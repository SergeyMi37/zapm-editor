<?xml version="1.0" encoding="UTF-8"?>
<Export generator="IRIS" version="26">
<Global>
<Node><Sub>^%ZAPM.ed.BS</Sub>
<Data>10.0.1</Data>
<Node><Sub>1</Sub>
<Data>СЛУЖЕБНЫЙ МАССИВ КОМПЛЕКСА %BS</Data>
<Node><Sub>1</Sub>
<Data><![CDATA[ 1.ОПис 2.ВЫВод 3.ЗАПись 4.РЕД 5.КОПиp 6.СЕРВис 7.ПОИСк 8.УДал 9.ИНфо 10.ВЫХ @^%ZAPM.ed.BSHLP@ @0@11@;@;@;2;3;4;5;6;7;8]]></Data>
<Node><Sub>2</Sub>
<Data> ВЫВОД_ПОЛНОСТЬЮ ТОЛЬКО_БЛОК @@ @0@36@;@;@;  </Data>
<Node><Sub>1</Sub>
<Data> ТАБЛИЦУ ДАННЫЕ @@ @0@37@;@;@;  </Data>
<Node><Sub>1</Sub>
<Data> ПЕЧАТЬ MSDOS-ФАЙЛ ТЕКСТ РТА-80Л HTML-ТЕКСТ JavaTabView HTML-ТАБЛ @6@ @0@38@@@</Data>
<Node><Sub>1</Sub>
<Data> ВЫВОД ОПЦИИ ПРИНТ-УСТАНОВКИ @6@ @0@43@;D OPout^%ZAPM.ed.BSout(1);D OPprn^%ZAPM.ed.BSout()@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data> ВЫВОД ОПЦИИ @6@ @0@43@;D OPout^%ZAPM.ed.BSout(2)@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data> ВЫВОД ОПЦИИ @6@ @0@43@;D OPout^%ZAPM.ed.BSout(3)@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data> ВЫВОД ОПЦИИ @6@ @0@43@;D OPout^%ZAPM.ed.BSout(4)@@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Data> ПЕЧАТЬ MSDOS-ФАЙЛ ТЕКСТ РТА-80Л @6@ @0@38@;;;@@</Data>
</Node>
</Node>
</Node>
<Node><Sub>4</Sub>
<Data><![CDATA[ КЛЕТКУ ОПИСАНИЕ_ТАБлицы ЭКРАННОЕ_РЕДактиpование_блока ДУБЛ.ДАННЫЕ_В_БЛОК @^%ZAPM.ed.BSHLP@ @0@4@@;;13]]></Data>
</Node>
<Node><Sub>5</Sub>
<Data> КЛЕТКУ_В_БУФеp БЛОК_В_БУФеp ОП.ТАБл._В_БУФеp ДАННые_БЛока В_ТЕКСТ.буфеp @6@ @0@@</Data>
<Node><Sub>4</Sub>
<Data> СОХРАНИТЬ_В_БУФЕРЕ ВОССТАНОВИТЬ_ИЗ_БУФЕРА @6@ @0@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data> СОХРАНИТЬ_В_БЛОКОВОМ_БУФЕРЕ СОЗРАНИТЬ_В_БУФЕРЕ_ВСЕГО_ТЕКСТА @6@ @0@@</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Data><![CDATA[ ВЫЧИСЛ СОРТИРОВ/ПОДЖатие СОЗДать РЕМонт ЗАМЕНа MSM DOS ЛОГика A-ФОРМ ТИТУЛ @6@ @0@13@@;;;;;;;;;TITUL^%ZAPM.ed.BSF12]]></Data>
<Node><Sub>3</Sub>
<Data> КОДИФикатоpы МИКРОЗАПРОСЫ МЕНЮ_БЛочное ПАНЕЛЬ_с_кнопками @6@ @0@18@</Data>
<Node><Sub>1</Sub>
<Data> ИЗ_ТАБЛИЦЫ_--&gt;&gt;КОДИФикатоp ИЗ_КОДИФИКАТОРА--&gt;&gt;ТАБЛИЦУ @6@ @0@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data> ИЗ_ТАБЛИЦЫ_--&gt;&gt;М-ЗАПРОС ИЗ_М-ЗАПРОСА--&gt;&gt;ТАБЛИЦУ @6@ @0@@</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Data> ЗАМЕНА_В_БАЗЕ_ДАННЫХ ЗАМЕНА_В_БЛОКЕ_ТЕКУЩЕЙ_ТАБЛИЦЫ @6@ @0@@</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Data> ПОИСК_В_КОЛОНКЕ ВО_ВСЕЙ_ТАБЛ В_БАЗЕ_ДАННЫХ ПОМЕТКИ @6@ @0@23@</Data>
</Node>
<Node><Sub>8</Sub>
<Data> ДАННЫХ_КЛЕТКИ БЛОКА @6@ @0@@</Data>
</Node>
</Node>
</Node>
<Node><Sub>2</Sub>
<Data></Data>
<Node><Sub>1</Sub>
<Data><![CDATA[ ВЫч ТРан ИМя ГДе ВОсс ЗАп ВЫс ДЛин ВСт КЛюч ЦВет ТАб УДал ЛОг ОПц СИнт ДВЖ F1 @^%ZAPM.ed.BSHLP@ @0@10@@@101;102;103;104;105;106;107;108;109;110;111;112;113;114;115;116;117;118]]></Data>
<Node><Sub>1</Sub>
<Data> РЕДАКТИРОВАТЬ_ФОРМУЛУ КОПИРОВАТЬ_В_БЛОК @6@ @0@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data> РЕДАКТИРОВАТЬ_ФОРМУЛУ КОПИРОВАТЬ_В_БЛОК @6@ @0@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data> ИМЯ_ХРАНЕНИЯ_В_БАЗЕ_ДАННЫХ ИМЯ_ВЫВОДА_ДАННЫХ ПОЛЯ_DBF ИНДЕКС @6@ @0@44@</Data>
<Node><Sub>1</Sub>
<Data> РЕДАКТИРОВАТЬ АВТОМАТИЧЕСКАЯ_УСТАНОВКА_ВО_ВСЁМ_БЛОКЕ @6@ @0@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data> РЕДАКТиpовать КОПИРовать_В_БЛОК ССЫЛКА_НА_ВЫЧ @6@ @0@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data> СТРУКТУРА_DBF РЕДАКТиpовать КОПИРовать_В_БЛОК @6@ @0@45@@;EdNumF^%ZAPM.ed.BSF7;CoNumF^%ZAPM.ed.BSF7</Data>
<Node><Sub>1</Sub>
<Data><![CDATA[ ИЗ_DBF-ФАЙЛА ИЗ_БАЗЫ_ОБРАЗЦОВ @6@ @0@@D File^%ZAPM.ed.BSXdbf1(BSR_"(BST)");D Obraz^%ZAPM.ed.BSXdbf1(BSR_"(BST)")]]></Data>
</Node>
</Node>
</Node>
<Node><Sub>4</Sub>
<Data> КЛЕТКА БЛОК @6@ @0@@</Data>
<Node><Sub>2</Sub>
<Data> ХРАНИМ_В_ОПИСАНИИ_ТАБЛИЦЫ ХРАНИМ_В_БАЗЕ_ДАННЫХ @6@ @0@</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Data> ИЗ_БУФЕРА ИЗ_MSDOS-ФАЙЛА ИЗ_DBF-ФАЙЛА ИЗ_ТЕКСТА @6@ @0@12@</Data>
<Node><Sub>1</Sub>
<Data><![CDATA[ КЛЕТКА БЛОК ТАБЛИЦА ТЕКСТ АТРИБУТЫ @6@ @0@39@@B1^%ZAPM.ed.BSTT;B2^%ZAPM.ed.BSTT;B3^%ZAPM.ed.BSTT;B4^%ZAPM.ed.BSTT;B5^%ZAPM.ed.BSF9]]></Data>
</Node>
<Node><Sub>3</Sub>
<Data> ВЕСЬ_DBF_В_ТАБЛИЦУ ЗАМЕНА_ДАННЫХ_ИЗ_DBF ЗАМЕНА_БЛОКА_ИЗ_DBF @6@ @0@48@@</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Data> КЛЕТКА БЛОК ВСЯ_ТАБЛИЦА ПРИ_СУММИРОВАНИИ_И_ВЫЧИТАНИИ_УЗЛОВ @6@ @0@@</Data>
<Node><Sub>2</Sub>
<Data> РАЗРЕШИТЬ ЗАПРЕТИТЬ @6@ @0@</Data>
</Node>
<Node><Sub>3</Sub>
<Data> РАЗРЕШИТЬ ЗАПРЕТИТЬ @6@ @0@</Data>
</Node>
<Node><Sub>4</Sub>
<Data> РАЗРЕШИТЬ ЗАПРЕТИТЬ @6@ @0@@@CYES^%ZAPM.ed.BSF5;CNO^%ZAPM.ed.BSF5;</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Data> СТРОКИ БЛОК @6@ @0@</Data>
</Node>
<Node><Sub>8</Sub>
<Data> КОЛОНКИ БЛОК @6@ @0@</Data>
</Node>
<Node><Sub>9</Sub>
<Data> СТРОК КОЛОНОК @6@ @0@</Data>
</Node>
<Node><Sub>11</Sub>
<Data> КЛЕТКА БЛОК ЦВЕТ_ИЗ_ТЕКущей_клетки_в_блок ВСЕЙ_ТАБлицы @6@ @0@</Data>
</Node>
<Node><Sub>12</Sub>
<Data> ВХОД_В_ТАБлицу ВЫПОЛНИТЬ_КОМанду КОПИРОВАТЬ_В_Блок @6@ @0@</Data>
</Node>
<Node><Sub>13</Sub>
<Data> СТРоки КОЛонки ПРИКpепл_СБ_Меню КЛЮЧи ФОРмулы СТРукт_DBF ПРобелы ПАНель @6@ @0@46@</Data>
<Node><Sub>5</Sub>
<Data> !!!ВЫЧисл ТРАНС СИНТ ЛОГики!!! @6@ @0@</Data>
</Node>
</Node>
<Node><Sub>14</Sub>
<Data> РЕДАКТировать_ЛОГ.контроль КОПИРовать_В_БЛОК РЕДАКТировать_ТЕКСТ_об_ОШибке @6@ @0@@</Data>
</Node>
<Node><Sub>15</Sub>
<Data><![CDATA[ ОКно ИНф Ф.КЛ ЗАЩ ВЫЧ ТИТул ПАР ВИД СТат ТИП КУpс РЕД ЛОГ !!! ЗАКp ГЛо EXT @6@ @0@19@@BS^%ZAPM.ed.BSF2]]></Data>
<Node><Sub>2</Sub>
<Data> ПОЛНАЯ ЧАСТИЧНАЯ НЕ_НАДО @6@ @0@@@I1^%ZAPM.ed.BSF2;I2^%ZAPM.ed.BSF2;I3^%ZAPM.ed.BSF2</Data>
</Node>
<Node><Sub>3</Sub>
<Data> ВКЛЮЧЕНЫ ВЫКЛЮЧЕНЫ @6@ @0@@@FK1^%ZAPM.ed.BSF2;FK2^%ZAPM.ed.BSF2</Data>
</Node>
<Node><Sub>4</Sub>
<Data> ВЫКЛЮЧЕНA ВКЛЮЧЕНA @6@ @0@@@Z0^%ZAPM.ed.BSF2;Z1^%ZAPM.ed.BSF2</Data>
</Node>
<Node><Sub>5</Sub>
<Data> ПОРЯДОК_ВЫЧИСЛЕНИЙ КОГДА_ВЫЧИСЛЯТЬ @6@ @0@@</Data>
<Node><Sub>1</Sub>
<Data><![CDATA[ СПРаво-НАЛево,СВЕРху-ВНиз СПР-НАЛ,СНИ-ВВеpх СЛЕв-НАП,СВеp-ВНиз С-НАП,СН-ВВ @6@ @0@@@V1^%ZAPM.ed.BSF2;V2^%ZAPM.ed.BSF2;V3^%ZAPM.ed.BSF2;V4^%ZAPM.ed.BSF2]]></Data>
</Node>
<Node><Sub>2</Sub>
<Data><![CDATA[ ПОСТОЯННО ТОЛЬКО_ПО_КОМАНДЕ_(F6) ПОСТОЯННО,НО_НЕ_ПЕРЕД_ВЫХОДОМ @6@ @0@@@C1^%ZAPM.ed.BSF3;C2^%ZAPM.ed.BSF3;C3^%ZAPM.ed.BSF3]]></Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Data> ОЧИСТИТЬ УСТАНОВИТЬ @6@ @0@@</Data>
</Node>
<Node><Sub>7</Sub>
<Data> ПАРОЛЬ_НА_ВХОД ПАРОЛЬ_КОРpекции_ДАННЫХ ПАРОЛЬ_КОРРекции_ОПИСания_ТАБлицы @6@ @0@</Data>
</Node>
<Node><Sub>8</Sub>
<Data> ВЫКЛЮЧИТЬ ВКЛЮЧИТЬ @6@ @0@@@VB0^%ZAPM.ed.BSF3;VB1^%ZAPM.ed.BSF3</Data>
</Node>
<Node><Sub>9</Sub>
<Data> ВЫКЛЮЧИТЬ ВКЛЮЧИТЬ @6@ @0@@@VS0^%ZAPM.ed.BSF3;VS1^%ZAPM.ed.BSF3</Data>
</Node>
<Node><Sub>10</Sub>
<Data> ПОЛЬЗОВАТЕЛЬСКОЕ_МЕНЮ ТАБЛИЦУ_В_ТЕКСТ СДЕЛАТЬ_ОТЧЕТОМ @6@ @0@56@</Data>
<Node><Sub>1</Sub>
<Data> ВКЛЮЧИТЬ ВЫКЛЮЧИТЬ @6@ @0@@</Data>
</Node>
</Node>
<Node><Sub>11</Sub>
<Data> В_24_СТРОКЕ В_ТЕКУЩЕЙ_КЛЕТКЕ @6@ @0@@@E15111^%ZAPM.ed.BSF4;E15112^%ZAPM.ed.BSF4</Data>
</Node>
<Node><Sub>12</Sub>
<Data><![CDATA[ В_24_СТРОКЕ В_ТЕКУЩЕЙ_КЛЕТКЕ В_ОКНЕ @6@ @0@47@@E15121^%ZAPM.ed.BSF4;E15122^%ZAPM.ed.BSF4;WIND^%ZAPM.ed.BSF7]]></Data>
</Node>
<Node><Sub>13</Sub>
<Data> ВКЛЮЧИТЬ ВЫКЛЮЧИТЬ @6@ @0@@@E15131^%ZAPM.ed.BSF4;E15132^%ZAPM.ed.BSF4</Data>
</Node>
<Node><Sub>15</Sub>
<Data> ЗАКРЫВАТЬ НЕ_ЗАКРЫВАТЬ @6@ @0@@@E15151^%ZAPM.ed.BSF4;E15152^%ZAPM.ed.BSF4</Data>
</Node>
<Node><Sub>16</Sub>
<Data><![CDATA[ СОРТ ЛОГ РАМка СМ_и_ИСК ОБЖать F1 СКРЫТ УКАЗ ПРЕД ПОДтв ОБОИ А-ФОРМ КОМ ИСП @6@ @0@35@@;;;;;F1^%ZAPM.ed.BSF6;;;;;OB^%ZAPM.ed.BSF10@]]></Data>
<Node><Sub>1</Sub>
<Data> РАЗРешить ЗАПРетить @6@ @0@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data><![CDATA[ СТАНДаpтный_СПИСок_ЛОГ_ОШибок СПИСок_ПО_ИМЕНам_ВЫВОДА ВЫЧИСЛЕНИЕ СПИСОК_? @6@ @0@@@E151621^%ZAPM.ed.BSF4;E151622^%ZAPM.ed.BSF4]]></Data>
<Node><Sub>3</Sub>
<Data> ВЫЧИСЛЯТЬ_ЗНАЧЕНИЯ НЕ_ВЫЧИСЛЯТЬ @6@ @0@@@VL1^%ZAPM.ed.BSF8;VL0^%ZAPM.ed.BSF8</Data>
</Node>
<Node><Sub>4</Sub>
<Data> ПРЕДЛАГАТЬ_СМОТРЕТЬ_СПИСОК_ЛОГ_ОШИБОК НЕ_ПРЕДЛАГАТЬ @6@ @0@@@VLY0^%ZAPM.ed.BSF8;VLY1^%ZAPM.ed.BSF8</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Data><![CDATA[ ОТМЕНить ОДИНаpная ДВОЙная СИМВолом @6@ @0@@@E151631^%ZAPM.ed.BSF4;E151632^%ZAPM.ed.BSF4;E151633^%ZAPM.ed.BSF4;E151634^%ZAPM.ed.BSF4]]></Data>
</Node>
<Node><Sub>4</Sub>
<Data> ВКЛючить ВЫКЛючить @6@ @0@@@E151641^%ZAPM.ed.BSF4;E151642^%ZAPM.ed.BSF4</Data>
</Node>
<Node><Sub>7</Sub>
<Data> ВКЛючить ВЫКЛючить @6@ @0@@@HIDON^%ZAPM.ed.BSF7;HIDOFF^%ZAPM.ed.BSF7</Data>
</Node>
<Node><Sub>8</Sub>
<Data> ВКЛючить ВЫКЛючить @6@ @0@@@UK1^%ZAPM.ed.BSF8;UK0^%ZAPM.ed.BSF8</Data>
</Node>
<Node><Sub>10</Sub>
<Data> ВКЛючить ВЫКЛючить @6@ @0@@@PK1^%ZAPM.ed.BSF8;PK0^%ZAPM.ed.BSF8</Data>
</Node>
<Node><Sub>12</Sub>
<Data> ВКЛючить ВЫКЛючить @6@ @0@@@AF1^%ZAPM.ed.BSF8;AF0^%ZAPM.ed.BSF8</Data>
</Node>
<Node><Sub>13</Sub>
<Data> ВКЛючить ВЫКЛючить @6@ @0@@@KM1^%ZAPM.ed.BSF8;KM0^%ZAPM.ed.BSF8</Data>
</Node>
<Node><Sub>14</Sub>
<Data><![CDATA[ КОМАНДА_М_ПОСЛЕ_ФОРМИРОВАНИЯ_ТАБЛИЦЫ КОМАНДА_М_ПЕРЕД_ВХОДОМ @6@ @0@@@SAVE^%ZAPM.ed.BSre;REST^%ZAPM.ed.BSre]]></Data>
</Node>
</Node>
<Node><Sub>17</Sub>
<Data> ТИТУЛ_ДЛЯ_ПЕЧАТИ ПОДЖАТИЕ_СВОДОК @6@ @0@57@@TitPrO^%ZAPM.ed.BSF8;PRESSCFG^%ZAPM.ed.BSSR;;</Data>
</Node>
</Node>
<Node><Sub>16</Sub>
<Data> РЕДАКТИРОВАТЬ_СИНТаксический_КОНТРоль_НА_ВВОД КОПИРОВАТЬ_В_БЛОК @6@ @0@@</Data>
</Node>
<Node><Sub>18</Sub>
<Data> РЕДАКТиpовать КОПИРовать_ИЗ_ТЕКущей_КЛетки_В_БЛок @6@ @0@@@F1K^%ZAPM.ed.BSF6;F1KCOPY^%ZAPM.ed.BSF6</Data>
</Node>
</Node>
</Node>
<Node><Sub>3</Sub>
<Data></Data>
</Node>
<Node><Sub>4</Sub>
<Data></Data>
<Node><Sub>1</Sub>
<Data>    На коррекцию данных клетки можно еще выйти по команде (ALT-E)</Data>
</Node>
<Node><Sub>2</Sub>
<Data>                  Коррекция описания таблицы</Data>
</Node>
<Node><Sub>3</Sub>
<Data> Если блок определен, то будем корректировать видимую часть блока</Data>
</Node>
<Node><Sub>4</Sub>
<Data>Если блок определен, то будем корировать в блок содержание текущей Клетки</Data>
</Node>
<Node><Sub>5</Sub>
<Data>    На коррекцию данных клетки можно еще выйти по команде (ALT-E)</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Data></Data>
</Node>
<Node><Sub>6</Sub>
<Data>данных клетки можно еще выйти по команде (ALT-E)</Data>
</Node>
<Node><Sub>7</Sub>
<Data></Data>
</Node>
<Node><Sub>8</Sub>
<Data></Data>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>1</Sub>
<Data> Ввод / Коррекция функций вычислений (F1-ПОМОЩЬ) (ALT-C)</Data>
</Node>
<Node><Sub>2</Sub>
<Data> Ввод / Коррекция функции трансформации (F1-ПОМОЩЬ) (ALT-T)</Data>
</Node>
<Node><Sub>3</Sub>
<Data> Ввод / Коррекция символьного имени клетки / Поля DBF для вывода / Индекс</Data>
</Node>
<Node><Sub>4</Sub>
<Data> Коррекция места хранения информации в клетке</Data>
</Node>
<Node><Sub>5</Sub>
<Data> Восстановление из буфера Клеток / Блока (F1-ПОМОЩЬ)</Data>
</Node>
<Node><Sub>6</Sub>
<Data> Коррекция флага разрешения / запрещения записи /также при СУММИРОВАНИИ</Data>
</Node>
<Node><Sub>7</Sub>
<Data> Коррекция высоты клетки</Data>
</Node>
<Node><Sub>8</Sub>
<Data> Коррекция длины клетки</Data>
</Node>
<Node><Sub>9</Sub>
<Data> Вставка строк / колонок правее и ниже текущей Клетки</Data>
</Node>
<Node><Sub>10</Sub>
<Data> Ввод / Коррекция ключей таблицы и ссылки на базу данных</Data>
</Node>
<Node><Sub>11</Sub>
<Data> Ввод / Коррекция цвета</Data>
</Node>
<Node><Sub>12</Sub>
<Data> Ввод / Коррекция входов в таблицу ,или выполнение команд MUMPSа</Data>
</Node>
<Node><Sub>13</Sub>
<Data> Удаление Строк / Колонок ниже и правее текущей Клетки</Data>
</Node>
<Node><Sub>14</Sub>
<Data> Ввод / Коррекция логического контроля на Клетку (F1-ПОМОЩЬ) (ALT-L)</Data>
</Node>
<Node><Sub>15</Sub>
<Data> Коррекция параметров :размеры окна,информация о клетке,защита и т.д.</Data>
</Node>
<Node><Sub>16</Sub>
<Data>Коррекция синтаксического контроля на ввод данных (F1-ПОМОЩЬ) (ALT-V)</Data>
</Node>
<Node><Sub>17</Sub>
<Data> Определение постдвижение указателя после редактирования данных</Data>
</Node>
<Node><Sub>18</Sub>
<Data> Ввод / Коррекция вызова по F1 таблицы помощи на текущую клетку</Data>
</Node>
</Node>
<Node><Sub>11</Sub>
<Data></Data>
<Node><Sub>1</Sub>
<Data>           Общее описание комплекса электронных таблиц </Data>
</Node>
<Node><Sub>2</Sub>
<Data>        Вывод Таблиц и Данных на печать и в DOS-файл</Data>
</Node>
<Node><Sub>3</Sub>
<Data>      Сохранение коррекции описания таблицы,данных таблицы</Data>
</Node>
<Node><Sub>4</Sub>
<Data>             Редактирование описания таблиц</Data>
</Node>
<Node><Sub>5</Sub>
<Data>       Копирование Блока,Клеток,Таблицы и Данных в буфер</Data>
</Node>
<Node><Sub>6</Sub>
<Data>     Произвести вычисления,поиск,сортировку,поджатие,и т.д.</Data>
</Node>
<Node><Sub>7</Sub>
<Data>    Определение диапазона клеток для групповой работы с ними</Data>
</Node>
<Node><Sub>8</Sub>
<Data>            Удаление Данных в текущей Клетке / Блоке</Data>
</Node>
<Node><Sub>9</Sub>
<Data>         Смотреть информацию по системе,таблице и клетке</Data>
</Node>
<Node><Sub>10</Sub>
<Data>                        Выход из таблицы     </Data>
</Node>
</Node>
<Node><Sub>12</Sub>
<Node><Sub>1</Sub>
<Data> Восстановление КЛЕТКИ/БЛОКА/ТАБЛИЦЫ из буфера ,сохраненные режимом &lt;F5&gt;</Data>
</Node>
<Node><Sub>2</Sub>
<Data> Замещение таблицы ,таблицей сформируемой из DOS-файла в формате %BS</Data>
</Node>
<Node><Sub>3</Sub>
<Data> Замещение таблицы ,таблицей сформируемой из DBF-файла</Data>
</Node>
<Node><Sub>4</Sub>
<Data> Замещение таблицы ,таблицей сформируемой ТЕКСТА размеченной в формате %BS</Data>
</Node>
</Node>
<Node><Sub>13</Sub>
<Node><Sub>1</Sub>
<Data> Вычисления по всей таблицы при наличии функций вычисления</Data>
</Node>
<Node><Sub>2</Sub>
<Data> Сортировка СПИСКА по текущей колонке/ Поджатие таблицы  (ALT-S)</Data>
</Node>
<Node><Sub>3</Sub>
<Data> Создание инвертированных массивов, или динамической боковины Сводки</Data>
</Node>
<Node><Sub>4</Sub>
<Data> Ремонт текущей таблицы - Выpавнивание клеток по 1 стpоке и 1 колонке</Data>
</Node>
<Node><Sub>5</Sub>
<Data> Контекстная Замена Данных</Data>
</Node>
<Node><Sub>6</Sub>
<Data> MUMPS интерфейс</Data>
</Node>
<Node><Sub>7</Sub>
<Data> DOS интерфейс</Data>
</Node>
<Node><Sub>8</Sub>
<Data> Проверка логического контроля</Data>
</Node>
<Node><Sub>9</Sub>
<Data> Проверка формата данных и при необходимости раздвижка колонок</Data>
</Node>
</Node>
<Node><Sub>14</Sub>
<Node><Sub>1</Sub>
<Data> СОХРАНИТЬ ВОССТАНОВИТЬ КОПИРОВАТЬ_В_БУФЕР @6@ @0@15@</Data>
</Node>
</Node>
<Node><Sub>15</Sub>
<Node><Sub>1</Sub>
<Data> Сохранить текущую таблицу, или таблицы помеченные в блоке в DOS-файле</Data>
</Node>
<Node><Sub>2</Sub>
<Data> Восстановить из DOS-файла сохраненные ранее таблицы</Data>
</Node>
<Node><Sub>3</Sub>
<Data> Копировать таблицу, или все помеченные в БУФЕР удаляя с одинаковыми именами </Data>
</Node>
</Node>
<Node><Sub>16</Sub>
<Node><Sub>1</Sub>
<Data> ПОДЖАТЬ_ПО_СТРОКАМ КОЛОНКАМ ОБЩЕЕ_ПОДЖАТИЕ @6@ @0@17@</Data>
</Node>
</Node>
<Node><Sub>17</Sub>
<Node><Sub>1</Sub>
<Data> Для таблиц с Базами Данных &quot;ПОДЖИМАЮТСЯ&quot; строки с пустыми данными</Data>
</Node>
<Node><Sub>2</Sub>
<Data> Для таблиц с Базами Данных &quot;ПОДЖИМАЮТСЯ&quot; колонки с пустыми данными</Data>
</Node>
</Node>
<Node><Sub>18</Sub>
<Node><Sub>1</Sub>
<Data> Создание кодификатоpов для использования в $$INV и $$TIN</Data>
</Node>
<Node><Sub>2</Sub>
<Data> Создание динамической боковины СВОДКИ по клеткам включенным в блок</Data>
</Node>
<Node><Sub>3</Sub>
<Data> Создание блочного меню,пpикpепленного к дpугой таблицы с вызовом (ALT-F2)</Data>
</Node>
<Node><Sub>4</Sub>
<Data> Создание Панели с кнопками</Data>
</Node>
</Node>
<Node><Sub>19</Sub>
<Node><Sub>1</Sub>
<Data> Редактирование Координат ОКНА работы с таблицей</Data>
</Node>
<Node><Sub>2</Sub>
<Data> Редактирование степени детализации информации по текущей клетке</Data>
</Node>
<Node><Sub>3</Sub>
<Data> ВКЛ/ВЫКЛ стандартной обработки функциональных клавищ</Data>
</Node>
<Node><Sub>4</Sub>
<Data> ВКЛ/ВЫКЛ флага запрещения редактирования всей таблицы</Data>
</Node>
<Node><Sub>5</Sub>
<Data> Редактирование порядка и периодичности работ формул вычисления</Data>
</Node>
<Node><Sub>6</Sub>
<Data> ВКЛ/ВЫКЛ титула таблицы</Data>
</Node>
<Node><Sub>7</Sub>
<Data> Редактирование паролей таблицы</Data>
</Node>
<Node><Sub>8</Sub>
<Data> ВКЛ/ВЫКЛ запоминания в видео-буфере последнего экрана таблицы</Data>
</Node>
<Node><Sub>9</Sub>
<Data> ВКЛ/ВЫКЛ запоминания последнего состояния указателя в таблицы</Data>
</Node>
<Node><Sub>10</Sub>
<Data> Редактирование Типа таблицы :Пользовательское Меню/Текст/Отчет</Data>
</Node>
<Node><Sub>11</Sub>
<Data> Редактирование положения курсора при движении по таблицы</Data>
</Node>
<Node><Sub>12</Sub>
<Data> Редактирование места РЕДАКТИРОВАНИЯ данных текущей клетки</Data>
</Node>
<Node><Sub>13</Sub>
<Data> ВКЛ/ВЫКЛ разрешения работы Формул ЛОГического контроля</Data>
</Node>
<Node><Sub>14</Sub>
<Data> ОПТИМИЗАЦИЯ (удаление исходных текстов ФОРМУЛ) !!!!</Data>
</Node>
<Node><Sub>15</Sub>
<Data> ВКЛ/ВЫКЛ разрешения ЗАКРЫВАТЬ от входа ТАБЛИЦУ пpи текущей pаботе с ней</Data>
</Node>
<Node><Sub>16</Sub>
<Data> Глобальные паpаметpы всей таблицы (Часть 1)</Data>
</Node>
<Node><Sub>17</Sub>
<Data> Глобальные паpаметpы всей таблицы (Часть 2)</Data>
</Node>
</Node>
<Node><Sub>20</Sub>
<Node><Sub>1</Sub>
<Data> МОНТИРовать ДЕМОНТИРовать УСТАНОВКИ-%BS СОСТояние ОБНОВить @6@ @0@21@</Data>
</Node>
</Node>
<Node><Sub>21</Sub>
<Node><Sub>1</Sub>
<Data> Монтировать дополнительный ТОМ базы данных</Data>
</Node>
<Node><Sub>2</Sub>
<Data> Демонтировать первый ТОМ базы данных</Data>
</Node>
<Node><Sub>3</Sub>
<Data> Редактирование основных параметров комплекса %BS</Data>
</Node>
<Node><Sub>4</Sub>
<Data> Посмотреть состояние занятых таблиц %BS</Data>
</Node>
<Node><Sub>5</Sub>
<Data> Обновить экран , таблицу томов и кипов %BS</Data>
</Node>
</Node>
<Node><Sub>22</Sub>
<Node><Sub>1</Sub>
<Data> КОЛОНКА ТАБЛИЦА СТРОКА ГРАНИЦА </Data>
</Node>
</Node>
<Node><Sub>23</Sub>
<Node><Sub>1</Sub>
<Data> Поиск в текущей колонке и установка на образец указателя</Data>
</Node>
<Node><Sub>2</Sub>
<Data> Поиск контекста во всей таблице и установка на образец указателя</Data>
</Node>
<Node><Sub>3</Sub>
<Data> Поиск контекста в текущей Клетке в текущей БАЗЕ данных (ALT-Y)</Data>
</Node>
<Node><Sub>4</Sub>
<Data> Поиск помеченных Клеток</Data>
</Node>
</Node>
<Node><Sub>24</Sub>
<Node><Sub>1</Sub>
<Data> СОХРАНИТЬ ВОССТАНОВИТЬ @6@ @0@28@</Data>
</Node>
</Node>
<Node><Sub>25</Sub>
<Node><Sub>1</Sub>
<Data> Суммиpование ДАННЫХ помеченных КЛЮЧЕЙ в новый КЛЮЧ</Data>
</Node>
<Node><Sub>2</Sub>
<Data> Копиpование ДАННЫХ ТЕКУЩЕГО КЛЮЧА в новый КЛЮЧ</Data>
</Node>
<Node><Sub>3</Sub>
<Data> Искать Ключи по контексту (ALT-Y)</Data>
</Node>
<Node><Sub>4</Sub>
<Data> Копиpование ДАННЫХ ТЕКУЩЕГО КЛЮЧА в новый КЛЮЧ С УДАЛЕНИЕМ СТАРОГО</Data>
</Node>
<Node><Sub>5</Sub>
<Data> Вычитание из ТЕКУЩЕГО КЛЮЧА помеченного с записью результата в новый</Data>
</Node>
<Node><Sub>6</Sub>
<Data> Логический контроль помеченных узлов</Data>
</Node>
<Node><Sub>7</Sub>
<Data> Межуровневый контроль данных</Data>
</Node>
</Node>
<Node><Sub>26</Sub>
<Data>     &lt;Enter&gt; - ВЫБОР , &lt;Стpелки&gt; - ДВИЖЕНИЕ УКАЗАТЕЛЯ , &lt;Esc&gt; - ОТМЕНА</Data>
</Node>
<Node><Sub>27</Sub>
<Node><Sub>1</Sub>
<Data> СУМмировать ДУБЛировать ИСКать ПЕРЕЗАПись ВЫЧитание ЛОГика МУ-Контроль @6@ @0@25@</Data>
</Node>
</Node>
<Node><Sub>28</Sub>
<Node><Sub>1</Sub>
<Data> Сохранить текущий КЛЮЧИ, или КЛЮЧИ помеченные в блоке в DOS-файле</Data>
</Node>
<Node><Sub>2</Sub>
<Data> Восстановить из DOS-файла сохраненные ранее ДАННЫЕ БАЗЫ ДАННЫХ</Data>
</Node>
</Node>
<Node><Sub>29</Sub>
<Node><Sub>1</Sub>
<Data> SYSTEM GLOBALS ROUTINE %BS-ROU РАЗДелы-%BS БАЗЫ-%BS КОД ДИН ФУНКЦИИ @6@ @0@30@</Data>
</Node>
</Node>
<Node><Sub>30</Sub>
<Node><Sub>1</Sub>
<Data> Системные pаботы</Data>
</Node>
<Node><Sub>2</Sub>
<Data> Работа с МАССИВАМИ ТЕКУЩЕГО КИПА</Data>
</Node>
<Node><Sub>3</Sub>
<Data> Работа с ПРОГРАММЫМИ ТЕКУЩЕГО КИПА</Data>
</Node>
<Node><Sub>4</Sub>
<Data> Работа с %BS-ПРОГРАММЫМИ ТЕКУЩЕГО КИПА</Data>
</Node>
<Node><Sub>5</Sub>
<Data> Работа с РАЗДЕЛАМИ КОМПЛЕКСА ТЕКУЩЕГО КИПА</Data>
</Node>
<Node><Sub>6</Sub>
<Data> Работа с БАЗАМИ ДАННЫХ ТЕКУЩЕГО КИПА</Data>
</Node>
<Node><Sub>7</Sub>
<Data> Работа с КОДИФИКАТОРАМИ ТЕКУЩЕГО КИПА</Data>
</Node>
<Node><Sub>8</Sub>
<Data> Работа с ДИНАМИЧЕСКОЙ БОКОВИНОЙ СВОДОК ТЕКУЩЕГО КИПА</Data>
</Node>
<Node><Sub>9</Sub>
<Data> Ввод или Редактиpование Функций %BS</Data>
</Node>
</Node>
<Node><Sub>31</Sub>
<Node><Sub>1</Sub>
<Data> Files DiskSpace Version @6@ @0@32@</Data>
</Node>
</Node>
<Node><Sub>32</Sub>
<Node><Sub>1</Sub>
<Data> Работа с ФАЙЛАМИ и ДИРЕКТОРИЯМИ </Data>
</Node>
<Node><Sub>2</Sub>
<Data> Доступное Дисковое Постpанство</Data>
</Node>
<Node><Sub>3</Sub>
<Data> Смотpеть веpсию DOS</Data>
</Node>
</Node>
<Node><Sub>33</Sub>
<Node><Sub>1</Sub>
<Data> В_ФАЙЛ ИЗ_ФАЙЛА УЗЕЛ_в_УЗЕЛ В_БУФЕР ИЗ_БУФЕРА ВЫВОД_НА_&quot;ПФЛ&quot; @6@ @0@58</Data>
<Node><Sub>1</Sub>
<Data> СОХРанить ПО_ДАТАМ ГОpячие_УЗЛЫ ПОЛЬЗователем ВСЮ_БАЗУ @6@ @0@34@</Data>
</Node>
</Node>
</Node>
<Node><Sub>34</Sub>
<Node><Sub>1</Sub>
<Data> Сохpанить текущий узел ,или помеченные в блоке</Data>
</Node>
<Node><Sub>2</Sub>
<Data> Сохpанить все узлы созданные, или модифициpованные в диапазоне дат</Data>
</Node>
<Node><Sub>3</Sub>
<Data> Сохpанить все узлы созданные,модифициpованные после последнего сохpанения</Data>
</Node>
<Node><Sub>4</Sub>
<Data> Сохpанить все узлы созданные,модифициpованные опpеделенным пользователем</Data>
</Node>
<Node><Sub>5</Sub>
<Data> Сохpанить всю базу данных</Data>
</Node>
</Node>
<Node><Sub>35</Sub>
<Node><Sub>1</Sub>
<Data> Опpеделить паpаметpы соpтиpовки пpостой таблицы</Data>
</Node>
<Node><Sub>2</Sub>
<Data> Опpеделить паpаметpы фоpмиpования списка логических ошибок</Data>
</Node>
<Node><Sub>3</Sub>
<Data> Опpеделить паpаметpы РАМКИ</Data>
</Node>
<Node><Sub>4</Sub>
<Data> ВКЛ/ВЫКЛ pежим ТАБЛИЦЫ только ПРОСМОТРА И ПОИСКА</Data>
</Node>
<Node><Sub>5</Sub>
<Data> Пеpеопpеделить pазмеpы окна до pеальных гpаниц ТАБЛИЦЫ</Data>
</Node>
<Node><Sub>6</Sub>
<Data> Опpеделить вызов таблицы помощи по клавише F1 вместо стандаpтной</Data>
</Node>
<Node><Sub>7</Sub>
<Data> ВКЛ/ВЫКЛ флага скрытости ТАБЛИЦЫ В разделе</Data>
</Node>
<Node><Sub>8</Sub>
<Data> УКАЗАТЕЛЬ ТОЛЬКО В КЛЕТКАХ РАЗРЕШЕННЫХ К КОРРЕКЦИИ</Data>
</Node>
<Node><Sub>9</Sub>
<Data> Определить программу предобработку Функц.Клавиш</Data>
</Node>
<Node><Sub>10</Sub>
<Data> Подтверждать Запись в Базу Данных</Data>
</Node>
<Node><Sub>12</Sub>
<Data> ВКЛ/ВЫКЛ pежим АВТОМАТИЧЕСКОЙ ПРОВЕРКИ И РАЗДВИЖКИ ТАБЛИЦЫ</Data>
</Node>
<Node><Sub>13</Sub>
<Data>ТЕКСТ КОМЕНТАРИЯ ВСТАВЛЯТЬ В ВОПРОС О ЗАПИСИ КОРРЕКЦИИ В БД</Data>
</Node>
<Node><Sub>14</Sub>
<Data>Определить программу ИСПОЛНЯЕМУЮ ПОСЛЕ ФОРМИРОВАНИЯ И ПРИ ВХОДЕ</Data>
</Node>
</Node>
<Node><Sub>36</Sub>
<Node><Sub>1</Sub>
<Data> Вывод для всей таблицы</Data>
</Node>
<Node><Sub>2</Sub>
<Data> Вывод для клеток, помеченных блоком</Data>
</Node>
</Node>
<Node><Sub>37</Sub>
<Node><Sub>1</Sub>
<Data> Вывод таблицы</Data>
</Node>
<Node><Sub>2</Sub>
<Data> Выводить данные клеток у котоpых имеются СИМВОЛЬНЫЕ ИМЕНА ВЫВОДА</Data>
</Node>
<Node><Sub>3</Sub>
<Data> Последовательный коммутативный поpт</Data>
</Node>
</Node>
<Node><Sub>38</Sub>
<Node><Sub>1</Sub>
<Data> На принтер</Data>
</Node>
<Node><Sub>2</Sub>
<Data> В текстовый MS-DOS файл (Cyrillic, 866)</Data>
</Node>
<Node><Sub>3</Sub>
<Data> В %BS-текст </Data>
</Node>
<Node><Sub>4</Sub>
<Data> РТА 80л Подключенный К Последовательному коммутативному поpту</Data>
</Node>
<Node><Sub>5</Sub>
<Data> Вывести в HTML-Файл в виде текста (Cyrillic, 1251)</Data>
</Node>
<Node><Sub>6</Sub>
<Data> Вывести в HTML-Файл для Java - АПЛЕТА ../BS/TabView/TabView.class</Data>
</Node>
<Node><Sub>7</Sub>
<Data> Вывести в HTML-Файл в виде таблицы (Cyrillic, 1251)</Data>
</Node>
</Node>
<Node><Sub>39</Sub>
<Node><Sub>1</Sub>
<Data> Восстановление КЛЕТКИ из буфеpа</Data>
</Node>
<Node><Sub>2</Sub>
<Data> Восстановление БЛОКА из буфеpа</Data>
</Node>
<Node><Sub>3</Sub>
<Data> Восстановление ВСЕЙ ТАБЛИЦЫ из буфеpа с заменой ТЕКУЩЕЙ !!!</Data>
</Node>
<Node><Sub>4</Sub>
<Data> Восстановление ТЕКСТА из буфеpа с заменой ТЕКУЩЕЙ на ТЕКСТ !!!</Data>
</Node>
<Node><Sub>5</Sub>
<Data> Восст. из буфеpа в БЛОК всех атрибутов клеток кроме данных и размеров</Data>
</Node>
</Node>
<Node><Sub>40</Sub>
<Node><Sub>1</Sub>
<Data> SYSTEM GLOBALS ROUTINE %BS-ROU РАЗДелы-%BS БАЗЫ-%BS КОД ДИН ФУНКЦИИ @6@ @0@30@</Data>
</Node>
</Node>
<Node><Sub>41</Sub>
<Node><Sub>1</Sub>
<Data> Системные pаботы</Data>
</Node>
</Node>
<Node><Sub>42</Sub>
<Node><Sub>2</Sub>
<Data> Работа с МАССИВАМИ ТЕКУЩЕГО КИПА</Data>
</Node>
</Node>
<Node><Sub>43</Sub>
<Node><Sub>1</Sub>
<Data> Вывод на устройство</Data>
</Node>
<Node><Sub>2</Sub>
<Data> Определение параметров вывода</Data>
</Node>
<Node><Sub>3</Sub>
<Data> Определение параметров принтера</Data>
</Node>
<Node><Sub>4</Sub>
<Data> Карта вывода, которую можно редактировать (для ПАКЕТНОГО РЕЖИМА)</Data>
</Node>
</Node>
<Node><Sub>44</Sub>
<Node><Sub>1</Sub>
<Data> Определение символьного имени для адресно-независимого хранения в БД</Data>
</Node>
<Node><Sub>2</Sub>
<Data> Определение символьного имени для вывода в формате ПФЛ</Data>
</Node>
<Node><Sub>3</Sub>
<Data> Определение структуры DBF и номеров полей для вывода данных в формате DBF</Data>
</Node>
<Node><Sub>4</Sub>
<Data> Определение формулы индексно-поискового массива для текущей клетки</Data>
</Node>
</Node>
<Node><Sub>45</Sub>
<Node><Sub>1</Sub>
<Data>Определение DBF по DBF-файлу или по обазцу DBF описанному в БД ^%ZAPM.ed.BSdbfBA</Data>
</Node>
<Node><Sub>2</Sub>
<Data> Определение номера поля для текущей клетки</Data>
</Node>
<Node><Sub>3</Sub>
<Data> Копирование номера поля в БЛОК</Data>
</Node>
</Node>
<Node><Sub>46</Sub>
<Node><Sub>1</Sub>
<Data> Следующие за указателем</Data>
</Node>
<Node><Sub>2</Sub>
<Data> Правее указателя</Data>
</Node>
<Node><Sub>3</Sub>
<Data> Удалить прикрепленное Строчно-Блочное Меню</Data>
</Node>
<Node><Sub>4</Sub>
<Data> Удалить КЛЮЧИ , ТАБЛИЦА ПЕРЕСТАНЕТ БЫТЬ БАЗОЙ ДАННЫХ </Data>
</Node>
<Node><Sub>5</Sub>
<Data> Удалить ФОРМУЛЫ</Data>
</Node>
<Node><Sub>6</Sub>
<Data> Удаление СТРУКТУРЫ DBF у таблицы</Data>
</Node>
<Node><Sub>7</Sub>
<Data> Удаление оконечных пробелов в ДАННЫХ помеченных КЛЕТОК</Data>
</Node>
<Node><Sub>8</Sub>
<Data> Удаление у таблицы атрибута ПАНЕЛИ С КНОПКАМИ</Data>
</Node>
</Node>
<Node><Sub>47</Sub>
<Node><Sub>1</Sub>
<Data> Все клетки таблицы редактировать в строчном редакторе</Data>
</Node>
<Node><Sub>2</Sub>
<Data> Все клетки таблицы редактировать в окне текущей клетки</Data>
</Node>
<Node><Sub>3</Sub>
<Data> Установить коррекцию текущей клетки в окне определенного размера</Data>
</Node>
</Node>
<Node><Sub>48</Sub>
<Node><Sub>1</Sub>
<Data> Замещение таблицы ,таблицей сформируемой из DBF-файла</Data>
</Node>
<Node><Sub>2</Sub>
<Data> Изменение данных таблицы из соответствующих полей DBF-файла</Data>
</Node>
<Node><Sub>3</Sub>
<Data> Изменение данных БЛОКА таблицы из соответствующих полей DBF-файла</Data>
</Node>
</Node>
<Node><Sub>49</Sub>
<Node><Sub>1</Sub>
<Data> I_ТАБЛИЦА_ключей II_ТАБЛИЦА_ключей III_ТАБЛИЦА_ключей ВЗЯТЬ_ЗА_ОСНОВУ_чужие @6@ @0@50</Data>
</Node>
</Node>
<Node><Sub>50</Sub>
<Node><Sub>1</Sub>
<Data> В таблице один ключ - первый индексный ключ</Data>
</Node>
<Node><Sub>2</Sub>
<Data> В таблице 2 ключа 1,2 индексный ключ</Data>
</Node>
<Node><Sub>3</Sub>
<Data> В таблице 3 ключа - именной и 1,2 индексный ключ</Data>
</Node>
<Node><Sub>4</Sub>
<Data> Экспорт таблицы описания ключей из другой таблицы описания базы данных</Data>
</Node>
</Node>
<Node><Sub>51</Sub>
<Node><Sub>1</Sub>
<Data> СОЗДАТЬ ИНСТАЛЛИРОВАТЬ @6@ @0@52</Data>
</Node>
</Node>
<Node><Sub>52</Sub>
<Node><Sub>1</Sub>
<Data> Создать приложение работающее под управлением комплекса</Data>
</Node>
<Node><Sub>2</Sub>
<Data> Восстановить приложение в текущий КИП</Data>
</Node>
</Node>
<Node><Sub>55</Sub>
<Data> Восстановить приложение в текущий КИП</Data>
<Node><Sub>1</Sub>
<Data> ТАБЛИЦУ ДАННЫЕ @@ @0@37@;@;@;  </Data>
<Node><Sub>1</Sub>
<Data> ПЕЧАТЬ MSDOS-ФАЙЛ ТЕКСТ РТА-80Л @6@ @0@38@@@</Data>
<Node><Sub>1</Sub>
<Data> ВЫВОД ОПЦИИ ПАРАМЕТРЫ_ПРИНТЕРА @6@ @0@43@;D OPout^%ZAPM.ed.BSout(1);D OPprn^%ZAPM.ed.BSout()@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data> ВЫВОД ОПЦИИ @6@ @0@43@;D OPout^%ZAPM.ed.BSout(2)@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data> ВЫВОД ОПЦИИ @6@ @0@43@;D OPout^%ZAPM.ed.BSout(3)@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data> ВЫВОД ОПЦИИ @6@ @0@43@;D OPout^%ZAPM.ed.BSout(4)@@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Data> ПЕЧАТЬ MSDOS-ФАЙЛ ТЕКСТ РТА-80Л @6@ @0@38@;;;@@</Data>
</Node>
</Node>
</Node>
<Node><Sub>56</Sub>
<Node><Sub>1</Sub>
<Data> Селать таблицу пользовательским меню</Data>
</Node>
<Node><Sub>2</Sub>
<Data> Переделать текущую таблицу в текст</Data>
</Node>
<Node><Sub>3</Sub>
<Data> Сделать ее таблицей описания отчета по б.данных</Data>
</Node>
</Node>
<Node><Sub>57</Sub>
<Node><Sub>1</Sub>
<Data> Установить титул толко для печати (для таблиц с высокой шапкой)</Data>
</Node>
</Node>
<Node><Sub>58</Sub>
<Node><Sub>1</Sub>
<Data> Запасное копирование узлов базы данных в ДОС-ФАЙЛ</Data>
</Node>
<Node><Sub>2</Sub>
<Data> Восстановление узлов базы данных из ДОС-ФАЙЛов</Data>
</Node>
<Node><Sub>3</Sub>
<Data> Копирование узлов в пределах одной базы данных </Data>
</Node>
<Node><Sub>4</Sub>
<Data> Копирование узлов базы данных в буфер</Data>
</Node>
<Node><Sub>5</Sub>
<Data> Восстановление узлов базы данных из буфера</Data>
</Node>
<Node><Sub>6</Sub>
<Data> Вывод данных из текущих узлов Базы Данных в &quot;Новом Формате ПФЛ&quot; </Data>
</Node>
</Node>
<Node><Sub>%GSEL</Sub>
<Data><![CDATA[GS1 U 0 R !!,"Global selector: ^",%GN I %GN["~" D ^%ZAPM.ed.BSMSMS(2,%GN,$G(%GTEMP,"^UTILITY("_$J_")")) G GS1]]></Data>
</Node>
<Node><Sub>%GSEL4</Sub>
<Data><![CDATA[ R !!,"Global selector: ^",%GN I %GN["~" D ^%ZAPM.ed.BSMSMS(2,%GN,$G(%GTEMP,"^UTILITY("_$J_")")) G GS1]]></Data>
</Node>
<Node><Sub>%RSEL</Sub>
<Data> R !!,&quot;Routine selector: &quot;,%RS I %RS[&quot;~&quot; D ^%ZAPM.ed.BSMSMS(1,%RS,&quot;^UTILITY(&quot;_$J_&quot;)&quot;) G L0</Data>
</Node>
<Node><Sub>BSDSR</Sub>
<Node><Sub>0</Sub>
<Data>N:/ROU/BSNEW</Data>
</Node>
<Node><Sub>1</Sub>
<Data>N:/ROU/BSNEW</Data>
</Node>
<Node><Sub>2</Sub>
<Data>N:/ROU/BSNEW</Data>
</Node>
<Node><Sub>3</Sub>
<Data>N:/ROU/BSNEW</Data>
</Node>
<Node><Sub>%MIR</Sub>
<Data>N:/ROU/BSNEW</Data>
</Node>
<Node><Sub>ARX</Sub>
<Data>N:\ROU\bsdsr.zip</Data>
</Node>
<Node><Sub>Profile</Sub>
<Data>L:/MSW_TOOLS/ROU/PROFILE</Data>
</Node>
</Node>
<Node><Sub>CacheTune</Sub>
<Data>2003-04-24</Data>
</Node>
<Node><Sub>Client BS-Portal ver.4.</Sub>
<Data>5011</Data>
</Node>
<Node><Sub>Debug</Sub>
<Data>0</Data>
</Node>
<Node><Sub>DriveISS</Sub>
<Data>n:/InfoPortal/</Data>
</Node>
<Node><Sub>HADDV</Sub>
<Data>ADDV I QF=1&amp;(VGIN&apos;=7)&amp;($ZU(1,2)=&quot;&quot;) W !,&quot;Расшиpение таблицы томов...&quot; D ADDV^%ZAPM.ed.BSH G VGSLOT</Data>
</Node>
<Node><Sub>HFILE</Sub>
<Data><![CDATA[ R !,"File Name >: ",%FN D:%FN="??" FILE^%ZAPM.ed.BSDOS2 G QUIT:%FN="",P1:%FN="^",QUIT:%FN="^Q"!(%FN="^q")]]></Data>
</Node>
<Node><Sub>HNAME</Sub>
<Data>HNAME I $D(%BShNAME),&apos;$G(QF) S HNAME=%BShNAME K %BShNAME G HNAME+3</Data>
</Node>
<Node><Sub>INT^%SP</Sub>
<Data>INT NEW (%FTOTBLK,%TOTBLK,%VGI,%NOSHOW,%SPDBNA) I &apos;$D(%NOSHOW) S %NOSHOW=1</Data>
</Node>
<Node><Sub>INT^%SPmsm4</Sub>
<Data>INT NEW (%FTOTBLK,%TOTBLK,%VGI,%NOSHOW,VOLDBNA) I &apos;$D(%NOSHOW) S %NOSHOW=1</Data>
</Node>
<Node><Sub>LPT</Sub>
<Node><Sub>3</Sub>
<Data>135</Data>
</Node>
</Node>
<Node><Sub>RVG18</Sub>
<Data><![CDATA[ S:$G(%BSvgT)=$H %BSvg="" S:$D(%BSvg) VGNAME=%BSvg,%BSvgT=$H I '$D(%BSvg) W !!,"Enter Volume Group Name to be Mounted: " R VGNAME]]></Data>
</Node>
<Node><Sub>RVG8</Sub>
<Data><![CDATA[ G:$G(%BSvg,"?")="" RELSE S:$D(%BSrs) SYS=%BSrs I '$D(%BSrs) W !!,"Enter Remote System Name: " R SYS G:SYS=""!(SYS="^") RELSE]]></Data>
</Node>
<Node><Sub>SGDDB</Sub>
<Data>PROMPT K ^%ZAPM.ed.BS(&quot;SYSGEN&quot;)</Data>
</Node>
<Node><Sub>SYSGEN</Sub>
<Data></Data>
</Node>
<Node><Sub>Startup</Sub>
<Node><Sub>DBSizesAllowed</Sub>
<Data>8192</Data>
</Node>
<Node><Sub>DefaultPort</Sub>
<Data>1972</Data>
</Node>
<Node><Sub>DomainspaceMaster</Sub>
<Data>0,</Data>
</Node>
<Node><Sub>ErrorPurge</Sub>
<Data>30</Data>
</Node>
<Node><Sub>JobServers</Sub>
<Data>0</Data>
</Node>
<Node><Sub>LicenseServer</Sub>
<Data>127.0.0.1,4001</Data>
</Node>
<Node><Sub>Section Head</Sub>
<Data></Data>
</Node>
<Node><Sub>ShutdownTimeout</Sub>
<Data>300</Data>
</Node>
<Node><Sub>TempDirectory</Sub>
<Data>Temp</Data>
</Node>
<Node><Sub>WebServer</Sub>
<Data>ON,57772</Data>
</Node>
<Node><Sub>WebServerURLPrefix</Sub>
<Data></Data>
</Node>
<Node><Sub>maxconsolelogsize</Sub>
<Data>5</Data>
</Node>
<Node><Sub>start_0</Sub>
<Data>System~1~1</Data>
</Node>
<Node><Sub>start_1</Sub>
<Data>Process~1~1</Data>
</Node>
<Node><Sub>start_2</Sub>
<Data>Job~1~1</Data>
</Node>
<Node><Sub>start_3</Sub>
<Data>Callin~1~1</Data>
</Node>
<Node><Sub>stu</Sub>
<Data>1</Data>
</Node>
<Node><Sub>zstu</Sub>
<Data>1</Data>
</Node>
</Node>
<Node><Sub>Telnet</Sub>
<Node><Sub>DNSLookup</Sub>
<Data>OFF</Data>
</Node>
<Node><Sub>Port</Sub>
<Data>23</Data>
</Node>
<Node><Sub>Section Head</Sub>
<Data></Data>
</Node>
</Node>
<Node><Sub>VER</Sub>
<Data>3.0.10</Data>
</Node>
<Node><Sub>login</Sub>
<Node><Sub>BS</Sub>
<Data>PQIAAA|%SYS|^%ZAPM.ed.BSC|0,0</Data>
</Node>
</Node>
</Node>
</Global>


<Routine name="%ZAPM.ed.BS" type="MAC" languagemode="0"><![CDATA[
%BS ///9.1553 от 1993 - 2007-08-29
 new
 I $ZV["Cach"||($ZV["IRIS") G ^%ZAPM.ed.BSC ;;;;;Cache' from InterSystems
 I '$D(^%ZAPM.ed.BSinFL) W /BEL,!,"Комплекс установлен с ошибками ! Повторим инсталляцию ? <N> " R *Y S:Y=13 Y=78 S:"Yy"[$C(Y) ^%ZAPM.ed.BS=600 Q  ;D SELF^%ZAPM.ed.BSMENU
 I $ZV["MSM for Windows NT" q
AL L  S %zT=$ZT,$ZT="ALLERR^%ZAPM.ed.BS1" D  S $ZT=$G(%zT) L  Q
 .L +@("%BSj"_$J)
 .D Registr^%ZAPM.ed.BSX(1),Z,DelKills^%ZAPM.ed.BSX
SRV(I) N B ;
 S B="^["""_$P($ZU(1,I),",")_""","""_$P($ZU(1,I),",",2)_"""]BSdirddp"
 I $$Data^%ZAPM.ed.BSF12(B),$$RP^%ZAPM.ed.BSGCH(B)="" S ^%ZAPM.ed.BSbufB("fT"_$G(%BS(3),$P)_$J_"u"_%BS(15),2,j)="@@1@9@@@@@1@@@@@@ rem-"_$P($P($G(@B,"???"),"@",2),",",2)
 E  S ^%ZAPM.ed.BSbufB("fT"_$G(%BS(3),$P)_$J_"u"_%BS(15),2,j)="@@1@9@@@@@1@@@@@@ loc-"_$P($ZU(1,0),",",2)
 Q
Z I $G(%BSenter) W " НОВЫЙ ПРОЦЕСС %BS ЗАПРЕЩЕН ",$$bel^%ZAPM.ed.BS3 H 2 S $ZT=$G(%zT) Q
 N %BSenter K (%zT) ;# U 0:(0::::#10080)
VER I $ZV'["Windows",$P($ZV,"Version ",2)<+^%ZAPM.ed.BS("VER") S ls=" ДЛЯ %BS V "_^%ZAPM.ed.BS_" нужна версия MSM "_^%ZAPM.ed.BS("VER")_" и выше " D O^%ZAPM.ed.BSF7 Q
0 D CLr^%ZAPM.ed.BSF4,REC^%ZAPM.ed.BSF12,GLKL^%ZAPM.ed.BS1 F  R *R:0 E  Q
 I $G(^%ZAPM.ed.BSS("XECUTE","KEY"))'="" D XEC^%ZAPM.ed.BSF10($$KBD^%ZAPM.ed.BSF12("^%ZAPM.ed.BSS(""XECUTE"")"),0)
 D PPP^%ZAPM.ed.BS1 I 'YES D:$G(%BS(24,1))'="" REGB^%ZAPM.ed.BSMSMF G EXIT ;РЕГИСТРАЦИЯ
 D WORKGRP^%ZAPM.ed.BS1 ;РАБОЧАЯ ГРУППА И КОМЕНТАРИЙ
 S %BSenter=1 D:$G(%BS(24,1))'="" REGO^%ZAPM.ed.BSMSMF
 I $$VAR^%ZAPM.ed.BSH ;ПЕРЕМЕННЫЕ
 ;ВЫПОЛНЕНИЕ MSM
 I $G(^%ZAPM.ed.BSS("XECUTE","KEY"))'="" D XEC^%ZAPM.ed.BSF10($$KBD^%ZAPM.ed.BSF12("^%ZAPM.ed.BSS(""XECUTE"")"),1)
 ;ВКЛЮЧЕНИЕ АРМА
 I %BS(12)'="",$G(@%BS(18)@(%BS(37),0,"7,4"))'="" S i=@$ZR,ii=$$KBD^%ZAPM.ed.BSF12("^%ZAPM.ed.BSS(""ARM"")") I $$Data^%ZAPM.ed.BSF12(ii) I $G(@ii@(i,"5,4"))'="" S i=@$ZR D ARM^%ZAPM.ed.BSTT(i),MGR G EXIT
 D WAIT^%ZAPM.ed.BSF2 G UCI:$$ZU^%ZAPM.ed.BS3(0)=$$ZU^%ZAPM.ed.BS3(1,0),RAZD
MGR I $ZV["Cach"||($ZV["IRIS") D  Q
 .I $$ZU^%ZAPM.ed.BSF4("%SYS")
 ;V 2:$J:1:2
 Q
UCI S MRMR="W /CUP(23,1),/EL(0),$$clr^%ZAPM.ed.BS3(4),""   <Enter>-ВЫБОР  <F6>-СЕРВИС  <F7>-ПОИСК  <F9>-СИСТЕМА-%BS  <Esc>-ОТМЕНА    """
 S %uCI=$V(2,$J,2) D MGR
 S BSR="^%ZAPM.ed.BSbufB",BST="fT"_$G(%BS(3),$P)_$J_"u"_%BS(15) I $D(@(BSR_"(BST,""STA"")")) D STA^%ZAPM.ed.BST G UCIE
 K ^%ZAPM.ed.BSbufB("fT"_$G(%BS(3),$P)_$J_"u"_%BS(15)),^%ZAPM.ed.BSbufB("uCI"_$G(%BS(3),$P)_$J_"u"_%BS(15)) S i=-1,YES=1
 F I=0:1:7 I $ZU(1,I)'="" S i=i+1,(%BS(8,i),^%ZAPM.ed.BSbufB("uCI"_$G(%BS(3),$P)_$J_"u"_%BS(15),i))=$P($ZU(1,I),",",2) D VOL^%ZAPM.ed.BSH(@$ZR,i) G EXIT:'YES F J=1:1 Q:$ZU(J,I)=""  S ^%ZAPM.ed.BSbufB("uCI"_$G(%BS(3),$P)_$J_"u"_%BS(15),i,J)=$P($ZU(J,I),",")
 S j=0,(se,ke)=0 F I=0:1 Q:'$D(^%ZAPM.ed.BSbufB("uCI"_$G(%BS(3),$P)_$J_"u"_%BS(15),I))  S %BS("Tmp",1)=^%ZAPM.ed.BSbufB("uCI"_$G(%BS(3),$P)_$J_"u"_%BS(15),I) D
 .I %BS(12)'="",'$D(@%BS(18)@(%BS(37),"*")),'$D(@%BS(18)@(%BS(37),%BS("Tmp",1))) Q
 .S j=j+1,^%ZAPM.ed.BSbufB("fT"_$G(%BS(3),$P)_$J_"u"_%BS(15),1,j)="@@1@9@@@@"_$S(I=0:0,1:"1,1")_"@1@"_$P(%BS,"!",4)_"@@@@@"_I
 .S i=2 F J=1:1 Q:'$D(^%ZAPM.ed.BSbufB("uCI"_$G(%BS(3),$P)_$J_"u"_%BS(15),I,J))  D  ;по кипам
 ..I J=1 D SRV(I)
 ..I %BS(12)'="",'$D(@%BS(18)@(%BS(37),"*")),'$D(@%BS(18)@(%BS(37),%BS("Tmp",1),"*")),'$D(@%BS(18)@(%BS(37),%BS("Tmp",1),^%ZAPM.ed.BSbufB("uCI"_$G(%BS(3),$P)_$J_"u"_%BS(15),I,J))) Q
 ..S i=i+1,^%ZAPM.ed.BSbufB("fT"_$G(%BS(3),$P)_$J_"u"_%BS(15),i,j)="@@1@9@@@@"_$S(J=1&(I=0):0,1:"3,1")_"@1@"_$P(%BS,"!",5)_"@@@@@"_I_","_J
 ..S:se<i se=i S:ke<j ke=j
 I $G(%BS(23)),%BS(12)'="" D DDPVOL^%ZAPM.ed.BSD1
 I se=0 S ls=" НЕТ ДОСТУПНЫХ КИПов ! " D O^%ZAPM.ed.BSF7 G EXIT
 S ^%ZAPM.ed.BSbufB("fT"_$G(%BS(3),$P)_$J_"u"_%BS(15))="@@@@@@@1@1@22@80@@X MRMR@@TBD^%ZAPM.ed.BSF4@1@1@@3,1@@@@@@1"
 S ^%ZAPM.ed.BSbufB("fT"_$G(%BS(3),$P)_$J_"u"_%BS(15),"FTR",1,1)="S d1=""·±­""_d_"" ""_^%ZAPM.ed.BSbufB(""uCI""_$G(%BS(3),$P)_$J_""u""_%BS(15),d)"
 S ^%ZAPM.ed.BSbufB("fT"_$G(%BS(3),$P)_$J_"u"_%BS(15),"FTR",2,1)="S d1="" -=§ ""_d_"" """_$S(%BS(17)<0:"",1:" D Comnt^%ZAPM.ed.BS2(d)")
 S ^%ZAPM.ed.BSbufB("fT"_$G(%BS(3),$P)_$J_"u"_%BS(15),"FTR",3,1)="S d1=""·±­· ""_^%ZAPM.ed.BSbufB(""uCI""_$G(%BS(3),$P)_$J_""u""_%BS(15),$P(d,"",""),$P(d,"","",2))"_$S(%BS(17)<0:"",1:" D Comnt^%ZAPM.ed.BS2(d)")
 S ^%ZAPM.ed.BSbufB("fT"_$G(%BS(3),$P)_$J_"u"_%BS(15),"AF2")="^%ZAPM.ed.BSS,ALTF2",$P(^%ZAPM.ed.BSbufB("fT"_$G(%BS(3),$P)_$J_"u"_%BS(15)),"@",39)="^%ZAPM.ed.BSHLP,MAIN",$P(@$ZR,"@",41)="AF10^%ZAPM.ed.BSF12"
 D RESZER^%ZAPM.ed.BSF2,TAB^%ZAPM.ed.BSF1,^%ZAPM.ed.BST
UCIE K %BS("Tmp",3),%BS("Tmp",4)
 I $D(TABLfind) G TAB
 I $D(NEWVOLUM) K NEWVOLUM,^%ZAPM.ed.BSbufB("fT"_$G(%BS(3),$P)_$J_"u"_%BS(15)) G UCI
 I R1=27!(ny<3)!(d="") G EXIT
 I $D(%BS(8,+d)) D UCI^%ZAPM.ed.BSH(%BS(8,+d),+d) G EXIT:'YES S %VGI=+d D CKD^%ZAPM.ed.BSF5(+d)
 I d?3A S %BS("Tmp",3)=d,%BS("Tmp",4)=$P(@BSR@(BST,1,nx),"@",15)
 I '$D(%BS("Tmp",4)) V 2:$J:+$P(d,",")*32+$P(d,",",2):2
 K ^%ZAPM.ed.BSbufB("R"_$G(%BS(3),$P)_$J_"u"_%BS(15)),^%ZAPM.ed.BSbufB("BUF"_$G(%BS(3),$P)_$J_"u"_%BS(15))
 S BSbufR="@@1@77@@@@@1@"_$P(%BS,"!",4)_"@@@@@·­±.. "_$S($D(%BS("Tmp",4)):%BS("Tmp",3)_","_%BS("Tmp",4),1:$$ZU^%ZAPM.ed.BS3(0))_"        ;   Комментарии к разделам"_$S($D(%BS("Tmp",4)):" DDP",1:"")
RAZD ;ВЫБОР РАЗДЕЛА
 I $G(^%ZAPM.ed.BSS("XECUTE","KEY"))'="" D XEC^%ZAPM.ed.BSF10($$KBD^%ZAPM.ed.BSF12("^%ZAPM.ed.BSS(""XECUTE"")"),2)
 I '$D(%BS("Tmp",4)) S MRMR="W /CUP(23,1),/EL(0),$$clr^%ZAPM.ed.BS3(4),"" <Enter>-ВЫБОР <F4>-КОМЕНТАРИЙ <F5>-ПРИЛОЖ <F6>-СЕРВИС <F7>-ПОИСК <F8>-УДАЛИТЬ """,i=2
 E  S MRMR="W /CUP(23,1),/EL(0),$$clr^%ZAPM.ed.BS3(4),"" <Enter>-ВЫБОР                   сетевые разделы                 <Esc>-ОТМЕНА  """,i=1,%BS("Tmp",6)=$$DDPGLO^%ZAPM.ed.BSD1(%BS("Tmp",3)_","_%BS("Tmp",4))
 S BSR="^%ZAPM.ed.BSbufB",BST="R"_$G(%BS(3),$P)_$J_"u"_%BS(15) I $D(@(BSR_"(BST,""STA"")")) D STA^%ZAPM.ed.BST G RAZDE
 S %NAM="^",^%ZAPM.ed.BSbufB("R"_$G(%BS(3),$P)_$J_"u"_%BS(15),1,1)=$G(BSbufR,"@@1@77@@@@@1@1;6;80;45@@@@@·­±.. "_$S($D(%BS("Tmp",4)):%BS("Tmp",3)_","_%BS("Tmp",4),1:$$ZU^%ZAPM.ed.BS3(0))_"        ;   Комментарии к разделам")
 I i=2 S ^%ZAPM.ed.BSbufB("R"_$G(%BS(3),$P)_$J_"u"_%BS(15),2,1)="@@1@77@@@@@1@"_$P(%BS,"!",5)_"@@@@@·­± ^новый Раздел ;"
 I %BS(23),'$D(%BS("Tmp",3)),'$D(^BSdirddp) D NEWDIR^%ZAPM.ed.BSD1
 S %BS("Tmp",1)=$S('$D(%BS("Tmp",3)):$P($$ZU^%ZAPM.ed.BS3(0),",",2),1:1),%BS("Tmp",2)=$S('$D(%BS("Tmp",3)):$P($$ZU^%ZAPM.ed.BS3(0),","),1:%BS("Tmp",3)_","_%BS("Tmp",4)),%BS("Tmp",5)=$S($$ver^%ZAPM.ed.BSF9(2)="]":2,1:3)_$$ver^%ZAPM.ed.BSF9(2)
RAZPR F  S %NAM=$$O^%ZAPM.ed.BSD1(%NAM) Q:%NAM=""  D
 .I $E(%NAM,1,4)="^%ZAPM.ed.BS",'$$ADMIN() Q
 .S i=i+1,^%ZAPM.ed.BSbufB("R"_$G(%BS(3),$P)_$J_"u"_%BS(15),i,1)="@@1@77@@@@@1@"_$P(%BS,"!",5)_"@@@@@·­± "_%NAM_$J("",$S($D(%BS("Tmp",3)):23,1:14)-1-$L(%NAM))_" ;"_$P($G(@%NAM),"@",2)
 S ^%ZAPM.ed.BSbufB("R"_$G(%BS(3),$P)_$J_"u"_%BS(15))="@@@@@@@1@1@22@80@@X MRMR@@%FKR^%ZAPM.ed.BS2@1@1@@@@@@@@1",se=i,ke=1
 S ^%ZAPM.ed.BSbufB("R"_$G(%BS(3),$P)_$J_"u"_%BS(15),"AF2")="^%ZAPM.ed.BSS,ALTF2",$P(^%ZAPM.ed.BSbufB("R"_$G(%BS(3),$P)_$J_"u"_%BS(15)),"@",39)="^%ZAPM.ed.BSHLP,MAIN1",$P(@$ZR,"@",41)="AF10^%ZAPM.ed.BSF12"
 D TAB^%ZAPM.ed.BSF1,^%ZAPM.ed.BST
RAZDE I $D(%BS(8)),$D(%VGI),$D(%BS(8,%VGI)) D UCI^%ZAPM.ed.BSH(%BS(8,%VGI),%VGI) G EXIT:'YES
 I $D(TABLfind) G TAB
 I R1=27!(ny=1) K ^%ZAPM.ed.BSbufB("R"_$G(%BS(3),$P)_$J_"u"_%BS(15)) S R1=27 G UCIE:$D(BSMGR) G UCI
 I ny=2,'$D(%BS("Tmp",3))  G:$D(IntBSD) RAZD S li="" D NEWRAZD^%ZAPM.ed.BS1 I '$D(HIDDR) K ^%ZAPM.ed.BSbufB("R"_$G(%BS(3),$P)_$J_"u"_%BS(15)) G RAZD
 S %NAM=$P(d," ",2) K HIDDR
TAB ;ВЫБОР ТАБЛИЦЫ
 I $G(^%ZAPM.ed.BSS("XECUTE","KEY"))'="" D XEC^%ZAPM.ed.BSF10($$KBD^%ZAPM.ed.BSF12("^%ZAPM.ed.BSS(""XECUTE"")"),3)
 K %BS("Tmp","EXIToutBD"),%BS(9),Pddp
 S MRMR="W /CUP(23,1),/EL(0),$$clr^%ZAPM.ed.BS3(4),"" <Enter>-ВЫБОР <F4>-КОМЕН <F5>-КОПИР <F7>-ПОИСК <F8>-УДАЛИТЬ <F9>-ИНФО """ K EXITout,TABLfind S Ii=$S($G(%NAM)["%BSbufS":79,1:77)
 S Pddp=$S($D(%BS("Tmp",3)):$P(%NAM,$E(%BS("Tmp",5),2),+%BS("Tmp",5)),1:$P(%NAM,"^",2))
 S BSR="^%ZAPM.ed.BSbufB",BST="T"_$G(%BS(3),$P)_$J_"u"_%BS(15) 
 I $D(@(BSR_"(BST,""STA"")")) D STA^%ZAPM.ed.BST,BS2 G TABE
 S %TAB="",i=1 K ^%ZAPM.ed.BSbufB("T"_$G(%BS(3),$P)_$J_"u"_%BS(15)),SPSV S ^%ZAPM.ed.BSbufB("T"_$G(%BS(3),$P)_$J_"u"_%BS(15),1,1)="@@1@"_Ii_"@@@@@1@"_$P(%BS,"!",4)_"@@@@@·­±.. "_%NAM_$J("",9-$L(%NAM)+Ii-77)_"        ; ТИП  ;   Комментарии к таблицам"
 S:Ii'=79 ^%ZAPM.ed.BSbufB("T"_$G(%BS(3),$P)_$J_"u"_%BS(15),2,1)="@@1@"_Ii_"@@@@@1@"_$P(%BS,"!",5)_"@@@@@·­± ~new table    "_$J("",Ii-77)_" ;      ;",i=i+1
 S Iii=i,Tmp1=1,Tmp2=2 I $D(%BS("Tmp",4)) S Tmp1=4,Tmp2=3
 F  S %TAB=$O(@%NAM@(%TAB)) Q:%TAB=""  X $G(WA) I %TAB'["@"&(%TAB'[$G(HIDD,"&"))&('$P($G(@%NAM@(%TAB)),"@",42)) K Tmp3 D
 .I '$D(IntBS),%BS(12)'="",'$D(@%BS(18)@(%BS(37),"*")),'$D(@%BS(18)@(%BS(37),%BS("Tmp",Tmp1),"*")),'$D(@%BS(18)@(%BS(37),%BS("Tmp",Tmp1),%BS("Tmp",Tmp2),"*")) D  Q:$D(Tmp3)
 ..I '$D(@%BS(18)@(%BS(37),%BS("Tmp",Tmp1),%BS("Tmp",Tmp2),Pddp,"*")),'$D(@%BS(18)@(%BS(37),%BS("Tmp",Tmp1),%BS("Tmp",Tmp2),Pddp,%TAB)) S Tmp3=1 Q
 .I Ii=79 D  S i=i+1,^%ZAPM.ed.BSbufB("T"_$G(%BS(3),$P)_$J_"u"_%BS(15),i,1)="@@1@"_Ii_"@@@@"_Iii_",1@1@"_$P(%BS,"!",5)_"@@@@@·­± ~"_IIi_" .......;"_%3_";"_$P($G(@%NAM@(%TAB)),"@") Q
 ..S IIi=%TAB I %TAB["^[" S IIi=$E(%TAB,4,6)_":"_$E(%TAB,10,12)_":"_$P(%TAB,"]",2,99)
 ..S %3=$S($P($G(@%NAM@(%TAB)),"@",24)="S":"СписоК",$P($G(@$ZR),"@")["ГОТОВ":"СводкА",1:"      ")
 .I $ZV'["Cach"&&($ZV'["IRIS") Q:%TAB["."
 .S %3=$$TIP($P($G(@%NAM@(%TAB)),"@",17)) S i=i+1,^%ZAPM.ed.BSbufB("T"_$G(%BS(3),$P)_$J_"u"_%BS(15),i,1)="@@1@"_Ii_"@@@@3,1@1@"_$P(%BS,"!",5)_"@@@@@·­± ~"_%TAB_$J("",18-$L(%TAB)-8+Ii-77)_" .......;"_%3_";"_$P($G(^(%TAB),"!???!"),"@")
 K HIDD,IIi,Ii,Iii
 S ^%ZAPM.ed.BSbufB("T"_$G(%BS(3),$P)_$J_"u"_%BS(15))="@@@@@@@1@1@22@80@@X MRMR@@%FKT^%ZAPM.ed.BS2@1@1@@@@@@@@1",$P(@$ZR,"@",41)="AF10^%ZAPM.ed.BSF12",se=i,ke=1
 S ^%ZAPM.ed.BSbufB("T"_$G(%BS(3),$P)_$J_"u"_%BS(15),"AF2")="^%ZAPM.ed.BSS,ALTF2",$P(^%ZAPM.ed.BSbufB("T"_$G(%BS(3),$P)_$J_"u"_%BS(15)),"@",39)="^%ZAPM.ed.BSHLP,MAIN2" D TAB^%ZAPM.ed.BSF1
 I $G(^%ZAPM.ed.BSS("XECUTE","KEY"))'="" D XEC^%ZAPM.ed.BSF10($$KBD^%ZAPM.ed.BSF12("^%ZAPM.ed.BSS(""XECUTE"")"),4)
 D ^%ZAPM.ed.BST
TABE I $D(%BS(8)),$D(%VGI),$D(%BS(8,%VGI)) D UCI^%ZAPM.ed.BSH(%BS(8,%VGI),%VGI) Q:$D(IntBS)  G EXIT:'YES
 I $D(TABLfind) G TAB
 I R1=27!(ny=1) K ^%ZAPM.ed.BSbufB("T"_$G(%BS(3),$P)_$J_"u"_%BS(15)) Q:$D(IntBS)  G RAZD
 I ny=2,%NAM'["%BSbufS" G:$D(IntBSD) TAB  S li="" D NEWTAB^%ZAPM.ed.BS1 I $G(d)'["&" K ^%ZAPM.ed.BSbufB("T"_$G(%BS(3),$P)_$J_"u"_%BS(15)) G TAB
 S BSR=%NAM,BST=$P($P(d,"~",2)," ") I BST'[$C(68,69,77,79,78,83,84,82),($G(^%ZAPM.ed.BSR("KEY"))'=$$PW^%ZAPM.ed.BS1(3)) D DE^%ZAPM.ed.BS1 G TAB
 I BSR'[$C(68,69,77,79,78,83,84,82),($G(^%ZAPM.ed.BSR("KEY"))'=$$PW^%ZAPM.ed.BS1(5)) D DE^%ZAPM.ed.BS1 G TAB
 I %NAM["%BSbufS",BST[":" I $ZV'["Cach"&&($ZV'["IRIS") S BST="^["""_$P(BST,":")_""":"""_$P(BST,":",2)_"""]"_$P(BST,":",3,99)
 I $D(IntBSD) Q
 I $D(@(BSR_"(BST,""STA"")")) D STA^%ZAPM.ed.BST,BS2 G TAB
 D ^%ZAPM.ed.BST,BS2 G TAB
BS2 S:'%BS(2) %BS(2)=99 Q
PRO I $ZE["<PROT" S $ZT="PRO^%ZAPM.ed.BS" G RAZPR
 S ls=$ZE D O^%ZAPM.ed.BSF7 G RAZPR
D G 0^%ZAPM.ed.BSTM
EXIT I $D(IntBSD) K BSR,BST Q
 D OP^%ZAPM.ed.BSF4
 D GLKL^%ZAPM.ed.BS1 K (%BS) W /CUP(1,1),/ED(2) D:$G(%BS(24,1))'="" REGE^%ZAPM.ed.BSMSMF
 W $J("Сегодня: ",55),$$WEEKEND^%ZAPM.ed.BSsFUNR(1,$$h^%ZAPM.ed.BS3()),"  ",$$ESDAY^%ZAPM.ed.BSsFUNR(6,$$h^%ZAPM.ed.BS3()) I $G(%BS(43))="" D SAY^%ZAPM.ed.BS3(0)
 Q
COPY I %B=3 S %zT=$ZT,$ZT="ERR^%ZAPM.ed.BSS1" D Buf^%ZAPM.ed.BSF12 S $ZT=$G(%zT) G D
 I %B=2 S %zT=$ZT,$ZT="ERR^%ZAPM.ed.BSS1" D REST^%ZAPM.ed.BSS1 S $ZT=$G(%zT) G D:'$D(%FN) K %FN,%DEV S R1=27 Q
 I %B=1 K %FN,%DEV S PR1="",%zT=$ZT,$ZT="ER^%ZAPM.ed.BSS1" D  S $ZT=$G(%zT) G:'$D(%FN) D C %DEV K %DEV,%FN,%DIAP G 71^%ZAPM.ed.BSF5
 .I $D(%DIA) S do="I i>2 S %TAB=$P($P($P(^(j),""@"",15),""~"",2),"" "") D COPY^%ZAPM.ed.BSS1" D BLOK^%ZAPM.ed.BSF1 Q
 .D COPY^%ZAPM.ed.BSS1 Q
DEL(%NAM,%TAB) N i,j,ZR,G I $ZV'["Cach"&&($ZV'["IRIS"),%NAM["%BSbufS",%TAB[":" S %TAB="^["""_$P(%TAB,":")_""":"""_$P(%TAB,":",2)_"""]"_$P(%TAB,":",3,99)
 Q:$P($P($G(@%NAM@(%TAB)),"@",30),"i")'=""  D PASE^%ZAPM.ed.BS1 I '$D(%w(4)) Q
 D L^%ZAPM.ed.BS3($NA(@%NAM@(%TAB))) Q:'LOC  D  D U^%ZAPM.ed.BS3($NA(@%NAM@(%TAB))) Q
 .I %TAB'[("D"_"EM"_"O"_"N"_"STR")&($G(^%ZAPM.ed.BSR("KEY"))'=$$PW^%ZAPM.ed.BS1(2)) D DE^%ZAPM.ed.BS1 Q
 .Q:'YES  D YE Q:'YES  D:'$E(%BS(1),16) KillTab^%ZAPM.ed.BSF12 D DEL^%ZAPM.ed.BSF10($NA(@(%NAM_"(%TAB)")),1) S R1=27,ny=1,%TAB="@"_%TAB D DEL^%ZAPM.ed.BSF10($NA(@(%NAM_"(%TAB)")),1) S %TAB=$E(%TAB,2,99) Q
TIP(%3) Q " "_$S(%3=1:"TABL",%3=2:"BSDT",%3=3:"LIST",%3=4:"SUMM",%3=5:"TEXT",%3=6:"LINK",%3=7:"MENU",%3=8:"BUTT",%3=9:"FAST",%3=11:"DIAL",%3=10:"RPRT",1:"!!!!")_" "
TIPP(%3) Q $S(%3["BaSe MsW":"PART",%3["BSD - MSW":"BASE",%3["%BS-invert-":"KDFK",%3["%BS-dinamo-":"MKZP",%3["%BS-index-":"INDX",1:"????")
YE I '$D(%DIA) S ls=" УДАЛЯЕМ ТАБЛИЦУ "_%NAM_","_%TAB_" !!! ВЫ УВЕРЕНЫ ? ",%B=2 W $$bel^%ZAPM.ed.BS3 D YES^%ZAPM.ed.BSF Q
 ;I $D(%DIA),'$G(AllWAY) D Yes^%ZAPM.ed.BSXfun("УДАЛЯЕМ ТАБЛИЦУ "_%NAM_","_%TAB_". Удалять С ПОДТВЕРЖДЕНИЕМ !!!",1) Q:YES<0  I 'YES D Yes^%ZAPM.ed.BSXfun(" ВЫ УВЕРЕНЫ ? Удалять ВСЕ ПОМЕЧЕННЫЕ ТАБЛИЦЫ БЕЗ ПОДТВЕРЖДЕНИЯ !",1) Q:YES<1  S AllWAY=1
 I $D(%DIA),'$G(AllWAY) D MENU^%ZAPM.ed.BSF5(" УДАЛИТЬ НЕ_УДАЛЯТЬ УДАЛИТЬ_ВСЕ_СРАЗУ ВЫХОД ","  ТАБЛИЦУ "_%NAM_","_%TAB,1) D  Q:'YES  S:%B=3 AllWAY=1 I %B=4 S EndLoop=1,YES=0 Q
 .I (R1=27&(R2=-1))!(%B=2) S YES=0
 Q
ADMIN() ;ПОЛЬЗОВАТЕЛЬ - АДМИНИСТРАТОР ?
 I %BS(12)'="",$D(@%BS(18)@(%BS(37),"3")) Q 1
 Q 0
 // for  do $$r^%ZAPM.ed.BSC(999) if R1=13 quit
r(R) O 0:(:"IS")
 R *R1:R,*R2:0,*R3:0,*R4:0,*R5:0 
 w !,"==="_R1_" "_R2_" "_R3_" "_R4_" "_R5,!
 q 1

]]></Routine>


<Routine name="%ZAPM.ed.BS1" type="MAC" languagemode="0"><![CDATA[
%BS1 ;ВХОД II ; 11:05   31.08.2000
 Q
WORKGRP S %BS(37)=%BS(12) I %BS(12)'="",%BS(18)'="" D  ;РАБОЧАЯ ГРУППА И КОМЕНТАРИЙ
 .I $G(@%BS(18)@(%BS(12),0,"9,4"))'="" S %BS(37)=@$ZR
 .S %BS(38)=$G(@%BS(18)@(".@WHO",%BS(12)))
 .I $O(@%BS(18)@(%BS(37),4,0,""))'="" S %BS(1)=$O(@%BS(18)@(%BS(37),4,0,""))
 Q
ADM(V,T) I T'="ADM",T=V Q 1
 I T="ADM",$$LITL^%ZAPM.ed.BSsFUNM(V)=$$LITL^%ZAPM.ed.BSsFUNM($P($G(^%ZAPM.ed.BSETUP("SETUP",9,2),$G(^%ZAPM.ed.BSS("SETUP",9,2))),"@",15)) Q 1
 Q 0
W I I'=$$PW(1) S ls=" КЛЮЧ НЕ ПРАВИЛЬНЫЙ " D O^%ZAPM.ed.BSF7 H
 I I=$$PW(1) D NMA S ls=" ALL RIGHT !!! " D O^%ZAPM.ed.BSF7 H
 H
PASE S i1=1,YES=0 D PS^%ZAPM.ed.BSD1(%NAM) D  I uc="N" S ls=" Пользователю "_%BS(12)_" КОРРЕКТИРОВАТЬ ОП.ТАБ. НЕЛЬЗЯ ",YES=0 D O^%ZAPM.ed.BSF7 X "I 0" Q
 .I %BS(12)'="",'$D(@%BS(18)@(%BS(37),"*")),'$D(@%BS(18)@(%BS(37),%BS("Tmp",1),"*")),'$D(@%BS(18)@(%BS(37),%BS("Tmp",1),%BS("Tmp",2),"*")) D
 ..I '$D(@%BS(18)@(%BS(37),%BS("Tmp",1),%BS("Tmp",2),Pddp,"*")),$G(@%BS(18)@(%BS(37),%BS("Tmp",1),%BS("Tmp",2),Pddp,%TAB,"4,2"))="N" S uc="N"
 I $P($G(@%NAM@(%TAB),"@@@cthgfy"),"@",4)="" S %w(4)="",YES=1 Q
PS D RED W " Введите пароль коррекции Описания Таблицы:",%NAM,",",%TAB," ",$$bel^%ZAPM.ed.BS3 D CLE,CL R %w(4)#7 D CachOn I $$ADM(%w(4),$P($G(@%NAM@(%TAB),"@@@cthgfy"),"@",4)) S YES=1 Q
 S:%w(4)="" i1=4 D RED W " Пароль не верен ",$$bel^%ZAPM.ed.BS3 H 2 D CLE S i1=i1+1 G PS:i1<4 K %w(4) Q
PPP ;ПАРОЛЬ ВХОДА В %BS -------
 N IP,i1,%PPP,R,ls
 ;???I %BS(12)="" G PPA
 I '$D(@%BS(18)) G PPA
 I $ZO(@%BS(18))="" G PPA
 S IP="пользователя"
PPPP S i1=1,YES=0 D RED W " Введите имя ",IP,":",$$atr^%ZAPM.ed.BS3(0) R " ",R:20 Q:"^."[R  s R=$$BIGL^%ZAPM.ed.BSsFUNM(R)
PP W /CUP(25,1),/EL(0),$$clr^%ZAPM.ed.BS3(11)," А теперь пароль :",$$atr^%ZAPM.ed.BS3(0) D CL R %PPP#40 D CachOn I $$LITL^%ZAPM.ed.BSsFUNM(R)="adm",$$LITL^%ZAPM.ed.BSsFUNM(%PPP)=$$LITL^%ZAPM.ed.BSsFUNM($P($G(^%ZAPM.ed.BSETUP("SETUP",9,2),$G(^%ZAPM.ed.BSS("SETUP",9,2))),"@",15)) S YES=1,%BS(12)="" D REGSERV Q
 I $$LITL^%ZAPM.ed.BSsFUNM(%PPP)=$$LITL^%ZAPM.ed.BSsFUNM($G(@%BS(18)@(".@PASSWORD",R),"¤")) S YES=1,%BS(12)=R D REGSERV Q
 S ls=" Пароль не верен " D O^%ZAPM.ed.BSF7 Q
PPA S IP="Администратора",%BS(12)="" I $P($G(^%ZAPM.ed.BSETUP("SETUP",9,2),$G(^%ZAPM.ed.BSS("SETUP",9,2))),"@",15)="" Q
 G PPPP
RED W /CUP(24,1),/EL(0),$$clr^%ZAPM.ed.BS3(11) Q
CLE W $$atr^%ZAPM.ed.BS3(0) Q
CL I $ZV["MSM" D CL^%ZAPM.ed.BSF4 ;ВЫКЛ ЭХА
CachOff I $ZV["Cach"||($ZV["IRIS") O 0:(:"S") ;ВЫКЛ ПОБАЙТОВОГО ЧТЕНИЯ
 Q
CachOn I $ZV["Cach"||($ZV["IRIS") O 0:(:"IS") ;ВКЛ ПОБАЙТОВОГО ЧТЕНИЯ
 Q
REGSERV D Int^%ZAPM.ed.BSERV("S $P(@G@(""CMT"",S),""§"",2)="" %BS v.""_^%ZAPM.ed.BS,$P(@G@(""CMT"",S),""§"",3)="" User :""_%BS(12)")
 Q
PAROL set YES=1 ; D PASCHECK(%NAM,"",4," Введите пароль коррекции ХАРАКТЕРИСТИК РАЗДЕЛА:"_%NAM_" ","%PAROL") Q
 ;---
PASCHECK(MAS,TAB,PICE,SAY,VAR) N AAA S i1=1,YES=0 S MAS=MAS_$S(TAB="":"",1:"(TAB)")
 I $P($G(@MAS),"@",PICE)="ADM" S AAA="ADM:" I $$LITL^%ZAPM.ed.BSsFUNM($P($G(^%ZAPM.ed.BSETUP("SETUP",9,2),$G(^%ZAPM.ed.BSS("SETUP",9,2))),"@",15))="" S YES=1 Q
 D RED W $E($G(AAA)_$G(SAY),1,75),$$bel^%ZAPM.ed.BS3 D CLE,CL R @VAR#17 D CachOn I $$ADM(@VAR,$P($G(@MAS),"@",PICE)) S YES=1 Q
 S:@VAR="" i1=4 D RED W " Пароль не верен ",$$bel^%ZAPM.ed.BS3 H 2 D CLE S i1=i1+1 G PASCHECK+1:i1<4 K @VAR Q
 ;---
COM S ll="@",ls=" Вводите / Корректируйте коментарий (до 300 симв)" D LE^%ZAPM.ed.BSTT I 'YES S li="" Q
 S li=$E(li,1,300) Q
NEWTAB S ls="Имя новой таблицы(до 10 символов),Если начинается с &,то - Скрытая",ll="@ +;:#!$.,~^""()*'\/<>" D LE^%ZAPM.ed.BSTT I 'YES S li="" Q
 I li="" Q
 I li'["DEMONST"&($G(^%ZAPM.ed.BSR("KEY"))'=$$PW(1)) D DE G NEWTAB
 I $L(li)>10 S ls=" Длина больше 10 символов " D O^%ZAPM.ed.BSF7 G NEWTAB
 D PS^%ZAPM.ed.BSD1(%NAM) D  I uc="N" S ls=" Пользователю "_%BS(12)_" СОЗДАВАТЬ ТАБЛИЦУ "_li_" ЗАПРЕЩЕНО " D O^%ZAPM.ed.BSF7 G NEWTAB
 .I %BS(12)'="",'$D(@%BS(18)@(%BS(37),"*")),'$D(@%BS(18)@(%BS(37),%BS("Tmp",1),"*")),'$D(@%BS(18)@(%BS(37),%BS("Tmp",1),%BS("Tmp",2),"*")),'$D(@%BS(18)@(%BS(37),%BS("Tmp",1),%BS("Tmp",2),Pddp,"*")) G NEU
 .Q
NEU .I '$D(@%BS(18)@(%BS(37),%BS("Tmp",1),%BS("Tmp",2),Pddp,li)) S uc="N"
 I $D(@(%NAM_"(li)")),$E(li,1)="&"  G HIDDEN
 I li="&?MSW?&" S HIDD="@",d="" Q
 I $E(li,1)="&" S ls=" Таблица Будет СКРЫТАЯ . Вы Уверены ? " D YES^%ZAPM.ed.BSF I 'YES G NEWTAB
 I $D(@(%NAM_"(li)")) D OkMsg^%ZAPM.ed.BSXfun(" Уже существует ") S d="&~"_li Q
 K M S II=" СПИСОК СВОДКА ",TAB=li,(M(5,2),M(5,1))=" Создание списка или сводки на основе готовой БАЗЫ ДАННЫХ" D  S ls="ВЫБЕРИТЕ НОВУЮ ТАБЛИЦУ" D MEN^%ZAPM.ed.BSF5 K II,I1,M I 'YES S li="" G NEWTAB
 .F I=1:1:19 S li="N"_I I $D(@%BS(20)@(li)) S M(5,I+2)=$P(^(li),"@") S I1=li_" " Q:$L(II_I1)>78  S II=II_I1
 .S M(1,1)=II_"@6@ @0@5"
 G TIS^%ZAPM.ed.BSS2:%B=1!(%B=2) S BSr1=%BS(20),BSt1="N"_(%B-2),BSr2=%NAM,BSt2=TAB G COPY^%ZAPM.ed.BSTK
HIDDEN S d="~"_li Q
DE S ls=" В ДЕМОНСТРАЦИОННОЙ ВЕРСИИ ИСПОЛЬЗУЙТЕ ИМЕНА НАЧИНАЮЩИЕСЯ НА ""DEMONSTR"" " D O^%ZAPM.ed.BSF7 Q
NEWRAZD S ls=" Enter a name for the new partition ",ll="@ &()^{}[]=+-/.,,$#*!;:""~`\" D LE^%ZAPM.ed.BSTT I 'YES S li="" Q
 I li'[("D"_"E"_"M"_"O"_"NSTR")&($G(^%ZAPM.ed.BSR("KEY"))'=$$PW(2)) D DE G ERR
 S %zT=$ZT,$ZT="ERR^%ZAPM.ed.BS1"
  S:li'["^" li="^"_li 
  I $D(@li) G:$P($G(@li),"@",3)'=""&($P($G(@li),"@")["BaSe MsW ") HH G:$P($G(@li),"@")'["BaSe MsW " NQM S ls=" Раздел "_li_" Уже существует " D O^%ZAPM.ed.BSF7 G NEWRAZD
NEWR S @li="",%NAM=li D PS^%ZAPM.ed.BSD1(%NAM) D  I uc="N" S ls=" Пользователю "_%BS(12)_" СОЗДАВАТЬ РАЗДЕЛ "_li_" НЕЛЬЗЯ " D O^%ZAPM.ed.BSF7 G NEWRAZD
 .I %BS(12)'="",'$D(@%BS(18)@(%BS(37),"*")),'$D(@%BS(18)@(%BS(37),%BS("Tmp",1),"*")),'$D(@%BS(18)@(%BS(37),%BS("Tmp",1),%BS("Tmp",2),"*")),'$D(@%BS(18)@(%BS(37),%BS("Tmp",1),%BS("Tmp",2),Pddp)) S uc="N"
 D PAROL^%ZAPM.ed.BSF4 S ls=" Let's make the partition hidden ? ",HIHI="",%B=2 
 D YES^%ZAPM.ed.BSF I YES S HIHI="S"
 S $ZT=$G(%zT),@%NAM="BaSe MsW @@"_HIHI_"@"_$G(%PAROL) ;D CP^%ZAPM.ed.BSGCH(%NAM,$P(%BS(22),",")) 
 K %PAROL,HIHI Q
25 W /CUP(25,1),$$atr^%ZAPM.ed.BS3(0),/EL(0),ls Q
HH S HIDDR=1,d=" "_li Q
NQM I $G(@li)="" D Yes^%ZAPM.ed.BSXfun("Массив "_li_" Чужой !!! Будем из него делать раздел ?",2) G NEWRAZD:'YES,NEWR
 D ErrMsg^%ZAPM.ed.BSXfun("Массив "_li_" Чужой !!!") G NEWRAZD
ERR S ls="Не корректное имя,(до 8 лат.букв и цифр)"_$ze D O^%ZAPM.ed.BSF7 S $ZT=$G(%zT) G NEWRAZD
 Q
PW(pi) Q $G(^%ZAPM.ed.BSR("KEY"))  ;~~~Q $$WP($E(^%ZAPM.ed.BSR(1,18),95)_$E(^(18),97)_$E(^(18),99)_$E(^(18),101)_$E(^(18),103)_$E(^(18),105),$ZV,$$ZU^%ZAPM.ed.BS3(1,0))
WRITE W ! F I=95:2:105 W $E(^%ZAPM.ed.BSR(1,18),I)
 W !,$ZV,!,$$ZU^%ZAPM.ed.BS3(1,0) Q
NMA S ^%ZAPM.ed.BSR("KEY")=$$PW(4) D  G CONF^%ZAPM.ed.BSH
 .;~~~S I=" WORK ",i=121 F ii=1:1:6 S $E(^%ZAPM.ed.BSR(1,18),i)=$E(I,ii),i=i+2
END D ENDS,ENDK Q
ENDS N ENDDN,I,BSI,es1 K es S I=0,es1=$P($G(%TIT,1),",") F BSI=se:-1:1 Q:BSI=""  I $D(@(BSR_"(BST,BSI,ke)")) D  I $D(ENDDN) S es=BSI+1 Q
 .I ($P(^(ke),"@",3)+I-1)>(BSY2(BS0)-BSY1(BS0)) S ENDDN=1
 .S I=I+$P(^(ke),"@",3)
 I $D(es),es<es1 S es=es1
 I '$D(es) S es=es1
 Q
ENDK N ENDRI,I,BSII,ek1 K ek S I=0,ek1=$P($G(%TIT,"1,1"),",",2) F BSII=ke:-1:1 Q:BSII=""  I $D(@(BSR_"(BST,se,BSII)")) D  I $D(ENDRI) S ek=BSII+1 Q
 .I ($P(^(BSII),"@",4)+I-1)>(BSX2(BS0)-BSX1(BS0)) S ENDRI=1
 .S I=I+$P(^(BSII),"@",4)
 I $D(ek),ek<ek1 S ek=ek1
 I '$D(ek) S ek=ek1
 Q
WP(pw,pv,pu) S pi=($E(pw,4)*$A($E(pv,$L(pv)-3))*$A($E(pu,2)))+($E(pw,5)*$A($E(pv,$L(pv)-5))*$A($E(pu,6)))
 Q ($E(pw,1)*$A($E(pv,$L(pv)))*$A($E(pu,3)))+($E(pw,2)*$A($E(pv,$L(pv)-2))*$A($E(pu,1)))+($E(pw,3)*$A($E(pv,$L(pv)-1))*$A($E(pu,5)))+($E(pw,6)*$A($E(pv,$L(pv)-4))*$A($E(pu,7)))+pi
ALLERR I $ZE["<ZFS" S ls="ОШИБКА РАБОТЫ С ФЛАГОМ ЗАПИСИ НА СЕТЕВОЙ МОНТИРУЕМЫЙ ТОМ" D ER^%ZAPM.ed.BSMSMF,WAITS^%ZAPM.ed.BSF2,END^%ZAPM.ed.BSF,GLKL,OP^%ZAPM.ed.BSF4
 I $ZE["<ZF10" S ls="ФОРСИРОВАННЫЙ ВЫХОД" D ER^%ZAPM.ed.BSMSMF,WAITS^%ZAPM.ed.BSF2,END^%ZAPM.ed.BSF,GLKL,OP^%ZAPM.ed.BSF4 G REC^%ZAPM.ed.BSF12
 I $ZE["<ZF11" S ls="СЕАНС ПРЕРВАН ДИСПЕТЧЕРОМ" D ER^%ZAPM.ed.BSMSMF,WAITS^%ZAPM.ed.BSF2,END^%ZAPM.ed.BSF,GLKL,REC^%ZAPM.ed.BSF12,MGR^%ZAPM.ed.BS
 I $ZE["<INRPT" S ls="ПРЕРВАНО" D ER^%ZAPM.ed.BSMSMF,WAITS^%ZAPM.ed.BSF2,GLKL,OP^%ZAPM.ed.BSF4 G REC^%ZAPM.ed.BSF12
 I $ZE["<DSTDB" S ls="ПРЕРВАНА СЕТЕВАЯ СВЯЗЬ" D ER^%ZAPM.ed.BSMSMF,WAITS^%ZAPM.ed.BSF2,GLKL,OP^%ZAPM.ed.BSF4 G REC^%ZAPM.ed.BSF12
 I $ZE["<DKFUL" S ls="НЕТ СВОБОДНОГО МЕСТА НА ДИСКЕ" D ER^%ZAPM.ed.BSMSMF,O^%ZAPM.ed.BSF7,GLKL,OP^%ZAPM.ed.BSF4 Q
 I $ZE["<PGMOV"!($ZE["<STKOV") W $$bel^%ZAPM.ed.BS3,$$clr^%ZAPM.ed.BS3(11),/ED(2),/CUP(1,1),"!!! НЕХВАТКА ОПЕРАТИВНОЙ ПАМЯТИ В РАЗДЕЛЕ !!!",!,$ZE_" "_$$ErrSay^%ZAPM.ed.BSF8($ZE) W $$atr^%ZAPM.ed.BS3(0) D ER^%ZAPM.ed.BSMSMF,GLKL,OP^%ZAPM.ed.BSF4 Q
 E  D ER^%ZAPM.ed.BSMSMF
 S ls=$$ZE() D O^%ZAPM.ed.BSF7 W $$atr^%ZAPM.ed.BS3(0) Q
ZE() Q $ZE_" "_$$ErrSay^%ZAPM.ed.BSF8($ZE)
ALLKILLB ;УДАЛИТЬ ВСЕ БУФЕРА ПЕРЕД ВЫХОДОМ В ДОС
 N II S II="" F  S II=$O(^%ZAPM.ed.BSbufB(II)) Q:II=""  I II["u" K ^%ZAPM.ed.BSbufB(II)
 Q
GLKL N II,ii,i S II="" F  S II=$O(^%ZAPM.ed.BSbufB(II)) Q:II=""  I II["u" S i=$P(II,"u",$S($E(II)'="u":1,1:2)) D  I ($G(%BS(3),$P)_$J)=$E(i,ii+1,99) K ^%ZAPM.ed.BSbufB(II)
 .F ii=$L(i):-1:1 Q:$E(i,ii)'?1N
 D ERASER^%ZAPM.ed.BSJPRN(0)
 Q
PROC N WIN S st=80,ks=25 D WIND^%ZAPM.ed.BSF3 Q:'YES  D ^%ZAPM.ed.BS,CW^%ZAPM.ed.BSF3 Q
]]></Routine>


<Routine name="%ZAPM.ed.BS2" type="MAC" languagemode="0"><![CDATA[
%BS2 ;Ф-КЛАВИШИ %BS & ETC.; 21:02 28-NOV-96 ; 14:07   02.06.2001
 Q
Hidden ;ОПРЕДЕЛЕНИЕ ПАРАМЕТРОВ РЕЖИМА HiddenLastKey
 S Hidd=$P(@BSR@(BST,"KEY",endkey),"@",15) I Hidd="" W $$bel^%ZAPM.ed.BS3 W $$bel^%ZAPM.ed.BS3 W $$bel^%ZAPM.ed.BS3 K Hidd Q
 S Hidd(1)=$P(@BSR@(BST,"KEY",endkey),"@",5)
 S endkey=endkey-1
 Q
Hidd ;ПРОГОН ТАБЛИЦЫ
 N D,Y1,Y2,X1,X2
 S Hid=$$TMPG^%ZAPM.ed.BSF11 I Hidd(1)="" S Hidd(1)="1,1,9999999,9999999"
 S Y1=$P(Hidd(1),",",1),Y2=$P(Hidd(1),",",3),X1=$P(Hidd(1),",",2),X2=$P(Hidd(1),",",4)
 F i=Y1:1:Y2 Q:'$D(@BSR@(BST,i))  F j=X1:1:X2 Q:'$D(@BSR@(BST,i,j))  I $P($P(^(j),"@",18),"#",2)=Hidd D
 .S D=$P(^(j),"@",15) I D'="",'$D(@Hid@(i)) S @Hid@(i)=D
 Q
FIND(G,S,U,D) ;БЛОК ПОИСКА
 N I,I1,I2,I3,I4,I5,I6,I7,I8,I9,J,JJ,JJJ
 ;;;S S=$S(S=+S:S,S[$C(34):S,1:$C(34)_S_$C(34))
 D Wait^%ZAPM.ed.BSXfun("Сканирую уровень "_U_" у "_G)
 K END S I1="" F  S I1=$O(@G@(I1)) Q:I1=""  I $D(@G@(I1)) D:U=1 FI(I1) Q:$D(END)  D  Q:$D(END)
 .S I2="" F  S I2=$O(@G@(I1,I2)) Q:I2=""  I $D(@G@(I1,I2)) D:U=2 FI(I2) Q:$D(END)  D  Q:$D(END)
 ..S I3="" F  S I3=$O(@G@(I1,I2,I3)) Q:I3=""  I $D(@G@(I1,I2,I3)) D:U=3 FI(I3) Q:$D(END)  D  Q:$D(END)
 ...S I4="" F  S I4=$O(@G@(I1,I2,I3,I4)) Q:I4=""  I $D(@G@(I1,I2,I3,I4)) D:U=4 FI(I4) Q:$D(END)  D  Q:$D(END)
 ....S I5="" F  S I5=$O(@G@(I1,I2,I3,I4,I5)) Q:I5=""  I $D(@G@(I1,I2,I3,I4,I5)) D:U=5 FI(I5) Q:$D(END)  D  Q:$D(END)
 .....S I6="" F  S I6=$O(@G@(I1,I2,I3,I4,I5,I6)) Q:I6=""  I $D(@G@(I1,I2,I3,I4,I5,I6)) D:U=6 FI(I6) Q:$D(END)  D  Q:$D(END)
 ......S I7="" F  S I7=$O(@G@(I1,I2,I3,I4,I5,I6,I7)) Q:I7=""  I $D(@G@(I1,I2,I3,I4,I5,I6,I7)) D:U=7 FI(I7) Q:$D(END)  D  Q:$D(END)
 .......S I8="" F  S I8=$O(@G@(I1,I2,I3,I4,I5,I6,I7,I8)) Q:I8=""  I $D(@G@(I1,I2,I3,I4,I5,I6,I7,I8)) D:U=8 FI(I8) Q:$D(END)  D  Q:$D(END)
 ........S I9="" F  S I9=$O(@G@(I1,I2,I3,I4,I5,I6,I7,I8,I9)) Q:I9=""  I $D(@G@(I1,I2,I3,I4,I5,I6,I7,I8,I9)) D:U=9 FI(I9) Q:$D(END)  D  Q:$D(END)
 Q
FI(O) I ("@"_O)[("@"_S) X D
 X WA Q
%FKR I R3=89 ZT "F10"
 I R3=86,'$D(%BS("Tmp",3)) D FIND^%ZAPM.ed.BSF5 G D
 S %NAM=$P(d," ",2) I R3=85,'$D(%BS("Tmp",3)) D SRV^%ZAPM.ed.BSF5 G D^%ZAPM.ed.BSF5
IntFKR ;%NAM=ИМЯ МАССИВА
 I R3=84,'$D(%BS("Tmp",3)) D APPLIC^%ZAPM.ed.BSZGAP Q:R1=27  G D^%ZAPM.ed.BSF5
 I R3=87 G D:ny<3!($D(%BS("Tmp",3))) D  Q:R1=27
 .D PAROL^%ZAPM.ed.BS1 I '$D(%PAROL) K %PAROL Q
 .S i="" I $O(@(%NAM_"(i)"))'="" D Yes^%ZAPM.ed.BSXfun("Раздел не пустой !!! Вы УВЕРЕНО ХОТИТЕ ЕГО УДАЛИТЬ ?",2) Q:YES<1
 .I %NAM'[("DE"_"M"_"O"_"NS"_"TR")&($G(^%ZAPM.ed.BSR("KEY"))'=$$PW^%ZAPM.ed.BS1(2)) D DE^%ZAPM.ed.BS1 Q
 .K @(%NAM) S R1=27,ny=1 D NEWDIR^%ZAPM.ed.BSD1
 I R3=83 I ny>$S($D(%BS("Tmp",3)):1,1:2) S li=$P(@%NAM,"@",2) D COM^%ZAPM.ed.BS1 D  G D
 .I YES S $P(@%NAM,"@",2)=li D
 ..I $D(IntFKR) S $P(@BSR@(BST,ny,nx),"@",15)=$E(d,1,6)_li Q
 ..S $P(d,";",2)=li,$P(^%ZAPM.ed.BSbufB("R"_$G(%BS(3),$P)_$J_"u"_%BS(15),ny,1),"@",15)=d
 G D
ERRRVG D ErrMsg^%ZAPM.ed.BSXfun("Редактирование харрактеристик возможно только в явно смонтрованном томе.  А мы сейчас находимся в томе смонтированном,  как RVG (Remote Volume Group)") q
%GBL I '$$RP^%ZAPM.ed.BSGCH("^BSdirddp") D ERRRVG Q
 D PAROL^%ZAPM.ed.BS1 I $D(%PAROL) S %GLB=%NAM K %PAROL D ^%ZAPM.ed.BSGCH,PROTALL^%ZAPM.ed.BSF9
 Q
%FKT I R3=89 ZT "F10"
 I R3=86 D FIND^%ZAPM.ed.BSF5 G D
 S %TAB=$P($P(d,"~",2)," "),ZZ=3 S:%NAM["%BSbufS" ZZ=2
 I R3=87 G D:ny<ZZ D  K AllWAY Q:R1=27
 .K AllWAY I $D(%DIA) S do="I i'<ZZ S %TAB=$P($P($P(^(j),""@"",15),""~"",2),"" "") I %TAB'="""" D DEL^%ZAPM.ed.BS(%NAM,%TAB)" D BLOK^%ZAPM.ed.BSF1 Q
 .D DEL^%ZAPM.ed.BS(%NAM,%TAB) Q
 I R3=85 D SRV^%ZAPM.ed.BSF5 K KILLER G D
 I R3=83,ny>2,$P(@(%NAM_"(%TAB)"),"@",30)="" S li=$P(@$ZR,"@") D COM^%ZAPM.ed.BS1 S:YES $P(@(%NAM_"(%TAB)"),"@")=li,$P(d,";",3)=li S $P(^%ZAPM.ed.BSbufB("T"_$G(%BS(3),$P)_$J_"u"_%BS(15),ny,1),"@",15)=d G D
 I R3=84 S OO=14,OOO="^%ZAPM.ed.BS" K %JB D 24^%ZAPM.ed.BSTM,^%ZAPM.ed.BSB,ZA^%ZAPM.ed.BSF G D:R1=27 G COPY^%ZAPM.ed.BS
 I R3=88 D
 .D SI^%ZAPM.ed.BSN N (%BS,vl,%zT,%KAT,%File,%NAM,%TAB) S BSR=%NAM,BST=%TAB D INFO^%ZAPM.ed.BSF6 Q
D W /CUP(24,1),$$atr^%ZAPM.ed.BS3(0),/EL(0),/CUP(25,1),$$atr^%ZAPM.ed.BS3(0),/EL(0)
 G D^%ZAPM.ed.BS
Comnt(d) Q:'$E(%BS(1),7) ;ВЫВОД КОМЕНТАРИЯ
 W /CUP(25,1),$$atr^%ZAPM.ed.BS3(0),/EL(0),$$ComUCI(d)
 Q
ComUCI(d) Q:d="" "" ;ВОЗВРАТ КОМЕНТАРИЯ
 Q:BSII=nx "" N u,s
 S %zT=$ZT,$ZT="ComErr^%ZAPM.ed.BS2"
 I d?.N1",".N S s=$P($$ZU^%ZAPM.ed.BS3($P(d,",",2),$P(d,",")),",",2),u=$P($$ZU^%ZAPM.ed.BS3($P(d,",",2),$P(d,",")),",") G Co
 E  S u=d,s=$P(^%ZAPM.ed.BSbufB("fT"_$G(%BS(3),$P)_$J_"u"_%BS(15),1,nx),"@",15)
Co Q $P($G(@("^["""_u_""","""_s_"""]BSdirddp"),"?"),"@")
ComErr S $ZT=$G(%zT) Q "@"
SetComU(d,li) ;ПРИВОЕНИЕ КОМЕНТАРИЯ
 S %zT=$ZT,$ZT="ComErrS^%ZAPM.ed.BS2" I $$ComUCI(d)
 I $ZR["BSdirddp" S $P(@$ZR,"@")=li,YES=1
 Q
ComErrS S $ZT=$G(%zT),YES=0 D ErrMsg^%ZAPM.ed.BSXfun(" Коррекция Комментария кипа недоступна") Q
COM ;ПРИCВОЕНИЕ КОМЕНТАРИЯ
 S li=$$ComUCI(d) D SetComU(d,li) Q:'YES
 I li="@" D ErrMsg^%ZAPM.ed.BSXfun(" Комментарий кипа недоступен") Q
 D COM^%ZAPM.ed.BS1 I YES D SetComU(d,li)
 Q
TESTC(KOLC) W #,"Идет тест",!
TEST ;ТЕСТ КОМБИНИРОВАННЫЙ
 N G,I,L1,L2,G1,G2,DE,AAA,TE,BY,S1,S2,S3,TmpTime
 S TE=$P($$h^%ZAPM.ed.BS3(),",",2),TmpTime=$P($H,",",2) ;НАЧАЛО
 F DE=1000:2000:$G(KOLC,10000) D ZF^%ZAPM.ed.BS3 D ZF^%ZAPM.ed.BS3 D ZF^%ZAPM.ed.BS3 S DE(DE)=$$T(DE)
 K ^BStest($P),@G S TE=$P($$h^%ZAPM.ed.BS3(),",",2)-TE
 S I="",G=0,L1=0,L2=0 F  S I=$O(DE(I)) Q:I=""  S G1=G1+$P(DE(I),"\"),L1=L1+$P(DE(I),"\",2),G2=G2+$P(DE(I),"\",3),L2=L2+$P(DE(I),"\",4),G=G+1
 S S1="Среднее Отношение байт/сек лок.к глоб.записи/лок.к глоб.чтению ("_((L1\G)/(G1\G))_"/"_((L2\G)/(G2\G))_")"
 S S2="Производительнось DDP Кб/сек Запись/Чтение ("_(G1\1024)_"/"_(G2\1024)_")"
 S TmpTime=$P($H,",",2)-TmpTime
 S S3="Всего работали "_(TmpTime/60)_" Мин."
 I $ZV["Windows" W !,S1,!,S2,!,S3,! Q
 D OkMsg^%ZAPM.ed.BSXfun(S1_" "_S2_" "_S3)
 Q
T(DE) S BY=DE*185
 K ^BStest($P) S G=$ZR,L1=$$TE(G,"ЛОК.ЗАПИСЬ "_G,DE) S L2=$$TES(G,"ЛОК.ЧТЕНИЕ "_G,DE)
 I $ZV['"Windows" S G=$P($P($G(^%ZAPM.ed.BSETUP("SERVER",4,4)),"@",15),"\",2),G=$NA(@G@("TEST",$P($$ZU^%ZAPM.ed.BS3(1,0),",",2),$G(%BS(3),$P)))
 I $ZV["Windows" S G="^BStest1",G=$NA(@G@("TEST",$G(%BS(3),$P)))
 K @G S G1=$$TE(G,"ГЛОБ.ЗАПИСЬ "_G,DE) S G2=$$TES(G,"ГЛОБ.ЧТЕНИЕ "_G,DE)
 Q (BY\$S(G1:G1,1:1))_"\"_$S((BY\$S(L1:L1,1:1)):(BY\$S(L1:L1,1:1)),1:1)_"\"_(BY\$S(G2:G2,1:1))_"\"_$S((BY\$S(L2:L2,1:1)):(BY\$S(L2:L2,1:1)),1:1)
TE(A,TT,KO) N T1,I
 D Wait^%ZAPM.ed.BSXfun(DE_":"_TT) S T1=$P($$h^%ZAPM.ed.BS3(),",",2)
 F I=1:1:KO S @A@(I)="1234567890-=\][POIUYTREWQASDFGHJKL;'/.,MNBVCXZzxcvbnm<>?:lkjhgfdsaqwertyuiop{}|+_)(*&^%$#@!~(1234567890-=\ЪХЗЩШГНЕКУЦЙФЫВАПРОЛДЖЭЁЮБЬТИМСЧЯячсмитьбюёэждлорпавыфйцукенгшщзхъ|+_%?;.,:$/!)" I '(I#100) X WA
 Q ($P($$h^%ZAPM.ed.BS3(),",",2)-T1)
TES(A,TT,KO) N T1,I
 I $ZV['"Windows" D Wait^%ZAPM.ed.BSXfun(DE_" Тест.Фаза:"_TT)
 S T1=$P($$h^%ZAPM.ed.BS3(),",",2)
 F I=1:1:KO S AAA($R(10))=@A@(I) I '(I#500) X $G(WA) I $G(WA)="" W "."
 Q ($P($$h^%ZAPM.ed.BS3(),",",2)-T1)
]]></Routine>


<Routine name="%ZAPM.ed.BS3" type="MAC" languagemode="0"><![CDATA[
%BS3 ;ЛОКИРОВКА ГЛОБАЛЕЙ ; 9:13   09.10.2001
BSR I $E(BSR,$L(BSR))="," S BSR=$E(BSR,1,$L(BSR)-1)_$S($E(BSR,$L(BSR))=",":")",1:"")
 Q
TRAP I k2=65 W #,!,k3 R R
 Q
FTRAP() D x("?") Q 1
L(BSR,L) ;ЛОКИРОВКА ССЫЛКИ
 D BSR I BSR="" D ERRBSR
 S LOC=1
 I $E(BSR,1,2)="^$" Q
 L +@BSR:0 E  D DDPLOCK
 Q
DDPLOCK ;ОЖИДАНИЕ ЛОКИРОВКА ССЫЛКИ
 S LOC=0 I $D(L) Q
 F  S ls="Узел "_BSR_" занят !!!,<Esc>-назад" D WAITS^%ZAPM.ed.BSF2 S gi=$G(gi,1)+1 W " ",gi H 1 W $$rt^%ZAPM.ed.BS3(0) D:R1=27  Q:R1=27  L +@BSR:0 I $T S LOC=1 Q
 .S ls="Узел "_BSR_" занят ,<Esc>-назад"
 Q
U(BSR) ;СНЯТИЕ ЛОКИРОВКИ
 D BSR I BSR="" D ERRBSR
 L -@BSR Q
ERRBSR Q:$D(L)  D ErrMsg^%ZAPM.ed.BSXfun("ЛОКИРУЕТСЯ ПУСТАЯ ССЫЛКА !!!") Q
R(BSR) D L(BSR) Q
D(BSR) D U(BSR) Q
  ;
  ;   АНАЛОГИ !!!
  ;
ZF I $ZV["Wind"!($ZV["Cach"||($ZV["IRIS")) Q
 ZF  Q
ZU(K,T) ;АНАЛОГ $ZU
  I $ZV["Cach"||($ZV["IRIS") Q $ZU(5)
  I $D(T) Q $ZU(K,T)
  E  Q $ZU(K)
x(x) S %BS("Tmp","NameS")=x D x^%ZAPM.ed.BS7238(%BS("Tmp","NameS")) Q
l() D WRITE^%ZAPM.ed.BS7238 Q ""
pr() Q:$ZN=""  S %zN=$ZN D PRINT^%ZAPM.ed.BS7238 ;ZL @%zN X %z0 K %zN,%z0,%z1,%z2,%z3,%z4,%z5,%z6,%z7,%z8,%z9,%z10,%z11,%z12,%z13 Q
atr(A) Q $C(27)_"["_A_"m"
bel() Q "" /// $C(7)
clear() Q $C(27)_"[0;0;25;80w"
clr(C) Q $C(27)_"["_$P($G(%BS,"1;6;33;42!1;6;37;47!1;6;33;46!1;6;30;45!1;6;30;46!2;6;30;46!1;6;33;45!2;6;30;46!1;6;33;46!2;6;30;41!1;6;32;40"),"!",C)_"m"
ed() Q $C(27)_"[2J" ;| W /ED(2)
el() Q $C(27)_"[K"  ;| W /EL(0)
esc(E) Q $C(27)_E
setkod() Q ""
r() N R,RR R *R,*RR:0,*RR:0 Q ""
rt(R) I $ZV["Cach"||($ZV["IRIS") D  Q "" ;ANSI-TERMINAL
 .X $G(%BS(43)) 
 .O 0:(:"IS") R *R1:R,*R2:0 i R1>31,R2>31 s rr=$c(R1)_$c(R2) f  r *r:0 d:r'=-1  i r=-1,$l(rr)>1 d AddHist^%ZAPM.ed.BSXuse("^%ZAPM.ed.BSbufB(""HISCTL1"")",rr) q  ;,ReadToEL^%ZAPM.ed.BSXuse
 ..s rr=rr_$c(r)  ;строка из буфера обмена Windows
 .r *R3:0,*R4:0,*R5:0 
 .;w !,"==="_R1_" "_R2_" "_R3_" "_R4_" "_R5,!  ;нужно узнать альт коды
 .I R1=13 S R2=-1
 .I '$E($G(%BS(1)),15),R1=3,R2=-1,R3=-1 ZT "INRP"
 .i R1=5 s R1=0,R2=18,R3=-1,R4=-1,R5=-1 q  ;Ctr-E --> Alt-E
 .i R1=4 s R1=0,R2=31,R3=-1,R4=-1,R5=-1 q  ;Ctr-D --> Alt-S
 .if $g(%BS(2008))="1L" d  ;эмуляция ANSI-TERMINAL, если Linux
 ..i R1=27,R2=91,R3=51,R4=126 s R1=127,R2=-1,R3=-1,R4=-1,R5=-1 q  ;del
 ..i R1=27,R2=91,R3=50,R4=126 s R1=0,R2=82,R3=-1,R4=-1,R5=-1 q  ;ins
 ..i R1=27,R2=91,R3=49,R4=126 s R1=0,R2=71,R3=-1,R4=-1,R5=-1 q  ;home
 ..i R1=27,R2=91,R3=52,R4=126 s R1=0,R2=79,R3=-1,R4=-1,R5=-1 q  ;end
 ..i R1=27,R2=91,R3=53,R4=126 s R1=0,R2=73,R3=-1,R4=-1,R5=-1 q  ;pu
 ..i R1=27,R2=91,R3=54,R4=126 s R1=0,R2=81,R3=-1,R4=-1,R5=-1 q  ;pd 
 ..i R1=27,R2=91,R3=49 d  q
 ...i R4=53 s R1=27,R2=79,R3=84,R4=-1,R5=-1 q  ;f5
 ...i R4=52 s R1=27,R2=79,R3=83,R4=-1,R5=-1 q  ;f4
 ...i R4=51 s R1=27,R2=79,R3=82,R4=-1,R5=-1 q  ;f3
 ...i R4=50 s R1=27,R2=79,R3=81,R4=-1,R5=-1 q  ;f2
 ...i R4=49 s R1=27,R2=79,R3=80,R4=-1,R5=-1 q  ;f1
 ...i R4=57 s R1=27,R2=79,R3=87,R4=-1,R5=-1 q  ;f8
 ...i R4=56 s R1=27,R2=79,R3=86,R4=-1,R5=-1 q  ;f7
 ...i R4=55 s R1=27,R2=79,R3=85,R4=-1,R5=-1 q  ;f6
 .i $g(%BS(2008)) d  ;эмуляция ANSI-TERMINAL, если версия больше 2008.1.2
 ..i R1=27,R2=91,R3=51,R4=126 s R1=127,R2=-1,R3=-1,R4=-1,R5=-1 q  ;del
 ..i R1=27,R2=91,R3=50,R4=126 s R1=0,R2=82,R3=-1,R4=-1,R5=-1 q  ;ins
 ..i R1=27,R2=91,R3=49,R4=126 s R1=0,R2=71,R3=-1,R4=-1,R5=-1 q  ;home
 ..i R1=27,R2=91,R3=52,R4=126 s R1=0,R2=79,R3=-1,R4=-1,R5=-1 q  ;end
 ..i R1=27,R2=91,R3=53,R4=126 s R1=0,R2=73,R3=-1,R4=-1,R5=-1 q  ;pu
 ..i R1=27,R2=91,R3=54,R4=126 s R1=0,R2=81,R3=-1,R4=-1,R5=-1 q  ;pd 
 ..i R1=27,R2=91,R3=49 d  q
 ...i R4=57 s R1=27,R2=79,R3=87,R4=-1,R5=-1 q  ;f8
 ...i R4=56 s R1=27,R2=79,R3=86,R4=-1,R5=-1 q  ;f7
 ...i R4=55 s R1=27,R2=79,R3=85,R4=-1,R5=-1 q  ;f6
 I $ZV["MSM-Workstation" R *R1:R,*R2:0,*R3:0 R *R4:0,*R5:0 D  Q ""
 .I $D(%BS(35,$P(R1_","_R2_","_R3_","_R4_","_R5,",-1"))) S Tmp=%BS(35,$P(R1_","_R2_","_R3_","_R4_","_R5,",-1"))_"-1,-1,-1,-1",R1=$P(Tmp,","),R2=$P(Tmp,",",2),R3=$P(Tmp,",",3),R4=$P(Tmp,",",4),R5=$P(Tmp,",",5)
 ;MSM-PC\PLUS & TERMINALS
 R *R1:R s R2=R1 d  i R4 f  s R2=R2_","_R1 d  Q:R4=0
 .f R3=1:1:30 r *R1:0 s R4=$t q:R4
 S R5=$P(R2_",-1,-1,-1,-1",",",1,5) I $D(%BS(35)) D
 .I $D(%BS(35,R5)) S R5=%BS(35,R5)_"-1,-1,-1,-1"
 S R1=$P(R5,",",1),R2=$P(R5,",",2),R3=$P(R5,",",3),R4=$P(R5,",",4),R5=$P(R5,",",5)
 Q ""
 
yx(Y,X) I $ZV["MSM-Workstation",Y>22 S Y=Y-1 ;| W /CUP(Y,X)
 S $X=Y-1,$Y=X-1 Q $C(27)_"["_Y_";"_X_"H"
p() Q $p
RE D ^%ZAPM.ed.BSXprog() Q
GE D ^%ZAPM.ed.BSMSMG() Q
h() Q $G(%BS(36),$P($H,","))_","_$P($H,",",2)
SAY(Y,X) N q,QQ     ;ЧТО И КЕМ
 S QQ=$$SW^%ZAPM.ed.BSF12("^%ZAPM.ed.BSS(""OWNER"")")
 W:Y /CUP(Y,X) W:'Y ! W $G(@QQ@(1))_$$ver^%ZAPM.ed.BSC //," §",^%ZAPM.ed.BS
 F I=2:1:5 W:Y /CUP(Y-1+I,X) W:'Y ! W $G(@QQ@(I))
 S I=6 W:Y /CUP(Y-1+I,X) W:'Y ! W "Registred EndUser:  " //,$G(^%ZAPM.ed.BSinFL)
 S I=7 W:Y /CUP(Y-1+I,X) W:'Y ! S q=$$GETOPT^%ZAPM.ed.BSC4cfg($$MainOpt^%ZAPM.ed.BSC4,"ENDUSER") S:q="?" q="MSW" W q
 Q
REGISTR ;РЕГИСТРАЦИЯ
	///
 Q
]]></Routine>


<Routine name="%ZAPM.ed.BS364" type="MAC" languagemode="0"><![CDATA[
%X364 ; BINDING FOR ANSI X3.64 NAMESPACE, NOV/92 ; RLL377 11/22/93  ; Compiled October 8, 2004 12:32:13
 ; +--------------------------------------------------------+
 ; | Copyright 1986-2003 by InterSystems Corporation,       |
 ; | Cambridge, Massachusetts, U.S.A.                       |
 ; | All rights reserved.                                   |
 ; |                                                        |
 ; | Confidential, unpublished property of InterSystems.    |
 ; |                                                        |
 ; | This media contains an authorized copy or copies       |
 ; | of material copyrighted by InterSystems and is the     |
 ; | confidential, unpublished property of InterSystems.    |
 ; | This copyright notice and any other copyright notices  |
 ; | included in machine readable copies must be reproduced |
 ; | on all authorized copies.                              |
 ; +--------------------------------------------------------+
 u 0 w !,"Illegal entry point: do not call ^",$ZN," directly."
 q:$zu(41)'>2  ZTRAP "EP"
APC ; Application program command
 w $c(27)_"_"
 q
BEL ; Ring the bell
  //w $c(7)
 q
CBT(%1) ; Cursor backward tabulation %1 tab stops
 s %1=+$g(%1,1) w $c(27,91)_%1_"Z" s $x=$x+7\8*8-(%1*8) s:$x<0 $x=0
 q
CCH ; Cancel character
 w $c(27)_"T"
 q
CHA(%1) ; Cursor horizontal absolute (move to column %1)
 s %1=+$g(%1,1) w $c(27,91)_%1_"G" s $x=%1-1
 q
CHT(%1) ; Cursor horizontal tabulation (forward %1 tab stops)
 s %1=+$g(%1,1) w $c(27,91)_%1_"I" s $x=$x\8*8+(%1*8) s:$x>255 $x=255
 q
CNL(%1) ; Cursor next line (cursor down %1 lines)
 s %1=+$g(%1,1) w $c(27,91)_%1_"E" s $y=$y+%1 s:$y>255 $y=255
 q
CPL(%1) ; Cursor preceding line (cursor up %1 lines)
 s %1=+$g(%1,1) w $c(27,91)_%1_"F" s $y=$y-%1 s:$y<0 $y=0
 q
CPR ; Cursor position report (return in $KEY)
 n %1 w $c(27,91)_"6n" r %1
 q
CTC(%1,%2,%3,%4,%5,%6,%7,%8,%9) ; Cursor tabulation control
 n %i,%p s %p=""
 f %i=1:1:9 i $d(@("%"_%i)) s %p=%p_$e(";",%p'="")_@("%"_%i)
 w $c(27,91)_%p_"W"
 q
CUB(%1) ; Cursor backward %1 columns
 s %1=+$g(%1,1) w $c(27,91)_%1_"D" s $x=$x-%1 s:$x<0 $x=0
 q
CUD(%1) ; Cursor down %1 lines
 s %1=+$g(%1,1) w $c(27,91)_%1_"B" s $y=$y+%1 s:$y>255 $y=255
 q
CUF(%1) ; Cursor forward %1 columns
 s %1=+$g(%1,1) w $c(27,91)_%1_"C" s $x=$x+%1 s:$x>255 $x=255
 q
CUP(%2,%1) ; Cursor position (column %1, line %2)
 I %2=0 S %2=1
 I %1=0 S %1=1
 s %1=+$g(%1,1),%2=+$g(%2,1) w $c(27,91)_%2_";"_%1_"H"
 //---MSW
 I %1>0 s $x=%1-1
 I %2>0 S $y=%2-1
 //---
 S $x=$s($x<0:0,$x>255:255,1:$x),$y=$s($y<0:0,$y>255:255,1:$y)
 q
CUU(%1) ; Cursor up %1 lines
 s %1=+$g(%1,1) w $c(27,91)_%1_"A" s $y=$y-%1 s:$y<0 $y=0
 q
CVT(%1) ; Cursor vertical tabulation
 w $c(27,91)_+$g(%1,1)_"Y"
 q
DA ; Device attributes - return in $KEY
 n %1,%2,%3 s %3="" u $i:("":"+S")
 w $c(27,91)_"c" r %1 s %2=$k f  r *%1 s %3=%3_$c(%1) q:%1=99
 s $k=%2_%3 u $i:("":"-S")
 q
DAQ(%1,%2,%3,%4,%5,%6,%7,%8,%9) ; Define area qualification
 n %i,%p s %p=""
 f %i=1:1:9 i $d(@("%"_%i)) s %p=%p_$e(";",%p'="")_@("%"_i)
 w $c(27,91)_%p_"o"
 q
DCH(%1) ; Delete %1 characters
 w $c(27,91)_+$g(%1,1)_"P"
 q
DCS ; Device control string
 w $c(27)_"P"
 q
DL(%1) ; Delete %1 lines
 w $c(27,91)_+$g(%1,1)_"M"
 q
DMI ; Disable manual input
 q
DSR(%1) ; Device status report - type %1 - return in $KEY
 n %2 w $c(27,91)_+$g(%1,5)_"n" r %2
 q
EA(%1) ; Erase in area
 w $c(27,91)_+$g(%1,1)_"O"
 q
ECH(%1) ; Erase %1 characters
 w $c(27,91)_+$g(%1,1)_"X"
 q
ED(%1) ; Erase in display (%1=0 cursor-to-end,1 begin-to-cursor,2 entire scr)
 w $c(27,91)_+$g(%1)_"J"
 q
EF(%1) ; Erase in field
 w $c(27,91)_+$g(%1,1)_"N"
 q
EL(%1) ; Erase in line (%1=0 cursor-to-end, 1 begin-to-cursor, 2 entire line)
 w $c(27,91)_+$g(%1)_"K"
 q
EMI ; Enable manual input
 q
EPA ; End of protected area
 w $c(27)_"W"
 q
ESA ; End of selected area
 w $c(27)_"G"
 q
FNT ; Font selection
 q
GSM ; Graphic size modification
 q
GSS ; Graphic size selection
 q
HPA(%1) ; Horizontal position attribute (cursor to column %1)
 s %1=+$g(%1,1) w $c(27,91)_%1_"`" s $x=%1-1 s:$x<0 $x=0
 q
HPR(%1) ; Horizontal position relative (cursor forward %1 columns)
 s %1=+$g(%1,1) w $c(27,91)_%1_"a" s $x=$x+%1 s:$x>255 $x=255
 q
HTJ ; Horizontal tab with justify
 w $c(27)_"I"
 q
HTS ; Horizontal tabulation set
 w $c(27)_"H"
 q
HVP(%1,%2) ; Horizontal and vertical position (column %1, line %2)
 s %1=+$g(%1,1),%2=+$g(%2,1) w $c(27,91)_%2_";"_%1_"f"
 s $x=%1-1,$y=%2-1,$x=$s($x<0:0,$x>255:255,1:$x),$y=$s($y<0:0,$y>255:255,1:$y)
 q
ICH(%1) ; Insert %1 characters
 w $c(27,91)_+$g(%1,1)_"@"
 q
IL(%1) ; Insert %1 lines
 w $c(27,91)_+$g(%1,1),"L"
 q
IND ; Index
 w $c(27)_"D" s $y=$y+1 s:$y>255 $y=255
 q
INT ; Interrupt
 w $c(27,91)_"a"
 q
JFY ; Justify
 q
MC ; Media copy
 w $c(27,91)_"i"
 q
MW ; Message waiting
 w $c(27)_"U"
 q
NEL ; Next line
 w $c(27)_"E" s $x=0,$y=$y+1 s:$y>255 $y=255
 q
NP(%1) ; Next page (advance %1 pages of terminal display memory)
 w $c(27,91)_+$g(%1,1)_"U"
 q
OSC ; Operating system command
 w $c(27)_"]"
 q
PLD ; Partial line down
 w $c(27)_"K"
 q
PLU ; Partial line up
 w $c(27)_"L"
 q
PM ; Privacy message
 w $c(27)_"^"
 q
PP(%1) ; Preceding page (backup %1 pages of terminal display memory)
 w $c(27,91)_+$g(%1,1)_"V"
 q
PU1 ; Private use one
 w $c(27)_"Q"
 q
PU2 ; Private use two
 w $c(27)_"R"
 q
QUAD ; QUAD
 q
REP ; Repeat
 w $c(27,91)_"b"
 q
RI ; Reverse index
 w $c(27)_"M" s $y=$y-1 s:$y<0 $y=0
 q
RIS ; Reset to initial state
 w $c(27)_"c" s $x=0,$y=0
 q
RM(%1,%2,%3,%4,%5,%6,%7,%8,%9) ; Reset mode
 n %i,%p s %p=""
 f %i=1:1:9 i $d(@("%"_%i)) s %p=%p_$e(";",%p'="")_@("%"_%i)
 w $c(27,91)_%p_"l"
 q
SEM ; Select editing extent mode
 w $c(27,91)_"Q"
 q
SGR(%1,%2,%3,%4,%5,%6,%7,%8,%9)  ; Select graphic rendition %1 thru %9
 n %i,%p s %p=""
 f %i=1:1:9 i $d(@("%"_%i)) s %p=%p_$e(";",%p'="")_@("%"_%i)
 w $c(27,91)_%p_"m"
 q
SL ; Scroll left
 q
SM(%1,%2,%3,%4,%5,%6,%7,%8,%9) ; Set mode
 n %i,%p s %p=""
 f %i=1:1:9 i $d(@("%"_%i)) s %p=%p_$e(";",%p'="")_@("%"_%i)
 w $c(27,91)_%p_"h"
 q
SPA ; Start of protected area
 w $c(27)_"V"
 q
SPI ; Spacing increment
 q
SR ; Scroll right
 q
SS2 ; Single shift two
 w $c(27)_"N"
 q
SS3 ; Single shift three
 w $c(27)_"O"
 q
SSA ; Start of selected area
 w $c(27)_"F"
 q
ST ; String terminator
 w $c(27)_"\"
 q
STS ; Set transmit state
 w $c(27)_"S"
 q
SU ; Scroll up
 w $c(27,91)_"S"
 q
TBC ; Tabulation clear
 w $c(27,91)_"g"
 q
TSS ; Thin space specification
 q
VPA(%1) ; Vertical position attribute (move to row %1 at same column)
 s %1=+$g(%1,1) w $c(27,91)_%1_"d" s $y=%1-1,$y=$s($y<0:0,$y>255:255,1:$y)
 q
VPR(%1) ; Vertical position relative (move down %1 lines at same column)
 s %1=+$g(%1,1) w $c(27,91)_%1_"e" s $y=$y+%1 s:$y>255 $y=255
 q
VTS ; Vertical tabulation sets
 w $c(27)_"J"
 q
 ;
]]></Routine>


<Routine name="%ZAPM.ed.BS7238" type="MAC" languagemode="0"><![CDATA[
%BS7238 ;СПЕЦИАЛЬНЫЕ NAMESPACE к ТЕРМИНАЛАМ и /l /p /x ; 17:43 27-FEB-99
SETCLR N n F n=1,2,9 S $P(%BS,"!",n)=7
 F n=3,4,10 S $P(%BS,"!",n)=1
 F n=5:1:8,11 S $P(%BS,"!",n)=0
 Q
PCPC N n I R1'=27 R *R2:0,*R3:0 Q
 I R1'=0 R *R2:0,*R3:0 Q
 F n=1:1:99 R *R2:0 Q:R2'=-1
 F n=1:1:99 R *R3:0 Q:R3'=-1
 Q
PCT N n I R1'=27 R *R2:0,*R3:0 Q
 F n=1:1:99 R *R2:0 Q:R2'=-1
 F n=1:1:99 R *R3:0 Q:R3'=-1
 Q
RT N R4,n,kO I R1'=27 R *R2:0,*R3:0 Q
 F n=1:1:99 R *R2:0 Q:R2'=-1
 F n=1:1:99 R *R3:0 Q:R3'=-1
 I R3>48&(R3<55) D
 .F n=1:1:99 R *R4:0 Q:R4'=-1
 .Q:R4=126
 .F n=1:1:99 R *R5:0 Q:R5'=-1
 .S R3=R3_R4 Q
 S kO=$P(%BS(11),"!",$L($P(%BS(10),(R1_","_R2_","_R3_"!")),"!")) I kO["," S R1=$P(kO,","),R2=$P(kO,",",2),R3=$P(kO,",",3)
 Q
%BPD N o,kO S R2=-1 F o=1:1:30 R *R3:0 Q:R3'=-1
 S kO=$P(%BS(11),"!",$L($P(%BS(10),(R1_","_R2_","_R3_"!")),"!")) I kO["," S R1=$P(kO,","),R2=$P(kO,",",2),R3=$P(kO,",",3)
 Q
%BCM7209 N o,kO S R2=-1 F o=1:1:30 R *R3:0 Q:R3'=-1
 S kO=$P(%BS(11),"!",$L($P(%BS(10),(R1_","_R2_","_R3_"!")),"!")) I kO["," S R1=$P(kO,","),R2=$P(kO,",",2),R3=$P(kO,",",3)
 Q
 ;W /x
CMD1 S $ZT="ERCMD^%ZAPM.ed.BS7238" N N
 F  D  Q:cmd="."!(cmd="ESC")!(YES=0)  G:cmd="DOS"!(cmd="dos") ^%SSD G:cmd="ALLWAY" ALLWAY D:cmd="WAYKILL" WAYKILL W $$atr^%ZAPM.ed.BS3(0),/CUP(1,1),/ED(2) X cmd
 .S %BSenter=1 W !!,/CUP(24,1),"<<<ЛОВУШКА>>> (",$G(x),") ",$$ZU^%ZAPM.ed.BS3(0),">" S cmd=$$Edit^%ZAPM.ed.BSXuse("",25,1,25,70,"","","^%ZAPM.ed.BSHLP(TRAP")
 .I cmd'="" D
 ..I cmd?.N S cmd=$G(%BS("Tmp","cmd",cmd)) Q
 ..S N=$O(%BS("Tmp","cmd",""),-1)+1,%BS("Tmp","cmd",N)=cmd
 .I cmd="LI"!(cmd="li") W /CUP(1,1),/ED(2) D
 ..F N=1:1 Q:'$D(%BS("Tmp","cmd",N))  W !,N,"=",%BS("Tmp","cmd",N)
 ..W $$r^%ZAPM.ed.BS3 S cmd=""
 .I cmd="/l"!(cmd="/L") W $$l^%ZAPM.ed.BS3,$$r^%ZAPM.ed.BS3 S cmd=""
 .I cmd="LT"!(cmd="lt") W /CUP(1,1),/ED(2) D LOCKTAB^%ZAPM.ed.BSF6 W $$r^%ZAPM.ed.BS3 S cmd=""
CMD2 S $ZT=$G(%zT) D CL^%ZAPM.ed.BSF4,RE^%ZAPM.ed.BSsBUF I $D(%ZREFERE),%ZREFERE'["""",$$Data^%ZAPM.ed.BSF12(%ZREFERE)
e Q
ALLWAY S %BS("Tmp","AllWay",$G(%BS(3),$P),x)="" G CMD2
WAYKILL K %BS("Tmp","AllWay",$G(%BS(3),$P)) S cmd="" Q
x(x) N %ZREFERE,cmd,%BSenter I x'="",$D(%BS("Tmp","AllWay",$G(%BS(3),$P),x)) Q
 S %zT=$ZT,%ZREFERE=$ZR D OP^%ZAPM.ed.BSF4,SA^%ZAPM.ed.BSsBUF W /ED(2),$$bel^%ZAPM.ed.BS3
ERCMD W /CUP(1,1),$$bel^%ZAPM.ed.BS3,!,$ZE,!!," - Возвpат  <Esc> или "".""",!," - Выход в MSM  ""H""",!," - Уйти в DOS  ""DOS""" W:x'="" !," - Игнорируем ",x," ловушку ""ALLWAY""" G CMD1
WRITE N %zz1,%zz0,%zz2,%zz3,%zz4,%zz5 ;ПОЭКРАННОЕ ЛИСТАНИЕ W /l
 W !,"------------- Локальные пеpеменные : ---------------"
 I $ZV["MSM" ;S %zz1=$O()
 I $ZV["Cach"||($ZV["IRIS") S %zz1="",%zz1=$O(@%zz1)
 S %zz0=0 F  Q:%zz1=""  D:%zz1'["%zz"  S %zz1=$O(@%zz1)
 .I "11"[$D(@%zz1) D W(%zz1)
 .I $D(@%zz1)>9 S %zz3=%zz1 F  S %zz3=$Q(@%zz3) Q:%zz3=""  D W(%zz3)
 W !,"-------- Конец списка локальных пеpеменных --------"
 Q
W(%z) S %zz5=$L(%z)+1,%zz4=79-%zz5 W !,%z,"=",$E(@%z,1,%zz4) S %zz4=%zz4+1
WW S %zz0=%zz0+1 I '(%zz0#22) W !,"--------- Press <Enter> >" R *%zz2,*%zz2:0,*%zz2:0
 Q:%zz4'<$L(@%z)  W $E(@%z,%zz4,%zz4+78) S %zz4=%zz4+79 G WW
PRINT ;ПОЭКРАННОЕ ЛИСТАНИЕ ПРОГРАММЫ W /p
 S %z0="S %z10=0 X %z1,%z3,%z2"
 S %z1="W !,""------------- Листинг пpогpаммы "",$ZN,"" ---------------"""
 S %z3="F %z3=1:1 Q:$T(+%z3)=""""  S %z4=$T(+%z3) X %z5"
 S %z2="W !,""------------- Конец листинга пpогpаммы -----------------"""
 S %z5="S %z6=$P(%z4,"" ""),%z4=%z6_$J("" "",9-$L(%z6))_$P(%z4,"" "",2,9999) X %z7"
 S %z7="S %z8=80,%z13=0 W !,$E(%z4,1,%z8-1) F  X %z9 Q:%z13"
 S %z9="S %z10=%z10+1 R:'(%z10#22) !,""--------- Press <Enter> >"",*%z11,*%z11:0,*%z11:0 X %z12"
 S %z12="S:%z8'<$L(%z4) %z13=1 I '%z13 W !,""........."",$E(%z4,%z8,%z8+69) S %z8=%z8+70" Q
 ;
]]></Routine>


<Routine name="%ZAPM.ed.BSA" type="MAC" languagemode="0"><![CDATA[
%BSA ;ПОЛНАЯ ССЫЛКА НА КЛЕТКУ ; 15:15   15.04.2003
 ;{i,j,"TAB","^PAR","UCI","SYS",k0,k1,...k9}
 ; 1 2   3      4     5     6    7  8 9 10...
A(p1,p2,p3,p4,p5,p6,p7,p8,p9,p10,p11,p12,p13,p14,p15,p16) S pp=$P($G(BSR),"^",2),ps=$S(pp'[",":$P($$ZU^%ZAPM.ed.BS3(0),",",2),1:$P(pp,$C(34),4))
 S pu=$S(pp'["[":$P($$ZU^%ZAPM.ed.BS3(0),","),1:$P(pp,$C(34),2)),pt=$G(BST) I $E(pp,1)="[" S pp=$P(pp,"]",2)
 S %zT=$ZT,$ZT="TRAP^%ZAPM.ed.BSA"
 I $D(p4) S pp=p4 I pp["^" S pp=$P(pp,"^",2)
 I $G(p3)'="" S pt=p3
 I $G(p5)'="" S pu=$TR(p5,"[]|""","") I pu["," S ps=$P(pu,",",2),pu=$P(pu,",")
 I $G(p6)'="" S ps=$TR(p6,"[]|""","") I ps["," S pu=$P(ps,","),ps=$P(ps,",",2)
 ;I $E(pp,1)="%" S pp="^"_pp ;`BSA
 S pp="^["""_pu_""","""_ps_"""]"_pp
 I $D(@(pp_"(pt,p1,p2)"))
 S bS=$ZR I $P(@(pp_"(pt,p1,p2)"),"@",9)=1 Q $P($G(@$ZR),"@",15)
 I '$D(p8),BST=pt,$$BSR(BSR)=pp Q $G(^%ZAPM.ed.BSbufB("BB"_$G(%BS(3),$P)_$J_"u"_%BS(15),p1,p2))
 S pb=$$KBD^%ZAPM.ed.BSF12($NA(@pp@(pt))),pb=$$BSD(pb,$G(p7))
 I $ZV["Cach"||($ZV["IRIS") F pi=1:1:9  Q:'$D(@("p"_(pi+7)))  S pb=pb_$S(@("p"_(pi+7))=+@("p"_(pi+7)):@("p"_(pi+7)),1:$C(34)_@("p"_(pi+7))_$C(34))_","
 E  F pi=1:1:9  Q:'$D(@("p"_(pi+7)))  S pb=pb_$S(@("p"_(pi+7))=+@("p"_(pi+7)):@("p"_(pi+7)),1:$C(34)_@("p"_(pi+7))_$C(34))_","
 S pij=p1_","_p2 I $P($G(@pp@(pt,"KEY",pi-1)),"@",6)="HiddenLastKey",$P($P(@(pp_"(pt,p1,p2)"),"@",18),"#",2)'="" D  Q $G(@$ZR,"<NO_VALUE>")
 .S pij=$P($P(@$ZR,"@",18),"#",2) I $D(@(pb_$C(34)_pij_""")"))
 I $P($P(@(pp_"(pt,p1,p2)"),"@",18),"#")'="" S pij=$P($P(@$ZR,"@",18),"#")
 I $D(@(pb_$C(34)_pij_""")")) Q @$ZR
 Q "<NO_VAL>" ;_$ZR
BSD(BSD,%NAm) ;ССЫЛКА НА УЗЕЛ БАЗЫ ДАННЫХ
 S %NAm=BSD_$G(%NAm)_$S(BSD["(":"",1:"(") I $E(%NAm,$L(%NAm))=")" S %NAm=$E(%NAm,1,$L(%NAm)-1)_","
 Q %NAm
BSR(bsr) N bs,A ;ПОЛНАЯ ССЫЛКА
 I $E(bsr,1,2)="^%" Q $$%^%ZAPM.ed.BSF12(bsr)
 ;4.;I $P($ZV,"Version ",2)'<4,bsr'["|" Q "^|"""_$P($$ZU^%ZAPM.ed.BS3(0),",")_""","""_$P($$ZU^%ZAPM.ed.BS3(0),",",2)_"""|"_$P(bsr,"^",2)
 ;4.;I $P($ZV,"Version ",2)'<4,$P(bsr,"|",2)'["," S bs=$P($P(bsr,"|",2),$C(34),2) Q "^|"""_bs_""","""_$P($$ZU^%ZAPM.ed.BS3(0),",",2)_"""|"_$P(bsr,"|",2)
 /*I $ZV["Cach"||($ZV["IRIS") D  Q A
 .S A=bsr
 .I bsr'["]" S A="^["""_$$ZU^%ZAPM.ed.BS3(0)_""",""""]"_$P(bsr,"^",2)
 .I $P($P(bsr,"]"),"[",2)'["," S A="^["""_$$ZU^%ZAPM.ed.BS3(0)_""",""""]"_$P(bsr,"]",2)
 .*/
 I bsr'["]" Q "^["""_$P($$ZU^%ZAPM.ed.BS3(0),",")_""","""_$P($$ZU^%ZAPM.ed.BS3(0),",",2)_"""]"_$P(bsr,"^",2)
 I $P($P(bsr,"]"),"[",2)'["," S bs=$P($P($P(bsr,"]"),"[",2),$C(34),2) Q "^["""_bs_""","""_$P($$ZU^%ZAPM.ed.BS3(0),",",2)_"""]"_$P(bsr,"]",2)
 Q bsr
TRAP S $ZT=$G(%zT) Q $ZE_" "_$ZR
e Q
]]></Routine>


<Routine name="%ZAPM.ed.BSB" type="MAC" languagemode="0"><![CDATA[
%BSB ;ОРГАНИЗАЦИЯ БЛОЧНОГО МЕНЮ ; 21:25   07.03.99
 ;OOO=ИМЯ МАССИВА,OO=ИНДЕКС
 N O0,O1,O2,O3,O4,O5,O6,O7,O8,O9,O10,O11,O12,O13,ORU,%b,JB,OI,o,oo,o1,o3
 S Oy=$Y,Ox=$X I $D(MouseYes) S Mouse(1)=$G(Mouse),Mouse=2
 K %GO Q:'$D(OOO)!('$D(OO))  I '$D(OOOO) Q:'$D(@(OOO_"("_OO_",1)"))
 I $D(%BS)["0" D CLr^%ZAPM.ed.BSF4
 S O3=@(OOO_"("_OO_$S($D(OOOO):")",1:",1)")),O1=1,O2=24,O0="("_OO,O4=$P(O3,"@",3) W /CUP(24,1) D O3
 D  K Dark S Mouse=$G(Mouse(1)) Q  ;O4=РАЗДЕЛИТЕЛЬ,O5=БЛОКИ--->O6=НОМЕР ВЫБРАННОГО БЛОКА
1 .K %JB,ORU S %JB=0,O0=OOO_"("_OO_$S($D(OOOO):"",1:",1"),ORU(1)=@(O0_")"),%JB(1)=$P(O0,OOO_"("_OO_",1,",2)
11 .S O3=ORU(1) D O3 D  W $$clr^%ZAPM.ed.BS3(8),$P(O3,"@") S O4=$P(O3,"@",3),O6=1,O5=$P(O3,"@") S:$D(%B) O6=%B+0 D USS S %B=O6,%b(1)=O6 I O3="^" D END Q
 ..Q:$P(O3,"@",4)=0  I O2'<0 S O6=$P(O3,"@",4),O4=$L($P(O3,"@"))-$L(O6)\2 W /CUP(O2-1,O1),$TR($J(0,O4)," 0","--")_O6_$TR($J(0,O4)," 0","--"),/CUP(O2,O1)
 ..I O2'>22 W /CUP(O2+1,O1),$TR($J(0,$L($P(O3,"@"))),"0 ","--"),/CUP(O2,O1)
 .I '$D(@(O0_","_O6_")")) D END Q
2 .S %B=1 W /CUP(O2,O1) D CLEA S O0=O0_","_O6,ORU(2)=@(O0_")"),%JB(2)=$P(O0,OOO_"("_OO_",1,",2)
22 .S O3=ORU(2) D O3 W $$clr^%ZAPM.ed.BS3(8),$P(O3,"@") D  S O4=$P(O3,"@",3),O5=$P(O3,"@"),O6=%B D USS S %B=O6,%b(2)=O6 I O3="^" S %B=%b(1) G 11
 ..Q:$P(O3,"@",4)=0  I O2'>22 W /CUP(O2+1,O1),$TR($J(0,$L($P(O3,"@"))),"0 ","--"),/CUP(O2,O1)
 .I '$D(@(O0_","_O6_")")) D END Q
3 .S %B=1 W /CUP(O2,O1) D CLEA S O0=O0_","_O6,ORU(3)=@(O0_")"),%JB(3)=$P(O0,OOO_"("_OO_",1,",2)
33 .S O3=ORU(3) D O3 W $$clr^%ZAPM.ed.BS3(8),$P(O3,"@") D  S O4=$P(O3,"@",3),O6=%B,O5=$P(O3,"@") D USS S %B=O6,%b(3)=O6 I O3="^" S %B=%b(2) G 22
 ..Q:$P(O3,"@",4)=0  I O2'>22 W /CUP(O2+1,O1),$TR($J(0,$L($P(O3,"@"))),"0 ","--"),/CUP(O2,O1)
 .I '$D(@(O0_","_O6_")")) D END Q
4 .S %B=1 W /CUP(O2,O1) D CLEA S O0=O0_","_O6,ORU(4)=@(O0_")"),%JB(4)=$P(O0,OOO_"("_OO_",1,",2)
44 .S O3=ORU(4) D O3 W $$clr^%ZAPM.ed.BS3(8),$P(O3,"@") D  S O4=$P(O3,"@",3),O6=%B,O5=$P(O3,"@") D USS S %B=O6,%b(4)=O6 I O3="^" S %B=%b(3) G 33
 ..Q:$P(O3,"@",4)=0  I O2'>22 W /CUP(O2+1,O1),$TR($J(0,$L($P(O3,"@"))),"0 ","--"),/CUP(O2,O1)
 .I '$D(@(O0_","_O6_")")) D END Q
5 .S %B=1 W /CUP(O2,O1) D CLEA S O0=O0_","_O6,ORU(5)=@(O0_")"),%JB(5)=$P(O0,OOO_"("_OO_",1,",2)
55 .S O3=ORU(5) D O3 W $$clr^%ZAPM.ed.BS3(8),$P(O3,"@") D  S O4=$P(O3,"@",3),O6=%B,O5=$P(O3,"@") D USS S %B=O6,%b(5)=O6 I O3="^" S %B=%b(4) G 44
 ..Q:$P(O3,"@",4)=0  I O2'>22 W /CUP(O2+1,O1),$TR($J(0,$L($P(O3,"@"))),"0 ","--"),/CUP(O2,O1)
 .I '$D(@(O0_","_O6_")")) D END Q
6 .S %B=1 W /CUP(O2,O1) D CLEA S O0=O0_","_O6,ORU(6)=@(O0_")"),%JB(6)=$P(O0,OOO_"("_OO_",1,",2)
66 .S O3=ORU(6) D O3 W $$clr^%ZAPM.ed.BS3(8),$P(O3,"@") D  S O4=$P(O3,"@",3),O6=%B,O5=$P(O3,"@") D USS S %B=O6,%b(6)=O6 I O3="^" S %B=%b(5) G 55
 ..Q:$P(O3,"@",4)=0  I O2'>22 W /CUP(O2+1,O1),$TR($J(0,$L($P(O3,"@"))),"0 ","--"),/CUP(O2,O1)
 .I '$D(@(O0_","_O6_")")) D END Q
e Q
O3 I $E($G(%BS(14)),2) S o3=$P($TR(O3,"йцукенгшщзхъэждлорpпавыфячсмитьбюё",""),"@")_"@"_$P(O3,"@",2,999)
 E  S o3=$P($TR(O3,"йцукенгшщзхъэждлоpрпавыфячсмитьбюё","ЙЦУКЕНГШЩЗХЪЭЖДЛОРРПАВЫФЯЧСМИТЬБЮЁ"),"@")
 I $D(@("Dark("_$P(O0,"(",2,999)_")"))'["0" S oo=("Dark("_$P(O0,"(",2,999)_")") D
 .F o=2:1 Q:$P(@oo,O4,o,999)=""  I $P(@oo,O4,o) S o1=$TR($P(o3,O4,o),"_",$C(254)),o1=$C(254)_$E(o1,2,$L(o1)-1)_$C(254),$P(o3,O4,o)=o1
 S O3=o3_"@"_$P(O3,"@",2,999) Q
CLEA W $$atr^%ZAPM.ed.BS3(0),/EL(0) Q
USS ;ВЫБОР БЛОКА O4=РАЗДЕЛИТЕЛЬ,O5=БЛОКИ--->O6=НОМЕР ВЫБРАННОГО БЛОКА
 D CL^%ZAPM.ed.BSF4 K %GO S %JB=%JB+1,O13="" S:$P(O5,O4,O6+1)="" O6=1 I $P(O3,"@",5)'="" S O13="W /CUP(O2+1,O1),$$atr^%ZAPM.ed.BS3(0),$G(@(OOO_""(""_$P(O3,""@"",5)_"","
R X:O13'="" O13_O6_")"")) W /EL(0)" S O7=$P(O5,O4,O6+1),O8=$F(O5,O7)-2,O9=O8-$L(O7)+O1 W /CUP(O2,O9),$$clr^%ZAPM.ed.BS3(9)," ",O7," ",$$clr^%ZAPM.ed.BS3(8),/CUP(O2,O9)
 S $Y=Oy,$X=Ox W $$rt^%ZAPM.ed.BS3(+%BS(2)) I R1=13!(R1=46) G SU
 I R1=27,R2=79,R3=80 G:$P($P(O3,"@",8),";",O6)="" R S IYI=$P(O3,"@",2)_","_$P($P(O3,"@",8),";",O6) D NE^%ZAPM.ed.BSN G R
 I R1=27,R2=79 G R
 I R1=27,R2=91!(R2=-1) D  G SU:O8="S",SUEN:O3="^",R
 .I R3=65!(R3<0) S O3="^" K ORU(%JB),%JB(%JB) W /CUP(O2,O1),$$atr^%ZAPM.ed.BS3(0),/EL(0) S O0=$P(O0,",",1,$L(O0,",")-1),%JB=%JB-2 Q  ;Л
 .I R3=66 S O8="S" Q  ;V
 .I R3=67 D SS S O6=O6+1 D  Q  ;-->
 ..I $P(O5,O4,O6+1)="" S O6=1 Q
 .I R3=68 D SS S O6=O6-1 D  Q  ;<--
 ..I $P(O5,O4,O6+1)="" S O6=$L(O5,O4)-2 Q
 I R1=27 G R
 I R1=0,R2=113,$E(%BS(1),3) D CM^%ZAPM.ed.BSF6 G R
 I R1=0,R2=33 G SUEN ;АТАВИЗМ !!! D AF^%ZAPM.ed.BSF6 G R ;!!!!
 I R1=0,(R2=139!(R2=140)!(R2=84)!(R2=88)) D AltKey^%ZAPM.ed.BSF8 G R
 I R1=0 G R
 G R ;!!!I R1<96 G SU
 D SS S O10=$C(R1),O11=O6 K O12
 F O6=1:1 S O7=$P(O5,O4,O6+1) Q:O7=""  I O7[O10 F OI=1:1:$L(O7) I $E(O7,OI)'=" " Q:$E(O7,OI)'=O10  S O12=O6 G RR
RR I $D(O12) S O6=O12 G SU
 S O6=O11 G R
SS ;СТИРАНИЕ ТЕКУЩЕГО БЛОКА
 S O7=$P(O5,O4,O6+1),O8=$F(O5,O7)-2,O9=O8-$L(O7)+O1 W /CUP(O2,O9),O4,O7,O4 Q
END K %b,OI,ORU,O0,O1,O2,O3,O4,O5,O6,O7,O8,O9,O10,O11,O12,O13 Q
SU ;ОКОНЧАНИЕ ВЫБОРА БЛОКА
 I $D(@("Dark("_$P(O0,"(",2,999)_")"))'["0",$P(@("Dark("_$P(O0,"(",2,999)_")"),O4,O6+1) W $$bel^%ZAPM.ed.BS3 G R
 I $P($P(O3,"@",6),";",O6)'="" X $P($P(O3,"@",6),";",O6) W /CUP(O2,O1),$$atr^%ZAPM.ed.BS3(0),/EL(0),$$clr^%ZAPM.ed.BS3(8),$P(O3,"@") G R
 I $P($P(O3,"@",7),";",O6)'="" S %GO=$P($P(O3,"@",7),";",O6)
SUEN W $$atr^%ZAPM.ed.BS3(0),/CUP(24,1),/EL(0)
 Q
]]></Routine>


<Routine name="%ZAPM.ed.BSBD" type="MAC" languagemode="0"><![CDATA[
%BSBD ;СОХРАНЕНИЕ / ВОССТАНОВЛЕНИЕ УЗЛОВ БАЗ ДАННЫХ ; 10:13   06.11.2001
COPYD ;ДАТАМ
 S l1=$$h^%ZAPM.ed.BS3() D D1 Q:'$D(da)  D SAVE Q
COPYH ;ГОРЯЧИЕ
 D DATE S hot=1 D SAVE Q
COPYU ;ПОЛЬЗОВАТЕЛЬ
 D DATE,POL Q:'$D(pol)  D SAVE Q
ALL D SAVE Q  ;ВСЮ
POL S ls=" ВВЕДИТЕ ИМЯ ПОЛЬЗОВАТЕЛЯ ",li="" D LE^%ZAPM.ed.BSTT I 'YES Q
 S pol=li Q
DATE S ls=" Будем опpеделять диапазон дат ? " D YES^%ZAPM.ed.BSF I 'YES Q
 S l1=$$h^%ZAPM.ed.BS3() K da
D1 S ls=" ОТ КАКОЙ ДАТЫ",li=$$ESDAY^%ZAPM.ed.BSsFUNR(6,l1) D LE^%ZAPM.ed.BSTT Q:'YES  S da(1)=$$DAT^%ZAPM.ed.BSsFUNR(6,li) I 'YES S ls=" ОШИБКА ДАТЫ " D WAITS^%ZAPM.ed.BSF2 G D1
 S (l1,da(1))=$$DATHR^%ZAPM.ed.BSsFUNR(6,da(1))
D2 S ls=" ДО КАКОЙ ДАТЫ",li=$$ESDAY^%ZAPM.ed.BSsFUNR(6,l1) D LE^%ZAPM.ed.BSTT G:'YES D1 S da(2)=$$DAT^%ZAPM.ed.BSsFUNR(6,li) I 'YES S ls=" ОШИБКА ДАТЫ " D WAITS^%ZAPM.ed.BSF2 G D2
 S da(2)=$$DATHR^%ZAPM.ed.BSsFUNR(6,da(2)) Q
D I $G(EndINDi)=1 Q
 G D^%ZAPM.ed.BS
CopyTree() N %NAm,%iii,ii,i,OT,KU,U
 I $$ErrUz Q 0
 S %iii=d
 N d,dat,date,WA,BSR,BST,Qu,i,%0
 S i=$$LOAD^%ZAPM.ed.BSscrF("^%ZAPM.ed.BSVOL(CopyTree)",2,2,"§","CopyTrP^%ZAPM.ed.BSBD") I R1=27 Q 0
 S j=0 F ii=1:2:15 S OT(j)=$P(i,"§",ii),KU(j)=$P(i,"§",ii+1),j=j+1 I $P(i,"§",ii+2)="" S U=j-1 Q
 F j=1:1:U I $G(OT(j))="" S i="ИСТОЧНИКА" Q
 F j=1:1:U I $G(KU(j))="" S i="ПОЛУЧАТЕЛЯ" Q
 I i'["§" D ErrMsg^%ZAPM.ed.BSXfun("У "_i_" введены ПУСТЫЕ КЛЮЧИ !") Q 0
 S OT=$$SSYL(U,.OT),KU=$$SSYL(U,.KU)
 I $L(OT,",")'=$L(KU,",") D ErrMsg^%ZAPM.ed.BSXfun("Количество уровней ИСТОЧНИКА и ПОЛУЧАТЕЛЯ не совпадает !") Q 0
 I '$$Data^%ZAPM.ed.BSF12(OT) D ErrMsg^%ZAPM.ed.BSXfun("В УЗЛЕ ИСТОЧНИКА данных НЕТ ! "_OT) Q 0
 I OT=KU D ErrMsg^%ZAPM.ed.BSXfun("ИСТОЧНИК и ПОЛУЧАТЕЛЬ совпадает !") Q 0
 I $$Data^%ZAPM.ed.BSF12(KU) D Yes^%ZAPM.ed.BSXfun("В УЗЛЕ ПОЛУЧАТЕЛЯ уже имеются данные ! Смешиваем ?") I YES<1 Q 0
 D Yes^%ZAPM.ed.BSXfun("Копируем "_OT_" в "_KU_" Вы УВЕРЕНЫ ?") I YES<1 Q 0
 I $D(@$QS(KU,0))["0",$D(@$QS(OT,0))'["0" S @$QS(KU,0)=@$QS(OT,0)
 D Copy^%ZAPM.ed.BSF8(OT,KU,1,1)
 Q 1
SSYL(key,%KEYS) N %NAm,ii S %NAm=BSD_$G(%KEYS(0))
 F ii=1:1:key Q:'$D(%KEYS(ii))  S %NAm=$NA(@%NAm@(%KEYS(ii)))
 Q %NAm
CopyTrP ;ПРЕДОБРАБОТКА ТАБЛИЦЫ
 N m,i,ii
 S $P(@BSR@(BST,2,2),"@",15)=$G(%KEYS(0)) I key=0 S $P(@BSR@(BST,2,2),"@",15)=%iii
 S $P(@BSR@(BST,2,4),"@",15)=$G(%KEYS(0)) I key=0 S $P(@BSR@(BST,2,4),"@",15)=%iii
 S i=2 F ii=1:1:key-1 Q:'$D(%KEYS(ii))  S i=i+2 F m=2,4 S $P(@BSR@(BST,i,m),"@",15)=$G(%KEYS(ii))
 I key'=0 S i=i+2,$P(@BSR@(BST,i,2),"@",15)=%iii
 Q
 ;ЗАКАЧКА В ТОБД ИНДЕКСЫ 1 УРОВНЯ БАЗЫ DDR
ZAKDDR S BDDR=$$KBD^%ZAPM.ed.BSF12($$DDRTOBD) I '$$Data^%ZAPM.ed.BSF12(BDDR) S ls="НЕДОСТУПНА БД DDR="_BDDR Q
 S I="" F  S I=$O(@BDDR@(I)) Q:I=""  S BD=$G(@BDDR@(I,"^","S")) F II=1:1 Q:$P(BD,"#",II,II+1)=""  S BDD=$P(BD,"#",II) I $$Data^%ZAPM.ed.BSF12(BDD) D
 .I '$D(@BDD@("DDR")) W !,BDD S @BDD@("DDR")=I
 Q
DDRTOBD() N A S A="" I $ZU(5)="FON" S A="2005" //БД ОПИСАНИЯ ФОРМ ВВОДА
 Q $NA(^%ZAPM.ed.BSMDDR("DDR"_A))
SINDDR(d) N BDDR ;СИНТАКСИЧЕСКИЙ КОНТРОЛЬ ДЛЯ КЛЕТКИ {12,7} ТОК
 S BDDR=$$KBD^%ZAPM.ed.BSF12($$DDRTOBD^%ZAPM.ed.BSBD) 
 I '$$Data^%ZAPM.ed.BSF12(BDDR) S ls="НЕДОСТУПНА БД DDR="_BDDR X "I 0" Q 0
 I '$D(@BDDR@(d)) S ls="НА 1 УРОВНЕ БД DDR НЕТ КЛЮЧА="_d X "I 0" Q 0
 Q 1
PFL1(d) ;ПФЛ
 N ST I key=0 S A6=A1_d
 E  S A6=$NA(@A1@(d))
 I $QL(A6)=A5 D PFL3(A6) Q
 S U1="" F  S U1=$O(@A6@(U1)) Q:U1=""  D
 .I $QL($NA(@A6@(U1)))=A5 D PFL3($NA(@A6@(U1))) Q
 .S U2="" F  S U2=$O(@A6@(U1,U2)) Q:U2=""  D
 ..I $QL($NA(@A6@(U1,U2)))=A5 D PFL3($NA(@A6@(U1,U2))) Q
 ..S U3="" F  S U3=$O(@A6@(U1,U2,U3)) Q:U3=""  D
 ...I $QL($NA(@A6@(U1,U2,U3)))=A5 D PFL3($NA(@A6@(U1,U2,U3))) Q
 ...S U4="" F  S U4=$O(@A6@(U1,U2,U3,U4)) Q:U4=""  D
 ....I $QL($NA(@A6@(U1,U2,U3,U4)))=A5 D PFL3($NA(@A6@(U1,U2,U3,U4))) Q
 ....S U5="" F  S U5=$O(@A6@(U1,U2,U3,U4,U5)) Q:U5=""  D
 .....I $QL($NA(@A6@(U1,U2,U3,U4,U5)))=A5 D PFL3($NA(@A6@(U1,U2,U3,U4,U5))) Q
 .....S U6="" F  S U6=$O(@A6@(U1,U2,U3,U4,U5,U6)) Q:U6=""  D
 ......I $QL($NA(@A6@(U1,U2,U3,U4,U5,U6)))=A5 D PFL3($NA(@A6@(U1,U2,U3,U4,U5,U6))) Q
 ......S U7="" F  S U7=$O(@A6@(U1,U2,U3,U4,U5,U6,U7)) Q:U7=""  D
 .......I $QL($NA(@A6@(U1,U2,U3,U4,U5,U6,U7)))=A5 D PFL3($NA(@A6@(U1,U2,U3,U4,U5,U6,U7))) Q
 .......S U8="" F  S U8=$O(@A6@(U1,U2,U3,U4,U5,U6,U7,U8)) Q:U8=""  D
 ........I $QL($NA(@A6@(U1,U2,U3,U4,U5,U6,U7,U8)))=A5 D PFL3($NA(@A6@(U1,U2,U3,U4,U5,U6,U7,U8))) Q
 ........S U9="" F  S U9=$O(@A6@(U1,U2,U3,U4,U5,U6,U7,U8,U9)) Q:U9=""  D
 .........D PFL3($NA(@A6@(U1,U2,U3,U4,U5,U6,U7,U8,U9))) Q
 Q
PFL3(S) ;ПФЛ
 N ST,STT
 D ST("{") S STT="NODE_DDR="_A2
 I $D(%KEYS(0)) S STT=STT_" KEY0="_%KEYS(0)
 I key=0 S STT=STT_" KEY0="_d
 F U=1:1:$QL(S) S STT=STT_" KEY"_U_"="_$QS(S,U)
 D ST(STT)
 D LOOP(S),ST("}") I '$$KOR U 0 Q
 U %DEV S ST="" F  S ST=$O(ST(ST)) Q:ST=""  U %DEV W ST(ST),!
 S DOKS=DOKS+1 U 0 X WA Q
LOOP(U) N PO,Y,X,X1 ;ЦИКЛ ПО УРОВНЮ ДАННЫХ
 I YXX1 D  Q
 .S Y=$P(YXX1,","),Y1=0
 .F X=$P(YXX1,",",2):2:$P(YXX1,",",3) S Y1=Y1+1 I $G(@U@(Y_","_X))'="" D ST($$0(Y1)_"="_@U@(Y_","_X))
 S PO="" F  S PO=$O(@U@(PO)) Q:PO=""  D ST(PO_"="_@U@(PO))
 Q
KOR() ;ПРИЗНАК ВТОРИЧНСТИ ДОКУМЕНТА
 I $G(KOR)="" Q 1
 N KOR1
 I $G(KOR)'="" D  I $D(KOR1) Q 1
 .S ST="" F  S ST=$O(ST(ST)) Q:ST=""  X KOR I  S KOR1=1 Q
 Q 0
0(I) Q $S(I?1N:"00",I?2N:"0",1:"")_I
ST(S) S ST=$G(ST)+1,ST(ST)=S
 Q
PFL() ;ВЫВОД В ФОРМАТЕ ПЕРФОЛЕНТЫ
 I $$ErrUz Q 0
 N A1,A2,A3,A4,A5,i,j,%DEV,%FN,A6
 N U1,U2,U3,U4,U5,U6,U7,U8,U9,U,YXX1,DOKS,STOP,KOR,pO,cHOSe
 S A3=d N d
 S A2=$G(@Bsr@(Bst,"DDR")) I A2="" D ErrMsg^%ZAPM.ed.BSXfun("В ТАБЛИЦЕ ОПИСАНИЯ КЛЮЧЕЙ НЕТ ССЫЛКИ НА БАЗУ ДАННЫХ DDR !") Q 0
 S A1=$$SSYL(key-1,.%KEYS)
 S A4=$$KBD^%ZAPM.ed.BSF12($$DDRTOBD),A4=$NA(@A4@(A2)) I '$$Data^%ZAPM.ed.BSF12(A4) D ErrMsg^%ZAPM.ed.BSXfun("НЕ ДОСТУПЕН УКАЗАТЕЛЬ НА ССЫЛКУ БАЗУ ДАННЫХ DDR="_A4) Q 0
 S A5=$O(@Bsr@(Bst,"KEY",""),-1),YXX1=$G(@A4@("^","YXX1")),DOKS=0,KOR=$G(@A4@("^","W"))
 D DOSOPN^%ZAPM.ed.BSBL1 Q:'$D(%FN) 0 U %DEV W ";%BS-FORMAT. "_$S($ZV["Cach"||($ZV["IRIS"):"Windows Text (Cirillic, 1251)",1:"MS-DOS Text (Cirillic, 866)"),!
 S pO="IF ST(ST)["""_KOR_"=1""" I $G(^%ZAPM.ed.BSbufB("HISTPFLF5",1))'="" S pO=^%ZAPM.ed.BSbufB("HISTPFLF5",1)
 U 0 I KOR'="" S KOR=$$LineEdit^%ZAPM.ed.BSXfun(pO,"ВВЕДИТЕ ДОПОЛНИТЕЛЬНОЕ УСЛОВИЕ ВЫВОДА ДОКУМЕТОВ (F1-ПОМОЩЬ)","","","^%ZAPM.ed.BSHLP,PFLF5","^%ZAPM.ed.BSbufB(""HISTPFLF5"")") I YES<1 S KOR=""
 D Wait^%ZAPM.ed.BSXfun("ВЫВОД В ФОРМАТЕ ПЕРФОЛЕНТЫ")
 D
 .I $D(%DIA) S do="I i>2 S A3=$P(^(j),""@"",15) I A3'="""" D PFL1^%ZAPM.ed.BSBD(A3)" D BLOK^%ZAPM.ed.BSF1 Q
 .D PFL1(A3)
 U %DEV W !,$$KOLDOK
 C %DEV U 0
 D OkMsg^%ZAPM.ed.BSXfun($$KOLDOK)
 Q 0
KOLDOK() I $G(DOKS) Q ";ВЫВЕДЕНО "_$G(DOKS)_" ДОКУМЕНТ(А,ОВ) !"
 Q ";НЕ ВЫВЕДЕНО НИ ОДНОГО ДОКУМЕНТА !"
ErrUz() I '(key>0&(ny<4)) Q 0
 I '(key=0&(ny<3)) Q 0
 D ErrMsg^%ZAPM.ed.BSXfun("УКАЗАТЕЛЬ НАХОДИСЯ НЕ НА УЗЛЕ БАЗЫ ДАННЫХ !")
 Q 1
ToBu(U) S A5=$G(A5)+1 D Copy^%ZAPM.ed.BSF8($NA(@A1@(U)),$NA(@A2@(U)),1,1) Q
ToBuff() ;копи в буфер
 I $$ErrUz Q 0
 N A1,A2,A3,A4,A5 S A4=d N d
 S A1=$$SSYL(key-1,.%KEYS),A2="^%ZAPM.ed.BSbufB(""NodeBaseToBu1"")" K @A2 D
 .I $D(%DIA) S do="I i>2 S A3=$P(^(j),""@"",15) I A3'="""" D ToBu^%ZAPM.ed.BSBD(A3)" D BLOK^%ZAPM.ed.BSF1 Q
 .D ToBu(A4)
 S ^%ZAPM.ed.BSbufB("NodeBaseToBu2")=A1
 D OkMsg^%ZAPM.ed.BSXfun("В БУФЕР СКОПИРОВАЛИ "_A5_" УЗЕЛ(ОВ,А)") Q 0
BuffTo() ;буфер в базу
 N A1,A2,A3,A4,A5 S A4=d N d
 S A1=$$SSYL(key-1,.%KEYS),A2="^%ZAPM.ed.BSbufB(""NodeBaseToBu1"")",A3=$G(^%ZAPM.ed.BSbufB("NodeBaseToBu2"))
 I A3="" D ErrMsg^%ZAPM.ed.BSXfun("БУФЕР ПУСТОЙ !") Q 0
 I $P(A3,"(")'=$P(A1,"(") D Yes^%ZAPM.ed.BSXfun("БАЗЫ ДАННЫХ РАЗНЫЕ ! "_A1_" и "_A3_" ВЫ УВЕРЕНЫ ?") I YES<1 Q 0
 S A5=$$LineEdit^%ZAPM.ed.BSXfun(A1,"КОПИРУЕМ ИЗ "_A3_" В ...")
 I $QL(A5)'=$QL(A3) D ErrMsg^%ZAPM.ed.BSXfun("КОЛИЧЕСТВО УРОВНЕЙ НЕ СОВПАДАЕТ ! "_A5_" и "_A2) Q 0
 I $$Data^%ZAPM.ed.BSF12(A5) D Yes^%ZAPM.ed.BSXfun("УЗЕЛ БАЗЫ ДАННЫХ УЖЕ СУЩЕСТВУЕТ ! "_A5_". СМЕШИВАЕМ, ВЫ УВЕРЕНЫ ?") I YES<1 Q 0
 I $D(@$QS(A5,0))["0" S @$QS(A5,0)=@$QS(A3,0)
 D Copy^%ZAPM.ed.BSF8(A2,A5,1,1)
 Q 1
SAVE D DOSOPN^%ZAPM.ed.BSBL1 I '$D(%FN) K %DEV Q  ;СОХРАНЕНИЕ УЗЛОВ БАЗЫ ДАННЫХ
 S %NAm=BSD_$G(%KEYS(0))
 I key=0 S %NAm=BSD_%iii
 S po=endkey I $D(@%NAm)
 S ls="СОХРАНЕНИЕ..."_BSD_" "_$S($D(da):"ПО ДАТАМ ",1:"")_$S($D(hot):"ГОРЯЧЕЕ ",1:"")_$S($D(pol):"ПОЛЬЗОВАТЕЛЬ "_pol,1:"") D WAITS^%ZAPM.ed.BSF2 S c=$ZR
 F  S c=$ZO(@c) Q:c=""  D  U 0 Q:c=""
SA .Q:$P(c,",",po)'[")"  S mE=@c,YES=1 D  Q:'YES  S:$D(hot) $P(@c,",",4)="" S cc=c,ccc=$P(cc,")") D NEW U %DEV W c,!,@c,! F  S cc=$ZO(@cc) Q:cc=""!(cc'[ccc)  U %DEV W:$G(@cc)'="" cc,!,$G(@cc),! U 0 X WA
 ..I $D(da) S md=+$TR($P(mE,",",1,2),",",".") I '(da(1)'>md&(da(2)'<md)) S YES=0 Q  ;Y2000
 ..I $D(hot) I '$P(mE,",",4) S YES=0 Q
 ..I $D(pol) I $P(mE,",",3)'=pol S YES=0 Q
 .S c=$G(cc) Q:c=""  G SA
 K c1,%3,%1,%2,c,cc,ccc,mE,po
SAVEND Q:'$D(%NEWRITE)  U %DEV W "*",!,"*",!,"**",!,"**",! Q
NEW Q:$D(%NEWRITE)  S %NEWRITE=1,%0=$$ESDAY^%ZAPM.ed.BSsFUNR(9,$$h^%ZAPM.ed.BS3()) U %DEV W %0,!,";BASE@"_$P(c,"(")_"@"_@BSD_"@"_po,! Q
COPY S OO=33,OOO="^%ZAPM.ed.BS" K %JB D  D 24^%ZAPM.ed.BSTM,^%ZAPM.ed.BSB,ZA^%ZAPM.ed.BSF K Dark G:R1=27 D
 .K Dark I $G(%BS("Tmp","AKBD",BSD),"RWD")'="RWD" S Dark(33,1)=" 1 1 1 1 1 0"
 I '$D(%JB(2)),%B=6 S Tmp=$$PFL() S $ZT=$G(%zT) G D:'$G(Tmp) S R1=27 Q
 I '$D(%JB(2)),%B=5 S Tmp=$$BuffTo() S $ZT=$G(%zT) G D:'$G(Tmp) S R1=27 Q
 I '$D(%JB(2)),%B=4 S Tmp=$$ToBuff() S $ZT=$G(%zT) G D:'$G(Tmp) S R1=27 Q
 I '$D(%JB(2)),%B=3 S Tmp=$$CopyTree() S $ZT=$G(%zT) G D:'$G(Tmp) S R1=27 Q
 I '$D(%JB(2)),%B=2 D REST S $ZT=$G(%zT) G D:'$D(%FN) K %FN,%DEV S R1=27 Q
 K %FN,DEV S %zT=$ZT,$ZT="ER^%ZAPM.ed.BSS1" D  S $ZT=$G(%zT),%DIAP="" K mE,md,hot,pol,da,PR1 G:'$D(%FN) D C %DEV K %DEV,%FN,%NEWRITE G 71^%ZAPM.ed.BSF5
 .S PR1="?:\???.%BD" I %B=1 D  Q
 ..I $D(%DIA) S do="I i>2 S %iii=$P(^(j),""@"",15) D COP^%ZAPM.ed.BSBD" D BLOK^%ZAPM.ed.BSF1,COPE Q
 ..S %iii=d D COP,COPE Q
 .K pol,hot I %B=2 D COPYD Q
 .I %B=3 D COPYH Q
 .I %B=4 D COPYU Q
 .I %B=5 D ALL Q
COP D DOSOPN^%ZAPM.ed.BSBL1 I '$D(%FN) K %DEV Q  ;СОХРАНЕНИЕ
 S po=endkey,%NAm=$$BSD^%ZAPM.ed.BSA(BSD,$G(%KEYS(0))) F ii=1:1:key-1 Q:'$D(%KEYS(ii))  S %NAm=%NAm_$S(%KEYS(ii)=+%KEYS(ii):%KEYS(ii),1:$C(34)_%KEYS(ii)_$C(34))_","
 I key=0 S %NAm=BSD_%iii G CO
 S %NAm=%NAm_$S(%iii=+%iii:%iii,1:$C(34)_%iii_$C(34))_")"
CO I $D(@%NAm)
 S ls="СОХРАНЕНИЕ..."_%NAm D WAITS^%ZAPM.ed.BSF2 S c=$ZR,cc=$P($ZR,")") I '$D(%NEWRITE) S %NEWRITE=1,%0=$$ESDAY^%ZAPM.ed.BSsFUNR(9,$$h^%ZAPM.ed.BS3()) U %DEV W %0,!,";BASE@"_$P(c,"(")_"@"_$G(@BSD)_"@"_po,!
 D  F  S c=$ZO(@c) Q:c=""!(c'[cc)  D  U 0 X WA
 .U %DEV W:$G(@c)'="" c,!,$G(@c),!
 K c1,%3,%1,%2,c,cc Q
COPE Q:'$D(%NEWRITE)  U %DEV W "*",!,"*",!,"**",!,"**",! Q
REST D DOSREAD^%ZAPM.ed.BSS1 I '$D(%FN) K %DEV Q  ;ВОССТАНОВЛЕНИЕ УЗЛОВ БАЗЫ ДАННЫХ
 S %zT=$ZT,$ZT="ER^%ZAPM.ed.BSS1"
 U %DEV R %CO F  U %DEV R %IN U 0 G:$ZC'=0 CLO^%ZAPM.ed.BSS1 D RES G:$ZC'=0!(%IN="**")!($ZE["<ENDOFFILE") CLO^%ZAPM.ed.BSS1
 S $ZT=$G(%zT),ls=" В Файле "_%FN_" Баз Данных не найдено " D O^%ZAPM.ed.BSF7 G CLO^%ZAPM.ed.BSS1
RES I $E(%IN,1,6)[";BASE" U 0 S ls=" Восстановим:"_$P(%IN,"@",2)_" " D YES^%ZAPM.ed.BSF I YES G I
e Q
I S li=$P(%IN,"@",2),ll="@",ls="Корректируйте имя Восстанавливаемой Базы Данных. <Esc>-Отмена" S:li["]" li="^"_$P(li,"]",2) S li=$$BSR^%ZAPM.ed.BSA(li) D LE^%ZAPM.ed.BSTT Q:'YES
 Q:li=""  S:li'["^" li="^"_li S %zT=$ZT,$ZT="ERR^%ZAPM.ed.BSS1"
 I $D(@(li)) S ls=" База Данных "_li_" Уже существует ! Пишем свеpху ? " D YES^%ZAPM.ed.BSF G I:'YES S %NAM=BSR,%TAB=BST D PASE^%ZAPM.ed.BS1 I '$D(%w(4)) G I
 ; !!! S %NAM=%NA ПРОВЕРКА НА СУЩЕСТВОВАНИЕ !!!!! РАЗНЫЕ ИМЕННЫЕ КЛЮЧИ !!!!!! ДОДЕЛАТЬ
 S $ZT=$G(%zT),BSd=li,ls="ВОССТАНОВЛЕНИЕ..."_BSd D WAITS^%ZAPM.ed.BSF2 F  U %DEV R %IN,%VA U 0 Q:$ZC'=0!(%IN="")!(%IN="**")  X WA I %IN'="*" S @(BSd_$S(%IN["(":"(",1:"")_$P(%IN,"(",2,999))=%VA
 Q:$ZC'=0  Q
FIND ;ПОИСК КЛЮЧЕЙ НАХОДЯСЬ В КЛЮЧАХ
 K da,hot,mE,po,pol,lk,END
 G D:key=0,B1:key'=endkey S m=" КЛЮЧЕЙ ПО_ДАТЕ_МОДИФИКАЦИИ ПО_ПОЛЬЗОВАТЕЛЮ ГОРЯЧИХ_DDR ЛЮБЫХ_ГОРЯЧИХ " D MENU^%ZAPM.ed.BSF5(m," ОПРЕДЕЛИТЕ РЕЖИМ ПОИСКА ") I R1=27 G D
 G @("B"_%B)
B1 S ls=" ВВЕДИТЕ ЗНАЧЕНИЕ КЛЮЧА,КОТОРЫЙ БУДЕМ ИСКАТЬ ",li="" D LE^%ZAPM.ed.BSTT I 'YES G D
 I li["@" D FINDKEY^%ZAPM.ed.BSIND(li,ny,nx,BSR,BST) G:$G(END)=2 NEWKEY,D ;ИНДЕКСИРОВАННЫЕ КЛЮЧИ
 S lk=li G FIN
B2 S l1=$$h^%ZAPM.ed.BS3() D D1 G D:'$D(da),FIN
B3 D DATE,POL G D:'$D(pol),FIN
B4 D DATE S hot=2 G FIN
B5 D DATE S hot=1 G FIN
FIN S %NAm=BSD_$G(%KEYS(0))
 S po=endkey I $D(@%NAm)
 S c=$ZR D SAY I $D(lk) D FIND^%ZAPM.ed.BS2(c,lk,key,"S c=$ZR D NAS^%ZAPM.ed.BSBD") G FINAL
 F  S c=$ZO(@c) Q:c=""!($D(END))  D  U 0 Q:c=""!($D(END))  X WA
 .;~~I $D(lk),("@"_$P($P($P(c,"(",2),")"),",",key))[("@"_lk) D NAS Q:$D(END)
 .;~~~I $D(lk),("@"_$P($P($P(c,"(",2),")"),",",key))[("@"_lk) I $P($P($P(c,"(",2),")"),",",key+1)="" D NAS Q:$D(END)
FI .Q:$P(c,",",po)'[")"  Q:$D(END)!($D(lk))  S mE=@c,YES=1 D  Q:'YES  D NAS
 ..I $D(da) S md=+$TR($P(mE,",",1,2),",",".") I '(da(1)'>md&(da(2)'<md)) S YES=0 Q  ;Y2000
 ..I $D(hot) I hot'=$P(mE,",",4) S YES=0 Q
 ..I $D(pol) I $P(mE,",",3)'=pol S YES=0 Q
FINAL G:$G(END)=2 NEWKEY I '$D(END) S ls=" КЛЮЧ НЕ НАЙДЕН " D O^%ZAPM.ed.BSF7
 K c1,%3,%1,%2,c,cc,ccc,mE,po,m
 G D
SAY S ls="ПОИСК..."_BSD_" "_$S($D(da):"ПО ДАТАМ ",1:"")_$S($D(hot):"ГОРЯЧЕЕ ",1:"")_$S($D(pol):"ПОЛЬЗОВАТЕЛЬ "_pol,1:"") D WAITS^%ZAPM.ed.BSF2 Q
NAS S ls=" НАШЛИ..."_$P($P(c,"(",2),",",1,key) D MENU^%ZAPM.ed.BSF5(" УСТАНовить ДАЛЬШЕ ПРЕКРатить ",ls) S:%B=1 END=2 S:%B=3 END=1 Q:$D(END)  I %B=2 S YES=1 D SAY Q
NEWKEY ;c - НОВАЯ ССЫЛКА $QS !!!!
 S zr=c K ^%ZAPM.ed.BSbufB("BB"_$G(%BS(3),$P)_$J_"u"_%BS(15)) F m=1:1:9 K ^%ZAPM.ed.BSbufB(m_"k"_$G(%BS(3),$P)_$J_"u"_%BS(15))
 S k=$P($P(zr,"(",2),")") F i=1:1:key-1 Q:$P(k,",",i)=""  S %KEYS(i)=$P(k,",",i) I %KEYS(i)'=+%KEYS(i)&($E(%KEYS(i),1)=$C(34)) S %KEYS(i)=$E(%KEYS(i),2,$L(%KEYS(i))-1)
 S %IND="",i=2,%NAm=$$BSD^%ZAPM.ed.BSA(BSD,$G(%KEYS(0))) F ii=1:1:key-1 Q:'$D(%KEYS(ii))  S %NAm=%NAm_$S(%KEYS(ii)'=+%KEYS(ii):$C(34)_%KEYS(ii)_$C(34),1:%KEYS(ii))_","
 S ^%ZAPM.ed.BSbufB(key_"k"_$G(%BS(3),$P)_$J_"u"_%BS(15),1,1)="@@1@70@@@@@1@"_$P(%BS,"!",4)_"@@@@@ .. k"_key_" "_%NAm
 S ^%ZAPM.ed.BSbufB(key_"k"_$G(%BS(3),$P)_$J_"u"_%BS(15),2,1)="@@"_k6_"@@@@@1@"_k10_"@@@@@ "_$S(k5'="":k5,1:"НОВЫЙ "_key_"-Й ИНДЕКСНЫЙ КЛЮЧ")
 I kt'="" S ^%ZAPM.ed.BSbufB(key_"k"_$G(%BS(3),$P)_$J_"u"_%BS(15),3,1)=@$ZR,i=i+1,$P(@$ZR,"@",3)="",$P(@$ZR,"@",8)=0,^%ZAPM.ed.BSbufB(key_"k"_$G(%BS(3),$P)_$J_"u"_%BS(15),"FTR",3,1)=kt,kt1="3,1" D:kd1
 .S @$ZR=@$ZR_" I $P(BS,""@"",19)'="""" S kd=$S($P(BS,""@"",19):$$ESDAY^%ZAPM.ed.BSsFUNR(9,$P($P(BS,""@"",19),"","",1,2)),1:$P(BS,""@"",19)),d1=d1_$J("""",$P(BS,""@"",4)-$L(d1)-22)_kd_"" ""_$P($P(BS,""@"",19),"","",3)"
 F  S %IND=$O(@(%NAm_"%IND)")) Q:%IND=""  I %IND'["@" S i=i+1,ii=%IND,^%ZAPM.ed.BSbufB(key_"k"_$G(%BS(3),$P)_$J_"u"_%BS(15),i,1)="@@"_k6_"@@@@"_$G(kt1)_"@1@"_k10_"@@@@@"_ii_"@@@@"_$G(@(%NAm_"%IND)"))
 S ^%ZAPM.ed.BSbufB(key_"k"_$G(%BS(3),$P)_$J_"u"_%BS(15))="@@@@@@@1@1@22@80@X MRMR@1@@%FKR^%ZAPM.ed.BST1@1",$P(@$ZR,"@",25)=1,$P(@$ZR,"@",17)=1,se=i,ke=1 K MX,MY D RESZER^%ZAPM.ed.BSF2,TAB^%ZAPM.ed.BSF1,W^%ZAPM.ed.BST,KLE^%ZAPM.ed.BSTM
 G D
]]></Routine>


<Routine name="%ZAPM.ed.BSBD1" type="MAC" languagemode="0"><![CDATA[
%BSBD1 ; пpогpамма РАБОТЫ С УЗЛАМИ БД ; 17:32   20.06.2001
 Q
PFLREAD ;ВВОД И РАЗРЕЗКА НА ПРЕДВВВОД ДОКУМЕНТОВ
 S D=0,SS="",%zT=$ZT,$ZT="ERFILE^%ZAPM.ed.BSBD1",NEWFORMAT=S
 S (S2,S1)=""
 ;I $ZV["MSM",S["Cirillic,",S["1251" D INIT^%ZAPM.ed.BSre(0) S S=S1,S1=S2,S2=S ;ПЕРЕКОДИРОВАТЬ В ASCII
 I $ZV["Cach"||($ZV["IRIS"),S["Cirillic,",S["866" D INIT^%ZAPM.ed.BSre(0) ;ПЕРЕКОДИРОВАТЬ В ANSI
 D Wait^%ZAPM.ed.BSXfun("Ввод документов %BS-FORMAT")
 ;F  U %DEV R S Q:$ZC'=0  D
 //ion 27.01.2006 проверка на корректность парных скобок {}
 I '$$PFLOK^%ZAPM.ed.BSBD1() Q
 S i="" F  S i=$O(fT2(i)) Q:i=""  S S=fT2(i) D
 .I $E(S,1)=";" Q  ;КОММЕНТАРИЙ
 .I S["{" D DOKUM Q
Vi U 0 I '$D(N) D ErrMsg^%ZAPM.ed.BSXfun("ОШИБКА ФОРМАТА ДОКУМЕНТА "_%FN) K %FN G EEE
EEE S $ZT=$G(%zT) D CLO
 Q
 
PFLOK()
 N F1,F2,L1,L2,L,i,Z,ZZ,ZZZ,STOP
 S (F1,F2,F3,L)=0
 F Z=0:1:255 S $E(ZZ,Z+1)=$C(Z) 
 S Z=$TR(ZZ,"{}"),ZZZ=""
 S i="" F  S i=$O(fT2(i)) Q:i=""  D  Q:$G(STOP)
 .S S=fT2(i),L1=$L(S)-$L($TR(S,"{","")),L2=$L(S)-$L($TR(S,"}","")),L=L+L1-L2
 .S ZZZ=ZZZ_$TR(S,Z) I $L(ZZZ,"{")=$L(ZZZ,"}") S ZZZ=""
 .I ZZZ["{{"!(ZZZ["}}") S STOP=i Q
 .I F1=0,L1=1,L2=0 S F1=1,F2=0
 .I F1=1,L1=0,L2=1 S F1=0,F2=1
 I F1=0,F2=1,L=0 Q 1
 D ErrMsg^%ZAPM.ed.BSXfun("ОШИБКА РАССТАНОВКИ СКОБОК В ДОКУМЕНТЕ! {В СТРОКЕ: "_$G(STOP,"???")_"}"_%FN)
 Q 0
 
DOKUM ;ВВОД ДОКУМЕНТА
 S D=D+1,N=0
 ;F  U %DEV R S Q:$ZC'=0  Q:S="}"  D
 F  S i=$O(fT2(i)) Q:i=""  S S=fT2(i)  Q:S="}"  D
 .S S=$TR(S,S1,S2) 
 .I $E(S,1)=";" Q  ;КОММЕНТАРИЙ
 .I $TR(S," ","")'="" S N=N+1,@TM@(%FN,D,N)=S
 D USE0^%ZAPM.ed.BSMDDR1 X $G(WA)
 Q
ERFILE U 0 I $ZE["<ENDOFFILE" G Vi
 D ErrMsg^%ZAPM.ed.BSXfun($ZE_" "_$$ErrSay^%ZAPM.ed.BSF8($ZE)) S $ZT=$G(%zT) G CLO
CLO U 0 C:$D(%DEV) %DEV Q
 Q
FORMAF ;ОБЩИЙ МОДУЛЬ
 S:F="" F="?????" S ND=$G(@BP@("@Last"))+1,@BP@("@Last")=ND D L^%ZAPM.ed.BS3($NA(@BP@(F,ND)))
 S @BP@(F,ND,"INF")=FN_"?"_$$h^%ZAPM.ed.BS3()_"?"_$G(%BS(12))_"?"_$$FILE^%ZAPM.ed.BSDOS(FN,1)_"?"_$$FILE^%ZAPM.ed.BSDOS(FN,2)
 D TempTX^%ZAPM.ed.BSTT($P(FN,"\",$L(FN,"\"))_" *"_F_"* ?"_ND_"?") S TmpND=TmpND+1
 Q
BP ;ОБРАБОТКА ДОКУМЕНТОВ
 S FN="",TmpND=0 F  S FN=$O(@TM@(FN)) Q:FN=""  D Wait^%ZAPM.ed.BSXfun("обработка "_FN) S D="" F  S D=$O(@TM@(FN,D)) Q:D=""  D  X WA
 .S N="" F  S N=$O(@TM@(FN,D,N)) Q:N=""  S S=@TM@(FN,D,N) D
 ..I N=1 S F=$P($P(S,"NODE_DDR=",2)," ") D FORMAF
 ..S @BP@(F,ND,(N+1)_",2")=S
 .D U^%ZAPM.ed.BS3($NA(@BP@(F,ND)))
 .D CTRL^%ZAPM.ed.BSMDDR1(BP,F,ND,BD)
 Q
 ;Z="" СИНТ. КОНТРОЛЬ ДОКУМЕНТА
 ;Z=1 ЗАНЕСЕНИЕ В БД
 ;Z=1,$G(uzel)'="" ЛОГ. КОНТРОЛЬ ДОКУМЕНТА БЕЗ ЗАНЕСЕНИЯ В БД
 ;Z=1,$G(uzel)="KILL" ОТКАТ-УДАЛЕНИЕ УЗЛОВ БД ДОКУМЕНТА
 ;BP-МАСССИВ БПО
 ;F - ИМЯ ФОРМЫ
 ;ND - НОМЕР ДОКУМЕНТА
CTT ;КОНТРОЛЬ НОВОГО ФОРМАТА
 F K=0:1:9 I $D(LB(F,K)) S LastKey=K I '$D(LB(F,K,1)) D CTRK(K,.Ke) Q:$D(ErrKey)  S Ke(K)=d
 I $D(ErrKey) D PROT^%ZAPM.ed.BSMDDR1(2,"ОШИБКА В ОПИСАНИИ КЛЮЧА "_K) Q
 S KK=LastKey ;ПОСЛЕДНИЙ КЛЮЧ
 S %zT=$ZT,$ZT="ERPOK^%ZAPM.ed.BSMDDR1"
 S bd=$P(LB(F,"KEY"),"@")_$G(Ke(0))  D varBLOCK^%ZAPM.ed.BSCocx
 I '$$Data^%ZAPM.ed.BSF12(bd) S @bd="BSD - MSW@" ;D PROT^%ZAPM.ed.BSMDDR1(2,"НЕ ДОСТУПНА БАЗА "_bd_" !  ВОЙДИТЕ НА 0-Й КЛЮЧ И СОЗДАЙТЕ НОВЫЙ УЗЕЛ БАЗЫ ДАННЫХ") Q
ctr K ls,POK,stOP,stoP I $G(LB(F,"W"))="!!!" S Wt=1 ;РАЗРЕШИТЬ ДУБЛИРОВАНИЕ
 S N=2 F  S N=$O(S(N)) Q:N=""  S OSN=0 D  I OSN D ER^%ZAPM.ed.BSMDDR1("в"_(N-1),OSN)
 .S PO=$P(S(N),"=")
 .S (d,d1,d0)=$P(S(N),"=",2,999)
 .I $G(LB(F,"PI"))[(PO_",") Q  ;ИГНОРИРУЕМЫЕ ПОКАЗАТЕЛИ
 .I $G(LB(F,"W"))=PO D  Q:$D(stOP)
 ..I d=0 D  Q
 ...I $G(uzel)'="KILL" D PROT^%ZAPM.ed.BSMDDR1(N,"ПОКАЗАТЕЛЬ "_PO_d_" ТРЕБУЕТ УДАЛЕНИЕ ДОКУМЕНТА ! ЭТО МОЖНО ВЫПОЛНИТЬ КОМАНДОЙ <ALT-F2> --> <ОТКАТ>") S OS=OS+1,OSN=OSN+1,stOP=1 Q
 ...I $G(uzel)="KILL" S stoP=1
 ..S Wt=$S(d=1:1,1:PO) Q
 .I '$D(LB(F,"I",PO)) D  Q
 ..D PROT^%ZAPM.ed.BSMDDR1(N,".НЕСУЩЕСТВУЮЩИЙ ПОКАЗАТЕЛЬ "_PO_" !!!") S OS=OS+1,OSN=OSN+1 K ls
 .I $D(LB(F,"I",PO,1)) D
 ..I $D(LB(F,"SPO")),LB(F,"SPO")[(PO_",") Q  ;СНЯТИЕ КОНТРОЛЯ
 ..S YES=1 X LB(F,"I",PO,1) I 'YES D PROT^%ZAPM.ed.BSMDDR1(N,PO_"="_d_" !!! "_$G(ls,"СИНТ.ОШИБКА")) S OS=OS+1,OSN=OSN+1 K ls Q
 .I $G(Z)=2,$G(LB(F,"I",PO))["@" S REC(PO)=d
 I $D(LB(F,"Singl")),'$D(stOP),'$D(stoP) S bd1=$$SingB^%ZAPM.ed.BSMDDR1 n sblo d  q:$d(sblo)
  .i $$block^%ZAPM.ed.BSCocx($P(bd1,"AsIs",2)) D PROT^%ZAPM.ed.BSMDDR1(N,bd1_" Узел Блокирован Администратором !") S OS=OS+1,sblo=1 Q
  .I $D(@bd1),'$G(Wt) D PROT^%ZAPM.ed.BSMDDR1(N,bd1_" УЖЕ СУЩЕСТВУЕТ И НЕТ ."_$G(Wt,"""КОР1""")) S OS=OS+1,sblo=1 Q
 I $D(LB(F,"P")) D PROT^%ZAPM.ed.BSMDDR1(" ФОРМА НАСТРОЕНА КАК ""МНОГО-ЛИНЕЙНАЯ"",НОВЫМ ФОРМАТОМ ТАКИЕ НЕ ПОДДЕРЖИВАЮТСЯ") S OS=OS+1 Q
 I 'OS S:$G(uzel)="" @BP@(F,ND,"2,1")=3 I $G(Z)=1 K REC,DUBL S Z=2 G ctr
 I OS D ER^%ZAPM.ed.BSMDDR1(" всего",OS) Q
 I $G(Z)=2 S RECK=1 D REC^%ZAPM.ed.BSMDDR1 S:$G(uzel)'="" @BP@(F,ND,"2,1")=OldP I "KILL"'[$G(uzel) S $P(@BP@(F,ND,"INF"),"?",6)=$S($D(oTl):"",1:+$G(rlo))
 I $G(uzel)="KILL" S Z="" K REC,DUBL,uzel G ctr ;ЭМУЛЯЦИЯ СИНТ.КОНТРОЛЯ
 Q
CTRK(K,%KEYS) ;КОНТРОЛЬ КЛЮЧЕЙ ИЗ НЕПОВТОРЯЮЩИХСЯ ПОКАЗАТЕЛЕЙ
 N FO,d1,d0,YES,Iv,ls,%NAm,ii
 S %zT=$ZT,$ZT="ERKEY^%ZAPM.ed.BSBD1"
 S %NAm=$$BSD^%ZAPM.ed.BSA($P(LB(F,"KEY"),"@"),$G(%KEYS(0))) F ii=1:1:9 Q:'$D(%KEYS(ii))  S %NAm=%NAm_$S(%KEYS(ii)=+%KEYS(ii):%KEYS(ii),1:$C(34)_%KEYS(ii)_$C(34))_","
 S (d1,d,d0)=$P($P(S(2),"KEY"_K_"=",2)," ")
 I $G(LB(F,K))["^%" X "S (d1,d,d0)="_LB(F,K)
 I d="" D PROT^%ZAPM.ed.BSMDDR1(2,"КЛЮЧ НОМЕР "_K_" ПУСТОЙ !") S OS=OS+1 Q
 I $D(LB(F,"KEY",K,1)) D
 .I $D(LB(F,K,2)) Q
 .X LB(F,"KEY",K,1) I 'YES D PROT^%ZAPM.ed.BSMDDR1($G(Iv,2),"ОШИБКА ДАННЫХ КЛЮЧА НОМЕР "_K_" "_$G(ls)) S OS=OS+1 K ls Q
 Q
ERKEY D PROT^%ZAPM.ed.BSMDDR1($G(Iv,2),"!!!КЛЮЧ "_K_" !!! "_$$ErrSay^%ZAPM.ed.BSF8($ZE)) S $ZT=$G(%zT) S OS=OS+1
 S ErrKey=1
 Q
]]></Routine>


<Routine name="%ZAPM.ed.BSBL" type="MAC" languagemode="0"><![CDATA[
%BSBL ;СОЗДАНИЕ БЛОКА,ОТКРЫТИЕ HFS,EXPORT DOS-FILE;;[ 30/09/93 11:17 ] ; 14:45   02.03.99
 K ^%ZAPM.ed.BSbufB("uP"_$G(%BS(3),$P)_$J_"u"_%BS(15)),^%ZAPM.ed.BSbufB("L"_$G(%BS(3),$P)_$J_"u"_%BS(15)) I '$P(@(BSR_"(BST)"),"@",3) S ls="А блок-то где ?" D O^%ZAPM.ed.BSF7 Q
BL1 ;ОТБОР БЛОКА С ТИТУЛОМ
 S BS=@(BSR_"(BST)"),^%ZAPM.ed.BSbufB("uP"_$G(%BS(3),$P)_$J_"u"_%BS(15))=BS S:$P(BS,"@",19) %TIT=$P(BS,"@",19),i1=$P(%TIT,",")-1,j1=$P(%TIT,",",2)-1
 ;ТИТУЛ ДЛЯ ПЕЧАТИ```MSW
 S:$P(BS,"@",50) %TIT=$P(BS,"@",50),i1=$P(%TIT,",")-1,j1=$P(%TIT,",",2)-1
 F i=1:1 Q:'$D(@(BSR_"(BST,i)"))  F j=1:1 Q:'$D(@(BSR_"(BST,i,j)"))  I $P(^(j),"@",12) S BS=^(j) D
 .D OBR S ^%ZAPM.ed.BSbufB("uP"_$G(%BS(3),$P)_$J_"u"_%BS(15),i,j)=BS
 .S ^%ZAPM.ed.BSbufB("uP"_$G(%BS(3),$P)_$J_"u"_%BS(15),0,j)=@(BSR_"(BST,i,j)"),^%ZAPM.ed.BSbufB("uP"_$G(%BS(3),$P)_$J_"u"_%BS(15),i,0)=@(BSR_"(BST,i,j)")
 .I '$D(%TIT) Q
 .F i2=1:1:i1 S I=i,BS=@(BSR_"(BST,i2,j)"),i=i2 D OBR S ^%ZAPM.ed.BSbufB("uP"_$G(%BS(3),$P)_$J_"u"_%BS(15),i2,j)=BS,i=I
 .F j2=1:1:j1 S J=j,BS=@(BSR_"(BST,i,j2)"),j=j2 D OBR S ^%ZAPM.ed.BSbufB("uP"_$G(%BS(3),$P)_$J_"u"_%BS(15),i,j2)=BS,^%ZAPM.ed.BSbufB("uP"_$G(%BS(3),$P)_$J_"u"_%BS(15),"0",j2)=@(BSR_"(BST,i,j2)"),j=J
 I '$D(%TIT) G BL2
 F i2=1:1:i1 F j2=1:1:j1 S BS=@(BSR_"(BST,i2,j2)"),i=i2,j=j2 D OBR S ^%ZAPM.ed.BSbufB("uP"_$G(%BS(3),$P)_$J_"u"_%BS(15),i2,j2)=BS,^%ZAPM.ed.BSbufB("uP"_$G(%BS(3),$P)_$J_"u"_%BS(15),i2,0)=@(BSR_"(BST,i2,j2)")
BL2 ;СОЗДАНИЕ ТАБЛИЦЫ
 S i=0,(BS,BS1,BS2)=0,BS3=1 F  S i=$O(^%ZAPM.ed.BSbufB("uP"_$G(%BS(3),$P)_$J_"u"_%BS(15),i)) Q:i=""  D  X WA S BS3=BS3+BS2 ;ПРИВЕДЕНИЕ КООРДИНАТ
 .S BS=^%ZAPM.ed.BSbufB("uP"_$G(%BS(3),$P)_$J_"u"_%BS(15),i,0),BS1=$P(BS,"@"),BS2=$P(BS,"@",3) S:BS1>BS3 $P(BS,"@")=BS3 S ^%ZAPM.ed.BSbufB("uP"_$G(%BS(3),$P)_$J_"u"_%BS(15),i,0)=BS
 S j=0,(BS,BS1,BS2)=0,BS3=1 F  S j=$O(^%ZAPM.ed.BSbufB("uP"_$G(%BS(3),$P)_$J_"u"_%BS(15),0,j)) Q:j=""  D  S BS3=BS3+BS2
 .S BS=^%ZAPM.ed.BSbufB("uP"_$G(%BS(3),$P)_$J_"u"_%BS(15),0,j),BS1=$P(BS,"@",2),BS2=$P(BS,"@",4) S:BS1>BS3 $P(BS,"@",2)=BS3 S ^%ZAPM.ed.BSbufB("uP"_$G(%BS(3),$P)_$J_"u"_%BS(15),0,j)=BS
 S i1=1,i=0 F  S i=$O(^%ZAPM.ed.BSbufB("uP"_$G(%BS(3),$P)_$J_"u"_%BS(15),i)) Q:i=""  D  S i1=i1+1 ;ПОДЖАТИЕ
 .S j1=1,j="" F  S j=$O(^%ZAPM.ed.BSbufB("uP"_$G(%BS(3),$P)_$J_"u"_%BS(15),0,j)) Q:j=""  S BS1=^%ZAPM.ed.BSbufB("uP"_$G(%BS(3),$P)_$J_"u"_%BS(15),i,0),BS11=$P(BS1,"@"),BS12=$P(BS1,"@",3),BS2=^%ZAPM.ed.BSbufB("uP"_$G(%BS(3),$P)_$J_"u"_%BS(15),0,j),BS21=$P(BS2,"@",2),BS22=$P(BS2,"@",4) D  S j1=j1+1
 ..I '$D(^%ZAPM.ed.BSbufB("uP"_$G(%BS(3),$P)_$J_"u"_%BS(15),i,j)) D  S BS=BS11_"@"_BS21_"@"_BS12_"@"_BS22_"@@@@@1@@@@@@",^%ZAPM.ed.BSbufB("L"_$G(%BS(3),$P)_$J_"u"_%BS(15),i1,j1)=BS Q
 ..S BS=^%ZAPM.ed.BSbufB("uP"_$G(%BS(3),$P)_$J_"u"_%BS(15),i,j),$P(BS,"@")=BS11,$P(BS,"@",2)=BS21,^%ZAPM.ed.BSbufB("L"_$G(%BS(3),$P)_$J_"u"_%BS(15),i1,j1)=BS
 S ^%ZAPM.ed.BSbufB("L"_$G(%BS(3),$P)_$J_"u"_%BS(15))=^%ZAPM.ed.BSbufB("uP"_$G(%BS(3),$P)_$J_"u"_%BS(15)) K ^%ZAPM.ed.BSbufB("uP"_$G(%BS(3),$P)_$J_"u"_%BS(15))
 ;I $D(@(BSR_"(BST,""PRN"")")) S ^%ZAPM.ed.BSbufB("L"_$G(%BS(3),$P)_$J_"u"_%BS(15),"PRN")=@(BSR_"(BST,""PRN"")") Q
 Q
OBR ;ОБРАБОТКА ДАННЫХ КЛЕТКИ
 I $P(BS,"@",9)=1 S (d1,d,d0)=$P(BS,"@",15)
 E  S (d1,d,d0)=$G(^%ZAPM.ed.BSbufB("BB"_$G(%BS(3),$P)_$J_"u"_%BS(15),i,j))
 I d0="" S d0=0
 I $P(BS,"@",8)'="" S nx=j,ny=i D  ;
 .I '$P(BS,"@",8) X @(BSR_"(BST,""FTR"",i,j)") Q
 .X $G(@(BSR_"(BST,""FTR"","_$P(BS,"@",8)_")"))
 S $P(BS,"@",8)="",$P(BS,"@",15)=d1,$P(BS,"@",9)=1
e Q
BF ;ОПЦИИ ВЫВОДА
BFB D SA^%ZAPM.ed.BSsBUF D BF2 D RE^%ZAPM.ed.BSsBUF Q
BF2 I $D(@(BSR_"(BST,""HFS"")")) S PRA1=@(BSR_"(BST,""HFS"")") F i=1:1:8 S @("PR"_i)=$P(PRA1,"@",i) G:i=8 BF1
 F ii=2:1:9 S i=ii-1,@("PR"_i)=$P(^%ZAPM.ed.BSS("HFS",ii,2),"@",15) G:ii=9 BF1
BF1 K BSd,BSk S (BSt1,kk)="HFS",BSr1="^%ZAPM.ed.BSS",BSt2="fTS"_$G(%BS(3),$P)_$J_"u"_%BS(15),BSr2="^%ZAPM.ed.BSbufB" D COPY^%ZAPM.ed.BSTK S ii=@(BSr2_"(BSt2)") F jj=2,4,5,12,13,14,15 S $P(ii,"@",jj)=""
 S @(BSr2_"(BSt2)")=ii F PRB=2:1:9 S i=PRB-1,$P(^%ZAPM.ed.BSbufB("fTS"_$G(%BS(3),$P)_$J_"u"_%BS(15),PRB,2),"@",15)=@("PR"_i) Q:PRB=9
 S yyy1=BSR,yyy2=BST D  K ^%ZAPM.ed.BSbufB("fTS"_$G(%BS(3),$P)_$J_"u"_%BS(15)) Q
 .D SI^%ZAPM.ed.BSN N (%BS,vl,%zT,%KAT,%File,yyy1,yyy2,BSB,PRA1)
 .S BST="fTS"_$G(%BS(3),$P)_$J_"u"_%BS(15),BSR="^%ZAPM.ed.BSbufB" D ^%ZAPM.ed.BST Q:R1=27  F PRB=2:1:9 S i=PRB-1,@("PR"_i)=$P(^%ZAPM.ed.BSbufB("fTS"_$G(%BS(3),$P)_$J_"u"_%BS(15),PRB,2),"@",15) Q:PRB=9
 .D  I PR8="Y" S $P(PRA1,"@",8)="N" S @(yyy1_"(yyy2,""HFS"")")=PRA1
 ..S PRA1="" F i=1:1:8 S PRA1=PRA1_@("PR"_i)_"@" Q:i=8
]]></Routine>


<Routine name="%ZAPM.ed.BSBL1" type="MAC" languagemode="0"><![CDATA[
%BSBL1 ;ОТКРЫТИЕ HFS, EXPORT DOS-FILE ; 16:39   12.05.99
DosOpn(NumDev,PR1) ;
DOSOPN ;ОТКРЫТИЕ УСТРОЙСТВА HFS ДЛЯ ЗАПИСИ
 I $ZV["Cach"||($ZV["IRIS"),'$$ASK^%ZAPM.ed.BSCi Q
 S YES=1 I $D(%DEV)&($D(%FN)) G U:%DEV>50&(%DEV<55),U:$ZV["Cach"||($ZV["IRIS")
DEV I $ZV["Cach"||($ZV["IRIS") S %DEV=51 G FN
 F %DEV=$G(NumDev,51):1:54 O %DEV::0 Q:$T
 I '$T S %DEV=0 S ls=" Все файловые устpойства ДОС заняты ..." D O^%ZAPM.ed.BSF7 G END
 N Qq
FN U 0 S %DEVTYPE="HFS" K %FN S ls=" Введите полный путь к DOS-файлу для ЗАПИСИ (F3-Каталог) ",li=$G(PR1)
         I li="" S li=$$DIRUSER^%ZAPM.ed.BSCmDDR(%BS(12)) //```
 D ChP^%ZAPM.ed.BSF10(2) ;ПЕРЕОПРЕДЕЛЕНИЕ ТЕКУЩЕГО КАТАЛОГА
 I $D(%BS)["0" D CLr^%ZAPM.ed.BSF4
 I $G(pacetD)=""!($G(pacetO)=1&($G(pacetD)=2))!($G(PR1)="") S %KAT="D DOS^%ZAPM.ed.BSDOS",ll="",%HIS="^%ZAPM.ed.BSbufB(""HISFILE"_$S('$E(%BS(1),12):$G(%BS(3),$P)_$G(%BS(12)),$E(%BS(1),12)=1:"1"_$G(%BS(12)),1:"1")_""")" D LE^%ZAPM.ed.BSTT Q:'YES  I li="" S YES=0 Q
 //```
 I $E(li,2)'=":"!("Aa"[$E(li,1))!($E(li,$L(li))="\") D ER^%ZAPM.ed.BSF("Enter the file name in the format... "_$$DIRUSER^%ZAPM.ed.BSCmDDR(%BS(12))_"FileName") G FN
 S %FN=li G:"^."[%FN END I $G(%SDEV)="HISTORY" C %DEV Q  ;!!!
 S:$P(li,"\",$L(li,"\")+1)'["." li=li_".%BS" I $E(li,$L(li)-3,$L(li))'=".%BS" S ls=" НЕОБХОДИМО РАСШИРЕНИЕ *.%BS " D O^%ZAPM.ed.BSF7 G FN
 I $G(pacetD)'="" I pacetD=1!(pacetO=1) D  G:$G(Qq) FN
 .I $$ZOS10^%ZAPM.ed.BSDOS(%FN)>0 I $$DelFile^%ZAPM.ed.BSXdos(%FN) S Qq=1
 S:$G(pacetD)'="" pacetO=2,pacetPR1=%FN
 I $G(pacetD)="" I $$OverAdd^%ZAPM.ed.BSXdos(%FN) G FN
U I $ZV["MSM" O %DEV:(%FN:"A") U %DEV I $ZA<0 G ErrO
  I $ZV["Cach"||($ZV["IRIS") G ErrO:'$$OpenFile^%ZAPM.ed.BSCF1(%FN,"A")
END S %3=250 I "^."[%FN S %4="" C %DEV K %DEV,%FN D CL^%ZAPM.ed.BSF4 Q
 U 0 Q
C C %DEV K %DEV,%FN D CL^%ZAPM.ed.BSF4 Q
ErrO U 0 S ls=" Ошибка откpытия файла "_%FN D O^%ZAPM.ed.BSF7 C %DEV
 I $G(pacetD)'="" Q
 G FN
 
IntTXT2T(BSr,BSt,BSR,BST) 
 ;ВНУТРЕННЯЯ ТОЧКА ВХОДА ИЗ BSr,BSt ---> BSR,BST
 S IntTXT2T=1 G IntTXT
EXPORTXT ;ВОССТАНОВЛЕНИЕ ИЗ ТЕКСТА
 D RIT^%ZAPM.ed.BSF3 I 'YES G D
IntTXT K ^%ZAPM.ed.BSbufB("uP"_$G(%BS(3),$P)_$J_"u"_%BS(15)),^%ZAPM.ed.BSbufB("P"_$G(%BS(3),$P)_$J_"u"_%BS(15)) S %I=$I
 S %zT=$ZT,$ZT="ER^%ZAPM.ed.BSBL1"
 S %IN=$G(@(BSr_"(BSt,1)")) I %IN="" S ls=" Нет ведь ничего !" D O^%ZAPM.ed.BSF7 G D
 I $E(%IN,1)'="#" S ls=" Не тот формат !" D O^%ZAPM.ed.BSF7 G D
 I '$D(IntTXT2T) S ls=" Восстановим ? Но текущая таблица будет потеряна! " D YES^%ZAPM.ed.BSF G:'YES D
 S AN=%IN,DL=$L(%IN)
IF S ls="ВОССТАНОВЛЕНИЕ..." D WAITS^%ZAPM.ed.BSF2  D TRANS
 S i=1 F  S i=$O(@(BSr_"(BSt,i)")) Q:i=""  Q:$G(@(BSr_"(BSt,i)"))=""  D
 .S %IN=$G(@(BSr_"(BSt,i)"))
 .S:i=2 AN=$E(%IN,1) S AN1=$E(%IN,1) D TRANS1 X $G(WA)
 G QQQ
tr(S) //АВТО-ТРАНСЛЯЦИЯ ИЗ ASCII
 S (S2,S1)="" D INIT^%ZAPM.ed.BSre(1)
 Q $TR(S,S1,S2)
EXPORT ;ВОССТАНОВЛЕНИЕ ИЗ DOS-ФАЙЛА
 K ^%ZAPM.ed.BSbufB("uP"_$G(%BS(3),$P)_$J_"u"_%BS(15)),^%ZAPM.ed.BSbufB("P"_$G(%BS(3),$P)_$J_"u"_%BS(15))
 S %I=$I D DEV^%ZAPM.ed.BSS1
REST D DOSREAD I '$D(%FN) K %DEV Q  ;ВОССТАНОВЛЕНИЕ ТАБЛИЦ
 S %zT=$ZT,$ZT="ER^%ZAPM.ed.BSBL1" U %DEV R %IN G:$ZC'=0 CLO
RES I $E(%IN,1)["#"!($E(%IN,1)["$") U 0 S ls=" Восстановим ? Но текущая таблица будет потеряна! " D YES^%ZAPM.ed.BSF G:'YES D S AN=%IN,DL=$L(%IN) G I
 U 0 S ls=" Не тот формат !" D O^%ZAPM.ed.BSF7 G D
I U 0 S ls="ВОССТАНОВЛЕНИЕ..." D WAITS^%ZAPM.ed.BSF2 S (S2,S1)="" I ($E(%IN,1)["#") D INIT^%ZAPM.ed.BSre(1)
 D TRANS
 F i=1:1 U %DEV R %IN Q:$ZC'=0  S %IN=$tr(%IN,S1,S2) D 
 .U 0 S:i=1 AN=$E(%IN,1) S AN1=$E(%IN,1) D TRANS1 X $G(WA)
QQQ S QQ=1 U 0 D TRANS1,TRA2
QQ S $ZT=$G(%zT) U 0 D CLO,TAB^%ZAPM.ed.BSF1,DEND^%ZAPM.ed.BSF2,REND^%ZAPM.ed.BSF2 G:$D(IntTXT2T) D D W^%ZAPM.ed.BST,KLE^%ZAPM.ed.BSTM G D
 G D
DOSREAD I $D(%DEV)&($D(%FN)) I %DEV>50&(%DEV<55) G U^%ZAPM.ed.BSS1
e Q
ER U 0 I $ZE["<INRP" S ls=" ПРЕРВАНО..." G ERE
 I $ZE["<ENDOFFILE" G QQQ
 I $ZE["<MXSTR" S ls=" Слишком длинная строка считана " G ERE
 S ls=$ZE
ERE S $ZT=$G(%zT) D O^%ZAPM.ed.BSF7,CLO K:$E($G(BST),1)="@" @(BSR_"(BST)") G END^%ZAPM.ed.BSF
CLO U 0 C:$D(%DEV) %DEV Q
D ;???MSW D U^%ZAPM.ed.BS3($NA(@BSR@(BST)))
 I $D(IntTXT2T) K IntTXT2T Q
 G 0^%ZAPM.ed.BSTM
TRANS ;ЗАПИСЬ ТАБЛИЦЫ
 S QQ="",FS=@(BSR_"(BST)") K @(BSR_"(BST)") S @(BSR_"(BST)")=FS
 S k=1,k1=2,k2=3,AN1=$E(AN,2) F i=k2:1 S AN2=$E(AN,i) D  Q:AN2=""
 .I AN2'=AN1 S j=i-1,^%ZAPM.ed.BSbufB("uP"_$G(%BS(3),$P)_$J_"u"_%BS(15),k)=k1_","_j,k2=i,AN1=AN2,k=k+1,k1=k2
 S l=0,BSI=0 Q
TRANS1 ;
 I $L(%IN)<DL S %IN=%IN_$J("",(DL-$L(%IN)))
 I '$D(AN1) G TRA2
 I AN1=AN D  Q
 .S j=0,l=l+1 F  S j=$O(^%ZAPM.ed.BSbufB("uP"_$G(%BS(3),$P)_$J_"u"_%BS(15),j)) Q:j=""  S k=^%ZAPM.ed.BSbufB("uP"_$G(%BS(3),$P)_$J_"u"_%BS(15),j),^%ZAPM.ed.BSbufB("P"_$G(%BS(3),$P)_$J_"u"_%BS(15),l,j)=$E(%IN,$P(k,","),$P(k,",",2))
TRA2 S AN=AN1,l=0,BSII=0,BSI=BSI+1,j1=0
TRA S BSII=BSII+1,STR="",STR1=""  F  S j1=$O(^%ZAPM.ed.BSbufB("P"_$G(%BS(3),$P)_$J_"u"_%BS(15),j1)) Q:j1=""  S SY=j1 S:QQ=1 SY=SY-1 D  G:STR1="" TRA1 S STR=STR_STR1
 .Q:'$D(^%ZAPM.ed.BSbufB("P"_$G(%BS(3),$P)_$J_"u"_%BS(15),j1,BSII))  S STR1=^%ZAPM.ed.BSbufB("P"_$G(%BS(3),$P)_$J_"u"_%BS(15),j1,BSII),SX=$L(STR1)
 D  S @(BSR_"(BST,BSI,BSII)")="@@"_SY_"@"_SX_"@@@@@1@@@@@@"_STR G TRA
 .I $TR(STR," ","")="" S STR="" Q
 .S f2=STR,f=$L(STR) I STR[" " F f=$L(STR):-1 S f1=$E(STR,f) Q:f1'=" "
 .S STR=$E(STR,1,f)
 .I $L(STR)>502 S STR=$E(STR,1,502)_"??"
TRA1 K ^%ZAPM.ed.BSbufB("P"_$G(%BS(3),$P)_$J_"u"_%BS(15)) G:QQ="" TRANS1
 Q
]]></Routine>


<Routine name="%ZAPM.ed.BSC" type="MAC" languagemode="0"><![CDATA[
%BSC ;ДЛЯ CACHE' - ДИСПЕТЧЕР ; 11:04   24.01.2002
 ;
 ; Copyright (c) Serge W. Mikhaylenko
 ; All Rights Reserved
 ;
 N  ;
 N LOGIN
 F  D START Q:'$D(LOGIN)  Q:"^ ."[LOGIN&(LOGIN'="")
MGR Q
START ;N  L  ;ГОЛОВНОЙ МОДУЛЬ 
 S $ZT="ALLERR^%ZAPM.ed.BSC"
 D CLr^%ZAPM.ed.BSF4,CCC
 D PROT
 D Registr^%ZAPM.ed.BSX(1)
 do Z
 do DelKills^%ZAPM.ed.BSX L
 D REGE^%ZAPM.ed.BSMSMF
 Q
MENU D MENU^%ZAPM.ed.BSCp Q
Z N N,I,II,III,BSR,BST,NSP,APP
 K GLOBALIST
 ///z I '$D(BSLOGIN) D LOGIN I '$G(YES,1) G EXIT
 S %BS(12)="m",%BS(39)="NAV" D REGSERV^%ZAPM.ed.BS1,EMUL
 D WORKGRP^%ZAPM.ed.BS1
 I %BS(12)'="",$G(@%BS(18)@(%BS(37),0,"7,4"))'="" S i=@$ZR,ii=$$KBD^%ZAPM.ed.BSF12("^%ZAPM.ed.BSS(""ARM"")") I $$Data^%ZAPM.ed.BSF12(ii) I $D(@ii@(i,"5,4"))'="" S i=@$ZR D ARM^%ZAPM.ed.BSTT(i) G EXIT
 I $D(%BS(39))[0 W !,"   ошибка доступа при регистрации" H 2 Q
 S APP=@%BS(18) ;I $O(@APP@("-0",""))'="" S %BS(1)=$O(@APP@("-0",""))
 ;S %BS(1)="00000100001101001100" //DFLT
NSP ;СПИСОК ИМЕННОВАННЫХ ОБЛАСТЕЙ
 ;S NSPL=$$NS^%ZAPM.ed.BSCi("NAV",$G(%BS(39))) 
 S NSPL=$$NS^%ZAPM.ed.BSCp()  ///z
 I NSPL=""  D ErrMsg^%ZAPM.ed.BSXfun("Нет доступных областей !") G EXIT
 S BSR="^%ZAPM.ed.BSbufB",BST="NameSpace"_$G(%BS(3),$P)_$J_"u"_%BS(15)
 D Copy^%ZAPM.ed.BSF8("^%ZAPM.ed.BSS(""ALINS"")",$NA(@BSR@(BST)))
 S $P(@BSR@(BST,1,1),"@",15)="  NameSpaces in   '"_$ZU(110)_"'",$P(@BSR@(BST,1,2),"@",15)=$ZV_" "_$$ver()_") № "_$$n()
 S $P(@BSR@(BST,2,1),"@",15)=" ..",$P(@BSR@(BST,2,2),"@",15)=" ...Exit"
 F I=1:1:$L(NSPL,$C(1)) i $P(NSPL,$C(1),I)'=""  D
 .S @BSR@(BST,I+2,1)=@BSR@(BST,2,1),@BSR@(BST,I+2,2)=@BSR@(BST,2,2)
 .S $P(@BSR@(BST,I+2,1),"@",15)=$P(NSPL,$C(1),I),$P(@BSR@(BST,I+2,2),"@",15)=" ..."
 S $P(@BSR@(BST),"@",15)=0,$P(@BSR@(BST),"@",19)="2,2",$P(@BSR@(BST),"@",16)=1
 S $P(@BSR@(BST),"@",41)="FKEY^%ZAPM.ed.BSC"
 S $P(@BSR@(BST),"@",39)="^%ZAPM.ed.BSC,ZHELP1"
 D TAB^%ZAPM.ed.BSF1,^%ZAPM.ed.BST I R1=27,R2=-1 G EXIT
 I ny=2 G EXIT
 I $G(R1)=13,$G(R2)=-1 D GLO($P(@BSR@(BST,ny,1),"@",15)),MGR^%ZAPM.ed.BS G NSP
 Q
REC S YY=15 W /CUP(YY,1),$ZV,/CUP(YY+1,1),"%BS ",$$ver,/CUP(YY+2,1),$$WEEKEND^%ZAPM.ed.BSsFUNR(1,$$h^%ZAPM.ed.BS3()),"  ",$$ESDAY^%ZAPM.ed.BSsFUNR(6,$$h^%ZAPM.ed.BS3()),/CUP(YY+3,1),"Server : ",$ZU(110)
 Q       
LOGIN ;ПРОВЕРКА ПАРОЛЯ
 N PASS,APP 
 W "%SYS>",!
 W /ED(2),$$atr^%ZAPM.ed.BS3(0) D SAY^%ZAPM.ed.BS3(5,3),REC
 W /CUP(YY+4,1),"Id terminal "_$$n ;,/CUP(YY+5,1),". ^ - выход из терминального режима" 
 S YES=0
 I $G(%BS(43))="" D RED^%ZAPM.ed.BS1 W /CUP(YY+6,1)," Enter username (exit-.) : ",$$atr^%ZAPM.ed.BS3(0) R LOGIN
 E  D  S LOGIN=$$LineEdit^%ZAPM.ed.BSXfun(""," Enter username (.-exit)") quit:$G(YES)<1  
 .//в AdvSockTerm должен быть выставлен таймаут=0 для запуска программ
 .W " Username:",! R LOGIN:1,R1:1 I LOGIN="SYS" W "Password:",! R PASS:1,R1:1  I PASS="XXX"!(R1="XXX")  W "%SYS>",! R XXX:1,R1:1 D GTKlog(XXX)
  Quit:"^ ."[LOGIN  ;s LOGIN=$$BIGL^%ZAPM.ed.BSsFUNM(R)
 D GTKlog(LOGIN) 
 I $G(%BS(43))="" W /CUP(YY+7,1),/EL(0),$$clr^%ZAPM.ed.BS3(11)," password :",$$atr^%ZAPM.ed.BS3(0) D CL^%ZAPM.ed.BS1 R PASS D CachOn^%ZAPM.ed.BS1
 I $G(%BS(43))'="" S PASS=$$LineEdit^%ZAPM.ed.BSXfun(""," password for user '"_LOGIN_"'") H:$G(YES)<1  
 S APP=$$CheckPass^%ZAPM.ed.BSCp(LOGIN,PASS,"NAV") 
 ;I APP="" S ls=" password wrong " D O^%ZAPM.ed.BSF7 q
 set APP="NAV"
 S YES=1,%BS(12)=LOGIN,%BS(39)=APP D REGSERV^%ZAPM.ed.BS1,EMUL
 Q
GTKlog(LOGIN) I $E(LOGIN,1,11)="D BST^%ZAPM.ed.BSC(" D GTKcheckGO(LOGIN) H
 Q
GTKcheckGO(L) N YES //код для сертификации
 I L[",""""""," S L=$$repl^%ZAPM.ed.BSCp2(L,","""""",",","""",") //S ^%Z(1)=L ЭМУЛЯЦИЯ ОШИБКИ ДЛЯ ADVSOCKTERM V.4
 S YES=0 X $$TR^%ZAPM.ed.BSsFUNM(L,"D BST^%ZAPM.ed.BSC(","D GTKc^%ZAPM.ed.BSC(") I 'YES W /ED(2),$$atr^%ZAPM.ed.BS3(0) D RED^%ZAPM.ed.BS1 W /CUP(13,25)," Ошибка доступа !!! "_$G(YES) R *R H
 X L
 Q
GTKc(U,BSR,BST,EDIT,MODE,BSLOGIN,BSSES) //проверка на соответствие сессии, пользователя
 N (YES,BSLOGIN,BSSES) I $G(BSLOGIN)="" S YES="Неопределен пользователь" Q
 I $G(BSSES)="" S YES="Неопределен ID сессии" Q
 D MAINVAR^%ZAPM.ed.BSC4 I $G(@BDSES@(BSSES,"CHR"))'="" S YES="Сессия закрыта" Q
 I $G(@BDSES@(BSSES,"NM"))'=BSLOGIN S YES="ID сессии не соответствует пользователю" Q
 S YES=1
 Q
EMUL I $G(%BS(12))'="" s %BS(18)="%BS(39)",%BS(37)=%BS(12),%BS(39,%BS(12),"*")="" ;ЭМУЛЯЦИЯ БД MSM
 Q
GLO(NAMESP) ;СПИСОК ГЛОБАЛЕЙ
 I '$$CNS^%ZAPM.ed.BSCp(NAMESP) D ErrMsg^%ZAPM.ed.BSXfun(NAMESP_" НЕДОСТУПЕН !") Q
 N TIPPA,I,II,BSR,BST,COM,%NAM,IntFKR ;,GLOBALIST
 S TIPPA="P ;" ;CBKMP````ВСЕ ТИПЫ ГЛОБАЛЕЙ
GLOBALS 
 I $D(%BS(39))[0 W !,"   ошибка доступа при регистрации" H 2 Q
 ;I $D(@%BS(39)@(NAMESP,"-1")) S TIPPA=$O(@$ZR@("")) I TIPPA="" 
 //все раздлы
 S TIPPA="BKMP ;"
 I '$D(GLOBALIST(NAMESP)) S GLOBALIST(NAMESP)=$$BSR^%ZAPM.ed.BSCi(NAMESP,,%BS(39),TIPPA) I GLOBALIST(NAMESP)="~" W !,"В доступе отказано" H 3 Q
 S BSR="^%ZAPM.ed.BSbufB",BST="GlobaList"_$G(%BS(3),$P)_$J_"u"_%BS(15) D CCC
 D Copy^%ZAPM.ed.BSF8("^%ZAPM.ed.BSS(""ALINS"")",$NA(@BSR@(BST))) S $P(@BSR@(BST,1,1),"@",15)="List of Globals in "_NAMESP,$P(@BSR@(BST,1,2),"@",15)=">>> Comments: № "_$$n()
 S $P(@BSR@(BST,2,1),"@",15)=" ^new",$P(@BSR@(BST,2,2),"@",15)=" ...create new partition" ///z
 F I=1:1 Q:$P(GLOBALIST(NAMESP),$C(1),I)=""  D
 .S @BSR@(BST,I+2,1)=@BSR@(BST,2,1),@BSR@(BST,I+2,2)=@BSR@(BST,2,2)
 .S GLO="^"_$P(GLOBALIST(NAMESP),$C(1),I)
 .S $P(@BSR@(BST,I+2,1),"@",15)=GLO I $$Data^%ZAPM.ed.BSF12(GLO) S COM=$$TIPP^%ZAPM.ed.BS($P($G(@GLO),"@",1))_" ;"_$P($G(@GLO),"@",2)
 .S $P(@BSR@(BST,I+2,2),"@",15)=$G(COM," ...")
 S $P(@BSR@(BST),"@",15)="INTGLO^%ZAPM.ed.BSC",
 	$P(@BSR@(BST),"@",19)="2,2",
 	$P(@BSR@(BST),"@",16)=1
 S $P(@BSR@(BST),"@",41)="FKEYPART^%ZAPM.ed.BSC"
 S $P(@BSR@(BST),"@",39)="^%ZAPM.ed.BSC,ZHELP2"
 D TAB^%ZAPM.ed.BSF1,^%ZAPM.ed.BST I R1=27,R2=-1 Q
 I ny=2 S li="" D NEWRAZD^%ZAPM.ed.BS1 K GLOBALIST(NAMESP) G GLOBALS ;НОВЫЙ РАЗДЕЛ
 D PART($P(@BSR@(BST,ny,1),"@",15),$E(d,1,4)) G GLOBALS
 Q
INTGLO S %NAM=$P(@BSR@(BST,ny,1),"@",15),IntFKR=1 G IntFKR^%ZAPM.ed.BS2 ;ФУНКЦИОНАЛЬНЫЕ КЛАВИШИ
FKEY ;ПРЕДОБРАБОТКА NAMESPACE
 ;I R1=27,R2=79,R3=85 D 0^%ZAPM.ed.BSDOS S R1=-2 Q  ;F6
 I R1=27,R2=79,R3=88 I $D(@%BS(39)@("-3")) D  Q  ;F9
 .S IYI="^%ZAPM.ed.BSETUP(SETUP" D NE^%ZAPM.ed.BSN D CLr^%ZAPM.ed.BSF4 S R1=-2 Q
 I R1<332,$E(%BS(1),3)=2,'$E($G(%BS(14)),4),R1>31,R1'=127 D CM^%ZAPM.ed.BSF6 S (R1,R2,R3)=0 Q
 I R1=8,R2=-1,R3=-1 S R1=27 Q  ;BACKSPACE
 Q
FKEYPART ;
 I R1=27,R2=79,R3=85 I $$COPYPART($P(@BSR@(BST,ny,1),"@",15)) S R1=-2 Q
 I R1=27,R2=79,R3=88 S IYI="^%ZAPM.ed.BSETUP(SETUP" D NE^%ZAPM.ed.BSN K %BS D CLr^%ZAPM.ed.BSF4 S R1=-2 Q
 I R1<332,$E(%BS(1),3)=2,'$E($G(%BS(14)),4),R1>31,R1'=127 D CM^%ZAPM.ed.BSF6 S (R1,R2,R3)=0 Q
 I R1=8,R2=-1,R3=-1 S R1=27 Q  ;BACKSPACE
 Q
EXIT D OP^%ZAPM.ed.BSF4 D  W #
 N II,ii,i S II="" F  S II=$O(^%ZAPM.ed.BSbufB(II)) Q:II=""  I II["u" D
 .L +^%ZAPM.ed.BSbufB(II):0  I  K ^%ZAPM.ed.BSbufB(II) Q
 Q
ALLERR I $ZE["<ZINRP" S ls="ПРЕРВАНО" D ER^%ZAPM.ed.BSF(ls) S R1=27,R2=-1,R3=-1 Q
 S ls="Произошла Ошибка ! "_$$ZE() D Tex^%ZAPM.ed.BSMSMF("ErrorTermA="_$ze,$G(BSG,"?")_","_$G(BSROU)_","_$ZN_","_$ZU(5)_","_$G(%KEY("MGWLPN"),"?")_","_$s_","_$G(BSSES))
ALLE D ER^%ZAPM.ed.BSF(ls) W $$atr^%ZAPM.ed.BS3(0) D EXIT G KL
ZE() Q $ZE_". "_$$ErrSay^%ZAPM.ed.BSF8($ZE)
PART(PARTITION,TIPP) ;СПИСОК ГЛОБАЛЕЙ
 I TIPP="PART" D PARTIT^%ZAPM.ed.BSF12(PARTITION) Q
 D ^%ZAPM.ed.BSMSMG(PARTITION)
 Q
COPYPART(PART) ;КОПИРОВАНИЕ РАЗДЕЛА
 N NP
 S NP=$$LineEdit^%ZAPM.ed.BSXfun("^","ВВЕДИТЕ ИМЯ РАЗДЕЛА, КУДА КОПИРОВАТЬ") Q:YES<1 0
 I $$Data^%ZAPM.ed.BSF12(NP) D Yes^%ZAPM.ed.BSXfun("РАЗДЕЛ "_NP_" УЖЕ СУЩЕСТВУЕТ, КОПИРОВАТЬ ?") Q:YES<1 0
 D Copy^%ZAPM.ed.BSF8(PART,NP,1) Q 1
 Q
C N %BS,Tmp,Qu D CM^%ZAPM.ed.BSF6
 Q
 ;-------------------------- 
 ;D INIT^%ZAPM.ed.BSChW ;ПЕРВОНАЧАЛЬНАЯ ИНИЦИАЛИЗАЦИЯ КОМПЛЕКСА
CACHERUN ;МОДУЛЬ ЗАПУСКА ПРИ КАЖДОЙ ЗАГРУЗКИ %BS В CACHE'
 I '$D(GREEN) D VAR^%ZAPM.ed.BSCh
 i $e($io,1,5)="|TCP|" S %BS(43)="W /CUP($Y,$X+1) W !" //это не ТЕЛНЕТ, TCP - сокетS
 I '$D(^%ZAPM.ed.BSETUP("OPTION")) D Copy^%ZAPM.ed.BSF8("^%ZAPM.ed.BSCDFLT(""N17"")","^%ZAPM.ed.BSETUP(""OPTION"")")
 i $tr($$ZV^%ZAPM.ed.BSCp,".")>200812||($p($$ZV^%ZAPM.ed.BSCp,".",1)>2008) s %BS(2008)=1
 if $zversion(1)=3 s %BS(2008)="1L" ;!msw
 Q
ver() Q +$G(^%ZAPM.ed.BS)_"."_$P($P(^%ZAPM.ed.BSC4,"@",2),"Version :",2)
PROT D Tex^%ZAPM.ed.BSMSMF("TermLogin",$G(U)_","_$G(BSR)_","_$G(BST)_","_$G(EDIT)_","_$G(MODE)_","_$G(BSLOGIN)_","_$G(BSSES))
 Q
ErrBST D Tex^%ZAPM.ed.BSMSMF("ErrorTerm="_$ze,$G(BSG,"?")_","_$G(BSROU)_","_$ZN_","_$ZU(5)_","_$G(%KEY("MGWLPN"),"?")_","_$s_","_$G(BSSES))
ErrBST1 N SAY I $D(BST),$ZE["<NOLINE" S SAY="Нет метки "_$P($G(BST),"^")_" в программе "_$P($G(BST),"^",2)_"."
 I $D(BST),$ZE["<NOROUTINE>" S SAY="Нет программы "_$G(BST)_"."
 D ER^%ZAPM.ed.BSF($G(SAY)_" Произошла Ошибка ! "_$$ZE())
 G KL
BST(U,BSR,BST,EDIT,MODE,BSLOGIN,BSSES) //Альтернативный вход в ТАБЛИЦУ
 N %intZAP,%intFK,ONS 
 D CC,DBL ;PLUS("%Bs"_BSLOGIN)
 S ONS=$ZU(5) W /CUP(1,1),$J("",999),# //ЧИСТКА ПЕРВЫХ СТРОК
 I $G(U)=1 D ^%ZAPM.ed.BSC G KL
 I $G(U)'="",'$$ZU^%ZAPM.ed.BSF4(U) D ^%ZAPM.ed.BSC G KL
 I BSR="$",BST="$" s $zt="ErrBST" W !,"...загружаем объекты "_U D PROT,GLO(U) G KL
 I BSR="#" s $zt="ErrBST1" D PROT D  G KL
 .I $$CFG^%ZAPM.ed.BSCp="ASU",$$ZU^%ZAPM.ed.BSF4("PRG") D VAR^BSe
 .D @BST
 I $G(BSR)="" D ^%ZAPM.ed.BSC G KL
 I $E(BSR,1)'="^" S BSR="^"_BSR
 I '$$Data^%ZAPM.ed.BSF12(BSR) D ^%ZAPM.ed.BSC G KL
 I BST="$" s $zt="ErrBST" D PROT,PARTIT^%ZAPM.ed.BSF12(BSR) G KL
 I '$$Data^%ZAPM.ed.BSF12($NA(@BSR@(BST))) D ^%ZAPM.ed.BSC G KL
 D PROT s $zt="ErrBST"
 I $G(EDIT)=0 D
 .N EDIT,ONS I '$P(@BSR@(BST),"@",16) S %intZAP=1,$P(@BSR@(BST),"@",16)=1
 .I $P(@BSR@(BST),"@",15)'="" S %intFK=$P(@BSR@(BST),"@",15),$P(@BSR@(BST),"@",15)=""
 .D
 ..I $G(MODE)=1 D  Q
 ...S W132=$P(@BSR@(BST),"@",10,11),$P(@BSR@(BST),"@",10,11)="45@132"
 ...S P132=$P(@BSR@(BST),"@",50) I P132 S O132=$P(@BSR@(BST),"@",19),$P(@BSR@(BST),"@",19)=P132
 ...D
 ....N %intZAP,%intFK,W132,P132,O132,EDIT,MODE
 ....D ^%ZAPM.ed.BST132
 ...I $D(W132) S $P(@BSR@(BST),"@",10,11)=W132
 ...I $D(O132) S $P(@BSR@(BST),"@",19)=O132
 ..D
 ...N %intZAP,%intFK,W132,P132,O132,EDIT,MODE
 ...D ^%ZAPM.ed.BST
 .I $D(%intZAP) S $P(@BSR@(BST),"@",16)=""
 .I $D(%intFK) S $P(@BSR@(BST),"@",15)=%intFK
 I $G(EDIT)=1 D
 .N EDIT,ONS D ^%ZAPM.ed.BST
 I $G(ONS)'="",'$$ZU^%ZAPM.ed.BSF4(ONS)
ERror G KL
DBL I BST["^^" S BST=$$TR^%ZAPM.ed.BSsFUNM(BST,"^^","^")
 Q
IP(S) N (S) D MAINVAR^%ZAPM.ed.BSC4
 I $D(BDSES),$D(@BDSES@(S)) Q $G(@BDSES@(S,"IP"))
 Q ""
CCC S %BS(40)=$G(BSSES,$J),%BS(41)=$$IP(%BS(40))
 ;I $D(%BS(39))'[0,$O(@%BS(39)@("-0",""))'="" S %BS(1)=$O(@%BS(39)@("-0",""))
 I '$D(GREEN) D VAR^%ZAPM.ed.BSCh
 Q
CC N APP,TOBD,GC
 S TOBD="^%ZAPM.ed.BSC(""PROTECT"")",GC=$$KBD^%ZAPM.ed.BSF12(TOBD)
 S APP=$$PROTECT^%ZAPM.ed.BSCp($G(BSLOGIN),"","NAV",1)
 D   D CLr^%ZAPM.ed.BSF4,EMUL,CCC
 .S (%BS(37),%BS(12))=BSLOGIN I "1"'[APP D  Q
 ..S %BS(39)=APP D CCC
 .I $D(^%ZAPM.ed.BSETUP("SETUP")) S %BS(1)=$P(@$ZR@(20,2),"@",15) Q
 .S %BS(1)="00000100001101001100" //DFLT
 Q
KL W $$atr^%ZAPM.ed.BS3(0) D EXIT^%ZAPM.ed.BS ;MINUS("%Bs"_BSLOGIN)
 R *R:1 H
n() Q $G(%BS(3),$P)_$J_"u"_%BS(15)
init d iniT^%ZAPM.ed.BSChW
q

]]></Routine>


<Routine name="%ZAPM.ed.BSC4" type="MAC" languagemode="0"><![CDATA[
%BSC4 ; Портал B4I ; 14:50 12.01.2003
 ;
 ;    Copyright Serge W. Mikhaylenko
 ;    All Rights Reserved
 Q
RUN ;Выполнение
 S $ZT="ErrRun^%ZAPM.ed.BSC4"
 D %KEY,MAINVAR
 I '$D(BSLABEL) W RED,$$LNG("Не определена метка выполнения",32),EF Q
 ;КОНТРОЛЬ И БИЛИНГ
 I $G(BSNSP)'="" D UCI($G(BSNSP))
 I $D(@BDREF@(BSRoutineId,"Name")) D  Q
 .S BDREQ=$$KBD^%ZAPM.ed.BSF12("^%ZAPM.ed.BSC4(""RouReq"")"),BDREQ1=$R(10)_$R(10)_$R(10)_$R(10)_$R(10)_$R(10)
 .S @BDREQ@(BDREQ1,"Ref")=BSRoutineId,@BDREQ@(BDREQ1,"IP")=CurUS,@BDREQ@(BDREQ1,"Time")=$H //ЗДЕСЬ МОЖНО СЧИТАТЬ ТРАФИК
 .D RU(BSLABEL_"^"_$G(@BDREF@(BSRoutineId,"Name")))
 .K @BDREQ@(BDREQ1)
 W RED,$$LNG("Некооректная переменная BSRoutineId=",33),BSRoutineId,EF
 Q
ErrRun S $ZT="",ze=$p($ZE,"^")  W RED,"Error: "_$$TRa^%ZAPM.ed.BSCh0(ze),EF,BBK
 Q
RU(%ZName) ;ЗАПУСК ПОЛЬЗ. ПРОГРАММЫ
 N %KEY,%CGI,%CGIEVAR,BDTAR,BDREF,BDREQ,BDREQ1,BDPIN,BDUSE,BDSES,GTmp,%BS,%ZCS,%zT,CMND
 N MGWCHD,MGWEBP,MGWJSP,MGWLPN,MGWNSP,MGWPWD,MGWUCI,MainOpt,NSPACE,ROU,TIMEOUT,X,bsg,bsd
 ;N BDDIC
 D @%ZName
 Q
LNG(ID,nu) i $d(nu) Q:$G(@BDDIC@(nu,$E($G(BSLNG,"RUS"),1)))="?" ID Q @$ZR
 Q $G(@BDDIC@(ID,$E($G(BSLNG,"RUS"),1)),ID)
MAIN ;ГОЛОВНАЯ ПРОГРАММА - ДИСПЕТЧЕР
 ;S $ZT="ErrRun^%ZAPM.ed.BSC4"
 D %KEY
 D MAINVAR
 I $G(%KEY("UZN"))'="" D:$$ZU^%ZAPM.ed.BSF4(%KEY("UZN")) ^dispatcher Q
 I $P($P($G(^%ZAPM.ed.BSC4("ADV")),"@",1),":",2)["Portal" D REMONT("Информационный портал") Q
 I $G(BSSES)'="",'$$EnablSess() D CLOSEWIN("#"_BSSES_". "_$$LNG("Текущая сессия закрыта. Открывайте новую сессию.",34)) Q
 I '$D(BSLABEL) W "Не определена программа !"   D l^%ZAPM.ed.BSCp2 Q
 S BSLABEL=$$%^%ZAPM.ed.BSCh(BSLABEL)
 D UCI($G(BSNSP))
 //I $G(BSPART)["~" S BSPART=$$%^%ZAPM.ed.BSCh(BSPART)
 I $G(BSLABEL)'="" D  Q
 .;I $G(BSLABEL)'["^" D @BSLABEL Q
 .I $G(BSLABEL)["N%" S BSLABEL=$$TR^%ZAPM.ed.BSsFUNM(BSLABEL,"N%","^%") D @BSLABEL Q
 .;I $G(BSLABEL)["^%ZAPM.ed.BS" 
 .D @BSLABEL Q
 .W $$LNG("Запрещенная метка 'BSLABEL'...",174)_$G(BSLABEL)_"!!!"
 W $$LNG("Нет переменной 'BSLABEL'...",36)
 Q
UCI(BSNSP) Q:BSNSP="" "?"
 I BSNSP["~" Q $$ZU^%ZAPM.ed.BSF4("%"_$E(BSNSP,2,99))
 I BSNSP'["~" Q $$ZU^%ZAPM.ed.BSF4(BSNSP)
 Q "?"
 //$$GETOPT^%ZAPM.ed.BSC4cfgP("^%ZAPM.ed.BSETUP(""ISS"")","bzOUTtables","V","^[""%SYS""]BSC4.ISS.Setup") //ТИПОВОЙ ВЫЗОВ ОБЩЕСИСТЕМНЫХ ПАРАМЕТРОВ
MainOpt() N t    S t=$$GETOPT^%ZAPM.ed.BSC4cfgP("^%ZAPM.ed.BSETUP(""ISS"")","Acfg")
 I t="" S t="^%ZAPM.ed.BSETUP(""CFG"")"
 Q t
MAINVAR ;ОСНОВНЫЕ ПЕРЕМЕННЫЕ ПОРТАЛА
 S MainOpt=$$MainOpt
 ;```I '$D(BStyle) 
 S BStyle=$$GETOPT^%ZAPM.ed.BSC4cfg(MainOpt,"CurCSS")
 I '$D(GREEN) D VAR^%ZAPM.ed.BSCh
 S NAVIG=$G(%CGIEVAR("HTTP_USER_AGENT"))
 S BDDIC=$$KBD^%ZAPM.ed.BSF12("^%ZAPM.ed.BSC4(""DICT"")")
 S BDREF=$$KBD^%ZAPM.ed.BSF12("^%ZAPM.ed.BSC4(""RouRef"")")
 S BDPIN=$$KBD^%ZAPM.ed.BSF12("^%ZAPM.ed.BSC4(""PIN"")")
 S BDUSE=$$KBD^%ZAPM.ed.BSF12("^%ZAPM.ed.BSC4(""PROTECT"")") ;W RED_111_$G(BDUSE,"?")_222_EF
 S BDSES=$$KBD^%ZAPM.ed.BSF12("^%ZAPM.ed.BSC4(""SESSIONS"")")
 S BDTAR=$$KBD^%ZAPM.ed.BSF12("^%ZAPM.ed.BSC4(""TARIFF"")")
 S BSDOMAIN=$$GETOPT^%ZAPM.ed.BSC4cfgP("^%ZAPM.ed.BSETUP(""ISS"")","bb4y1") 
VARI     S (%BS(41),CurUS)=$$ADDRIP
 S GTmp=$NA(^["%SYS"]mtempBD4(CurUS))
 S HTTPREF=$G(%CGIEVAR("HTTP_REFERER"))
 I $D(BSSES) S %BS(40)=BSSES
 I $D(BSLOGIN) S %BS(12)=BSLOGIN
 S %BS(24,1)=$$KBD^%ZAPM.ed.BSF12("^%ZAPM.ed.BSVOL(""PROTOKOL"")")
 Q
EnablSess() ;КОНТРОЛЬ СЕССИЙ
 I $D(@BDSES@(BSSES)),$G(BSLOGIN)=$G(@BDSES@(BSSES,"NM")),$G(CurUS)=$G(@BDSES@(BSSES,"IP")),$G(@BDSES@(BSSES,"CHR"))="" S @BDSES@(BSSES,"CUR")=$H D  Q 1
 .S @BDSES@(BSSES,"COUNT")=$G(@BDSES@(BSSES,"COUNT"))+1
 Q 0
%KEY N I,II,J  S I="" F  S I=$O(%KEY(I)) Q:I=""  D
 .;S $ZT="%ErKey" 
 .I $D(%KEY(I))>1 D  Q
 ..I $D(%KEY(I,$O(%KEY(I,""),-1)))=1 S @I=%KEY(I,$O(%KEY(I,""),-1)) Q
 ..S II="",J="",JJ=$O(%KEY(I,""),-1) I JJ="" S @I="" Q
 ..F  S II=$O(%KEY(I,JJ,II)) Q:II=""  S J=J_%KEY(I,JJ,II)
 ..S @I=J
 .I $E(I)'?1N S @I=%KEY(I)
 I $G(BSLNG)="" S BSLNG="RUS"
 K BSROU,BSNSPACE
 Q
%ErKey Q
BEG1 ;i $d(zBEG1) q
 D GRA N BSGRANT
 i '$D(BK) D VAR^%ZAPM.ed.BSCh
 W "<HTML><HEAD>"_BK ;_"<LINK REL=""SHORTCUT ICON"" HREF=""http://localhost:1962/b4y/b4y.ico"">"	
 s zBEG1=1 //флаг о том, что заголовок уже выведен 
 w $$STYLE
 Q
First2 ;H 1
First ;ПЕРВАЯ УГЛОВАЯ СТРАНИЦА
 S Frame="LeftUp"
 D BEG1
 w BK,"<script LANGUAGE=""JavaScript"">",BK
 W "function ReSet() {",BK
 S BSLABEL="L1"
   w "parent.L1.location='"_$$ADDBSGET()_"';",BK
 S BSLABEL="U1"
   ;w "alert(parent.U1.name);"
   w "parent.U1.location='"_$$ADDBSGET()_"';",BK
 S BSLABEL="D1"
   w "parent.D1.location='"_$$ADDBSGET()_"';",BK
 W "}",BK
 W "</script>",BK
 D UGOL(1)
 S II=BSLNG,BSLABEL="First"
 I $$GETOPT^%ZAPM.ed.BSC4cfg(MainOpt,"MultiL") D
 .W "<p align='center'><font size=1 face='Arial, Helvetica, MS Sans Serif'>"
 .F I="RUS","ENG" d  ;,"GER","FRA" D
 ..N BSLNG W " "
 ..I II=I W I
 ..E  S BSLNG=I W "<A HREF='",$$ADDBSGET(),"'>",I,"</A>"
 ..W " "
 .W EF,"</p>"
 W "</span>"
 D END
 q
UGOL(O)     W "</HEAD>",BK
 W "<BODY "_$S(O:"onload='ReSet();'",1:"")_">" // background='"_BSDOMAIN_"/logo/ugol.gif'>",BK
 N IP,IP1,IP2 S IP1="" //$$LNG("P")
 S IP=$$GETOPT^%ZAPM.ed.BSC4cfg(MainOpt,"IP") I IP'="" S IP1=IP
 S IP2=$$GETOPT^%ZAPM.ed.BSC4cfg(MainOpt,"B4I")
 i IP1'="" S IP1="<font size=1 face='Arial, Helvetica, MS Sans Serif'>"_IP1_EF //_BBK
 S IP2=BLUE_"<big><strong>"_IP2_"</strong></big>"_EF //__BBK
 N BD,z,GR1L,GR1B S BD=$$KBD^%ZAPM.ed.BSF12("^%ZAPM.ed.BSC4(""GRAND"")")
 s BSGRANT=$G(BSGRANT,"DFLT") I $G(BSGRANT)="" s BSGRANT="DFLT"
 S z=$$GetVar^%ZAPM.ed.BSC4("GRANT") I z'["ERROR",z'="" S BSGRANT=z
 S GR1L=$G(@BD@(BSGRANT,"TXTLITL")),GR1B=$G(@BD@(BSGRANT,"TXTBIG"))
 I GR1L'="" S IP1=GR1L
 I GR1B'="" S IP2=GR1B
 W "<span id=Ugol >"
 I $G(BSframe) d @("UGOL"_BSframe)
 E  w "<table border=0 width=100%><tr><td align=center>"_IP1_"</td></tr><tr><td align=center>"_IP2_"</td></tr></table>"
 Q
END W "</BODY></HTML>",BK
 Q
RECURS(S) Q:S=""  ;РЕКУРСИВНЫЙ МОДУЛЬ ВЫЧЛЕНЕНИЯ НЕПЕРЕСЕКАЮЩИХСЯ АТОМАРНЫХ ГРАНДОВ
 N FFF
 I S'["," D  Q
 .I $G(@BD@(S,"Z1"))'="" D RECURS($G(@BD@(S,"Z1"))) Q
 .I $G(@BD@(S,"MENU"))'="" I '$D(FF(S)) S F=$G(F)+1,F(F)=S,FF(S)=""
 F FFF=1:1 Q:$P(S,",",FFF,FFF+1)=""  D RECURS($P(S,",",FFF))
 Q
GRA N BD,z,GR1S S BD=$$KBD^%ZAPM.ed.BSF12("^%ZAPM.ed.BSC4(""GRAND"")")
 s BSGRANT=$G(BSGRANT,"DFLT") I $G(BSGRANT)="" s BSGRANT="DFLT"
 S z=$$GetVar^%ZAPM.ed.BSC4("GRANT") I z'["ERROR",z'="" S BSGRANT=z
 S GR1S=$G(@BD@(BSGRANT,"STYLE"))
 I GR1S'="" S BStyle=GR1S
 Q
L1 ;ЛЕВЫЙ ФРЭЙМ
 N Cm,FF,F,BD
 S Frame="LeftDn"
 D BEG1
 S BD=$$KBD^%ZAPM.ed.BSF12("^%ZAPM.ed.BSC4(""GRAND"")")
 s BSGRANT=$G(BSGRANT,"DFLT") I $G(BSGRANT)="" s BSGRANT="DFLT"
 S z=$$GetVar^%ZAPM.ed.BSC4("GRANT") I z'["ERROR",z'="" S BSGRANT=z
 S Cm=$$GETOPT^%ZAPM.ed.BSC4cfg(MainOpt,"Commerce")
 W "</HEAD><DIV id=BodyL1 >"
 //w "<BODY TEXT=#8F8F8F LINK=#000095 VLINK=#460080 ALINK=BLUE>",BK
 w "<BODY TEXT=black LINK=black VLINK=black ALINK=black>",BK
 
 d RECURS(BSGRANT) I '$D(F)  W "Грант: "_RED_$G(BSGRANT)_EF_" - пустой!"
 N BSGRANT 
 
 I $G(BSframe) d @("Top"_BSframe)
 e  W "<H3><table border=0>" D LA1,LAend
 
 s I="" F  S I=$O(F(I)) Q:I=""  i F(I)'="" D  S BSmenuID=F(I) D @PMENU
 .S PMENU=$G(@BD@(F(I),"MENU")),PREM=$G(@BD@(F(I),"REM")),PTITLE=$G(@BD@(F(I),"TITLE"))
 .S PPROG=$G(@BD@(F(I),"PROG")),PWRITE=$G(@BD@(F(I),"WRITE")),PTOPIC=$G(@BD@(F(I),"TOPIC"))
 .S PTOPIC1=$G(@BD@(F(I),"TOPIC1")),NSP1=$G(@BD@(F(I),"NSP"))
 .I PMENU="" S PMENU="zerro^%ZAPM.ed.BSC4b"
 
 I $G(BSframe) d @("TopEnd"_BSframe)
 e  D LA1,LAend W "</table>" W "</H3>"
 D JS^%ZAPM.ed.BSCp
 	w "var Prev1='1';"_BK
 	W "function Cur(tt)",!
	W "    {",!  
	//w "alert(11);"_BK
	W "        if (Prev1=='2') {Prev.className = 'TopMenuNorm';}"_BK
	//W "        tt.className = 'TopMenuSel';"_BK
	//W "        tt.style.color='white';"_BK
	W "        Prev=tt; Prev1='2';",!
	W "    };",!
	W "function MOver(t) {",!
	W "     if (t.className!='TopMenuSel') {t.className = 'TopMenuOver';}"_BK
	W "    };",!	
	W "function MOut(t) {",!
	W "     if (t.className!='TopMenuSel') {t.className = 'TopMenuNorm';}"_BK
	W "    };",!	
	W "function MDown(t) {",!
	W "     if (t.className!='TopMenuSel') {t.className = 'TopMenuSel'; Cur(t);} "_BK
	W "    };",!	
 D JSE^%ZAPM.ed.BSCp
 w "<br>" 
 I $G(BSframe)="" D FOO("footer")
 W ""
 W "</BODY></DIV></HTML>"
 Q
mouse() n q s q=" ONMOUSEOVER='MOver(this);' ONMOUSEOUT='MOut(this);' ONMOUSEDOWN='MDown(this);' " 
	//ONMOUSEUP="this.className = 'ParamOver';"> 
	q q
FOO(HTML) S gr=$G(^%ZAPM.ed.BS("Config",HTML)) I gr="" D
 .D BSdebug
 .I $G(BSdebug) d logo
 .D COPYR
 E  W AF_"Конфигурация :"_RED_$$CFG^%ZAPM.ed.BSCp_EF_""_EF_"<BR><BR>" W gr
 Q
BSdebug I $G(BSdebug),$d(BSLOGIN),'$$GRA^%ZAPM.ed.BSCGIS(BSLOGIN,"zDebug") K BSdebug
 Q
LA1 I $G(BSframe) d @("LA1"_BSframe)
 E  W "<TR><TD class=s3> </TD><TD class=s3><font size=4 face='Arial, Helvetica, MS Sans Serif'><b>"
 Q
LA(TOP,ENABLE,IMG) ;ВЫВОД ПУНКТА
 D LA1
 S BSLABEL=TOP
 I '$G(ENABLE) W "<div class=TopMenuDis id='"_F(I)_"'>"_$G(IMG)_$$LNG(TOP)_"</div>" g LAend
 S BSTOP=TOP
 W "<span id='"_F(I)_"'><A class=TopMenuNorm "_$$mouse()_" HREF='"_$$ADDBSGET_"' target='U1' "_$$title(TOP)_">"_$G(IMG)_$$LNG(TOP)_" </A><span>" ;,BBK
LAend I $G(BSframe)  d @("LAend"_BSframe)
 E  W "</b></font></TD><TD class=s3> </TD></TR>"_BK
 Q
mR I $G(BSNOREG)="0" D LA("reg",$G(BSSES))
 Q
reg D BSTOP Q
reg2 D ^%ZAPM.ed.BSC4reg
 Q
mH D LA("docum",1,"<img src='"_BSDOMAIN_"/img/help1.gif' border=0 title='Документация разработчика' >") q
docum D BSTOP Q
docum2 D help
 Q
mSCO //попробуем без этого режима  D LA^%ZAPM.ed.BSC4($S($G(BSSES)'="":"Sclose",1:"Sopen"),1,$S($G(BSSES)'="":"<img border=0 src='"_BSDOMAIN_"/img/exit.gif'>",1:"<img border=0 src='"_BSDOMAIN_"/img/open.gif'>"))  
 I $G(BSSES)'="" D
 .N BSnewREG S BSnewREG=1
 .D LA^%ZAPM.ed.BSC4("Sopen",1,"<img border=0 src='"_BSDOMAIN_"/img/open.gif'>")  Q
 Q
Sopen D BSTOP q
Sopen2 D Sopen^%ZAPM.ed.BSC4reg
 Q
Sclose D BSTOP q
Sclose2 D CloseSes^%ZAPM.ed.BSC4reg
 Q
mA D LA("ADM",1,"<img src='"_BSDOMAIN_"/img/option.gif' border=0>") Q
ADM D BSTOP q
ADM2 D ADM^%ZAPM.ed.BSC4rout
 Q
projimg() q "<img src='"_BSDOMAIN_"/img/proj.gif' border=0>"
mP D LA("proo",$G(BSSES)'="",$$projimg) q
proo D BSTOP Q
proo2 D ^%ZAPM.ed.BSC4base
 Q
mRe I $g(Cm)=1 D LA("rent",$G(BSSES)'="")
 q
rent D BSTOP Q
rent2 D rent^%ZAPM.ed.BSC4rout
 Q
mT  I $g(Cm)=1 D LA("tariff",1)
 q
tariff D BSTOP Q
tariff2 ;тарифы
 D BEG1 N BDT,I
 W " <table border=0 width=100%>"
 W "<tr><td align='right' class=s3 ><strong>"_$$LNG^%ZAPM.ed.BSC4("tariff")_"</strong></td class=s3 >" D  W "</tr>",BK
 .F I=0:1:3 W "<td class=s3 >&nbsp;"_$$LNG^%ZAPM.ed.BSC4("T"_I)_"</td>"
 W "<tr><td align='right' class=s3 >"_$$LNG^%ZAPM.ed.BSC4(24)_"</td class=s1 >" D  W "</tr>",BK
 .F I=0:1:3 W "<td class=s1 >&nbsp;"_$G(@BDTAR@(I,"D"))_"</td>"
 W "<tr><td align='right' class=s3 >"_$$LNG^%ZAPM.ed.BSC4(25)_"</td class=s1 >" D  W "</tr>",BK
 .F I=0:1:3 W "<td class=s1 >&nbsp;"_$G(@BDTAR@(I,"PG"))_"</td>"
 W "<tr><td align='right' class=s3 >"_$$LNG^%ZAPM.ed.BSC4(26)_"</td class=s1 >" D  W "</tr>",BK
 .F I=0:1:3 W "<td class=s1 >&nbsp;"_$G(@BDTAR@(I,"GOD"))_"</td>"
 W "<tr><td align='right' class=s3 >"_$$LNG^%ZAPM.ed.BSC4(23)_"</td class=s1 >" D  W "</tr>",BK
 .F I=0:1:3 W "<td class=s1 >&nbsp;"_$G(@BDTAR@(I,"M"))_"</td>"
 W "<tr><td align='right' class=s3 >"_$$LNG^%ZAPM.ed.BSC4(27)_"</td class=s1 >" D  W "</tr>",BK
 .F I=0:1:3 W "<td class=s1 >&nbsp;"_$G(@BDTAR@(I,"BD"))_"</td>"
 W "<tr><td align='right' class=s3 >"_$$LNG^%ZAPM.ed.BSC4(28)_"</td class=s1 >" D  W "</tr>",BK
 .F I=0:1:3 W "<td class=s1 >&nbsp;"_$G(@BDTAR@(I,"ROU"))_"</td>"
 W "<tr><td align='right' class=s3 >"_$$LNG^%ZAPM.ed.BSC4(29)_"</td class=s1 >" D  W "</tr>",BK
 .F I=0:1:3 W "<td class=s1 >&nbsp;"_$G(@BDTAR@(I,"TRF"))_"</td>"
 W "<tr><td align='right' class=s3 >"_$$LNG^%ZAPM.ed.BSC4(30)_"</td class=s1 >" D  W "</tr>",BK
 .F I=0:1:3 W "<td class=s1 >&nbsp;"_$$LNG^%ZAPM.ed.BSC4($G(@BDTAR@(I,"PRI"),"?"))_"</td>"
 W "</table>"
 //D TXTARIF^%ZAPM.ed.BSC4reg(
 D InfoSess^%ZAPM.ed.BSC4rout
 D END
 Q
mAb I Cm=1 D LA("about",1)
 q
about D BSTOP Q
about2
 D SITE("D1",BSDOMAIN_"/about/"_$$LITL^%ZAPM.ed.BSsFUNM(BSLNG)_"/index.htm")
 Q
SITE(FRAME,URL)
 D BEG1
 w BK,"<script LANGUAGE=""JavaScript"">",BK
 W "function ReSet2() {",BK
 w "parent."_FRAME_".location='"_URL_"';",BK
 W "}",BK
 W "</script>",BK
 W "</HEAD>",BK
 W "<BODY onload='ReSet2();'>",BK
 D END
 Q
BSTOP1 W "<table border=0 width=100%><tr>"
 W "<td align=center width=70% class=TopHeadSel>" //<font color=#FFFFFF>"
 Q
Header(s) q "<DIV id=HeadU1 align=center class=TopHeadSel >"_s_"</DIV>"
BSTOP ;ВЫВОД ЗАГОЛОВКА В ВЕРХНЕМ ФРЭЙМЕ
 S Frame="RightUp"
 D BEG1
 w BK,"<script LANGUAGE=""JavaScript"">",BK
 W "function ReSet1() {",BK
 S BSLABEL=BSTOP_2
 w "parent.D1.location='"_$$ADDBSGET()_"';",BK
 W "}",BK
 W "</script>",BK
 W "</HEAD>",BK
 W "<BODY onload='ReSet1();'>"_BK // background='"_BSDOMAIN_"/logo/up.gif'>",BK
 w $$Header($s($G(BSTOP2)'="":$$LNG^%ZAPM.ed.BSC4(BSTOP2),1:$$LNG^%ZAPM.ed.BSC4(BSTOP))) g END //для ASU
 D BSTOP1
 W "<H1><DIV id=HeadU1 >"_$$LNG(BSTOP)_"</DIV></H1>" //,EF
 W "</td><td><DIV id=TabU1 ><table border=0>"
 I BSTOP="proo" D
 .n BSLABEL,A1
 .S BSLABEL="PRO^~BSC4base" W "<tr><td>"_$$A1(1)_$$LNG("проекты",37)_A1_"</td></tr>",BK
 .S BSLABEL="TAB^~BSC4base" W "<tr><td>"_$$A1(0)_$$LNG("таблицы",38)_A1_"</td></tr>",BK
 .S BSLABEL="ROU^~BSC4base1" W "<tr><td>"_$$A1(0)_$$LNG("программы",39)_A1_"</td></tr>",BK
 W "</table></DIV>"
 W "</td></tr></table>"
 D END
A1(O) S A1="</LI>" Q "<LI class=u1 style=""list-style-image: url('"_BSDOMAIN_"/logo/open"_O_".gif')"" OnClick=""parent.D1.location='"_$$ADDBSGET()_"';"">"
U1 ;ВЕРХНИЙ ФРЭЙМ
 S Frame="RightUp"
 D BEG1
 W "</HEAD><BODY>"_BK // background='"_BSDOMAIN_"/logo/up.gif'>",BK
 ;W "<table border=0 width=100%><tr><td align=center width=70% class=s3><font color=#FFFFFF><H1><DIV id=HeadU1 >",$$LNG(0)," ",$$LNG(1)_EF_"</DIV></H1></B></font></td><td><DIV id=TabU1 ><table border=0></table></DIV></td></tr></table>"
 w $$Header($$LNG(0)_" "_$$LNG(1))
 D END
 Q
D1 ;НИЖНИЙ ФРЭЙМ
 S Frame="RightDn"
 D BEG1
 W "</HEAD><BODY>",BK
 I $g(Cm)=1 W $$LNG(2),"<br><br>" D  D D11 I 1
 .//_$$LNG(4)_" "_$$GetAllVisit^%ZAPM.ed.BSCh("R","B4Y")_"<br>"_$$LNG(3)," ",$$GetAllVisit^%ZAPM.ed.BSCh("Q","B4Y"),"<br>"
 E  W $$LNG(333),"<br><br>"
 N GetAccLU I $G(BSLOGINDFLT)'="" I $$GetAcc^%ZAPM.ed.BSC4cfgP(BSLOGINDFLT,"Aautoreg")!($G(@BDUSE@(BSLOGINDFLT,"REG"))=1) D  //ВКЛ АВТОРЕГИСТРАЦИЯ
 .D JS^%ZAPM.ed.BSCp
 .n BSLOGIN,BSLABEL S BSLOGIN=BSLOGINDFLT,BSLABEL="SopenP^~BSC4reg",BSPASS=$G(BSPASS)
 .w "parent.D1.location='"_$$ADDBSGET()_"';"_BK
 .D JSE^%ZAPM.ed.BSCp
 D InfoSess^%ZAPM.ed.BSC4rout,END
 Q
D11 w "<br>",$$LNG(5),"<br><br>",$$LNG(6),"<br>" q
title(ID) n i s i=$G(@BDDIC@(ID,"t"_$E(BSLNG,1)))
 i i="" q ""
 Q "title='"_i_"'"
BSPARVAR(A,B) //ВОССТАНОВИТЬ ПЕРЕМЕННЫЕ
 N I F I=1:1 Q:$P(A,"@",I,I+1)=""  S @$P(A,"@",I)=$P(B,"@",I)
 Q I
BSADDVAR() //СОБРАТЬ ВСЕ ПЕРЕМЕННЫЕ
 N %zz1,%zz0,%zz2,%zz3,II
 S %zz1="",%zz1=$O(@%zz1)
 S II="",x="" F  Q:%zz1=""  D:%zz1'["%zz"  S %zz1=$O(@%zz1)
 .I "11"[$D(@%zz1),$E(%zz1,1,2)="BS" S x=x_%zz1_"@",II=II_@%zz1_"@"
 S I=x Q II
ADDRIP() N CurUS //АДРЕС УДАЛЕННОГО КЛИЕНТА
 S CurUS=$G(%CGIEVAR("REMOTE_ADDR"),$G(BSLOGIN,"?")) I CurUS="" S CurUS="?"
 Q CurUS
ADDSN() i $G(%("HOST:"))'="" Q $G(%("HOST:"))  //ИМЯ СЕРВЕРА С ПОРТОМ, Без порта $ZU(110)
  Q $$ipS^%ZAPM.ed.BSCp2  //ip сервера
ADDLIB()  I $G(MGWLIB)="" d
 .i $G(%("HOST:"))'="" S MGWLIB="/?BSTKWEB%20" q  ;TK-WEB
 .S MGWLIB="/scripts/mgwms32.dll"                 ;WEBLINK
 Q $G(MGWLIB)_"?"
ADDBSGET(%zz4,%zz8) ;ДОБАВИТЬ ВСЕ BS-ПЕРЕМЕННЫЕ
 N %zz1,%zz0,%zz2,%zz3,I,II,%zz7
 S II=$$addbs()
 Q $$ADDLIB()_"BSG=B4"_$G(%zz4,"I")_II_%zz7
addbs()  I $G(%zz8)'="" N BSLABEL S BSLABEL=$TR(%zz8,"%","~")
 S %zz1="",%zz1=$O(@%zz1),%zz7="" I $G(MGWSTO) S %zz7="&MGWSTO="_MGWSTO
 S II="" F  Q:%zz1=""  D:%zz1'["%zz"  S %zz1=$O(@%zz1)
 .I "11"[$D(@%zz1),$E(%zz1,1,2)="BS",%zz1'="BSG" S II=II_"&"_%zz1_"="_@%zz1
 Q II
addb(%zz4,%zz8) ;ДОБАВИТЬ ВСЕ BS-ПЕРЕМЕННЫЕ
 N %zz1,%zz0,%zz2,%zz3,I,II,%zz7
 Q $$addbs()
logo ;логотип
 W AF_"Конфигурация :"_RED_$$CFG^%ZAPM.ed.BSCp_EF_""_EF_"<BR><BR>"
 I $g(Cm)=1 W $$logo2 Q
 W $$logo1
 Q
logo2() Q "<a href='http://www.intersystems.ru' target='_new'>"_$$logo1_"</a>"_"<br>"_BK
logo1() Q "<img src='"_BSDOMAIN_"/logo/logo.gif' alt='InterSystems' border=0>"
COPYR W "<p align='left'><font size=1 face='Arial, Helvetica, MS Sans Serif'>",BK
 I BSLNG="RUS" W BLUE_"<div title='"_$$GETOPT^%ZAPM.ed.BSC4cfg(MainOpt,"ENDUSER")_"'>""Нужное не сложно,<br>Сложное не нужно"".<br></div>"_EF
 E  W BLUE_"""Necessary it is not difficult,<BR>Difficult it is not necessary"".<BR>"_EF
 W "<br>",BK S YY=$P($P($G(^%ZAPM.ed.BSC4),"от",2),"-") I YY="" S YY="2005"
 W $$News("&copy; 1993 -"_YY_". %BS-Portal")_"<br>"
 I $g(Cm)=1      W "&copy; 1993-"_YY_". "_$S(BSLNG="RUS":"Сергей В. Михайленко",1:"Serge W. Mikhaylenko")_"<br>"
 I BSLNG="RUS" W "Все права защищены<br>Версия "
 E  W "All Rights Reserved<br>Version "
 W $$ver^%ZAPM.ed.BSC_"<br>"_BK
 N A S A=$$GETOPT^%ZAPM.ed.BSC4cfgP("^%ZAPM.ed.BSETUP(""ISS"")","Admin") S BSend2mail=$ZCONVERT($P($P(A,"<",2),"@"),"U")
 W "e-mail: <a href='"_$$ADDBSGET^%ZAPM.ed.BSC4(,"SMTP1^~BSvdaMAIL")_"' target=new title='Послать письмо админиcтратору портала'>"_$P(A,"<",1)_"</a>"
 W $P(A,">",2)
 I $g(Cm)=1 w "<br>phone: +7 (095) 361-8735"
 W "</p>"_BK
 /*      I $D(BSSES) D  //НЕ ПОЛУЧИЛСЯ ФОКУС
 .W "<script LANGUAGE='JavaScript' EVENT='onunload()' FOR='window'>"_BK
 .S BSLABEL="CloseSession^~BSC4reg" W "open('"_$$ADDBSGET()_"','Dummy','width=1,height=1');",BK
 .W "</script>"_BK */
 ;S NoDetal=1 d InfoSess^%ZAPM.ed.BSC4rout
 Q
HelpPortal() N I ; N GetAccLU I $D(BSLOGIN),$$GetAcc^%ZAPM.ed.BSC4cfgP(BSLOGIN,"BSDA")>2 S I=" <a class=u1 onclick='open("""_$$ADDLIB^%ZAPM.ed.BSC4()_"BSG=B4&BSLABEL=Navigator&BSLNG=RUS&BSNSP=~SYS&BSPRO=DOC&BSRoutineId=839116428"","""",""toolbar=no,menubar=no,scrollbars=yes,"_$$GETOPT^%ZAPM.ed.BSC4cfg(MainOpt,"NWT1")_",status=1,resizable=1"");'><img src='"_BSDOMAIN_"/img/edithelp.gif' ALT='EditHelpPortal' border=0></a>"
 Q $G(I)_"<li><a class=u1 onclick='open("""_$$ADDLIB^%ZAPM.ed.BSC4()_"BSG=B4&BSLABEL=ViewTree&BSLNG=RUS&BSNSP=~SYS&BSPRO=DOC&BSRoutineId=2441218863"","""",""toolbar=no,menubar=no,scrollbars=yes,"_$$GETOPT^%ZAPM.ed.BSC4cfg(MainOpt,"NWT1")_",status=1,resizable=1"");' ><img src='"_BSDOMAIN_"/img/help.gif' ALT='"_$$LNG^%ZAPM.ed.BSC4(" Схемы функционирования и информация о функциях, программных модулях и внутренних переменных необходимых для разработки пользовательских проектов'",42)_"' border=0></a>"
 ;HelpCOS() q "<li><a href='"_BSDOMAIN_"/docs/olr/olrrefTOC.html' title='Cach&eacute; ObjectScript Language Reference' target='_new1'>HelpCOS</a>"
 ;HelpSQL() q "<li><a href='"_BSDOMAIN_"/docs/sqr/sqlreference.html' title='Cach&eacute; SQL Reference' target='_new2'>Cach&eacute;SQL</a> <a href='"_BSDOMAIN_"/docs/err/errsql.html' title='Cach&eacute; SQL Errors' target='_newE'>SQL Errors</a>"
HelpCache() Q "<li><a href='http://"_$P($$ADDSN^%ZAPM.ed.BSC4(),":")_":"_$s($$ZV^%ZAPM.ed.BSCp>5:8,1:1)_"972/csp/docbook/DocBook.UI.Page.cls' title='Online Full Documentation' target='_new5'>Полная документация по СУБД Cache'</a> "
HelpCacheClass() q "<li><a href='http://"_$P($$ADDSN^%ZAPM.ed.BSC4(),":")_":"_$s($$ZV^%ZAPM.ed.BSCp>5:"8972/csp/documatic/%25CSP.Documatic.cls",1:"1972/apps/documatic")_"' title='Online Class Documentation' target='_new5'>Class Documentation</a> "_$$LNG^%ZAPM.ed.BSC4(" Докуметация Классов СУБД Cache'",47)
HelpDhtml() q "<li><a href='"_BSDOMAIN_"/docs/html4spec/index.html' title='"_$$LNG^%ZAPM.ed.BSC4("Спецификация",40)_" HTML 4.0' target='_new3'>DHTML</a>"
HelpJS() q "<li><a href='"_BSDOMAIN_"/docs/javascript/index.htm' title='"_$$LNG^%ZAPM.ed.BSC4("Спецификация",40)_" JavaScript' target='_new4'>JavaScript</a>"
News(n) I $G(BSLOGIN)="" Q n
 I '$$GRA^%ZAPM.ed.BSCGIS(BSLOGIN,"zDebug") Q n
 n BSfile S BSfile="http://"_$$ADDSN^%ZAPM.ed.BSC4()_BSDOMAIN_"/docs/BS-Portal_Release_notes.txt"
 q "<a href='"_$$ADDBSGET^%ZAPM.ed.BSC4(,"GETTXT^~BSC4")_"' target=new TITLE='Что нового в комплексе'>"_n_"</a>"
BSDOC  w "<li>"_$$News("BS-Portal_Release_notes"),BBK,BBK
 S BSfile="http://"_$$ADDSN^%ZAPM.ed.BSC4()_"/vv/bsdoc/BS_Release_notes.txt"
 w "<li><a href='"_$$ADDBSGET^%ZAPM.ed.BSC4(,"GETTXT^~BSC4")_"#GOend' target=new TITLE='новости в комплексе до 9 версии для MSM'>Новости до 9 версии (Система MSM)</a> "
       W "<a href='http://"_$$ADDSN^%ZAPM.ed.BSC4()_"/vv\bsdoc\index.htm' target=new TITLE='Официальная документация %BS - Терминальный режим для MSM до 9 версии'>Официальная документация %BS</a>"
 Q
help ;
 D BEG1 W "<title>Документация по порталу для разработчика</title></HEAD>"_$$B27^%ZAPM.ed.BSCm4()
 w !,"<li>Комплекс %BS<ul>" D BSDOC
 W !,"<LI>"_$$mBSDOC1^%ZAPM.ed.BSC4b_BBK,BBK
 w !,"<li>"_$$BsDoc^%ZAPM.ed.BSC4b("Докуметация по комплексу %BS")_BBK,BBK
 W !,$$HelpPortal,"Докуметация BS-портала",BBK,BBK ;http://localhost:1972/CSP/MSW/Bsdoc.csp
 W !,"<li><a href='http://"_$P($$ADDSN^%ZAPM.ed.BSC4(),":")_":"_$s($$ZV^%ZAPM.ed.BSCp>5:8,1:1)_"972/csp/msw/Bsdoc.csp' title='Online BS-Doc' target='_new9'>Online BS-Doc</a> "
 W !,"<li><a href='http://"_$P($$ADDSN^%ZAPM.ed.BSC4(),":")_":"_$s($$ZV^%ZAPM.ed.BSCp>5:8,1:1)_"972/csp/msw/BsLib.csp' title='Online BS-Lib' target='_new99'>Online BS-Lib</a> "
 ;W !,$$HelpCOS,$$LNG^%ZAPM.ed.BSC4(" Описние языка программирования в СУБД Cache'",43),BBK,BBK
 ;S UR="http://"_$$ADDSN^%ZAPM.ed.BSC4()_BSDOMAIN_"/docs/Kirsten-Cache-book/index.htm",A=$$HTTP^%ZAPM.ed.BSCmail(UR) I $P(A," ",2)=200 D
 ;.w !,"<a href='"_UR_"' title='Книга В.Кирстена' target='_ne4'><img border=0 src='"_BSDOMAIN_"/img/cos.gif'> СУБД Cache' объектно-ориентированная разработка приложений</a>",BBK,BBK
 ;W !,$$HelpSQL,$$LNG^%ZAPM.ed.BSC4(" Описние SQL в СУБД Cache'",44),BBK,BBK
 W !,"</ul>",$$HelpDhtml,$$LNG^%ZAPM.ed.BSC4(" Спецификация HTML 4.0",45),BBK,BBK
 W !,$$HelpJS,$$LNG^%ZAPM.ed.BSC4(" Спецификация JavaScript",46),BBK,BBK
 w !,"<li><a href='"_BSDOMAIN_"/docs/tags.chm' title='Помощь по HTML и CSS' target='_ne4'>Помощь по HTML и CSS. © 1999-2002 А.Климов</a>",BBK,BBK
 W !,$$HelpCache,BBK,BBK
 W !,$$HelpCacheClass,BBK,BBK
 W !,"<li><a href='http://"_$P($$ADDSN^%ZAPM.ed.BSC4(),":")_":"_$s($$ZV^%ZAPM.ed.BSCp>5:8,1:1)_"972/csp/samples/menu.csp' title='Online CSP Sample Menu' target='_new6'>CSP Sample Menu</a> ",$$LNG^%ZAPM.ed.BSC4(" Примеры применения технологии Cache'ServerPages",48),BBK,BBK
 D symbol^%ZAPM.ed.BSpgBS
 D InfoSess^%ZAPM.ed.BSC4rout
 Q
GETTXT n tmp,AA,OK,S1,S2
 D BEG1^%ZAPM.ed.BSC4  W $$B27^%ZAPM.ed.BSCm4()
 I $ZCONVERT($E(BSfile,1,4),"L")="http" D  Q:'$D(tmp)
 .S OK=$$HTTP^%ZAPM.ed.BSCmail(BSfile,2,.AA) I $P(OK," ",2)'=200 Q
 .M tmp=AA("Data")
 E  D File2Arr^%ZAPM.ed.BSCEXE($TR(BSfile,"/","\"),.tmp) 
 W "<PRE><TT>"
 S tmp="" F  S tmp=$O(tmp(tmp)) Q:tmp=""  D
 .I '$D(S1),$$IFDOS^%ZAPM.ed.BSHTML1(tmp(tmp)) D INIT^%ZAPM.ed.BSre(1)
 .W $TR(tmp(tmp),$G(S1),$G(S2))
 W "</TT></PRE><A NAME='GOend'></BODY></HTML>"
 Q
meta() ;^^^q "<meta http-equiv=""Content-Type"" content=""text/html; charset=windows-1251"">"
 q "<meta http-equiv=""Content-Type"" content=""text/html; charset=utf-8"">"
STYLE() ;СТИЛИ
 N Q
 I $G(BStyle)'="" S:$D(BStyleOver) BStyle=BStyleOver  N %ZName S Q=$$GetDirectTabN1^%ZAPM.ed.BSC4r("[""%SYS""]BSC4.CFG","FrameStyle",BStyle,"MainS")_BK_$$GetDirectTabN1^%ZAPM.ed.BSC4r("[""%SYS""]BSC4.CFG","FrameStyle",BStyle,$G(Frame,"RightDn")) I Q'="" Q Q
 S Q=$$meta()_BK
 S Q=Q_"<style type=""text/css"">"_BK
 S Q=Q_"body { scrollbar-face-color:#E4E4E4; scrollbar-shadow-color: #B4B4B4;"_BK
 S Q=Q_"scrollbar-highlight-color: #B4B4B4; scrollbar-3dlight-color:#E4E4E4; scrollbar-darkshadow-color:BLACK;"_BK
 S Q=Q_"scrollbar-track-color: #B4B4B4; scrollbar-arrow-color: #B4B4B4; "_BK
 S Q=Q_"}"_BK
 //S Q=Q_"Body { BackGround-Image: url("_BSDOMAIN_"/img/fon1.gif); BackGround-Repeat: repeat;  }"_BK
 S Q=Q_"TD.s1 { BACKGROUND: #E4E4E4; }"_BK
 S Q=Q_"TD.s2 { BACKGROUND: #B4B4B4; }"_BK
 S Q=Q_".u1 { color:blue; text-decoration:underline; cursor:hand;  }"_BK
 S Q=Q_"</style>"
 Q Q
SetVar(Name,Val)  N A S A=$$CheckVar() I 'A Q A
 S @BDSES@(BSSES,"VAR",Name)=Val
 Q 1
GetVar(Name,DFLT) N A S A=$$CheckVar() I 'A Q A
 Q $G(@BDSES@(BSSES,"VAR",Name),$G(DFLT))
CheckVar() I $G(BSSES)="" Q "!ERROR BSSES"
 I $G(BDSES)="" Q "!ERROR BDSES"
 I $G(Name)="" Q "!ERROR NameVariable"
 Q 1
REMONT(NA) s BStyleOver="GKVVBLUE" D BEG1
 Write "<title>"_NA_" - ремонтные работы </title></head><body><center>"_BK
 Write "<h2> Ресурс '"_NA_"' временно недоступен.</h2>"_BK
 Write "<hr>"_BK
 Write "<p align=""center"">Проводятся ремонтные работы. За допонительной информацией обращайтесь"_BK
 Write " по тел. 27-04.</p>"_BK
 Write "<table border=""0"" cellspacing=""0"" cellpadding=""0"">"_BK
 Write "<tr><td align=""left""><img src=""/iss/img/constr1.gif"" WIDTH=""16"" HEIGHT=""16""></td><td align=""right""><img src=""/iss/img/constr1.gif"" WIDTH=""16"" HEIGHT=""16""></td></tr>"_BK
 Write "<tr><td align=""center"" colspan=""2""><img src=""/iss/img/constr2.gif"" WIDTH=""459"" HEIGHT=""28""></td></tr>"_BK
 Write "</table>"_BK
 Write "<p>&nbsp;</p>"_BK
 Write "<p align=""center"">ИВЦ</p>"_BK
 Write "<hr></center></body></html>"_BK      D END
   Q     
CLOSEWIN(SAY,CL) D BEG1^%ZAPM.ed.BSC4
 w BK,"<script LANGUAGE=""JavaScript"">",BK
 W "function ReSet() {",BK
 W "status='Status :CloseWin:'"_BK
 W "alert('"_SAY_"."_$$LNG(" Окно браузера будет закрыто.")_"');"_BK
 I $G(CL)'=0 W "parent.window.close();"_BK
 W "}",BK
 W "</script>",BK
 W "</HEAD>",BK
 W "<BODY onload='ReSet();'>",BK
 D END
 Q
RUNTIME
 ;S A=$$GETOPT^%ZAPM.ed.BSC4cfgP("^%ZAPM.ed.BSETUP(""ISS"")","Atkweb") I A'="" K MGWLIB S %("HOST:")=$ZU(110)_":"_A D  Q
 ;.D JS^%ZAPM.ed.BSCp
 ;.w "var=parent.location;"_BK //...И ТАК ДАЛЕЕ 
 ;.;--- ПОДМЕНА В url       http://home/scripts/mgwms32.dll?        НА      http://home:82/?BSTKWEB%20?
 ;.D JSE^%ZAPM.ed.BSCp
 ;.;D locvar^%ZAPM.ed.BSCh0("",1) //1 - выводить %KEY,%CGI,%ZCS,%CGIEVAR
 w $$meta() 
    s zlABEL=$G(^%ZAPM.ed.BS("Config","Frame"),"LogoL1U1D1")
    I zlABEL'="" D  D @zlABEL G RUNTIME2
    .I zlABEL'="LogoL1U1D1",$$CbaseNS^%ZAPM.ed.BSCp //перейти в базовый нс
    E  D LogoL1U1D1   
RUNTIME2    W "</html>"_BK
    Q
LogoL1U1D1 w "<title>"_$ZU(110)_" (Информационный Портал)</title></head>"_BK //СТАНДАРТНАЯ
 w "<frameset framespacing='0' border='false' frameborder='0' cols='*,82%'>"_BK
     w "<frameset framespacing='0' border='false' frameborder='0' rows='1,90,*'>"_BK //0!!!
     s BSLABEL="First" //добавь в урл   BSNOREG=0&BSBBS=NewPin
     N BSLOGIN S BSframe=""
      w "<frame name='WORK' SCROLLING='no'>"_BK //noresize //WORK для WAKAVIKI
      w "<frame SRC='"_$$ADDBSGET_"' name='logo' SCROLLING='no'>"_BK //noresize
      W "<frame name='L1' SCROLLING='auto'>"_BK //
     W "</frameset>"_BK
    W "<frameset  framespacing='0' border='false' frameborder='0' rows='30,*'>"_BK //
     W "<frame name='U1' marginheight=0 marginwidth=0  SCROLLING='no'>"_BK ////для ASU
     W "<frame name='D1' SCROLLING='auto'>"_BK //
    W "</frameset>"_BK
    W "</frameset>"_BK
 Q
NewLogoL1U1D1 //НОВАЯ
   w "<frameset framespacing='0' border='false' frameborder='0' rows='0%,7%,15%,*'>"_BK
     s BSLABEL="First" //добавь в урл   BSNOREG=0&BSBBS=NewPin
      N BSLOGIN S BSframe="1"
       w "<frame name='WORK' SCROLLING='no'>"_BK //noresize //WORK для WAKAVIKI
      w "<frame SRC='"_$$ADDBSGET_"' name='logo' SCROLLING='no'>"_BK //noresize
      W "<frame name='L1' SCROLLING='auto'>"_BK //
     
    W "<frameset  framespacing='0' border='false' frameborder='0' cols='*,80%'>"_BK //
     W "<frame name='U1' SCROLLING='auto'>"_BK //
     W "<frame name='D1' SCROLLING='auto'>"_BK //
    W "</frameset>"_BK
   W "</frameset>"_BK
 Q
]]></Routine>


<Routine name="%ZAPM.ed.BSC4base" type="MAC" languagemode="0"><![CDATA[
%BSC4base ; пpогpамма управления БД ; 14:38   17.09.2002
 ;
 ;    Copyright Serge W. Mikhaylenko
 ;    All Rights Reserved
 ;
PRO ;ПРОЕКТЫ
 W BK,BK
 D pin
 D BEG1^%ZAPM.ed.BSC4  Q:pi=""
 W "<form action="""_$$ADDLIB^%ZAPM.ed.BSC4()_""" method=""POST"">"
 S BSLABEL="ActPR01^~BSC4base"
 D ADDBSPOST^%ZAPM.ed.BSC4reg
   W "<div align='right'>" 
      S BSLABEL="ENTER^~BSC4cfg" W " <a class=u1 onclick='open("""_$$1^%ZAPM.ed.BSC4rout("CfgPro","^"_pi)_""","""",""toolbar=no,menubar=no,scrollbars=yes,"_$$GETOPT^%ZAPM.ed.BSC4cfg(MainOpt,"NWO1")_",status=1,resizable=1"");' >"_$$param_"</a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"
   W $$HelpB
   S BSLABEL="help^~BSC4" W " <a class=u1 onclick='open("""_$$ADDBSGET^%ZAPM.ed.BSC4()_""","""",""toolbar=no,menubar=no,scrollbars=yes,"_$$GETOPT^%ZAPM.ed.BSC4cfg(MainOpt,"NWO1")_",status=1,resizable=1"");' ><img src='"_BSDOMAIN_"/img/help1.gif' ALT='Документация DHTML, JavaScript, COS, SQL, Errors'></a> "
   W "</div>"_BK
 W "<table border=0 width=100%>"
 W "<tr><td class=s1 width=5%>"_$$projimg^%ZAPM.ed.BSC4_RED_$G(BSPRO)_EF_"</td><td class=s1  width=75%><strong>"_$$LNG^%ZAPM.ed.BSC4("ПРОЕКТЫ",50)_"</strong></td><td class=s1  width=20%></td></tr>",BK
 N I,N,BD,Sort
 S Sort=+$$GETOPT^%ZAPM.ed.BSC4cfg("^"_pi_"(""CfgPro"")","Sort1") I 'Sort S Sort=-1
 W "<tr><td class=s3 title='"_pi_"'>"_$$LNG^%ZAPM.ed.BSC4("ИМЯ",51)_"</td><td class=s3 >"_$$LNG^%ZAPM.ed.BSC4("ОПИСАНИЕ ПРОЕКТОВ",52)_"</td><td class=s3 ></td></tr>"
 I '$D(@("^"_pi_".PRO")) S @$ZR="" W RED_$ZR_EF_" "_$$LNG^%ZAPM.ed.BSC4("Нет проектов ! Обратитесь к Администратору",53) g PROe
 W "<tr><td class=s1 ><input type=""text"" size=8 maxlength=8 name='Proj' value='"_$$NewProj("NewProj")_"'></td><td class=s1 > " D OPro() W "</td><td class=s1 >" W "<input type=""submit"" name=""newOK"" value='&gt;&gt;"_$$LNG^%ZAPM.ed.BSC4("Создать проект",54)_"'></td></tr>",BK
 S N="",I=0,Co=0
 F  S N=$O(@("^"_pi_".PRO")@(N),Sort) Q:N=""  D
 .S Co=Co+1
 .W "<input type=""hidden"" name='Proj"_Co_"' value="""_N_""">"
 .W "<tr><td class=s1 >"_N_"</td><td class=s1 ><input type=""text"" size=40 maxlength=148 name='Desc"_Co_"' value='"_$G(@("^"_pi_".PRO")@(N,"REM"))_"'></td><td class=s1 >" W "<input type=""submit"" name='ActOK"_Co_"' value='&gt;&gt;'>" D ACT W "</td></tr>"
 W "<input type=""hidden"" name='ProjCount' value="""_Co_""">"
PROe  W " </table>"
 W "</form>"
 D InfoSess^%ZAPM.ed.BSC4rout,END^%ZAPM.ed.BSC4
 Q
param() q "<img src='"_BSDOMAIN_"/img/opt.gif' width=2% ALT='"_$$LNG^%ZAPM.ed.BSC4("настройка",49)_"'>"
NewProj(N) N NN ;НОВОЕ ИМЯ ПРОЕКТА
 F NN=1:1 I '$D(@("^"_pi_".PRO")@(N_NN)) Q
 Q N_NN
OPro() N I,P,T,BD ;ВСЕ ПРОЕКТЫ ДОСТУПНЫЕ КАК ШАБЛОН
 W "<select name=""newPR"" size=1>"
 W "<option value=''>"_$$LNG^%ZAPM.ed.BSC4("взять за основу ...",55)_"</option>"
 I $D(@GTmp@(BSLOGIN,"PRO")) W "<option value='"_$ZR_"'>"_$$LNG^%ZAPM.ed.BSC4("Копировать из буфера",56)_"</option>"
 W "<option value='1'>"_$$LNG^%ZAPM.ed.BSC4("Импорт из ODBC",57)_"</option>"
 W "<option value='2'>"_$$LNG^%ZAPM.ed.BSC4("Связь с ODBC",58)_"</option>"
 W "<option value='4'>----- "_$$LNG^%ZAPM.ed.BSC4("Типовые проекты",322)_"</option>"
 s IC=+$$GETOPT^%ZAPM.ed.BSC4cfg(MainOpt,"Conc")
 S I="",BD="^[""%SYS""]BSC4.CFG.Projects"
 F  S I=$O(@BD@(I)) Q:I=""  D
 .I $E(I,1)="*",'IC Q  //КОНКУРСНЫЕ ПРОЕКТЫ ОТМЕНИТЬ
 .W "<option value='"_I_"'>"_$G(@BD@(I,"Descr"),"*?")_"</option>"
 ;W "<option " W " value='DOCUM'>"_$$LNG^%ZAPM.ed.BSC4("Документация",59)_"</option>"
 ;W "<option " W " value='*DOCUM*'>"_$$LNG^%ZAPM.ed.BSC4("*СтатСчетчик")_"</option>"
 ;W "<option " W " value='*DOCUM*'>"_$$LNG^%ZAPM.ed.BSC4("*Гост.Книга")_"</option>"
 ;W "<option " W " value='*DOCUM*'>"_$$LNG^%ZAPM.ed.BSC4("*ЧатКомната")_"</option>"
 ;W "<option " W " value='*DOCUM*'>"_$$LNG^%ZAPM.ed.BSC4("*Анкетирование")_"</option>"
 ;W "<option " W " value='*DOCUM*'>"_$$LNG^%ZAPM.ed.BSC4("*ПрайсЛисты")_"</option>"
 ;S P="^%ZAPM.ed.BSC4E" W "<option " W " value='"_$NA(@P)_"'>"_$P($G(@P),"@",2)_"</option>"
 ;.I I=+$G(T) W "selected"
 I 'IC Q  //КОНКУРСНЫЕ ПРОЕКТЫ ОТМЕНИТЬ
 W "</select>"
 W "<select name=""Complet"" size=1>"
 W "<option value=''></option>"
 W "<option value=''>"_$$LNG^%ZAPM.ed.BSC4("Конкурсные проекты")_"</option>"
 W "<option value=''>...</option>"
 W "</select>"
 Q
ActPR01 ;ДЕЙСТВИЕ С ПРОЕКТОМ
 D pin
 I $D(newOK) G CreatPro
 F I=1:1:$G(ProjCount) I $D(@("ActOK"_I)) Q
 I $D(@("Proj"_I)) D
 .I $G(@("Act"_I))=2 D KILLPRO^%ZAPM.ed.BSC4rout(pi,@("Proj"_I)) G PRO
 .I $G(@("Act"_I))=1 D EditP(@("Proj"_I)) Q
 .I $G(@("Act"_I))=3 D CopyP2B(@("Proj"_I)) G PRO
 Q
TR(S) Q $TR(S,$C(34)_"@'","`^`")
IntEditPro(pi,P) S I=1,Desc1=$G(@("^"_pi_".PRO")@(P,"REM")) D EditP(P) //внутренняя точка входа для редактирвания проекта
 Q
EditP(P) N x     S BSPRO=P,@BDSES@(BSSES,"PROJ")=P
 I $G(@("^"_pi_".PRO")@(P,"REM"))'=@("Desc"_I) S @("^"_pi_".PRO")@(P,"REM")=$$TR(@("Desc"_I))
 N %ZName S %ZName="^"_pi_"." S x=$$GetDirectTabN1^%ZAPM.ed.BSC4r(BSPRO,"Param","NOTE","V") I x="" S x=$$GetDirectTabN1^%ZAPM.ed.BSC4r(BSPRO,"Param","NOTE","Val")
 W x
 D TAB G ROU^%ZAPM.ed.BSC4base1
CreatPro ;СОЗДАТЬ ПРОЕКТ
 i $d(@("^"_pi_".PRO")@(Proj)) W $$LNG^%ZAPM.ed.BSC4("Проект с именем",60)," '",RED,Proj,EF,"' ",$$LNG^%ZAPM.ed.BSC4("уже существует",61),BK G:$G(newPR)="" PRO G MERGE^%ZAPM.ed.BSC4r2
 I $G(newPR)="" D NEWPRO^%ZAPM.ed.BSC4rout(Proj,$$LNG^%ZAPM.ed.BSC4("ПРОЕКТ ДЛЯ ",317)_"`"_BSLOGIN_"`")
CreatMERG D pin
 I $G(newPR)="4"  w RED,$$LNG^%ZAPM.ed.BSC4("Типовые проекты находятся ниже",323),EF G PRO
 I $G(newPR)="1"  D ODBC2P(Proj) q
 I $G(newPR)="2"  D ODBC2P(Proj) q
 I $G(newPR)=""  G PRO
 N BDP,PP,PP1,PP2 S BDP="^[""%SYS""]BSC4.CFG.Projects"
 I $D(@BDP@(newPR)) D  G PRO
 .S PP=$G(@BDP@(newPR,"Prog"),"*?"),PP1=$G(@BDP@(newPR,"Descr"),"*?")
 .s PP2=$G(@BDP@(newPR,"Request"),"*?"),PP3=$G(@BDP@(newPR,"Award"),"*?"),PP4=$G(@BDP@(newPR,"Conc"),"*?")
 .I PP'="*?" D @(PP_"(pi,Proj)")
 D COPYPRO(newPR,Proj)
 G PRO
CreatNewPro(a,b) s IC=+$$GETOPT^%ZAPM.ed.BSC4cfg(MainOpt,"Conc")
 w "<H3>",RED,$$LNG^%ZAPM.ed.BSC4("Типовые проекты находятся в стадии разработки"),EF,"</H3>" I 'IC Q
 w "<H3>",RED,$$LNG^%ZAPM.ed.BSC4(" и выставлены на конкурс"),EF,"</H3>"
 w BBK,RED,$$LNG^%ZAPM.ed.BSC4("Название проекта"),EF," :","<br>",$G(PP1),"<br>"
 w BBK,RED,$$LNG^%ZAPM.ed.BSC4("Требуемый функционал проекта"),EF," :","<br><PRE>",$G(PP2),"</PRE><br>"
 w BBK,RED,$$LNG^%ZAPM.ed.BSC4("Условия конкурса"),EF," :","<br><PRE>",$G(PP4),"</PRE><br>"
 w BBK,RED,$$LNG^%ZAPM.ed.BSC4("Награда 3 победителям"),EF," :","<br>",$G(PP3),"<br>"
 q
COPYPRO(newPR,p) ;КОПИРОВАТЬ ПРОЕКТ ИЗ БУФЕРА В НОВЫЙ
 N pin S pin=pi_"."_p
 D Copy^%ZAPM.ed.BSF8($P(newPR,""")")_".ROU"")","^"_pin_".ROU")
 M @("^"_pin)=@newPR
 S N="" F  S N=$O(@("^"_pin)@(N)) Q:N=""  I $P($G(@("^"_pin)@(N)),"@",17)=2 D
 .S @("^"_pin)@(N,"Compile")="Create "_$$TD
 .S @("^"_pin)@(N,"KEY")="^"_pin_"."_N
 .I $D(@("^"_pin)@(N,"GLOBAL")) M @("^"_pin_"."_N)=@("^"_pin)@(N,"GLOBAL") K @("^"_pin)@(N,"GLOBAL")
 S @("^"_pi_".PRO")@(p,"REM")=$P($G(@newPR),"@",2)
 Q
CopyP2B(BSPRO,DEST) ;КОПИРОВАТЬ ПРОЕКТ В БУФЕР
 N pin,N
 S pin=pi_"."_BSPRO I '$D(DEST) S DEST=$NA(@GTmp@(BSLOGIN))
 K @DEST@("PRO"),@DEST@("PRO.ROU")
 ;M @DEST@("PRO.ROU")=@("^"_pin_".ROU")
 S N="" F  S N=$O(@("^"_pin_".ROU")@(N)) Q:N=""  D R2B^%ZAPM.ed.BSC4base1(N,$NA(@DEST@("PRO.ROU",N)))
 M @DEST@("PRO")=@("^"_pin)
 S p="" F  S p=$O(@("^"_pin)@(p)) Q:p=""  I $P($G(@("^"_pin)@(p,"B4I")),"@",2) D  ;И ДАННЫЕ ТОЖЕ ПОЛОЖИТЬ
 .M @DEST@("PRO",p,"GLOBAL")=@(@("^"_pin)@(p,"KEY"))
 Q
DSN() I $G(DSN)="" W $$LNG^%ZAPM.ed.BSC4("Вы не определили 'Data Sours Name'",62),BK Q 0
 Q 1
TABODBC I TABODBC="" W $$LNG^%ZAPM.ed.BSC4("Вы не определили ТАБЛИЦУ",63) G TAB
 I '$$DSN G TAB
 D Tab2TOBD^%ZAPM.ed.BSCBD(DSN,$G(USER),$G(PASS),TABODBC,TOBD) K:$D(ErroR) @TOBD
 I $D(ODBCD),'$D(ErroR) J JTB2TOBD^%ZAPM.ed.BSCBD(DSN,$G(USER),$G(PASS),TABODBC,TOBD)
 I '$D(ErroR) W BK,$$LNG^%ZAPM.ed.BSC4("Таблица из ODBC источника будет создана в фоновом режиме",64)
 G TAB
ODBC ;ЗАГРУЗКА ПРОЕКТА ИЛИ ТАБЛИЦЫ
 N ErroR,part,PxPUSTO
 I $D(TABODBC) G TABODBC
 I '$$DSN G PRO
 D NEWPRO^%ZAPM.ed.BSC4rout(Proj,"ПРОЕКТ из ODBC `"_DSN_"`") S part="^"_pin
 I $D(ODBCD) J JOBODBS(DSN,$G(USER),$G(PASS),part)
 I $D(ODBCS) D
 .D Stream1^%ZAPM.ed.BSCBD(DSN,$G(USER),$G(PASS),part)
 .D PART2BSD^%ZAPM.ed.BSCRG(part) i $G(Errors) W !,"Произошла ошибка конвертации таблиц",!,BK q
 I '$D(ErroR) W BK,$$LNG^%ZAPM.ed.BSC4("Проект из ODBC источника будет создан в фоновом режиме",65)
 G PRO
JOBODBS(DSN,USER,PASS,part) ;DEMON ДЛЯ ВСЕГО ДСН-ПРОЕКТА+ДАННЫЕ
 D Stream^%ZAPM.ed.BSCBD(DSN,$G(USER),$G(PASS),part,"")
 Q
ODBC2P(Proj,TOBD) ;импортировать из ODBC
 n aa,Cm D pin   D BEG1^%ZAPM.ed.BSC4
 W "<div align='right'>"_$$HelpB_"</div>"_BK
 S Cm=$$GETOPT^%ZAPM.ed.BSC4cfg(MainOpt,"Commerce")
 s aa=$$GETOPT^%ZAPM.ed.BSC4cfg(MainOpt,"ImportODBC")
 I $G(newPR)="2" s aa=0 ;пока так - это линк
 I $G(newTP)="2" s aa=0 ;пока так - это линк
 i 'aa D
 .I Cm=1 W $$LNG^%ZAPM.ed.BSC4("Режим связи или импорта таблиц из ODBC источников доступны при тарифном плане КОРПОРАТИВНЫЙ, или при согласовании условий с администратором при тарифном плане ПРОФЕССИОНАЛЬНЫЙ.",66) Q
 .E  W $$LNG^%ZAPM.ed.BSC4("Режим связи не включен в данной версии")
 W "<form action="""_$$ADDLIB^%ZAPM.ed.BSC4()_""" method=""POST"">"
 W "<input type=""hidden"" name='Proj' value="""_Proj_""">"
 I $G(TOBD)'="" W "<input type=""hidden"" name='TOBD' value='"_TOBD_"'>"
 S BSLABEL="ODBC^~BSC4base"
 D ADDBSPOST^%ZAPM.ed.BSC4reg
 W "<table border=0 width=100%>"
 W "<tr><td  width=30% align='right' class=s1 >"_$$LNG^%ZAPM.ed.BSC4("Имя DSN",67)_"</td><td align='left' class=s1 ><input type=""text"" size=20 maxlength=48 name='DSN' "_$s('aa:"disabled",1:"")_" value=''></td></tr>"
 W "<tr><td align='right' class=s1 >"_$$LNG^%ZAPM.ed.BSC4("Имя пользователя",68)_"</td><td  align='left' class=s1 ><input type=""text"" size=20 maxlength=48 name='USER' value=''></td></tr>"
 W "<tr><td align='right' class=s1 >"_$$LNG^%ZAPM.ed.BSC4("Пароль",69)_"</td><td  align='left' class=s1 ><input type=""text"" size=20 maxlength=48 name='PASS' value=''></td></tr>"
 I $G(newTP)=1 W "<tr><td align='right' class=s1 >"_$$LNG^%ZAPM.ed.BSC4("Таблица",70)_"</td><td  align='left' class=s1 ><input type=""text"" size=20 maxlength=48 name='TABODBC' value='"_Table_"'></td></tr>"
 W " </table>"
 W "<input "_$s('aa:"disabled",1:"")_" type=""submit"" name='ODBCS' value='"_$$LNG^%ZAPM.ed.BSC4("Загрузить только структуру таблиц",71)_"'><br>",BK
 w "<input type=""submit"" "_$s('aa:"disabled",1:"")_" name='ODBCD' value='"_$$LNG^%ZAPM.ed.BSC4("Загрузить структуру и данные таблиц",72)_"'><br><input type=""reset"" name='ESC' value='"_$$LNG^%ZAPM.ed.BSC4("отмена",73)_"'>",BK
 W "</form>"_BBK d BACK^%ZAPM.ed.BSCh
 D InfoSess^%ZAPM.ed.BSC4rout,END^%ZAPM.ed.BSC4
 q
pin I $G(BSPRO)="",$G(BSSES)'="" S BSPRO=$G(@BDSES@(BSSES,"PROJ"))
 i '$d(pi) D
 .I $G(BSPIN)'="" S pi=BSPIN Q
 .S (BSPIN,pi)=$g(@BDUSE@(BSLOGIN,"PIN")) //?????
 S pin=pi_"."_$G(BSPRO,"DFLT")
 S BSNSP=$G(@BDPIN@(BSPIN,"NSP"),$ZU(5)) I $ZU(5)'=BSNSP I $$ZU^%ZAPM.ed.BSF4(BSNSP) //ТО ПЕРЕШЛИ //?????
 Q
SQL(IM) S BSLABEL="MAIN^~BSCGH"
 Q "<a class=u1 onclick='open("""_$$ADDBSGET^%ZAPM.ed.BSC4()_""",""RESULT3"",""toolbar=yes,menubar=no,scrollbars=yes,"_$$GETOPT^%ZAPM.ed.BSC4cfg(MainOpt,"NWT1")_",status=1,resizable=1"");' >"_IM_"</a>"
 ///scripts/mgwms32.dll?BSG=SQL
TAB ;ВСЕ ТАБЛИЦЫ PIN
 D BEG1^%ZAPM.ed.BSC4
 D pin
 I $G(BSPRO)="" W $$LNG^%ZAPM.ed.BSC4("Сначало определите ПРОЕКТ",74) G PRO
 W "<form action="""_$$ADDLIB^%ZAPM.ed.BSC4()_""" method=""POST"">"
 S BSLABEL="ActT1^~BSC4base"
 D ADDBSPOST^%ZAPM.ed.BSC4reg
 W $$SERVIS("TAB^~BSC4base","CfgTab","NWT1")
 W "<table border=0 width=100%>"
 W "<tr><td width=10% align='right' class=s1 ><strong TITLE='"_$G(BSNSP,"?")_"'>"_$$LNG^%ZAPM.ed.BSC4("ТАБЛИЦЫ",75)_"</strong></td><td width=70% class=s1 >"_$$LNG^%ZAPM.ed.BSC4("текущего проекта ",76)_RED_pin_EF_"</td><td width=20% class=s1 >"_$$LNG^%ZAPM.ed.BSC4("Групповое действие над всеми",77)_"</td></tr>"
 N I,N,BD,Sort,WebEditDT1,NWT1
 S Sort=+$$GETOPT^%ZAPM.ed.BSC4cfg("^"_pi_"(""CfgTab"")","Sort1") I 'Sort S Sort=-1
 W "<tr><td width=10% class=s3 >"_$$LNG^%ZAPM.ed.BSC4("ИМЯ",51)_"</td><td  width=70% class=s3 >"_$$LNG^%ZAPM.ed.BSC4("ОПИСАНИЕ ТАБЛИЦЫ БАЗЫ ДАННЫХ",78)_"</td><td width=20% class=s3 >" D ACT0 W $$Che(0)_"<input type=""submit"" name='ActOK0' title='"_$$LNG^%ZAPM.ed.BSC4("Групповое действие",79)_"' value='&gt;&gt;'></td></tr>"
 S N="",I=0 I '$D(@("^"_pin)) W $$LNG^%ZAPM.ed.BSC4("Нет раздела ! Обратитесь к Администратору",80) Q
 ;
 W "<tr><td class=s1 ><input type='text' size=13 maxlength=13 name='Table' value='"_$$NewTable("NewTable")_"'></td><td class=s1 > "
 D OT() W "</td><td class=s1 >" W "<input type=""submit"" name=""newOK"" value='&gt;&gt;"_$$LNG^%ZAPM.ed.BSC4("Создать таблицу",81)_"'></td></tr>",BK
 S Co=0,NWT1=$$GETOPT^%ZAPM.ed.BSC4cfg(MainOpt,"NWT1"),WebEditDT1=$$GETOPT^%ZAPM.ed.BSC4cfg(MainOpt,"WebEditDT")
 F  S N=$O(@("^"_pin)@(N),Sort) Q:N=""  I $P($G(@("^"_pin)@(N)),"@",17)=2 D
 .I N="ROU"!($E(N,1)="@") Q
 .S Co=Co+1
 .W "<input type='hidden' name='Table"_Co_"' value="""_N_""">" s sta=$G(@("^"_pin)@(N,"Compile"))
 .W "<tr><td width=20% class=s1 ><a title='"_$$NameTab_"'>"_$$RedStar^%ZAPM.ed.BSC4rou($e(sta,1,2)'="OK")
 .w N_"</a></td><td class=s1 >"
 .I $e(sta,1,2)="OK" D
 ..W $$PAform^%ZAPM.ed.BSCm()
 ..W $$PAframe^%ZAPM.ed.BSCm()
 ..;W " <A title='форма редактирования таблицы' "_$$AN^%ZAPM.ed.BSCm("^"_pin,N,"T^~BSCm4")_"><img src='"_BSDOMAIN_"/img/form.gif'></A>"
 ..;W "<a title='"_$$NameTab_"'><img src='"_BSDOMAIN_"/img/const.gif'></A>"
 .W " "_$$BP1_AF_$P($G(@("^"_pin)@(N)),"@",1)_EF
 .W "</td><td class=s1 ><input type=""submit"" name='ActOK"_Co_"' value='&gt;&gt;'>" D ACT W $$Che(Co,N)_"</td></tr>"_BK
 W "<input type='hidden' name='TableCount' value="""_Co_""">"_BK
 W " </table>"_BK
 W "</form>"
 D InfoSess^%ZAPM.ed.BSC4rout D END^%ZAPM.ed.BSC4
 Q
NameTab() N S,BSLABEL,BSDJS,T,P
 I $e(sta,1,2)'="OK" S S=$$LNG^%ZAPM.ed.BSC4("не компилирована",316) Q S
 S BSLABEL="EDIT^~BSChT1",BSDJS=BSDOMAIN,P="^"_pin,T=N
 S S=$$LNG^%ZAPM.ed.BSC4("компилирована")_$P(sta,"OK",2) I 'WebEditDT1 Q S
 S S=S_"' class=u1 onclick='open("""_$$1^%ZAPM.ed.BSC4rout(T,P)_""","""",""toolbar=no,menubar=no,scrollbars=yes,"_NWT1_",status=1,resizable=1"");"
 Q S
NewTable(N) N NN ;НОВОЕ ИМЯ
 F NN=1:1 I '$D(@("^"_pin)@(N_NN)) Q
 Q N_NN
CompTab ;КОМПИЛИРОВАТЬ
 I $G(NoFON) D FTAB^%ZAPM.ed.BSC4base("^"_pin,TabName,MainOpt) Q
 J FTAB^%ZAPM.ed.BSC4base("^"_pin,TabName,MainOpt)::0 I  W $$LNG^%ZAPM.ed.BSC4("Таблица '",82)_RED,TabName,EF_$$LNG^%ZAPM.ed.BSC4("' будет откомпилирована",83),BBK I 1
 E  W $$LNG^%ZAPM.ed.BSC4("Неудачная компиляция Таблицы '",84)_RED,TabName,EF
 Q
FTAB(BSR,BST,MainOpt) ;ФОРМАТИРОВАТЬ И КОМПИЛИРОВАТЬ
 N ErroR,OK,NOKILLER,PxPUSTO
 S $ZT="ErrComp^"_$ZN
 D TAB^%ZAPM.ed.BSF1
 S PxPUSTO="" ;,NOKILLER=1
 D START^%ZAPM.ed.BSCBD($NA(@BSR@(BST)),1,"")
 Q
ErrComp S $ZT="",@BSR@(BST,"Compile")=$ZE
 Q
ErrSave S $ZT="",ze1=$p($ZE,"^")  W RED,"Error: "_$$TRa^%ZAPM.ed.BSCh0(ze1),EF,BBK
 I $G(A)'="" W "'",A,"' "_$$LNG^%ZAPM.ed.BSC4("Некорректный идентификатор",85),BBK,BBK
 G BACK^%ZAPM.ed.BSCh
 Q
helpkeywords() q " "_$$NEWIN^%ZAPM.ed.BSC4base1($$LNG^%ZAPM.ed.BSC4("Список ключевых, зарегистрированных слов",86),"1",$$LNG^%ZAPM.ed.BSC4("загрузить cписок запрещенных слов в новом окне браузера",87),"KeyWord^~BSC4r")
CtrlKeyWord(A) ;контроль на зарезервированные имена
 i $d(^%ZAPM.ed.BSC4KWD($$LITL^%ZAPM.ed.BSsFUNM(A))) W $$LNG^%ZAPM.ed.BSC4("Имя поля",88)," '",A,"' ",$$LNG^%ZAPM.ed.BSC4("зарезервировано системой",89),$$helpkeywords,BBK q 0
 q 1
SaveTab ;СОХРАНИТЬ КОРРЕКЦИЮ
 D pin
 k ze1 D SaveTab2 i $d(ze1) q
 I Y<2 W $$LNG^%ZAPM.ed.BSC4("Таблица модифицирована.",90),RED,$$LNG^%ZAPM.ed.BSC4("Но она не имеет полей !",91),EF,BK G SaveTab1
 I $D(CompTab) D CompTab G TAB
 W $$LNG^%ZAPM.ed.BSC4("Таблица модифицирована.",90),BK
SaveTab1 D Edit(TabName)
 Q
SaveTab2
 N BDorig
 S PT=$NA(@("^"_pin)@(TabName)),PR=$NA(@("^"_pin)@("ROU"))
 S $P(@PT@("B4I"),"@",1)=$S($D(SuffSave):1,1:0)
 S $P(@PT@("B4I"),"@",2)=$S($D(InsD):1,1:0)
 I '$D(@PT) W $$LNG^%ZAPM.ed.BSC4("Таблица '",82),PT,$$LNG^%ZAPM.ed.BSC4("' не существует",92),BKK ZT "errorName"
 S $ZT="ErrSave^"_$ZN
 S BD="^"_pin_"."_TabName
 I $E($G(Suff),1)="!" S BD=$E($G(Suff),2,999) I 1 S BDorig=1
 E  I $G(Suff)'="" S BD="^"_pin_"."_Suff
 ;//КОНТРОЛЬ НА ИМЕНА ПОЛЯ И ИНДЕКСЫ
 S A=BD,@A=1 i '$$CtrlKeyWord(A) ZT "errorName"
 I $D(Suff),$E($G(Suff),1)'="!" S A=Suff,@A=1
 I '$D(FCount) G Sa
 K S F I=1:1:FCount I $G(@("Field"_I))'="" S A=@("Field"_I),@A=1 D  i '$$CtrlKeyWord(A) ZT "errorName"
 .I '$D(S(A)) S S(A)="" Q
 .E  W $$LNG^%ZAPM.ed.BSC4("ИМЕНА ПОЛЕЙ НЕ ДОЛЖНЫ ПОВТОРЯТЬСЯ",93)," '",A,"'",BBK ZT "errorName"
 K A,a N TT
 I $G(Desc)'="" S $P(@PT,"@",1)=$$TR($G(Desc))
 S Y=1 F I=1:1:FCount I $G(@("Field"_I))'="" S A=@("Field"_I) D
 .S Y=Y+1
 .I '$D(@PT@(Y)) S @PT@(Y,1)=@PR@(2,1),@PT@(Y,2)=@PR@(2,2)
 .;индекс
 .I $G(@("Ind"_I))'="" S $P(@PT@(Y,2),"@",15)=@("Ind"_I),InDx=1 I 1
 .E  S $P(@PT@(Y,2),"@",15)=""
 .S $P(@PT@(Y,2),"@",17)=$$TR($G(@("Desc"_I)))
 .S $P(@PT@(Y,1),"@",15)=$$TR($G(@("Desc"_I)))
 .S TT=$G(@("TIP"_I)),$P(@PT@(Y,2),"@",21)=TT D
 ..I "86"[TT D SETOPT^%ZAPM.ed.BSC4cfgP($NA(@PT@("ParmsCell",A)),"xRO","V",1)
 ..I TT=4 D SETOPT^%ZAPM.ed.BSC4cfgP($NA(@PT@("ParmsCell",A)),"fTRN","V","$$TXTD^%ZAPM.ed.BSsFUNR(d)")
 .S $P(@PT@(Y,2),"@",18)=A
 F I=(Y+1):1 Q:'$D(@PT@(I))  K @PT@(I)
Sa ;F I="KEY","FTR","RTR","FCL","COL" K @PT@(I)
        F I="FTR","RTR","FCL","COL" K @PT@(I)
 S $P(@PT,"@",19)="2,2"
 S @PT@("DSN")="Создана B4I "_$ZD($H,3)
 I '$D(SuffSave) K @BD
 I '$D(BDorig) S @BD="BSD - MSW@"_"^"_pin_"@"_TabName
 S @PT@("KEY")=BD
 D
 .N Y D TA2BD^%ZAPM.ed.BSCRG("^"_pin,TabName,1,$G(InDx)) ;1 НЕ ПРИСВАИВАТЬ ИМЯ ПО-УМОЛЧАНИЮ
 S @("^"_pin)@(TabName,"Compile")="Save "_$$TD
 Q
TD(H) I '$D(H) S H=$H
 I H="" Q "время/дата пустое"
 ;Q H
 Q $ZT($P(H,",",2),1)_" "_$ZD(H,3)
Edit(TAB) ;РЕДАКТИРОВАТЬ
 D BEG1^%ZAPM.ed.BSC4
 ;W "рабочей области '"_$zu(5)_"' "_pin_","_TAB
 N Y,STa,SuffSave,ti,de,SuffKEY,in,AllTip
 S STa=$G(@("^"_pin)@(TAB,"Compile"))
 I STa["Begin " W $$LNG^%ZAPM.ed.BSC4("Таблица '",82)_RED,TAB,EF_$$LNG^%ZAPM.ed.BSC4("' еще компилируется",94),BBK G TAB
 W $$SERVIS("TAB^~BSC4base","CfgTab")
 W "<form action="""_$$ADDLIB^%ZAPM.ed.BSC4()_""" method=""POST"">"
 S BSLABEL="SaveTab^~BSC4base"
 D ADDBSPOST^%ZAPM.ed.BSC4reg
 W "<table border=0 width=100%>"
   W "<input type=""hidden"" name='TabName' value="""_TAB_""">"
 W "<tr><td align='CENTER' width=40% class=s1 >"_$$LNG^%ZAPM.ed.BSC4("РЕДАКТИРОВАНИЕ ТАБЛИЦЫ",95)_"</td><td  width=60% class=s1 >"_RED_BSPRO_"."_EF_TAB_"</td></tr>",BK
 W "<tr><td width=30% class=s3 >"_$$LNG^%ZAPM.ed.BSC4("ОБЩИЕ ПАРАМЕТРЫ",96)_" "_$$ParmTab_"</td><td  width=70% class=s3 >"_$$LNG^%ZAPM.ed.BSC4("ЗНАЧЕНИЯ",97)_"</td></tr>",BK
   W "<tr><td class=s1 >"_$$LNG^%ZAPM.ed.BSC4("Описание",98)_"</td><td class=s1 ><input type=""text"" size=45 maxlength=145 name='Desc' value='"_$P($G(@("^"_pin)@(TAB)),"@",1)_"'></td></tr>",BK
 S SuffSave=$P($G(@("^"_pin)@(TAB,"B4I"),"1"),"@",1)
 S InsD=$P($G(@("^"_pin)@(TAB,"B4I"),"1"),"@",2)
 S SuffKEY=$P($G(@("^"_pin)@(TAB,"KEY")),pin_".",2) I SuffKEY="" S SuffKEY="!"_$G(@("^"_pin)@(TAB,"KEY"))
   W "<tr><td class=s1 >"_$$LNG^%ZAPM.ed.BSC4("Суффикс массива данных",99)_" <input type=""text"" size=10 maxlength=25 name='Suff' value='"_SuffKEY_"'></td>"
    W "<td class=s1 ><input type=""checkbox"" title='"_$$LNG^%ZAPM.ed.BSC4("",100)_"' name=""SuffSave"" value="""_SuffSave_""" "_$$ch^%ZAPM.ed.BSC4cfg(SuffSave)_" >"_$$LNG^%ZAPM.ed.BSC4("сохранять при перекомпиляции")
     W " <input type=""checkbox"" title='"_$$LNG^%ZAPM.ed.BSC4("При копировании в буфер обмена включать данные в проект")_"' name=""InsD"" value="""_InsD_""" "_$$ch^%ZAPM.ed.BSC4cfg(InsD)_" >"_$$LNG^%ZAPM.ed.BSC4("включать в шаблон проекта")_" </td></tr>",BK
   W "<tr><td class=s1 >"_$$LNG^%ZAPM.ed.BSC4("Статус таблицы",101)_"</td><td class=s1 ><input type=""text"" size=45 maxlength=145 name='StatTab' value='"_STa_"'></td></tr>",BK
 W "</table>"
 W " <table border=0 width=100%>"
 W "<tr><td width=20% class=s3 >"_$$LNG^%ZAPM.ed.BSC4("ИМЕНА ПОЛЕЙ",102)_"</td><td  width=10% class=s3 >"_$$LNG^%ZAPM.ed.BSC4("ТИП ПОЛЯ",103)_"</td><td  width=10% class=s3 >"_$$LNG^%ZAPM.ed.BSC4("ИНДЕКС",104)_"</td><td width=* class=s3 >"_$$LNG^%ZAPM.ed.BSC4("ОПИСАНИЕ ПОЛЯ",105)_"</td></tr>",BK
 F Y=2:1 Q:'$D(@("^"_pin)@(TAB,Y))  D
 .W "<tr><td class=s1 >" S NameField2=$P($P(@("^"_pin)@(TAB,Y,2),"@",18),"#")
 .W "<input type=""text"" tabindex='"_Y_"' size=13 maxlength=13 name='Field"_Y_"' value='"_NameField2_"'> "_$$ParmField_"</td><td class=s1 >"
 .s ti=$P(@("^"_pin)@(TAB,Y,2),"@",21) //ТИП
 .S in=$P(@("^"_pin)@(TAB,Y,2),"@",15) //ИНДЕКС
 .s de=$P(@("^"_pin)@(TAB,Y,1),"@",15) //ОПИСАНИЕ ПОЛЯ
 .d TIPS(ti) w "</td><td class=s1 >"
 .D IND(in)
 .W "</td><td class=s1 ><input type=""text"" size=45 maxlength=2000"
 .i ti=2 w " title='"_$$LNG^%ZAPM.ed.BSC4("Для поля типа Radio текст вариантов введите в описании поля, разделенными ~",106)_"' " i de'["~" s de=$tr(de," ","~")
 .i ti'=2 w " title='В описании поля в вертикальных скобках || можно ввести значение по-умолчанию' "
 .w " name='Desc"_Y_"' value='"_de_"'></td></tr>",BK
 W "<tr><td class=s1 ><input type=""text""  tabindex='"_Y_"' size=13 maxlength=13 name='Field"_Y_"' value=''></td><td class=s1 >"
  d TIPS("") w "</td><td class=s1 >"
  D IND("") W "</td><td class=s1 ><input type=""text"" size=45 maxlength=2000 name='Desc"_Y_"' value='"_$$LNG^%ZAPM.ed.BSC4("Новое описание поля",107)_"'></td></tr>",BK
 W " </table>"
 W "<input type=""hidden"" name='FCount' value="""_Y_""">"
 W "<nobr><input type=""submit"" name=""SaveTab"" title='"_$$LNG^%ZAPM.ed.BSC4("Только сохранить изменения",108)_"' value='"_$$LNG^%ZAPM.ed.BSC4("Сохранить",109)_"'>"
 w "<input type=""submit"" name=""CompTab"" title='"_$$LNG^%ZAPM.ed.BSC4("Создать объектное и SQL представление таблицы",110)_"' value='"_$$LNG^%ZAPM.ed.BSC4("Компилировать",111)_"'>"
 w "<input type='RESET' title='"_$$LNG^%ZAPM.ed.BSC4("Отменить текущие изменения",112)_"' name='Reset1' value='"_$$LNG^%ZAPM.ed.BSC4("Отменить",73)_"'>"
 W "</nobr></form>"
 I STa["Begin" D BACK^%ZAPM.ed.BSCh
 D InfoSess^%ZAPM.ed.BSC4rout,END^%ZAPM.ed.BSC4
 Q
TIPS(S) N i,t ;ТИПЫ ПОЛЕЙ ИЗ ТАБЛИЦЫ
 W "<select name='TIP"_Y_"'>"
 s i="" f  s i=$o(^%ZAPM.ed.BSC4TIP(i)) q:i=""  W "<option " D  W " value='"_i_"'>"_$g(^%ZAPM.ed.BSC4TIP(i,"Name"))_"</option>"
 .I i=S W "selected"
 ;I $D(AllTip) W $$AllTipProTab(S) //БЫСТРЕЕ РАБОТАТЬ С ЛОКАЛЬНЫМ МАССИВОМ ? НОСОВ!? ПРОТЕСТИРОВАТЬ ЧТО БЫСТРЕЕ!!! ПОТОМ
 ;I '$D(AllTip) W $$TipProTab(S)
 W "</select>"
 Q
IND(S) N I,T
 W "<select name='Ind"_Y_"' size=1>"
 F I="",1:1:9 W "<option " D  W " value='"_I_"'>"_I_"</option>"
 .I I=S W "selected"
 W "</select>"
 Q
Creat ;СОЗДАТЬ ТАБЛИЦУ
 i $d(@("^"_pin)@(Table)) W $$LNG^%ZAPM.ed.BSC4("Таблица с именем",115)," '",RED,Table,EF,"' ",$$LNG^%ZAPM.ed.BSC4("уже существует",61),BK G TAB
 S $ZT="ErrSave^"_$ZN
 s A=Table,@A=1  i '$$CtrlKeyWord(A) ZT "errorName"
 S $ZT=""
 I newTP=1 D ODBC2P(BSPRO,$NA(@("^"_pin)@(Table))) Q
 I newTP=2 D ODBC2P(BSPRO,$NA(@("^"_pin)@(Table))) Q  ;ПОКА ТАК
 I newTP=3 D UPLOADF^%ZAPM.ed.BSC4r3(BSPRO,pin,Table) Q
 d NewT(newTP,pin,Table)
 G TAB
NewT(newTP,pin,Table) ;новая таблица
 M @("^"_pin)@(Table)=@newTP
 I newTP'[pin S @("^"_pin)@(Table,"KEY")="^"_pin_"."_Table D
 .I $D(@newTP@("GLOBAL")) M @("^"_pin_"."_Table)=@newTP@("GLOBAL") K @("^"_pin)@(Table,"GLOBAL")
 S $P(@("^"_pin)@(Table),"@",17)=2
 S @("^"_pin)@(Table,"Compile")="Create "_$$TD
 q
AcT(A,T,NoFON) ;Групповые операции
 I A=2 D KILL(T) Q
 I A=1 S TabName=T D  ;рекомпиляция
 .N InsD,Desc,Suff,Y,PT,a,A,BD,Y,I,SuffSave,SuffKEY,FCount
 .D Group
 Q
Group S SuffKEY=$P($G(@("^"_pin)@(T,"KEY")),pin_".",2) I SuffKEY="" S SuffKEY="!"_$G(@("^"_pin)@(T,"KEY"))
 F Y=2:1 Q:'$D(@("^"_pin)@(T,Y))
 S Suff=SuffKEY
 S SuffSave=$P($G(@("^"_pin)@(T,"B4I"),"1"),"@",1) i 'SuffSave k SuffSave
 s InsD=$P($G(@("^"_pin)@(T,"B4I"),"1"),"@",2) i 'InsD k InsD
 D SaveTab2,CompTab
 Q
ActT1 ;ДЕЙСТВИЯ НАД ТАБЛИЦЕЙ
 D pin
 I $D(newOK) G Creat
 I $D(ActOK0) D  G TAB ;ГРУППОВАЯ
 .I $D(Check0) D  Q
 ..F I=1:1:$G(TableCount) D AcT($G(Act0),@("Table"_I)) ;ВСЕ
 .E  F I=1:1:$G(TableCount) I $D(@("Check"_I)) D AcT($G(Act0),@("Table"_I))
 .q
 F I=1:1:$G(TableCount) I $D(@("ActOK"_I)) Q
 I $D(@("Table"_I)) D
 .I $G(@("Act"_I))=3 D T2B(@("Table"_I)) G TAB
 .I $G(@("Act"_I))=2 D KILL(@("Table"_I)) G TAB
 .I $G(@("Act"_I))=1 D Edit(@("Table"_I)) Q
 Q
T2B(TAB,DEST) ;ТАБЛИЦУ В БУФЕР ОБМЕНА
 I '$D(DEST) S DEST=$NA(@GTmp@(BSLOGIN,"TAB"))
 K @DEST
 M @DEST=@("^"_pin)@(TAB)
 I $P($G(@("^"_pin)@(TAB,"B4I")),"@",2) M @DEST@("GLOBAL")=@(@("^"_pin)@(TAB,"KEY")) ;W $ZR КОПИРУЕМ И ДАННЫЕ
 Q
KILL(TAB) ;УДАЛИТЬ ТАБЛИЦУ
 I $$Delete^%apiOBJ(pin_"."_TAB,,.ERR)
 W $G(ERR),BK
 S BD=@("^"_pin)@(TAB,"KEY")
 K @("^"_pin)@(TAB),@BD
 W $$LNG^%ZAPM.ed.BSC4("ТАБЛИЦА",116)," '",RED,TAB,EF,"' ",$$LNG^%ZAPM.ed.BSC4("УДАЛЕНА",117),BBK,BBK
 Q
ACT0 ;ГРУППОВЫЕ ДЕЙСТВИЯ
 N I,T
 S T=1 W "<select name='Act0' size=1>"
 F I=$$LNG^%ZAPM.ed.BSC4("Рекомпилировать",118),$$LNG^%ZAPM.ed.BSC4("Удалить",119) W "<option value='"_T_"'>"_I_"</option>" S T=T+1
 W "</select>"
 Q
ACT N I,T
 S T=1 W "<select name='Act"_Co_"' size=1>"
 F I=$$LNG^%ZAPM.ed.BSC4("Редактировать",120),$$LNG^%ZAPM.ed.BSC4("Удалить",119),$$LNG^%ZAPM.ed.BSC4("Копировать в буфер",121) W "<option value='"_T_"'>"_I_"</option>" S T=T+1
 W "</select>"
 Q
OT() N I,P,T ;ВСЕ ТАБЛИЦЫ ДОСТУПНЫЕ КАК ШАБЛОН
 W "<select name=""newTP"" size=1>"
 S P="^%ZAPM.ed.BSC4E" F T="EMPTY" W "<option value='"_$NA(@P@(T))_"'>"_$$LNG^%ZAPM.ed.BSC4("Пустой шаблон",330)_"</option>"
 I $D(@GTmp@(BSLOGIN,"TAB")) W "<option value='"_$ZR_"'>"_$$LNG^%ZAPM.ed.BSC4("Копировать из буфера",56)_"</option>"
 W "<option value='1'>"_$$LNG^%ZAPM.ed.BSC4("Импорт из ODBC",57)_"</option>"
 W "<option value='2'>"_$$LNG^%ZAPM.ed.BSC4("Связь с ODBC",58)_"</option>"
 W "<option value='3'>"_$$LNG^%ZAPM.ed.BSC4("Загрузить из файла (*.txt *.csv)")_"</option>"
 S P="^[""%SYS""]BSC4.CFG" F T="Param","UStatus","Dict" W "<option value='"_$NA(@P@(T))_"'>"_$P($G(@P@(T),"?@"),"@")_"</option>"
 W "</select>"
 Q
Che(N,NN) Q "<input type=""checkbox"" title='"_$$LNG^%ZAPM.ed.BSC4("Групповая работа включая ",122)_$S(N=0:$$LNG^%ZAPM.ed.BSC4("всех",123),1:NN)_"' name='Check"_N_"' value=''>"
ALLPART(PART) ;КОМПИЛИРОВАТЬ ВЕСЬ РАЗДЕЛ B4Y
 N PP
 D MAINVAR^%ZAPM.ed.BSC4
 S pin=$P(PART,"^",2,99)
 S PP="" F  S PP=$O(@PART@(PP)) Q:PP=""  I PP'="ROU" D
 .I $P(@PART@(PP),"@",17)=2 D AcT(1,PP,1)
 Q
BP1() N G I '$P($G(@("^"_pin)@(N,"Parms")),"@",1) Q ""
 S G=$$KBD^%ZAPM.ed.BSF12($NA(@("^"_pin)@(N))) I G="" Q ""
 Q $$BP^%ZAPM.ed.BSC4cfgP("ПАРАМЕТРЫ "_N,"Редактировать параметры",G,G,1)
ParmField()
 Q $$BP^%ZAPM.ed.BSC4cfgP("Параметры "_NameField2,$$LNG^%ZAPM.ed.BSC4("дополнительные параметры поля"),"^[|~SYS|]BSC4.CFG.PropFields",$NA(@("^"_pin)@(TAB,"ParmsCell",NameField2)),1)
ParmTab()
 Q $$BP^%ZAPM.ed.BSC4cfgP("Параметры Таблицы",$$LNG^%ZAPM.ed.BSC4("дополнительные параметры таблицы"),"^[|~SYS|]BSC4.CFG.PropTables",$NA(@("^"_pin)@(TAB,"Parms")),1)
SERVIS(A1,A2,A3) N BSLABEL,Q
 S Q="<div align='right'>"_$$REFRESH(A1)_" "
 I $D(A3) S BSLABEL="ENTER^~BSC4cfg" S Q=Q_" <a class=u1 onclick='open("""_$$1^%ZAPM.ed.BSC4rout(A2,"^"_pi)_""","""",""toolbar=no,menubar=no,scrollbars=yes,"_$$GETOPT^%ZAPM.ed.BSC4cfg(MainOpt,A3)_",status=1,resizable=1"");' >"_$$param_"</a>"
 S Q=Q_"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"_$$HelpB
 S Q=Q_$$Help
 Q Q_"</div>"_BK
HelpB() Q $$SQL("<img src='"_BSDOMAIN_"/img/bssql.gif' ALT='"_$$LNG^%ZAPM.ed.BSC4("Загрузить SQL менеджер")_"'>")
Help() S BSLABEL="help^~BSC4" Q "<a class=u1 onclick='open("""_$$ADDBSGET^%ZAPM.ed.BSC4()_""",""RESULT3"",""toolbar=no,menubar=no,scrollbars=yes,"_$$GETOPT^%ZAPM.ed.BSC4cfg(MainOpt,"NWO1")_",status=1,resizable=1"");' ><img src='"_BSDOMAIN_"/img/help1.gif' ALT='Документация DHTML, JavaScript, COS, SQL, Errors'></a>"
REFRESH(A1) n BSLABEL S BSLABEL=A1
 Q "<a href='"_$$ADDBSGET^%ZAPM.ed.BSC4()_"'><img border=0 src='"_BSDOMAIN_"/img/refr.gif' ALT='"_$$LNG^%ZAPM.ed.BSC4("обновить")_"'></a>"_BK
]]></Routine>


<Routine name="%ZAPM.ed.BSC4base1" type="MAC" languagemode="0"><![CDATA[
%BSC4base1 ; пpогpамма управления БД ; 15:21   10.09.2002
 ;
 ;    Copyright (C) 2002 Serge W. Mikhaylenko
 ;    All Rights Reserved
 ;
ROU ;ПРОГРАММЫ
 D BEG1^%ZAPM.ed.BSC4
 D pin^%ZAPM.ed.BSC4base
 I $G(BSPRO)="" W $$LNG^%ZAPM.ed.BSC4("Сначало определите ПРОЕКТ",74) G PRO^%ZAPM.ed.BSC4base
 W "<form action="""_$$ADDLIB^%ZAPM.ed.BSC4()_""" method=""POST"">"
 S BSLABEL="ActRou^~BSC4base1"
 D ADDBSPOST^%ZAPM.ed.BSC4reg
 W $$SERVIS^%ZAPM.ed.BSC4base("ROU^~BSC4base1","CfgRou","NWO1")
 W "<table border=0 width=100%>"
 W "<tr><td width=10% align='right' class=s1 ><strong>"_$$LNG^%ZAPM.ed.BSC4("ПРОГРАММЫ",124)_"</strong></td><td width=60% class=s1 >"_$$LNG^%ZAPM.ed.BSC4("текущего проекта ",76)_RED_BSPRO_EF_"</td><td class=s1 >"_$$LNG^%ZAPM.ed.BSC4("Групповое действие над всеми",77)_"</td></tr>"
 N I,N,BD,Sort
 S Sort=+$$GETOPT^%ZAPM.ed.BSC4cfg("^"_pi_"(""CfgRou"")","Sort1") I 'Sort S Sort=-1
 W "<tr><td class=s3 >"_$$LNG^%ZAPM.ed.BSC4("ИМЯ",51)_"</td><td class=s3 >"_$$LNG^%ZAPM.ed.BSC4("ОПИСАНИЕ ПРОГРАММНОГО МОДУЛЯ",125)_"</td><td class=s3 >" D ACT0^%ZAPM.ed.BSC4base W $$Che^%ZAPM.ed.BSC4base(0)_"<input type=""submit"" name='ActOK0' title='"_$$LNG^%ZAPM.ed.BSC4("Групповое действие",79)_"' value='&gt;&gt;'></td></tr>"
 S N="",I=0 I '$D(@("^"_pin)) W $$LNG^%ZAPM.ed.BSC4("Нет раздела ! Обратитесь к Администратору",80) Q
 W "<tr><td class=s1 ><input type=""text"" size=13 maxlength=13 name='Rou' value='"_$$NewRoutin("NewRoutin")_"'></td><td class=s1 > "
 D OR(),TLIST() W "</td><td class=s1 >"
 W "<input type=""submit"" name=""newOK"" value='&gt;&gt;"_$$LNG^%ZAPM.ed.BSC4("Создать программу",126)_"'></td></tr>",BK
 S Co=0
 F  S N=$O(@("^"_pin_".ROU")@(N),Sort) Q:N=""  D
 .S Co=Co+1
 .W "<input type=""hidden"" name='Rou"_Co_"' value="""_N_""">" s sta=$G(@("^"_pin_".ROU")@(N,"STA"))
 .W "<tr><td width=20% class=s1 ><a title='"_$s($e(sta,1,2)'="OK":$$LNG^%ZAPM.ed.BSC4("не компилирована",316),1:$$LNG^%ZAPM.ed.BSC4("компилирована")_$P(sta,"OK",2))_"'>"_$$RedStar^%ZAPM.ed.BSC4rou($e(sta,1,2)'="OK")_N_"</a>"
 .w "</td><td class=s1 >"
 .i $d(@("^"_pin_".ROU")@(N,"HTM"))
 .s Tmp=$ZR i sta["OK" W $$NEWIN("<IMG SRC='"_BSDOMAIN_"/img/ie.gif'>",Tmp,$$LNG^%ZAPM.ed.BSC4("загрузить предлагаемый HTML код в новом окне",139),,$S(sta["OK":" ",1:"disabled"))
 .w AF_$G(@("^"_pin_".ROU")@(N,"REM"))_EF_"</td><td class=s1 >"
 .W "<input type=""submit""  title='"_$$LNG^%ZAPM.ed.BSC4("Действие",127)_"' name='ActOK"_Co_"' value='&gt;&gt;'>" D ACT^%ZAPM.ed.BSC4base W $$Che^%ZAPM.ed.BSC4base(Co,N)_"</td></tr>",BK
 W "<input type=""hidden"" name='RouCount' value="""_Co_""">"
 W " </table>"
 W "</form>"
 D END^%ZAPM.ed.BSC4
 Q
NewRoutin(N) N NN ;НОВОЕ ИМЯ ПРОГРАММЫ
 F NN=1:1 I '$D(@("^"_pin_".ROU")@(N_NN)) Q
 Q N_NN
EditRou(Rou) ;РЕДАКТИРОВАТЬ ПРОГРАММУ
 D BEG1^%ZAPM.ed.BSC4
 W $$SERVIS^%ZAPM.ed.BSC4base("ROU^~BSC4base1","CfgRou")
 N Y,STA,ht,ht1,oFFe
 S STA=$G(@("^"_pin_".ROU")@(Rou,"STA"))
 S CheckCode=$P($G(@("^"_pin_".ROU")@(Rou,"FLG")),"@",1)
 S ProtCode=$P($G(@("^"_pin_".ROU")@(Rou,"FLG")),"@",2)
 S Answer=$G(@("^"_pin_".ROU")@(Rou,"ROU")) I Answer="" S Answer=$$LNG^%ZAPM.ed.BSC4("Контроль не производился",128)
 W "<form action="""_$$ADDLIB^%ZAPM.ed.BSC4()_""" method=""POST"">"
 S BSLABEL="SaveRou^~BSC4base1"
 D ADDBSPOST^%ZAPM.ed.BSC4reg
 W "<table border=0 width=100%>"
    W "<input type=""hidden"" name='Rou' value="""_Rou_""">"
 W "<tr><td align='CENTER' width=40% class=s1 >"_$$LNG^%ZAPM.ed.BSC4("РЕДАКТИРОВАНИЕ ПРОГРАММЫ",129)_"</td><td  width=60% class=s1 >"_RED_BSPRO_"."_EF_Rou_"</td></tr>",BK
 W "<tr><td width=30% class=s3 >"_$$LNG^%ZAPM.ed.BSC4("ОБЩИЕ ПАРАМЕТРЫ",96)_"</td><td  width=70% class=s3 >"_$$LNG^%ZAPM.ed.BSC4("ЗНАЧЕНИЯ",97)_"</td></tr>",BK
  W "<tr><td class=s1 >"_$$LNG^%ZAPM.ed.BSC4("Описание",98)_"</td><td class=s1 ><input type=""text"" size=45 maxlength=145 name='Desc' value='"_$G(@("^"_pin_".ROU")@(Rou,"REM"))_"'></td></tr>",BK
   W "<tr><td class=s1 > <input type=""checkbox"" name=""CheckCode"" value="""_CheckCode_""" "_$$ch^%ZAPM.ed.BSC4cfg(CheckCode)_">"_$$LNG^%ZAPM.ed.BSC4("Контроль кода Администратором",130)_"</td><td class=s1 ><input type=""text"" size=25 maxlength=45 name='Answer' value='"_Answer_"'>"
    W " <input type=""checkbox"" name=""ProtCode"" title='"_$$LNG^%ZAPM.ed.BSC4("Запретить ремастеринг во избежания уничтожения пользовательской редакции кода")_"' value="""_ProtCode_""" "_$$ch^%ZAPM.ed.BSC4cfg(ProtCode)_">"_$$LNG^%ZAPM.ed.BSC4("Запретить ремастеринг")_"</td></tr>",BK
     W "<tr><td class=s1 >"_$$LNG^%ZAPM.ed.BSC4("Статус программы",131)_" Cache'ObjectScript</td><td class=s1 ><input type=""text"" size=45 maxlength=145 name='StatRou' value='"_STA_"'></td></tr>",BK
 W "</table>"
 S oFFe=$$GETOPT^%ZAPM.ed.BSC4cfg(MainOpt,"WebEditRou")
 D BUTT
 s ht=$G(@("^"_pin_".ROU")@(Rou,"COS")),Tmp=$ZR
 W " ",$$NEWIN("<IMG SRC='"_BSDOMAIN_"/img/cos.gif'> COS",Tmp,$$LNG^%ZAPM.ed.BSC4("загрузить предлагаемый COS код в новом окне браузера",134),"NumADD^~BSC4r","BUT")
 s ht1=$G(@("^"_pin_".ROU")@(Rou,"HTM")),Tmp=$ZR
 W $$NEWIN("<IMG SRC='"_BSDOMAIN_"/img/ie"_$S(STA["OK":"",1:"off")_".gif'> HTML",Tmp,$$LNG^%ZAPM.ed.BSC4("загрузить предлагаемый HTML код в новом окне",139),,$S(STA["OK":" ",1:"disabled"))
 W "<table border=0 width=100%>"
 W "<tr><td width=* class=s1 ><IMG SRC='"_BSDOMAIN_"/img/cos.gif'>"_$$LNG^%ZAPM.ed.BSC4("Серверная часть (выполняет Cache' сервер) ",132)_$$HelpCache^%ZAPM.ed.BSC4_" "
 I $G(@BDSES@(BSSES,"TEXTARIA","COS"))="" w "<A HREF='"_$$GETH^%ZAPM.ed.BSC4r2("COS","B")_"'><IMG SRC='"_BSDOMAIN_"/img/b.gif' ALT='"_$$LNG^%ZAPM.ed.BSC4("увеличить окно редактирования",138)_"' border=0></A>"_BK
 I $G(@BDSES@(BSSES,"TEXTARIA","COS"))'="" w "<A HREF='"_$$GETH^%ZAPM.ed.BSC4r2("COS","L")_"'><IMG SRC='"_BSDOMAIN_"/img/l.gif' ALT='"_$$LNG^%ZAPM.ed.BSC4("уменьшить окно редактирования",133)_"' border=0></A>"_BK
 W $s(STA'["OK":RED_$$LNG^%ZAPM.ed.BSC4("необходима компиляция")_EF,1:"")_"</td></tr>",BK
 W "<tr><td class=s1 >"
 I oFFe W "<textarea "_$$GETTA^%ZAPM.ed.BSC4r2("COS")_" name='ServR'>"_$$TR^%ZAPM.ed.BSsFUNM($$TR^%ZAPM.ed.BSsFUNM(ht,"<","&lt;"),">","&gt;")_"</textarea>"
 i 'oFFe W "<CENTER>"_RED_$$LNG^%ZAPM.ed.BSC4("РЕДАКТОР ВЫКЛЮЧЕН")_EF_"</CENTER>"
 W "</td></tr>",BK
 W "<tr><td width=* class=s3 ><IMG SRC='"_BSDOMAIN_"/img/ie.gif'>"_$$LNG^%ZAPM.ed.BSC4("Клиентская часть (выполняется в WEB браузере) ",135)_$$HelpDhtml^%ZAPM.ed.BSC4_", "_$$HelpJS^%ZAPM.ed.BSC4_" "
 I $G(@BDSES@(BSSES,"TEXTARIA","HTM"))="" w "<A HREF='"_$$GETH^%ZAPM.ed.BSC4r2("HTM","B")_"'><IMG SRC='"_BSDOMAIN_"/img/b.gif' ALT='"_$$LNG^%ZAPM.ed.BSC4("увеличить окно редактирования",138)_"' border=0></A>"_BK
 I $G(@BDSES@(BSSES,"TEXTARIA","HTM"))'="" w "<A HREF='"_$$GETH^%ZAPM.ed.BSC4r2("HTM","L")_"'><IMG SRC='"_BSDOMAIN_"/img/l.gif' ALT='"_$$LNG^%ZAPM.ed.BSC4("уменьшить окно редактирования",133)_"' border=0></A>"_BK
 W "</td></tr>",BK
 W "<tr><td class=s3 >"_$s(STA'["OK":RED_$$LNG^%ZAPM.ed.BSC4("после компиляции",136)_EF,1:"")
 w $$LNG^%ZAPM.ed.BSC4(" возьмите в буфер обмена и вставте в ваш WEB сайт",137)
 W "</td></tr>",BK
 w "<tr><td class=s3 ><textarea "_$$GETTA^%ZAPM.ed.BSC4r2("HTM")_" name='ClienR'>"_$$TR^%ZAPM.ed.BSsFUNM($$TR^%ZAPM.ed.BSsFUNM(ht1,"<","&lt;"),">","&gt;")_"</textarea></td></tr>",BK
 W "</table>"
 W "</form>"
 D InfoSess^%ZAPM.ed.BSC4rout,END^%ZAPM.ed.BSC4
 Q
NEWIND I BSTMP["|" S BSTMP=$TR(BSTMP,"|",$C(34))
 w $g(@BSTMP," ") ;новое окно
NEWIN(t,ZR,tit,CodeM,BUT) ;новое окно
 n BSLABEL,BSLOGIN,BSPRO,BSRoutineId,BSSES,BSTMP,BSTOP,BSGRANT s BSLABEL=$g(CodeM,"NEWIND^~BSC4base1"),BSTMP=ZR
 S R=$$ADDBSGET^%ZAPM.ed.BSC4() I R[$C(34) S R=$TR(R,$C(34),"|")
 I $D(BUT) Q "<BUTTON "_BUT_" title='"_tit_"' onclick=""open('"_R_"','','toolbar=yes,menubar=no,scrollbars=yes,"_$$GETOPT^%ZAPM.ed.BSC4cfg(MainOpt,"NWT1")_",status=1,resizable=1');"">"_t_"</BUTTON>"
 Q "<a title='"_tit_"' class=u1 onclick=""open('"_R_"','Tmp"_$TR($H,",","")_"','toolbar=yes,menubar=no,scrollbars=yes,"_$$GETOPT^%ZAPM.ed.BSC4cfg(MainOpt,"NWT1")_",status=1,resizable=1');"">"_t_"</a>"
CheckRou(ServR) ;        трансляция и синтаксический контроль кода
 I ServR="" W RED_Rou_" "_$$LNG^%ZAPM.ed.BSC4("Программа пустая!",140)_EF_BBK Q 0
 I '$$Security^%ZAPM.ed.BSC4r(ServR) W RED_Rou_" "_$$LNG^%ZAPM.ed.BSC4("Контроль на безопасность не пройден!",141),EF," ",$$NEWIN($$LNG^%ZAPM.ed.BSC4("Запрещенные команды",142),"1",$$LNG^%ZAPM.ed.BSC4("загрузить запрещенный COS код в новом окне браузера",143),"Protect^~BSC4r"),BBK Q 0
 S ServR=" #include %BSC4inc"_BK_ServR
 s K=$L(ServR,BK)
 F I=1:1:K S ServR(I)=$P(ServR,BK,I) ;W ServR(I),BK
 S ServR="",ServR(0)=K,out=""
 D ROUTINE^%R(pin_"."_Rou_".MAC",.ServR,.err,"CS",0)
 I $G(err)'="" W "<PRE>",RED,$$FMTERR^%R(.err,.ServR),EF,"</PRE>",BK Q 0
 ;D ROUTINE^%R(pin_"."_Rou_".INT",.ServR,.err,"D",0)
 ;I $G(err)'="" W "<PRE>",RED,$$FMTERR^%R(.err,.ServR),EF,"</PRE>",BK Q 0
 ;D DEL1^%ZAPM.ed.BSC4r4(pin_"."_Rou_".MAC") ;,filedate,nsp)
 Q 1
CompRou ;КОМПИЛИРОВАТЬ ПРОГРАММУ
 N N1,R1,I,K,out,err
 s N1=$ZU(5),R1=$zcrc(N1_"^"_pin_"."_Rou,7)
 I '$$CheckRou(ServR) D  Q  ;ИЛИ СИНТАКСИС НЕ ПРОШЕЛ
 .S @("^"_pin_".ROU")@(Rou,"STA")="Error "_$$TD^%ZAPM.ed.BSC4base
 .D DEL1^%ZAPM.ed.BSC4r4(pin_"."_Rou_".*") K @BDREF@(R1)
 .S @("^"_pin_".ROU")@(Rou,"ROU")=" "
 ;контроль прошел
 S @BDREF@(R1,"Name")=pin_"."_Rou,@BDREF@(R1,"Namespace")=N1 ;,@BDREF@(R1,"pi")=pi
 I $G(ClienR)'="" S @("^"_pin_".ROU")@(Rou,"HTM")=$$TR^%ZAPM.ed.BSsFUNM(ClienR,"????????",R1)
 ;I $G(ServR)'="" S @("^"_pin_".ROU")@(Rou,"COS")=$$TR^%ZAPM.ed.BSsFUNM(ServR,"????????",R1) !!!!!! НЕЛЬЗЯ
 S @("^"_pin_".ROU")@(Rou,"STA")="OK "_$$TD^%ZAPM.ed.BSC4base,@("^"_pin_".ROU")@(Rou,"ROU")=" BSRoutineId="_R1
 Q
ReMST(newTP,EnablT) K @("^"_pin_".ROU")@(Rou)
 I newTP["^" D @(newTP_"(pin,Rou,EnablT)") I 1
 E  D @(newTP_"^%ZAPM.ed.BSC4rou(pin,Rou,EnablT)")
 D EditRou(Rou) Q
BUTT W "<nobr><input type=""submit"" name=""SaveRou"" "_$S('$G(oFFe):"disabled",1:"")_" title='"_$$LNG^%ZAPM.ed.BSC4("Только сохранить изменения",108)_"' value='"_$$LNG^%ZAPM.ed.BSC4("Сохранить",109)_"'>"
 w "<input type=""submit"" name=""CompRou"" "_$S('$G(oFFe):"disabled",1:"")_" title='"_$$LNG^%ZAPM.ed.BSC4("Компилировать серверную часть модуля",144)_"' value='"_$$LNG^%ZAPM.ed.BSC4("Компилировать",111)_"'>"
 w "<input type='RESET' "_$S('$G(oFFe):"disabled",1:"")_" title='"_$$LNG^%ZAPM.ed.BSC4("Отменить текущие изменения",112)_"' name='Reset1' value='"_$$LNG^%ZAPM.ed.BSC4("Отменить",73)_"'>"
 N MST S MST=$G(@("^"_pin_".ROU")@(Rou,"MST"))
 I MST'="" w "<input type=""submit"" name=""ReMST"" "_$S('$G(oFFe):"disabled",1:"")_" "_$S($G(ProtCode):"disabled",1:"")_" title='"_$$LNG^%ZAPM.ed.BSC4("Создать заново программу, используя Мастер `",145)_$P($P(MST,","),"^")_$$LNG^%ZAPM.ed.BSC4("` для таблицы `",146)_$P(MST,",",2)_"`' value='"_$$LNG^%ZAPM.ed.BSC4("РеМастеринг",147)_"'>"
 W "</nobr>" Q
SaveRou ;СОХРАНИТЬ ИЗМЕНЕНИЯ
 D pin^%ZAPM.ed.BSC4base
 I $D(ReMST) S ReMST=@("^"_pin_".ROU")@(Rou,"MST") D ReMST($P(ReMST,",",1),$P(ReMST,",",2)) Q
 I $G(Desc)'="" S @("^"_pin_".ROU")@(Rou,"REM")=Desc
 I $G(Suff)'="" S @("^"_pin_".ROU")@(Rou,"ROU")=Suff
 S $P(@("^"_pin_".ROU")@(Rou,"FLG"),"@",1)=$S($D(CheckCode):1,1:0)
 S $P(@("^"_pin_".ROU")@(Rou,"FLG"),"@",2)=$S($D(ProtCode):1,1:0)
 I $D(CheckCode),'$$TARIF^%ZAPM.ed.BSC4rout("TIP") W RED,$$LNG^%ZAPM.ed.BSC4("Контроль кода Адмигистратором",148)," ",$$LNG^%ZAPM.ed.BSC4("возможно только на старших тарифных планах",149),EF,BBK,BBK
 ;ZW %KEY("ServR"),BK
 I $G(ServR)'="" S @("^"_pin_".ROU")@(Rou,"COS")=ServR
 I $G(ClienR)'="" S @("^"_pin_".ROU")@(Rou,"HTM")=ClienR
 S @("^"_pin_".ROU")@(Rou,"STA")="Save "_$$TD^%ZAPM.ed.BSC4base
 ;S @("^"_pin_".ROU")@(Rou,"ROU")=" "
 I $D(CompRou) D CompRou
 D EditRou(Rou) Q
ActRou ;ДЕЙСТВИЯ НАД ПРООГРАММОЙ
 N I D pin^%ZAPM.ed.BSC4base
 I $D(newOK) G CreatRou
 I $D(ActOK0) D  G ROU ;ГРУППОВАЯ
 .I $D(Check0) F I=1:1:$G(RouCount) D Ac($G(Act0),@("Rou"_I)) ;ВСЕ
 .E  F I=1:1:$G(RouCount) I $D(@("Check"_I)) D Ac($G(Act0),@("Rou"_I))
 F I=1:1:$G(RouCount) I $D(@("ActOK"_I)) Q
 I $D(@("Rou"_I)) D
 .I $G(@("Act"_I))=2 D KillRou(@("Rou"_I)) G ROU
 .I $G(@("Act"_I))=1 D EditRou(@("Rou"_I)) Q
 .I $G(@("Act"_I))=3 D R2B(@("Rou"_I)) G ROU
 Q
Ac(A,R) ;ГРУППОВОЕ ДЕЙСТВИЕ
 I A=1 S Rou=R,ServR=$G(@("^"_pin_".ROU")@(Rou,"COS")),ClienR=$G(@("^"_pin_".ROU")@(Rou,"HTM")) D CompRou Q
 I A=2 D KillRou(R) Q
 Q
ALLROU(PART) //КОМПИЛИРОВАТЬ ВСЕ ПРОГРАММЫ B4Y
 N Rou,PP,pin
 D MAINVAR^%ZAPM.ed.BSC4
 S pin=$P(PART,"^",2,99)
 S PP=$G(@PART@("ROU","KEY")) Q:PP=""
 S Rou="" F  S Rou=$O(@PP@(Rou)) Q:Rou=""  D Ac(1,Rou)
 Q
R2B(ROU,DEST) ;ПРОГРАММУ В БУФЕР ОБМЕНА
 I '$D(DEST) S DEST=$NA(@GTmp@(BSLOGIN,"ROU"))
 N ID K @DEST
 S ID=$P($G(@("^"_pin_".ROU")@(ROU,"ROU"))," BSRoutineId=",2)
 M @DEST=@("^"_pin_".ROU")@(ROU)
 I ID'="" D
 .S @DEST@("HTM")=$$TR^%ZAPM.ed.BSsFUNM(@("^"_pin_".ROU")@(ROU,"HTM"),ID,"????????")
 .S @DEST@("COS")=$$TR^%ZAPM.ed.BSsFUNM(@("^"_pin_".ROU")@(ROU,"COS"),ID,"????????")
 .K @DEST@("ROU"),@DEST@("STA")
 Q
KillRou(Rou) ;УДАЛИТЬ ПРОГРАММУ
 N ID
 D DEL1^%ZAPM.ed.BSC4r4(pin_"."_Rou_".*") S ID=$P($G(@("^"_pin_".ROU")@(Rou,"ROU"))," BSRoutineId=",2)
 K @("^"_pin_".ROU")@(Rou) I ID'="" K @BDREF@(ID)
 W $$LNG^%ZAPM.ed.BSC4("ПРОГРАММА",150)," '",RED,Rou,EF,"' ",$$LNG^%ZAPM.ed.BSC4("УДАЛЕНА",117),BBK,BBK
 Q
CreatRou ;СОЗДАТЬ ПРОГРАММУ
 I $D(@("^"_pin_".ROU")@(Rou)) W $$LNG^%ZAPM.ed.BSC4("Программа с именем",151)," '",RED,Rou,EF,"' ",$$LNG^%ZAPM.ed.BSC4("уже существует",61),BK G ROU
 I newTP[$P(GTmp,")") D Copy^%ZAPM.ed.BSF8(newTP,$NA(@("^"_pin_".ROU")@(Rou))) G ROU
 I newTP="" S @("^"_pin_".ROU")@(Rou,"REM")="" I 1
 E  D
 .I newTP["*" W $$LNG^%ZAPM.ed.BSC4("Мастер создания программ '",152)_$E(newTP,2,99)_$$LNG^%ZAPM.ed.BSC4("' доступен только на старших тарифных планах",153) I 1
 .E  D @(newTP_"^%ZAPM.ed.BSC4rou(pin,Rou,EnablT)")
 G ROU
OR() N B,I,P,T ;ВСЕ ПРОГРАММЫ ДОСТУПНЫЕ КАК ШАБЛОН
 W "<select name=""newTP"" size=1>"
 I $D(@GTmp@(BSLOGIN,"ROU")) W "<option value='"_$ZR_"'>"_$$LNG^%ZAPM.ed.BSC4("Копировать из буфера",56)_"</option>"
 ;S P="^%ZAPM.ed.BSC4E",T=""
 ;S B=$$KBD^%ZAPM.ed.BSF12($NA(@P@("ROU")))
 W "<option value=''>"_$$LNG^%ZAPM.ed.BSC4("применить мастер..",154)_"</option>"
 F T="RunCode","InputForm","Populate","DynamicSQL","Find","Navigator"  W "<option value='"_T_"'>"_T_"</option>"
 W "</select>"
 Q
TLIST() N N ;ДОСТУПНЫЕ ТАБЛИЦЫ
 S N=""
 W "<select name=""EnablT"" size=1>"
 W "<option " W " value=''>"_$$LNG^%ZAPM.ed.BSC4("к таблице..",155)_"</option>"
 F  S N=$O(@("^"_pin)@(N)) Q:N=""  I $P($G(@("^"_pin)@(N)),"@",17)=2 D
 .I N="ROU" Q
 .I $G(@("^"_pin)@(N,"Compile"))'["OK" q  ;не компилирована
 .W "<option " W " value='"_N_"'>"_N_"</option>"
 W "</select>"
 Q
]]></Routine>


<Routine name="%ZAPM.ed.BSC4cal" type="MAC" languagemode="0"><![CDATA[
%BSC4cal ;CALENDAR FUNCTION  ; Compiled February 22, 2002 23:26:36
 ;
 ;    Copyright (C) 2002 Serge W. Mikhaylenko
 ;    All Rights Reserved
 ; 
 q
A(d,T,Targ) ;ЯКОРЬ ;КАЛЕНДАРЬ d-дата предустановки, d="" - дата текущая d=YYYYMMDD
 I d="" S d=$ZD($h,8)
 Q $$a^%ZAPM.ed.BSC4rout($$CALGET(d),T,T,300,250)
on(BSLABEL,W,H) q " onclick='open("""_$$ADDBSGET^%ZAPM.ed.BSC4()_""","""_$G(Targ,"calend")_""",""toolbar=no,menubar=no,scrollbars=no,width="_$G(W,640)_",height="_$G(H,480)_",status=1,resizable=1"");' "
B(d,N,Targ,ROU,AN) ;кнопка/ЯКОРЬ В НОВОМ ОКНЕ
 I d="" S d=$ZD($h,8)
 N BSLABEL,BSDATE,Q,QQ S BSLABEL=$G(ROU,"CALDATE^~BSC4cal"),BSDATE=d,Q=""
 I $G(AN)="" S Q=Q_"<BUTTON name='Calendar2' ",QQ="</BUTTON>"
 E  S Q=Q_"<A name='Calendar2' ",QQ="</A>"
 S Q=Q_$$on(BSLABEL,300,250)_" ><IMG src='"_BSDOMAIN_"/img/cal.gif' alt='"_$G(N,""_$$LNG^%ZAPM.ed.BSC4("календарь",156)_"")_"'>"
 Q Q_QQ
EDITDATE ;ВЫЗВАТЬ КАЛЕНДАРЬ
 D CAL($E(BSDATE,1,4),$E(BSDATE,5,6)-1,+$E(BSDATE,7,8),"Календарь","",BS1,BS2,,1) //BS2=ПРОГРАММА ВОЗВРАТА
 Q
 //ПРИНЯТЬ ДАТУ ОТ КАЛЕНДАРЯ
D4(N) S:N="" N=1 Q $S($L(N)=1:"0"_N,1:N)
RETURN() ;ПРИНЯТЬ ДАТУ ОТ КАЛЕНДАРЯ
 N D
 I $D(Today) S D=$ZD($h,8)
 I $D(Ok) S D=tbSelYear_$$D4(tbSelMonth)_$$D4(calSelectedDate)
 I $D(Esc) S D=""
 Q D //D=YYYYMMDD
CALDATE ;ВЫЗВАТЬ КАЛЕНДАРЬ
 D CAL($E(BSDATE,1,4),$E(BSDATE,5,6)-1,+$E(BSDATE,7,8),$$LNG^%ZAPM.ed.BSC4("Календарь",157))
 Q
CALGET(d) N BSLABEL,BSDATE S BSLABEL="CALDATE^~BSC4cal",BSDATE=d
 Q $$ADDBSGET^%ZAPM.ed.BSC4()    
CAL(Yy,Mm,Dd,TiT,BODY,BSG,BSLABEL,GRAY,NOCLOSE,YearOT,YearDO) ;//Календарь - RUS
 ;Yy,- год по-умолчанию
 ;Mm,- месяц по-умолчанию
 ;Dd,- день по-умолчанию
 ;TiT,- атрибут тага <title>
 ;BODY,- атрибут тага <body>
 ;BSG,- скрытая переменная ссылки на узел BS-WebLink
 ;BSLABEL,- скрытая переменная ссылки на программу обработки выбора даты
 ;GRAY,- цвета календаря
 ;NOCLOSE,- не закрывать текущее окно браузера
 ;YearOT,- нижний диапазон годов
 ;YearDO- верхний диапазон годов
 Write "  ",BK
 Write "<html>",BK
 Write "<head><title>"_TiT_"</title>",BK
 W $$STYLE^%ZAPM.ed.BSC4
 Write "<script language=""javascript"">",BK
 W "<!--",BK
 Write " //Скачано с cgi.ru",BK
 Write " //Все скрипты : cgi.ru",BK
 Write " //info@cgi.ru",BK
 Write " // Идея и основная часть кода: Nick Korosi (nfk2000@hotmail.com).",BK
 Write " // Дополнено:",BK
 Write " //  1. Отображение порядка дней недели в соответствии с принятым в России;",BK
 Write " //      2. Подсветка текущего дня месяца;",BK
 Write " //      3. Возможность общей настройки цветового решения;",BK
 Write " // Автор дополнений: Боронин Денис (bdv@freemail.ru). ",BK
 Write " // Idea and main code part: Nick Korosi (nfk2000@hotmail.com) ",BK
 Write " // Adds:",BK
 Write " //  1. Russian week date order;",BK
 Write " //      2. Current day illumination;",BK
 Write " //      3. Simple color setting up.",BK
 Write " // Author of adds: Denis Boronin (bdv@freemail.ru)",BK
 Write "var dDate = new Date("_(Yy)_","_(Mm)_","_(Dd)_");",BK
 Write "var dCurMonth = dDate.getMonth();",BK
 Write "var dCurDayOfMonth = dDate.getDate();",BK
 Write "var dCurYear = dDate.getFullYear();",BK
 Write "var objPrevElement = new Object();",BK
 Write "var bgcolor",BK
 Write "var webgcolor",BK
 Write "var wecolor",BK
 Write "var nwecolor",BK
 Write "var tbgcolor",BK
 Write "var ntbgcolor",BK
 Write "var sbgcolor",BK
 Write "function fToggleColor(myElement) ",BK
 Write "{",BK
 Write " var toggleColor = ""#ff0000"";",BK
 Write " if (myElement.id == ""calDateText"") ",BK
 Write "  {",BK
 Write "  if (myElement.color == toggleColor) ",BK
 Write "   {",BK
 Write "   myElement.color = """";",BK
 Write "   } ",BK
 Write "  else ",BK
 Write "  {",BK
 Write "  myElement.color = toggleColor;",BK
 Write "  }",BK
 Write " } ",BK
 Write " else ",BK
 Write "  if ((myElement.id == ""calCell"") || (myElement.id == ""calTodayCell""))",BK
 Write "  {",BK
 Write "  for (var i in myElement.children) ",BK
 Write "   {",BK
 Write "   if (myElement.children[i].id == ""calDateText"") ",BK
 Write "    {",BK
 Write "    if (myElement.children[i].color == toggleColor) ",BK
 Write "     {",BK
 Write "     myElement.children[i].color = """";",BK
 Write "     } ",BK
 Write "    else ",BK
 Write "    {",BK
 Write "    myElement.children[i].color = toggleColor;",BK
 Write "    }",BK
 Write "   }",BK
 Write "  }",BK
 Write " }",BK
 Write "}",BK
 Write "function fSetSelectedDay(myElement)",BK
 Write "{",BK
 Write " if (myElement.id == ""calCell"") ",BK
 Write " {",BK
 Write "  if (!isNaN(parseInt(myElement.children[""calDateText""].innerText))) ",BK
 Write "   {",BK
 Write "   myElement.bgColor = sbgcolor;",BK
 Write "   objPrevElement.bgColor = ntbgcolor;",BK
 Write "   document.all.calSelectedDate.value = parseInt(myElement.children[""calDateText""].innerText);",BK
 Write "   objPrevElement = myElement;",BK
 Write "   }",BK
 Write "  }",BK
 Write "}",BK
 Write "function fGetDaysInMonth(iMonth, iYear) ",BK
 Write "{",BK
 Write " var dPrevDate = new Date(iYear, iMonth, 0);",BK
 Write " return dPrevDate.getDate();",BK
 Write "}",BK
 Write "function fBuildCal(iYear, iMonth, iDayStyle) ",BK
 Write "{",BK
 Write " var aMonth = new Array();",BK
 Write " aMonth[0] = new Array(7);",BK
 Write " aMonth[1] = new Array(7);",BK
 Write " aMonth[2] = new Array(7);",BK
 Write " aMonth[3] = new Array(7);",BK
 Write " aMonth[4] = new Array(7);",BK
 Write " aMonth[5] = new Array(7);",BK
 Write " aMonth[6] = new Array(7);",BK
 Write " var dCalDate = new Date(iYear, iMonth-1, 1);",BK
 Write " var iDayOfFirst = dCalDate.getDay();",BK
 Write " var iDaysInMonth = fGetDaysInMonth(iMonth, iYear);",BK
 Write " var iVarDate = 1;",BK
 Write " var i, d, w;",BK
 Write " if (iDayOfFirst==0)",BK
 Write " {",BK
 Write "  iDayOfFirst=6",BK
 Write " }",BK
 Write " else",BK
 Write " {",BK
 Write "  iDayOfFirst=iDayOfFirst-1",BK
 Write " }",BK
 Write " if (iDayStyle == 2) ",BK
 Write "  {",BK
 Write "  aMonth[0][0] = ""Понедельник"";",BK
 Write "  aMonth[0][1] = ""Вторник"";",BK
 Write "  aMonth[0][2] = ""Среда"";",BK
 Write "  aMonth[0][3] = ""Четверг"";",BK
 Write "  aMonth[0][4] = ""Пятница"";",BK
 Write "  aMonth[0][5] = ""Суббота"";",BK
 Write "  aMonth[0][6] = ""Воскресенье"";",BK
 Write "  } ",BK
 Write " else ",BK
 Write "  if (iDayStyle == 1) ",BK
 Write "  {",BK
 Write "  aMonth[0][0] = ""Пон"";",BK
 Write "  aMonth[0][1] = ""Вт"";",BK
 Write "  aMonth[0][2] = ""Ср"";",BK
 Write "  aMonth[0][3] = ""Чт"";",BK
 Write "  aMonth[0][4] = ""Пт"";",BK
 Write "  aMonth[0][5] = ""Сб"";",BK
 Write "  aMonth[0][6] = ""Вск"";",BK
 Write "  } ",BK
 Write "  else ",BK
 Write "   {",BK
 Write "   aMonth[0][0] = ""Пн"";",BK
 Write "   aMonth[0][1] = ""Вт"";",BK
 Write "   aMonth[0][2] = ""Ср"";",BK
 Write "   aMonth[0][3] = ""Чт"";",BK
 Write "   aMonth[0][4] = ""Пт"";",BK
 Write "   aMonth[0][5] = ""Сб"";",BK
 Write "   aMonth[0][6] = ""Вс"";",BK
 Write "   }",BK
 Write " for (d = iDayOfFirst; d < 7; d++) ",BK
 Write "  {",BK
 Write "  aMonth[1][d] = iVarDate",BK
 Write "  iVarDate++;",BK
 Write "  }",BK
 Write " for (w = 2; w < 7; w++) ",BK
 Write "  {",BK
 Write "  for (d = 0; d < 7; d++) ",BK
 Write "   {",BK
 Write "   if (iVarDate <= iDaysInMonth) ",BK
 Write "    {",BK
 Write "    aMonth[w][d] = iVarDate",BK
 Write "    iVarDate++;",BK
 Write "    }",BK
 Write "   }",BK
 Write "  }",BK
 Write " return aMonth;",BK
 Write "}",BK
 Write "function fDrawCal(iYear, iMonth, iCellWidth, iCellHeight, sDateTextSize, sDateTextWeight, iDayStyle, ibgcolor, iwebgcolor, inwecolor, iwecolor, itbgcolor, intbgcolor, isbgcolor) ",BK
 Write "{ ",BK
 Write " bgcolor = ibgcolor;",BK
 Write " webgcolor = iwebgcolor;",BK
 Write " wecolor = iwecolor;",BK
 Write " nwecolor = inwecolor;",BK
 Write " tbgcolor = itbgcolor;",BK
 Write " ntbgcolor = intbgcolor;",BK
 Write " sbgcolor = isbgcolor;",BK
 Write " var myMonth;",BK
 Write " myMonth = fBuildCal(iYear, iMonth, iDayStyle);",BK
 Write " document.write(""<table border='0'>"")",BK
 Write " document.write(""<tr>"");",BK
 Write " document.write(""<td align='center' style='BACKGROUND-COLOR:""+ bgcolor +"";FONT-FAMILY:Arial;FONT-SIZE:12px;FONT-WEIGHT:bold;COLOR:""+ nwecolor +""'>"" + myMonth[0][0] + ""</td>"");",BK
 Write " document.write(""<td align='center' style='BACKGROUND-COLOR:""+ bgcolor +"";FONT-FAMILY:Arial;FONT-SIZE:12px;FONT-WEIGHT:bold;COLOR:""+ nwecolor +""'>"" + myMonth[0][1] + ""</td>"");",BK
 Write " document.write(""<td align='center' style='BACKGROUND-COLOR:""+ bgcolor +"";FONT-FAMILY:Arial;FONT-SIZE:12px;FONT-WEIGHT:bold;COLOR:""+ nwecolor +""'>"" + myMonth[0][2] + ""</td>"");",BK
 Write " document.write(""<td align='center' style='BACKGROUND-COLOR:""+ bgcolor +"";FONT-FAMILY:Arial;FONT-SIZE:12px;FONT-WEIGHT:bold;COLOR:""+ nwecolor +""'>"" + myMonth[0][3] + ""</td>"");",BK
 Write " document.write(""<td align='center' style='BACKGROUND-COLOR:""+ bgcolor +"";FONT-FAMILY:Arial;FONT-SIZE:12px;FONT-WEIGHT:bold;COLOR:""+ nwecolor +""'>"" + myMonth[0][4] + ""</td>"");",BK
 Write " document.write(""<td align='center' style='BACKGROUND-COLOR:""+ webgcolor +"";FONT-FAMILY:Arial;FONT-SIZE:12px;FONT-WEIGHT:bold;COLOR:""+ wecolor +""'>"" + myMonth[0][5] + ""</td>"");",BK
 Write " document.write(""<td align='center' style='BACKGROUND-COLOR:""+ webgcolor +"";FONT-FAMILY:Arial;FONT-SIZE:12px;FONT-WEIGHT:bold;COLOR:""+ wecolor +""'>"" + myMonth[0][6] + ""</td>"");",BK
 Write " document.write(""</tr>"");",BK
 Write " for (w = 1; w < 7; w++) ",BK
 Write "  {",BK
 Write "  document.write(""<tr>"")",BK
 Write "  for (d = 0; d < 7; d++) ",BK
 Write "   {",BK
 Write "   if (myMonth[w][d]==dCurDayOfMonth)",BK
 Write "    {",BK
 Write "    document.write(""<td id=calTodayCell bgcolor='""+ tbgcolor +""' align='center' valign='center' width='"" + iCellWidth + ""' height='"" + iCellHeight + ""' style='CURSOR:Hand;FONT-FAMILY:Arial;FONT-SIZE:"" + sDateTextSize + "";FONT-WEIGHT:"" + sDateTextWeight + ""' onMouseOver='fToggleColor(this)' onMouseOut='fToggleColor(this)' onclick=fSetSelectedDay(this)>"");",BK
 Write "    }",BK
 Write "   else",BK
 Write "    {",BK
 Write "    document.write(""<td id=calCell bgcolor='""+ ntbgcolor +""' align='center' valign='center' width='"" + iCellWidth + ""' height='"" + iCellHeight + ""' style='CURSOR:Hand;FONT-FAMILY:Arial;FONT-SIZE:"" + sDateTextSize + "";FONT-WEIGHT:"" + sDateTextWeight + ""' onMouseOver='fToggleColor(this)' onMouseOut='fToggleColor(this)' onclick=fSetSelectedDay(this)>"");",BK
 Write "    }",BK
 Write "  if (!isNaN(myMonth[w][d])) ",BK
 Write "   {",BK
 Write "   document.write(""<font id=calDateText onclick=fSetSelectedDay(this)>"" + myMonth[w][d]);",BK
 Write "   } ",BK
 Write "  else ",BK
 Write "   {",BK
 Write "   document.write(""<font id=calDateText onclick=fSetSelectedDay(this)>"");",BK
 Write "   }",BK
 Write "  document.write(""</td>"")",BK
 Write "  }",BK
 Write "  document.write(""</tr>"");",BK
 Write "  }",BK
 Write " document.write(""</table>"")",BK
 Write " }",BK
 Write "function fUpdateCal(iYear, iMonth) ",BK
 Write "{",BK
 Write " myMonth = fBuildCal(iYear, iMonth);",BK
 Write " objPrevElement.bgColor = ntbgcolor;",BK
 Write " if (((iMonth-1)==dCurMonth) && (iYear==dCurYear))",BK
 Write "  {",BK
 Write "  calTodayCell.bgColor = tbgcolor",BK
 Write "  }",BK
 Write " else",BK
 Write "  {",BK
 Write "  calTodayCell.bgColor = ntbgcolor",BK
 Write "  }",BK
 Write " document.all.calSelectedDate.value = """";",BK
 Write " for (w = 1; w < 7; w++) ",BK
 Write "  {",BK
 Write "  for (d = 0; d < 7; d++) ",BK
 Write "   {",BK
 Write "   if (!isNaN(myMonth[w][d])) ",BK
 Write "    {",BK
 Write "    calDateText[((7*w)+d)-7].innerText = myMonth[w][d];",BK
 Write "    } ",BK
 Write "   else ",BK
 Write "    {",BK
 Write "    calDateText[((7*w)+d)-7].innerText = "" "";",BK
 Write "    }",BK
 Write "   }",BK
 Write "  }",BK
 Write "}",BK
 Write "-->",BK
 Write "</script>",BK
 ;Write "<!-- ОКОНЧАНИЕ -->",BK
 Write "</head>",BK
 ;Write "<body ONUNLOAD='window.returnValue = frmCalendar.tbSelYear.value+"",""+frmCalendar.tbSelMonth.value+"",""+frmCalendar.calSelectedDate.value; YeaR=frmCalendar.tbSelYear.value; MontH=frmCalendar.tbSelMonth.value;'>",BK
 Write "<body "_$G(BODY)_"  onkeyPress=""javascript: if (27 == event.keyCode) window.close(); "" ><center>",BK
 ;Write "<!--",BK
 ;Write " Вставить текст в необходимое место Вашей страницы",BK
 ;Write "-->",BK
 ;Write "<!-- НАЧАЛО -->",BK
 Write "<script language=""JavaScript"" for=window event=onload>",BK
 Write "<!--",BK
 Write " var dCurDate = new Date("_(Yy)_","_(Mm)_","_(Dd)_");",BK
 Write " frmCalendar.tbSelMonth.options[dCurDate.getMonth()].selected = true;",BK
 Write " for (i = 0; i < frmCalendar.tbSelYear.length; i++)",BK
 Write "  if (frmCalendar.tbSelYear.options[i].value == dCurDate.getFullYear())",BK
 Write "  frmCalendar.tbSelYear.options[i].selected = true;",BK
 Write "-->",BK
 Write "</script>",BK
 Write "<form name=""frmCalendar"" method=""post"" action="""_$$ADDLIB^%ZAPM.ed.BSC4_""">",BK
 ;;;Write "<form name=""frmCalendar"" method=""post"" action="""">",BK     
 Write "<input type=""hidden"" name=""calSelectedDate"" value="""">",BK
 ;Write "<input type=""hidden"" name=""YeaR"" value="""">",BK
 ;Write "<input type=""hidden"" name=""MontH"" value="""">",BK
 D ADDBSPOST^%ZAPM.ed.BSC4reg
 Write "<table border=""0"" bgcolor=""white"">",BK
 Write " <tr>",BK
 Write " <td align=center>",BK
 Write " <select name=""tbSelMonth"" onchange='fUpdateCal(frmCalendar.tbSelYear.value, frmCalendar.tbSelMonth.value)'>",BK
 Write " <option value=""1"">Январь</option>",BK
 Write " <option value=""2"">Февраль</option>",BK
 Write " <option value=""3"">Март</option>",BK
 Write " <option value=""4"">Апрель</option>",BK
 Write " <option value=""5"">Май</option>",BK
 Write " <option value=""6"">Июнь</option>",BK
 Write " <option value=""7"">Июль</option>",BK
 Write " <option value=""8"">Август</option>",BK
 Write " <option value=""9"">Сентябрь</option>",BK
 Write " <option value=""10"">Октябрь</option>",BK
 Write " <option value=""11"">Ноябрь</option>",BK
 Write " <option value=""12"">Декабрь</option>",BK
 Write " </select>",BK
 Write " <select name=""tbSelYear"" onchange='fUpdateCal(frmCalendar.tbSelYear.value, frmCalendar.tbSelMonth.value)'>",BK
 F Y=$G(YearOT,$E($ZD($h,8),1,4)-3):1:$G(YearDO,$E($ZD($h,8),1,4)+2) Write "                         <option value="""_Y_""">"_Y_"</option>",BK
 Write " </select>",BK
 Write " </td>",BK
 Write " </tr>",BK
 Write " <tr>",BK
 Write "  <td>",BK
 Write "  <script language=""JavaScript"">",BK
 Write "  <!--",BK
 Write "  var dCurDate = new Date("_(Yy)_","_(Mm)_","_(Dd)_");",BK
 Write "  fDrawCal(dCurDate.getFullYear(), dCurDate.getMonth()+1, 30, 16, ""12px"", ""bold"", 3, ""gray"", ""blue"", ""white"", ""white"", ""Aqua"", """_$g(GRAY,"silver")_""", ""Teal"");",BK
 Write "  -->",BK
 Write "  </script>",BK
 Write " </td>",BK
 Write " </tr>",BK
 Write "</table>",BK
 I $D(NOCLOSE) S NOC=""
 E  S NOC="ONCLICK='window.close();'"
 Write "<input type=""submit"" name=""Ok"" "_NOC_" value=""Выбрать"">",BK
 Write "<input type=""submit"" name=""Today"" "_NOC_" value=""Сегодня"">",BK
 Write "<input type=""submit"" name=""Esc"" "_NOC_" value=""Отмена"">",BK
 Write "</center></form>",BK
 Write "</body>",BK
 Write "</html>",BK
 Q
]]></Routine>


<Routine name="%ZAPM.ed.BSC4cfg" type="MAC" languagemode="0"><![CDATA[
%BSC4cfg ;БИБЛИОТЕКА ФУНКЦИЙ РАБОТЫ С ОПЦИЯМИ ; 21:45   11.01.2001
 ;
 ;    Copyright (C) 2002 Serge W. Mikhaylenko
 ;    All Rights Reserved
 ;
 ;КОРРЕКТНО РАБОТАЮТ ТОЛЬКО НОВЫЙ ФОРМАТ ТАБЛИЦ ОПЦИИ: OPT=1 !!!!!!!!!!
 Q
VAR ;НАЧАЛО
 S Bs=$$CurT^%ZAPM.ed.BSChT($$%^%ZAPM.ed.BSCh(BSNSP),$$%^%ZAPM.ed.BSCh(BSPART),$$%^%ZAPM.ed.BSCh(BSTABL))
 S PART=$P(Bs,"("),TABL=$QS(Bs,1)
 S O=Bs
 Q
BSVAR ;ПЕРЕМЕННЫЕ ДЛЯ ТАБЛИЦЫ
 w "<input type=""hidden"" name=""BSTABL"" value="""_%KEY("BSTABL")_""">",$G(BK) 
 w "<input type=""hidden"" name=""BSPART"" value="""_%KEY("BSPART")_""">",$G(BK) 
 ;w "<input type=""hidden"" name=""BSNSPACE"" value="""_%KEY("BSNSPACE")_""">",$G(BK)     
 Q
ENTER ;основной вход в таблицу опций
 N O D VAR
 D BEG1^%ZAPM.ed.BSC4
 W "<TITLE> <<<<<<<<<<<< "_$$TITLE(O)_"</TITLE></HEAD>",BK
 W "<BODY  onkeyPress=""javascript: if (27 == event.keyCode) window.close();"" "_$$0^%ZAPM.ed.BSCh(3)_">",BK
 W "<CENTER>"_AF_O_EF
 I $G(@O@("OPT"))'=1,'$P($G(@O@("OPT")),",",2) W $$LNG^%ZAPM.ed.BSC4("В таблице опций",158)_" '"_O_"' "_$$LNG^%ZAPM.ed.BSC4("неправильный параметр",159)_BK D BACK^%ZAPM.ed.BSCh Q
 D OPT(O)
 D BSVAR
 w "<BR><input type=""hidden"" name=""BSNSP"" value="""_BSNSP_""">"
 w "<BR><input type=""hidden"" name=""BSLABEL"" value=""SAVE^~BSC4cfg"">"
 D BU2
 W "</form></CENTER>"
ENTE D END2^%ZAPM.ed.BSCh
 Q
BU2      w "<input type=""SUBMIT"" name=""SubMit1""  value=""Запомнить""> "
 w "<input type=""RESET"" name=""Reset1""  ONCLICK=""window.close();""  value=""Отменить"">"
 Q       
SAVE ;СОХРАНИТЬ НОВЫЕ ПАРАМЕТРЫ
 N O
 D VAR
 D SAVEOPT^%ZAPM.ed.BSC4cfg(O)
 D END2^%ZAPM.ed.BSCh
 q
TITLE(TBL) ;вывести заголовок
 I $G(@TBL@("OPT"))=1 Q $P($G(@TBL@(2,4)),"@",15)
 E  Q $P($G(@TBL),"@",1)
 Q
OPT(TBL,NOFORM) ;ФОРМА С ПАРАМЕТРАМИ
 W "<form action="""_$$ADDLIB^%ZAPM.ed.BSC4()_""" method=""POST"">"
 N BSLABEL,BSTOP,BSNSP1
 D ADDBSPOST^%ZAPM.ed.BSC4reg
 D BU2
 I '$D(@TBL@("OPT")) W $$LNG^%ZAPM.ed.BSC4("В таблице опций отсутствуют базовые параметры",160)_BK D BACK^%ZAPM.ed.BSCh G ENTE
 ;w "<input type=""hidden"" name=""BSROU"" value="""_$G(MainRef,"MAIN^~BSCh1")_""">"
 N I,II,P1,P2,P3,P4,P5,X,Y,S
 w BK,"<table border=0>",BK
 I $G(@TBL@("OPT"))'=1 S S=@$ZR F I=$S($P(S,",",3):$P(S,",",2),1:1):1 Q:'$D(@TBL@(I))  D  W BK
 .Q:'$P(S,",",2)  Q:'$P(S,",")
 .S P4=$P($G(@TBL@(I,+$P(S,",",1))),"@",15),P1=$P($G(@TBL@(I,+$P(S,",",2))),"@",15)
 .S P3=" SIZE=50 ",P5=$P($P($G(@TBL@(I,$P(S,",",2))),"@",18),"#")
 .I P4'="",$P($G(@TBL@(I,$P(S,",",2))),"@",5)="" D text1(P1,P3,P5)
 I $G(@TBL@("OPT"))=1 F I=3:1 Q:$P($G(@TBL@(I,2)),"@",15)=""  D  W BK
 .S P1=$P(@TBL@(I,1),"@",15),P2=$P(@TBL@(I,2),"@",15),P3=$P(@TBL@(I,3),"@",15)
 .S P4=$P(@TBL@(I,4),"@",15),P5=$P(@TBL@(I,5),"@",15)
 .D TAB
 I $$GETOPT(TBL,"NO")
 w "</table>"
 Q
TAB ;ТЕКУЩАЯ СТРОКА
 I P2="textarea" D  Q
 .W "<tr><td align=""right""><textarea name="""_$$name(P5)_""" "_P3_" >"_P1_"</textarea></td><td>",$$TEGS^%ZAPM.ed.BSre(P4),"</td></tr>"
 I P2="text" D text(P1,P3,P5) Q
 I P2="checkbox" D  Q
 .W "<tr><td align=""right""><input type=""checkbox"" name="""_$$name(P5)_""" value="""_P1_""" "_P3_$$ch(P1)_"></td><td>",$$TEGS^%ZAPM.ed.BSre(P4),"</td></tr>"
 I P2="radio" w "<p>",BK D  Q
 .F II=1:1:$L(P4,"~") W "<tr><td align=""right""><input type=""radio"" name="""_$$name(P5)_""" value="_II_" "_P3_$$ch(P1=II)_"></td><td>",$$TEGS^%ZAPM.ed.BSre($P(P4,"~",II)),"</td></tr>",BK
 .w "</p>"
 Q       
text(P1,P3,P5) W "<tr><td align=""right""><input type=""text"" name="_$$name(P5)_" "_P3_" value='"_P1_"'></td><td>",$$TEGS^%ZAPM.ed.BSre(P4),"</td></tr>"
 Q
text1(P1,P3,P5) W "<tr><td align=""right"">",$$TEGS^%ZAPM.ed.BSre(P4),"</td><td><input type=""text"" name="_$$name(P5)_" "_P3_" value='"_P1_"'></td></tr>"
 Q
name(P) ;ИМЯ КОМПОНЕНТЫ
 I P="" Q $QS(TBL,1)_I
 Q P
ch(P) I P q " checked "
 q ""
SAVEOPT(TBL) ;ПРИСВОЕНИЕ
 N I,C,N,S
 ;W "<BODY >",BK
 W "<BODY onload='window.close();'>",BK
 W "<CENTER>"
 W "<H3>"_$$LNG^%ZAPM.ed.BSC4("Опции запомнены",161)_"</H3>"
 
 W "<HR></CENTER>"
 I $G(@TBL@("OPT"))'=1 S S=@$ZR F I=$S($P(S,",",3):$P(S,",",2),1:1):1 Q:'$D(@TBL@(I))  D
 .Q:'$P(S,",",2)  Q:'$P(S,",")  Q:$P($G(@TBL@(I,$P(S,",",2))),"@",5)'=""
 .;S P4=$P($G(@TBL@(I,+$P(S,",",1))),"@",15),P1=$P($G(@TBL@(I,+$P(S,",",2))),"@",15)
 .S N=$P($P($G(@TBL@(I,$P(S,",",2))),"@",18),"#") i N="" s N=$QS(TBL,1)_I
 .I $TR($G(%KEY(N)),"@","")=$G(%KEY(N)) S $P(@TBL@(I,$P(S,",",2)),"@",15)=$G(%KEY(N)) Q
 .S $P(@TBL@(I,$P(S,",",2)),"@",15)=$TR($G(%KEY(N)),"@","") D PROT(N)
 
 I $G(@TBL@("OPT"))=1 F I=3:1 Q:$P($G(@TBL@(I,2)),"@",15)=""  D
 .S C=$P($G(@TBL@(I,2)),"@",15)
 .I $P($G(@TBL@(I,5)),"@",15)'="" S N=$P($G(@TBL@(I,5)),"@",15)
 .E  S N=$QS(TBL,1)_I
 .I C="checkbox" D  Q
 ..I $D(%KEY(N)) S $P(@TBL@(I,1),"@",15)=1
 ..E  S $P(@TBL@(I,1),"@",15)=0
 .I $TR($G(%KEY(N)),"@","")=$G(%KEY(N)) S $P(@TBL@(I,1),"@",15)=$G(%KEY(N)) Q
 .S $P(@TBL@(I,1),"@",15)=$TR($G(%KEY(N)),"@","") D PROT(N)
 Q
PROT(N) ;ЗАПИСЬ ЗАПРЕЩЕННОГО
 W "<br>"_$$LNG^%ZAPM.ed.BSC4("Параметр",162)_" '"_N_"' "_$$LNG^%ZAPM.ed.BSC4("имеет запрещенный символ",163)_" '@': "_RED_$G(%KEY(N))_EF_"<br>"
 W "<br>"_$$LNG^%ZAPM.ed.BSC4("Запомнили",164)_" : "_GREEN_$TR($G(%KEY(N)),"@","")_EF_"<br>"
 Q
GETOPT(TBL,NO,NK) ;ВОЗВРАТИТЬ ЗНАЧЕНИЕ ОПЦИИ NO
 ;NO - ИМЯ ПОКАЗАТЕЛЯ
 ;NK - НОМЕР КОЛОНКИ В ТАБЛИЦЕ 
 N N,I,Q S Q="?"
 try { ;в TBL может быть ссылка на несуществующую область
	 I $G(@TBL@("LST"),1)'=$G(@TBL@("OPT","LST")) D GREATINDX
 } catch e {}
 I $G(@TBL@("OPT","LST",NO))'="" S I=$G(@TBL@("OPT","LST",NO)) Q $P($G(@TBL@(I,$G(NK,1))),"@",15)
 F I=3:1 Q:$P($G(@TBL@(I,2)),"@",15)=""  D
 .I $P($G(@TBL@(I,5)),"@",15)'="" S N=$P($G(@TBL@(I,5)),"@",15)
 .E  S N=$QS(TBL,1)_I
 .I N=NO S Q=$P($G(@TBL@(I,$G(NK,1))),"@",15) Q
 Q Q
SETOPT(TBL,NO,Q,NK) ;ПРИСВОИТЬ ЗНАЧЕНИЕ ОПЦИИ NO=Q
 N N,I
 I $G(@TBL@("LST"),1)'=$G(@TBL@("OPT","LST")) D GREATINDX
 I $G(@TBL@("OPT","LST",NO))'="" S I=$G(@TBL@("OPT","LST",NO)),$P(@TBL@(I,$G(NK,1)),"@",15)=Q Q
 F I=3:1 Q:$P($G(@TBL@(I,2)),"@",15)=""  D
 .I $P($G(@TBL@(I,5)),"@",15)'="" S N=$P($G(@TBL@(I,5)),"@",15)
 .E  S N=$QS(TBL,1)_I
 .I N=NO S $P(@TBL@(I,$G(NK,1)),"@",15)=Q Q
 Q
GREATINDX //СОЗДАТЬ ИНДЕКС ПОКАЗАТЕЛЕЙ ОПЦИЙ
 S $ZT="ERRGREAT^%ZAPM.ed.BSC4cfg"
 K @TBL@("OPT","LST") S @TBL@("OPT","LST")=$G(@TBL@("LST"),1)
 F I=3:1 Q:$P($G(@TBL@(I,2)),"@",15)=""  D
 .I $P($G(@TBL@(I,5)),"@",15)'="" S N=$P($G(@TBL@(I,5)),"@",15)
 .E  S N=$QS(TBL,1)_I
 .S @TBL@("OPT","LST",N)=I
 Q
ERRGREAT Q
]]></Routine>


<Routine name="%ZAPM.ed.BSC4cfgP" type="MAC" languagemode="0"><![CDATA[
%BSC4cfgP ;БИБЛИОТЕКА ФУНКЦИЙ РАБОТЫ С ТАБЛИЦАМИ ПАРАМЕТРОВ ; 21:44   21.12.2002
 ;
 ;    Copyright (C) 2002 Serge W. Mikhaylenko
 ;    All Rights Reserved
 ;
 Q
A(TIT,BSBD,BSBD1,d,W,H) ;ЯКОРЬ
 N BSLABEL,BSMODE S BSLABEL="ENTER^~BSC4cfgP",BSMODE=d
 Q "<a name='Param1' title='"_BSBD_"' class=u1 "_$$on(BSLABEL)_" >"_TIT_"</a>"
on(BSLABEL) I $G(BSBD1)="" K BSBD1
 q " onclick='open("""_$$ADDBSGET^%ZAPM.ed.BSC4()_""",""Button"_$TR($G(BSSES),".","")_""",""toolbar=no,menubar=no,scrollbars=yes,width="_$G(W,800)_",height="_$G(H,500)_",status=1,resizable=1"");' "
B(TIT,BSBD,BSBD1,d,W,H) ;кнопка
 N BSLABEL,BSMODE,Q S BSLABEL="ENTER^~BSC4cfgP",BSMODE=d,Q=""
 S Q=Q_"<BUTTON name='Param1' "_$$on(BSLABEL)_" >"_TIT_"</BUTTON>"
 Q Q
BP(A1,A2,G1,G2,M,AN,IMG) //УНИВЕРСАЛЬНЫЙ ВЫЗОВ ПАРАМЕТРОВ
 N BSTITLE S BSTITLE=$$TR^%ZAPM.ed.BSsFUNM(A1," ","%20")
 I $G(AN)="" Q $$B("<img src='"_BSDOMAIN_"/img/"_$G(IMG,"param.gif")_"' ALT='"_A2_"'>",$$%T^%ZAPM.ed.BSCh(G1),$$%T^%ZAPM.ed.BSCh(G2),M)
 Q $$A("<img src='"_BSDOMAIN_"/img/"_AN_"' ALT='"_A2_"'>",$$%T^%ZAPM.ed.BSCh(G1),$$%T^%ZAPM.ed.BSCh(G2),M)
VARI //СОЗДАНИЕ ЛОКАЛЬНЫХ ПЕРМЕННЫХ
 S O=$$SW^%ZAPM.ed.BSF12($$%^%ZAPM.ed.BSCh(BSBD)),OO=$$SW^%ZAPM.ed.BSF12($$%^%ZAPM.ed.BSCh($G(BSBD1)))
 ;S ^%ZZZ(1)=O,^%ZZZ(2)=OO
 ;S ArrOUT=$$KBD^%ZAPM.ed.BSF12("^%ZAPM.ed.BSC4SNX(""OUT"")")
 Q
ENTER //
 D VARI
 D OPEN(O,OO,$G(BSMODE,0))
 Q
OPEN(O,OO,BSMODE) ;основной вход в таблицу опций
 ;MODE=0  ТОЛЬКО СМОТРЕТЬ ПАРАМЕТРЫ
 ;MODE=1  РЕДАКТИРОВАТЬ ПАРАМЕТРЫ
 ;MODE=2  РЕДАКТИРОВАТЬ И САМУ ТАБЛИЦУ ПАРАМЕТРОВ
 I OO="" S OO=O
 D BEG1^%ZAPM.ed.BSC4
 W "<TITLE> "_$$place(OO)_$$TITLE(OO)_" _________________________________</TITLE></HEAD>",BK
 W "<BODY onkeyPress=""javascript: if (27 == event.keyCode) window.close(); "">"_BK
 W "<CENTER>"
 D  //ПРОГРАММЫ ПРЕДОБРАБОТКИ
 .N OP,p1 
 .S OP="" F  S OP=$O(@O@(OP)) Q:OP=""  I $G(@O@(OP,"T"))="HR" S p1=$G(@O@(OP,"V")) I p1["^" D @p1
 D OPT(O,OO,BSMODE)
 ;w "<BR><input type=""hidden"" name=""BSNSP"" value="""_BSNSP_""">"
 ;w "<BR><input type=""hidden"" name=""BSLABEL"" value=""SAVE^~BSC4cfg"">"
 I '$D(NoBU2) D BU2 //ВЫВОДИТЬ ВТОРОЙ РАЗ КНОПКУ СОХРАНЕНИЯ
 W "</form></CENTER>"
 D END^%ZAPM.ed.BSC4 Q
ENTE D END2^%ZAPM.ed.BSCh
 Q
BU2 ;I BSMODE w "<input type=""SUBMIT"" name=""SubMit1""  value=""Запомнить""> "
 ;w "<input type=""RESET"" name=""Reset1""  ONCLICK=""window.close();""  value=""Отменить"">"
 ;w "<INPUT name=bSAV title='сохранить текущую коррекцию' TYPE='submit' VALUE='Запомнить'>"_BK
 w "<BUTTON tabindex=0 onclick='submit();' title='сохранить текущую коррекцию' VALUE='сохранить' ><IMG SRC='"_BSDOMAIN_"/img/save.gif'></BUTTON>"_BK
 W "<BUTTON onclick='window.close();' title='отменить текущее изменение'><IMG SRC='"_BSDOMAIN_"/img/del.gif' ></BUTTON>"_BK
 q
GetAcc(L,A) //ВОЗВРАТИТЬ ПРАВА ДОСТУПА ДЛЯ ПОЛЬЗОВАТЕЛЯ L К ПРИЛОЖЕНИЮ A 
 N BD,D,U
 ;S BD="^%ZAPM.ed.BSc4uSERS" ;
 S BD=$$KBD^%ZAPM.ed.BSF12("^%ZAPM.ed.BSC4(""PROTECT"")")
 S D=$$GETOPT($NA(@BD@(L,"FNM")),A,,"^[""%SYS""]BSC4.ISS.Access")
 I D'="" Q D  //СВОИ ПРАВА ИМЕЮТ НАИВЫСШИЙ ПРИОРИТЕТ
 S U=$G(@BD@(L,"ARRAY")) I U="" Q D
 I $G(GetAccLU(L))>2 Q D
 S GetAccLU(L)=$G(GetAccLU(L))+1 ;
 ;S ^%ZZZ($I(^%ZZZ))=A
 S U=$$GetAcc(U,A) //ПРАВА ЭКВИВАЛЕНТНОГО ПОЛЬЗОВАТЕЛЯ
 I D?1N,U?1N,D>U Q D  //ПРАВ ТОТ У КОГО БОЛЬШЕ ПРАВ
 I D?1N,U?1N,D'>U Q U
 Q U
place(T) Q $ZU(110)_"/"_$QS(T,-1)_"/"_$QS(T,0)_"/"_$QS(T,1)_"/"
TITLE(TBL) ;вывести заголовок БАЗЫ ДАННЫХ ТАБЛИЦЫ ПАРАМЕТРОВ
  N A S A=$P($G(@TBL),"@",4) I A="" S A=$G(BSTITLE)
  ;I A="" S A=$QS(TBL,1)
  Q A
OPT(TBL,OO,BSMODE) ;ФОРМА С ПАРАМЕТРАМИ
 W "<form name='first1' action="""_$$ADDLIB^%ZAPM.ed.BSC4()_""" method=""POST"">"
 N BSLABEL,BSTOP,BSNSP1,FirstNam
 I BSMODE S BSLABEL="SAVE^~BSC4cfgP"
 D ADDBSPOST^%ZAPM.ed.BSC4reg
 D BU2 W "<HR>"
 I $O(@TBL@(""))="" W "<DIV title='"_TBL_"'>В ШАБЛОНЕ опций '"_TBL_"' отсутствуют данные</DIV>"_BBK G ENTE
 N I,II,P1,P2,P3,P4,P5,X,Y,S,D,D2,D3,D4,OP,DIS
 w BK,"<table border=0>",BK
 S OP="",DIS="" I 'BSMODE S DIS=" disabled "
 F  S OP=$O(@TBL@(OP)) Q:OP=""  S P4=$G(@TBL@(OP,"O")),P3=$G(^("T")),D5=$G(^("D")),P1=$G(@OO@(OP,"V")) D
 .I P3="HR" W "</table><table width=100% border=0><tr><td align='center' class=s5>"_P4_"</td></tr></table><table>" Q
 .S D3=+P3,P2=$S(D3=1:"textarea",D3=2:"radio",D3=3:"checkbox",1:"text"),P5=OP I P1="" S P1=D5
 .S P3=$P(P3," ",2,99),D4=" title='"_OP_"' "_DIS I P3="" S P3=" size=50 "
 .D TAB
 w "</table><HR>"
 I '$D(FirstNam) Q
 W BK D JS^%ZAPM.ed.BSCp W BK
 w "first1."_FirstNam_".focus();"_BK
 D JSE^%ZAPM.ed.BSCp
 Q
TAB ;ТЕКУЩАЯ СТРОКА
 I D3=6 D  Q  //COMBOBOX
 .W BK_BK_"<tr><td align=""right"" class=s1 ><SELECT name="_$$name(P5,1)_" >"  D  W "</SELECT></td><td class=s1 >"_$P($$TEGS^%ZAPM.ed.BSre($P(P4,"~",1)),":")_"</td></tr>"
 ..N p4 S p4=P4 I P4[":" S p4=$P(P4,":",2,99) 
 ..F II=1:1:$L(p4,"~") W "<OPTION value="_II_" "_P3_D4_" "_$S(P1=II:"SELECTED",1:"")_" >"_$$TEGS^%ZAPM.ed.BSre($P(p4,"~",II))_"</OPTION>",BK
  I P2="textarea" D  Q
 .W "<tr><td align=""right"" class=s1 ><textarea name="_$$name(P5,1)_" "_$S(P3["size=50":" cols=50 rows=3 ",1:P3)_D4_" >"_P1_"</textarea></td><td class=s1 >",$$TEGS^%ZAPM.ed.BSre(P4),"</td></tr>"
 I P2="text" D text(P1,P3,P5) Q
 I P2="checkbox" D  Q
 .W "<tr><td align=""right"" class=s3 ><input type=""checkbox"" name="_$$name(P5)_" value="""_P1_""" "_P3_D4_$$ch(P1)_"></td><td class=s3 >",$$TEGS^%ZAPM.ed.BSre(P4),"</td></tr>"
 I P2="radio" w "<p>",BK D  Q
 .F II=1:1:$L(P4,"~") W "<tr><td align=""right"" class=s4 ><input type=""radio"" name="_$$name(P5)_" value="_II_" "_P3_D4_$$ch(P1=II)_"></td><td class=s4 >",$$TEGS^%ZAPM.ed.BSre($P(P4,"~",II)),"</td></tr>",BK
 .w "</p>"
 Q
text(P1,P3,P5) W "<tr><td align=""right"" class=s2 ><input type=""text"" name="_$$name(P5,1)_" "_P3_D4_" value='"_P1_"'></td><td class=s2 >",$$TEGS^%ZAPM.ed.BSre(P4),"</td></tr>"
 Q
name(P,T) ;ИМЯ КОМПОНЕНТЫ
 I P="" S P=$QS(TBL,1)_I
 I '$D(FirstNam),$d(T) S FirstNam=P
 Q "'"_P_"'"
ch(P) I P q " checked "
 q ""
SAVE ;СОХРАНИТЬ НОВЫЕ ПАРАМЕТРЫ
 D VARI
 D SAVEOPT(O,OO,$G(BSMODE,0))
 D END2^%ZAPM.ed.BSCh
 q
SAVEOPT(TBL,OO,BSMODE) ;ПРИСВОЕНИЕ
 I OO="" S OO=TBL
 N C,N,S,LABPRE,LABPOST,StopSave
 N I,II,P1,P2,P3,P4,P5,X,Y,S,D,D2,D3,D4,OP
 W "<BODY >",BK
 ;W "<BODY onload='window.close();'>",BK
 ;W "<CENTER>"
 ;W "<H3>"_$$LNG^%ZAPM.ed.BSC4("Опции запомнены",161)_"</H3>"
 ;W "<HR></CENTER>"
 Q:BSMODE<1
 S OP="" F  S OP=$O(@TBL@(OP)) Q:OP=""  S P4=$G(@TBL@(OP,"O")),D3=$G(^("T")),D5=$G(^("D")),P1=$G(@OO@(OP,"V")) D
 .I D3="HR" I D5["^" S LABPOST=D5 //ПОЛЬЗОВАТЕЛЬСКАЯ ПРОГРАММА ПОСТ-СОХРАНЕНИЯ ПАРАМЕТРОВ
 .S C=$S(D3=1:"textarea",D3=2:"radio",D3=3:"checkbox",1:"text"),N=OP
 .I C="checkbox" D SE($NA(@OO@(N,"V")),$S($D(%KEY(N)):1,1:0)) Q
 .D SE($NA(@OO@(N,"V")),$G(%KEY(N)))
 D SNX^%ZAPM.ed.BSChT1("S",OO,TBL,$$KBD^%ZAPM.ed.BSF12("^%ZAPM.ed.BSC4SNX(""OUT"")"))
 I $G(LABPOST)'="" D  Q:$G(StopSave)=2  I $G(StopSave) G ENTER
 .;D locvar^%ZAPM.ed.BSCh0("")
 .D @LABPOST
 W BK D JS^%ZAPM.ed.BSCp W BK
 w "window.close();"_BK
 D JSE^%ZAPM.ed.BSCp
 Q
SE(G,S) I S="" K @G Q
 S @G=S Q
GETOPT(TBL,NO,NK,SH) ;ВОЗВРАТИТЬ ЗНАЧЕНИЕ ОПЦИИ NO 
 ;NO - ИМЯ ПОКАЗАТЕЛЯ
 ;NK - другие поля параметра V D,O,T  имеет значение если TBL - ШАБЛОН
 ;SH - ШАБЛОН ОТКУДА БРАТЬ ЗНАЧЕНИЯ ПО-УМОЛЧАНИЮ
 I TBL=""!(NO="") Q ""
 S TBL=$$SW^%ZAPM.ed.BSF12(TBL)
 S NK=$G(NK,"V")
 I $D(SH),'$D(@TBL@(NO,NK)) Q $G(@SH@(NO,"D"))
 Q $G(@TBL@(NO,NK))
SETOPT(TBL,NO,NK,VAL) ;ПРИСВОИТЬ ЗНАЧЕНИЕ ОПЦИИ NO
 ;NO - ИМЯ ПОКАЗАТЕЛЯ
 ;NK - другие поля параметра V D,O,T имеет значение если TBL - ШАБЛОН
 I TBL=""!(NO="") Q ""
 I $G(NK)="" S NK="V"
 S NK=$G(NK,"V")
 S TBL=$$SW^%ZAPM.ed.BSF12(TBL)
 D SE($NA(@TBL@(NO,NK)),VAL)
 Q
Save123 //СОХРАНЕНИЕ ОБЩЕСИСТЕМНЫХ ПАРАМЕТРОВ (СИНИЙ МОЛОТОК)
 S A=$$GETOPT^%ZAPM.ed.BSC4cfgP("^%ZAPM.ed.BSETUP(""ISS"")","Atkweb")
 I A'="" S $P(^%ZAPM.ed.BSpgWEBC("Control"),",",7)=A
 S A=$$GETOPT^%ZAPM.ed.BSC4cfgP("^%ZAPM.ed.BSETUP(""ISS"")","Aterm")
 I A'="" S $P(^%ZAPM.ed.BSpgBS("Control"),",",7)=A
 S A=$$GETOPT^%ZAPM.ed.BSC4cfgP("^%ZAPM.ed.BSETUP(""ISS"")","Atmdapi")
 I A'="" S ^%ZAPM.ed.BSCmdapicfg("port")=A
 S A=$$GETOPT^%ZAPM.ed.BSC4cfgP("^%ZAPM.ed.BSETUP(""ISS"")","Atkmail")
 I A'="" D
 .K ^%ZAPM.ed.BSpgWEM("HOST"),^%ZAPM.ed.BSpgWEMM("HOST") S ^%ZAPM.ed.BScSMTP($ZCONVERT($ZU(110),"U"),"POP")=$P(A,",",2),^%ZAPM.ed.BScSMTP($ZCONVERT($ZU(110),"U"),"SMTP")=$P(A,",",1)
 .S ^%ZAPM.ed.BSpgWEM("HOST",$ZCONVERT($ZU(110),"U"))=A,^%ZAPM.ed.BSpgWEMM("HOST",$ZCONVERT($ZU(110),"U"))=A
 .S ^%ZAPM.ed.BSpgWEM("HOST")=$ZCONVERT($ZU(110),"U"),^%ZAPM.ed.BSpgWEMM("HOST")=$ZCONVERT($ZU(110),"U")
 i $P($g(%BS(44)),",",1) D SYSMSG^%ZAPM.ed.BSCek("User: "_$g(BSLOGIN)_" Change System Parametrs.","W")
 // w $$w2f^%ZAPM.ed.BSCp2("N:\!\FnameSYS.LOG")
 D Tex^%ZAPM.ed.BSMSMF("ChangeSysParametrs","")
 Q
Save1234 //СОХРАНЕНИЕ ПАРАМЕТРОВ ПРАВ ДОСТУПА ПОЛЬЗОВАТЕЛЯ (ЧЕРНЫЙ МОЛОТОК)
 S A=$G(@OO@("Amail","V")),NM=$QS(OO,1),NMU=$ZCONVERT($QS(OO,1),"U") //?????
 S SN=$ZCONVERT($ZU(110),"U")
 I A D
 .S ^%ZAPM.ed.BSpgWEM("USER",NM)=$QS(OO,1)
 .S ^%ZAPM.ed.BSpgWEM("USER",NMU)=$QS(OO,1)
 .S ^%ZAPM.ed.BSpgWEM("HOST")=SN
 I 'A K ^%ZAPM.ed.BSpgWEM("USER",NM),^%ZAPM.ed.BSpgWEM("USER",NMU) ;В ПРОТИВНОМ СЛУЧАЕ УДАЛИМ ...
 
 K ^%ZAPM.ed.BSpgWEMM("HOST"),^%ZAPM.ed.BSpgWEMM("USER") 
 M ^%ZAPM.ed.BSpgWEMM("HOST")=^%ZAPM.ed.BSpgWEM("HOST")
 M ^%ZAPM.ed.BSpgWEMM("USER")=^%ZAPM.ed.BSpgWEM("USER")
 i $P($g(%BS(44)),",",1) D SYSMSG^%ZAPM.ed.BSCek("User: "_$g(BSLOGIN)_" ChangeUserParametrs For: "_NM_".","W")
 
 // w $$w2f^%ZAPM.ed.BSCp2("N:\!\Fname.LOG")
 
 D Tex^%ZAPM.ed.BSMSMF("ChangeUserParametrs","For: "_NM)
 Q
 
]]></Routine>


<Routine name="%ZAPM.ed.BSC4demon" type="MAC" languagemode="0"><![CDATA[
%BSC4demon ; ФОНОВЫЙ ПРОЦЕС СИСТЕМНЫХ РАБОТ (СУПЕРВИЗОР,МУСОРЩИК...) ; 15:36   05.09.2002
 ;
 ;    Copyright (C) 2002 Serge W. Mikhaylenko
 ;    All Rights Reserved
 ;
 Q
START D GTmp
 L +%BSDemon:0 E  H
 S CFG="^[""%SYS""]BSC4.CFG.DemonCFG"
 S CMD="^[""%SYS""]BSC4.CFG.DemonCMD"
 k @GTmp 
 ;S $ZT="Err"
 s $P(@GTmp,"~",1)=$$TD^%ZAPM.ed.BSC4base($H) //ВРЕМЯ СТАРТА ДЕМОНА
 S BDSES=$$KBD^%ZAPM.ed.BSF12("^%ZAPM.ed.BSC4(""SESSIONS"")")
 S BDRouRef=$$KBD^%ZAPM.ed.BSF12("^%ZAPM.ed.BSC4(""RouRef"")")
 S BSPIN="%BSdemon"
 I $D(BSLOGIN) S BSLOGIN="%BSdeamon"
  S @GTmp@(1)=BDSES
 D MAINVAR^%ZAPM.ed.BSC4
  S @GTmp@(2)=RED
1 HANG $G(@CFG@("Interval","Val"),1) //ЦИКЛ С ИНТЕРВАЛОМ
 S C="" F  S C=$O(@CMD@(C))  Q:C=""  D
 .I $$HoldActivate Q
 .S If=$G(@CMD@(C,"If"),0),Cmd=$G(@CMD@(C,"Cmd"),"Dummy")
 .w "." D
 ..;w !,"CMD: "_"I "_If_" D "_Cmd  ;S @GTmp@($H)="CMD: "_"I "_If_" D "_Cmd 
 ..X "I "_If_" D "_Cmd_" w !,$$TD^%ZAPM.ed.BSC4base($H)_"" ""_Cmd" //КОМАНДА ПРИ УСЛОВИИ
 G 1
 ;Err S @GTmp@($H)=$ZE
 Q
GTmp S GTmp="^[""%SYS""]mtemp.Demon"
 Q       
Report //сделать новый отчет по ресурсам
 ;ЗАПУСК ПОДСЧЕТА У КОГО СКОЛЬКО БАЙТ НАТИКАЛО
 D RR^%ZAPM.ed.BSC4rout
 Q
ReportNewDay() S BDSTAT="^[""%SYS""]BSC4.CFG.UStatus("""_$ZD($H,8)_""")"
 i '$d(@BDSTAT) q 1
 Q 0
NewDay(BDS) I $G(BDS)="" Q 0
 i '$d(@BDS) S @BDS=$H q 1
 Q 0
RouRefCheck //Контроль потерянных ссылок на программы
 S I="" F  S I=$O(@BDRouRef@(I)) Q:I=""  S n1=$G(@BDRouRef@(I,"Name")),n2=$G(@BDRouRef@(I,"Namespace")) D
 .I $$EXIST^%R(n1_".MAC",n2) Q
 .I $$EXIST^%R(n1_".INT",n2) Q
 .k @BDRouRef@(I)
 q
SessCheck //Контроль незакрытых сессий
 S KS=$G(@CFG@("Sess","Val"),20)*60 //Сколько минут не закрывать насильно, брошенную сессию
 S KD=$G(@CFG@("SessDay","Val"),3) //Сколько дней не удалять ссылку на сессию
 I $D(BSLOGIN) S BSLOGIN="%BSdeamon"
 S I="" F  S I=$O(@BDSES@(I)) Q:I=""  S CHR=$G(@BDSES@(I,"CHR")),CUR=$G(@BDSES@(I,"CUR")) D
 .w !,"ceссия "_I  
 .i CHR'="" w " закрыта "_$$TD^%ZAPM.ed.BSC4base(CHR)
 .e  w " не закрыта"
 .I CHR'="" D  Q  //УДАЛЕНИЕ ЗАКРЫТЫХ СЕССИЙ
 ..s ra=$H-CHR w " if "_ra_">"_KD
 ..I (ra>KD) D  K @BDSES@(I) w " удаляем ",$zr D DelUser^%ZAPM.ed.BSCp("",I) Q
 ...//СУММИРОВАНИЕ СЧЕТЧИКОВ В БАЗУ ДАННЫХ ВИЗИТОВ
 ...D Tex^%ZAPM.ed.BSMSMF("EraseSess",$G(@BDSES@(I,"OHR"))_","_$G(@BDSES@(I,"COUNT"))_","_$G(@BDSES@(I,"CUR"))_","_$G(BSLOGIN)_","_$G(I))
 .s ra1=$H*86400+$P($H,",",2),ra2=(CUR*86400+$P(CUR,",",2)) w " if ("_ra1_"-"_ra2_")>"_KS
 .I (ra1-ra2)>KS S @BDSES@(I,"CHR")=$H w " закрываем ",$zr D DelUser^%ZAPM.ed.BSCp("",I) //НАСИЛЬНОЕ ЗАКРЫТИЕ СЕССИИ
 q
 ;S (^mtempBSsinx,^mtempBSprot)=1 //СБРОС СИСТЕМНЫХ СЧЕТЧИКОВ
RJCheck() //проверить есть ли команды в глобали
 n i
 s i="" f  s i=$O(@GTmp@(i)) q:i=""   i $G(@GTmp@(i))=0 j RJExe^%ZAPM.ed.BSC4demon($na(@GTmp@(i)))::0 //Запустить процесс
 q 1
RJExe(zr) //выполнить команду
 i $I(@zr)=1 x $g(@zr@("cmd"))
 Q       
SessTimeHour() //Срабатывать в начале каждого часа
 S CT=$P($h,",",2)\3600
 I CT'=$G(CTIME) S CTIME=CT Q 1
 Q 0
EvTimeSec(CTIMEm,M) //Срабатывать КАЖДЫЕ М СЕКУНД
 S CTm=$P($h,",",2)\$G(M,60)
 I CTm'=$G(@CTIMEm) S @CTIMEm=CTm Q 1
 Q 0
HoldActivate() Q $G(@CFG@("Hold","Val"),0) //задержать работу Демона
Halt H  //остановить Демон - задание снять
HaltActivate() Q $G(@CFG@("Halt","Val"),0)
Check(S) //проверка подвисших заданий (сек разрешено выполняться)
 Q
CheckKJ(JOB) N ONSP S ONSP=$ZU(5) I $$ZU^%ZAPM.ed.BSF4("%SYS")
 S RET=$$INT^RESJOB(JOB) //УДАЛИТЬ ПОДВИСШЕЕ ЗАДАНИЕ
 I $$ZU^%ZAPM.ed.BSF4(ONSP)
 Q
Dummy Q
STATUS ;СТАТУС ТАЙМЕРА
 L +%BSDemon:0 I  W !,"%BS-Demon NOT ACTIVE." Q
 W !,"%BS-Demon ALLREADY STARTED."
 Q
]]></Routine>


<Routine name="%ZAPM.ed.BSC4r" type="MAC" languagemode="0"><![CDATA[
%BSC4r ;Трансляция и контроль кода ; 15:37   05.09.2002
 ;
 ;    Copyright (C) 2002 Serge W. Mikhaylenko
 ;    All Rights Reserved
 ;
DelBS ;УДАЛИТЬ ВЕСЬ ИСХОДНЫЙ КОД КОМПЛЕКСА
 S I="%BS" D  F  S I=$O(^ROUTINE(I)) Q:I'["%BS"  D
 .D DelSours(I)
 Q
DelSours(ro) K ^ROUTINE(ro,0),^rMAC(ro,0) ;УДАЛИТЬ ИСХОДНЫЙ ТЕКСТ
 Q
DelBSAll ;УДАЛИТЬ ВЕСЬ КОМПЛЕКС
 I '$$ZU^%ZAPM.ed.BSF4("%SYS") Q
 //I $ZU(5,"%SYS")="" Q
 S I="^%ZAPM.ed.BS" D  F  S I=$O(^$GLOBAL(I)) Q:I'["^%ZAPM.ed.BS"  D
 .K @I
 S I="%BS" D  F  S I=$O(^rINC(I)) Q:I'["%BS"  D
 .K ^rINC(I)
 S I="%BS" D  F  S I=$O(^ROUTINE(I)) Q:I'["%BS"  I I'=$ZN D
 .D DEL1^%ZAPM.ed.BSC4r4(I_".*")
 X "D DEL1^%ZAPM.ed.BSC4r4($ZN_"".*"")"
 Q
XECUTE(CODE)
 N pin,Rou S pin="Temp",Rou=BSRoutineId
 I $$CheckRou^%ZAPM.ed.BSC4base1(CODE) D @("^"_pin_"."_Rou),DEL1^%ZAPM.ed.BSC4r4(pin_"."_Rou_".*") Q
 Q
GetResultRef(A,F) ;возвратить результат ссылки
 i $e(A,1)="^" q $$GetTableBS^%ZAPM.ed.BSCi($P(A,":",1),$P(A,":",2),$P(A,":",3),$P(A,":",4),$P(A,":",5)) ;это таблица/текст %BS
 i $e(A,1)="/"!($e(A,1,4)="HTTP")!($e(A,1,4)="http") q $$onLOAD(A,F) ;создание страницы с JS кодом на загрузку A-URL
 i $e(A,1,6)="DoMaIn" q $$onLOAD($$TR^%ZAPM.ed.BSsFUNM(A,"DoMaIn",BSDOMAIN),F) ;--//--
 i A'="^%" q @A
 q A
onLOAD(A,F) ;
 N Q S Q="<HTML><HEAD>"_$$meta^%ZAPM.ed.BSC4_BK
 S Q=Q_"<script LANGUAGE=""JavaScript""><!--"_BK
 S Q=Q_"function ReSet() {"_BK
 ;S Q=Q_"alert('"_A_"');"_BK
 S Q=Q_"parent."_F_".location='"_A_"';"_BK
 S Q=Q_"}"_BK
 S Q=Q_"// --></script>"_BK
 S Q=Q_"</HEAD>"_BK
 S Q=Q_"<BODY onload='ReSet();'>"_BK
 S Q=Q_"</BODY></HTML>"_BK
 Q Q
href(C) ;СГЕНЕРИТЬ CGI ПЕРЕМЕННЫЕ В ФОРМАТЕ GET
 Q $$add^%ZAPM.ed.BSC4rou_C
GetTabProp(P,T,NF) //ВОЗВРАТИТЬ ЗНАЧЕНИЕ СВОЙСТВ ПОЛЯ
 Q "ПОКА ТАК!"
GetDirTabFile(P,T,Key,NF,FILE) //ВОЗВРАТИТЬ ПУТЬ И ИМЯ ФАЙЛА ЛЕЖАЩЕЕ В ПОЛЕ, ЕСЛИ ПОЛЕ - FILESTREAM
 N FF,FN1,FN2,PTab
 S FF=$$GetDirectTab(P,T,.Key,NF) I FF="" Q ""
 S FN2=$$GETOPT^%ZAPM.ed.BSC4cfgP($NA(@PTab@("Parms")),"DF"),FN1=$$GETOPT^%ZAPM.ed.BSC4cfgP($NA(@PTab@("ParmsCell",NF)),"xSubDir")
 S FN2=##class(%File).NormalizeDirectory(FN2_FN1)_FF
 I $D(FILE) S FILE(1)=FN2
 I $ZU(140,4,FN2)'=0 Q ""
 I $D(FILE) S FILE(2)=$$GETOPT^%ZAPM.ed.BSC4cfgP($NA(@PTab@("Parms")),"WF")_FN1_FF
 Q FN2
GetDirectTabN1(P,T,A,NF)
 N Key
 S Key=1,Key(1)=A
 Q $$GetDirectTab(P,T,.Key,NF)
GetDirectTabN2(P,T,A1,A2,NF)
 N Key
 S Key=2,Key(1)=A1,Key(2)=A2
 Q $$GetDirectTab(P,T,.Key,NF)
GetDirectTabN3(P,T,A1,A2,A3,NF)
 N Key
 S Key=3,Key(1)=A1,Key(2)=A2,Key(3)=A3
 Q $$GetDirectTab(P,T,.Key,NF)
GetDirectTabN4(P,T,A1,A2,A3,A4,NF)
 N Key
 S Key=4,Key(1)=A1,Key(2)=A2,Key(3)=A3,Key(4)=A4
 Q $$GetDirectTab(P,T,.Key,NF)
GetDirectTabN5(P,T,A1,A2,A3,A4,A5,NF)
 N Key
 S Key=5,Key(1)=A1,Key(2)=A2,Key(3)=A3,Key(4)=A4,Key(5)=A5
 Q $$GetDirectTab(P,T,.Key,NF)
GetDirectTabN6(P,T,A1,A2,A3,A4,A5,A6,NF)
 N Key
 S Key=6,Key(1)=A1,Key(2)=A2,Key(3)=A3,Key(4)=A4,Key(5)=A5,Key(6)=A6
 Q $$GetDirectTab(P,T,.Key,NF)
GetDirectTab(P,T,Key,NF) //ВОЗВРАТИТЬ ЗНАЧЕНИЕ ПОЛЯ КОНКРЕТНОЙ ЗАПИСИ
 N GL,K,KK,G
 i NF="" ZT "SUBSC"
 D GL
 //i GL["%" ZT "%Prot"
 ;W pin,0,G,1 ZW Key
 F K=1:1:Key Q:'$D(Key(K))  I Key(K)'="" S G=$NA(@G@(Key(K)))
 ;ZW Key
 S KK=$G(@G@(NF))
 Q KK
GL I $E(P,1)="^" S PTab=$NA(@P@(T)),G=$$KBD^%ZAPM.ed.BSF12(PTab) Q
 I '$D(%ZName) S GL="^"_P_"."_T,PTab=$NA(@("^"_P)@(T))
 E  S GL="^"_$P($P(%ZName,"."),"^",2)_"."_P_"."_T,PTab=$NA(@("^"_$P($P(%ZName,"."),"^",2)_"."_P)@(T)) i GL["%" ZT "%Prot"
 S G=GL
 Q
KillDirectTab(P,T,Key)
 N GL,K,KK,G
 D GL
 //i GL["%" ZT "%Prot"
 F K=1:1:Key Q:'$D(Key(K))  I Key(K)'="" S G=$NA(@G@(Key(K)))
 K @G
SetDirectTab(P,T,Key,NF,VAL)
 N GL,K,KK,G
 i NF="" ZT "SUBSC"
 D GL
 //i GL["%" ZT "%Prot"
 F K=1:1:Key Q:'$D(Key(K))  I Key(K)'="" S G=$NA(@G@(Key(K)))
 S @G@(NF)=VAL
 Q 1
ORDEr(P,T,Key,Node,Nap)
 N GL,K,KK,G
 D GL
 //i GL["%" ZT "%Prot"
 F K=1:1:Key-1 Q:'$D(Key(K))  I Key(K)'="" S G=$NA(@G@(Key(K)))
 S KK=$O(@G@(Node),Nap)
 ;I KK="" Q Node
 Q KK
RO(R,L) //ЗАПУСК ПРОГРАММ
 D @(L_"^"_R)
    Q
DoRou(P,R,L)
 N GL
 S GL=$P($P(%ZName,"."),"^",2)_"."_P_"."_R //это только в B4Y
 i GL["%" q
 D @(L_"^"_GL)
    Q
DDATA(S) ;$D
 I S["^" ZT "^Prot"
 I S["@" ZT "@Prot"
 Q $D(@S)
DGET(S) ;$G
 I S["^" ZT "^Prot"
 I S["@" ZT "@Prot"
 Q $G(@S)
DSET(S,V) ;SET @S=V
 ;w S," ",V," "
 I S["^" ZT "^Prot"
 I S["@" ZT "@Prot"
 S @S=V Q
DKILL(S) ;kill @S        ;w S," ",V," "
 I S["^" ZT "^Prot"
 I S["@" ZT "@Prot"
 k @S Q
DynSQLprep(SQL,%qHandle)        n %st S %st=##class(%DynamicQuery).SQLPrepare(.%qHandle,SQL) q:+%st'=1 %st      S %st=##class(%DynamicQuery).SQLExecute(.%qHandle) q %st
DynSQLfetch(%qHandle,%row,%stop)   D ##class(%DynamicQuery).SQLFetch(.%qHandle,.%row,.%stop) Q %stop
DynSQLColInfo(%COL,%qHandle)    D ##class(%DynamicQuery).SQLGetInfo(.%COL,.%PAR,.%IDI,.%qHandle) Q ""
DynSQLcol(%COL,%num)            Q $L($LI(%COL,%num),1)
DynSQLrow(%row,%num)            Q $LI(%row,%num)
DynSQLclose(%qHandle)            d ##class(%DynamicQuery).SQLClose(.%qHandle) Q ""
 
beg(tit) q "<html><HEAD>"_BK_$$STYLE^%ZAPM.ed.BSC4_BK_"</HEAD><title>"_tit_"</title>"
NumADD W $$beg(""_$$LNG^%ZAPM.ed.BSC4("Текст программы на языке",165)_" Cache'ObjectScript") I BSTMP["|" S BSTMP=$TR(BSTMP,"|",$C(34))
 N S,K,I,L,LA,LAB,Z0,Z1,Z2,Z3,Z4
 S S=$G(@BSTMP),K=$L(S,BK)
 S Z1="<strong title='"_$$LNG^%ZAPM.ed.BSC4("Коментарий программы",324)_"'>",Z0="</strong>"
 S Z2="<strong title='"_$$LNG^%ZAPM.ed.BSC4("SQL - утверждение COS программы",325)_"'>"
 S Z3="<strong title='"_$$LNG^%ZAPM.ed.BSC4("Метка программы",326)_"'>"
 S Z4="<strong title='"_$$LNG^%ZAPM.ed.BSC4("Макрос HTML кода",327)_"'>"
 W "<TT>" S BL=0,LA=0,LAB=""
  F I=1:1:K S L=$$TR^%ZAPM.ed.BSsFUNM($$TR^%ZAPM.ed.BSsFUNM($P(S,BK,I),"<","&lt;"),">","&gt;") D  S L(I+1)=L,LA=LA+1,L(I+1,0)=$G(LAB)_"+"_LA
  .I L["&html" S L=BLUE_Z4_L_Z0_EF S BL=1 Q
  .I L="&gt;" S L=BLUE_Z4_L_Z0_EF S BL=0 Q
  .I BL S L=BLUE_Z4_L_Z0_EF Q
  .I $E(L,1)=" " S L="&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"_L
  .E  S LAB=$P(L," ",1),L=RED_Z3_$P(L," ",1)_Z0_EF_" "_$P(L," ",2,999),LA=-1
  .I L[" ;" S L=$P(L," ;",1)_GREEN_Z1_" ;"_$P(L," ;",2,999)_Z0_EF
  .I L[" //" S L=$P(L," //",1)_GREEN_Z1_" //"_$P(L," //",2,999)_Z0_EF
  .I L["&sql" S L=$P(L,"&sql",1)_MAROON_Z2_"&sql"_$P(L,"&sql",2,999)_Z0_EF
  s I="" f  s I=$o(L(I)) q:I=""  W "<NOBR><a title='"_$G(L(I,0))_"'>",I,") </a>",L(I),"</NOBR><BR>",BK
  W "</TT></html>"
 Q
KeyWord W $$beg(""_$$LNG^%ZAPM.ed.BSC4("вывод списка ЗАРЕЗЕРВИРОВАННЫХ СЛОВ",166)_"")
 N S,K,I S S=$$KBD^%ZAPM.ed.BSF12("^%ZAPM.ed.BSC4(""Keywords"")")
  w "<h3>"_$$LNG^%ZAPM.ed.BSC4("Список зарезервированных системой слов",167)_"</H3>",BBK,BBK
  s I="" f K=1:1 s I=$o(@S@(I)) q:I=""  W "<LI> ",RED,I,EF," ",GREEN,$G(@S@(I,"Description")),EF,"</LI>",BBK
  W "</html>"
  Q
Protect W $$beg(""_$$LNG^%ZAPM.ed.BSC4("вывод списка запрещенных команд",168)_"")
 N S,K,I S S=$$KBD^%ZAPM.ed.BSF12("^%ZAPM.ed.BSC4(""SafeCode"")")
  w "<h3>"_$$LNG^%ZAPM.ed.BSC4("Запрещены следующие команды и символы",169)_"</H3>",BBK,BBK
  s I="" f K=1:1 s I=$o(@S@(I)) q:I=""  W "<LI>  ",RED,I,EF," ",GREEN,$G(@S@(I,"Description")),EF,"</LI>",BBK
  W "</html>"
  Q
Security(S) ;проверка на небезопастный код COS
 N B,i,I,K
 S BDSC=$$KBD^%ZAPM.ed.BSF12("^%ZAPM.ed.BSC4(""SafeCode"")"),S=$$LITL^%ZAPM.ed.BSsFUNM(S)
 s K=$L(S,BK)
 F I=1:1:K S S(I)=$P(S,BK,I)
 S S(0)=K K Sec
 s i="" f  s i=$o(@BDSC@(i)) q:i=""  I S[i F I=1:1:K I S(I)[i S Sec(I)=$$TR^%ZAPM.ed.BSsFUNM($$TR^%ZAPM.ed.BSsFUNM(S(I),"<","&lt;"),">","&gt;"),Sec(I)=$$TR^%ZAPM.ed.BSsFUNM(Sec(I),i,RED_i_EF)
 I $D(Sec) D  Q 0
 .s i="" f  s i=$o(Sec(i)) q:i=""  W i+1,") ",Sec(i),BBK
 Q 1
%R ;entery points
 ; #; This function currently assumes the calling parameters are valid.
 ; #; parameters:
 ; #;   rou - name.ext.ver of the routine to compile
 ; #;   .array - array of source code; array(0)=lines, array(1-n)=source
 ; #;   .err - errors detected ($LIST format, call $$FMTERR to display)
 ; #;   options:
 ; #;     L - Load saved routine into 'array' parameter
 ; #;     C - Compile
 ; #;     D - Delete source
 ; #;     S - Save
 ; #;     B - create Backup copy when saving MAC,INC routines
 ; #;     M - generate routine map (INTERNAL OPTION ONLY)
 ; #;     I - Bypass <PROTECT> errors (INTERNAL OPTION ONLY)
 ; #;   langmode - language mode, 0-9 (optional)
 ; #;   filedate - datestamp to be used (optional)
 ; #;   nsp - desired namespace (optional)
 ; #; return:
 ; #;   1 for success; 0 for failure if any of the specified options do not succeed
 ; #;     The return value also concatenates the status of each specified option.
 ; #;     The format of the return value is: 0/1 ^ , status1, status2, status3...
ROUTINE(rou,array,err,options,langmode,filedate,nsp)
 ;
 ; ...
 ; #; This function syntax checks INT source code
 ; #;   src - source (INT) code;
 ; #;         either a single line stored in a variable, or
 ; #;         an array where: array(0)=#lines, array(1-n)=source
 ; #;   .err - errors detected ($LIST format, call $$FMTERR to display)
 ; #;   langmode - language mode, 0-9 (optional)
 ; #; return:
 ; #;   1 for success; 0 for failure (syntax errors found)
CHECK(src,err,langmode) ;
 ;
 ; ...
 ; #; Get save date/time
 ; #; parameters:
 ; #;   rou - name.ext of the routine to fetch date for
 ; #;   fmt - $ZDateTime format of date/time returned (0-12, optional);
 ; #;          0 58142,34718 [default]
 ; #;          1 03/09/2000 09:37:35
 ; #;          2 09 Mar 2000 09:37:35
 ; #;          3 2000-03-09 09:37:35
 ; #;          4 09/03/2000 09:37:35
 ; #;          5 Mar 9, 2000 09:37:35
 ; #;          6 Mar 9 2000 09:37:35
 ; #;          7 Mar 09 2000 09:37:35
 ; #;          8 20000309 09:37:35
 ; #;          9 March 9, 2000 09:37:35
 ; #;          10 4 09:37:35
 ; #;          11 Thu 09:37:35
 ; #;          12 Thursday 09:37:35
 ; #;   nsp - namespace (optional)
 ; #; return: routine save date/time
DATE(rou,fmt,nsp)
 ;
 ; ...
 ; #; Delete a routine
 ; #; parameters:
 ; #;   rou - name.ext[.ver] of the routine to delete;
 ; #;         name.* will delete all types of routine code
 ; #;   nsp - namespace (optional)
 ; #; return: none
DEL(rou,nsp)
 ; ...
 ; #; Determine whether routine exists
 ; #; parameters:
 ; #;   rou - name.ext[.ver] of the routine to fetch language mode
 ; #;   nsp - namespace to check (optional)
 ; #; return: 0/1
EXIST(rou,nsp)
 ; ...
 ; #; Return language mode
 ; #; parameters:
 ; #;   rou - name.ext[.ver] of the routine to fetch language mode
 ; #;   nsp - namespace to check (optional)
 ; #; return: 0 = Cache ObjectScript
 ; #;         1 = DSM-11
 ; #;         2 = DTM
 ; #;         3 = Ipsum
 ; #;         4 = Cobra
 ; #;         5 = DSM-VMS
 ; #;         6 = DSM-J
 ; #;         7 = DTM-J
 ; #;         8 = MSM
 ; #;         9 = Cache Basic
LANG(rou,nsp)
 ; ...
 ; #; Set language mode
 ; #; parameters:
 ; #;   rou - name.ext of the routine to set language mode
 ; #;   lang - language mode
 ; #; return: 1/0 (success/fail)
LANGSET(rou,lang)
 ; ...
 ; #; Get # of routine lines
 ; #; parameters:
 ; #;   rou - name.ext[.ver] of the routine to fetch language mode
 ; #;   nsp - namespace to check (optional)
 ; #; return: # of lines
LENGTH(rou,nsp)
 ; ...
 ; #; Get a single routine line
 ; #; parameters:
 ; #;   rou - name.ext of the routine
 ; #;   lnum - number of line to fetch
 ; #;   nsp - namespace to check (optional)
 ; #; return: routine line
LINE(rou,lnum,nsp)
 ; ...
 ; #; Set a routine line
 ; #; parameters:
 ; #;   rou - name.ext of the routine
 ; #;   lnum - number of line to fetch
 ; #;   line - line to set
 ; #; return: 1/0 (sucess/failure)
LINESET(rou,lnum,line)
 ; ...
 ; #; Get a bunch of routine names and, optionally, routine info
 ; #; parameters:
 ; #;   mask - routine wildcard.extension selection mask
 ; #;          valid extensions:
 ; #;              SRC = MAC/INT,INC source code (default)
 ; #;              COS = MAC/INT source code
 ; #;              BAS = BASIC source code
 ; #;              MAC = MACRO source code
 ; #;              INT = INTERMEDIATE source code
 ; #;              INC = INCLUDE source code
 ; #;              OBJ = OBJECT code
 ; #;              * = ALL code
 ; #;          (e.g. A*.INT;B*.MAC;'C*;D*.*;E*.COS;F*.SRC)
 ; #;   size - # of routines to fetch
 ; #;   detail - return detailed data in data buffer (0/1)
 ; #;   .data - routine information ($LIST format)
 ; #;           if detail=0: data = $LIST(routine1.ext,routine2.ext,...)
 ; #;           if detail=1: data = $LIST($LIST(routine1.ext,date,size,lang),...)
 ; #;   .ctx - context information for subsequent call to $$LIST,
 ; #;           (i.e. set ctx=0 for first call, ctx=1 for subsequent calls)
 ; #;   nsp - namespace (optional)
 ; #; return: 1 if more routines can be fetched; 0 if no more routines
LIST(mask,size,detail,data,ctx,nsp)
 ; ...
 ; #; Lock a routine
 ; #; parameters:
 ; #;   rou - name.ext of the routine to lock
 ; #;   timeout - lock timeout, optional (default=2 seconds)
 ; #; return: lock status (1 - locked; 0 - not locked)
LOCK(rou,timeout)
 ; ...
 ; #; Unlock a routine
 ; #; parameters:
 ; #;   rou - name.ext of the routine to lock
 ; #; return: none
UNLOCK(rou)
 ; ...
 ; #; Get next routine (i.e. $Order)
 ; #; parameters:
 ; #;   from - starting point
 ; #;           (i.e. "" for first call, rtn.ext for subsequent calls)
 ; #;   nsp - namespace (optional)
 ; #; return: next routine.exe[.ver]; "" if no more routines
NEXT(from,nsp)
 ; ...
 ; #; Get routine size
 ; #; parameters:
 ; #;   rou - name.ext[.ver] of the routine to fetch size (version is optional)
 ; #;   nsp - namespace to check (optional)
 ; #; routine = routine size (# characters)
SIZE(rou,nsp)
 ; ...
 ; #; Get the maximum # of versions to keep (backups + master)
 ; #; parameters:
 ; #;   type - routine type (MAC,INC,BAS,etc)
 ; #;   nsp - namespace to check (optional)
 ; #; return: max # versions
VERMAX(type,nsp)
 ; ...
 ; #; Set the maximum # of versions to keep (backups + master)
 ; #; parameters:
 ; #;   type - MAC or INC
 ; #;   nsp - namespace to check (optional)
 ; #; return: none
VERMAXSET(type,max,nsp)
 ; ...
 ; #; Get a backup version # from a relative version #
 ; #; parameters:
 ; #;   rou - name.ext[.ver] of the routine to fetch language mode (version is optional)
 ; #;         The version # can be a relative #.  For example, routine.MAC.-1 will
 ; #;         return the most recent backup version #.
 ; #;   nsp - namespace to check (optional)
 ; #; return: version #
VERSION(rou,nsp)
 ; ...
 ; #; Get the first (oldest) backup version #
 ; #; parameters:
 ; #;   rou - name.ext of the routine to fetch language mode
 ; #;   nsp - namespace to check (optional)
 ; #; return: oldest backup version #
VERSION1(rou,nsp)
 ; ...
 ; #; Format an error list:
 ; #; This function will format an error for display by converting it
 ; #; from $LIST($LIST) format to either a string, delimited by $c(13,10),
 ; #; or a local array to be passed back in the 'out' parameter.  If 'out'
 ; #; is defined it populates the array, otherwise it creates a string
 ; #; which is passed back as the return value.
 ; #; parameters:
 ; #;   e - $LIST($LIST) errors
 ; #;   .src - source code array, if this is defined it will show the line
 ; #;          of source code where the error occurred.
 ; #;   .out - return detailed data in out() array instead of the function
 ; #;          return value
 ; #; return: error text, if .out parameter is undefined
FMTERR(e,src,out)
 Q
 /*
 Set rtn=$$ParseRoutineHeader^%R(rtn,.type) Set:type="" type="INT"
 Set:m["." m=$$ParseRoutineName^%R(m,.e),e=$s(e="*":"",e="SRC":".INC.MAC.INT.BAS",e="":"",1:"."_e)
 If $e(ROU)="%" && ($e($zu(5),1,2)'="^^") && ('$$CheckPercentRoutineChange^%R(ROU,EXT))
 */
]]></Routine>


<Routine name="%ZAPM.ed.BSC4r1" type="MAC" languagemode="0"><![CDATA[
%BSC4r1 ;HELPER PROJECT
 ;
 ;    Copyright (C) 2002 Serge W. Mikhaylenko
 ;    All Rights Reserved
 ;
 Q
CREAT(pi,BSPRO) ;СОЗДАТЬ ПРОЕКТ "Документация"
 ;i $zu(5,"%SYS")
 I '$D(@("^"_pi_".PRO")@(BSPRO,"REM")) S @("^"_pi_".PRO")@(BSPRO,"REM")=$$LNG^%ZAPM.ed.BSC4("Документация",59)_" ..."
 S pin=pi_"."_BSPRO
 I '$D(@("^"_pin)) S @("^"_pin)="BaSe MsW @"_$$LNG^%ZAPM.ed.BSC4("Документация",59)_" ..."
 M @("^"_pin_"(""ROU"")")=^%ZAPM.ed.BSC4E("ROU")
 M @("^"_pin_"(""Tree"")")=^["%SYS"]BSC4.DOC("Tree")
 S @("^"_pin)@("Tree","Compile")="Save "_$$TD^%ZAPM.ed.BSC4base
 F I=1:1:3 M @("^"_pin_"(""Content"_I_""")")=^["%SYS"]BSC4.DOC("Content"_I) S @("^"_pin)@("Content"_I,"Compile")="Save "_$$TD^%ZAPM.ed.BSC4base
 M @("^"_pin_"(""Param"")")=^["%SYS"]BSC4.DOC("Param") S @("^"_pin)@("Param","Compile")="Save "_$$TD^%ZAPM.ed.BSC4base
 S @("^"_pin)@("ROU","KEY")="^"_pin_".ROU"
 M @("^"_pin_".ROU")=^["%SYS"]BSC4.DOC.ROU
 F I="ViewMenu","EditMenu" D                             //ЧИСТКА СТАРЫХ ССЫЛОК
 .S II=$P($G(@("^"_pin_".ROU(I,""ROU"")")),"=",2)
 .S @("^"_pin_".ROU(I,""HTM"")")=$$TR^%ZAPM.ed.BSsFUNM($G(@("^"_pin_".ROU(I,""HTM"")")),"BSNSP=~SYS&BSPRO=DOC&BSRoutineId="_II,"BSNSP="_BSNSP_"&BSPRO="_BSPRO_"&BSRoutineId=????????")
 .K ^("STA"),^("ROU")
 .S @("^"_pin_".ROU(I,""COS"")")=$$TR^%ZAPM.ed.BSsFUNM($G(@("^"_pin_".ROU(I,""COS"")")),"BSNSP=~SYS","BSNSP="_BSNSP)
 F I=1:1:3 S @("^"_pin)@("Content"_I,"KEY")="^"_pin_".Content"_I
 S @("^"_pin)@("Tree","KEY")="^"_pin_".Tree"
 F I=1:1:3 S @("^"_pin_".Content1")@(I,"Descr")=""_$$LNG^%ZAPM.ed.BSC4("Пункт меню",170)_" "_I F I2=10:1:13 S II="Y"_I_"F"_I2,@("^"_pin_".Content2")@(II,"Descr")=""_$$LNG^%ZAPM.ed.BSC4("Подменю",171)_" "_II  F II2=100:1:103 S III="T"_I_"P"_II_"S"_II2,@("^"_pin_".Tree")@(I,II,III,"zero")=7,@("^"_pin_".Content3")@(III,"Descr")=""_$$LNG^%ZAPM.ed.BSC4("Статья",172)_" "_III
 S @("^"_pin)@("Param","KEY")="^"_pin_".Param"
 M @("^"_pin_".Param")=^["%SYS"]BSC4.DOC.Param
 S @("^"_pin_".Param(""HEADER"",""Val"")")=$$BIGL^%ZAPM.ed.BSsFUNM(@("^"_pin_".Param(""HEADER"",""Descr"")"))
 S newTP="Navigator" F I=1:1:3 D Navigator^%ZAPM.ed.BSC4rou(pin,"EditContent"_I,"Content"_I)
 S newTP="Navigator" D Navigator^%ZAPM.ed.BSC4rou(pin,"EditParam","Param")
 Q
 ;D Helper(pin,"EditMenu","Tree")
 ;D TreeMenu(pin,"ViewMenu","Tree")
 
 ;ОТКЛЮЧИТЬ
TreeMenu(pin,Rou,Tab) Q  I $G(Tab)="" G TabEmpty^%ZAPM.ed.BSC4rou
 S newTP="TreeMenu^%ZAPM.ed.BSC4r1"
 D MST^%ZAPM.ed.BSC4rou S V=" "_$$LNG^%ZAPM.ed.BSC4("Просмотр пунктов меню ",173)
 S @("^"_pin_".ROU")@(Rou,"REM")=V
 n BSSES,BSLOGIN,BSLABEL,BSG,BSGRANT,BSTOP
 S BSG="B4",BSRoutineId="????????"
 n C,H,T1,T2,I,TA,RT,PT,TAB,K,KI,Y,TN,A,GetField
 s C="ViewTree ; "_$$say2^%ZAPM.ed.BSC4rou_V_BK_$$hr^%ZAPM.ed.BSC4rou_BK
 D
 .N BSRoutineId F I="T","C","D" S BSLABEL="Tree"_I S A(I)=$$ADDBSGET^%ZAPM.ed.BSC4("")
 S C=C_" &html<"_BK
 S C=C_"<html><head><title>"_V_"</title>"_BK_$$meta^%ZAPM.ed.BSC4()_BK
 S C=C_"</head>"_BK
 S C=C_"<frameset framespacing=0 frameborder='1' rows='*,83%'>"_BK
 S C=C_"  <frame SRC="""_A("T")_"&BSRoutineId=#(BSRoutineId)#"" noresize name='TITLE2' SCROLLING='no'>"_BK
 S C=C_" <frameset  framespacing='0' border='false' frameborder='1' cols='*,60%'>"_BK
 S C=C_"  <frame SRC="""_A("C")_"&BSRoutineId=#(BSRoutineId)#"" name='CONTENT2' noresize SCROLLING='auto'>"_BK
 S C=C_"  <frame SRC="""_A("D")_"&BSRoutineId=#(BSRoutineId)#"" name='DESCRIPT2' noresize SCROLLING='auto'>"_BK
 S C=C_" </frameset>"_BK
 S C=C_"</frameset>"_BK
 S C=C_"</html>"_BK
 S C=C_">"_BK
 S C=C_" Q  "_BK
 S C=C_"H1() Q ""<html><head>""_BK "_BK
 S C=C_"H2() Q ""</head><body>""_BK "_BK
 S C=C_"H3() Q ""</body></html>""_BK "_BK
 S C=C_"TreeT ; "_$$hr^%ZAPM.ed.BSC4rou_BK
 S C=C_" W $$H1"_BK
 S C=C_" W $$$GetDirectTabN1("""_BSPRO_""",""Param"",""TITLE"",""Val"")"_BK
 S C=C_" W $$$Meta(1251)"_BK
 S C=C_" W $$H2"_BK
 S C=C_" W ""<H3><center>""_$$$GetDirectTabN1("""_BSPRO_""",""Param"",""HEADER"",""Val"")_""</center></H3><br>"" "_BK
 S C=C_" W ""<div align='right'>| <a target='DESCRIPT2' ""_$$ah(""Find"")_"""_$$LNG^%ZAPM.ed.BSC4("Поиск",175)_"</a>"" "_BK
 S C=C_" W "" | <a target='CONTENT2' ""_$$ah(""Indx"")_"""_$$LNG^%ZAPM.ed.BSC4("Индексы",176)_"</a>"" "_BK
 S C=C_" W "" | <a target='CONTENT2' ""_$$ah(""TreeC"")_"""_$$LNG^%ZAPM.ed.BSC4("Содержание",177)_"</a> |</div>"" "_BK  
 S C=C_" W $$H3"_BK
 S C=C_" Q"_BK  
 S C=C_"Find ;"_$$LNG^%ZAPM.ed.BSC4("Поисковый модуль для документации",328)_" "_$$hr^%ZAPM.ed.BSC4rou_BK
 S C=C_" W 1 Q"_BK  
 S C=C_"Indx ;"_$$LNG^%ZAPM.ed.BSC4("Формировать индексы документации по ключевым словам",329)_" "_$$hr^%ZAPM.ed.BSC4rou_BK
 S C=C_" W $$H1,$$$GetDirectTabN1("""_BSPRO_""",""Param"",""CONTENT"",""Val""),$$H2,BK "_BK
 S C=C_" Q"_BK
 S C=C_"ah(L) ;"_BK
 S C=C_" N BSLABEL S L=""&BSLABEL=""_L"_BK
 S C=C_" q ""href='""_$$$href(L)_""' >"" "_BK
 S C=C_"TreeC ; "_$$hr^%ZAPM.ed.BSC4rou_BK
 S C=C_" W $$H1,$$$GetDirectTabN1("""_BSPRO_""",""Param"",""CONTENT"",""Val""),BK,$$$GetDirectTabN1("""_BSPRO_""",""Param"",""JSMENU"",""Val""),BK"_BK
 S C=C_" W ""<style type='text/css'>""_BK"_BK
 S C=C_" W ""  UL.toc LI {list-style-image:url("_BSDOMAIN_"/img/bclose.gif)}""_BK"_BK
 S C=C_" W ""  UL.toc LI.open {list-style-image:url("_BSDOMAIN_"/img/bopen.gif)}""_BK"_BK
 S C=C_" W ""</style>""_BK"_BK
 S C=C_" W $$$Meta(1251)"_BK
 S C=C_" &html<"_BK
 S C=C_"</head><body ONCLICK='return false'>"_BK
 S C=C_"<UL CLASS='toc' ONCLICK='outliner();' ONSELECTSTART='return false;' ONMOUSEOVER='mouseEnters();' ONMOUSEOUT='mouseLeaves();' ONKEYPRESS='checkChar(event.srcElement);'>"_BK
 S C=C_">"_BK    
 D
 .N BSRoutineId,BStop S BSLABEL="TreeDesc" S A=$$ADDBSGET^%ZAPM.ed.BSC4("")
 S C=C_" N K1,K2,K3,Key1,Key2,Key3 "_BK
 S C=C_" W BK S K1="""",Key1=1,Key1(1)="""" F  S K1=$$$ORDER("""_BSPRO_""",""Tree"",.Key1,K1,1) Q:K1=""""  D  "_BK
 S C=C_" .W ""<LI><A ONCLICK='parent.DESCRIPT2.location="""""_A_"""_$$C3(K1)_"""""";' ""_$$C2(K1,1)_"">""_$$C1(K1,1)_""</A><UL>""_BK "_BK
 S C=C_" .S K2="""",Key2=2,Key2(1)=K1,Key2(2)=""""  F  S K2=$$$ORDER("""_BSPRO_""",""Tree"",.Key2,K2,1) Q:K2=""""  D  "_BK
 S C=C_" ..W "" <LI STYLE='list-style-image: URL("_BSDOMAIN_"/img/bopen1.gif)'><A ONCLICK='parent.DESCRIPT2.location="""""_A_"""_$$C3(K1,K2)_"""""";' ""_$$C2(K2,2)_"">""_$$C1(K2,2)_""</A><UL>""_BK "_BK
 S C=C_" ..S K3="""",Key3=3,Key3(1)=K1,Key3(2)=K2,Key3(3)=""""  F  S K3=$$$ORDER("""_BSPRO_""",""Tree"",.Key3,K3,1) Q:K3=""""  D  "_BK
 S C=C_" ...W ""  <LI STYLE='list-style-image: URL("_BSDOMAIN_"/img/bopen2.gif)'><A ONCLICK='parent.DESCRIPT2.location="""""_A_"""_$$C3(K1,K2,K3)_"""""";' ""_$$C2(K3,3)_"">""_$$C1(K3,3)_""</A></LI>""_BK "_BK
 S C=C_" ..W "" </UL></LI>""_BK "_BK  
 S C=C_" .W ""</UL></LI>""_BK "_BK
 S C=C_" W ""</UL>""_BK "_BK
 S C=C_" W $$H3"_BK
 S C=C_" Q"_BK
 S C=C_"Topic(K,Nu) ;"_$$LNG^%ZAPM.ed.BSC4("СОДЕРЖАНИЕ ПУНКТА",178)_BK
 S C=C_" W $$$GetDirectTabN1("""_BSPRO_""",""Content""_Nu,K,""Html"")_BK"_BK
 S C=C_" N A S A=$$$GetDirectTabN1("""_BSPRO_""",""Content""_Nu,K,""Refer"")"_BK
 S C=C_" ;I A'="""" W $$$GetTableBS($P(A,"":"",1),$P(A,"":"",2),$P(A,"":"",3),$P(A,"":"",4),$P(A,"":"",5))_BK"_BK
 S C=C_" I A'="""" W $$$GetResultRef(A,""DESCRIPT2"")_BK"_BK
 S C=C_" Q"_BK
 S C=C_"TreeDesc ;"_$$LNG^%ZAPM.ed.BSC4("ПРОГРАММА ОТОБРАЖЕНИЯ СОДЕРЖАНИЯ ПУНКТА ",179)_BK
 S C=C_" I $G(BSK3)'="""" D Topic(BSK3,3) Q"_BK
 S C=C_" I $G(BSK2)'="""" D Topic(BSK2,2) Q"_BK
 S C=C_" I $G(BSK1)'="""" D Topic(BSK1,1) Q"_BK
 S C=C_" //N K1,K2,K3,Key1,Key2,Key3 "_BK
 S C=C_" //S K3="""",Key3=3,Key3(1)=BSK1,Key3(2)=BSK2,Key3(3)=""""  F  S K3=$$$ORDER("""_BSPRO_""",""Tree"",.Key3,K3,1) Q:K3=""""  D  "_BK
 S C=C_" //.D Topic(K3,3) w ""<br>"" "_BK
 S C=C_" Q"_BK
 S C=C_"C3(K1,K2,K3) ;"_$$LNG^%ZAPM.ed.BSC4("ПОДГОТОВКА CGI-ПЕРЕМЕННЫХ",180)_BK
 S C=C_" N A S A=""&BSRoutineId=""_BSRoutineId"_BK
 S C=C_" S A=A_""&BSK1=""_K1"_BK
 S C=C_" I $D(K2) S A=A_""&BSK2=""_K2"_BK
 S C=C_" I $D(K3) S A=A_""&BSK3=""_K3"_BK
 S C=C_" Q A "_BK
 S C=C_"C1(K,Nu) ;"_$$LNG^%ZAPM.ed.BSC4("ТЕКСТ ПУНКТА",181)_BK
 S C=C_" N A S A=$$$GetDirectTabN1("""_BSPRO_""",""Content""_Nu,K,""Descr"")"_BK
 S C=C_" I A="""" S A=K"_BK
 S C=C_" Q A "_BK
 S C=C_"C2(K,Nu) ;"_$$LNG^%ZAPM.ed.BSC4("КОМЕНТАРИЙ ПУНКТА",182)_BK
 S C=C_" N A S A=$$$GetDirectTabN1("""_BSPRO_""",""Content""_Nu,K,""FDescr"")"_BK
 S C=C_" I A="""" S A=K"_BK
 S C=C_" Q "" title='""_A_""' "" "_BK
 S C=C_"TreeD ; "_$$hr^%ZAPM.ed.BSC4rou_BK
 S C=C_" W $$H1,$$$GetDirectTabN1("""_BSPRO_""",""Param"",""DESCRIPT"",""Val""),$$H2"_BK
 S C=C_" W $$$Meta(1251)_BK"_BK
 S C=C_" W ""</head><body>"" "_BK
 S C=C_" W 1211"_BK  
 S C=C_" W ""</body></html>"" "_BK
 S C=C_" Q"_BK  
 S C=C_"ViewTNF ; "_$$hr^%ZAPM.ed.BSC4rou_BK
 S C=C_" W !!! "_BK    
 S C=C_" Q"_BK 
 ;-----------------------------------------
 s H="<!-- "_$$say1^%ZAPM.ed.BSC4rou_" -->"_BK
 S H=H_$$VAR^%ZAPM.ed.BSC4rou(1,"ViewTree"),BSLABEL="ViewTree"
 S H=H_"<a href="_$$add^%ZAPM.ed.BSC4rou_">"_$$LNG^%ZAPM.ed.BSC4("Загрузить Просмотр пунктов меню (Вариант с фрэймами)",183)_"</a>"_BK
 S H=H_$$VAR^%ZAPM.ed.BSC4rou(2,"ViewTNF"),BSLABEL="ViewTNF"
 S H=H_"<a href="_$$add^%ZAPM.ed.BSC4rou_">"_$$LNG^%ZAPM.ed.BSC4("Загрузить Просмотр пунктов меню (Вариант без фрэймов)",184)_"</a>"_BK
 S H=H_"</center>"_BK
 s H=H_$$end^%ZAPM.ed.BSC4rou
 g Save^%ZAPM.ed.BSC4rou
         ;ОТКЛЮЧИТЬ
Helper(pin,Rou,Tab) Q    I $G(Tab)="" G TabEmpty^%ZAPM.ed.BSC4rou
 S newTP="Helper^%ZAPM.ed.BSC4r1"
 D MST^%ZAPM.ed.BSC4rou S V=" "_$$LNG^%ZAPM.ed.BSC4("Редактор пунктов меню ",185)
 S @("^"_pin_".ROU")@(Rou,"REM")=V
 n BSSES,BSLOGIN,BSLABEL,BSG,BSGRANT,BSTOP
 S BSG="B4",BSRoutineId="????????"
 n C,H,T1,T2,I,TA,RT,PT,TAB,K,KI,Y,TN,GetField
 s C="Navigator ; "_$$say2^%ZAPM.ed.BSC4rou_V_BK_$$hr^%ZAPM.ed.BSC4rou_BK
 S C=C_" set Home1=1 // "_$$LNG^%ZAPM.ed.BSC4("заголовок страницы",186)_BK     
 S C=C_"Navig1 ; "_$$hr^%ZAPM.ed.BSC4rou_BK
 S C=C_" set Header="""_V_""" // "_$$LNG^%ZAPM.ed.BSC4("заголовок страницы",186)_BK  
 S C=C_" set Max=$$$CoutFeild("""_BSPRO_""","""_Tab_""") //"_$$LNG^%ZAPM.ed.BSC4("количество полей",187)_BK
 S C=C_" set MaxI=$$$CoutIndxFeild("""_BSPRO_""","""_Tab_""") //"_$$LNG^%ZAPM.ed.BSC4("количество индексированных полей",188)_BK
 S C=C_" D $$$DKILL(""Dis"") // "_$$LNG^%ZAPM.ed.BSC4("удалить массив признака опции",189)_" DISABLE"_BK
 S C=C_" D $$$DKILL(""STOP"") "_BK
 S C=C_" for Num=1:1:MaxI D  Q:$G(STOP)=1  G:$G(STOP)=2 Navigator  //"_$$LNG^%ZAPM.ed.BSC4("цикл по индексным полям",190)_BK
 S C=C_"    .D KKey(Num)  "_BK
 S C=C_"    .IF $$$DDATA(""Home""_Num) D $$$DSET(""Home""_(Num+1),1) D $$$DSET(""value""_Num,$$$ORDER("""_BSPRO_""","""_Tab_""",.Key,"""",1)) D CheckL Q:$D(STOP)  "_BK
 S C=C_"    .IF $$$DDATA(""End""_Num) D $$$DSET(""Home""_(Num+1),1) D $$$DSET(""value""_Num,$$$ORDER("""_BSPRO_""","""_Tab_""",.Key,"""",-1)) D CheckR "_BK
 S C=C_"    .IF $$$DDATA(""Del""_Num) D $$$DKILL(""Del""_Num) D $$$DSET(""Left""_Num,1) D $$$KillDirectTab("""_BSPRO_""","""_Tab_""",.Key) D  //"_$$LNG^%ZAPM.ed.BSC4("удалить узел ",191)_BK
 S C=C_"    ..D $$$DKILL(""Ke1""),$$$DSET(""Ke1(1)"",$$$DGET(""value""_Num)) S Ke1=1 D $$$KillDirectTab(""DOC"",""Content""_Num,.Ke1) "_BK
 S C=C_"    .IF $$$DDATA(""Left""_Num) D $$$DSET(""Home""_(Num+1),1) D $$$DSET(""value""_Num,$$$ORDER("""_BSPRO_""","""_Tab_""",.Key,$$$DGET(""value""_Num),-1)) D CheckL Q:$D(STOP)  "_BK
 S C=C_"    .IF $$$DDATA(""Right""_Num) D $$$DSET(""Home""_(Num+1),1) D $$$DSET(""value""_Num,$$$ORDER("""_BSPRO_""","""_Tab_""",.Key,$$$DGET(""value""_Num),1)) D CheckR "_BK
 S C=C_"    .S Dis(Num,1)=($$$ORDER("""_BSPRO_""","""_Tab_""",.Key,$$$DGET(""value""_Num),-1)="""") "_BK
 S C=C_"    .S Dis(Num,2)=($$$ORDER("""_BSPRO_""","""_Tab_""",.Key,$$$DGET(""value""_Num),1)="""") "_BK
 S C=C_" &html<"_BK
 S C=C_"<html><title>#(Header)#</title>"_BK_$$STYLE^%ZAPM.ed.BSC4()_BK
 S C=C_"<body><center>"_BK
 D 
 .N BSRoutineId
 .S C=C_""_$$form^%ZAPM.ed.BSC4rou("NameForm")
 S C=C_"<input type='hidden' name='BSLABEL' value='Navig2'>"_BK
 S C=C_"<table border=0>"_BK
 S C=C_">"_BK
 S C=C_"   D $$$DSET(""Key(Key)"",$$$DGET(""value""_Num)) //"_$$LNG^%ZAPM.ed.BSC4("присвоить значение последнего индекса",192)_" "_BK
 S C=C_"    IF $D(Save) D  //"_$$LNG^%ZAPM.ed.BSC4("присвоить исправления",193)_BK
 S C=C_"     .for Num=1:1:MaxI D  "_BK   
 S C=C_"     ..n w,a s w=1,w(1)=$$$DGET(""value""_Num)"_BK
 S C=C_"     ..IF w(1)'="""" D  "_BK
 S C=C_"     ...S a=$$$DGET(""DescU""_Num) i $$$SetDirectTab("""_BSPRO_""",""Content""_Num,.w,""Descr"",a)"_BK
 S C=C_"     ...S a=$$$DGET(""FDescU""_Num) i $$$SetDirectTab("""_BSPRO_""",""Content""_Num,.w,""FDescr"",a)"_BK
 S C=C_"     ...S a=$$$DGET(""ReferU""_Num) i $$$SetDirectTab("""_BSPRO_""",""Content""_Num,.w,""Refer"",a)"_BK
 S C=C_"     ...S a=$$$DGET(""HtmlU""_Num) i $$$SetDirectTab("""_BSPRO_""",""Content""_Num,.w,""Html"",a)"_BK
 S C=C_"     ...S a=$$$DGET(""KeyWordsU""_Num) i $$$SetDirectTab("""_BSPRO_""",""Content""_Num,.w,""KeyWords"",a)"_BK
 S C=C_"     .for Num=(MaxI+1):1:Max D  //"_$$LNG^%ZAPM.ed.BSC4("цикл по всем неиндексным полям",194)_BK
 S C=C_"     ..set var1=$$$GetFeild("""_BSPRO_""","""_Tab_""",Num) //"_$$LNG^%ZAPM.ed.BSC4("взять все атрибуты текущего поля",195)_BK
 S C=C_"     ..set NameFeild=$P(var1,""~"",1) //"_$$LNG^%ZAPM.ed.BSC4("вычленить имя поля",196)_BK
 S C=C_"     ..IF $$$SetDirectTab("""_BSPRO_""","""_Tab_""",.Key,NameFeild,$$$DGET(""value""_Num)) //"_$$LNG^%ZAPM.ed.BSC4("присвоим в прямом доступе",197)_BK
 S C=C_"   for Num=1:1:Max {  //"_$$LNG^%ZAPM.ed.BSC4("цикл по всем полям",198)_BK
 S C=C_"     set var1=$$$GetFeild("""_BSPRO_""","""_Tab_""",Num) //"_$$LNG^%ZAPM.ed.BSC4("взять все атрибуты текущего поля",195)_BK
 S C=C_"     set NameFeild=$P(var1,""~"",1) //"_$$LNG^%ZAPM.ed.BSC4("вычленить имя поля",196)_BK
 S C=C_"     set Description=$P(var1,""~"",2),CLASS="""" s:'(Num#2) CLASS="" class=s3 "" //"_$$LNG^%ZAPM.ed.BSC4("вычленить описание поля",199)_BK
 S C=C_"     write ""<tr>"" //"_$$LNG^%ZAPM.ed.BSC4("вывести описание",200)_BK
 S C=C_"     if $P(var1,""~"",4)'="""" D  //"_$$LNG^%ZAPM.ed.BSC4("эти поля индексные",201)_BK
 S C=C_"       .W ""<td align='right'""_CLASS_""><input type='submit' name='Del""_Num_""' title='"_$$LNG^%ZAPM.ed.BSC4("удалить узел",202)_" ""_$SELECT(Num=MaxI:"""",1:"""_$$LNG^%ZAPM.ed.BSC4("со всеми потомками высших уровней",203)_""")_""' value='"_$$LNG^%ZAPM.ed.BSC4("Удалить",119)_"'>&nbsp;<input type='submit' ""_$$Disable(Num,1)_"" name='Home""_Num_""' value='&lt;&lt;'><input type='submit' name='Left""_Num_""' ""_$$Disable(Num,1)_"" value='&lt;'></td>"""_BK
 S C=C_"     if Num=(MaxI+1) w ""<tr><td><hr></td><td><hr></td><td></td><td><hr></td></tr><td align='right'""_CLASS_""><input type='submit' name='Save' value='"_$$LNG^%ZAPM.ed.BSC4("Сохранить",109)_"'></td>"" "_BK
 S C=C_"     if Num=(MaxI+2) w ""<td align='right'""_CLASS_""><input type='Reset' name='Reset' value='"_$$LNG^%ZAPM.ed.BSC4("Отменить",204)_"'></td>"" "_BK
 S C=C_"     if Num>(MaxI+2) w ""<td""_CLASS_""></td>"""_BK
 S C=C_"     if $P(var1,""~"",4)="""" D  //"_$$LNG^%ZAPM.ed.BSC4("эти поля неиндексные",205)_BK
 S C=C_"       .D $$$DSET(""value""_Num,$$$GetDirectTab("""_BSPRO_""","""_Tab_""",.Key,NameFeild)) //"_$$LNG^%ZAPM.ed.BSC4("прямой доступ к данным таблицы, когда знаешь индексы",206)_BK
 S C=C_"     write ""<td""_CLASS_""><input type='text' size=10 maxlength=2048 title='""_NameFeild_""' name='value""_Num_""' value='""_$$$DGET(""value""_Num)_""'></td>"""_BK
 S C=C_"     S var2=""<td align='left'""_CLASS_"">"" "_BK
 S C=C_"     if $P(var1,""~"",4)'="""" D  //"_$$LNG^%ZAPM.ed.BSC4("эти поля индексные",201)_BK
 S C=C_"       .S var2=var2_""<input type='submit' name='Right""_Num_""' ""_$$Disable(Num,2)_"" value='&gt;'><input type='submit' ""_$$Disable(Num,2)_"" name='End""_Num_""' value='&gt;&gt;'>"" "_BK
 S C=C_"     w var2_""</td>"""_BK
 S C=C_"     write $$DDD()_""</tr>"" "_BK
 S C=C_"     }"_BK
 S C=C_" write ""<input type='hidden' name='BSRoutineId' value='""_BSRoutineId_""'>"""_BK
 S C=C_" &html<"_BK
 S C=C_"</table></form></center>"_BK
 S C=C_"</body></html>"_BK
 S C=C_">"_BK
 ;S C=C_" D TREE ;D $$$DoRou("""_BSPRO_""",""NewRoutin3"",""Variables1"") Q  "_BK
 S C=C_" quit"_BK
 S C=C_"DDD()    n a,a1,a2,a3,a4,a5,w     s w=1,w(1)=$$$DGET(""value""_Num) Q:Num>MaxI ""<td align='LEFT'""_CLASS_""></td><td align='LEFT'""_CLASS_""></td>"" "_BK
 S C=C_" s a=$$$GetDirectTab("""_BSPRO_""",""Content""_Num,.w,""Descr"")"_BK
 S C=C_" s de=$p($$$GetFeild("""_BSPRO_""",""Content""_Num,""Descr""),""~"",2)"_BK
 S C=C_" S a1=""<div><textarea title='""_de_""' name='DescU""_Num_""' cols=20 rows=1>""_a_""</textarea>"_$$LNG^%ZAPM.ed.BSC4("описание",207)_"</div>"""_BK
 
 S C=C_" s a=$$$GetDirectTab("""_BSPRO_""",""Content""_Num,.w,""FDescr"")"_BK
 S C=C_" s de=$p($$$GetFeild("""_BSPRO_""",""Content""_Num,""FDescr""),""~"",2)"_BK
 S C=C_" S a2=""<div><textarea title='""_de_""' name='FDescU""_Num_""' cols=20 rows=3>""_a_""</textarea>"_$$LNG^%ZAPM.ed.BSC4("полное описание",208)_"</div>"""_BK
 
 S C=C_" s a=$$$GetDirectTab("""_BSPRO_""",""Content""_Num,.w,""Refer"")"_BK
 S C=C_" s de=$p($$$GetFeild("""_BSPRO_""",""Content""_Num,""Refer""),""~"",2)"_BK
 S C=C_" S a3=""<div><textarea title='""_de_""' name='ReferU""_Num_""' cols=30 rows=1>""_a_""</textarea>"_$$LNG^%ZAPM.ed.BSC4("ссылка",209)_"</div>"""_BK
 
 S C=C_" s a=$$$GetDirectTab("""_BSPRO_""",""Content""_Num,.w,""KeyWords"")"_BK
 S C=C_" s de=$p($$$GetFeild("""_BSPRO_""",""Content""_Num,""KeyWords""),""~"",2)"_BK
 S C=C_" S a5=""<div><textarea title='""_de_""' name='KeyWordsU""_Num_""' cols=20 rows=1>""_a_""</textarea>"_$$LNG^%ZAPM.ed.BSC4("Ключевые слова",210)_"</div>"""_BK
 
 S C=C_" s a=$$$GetDirectTab("""_BSPRO_""",""Content""_Num,.w,""Html"")"_BK
 S C=C_" s de=$p($$$GetFeild("""_BSPRO_""",""Content""_Num,""Html""),""~"",2)"_BK
 S C=C_" S a4=""<div><textarea title='""_de_""' name='HtmlU""_Num_""' cols=50 rows=10>""_a_""</textarea>html</div>"""_BK
 
 S C=C_" Q ""<td align='LEFT'""_CLASS_"">""_a1_a2_a3_a5_""</td><td align='LEFT'""_CLASS_"">""_a4_""</td>"" "_BK
 S C=C_"CheckL //"_$$LNG^%ZAPM.ed.BSC4("проверить значение ключей",211)_BK
 S C=C_" if $$$DGET(""value""_Num)="""" D $$$DSET(""value""_Num,$$$ORDER("""_BSPRO_""","""_Tab_""",.Key,"""",1)) d  "_BK
 S C=C_" .if $$$DGET(""value""_Num)="""" D  "_BK
 S C=C_" ..I Num=1 S STOP=1 Q  "_BK
 S C=C_" ..E  S Num=Num-1 S STOP=2"_BK
 S C=C_" quit"_BK
 S C=C_"CheckR //"_$$LNG^%ZAPM.ed.BSC4("проверить значение ключей",211)_BK
 S C=C_" if $$$DGET(""value""_Num)="""" D $$$DSET(""value""_Num,$$$ORDER("""_BSPRO_""","""_Tab_""",.Key,"""",-1)) d  "_BK
 S C=C_" .if $$$DGET(""value""_Num)="""" D  "_BK
 S C=C_" ..I Num=1 S STOP=1 Q  "_BK
 S C=C_" ..E  S Num=Num-1 S STOP=2"_BK
 S C=C_" quit"_BK
 S C=C_"Disable(N,A) Q $S($G(Dis(N,A)):""DISABLED"",1:"""") //"_$$LNG^%ZAPM.ed.BSC4("выставить опцию",212)_BK        
 S C=C_"KKey(k) //"_$$LNG^%ZAPM.ed.BSC4("подготовить массив данных узлов",213)_BK    
 S C=C_" D $$$DKILL(""Key"") //"_$$LNG^%ZAPM.ed.BSC4("Удалить массив",214)_BK
 S C=C_" n i f i=1:1:k s Key(i)=$$$DGET(""value""_i)"_BK 
 S C=C_" s Key=k Q"_BK   
 S C=C_"Navig2 ; "_$$hr^%ZAPM.ed.BSC4rou_BK
 S C=C_" G Navig1"_BK    
 ;----------------------------------------- 
 s H="<!-- "_$$say1^%ZAPM.ed.BSC4rou_" -->"_BK
 S H=H_$$VAR^%ZAPM.ed.BSC4rou(1,"Navigator"),BSLABEL="Navigator"
 S H=H_"<a href="_$$add^%ZAPM.ed.BSC4rou_">"_$$LNG^%ZAPM.ed.BSC4("Загрузить Редактор пунктов меню",215)_"</a>"_BK
 S H=H_"</center>"_BK
 s H=H_$$end^%ZAPM.ed.BSC4rou
 g Save^%ZAPM.ed.BSC4rou
]]></Routine>


<Routine name="%ZAPM.ed.BSC4r2" type="MAC" languagemode="0"><![CDATA[
%BSC4r2 ;МОДУЛЬ ДЛЯ СПЕЦИАЛЬНЫХ ФУНКЦИЙ  ; 11:11   12.09.2002
 Q
MERGE ;СМЕШАТЬ ПРОЕКТЫ
 D BEG1^%ZAPM.ed.BSC4
 W "<BODY>"
 N BSPASS,BSNAME,BSTARIF,BSEMAIL,BSFIRMA,BSCOUNTRY,BSCITY,BSLABEL
 S BSTMP1=newPR,BSTMP2=Proj
 W "<form action="""_$$ADDLIB^%ZAPM.ed.BSC4()_""" method=""POST"">"
 S BSLABEL="MERG^~BSC4r2"
 D ADDBSPOST^%ZAPM.ed.BSC4reg
 W "<HR>"_RED,$$LNG^%ZAPM.ed.BSC4("Будем смешивать ? Вы уверены ?",318),EF,BK_BBK
 W "<input type=""submit"" name=""sMER"" value='"_$$LNG^%ZAPM.ed.BSC4("СМЕШАТЬ",319)_"'>",BK
 W "</form>" d BACK^%ZAPM.ed.BSCh
 D END^%ZAPM.ed.BSC4
 Q
MERG ;ПОДТВЕРЖДЕНИЕ УДАЛЕНИЯ
 I $D(sMER) W "<HR>"_$$LNG^%ZAPM.ed.BSC4("Объединим два проекта",320)_BBK S newPR=BSTMP1,Proj=BSTMP2 G CreatMERG^%ZAPM.ed.BSC4base
 E  W "<HR>"_$$LNG^%ZAPM.ed.BSC4("Смешение отменено",321)_BBK
 G PRO^%ZAPM.ed.BSC4base
 Q
WIND ;ИЗМЕНИТЬ ОКНО
 N S,i,I,K,M
 D pin^%ZAPM.ed.BSC4base
 I BSTMPL="B" D
 .s S=$G(@("^"_pin_".ROU")@(BSR1,BSTMPH)),Tmp=$ZR
 .S M=0
 .s K=$L(S,BK)
 .F I=1:1:K I M<$L($P(S,BK,I)) S M=$L($P(S,BK,I))
 .S:M<255 M=255 S:K<25 K=25
 .S @BDSES@(BSSES,"TEXTARIA",BSTMPH)="cols="_M_" rows="_K
 I BSTMPL="L" K @BDSES@(BSSES,"TEXTARIA",BSTMPH)
 D EditRou^%ZAPM.ed.BSC4base1(BSR1)
 Q
GETH(H,L) ;GET - ПЕРЕМЕННЫЕ ДЛЯ УВЕЛИЧЕНИЯ/УМЕНЬШЕНИЯ ОКОН ТЕXTARIA
 n BSLABEL,BSRoutineId,BSTMPH,BSTMPL,BSTOP,BSGRANT,BSROU
 s BSLABEL="WIND^~BSC4r2",BSTMPH=H,BSTMPL=L,BSR1=Rou
 S R=$$ADDBSGET^%ZAPM.ed.BSC4()
 Q R
GETTA(A) ;РАЗМЕРЫ ТЕКCТ АРИИ ПО УМОЛЧАНИЮ
 N I
 S I=$G(@BDSES@(BSSES,"TEXTARIA",A))
 I I="" S I=$$GETOPT^%ZAPM.ed.BSC4cfg(MainOpt,A) I I="" Q "cols=70 rows=4"
 Q I
 ;====================================================================================
prg ;РАЗОВАЯ ПРОКАЧКА ПРОГРАММ для АСУРП
 zn "USER" 
 n g,S,SS,I,FLAG,ROU,V,II,err
 s g="^%ZAPM.ed.BSC(""asurpPRG"")"
 F I=1:1 Q:'$D(@g@(I))  S SS(I,1)=$P(@g@(I),"|",1),SS(I,2)=$P(@g@(I),"|",2)
 S I="A" F  S I=$O(^ROUTINE(I)) Q:I=""  D
 .K FLAG,ROU W !,I 
 .F II=0:1:^ROUTINE(I,0,0) I $D(^ROUTINE(I,0,II)) S (ROU(II),S)=@$ZR D
 ..S V="" F  S V=$O(SS(V)) Q:V=""  I S[SS(V,1) S S=$$TR^%ZAPM.ed.BSsFUNM(S,SS(V,1),SS(V,2))
 ..I ROU(II)'=S S ROU(II)=S,FLAG=1 w "+"
 .I $D(FLAG) D
 ..D ROUTINE^%R(I_".INT",.ROU,.err,"CS",0)
 ..ZW err
 . //ЗАПИСАТЬ ПРОГРАММУ
 Q
 ;====================================================================================
132 ;РАСШИРИТЬ ОКНО КОНСОЛИ!!! РАЗОВАЯ ПРОКАЧКА ПРОГРАММ
 K SS F I=1:1 Q:'$D(^%ZAPM.ed.BSC("T132X48",I))  S SS(I,1)=$P(^%ZAPM.ed.BSC("T132X48",I),"|",1),SS(I,2)=$P(^%ZAPM.ed.BSC("T132X48",I),"|",2)
 S I="%BS" D  F  S I=$O(^ROUTINE(I)) Q:I=""  I I["%BST132"  I I'=$ZN D
 .K FLAG,ROU W !,I
 .F II=0:1:^ROUTINE(I,0,0) I $D(^ROUTINE(I,0,II)) S (ROU(II),S)=@$ZR D
 ..S V="" F  S V=$O(SS(V)) Q:V=""  I S[SS(V,1) S S=$$TR^%ZAPM.ed.BSsFUNM(S,SS(V,1),SS(V,2))
 ..I ROU(II)'=S S ROU(II)=S,FLAG=1
 .I $D(FLAG) D
 ..D ROUTINE^%R(I_".INT",.ROU,.err,"CS",0)
 ..ZW err
 . //ЗАПИСАТЬ ПРОГРАММУ
 Q
 ;====================================================================================
CNODE Q  ;СОЗДАТЬ УЗЕЛКИ ДЛЯ LNG!!! РАЗОВАЯ ПРОКАЧКА
 S X=$O(^%ZAPM.ed.BSC4DIC("!"),-1)+1 K SSS
 S I="%BSC4" D  F  S I=$O(^ROUTINE(I)) Q:I'["%BSC4"  I I'=$ZN D
 .F II=1:1:^ROUTINE(I,0,0) I $D(^ROUTINE(I,0,II)) S (S4,S)=@$ZR D
 ..F SS="$$LNG(","$$LNG^%ZAPM.ed.BSC4(" D XE(SS,S)
 ..I S4'=S S ^ROUTINE(I,0,II)=S4
 ;ZW SSS
 Q
XE(SS,S) I S'[SS Q
 F S2=2:1 Q:$P(S,SS,S2,S2+1)=""  S S3=$P($P(S,SS,S2),")",1) D
 .I $E(S3,1)'=$C(34) Q
 .I $E(S3,$L(S3))'=$C(34)&(S3'[",") S S3=$P($P(S,SS,S2),")",1,2)
 .I S3["""_"!(S3["_""") Q
 .;W !,S3
 .S S1="D XEC^%ZAPM.ed.BSC4r2("_S3_")" X S1
 Q
XEC(T,N)
 I $D(^%ZAPM.ed.BSC4DIC(T)) Q
 I $D(N) D  Q
 .I $D(^%ZAPM.ed.BSC4DIC(N)) Q
 .S ^%ZAPM.ed.BSC4DIC(N,"R")=T,^%ZAPM.ed.BSC4DIC(N,"E")="?",^%ZAPM.ed.BSC4DIC(N,"F")="?",^%ZAPM.ed.BSC4DIC(N,"G")="?"
 s XX(T)=$G(XX(T))+1 I XX(T)=1 S X=X+1,N=X S XX(T,1)=X S ^%ZAPM.ed.BSC4DIC(N,"R")=T,^%ZAPM.ed.BSC4DIC(N,"E")="?",^%ZAPM.ed.BSC4DIC(N,"F")="?",^%ZAPM.ed.BSC4DIC(N,"G")="?"
 I XX(T)>1 S N=XX(T,1),^%ZAPM.ed.BSC4DIC(N,"Multu")=XX(T)
 S S4=$$TR^%ZAPM.ed.BSsFUNM(S4,""""_T_"""",""""_T_""","_N)
 Q
 ;===========================================================
 ;
 ;ИДЕЯ : ОТЧЕТНУЮ ТАБЛИЦУ
 ;1. ОТСКАНИРОВАТЬ И СОЗДАТЬ ВРЕМЕННЫЙ МАССИВ ПО ТАБЛИЦЕ ОТЧЕТА
 ;2. ОБВЯЗАТЬ ЕГО SQL-Ю ...
 ;3. УБИТЬ И МАССИВ И КЛАСС И ОТЧЕТНУЮ ТАБЛИЦУ
 ;
ARRAY2OBJ(GN,P,T,KKOL,FIELDS,NAMECLASS,TEMPDIR) ;СОЗДАТЬ ОБЪЕКТНУЮ ОБВЯЗКУ ДЛЯ МАССИВА БД
 N I,II,III,NF,BSR,BST,PxPUSTO,se,ke
 ;S P="^Struct",T="KNHA"
 i $P($G(@P),"@",1)'="BaSe MsW " S @P="BaSe MsW @РАЗДЕЛ@@"
 K @P@(T)
 S @P@(T)="МАССИВ "_GN_", ПОЛЯ="_FIELDS_"@@@@@1@1@1@1@22@80@1@@1@@@2@@2,2@1@@@@@1@@@7@2@@@@@@@@@@"
 S @P@(T,1,1)="1@1@2@20@@@@@1@2;6;35;42@@@@@"
 S @P@(T,1,2)="1@21@2@53@@@@0@1@2;6;35;42@@@@@@"
 S @P@(T,"FTR",1,2)="S d1="" КЛЮЧИ: ""_$G(k1)_"" ""_$G(k2)_"" ""_$G(k3)_"" ""_$G(k4)_"" ""_$G(k5)_"" ""_$G(k6)_"" ""_$G(k7)_"" ""_$G(k8)_"" ""_$G(k9)"
 S @P@(T,"FTR",1,2,1)=" КЛЮЧИ: "_$G(k1)_" "_$G(k2)_" "_$G(k3)_" "_$G(k4)_" "_$G(k5)_" "_$G(k6)_" "_$G(k7)_" "_$G(k8)_" "_$G(k9)
 S @P@(T,"KEY")=GN
 S @GN="BSD - MSW@"_P_"@"_T
 I '$G(KKOL)!($G(FIELDS)="") D ARRAYSCAN(GN)
 F I=1:1:KKOL S @P@(T,"KEY",I)="49@@64@@НОВЫЙ "_I_"-КЛЮЧ@1,70@@@ "_I_"-Й ИНДЕКСНЫЙ@1;6;33;42@@@@@Введите "_I_"-КЛЮЧ@@@@@"
 S III=FIELDS ;"KNP,KPD,KSP,OKATO,SNM,VSV"
 S II=2 F I=1:1 Q:$P(III,",",I,I+1)=""  S NF=$P(III,",",I) D
 .S @P@(T,II,1)="3@1@2@20@@@@@1@2;6;35;42@@@@@ ИМЯ ПОЛЯ: "_NF
 .S @P@(T,II,2)="3@21@2@53@@@@@2@2;6;34;43@@@@@@@@"_NF_"@"
 .S II=II+1
 S BSR=P,BST=T D TAB^%ZAPM.ed.BSF1
 I $D(NAMECLASS) S PxPUSTO="" I $$START^%ZAPM.ed.BSCBD($NA(@P@(T)),1,$G(NAMECLASS),$G(TEMPDIR))
 Q
ARRAYSCAN(GN) ;СКАНИРОВАТЬ МАССИВ И ОПРЕДЕЛИТЬ КАКИЕ ПОЛЯ И СКОЛЬКО УРОВНЕЙ
 Q
]]></Routine>


<Routine name="%ZAPM.ed.BSC4r3" type="MAC" languagemode="0"><![CDATA[
%BSC4r3 ;МОДУЛЬ ДЛЯ СПЕЦИАЛЬНЫХ ФУНКЦИЙ = CSP-UPLOAD ; 11:11   12.09.2002
 Q
UPL ;ОСНОВНОЙ ВЫЗЫВАЮЩИЙ МОДУЛЬ UPLOAD
 N BSS1,BSS2,BSS3,BSS4,BSS5 ;BSS6=ПРОГРАММА КОТОРУЮ НАДО ВЫПОЛНИТЬ ПОТОМ
 S BSS1=$G(BSLOGIN),BSS3=$G(BSSES),BSS4=CurUS
 W $$NEWIN^%ZAPM.ed.BSC4base1($$LNG^%ZAPM.ed.BSC4("UploadFile"),"1",$$LNG^%ZAPM.ed.BSC4("UploadFile"),"UP^~BSC4r3"),BBK
 Q
UP D BEG1^%ZAPM.ed.BSC4
 ;<meta http-equiv="Content-Type" content="text/html; charset=windows-1251">
 W "<title>UpLoad File</title>"_$g(BK)
 W "</head><body onkeyPress='javascript: if (27 == event.keyCode) window.close();' >"
 D CSPUPLOAD("")
 W "</form>"_$g(BK)
 D END^%ZAPM.ed.BSC4
 Q
ERRR ;
 W "<pre>"
 W
 W "</pre>"
 Q
TKUPLOAD //ЗАКОНЧИТЬ ПРИЕМ ФАЙЛА
 S F=$G(%KEY("FileStream"))
 Set by=$P(F,"~",3)
 S FiNa=$P(F,"~",5,9)
 S GL=$P(F,"~",1)
 I FiNa="" S BK=$c(13,10) D CLOSEWIN Q
 i by'=0,BSS1'="" D
 .K ^mtempBSC4(BSS1,BSS3)
 .S ^mtempBSC4(BSS1,BSS3)=BSS4_","_by_","_FiNa
 .S I="" F  S I=$O(@GL@(I)) Q:I=""  D
 ..Set bytes=$G(@GL@(I))
 ..s ^mtempBSC4(BSS1,BSS3,I)=bytes
 .K @GL
 .Write !,"Загружен с Login :",BSS1,!,"<BR>Адрес IP:",BSS4,!
 I $g(BSS6)'="" D  I $G(BSNSP)'="" I $$ZU^%ZAPM.ed.BSF4(BSNSP) D @BSS6
 .I BSS6["^~" S BSS6=$$%^%ZAPM.ed.BSCh(BSS6)
 .S BSSES=BSS3,BSNSP=$$%^%ZAPM.ed.BSCh($$GetVar^%ZAPM.ed.BSC4("NSpace"))
 // D locvar^%ZAPM.ed.BSCh0("",1)
 D CLOSEWIN 
 Q
CSPUPLOAD(F) N uri ;S uri="/csp/asu/b4y/b4yupload"_F_".csp"
 s uri="http://"_$P($ZU(54,13,$zu(110)),",")_":"_$$WebPort^%ZAPM.ed.BSCp2_"/csp/asu/b4y/b4yupload"_F_".csp"
 ;i $G(%("HOST:"))'="" S uri=""_$$ADDLIB^%ZAPM.ed.BSC4_"" 
 W "<hr><form action='"_uri_"' enctype='multipart/form-data' method='post'>"_BK
 W $$LNG^%ZAPM.ed.BSC4("Введите полное имя файла")_": <input name=FileStream size=""50"" type=""file"">"_BK
 W "<p>"_BK
 W "<ul><input type='submit' value='"_$$LNG^%ZAPM.ed.BSC4("Загрузить")_"'></ul>"_BK
 W "</p><hr>"_BK
  i $G(%("HOST:"))'="" W "<input type='hidden' name='BSLABEL' value='TKUPLOAD^~BSC4r3 '>"_BK
 I $D(BSS1) D
 .W "<input type='hidden' name='BSS1' value='"_BSS1_"'>"_BK
 .W "<input type='hidden' name='BSS2' value='"_$L(BSS1)_"'>"_BK
 W "<input type='hidden' name='BSS3' value='"_BSS3_"'>"_BK
 I $D(BSS4) D
 .W "<input type='hidden' name='BSS4' value='"_BSS4_"'>"_BK
 .W "<input type='hidden' name='BSS5' value='"_$L(BSS4)_"'>"_BK
 I $D(BSS6) D
 .W "<input type='hidden' name='BSS6' value='"_BSS6_"'>"_BK
 .W "<input type='hidden' name='BSS7' value='"_$L(BSS6)_"'>"_BK
 I $D(BSS8) D
 .W "<input type='hidden' name='BSS8' value='"_BSS8_"'>"_BK
 .W "<input type='hidden' name='BSS9' value='"_$L(BSS8)_"'>"_BK
 Q
UPLOAD ;CSP-МОДУЛЬ
 New by,I,BSS1,byte,BSS2,BSS3,BSS4,BSS5
 ;S $ZT="ERRR^%ZAPM.ed.BSC4r3"
 S BSS2=+%request.Get("BSS2")
 S BSS1=$E(%request.Get("BSS1"),1,BSS2)
 S BSS3=+%request.Get("BSS3")
 S BSS5=+%request.Get("BSS5")
 S BSS4=$E(%request.Get("BSS4"),1,BSS5)
 S BSS7=+%request.Get("BSS7")
 S BSS6=$E(%request.Get("BSS6"),1,BSS7)
 S BSS9=+%request.Get("BSS9")
 S BSS8=$E(%request.Get("BSS8"),1,BSS9)
 W "<input type='hidden' name='BSS1' value='"_$g(BSS1)_"'>",!
 W "<input type='hidden' name='BSS2' value='"_$g(BSS2)_"'>",!
 W "<input type='hidden' name='BSS3' value='"_$g(BSS3)_"'>",!
 W "<input type='hidden' name='BSS4' value='"_$g(BSS4)_"'>",!
 W "<input type='hidden' name='BSS5' value='"_$g(BSS5)_"'>",!
 W "<input type='hidden' name='BSS6' value='"_$g(BSS6)_"'>",!
 W "<input type='hidden' name='BSS7' value='"_$g(BSS7)_"'>",!
 W "<input type='hidden' name='BSS8' value='"_$g(BSS8)_"'>",!
 W "<input type='hidden' name='BSS9' value='"_$g(BSS9)_"'>",!
 Set by=%request.GetMimeData("FileStream").Size
 S FiNa=%request.GetMimeData("FileStream").FileName
 I FiNa="" D UPEND S BK=$c(13,10) D CLOSEWIN Q
 i by'=0,BSS1'="" D
 .K ^mtempBSC4(BSS1,BSS3)
 .S ^mtempBSC4(BSS1,BSS3)=BSS4_","_by_","_FiNa
 .F I=0:30000:by D
 ..Set bytes=%request.GetMimeData("FileStream").Read(30000)
 ..s ^mtempBSC4(BSS1,BSS3,I)=bytes
 .Write !,"Загружен с Login :",BSS1,!,"<BR>Адрес IP:",BSS4,!
 I $g(BSS6)'="" D  D @BSS6
 .I BSS6["^~" S BSS6=$$%^%ZAPM.ed.BSCh(BSS6)
UPEND F I=1:1:30 W "<BR>"
 D %session.%Close()
 d CLOSEWIN
 Q
CLOSEWIN I $G(NoCloseWin) Q
 D JS^%ZAPM.ed.BSCp
 W "window.close();"_BK
 D JSE^%ZAPM.ed.BSCp
 Q
UPLOADFL ;импорт из ТЕКСТОВОГО ФАЙЛА (3 ШАГ)
 D MAINVAR^%ZAPM.ed.BSC4
 W "<HR><H3>"_$$LNG^%ZAPM.ed.BSC4("Создание таблицы из текстового файла")_$$LNG^%ZAPM.ed.BSC4(" ( 3 ШАГ )")_"<H3>"
 k ^mtempBSC4LF(BSS1,BSS3),by
 S I="",j=0 F  S I=$O(^mtempBSC4(BSS1,BSS3,I)) Q:I=""  S ST=^mtempBSC4(BSS1,BSS3,I) D
 .i j'=0 S ST=III_ST,j=j-1
 .F II=1:1 Q:$P(ST,BK,II,II+1)=""  S III=$P(ST,BK,II) d
 ..s j=j+1,^mtempBSC4LF(BSS1,BSS3,j)=III
 ;W BK,!,"OK"
 N InsD,Desc,Suff,Y,PT,a,A,BD,Y,I,SuffSave,SuffKEY,FCount,FC
 S P="^%ZAPM.ed.BSC4E",T="EMPTY",pin=$P(BSS8,"~",2),TabName=$P(BSS8,"~",3) d NewT^%ZAPM.ed.BSC4base($NA(@P@(T)),pin,TabName)
 S NAMF=$P(BSS8,"~",4)
 F I=1:1 Q:$P(NAMF,";",I,I+1)=""  S (FC(I),@("Field"_I))=$P(NAMF,";",I),@("Desc"_I)="Description of "_$P(NAMF,";",I)
 S FCount=I-1,T=TabName,Desc=%request.GetMimeData("FileStream").FileName
 D Group^%ZAPM.ed.BSC4base
 N DEL,BD,S,i,I
 S DEL=$P(BSS8,"~",5),BD=$G(@("^"_pin)@(T,"KEY"))
 S I="" F  S I=$O(^mtempBSC4LF(BSS1,BSS3,I)) Q:I=""  S i=I,S=^mtempBSC4LF(BSS1,BSS3,I) F Y=1:1:FCount D
 .I $P(S,DEL,Y)'="" S @BD@(I,FC(Y))=$P(S,DEL,Y)
 W $$LNG^%ZAPM.ed.BSC4("Загружено записей: "),i,BK
 k ^mtempBSC4LF(BSS1,BSS3),^mtempBSC4(BSS1,BSS3)
 ;D ERRR
 Q
UPLOADF2         ;ПАРАМЕТРЫ импорта из ТЕКСТОВОГО ФАЙЛА (2 ШАГ)
 D BEG1^%ZAPM.ed.BSC4    W $$STYLE^%ZAPM.ed.BSC4
 W "<BODY><H3>"_$$LNG^%ZAPM.ed.BSC4("Создание таблицы из текстового файла")_$$LNG^%ZAPM.ed.BSC4(" ( 2 ШАГ )")_"<H3>"
 N BSS1,BSS2,BSS3,BSS4,BSS5,BSS6,BSS7,BSS8,BSS9
 S $ZT="ErrSave^%ZAPM.ed.BSC4base"
 F I=1:1 Q:$P(NAMF,";",I,I+1)=""
 K S,A,a F I=1:1 Q:$P(NAMF,";",I,I+1)=""  S ii=$P(NAMF,";",I) S A=ii,@A=1 D  i '$$CtrlKeyWord^%ZAPM.ed.BSC4base(A) ZT "errorName"
 .I '$D(S(A)) S S(A)="" Q
 .E  W $$LNG^%ZAPM.ed.BSC4("ИМЕНА ПОЛЕЙ НЕ ДОЛЖНЫ ПОВТОРЯТЬСЯ",93)," '",A,"'",BBK ZT "errorName"
 K A,a
 S BSS1=$G(BSLOGIN),BSS3=$G(BSSES),BSS4=CurUS,BSS6="UPLOADFL^%ZAPM.ed.BSC4r3",BSS8=Proj_"~"_Pn_"~"_Ta_"~"_NAMF_"~"_DELIM
 D CSPUPLOAD("f")
 W "</form>"
 d BACK^%ZAPM.ed.BSCh
 D END^%ZAPM.ed.BSC4
 Q
 //ErrSaveUP G ErrSave^%ZAPM.ed.BSC4base
UPLOADF(Proj,pin,Table) ;ПАРАМЕТРЫ импорта из ТЕКСТОВОГО ФАЙЛА (1 ШАГ)
 n aa ;D pin^%ZAPM.ed.BSC4base
 D BEG1^%ZAPM.ed.BSC4
 W $$STYLE^%ZAPM.ed.BSC4
 W "<BODY><H3>"_$$LNG^%ZAPM.ed.BSC4("Создание таблицы из текстового файла")_$$LNG^%ZAPM.ed.BSC4(" ( 1 ШАГ )")_"<H3>"
 s aa=$$GETOPT^%ZAPM.ed.BSC4cfg(MainOpt,"ImportTXT")
 ;I $G(newPR)="2" s aa=0 ;пока так - это линк
 ;I $G(newTP)="2" s aa=0 ;пока так - это линк
 i 'aa W $$LNG^%ZAPM.ed.BSC4("Режимы импорта таблиц из Текстовых файлов доступны при тарифном плане КОРПОРАТИВНЫЙ, или при согласовании условий с администратором при тарифном плане ПРОФЕССИОНАЛЬНЫЙ.")
 W "<form action="""_$$ADDLIB^%ZAPM.ed.BSC4()_""" method=""POST"">"
 S BSLABEL="UPLOADF2^~BSC4r3"
 D ADDBSPOST^%ZAPM.ed.BSC4reg
 W "<input type=""hidden"" name='Proj' value="""_Proj_""">"
 W "<input type=""hidden"" name='Pn' value='["""_$zu(5)_"""]"_pin_"'>"
 W "<input type=""hidden"" name='Ta' value='"_Table_"'>"
 W "<table border=0 width=100%>"
 s namf="F1;F2;F3;F4;F5;F6;F7;F8;F9;F10;F11;F12;F13;F14"
 W "<tr><td  width=30% align='right' class=s1>"_$$LNG^%ZAPM.ed.BSC4("Имена полей будущей таблицы")_"</td><td align='left' class=s1 ><input type=""text"" title='"_$$LNG^%ZAPM.ed.BSC4("не меняйте разделитель ; между именами полей")_"' size=50 maxlength=50 name='NAMF' value='"_namf_"'></td></tr>"
 W "<tr><td align='right' class=s1>"_$$LNG^%ZAPM.ed.BSC4("Разделитель между даными в строках файла")_"</td><td  align='left' class=s1 ><input type=""text"" size=1 maxlength=1 name='DELIM' value=';'></td></tr>"
 W " </table>"
 ;W "<input "_$s('aa:"disabled",1:"")_" type=""submit"" name='UPLOAD' value='"_$$LNG^%ZAPM.ed.BSC4("Загрузить только структуру таблиц",71)_"'><br>",BK
 w "<input type=""submit"" "_$s('aa:"disabled",1:"")_" name='UPLOAD' value='"_$$LNG^%ZAPM.ed.BSC4("Загрузить структуру и данные")_"'><br><input type=""reset"" name='ESC' value='"_$$LNG^%ZAPM.ed.BSC4("отмена",73)_"'>",BK
 W "</form>" d BACK^%ZAPM.ed.BSCh
 D END^%ZAPM.ed.BSC4
 Q
 //------------------------------------------ CSP TEMPLATE
 
 q "<a href='"_$$ADDBSGET^%ZAPM.ed.BSC4(,"aGET^")_"' target=new TITLE='"_dt_"'>"_t_"</a>"
BSRES D BEG1^%ZAPM.ed.BSC4 S name=BStype
  D BACK^%ZAPM.ed.BSCh W "<HR>"
 s a=$$TR^%ZAPM.ed.BSsFUNM($$txttab^%ZAPM.ed.BSC4r3($P(name,"_",1),$P(name,"_",2)),$C(34),"&#34;") 
 w $$TR^%ZAPM.ed.BSsFUNM($$TR^%ZAPM.ed.BSsFUNM(a,"'","&#8217;"),"<Ins>","&#60;Ins&#62;")_"';"
 W "<HR>" D BACK^%ZAPM.ed.BSCh
 D END^%ZAPM.ed.BSC4 Q
BSDOC D BEG1^%ZAPM.ed.BSC4
 W "<style type='text/css'>"_BK
 W "h4 { background-color: #007D7D; color: yellow; }"_BK
 W "h2 { background-color: yellow; color: #007D7D; }"_BK
 W "textarea {font-family: Fixedsys, Courier New, Courier;}"_BK
 W "</style>"_BK
 W "</HEAD>"_BK
 W "<BODY>"_BK
 W "<form action='' method=post><CENTER>"_BK
 W "<h4>1. Документация по текстовому процессору %BS"_BK
 W "<select id=type1 name=type onchange=""location='"_$$ADDBSGET^%ZAPM.ed.BSC4(,"BSRES^%ZAPM.ed.BSC4r3")_"&BStype='+document.getElementById('type1').value;"">"_BK
 W "	<option value=""""></option>"_BK
	D TampleteTXT^%ZAPM.ed.BSC4r3
 W "</select></h4>"_BK
 W "<h4>2. Документация по табличному процессору %BS"_BK
 W "<select id=type2 name=type onchange=""location='"_$$ADDBSGET^%ZAPM.ed.BSC4(,"BSRES^%ZAPM.ed.BSC4r3")_"&BStype='+document.getElementById('type2').value;"">"_BK
 W "	<option value=""""></option>"_BK
	D TampleteTAB^%ZAPM.ed.BSC4r3
 W "</select></h4>"_BK
 W "<h4>3. Стpуктуpа %BS-ресурсов. Локали,буфера,NS"_BK
 W "<select id=type3 name=type onchange=""location='"_$$ADDBSGET^%ZAPM.ed.BSC4(,"BSRES^%ZAPM.ed.BSC4r3")_"&BStype='+document.getElementById('type3').value;"">"_BK
 W "	<option value=""""></option>"_BK
	D TampleteBSD^%ZAPM.ed.BSC4r3
 W "</select></h4>"_BK
 W "<h4>4. Cache'-ОПИСАНИЕ ФУНКЦИЙ И МОДУЛЕЙ"_BK
 W "<select id=type4 name=type onchange=""location='"_$$ADDBSGET^%ZAPM.ed.BSC4(,"BSRES^%ZAPM.ed.BSC4r3")_"&BStype='+document.getElementById('type4').value;"">"_BK
 W "	<option value=""""></option>"_BK
	D TampleteBSC^%ZAPM.ed.BSC4r3
 W "</select></h4>"_BK
 W "<h4>5. Документация по ""Информационному порталу"""_BK
 W " <A CLASS=s2 HREF='http://"_($$ipS^%ZAPM.ed.BSCp2)_":1962/vv/bsdoc/index.htm' >Загрузить</A>"_BK
 W "</h4>"_BK
 W "</CENTER><HR>"_BK
 D BACK^%ZAPM.ed.BSCh
 D END^%ZAPM.ed.BSC4
 Q
TampleteBSC //
	S P="^%ZAPM.ed.BSC"
	F I="FUN" D
	.W "<option value=C_"_I_" >"_$P($G(@P@(I)),"@")_"</option>",!
	Q
TampleteBSD //
	S P="^%ZAPM.ed.BSHLP",T="DOC_TAB"
	F I=1:1 Q:'$D(@P@(T,I))  D
	.I $G(@P@(T,I))["_____" S S=$G(@P@(T,I)) W "<option value="_T_$TR($E(S,1,4),".","")_" >"_$P($P($G(@P@(T,I+1)),"== ",2)," ==",1)_"</option>",!
 Q
TampleteTXT //
	S P="^%ZAPM.ed.BSX"
	F I="DocMain","DocStruct","DocGlobals","DocVariabl" D
	.W "<option value=X_"_I_" >"_$P($G(@P@(I)),"@")_"</option>",!
 Q
TampleteTAB //
	S P="^%ZAPM.ed.BSHLP"
	F I=1:1:9 W "<option value=HLP_D"_I_" >"_$P($G(@P@("D"_I)),"@")_"</option>",!
 Q
TampleteRES(N)  Q $$txttab($P(N,"_",1),$P(N,"_",2))
 
txttab(B,T) N Q i B="" Q ""
  S P="^%ZAPM.ed.BS"_B,$ZT="TampleERROR",Q=""
  I B="DOC" S G=$NA(^%ZAPM.ed.BSHLP("DOC_TAB")) S T=$P($P(T,"TAB",2)," ") D  G txt2 
  .F I=1:1 Q:'$D(@G@(I))  I $E($G(@G@(I)),1,3)[(T_".") S II=I D txt1($P($P($G(@G@(II+1)),"== ",2)," ==",1)) D  Q
  ..D  F II=I+1:1 Q:'$D(@G@(II))  Q:$G(@G@(II))["_____"  D
  ...S Q=Q_$G(@G@(II))_"<BR>" 
  E  S G=$NA(@P@(T))
  D txt1($P($G(@G),"@")) 
  F I=1:1 Q:'$D(@G@(I))  S Q=Q_" "_$G(@G@(I))_"<br>" ;$C(13,10)
txt2 S Q=Q_"</pre>" ;  </textarea>"_$C(13,10)
 q Q
txt1(SS)  S Q=Q_"<H2>"_SS_"</H2><pre>"_$C(13,10)  ;_" <textarea cols=95 rows=10 >"
 Q
SetSelectTXT(T,R) 
 i R'="" S ^%ZAPM.ed.BSbufB("SetSelectTXT",R)=T 
 Q $J
GetSelectTXT(R) Q $G(^%ZAPM.ed.BSbufB("SetSelectTXT",R)," //?")
TampleERROR Q $ZE
PROFREST I '$$EXIST^%R("tempBS.INT") D ErrMsg^%ZAPM.ed.BSXfun("НЕ из чего ВОССТАНАВЛИВАТЬ, сначало импортируйте программы *.rgr") Q
 D RestGlo^tempBS,DelRou^tempBS,DEL1^%ZAPM.ed.BSC4r4("tempBS.*") D OkMsg^%ZAPM.ed.BSXfun("Восстановлено")
 Q
GetLenRou(r) //возвратить размер программы в байтах
 i r="" q "???"
 n n,I,i S r=$P(r,".")
 m n=^ROUTINE(r,0)
 S I=0  F i=1:1 Q:'$D(^ROUTINE(r,0,i))  S I=I+$L($G(^ROUTINE(r,0,i)))
 q r_" - имеет размер <font color=red>"_I_"</font> байт."
 //.........................................
VerEX() N F,M1,N1,N2,i,SS,N,FN,STR,T,T1
 S F="L:\MSW_Tools\MakeCab-Copy2---Installation.BAT" ////////////////////////////
 D File2Arr^%ZAPM.ed.BSCEXE(F,.M1),STR2MAS^%ZAPM.ed.BSCmail(.M1,.N,$C(13,10))
 S SS=0,i="",STR="",N2=0,T1=0
  F  S i=$O(N(i)) Q:i=""  D  Q:SS=2
 .I N(i)["@echo !  Recompilation" S SS=1 Q
 .I N(i)["rem -STOP-" S SS=2 Q
 .I SS=0 Q
 .I N(i)["copy " S FN=$P(N(i)," ",2) i FN[":" D
 ..S T=$ZU(140,2,FN) S:T>T1 T1=T S T=$$TD^%ZAPM.ed.BSC4base(T)
 ..S N1=$$VerEXE(FN),STR=STR_$$JF^%ZAPM.ed.BSC4r4($$JF^%ZAPM.ed.BSC4r4($P(FN,"\",$L(FN,"\")),20)_N1,35)_T_$C(13,10),N1=$TR(N1,".0"),N2=N2+N1
  S STR=$$JF^%ZAPM.ed.BSC4r4($$JF^%ZAPM.ed.BSC4r4("Client BS-Portal ver.",20)_"4."_$I(^%ZAPM.ed.BS("Client BS-Portal ver.4.")),35)_$$TD^%ZAPM.ed.BSC4base(T1)_$C(13,10)_"--------------------------------"_$C(13,10)_STR
 K SS S SS(1)=STR D Arr2File^%ZAPM.ed.BSCEXE(.SS,"L:\MSW_Tools\_installation_ext\soft\dsr-client-dev\Support\client.inf")
 Q STR
VerEXE(FN) //ВЕРСИЯ ПРОГРАММЫ
 N I,N,M,i,S,AA S $ZT="VerEr"
 S I="ProductVersion",S="" F i=1:1:$L(I) S S=S_$E(I,i)_$C(0)
 D File2Arr^%ZAPM.ed.BSCEXE(FN,.M),STR2MAS^%ZAPM.ed.BSCmail(.M,.N,$C(1))
 S i="" F  S i=$O(N(i)) Q:i=""  I N(i)[S Q
 S i=$TR($P($P(N(i),S,2),$C(16)),$C(0,1,20,24,12,14,22),"")
 S AA=$TR($P(i,"("),", ",".")
 ;F I=1:1:$L(AA) W !,$E(AA,I),"---",$A($E(AA,I))
 Q $P(AA,".",1,3)
VerEr Q "..." ;$ZE
SetALLStyle //ALL
 D BEG1^%ZAPM.ed.BSC4 W $$TITL^%ZAPM.ed.BSCGIS("Style Set"),$$B27^%ZAPM.ed.BSCGIS(1)
 ;D locvar^%ZAPM.ed.BSCh0("",1)
 I V["@" W RED_"Запрещенный символ @"_EF G SetALLStyle1
 S T=$$GETOPT^%ZAPM.ed.BSC4cfgP("^%ZAPM.ed.BSETUP(""ISS"")","Acfg")
 I V'="" D
 .I A=2 S $P(@T@(10,1),"@",15)=V,SET=1
 .I A=1,$G(BSGRANT)'="" S BD=$$KBD^%ZAPM.ed.BSF12("^%ZAPM.ed.BSC4(""GRAND"")") D  ;W 1_BD_1 D
 ..I $D(@BD@(BSGRANT)) S @BD@(BSGRANT,"STYLE")=V,SET=1
 I $G(SET)=1 W GREEN_"Параметры изменены<HR>"_EF 
 E  W RED_"Параметры НЕ изменены<HR>"_EF
SetALLStyle1 D BUTT^%ZAPM.ed.BSCGIS,END^%ZAPM.ed.BSC4
 Q
 //////////////// ЕСЛИ УДАЛЯТ BSC4.CFG.FrameStyle.MAC то вставить снова в программу
%BSC4inc ;встроенные функции   ; Compiled October 26, 2005 20:19:50
Navigator ; Пример CacheObjectScript кода : Навигатор прямого доступа к таблице `FrameStyle` 
 ;============================================================
 set Home1=1 
Navig1 ;  ;============================================================
 set Header=" Навигатор прямого доступа к таблице `FrameStyle` " // заголовок страницы
 set Max=$$GetField^%ZAPM.ed.BSC4rou("CFG","FrameStyle","Count") //количество полей
 set MaxI=$$GetField^%ZAPM.ed.BSC4rou("CFG","FrameStyle","Index") //количество индексированных полей
 D DKILL^%ZAPM.ed.BSC4r("Dis") // удалить массив признака опции DISABLE
 D DKILL^%ZAPM.ed.BSC4r("STOP") 
 for Num=1:1:MaxI D  Q:$G(STOP)=1  G:$G(STOP)=2 Navigator  //цикл по индексным полям
    .D KKey(Num)  
    .IF $$DDATA^%ZAPM.ed.BSC4r("Home"_Num) D DSET^%ZAPM.ed.BSC4r("Home"_(Num+1),1) D DSET^%ZAPM.ed.BSC4r("value"_Num,$$ORDEr^%ZAPM.ed.BSC4r("CFG","FrameStyle",.Key,"",1)) D CheckL Q:$D(STOP)  
    .IF $$DDATA^%ZAPM.ed.BSC4r("End"_Num) D DSET^%ZAPM.ed.BSC4r("Home"_(Num+1),1) D DSET^%ZAPM.ed.BSC4r("value"_Num,$$ORDEr^%ZAPM.ed.BSC4r("CFG","FrameStyle",.Key,"",-1)) D CheckR 
    .IF $$DDATA^%ZAPM.ed.BSC4r("Del"_Num) D DKILL^%ZAPM.ed.BSC4r("Del"_Num) D DSET^%ZAPM.ed.BSC4r("Left"_Num,1) D KillDirectTab^%ZAPM.ed.BSC4r("CFG","FrameStyle",.Key) //удалить узел 
    .IF $$DDATA^%ZAPM.ed.BSC4r("Left"_Num) D DSET^%ZAPM.ed.BSC4r("Home"_(Num+1),1) D DSET^%ZAPM.ed.BSC4r("value"_Num,$$ORDEr^%ZAPM.ed.BSC4r("CFG","FrameStyle",.Key,$$DGET^%ZAPM.ed.BSC4r("value"_Num),-1)) D CheckL Q:$D(STOP)  
    .IF $$DDATA^%ZAPM.ed.BSC4r("Right"_Num) D DSET^%ZAPM.ed.BSC4r("Home"_(Num+1),1) D DSET^%ZAPM.ed.BSC4r("value"_Num,$$ORDEr^%ZAPM.ed.BSC4r("CFG","FrameStyle",.Key,$$DGET^%ZAPM.ed.BSC4r("value"_Num),1)) D CheckR 
    .S Dis(Num,1)=($$ORDEr^%ZAPM.ed.BSC4r("CFG","FrameStyle",.Key,$$DGET^%ZAPM.ed.BSC4r("value"_Num),-1)="") 
    .S Dis(Num,2)=($$ORDEr^%ZAPM.ed.BSC4r("CFG","FrameStyle",.Key,$$DGET^%ZAPM.ed.BSC4r("value"_Num),1)="") 
 Write "",!
	Write "<html><title>"_(Header)_"</title>"_$c(9),!
	Write "",!
 W $$GetDirectTabN1^%ZAPM.ed.BSC4r("CFG","FrameStyle",$$DGET^%ZAPM.ed.BSC4r("value1"),"MainS")_$$GetDirectTabN1^%ZAPM.ed.BSC4r("CFG","FrameStyle",$$DGET^%ZAPM.ed.BSC4r("value1"),"LeftDn")
 Write "",!
	Write "<body><center><H4>"_(Header)_"</H4>",!
	//ДЕМОНСТРАЦИЯ СТИЛЕЙ ---------
	Write "<table border=1 class=tpTable ><tr>",!
	Write "",!
 	F I=1:1:5 w "<td class=s"_I_" >class=s"_I_"</td>"
 	w "<td ><th title='для оформления ZEN таблицы'>class='table.tpTable th'</th></td>",!
 	w "<td class=u1 ><A ONCLICK='SS(1,NameForm1.value1.value);' class=u1 TITLE='Применить текущий стиль, как основной для Гранда `"_$G(BSGRANT)_"`, который использует текущий пользователь `"_$G(BSLOGIN)_"`'>class=u1</A></td>",!
 	w "<td><A ONCLICK='SS(2,NameForm1.value1.value);' class=item TITLE='Применить текущий стиль, как основной для ВъХ пользователей'>class=A.item</A></td>"
 	Write "</table>",!
 	Write "",!
 D JS^%ZAPM.ed.BSCp
 	w "function SS(A,V) {"_BK
 	;W "alert(V);"_BK
 	W "open("""_$$ADDBSGET^%ZAPM.ed.BSC4(,"SetALLStyle^%ZAPM.ed.BSC4r3")_"&A=""+A+""&V=""+V,""xxx"",""toolbar=no,menubar=no,scrollbars=1,width=500,height=200,status=1,resizable=1"");"_BK
 	W "}"_BK
 D JSE^%ZAPM.ed.BSCp
	//------------------------------
	Write "<form name='NameForm1'  method='POST' action='"_($$ADDLIB^%ZAPM.ed.BSC4())_"' >",!
    D
    I $G(BSLOGIN)'="" Write "<input type=hidden name='BSLOGIN' value='"_$G(BSLOGIN)_"'>",!
    I $G(BSGRANT)'="" Write "<input type=hidden name='BSGRANT' value='"_$G(BSGRANT)_"'>",!
 
	Write "<input type=hidden name='BSDOMAIN' value='/b4y'>",!
	Write "<input type=hidden name='BSG' value='B4'>",!
	Write "<input type=hidden name='BSLABELt' value='Sopen2'>",!
	Write "<input type=hidden name='BSLNG' value='RUS'>",!
	Write "<input type=hidden name='BSNSP' value='~SYS'>",!
	Write "<input type=hidden name='BSPRO' value='CFG'>",!
	Write "<input type=hidden name='BSaX' value='1'>",!
 ;	Write "<input type=hidden name='BSdebug' value='1'>",!
	Write "<input type=hidden name='BSnewREG' value='1'>",!
	Write "<input type=hidden name='BStyle' value='GREEN'>",!
	Write "<input type='hidden' name='BSLABEL' value='Navig2'>",!
	Write "<table border=0>",!
	Write "",!
   D DSET^%ZAPM.ed.BSC4r("Key(Key)",$$DGET^%ZAPM.ed.BSC4r("value"_Num)) //присвоить значение последнего индекса 
    IF $D(Save) D  //присвоить исправления
       .for Num=(MaxI+1):1:Max D  //цикл по всем неиндексным полям
       ..set var1=$$GetField^%ZAPM.ed.BSC4rou("CFG","FrameStyle",Num) //взять все атрибуты текущего поля
       ..set NameFeild=$P(var1,"~",1) //вычленить имя поля
       ..IF $$SetDirectTab^%ZAPM.ed.BSC4r("CFG","FrameStyle",.Key,NameFeild,$$DGET^%ZAPM.ed.BSC4r("value"_Num)) //присвоим в прямом доступе
   for Num=1:1:Max {  //цикл по всем полям
     set var1=$$GetField^%ZAPM.ed.BSC4rou("CFG","FrameStyle",Num) //взять все атрибуты текущего поля
     set NameFeild=$P(var1,"~",1) //вычленить имя поля
     set Description=$P(var1,"~",2) //вычленить описание поля
     write "<tr>" //вывести описание
     if $P(var1,"~",4)'="" D  //эти поля индексные
       .W "<td align='right'><input type='submit' name='Del"_Num_"' title='удалить узел "_$SELECT(Num=MaxI:"",1:"со всеми потомками высших уровней")_"' value='Удалить'> <input type='submit' "_$$Disable(Num,1)_" name='Home"_Num_"' value='<<'><input type='submit' name='Left"_Num_"' "_$$Disable(Num,1)_" value='<'></td>"
     if Num=(MaxI+1) w "<tr><td><hr></td><td><hr></td><td></td><td><hr></td></tr><td align='right'><input type='submit' name='Save' value='Coхранить'></td>" 
     if Num=(MaxI+2) w "<td align='right'><input type='Reset' name='Reset' value='Отменить'></td>" 
     if Num>(MaxI+2) w "<td></td>"
     if $P(var1,"~",4)="" D  //эти поля не индексные
       .D DSET^%ZAPM.ed.BSC4r("value"_Num,$$GetDirectTab^%ZAPM.ed.BSC4r("CFG","FrameStyle",.Key,NameFeild)) //прямой доступ к данным таблицы, когда знаешь индексы
     if $P(var1,"~",3)'=1 write "<td><input type='text' size=40 maxlength=2048 title='"_NameFeild_"' name='value"_Num_"' value='"_$$DGET^%ZAPM.ed.BSC4r("value"_Num)_"'></td>"
     if $P(var1,"~",3)=1 write "<td><textarea cols=40 rows=5 title='"_NameFeild_"' name='value"_Num_"' >"_$$DGET^%ZAPM.ed.BSC4r("value"_Num)_"</textarea></td>"
     S var2="<td align='left'>" 
     if $P(var1,"~",4)'="" D  //эти поля индексные
       .S var2=var2_"<input type='submit' name='Right"_Num_"' "_$$Disable(Num,2)_" value='>'><input type='submit' "_$$Disable(Num,2)_" name='End"_Num_"' value='>>'>" 
     write var2_"</td>" 
     write $$Desc(" ("_NameFeild_") "_Description)_"</tr>" 
     }
 write "<input type='hidden' name='BSRoutineId' value='"_BSRoutineId_"'>"
 Write "",!
	Write "</table></form></center>",!
	Write "</body></html>",!
	Write "",!
 ;D $$$DoRou("CFG","NewRoutin3","Variables1") Q  
 quit
Desc(D) Q "<td align='lift'><strong>"_D_"</strong></td>" //вывести описание
CheckL //проверить значение ключей
 if $$DGET^%ZAPM.ed.BSC4r("value"_Num)="" D DSET^%ZAPM.ed.BSC4r("value"_Num,$$ORDEr^%ZAPM.ed.BSC4r("CFG","FrameStyle",.Key,"",1)) d  
 .if $$DGET^%ZAPM.ed.BSC4r("value"_Num)="" D  
 ..I Num=1 S STOP=1 Q  
 ..E  S Num=Num-1 S STOP=2
 quit
CheckR //проверить значение ключей
 if $$DGET^%ZAPM.ed.BSC4r("value"_Num)="" D DSET^%ZAPM.ed.BSC4r("value"_Num,$$ORDEr^%ZAPM.ed.BSC4r("CFG","FrameStyle",.Key,"",-1)) d  
 .if $$DGET^%ZAPM.ed.BSC4r("value"_Num)="" D  
 ..I Num=1 S STOP=1 Q  
 ..E  S Num=Num-1 S STOP=2
 quit
Disable(N,A) Q $S($G(Dis(N,A)):"DISABLED",1:"") //выставить опцию
KKey(k) //подготовить массив данных узлов
 D DKILL^%ZAPM.ed.BSC4r("Key") //Удалить массив
 n i f i=1:1:k s Key(i)=$$DGET^%ZAPM.ed.BSC4r("value"_i)
 s Key=k Q
Navig2 ;  ;============================================================
 G Navig1
DOCOUT 
 S Fname="N:\123.TXT" I $ZU(140,4,Fname)'=0 S OLDIO=$I O Fname:"UWN" U Fname W "-----",! d  W "-------",! U OLDIO C Fname 
 .s BSR="^%ZAPM.ed.BSHLP" F I=1:1:9 D DOCOUT1(BSR,"D"_I) 
 .s BSR="^%ZAPM.ed.BSX",I="" F  S I=$O(@BSR@(I)) Q:I=""  I $E(I,1,3)="Doc" D DOCOUT1(BSR,I) 
 Q
DOCOUT1(R,T) W !!,"------------------------------------------------------------------"
 S II="" F  S II=$O(@R@(T,II)) Q:II=""  W !,$G(@R@(T,II))
 Q 
]]></Routine>


<Routine name="%ZAPM.ed.BSC4r4" type="MAC" languagemode="0"><![CDATA[
%BSC4r4 ;СОЗДАНИЕ ДИСТРИБУТИВОВ. Модуль выкачки массивов из MSM в ^%ZZZ 
 ;
 ; Copyright (c) Serge W. Mikhaylenko
 ; All Rights Reserved
 ;
 Q
LST N M1,N,i,FI,F,T
 S F="d:\MSW_Tools\_installation_ext\soft\dsr-client-dev\Support\"
 D File2Arr^%ZAPM.ed.BSCEXE(F_"Setup.Lst",.M1),STR2MAS^%ZAPM.ed.BSCmail(.M1,.N,$C(13,10))
 S i=""  F  S i=$O(N(i)) Q:i=""  D  
 .I $E(N(i),1,4)="File" S FI=$P($P(N(i),"@",2),",",1) D
 ..S T=$ZU(140,2,F_FI) S T=$$TR^%ZAPM.ed.BSsFUNM($ZD(T,1),"/200","/0")_" "_$ZT($P(T,",",2),3) S $P(N(i),",",5)=$E(T,1,$L(T)-2)_" "_$E(T,$L(T)-1,$L(T))
 ..S T=$ZU(140,1,F_FI) S $P(N(i),",",6)=T
 ..W !,N(i)
 .S N(i)=N(i)_$C(13,10)
 D Arr2File^%ZAPM.ed.BSCEXE(.N,F_"Setup.Lst")
 D ANY
 Q
AUxml s onlyxml=1 //только создать xml
AUFREE S FREE=1 G AU //ДИСТРИБУТИВ ДЛЯ ВСЕХ, А НЕ ТОЛЬКО ДЛЯ ВВ
 Q
AUFON S addFON=1 //C МАССИВАМИ FON 
AU I $$ZU^%ZAPM.ed.BSF4("%SYS") S $ZT="Er" D AUTO //ПОЛНАЯ СБОРКА ДИСТРИБУТИВА БЕЗ FON
 q
Er W !,$ZE D ANY
 Q 
AUTO S AUTO=1 D ALL,VAR1^%ZAPM.ed.BSCm1,VAR3^%ZAPM.ed.BSCm1,ARX
 I $G(FREE) W !,"!!!!!!!! ДЛЯ ВСЕХ !!!!!!!!!!!!!",!
 I $ZU(140,4,ARX)=0 D  //ЕСЛИ СУЩЕСТВУЕТ СТАРЫЙ, ТО ...
 .S Time=$ZU(140,2,ARX),Time=$ZD(Time,3)_"~"_(VER-1) 
 .W !,"Копируем предыдущий дистрибутив в "_Time,!
 .D exec^%ZAPM.ed.BSCEXE(COMM_"COPY "_$TR(ARX_" "_$$TR^%ZAPM.ed.BSsFUNM(ARX,"bsdsr.zip","bs"_Time_".zip"),"/","\"),0)
 .I $ZU(140,5,ARX)
 S COMM1=COMM_" "_Dbin_"\Rar.exe a -ep "_$TR(ARX_" "_PR1,"/","\")_"\*.*"
 W !,"Формирование архива "_COMM1,!!
 D exec^%ZAPM.ed.BSCEXE(COMM1,0) ;_" -ps3v9e3t6a8m9y0",0)
 I $ZU(140,4,ARX)=0 W !,"Архив готов. "_$ZU(140,1,ARX)_" byte. "_$ZD($ZU(140,2,ARX),3),!,ARX
 E  W !,"!!! Архив НЕ готов ! "_ARX
 W !! i $g(onlyxml) g xml1
 D exec^%ZAPM.ed.BSCEXE(COMM_" N:\InfoPortal\rarcsp.bat",0) s CSPf=$$TR^%ZAPM.ed.BSsFUNM(ARX,"bsdsr.zip","ip\cache\csp.rar")
 I $ZU(140,4,CSPf)=0 W !,"Архив готов. "_$ZU(140,1,CSPf)_" byte. "_$ZD($ZU(140,2,CSPf),3),!,CSPf
 E  W !,"!!! Архив НЕ готов ! "_CSPf
xml1 W !,$$VerEX^%ZAPM.ed.BSC4r3 //ПРОСЧИТАТЬ ВЕРСИЮ КЛИЕНТА 
ANY W !!,"...Press ANY KEY ..." R *r1
 Q
ARX S PR1=$p(PR1,"/",1,$l(PR1,"/")-1) ;,ARX=$$TR^%ZAPM.ed.BSsFUNM(PR1,"BSNEW","bssetup")_"\bsdsr.zip"
 S ARX=$$GETOPT^%ZAPM.ed.BSC4cfgP("^%ZAPM.ed.BSETUP(""ISS"")","bBSDSRA")_"bsdsr.zip"
 ;I $G(^%ZAPM.ed.BSETUP("BSDSR","ARX"))'="" S ARX=^%ZAPM.ed.BSETUP("BSDSR","ARX")
 Q
ALL I $G(addFON) D FON^%ZAPM.ed.BSCAsIs1("^%ZAPM.ed.BStemp",1)
 N GOF,RSA 
 D BSC,BSc,BSETUP,BSCACHE
 K ^%ZAPM.ed.BStemp
 ;I '$G(AUTO) D ARX S A=$$LineEdit^%ZAPM.ed.BSXfun(ARX,"!!!!!!!! ВВЕДИТЕ ПОЛНЫЙ ПУТЬ К ДИСТРУБУТИВУ !!!!!!!!") I A'="" S ^%ZAPM.ed.BSETUP("BSDSR","ARX")=A
 i '$g(onlyxml) D GOFRSA
 D XML
 Q
GOFRSA N dir,g,g1,I,II
 S dir="N:/ROU/Install" I '$$exists^%ZAPM.ed.BSCEXE(dir) W "Директория "_dir_" не создана!" Q
 //массивы
 F II="MAC","INC" i $d(@("r"_II)) K @("^tempBSr"_II) S GOF("BSC","tempBSr"_II)="",I="" F  S I=$O(@("r"_II)@(I)) Q:I=""  m @("^tempBSr"_II)@(I)=@("^r"_II)@(I)
 S I="" F  S I=$O(GOF(I)) Q:I=""  D
 .N g
 .M g=GOF(I) D %GOF^%ZAPM.ed.BSCEXE($ZCONVERT(dir_"/bs-portal/"_I,"L")_".gof",.g,$G(GOF(I)))
 N g
 //программы
 S I="" F  S I=$O(RSA(I)) Q:I=""  I I'["-" D
 .M g=RSA(I)
 .S II="" F i=1:1 S II=$O(g(II)) Q:II=""  S g1(i)=II_"."_g(II)
 .S g1(i)="ZSTU.INT"
 .I $$Ro^%ZAPM.ed.BSCEXE($ZCONVERT(dir_"/update","L")_".rsa","g1",,$G(RSA(I)))
 Q
XML //ВСЕ ВЫБРОСИТЬ В XML
 N List,I,g,g1,II,dir
 S dir="N:/ROU/b4y" I '$$exists^%ZAPM.ed.BSCEXE(dir) W "Директория "_dir_" не создана!" Q
 i '$g(onlyxml) S (List("/csp/msw/BsDoc.csp"),List("/csp/msw/BsDocResult.csp"),List("/csp/msw/BsLib.csp"),List("/csp/msw/BsLibresult.csp"))=""
 S (List("/csp/msw/b4y/b4yupload.csp"),List("/csp/msw/b4y/b4yuploadf.csp"))=""
 i $g(onlyxml) S (List("/isc/studio/templates/BsLIB.csp"),List("/isc/studio/templates/BsLIB2.csp"))=""
 F I="BSG","BSQLDSN","BSWebService","GRAND","GRANDAPP","HELP","MAIL","PROTECT","SESSIONS","TEST","VISIT" S List("BSC."_I_".CLS")=""
 F I="Content1","Content2","Content3","Param","Tree" S List("BSC4.BSDOC."_I_".CLS")=""
 F I="DemonCFG","DemonCMD","Dict","FrameStyle","Param","Projects","PropFields","PropTables","UStatus" S List("BSC4.CFG."_I_".CLS")=""
 //программы
 S I="" F  S I=$O(RSA(I)) Q:I=""  I I'["-" D
 .M g=RSA(I)
 .S II="" F  S II=$O(g(II)) Q:II=""  D
 ..I $D(^rINC(II)) S List(II_".INC")="" Q
 ..S List(II_"."_g(II))=""
 .;S List("ZSTU.INT")=""
 i '$g(onlyxml) S List("%BSALL.PRJ")=""   //^oddPROJECT(nameProj,item,....
 //массивы
 K g
 S I="" F  S I=$O(GOF(I)) Q:I=""  D
 .I I="BScBDPROFILE" D  Q
 ..S II="" F  S II=$O(GOF(I,II)) Q:II=""  S g(II_".GBL")=""
 ..do $system.OBJ.Export(.g,dir_"/"_I_".xml","d",.err)
 .S II="" F  S II=$O(GOF(I,II)) Q:II=""  I II'["tempBSr" S List(II_".GBL")=""
 do $system.OBJ.Export(.List,dir_"/BSALL.xml","d",.err)
 K List S List("BsBuild.INT")=""
 do $system.OBJ.Export(.List,dir_"/BsBuild.xml","d",.err)
 Q 
 ;
G2F(GLN,%DEV,CURDEV,RComment) //МАССИВ В ФАЙЛ -----------
 N NFN,LR,LTR,f,DOS,FNO
 D GSAVE(GLN,"tempBS")
 i $$RREST("tempBS") U $G(CURDEV,0) w "Есть ошибки !!!",! q
 I $$Open^%ZAPM.ed.BSCF1(%DEV,"W")<0  U $G(CURDEV,0) W "Ошибка открытия файла ! "_%DEV,! Q
 U %DEV
 D RComment(RComment),RO("^ROUTINE","INT",1,0,"+tempBS*") 
 C %DEV U $G(CURDEV,0)
G2F1 D DeltempBS
 Q
OPENFILE(PR1,AUTO) I '$G(AUTO)   D DOSOPN^%ZAPM.ed.BSBL1 I '$D(%FN) Q 0
 I $G(AUTO) S %FN=PR1 D  I '$$OpenFile^%ZAPM.ed.BSCF1(PR1,"A") K %FN,%DEV Q 0
 .I $$DelFile^%ZAPM.ed.BSCEXE(PR1)
 Q 1
BSETUP //СОЗДАТЬ ДИСТРИБУТИВ %BSETUP.RGR
 D DeltempBS
 N %FN,%DEV,NFN,LR,LTR
 S PR1=$$GETOPT^%ZAPM.ed.BSC4cfgP("^%ZAPM.ed.BSETUP(""ISS"")","bBSDSR")_"%bsetup.rgr"
 ;I PR1'["/" S PR1=$g(^%ZAPM.ed.BSETUP("BSDSR",2),"D:/MSW/!")_"/%bsetup.rgr"
 S GOF="BSETUP"
 D GSAVE("+%BSETUP*","tempBS")
 W !!! i $$RREST("tempBS") w "Есть ошибки !!!",!!! q
 ;D DOSOPN^%ZAPM.ed.BSBL1 I '$D(%FN) Q
 I '$$OPENFILE(PR1,$G(AUTO)) Q
 U %DEV ;s ^%ZAPM.ed.BSETUP("BSDSR",2)=$p(%FN,"/",1,$l(%FN,"/")-1)
 S RSA="BSETUP-"
 S GOF(GOF)="%BSETUP-global. Version "_$$ver^%ZAPM.ed.BSC
 D RComment(GOF(GOF)),RO("^ROUTINE","INT",1,0,"+tempBS*") W !!!!
 C %DEV
BSETUP1 D DeltempBS
 Q
PROF //СОЗДАТЬ ДИСТРИБУТИВ ПРОФИЛЕЙ
 D DeltempBS
 N %FN,%DEV,NFN,LR,LTR
 S PR1=$$GETOPT^%ZAPM.ed.BSC4cfgP("^%ZAPM.ed.BSETUP(""ISS"")","bBSDSR")_"%bs-profile.rgr"
 ;S PR1=$g(^%ZAPM.ed.BSETUP("BSDSR",3),"D:/MSW/!")_"/%bs-profile.rgr"
 S GOF="PROFILE"
 D GSAVE("+%BSc4uSERS,+%BSC4.Profile,+%BSC4grand,+%BScGRAND,+%BScGAPP,+%BScPROT","tempBS")
 ;D GSAVE("%BSC4.Profile","tempBS")
 ;D GSAVE("%BSC4grand","tempBS")
 ;D GSAVE("%BScGRAND","tempBS")
 ;D GSAVE("%BScGAPP","tempBS")
 ;D GSAVE("%BScPROT","tempBS")
 W !!! i $$RREST("tempBS") w "Есть ошибки !!!",!!! q
 I '$$OPENFILE(PR1,$G(AUTO)) Q
 U %DEV ;s ^%ZAPM.ed.BSETUP("BSDSR","Profile")=$p(%FN,"/",1,$l(%FN,"/")-1)
 S RSA="PROFILE-"
 S GOF(GOF)="%BS profile. Version "_$$ver^%ZAPM.ed.BSC
 D RComment(GOF(GOF)),RO("^ROUTINE","INT",1,0,"+tempBS*") W !!!!
 C %DEV
 D DeltempBS
 d GOFRSA
 Q
BSc //СОЗДАТЬ ДИСТРИБУТИВ %BScBD.RGR
 D DeltempBS
 N %FN,%DEV,NFN,LR,LTR
 S PR1=$$GETOPT^%ZAPM.ed.BSC4cfgP("^%ZAPM.ed.BSETUP(""ISS"")","bBSDSR")_"%bscbd.rgr"
 ;S PR1=$g(^%ZAPM.ed.BSETUP("BSDSR",3),"D:/MSW/!")_"/%bscbd.rgr"
 S GOF="BScBDPROFILE"
 I $G(FREE) S MASK="+%BSc*,-%BScVIS,-%BScMAIL,-%BSc4uSESS,-%BSc4uSERS,-%BScPROT"
 E  S MASK="+%BSc*,-%BScVIS,-%BScMAIL,-%BSc4uSESS"
 D GSAVE(MASK,"tempBS")
 W !!! i $$RREST("tempBS") w "Есть ошибки !!!",!!! q
 ;D DOSOPN^%ZAPM.ed.BSBL1 I '$D(%FN) Q
 I '$$OPENFILE(PR1,$G(AUTO)) Q
 U %DEV ;s ^%ZAPM.ed.BSETUP("BSDSR",3)=$p(%FN,"/",1,$l(%FN,"/")-1)
 S RSA="BSc-"
 S GOF(GOF)="%BSc*-globals. Version "_$$ver^%ZAPM.ed.BSC
 D RComment(GOF(GOF)),RO("^ROUTINE","INT",1,0,"+tempBS*") W !!!!
 C %DEV
BSc1 D DeltempBS
 Q
BSC //СОЗДАТЬ ДИСТРИБУТИВ %BSС.RR %BSС.RGR
 D DeltempBS
 N %FN,%DEV,NFN,LR,LTR
 X "ZL %BSF11 ZS %BSCnewF11"
 S PR1=$$GETOPT^%ZAPM.ed.BSC4cfgP("^%ZAPM.ed.BSETUP(""ISS"")","bBSDSR")_"%bsc.rr"
 ;S PR1=$g(^%ZAPM.ed.BSETUP("BSDSR",0),"D:/MSW/!")_"/%bsc.rr"
 d VERADD($P(PR1,"/",1,$L(PR1,"/")-1)_"/#.ver")
 I '$$OPENFILE(PR1,$G(AUTO)) Q
 U %DEV ;s ^%ZAPM.ed.BSETUP("BSDSR",0)=$p(%FN,"/",1,$l(%FN,"/")-1)
 S RSA="BSC",RSA(RSA)="%BSC-routine. Version "_$$ver^%ZAPM.ed.BSC
 I $G(FREE) S ROULIST="+%BSC*,-%BSCSV*"
 E  S ROULIST="+%BSC*"
 D RComment(RSA(RSA)),RO("^rINC","INC","","","+%BSC*")
 D RO("^ROUTINE","INT",1,0,ROULIST) //,RO("^ROUTINE","INT","",0,"+%ZMGWS*") //,RO("^ROUTINE","INT","",0,"+%a*")
 D RO("^rMAC","MAC","",0,"+%BSC*"),RO("^rMAC","MAC","",0,"+%zek*") W !!!!
 C %DEV U 0
 S GOF="BSC"
 I $G(FREE) S MASK="+%BSC*,-%BSC4SNX*,+BSC*,-BSC4.CFG.UStat*,-%BSZ,+%BSC4SNX,-%BSZ*,-%BSMDDR,-%BSCmdapilog"
 E  S MASK="+%BSC*,-%BSC4SNX.OUT*,-%BSC4SNX.BPO*,-%BSC4SNX.Protokol*,-%BSC4SNX.VKS*,+BSC*,-BSC4.CFG.UStat*,-%BSCmdapilog"
 D GSAVE(MASK,"tempBS") ;,GSAVE("BSC","tempBS")
 W !!! i $$RREST("tempBS") w "Есть ошибки !!!",!!! q
 S NFN=$P(%FN,".",1)_".rgr"
 i $$Open^%ZAPM.ed.BSCF1(NFN,"W")
 U NFN
 S RSA="BSC-"
 S GOF(GOF)="%BSC-globals. Version "_$$ver^%ZAPM.ed.BSC
 D RComment(GOF(GOF)),RO("^ROUTINE","INT",1,0,"+tempBS*") W !!!!
 C NFN
BSC1 D DeltempBS
 Q
BSCACHE //СОЗДАТЬ ДИСТРИБУТИВ %BSСACHE.RR %BSСACHE.RGR
 D DeltempBS
 N %FN,%DEV,NFN,LR,LTR,MASK
 S PR1=$$GETOPT^%ZAPM.ed.BSC4cfgP("^%ZAPM.ed.BSETUP(""ISS"")","bBSDSR")_"%bscache.rr" 
 ;S PR1=$g(^%ZAPM.ed.BSETUP("BSDSR",1),"D:/MSW/!")_"/%bscache.rr"
 ;D DOSOPN^%ZAPM.ed.BSBL1 I '$D(%FN) Q
 I '$$OPENFILE(PR1,$G(AUTO)) Q
 U %DEV ;s ^%ZAPM.ed.BSETUP("BSDSR",1)=$p(%FN,"/",1,$l(%FN,"/")-1)
 S RSA="BSCACHE",RSA(RSA)="%BSCACHE-routine. Version "_$$ver^%ZAPM.ed.BSC
 I $G(FREE) S ROULIST="+%BS*,-%BSC*,-%BSc*,-%BSTAB*,-%BSMOL*,-%BSmirO*,-%BSion*,-%BSgsv*,-%BSfon*,-%BSkov*"
 E  S ROULIST="+%BS*,-%BSC*,-%BSc*"
 D RComment(RSA(RSA)),RO("^ROUTINE","INT",1,0,ROULIST),RO("^rMAC","MAC","",0,"+%BS*") W !!!!
 C %DEV U 0
 S GOF="BSCACHE"
 I $G(FREE) S MASK="+%BS*,-%BSC*,-%BSc*,-%BSETUP,-%BSb*,-%BSpgWEB*,+%BSpgWEBC,-%BSpgWEMM"
 E  S MASK="+%BS*,-%BSC*,-%BSc*,-%BSETUP,-%BSb*,-%BSvda*,-%BSpgWEB*,+%BSpgWEBC,-%BSpgWEMM,-%BSC4MON.SINX.BPO,+%BSCiP*"
 D GSAVE(MASK,"tempBS")
 W !!! i $$RREST("tempBS") w "Есть ошибки !!!",!!! q
 S NFN=$P(%FN,".",1)_".rgr"
 i $$Open^%ZAPM.ed.BSCF1(NFN,"W")
 U NFN
 S RSA="BSCACHE-"
 S GOF(GOF)="%BSCACHE-globals. Version "_$$ver^%ZAPM.ed.BSC
 D RComment(GOF(GOF)),RO("^ROUTINE","INT",1,0,"+tempBS*") W !!!!
 C NFN
BSCACHE1 D DeltempBS
 Q
VERADD(PR1) //СЧЕТЧИК ВЕРСИЙ+1
 S VE=$P(^%ZAPM.ed.BSC4,"@",2)
 S VER=$P(VE,"Version :",2)+1
 S $P(VE,"Version :",2)=VER_" от "_$ZD(+$H,3)
 S $P(^%ZAPM.ed.BSC4,"@",2)=VE
 S ^ROUTINE("%BS",0,1)="%BS ///"_$$ver^%ZAPM.ed.BSC
 N %FN,%DEV,NFN,LR,LTR
 I '$$OPENFILE(PR1,$G(AUTO)) Q
 U %DEV W $$ver^%ZAPM.ed.BSC," ",$ZU(110)
 C %DEV U 0
 Q
Ver() q "Ver. "_$P($P(^%ZAPM.ed.BSC4,"@",2),"Version :",2)
 //--------------------------------------------------------------------------
RO(M,EXT,N,NN,MA) //ВЫВЕСТИ СТРОКИ ПРОГРАММ
 N I,MI,MI2,MI3,MI4
 ;I MA["-" S MI2=$P(MA,"-",2),MI3=$P(MA,"-",3),MI4=$P(MA,"-",4),MI5=$P(MA,"-",5),MA=$P(MA,"-",1)
 S I=""  F  S I=$O(@M@(I)) Q:I=""  I $$MASK(I,MA) D  ;I ("@"_I)[("@"_MA) D
 .;I $G(MI2)'="",("@"_I)[("@"_MI2) Q  //ИСКЛЮЧЕНИЯ
 .;I $G(MI3)'="",("@"_I)[("@"_MI3) Q
 .;I $G(MI4)'="",("@"_I)[("@"_MI4) Q
 .;I $G(MI5)'="",("@"_I)[("@"_MI5) Q
 .S II=0
 .I EXT="INT",$D(^rMAC(I)) Q  //
 .I M="^rMAC" S rMAC(I)=""
 .I M="^rINC" S rINC(I)=""
 .S RSA(RSA,I)=EXT
 .W I,"^",EXT,"^"_N_"^",$G(@M@(I,0)),"^"_NN,!
 .F II=1:1 Q:'$D(@M@(I,0,II))   W @M@(I,0,II),!
 .W !
 Q
RComment(T) W $S($D(FREE):"Дистрибутив Для Всех. ",1:"")_"Cache for Windows NT^MAC^"_T_" из области "_$ZU(5)_"^~Format=Cache.S~",!,"%BS version "_$$ver^%ZAPM.ed.BSC_" ~"_$ZU(5)_"~",!
 Q
MASK(NAME,MASK) //ЛОГИКА ВКЛЮЧЕНИЯ\ВЫКЛЮЧЕНИЯ ИМЕН
 N A,I,J,M,RET S RET=0
 i MASK="*" q 1
 I '$D(MI) F I=1:1 Q:$P(MASK,",",I,I+1)=""  S A=$P(MASK,",",I),J=$E(A,1) S MI(J,$E($P(A,"*"),2,99))=A["*"
 S I="" F  S I=$O(MI("+",I)) Q:I=""  D  Q:RET=2
 .I MI("+",I)=0,NAME=I S RET=2 Q
 .I MI("+",I)=1,("@"_NAME)[("@"_I) S RET=1 Q
 I RET=1 S I="" F  S I=$O(MI("-",I)) Q:I=""  D  
 .I MI("-",I)=1,("@"_NAME)[("@"_I) S RET=0 Q
 .I MI("-",I)=0,NAME=I S RET=0 Q
 Q RET
GSAVE(MA,ROU) //СОХРАНИТЬ ГЛОБАЛИ В ПРОГРАММАХ
 N t,NS,i,ii,rc,MI,MI2,MI3,MI4,MI5
 S NS=$ZU(5),t="^mtempmBSdirGlob"
 D GetGlobalDir^%ZAPM.ed.BSCp(NS,t)
 ;I MA["-" S MI2=$P(MA,"-",2),MI3=$P(MA,"-",3),MI4=$P(MA,"-",4),MI5=$P(MA,"-",5),MA=$P(MA,"-",1)
 S i="" F ii=1:1 S i=$O(@t@(i)) Q:i=""  I $$MASK(i,MA) D  ;I ("@"_i)[("@"_MA) D
 .;I $G(MI2)'="",("@"_i)[("@"_MI2) Q
 .;I $G(MI3)'="",("@"_i)[("@"_MI3) Q
 .;I $G(MI4)'="",("@"_i)[("@"_MI4) Q
 .;I $G(MI5)'="",("@"_i)[("@"_MI5) Q
 .S GOF(GOF,i)=""
 .S LR=$G(LR)+1,LR(LR)=$$G2R("^"_i,ROU_"."_$$NaR(i)) ;W !,i
 K @t
 Q
NaR(N) I $E(N,1)="%" Q "p"_$E(N,2,99)
 Q N
RREST(ROU) //СОБРАТЬ ПРОГРАММУ ВОССТАНОВЛЕНИЯ
 N ERR
 D NEWROU(ROU),ADDSTR(ROU,"RestGlo //")
 S I="" F  S I=$O(LR(I)) Q:I=""  D ADDSTR(ROU,LR(I)) I LR(I)["!ERROR" S ERR=$G(ERR)+1
 D ADDSTR(ROU," Q"),ADDSTR(ROU,"DelRou //") //,ADDSTR(ROU," S $ZT=""DelErr^"_ROU_""" //")
 S I="" F  S I=$O(LTR(I)) Q:I=""  I LTR(I)'=ROU D ADDSTR(ROU," D DEL1^%ZAPM.ed.BSC4r4("""_LTR(I)_".*"")")
 D ADDSTR(ROU," Q") //,ADDSTR(ROU,"DelErr Q  //")
 D SAVEROU(ROU)
 I $G(ERR) Q +$G(ERR)
 Q 0
 /*
 >w $$Quote^%cspQuote($lb("123",123))
$c(5,1)_"123"_$c(3,4)_"{"
>w $$Quote^%cspQuote($lb("123",123,"aa ""111"" bb"))
$c(5,1)_"123"_$c(3,4)_"{"_$c(13,1)_"aa ""111"" bb"
 */
G2M(i) ;ГЛОБАЛЬ В ЛОКАЛЬ
 K STR S FLAG=0
 S STR(1)=" S "_GG_"="_$$CUT($E(i,1,LONG))
 F f=2:1 Q:$E(i,f*LONG-LONG+1,LONG+(LONG*(f-1)))=""  S FLAG=0,STR(f)=" S @$ZR=@$ZR_"_$$CUT($E(i,f*LONG-LONG+1,LONG+(LONG*(f-1))))
 Q
CUT(S)  I S="" Q """"""
 S SS="" F II=1:1:$L(S) S v=$A($E(S,II)) D
 .I v<32 D ADSUM(v) Q  ;//"$C("_v_")") Q
 .I v>126&(v<161) D ADSUM(v) Q  ;//"$C("_v_")") Q
 .I v=34 D ADSUM(v) Q  ;//"$C("_v_")") Q
 .D ADSU($E(S,II))
 I FLAG=2 S SS=SS_""""
 I FLAG=1 S SS=SS_")"
 Q SS
ADSUM(S) I FLAG=1 S SS=SS_","_S ;//S SS=SS_"_"_S
 I FLAG=0 S SS="$C("_S ;//S SS=S
 I FLAG=2 S SS=SS_"""_$C("_S ;//S SS=SS_"""_"_S
 S FLAG=1
 Q
ADSU(S) I FLAG=1 S SS=SS_")_"""_S ;//S SS=SS_"_"""_S
 I FLAG=0 S SS=""""_S
 I FLAG=2 S SS=SS_S
 S FLAG=2
 Q
G2R(G,R) //ГЛОБАЛЬ В ПРОГРАММУ ЗАСУНУТЬ
 N BT,ND,BTR,BTR1,R1,RR,GG,I,II,ROUTINE,LONG,f,v,ERROR,FLAG,RSTR,STR,SS,err
 S ERROR=0
 I '$D(@G) Q $$GINFO(" // global: "_G_" not exist")
 D NEWROU(R)     S RR=R,R1=0,BTR=0,BT=0,ND=0,LONG=1000
 I $D(@G)'[0 D SAVENODE(G)
 S GG=G F  S GG=$ZO(@GG) Q:GG=""  D SAVENODE(GG)
 D SAVEROU(RR)
 I $G(ERROR) Q $$GINFO(" //D ^"_R_" //!!!ERROR="_ERROR_" // ")
 Q $$GINFO(" D ^"_R_" // ")
GINFO(S) N A S A=$$JF(S,50) I $D(BT) S A=A_$$JF(BT,8,".")_$$JF("bytes",9)_$$JF(ND,6,".")_"nodes"
 Q A
JF(S,N,C) Q S_$TR($J("",N-$L(S))," ",$G(C," "))
SAVENODE(GG) //СОХРАНИТЬ УЗЕЛ
  S BT=BT+$L(@GG)+$L(GG),ND=ND+1
  D G2M(@GG)
  S I="" F  S I=$O(STR(I)) Q:I=""  D
  .S BTR=BTR+$L(STR(I))
  .I BTR>31000 S R1=R1+1 D ADDSTR(RR," S LTR=$G(LTR)+1,LTR(LTR)="""_RR_""" G ^"_R_"."_R1),SAVEROU(RR) S RR=R_"."_R1 D NEWROU(RR)
  .D ADDSTR(RR,STR(I))
  Q
ADDSTR(RR,S) //ДОБАВИТЬ СТРОКУ В ПРОГРАММУ
 S RSTR=RSTR+1,ROUTINE(RSTR)=S
 Q
NEWROU(R) K ROUTINE
 S ROUTINE(1)=" //Программа создающая массив"
 S BTR=$L(ROUTINE(1)),RSTR=1,LTR=$G(LTR)+1,LTR(LTR)=R
 Q
SAVEROU(R) //СОХРАНИТЬ ПРОГРАММУ
 S ROUTINE(0)=RSTR
 D ROUTINE^%R(R_".INT",.ROUTINE,.err,"CS",0)
 I $G(err)'="" W $$FMTERR^%R(.err,.ROUTINE) S ERROR=ERROR+1
 E  W !,R," Ok"
 Q
MIR //СОЗДАТЬ ДИСТРИБУТИВ %GKDO*.RR %MIR*.RGR --- ДИСПЕТЧЕР ДОКУМЕНТОВ --- МИРЕНБУРГ АНДРЕЙ ЛЬВОВИЧ
 D DeltempBS
 N %FN,%DEV,NFN,LR,LTR
 S PR1=$$GETOPT^%ZAPM.ed.BSC4cfgP("^%ZAPM.ed.BSETUP(""ISS"")","bBSDSR")_"%GKDOC.rg"
 ;S PR1=$g(^%ZAPM.ed.BSETUP("BSDSR",0),"D:/MSW/!")_"/%GKDOC.rg"
 I '$$OPENFILE(PR1,$G(AUTO)) Q
 D GSAVE("+%MIR*","tempBS")
 W !!! i $$RREST("tempBS") w "Есть ошибки !!!",!!! q
 U %DEV ;s ^%ZAPM.ed.BSETUP("BSDSR","%MIR")=$p(%FN,"/",1,$l(%FN,"/")-1)
 D RComment("%GKDOC-routine. Version "_$$ver^%ZAPM.ed.BSC),RO("^ROUTINE","INT",1,0,"+%GKDO*"),RO("^ROUTINE","INT",1,0,"+tempBS*") W !!!!
 C %DEV U 0 D DeltempBS
 Q               
DeltempBS I $$EXIST^%R("tempBS.INT")     D DelRou^tempBS,DEL1("tempBS.*") Q
DEL1(r) i $$ZV^%ZAPM.ed.BSCp>5 s r=$p(r,".*")
 d DEL^%R(r)
 q
DELs(mask) //удаление программ по маске
 q
 n i,ii
 S (i,ii)=$p(mask,"*") d  F  S i=$O(^ROUTINE(i)) Q:i=""  d
 .i $Zname(i,1) i ("@"_i)[("@"_ii) w !,$$DEL^%R(i)
 q 
 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
 ;Модуль выкачки массивов из MSM в ^%ZZZ 
 ;0. Перенести в MSM под именем ^z в кип PRG
 ;1. создать там новый том ZZZ,ZZZ для хранения массива Z с длиной узла до 511
 ;2. запустить gd^z
 ;3. перенести массив ^[""ZZZ"",""ZZZ""]Z в Кашу в namespace PRG
 ;4. восстановить d Z^%ZAPM.ed.BSC4r4("^Z")
g2g(G,gl) ;положить глобаль в линейный массив
 s LONG=200
 i $g(gl)="" s gl="^mtempGL"
 ;s l=0
 I $D(@G)'[0 D sAVENODE(G)
 S GG=G F  S GG=$ZO(@GG) Q:GG=""  D sAVENODE(GG)
 q
sAVENODE(GG) ;СОХРАНИТЬ УЗЕЛ
  S BT=$g(BT)+$L(@GG)+$L(GG),ND=$g(ND)+1
  D G2M(@GG)
  S I="" F  S I=$O(STR(I)) Q:I=""  D
  .S BTR=$g(BTR)+$L(STR(I))
  .s l=l+1,@gl@(l,0)=$l(@GG)+$L(GG),@gl@(l)=$e(STR(I),1,510) i $e(STR(I),511)'="" s @gl@(l,1)=$e(STR(I),511,511+510) 
  Q
gMT k ^%ZZZ d g2g("^MT","^%ZZZ")
 q
g(gl) k @gl g gd1
gd s gl="^[""ZZZ"",""ZZZ""]Z" k @gl
gd1 S i="^",l=0 F  S i=$O(@i) Q:i=""  S i="^"_i w !,i D
 .;i i="^GRAF" w " пропущено <DKSER>" q
 .d g2g(i,gl)
 w !," количество ошибок: " zw ERR
 q
Z(G) ;Модуль закачки массивов из ^Z в ... с перекодирокой из ASCII в ANSI
 s nm1="" //,(S1,S2)="" //
 d INIT^%ZAPM.ed.BSre(0) 
 i $g(G)="" S G="^Z" K ^%ZZZ,ERR
 S I="" F  S I=$O(@G@(I)) Q:I=""  S xxx=I
 .s cs=@G@(I,0),s=@G@(I) i $d(@G@(I,1)) s s=s_@G@(I,1)
 .s in=$p(s,"=",1),nm=$p($p(s," ^",2),"=",1) s v=$p(s,"=",2,999) 
 .D  i nm'=nm1 s nm1=nm k @("^"_nm1) w !,nm1_" "
 ..I nm["(" S nm=$P(nm,"(")
 ..I in["(",in'[")" S in=$p(s,"=",1,2),v=$p(s,"=",3,999) 
 ..I in["(",in'[")" S in=$p(s,"=",1,3),v=$p(s,"=",4,999) 
 .D  x "s ^%ZZZ="_v 
 ..I $E($g(@G@(I+1)),1,12)=" S @$ZR=@$ZR" S v=v_" "_@G@(I+1),I=I+1
 .S in=$P($tr(in,S1,S2),"S ",2,999) S @in=$tr(^%ZZZ,S1,S2)
 .s g=$zr,cs1=$l(g)+$L(@g) i cs1'=cs w !,g w " "_cs1_","_cs_" не совпадает кол-во символов" S ERR=$g(ERR)+1,ERR(ERR,g)=cs1
 q
 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
 //Создание дистрибутива комплекса АСУРП
PRG N LIST
 s dir="Z:\n\ASU-AST\Arhiv\rou\prg\"
 zn $$v^%ZAPM.ed.BSCp("vPRG")
 d addRou("+A*,+Q*,+W*,+E*,+R*,+T*,+Y*,+U*,+I*,+O*,+P*,+S*,+D*,+F*,+G*,+H*,+J*,+K*,+L*,+Z*,+X*,+C*,-CSP*,+V*,+B*,+N*,+M*")
 d addGlo("+BS*,-BSprot*,-BSbufS*,+MSM*,+ASU*") //"+A*,+Q*,+W*,+E*,+R*,+T*,+Y*,+U*,+I*,+O*,+P*,+S*,+D*,+F*,+G*,+H*,+J*,+K*,+L*,+Z*,+X*,+C*,+V*,+B*,+N*,+M*")
 s time=$zd($h,3)_"("_$tr($p($ZDATETIME($ZUTIL(188),1,1,2)," ",2),":","'")_")"
 do $system.OBJ.Export(.LIST,dir_time_"-prg.xml","d",.err)
 zn "%SYS" k LIST
 d addRou("+%BS*,+%ZM*,+%GBA*")
 d addGlo("+%ZM*")
 do $system.OBJ.Export(.LIST,dir_time_"-sys.xml","d",.err)
 w ! zw err
 Q
DescOut2File(ClassName,dir) //выгрузить в файл описание класса
 n menFile,menuU,OLDIO,pr,i,z
 d lp^%ZAPM.ed.BSCp2(ClassName,.pr)
 d menuBeg,menuTab,menuEnd
 q
menuTab 
 U menFile  w "<table border=1 >"
 w "<tr><td><b>Имя таблицы</b></td><td> -</td><td><b>"_ClassName_"</b></td></tr>"
 w "<tr><td><b>Описание таблицы</b></td><td> -</td><td><b>"_pr_"</b></td></tr>"
 w "<tr><td><i>Имя поля</i></td><td>Тип</td><td>Описание поля</td></tr>"
 S i="" F  S i=$O(pr(i)) Q:i=""  d
 .w "<tr><td><i>"_pr(i)_"</i></td><td>"_$g(pr(i,"type"))_"</td><td>"_$g(pr(i,"desc"),"?"_pr(i))_"</td></tr>"
 w "</table>"_BK
 U OLDIO q
menuBeg
 i pr["%Zen" s z="zen"
 s i=$o(pr("")) i i'="" i $g(pr(i,"type"))["%ZEN" s z="zen"
 S menFile=dir_$g(z,"tab")_ClassName_".html" ;I $ZU(140,4,menFile)'=0 
 S OLDIO=$I O menFile:"UWN" U menFile 
 D BEG1^%ZAPM.ed.BSC4 
 U OLDIO s menU=0
 q
menuEnd
 U menFile D END^%ZAPM.ed.BSC4 U OLDIO
 C menFile 
 q
addRouMac(MA) //Создание дистрибутива комплекса АСУРП программы MAC 
 n i,ii,rc,MI,MI2,MI3,MI4,MI5
 S (i,ii)=""  i '$g(noSay) w !,"выбираем MAC программы по маске :"_MA
 F  S i=$O(^rMAC(i)) Q:i=""  i $$MASK^%ZAPM.ed.BSC4r4(i,MA) s LIST(i_".MAC")=""  i '$g(noSay) w !,"MAC: "_i
 i $d(LIST(".MAC")) k LIST(".MAC")
 q
addRou(MA) //Создание дистрибутива комплекса АСУРП 
 n i,ii,rc,MI,MI2,MI3,MI4,MI5
 S (i,ii)=""  i '$g(noSay) w !,"выбираем INT программы по маске :"_MA
 F  S i=$O(^ROUTINE(i)) Q:i=""  i $$MASK^%ZAPM.ed.BSC4r4(i,MA) s LIST(i_".INT")="" 
 i $d(LIST(".INT")) k LIST(".INT")
 q
addGlo(MA)
 N t,NS,i,ii,rc,MI,MI2,MI3,MI4,MI5
 S NS=$ZU(5),t="^||mtempmBSdirGlob"
 D GetGlobalDir^%ZAPM.ed.BSCp(NS,t) 
 i '$g(noSay) w !,"выбираем глобали по маске :"_MA
 S i="" F ii=1:1 S i=$O(@t@(i)) Q:i=""  I $$MASK^%ZAPM.ed.BSC4r4(i,MA) s LIST(i_".GBL")="" 
 K @t
 q
AddMenu(a)  i '$g(noSay) w !,"выбираем меню ИП по маске :"_a
 n i
 s (a,i)=$p(a,$c(34),2) f  s i=$o(@g@(i)) q:i=""  i i[a  w !,i m @g1@(i)=@g@(i)
 s LIST(g1_".GBL")=""
 q
 //$$GetF^%ZAPM.ed.BSCtree("Security.Applications","ID","/csp/ndoc","Path","%SYS") = реальный путь
addCSP(dir)  i '$g(noSay) w !,"выбираем файлы по маске :"_dir
 n rs,dir1,file
 s dir=$zconvert($tr(dir,"\","/"),"L")
 i dir'["+",dir'["*" s LIST(dir)="" q  //явный путь
 i $e(dir)="+" s dir=$p($p(dir,"+",2,9),"*")
 s dir1=dir
 i $e(dir)'="/" s dir="/"_dir
 s dir2=$$GetF^%ZAPM.ed.BSCtree("Security.Applications","ID",dir,"Path","%SYS")
 ;w !,"---",7,dir2,7
 i "?."[dir2 s dir3=$p(dir,"/",$l(dir,"/")),dir2=$$GetF^%ZAPM.ed.BSCtree("Security.Applications","ID",$p(dir,"/",1,$l(dir,"/")-1),"Path","%SYS") d
 .;w !,"=====",$p(dir,"/",1,$l(dir,"/")-1)
 .i "?."'[dir2 s dir2=dir2_"/"_dir3 q
 .i "?."[dir2 s dir2=$$CacheSysDir^%ZAPM.ed.BSCp(dir)
 ;w !!!,1,dir2,1
 N i,in,U1,MAS,m,FN,FN1
 S MAS="m" K @MAS D FileListDir^%ZAPM.ed.BSCEXE(dir2,MAS,2,"")
 S U1="" F i=1:1 S U1=$O(@MAS@(U1)) Q:U1=""  D
 .S FN=$P(@MAS@(U1),"?",1)
 .s file=$ZCONVERT($tr(FN,"/","\"),"L")
 .w !,file
 .s LIST(dir1_$tr($p(file,$tr(dir1,"/","\"),2),"\","/"))=""
 q
addCls(MA) n ClassName,res i '$g(noSay)  w !,"выбираем классы по маске :"_MA
 N t,NS,i,ii,rc,MI,MI2,MI3,MI4,MI5
 s res=##class(%ResultSet).%New("%ClassDefinition.ClassInfo")
 i 'res w:$zu(67,10,$j)=1 !,"Can not open res" q
 d res.Execute()
 f  q:'res.Next()  d
 . s ClassName=res.GetData(1)
 . I $$MASK^%ZAPM.ed.BSC4r4(ClassName,MA) s LIST(ClassName_".CLS")="" i $g(^%ZAPM.ed.BS("Debug")) d DescOut2File(ClassName,"d:\_snap\")
 k res ;d res.%Close() 
 q
BuildMS(name,dir) //сборка по АРМу на основе конфигурационного файла MS, кладем в dir
 n i,ns,ons,LIST,err,g,g1
 i $g(name)="" q
 i '$g(noSay) w !,"======================== Сборка :"_name
 i $g(MS(name,"active"))=0  i '$g(noSay) w " билд не активен" q
 s ons=$zu(5),ns=$$%^%ZAPM.ed.BSCh($g(MS(name,"namespace")))
 i ns'="",ons'=ns zn ns
 i $e(dir,$l(dir))'="\" s dir=dir_"\"
 s g="^[""prg""]MSM.ASURP.MatrAcc",g1=g_"Tempo" k @g1
 s i="" f  s i=$o(MS(name,i)) q:i=""  d 
 .i $e(i,1,4)="menu" d AddMenu(MS(name,i)) q
 .i $e(i,1,3)="INT" d addRou(MS(name,i)) q
 .i $e(i,1,3)="GBL" d addGlo(MS(name,i)) q
 .i $e(i,1,3)="CLS" d addCls(MS(name,i)) q
 .i $e(i,1,3)="CSP" d addCSP(MS(name,i)) q
 .i $e(i,1,3)="MAC" d addRouMac(MS(name,i)) q
 i '$d(LIST) g BuildMS2
 ;;s LIST("d:\scool2007\!_Упражнения\UNITTE~1.DOC")=""
 n fn,%datetime,%date,%section,%namespace,a
 s %datetime=$zd($h,3)_"("_$tr($p($ZDATETIME($ZUTIL(188),1,1,2)," ",2),":.","'-")_")"
 s %date=$zd($h,3)
 s %namespace=$g(MS(name,"namespace")),%section=name
 s a=$g(MS(name,"sfilename")) i a="" s a="%section"
 e  i a'[$c(34) s a=$c(34)_a_$c(34)
 x "s a="_a
  s fn=dir_a_".xml" 
 do $system.OBJ.Export(.LIST,fn,"d",.err)
 w !!,"Выведено в файл :"_fn,!!
 w ! zw err
BuildMS2 zn ons
 k @g1
 q
LoadXML(BSfile) //загрузка из сборки
 n fn,g,g1,I,STOP,ERR,i,menu
 s fn=$$b64d^%ZAPM.ed.BSCp2(BSfile)
 //нужен ini файл для команд перед восстановлением....но пока так.//////////////////////////////////
LoadXMLint s g="^[""prg""]MSM.ASURP.MatrAcc",g1=g_"Tempo",g2=g_"Back" k @g1
 m @g2=@g  //сделаем запасную копию 
 w "Загрузка из сборки :",fn
 s name=$p(fn,"\",$l(fn,"\")),ns=$$%^%ZAPM.ed.BSCh($p(name,"_",2)) i ns'="" zn ns
 w !,"В рабочей области :"_$zu(5) 
 i '$d(auto) r !!,"Вы уверены? [YyнН/N] <N>",r q:r=""  q:"YyнН"'[r
 
 do $system.OBJ.Load(fn,"ck",.ERR) 
 S I="" F  S I=$O(ERR(I)) Q:I=""  D  ;Q:$G(STOP)
 .I ERR(I,"code")'=5475 S STOP=I Q
 .I ERR(I,"param",1)["%BSC" S STOP=I Q
 w !!,"Восстанавливаем меню ИП..."
 s i="" f  s i=$o(@g1@(i)) q:i=""  w !,i s menu=$p(i,":") i menu'="" s menu(menu)=""
 s i=""  f  s i=$o(@g@(i)) q:i=""  i $p(i,":")'="",$d(menu($p(i,":"))) k @g@(i) w !,"удалили : "_i
 m @g=@g1  
 i '$d(auto) D ANY^%ZAPM.ed.BSC4r4
 q 
LoadAllXml(sec,dirfile) n auto s auto=1
 d INI^%ZAPM.ed.BSCindx(dirfile,.MS)
 S i1="" F  S i1=$O(MS(sec,i1)) Q:i1=""  i $e(i1,1,4)="File" s fn=MS(sec,i1) i fn'="" d
 . w !,"//////////////////////////////////////////////////////////////////////////",!
 .d LoadXMLint
 D ANY^%ZAPM.ed.BSC4r4
 q
 
]]></Routine>


<Routine name="%ZAPM.ed.BSC4rou" type="MAC" languagemode="0"><![CDATA[
%BSC4rou ;Программа создания программных модулей
 ;
 ;    Copyright (C) 2002 Serge W. Mikhaylenko
 ;    All Rights Reserved
 ;
 q
MST  S @("^"_pin_".ROU")@(Rou,"MST")=newTP_","_Tab
 Q
UFD(pin,Rou,Tab) ;ПОКА ОТКЛЮЧЕНА - НЕ ОПРАВДАЛА СЕБЯ - НЕТ ИД СЕССИИ
 D MST S V=$$LNG^%ZAPM.ed.BSC4("Унифицированная форма занесения данных в таблицу")_" '"_Tab_"'"
 S @("^"_pin_".ROU")@(Rou,"REM")=V
 n BSSES,BSLOGIN,BSLABEL,BSG,BSGRANT,BSTOP
 S BSG="B4",BSRoutineId="????????"
 n C,H,T1,T2,I,TA,RT,PT,TAB,K,KI,Y,TN,GetField
 S C="UFD1 ; "_$$say2_" "_BK
 S C=C_" S V1="""_pin_""",V2="""_Tab_""""_BK
 S C=C_" D $$$ROU(""%BSCm3"",""T"")"_BK
 S C=C_" quit"_BK
 S H="<HTML><BODY>"_$$VAR(1,"UFD1"),BSLABEL="UFD1" 
 S H=H_"<a href="_$$add_">"_V_"</a>"_BK
 S H=H_"</BODY></HTML>"_BK
 g Save
RunCode(pin,Rou,Tab) ; 
 D MST S V=$$LNG^%ZAPM.ed.BSC4("Выполнить программу",226)
 S @("^"_pin_".ROU")@(Rou,"REM")=V
 n BSSES,BSLOGIN,BSLABEL,BSG,BSGRANT,BSTOP
 S BSG="B4",BSRoutineId="????????"
 n C,H,T1,T2,I,TA,RT,PT,TAB,K,KI,Y,TN,GetField
 S C="Variables1 ; "_$$say2_" "_$$hr_BK
 S C=C_" write ""<pre>"""_BK
 S C=C_" D $$$XECUTE(CACHECODE)"_BK
 S C=C_" write ""</pre>"""_BK
 S C=C_" quit"_BK
 S H="<HTML><BODY>"_$$VAR(1,"Variables1"),BSLABEL="Variables1" 
 S H=H_$$form("NameForm")        
 S H=H_"<textarea cols=70 rows=5 name='CACHECODE'> "_BK
 S H=H_" W ""<br>СЕГОДНЯ: "",$ZD($H,3)"_BK_" W ""<br>СЕЙЧАС: "",$ZT($P($H,"","",2),1) </textarea><br>"_BK
 S H=H_"<input type='submit' name='Run' title='"_$$LNG^%ZAPM.ed.BSC4("Выполнить программу",226)_"' value='RUN'>"_BBK
 S H=H_RED_$$LNG^%ZAPM.ed.BSC4("Не используйте макрос $$$XECUTE в цикле, так как при каждом его выполнении создается и компилирутся программа, а по окончании выполнения она удаляется.")_EF_BK
 S H=H_"</form></center></BODY></HTML>"_BK
 g Save
Populate(pin,Rou,Tab) I $G(Tab)="" G TabEmpty
 D MST S V=$$LNG^%ZAPM.ed.BSC4(" Создать тестовые записи для `",228)_Tab_"` "
 S @("^"_pin_".ROU")@(Rou,"REM")=V
 n BSSES,BSLOGIN,BSLABEL,BSG,BSGRANT,BSTOP
 S BSG="B4",BSRoutineId="????????"
 n C,H,T1,T2,I,TA,RT,PT,TAB,K,KI,Y,TN,GetField
 S C="Populate1 ; "_$$say2_" "_$$hr_BK
 S C=C_" s Num=50 do Pop(Num)"_BK
 S C=C_" w !,"""_$$LNG^%ZAPM.ed.BSC4("Создание",229)_" ""_(Num-$G(Error))_"" "_$$LNG^%ZAPM.ed.BSC4("записей произведено",230)_""""_BK
 S C=C_"  d ShowRow(100) quit"_BK
 d InputForm1
 S C=C_" quit"_BK
 S C=C_"Pop(N) for i=1:1:N do  ;"_$$LNG^%ZAPM.ed.BSC4("создание N записей",231)_""_BK
 F I=1:1:K S C=C_"  .set "_$p(C1,",",I)_"=$$RandomField(10)"_BK  
 S C=C_"  .do NewRow if SQLCODE'=0 s Error=$G(Error)+1"_BK       
 S C=C_" quit"_BK
 S C=C_"RandomField(N) ;"_$$LNG^%ZAPM.ed.BSC4("создание строки из N случайных символов",232)_""_BK
 S C=C_" new st,str ;"_$$LNG^%ZAPM.ed.BSC4("делаем приватными переменные",233)_" st,str"_BK     
 S C=C_"  set str="""" ; "_$$LNG^%ZAPM.ed.BSC4("делаем начальное присвоение",234)_""_BK 
 S C=C_"  for st=1:1:N set str=str_$char($$CodeLetter)"_BK       
 S C=C_" quit str ;"_$$LNG^%ZAPM.ed.BSC4("возвратить строку",235)_""_BK
 S C=C_"CodeLetter() ;"_$$LNG^%ZAPM.ed.BSC4("функция возвращает код случайной буквы",236)_""_BK
 S C=C_" new с"_BK       
 S C=C_" for  set c=$R(255) if c>64&(c<123)!(c>191&(c<256)) q  "_BK      
 S C=C_" q c"_BK 
 d ShowRow S C=C_" quit"_BK
 ;-----------------------------------------
 S H=$$VAR(1,"Populate1"),BSLABEL="Populate1" 
 S H=H_"<a href="_$$add_">"_$$LNG^%ZAPM.ed.BSC4("Создать для таблицы 50 тестовых записей",237)_"</a>"_BK
 S H=H_"</center>"_BK
 g Save
DynamicSQL(pin,Rou,Tab)  I $G(Tab)="" G TabEmpty
 D MST S V=" "_$$LNG^%ZAPM.ed.BSC4("Динамические SQL запросы для `",238)_""_Tab_"` "
 S @("^"_pin_".ROU")@(Rou,"REM")=V
 n BSSES,BSLOGIN,BSLABEL,BSG,BSGRANT,BSTOP
 S BSG="B4",BSRoutineId="????????"
 n C,H,T1,T2,I,TA,RT,PT,TAB,K,KI,Y,TN,GetField
 s C="DynSQL ; "_$$say2_V_BK_$$hr_BK
 S C=C_"DynSQL1 ; (вариант 1)"_$$hr_BK
 S C=C_" set Header="""_V_""" // "_$$LNG^%ZAPM.ed.BSC4("заголовок страницы",186)_""_BK  
 S C=C_" &html<"_BK
 S C=C_"<html><title>#(Header)#</title>"_BK
 S C=C_"<body><center><H4>#(Header)#</H4>"_BK
 D 
 .N BSRoutineId
 .S C=C_""_$$form("NameForm")
 S C=C_"<input type='hidden' name='BSLABEL' value='DynSQL2'>"_BK
 S C=C_">"_BK
 S C=C_" set Maxfeild=$$$CoutFeild("""_BSPRO_""","""_Tab_""") //"_$$LNG^%ZAPM.ed.BSC4("количество полей",187)_""_BK
 
 S C=C_" G:$D(SQLstr1) L2  set var2="""" //"_$$LNG^%ZAPM.ed.BSC4("начальное пустое значение",239)_""_BK
 S C=C_" set SQLstr1=""INSERT INTO ""_$$$NameTable("""_BSPRO_""","""_Tab_""")_"" ("" //"_$$LNG^%ZAPM.ed.BSC4("присвоим начальное значение строки утверждения",240)_""_BK
 S C=C_" for Num=1:1:Maxfeild {  //"_$$LNG^%ZAPM.ed.BSC4("цикл по всем полям",198)_""_BK
 S C=C_"    set var1=$$$GetFeild("""_BSPRO_""","""_Tab_""",Num) //"_$$LNG^%ZAPM.ed.BSC4("взять все атрибуты текущего поля в переменную",241)_""_BK
 S C=C_"    set NameFeild=$P(var1,""~"",1) //"_$$LNG^%ZAPM.ed.BSC4("вычленить имя поля",196)_""_BK
 S C=C_"    s SQLstr1=SQLstr1_NameFeild //"_$$LNG^%ZAPM.ed.BSC4("присвоить имя поля к строке утверждения",242)_""_BK
 S C=C_"    s var2=var2_""'ТЕСТОВОЕ ЗНАЧЕНИЕ'"" //"_$$LNG^%ZAPM.ed.BSC4("присвоить имя поля к строке утверждения",242)_""_BK
 S C=C_"     if Num'=Maxfeild s SQLstr1=SQLstr1_"", "",var2=var2_"", "" //"_$$LNG^%ZAPM.ed.BSC4("присвоить запятую если это не последнее поле",243)_""_BK
 S C=C_"  }"_BK
 S C=C_" s SQLstr1=SQLstr1_"") VALUES (""_var2_"")"" //"_$$LNG^%ZAPM.ed.BSC4("присвоить имя поля к строке утверждения",242)_""_BK
 S C=C_"L2 w ""<table border=0>"""_BK
 S C=C_" w ""<tr><td><input type='submit' name='INSERT' value='"_$$LNG^%ZAPM.ed.BSC4("Вставить",244)_"'></td><td><textarea cols=70 rows=5 name='SQLstr1'>"",SQLstr1,""</textarea></td></tr>"""_BK
 
 S C=C_" G:$D(SQLstr2) L3  set var2="""" //"_$$LNG^%ZAPM.ed.BSC4("начальное пустое значение",239)_""_BK
 S C=C_" set SQLstr2=""UPDATE ""_$$$NameTable("""_BSPRO_""","""_Tab_""")_"" SET "" //"_$$LNG^%ZAPM.ed.BSC4("присвоим начальное значение строки утверждения",240)_""_BK
 S C=C_" for Num=1:1:Maxfeild {  //"_$$LNG^%ZAPM.ed.BSC4("цикл по всем полям",198)_""_BK
 S C=C_"    set var1=$$$GetFeild("""_BSPRO_""","""_Tab_""",Num) //"_$$LNG^%ZAPM.ed.BSC4("взять все атрибуты текущего поля в переменную",241)_""_BK
 S C=C_"    set NameFeild=$P(var1,""~"",1) //"_$$LNG^%ZAPM.ed.BSC4("вычленить имя поля",196)_""_BK
 S C=C_"     if Num=1 set var2=NameFeild //"_$$LNG^%ZAPM.ed.BSC4("запомнить первое поле",245)_""_BK
 S C=C_"    s:Num'=1 SQLstr2=SQLstr2_NameFeild_""='НОВОЕ ТЕСТОВОЕ ЗНАЧЕНИЕ'"" //"_$$LNG^%ZAPM.ed.BSC4("присвоить имя поля к строке утверждения, если это не 1 поле",246)_""_BK
 S C=C_"     if Num'=Maxfeild s:Num'=1 SQLstr2=SQLstr2_"", "" //"_$$LNG^%ZAPM.ed.BSC4("присвоить запятую если это не последнее поле",243)_""_BK
 S C=C_"  }"_BK
 S C=C_" s SQLstr2=SQLstr2_"" WHERE ""_var2_""='ТЕСТОВОЕ ЗНАЧЕНИЕ'"" //"_$$LNG^%ZAPM.ed.BSC4("присвоить имя поля к строке утверждения",242)_""_BK
 S C=C_"L3 write ""<tr><td><input type='submit' name='UPDATE' value='"_$$LNG^%ZAPM.ed.BSC4("Обновить",247)_"'></td><td><textarea cols=70 rows=5 name='SQLstr2'>""_SQLstr2_""</textarea></td></tr>""  "_BK
 
 S C=C_" G:$D(SQLstr3) L4  set var2="""" //"_$$LNG^%ZAPM.ed.BSC4("начальное пустое значение",239)_""_BK
 S C=C_" set SQLstr3=""DELETE FROM ""_$$$NameTable("""_BSPRO_""","""_Tab_""")_"" "" //"_$$LNG^%ZAPM.ed.BSC4("присвоим начальное значение строки утверждения",240)_""_BK
 S C=C_" for Num=1:1:Maxfeild {  //"_$$LNG^%ZAPM.ed.BSC4("цикл по всем полям",198)_BK
 S C=C_"    set var1=$$$GetFeild("""_BSPRO_""","""_Tab_""",Num) //"_$$LNG^%ZAPM.ed.BSC4("взять все атрибуты текущего поля в переменную",241)_BK
 S C=C_"    set NameFeild=$P(var1,""~"",1) //"_$$LNG^%ZAPM.ed.BSC4("вычленить имя поля",196)_BK
 S C=C_"     if Num=1 set var2=NameFeild //"_$$LNG^%ZAPM.ed.BSC4("запомнить первое поле",245)_BK
 S C=C_"  }"_BK
 S C=C_" s SQLstr3=SQLstr3_"" WHERE ""_var2_""='ТЕСТОВОЕ ЗНАЧЕНИЕ'"" "_BK
 S C=C_"L4 write ""<tr><td><input type='submit' name='DELETE' value='"_$$LNG^%ZAPM.ed.BSC4("Удалить",119)_"'></td><td><textarea cols=70 rows=5 name='SQLstr3'>""_SQLstr3_""</textarea></td></tr>""  "_BK
 
 S C=C_" G:$D(SQLstr4) L5  set SQLstr4=""SELECT "" //"_$$LNG^%ZAPM.ed.BSC4("присвоим начальное значение стоки утверждения",248)_BK
 S C=C_" for Num=1:1:Maxfeild {  //"_$$LNG^%ZAPM.ed.BSC4("цикл по всем полям",198)_BK
 S C=C_"    set var1=$$$GetFeild("""_BSPRO_""","""_Tab_""",Num) //"_$$LNG^%ZAPM.ed.BSC4("взять все атрибуты текущего поля в переменную",241)_BK
 S C=C_"    set NameFeild=$P(var1,""~"",1) //"_$$LNG^%ZAPM.ed.BSC4("вычленить имя поля",196)_BK
 S C=C_"     if Num=1 set var2=NameFeild //"_$$LNG^%ZAPM.ed.BSC4("запомнить первое поле",245)_BK
 S C=C_"    s SQLstr4=SQLstr4_NameFeild //"_$$LNG^%ZAPM.ed.BSC4("присвоить имя поля к строке утверждения",242)_BK
 S C=C_"     if Num'=Maxfeild s SQLstr4=SQLstr4_"", "" //"_$$LNG^%ZAPM.ed.BSC4("присвоить запятую если это не последнее поле",243)_BK
 S C=C_"  }"_BK
 S C=C_" s SQLstr4=SQLstr4_"" FROM ""_$$$NameTable("""_BSPRO_""","""_Tab_""")_"" WHERE ""_var2_"" LIKE '%ТЕСТОВОЕ ЗНАЧЕНИЕ%'"" //"_$$LNG^%ZAPM.ed.BSC4("присвоить имя поля к строке утверждения",242)_BK
 S C=C_"L5 write ""<tr><td><input type='submit' name='SELECT' value='"_$$LNG^%ZAPM.ed.BSC4("Выбрать",249)_"'></td><td><textarea cols=70 rows=5 name='SQLstr4'>""_SQLstr4_""</textarea></td></tr>""  "_BK
 S C=C_" &html<"_BK
 S C=C_"</table>"_BK
 S C=C_"<input type='hidden' name='BSRoutineId' value='#(BSRoutineId)#'>"_BK
 S C=C_"</center></form></body></html>"_BK
 S C=C_">"_BK
 
 S C=C_" quit"_BK
 S C=C_"DynSQL2 ; "_$$hr_BK
 S C=C_" if $D(SELECT) set SQLstat=SQLstr4"_BK
 S C=C_" if $D(INSERT) set SQLstat=SQLstr1"_BK
 S C=C_" if $D(UPDATE) set SQLstat=SQLstr2"_BK
 S C=C_" if $D(DELETE) set SQLstat=SQLstr3"_BK
 D DYNS
 S C=C_" GOTO DynSQL1"_BK
 ;-----------------------------------------
 s H="<!-- "_$$say1_" -->"_BK
 S H=H_$$VAR(1,"DynSQL1"),BSLABEL="DynSQL1"
 S H=H_"<a href="_$$add_">"_$$LNG^%ZAPM.ed.BSC4("Вызвать сгенеренные на сервере формы Динамических SQL запросов",250)_"</a>"_BK
 S H=H_"</center>"_BK
 s H=H_$$end
 g Save
DYNS ;ТЕЛО ПРОГРАММЫ
 S C=C_" write ""<center>"" s result=$$$DynSQLprep(SQLstat,.hhh) //hhh - "_$$LNG^%ZAPM.ed.BSC4("ссылка на объект - результат запроса",251)_BK
 S C=C_" if +result=1 write """_GREEN_"SQL "_$$LNG^%ZAPM.ed.BSC4("утверждение выполнилось удачно",252)_"."_EF_""",! "_BK
 S C=C_" else  write """_RED_$$LNG^%ZAPM.ed.BSC4("Ошибка выполнения SQL утверждения",253)_" : "_EF_"""_$$$MsgSQLError(result) goto DynSQL2end"_BK
 S C=C_" w ""<table border=1>"" new allcol,row2 //"_$$LNG^%ZAPM.ed.BSC4("делаем приватной переменную",254)_" allcol и row2"_BK
 S C=C_" s x=$$$DynSQLColInfo(.COL,.hhh) // "_$$LNG^%ZAPM.ed.BSC4("получим информацию о колонках, она присвоится в переменную",255)_" COL"_BK
 S C=C_"  for  Q:$$$DynSQLfetch(.hhh,.row1,.STOP)=1  s row2=$G(row2)+1  D  //"_$$LNG^%ZAPM.ed.BSC4("цикл по всем записям результата выполнения утверждения",256)_BK
 S C=C_"  .if '$D(allcol) s allcol=$LISTLENGTH(row1) d  //"_$$LNG^%ZAPM.ed.BSC4("один раз вычисляется количество колонок в результате запроса",257)_BK
 S C=C_"  ..W ""<tr><td bgcolor=#E4E4E4>.</td>"""_BK
 S C=C_"  .. for col=1:1:allcol W ""<td bgcolor=#E4E4E4>"",$$$DynSQLcol(COL,col),""</td>""  //"_$$LNG^%ZAPM.ed.BSC4("цикл по колонкам",258)_BK
 S C=C_"  .W ""<tr><td bgcolor=#E4E4E4>"",row2,""</td>"""_BK
 S C=C_"  . for col=1:1:allcol do  //"_$$LNG^%ZAPM.ed.BSC4("цикл по колонкам",258)_BK
 S C=C_"  ..W ""<td>"",$$$DynSQLGetData(row1,col),""</td>"""_BK
 S C=C_"  .W ""</tr>"""_BK       
 S C=C_" w ""</table><BR>"""_BK
 S C=C_" if '$D(row2) w ""<br>"_$$LNG^%ZAPM.ed.BSC4("но нет ни одной записи удовлетворяющей предложенным условиям",259)_""""_BK
 S C=C_"DynSQL2end  w $$$DynSQLclose(.hhh)"_BK
 S C=C_"  write ""</center>"""_BK
 Q       
Find(pin,Rou,Tab)  I $G(Tab)="" G TabEmpty
 D MST S V=" Модуль поиска для `"_Tab_"` "
 S @("^"_pin_".ROU")@(Rou,"REM")=V
 n BSSES,BSLOGIN,BSLABEL,BSG,BSGRANT,BSTOP
 S BSG="B4",BSRoutineId="????????"
 n C,H,T1,T2,I,TA,RT,PT,TAB,K,KI,Y,TN,GetField
 s C="Find ; "_$$say2_V_BK_$$hr_BK
 S C=C_"Find1 ; "_$$hr_BK
 S C=C_" set Header="""_V_""" // "_$$LNG^%ZAPM.ed.BSC4("заголовок страницы",186)_BK  
 S C=C_" &html<"_BK
 S C=C_"<html><title>#(Header)#</title>"_BK
 S C=C_"<body><center><H4>#(Header)#</H4>"_BK
 D 
 .N BSRoutineId
 .S C=C_""_$$form("NameForm")
 S C=C_"<input type='hidden' name='BSLABEL' value='Find2'>"_BK
 S C=C_"<table border=0>"_BK
 S C=C_">"_BK
 S C=C_" set Maxfeild=$$$CoutFeild("""_BSPRO_""","""_Tab_""") //"_$$LNG^%ZAPM.ed.BSC4("количество полей",187)_BK
 S C=C_" set MaxIndxfeild=$$$CoutIndxFeild("""_BSPRO_""","""_Tab_""") //"_$$LNG^%ZAPM.ed.BSC4("количество индексированных полей",188)_BK
 S C=C_" N Sel"_BK
 S C=C_" for Num=1:1:Maxfeild {  //"_$$LNG^%ZAPM.ed.BSC4("цикл по всем полям",198)_BK
 S C=C_"     set var1=$$$GetFeild("""_BSPRO_""","""_Tab_""",Num) //"_$$LNG^%ZAPM.ed.BSC4("взять все атрибуты текущего поля",195)_BK
 S C=C_"     set NameFeild=$P(var1,""~"",1) //"_$$LNG^%ZAPM.ed.BSC4("вычленить имя поля",196)_BK
 S C=C_"     set Description=$P(var1,""~"",2) //"_$$LNG^%ZAPM.ed.BSC4("вычленить описание поля",199)_BK
 S C=C_"     write ""<tr><td align='right'><strong>"" //"_$$LNG^%ZAPM.ed.BSC4("вывести начало строки таблицы",260)_BK
 S C=C_"       if MaxIndxfeild'<Num write ""<FONT COLOR=RED>*</FONT>"" //"_$$LNG^%ZAPM.ed.BSC4("вывести красную звездочку если поле индексированное",261)_BK
 S C=C_"     write Description,"" ("",NameFeild,"") <input type='checkbox' title='"_$$LNG^%ZAPM.ed.BSC4("поле учавствует в SQL запросе",262)_"' name='C""_Num_""' checked></strong></td>"""_BK
 S C=C_"     write ""<td> AS <input type='text' size=7 maxlength=48 title='"_$$LNG^%ZAPM.ed.BSC4("превдоним",263)_"' name='A""_Num_""' value=''>"""_BK
 S C=C_"     write ""</td></tr>"" //"_$$LNG^%ZAPM.ed.BSC4("вывести окончание строки таблицы",264)_BK
 S C=C_"      if '$D(Sel) s Sel=""<option value='""_NameFeild_""' selected>""_NameFeild_""</option>"" //"_$$LNG^%ZAPM.ed.BSC4("подготовить опции для",265)_" SELECT"_BK
 S C=C_"      else  set Sel=Sel_""<option value='""_NameFeild_""'>""_NameFeild_""</option>"""_BK
 S C=C_"     }"_BK
 S C=C_" write ""<input type='hidden' name='BSRoutineId' value='""_BSRoutineId_""'>"""_BK
 S C=C_" &html<"_BK
 S C=C_"</table><hr>"_BK 
 S C=C_"<select name='FIELD1'>#(Sel)#</select><select name='OPER1'><option value='1' selected>равно</option><option value='2'>"_$$LNG^%ZAPM.ed.BSC4("начинается",266)_"</option><option value='3'>"_$$LNG^%ZAPM.ed.BSC4("включает",267)_"</option></select>"_BK
 S C=C_"<input type='text' size=7 maxlength=48 title='"_$$LNG^%ZAPM.ed.BSC4("строка",268)_"' name='STR1' value='123'><br><input type='submit' name='Find1' title='"_$$LNG^%ZAPM.ed.BSC4("искать",269)_"' value='"_$$LNG^%ZAPM.ed.BSC4("Искать",270)_"'>"_BK
 S C=C_"<br><hr><FONT COLOR=RED>*</FONT> "_$$LNG^%ZAPM.ed.BSC4("обязательные (индексированные) показатели",271)_"</form>"_BK
 S C=C_"</center></body></html>"_BK
 S C=C_">"_BK
 S C=C_" quit  ;"_$$LNG^%ZAPM.ed.BSC4("внутри тела макроса &html можно применять выражения COS в скобках",272)_" #(...)#"_BK
 S C=C_"Find2 ; "_$$hr_BK
 S C=C_" &html<"_BK
 S C=C_"<html><title></title>"_BK
 S C=C_"<body><center><H4>SQL "_$$LNG^%ZAPM.ed.BSC4("утверждение",273)_"</H4>"_BK
 D 
 .N BSRoutineId
 .S C=C_""_$$form("NameForm")
 S C=C_">"_BK
 S C=C_" set Maxfeild=$$$CoutFeild("""_BSPRO_""","""_Tab_""") //"_$$LNG^%ZAPM.ed.BSC4("количество полей",187)_BK
 S C=C_" s SQL=""SELECT "" "_BK
 S C=C_" for Num=1:1:Maxfeild if $$$DDATA(""C""_Num) D  //"_$$LNG^%ZAPM.ed.BSC4("цикл по всем полям",198)_BK
 S C=C_"    .set var1=$$$GetFeild("""_BSPRO_""","""_Tab_""",Num) //"_$$LNG^%ZAPM.ed.BSC4("взять все атрибуты текущего поля в переменную",241)_BK
 S C=C_"    .set NameFeild=$P(var1,""~"",1) //"_$$LNG^%ZAPM.ed.BSC4("вычленить имя поля",196)_BK
 S C=C_"    .s SQL=SQL_NameFeild if $$$DGET(""A""_Num)'="""" s SQL=SQL_"" AS ""_$$$DGET(""A""_Num) //"_$$LNG^%ZAPM.ed.BSC4("присвоить имя поля к строке утверждения",242)_BK
 S C=C_"    . if Num'=Maxfeild s SQL=SQL_"", "" //"_$$LNG^%ZAPM.ed.BSC4("присвоить запятую если это не последнее поле",243)_BK
 S C=C_" IF $G(OPER1)=1 S S1=""="",(S2,S3)="""" "_BK
 S C=C_" IF $G(OPER1)=2 S S1=""LIKE"",S2="""",S3=""%"" "_BK
 S C=C_" IF $G(OPER1)=3 S S1=""LIKE"",S2=""%"",S3=""%"" "_BK     
 S C=C_" s SQLstat=SQL_"" FROM ""_$$$NameTable("""_BSPRO_""","""_Tab_""")_"" WHERE ""_FIELD1_"" ""_S1_"" '""_S2_STR1_S3_""'"" //"_$$LNG^%ZAPM.ed.BSC4("присвоить имя поля к строке утверждения",242)_BK
 S C=C_" write ""<input type='hidden' name='BSRoutineId' value='""_BSRoutineId_""'>"""_BK
 S C=C_" write ""<textarea cols=70 rows=5 name='SQLstat'>""_SQLstat_""</textarea>"""_BK
 S C=C_" write ""<input type='submit' name='SELECT' value='"_$$LNG^%ZAPM.ed.BSC4("Выбрать",249)_"'>"""_BK
 S C=C_" W ""<input type='hidden' name='BSLABEL' value='Find3'>"""_BK
 S C=C_" W ""</form></center></body></html>"""_BK        
 S C=C_" quit  "_BK
 S C=C_"Find3 ; "_$$hr_BK
 D DYNS
 S C=C_" G Find1"_BK
 ;-----------------------------------------
 s H="<!-- "_$$say1_" -->"_BK
 S H=H_$$VAR(1,"Find1"),BSLABEL="Find1"
 S H=H_"<a href="_$$add_">"_$$LNG^%ZAPM.ed.BSC4("Вызвать поисковый модуль",274)_"</a>"_BK
 S H=H_"</center>"_BK
 s H=H_$$end
 g Save
Navigator(pin,Rou,Tab) I $G(Tab)="" G TabEmpty
 D MST S V=" "_$$LNG^%ZAPM.ed.BSC4("Навигатор прямого доступа к таблице `",275)_Tab_"` "
 S @("^"_pin_".ROU")@(Rou,"REM")=V
 n BSSES,BSLOGIN,BSLABEL,BSG,BSGRANT,BSTOP
 S BSG="B4",BSRoutineId="????????"
 n C,H,T1,T2,I,TA,RT,PT,TAB,K,KI,Y,TN,GetField
 s C="Navigator ; "_$$say2_V_BK_$$hr_BK
 S C=C_" set Home1=1 "_BK     
 S C=C_"Navig1 ; "_$$hr_BK
 S C=C_" set Header="""_V_""" // "_$$LNG^%ZAPM.ed.BSC4("заголовок страницы",186)_BK  
 S C=C_" set Max=$$$CoutFeild("""_BSPRO_""","""_Tab_""") //"_$$LNG^%ZAPM.ed.BSC4("количество полей",187)_BK
 S C=C_" set MaxI=$$$CoutIndxFeild("""_BSPRO_""","""_Tab_""") //"_$$LNG^%ZAPM.ed.BSC4("количество индексированных полей",188)_BK
 S C=C_" D $$$DKILL(""Dis"") // "_$$LNG^%ZAPM.ed.BSC4("удалить массив признака опции",189)_" DISABLE"_BK
 S C=C_" D $$$DKILL(""STOP"") "_BK
 S C=C_" for Num=1:1:MaxI D  Q:$G(STOP)=1  G:$G(STOP)=2 Navigator  //"_$$LNG^%ZAPM.ed.BSC4("цикл по индексным полям",190)_BK
 S C=C_"    .D KKey(Num)  "_BK
 S C=C_"    .IF $$$DDATA(""Home""_Num) D $$$DSET(""Home""_(Num+1),1) D $$$DSET(""value""_Num,$$$ORDER("""_BSPRO_""","""_Tab_""",.Key,"""",1)) D CheckL Q:$D(STOP)  "_BK
 S C=C_"    .IF $$$DDATA(""End""_Num) D $$$DSET(""Home""_(Num+1),1) D $$$DSET(""value""_Num,$$$ORDER("""_BSPRO_""","""_Tab_""",.Key,"""",-1)) D CheckR "_BK
 S C=C_"    .IF $$$DDATA(""Del""_Num) D $$$DKILL(""Del""_Num) D $$$DSET(""Left""_Num,1) D $$$KillDirectTab("""_BSPRO_""","""_Tab_""",.Key) //"_$$LNG^%ZAPM.ed.BSC4("удалить узел ",191)_BK
 S C=C_"    .IF $$$DDATA(""Left""_Num) D $$$DSET(""Home""_(Num+1),1) D $$$DSET(""value""_Num,$$$ORDER("""_BSPRO_""","""_Tab_""",.Key,$$$DGET(""value""_Num),-1)) D CheckL Q:$D(STOP)  "_BK
 S C=C_"    .IF $$$DDATA(""Right""_Num) D $$$DSET(""Home""_(Num+1),1) D $$$DSET(""value""_Num,$$$ORDER("""_BSPRO_""","""_Tab_""",.Key,$$$DGET(""value""_Num),1)) D CheckR "_BK
 S C=C_"    .S Dis(Num,1)=($$$ORDER("""_BSPRO_""","""_Tab_""",.Key,$$$DGET(""value""_Num),-1)="""") "_BK
 S C=C_"    .S Dis(Num,2)=($$$ORDER("""_BSPRO_""","""_Tab_""",.Key,$$$DGET(""value""_Num),1)="""") "_BK
 S C=C_" &html<"_BK
 S C=C_"<html><title>#(Header)#</title>"_BK
 S C=C_"<body><center><H4>#(Header)#</H4>"_BK
 D 
 .N BSRoutineId
 .S C=C_""_$$form("NameForm")
 S C=C_"<input type='hidden' name='BSLABEL' value='Navig2'>"_BK
 S C=C_"<table border=0>"_BK
 S C=C_">"_BK
 S C=C_"   D $$$DSET(""Key(Key)"",$$$DGET(""value""_Num)) //"_$$LNG^%ZAPM.ed.BSC4("присвоить значение последнего индекса ",276)_BK
 S C=C_"    IF $D(Save) D  //присвоить исправления"_BK
 S C=C_"       .for Num=(MaxI+1):1:Max D  //"_$$LNG^%ZAPM.ed.BSC4("цикл по всем неиндексным полям",194)_BK
 S C=C_"       ..set var1=$$$GetFeild("""_BSPRO_""","""_Tab_""",Num) //"_$$LNG^%ZAPM.ed.BSC4("взять все атрибуты текущего поля",195)_BK
 S C=C_"       ..set NameFeild=$P(var1,""~"",1) //"_$$LNG^%ZAPM.ed.BSC4("вычленить имя поля",196)_BK
 S C=C_"       ..IF $$$SetDirectTab("""_BSPRO_""","""_Tab_""",.Key,NameFeild,$$$DGET(""value""_Num)) //"_$$LNG^%ZAPM.ed.BSC4("присвоим в прямом доступе",197)_BK
 S C=C_"   for Num=1:1:Max {  //"_$$LNG^%ZAPM.ed.BSC4("цикл по всем полям",198)_BK
 S C=C_"     set var1=$$$GetFeild("""_BSPRO_""","""_Tab_""",Num) //"_$$LNG^%ZAPM.ed.BSC4("взять все атрибуты текущего поля",195)_BK
 S C=C_"     set NameFeild=$P(var1,""~"",1) //"_$$LNG^%ZAPM.ed.BSC4("вычленить имя поля",196)_BK
 S C=C_"     set Description=$P(var1,""~"",2) //"_$$LNG^%ZAPM.ed.BSC4("вычленить описание поля",199)_BK
 S C=C_"     write ""<tr>"" //"_$$LNG^%ZAPM.ed.BSC4("вывести описание",200)_BK
 S C=C_"     if $P(var1,""~"",4)'="""" D  //"_$$LNG^%ZAPM.ed.BSC4("эти поля индексные",201)_BK
 S C=C_"       .W ""<td align='right'><input type='submit' name='Del""_Num_""' title='"_$$LNG^%ZAPM.ed.BSC4("удалить узел",202)_" ""_$SELECT(Num=MaxI:"""",1:""со всеми потомками высших уровней"")_""' value='Удалить'>&nbsp;<input type='submit' ""_$$Disable(Num,1)_"" name='Home""_Num_""' value='&lt;&lt;'><input type='submit' name='Left""_Num_""' ""_$$Disable(Num,1)_"" value='&lt;'></td>"""_BK
 S C=C_"     if Num=(MaxI+1) w ""<tr><td><hr></td><td><hr></td><td></td><td><hr></td></tr><td align='right'><input type='submit' name='Save' value='Coхранить'></td>"" "_BK
 S C=C_"     if Num=(MaxI+2) w ""<td align='right'><input type='Reset' name='Reset' value='"_$$LNG^%ZAPM.ed.BSC4("Отменить",204)_"'></td>"" "_BK
 S C=C_"     if Num>(MaxI+2) w ""<td></td>"""_BK
 S C=C_"     if $P(var1,""~"",4)="""" D  //"_$$LNG^%ZAPM.ed.BSC4("эти поля неиндексные",205)_BK
 S C=C_"       .D $$$DSET(""value""_Num,$$$GetDirectTab("""_BSPRO_""","""_Tab_""",.Key,NameFeild)) //"_$$LNG^%ZAPM.ed.BSC4("прямой доступ к данным таблицы, когда знаешь индексы",206)_BK
 S C=C_"     if $P(var1,""~"",3)'=1 write ""<td><input type='text' size=40 maxlength=2048 title='""_NameFeild_""' name='value""_Num_""' value='""_$$$DGET(""value""_Num)_""'></td>"""_BK
 S C=C_"     if $P(var1,""~"",3)=1 write ""<td><textarea cols=40 rows=5 title='""_NameFeild_""' name='value""_Num_""' >""_$$$DGET(""value""_Num)_""</textarea></td>"""_BK
 S C=C_"     S var2=""<td align='left'>"" "_BK
 S C=C_"     if $P(var1,""~"",4)'="""" D  //"_$$LNG^%ZAPM.ed.BSC4("эти поля индексные",201)_BK
 S C=C_"       .S var2=var2_""<input type='submit' name='Right""_Num_""' ""_$$Disable(Num,2)_"" value='&gt;'><input type='submit' ""_$$Disable(Num,2)_"" name='End""_Num_""' value='&gt;&gt;'>"" "_BK
 S C=C_"     write var2_""</td>"" "_BK
 S C=C_"     write $$Desc("" (""_NameFeild_"") ""_Description)_""</tr>"" "_BK
 S C=C_"     }"_BK
 S C=C_" write ""<input type='hidden' name='BSRoutineId' value='""_BSRoutineId_""'>"""_BK
 S C=C_" &html<"_BK
 S C=C_"</table></form></center>"_BK
 S C=C_"</body></html>"_BK
 S C=C_">"_BK
 S C=C_" ;D $$$DoRou("""_BSPRO_""",""NewRoutin3"",""Variables1"") Q  "_BK
 S C=C_" quit"_BK
 S C=C_"Desc(D) Q ""<td align='lift'><strong>""_D_""</strong></td>"" //"_$$LNG^%ZAPM.ed.BSC4("вывести описание",200)_BK
 S C=C_"CheckL //"_$$LNG^%ZAPM.ed.BSC4("проверить значение ключей",211)_BK
 S C=C_" if $$$DGET(""value""_Num)="""" D $$$DSET(""value""_Num,$$$ORDER("""_BSPRO_""","""_Tab_""",.Key,"""",1)) d  "_BK
 S C=C_" .if $$$DGET(""value""_Num)="""" D  "_BK
 S C=C_" ..I Num=1 S STOP=1 Q  "_BK
 S C=C_" ..E  S Num=Num-1 S STOP=2"_BK
 S C=C_" quit"_BK
 S C=C_"CheckR //"_$$LNG^%ZAPM.ed.BSC4("проверить значение ключей",211)_BK
 S C=C_" if $$$DGET(""value""_Num)="""" D $$$DSET(""value""_Num,$$$ORDER("""_BSPRO_""","""_Tab_""",.Key,"""",-1)) d  "_BK
 S C=C_" .if $$$DGET(""value""_Num)="""" D  "_BK
 S C=C_" ..I Num=1 S STOP=1 Q  "_BK
 S C=C_" ..E  S Num=Num-1 S STOP=2"_BK
 S C=C_" quit"_BK
 S C=C_"Disable(N,A) Q $S($G(Dis(N,A)):""DISABLED"",1:"""") //"_$$LNG^%ZAPM.ed.BSC4("выставить опцию",212)_BK        
 S C=C_"KKey(k) //"_$$LNG^%ZAPM.ed.BSC4("подготовить массив данных узлов",213)_BK    
 S C=C_" D $$$DKILL(""Key"") //"_$$LNG^%ZAPM.ed.BSC4("Удалить массив",214)_BK
 S C=C_" n i f i=1:1:k s Key(i)=$$$DGET(""value""_i)"_BK 
 S C=C_" s Key=k Q"_BK   
 S C=C_"Navig2 ; "_$$hr_BK
 S C=C_" G Navig1"_BK    
 ;-----------------------------------------
 s H="<!-- "_$$say1_" -->"_BK
 S H=H_$$VAR(1,"Navigator"),BSLABEL="Navigator"
 S H=H_"<a href="_$$add_">"_$$LNG^%ZAPM.ed.BSC4("Загрузить навигатор прямого доступа",277)_"</a>"_BK
 S H=H_"</center>"_BK
 s H=H_$$end
 g Save
ShowRow S C=C_"ShowRow(MaxNum)  &sql(DECLARE ActiveRow CURSOR FOR SELECT "_C1_" INTO "_C2_" FROM "_TN_")"_BK
 S C=C_"  &sql(OPEN ActiveRow)"_BK
 S C=C_" W $$$Meta(1251)"_BK
 S C=C_"  write ""<center><br><table border=1><tr><td>"_$$LNG^%ZAPM.ed.BSC4("Имена полей",278)_"</td>"",!"_BK
 F I=1:1:K S C=C_"  write ""<td bgcolor=#B4B4B4>"_$$RedStar^%ZAPM.ed.BSC4rou(I'>INDX)_$p(C1,",",I)_"</td>"""_BK
 S C=C_"  write ""</tr>"",! set Num=0"_BK        
 S C=C_"  for   &sql(FETCH ActiveRow) q:SQLCODE'=0  q:MaxNum=Num  do  ;"_$$LNG^%ZAPM.ed.BSC4("цикл по выбранным записям",279)_BK
 S C=C_"  .write ""<tr>"",!"_BK
 S C=C_"  .set Num=Num+1   write ""<td bgcolor=#E4E4E4> "_$$LNG^%ZAPM.ed.BSC4("Запись",280)_" "",Num,""</td>"""_BK
 F I=1:1:K S C=C_"  .write ""<td>"",$G("_$p(C1,",",I)_"),""</td>"""_BK
 S C=C_"  .write ""</tr>"",!"_BK
 S C=C_"  &sql(CLOSE ActiveRow)"_BK
 S C=C_"  write ""</table><br></center>"",!"_BK  
 q
InputForm1 S TN=$TR(pin,".","_")_"."_Tab
 S C=C_"NewRow &sql( INSERT INTO "_TN_" ("
 s K=$$GetField("","","Count")   ;РАЗБОР ПОЛЕЙ ТАБЛИЦЫ
 S (I1,I2,C1,C2)="" F Y=1:1:K S TA=$$GetField("","",Y) D  ;NAME ~ DESCRIPTION ~ TYPE ~ INDEX
 .S C1=C1_$p(TA,"~",1),C2=C2_":"_$p(TA,"~",1) D  I Y'=K S C1=C1_",",C2=C2_"," ;ВСЕ ПОЛЯ
 .I $p(TA,"~",4) S INDX=Y,I1=I1_$p(TA,"~",1)_"=:"_$p(TA,"~",1)_" and "  ;ИНДЕКСНЫЕ ПОЛЯ
 .S I2=I2_$p(TA,"~",1)_"=:"_$p(TA,"~",1)_","
 S I1=$E(I1,1,$L(I1)-5),I2=$E(I2,1,$L(I2)-1)
 S C=C_C1_") VALUES ("_C2_") )"_BK
 q
InputForm(pin,Rou,Tab) I $G(Tab)="" G TabEmpty
 D MST 
 n BSSES,BSLOGIN,BSLABEL,BSG,BSGRANT,BSTOP
 S BSG="B4",BSRoutineId="????????"
 n C,H,T1,T2,I,TA,RT,PT,TAB,K,KI,Y,TN,GetField
 s I=$$LNG^%ZAPM.ed.BSC4("Форма ввода для",281)_" `"_Tab_"`"
 S @("^"_pin_".ROU")@(Rou,"REM")=I
 s C="InputForm ; "_$$say2_" ("_I_")"_BK_$$hr_BK                          ;_" #include %BSC4inc"_BK   
 S C=C_"Label1 ; ("_$$LNG^%ZAPM.ed.BSC4("вариант",282)_" 1)"_$$hr_BK
 S C=C_" do Update:$d(Upd),NewRow:$d(New),Delete:$d(Del) //"_$$LNG^%ZAPM.ed.BSC4("диспетчер",283)_BK
 S C=C_" do ShowRow($GET(CountRows,10)) // "_$$LNG^%ZAPM.ed.BSC4("ограничим вывод списка 10 записями, если неопределена переменная",284)_" CountRows"_BK        
 S C=C_" quit"_BK
 d InputForm1
 S C=C_" goto Final"_BK  
 S C=C_"Update &sql(UPDATE "_TN_" SET "_I2_" WHERE "_I1_")"_BK
 S C=C_" goto Final"_BK
 
 S C=C_"Delete &sql(DELETE FROM "_TN_" WHERE "_I1_")"_BK
 S C=C_" goto Final"_BK
 
 S C=C_"Final write ""<center>"" if '$Data(SQLCODE) quit  "_BK
 S C=C_" if SQLCODE=0 write """_GREEN_"SQL "_$$LNG^%ZAPM.ed.BSC4("утверждение выполнилось удачно",252)_"."_EF_""",! "_BK
 S C=C_" else  write """_RED_""_$$LNG^%ZAPM.ed.BSC4("Ошибка выполнения SQL утверждения",253)_" : "_EF_""",$$$ASqlError("""_BSDOMAIN_""","""_$$LNG^%ZAPM.ed.BSC4("смотреть код ошибки",285)_"""),SQLCODE,$$$A"_BK
 ;S C=C_" if SQLCODE=-119 write "" "_$$LNG^%ZAPM.ed.BSC4("Такая Запись уже есть",286)_" !"",! "_BK
 S C=C_"  write ""</center>"""_BK        
 S C=C_" quit"_BK
 
 d ShowRow ;SQL
 S C=C_" goto Label2"_BK
 
 S C=C_"Label2 ; (вариант 2)"_$$hr_BK
 S C=C_"     set var1=$$$GetFeild("""_BSPRO_""","""_Tab_""",1) //"_$$LNG^%ZAPM.ed.BSC4("взять атрибуты первого поля",287)_BK
 S C=C_"     set NameFeild=$P(var1,""~"",1) // "_$$LNG^%ZAPM.ed.BSC4("взять имя первого поля",288)_BK
 S C=C_"     set Header=""Форма ввода для `"_Tab_"`"" // "_$$LNG^%ZAPM.ed.BSC4("заголовок страницы",186)_BK  
 S C=C_" write ""<html><title>"",Header,""`</title>"""_BK
 //S C=C_" write ""<body onload='NameForm1.""_NameFeild_"".focus();'>"""_BK //ДАВАЛА ОШИБКУ
 S C=C_" write ""<body >"""_BK
 S C=C_" write ""<center><H3>"",Header,""</H3>"""_BK
 S C=C_" &html<"_BK      
 D 
 .N BSRoutineId
 .S C=C_""_$$form("NameForm")
 S C=C_"<input type='hidden' name='BSLABEL' value='Label1'>"_BK
 S C=C_"<table border=0>"_BK
 S C=C_">"_BK
 S C=C_" set Maxfeild=$$$CoutFeild("""_BSPRO_""","""_Tab_""") //"_$$LNG^%ZAPM.ed.BSC4("количество полей",187)_BK
 S C=C_" set MaxIndxfeild=$$$CoutIndxFeild("""_BSPRO_""","""_Tab_""") //"_$$LNG^%ZAPM.ed.BSC4("количество индексированных полей",188)_BK
 S C=C_" for Num=1:1:Maxfeild {  //"_$$LNG^%ZAPM.ed.BSC4("цикл по всем полям",198)_BK
 S C=C_"     set var1=$$$GetFeild("""_BSPRO_""","""_Tab_""",Num) //"_$$LNG^%ZAPM.ed.BSC4("взять все атрибуты текущего поля",195)_BK
 S C=C_"     set NameFeild=$P(var1,""~"",1) //"_$$LNG^%ZAPM.ed.BSC4("вычленить имя поля",196)_BK
 S C=C_"     set Description=$P(var1,""~"",2) //"_$$LNG^%ZAPM.ed.BSC4("вычленить описание поля",199)_BK
 S C=C_"     write ""<tr><td align='right'><strong>"" //"_$$LNG^%ZAPM.ed.BSC4("вывести начало строки таблицы",260)_BK
 S C=C_"       if MaxIndxfeild'<Num write ""<FONT COLOR=RED>*</FONT>"" //"_$$LNG^%ZAPM.ed.BSC4("вывести красную звездочку если поле индексированное",261)_BK
 S C=C_"     write Description,""</strong></td>"""_BK
 S C=C_"     if $P(var1,""~"",3)=1 write ""<td><textarea cols=40 rows=5 title='""_NameFeild_""' name='""_NameFeild_""' ></textarea>"""_BK
 S C=C_"     if $P(var1,""~"",3)'=1 write ""<td><input type='text' size=40 maxlength=2048 title='""_NameFeild_""' name='""_NameFeild_""' value=''>"""_BK
 S C=C_"     write ""</td></tr>"" //"_$$LNG^%ZAPM.ed.BSC4("вывести окончание строки таблицы",264)_BK
 S C=C_"     }"_BK
 S C=C_" write ""<input type='hidden' name='BSRoutineId' value='""_BSRoutineId_""'>"""_BK
 S C=C_" &html<"_BK
 S C=C_"</table><BR>"_BK 
 S C=C_"<input type='text' size=3 maxlength=3 title='"_$$LNG^%ZAPM.ed.BSC4("количество записей",289)_"' name='CountRows' value='#($g(CountRows,15))#'>"_BK      
 S C=C_"<input type='submit' name='Show' title='смотреть первые записи' value='смотреть записи'>"_BK
 S C=C_"<input type='submit' name='New' title='"_$$LNG^%ZAPM.ed.BSC4("создать новую запись",292)_"' value='"_$$LNG^%ZAPM.ed.BSC4("Новая запись",293)_"'>"_BK
 S C=C_"<input type='submit' name='Upd' title='"_$$LNG^%ZAPM.ed.BSC4("модифицировать существующую запись",294)_"' value='"_$$LNG^%ZAPM.ed.BSC4("Обновить запись",295)_"'>"_BK
 S C=C_"<input type='submit' name='Del' title='"_$$LNG^%ZAPM.ed.BSC4("удалить существующую запись",296)_"' value='"_$$LNG^%ZAPM.ed.BSC4("Удалить запись",297)_"'>"_BK
 S C=C_"<input type='reset' title='"_$$LNG^%ZAPM.ed.BSC4("Отменить текущие изменения",112)_"' name='Reset1' value='"_$$LNG^%ZAPM.ed.BSC4("Отменить",204)_"'>"_BK
 S C=C_"<br><FONT COLOR=RED>*</FONT> "_$$LNG^%ZAPM.ed.BSC4("обязательные (индексированные) показатели",271)_"</form></center>"_BK
 S C=C_"</center></body></html>"_BK
 S C=C_">"_BK
 S C=C_" quit   ;"_$$LNG^%ZAPM.ed.BSC4("внутри тела макроса &html можно применять выражения COS в скобках",272)_" #(...)#"_BK
 ;-----------------------------------------
 ;S BSLABEL="NewRow"
 s H="<!-- "_$$say1_" -->"_BK
 S H=H_$$VAR(1,"Label2"),BSLABEL="Label2"
 S H=H_"<a href="_$$add_">"_$$LNG^%ZAPM.ed.BSC4("Вызвать динамически сгенеренную на сервере форму ввода. Отрабатывают их статические SQL запросы",298)_"</a>"_BK
 S H=H_"</center>"_BK
 s H=H_$$end
Save S @("^"_pin_".ROU")@(Rou,"HTM")=H ;$$TR^%ZAPM.ed.BSsFUNM($$TR^%ZAPM.ed.BSsFUNM(H,"<","&lt;"),">","&gt;")
 S @("^"_pin_".ROU")@(Rou,"COS")=C ;$$TR^%ZAPM.ed.BSsFUNM($$TR^%ZAPM.ed.BSsFUNM(C,"<","&lt;"),">","&gt;")
 q
add() q $$ADDBSGET^%ZAPM.ed.BSC4("")   ;$P($G(HTTPREF),$G(MGWLIB),1)_$$ADDBSGET^%ZAPM.ed.BSC4("")
RedStar(a) i a q RED_"*"_EF
 q ""
TabEmpty W RED,$$LNG^%ZAPM.ed.BSC4("Вы не определили таблицу",299),EF Q
TypeBeg(t) q "<input type=""text"" size=27 maxlength=2048"
TypeEnd(t) q ""
NameTable(P,T) ;имя таблицы для SQL
 q $P($P(%ZName,"."),"^",2)_"_"_P_"."_T
GetField(P,T,A,BSFLAG) ;Информация по полям таблицы // Современем сделать по объектам
 N PT,a
 S a=$NA(@("GetField")@("1"_P,"2"_T))
 I $D(BSFLAG) G GetField1
 I P="" S P="^"_pin
 I P'["." D
 .I $D(pi) S P="^"_pi_"."_P Q
 .S P="^"_$P($P(%ZName,"."),"^",2)_"."_P Q
 I T="" S T=Tab
GetField1 S PT=$NA(@P@(T)) I '$$Data^%ZAPM.ed.BSF12(PT) Q "!NoTable="_PT
 N K,KI,TA,Y,I
 I '$D(@a) D GetMass 
 I A="Count" Q +$G(@a)
 I A="Index" Q $P($G(@a),",",2)
 I A?.N Q $G(@a@(A),"?")
 F I=1:1:+$G(@a) I $P($G(@a@(I),"?"),"~")=A Q
 q $G(@a@(I),"?")
GetMass          //ОСОБАЯ МОДЕЛЬ BS- БАЗ ДАННЫХ
 N X
 S K=0,KI=0   //...ИМЯ ПОЛЯ~ОПИСАНИЕ~ТИП ДАННЫХ~№ИНДЕКСА~YxX-НОМЕРА СТРОКxКОЛОНОК
 F Y=1:1 Q:'$D(@PT@("KEY",Y))  S K=K+1,TA=@PT@("KEY",Y),KI=K,@a@(K)=$P(TA,"@",22)_"~"_$P(TA,"@",17)_"~"_$P(TA,"@",21)_"~"_Y D
 .I $P(TA,"@",17)="" S $P(@a@(K),"~",2)=$P(TA,"@",9)
 .I $P(@a@(K),"~",1)="" S $P(@a@(K),"~",1)="KEY"_Y 
 .S $P(@a@(K),"~",5)=Y
 F Y=2:1 Q:'$D(@PT@(Y))  F X=1:1 Q:'$D(@PT@(Y,X))  I $P(@PT@(Y,X),"@",9)=2 S TA=@PT@(Y,X) S K=K+1 D 
 .S @a@(K)=$P($P(TA,"@",18),"#")_"~"_$P(TA,"@",17)_"~"_$P(TA,"@",21)
 .I $P(TA,"@",17)="" S $P(@a@(K),"~",2)=$P($P(TA,"@",18),"#")
 .S $P(@a@(K),"~",5)=Y_"x"_X
 S @a=K_","_KI
 Q
1 W BK,pin,BK
 W Rou,BK
 W Tab,BK Q
t1 q "&lt;"      
t2 q "&gt;"
VAR(N,L) Q "<hr><center><H2>"_$$say1_" ("_$$LNG^%ZAPM.ed.BSC4("вариант",282)_" "_N_")</H2> "_BK_$$cmt(L)_BK
cmt(L) Q AF_" "_$$LNG^%ZAPM.ed.BSC4("Этот HTML-код вызывает выполнение программного модуля Cache' с метки :",300)_L_" "_EF_"<br>"
say1() q $$LNG^%ZAPM.ed.BSC4("Пример HTML кода :",301)
say2() q $$LNG^%ZAPM.ed.BSC4("Пример CacheObjectScript кода :",302)
form(Tab) q "<form name='"_Tab_"1'  method='POST' action='#("_$$cgievar_")#' >"_BK_$$ADDBSPOST0^%ZAPM.ed.BSC4reg()_BK
beg(tit,first) q "<html><title>"_tit_"</title><body onload='"_Tab_"1."_first_".focus();'>"
end() q "</body></html>"
hr() q " ;"_$tr($j("",60)," ","=")
cgievar() q "$$ADDLIB^%ZAPM.ed.BSC4()" ; $p($g(%CGIEVAR("HTTP_REFERER")),"?")
]]></Routine>


<Routine name="%ZAPM.ed.BSC4rout" type="MAC" languagemode="0"><![CDATA[
%BSC4rout ; пpогpамма управления программами ; 11:12   12.09.2002
 ;
 ;    Copyright Serge W. Mikhaylenko
 ;    All Rights Reserved
 ;
 w "пpогpамма управления программами"
 Q
snrip() q "<BR>Имя сервера и порт :"_RED_$g(%CGIEVAR("SERVER_NAME"))_EF_"<br>IP адрес клиента :"_GREEN_$g(%CGIEVAR("REMOTE_ADDR"))_EF
snW() Q "Имя сервера ОС: <font color=red title='"_$$ipS^%ZAPM.ed.BSCp2_"'>"_$ZU(110)_EF
wnW() q "Веб сервер: "_RED_$G(%CGIEVAR("SERVER_SOFTWARE"))_EF
InfoSess //ИНФОРМАЦИЯ О СЕССИИ
 D BSdebug^%ZAPM.ed.BSC4
 I '$G(BSdebug) Q 
InfoSess3 I '$$GETOPT^%ZAPM.ed.BSC4cfg(MainOpt,"WebInfoSess") W $$snW_"<BR>"_$$wnW_$$snrip Q 
 W "<HR>"_AF
 I $G(BSdebug) W "Версия СУБД :<A TARGET='_new' TITLE='Лицензия' "_$s($G(BSSES)="":"",1:"HREF='"_$$ADDBSGET^%ZAPM.ed.BSC4(,"InfoKEY^~BSC4rout")_"'")_">"_$zv_"</A><BR>" W "Имя сервера :<font color=MAROON title='"_$$ipS^%ZAPM.ed.BSCp2_"'><A HREF='"_$$ADDBSGET^%ZAPM.ed.BSC4(,"IPA^~BSvdaSTAT")_"' TARGET='NEWIP'>"_$ZU(110)_"</A>"_EF
 E  W $$snW
 W " "_$$SysVer^%ZAPM.ed.BSCEXE
 I $G(BSdebug) W "<BR>"_$$wnW_BBK W "Веб клиент :"_MAROON_$G(NAVIG)_EF_$$snrip
 Q:$G(NoDetal)  Q:'$G(BSdebug) 
 W "<BR>Версия %BS :",RED,$$ver^%ZAPM.ed.BSC_EF_" Текущая конфигурация :"_RED_$$CFG^%ZAPM.ed.BSCp_EF_BBK
 W " ID процесса :",RED,$J,EF,", Сервис :",RED,$G(%KEY("MGWLPN"),"no weblink"),EF
  I '$G(%KEY("BSONLY")) W ", Рабочая область :",BLUE,$$ZU^%ZAPM.ed.BS3(0),EF,"<br> <font TITLE='Доступный размер раздела (байт)'>Доступный размер раздела (байт) :",MAROON,$S,EF,"</font><br> Текущее устройство вывода :",BLUE,$I,EF_BBK
 i $d(BSLOGIN) D
 .W "Имя пользователя :"_RED_$G(BSLOGIN,"?")_EF //_" Sessions id: "_RED_$$InfoSession($G(BSSES,"?"))_EF 
 .I $G(BSdebug) S CRLF=$C(13,10) d
 ..D ErrHEAD^%ZAPM.ed.BSCh0 D LOCLIST^%ZAPM.ed.BSCh0(1) 
 .;
 .;ЗАПУСТИТЬ ПОЛНЫЙ ТЕРМИНАЛ ЧЕРЕЗ RunDos.OCX
 .;S HREF=$$ADDBSGET^%ZAPM.ed.BSC4(,"InfoTerm^~BSC4rout"),TA="target=new"
 .;w " - <A HREF='"_HREF_"' "_TA_" TITLE='Загрузить терминал'>Terminal</A>"
 .;
 .;I $$PORT^%ZAPM.ed.BSpgTEL D  //Загрузить TCP-сокет
 .;.S HREF=$$ADDBSGET^%ZAPM.ed.BSC4(,"InfoTCP^~BSC4rout"),TA="target=new"
 .;.I WorkDir'="" S TA="",HREF="javascript: TELNETP(""1"",""$"",""$"",""BS_TELNET"");"
 .;.w " - <A HREF='"_HREF_"' "_TA_" TITLE='Загрузить TCP-сокет'>TCP-socket</A>"
 .;//test!!!
 .;I $$GETOPT^%ZAPM.ed.BSC4cfgP("^%ZAPM.ed.BSETUP(""ISS"")","AsysEInoActivX") 
 .;Q
 .i '$d(BSSES) Q
 .D ExecTel^%ZAPM.ed.BSCp D  //TECT!!!!!!
 ..;w BK_" - <A HREF=""javascript: Exec('C:/utl/UltraEdit/uedit32.exe','L:/MSW_Tools/_installation_ext/soft/dsr-client-dev/Support/Setup.Lst','L:/!');"" TITLE='Загрузить ЗАДАНИЕ'>EXE</A>"
 ..;w BK_" - <A HREF=""javascript: Exec('NOTEPAD.exe','L:/MSW_Tools/_installation_ext/soft/dsr-client-dev/Support/Setup.Lst','C:/Program Files/MSW-Tools/ClientIP/');"" TITLE='Загрузить ЗАДАНИЕ'>EXE</A>"
 ..;
 ..;В ТЕРМИНАЛЕ СМОТРЕТЬ УЗЛЫ ТЕКУЩЕЙ СЕССИИ
 ..w BK_"ID сессии :<A HREF=""javascript: "_$$TELNET^%ZAPM.ed.BSCp2("%SYS","#","InfoSessi^^%ZAPM.ed.BSC4rout("_BSSES_")","Sessions")_" "" TITLE='Sessions id: '>"_$G(BSSES)_"</A>"
 ..;
 ..;ЗАПУСТИТЬ ПОЛНЫЙ ТЕРМИНАЛ
 ..I $G(BSdebug) D
 ...w BK_" <A HREF=""javascript: "_$$TELNET^%ZAPM.ed.BSCp2("1","$","$","Terminal")_" "" TITLE='Загрузить Terminal'>Терминал</A>"
 ...w BK_" <A HREF=""javascript: "_$$TELNET^%ZAPM.ed.BSCp2("%SYS","%BSC","PROTECTM","Основные БД")_" "" TITLE='Основные БД'>Основные таблицы</A>"
 ...;w BK_" - <A HREF=""javascript: "_$$WebView^%ZAPM.ed.BSCp2("http://VM-MSW:1962/?BSTKWEB%20?BSG=Phone&&WEBPAGE=FRAMES")_" "" TITLE='Загрузить ЗАДАНИЕ'>WebView</A>"
 ...;w BK_" - <A HREF=""javascript: "_$$OpenWeb^%ZAPM.ed.BSCp2("http://"_$$ADDSN^%ZAPM.ed.BSC4_$$ADDBSGET^%ZAPM.ed.BSC4(,"InfoKEY^~BSC4rout"),"'")_" "" TITLE='Загрузить ЗАДАНИЕ'>OpenWeb</A>"
 ...//ПсевдоГиперСобытия
 ...;w BK_" <A HREF="""" onClick='"_$$HyperRunTel^%ZAPM.ed.BSCp2("1","$","$","Terminal")_"' TITLE='Загрузить Terminal через ПсевдоГиперСобытие'>HyperTerminal</A>"
 ...;w BK_" <A HREF="""" onClick='"_$$HyperRunTel^%ZAPM.ed.BSCp2("%SYS","%BSC","PROTECTM","Основные БД")_"' TITLE='Загрузить Terminal через ПсевдоГиперСобытие'>HyperTerminal</A>"
 W EF_BBK
 D FOO^%ZAPM.ed.BSC4("footer")
 Q
Lab W 11111111
 Q
InfoKEY N CK,I,AK
 D BEG1^%ZAPM.ed.BSC4 W $$TITL^%ZAPM.ed.BSCGIS("Параметры лицензии"),$$B27^%ZAPM.ed.BSCGIS(0)
 I $G(BSSES)="" W "надо зарегистрироваться!"
 E  D
 . zn "%sys" D OutSpool^%ZAPM.ed.BSCpool("D ^CKEY"),Spool2BSSES^%ZAPM.ed.BSCpool(+$J,"^CKEY") M CK=@BDSES@(BSSES,"VAR","SPOOL","^CKEY")
 .W "<PRE>" D  W "</PRE><HR>"
 ..S I="" F  S I=$O(CK(I)) Q:I=""  D
 ...W CK(I) I CK(I)["AuthorizationKey" S AK=$TR($P($P(CK(I),"=",2),$C(13))," ","")
 .W "<PRE>" I $D(AK) D DecodeW^CKEY(AK) W "</PRE><HR>"
 D BUTT^%ZAPM.ed.BSCGIS,END^%ZAPM.ed.BSC4
 Q
InfoSession(S) I '$G(BSdebug) Q S
 S BSLABEL="InfoSessio^~BSC4rout" 
 N HREF,TA S HREF=$$ADDBSGET^%ZAPM.ed.BSC4(),TA="target=new" 			;по старому
 I $$GETOPT^%ZAPM.ed.BSC4cfgP("^%ZAPM.ed.BSETUP(""ISS"")","AsysEInoActivX") d  	;по новому
 .D TELNETP^%ZAPM.ed.BSCmDDR S TA="",HREF="javascript: TELNETP(""%SYS"",""#"",""InfoSessi^^%ZAPM.ed.BSC4rout("_BSSES_")"",""Sessions"");"
  Q "<A HREF='"_HREF_"' "_TA_" TITLE='Загрузить в терминале редактор массивов с узлом сессии'>"_S_"</A>"
InfoSessio D RunProSess("TELNETP(""%SYS"",""#"",""InfoSessi^^%ZAPM.ed.BSC4rout("_BSSES_")"",""Sessions"");") Q
 
InfoTerm D RunProSess("TELNETP(""1"",""$"",""$"",""BS_TELNET"");") Q
InfoTCP N tcpPORT S tcpPORT=$$PORT^%ZAPM.ed.BSpgTEL d  D RunProSess("TELNETP(""1"",""$"",""$"",""BS_TELNET"");") Q
 .i tcpPORT="" k tcpPORT 
InfoSessi(S) N R S R=$NA(@$$KBD^%ZAPM.ed.BSF12("^%ZAPM.ed.BSC4(""SESSIONS"")")@(S)) D ^%ZAPM.ed.BSMSMG(R)
 Q
RunProSess(JS,Other) //загрузить ПРОЦЕСС JS
 D BEG1^%ZAPM.ed.BSC4 
 S rd1="" i $g(Other)'="" d @Other
 e  D FUN^%ZAPM.ed.BSCmDDR
 w "<BODY ONLOAD='"_JS D  W "'><OBJECT ID=RDos"_BK 
 .W "window.close();"
 w "CLASSID=""CLSID:23F82604-18EB-4BBD-943B-60C05C57DFB4"" "_BK 
 w "CODEBASE=""RunDos.CAB#version=2,4,0,4"" width=0 >"_BK 
 w "</OBJECT>"_BK 
 D END^%ZAPM.ed.BSC4
 Q
ExeRun1 D JS^%ZAPM.ed.BSCp
 n Ext,WorkDir 
 s WorkDir=$$DR^%ZAPM.ed.BSCp2
 i WorkDir'="" s Ext=$$GETOPT^%ZAPM.ed.BSC4cfgP("^%ZAPM.ed.BSETUP(""ISS"")","AsysEInoActivX")  //WebView--STATUS
 w "function ExeRun2(workdir,exe,param) {",BK
 ;W "alert(workdir);"_BK
 I '$G(Ext) D
 .w "parent."_$G(rd1,"rd1.")_"RDos.RunOption=1;"_BK
 .w "if (workdir=='') parent."_$G(rd1,"rd1.")_"RDos.WorkDir="_$$WorkDir^%ZAPM.ed.BSCAsIs()_";"_BK
 .w "else parent."_$G(rd1,"rd1.")_"RDos.WorkDir=workdir;"_BK
 ;W "prompt('Вот она!',parent."_$G(rd1,"rd1.")_"RDos.WorkDir);"_BK 
 I '$G(Ext) w "parent."_$G(rd1,"rd1.")_"RDos.Command=exe+' '+param;"_BK 
 E  D
 .w "var Rou=exe;"_BK  //запуск через статус-бар программы WebView.exe
 .w "var Par=cmdline;"_BK
 .w "var Dir='"_$G(WorkDir)_"';"_BK
 .w "status='Status :Exec:*'+Rou+'*'+Par+'*'+Dir+'*';"_BK
 .w "status='Ждите, программа запускается...';"_BK
 ;W "var aa=prompt('Вот она!','"_FTerm_"');"_BK
 ;W "alert(param);"_BK
 I '$G(Ext) w "parent."_$G(rd1,"rd1.")_"RDos.RunCommand();"_BK
 w "}",BK
 D JSE^%ZAPM.ed.BSCp
 Q
tit(T) Q "<title>"_T_"</title>"
a(R,A,T,W,H) S R=$$R(R) I R[$C(34) S R=$$TR^%ZAPM.ed.BSsFUNM(R,$C(34),$C(34,34))
 Q "<a title='"_$G(T)_"' class=u1 onclick='open("""_R_""",""RESULT3"",""toolbar=no,menubar=no,scrollbars=yes,"_$$GETOPT^%ZAPM.ed.BSC4cfg(MainOpt,"NWO1")_",status=1,resizable=1"");'>"_A_"</a>"
R(L) ;СТАНДАРТНАЯ ЗАГРУЗКА ИЗ ПРОГРАММЫ
 N BSLABEL S BSLABEL=L
 Q $$ADDBSGET^%ZAPM.ed.BSC4()
1(T,P) ;СТАНДАРТНАЯ ЗАГРУЗКА ТАБЛИЦЫ ИЗ РАЗДЕЛА
 N BSNSP S BSNSP=$TR($ZU(5),"%","~")
 Q $$ADDBSGET^%ZAPM.ed.BSC4()_"&BSPART="_P_"&BSTABL="_T
ADM2 W "<tr><td width=10% class=s3 >"_T_"</td><td  width=70% class=s3 >"
 W "<a class=u1 title='Таблица "_PA_"("_T_")' onclick='open("""_$$1(T,P)_""","""",""toolbar=no,menubar=no,scrollbars=yes,"_$$GETOPT^%ZAPM.ed.BSC4cfg(MainOpt,"NWO1")_",status=1,resizable=1"");' align='right'>"_$P($G(@PA@(T)),"@")_"</a>"
 W "</td></tr>",BK
 Q
primg() q "<img border=0 src='"_BSDOMAIN_"/img/printer.gif' >"
blank() q "<img border=0 src='"_BSDOMAIN_"/img/fon-polos.jpg' >"
DEL  w t_"<td width=10% >"_y_BK
 Q
option
 D ExecTel^%ZAPM.ed.BSCp 
 W "<div align='right'><TABLE BORDER=0><TR>" d  W "</TR></TABLE></div>"_BK_BK
 .n t,y,Tit,NewStart
 .S t="<TD>",y="</TD>"_BK
 .w t_$$NEWUSERS_y
 .w t_$$a("USERLIST^~BSC4rout","<img border=0 src='"_BSDOMAIN_"/img/persons.gif' ALT='Список Пользователей и их ресурсы'>")_y
 .w t_$$a("ShowUser^~BSmirWAKA","<img border=0 src='"_BSDOMAIN_"/img/persons-.gif' ALT='Групповая работа с аккаунтами пользователей'>")_y
 .N BSLABEL,BSBBS,BSintREG1 S BSBBS="MSM",BSLABEL="^~BSC4reg"
 .W t_"<a href='"_$$ADDBSGET^%ZAPM.ed.BSC4()_"' target='RESULT3'><img border=0 src='"_BSDOMAIN_"/img/person.gif' ALT='Ввести, модифицировать и удалить пользователя'></a>"_y
 .W t D CHANGEKillUser W y
 .w t D EMPTYPASS("<img border=0 src='"_BSDOMAIN_"/img/person2.gif' ALT='Пользователь забыл пароль'>") W y
 .i $g(^%ZAPM.ed.BS("Config"))="VV" w t D ACCESS($$ACCIMG^%ZAPM.ed.BSCm2) w y
 .D DEL
 .W t_$$PARIP^%ZAPM.ed.BSCm1("param.gif")_y
 .I $$GRA^%ZAPM.ed.BSCGIS(BSLOGIN,"zDebug") W t_$$PARIPED^%ZAPM.ed.BSCm1("refr-blu.gif")_y
 .D DEL
 .w t D SETU("<img border=0 src='"_BSDOMAIN_"/img/option.gif' ALT='") w y
 .W t_$$A^%ZAPM.ed.BSC4cfgP("<img border=0 src='"_BSDOMAIN_"/img/ham-blue.gif' ALT='Дополнительные параметры системы'>","^[|~SYS|]BSC4.ISS.Setup","^~BSETUP(|ISS|)",1)_y
 .I $$GRA^%ZAPM.ed.BSCGIS(BSLOGIN,"zDebug") N g s g="^[""%SYS""]BSC4.ISS.Setup" W t_$$Param3^%ZAPM.ed.BSCAsIs_y
 .D DEL
 .i $g(^%ZAPM.ed.BS("Config"))="VV" d
 ..W t_$$PARSNXI^%ZAPM.ed.BSCm1("refr-blu.gif")_y
 ..W t_$$PARSNXIED^%ZAPM.ed.BSCm1("refr-red.gif")_y
 ..D DEL
 .w t_"<A HREF=""javascript: "_$$TELNET^%ZAPM.ed.BSCp2("%SYS","%BSC","PROTECTM","Основные БД")_" "" TITLE='Основные БД'><img border=0 src='"_BSDOMAIN_"/ext/mdb.gif' ALT='Основные БД'></A>"_y
 .D DEL
 .W t_"<a target='RESULT3' href='"_$$ADDLIB^%ZAPM.ed.BSC4()_"BSGRANT="_$G(BSGRANT)_"&BSLOGIN="_BSLOGIN_"&BSG=B4&BSDOMAIN=/b4y&BSLABEL=Navigator&BSLNG=RUS&BSNSP=~SYS&BSPRO=CFG&BSRoutineId=1814453359'><img border=0 src='"_BSDOMAIN_"/img/paint.gif' ALT='Навигатор по Стилям'></a>"_y
 .;W t_"<a target='style1' href='"_$$ADDBSGET^%ZAPM.ed.BSC4(,"Navigator^~BSC4r3")_"'><img border=0 src='"_BSDOMAIN_"/img/paint.gif' ALT='Параметры Стилей'></a>"_y
 .D SDemon^%ZAPM.ed.BSCZSTU
 .S Tit=$$LNG^%ZAPM.ed.BSC4("Фоновое задание")_" "_$S($G(NewStart)="":$$LNG^%ZAPM.ed.BSC4("не запущено"),1:$$LNG^%ZAPM.ed.BSC4("уже работает с ")_$G(NewStart))
 .W t_"<a target='RESULT3' href='"_$$ADDLIB^%ZAPM.ed.BSC4()_"BSG=B4&BSDOMAIN=/b4i&BSLABEL=Navigator&BSLNG=RUS&BSNSP=~SYS&BSPRO=CFG&BSRoutineId=3381443579'><img border=0 WIDTH=15 src='"_BSDOMAIN_"/img/daemon.gif' ALT='Параметры Демона. "_Tit_"'></a>"_y
 .W t_"<a target='RESULT3' href='"_$$ADDLIB^%ZAPM.ed.BSC4()_"BSG=B4&BSDOMAIN=/b4i&BSLABEL=Navigator&BSLNG=RUS&BSNSP=~SYS&BSPRO=CFG&BSRoutineId=3010540426'><img border=0 WIDTH=15 src='"_BSDOMAIN_"/img/daemonfly.gif' ALT='Команды Демону. "_Tit_"'></a>"_y
 .w t_"<A HREF=""javascript: "_$$TELNET^%ZAPM.ed.BSCp2("%SYS","%BSJPRN","DPP","Устройства вывода")_" "" TITLE='Устройства вывода'><img border=0 src='"_BSDOMAIN_"/img/printer.gif'></A>"_y
 .;W t_"<a title='устройства вывода' "_$$AN^%ZAPM.ed.BSCm("^%ZAPM.ed.BSJPRN","PRN","EDIT^~BSChT1")_"><img src='"_BSDOMAIN_"/img/printer.gif'></a>"_y
 .w t_$$STAT^%ZAPM.ed.BSvdaSTAT("")_y
 .D DEL
 .W t_$$CHANGESYSDATE^%ZAPM.ed.BSCp_y
 .W t_$$CHANGESYSTIME^%ZAPM.ed.BSCp_y
 .i $g(^%ZAPM.ed.BS("Config"))="VV" W t_$$LTA("<img border=0 src='"_BSDOMAIN_"/img/cos.gif'>")_y
 .W t_$$S^%ZAPM.ed.BSCsys_y
 .W t_$$cconsolelog("<img border=0 src='"_BSDOMAIN_"/ext/ini.gif'>")_y
 .D DEL
 .w t_$$a("RR^~BSCrr","<img border=0 src='"_BSDOMAIN_"/ext/mdl.gif' ALT='Загрузить документ из Rotional Rose'>")_y
 .W t_$$HelpB^%ZAPM.ed.BSC4base_y
 .W t_$$Help^%ZAPM.ed.BSC4base_y
 .w t_$$a("TEST^~BSpgBS","<img border=0 src='"_BSDOMAIN_"/img/edit.gif' ALT='Тестовая страница'>")_y
 q
ADM ;МОДУЛЬ АДМИНИСТРАТОРА
 d GRA^%ZAPM.ed.BSC4 N BSGRANT,BSintREG
 D BEG1^%ZAPM.ed.BSC4
 d option
 W "<table border=0 width=100%>"
 W "<tr><td width=20% class=s1 ><STRONG>------</STRONG>"_"</td></tr>"_BK
 W "</table>"_BK
 D part
 D part2
 ;W $$BsDoc^%ZAPM.ed.BSC4b("<img border=0 src='"_BSDOMAIN_"/img/bsdoc.gif' >")," %BS - Документация"_BBK_BBK
 
 d Weblink
 D NuSphere
 D InfoSess
 ;S BSLABEL="Reg^~BSCm6" W "<a HREF='"_$$ADDBSGET^%ZAPM.ed.BSC4()_"' target='NuSphere'>REG INT</A><HR>"
 D END^%ZAPM.ed.BSC4
 Q
part2
 D STY^%ZAPM.ed.BSCm2(2),DIV^%ZAPM.ed.BSCm2(2,"Редактивать параметры синхронизации","СИСТЕМА СИНХРОНИЗАЦИИ")
 D   D DI^%ZAPM.ed.BSCm2
 .N ta
 .s ta=0,ta("Text")=0,ta("Par")=0 //ВСЕ КРОМЕ
 .D PARTS^%ZAPM.ed.BSCm("^%ZAPM.ed.BSC4SNX","|",1,.ta)
 q
part  ;D PARTS^%ZAPM.ed.BSCm("^[""%SYS""]BSC4.CFG|^%ZAPM.ed.BSC4|^%ZAPM.ed.BSC4SNX","|",3)
 D STY^%ZAPM.ed.BSCm2(0),DIV^%ZAPM.ed.BSCm2(0,"Редактивать системные БД","ОБЩИЕ ПАРАМЕТРЫ КОМПЛЕКСА")
 D   D DI^%ZAPM.ed.BSCm2 
 d part3
 q
part3  N ta
 s ta=1,ta("GRAND")=1,ta("SESSIONS")=1,ta("PROTECT")=1,ta("PIN")=1,ta("IP")=1,ta("Profile")=1 //ТОЛЬКО УКАЗАННЫЕ
 D PARTS^%ZAPM.ed.BSCm("^%ZAPM.ed.BSC4","|",1,.ta)
 q
Weblink i $G(%("HOST:"))'="" Q  //НЕТ ЕГО
 W "<FIELDSET><LEGEND>Weblink</LEGEND>" d   w "</FIELDSET>"
 .S U="http://"_$$ADDSN^%ZAPM.ed.BSC4_$$ADDLIB^%ZAPM.ed.BSC4() W "<hr><a HREF='"_U_"' target='Weblink'>Конфигурирование Weblink ситемного интегратора</A>"
 q
NuSphere W "<HR>" D
 .S ST=$$HTTP^%ZAPM.ed.BSCmail("http://"_$P($$ADDSN^%ZAPM.ed.BSC4,":")_":81") I $P(ST," ",2)'=200 Q 
 .S U="http://"_$P($$ADDSN^%ZAPM.ed.BSC4,":")_":9000" 
 .W "<FIELDSET><LEGEND>NuSphere Technology Platform: (Apache:port-81, PHP, MySQL)</LEGEND>"
 .W "<a HREF='"_U_"' target='NuSphere'>NuSphere Administration Web Site</A><HR>" D
 ..W $$xAWIKI^%ZAPM.ed.BSC4b("WackoWiki Портал - База знаний")
 ..w "<br><a HREF='"_$$testODBC^%ZAPM.ed.BSCGH()_"' target='MGWSI'>Пример доступа из PHP к СУБД Cache' по ODBC</A>"
 ..
 ..S U="http://"_$P($$ADDSN^%ZAPM.ed.BSC4,":")_":81/cgi-bin/nph-mgwsic.exe"
 ..S ST=$$HTTP^%ZAPM.ed.BSCmail(U,2,.OUT) I $P(ST," ",2)'=200 Q
 ..Q:'$D(OUT)  S OUT=$O(OUT("Data","")) I OUT'="" I $G(OUT("Data",OUT))["error occurred" Q
 ..W "<hr><a HREF='"_U_"' target='MGWSI'>Конфигурирование m_PHP ситемного интегратора (M/Gateway Developments Ltd.)</A>"
 ..S U="http://"_$P($$ADDSN^%ZAPM.ed.BSC4,":")_":81/test/m/mainmenu.php" W "<br><a HREF='"_U_"' target='MGWSI'>1. Пример доступа из PHP(n:\infoportal\nus\test\...) к СУБД Cache'</A>"
 ..S U="http://"_$P($$ADDSN^%ZAPM.ed.BSC4,":")_":81/test/m/test.php" W "<br><a HREF='"_U_"' target='MGWSI'>2. Пример доступа из PHP(n:\infoportal\nus\test\...) к СУБД Cache'</A>"
 ..
 .w "</FIELDSET>"
 Q
cconsolelog(IMG) //ПОКАЗАТЬ clog
 N BSPARENT,BSLABEL,BSTABL,BSPART S BSLABEL="CLOG^~BSC4rout"
 Q " <a href='"_$$ADDBSGET^%ZAPM.ed.BSC4()_"#LOGend' TARGET='RESULT3' title='Показать CCONSOLE.LOG'>"_IMG_"</a>"
CLOG  n filename,deflocation,tmp
 D BEG1^%ZAPM.ed.BSC4  W $$B27^%ZAPM.ed.BSCm4()
 s filename=$$CacheSysDir^%ZAPM.ed.BSCp("\mgr\cconsole.log")
 D File2Arr^%ZAPM.ed.BSCEXE(filename,.tmp) W "<PRE>"
 S tmp="" F  S tmp=$O(tmp(tmp)) Q:tmp=""  W tmp(tmp)
 W "</PRE><A NAME='LOGend'>"
 Q
LTA(IMG) //ПОКАЗАТЬ ТАБЛИЦУ ЛОКИРОВКИ
 N BSPARENT,BSLABEL,BSTABL,BSPART S BSLABEL="LT^~BSCp"
 Q " <a href='"_$$ADDBSGET^%ZAPM.ed.BSC4()_"' TARGET='RESULT3' title='Таблица Залоченных Ссылок'>"_IMG_"</a>"
SETU(IMG)        N T,P,nEW,PA
 S BSLABEL="ENTER^~BSC4cfg"
 S P=$$MainOpt^%ZAPM.ed.BSC4,PA=$P(P,"("),T=$QS(P,1),P=$$%T^%ZAPM.ed.BSCh(PA)
 W "<a class=u1 title='!!!' onclick='open("""_$$1(T,P)_""",""RESULT3"",""toolbar=no,menubar=no,scrollbars=yes,"_$$GETOPT^%ZAPM.ed.BSC4cfg(MainOpt,"NWO1")_",status=1,resizable=1"");'>"_IMG_$P($G(@PA@(T)),"@")_"'></a>"
 Q
ACCESS(IMG)   N BSPARENT,BSLABEL,BSTABL,BSPART S BSLABEL="T^~BSCm4",BSPART="^~BSC4",BSTABL="PROTECT",BSPARENT="EditForm"_$p(BSSES,".")
 W " <a href='"_$$ADDBSGET^%ZAPM.ed.BSC4()_"' TARGET='"_BSPARENT_"'>"_IMG_"</a>"
 Q
CHANGEKillUser D CHANGEKILL("<img border=0 src='"_BSDOMAIN_"/img/person3.gif' ALT='Сменить пароль или удалить пользователя "_$G(BSLOGIN)_"'>")
 Q
CHANGEKILL(IMG) N BSintREG1,BSLABEL S BSintREG1=1,BSLABEL="^~BSC4reg"
 W " <a href='"_$$ADDBSGET^%ZAPM.ed.BSC4()_"' target='RESULT3' >"_IMG_"</a>"
 Q
EMPTYPASS(IMG) N BSintREG1,BSLABEL S BSintREG1=1,BSLABEL="EMPTYPASS1^~BSC4rout"
 W " <a target='RESULT3'  TITLE='"_$$LNG^%ZAPM.ed.BSC4("Обнулить пароль пользователю")_"' href='"_$$ADDBSGET^%ZAPM.ed.BSC4()_"'>"_IMG_"</a>"
 Q
EMPTYPASS1 N Q,I,II S Q=""
 D BEG1^%ZAPM.ed.BSC4
 W "<h3>"_$$LNG^%ZAPM.ed.BSC4("Пользователь забыл пароль")_"</h3>"
 W "<form action="""_$$ADDLIB^%ZAPM.ed.BSC4()_""" method=""POST"">"
 S BSLABEL="EMPTYPASS2^~BSC4rout"
 D ADDBSPOST^%ZAPM.ed.BSC4reg
 S Q=Q_"<SELECT NAME=USER><OPTION></OPTION>"
 S II="" F I=1:1 S II=$O(@BDUSE@(II)) Q:II=""  S Q=Q_"<OPTION>"_II_"</OPTION>"
 W " Пользователю "_Q_"</SELECT><HR>"
 W "<input type='submit' name=""sNEW"" value='"_$$LNG^%ZAPM.ed.BSC4("Обнулить пароль")_"'></FORM>"
 d BACK^%ZAPM.ed.BSCh D END^%ZAPM.ed.BSC4
 Q
EMPTYPASS2       D BEG1^%ZAPM.ed.BSC4
 I $G(USER)="" G EMPTYPASS3
 D PassNew^%ZAPM.ed.BSCp(USER,"","0","",1)
 S @BDUSE@(USER,"PSW")=$$CRC^%ZAPM.ed.BSCp(USER,0)
 W "<h3>Пользователю "_RED_USER_EF_" присвоен пароль 0</h3>"
EMPTYPASS3 d BACK^%ZAPM.ed.BSCh D END^%ZAPM.ed.BSC4
 Q
NEWUSERS() N BSintREG,BSLABEL
 S BSintREG=1,BSLABEL="^~BSC4reg"
 Q "<a href='"_$$ADDBSGET^%ZAPM.ed.BSC4()_"' target='RESULT3'><img border=0 src='"_BSDOMAIN_"/img/pers-new.gif' ALT='Новый пользователь'></a>"_BK
ADM1() I nEW S nEW=nEW+1 Q nEW
 Q ""
RR ;ЗАПУСК ПОДСЧЕТА У КОГО СКОЛЬКО БАЙТ НАТИКАЛО
 N BSLOGIN,pi,pin,BSPRO,Num,BSNSP,ONSP
 D MAINVAR^%ZAPM.ed.BSC4
 N Cm S Cm=$$GETOPT^%ZAPM.ed.BSC4cfg(MainOpt,"Commerce")
 I '$D(BDTAR) S BDTAR=$$KBD^%ZAPM.ed.BSF12("^%ZAPM.ed.BSC4(""TARIFF"")")
 S ONSP=$ZU(5)
 S BDSTAT="^[""%SYS""]BSC4.CFG.UStatus("""_$ZD($H,8)_""")"
 S pi="" F Num=1:1 S pi=$O(@BDPIN@(pi)) Q:pi=""  D
 .S BSLOGIN=$G(@BDPIN@(pi,"LOGIN"))
 .D USR
 .S @BDSTAT@(pi,"MainLogin")=BSLOGIN,@BDSTAT@(pi,"NSP")=BSNSP,@BDSTAT@(pi,"TRF")=TARIF
 .S @BDSTAT@(pi,"ProjCount")=$P($P(KP1,","),"="),@BDSTAT@(pi,"ProjSize")=$P($P(KP1,",",1),"=",2)
 .S @BDSTAT@(pi,"ProgCount")=$P($P(KP1,",",2),"="),@BDSTAT@(pi,"ProgSize")=$P($P(KP1,",",2),"=",2)
 .S @BDSTAT@(pi,"TabCount")=$P($P(KP1,",",3),"="),@BDSTAT@(pi,"TabSize")=$P($P(KP1,",",3),"=",2)
 .S @BDSTAT@(pi,"Total")=KP2,@BDSTAT@(pi,"TotalOST")=(TARIF-KP2)
 .I $G(@BDPIN@(pi,"DAT"))'="" S @BDSTAT@(pi,"DateRegistr")=$ZD($G(@BDPIN@(pi,"DAT")),8)
 .S @BDSTAT@(pi,"TimeReport")=$ZT($P($H,",",2),1)
 I $$ZU^%ZAPM.ed.BSF4(ONSP)
 q
USERLIST ;СПИСОК ПОЛЬЗОВАТЕЛЕЙ
 W $$tit($$LNG^%ZAPM.ed.BSC4("СПИСОК ПОЛЬЗОВАТЕЛЕЙ",305))
 W $$STYLE^%ZAPM.ed.BSC4
 W " <table border=0 width=100%>"
 N BSLOGIN,pi,pin,BSPRO,Num,BSNSP
 N Cm S Cm=$$GETOPT^%ZAPM.ed.BSC4cfg(MainOpt,"Commerce")
 I '$D(BDTAR) S BDTAR=$$KBD^%ZAPM.ed.BSF12("^%ZAPM.ed.BSC4(""TARIFF"")")
 S BSLOGIN="" F Num=1:1 S BSLOGIN=$O(@BDUSE@(BSLOGIN)) Q:BSLOGIN=""  D US(BSLOGIN,BDTAR,BDPIN,BDUSE,$G(BDSTAT))
 Q
US(BSLOGIN,BDTAR,BDPIN,BDUSE,BDSTAT) K pi,pin,BSPRO,BSNSP
 D pin^%ZAPM.ed.BSC4base I pi="" Q
USR S BSNSP=$G(@BDPIN@(pi,"NSP"))
 I '$$ZU^%ZAPM.ed.BSF4(BSNSP) Q
 I BDSTAT="" W "<tr><td class=s1 >"_Num_"</td><td>"
 D STATUS
 I BDSTAT="" W "</td>"
 Q
STATUS ;О РЕСУРСАХ ПОЛЬЗОВАТЕЛЯ
 ;N KP1,KP2,TARIF
 I '$D(Cm) S Cm=$$GETOPT^%ZAPM.ed.BSC4cfg(MainOpt,"Commerce")
 I '$D(BDTAR) S BDTAR=$$KBD^%ZAPM.ed.BSF12("^%ZAPM.ed.BSC4(""TARIFF"")")
 D pin^%ZAPM.ed.BSC4base
 S KP1=$$OcupSize
 S TARIF=$$TARIF("M")*1024*1024 ;БАЙТ
 S KP2=$P($P(KP1,",",1),"=",2)+$P($P(KP1,",",2),"=",2)+$P($P(KP1,",",3),"=",2)
 I $G(BDSTAT)'="" Q
 w "<hr>"_$$LNG^%ZAPM.ed.BSC4("Статус ресурса...",306)
 W " <table border=0 width=100%>"
 W "<tr><td width=30% class=s3 ><strong>"_$$LNG^%ZAPM.ed.BSC4(22)_"</strong></td><td  width=70% class=s1 >"_BSLOGIN_"</td><tr>",BK
 W "<tr><td width=30% class=s3 ><strong>"_$$LNG^%ZAPM.ed.BSC4(12)_"</strong></td><td  width=70% class=s1 >"_pi_"</td><tr>",BK
 W "<tr><td width=30% class=s3 ><strong>"_$$LNG^%ZAPM.ed.BSC4("Рабочая область",307)_"</strong></td><td  width=70% class=s1 >"_$G(@BDPIN@(pi,"NSP"))_"</td><tr>",BK
 I Cm=1 W "<tr><td width=30% class=s3 ><strong>"_$$LNG^%ZAPM.ed.BSC4("Ptariff")_"</strong></td><td  width=70% class=s1 >"_$$LNG^%ZAPM.ed.BSC4("T"_TARIF1)_"</td><tr>",BK
 W "</table>",BBK
 I Cm'=1 Q
 W " <table border=0 width=100%>"
 W "<tr><td align='right' class=s3 ><strong>"_$$LNG^%ZAPM.ed.BSC4("ВАШИ РЕСУРСЫ",308)_"</strong></td><td class=s3  align='CENTER'><strong>"_$$LNG^%ZAPM.ed.BSC4("Количество",309)_"</strong></td><td class=s3  align='CENTER'><strong>"_$$LNG^%ZAPM.ed.BSC4("Занимаемый Объем (Байт)",310)_"</strong></td><td class=s3  align='CENTER'><strong>"_$$LNG^%ZAPM.ed.BSC4("Осталось (Байт)",311)_"</strong></td></tr>",BK
 W "<tr><td align='right' class=s3 ><strong>"_$$LNG^%ZAPM.ed.BSC4("Проекты",312)_"</strong></td><td class=s1 >"_$P($P(KP1,","),"=")_"</td><td class=s1 >"_$P($P(KP1,",",1),"=",2)_"</td><td class=s1 >-</td></tr>",BK
 W "<tr><td align='right' class=s3 ><strong>"_$$LNG^%ZAPM.ed.BSC4("Программы",313)_"</strong></td><td class=s1 >"_$P($P(KP1,",",2),"=")_"</td><td class=s1 >"_$P($P(KP1,",",2),"=",2)_"</td><td class=s1 >-</td></tr>",BK
 W "<tr><td align='right' class=s3 ><strong>"_$$LNG^%ZAPM.ed.BSC4("Таблицы",314)_"</strong></td><td class=s1 >"_$P($P(KP1,",",3),"=")_"</td><td class=s1 >"_$P($P(KP1,",",3),"=",2)_"</td><td class=s1 >-</td></tr>",BK
 
 W "<tr><td align='right' class=s3 ><strong>"_$$LNG^%ZAPM.ed.BSC4("ИТОГО:",315)_"</strong></td><td class=s1 >.</td><td class=s1 >"_KP2_"</td><td class=s1 >"_(TARIF-KP2)_"</td></tr>",BK
 W "</table>",BBK
 Q
TARIF(CELL) N TARIF ;ЗНАЧЕНИЕ ПАРАМЕТРА ТАРИФНОГО ПЛАНА ДЛЯ ТЕКУЩЕГО ПОЛЬЗОВАТЕЛЯ
 S TARIF1=$G(@BDPIN@(pi,"TRF"))
  I TARIF1="" S TARIF1=$G(@BDUSE@(BSLOGIN,"TRF"),"?") //ПОКА ТАК
 S TARIF=$G(@BDTAR@(TARIF1,CELL))
 Q TARIF
OcupSize() ;ЗАНИМАЕМОЕ ПРОСТРАНСТВО
 N I,P,R,T,OP,OR,OT,BD
 S I="",P=0,R=0,T=0,OP=0,OR=0,OT=0 F  S I=$O(@("^"_pi_".PRO")@(I)) Q:I=""  D OPRO(pi,I) S P=P+1
 D OPRO(pi) ;ТЕПЕРЬ СЛУЖЕБНЫЙ
 S BD=$P($G(@("^"_pi)@("PRO","KEY")),"@")
 I $$Data^%ZAPM.ed.BSF12(BD) S OP=OP+$$^%ZAPM.ed.BSCGS("",BD) //ТОЛЬКО ДЛЯ WINDOWS
 Q P_"="_OP_","_R_"="_OR_","_T_"="_OT
OPRO(pi,BSPRO) ;ПОДСЧЕТ ПРОЕКТОВ С ТАБЛИЦАМИ И ПРОГРАММАМИ
 N I,N,BD
 S I=0
 I $D(BSPRO) S pin=pi_"."_BSPRO
 E  S pin=pi
 I '$D(@("^"_pin)) Q
 ;ЦИКЛ ПО ПРОГРАММАМ
 S BD=$P($G(@("^"_pin)@("ROU","KEY")),"@")
 I $$Data^%ZAPM.ed.BSF12(BD) D  S OR=OR+$$^%ZAPM.ed.BSCGS("",BD) ;ОПИСАНИЕ ПРОГРАММ
 .S N="" F  S N=$O(@BD@(N)) Q:N=""  D
 ..S OR=OR+$$OROU(pin_"."_N) S R=R+1 ;ПРОГРАММЫ
 S N="" F  S N=$O(@("^"_pin)@(N)) Q:N=""  I $P($G(@("^"_pin)@(N)),"@",17)=2 D
 .I N'="ROU"&(N'="PRO") S T=T+1
 .S BD=$P($G(@("^"_pin)@(N,"KEY")),"@") I BD="" Q
 .S BD=$QS(BD,0) I $D(@BD) S OT=OT+$P($$^%ZAPM.ed.BSCGS("",BD),"^") ;ИНФМАССИВЫ
 S OP=OP+$$^%ZAPM.ed.BSCGS("",pin) ;РАЗДЕЛ
 q
OROU(NameROU) ;ПОСЧИТАТЬ ПРОГУ
 Q 0
NEW ;СЛУЖЕБНЫЙ РЕСУРС ДЛЯ НОВОГО ПОЛЬЗОВАТЕЛЯ
 D pin^%ZAPM.ed.BSC4base
NewR I $G(@("^"_pi))["BaSe MsW" D  Q  //УЖЕ СУЩЕСТВУЕТ
 .S @BDPIN@(pi,"LOGIN",BSLOGIN)=$H
 S @("^"_pi)="BaSe MsW @СЛУЖЕБНЫЙ РЕСУРС ДЛЯ НОВОГО ПОЛЬЗОВАТЕЛЯ '"_BSLOGIN_"'"
 /*
 D Copy^%ZAPM.ed.BSF8("^%ZAPM.ed.BSC4E(""PRO"")","^"_pi_"(""PRO"")")
 D Copy^%ZAPM.ed.BSF8("^%ZAPM.ed.BSC4E(""CfgPro"")","^"_pi_"(""CfgPro"")")
 D Copy^%ZAPM.ed.BSF8("^%ZAPM.ed.BSC4PRO","^"_pi_".PRO")
 */
 M @("^"_pi_"(""PRO"")")=^%ZAPM.ed.BSC4E("PRO")
 M @("^"_pi_"(""CfgPro"")")=^%ZAPM.ed.BSC4E("CfgPro")
 M @("^"_pi_".PRO")=^%ZAPM.ed.BSC4PRO
 S @("^"_pi)@("PRO","KEY")="^"_pi_".PRO"
 S @("^"_pi_".PRO")="BSD - MSW@"
 M @("^"_pi_"(""CfgRou"")")=^%ZAPM.ed.BSC4E("CfgRou")
 M @("^"_pi_"(""CfgTab"")")=^%ZAPM.ed.BSC4E("CfgTab")
 /*
 D Copy^%ZAPM.ed.BSF8("^%ZAPM.ed.BSC4E(""CfgRou"")","^"_pi_"(""CfgRou"")")
 D Copy^%ZAPM.ed.BSF8("^%ZAPM.ed.BSC4E(""CfgTab"")","^"_pi_"(""CfgTab"")")
 */
 Q
NEWPRO(BSPRO,REM) D pin^%ZAPM.ed.BSC4base
NewP S @("^"_pi_".PRO")@(BSPRO,"REM")=REM
 S @("^"_pin)="BaSe MsW @"_REM
 D Copy^%ZAPM.ed.BSF8("^%ZAPM.ed.BSC4E(""ROU"")","^"_pin_"(""ROU"")")
 S @("^"_pin)@("ROU","KEY")="^"_pin_".ROU"
 S @("^"_pin_".ROU")="BSD - MSW@"
 Q
KILL() ;удаление ВСЕХ ресурсов И ЛОГИНА
 D pin^%ZAPM.ed.BSC4base
 N I,J,NSP
 ;КОНТРОЛЬ НА ЗАНЯТОСТЬ ДРУГИМ ПОЛЬЗОВАТЕЛЕМ -- Q 0
 S NSP=$G(@BDPIN@(pi,"NSP")) I '$$UCI^%ZAPM.ed.BSC4(NSP) Q 0
 S I="" F  S I=$O(@("^"_pi_".PRO")@(I)) Q:I=""  D KILLPRO(pi,I)
 D KILLPRO(pi) ;ТЕПЕРЬ СЛУЖЕБНЫЙ
 k @BDPIN@(pi),@BDUSE@(BSLOGIN) ;А ТЕПЕРЬ ВЕСЬ ЛОГИН
 Q 1
KILLPRO(pi,BSPRO) ;удаление ПРОЕКТОВ С ТАБЛИЦАМИ И ПРОГРАММАМИ
 N I,N,BD,ERR
 I $G(BSSES)'="" I $G(@BDSES@(BSSES,"PROJ"))=BSPRO K @BDSES@(BSSES,"PROJ") ;УДАЛИТЬ ИМЯ ТЕКУЩЕГО ИЗ СЕССИИИ
 S I=0
 I $D(BSPRO) S pin=pi_"."_BSPRO
 E  S pin=pi
 I '$D(@("^"_pin)) Q
 ;ЦИКЛ ПО ПРОГРАММАМ
 S BD=$P($G(@("^"_pin)@("ROU","KEY")),"@")
 I $$Data^%ZAPM.ed.BSF12(BD) S N="" F  S N=$O(@BD@(N)) Q:N=""  D
 .D DEL1^%ZAPM.ed.BSC4r4(pin_"."_N_".*") ;УДАЛЯЕМ ПРОГРАММЫ
 ;ЦИКЛ ПО ТАБЛИЦАМ
 S N="" F  S N=$O(@("^"_pin)@(N)) Q:N=""  I $P($G(@("^"_pin)@(N)),"@",17)=2 D
 .I $$Delete^%apiOBJ(pin_"."_N,,.ERR)
 .W $G(ERR),BK
 .S BD=$P($G(@("^"_pin)@(N,"KEY")),"@")
 .I BD="" Q
 .S BD=$QS(BD,0) I $D(@BD) K @BD
 K @("^"_pin)
 I $G(BSPRO)'="" K @("^"_pi_".PRO")@(BSPRO)
 q
rent ;w "информация о ренте"
 D BEG1^%ZAPM.ed.BSC4
 D STATUS
 q
]]></Routine>


<Routine name="%ZAPM.ed.BSCB" type="MAC" languagemode="0"><![CDATA[
%BSCB ;СОЗДАНИЕ ДИСТРИБУТИВОВ ; 10:12   18.10.2002
 ;
 ; Copyright (c) Serge W. Mikhaylenko
 ; All Rights Reserved
 ;
 Q
BsBuild //загрузка и компиляция классов BS-Portal
 //ОСНОВА КОДА ПОДСМОТРЕНА У ШУТОВА СЕРГЕЯ (ДИМАС)
 D Uninstall
 D Install
 Q
Install
 N STOP,I,II
 S DIR="c:\bs\" //ДИРЕКТОРИЯ ИСХОДНИКОВ. НЕ УДАЛЯЙТЕ И НЕ ПЕРЕНОСИТЕ ЕЕ!
 s OWNER="Михайленко Сергей <Mikhaylenko@b4y.net.ru>"
 do $system.OBJ.Load(DIR_"BSALL.xml","ck",.ERR) 
 S I="" F  S I=$O(ERR(I)) Q:I=""  D  Q:$G(STOP)
 .I ERR(I,"code")'=5475 S STOP=I Q
 .I ERR(I,"param",1)["%BSC" S STOP=I Q
 I $G(STOP) W "Обнаружены критичные ошибки...",!,"Обратитесь к разработчику "_OWNER q
 W "Обнаружены некритичные ошибки, продолжаем..."
 d iniT^%ZAPM.ed.BSCB
 Q 
Show do $system.OBJ.ShowFlags()
 Q
Uninstall
 N I,i Q:'$D(^%ZAPM.ed.BS)
 S BS="BS-Portal"
 write !,"удаление полного проекта "_BS,!
 k ^oddPROJECT("%BSALL")
 write !,"удаление всех описаний классов "_BS,!
 do $system.OBJ.DeletePackage("BSC")
 do $system.OBJ.DeletePackage("BSC4")
 F I="Doc","DocResult","Lib","Libresult" S II="/csp/msw/Bs"_I_".csp" I ##class(%CSP.Routine).Delete(II) W !,"Удалили CSP страницу "_II
 
   write !,"удаление всех программ "_BS,!
 // удаляются все программы из области, кроме текущей
 set rset = ##class(%ResultSet).%New()
 set rset.ClassName = "%Library.Routine"
 set rset.QueryName = "RoutineList"
 
 for I="%BS","%zek"  {
 	S rext=I_"*.MAC,"_I_"*.INT,"_I_"*.OBJ"
 	do rset.Execute(rext,1,0)
	 while (rset.Next(.sc)) {
	    if ($SYSTEM.Status.IsOK(sc)) {
	       set rname = rset.Data("Name")
	       if ($t(+0)'=$extract(rname,1,$length(rname)-4)) {
	       	write rname,!
	       	do ##class(%Library.Routine).Delete(rname)
	       }
	    }
	 }
  }
  write !,"удаление всех массивов "_BS,!
 // удаляются все программы из области, кроме текущей
 S I="" F i=1:1  S I=$O(^$GLOBAL(I)) Q:I=""  W:'(i#10) "." I I["^%ZAPM.ed.BS"!(I["^BSC") W !,I K @I
 Q
]]></Routine>


<Routine name="%ZAPM.ed.BSCBD" type="MAC" languagemode="0"><![CDATA[
%BSCBD ;Генератор классов для ТаблицОписанияБазДанных %BS ; 18:26   06.04.2003
 ;
 ; Copyright (c) Serge W. Mikhaylenko
 ; All Rights Reserved
 ;
 Q
LD(D) D LoadDir^%apiOBJ(D,"cru",.ErroR) ;ЗАГРУЗИТЬ КЛАССЫ ИЗ ДИРЕКТОРИИ
 q
LF(D) D LoadFile^%apiOBJ(D,"cru",.ErroR) ;ЗАГРУЗИТЬ КЛАССЫ ИЗ CDL
 ;do DecomposeStatus^%apiOBJ(status,.err) write !,err(err),!
 Q
ALL(UCI) ;КОМПИЛИРОВАТЬ ВСЕ РАЗДЕЛЫ И КОДИФИКАТОРЫ
 N PxPUSTO
 I $G(UCI)="" G ALLP
 I $ZU(5)'=UCI,$$ZU^%ZAPM.ed.BSF4(UCI)
 I $ZU(5)'=UCI Q "No found "_UCI
 S PxPUSTO=""
ALLP N GL S GL="" F  S GL=$O(^$GLOBAL(GL)) Q:GL=""  D
 .I $E($G(@GL),1,9)="BaSe MsW ",($E(GL,1,5)="^%ZAPM.ed.BSC"!($E(GL,1,4)="^%ZAPM.ed.BSS")) W !,"partition ",GL D ALLPART(GL) Q
 .D kdf^%ZAPM.ed.BSCKD(GL)
 Q 1
ALLPART(PART) ;КОМПИЛИРОВАТЬ ВЕСЬ РАЗДЕЛ
 S PP="" F  S PP=$O(@PART@(PP)) Q:PP=""  D
 .I $P(@PART@(PP),"@",17)=2 W !,$$START($NA(@PART@(PP)),1) ;БАЗА ДАННЫХ
 Q
START(TOBD,COMPILE,NC,DIR) ;
 N FN,K,S,I,J,P,SS,BD,CBD,BSK,P3,SUBK,OK
 I '$D(@TOBD) S ErroR="1,Undefine TOBD" Q ErroR
 I $G(DIR)="" S DIR=$$TEMPDIR^%ZAPM.ed.BSCF1
 I $D(NOKILLER),NOKILLER[":\" S DIR=NOKILLER
 I $P(@TOBD,"@",17)'=2 S ErroR="1,This no BD" Q ErroR
 D Copy^%ZAPM.ed.BSF8($NA(@TOBD@("KEY")),"K")
 S BD=$P(K,"@",1) ;ИМЯ БАЗЫ ДАННЫХ
 I $G(NC)="" S NC=$TR(TOBD,"(]%[)""^","..") S NC=$P(NC,".",1,$L(NC,".")-1)_"."_$S($E($P(NC,".",$L(NC,".")),1)?1N:"B",1:"")_$P(NC,".",$L(NC,"."))
 ;W NC Q
 S FN=DIR_NC_".CDL"
 I '$$OpenFile^%ZAPM.ed.BSCF1(FN,"W") S ErroR="1,No access to file "_FN Q ErroR
 U FN
 D TITLE W "class ",NC,!,"{",!
 D SUPER,KEYS I $D(@TOBD@("Metod")) S I="" F  S I=$O(@TOBD@("Metod",I)) Q:I=""  D METOD($G(@TOBD@("Metod",I)),I)
 D METOD("NameKey()",,"Q "_$D(K(0))) I '$G(NOqListBD) D QUERY
 D STORAGE
 W !,"}",!
 C FN
 I $G(COMPILE) D  I $g(NOKILLER)="",$$DelFile^%ZAPM.ed.BSCEXE(FN)
 .S @TOBD@("Compile")="Begin "_$$TD^%ZAPM.ed.BSC4base
 .K ErroR
 .D LF(FN)
 .I $G(ErroR) S OK=$TR($G(ErroR(1),ErroR),$C(34)_"'","``")
 .E  S OK="OK "_$$TD^%ZAPM.ed.BSC4base
 .S @TOBD@("Compile")=OK,@TOBD@("LST")=$H_","_$G(BSLOGIN)
 .D SNX^%ZAPM.ed.BSChT1("S",$TR(TOBD,"@",""),"TABLE")
 Q "1 OK"
TITLE W !,"/***********************************************************************\"
 W !,"          File: ",FN
 W !,"        Author: Serge W. Mikhaylenko"
 W !,"          Date: ",$ZD($H,9)
 W !,"   Description: Tree-DataBase from %BS"
 W !,"         Above: This File is Generated by %BS+++Cache"
 W !,"\***********************************************************************/",!!
 Q
SUPER W !,"description = {",!,$P(@TOBD,"@",1),!,"}",!
 W !,"   super = %Library.Persistent,%Library.Populate;",!
 W !,"persistent = BD;"
 W !,"index i1 { attributes = " D  W "; extent = 0; idkey; primarykey = 0; unique = 0; }",!
 .S S="",SUBK=0
 .F I=0:1:9 I $D(K(I)) S SUBK=SUBK+1,S=S_$$nk(I,"K"_SUBK)_","
 .W $E(S,1,$L(S)-1)
 Q
tra(S) Q $TR(S,$C(34)_"'","``")
nk(n,a) i $p(K(n),"@",22)'="" q $p(K(n),"@",22)
 e  q a
KEYS S SUBK=0
 F I=0:1:9 I $D(K(I)) D
 .S SUBK=SUBK+1
 .W !,"attribute "_$$nk(I,"K"_SUBK)," { type = %String(MAXLEN=""""); calculated = 0; description = ""Индексный ключ номер "_I_". Описан как :"
 .I $P(K(I),"@",17)'="" W $$tra($P(K(I),"@",17))_""";"
 .E  W $$tra($P(K(I),"@",15))_""";"
 .W " not final; multidimensional = 0; public; required; sqlcomputed = 0; transient = 0; }"
 w ! F I=1:1 Q:'$D(@TOBD@(I))  F J=1:1 Q:'$D(@TOBD@(I,J))  I $P(@TOBD@(I,J),"@",9)=2 D
 .I $P($P(@TOBD@(I,J),"@",18),"#")'="" S nynx=$P($P(^(J),"@",18),"#"),S=$TR(nynx,",ЁЙЦУКЕНГШЩЗХЪЭЖДЛОРПАВЫФЯЧСМИТЬБЮ","xQQWERTYUIOPPPPPLKJHGFDSAZXCVBNMMM"),S=$$Px(S)
 .E  S nynx=I_","_J,S="Px"_I_"x"_J
 .S P(S)=nynx W !,"  attribute "_S_" { type = %Library.String(MAXLEN=""""); calculated = 0; "
 .W "description = {",!
 .I $P(@TOBD@(I,J),"@",17)'="" W $$tra($P(@TOBD@(I,J),"@",17)),!
 .E  W "Показатель хранимый в базе данных. В таблице описания базы данных лежит в строке "_I_" колонке "_J_".",!
 .W "} "
 .W " not final; multidimensional = 0; public; not required; sqlcomputed = 0; transient = 0; }",!
 Q
Px(P) I $G(NOqListBD) Q "P"_$S($L(P)=1:"00",$L(P)=2:"0",1:"")_P
	I $E(P,1)?1N Q "Px"_P
 Q $G(PxPUSTO,"Px")_P
METOD(NM,N,code)
 W !!,"   method "_NM
 W !,"   {"
 W !,"   returntype = %Library.String;"
 W !,"   classmethod;"
 W !,"   not final;"
 W !,"   public;"
 W !,"   sqlproc = 0;"
 W !,"   code ="
 W !,"   ["
 I $D(code) W !,"     "_code
 E  S M="" F  S M=$O(@TOBD@("Metod",N,M)) Q:M=""  W !,"    "_$G(@TOBD@("Metod",N,M))
 W !,"   ]"
 W !,"   }",!
 Q
QUERY S S=""
 W !,"   query ListBD((Param1:%Library.String))"
 W !,"   {"
 W !,"           type = %Library.SQLQuery(CONTAINID=0,ROWSPEC=""" D  W """);"
 .;K1:%String,K2:%String,P1:%String,P2:%String,P3:%Library.String,P4:%Library.String
 .S SUBK=0
 .F I=0:1:9 I $D(K(I)) S SUBK=SUBK+1 W $$nk(I,"K"_SUBK)_":%String," S S=S_$$nk(I,"K"_SUBK)_", "
 .S J="",SS="" F  S J=$O(P(J)) Q:J=""  S SS=SS_J_":%String,",S=S_J_", "
 .W $E(SS,1,$L(SS)-1)
 W !,"           sqlquery ="
 W !,"           ["
 W !,"                   :SELECT "_$E(S,1,$L(S)-2)
 W !,"                   :FROM "_$P(NC,".",$L(NC,"."))
 I $D(K(1)) W !,"                   :WHERE ("_$$nk(1,"K1")_" = :Param1)"
 I $D(K(2)) W !,"                   :ORDER BY "_$$nk(2,"K2")
 W !,"            ]"
 W !,"            sqlproc = 0;"
 W !,"            sqlview = 0;"
 W !,"   }",! Q
STORAGE ;
 W !!,"       storage BD"
 W !,"       {"
 W !,"               description = ""Конструкция SQL доступа к базам данных %BS"";"
 W !,"               type = %CacheSQLStorage;"
 W !,"               sql"
 W !,"               {"
 W !,"                       map Master"
 W !,"                       {"
         W !,"                               type = data;"
 I $D(K(0)) D  ;ЕСТЬ ИМЕННОЙ КЛЮЧ
 .W !,"                               structure = list;"
 .W !,"                               global = ^*;"
 E  W !,"                               global = "_BD_";"
 W !
 S SUBK=0
 I $D(K(0)) D
 .S SUBK=1
    .W !,"       subscript 1 {"
    .W !,"        accesstype = global;"
    .W !,"        nextcode = ["
 .W !,"         I {L1}="""" S {L1}="_$$BD34
    .W !,"         S {L1}=""^""_{L1}"
    .W !,"         S {L1}=$O(^$GLOBAL({L1}))"
    .W !,"         S {L1}=$E({L1},2,$L({L1}))"
    .W !,"         I $E({L1},1,$L("_$$BD34_"))'="_$$BD34_" S {L1}="""""
 .W !,"            Q"
    .W !,"         ]"
    .W !,"         expression = "_$$BD34_"_{K1}; "
    .W !,"        }"
 F I=1:1:9 I $D(K(I)) D
 .S SUBK=SUBK+1
 .W !,"       subscript "_SUBK_"   { expression = {"_$$nk(I,"K"_SUBK)_"}; accesstype = sub; }"
 S J="" F  S J=$O(P(J)) Q:J=""  D
 .W !,"                           data "_J_" { node = """_P(J)_"""; }"
 S SUBK=0
 I $D(K(0)) S SUBK=1 W !,"   rowidspec 1 { field = K1; expression=$E({L1},$L("_$$BD34_")+1,$L({L1})); }"
         F I=1:1:9 I $D(K(I)) D
         .S SUBK=SUBK+1
         .W !,"   rowidspec "_SUBK_" { field = "_$$nk(I,"K"_SUBK)_"; expression={L"_SUBK_"}; }"
 W !,"                       }" ;MAP
 W !,"               }" ;SQL
 W !,"       }"
 Q
BD34() ;Q $C(34)_$E($$TR^%ZAPM.ed.BSsFUNM(BD,$C(34),$C(34,34)),2,999)_$C(34)
 N B1
 S B1=BD I BD["]" S B1="^"_$P(BD,"]",2,999)
 Q $C(34)_$E(B1,2,999)_$C(34)
NextNameBD(B) ;ПОКА НЕ ИСПОЛЬЗУЕТСЯ
 N NBD,NS,us,BD1
 S NBD=B
 I B["^[""" D
 .S NS=$ZU(5)
 .S us=$P(B,$C(34),2) I us'=$ZU(5) I $$ZU^%ZAPM.ed.BSF4(us)
 .S BD1="^"_$P(B,"]",2,9) S NBD=$O(^$GLOBAL(BD1))
 .I $ZU(5)'=NS,$$ZU^%ZAPM.ed.BSF4(NS)
 I B'["^[""" S NBD=$O(^$GLOBAL(B))
 Q NBD
Tab2TOBD(DSN,USER,PASS,NAME,TOBD) ;СТРУКТУРУ ТАБЛИЦЫ В ТАБЛИЦУ %BS
 N WEBSQL,I,II,flag
 D TABLE2T^%ZAPM.ed.BSCRG(DSN,NAME,TOBD,USER,PASS)
 I '$D(@TOBD) S ErroR=" Произошла ошибка импорта таблицы " W !,ErroR q
 D TA2BD^%ZAPM.ed.BSCRG($QS(TOBD,0),$QS(TOBD,1))
 I $P($G(@TOBD),"@",17)'=2 S ErroR=" Произошла ошибка импорта таблицы %BS " W ErroR,! q
 Q
JTB2TOBD(DSN,USER,PASS,NAME,TOBD) ;ТАБЛИЦУ %BS + КОМПИЛИРВАТЬ + ДАННЫЕ
 S PxPUSTO="" D START(TOBD,1) I $G(ErroR)>0 W !," Произошла ошибка компиляции ",! zw ErroR q
 D TAB2BSD^%ZAPM.ed.BSCRG(DSN,USER,PASS,NAME,$QS(TOBD,0),$QS(TOBD,1))
 Q
Stream(DSN,USER,PASS,part,NOKILLER) ;потоковая закачка всего DSN в Cache
 N (DSN,USER,PASS,part,NOKILLER) ;NOKILLER=путь к временной директории в которой CDL не удаляются (для отладки)
 d Stream1(DSN,USER,PASS,part)
 d Stream2(DSN,USER,PASS,part)
 q
Stream1(DSN,USER,PASS,part) ;закачка структуры DSN в раздел BS
 i $g(part)="" s part="^"_DSN
 D DSN2PART^%ZAPM.ed.BSCRG(DSN,part,$G(USER),$G(PASS)) I $G(ErV) W !,"Произошла ошибка доступа до DSN:"_DSN_" ",! zw ErV q
 q
Stream2(DSN,USER,PASS,part) ;закачка данных из таблиц DSN в таблицы BS
 D PART2BSD^%ZAPM.ed.BSCRG(part) i $G(Errors) W !," Произошла ошибка конвертации таблиц ",! q
 S PxPUSTO="" D ALLPART(part)
 I $G(ErroR)>0 W !," Произошла ошибка компиляции ",! zw ErroR q
 D DSN2BS^%ZAPM.ed.BSCRG(DSN,$G(USER),$G(PASS),part)
 W !,"Ok",!!     Q
 /////////////////////////////////////
MSETSQL(TD)
	I '$D(@TD) Q "0 ПУСТАЯ "_TD
	N GC,GD,PxPUSTO,NOKILLER,NOqListBD,IDU,%code
	S IDU=$$2LAT^%ZAPM.ed.BSCp($G(%BS(12),$G(BSLOGIN)))_"x"
	S GC=$NA(@("^CacheTempSQL")@(IDU))
	S GD="^CacheTempSQL."_IDU K @GD	M @GD=@TD 
	I $D(@GC) Q "1 @CacheTempSQL."_IDU
	M @GC=^%ZAPM.ed.BSC4("SQL")	S @GC@("KEY")=GD 
	S PxPUSTO="" ;,NOKILLER=1 ;НЕ УДАЛЯТЬ ФАЙЛ CDL
	S NOqListBD=1 ;НЕ СОЗДАВТЬ ЗАПРОС И ИМЕНА ПОЛЕЙ НОРМАЛИЗОВАТЬ
	S OK=$$START^%ZAPM.ed.BSCBD(GC,1) I $E(OK)="0" K @GD,@GC
	Q OK_" @CacheTempSQL."_IDU
 
MSETSQL1   S BSR="^CacheTempSQL",BST="SQL1" D ^%ZAPM.ed.BST
	Q
]]></Routine>


<Routine name="%ZAPM.ed.BSCEXE" type="MAC" languagemode="0"><![CDATA[
%BSCEXE ; Cache' Dos-Functions for %BS ; 15:50   02.11.2001
 ;
 ; Copyright (c) Serge W. Mikhaylenko
 ; All Rights Reserved
 ;
 Q
 ;The following table shows the $ZU(140) flags recognized by Cache:
 ;Flag Operation
 ;  1 Returns file size in bytes.
 ;  2 Returns modification date/time in $H format
 ;  3 Returns creation date/time in $H format
 ;  4 Tests whether the named file exists (returns 0 if yes)
 ;  5 Deletes the named file
 ;  6 Renames the file specified in name with the name specified in newname. May move the file
 ;      to a different location, if the host operating system supports it.
 ;  7 Returns file attributes as a bit map.
 ;  8 [unused]
 ;  9 Creates the directory specified in name.
 ;  10 Deletes the directory specified in name
FileListDir(DIR,OUT,MODE,MASK) //выходной массив @OUT
 N mask,IndexLoop K @OUT D FileList(DIR,OUT,MODE,$G(MASK)) Q
FileList(DIR,OUT,MODE,MASK) //ВЫДАТЬ СПИСОК ФАЙЛОВ В ДИРЕКТОРИИ. MASK="exe,jpg,bmp" --- РАБОТАЕТ В ВЕБЛИНКЕ
 N rs,X,N
 I $G(MASK)'="" S mask=","_MASK_","
 set rs=##Class(%ResultSet).%New("%File.FileSet")
 S X=rs.Execute(DIR,"*.*") I X'=1 S Error=-1 Q
 F  Q:'rs.Next()  S N=rs.Get("Name") D
 .I ".."'[$P(N,"\",$L(N,"\")) D
 ..I $G(mask)'="",mask'[(","_$ZCONVERT($P($P(N,"\",$L(N,"\")),".",2),"L")_",") Q
 ..I MODE=1 S @OUT@($P(N,"\",$L(N,"\")))=rs.Get("Type")_"?"_rs.Get("Size")_"?"_rs.Get("DateCreated")_"?"_rs.Get("DateModified")
 ..I MODE=2,rs.Get("Type")'="D" S IndexLoop=$G(IndexLoop)+1,@OUT@(IndexLoop)=N_"?"_rs.Get("Type")_"?"_rs.Get("Size")_"?"_rs.Get("DateCreated")_"?"_rs.Get("DateModified")
 .I rs.Get("Type")="D",".."'[$P(N,"\",$L(N,"\")) D FileList(N_"\",$S(MODE=1:$NA(@OUT@($P(N,"\",$L(N,"\")))),1:OUT),MODE,$G(MASK))
 Q
 //$zu(140,1,filename)
GetFileSize(file,size,mode)  //ПРОЧИТАТЬ ИЗ ФАЙЛА  --- РАБОТАЕТ В ВЕБЛИНКЕ, ЕСЛИ size МЕНЬШЕ 32К !!! ТОЛЬКО ТЕКСТОВЫЕ ФАЙЛЫ
 N str,f,ok,len
 set f=##class(%File).%New(file)
 set ok=f.Open($G(mode,"RU"))     if 'ok do f.%Close() Q "-2"  //do DecomposeStatus^%apiOBJ(ok,.err) write !,err(err),!
 ;set len=$zu(140,1,file) I len<size S size=len
 S str=f.Read(.size) if size=-1 do f.%Close() Q "-1"
 do f.%Close()
 Q str
FileCopy(S,T) //КОПИРОВАТЬ ФАЙЛ
 N K,MM S K=$$File2Arr^%ZAPM.ed.BSCEXE(S,.MM) I 'K Q K
 Q $$Arr2File^%ZAPM.ed.BSCEXE(.MM,T)
Arr2File(Mas,file)  //ПРОЧИТАТЬ ИЗ МАССИВА И ПОЛОЖИТЬ В ФАЙЛ
 N str,f,ok,len,I,size
 set f=##class(%File).%New(file)
 set ok=f.Open("WN"),len=0     if 'ok do f.%Close() Q $$Err(ok)
 S I="" F  S I=$O(Mas(I)) Q:I=""  D f.Write(Mas(I)) S len=len+$L(Mas(I))
 do f.%Close()
 Q len_" byte"
File2Arr(file,Mas)  //ПРОЧИТАТЬ ИЗ ФАЙЛА И ПОЛОЖИТЬ В МАССИВ
 N str,f,ok,len,I,size
 set f=##class(%File).%New(file)
 set ok=f.Open("RSU")     if 'ok do f.%Close() Q $$Err(ok)
 set len=$zu(140,1,file)
 F I=0:30000:len D
 .S size=30000 S Mas(I)=f.Read(.size)
 do f.%Close()
 Q len_" byte"
 ; Note : need "W" to write, "R" to read, "N" for new, "U" to read over crlf delims ,S - BINARY STREAM
Err(ok) do DecomposeStatus^%apiOBJ(ok,.err) Q err(err)
 Q
File2Arr1() s file="L:\_ZD\mpki-.txt"
 N str,f,ok,len,I,size
 set f=##class(%File).%New(file),co=0
 set ok=f.Open("RSU")     if 'ok do f.%Close() Q $$Err(ok)
 set len=$zu(140,1,file)
 F I=0:1000:len s co=co+1 D   ;i co>10 q
 .S size=1000 S ^tMTKI(co)=f.Read(.size) w !,co," "_$e(^tMTKI(co),1,67)_".."
 do f.%Close()
 Q len_" byte"
GetFileC(file,flag)  //ВОЗВРАТИТЬ СОДЕРЖАНИЕ ФАЙЛА  --- РАБОТАЕТ В ВЕБЛИНКЕ, ЕСЛИ РАЗМЕР ФАЙЛА МЕНЬШЕ 32К
 N str,f,ok,len
 set f=##class(%File).%New(file)
 IF $D(flag) G GetFileCC
 set ok=f.Open("RU")     if 'ok do f.%Close() Q "-2"
 set len=$zu(140,1,file)
 S str=f.Read(.len) if len=-1 do f.%Close() Q "-1"
GetFileCE do f.%Close()
 Q str
GetFileCC K flag
 set ok=f.Open("R") if 'ok do f.%Close() Q "-2"
 F str=1:1 S len=32000,flag(str)=f.Read(.len) I len=-1 Q
 G GetFileCE
GetFile(file,ASCII) //ВОЗВРАТИТЬ СОДЕРЖАНИЕ ТЕКСТОВОГО ФАЙЛА  --- НЕ РАБОТАЕТ В ВЕБЛИНКЕ
  n a,s,x,S1,S2
  s $zt="GetFile1",s="",(S1,S2)="" I $D(ASCII) D INIT^%ZAPM.ed.BSre(ASCII)
  o file:"r":0 i '$t g GetFile1
  u file F  r a s s=s_$c(13,10)_$TR(a,S1,S2) ;u 0 w a,!
GetFile1 c file
 Q s
WINDOWS() Q "NT"
dir(dir,file) N w,a,s
 S w=$$command("d:\!\SHOW.BAT "_dir_" "_file)
  s $zt="dir1",s=""
  o file:"r":0 i '$t g dir1
  u file F  r a s s=s_$c(13,10)_a
  q
command(exec) ; Output directory listing
  n file,a,s,x
  s file=$$exec(exec,1)
  s $zt="dir1",s="" D INIT^%ZAPM.ed.BSre(0)
  o file:"r":0 i '$t g dir1
  u file F  r a s s=s_$c(13,10)_$TR(a,S1,S2) ;u 0 w a,!
dir1 c file
  d del(file)
  ;l -^%dosfile
dirq q s
 
del(D) i $$DelFile(D)
 Q
DelFile(D) ;Удаление файла
 N A S A=$ZU(140,5,D) I A=0 Q 1
 q A
 
files(spec) ; Return list of files that match pattern
  n (spec)
  s spec=$g(spec),Win=$$WINDOWS
  i Win="Win95" s exec="dir "_spec_" /v /a"
  e  i Win="NT" s exec="dir "_spec_" /x"
  e  s exec="dir "_spec_" /v /a"
  s file=$$exec(exec,1)
  s $zt="files1"
  o file:"r":0 i '$t g files1
  s str=""
  i Win="Win95" DO  ; --- Windows 95 Specific "DIR" Output ---
  . f  d
  .. u file r a
  .. i $e(a,1)=" "!(($e(a,9)'=" ")&($e(a,9)'=".")) q
  .. s pre=$tr($e(a,1,8)," ")                ; 8.2 DOS file name
  .. s suf=$tr($e(a,10,12)," ")
  .. s dosnam=pre
  .. i pre'["."&(suf'="") s dosnam=dosnam_"."
  .. s dosnam=dosnam_suf
  .. s a=$e(a,13,$l(a))
  .. d lspc                                  ; No leading spaces
  .. s f=$f(a," ")                           ; Find next space
  .. s size=$e(a,1,f-2),size=+$tr(size,",.") ; Actual size (no punctuation)
  .. s a=$e(a,f-1,$l(a))
  .. d lspc
  .. s f=$f(a," ")                          ; Skip allocated size
  .. s a=$e(a,f-1,$l(a))
  .. d lspc
  .. s f=$f(a," ")
  .. s dat=$e(a,1,f-2)                       ; 'Modified' date
  .. s a=$e(a,f-1,$l(a))
  .. s yy=$p(dat,"-",3)
  .. s mm=$p(dat,"-",2)
  .. s dd=$p(dat,"-",1)
  .. i yy>70 s yy=19_yy
  .. s dat=yy_"-"_mm_"-"_dd
  .. d lspc
  .. s f=$f(a," ")
  .. s tim=$e(a,1,f-2)                       ; 'Modified' time
  .. s a=$e(a,f-1,$l(a))
  .. s hh=+tim,mm=$p(tim,":",2)
  .. i mm["p" s hh=hh+$s(hh=12:0,1:12)
  .. i mm["a",hh=12 s hh=0
  .. s mm=$e(100+mm,2,3),hh=$e(hh+100,2,3)
  .. s tim=hh_":"_mm
  .. d lspc
  .. s f=$f(a," ")                           ; Skip Accessed date
  .. s a=$e(a,f-1,$l(a))
  .. s attr=$e(a,1,8),a=$e(a,9,$l(a))
  .. s attr=$zcvt(attr,"l"),attr=$tr(attr," ")
  .. d lspc
  .. s name=a                                ; 'Real' file name
  .. s str=str_dosnam_";"_attr_";"_size_";"_dat_";"_tim_";"_name_$c(10)
  e  DO  ; --- DEFAULT: Windows NT Specific "DIR" Output ---
  . f  d
  .. u file r a
  .. i $e(a,1)=" "!(($e(a,9)'=" ")&($e(a,3)'="/")) q
  .. s f=$f(a," ")
  .. s dat=$e(a,1,f-2)                       ; 'Modified' date
  .. s a=$e(a,f-1,$l(a))
  .. s mm=$p(dat,"/",1)
  .. s dd=$p(dat,"/",2)
  .. s yy=$p(dat,"/",3)
  .. i yy>70 s yy=19_yy
  .. s dat=yy_"-"_mm_"-"_dd
  .. d lspc
  .. s f=$f(a," ")
  .. s tim=$e(a,1,f-2)                       ; 'Modified' time
  .. s a=$e(a,f-1,$l(a))
  .. s hh=+tim,mm=$p(tim,":",2)
  .. i mm["p" s hh=hh+$s(hh=12:0,1:12)
  .. i mm["a",hh=12 s hh=0
  .. s mm=$e(100+mm,2,3),hh=$e(hh+100,2,3)
  .. s tim=hh_":"_mm
  .. d lspc
  .. i $e(a)="<" DO  ; Handle '<DIR>' stuff...
  ... s f=$f(a," ")                           ; Ignore '<DIR>'
  ... s attr=$e(a,1,f-2)
  ... s a=$e(a,f-1,$l(a))
  ... s attr="d"
  ... d lspc
  .. e  s attr=""
  .. s f=$f(a," ")                           ; Find next space
  .. i a'="",'f s size=a
  .. e  s size=$e(a,1,f-2)
  .. i 'f s (dosnam,name)=$s(size=".":$zcvt($p(spec,"\",$l(spec,"\")),"u"),1:size),size="",str=str_dosnam_";"_attr_";"_size_";"_dat_";"_tim_";"_name_$c(10) QUIT
  .. s size=+$tr(size,",.") ; Actual size (no punctuation)
  .. s a=$e(a,f-1,$l(a))
  .. d lspc
  .. s pre=$p($p(a,".",1)," ")                ; 8.2 DOS file name
  .. s suf=$p($p(a,".",2)," ")
  .. s dosnam=pre
  .. i pre'["."&(suf'="") s dosnam=dosnam_"."
  .. s dosnam=dosnam_suf
  .. s a=$e(a,f-1,$l(a))
  .. d lspc                                  ; No leading spaces
  .. s name=$s(a="":dosnam,1:a)              ; 'Real' file name
  .. s str=str_dosnam_";"_attr_";"_size_";"_dat_";"_tim_";"_name_$c(10)
files1  c file
  d del(file)
  ;l -^%dosfile
filesq  q str
 
size(D) ; Get size of single file (-1 indicates failure)
 N A S A=$ZU(140,1,D)
 Q A
volspace(spec) ; Get space left on drive
  n (spec)
  s spec=$g(spec),Win=$$WINDOWS
  i spec?1a s spec=spec_":"
  i Win="Win95" s exec="dir "_spec_"\"
  e  i Win="NT" s exec="dir "_$$curdrive()_":\"
  e  s exec="dir "_spec_"\"
  s file=$$exec(exec,1)
  s $zt="volspace1"
  o file:"r":0 i '$t g volspace1
  s b="" f i=1:1 s a=b u file r b
volspace1 ;
  c file
  d del(file)
  ;l -^%dosfile
  s a=b
  d lspc
  i Win="Win95" DO  ; --- Windows 95 Specific "DIR" Output ---
  . s f=$f(a," "),a=$e(a,f,$l(a))
  . s f=$f(a," "),a=$e(a,f-1,$l(a))
  . d lspc
  . s a=$p(a," ",1)
  e  DO  ; --- DEFAULT: Windows NT Specific "DIR" Output ---
  . s a=$p(a," ")
volspaceq q $tr(a,",.")
 
CurDisk() Q $$curdrive()
curdrive() ; Get current drive
  n file,i,a,Win
  s file="dir",Win=$$WINDOWS
  s $zt="curdrive1"
  o file:"rq":0 i '$t g curdrive1
  i Win="Win95" u file r a,a
  e  i Win="NT" u file r a
  e  u file r a,a
curdrive1 c file
curdriveq q $p(a," ",5)
 
GCDir(D) q $$ANSI^%ZAPM.ed.BSre($$subdir(D))
subdir(spec) ; Get current directory
  n (spec)
  s spec=$g(spec)
  i spec="" s spec=$$curdrive()
  i spec?1a s spec=spec_":"
  s file="dir "_spec
  s $zt="subdir1"
  o file:"rq":0 i '$t g subdir1
  u file r a,a,a,a
subdir1  c file
  s dir=$p(a," ",4)
  s dir=$p(dir,"\",2,$l(dir,"\"))
  i dir="" s dir="\"
subdirq  q dir
 
verify(spec) ; Check/Set verification of file copy
  n (spec)
  s spec=$g(spec)
  s spec=$zcvt(spec,"l")
  s flag=0 i spec'="on"&(spec'="off")&(spec'="") s spec="",flag=1
  i spec'="" s exec="verify "_spec d exec(exec,0) q
  s exec="verify"
  s file=$$exec(exec,1)
  s $zt="verify1"
  o file:"r":0 i '$t g verify1
  u file r a
verify1  c file
  d del(file)
  ;l -^%dosfile
  i flag w a,! q
verifyq  q a
 
copy(source,target) ; Copy files
  n (source,target)
  s source=$g(source),target=$g(target)
  i source=""!(target="") q
  s exec="copy "_source_" "_target
  d exec(exec,0)
copyq  q
 
RenFile(S,D) ; Rename files
 N A S A=$ZU(140,6,S,D) I A=0 Q 1
 Q 0
CNDir(D) ; Make a directory
 N A S A=$ZU(140,9,D) I A=0 Q 1
 Q 0
DelDir(D) ; Удалить пустую директорию
 N A S A=$ZU(140,10,D) I A=0 Q 1
 Q 0
type(spec) ; Type a file
  n (spec)
  s spec=$g(spec)
  i spec="" q
  s $zt="type1"
  o spec:"r":0 i '$t q
  f  u spec r a u 0 w a,!
type1  c spec
typeq  q
 
var(spec) ; DOS variables
  n exec,file,str,a,flag
  s spec=$g(spec)
  s exec="set"
  s file=$$exec(exec,1)
  s $zt="var1"
  o file:"r":0 i '$t g var1
  s str="",flag=0
  f  u file r a s str=str_a_$c(0) i $zcvt($p(a,"=",1),"l")=$zcvt(spec,"l")
  s str=$p(a,"=",2,999),flag=1 q
var1  c file
  d del(file)
  i spec'=""&('flag) s str=""
varq  q str
exists(file) ; Check to see if a file exists and return 0 or 1
  I $ZU(140,4,file)=0 Q 1
  Q 0
 ;Set Current Drive
SCDrive(D) Q "РЕЖИМ ПОКА НЕ ЭМУЛИРОВАН"
 Q
 ;Set File Attributes
SetAtr(F) Q "РЕЖИМ ПОКА НЕ ЭМУЛИРОВАН"
 Q
 ;Change Current Directory
CCDir(D) Q "РЕЖИМ ПОКА НЕ ЭМУЛИРОВАН"
 Q
 ;Get Drive Parameters
GetDPar(D) Q "РЕЖИМ ПОКА НЕ ЭМУЛИРОВАН"
 Q
 ;Get File Attributes
FileAtr(F,M) //Атрибуты ФАЙЛА
 I M=1 q $ZU(140,1,F) //- РАЗМЕР ФАЙЛА
 I M=2 q $ZD($P($ZU(140,2,F),",",1),3) //- ДАТА   $ZT($P(H,",",2),1)_" "_$ZD(H,3)
 I M=3 q $ZT($P($ZU(140,2,F),",",2),1) //- ВРЕМЯ
 Q ""
GetAtr(File)  //Атрибуты ФАЙЛА
 q $ZU(140,7,File)
 ;Существует ли файл
ExsFile(D) Q $$exists(D)
 Q
BegDir(D,V) ;Begin Directory Search 12 !!
 Q "" ;I $ZV["MSM" Q $ZOS(12,D,V)
SearFile(D,V) Q "РЕЖИМ ПОКА НЕ ЭМУЛИРОВАН"
 Q ""
 ;Continue Directory Search
ContDir(D) Q "РЕЖИМ ПОКА НЕ ЭМУЛИРОВАН"
 Q
Ver() N S1,S2 Q $$ANSI^%ZAPM.ed.BSre($$version)  ;Get MS-DOS Version Number
version() ; Get DOS Version
  n a,file
  s file="ver"
  s $zt="version1"
  o file:"rq":0 i '$t g version1
  u file r a,a
version1 c file
  d del(file)
versionq q a
 
EXE(EXE) I $zf(-1,EXE)
 Q
SysVer() N F,S //ПОЛУЧИТЬ ВЕРСИЮ ОПЕРАЦИОННОЙ СИСТЕМЫ
 I $ZV["Linu" S F="uname -a"
 E  S F="ver"
 S F=$$exec(F,1)
 S S=$TR($$GetFileSize(F,32000),$C(13,10))
 D del(F)
 Q $$ANSI^%ZAPM.ed.BSre(S)
exec(exec,out) ; Executable string
  i out d  q file
  .;l +^%dosfile
  . s file=$$TEMPDIR^%ZAPM.ed.BSCF1_"BS"_$TR($G(%BS(3),$P),":|,","")_$J_".tmp"
  . s x=$zf(-1,exec_" > "_file)
  i 'out d
  . s x=$zf(-1,exec)
execq q
lspc  ; Strip leading spaces
  i $e(a,1)=" " s a=$e(a,2,$l(a)) g lspc
lspcq  q
 ////////////////////////////////////////////////////////////////
 
 
test0 //пример нового доступа к внешней таблицы ODBC
 
 
 ////////////////////////////////////////////////////////////////
 S dsn="NuSphere"
 s BSUsEr="root"
 S BSPsWrD=""
 S sql="SELECT * FROM e107_user"
 //S IF="1 S Break=(ii>1)"
 s TG="^sss"
 d Read(dsn,sql,$G(IF),,TG) ;НОВЫЙ БОЛЕЕ ПРАВИЛЬНЫЙ АНАЛОГ D Read^%ZAPM.ed.BSCG
 I $D(Errors) W !,Errors ;ПОСМОТРЕТЬ ОШИБКИ
 I $G(TG)'="" D ^%ZAPM.ed.BSMSMG(TG) ;ВОЙТИ В РЕДАКТОР МАССИВОВ
 q
test1 M MM=^sss(4,1) D STR2MAS^%ZAPM.ed.BSCmail(.MM,.MMM,$C(13,10)) K ^ss M ^ss=MMM
	Q
test2 K MM M MM=^sss(4,1) D Arr2File^%ZAPM.ed.BSCEXE(.MM,"N:\1")
	Q
Read(DSN,SQL,IF,ErV,TG) ;ЧТЕНИЕ ТАБЛИЦЫ В МАССИВ TG
ReadInt	d ReadSql(DSN,$G(BSUsEr),$G(BSPsWrD),SQL,TG,IF,$G(ErV))
	q
ReadSql(dsn,login,pswd,sql,vcol,IF,ErV) ;ЧТЕНИЕ ТАБЛИЦЫ В МАССИВ TG
 n stmt,con,sc,ncols,i,ii,idRec,v,ColsInfo,Break
 //код для совместимости со старыми программами
 i $G(ErV)'=0 S ErV=1  // ErV=1 ;ВСЕ СООБЩЕНИЯ БУДУТ НАХОДИТСЯ В ПЕРЕМЕННОЙ Errors
 K Errors
 S $ZT="Dis"
 I $G(vcol)'="" K @vcol S @vcol@(-1)=sql
 I $G(IF)'="" I $G(vcol)'="" S @vcol@(-2)=IF
 //
 S con=##Class(%SQLGatewayConnection).%New()
 S sc=con.Connect(dsn,login,pswd)
 s sc=con.AllocateStatement(.stmt)
 I +sc'=1 d Er g Dis
 S sc=con.Prepare(stmt,sql)
 I +sc'=1 d Er g Dis
 S sc=con.Execute(stmt)
 S sc=con.DescribeColumns(stmt,.ColsInfo)
 S ncols=$LI($LI(ColsInfo,1),1)
 ;W "ncols=",ncols,! //количество колонок
 I ncols<1  d Er g Dis
 d hdr
 S ii=0  //счетчик записей
 for  {
	s sc=con.Fetch(stmt)
	I +sc'=1 Q  //дошли до конца
	S ii=ii+1
	for i=1:1:ncols S v="" S sc=con.GetData(stmt,i,1,.v) d
	.s @vcol@(ii,i)=$e(v,1,31743) i $l(v)>31743 D
	..f i1=1:1 q:$e(v,31743)=""  S sc=con.GetData(stmt,i,1,.v) s @vcol@(ii,i,i1)=$e(v,1,31743)
	i $G(IF)'="" x "I "_IF //логика внутри цикла
	I $G(Break) Q  //прерывание перебора - Break создался внутри IF
 }
Dis D con.Disconnect()
 Q
Er do DecomposeStatus^%apiOBJ(sc,.Errors) i $g(ErV)'=1 zw Errors
 q
hdr //информация по полям и заголовке БД
 ;S w(1)=10,w(2)=9,w(3)=11,w(4)=8,w(5)=5,w(6)=12,w(7)=11,w(8)=4
 ;S x(1)=0 for i=2:1:8 S x(i)=x(i-1)+w(i-1) 
 ;W ?x(1),"Name" 
 ;W ?x(2),"SQL type" 
 ;W ?x(3),"Size"
 ;W ?x(4),"Dec dig"
 ;W ?x(5),"Null" 
 ;W ?x(6),"Datype"
 ;W ?x(7),"Dis sz" 
 ;W ?x(8),"Currency",!
 for i=1:1:ncols {
   S ColInfo=$LI(ColsInfo,i+1)
   s @vcol@(0,i)=$LI(ColInfo,1)
   ;for i1=1:1:7 W ?x(i1),$LI(ColInfo,i1)
 }	 
 Q
 
%GOF(IO,glovec,desc) //OUT
 N IOT,IOPAR          ;S IO="C:\FILENAME.GOF",
 S IOT="RMS",IOPAR="" ;,glovec("%A")="",glovec("%B")="",desc="description"
 Q $$entry^%GOF(.glovec,desc) ;W !,"Globals exported successfully" Q
 
%GIF(IO) ;IN
 ;S IO="C:\FILENAME.GOF"
 N IOT S IOT="RMS" 
 Q $$entry^%GIF() ;W !,"Globals imported successfully" Q
 
ASYS4 ;Кривошеев С.А.;Системные процедуры и функции;;[ 23/10/2003 8:54 ]
Ri(File,Typ)                           ; * Импорт программ *
 N case
 ; File  - имя файла
 ; Fetch - строка шаблон
 s Typ=$g(Typ,"Cache")
 s File=File_":(""RU"")"
 S case=$$rload^%Wr(File,Typ,0,2,1,0,0,0)
 Q case
Ro(File,Name,Type,Descrip)             ; * Экспорт программ *
 N case,type,name
 ; File    - имя файла
 ; Name    - имя переменной со списком программ @Name@(i)="rtn.INT"
 ; Type    - тип программ INT, MAC, OBJ
 ; Descrip - коментарий
 S Name=$G(Name)
 S Type=$G(Type,"INT")
 S Descrip=$G(Descrip)
 S name=$NA(^%utility($J))
 I Name'="" K @name M @name=@Name
 S type="Cache"
 S:Type="OBJ" type="Object"
 S case=$$rsave^%Wr(Type,File_":(""NW"")",Descrip,type,0,0,1)
 Q case
FetchR(Fetch,Name,Type)                ; * Выбрать программы по шаблону *
 N case,name,nam,i
 ; Fetch - Строка шаблон "rtn,a*,'ab,'ac"
 ; Name  - имя переменной результата
 ; Type  - переделывать результат в @Name@(i)=rtn или оставить @Name@(rtn)=""
 S Fetch=$G(Fetch,"*")
 S Name=$G(Name)
 S Type=$G(Type,1)
 K:Name'="" @Name
 S name=$NA(^%utility($J))
 K @name
 S case=$$rsel^%Wr(Fetch)
 Q:'case 0
 I Type=0 M:Name'="" @Name=@name K:Name'="" @name Q case
 S:Name="" Name=name
 S nam=""
 F  S nam=$O(@name@(nam)) Q:(nam="")!(+nam=nam)  S @Name@($I(i))=nam K @name@(nam)
 K:Name'=name @name
 Q case
Gi(File,Fetch,Scr)                     ; * Импорт глобалов тип 5 Cache *
 N case,name,IO
 ; File  - имя файла
 ; Fetch - строка шаблон "^glb"_$C(13,10)_"^tmp*"
 ; Scr   - вывод на экран
 S Fetch=$G(Fetch,"*")
 S Scr=$G(Scr,0)
 S IO=Scr
 S case=$$main^%Wgr(File_":(""VR"")",5,Fetch,0,0,0)
 Q case
Go(File,Name,Rm,Scr)                   ; * Экспорт глобала тип 5 Cache *
 N case,name,IO,RM
 ; File  - имя файла
 ; Name  - имя переменной со списком глобалов @Name@(i)="^tmp(1,2"
 ; Rm    - 
 ; Scr   - вывод на экран
 S Name=$G(Name)
 S Rm=$G(Rm,80)
 S Scr=$G(Scr,0)
 S name=$NA(^%utility($J))
 M:Name'="" @name=@Name
 S IO=Scr
 S RM=Rm
 S case=$$main^%Wgs(File_":(""VNW"")",5,"",0,0)
 Q case
Gif(File,Del,Fetch,Name,Scr)           ; * Импорт глобалов тип 7 Cache Block *
 N case,name,IO
 ; File  - имя файла
 ; Del   - удалять глобалы
 ; Fetch - строка шаблон "^glb"_$C(13,10)_"^tmp*"
 ; Name  - имя переменной со списком глобалов @Name@("glb")=""
 ; Scr   - вывод на экран
 S Fetch=$G(Fetch,"*")
 S Name=$G(Name)
 S Scr=$G(Scr,0)
 S Del=$G(Del,1)
 S name=$NA(^%utility($J))
 S IO=Scr
 D Gif1
 Q:case=0 0
 D:Del Gif2
 S case=$$main^%Wgr(File_":(""RU"")",7,Fetch,0,0,0)
 Q case
Gif2                                   ; удаление глобалов
 N var,nam
 S var=""
 F  S nam=$O(@name@(var)) Q:var=""  S nam="^"_var K @nam
 Q
Gif1                                   ; прочитать заголовок из файла
 N i,r
 S case=$$header^%Wgr(File_":(""UR"")",7,0)
 Q:case=0
 I Name'="" Q:Name=1  K @name M @name=@Name Q
 S case=$P(case,$C(22,35,1),2)
 K @name
 S r=$C(19,94,1)
 F i=1:1:$L(case,r)-1 S @name@($P(case,r,i))=""
 Q
Gof(File,Comment,Name,Scr)             ; * Экспорт глобалов тип 7 Cache Block *
 N case,name,IO
 ; File    - имя файла
 ; Comment - строка коментария к данным
 ; Name    - имя переменной со списком глобалов @Name@(i)="^glb"
 ; Scr     - вывод на экран
 S Comment=$G(Comment)
 S Name=$G(Name)
 S Scr=$G(Scr,0)
 S name=$NA(^%utility($J))
 M:Name'="" @name=@Name
 S IO=Scr
 S case=$$main^%Wgs(File_":(""WNU"")",7,Comment,0,0)
 Q case
GoMSM(Fetch,File,Scr)                  ; * Экспорт глобалов в формате %GS MSM *
 n ok,name,glb,i
 s Scr=$g(Scr,1)
 s File=$$FOpen^ASYS(File)
 i File="" q:$q 0 q
 s ok=$$FetchG(Fetch)
 i 'ok q:$q 0 q
 S name=$NA(^%utility($J))
 w:Scr !,"Запись глобалов",!
 d BEGTXT
 s i=0
 s glb=""
 f  s glb=$o(@name@(glb)) q:glb=""  d NEWGLB
 d END("**")
 c File
 w !,"Запись завершена! Записан(о) ",i," глобал(а)"
 q:$q 1
 q
BEGTXT                                 ; Начальный текст
 n txt
 s txt=$$Time^zfunc()_" "_$$Date^zfunc()_" OOO NTC Air, 2003"
 d USE^ASYS3(File)
 w txt,!
 w "",!
 d USE^ASYS3()
 q
NEWGLB                                 ; Очередной глобал
 n uz,val
 s i=i+1
 s uz=@name@(glb)
 w $$PadR^zfunc(uz,10)
 s val=$d(@uz)
 i (val=1)!(val=11) d W(uz)
 f  s uz=$q(@uz) q:uz=""  d W(uz)
 d END("*")
 q
END(Txt)                               ; Записать концовку
 d USE^ASYS3(File)
 w Txt,!
 w Txt,!
 d USE^ASYS3()
 q
W(Name)                                ; Запись узла
 d USE^ASYS3(File)
 w Name,!
 w @Name,!
 d USE^ASYS3()
 q
FetchG(Fetch,Name,Type)                ; * Выбрать глобалы по шаблону *
 N count,name,i,nam
 ; Fetch - Строка шаблон "glb;a*;'ab;'ac"
 ; Name  - имя переменной результата
 ; Type  - переделывать результат в @Name@(i)=glb или оставить @Name@(glb)=""
 S Fetch=$G(Fetch,"*")
 S Name=$G(Name)
 S Type=$G(Type,1)
 K:Name'="" @Name
 S name=$NA(^%utility($J))
 K @name
 S count=$$Fetch^%GD(Fetch,1,0)
 I $I=2 K ^%utility("SPOOL")
 Q:'count 0
 I Type=0 M:Name'="" @Name=@name K:Name'="" @name Q count
 S:Name="" Name=name
 S nam=""
 F  S nam=$O(@name@(nam)) Q:(nam="")!(+nam=nam)  S:$D(@nam) @Name@($I(i))=nam K @name@(nam)
 K:Name'=name @name
 Q count 
 //----------------------------
 /*Сначала насчет хелпа :)
Все системные утилитки ^%W* являются недокументированными и НЕ
предназначены для прямого использования (писаны они как ответная часть
виндовых утилит) Но так как до 5-й версии нет (или я не нашел)
системных утилит для использования из под программ на COS (%RI и %RO
не считаются - т.к. они сугубо интерактивные), то приходится
разбираться с исходниками ^%W* и огромное спасибо ИнтерСистемз за то
что они оставили их открытыми!
Собственно эти исходники и являются единственным ХЕЛПОМ для меня :)
 
Теперь насчет импорта:
Есть аналогичная точка входа в ^%Wr
но с ней НЕ так все просто так как нет возможности в программе
получить список возникших ошибок при компиляции загружаемых программ!
Ее можно только заставить вывалить уведомления на текущее устройство
но для использования в программе сие не годится!
На всякий случай все таки приведу мое описание этой функции:
 
(Всё IMHO)
 
$$rload^%Wr(file,format,selection,over,compile,syntax,backup,showstat,langmode,pasting)
где:
file - по аналогии с rsave: "диск:/путь/файл:(""RS"")" (вместо RS в
       принципе м.б. другие параметры открытия файла)
format - Формат импорта ("Cache","DTM","DSM","Object","ISM","MSM",и.т.д)
selection - 0-все проги из файла
            1-поименным списком (список в ^%utility($j,Имя,Тип)=""
                                 где Имя - имя программы
                                     Тип - "INT","MAC","BAS" и т.д.)
            2-по списку масок   (список в ^%utility($j,Тип,i)=маска
                                 где Тип - "INT","MAC","BAS" и т.д.
                                     i - 1,2,3,...
                                     маска - "=имя" - эквивалентность
                                             "?шаблон" - соотв.М-шаблону
                                             "имя1:имя2" - диапазон)
over - 0 - не перезаписывать существующие
       1 - делать запрос на перезапись (не подходит !!!)
       2 - всегда перезаписывать существующие
compile - 0 - не компилировать а только загрузить тексты
          1 - компилировать при загрузке
syntax - ??? не используется ???
backup - 1 - создавать резервную копию
         0 - не создавать
showstat - 1 - показывать ход выполнения (write на $p -устройство)
           0 - не показывать ход выполнения
langmode - Языковый режим компиляции:("Cache","DSM-11","DTM","Ipsum","Cobra","DSM-VMS","MSM" и т.д.)
pasting - 0 !
 
 
Ну и типа пример: :-)
 s x=$$rload^%Wr("e:/cache5/viewsc.rsa:(""RS"")","Cache",0,2,1,0,0,0,"Cache")
 
 */
 
]]></Routine>


<Routine name="%ZAPM.ed.BSCF1" type="MAC" languagemode="0"><![CDATA[
%BSCF1 ; пpогpамма ФУНКЦИЙ ; 13:37   12.09.2002
 ;
 ; Copyright (c) Serge W. Mikhaylenko
 ; All Rights Reserved
 ;
 Q
As2An(Sours) ;ПЕРЕКОДИРОВКА ;трансляциЯ из ASCII в ANSI ; 14:21 26-SEP-97
 I '$D(As2An1) D INIT^%ZAPM.ed.BSre(1) S As2An1=S1,As2An2=S2
 Q $TR(Sours,As2An1,As2An2)
CELL(G,Y,FORX,ANSI,DEL)
 N VALUE,S1,S2,As2An1,As2An2
 I '$$Data^%ZAPM.ed.BSF12(G) Q ""
 S DEL=$G(DEL,$C(1))
 S VALUE="" I $G(ANSI) D  Q VALUE
 .D INIT^%ZAPM.ed.BSre(1) S As2An1=S1,As2An2=S2
 .X "F X="_FORX_" S VALUE=VALUE_$TR($P($G(@G@(Y,X)),""@"",15),As2An1,As2An2)_DEL"
 X "F X="_FORX_" S VALUE=VALUE_$P($G(@G@(Y,X)),""@"",15)_DEL"
 Q VALUE
TEMPDIR() ;ВОЗВРАТИТЬ ДИРЕКТОРИЮ ДЛЯ ВРЕМЕННЫХ ФАЙЛОВ
 Q $$TEMPDIR^%ZAPM.ed.BSpgBS
OpenFile(N,M) ;ОТКРЫТЬ ФАЙЛ
 I M="R" O N:("RW"):3 E  Q 0
 I M="W" O N:("WNS"):3 E  Q 0
 ;I M="A" O N:(/WRITE:/APPEND):3 E  Q 0 ;"ДОПИСАТЬ"
 I M="A" O N:("WAS"):3 E  Q 0 ;"ДОПИСАТЬ"
 S %DEV=N
 Q 1
Open(N,M) ;ОТКРЫТЬ ФАЙЛ
 S DOS=0
 I M="R" O N:("RW"):3 E  D ErO Q -1
 ;I M="A" O N:(/WRITE:/APPEND):3 E  D ErO Q -1   ;"ДОПИСАТЬ"
 I M="A" O N:("WAS"):3 E  D ErO Q -1
 I M="W" O N:("WNS"):3 E  D ErO Q -1
 S DOS=N
 Q 0
ErO u $P d ErrMsg^%ZAPM.ed.BSXfun(" Не могу откpыть файл "_N_" ") Q
WEBROOT() N D
 S D=$$GETOPT^%ZAPM.ed.BSC4cfg($$MainOpt^%ZAPM.ed.BSC4,"TempDir2") //???ПОКА ТАК
 ;S D=$G(^%ZAPM.ed.BSC("WWWROOT"))
 I D="" Q ""
 I $$exists^%ZAPM.ed.BSCEXE(D) Q D
 Q ""
UpWEB(G) ;WEB INSTALLING
 N D,F,S,I,II S D=$$WEBROOT() I D="" Q 0
 I $$DelFile^%ZAPM.ed.BSCEXE(D_"\BS-WEB.BAT")
 S F=D_"\BS-WEB.BAT" I '$$OpenFile(F,"W") Q 0
 U F W $P(D,":",1)_":",!,"CD \",!,"CD ",$P(D,":",2),!,"BS-WEB.EXE -Y",!,"DEL BS-WEB.EXE",!,"DEL BS-WEB.PIF",!,"DEL BS-WEB.BAT",!
 C F
 I $$DelFile^%ZAPM.ed.BSCEXE(D_"\BS-WEB.PIF")
 S S=@G@(0),F=D_"\BS-WEB.PIF" I '$$OpenFile(F,"W") Q 0
 U F W S C F
 I $$DelFile^%ZAPM.ed.BSCEXE(D_"\BS-WEB.EXE")
 S F=D_"\BS-WEB.EXE" I '$$OpenFile(F,"W") Q 0
 S I=0 U F F  S I=$O(@G@(I)) Q:I=""  W @G@(I)
 C F D EXE^%ZAPM.ed.BSCEXE(D_"\BS-WEB.BAT")
 S F=D_"\BS\BS.GIF" I '$$OpenFile(F,"R") Q 0
 C F Q 1
UpDFLT(G) ;УСТАНОВКИ
 N S,SS,I,II,III,IIII D ROU(G,1) Q
ROU(G,F) S S="",III=0,IIII=1 K @G@("ROU") F I=1:1 Q:'$D(@G@(I))  D
 .S S=S_@G@(I) F II=1:1:$L(S,$C(13,10))-1 S SS=$P(S,$C(13,10),II) D:'(I=1&(II<3))
 ..I SS="" S III=0,IIII=IIII+1 Q
 ..S III=III+1,@G@("ROU",IIII,III)=SS
 .S S=$P(S,$C(13,10),II+1)
 G:$G(F) CacheGR S SS="ZR  F I=1:1 Q:'$D(@G@(""ROU"",I))  X III ZS @NAME ZR  ",IIII="S NAME=$P(@$ZR,""."")"
 S III="F II=1:1 Q:'$D(@G@(""ROU"",I,II))  X:II=1 IIII ZI:II'=1 @$ZR:+(II-2)" X SS K @G
 Q
CacheGR ;Restore Globals in Cache' Object
 D NaSET^%ZAPM.ed.BSZRO,ACT
 D NaGET^%ZAPM.ed.BSZRO
 Q
CacheSET(S,SS) S $ZT="CacheERS^"_$ZN
 S @S=SS
 Q
CacheERS ;ОШИБКА
 S ^mtempBSerror(0)=$G(^mtempBSerror(0))+1
 S ^mtempBSerror(^mtempBSerror(0),"R")=S
 S ^("V")=SS,^("E")=$ZE
 Q
ACT S NewG="" K ^mtempBSerror
 F I=1:1 Q:'$D(@G@("ROU",I))  F II=1:2 Q:'$D(@G@("ROU",I,II))  D
 .S S=@G@("ROU",I,II),SS=$G(@G@("ROU",I,II+1))
 .I NewG'=$P(S,"(") S NewG=$P(S,"(") I $E(NewG,1,4)="^%ZAPM.ed.BS"&($E(NewG,1,7)'="^%ZAPM.ed.BSbuf") K @NewG
 .D CacheSET(S,SS)
 K @G I $D(^mtempBSerror) S ^mtempBSerror=$$ESDAY^%ZAPM.ed.BSsFUNR(6,$H) ;Date for Cache'
 Q
]]></Routine>


<Routine name="%ZAPM.ed.BSCF2" type="MAC" languagemode="0"><![CDATA[
%BSCF2 ; пpогpамма длЯ ИМПОРТА ИЗ Cache' В EXCEL ; 16:41   06.03.2000
 ;
 ; Copyright (c) Serge W. Mikhaylenko
 ; All Rights Reserved
 ;
DIR Q
TableString(G,Y,FORX,ANSI,DEL)
 N VALUE,S1,S2,As2An1,As2An2
 I '$$Data^%ZAPM.ed.BSF12(G) Q -1 ;ПОЛНАЯ ССЫЛКА НА ТАБЛИЦУ
 I '$D(@G@(Y)) Q -2 ;ТАКОЙ СТРОКИ НЕТ
 S DEL=$G(DEL,$C(1)) ;РАЗДЕЛИТЕЛЬ
 S VALUE="" I $G(ANSI) D  Q VALUE ;НАДО ПЕРЕКОДИРОВАТЬ
 .D INIT^%ZAPM.ed.BSre(1) X "F X="_FORX_" S VALUE=VALUE_$TR($P($G(@G@(Y,X)),""@"",15),S1,S2)_DEL"
 X "F X="_FORX_" S VALUE=VALUE_$P($G(@G@(Y,X)),""@"",15)_DEL"
 Q VALUE
TextString(G,FORY,ANSI,DEL)
 N VALUE,S1,S2,As2An1,As2An2
 I '$$Data^%ZAPM.ed.BSF12(G) Q -1 ;ПОЛНАЯ ССЫЛКА НА ТЕКСТ
 I '$D(@G@(Y)) Q -2 ;ТАКОЙ СТРОКИ НЕТ
 S DEL=$G(DEL,$C(1)) ;РАЗДЕЛИТЕЛЬ
 S VALUE="" I $G(ANSI) D  Q VALUE ;НАДО ПЕРЕКОДИРОВАТЬ
 .D INIT^%ZAPM.ed.BSre(1) X "F Y="_FORY_" S VALUE=VALUE_$TR($G(@G@(Y)),S1,S2)_DEL"
 X "F Y="_FORY_" S VALUE=VALUE_$G(@G@(Y))_DEL"
 Q VALUE
]]></Routine>


<Routine name="%ZAPM.ed.BSCG" type="MAC" languagemode="0"><![CDATA[
%BSCG ; пpогpамма SQL-Gate ; 10:19   19.10.2001
 ;===================================================================
 ;| Пример для зимней школы 1999 тема SqlGate                       |
 ;|                                           ;Н.Жохов              |
 ;| loaddll       загрузить dll библиотеку                          |
 ;| freedll       выгрузить dll библиотеку                          |
 ;| connect                                                         |
 ;| disconnect                                                      |
 ;| Create        создать таблицу                                   |
 ;| Populate      создать экзмпляры записей                         |
 ;| Select        Сделать выборку                                   |
 ;| TableCatalog(mode)                                              |
 ;| TableColumn                                                     |
 ;| ProcCatalog                                                     |
 ;| CallProc      Вызов хранимой процедуры                          |
 ;===================================================================
 Q
T2 S DNS="TDBF" G 1
T1 ;ТЕСТ
 N Errors,DNS,SQL,IF,ErV,TG,Break,Return
 ;---ИМЯ DNS
 S DNS="KSP"
1 ;---ЗАПРОС К БАЗЕ
 ;S SQL="SELECT nwc, snaim FROM knh WHERE nwc LIKE '3%' AND snaim LIKE '1%' AND TRUE"
 ;S SQL="SELECT Knh.NWC, Knh.SNAIM, KPD.HAR, KPD.IMJ FROM Knh LEFT JOIN KPD ON Knh.KPD = KPD.KPD WHERE (((Knh.NWC) Like '6%') AND ((KPD.IMJ) Like 'Мо%'));"
 S SQL="SELECT * FROM TEL"
 ;---ФОРМУЛА ДОПОЛНИТЕЛЬНОЙ ВЫБОРКИ ИЗ РЕЗУЛЬТАТОВ ВЫБОРКИ
 ;d - СТРОКА ЗАПИСИ РЕЗУЛЬТАТА ВЫБОРКИ  $LI(d,5) - ЗНАЧЕНИЕ 5 ПОЛЯ
 ;ЕСЛИ ПРИСВОИТЬ Break=1 , ТО ПЕРЕБОР ВЫБОРКИ ПРЕРВЕТСЯ
 S IF="$E($LI(d,1),1)'=0" ;"I $LI(d,1)=""3657"" S Break=1,Return=$LI(d,2)"
 ;---ПОДАВЛЯТЬ ВЫВОД СООБЩЕНИЙ ОБ ОШИБКАХ НА ТЕКУЩЕЕ УСТРОЙСТВО (КОНСОЛЬ)
 S ErV=1 ;ВСЕ СООБЩЕНИЯ БУДУТ НАХОДИТСЯ В ПЕРЕМЕННОЙ Errors
 ;---МАССИВ В КОТОРЫЙ ЗАПИСАТЬ РЕЗУЛЬТАТЫ ВЫБОРКИ, ИНАЧЕ ВСЕ ВЫВЕДЕТСЯ НА КОНСОЛЬ
 S TG="" ;"TEMPO"
 D Read(DNS,SQL,IF,ErV,TG)
 I $D(Errors) W !,Errors ;ПОСМОТРЕТЬ ОШИБКИ
 I $G(TG)'="" D ^%ZAPM.ed.BSMSMG(TG) ;ВОЙТИ В РЕДАКТОР МАССИВОВ
 Q
 
Read(DSN,SQL,IF,ErV,TG) ;выполнение запроса и результат положить В МАССИВ TG
 ;@TG@(-2)=IF - логика ограничения выполнения перебора полученного результата
 ;@TG@(-1)=SQL
 ;@TG@(0,number_field)=ИМЯ ПОЛЯ
 ;@TG@(number_record,number_field)=ЗНАЧЕНИЕ ПОЛЯ
 ;@TG@(number_record,number_field,k)=если ЗНАЧЕНИЕ ПОЛЯ больше 31k
 g ReadInt^%ZAPM.ed.BSCEXE //НОВЫЙ КОД
 N hstmt,e,ColInfo,ncol,d,i,sql,rc,ColName,hdbc,Break
 K Errors
 S $ZT="ERG^%ZAPM.ed.BSCG"
 I $G(TG)'="" K @TG S @TG@(-1)=SQL
 I $G(IF)'="" D  I $G(TG)'="" S @TG@(-2)=IF
 . ;ПРОВЕРИТЬ СИНТАКСИС У IF
 d loaddll(),connect(DSN,$G(BSUsEr),$G(BSPsWrD))
 d Select(SQL,$G(IF),$G(TG))
 d disconnect,freedll
 Q
ERG D EW($ZE_" "_$$ErrSay^%ZAPM.ed.BSF8($ZE)) Q
intDSN(DSN,USER,PASS) ; ИНФОРМАЦИЯ ПО DSN --> WEBSQL
 N I,II,i,ii,ErV,%,d,e,hdbc,iName,iType,name,rc
 S ErV="1 "
 S WEBSQL=DSN D iDSN(DSN,$G(USER),$G(PASS))
 Q
iDSN(DSN,USER,PASS) ; ИНФОРМАЦИЯ ПО DSN
 d loaddll(),connect(DSN,$G(USER),$G(PASS)) I hdbc'=0 D
 .;d TableCatalog(1) ;СТРУКТУРА НО НЕ ТА...
 .d TableCatalog(0) ; КАКИЕ ТАМ ТАБЛИЦЫ
 .d disconnect
 D freedll
 Q
iTAB(DSN,tbl,USER,PASS) ;ИНФОРМАЦИЯ ПО ТАБЛИЦЕ !!!!! НЕ РАБОТАЕТ
 d loaddll(),connect(DSN,$G(USER),$G(PASS)) I hdbc'=0 D
 .D TableColumn(tbl)
 .d disconnect
 D freedll
 Q
iSQL(DSN,tbl,USER,PASS) ;ВЫПОЛНЕНИЕ ПОЛНОЙ ВЫБОРКИ ИЗ ТАБЛИЦЫ
 d loaddll(),connect(DSN,$G(USER),$G(PASS)) I hdbc'=0 D
 .d Select("SELECT * FROM "_tbl,"","")
 .d disconnect
 D freedll
 Q
 
TEST(DSN) ;ТЕСТ С DSN-СОЕДИНЕНИЕМ
 d loaddll(),connect(DSN)
 ;d CreateTable
 d Populate
 d Select("SELECT * FROM TEST","","")
 ;d TableCatalog(1)
 ;d TableCatalog(0)
 d disconnect,freedll
 Q
 ;===================================================================
loaddll(DIR) ;ЗАГРУЗИТЬ DLL
 S %=$ZF(-3,$G(DIR,$P($$defdir^%GLO("%SYS"),"\mgr")_"\bin\cgate.dll"),"Connect","","","") Q
freedll ;ОСВОБОДИТЬ DLL
 S %=$ZF(-3,"") Q
 ;===================================================================
CreateTable ; Создание таблицы TEST
 N hstmt,e
 S hstmt=$ZF(-3,"","AllocStatement",hdbc) I hstmt=0 W "can't alloc statement",!
 S sql="CREATE TABLE TEST (A1 VARCHAR(50), A2 VARCHAR(50))"
 S e=$ZF(-3,"","Prepare",hstmt,sql) I e'=0 D Err(e),DropStatement(hstmt) Q
 S e=$ZF(-3,"","Execute",hstmt) I e'=0 D Err(e),DropStatement(hstmt) Q
 S e=$ZF(-3,"","DropStatement",hstmt) D Err(e)
 Q
 ;===================================================================
 ; Заполнение данными таблицы TEST
 ; Для таких утверждений удобнее работать с параметрами
Populate
 S hstmt=$$AllocStatement I hstmt=0 Q
 S sql="INSERT INTO TEST (A1,A2) VALUES (?, ?)"
 ;S sql="INSERT INTO TEST (A1,A2) VALUES (""ZZZ"", ""QQQ"")"
 S e=$ZF(-3,"","Prepare",hstmt,sql) I e'=0 D Err(e),DropStatement(hstmt) Q
 ;S e=$ZF(-3,"","Execute",hstmt) I e'=0 B
 ;Q
 S pdtl=$LB(50,50)
 S pdt=$LB(12,12)
 S ps=$LB(0,0)
 S piot=$LB(1,1) ; in=1, in/out =2, out=4
 S ppr=$LB(50,50)
 S e=$ZF(-3,"","BindParameters",hstmt,pdtl,pdt,ps,piot,ppr) I e'=0 W "Bind failed",! D Err(e),DropStatement(hstmt) Q
 D new("AA","X")
 D new("AB","X")
 D new("BA","X")
 D new("BB","X")
 D DropStatement(hstmt)
 Q
new(a1,a2)
 S e=$ZF(-3,"","SetParameter",hstmt,$LB(a1),1) I e'=0 B
 S e=$ZF(-3,"","SetParameter",hstmt,$LB(a2),2) I e'=0 B
 S e=$ZF(-3,"","Execute",hstmt) I e'=0 B
 Q
 ;===================================================================
DeleteTable ;
 N hstmt,e
 S hstmt=$ZF(-3,"","AllocStatement",hdbc) I hstmt=0 W "can't alloc statement",! Q
 S sql="DROP TABLE TEST"
 S e=$ZF(-3,"","Prepare",hstmt,sql) I e'=0 D Err(e),DropStatement(hstmt) Q
 S e=$ZF(-3,"","Execute",hstmt) I e'=0 D Err(e),DropStatement(hstmt) Q
 D DropStatement(hstmt)
 Q
 ;===================================================================
 ; показать таблицы в Источнике Данных
TableCatalog(mode)
 N hstmt,e,i,ncol,ColInfo
 S hstmt=$$AllocStatement I hstmt=0 Q
 
 S e=$ZF(-3,"","Tables",hstmt,"","","","") I e'=0 D Err(e),DropStatement(hstmt) Q
 
 S ColInfo=$ZF(-3,"","DescribeColumns",hstmt)
 
 ; показать имена столбцов используемых
 ; для описания запроса списка таблиц
 I $G(mode)=1 D ShowResSetStruc(ColInfo) D DropStatement(hstmt) Q
 
 S ncol=$LI($LI(ColInfo,1),1)
 
 ; найти индексы столбцов имени и типа таблицы
 F i=1:1:ncol D
 .S d=$LI(ColInfo,i+1)
 .S name=$LI(d,1)
 .I $ZCONVERT(name,"U")="TABLE_NAME" S iName=i
 .I $ZCONVERT(name,"U")="TABLE_TYPE" S iType=i
 .S WEBSQ(0,i)=name
 I $D(WEBSQL) S WEBSQL(0,1)="TABLE NAME",WEBSQL(0,2)="TYPE"
 E  W "TABLE NAME",?20,"TYPE",! W $TR($J("",30)," ","-"),!
 F i=1:1 S rc=$ZF(-3,"","Fetch",hstmt) Q:rc'=0  D
 .S d=$ZF(-3,"","GetOneRow",hstmt) I d="" Q
 .I $D(WEBSQL) D
 ..I $D(iName) S WEBSQL(i,1)=$LI(d,iName)
 ..I $D(iType) S WEBSQL(i,2)=$LI(d,iType)
 ..F ii=1:1:ncol D
 ...S WEBSQ(i,ii)=$LI(d,ii)
 .E  W $LI(d,$G(iName,1)),?20,$LI(d,$G(iType,2)),!
 D DropStatement(hstmt)
 Q
ShowResSetStruc(ColsDef)
 N i,n
 S n=$LI($LI(ColsDef,1),1)
 D ShowColDef("ColName","SQLtype","Prcs","Scale","Nulb","dtype","Display","$")
 W $TR($J("",79)," ","-"),!
 F i=1:1:n D
 .S d=$LI(ColsDef,i+1)
 .D ShowColDef($LI(d,1),$LI(d,2),$LI(d,3),$LI(d,4),$LI(d,5),$LI(d,6),$LI(d,7),$LI(d,8))
 Q
ShowColDef(a1,a2,a3,a4,a5,a6,a7,a8)
 W a1
 W ?20,a2
 W ?33,a3
 W ?39,a4
 W ?45,a5
 W ?50,a6
 W ?65,a7
 W ?75,a8
 W !
 Q
 ;===================================================================
 ; показать столбцы и их свойства для таблицы с именем tbl
TableColumn(tbl)
 N hstmt,e,i,d,ncol,ColInfo,rc
 
 S hstmt=$$AllocStatement I hstmt=0 Q
 S e=$ZF(-3,"","Columns",hstmt,"","","X%","A1") I e'=0 D Err(0),DropStatement(hstmt) Q
 
 S ColInfo=$ZF(-3,"","DescribeColumns",hstmt)
 
 ; показать имена столбцов используемых
 ; для описания запроса списка столбцов таблицы
 I 0 D ShowResSetStruc(ColInfo) D DropStatement(hstmt) Q
 
 N iName,iTypeId,iTypeName,iPrec,iLen,iScale,iNull
 N xName,xTypeId,xTypeName,xPrec,xLen,xScale,xNull
 S xName=0
 S xTypeId=xName+20
 S xTypeName=xTypeId+5
 S xPrec=xTypeName+10
 S xLen=xPrec+5
 S xScale=xLen+7
 S xNull=xScale+15
 
 S ncol=$LI($LI(ColInfo,1),1)
 F i=1:1:ncol D
 .S d=$LI(ColInfo,i+1)
 .S name=$LI(d,1)
 .I name="COLUMN_NAME" S iName=i
 .I name="DATA_TYPE" S iTypeId=i
 .I name="TYPE_NAME" S iTypeName=i
 .I name="PRECISION" S iPrec=i
 .I name="LENGTH" S iLen=i
 .I name="SCALE" S iScale=i
 .I name="NULLABLE" S iNull=i
 
 W ?xName,"NAME",?xTypeId,"TID",?xTypeName,"TNAME"
 W ?xPrec,"PREC",?xLen,"LEN",?xScale,"SCALE"
 W ?xNull,"NULL",!
 W $TR($J("",79)," ","-"),!
 
 F  S rc=$ZF(-3,"","Fetch",hstmt) Q:rc'=0  D
 .S d=$ZF(-3,"","GetOneRow",hstmt) I d="" Q
 .W ?xName,$LI(d,iName),?xTypeId,$LI(d,iTypeId),?xTypeName,$LI(d,iTypeName)
 .W ?xPrec,$LI(d,iPrec),?xLen,$LI(d,iLen),?xScale,$LI(d,iScale)
 .W ?xNull,$LI(d,iNull)
 .W !
 D DropStatement(hstmt)
 Q
 ;===================================================================
 ; Сделать запрос и показать результаты
Select(sql,IF,TG)
 N ColInfo,hstmt,ncol,d,i,rc,ColName
 S hstmt=$$AllocStatement I hstmt=0 Q
 S e=$ZF(-3,"","Prepare",hstmt,sql) I e'=0 D Err(0),DropStatement(hstmt)
 S e=$ZF(-3,"","Execute",hstmt) I e'=0 D Err(0),DropStatement(hstmt)
 
 S ColInfo=$ZF(-3,"","DescribeColumns",hstmt)
 I ColInfo="" D EW("Результат запроса пустой") D DropStatement(hstmt) Q
 S ncol=$LI($LI(ColInfo,1),1) ;КОЛИЧЕСТО КОЛОНОК
 
 F i=1:1:ncol D
 .S d=$LI(ColInfo,i+1)
 .S ColName(i)=$LI(d,1) ;ИМЕНА ПОЛЕЙ
 
 I $G(TG)="" D
 .F i=1:1:ncol W ?15*(i-1),ColName(i)            ;ЗАСВЕТИТЬ ШАПКУ
 .W !,$TR($J("",79)," ","-")
 I $G(TG)'="" F i=1:1:ncol S @TG@(0,i)=ColName(i)
 
 S ii=0
 ;ЦИКЛ ПО ОТКРЫТОМУ КУРСОРУ
 F  S rc=$ZF(-3,"","Fetch",hstmt) Q:rc'=0  D  I $G(Break) Q  ;ПРЕРВАТЬ ПЕРЕБОР
 .S d=$ZF(-3,"","GetOneRow",hstmt) I d="" Q  ;ТЕКУЩАЯ ЗАПИСЬ
 .I $G(IF)'="" X "I "_IF E  Q
 .S ii=ii+1 I $G(TG)="" W !
 .F i=1:1:ncol D
 ..I $G(TG)="" W ?15*(i-1),$LI(d,i) Q        ;КОЛОНКИ
 ..S @TG@(ii,i)=$LI(d,i)
 D DropStatement(hstmt)
 Q
 ;===================================================================
ShowResultSet(hstmt)
 N ColInfo
 S ColInfo=$ZF(-3,"","DescribeColumns",hstmt)
 I ColInfo="" W "No Result",! Q
 
 S ncol=$LI($LI(ColInfo,1),1)
 
 F i=1:1:ncol D
 .S d=$LI(ColInfo,i+1)
 .S ColName(i)=$LI(d,1)
 
 F i=1:1:ncol W ?15*(i-1),ColName(i)
 W !
 W $TR($J("",79)," ","-"),!
 
 F  S rc=$ZF(-3,"","Fetch",hstmt) Q:rc'=0  D
 .S d=$ZF(-3,"","GetOneRow",hstmt) I d="" Q
 .F i=1:1:ncol W ?15*(i-1),$LI(d,i)
 .W !
 Q
 ;===================================================================
 ; Просмор каталога процедур
ProcCatalog(mode)
 N name,x,hdr,i,ncol,x
 
 S hstmt=$$AllocStatement I hstmt=0 Q
 S e=$ZF(-3,"","DescribeProcedures",hstmt,"","","")
 
 S ColInfo=$ZF(-3,"","DescribeColumns",hstmt)
 
 ; показать структуру запроса списка процедур
 I +$G(mode)=1 D ShowResSetStruc(ColInfo) D DropStatement(hstmt) Q
 
 S ncol=$LI($LI(ColInfo,1),1)
 ;S ncol=3
 F i=3:1:ncol D
 .S d=$LI(ColInfo,i+1)
 .S hdr(i)=$LI(d,1)
 .I i>3,$P($LI(d,1),"_",2)'="" S hdr(i)=$P($LI(d,1),"_",2)
 .S x(i)=$S(i=3:0,i=4:25,1:$L(hdr(i-1))+1)+$S(i=3:0,1:x(i-1))
 .W ?x(i),hdr(i)
 
 W !,$TR($J("",79)," ","-"),!
 
 F  S rc=$ZF(-3,"","Fetch",hstmt) Q:rc'=0  D
 .S d=$ZF(-3,"","GetOneRow",hstmt) I d="" Q
 .F i=3:1:ncol D
 ..S v=$LI(d,i) I v="<NULL DATA>" S v="<NULL>"
 ..W ?x(i),v
 .W !
 D DropStatement(hstmt)
 Q
 
 ;===================================================================
ProcPar
 Q
 ;===================================================================
CallProc
 N hstmt,sql,e
 S hstmt=$$AllocStatement I hstmt=0 Q
 S sql="CALL DemoQuery_Qy1( '1', '2' )"
 S e=$ZF(-3,"","Prepare",hstmt,sql) I e'=0 D Err(e),DropStatement(hstmt) Q
 S e=$ZF(-3,"","Execute",hstmt) I e'=0 D Err(e),DropStatement(hstmt) Q
 D ShowResultSet(hstmt)
 D DropStatement(hstmt)
 Q
 ;===================================================================
AllocStatement()
 S hstmt=$ZF(-3,"","AllocStatement",hdbc)
 I hstmt=0 D EW("can't alloc statement")
 Q hstmt
 ;===================================================================
DropStatement(hstmt)
 S e=$ZF(-3,"","DropStatement",hstmt)
 Q
 ;===================================================================
connect(dsn,user,pswd)
 S hdbc=$ZF(-3,"","Connect",$G(dsn),$G(user),$G(pswd))
 I hdbc=0 D EW("Connection failor !")
 Q
 ;===================================================================
disconnect
 S e=$ZF(-3,"","Disconnect",hdbc)
 D Err(e)
 Q
 ;===================================================================
EW(V) ;СООБЩЕНИЕ О ОШИБКЕ
 I $D(ErV) S Errors=$G(Errors)_V_". "_$C(13,10) Q
 W V_". ",! Q
ErrWas
 N e S e=$ZF(-3,"","WasError") I e=0 Q
 I e=-1000 D EW("SqlGate error") Q
 I e'=-1 Q
 N el S el=$ZF(-3,"","GetSqlErrors",+$G(hdbc),+$G(hstmt))
 N l S l=$LL(el)
 N i F i=1:1:l D EW($LI(el,i))
 Q
 ;===================================================================
Err(e)
 I e=0 Q
 I e=-1000 D EW("SqlGate error") Q
 I e'=-1 D EW("Other error") Q
 N el S el=$ZF(-3,"","GetSQLErrors",+$G(hdbc),+$G(hstmt))
 N l S l=$LL(el)
 N i F i=1:1:l D EW($LI(el,i))
 Q
]]></Routine>


<Routine name="%ZAPM.ed.BSCG1" type="MAC" languagemode="0"><![CDATA[
%BSCG1 ; пpогpамма НА ПРАВАХ ПРИМЕРА ПОИСКОВОГО МОДУЛЯ ; 20:09   18.09.2000
 Q     ;ПЛОХОЕ РЕШЕНИЕ, НО РАБОТАЕТ...  ХОРОШЕЕ СМОТРИ %BSCG2
 ;KNH.DBF  SNAIM - СОКР. НАИМЕНОВАНИЕ ВЧ
 ;         NWC - НОМЕР ВЧ
 ;         KPD - КОД ДИСЛОКАЦИИ
 ;         IMG - ПОЛНОЕ НАИМЕНОВАНИЕ ВЧ
 ;KPD.DBF  KPD - САМ КОД
 ;         HAR - ХАРАКТЕРИСТИКА НАСЕЛЕННОГО ПУНКТА
 ;         IMJ - НАИМЕНОВАНИЕ
 ;
 ;!!! НЕ ЗАБУДЬТЕ СДЕЛАТЬ !..
 ;ОПРЕДЕЛИТЕ  DNS="KSP" В CONTROL PANEL -- ODBC DRIVERS
 ;S ^MGWAPP("SAMPLE_KSP")=MAIN^%ZAPM.ed.BSCG1
 ;ВЫЗОВ http://cacheserver/scripts/mgwms32.dll?MGWAPP=SAMPLE_KSP
 ;
FIRST ;ПЕРВАЯ СТРАНИЦА
 D VAR^%ZAPM.ed.BSCh
 D FORM^%ZAPM.ed.BSCh
 W "<P><strong>ВВЕДИТЕ КОНТЕКСТ ПОИСКА  </strong>"
 w "<input type=""submit"" value="" Искать"" name=""FIND1"">"
 W "<input type=""reset"" value="" Очистить текстовые поля"" name=""FIND2"">"
 w "<input type=""hidden"" name=""MGWAPP"" value=""SAMPLE_KSP""></P>"
 w BK,"<table border=""0"">",BK
 w "<tr>",BK
   w "<td align=""right""><strong>Номер В/Ч (4цифры)</strong></td>",BK
   w "<td><input type=""text"" name=""NWC"" size=""17"">"
   W "</td>",BK
 w "</tr>"
 w "<tr>"
   w "<td align=""right""><strong>Действительное наименование</strong></td>",BK
   w "<td><input type=""text"" name=""IMJ"" size=""17"">"
   W "</td>",BK
 w "</tr>"
 w "<tr>"
   w "<td align=""right""><strong>Дислокация</strong></td>",BK
   w "<td><input type=""text"" name=""DIS"" size=""17"">"
   W "</td>",BK
 w "</tr>"
 w "</table>",BK
 W "</FORM>"
 Q
MAIN ;ГОЛОВНАЯ ПРОГРАММА - ДИСПЕТЧЕР
 I $G(%KEY("FIND1"))'="" G FIND
 G FIRST
FIND ;ИСКАТЬ...
 N Errors,DNS,ErV,Break,Return,SQL,IF,TK,TD,TempK,TempD,KDS,KDS1
 D VAR^%ZAPM.ed.BSCh
 I $G(%KEY("NWC"))="",$G(%KEY("IMJ"))="",$G(%KEY("DIS"))="" W "ВСЕ ПОЛЯ ПУСТЫЕ !" Q
 S (Z1,Z2)=""
 I $G(%KEY("NWC"))'="" S Z1="nwc LIKE '"_$G(%KEY("NWC"))_"%' AND "
 I $G(%KEY("IMJ"))'="" S Z2="snaim LIKE '"_$G(%KEY("IMJ"))_"%' AND "
 S TK="TempG",TD="TempD"
 I Z1="",Z2="" G DISL
 
 S SQL="SELECT nwc, snaim, kpd FROM knh WHERE "_Z1_" "_Z2_" TRUE"
 S IF="$LI(d,3)'="""" S KDS1($LI(d,3))=1"
 D Read^%ZAPM.ed.BSCG("KSP",SQL,IF,1,TK) I $D(Errors) W !,Errors Q
 I '$D(@TK) W !,"РЕЗУЛЬТАТ ВЫБОРКИ ПУСТОЙ" Q
 I '$D(@TK@(1)) W !,"РЕЗУЛЬТАТ ВЫБОРКИ ПУСТОЙ" Q
 I $G(%KEY("DIS"))'="" G DISL1
 
 S SQL="SELECT kpd, har, IMJ FROM kpd WHERE HAR IS NOT NULL AND ("
 S I="" F  S I=$O(KDS1(I)) Q:I=""  S SQL=SQL_" KPD='"_I_"' OR "
 S SQL=SQL_" FALSE)" K KDS1
 S IF="$LI(d,1)'="""" S KDS($LI(d,1))=$LI(d,2)_$LI(d,3)"
 D Read^%ZAPM.ed.BSCG("KSP",SQL,IF,1,TD) I $D(Errors) W !,Errors Q
TAB D TABL1 S II=""
 F I=1:1 Q:'$D(@TK@(I))  D
 .w "<tr>",BK
 .w "<td>",$G(@TK@(I,1)),"</td>"
 .w "<td>",$G(@TK@(I,2)),"</td>"
 .w "<td>" D  W II,"</td>"
 ..I $G(KDS($G(@TK@(I,3),0)))'="" S II=$G(KDS($G(@TK@(I,3),0))) Q
 ..S II="???"
 .w "</tr>"
 D TABL2
 Q
DISL1 ;ДИСЛОКАЦИЯ
 ;Q
DISL ;ДИСЛОКАЦИЯ
 S SQL="SELECT kpd, har, IMJ FROM kpd WHERE HAR IS NOT NULL AND IMJ LIKE '"_$G(%KEY("DIS"))_"%'"
 S IF="$LI(d,1)'="""" S KDS($LI(d,1))=$LI(d,2)_$LI(d,3)"
 D Read^%ZAPM.ed.BSCG("KSP",SQL,IF,1,TD) I $D(Errors) W !,Errors Q
 I '$D(@TD) W !,"РЕЗУЛЬТАТ ВЫБОРКИ ПУСТОЙ" Q
 I '$D(@TD@(1)) W !,"РЕЗУЛЬТАТ ВЫБОРКИ ПУСТОЙ" Q
 K @TD
 S SQL="SELECT nwc, snaim, kpd FROM knh WHERE NWC IS NOT NULL AND ("
 S I="" F  S I=$O(KDS(I)) Q:I=""  S SQL=SQL_" KPD='"_I_"' OR "
 S SQL=SQL_" FALSE)"
 S IF="$E($LI(d,1),1)'=0"
 I $D(KDS1) S IF=IF_" I $D(KDS1($LI(d,3)))" D
 .I $G(%KEY("IMJ"))'="" S IF=IF_",$E($LI(d,2),1,"_$L(%KEY("IMJ"))_")="""_$G(%KEY("IMJ"))_""""
 .I $G(%KEY("NWC"))'="" S IF=IF_",$E($LI(d,1),1,"_$L(%KEY("NWC"))_")="""_$G(%KEY("NWC"))_""""
 D Read^%ZAPM.ed.BSCG("KSP",SQL,IF,1,TK) I $D(Errors) W !,Errors Q
 I '$D(@TK) W !,"РЕЗУЛЬТАТ ВЫБОРКИ ПУСТОЙ" Q
 I '$D(@TK@(1)) W !,"РЕЗУЛЬТАТ ВЫБОРКИ ПУСТОЙ" Q
 G TAB
TABL1 ;НАЧАТЬ ТАБЛИЦУ
  w BK,"<table border=""1"">",BK
 w "<tr>",BK
   w "<td align=""right""><strong>Номер В/Ч (4цифры)<BR>'"_$G(%KEY("NWC"))_"'</strong></td>",BK
   w "<td align=""right""><strong>Действительное наименование<BR>'"_$G(%KEY("IMJ"))_"'</strong></td>",BK
   w "<td align=""right""><strong>Дислокация<BR>'"_$G(%KEY("DIS"))_"'</strong></td>",BK
 w "</tr>"
 Q
TABL2 ;ЗАКОНЧИТЬ
 w "</table>",BK
 Q
 /////////////////////////////////////////////////////////////////////////////////// NEW
 /////////////////////////////////////////////////////////////////////////////////// 
A1 W "<TITLE>НАЧАЛО НОВОГО ПОИСКА КСП</TITLE>"_BK
 w "<FRAMESET rows='60%,10%,*'  >"_BK
 w "<FRAME SRC='"_$$ADDBSGET^%ZAPM.ed.BSC4(,"AR^%ZAPM.ed.BSCG1")_"' NAME='ARH' frameborder=0 SCROLLING=AUTO >"_BK
  w "<FRAME SRC='"_$$ADDBSGET^%ZAPM.ed.BSC4(,"AF^%ZAPM.ed.BSCG1")_"' NAME='FIN' frameborder=0 >"_BK
   w "<FRAME SRC='"_$$ADDBSGET^%ZAPM.ed.BSC4(,"AN^%ZAPM.ed.BSCG1")_"' NAME='NAST' frameborder=0 SCROLLING=AUTO>"_BK
 w "</FRAMESET>"
 Q
ARHIV
AR D BEG1^%ZAPM.ed.BSC4
 I '$D(BSPATT) W "Здесь будет архив искомого ксп" G AR0
 W BSPATT
 S TK="TempG",TD="TempD"
 S IF="1"
 D Read^%ZAPM.ed.BSCG("KSP","SELECT KSP,NKSP,KVD,KPD,KNP,IMJ_D,IMJ_P,IMJ_B,IMJ_R,NPR,DPR,DIZ FROM ArxKsp WHERE KSP LIKE '"_BSPATT_"%'",IF,1,TK) I $D(Errors) W !,Errors Q
  I '$D(@TK) W !,"РЕЗУЛЬТАТ ВЫБОРКИ ПУСТОЙ" Q
 I '$D(@TK@(1)) W !,"РЕЗУЛЬТАТ ВЫБОРКИ ПУСТОЙ" Q
 D TAB^%ZAPM.ed.BSCGH(TK)
AR0 D END^%ZAPM.ed.BSC4
 Q
AF D BEG1^%ZAPM.ed.BSC4
 w "<BODY BGCOLOR=Dodgerblue "_$$27_" onload='F3.patternstr.focus();'>"_BK_$$js^%ZAPM.ed.BSCp_$$Status^%ZAPM.ed.BSCm4("введите контекст поиска. {Esc} - отмена, закрыть окно. {F5} - обновить окно")_$$jse^%ZAPM.ed.BSCp_BK
 W "<CENTER><TABLE BORDER=0><TR><TD>"
 W "<form action="""_$$ADDLIB^%ZAPM.ed.BSC4()_""" name=F3 target='NAST' method=""POST"">"_BK
 S BSLABEL="AN^~BSCG1"
 D ADDBSPOST^%ZAPM.ed.BSC4reg
 w "Введите начальные цифры КСП <INPUT TYPE=text TITLE='Контекст поиска' size=32 name=patternstr >&nbsp;"
 w "<BUTTON title='поиск начать' TYPE=SUBMIT VALUE='Искать' NAME=F1><img src='"_BSDOMAIN_"/img/find.gif'></BUTTON>&nbsp;"
 W "</FORM></TD>"_BK
 W "</TR><TABLE></CENTER>"_BK
 D END^%ZAPM.ed.BSC4
 Q
27() Q " onkeyPress='javascript: if (27 == event.keyCode) parent.window.close();' "
FINDSTRCONV(S)
 Q $TR(S,"FDULTPBQRKVYJGHCNEAWXIOSMZf,dult`;pbqrkvyjghcnea[wxio]sm'.z","АВГДЕЗИЙКЛМНОПРСТУФЦЧШЩЫЬЯабвгдеёжзийклмнопрстуфхцчшщъыьэюя")
AN D BEG1^%ZAPM.ed.BSC4
 ;SELECT MAX(DAT) As DATA1 FROM Knh_a
 w "<BODY bgcolor=Lightgrey "_$$27_">"_BK
 I $G(patternstr)="" W "Контекст пустой",BK G AN0
 s BSPATT=$$FINDSTRCONV($G(patternstr))
 S TK="TempG",TD="TempD"
 S SQL="SELECT MAX(DAT) As Last_Data FROM Knh_a"
 S IF="1"
 D Read^%ZAPM.ed.BSCG("KSP",SQL,IF,1,TK) I $D(Errors) W !,Errors Q
 S MAXDAT=$E(@TK@(1,1),9,10)_"."_$E(@TK@(1,1),6,7)_"."_$E(@TK@(1,1),1,4)
 D TAB^%ZAPM.ed.BSCGH(TK)
 I '$D(@TK) W !,"РЕЗУЛЬТАТ ВЫБОРКИ ПУСТОЙ" Q
 I '$D(@TK@(1)) W !,"РЕЗУЛЬТАТ ВЫБОРКИ ПУСТОЙ" Q
 S LD=$G(@TK@(1,1)) I LD="" W !,"ДАТА ПУСТАЯ" Q 
 D Read^%ZAPM.ed.BSCG("KSP","SELECT KSP,SNM,DAT,KNH,KPD,OKATO,KNP FROM Knh_a WHERE (KSP LIKE '"_BSPATT_"%') AND (DAT LIKE '"_MAXDAT_"')",IF,1,TK) I $D(Errors) W !,Errors Q
 D TAB^%ZAPM.ed.BSCGH(TK)
 W BK_$$js^%ZAPM.ed.BSCp D  W $$jse^%ZAPM.ed.BSCp_BK 
 .W "parent.ARH.location='"_$$ADDBSGET^%ZAPM.ed.BSC4(,"ARHIV^%ZAPM.ed.BSCG1")_"';"_BK
 ;D locvar^%ZAPM.ed.BSCh0("",1)
AN0
 D END^%ZAPM.ed.BSC4
 Q  
]]></Routine>


<Routine name="%ZAPM.ed.BSCG2" type="MAC" languagemode="0"><![CDATA[
%BSCG2 ; пpогpамма НА ПРАВАХ ПРИМЕРА ПОИСКОВОГО МОДУЛЯ (АНАЛОГ ASP :-) ; 16:06   16.10.2000
 Q     ;ХОРОШЕЕ РЕШЕНИЕ НЕ В ПРИМЕР %BSCG1
 ;KNH.DBF  SNAIM - СОКР. НАИМЕНОВАНИЕ ВЧ
 ;         NWC - НОМЕР ВЧ
 ;         KPD - КОД ДИСЛОКАЦИИ
 ;         IMG - ПОЛНОЕ НАИМЕНОВАНИЕ ВЧ
 ;KPD.DBF  KPD - САМ КОД
 ;         HAR - ХАРАКТЕРИСТИКА НАСЕЛЕННОГО ПУНКТА
 ;         IMJ - НАИМЕНОВАНИЕ
 ;
MAIN ;ГОЛОВНАЯ ПРОГРАММА - ДИСПЕТЧЕР
 I $G(%KEY("FIND1"))'="" G FIND
 G FIRST
 ;!!! НЕ ЗАБУДЬТЕ СДЕЛАТЬ !..
 ;ОПРЕДЕЛИТЕ  DSN="KSP" В CONTROL PANEL -- ODBC DRIVERS DBase IV
 ;S ^MGWAPP("KSP")="MAIN^%ZAPM.ed.BSCG2"
 ;ВЫЗОВ http://webserver/scripts/mgwms32.dll?MGWAPP=KSP
 ;
FIRST ;ПЕРВАЯ СТРАНИЦА
 D VAR^%ZAPM.ed.BSCh
 D FORM^%ZAPM.ed.BSCh
 W "<P><strong>ВВЕДИТЕ КОНТЕКСТ ПОИСКА  </strong>"
 w "<input type=""submit"" value="" Искать"" name=""FIND1"">"
 W "<input type=""reset"" value="" Очистить текстовые поля"" name=""FIND2"">"
 w BK,"<table border=""0"">",BK
 w "<tr>",BK
   w "<td align=""right""><strong>Номер В/Ч (4цифры)</strong></td>",BK
   w "<td><input type=""text"" name=""NWC"" size=""17"">"
   W "</td>",BK
 w "</tr>"
 w "<tr>"
   w "<td align=""right""><strong>Действительное наименование</strong></td>",BK
   w "<td><input type=""text"" name=""IMJ"" size=""17"">"
   W "</td>",BK
 w "</tr>"
 w "<tr>"
   w "<td align=""right""><strong>Дислокация (например:Саров)</strong></td>",BK
   w "<td><input type=""text"" name=""DIS"" size=""17"">"
   W "</td>",BK
 w "</tr>"
 w "</table>",BK
 W "</FORM>"
 Q
FIND ;ИСКАТЬ...
 N Errors,DNS,ErV,Break,Return,SQL,IF,TK,TD,TempK,TempD,KDS,KDS1,I,II
 D VAR^%ZAPM.ed.BSCh
 I $G(%KEY("NWC"))="",$G(%KEY("IMJ"))="",$G(%KEY("DIS"))="" W "ВСЕ ПОЛЯ ПУСТЫЕ !" Q
 F I="NWC" I $G(%KEY(I))'="",$L($G(%KEY(I)))<2 W "ДЛИНА СТРОКИ КОНТЕКСТА<BR>ДОЛЖНА БЫТЬ БОЛЬШЕ ОДНОГО СИМВОЛА!" S II=1 Q
 I $G(II) Q
 S (Z1,Z2,Z3)=""
 I $G(%KEY("NWC"))'="" S Z1="((KNH.nwc) LIKE '"_$G(%KEY("NWC"))_"%') AND "
 I $G(%KEY("IMJ"))'="" S Z2="((KNH.SNAIM) LIKE '"_$G(%KEY("IMJ"))_"%') AND "
 I $G(%KEY("DIS"))'="" S Z3="((KPD.IMJ) LIKE '"_$G(%KEY("DIS"))_"%') AND "
 S TK="TempG"
 S SQL="SELECT Knh.NWC, Knh.SNAIM, KPD.HAR, KPD.IMJ"
 S SQL=SQL_" FROM Knh LEFT JOIN KPD ON Knh.KPD = KPD.KPD"
 S SQL=SQL_" WHERE ((KNH.NWC IS NOT NULL) AND (KNH.NWC NOT LIKE '0%') AND "_Z1_" "_Z2_" "_Z3_" TRUE)"
 ;W !,SQL,BK
 D Read^%ZAPM.ed.BSCG("KSP",SQL,"",1,TK) I $D(Errors) W !,"<PRE>",Errors,"</PRE>" Q
 I '$D(@TK) W !,"РЕЗУЛЬТАТ ВЫБОРКИ ПУСТОЙ" Q
 I '$D(@TK@(1)) W !,"РЕЗУЛЬТАТ ВЫБОРКИ СОВСЕМ ПУСТОЙ" Q
TAB D TABL1
 F I=1:1 Q:'$D(@TK@(I))  D
 .w "<tr>",BK
 .w "<td>",$G(@TK@(I,1)),"</td>"
 .w "<td>",$G(@TK@(I,2)),"</td>"
 .w "<td>",$G(@TK@(I,3))_$G(@TK@(I,4)),"</td>"
 .w "</tr>"
 D TABL2
 Q
TABL1 ;НАЧАТЬ ТАБЛИЦУ
  w BK,"<table border=""1"">",BK
 w "<tr>",BK
   w "<td align=""right""><strong>Номер В/Ч (4цифры)<BR>'"_$G(%KEY("NWC"))_"'</strong></td>",BK
   w "<td align=""right""><strong>Действительное наименование<BR>'"_$G(%KEY("IMJ"))_"'</strong></td>",BK
   w "<td align=""right""><strong>Дислокация<BR>'"_$G(%KEY("DIS"))_"'</strong></td>",BK
 w "</tr>"
 Q
TABL2 ;ЗАКОНЧИТЬ
 w "</table>",BK
 Q
]]></Routine>


<Routine name="%ZAPM.ed.BSCGIS" type="MAC" languagemode="0"><![CDATA[
%BSCGIS ; пpогpамма связи с КОМПОНЕНТОЙ 
 ;
 ; Copyright (c) Serge W. Mikhaylenko
 ; All Rights Reserved
 ;
 Q
TITL(S) Q "<TITLE>"_S_"</TITLE></HEAD>"
INFO //  
 W "ИНФОРМАЦИЯ : X="_$G(BSocxP0kD)_" Y="_$G(BSocxP0kS)
 Q
REG //функция регистации
 N A,noPASS
 I $G(BSocxREG)="notPASS" S noPASS=1
 S A=$$PROTECT^%ZAPM.ed.BSC4reg($G(BSocxP0kD,"Z"),$G(BSocxP0kS))     ;ПРОВЕРКА ПАРОЛЯ
 ;S ^%ZZZ(1)=A
 I A="" W 0 Q
 I '$$GRA($G(BSocxP0kD,"Z"),$G(BSocxGRAND)) W 0 Q
 I A=1 S BSLOGIN=$G(BSocxP0kD,"Z") D Session^%ZAPM.ed.BSC4reg W "-=!=-"_$G(BSSES,"?")_"-=!=-"
 ;S ^%ZZZ(BSLOGIN)=$G(BSSES,"?")
 Q
GRA(BSLOGIN,Gr)  N BSGRANT,A     N Cm,FF,F,BD //НАЙТИ ВХОЖДЕНИЕ ГРАНДА В ОБЩИЙ
 I '$D(BDUSE) D MAINVAR^%ZAPM.ed.BSC4
 S BD=$$KBD^%ZAPM.ed.BSF12("^%ZAPM.ed.BSC4(""GRAND"")")
 S BSGRANT=$G(@BDUSE@(BSLOGIN,"GRANT")) I BSGRANT="" Q 0
 d RECURS^%ZAPM.ed.BSC4(BSGRANT) I $D(FF(Gr)) Q 1
 Q 0
CLS //ЗАКРЫТИЕ СЕССИИ
 D CloseSess^%ZAPM.ed.BSC4reg W "OK"
 Q
EVENT //СОБЫТИЯ
 W $H
 Q
Report //СОБЫТИЯ
 S Par1=$G(BSocxP0kD),Par2=$G(BSocxP0kS) ;,Par3=$G(BSExtVar)
 W +$G(@Par1@("Count"))_BK
 F i=0:1 Q:'$D(@Par1@(i))  D
 .;W $G(@Par1@(i))_BK
 .S A=$TR($G(@Par1@(i)),BK,"") W A_BK
 W "<End Of File>"
 Q
Step1NewTabel D BEG1^%ZAPM.ed.BSC4 W $$TITL^%ZAPM.ed.BSCGIS("Шаг1 - потоковый ввод"),$$B27^%ZAPM.ed.BSCGIS
 d Step1NewTabel^%ZAPM.ed.BSCAsIs 
 D BUTT^%ZAPM.ed.BSCGIS,END^%ZAPM.ed.BSC4 //НОВЫЙ ТАБЕЛЬ
 q
ReportTabel2005 D BEG1^%ZAPM.ed.BSC4 W $$TITL^%ZAPM.ed.BSCGIS("Отчеты"),$$B27^%ZAPM.ed.BSCGIS
 I $G(BSocxP0kD)'=""  S BSPART=$$Normalize($G(BSocxP0kD)),BSTABL=$G(BSocxP0kS),PT=$NA(@BSPART@(BSTABL))
  D ReportLIST^%ZAPM.ed.BSCAsIs
 D BUTT,END^%ZAPM.ed.BSC4
 q
ErrLogTabel2005 
 D BEG1^%ZAPM.ed.BSC4 W $$TITL^%ZAPM.ed.BSCGIS("Cписок ошибок, выявленных при занесении информации в базу данных"),$$B27^%ZAPM.ed.BSCGIS
 D VAR M L=@BDSES@(BSSES,"VAR","ERR","LOG") M C=@BDSES@(BSSES,"VAR","ERR","COU") D BUTT^%ZAPM.ed.BSCGIS
 I $D(C) W "<CENTER><H3><a name=a2>ОШИБКИ ВЫЧИСЛЕНИЯ -------------</H3> "_$s($d(L):"<a href='#a1' TITLE='Перейти'>ОШИБКИ ЛОГИЧЕСКОГО КОНТРОЛЯ",1:"")_"</a></CENTER>" D ErrWrite(.C) 
 I $D(L) W "<CENTER><a name=a1>"_$s($d(C):"<a href='#a2' TITLE='Перейти'>ОШИБКИ ВЫЧИСЛЕНИЯ</a>",1:"")_" <H3>-------------- ОШИБКИ ЛОГИЧЕСКОГО КОНТРОЛЯ</H3></CENTER>" D ErrWrite(.L) 
 D BUTT^%ZAPM.ed.BSCGIS,END^%ZAPM.ed.BSC4
 q
ErrWrite(L)  w "<HR><table border=0>"
 S Y="" F  S Y=$O(L(Y)) Q:Y=""  w "<tr><td class=s1 width=5%>Строка "_Y D  W "</td></tr>"_BK
 .w "<table border=0>"
 .S X="" F  S X=$O(L(Y,X)) Q:X=""  w "<tr><td class=s2 width=5%>Колонка "_X D  W "</td></tr>"_BK
 ..w "<table border=0 width=100%>"
 ..I $D(L(Y,X,"ER")) w "<tr><td class=s3 width=5%>Ошибка выполнения!</td><td class=s4 >"_RED_L(Y,X,"ER")_EF_"</td></tr>"_BK
 ..w "<tr><td class=s4 width=5%>Не выполняется формула</td><td class=s5 >"_L(Y,X,1)_"</td></tr>"_BK
 ..w "<tr><td class=s4 width=5%>Текущие значения :</td><td class=s5 >"_L(Y,X,2)_"</td></tr>"_BK
 ..w "</table>"
 .w "</table>"
 w "</table><HR>"
 Q
DocumTabel2005
 D BEG1^%ZAPM.ed.BSC4 W $$TITL^%ZAPM.ed.BSCGIS("Документация"),$$B27^%ZAPM.ed.BSCGIS
 D VAR d DOCUM2^%ZAPM.ed.BSCAsIs 
 ;d dop^%ZAPM.ed.BSCAsIs,help^%ZAPM.ed.BSC4 
 D BUTT^%ZAPM.ed.BSCGIS,END^%ZAPM.ed.BSC4
 q
HELP //ПОМОЩЬ
 I +$G(BSSES)="0" G STOP
 D BEG1^%ZAPM.ed.BSC4 W $$TITL("HELP"),$$B27
 D help^%ZAPM.ed.BSC4
 D BUTT
 D END^%ZAPM.ed.BSC4
 Q
NEWDOC //ДОНЕСЕНИЯ О ОБЫТИЯХ
 I +$G(BSSES)="0" G STOP
 I '$G(BSocxP0kS) D CLOSEWIN^%ZAPM.ed.BSC4("Некорректные координаты "_$$SD(),0) q
 D VAR
 zn nsmon
 s BSgMODE="NEW",BSList=2
 D PART("^["""_nsmon_"""]BSC4MON.UFD","Новый документ "_$$SD())
 q
SD() Q "--- Широта("_$G(BSocxP0kS)_") Долгота("_$G(BSocxP0kD)_")"
B27(C) Q "<BODY "_$$27_">"_BK_$$js^%ZAPM.ed.BSCp_$$Status^%ZAPM.ed.BSCm4("{Esc} - отмена, закрыть окно. {F5} - обновить окно")_$$GISclose($G(C))_$$jse^%ZAPM.ed.BSCp_BK
27() Q " onkeyPress='javascript: if (27 == event.keyCode) GISclose();' "
GISclose(C) N Q
 S Q="function GISclose() {"_BK
 S Q=Q_"status='Status :CloseWin:'"_BK
 ;S Q=Q_"alert(111);"_BK
 I $G(C) S Q=Q_"window.close();"_BK
 S Q=Q_"}"_BK
 Q Q
BUTT  W "<CENTER><BUTTON onclick='"_$S('$D(BSocxP0kD):"window.close",1:"GISclose")_"();' title='Закрыть окно'><IMG SRC='"_BSDOMAIN_"/img/kill.gif'>Закрыть</BUTTON></CENTER>"
 Q
 
PART(pin,TITL) //РАЗДЕЛ
 D BEG1^%ZAPM.ed.BSC4 W $$TITL(TITL)
 W $$B27 D BUTT
 I $E(pin,1)'="^" S pin="^"_pin
 I '$$Data^%ZAPM.ed.BSF12(pin) w "нет доступа к "_pin Q
 W "<table border=0 width=100%>"
 S N=""  F  S N=$O(@(pin)@(N)) Q:N=""  I $P($G(@(pin)@(N)),"@",17)=2 D
 .I N="ROU" Q
 .W "<tr><td width=20% class=s1 >"
 .W "<a title='редактировать в форме' "_$$AN^%ZAPM.ed.BSCm(pin,N,"T^~BSCm4")_"> "_N_" </a>"
 .W "</td><td class=s1 >"_AF,$P($G(@(pin)@(N)),"@",1),EF_"</td></tr>",BK
 W "</table>"
 D BUTT,END^%ZAPM.ed.BSC4
 Q
VAR //ПЕРЕМЕННЫЕ СОЗДАТЬ
 S nsmon="FON" ;ГДЕ ЛЕЖИТ ПРОЕКТ МОНИТОРИНГ
 Q
Normalize(p) i p'["^" s p="^AsIs"_$ZCONVERT(p,"U") //нормализовать имя раздела для Табеля 2005
 I $E(p,1,2)="^~" S p="^%"_$E(p,3,99)
 q p
EXnewKEY //НОВЫЙ КЛЮЧ ДЛЯ EXCELL
 I +$G(BSSES)="0" G STOP
 D VAR I $G(BSFlagRecord)'=""  S BStyleOver="GKVV7"
 D BEG1^%ZAPM.ed.BSC4 W $$TITL("Новый ключ : Для раздела ("_$$Normalize($G(BSocxP0kD))_") и таблицы ("_$G(BSocxP0kS)_")")
 W $$B27 S BSPART=$$Normalize($G(BSocxP0kD)),BSTABL=$G(BSocxP0kS),PT=$NA(@BSPART@(BSTABL))
 I '$$Data^%ZAPM.ed.BSF12(PT) W "Раздела(Таблицы) "_RED_PT_EF_" в рабочей области '"_RED_BSNSP_EF_"' нет. "_BBK
 I $$ACCE^%ZAPM.ed.BSCocx(5),$G(BSnewForm)'="",$G(BSFlagRecord)="" D  //ЕСЛИ РАЗРЕШЕНО РЕДАКТИРОВАТЬ ТОБД, И НЕ СУЩЕСТВУЕТ "KEY"
 .S BSLABEL="CREATAB^~BSCocx1" 
 .W GREEN_"<A HREF='"_$$ADDBSGET^%ZAPM.ed.BSC4()_"'>Создать/Редактировать Таблицу описания Баз Данных</A>"_EF
 i $$ACCES^%ZAPM.ed.BSCocx(BSLOGIN,BSSES)>6,$$Data^%ZAPM.ed.BSF12(PT) D  //ЭТО РАЗРАБОТЧИК
 .;S BSLABEL="KILLTAB^~BSCocx1" 
 .;W GREEN_" Таблицу описания Баз Данных вместе с данными <A HREF='"_$$ADDBSGET^%ZAPM.ed.BSC4()_"'>"_RED_"Удалить"_EF_"</A>"_EF ;d
 I $$Data^%ZAPM.ed.BSF12(PT) D KEYS^%ZAPM.ed.BSCocx
 I $G(BSkeyCC)'="" D BUTT
 d InfoSess^%ZAPM.ed.BSC4rout 
 D END^%ZAPM.ed.BSC4
 Q
NEWLAY //НОВЫЙ СЛОЙ
 I +$G(BSSES)="0" G STOP
 D VAR
 D BEG1^%ZAPM.ed.BSC4 W $$TITL("Новый Слой")
 W $$B27
 S BSNSP=nsmon,BSPRT="BSC4MON"   D FrmRptBrowse^%ZAPM.ed.BSfonRPT
 D BUTT,END^%ZAPM.ed.BSC4
 Q
EDITDOC //
 I +$G(BSSES)="0" G STOP
 D VAR
 D BEG1^%ZAPM.ed.BSC4 W $$TITL("Редактировать документы")
 W $$B27
 zn nsmon
 ;s BSgMODE="NEW",BSList=2
 S BSNSP=nsmon,BSPRT="BSC4MON"   
 D PART("^["""_BSNSP_"""]"_BSPRT_".UFD","Редактировать документы"_$$SD())
 ;D BUTT
 D END^%ZAPM.ed.BSC4
 Q
REPORT //
 I +$G(BSSES)="0" G STOP
 D BEG1^%ZAPM.ed.BSC4 W $$TITL("Формировать отчеты")
 W $$B27
 D LISTP^%ZAPM.ed.BSmirGL
 D BUTT  D END^%ZAPM.ed.BSC4
 Q
STOP D CLOSEWIN^%ZAPM.ed.BSC4("Вы не зарегистрировались",0) 
 Q       
 /*
SQLGO ;ВОЗВРАТИТЬ ТАБЛИЦУ
 D Read^%ZAPM.ed.BSCG(DSN,SQL,$G(IF),,TG) ;ЧТЕНИЕ ТАБЛИЦЫ В МАССИВ TG
 D TAB(TG)
 S BDSN=$$KBDG("^%ZAPM.ed.BSC(""BSQLDSN"")") I BDSN'="" D
 .S I=$O(@BDSN@("SQL",""),-1)+1,@BDSN@("SQL",I,"SQL1")=SQL
 .I I>$$0^%ZAPM.ed.BSCh(30) S I=$O(@BDSN@("SQL","")) K @BDSN@("SQL",I)
 D HELP
 Q
 */
]]></Routine>


<Routine name="%ZAPM.ed.BSCGS" type="MAC" languagemode="0"><![CDATA[
%BSCGS(DiR,gLo) ;Global Size Utility   ; 15:45   05.09.2002 ; Compiled September 21, 2001 14:33:07
 ; +--------------------------------------------------------+
 ; | Copyright 1986-2001 by InterSystems Corporation,       |
 ; | Cambridge, Massachusetts, U.S.A.                       |
 ; | All rights reserved.                                   |
 ; |                                                        |
 ; | Confidential, unpublished property of InterSystems.    |
 ; |                                                        |
 ; | This media contains an authorized copy or copies       |
 ; | of material copyrighted by InterSystems and is the     |
 ; | confidential, unpublished property of InterSystems.    |
 ; | This copyright notice and any other copyright notices  |
 ; | included in machine readable copies must be reproduced |
 ; | on all authorized copies.                              |
 ; +--------------------------------------------------------+
 ;%system.INC ; LFT865 11/08/00
 ;%ST.INC CFL509 04/24/01
 I $zv'["Windows" Q "NoWindows!"
 I $$ZV^%ZAPM.ed.BSCp>5 Q "No5.0!"
 If $$isrem^%GLO Quit $ZN_" does not currently support default global directory located on a remote system."
 If '$zbitget($zversion(0),21) Q $ZN_" only runs on big database system code."
 n (DiR,gLo)
 S $ZT="ERR^"_$ZN
 I $G(DiR)'="" S NSold=$ZU(5) I '$$ZU^%ZAPM.ed.BSF4(DiR) Q "NoDir!"
 s DIR=$$GETDIR ;///
 I DIR="" D NSNAZAD Q "NoDir!"
 
 If $zbitget($zversion(0),21) {
    Set dirinfo=$zu(49,DIR) If (+dirinfo)<0 Write !,*7,DIR," is not available" Quit
    Set bigdb=$Piece(dirinfo,",",21)
    Set blksiz=$Piece(dirinfo,",",2)
 } else {
    Set bigdb=0
    Set blksiz=2048
 }
 
 Set datasize=$Case(blksiz,2048:2036,:(blksiz-$zu(40,32,10)))
 s ONSP=$zu(5) zn "^^"_DIR ;save current namespace
 
 d INT^%T ;,^%GSET ;///%GSET accepts globals in current namespace only
         ;g exit:$o(^UTILITY($j,""))="" ;///
         ;s detail=($$YN("Show details?","N")="Y") ;///
 s detail=1
 ;d ^%IS q:POP  ;///
              s G="",P=1,(tbytes,tblks,tcont,DX)=0
 ;i IO=$I,$G(
 S XY="" ; S DX=18 ;///
 ;i 'detail d showless i 1
 
 I gLo["]" S gLo=$P(gLo,"]",2)
 I $E(gLo,1)="^" S gLo=$E(gLo,2,99)
   d showmore ;d:'POP stop w @IOF       ///
exit zn ONSP
 ;c:$d(IO) IO k %ST
 q $G(TOTAL)
 ;
NSNAZAD() I $G(NSold)'="" I $$ZU^%ZAPM.ed.BSF4(NSold)
 Q
GETDIR() ;
 ;W !
 S R=$zu(12,"") ;W !
 Q:R="QUIT"!(R="quit")!(R="^")!(R="") ""
 q $zu(12,R,3) ;not really necessary as GetDir checked R already
 ;
showmore ;inherit all variables from caller, call detail(), and display
 ;u IO d hdr i IO=$I     d CURRENT^%IS
 ;f  s G=$o(^UTILITY($j,G)) q:G=""  d:'POP
 ;. w ?6,G
 s DY=1,DX=1
 ;. i '$p(^UTILITY("GLO",G),"^",3) w " - implicit",! q
  s x=$$detail(gLo) If x="" Quit
  Set bytes=$p(x,","),blks=$p(x,",",2),cont=$p(x,",",3)
 ;. s tbytes=tbytes+bytes,tblks=tblks+blks,tcont=tcont+cont
 ;. w:'DX ?18,$J($fn(blks,","),8)
 ;. w ?28,$J($fn(bytes,","),15),?45
  S TOTAL=bytes
  i blks=0 S TOTAL=TOTAL_"^"_"0%"
  i blks'=0 S TOTAL=TOTAL_"^"_$j(100*(bytes/(blks*datasize)),1,0)_"%"
  S TOTAL=TOTAL_"^"_$j($fn(cont,","),1)_"^"_$p(x,"?",2)
 ;. i $y>(IOSL-4) d hdr
 ;w !!?6,"TOTAL" d hdr1
 ;w ?18,$J($fn(tblks,","),8)
 ;w ?28,$J($fn(tbytes,","),15)
 ;w:tblks ?45,$j(100*(tbytes/(tblks*datasize)),5,0)," %"
 ;w ?55,$j($fn(tcont,","),7)
 q
showless ;inherit all variables from caller, call brief(), and display
 u IO w @IOF i IO=$I d CURRENT^%IS
 S H="Global Size Display of "_$zu(5)
 U IO W @IOF W !,$J(H,$L(H)+IOM\2)
 D INT^%T S H=%TIM_"  "_$zd($h,7) W !,$J(H,$L(H)+IOM\2)
 w !!
 f  s G=$o(^UTILITY($j,G)) q:G=""  d:'POP
 . w $j(G,12)
 . i '$p(^UTILITY("GLO",G),"^",3) w $j(" - ",8),! q
 . s x=$$brief("^"_G),blks=+x,tblks=tblks+blks
 . i x'["?" w $J(blks,8)
 . e  w $j($p(x,"?",2),8)
 w !!,$j("TOTAL:",12),$j(tblks,8),!
 q
 ;
hdr d stop q:POP  w @IOF
 w "directory: ",DIR,!
 w "Page: ",P,?34,"GLOBAL SIZE",?(IOM-11),$ZDATE($h,2,,4),!,?(IOM-8),%TIM,!
 w ?6,"Global"
 s P=P+1
hdr1 w ?18,"  Blocks",?28,"     Bytes Used",?45,"Packing",?55,"Contig.",!
 w ?6,"--------",?18,"--------",?28,"---------------",?45,"-------",?55,"-------",!
 q
stop i P=1!(IOST'["C-") q
 r !?40,"<RETURN> to continue or '^' to STOP: ",X s:X="^" POP=1
 q
 ;
detail(G) ;detailed version
 n (bigdb,blksiz,dataloc,datasize,dirinfo,G,%ST,DX,DY,XY,DIR) ;DX,DY,XY are used to display progress
 If $Data(dataloc) {
    Set DIR=$Extract(dataloc,2,$Length(dataloc)) ; leave off the "^"
    If ($zbitget($zversion(0),21)) {
       Set dirinfo=$zu(49,DIR) If (+dirinfo)<0 Quit ""
       Set bigdb=$Piece(dirinfo,",",21)
       Set blksiz=$Piece(dirinfo,",",2)
    } else {
       Set bigdb=0
       Set blksiz=2048
    }
 }
 Set datasize=$Case(blksiz,2048:2036,:(blksiz-$zu(40,32,10)))
 s (n,k,c)=0 ;n:bytes,k:blocks,c:contiguous blocks?
 ;W !!,DIR,!,G,!!! R rrrrr
 Set rc=$$GetGlobalPointers^%DM(DIR,G,,.b)
 If ('rc) Do ShowMessage(rc,0) Quit ""
 o 63
 f  q:'b  d  q:$d(err)  s p=b+1,b=$$GetLinkBlockFromViewBuffer^%DMREPAIR(bigdb),c=c+(p=b)
 . v b s t=$$GetBlockTypeFromViewBuffer^%DMREPAIR(bigdb)
 . i t-8,t-12 s err="?TOB: "_b_":"_t q  ;unexpected type of block
 . s n=n+$$GetOffsetFromViewBuffer^%DMREPAIR(bigdb),k=k+1 ;q:t=8  ;so much for normal data blocks
 . Set n=n-$Case(bigdb,0:0,:$zu(40,32,10)) ;Adjust number for header bytes
 . f i=1:1 s x=$v(i*2-1,-6) q:x=""  d  q:$d(err)
 . . ;Next line covers all the long string types for both 2k and bigdb
 . . s v=$v(i*2,-6) If $a(v)'=5,($a(v)'=$Case(bigdb,0:9,:7)),($a(v)'=3) Quit
 . . s nb=$p(v,",",2),r=$p(v,",",3) ;nb: # of blocks,r:#bytes in last block
 . . s n=n+((nb-1)*blksiz)+r,k=k+(nb-1)+''r
 . ;i DX u 0 X XY w $J(k,8) u IO
 ;i DX u 0 X XY w $J(k,8) u IO
 c 63
 q n_","_k_","_c_$g(err)
brief(G) ;brief version (quicker)
 n (bigdb,blksiz,datasize,dirinfo,G,DIR)
 s k=0 ;k:blocks
 Set rc=$$GetGlobalPointers^%DM(DIR,G,.b)
 If ('rc) Do ShowMessage(rc,0) Set err="?" Goto exitbrf
 o 63
 i 'b s err="?GLOBAL" g exitbrf
 f  q:'b  v b s t=$$GetBlockTypeFromViewBuffer^%DMREPAIR(bigdb) q:(t=6!(t=70))  s b=$v(2,-5)
 i 'b s err="?BOTPNT" g exitbrf
 f  k big s lastbig=-1,big=0 q:'b  v b  d  s k=k+i-1
 . f i=1:1 s x=$v(i*2-1,-6) q:x=""  s p=$v(i*2,-6) d:$Piece(p,",")
 . . Set p=$Piece(p,",",2) ;block number with big string
 . . i lastbig=(i-1) s $p(big(big),",",2)=p
 . . e  s big=big+1,big(big)=p
 . . s lastbig=i
 . s b=$$GetLinkBlockFromViewBuffer^%DMREPAIR(bigdb) ;get next linked block before doing big blocks
 . s j="" f  s j=$o(big(j)) q:j=""  s k=k+$$bigblk(big(j))
exitbrf c 63
 q k_$g(err)
bigblk(b) ;
 n (b,bigdb) s beg=+$p(b,","),end=+$p(b,",",2) s:'end end=beg q:'beg 0
 s b=beg,k=0 f  v b  q:($$GetBlockTypeFromViewBuffer^%DMREPAIR(bigdb)'=12)  d  q:b=end  s b=$$GetLinkBlockFromViewBuffer^%DMREPAIR(bigdb) q:'b
 . f i=1:1 s x=$v(i*2-1,-6) q:x=""  d
 . . s v=$v(i*2,-6) q:$a(v)'=3
 . . s k=k+$p(v,",",2)  ;+''($p(v,",",3))
 q k
YN(P,D,t) N R,X S P=$G(P),D=$E($G(D)_"?"),t=$G(t) ;ask Yes/No w/ Prompt,Default
 S D=$S("Yy"[D:"Yes => ","Nn"[D:"No => ",1:"") ;Yes, No or no default
 F  W !,P_"? "_D Read:t R:t Read:'t R DO  I "^YN"[R Q  ;timed or non-timed read
 . S X=R,R=$TR($E(R_D_"?"),"yn","YN") I "^YN"'[R W "  enter Yes or No, please"
 S POP=(R="^") W $E($S(R="N":"No",R="Y":"Yes",1:""),$L(X)+1,3) Q R
GetDir(p,d,exists) ;ask for a directory, allow defaults
 i '$D(exists) s exists=1 ; default is to check if exists
 n neednew s neednew=1 ;expect to new dirlist
 i $g(dirlist) i $g(@dirlist) s neednew=0 ; callers dirlist seems ok
 i neednew n dirlist d
 . S dirlist="mtemp1(""dir"")" ;as good a place as any...
 . I $G(@dirlist)<$H K @dirlist S @dirlist=$H_","_$J_","_$I
 N R,Z,Lock Lock +@dirlist:1 S Lock=$T DO  Lock:Lock -@dirlist Q R
 . N N,OLD,MAX,TWO S (N,MAX)=$G(@dirlist@(0))+1,TWO=0
Get . S OLD=$G(@dirlist@(N)),$ZT="GetErr" I OLD="",N=MAX S OLD=$G(d)
 . W:'TWO ! I TWO W $C(13),$J("",70),$C(13) ;start on new line
 . W p_": "_$S(OLD]"":OLD_" => ",1:"") R R S Z=$ZB,TWO=0 S:R="" R=OLD
 . i $ZM'["R" I $A(Z)=27 S R="" DO  G Get:R="" ;handle special function keys!!
 . . I Z=$C(27,91,65) DO  Q  ;handle ANSI up-arrow
 . . . S TWO=1,N=N-1 I 'N S N=$G(@dirlist@(0))+1 Q
 . . I Z=$C(27,91,66) DO  Q  ;handle ANSI down-arrow
 . . . S N=N+1,TWO=1 I N>MAX S N=1
 . . I Z=$C(27,91,67) S R="@" Q  ;handle ANSI right-arrow --> edit
 . . I Z=$C(27,91,68) S R="@" Q  ;handle ANSI left-arrow --> edit
 . ;
 . I R="@",OLD]"" S R=$$ED(OLD) ;use good-old replace/with editor
 . I $E(R)="?" S Z=R Q  ;pass-on request for elaboration
 . i $$STOP(R) Q
 . S Z=$S(exists:$$ChkDirOrSpecEXISTS(R),1:$$ChkDirVALID(R))
 . I Z="" W *7,"  could not interpret '"_R_"'",! G:exists Get d  g:Z="N" Get
 . . s Z=$$YN("Use this directory anyway")
 . Q  ;needed to not enter 'GetErr'
GetErr . S $ZT="",D="",TWO=0,N=$G(MAX) ; clear default
 . I $P($ZE,">")="<INTERRUPT" S R="" q
 . E  W !,"Error: "_$ZE
 . G Get
UC(x) q $zcvt(x,"u")
Touch(D) ;add directory 'D' to the list of directories 'touched' today
 Q:D=""  Q:D=-1  n neednew s neednew=1 ;expect to new dirlist
 i $g(dirlist) i $g(@dirlist) s neednew=0 ; callers dirlist seems ok
 i neednew n dirlist d
 . S dirlist="mtemp1(""dir"")" ;as good a place as any...
 . I $G(@dirlist)<$H K @dirlist S @dirlist=$H_","_$J_","_$I
 I $D(@dirlist@("*",D)) Q  ;already in list
 N N S N=$G(@dirlist@(0))+1,@dirlist@(0)=N,@dirlist@(N)=D
 S @dirlist@("*",D)=N Q  ;keep track of directories added
ED(%L) ; Edit using the familiar old line editor.
 N %IED,%R,%W,%A,%B,%C,%D,%J X ^%("ED") W !?7,"--> "_%L Q %L
ChkDirVALID(R) N N S $ZE="",$ZT="ChkBad",N=$ZU(12,R,1) Q N
ChkDirEXISTS(R) N N S $ZE="",$ZT="ChkBad",N=$ZU(12,R,2) Q N
ChkDirOrSpecEXISTS(R) N N S $ZE="",$ZT="ChkBad",N=$ZU(12,R,3) Q N
ChkDir(R) N N S $ZE="",$ZT="ChkBad",N=$ZU(12,R,2) Q N
ChkBad S $ZT="" W !,"<"_$P($P($ZE,"<",2),">")_"> error -- invalid directory"
 Q ""
STOP(x) S x=$$UC($E(x,1,4)) Q (x["EXIT")!(x["STOP")!(x["QUIT")!(x["HALT")!($E(x)="^")
ShowMessage(sc,device)
 New msglist d DecomposeStatus^%DM(sc,.msglist,0,"")
 d wrtmsg($C(13,10),device) f i=1:1:msglist d wrtmsg(msglist(i)_$C(13,10),device)
 q
GetMessage(code,locale)
 If $Get(locale)="" Set locale=$$getEnvironment^%DM()
 If locale="" s locale="ENU"
 q $g(^%Messages(code,"text",locale),$g(^%Messages(code,"text","ENU"),1000))
wrtmsg(msg,device) ;
 q:'$L(msg)       ; Avoid argumentless writes...
 i $g(%UI,"CHUI")="CHUI" u device w msg q
 d:$$IjcMsg^%Wprima("DI"_msg)="CANCEL"  ; Return value could be cancel message
 . i $$IjcMsg^%Wprima("DI"_$C(13,10)_"Abort received!"_$C(13,10))
 . zt "Abort"
 q
ERR S $ZT="",ze=$ZE
 I ze["<FUNCTION>" Q "Bad namespace name """_$G(DiR)_"""."
 I ze["<DIRECTORY>" Q "Namespace """_$G(DiR)_""" is not available."
 I ze["<NAMESPACE>" Q "Namespace """_$G(DiR)_""" is not available."
 I ze["<PROTECT>" Q "Insufficient privileges for """_$G(DiR)_"""."
 I ze["<NOTOPEN>" Q "No database in """_$G(DiR)_"""."
 I ze["<INTERRUPT>" Q "Interrupted."
 Q "Error: "_ze
]]></Routine>


<Routine name="%ZAPM.ed.BSCKD" type="MAC" languagemode="0"><![CDATA[
%BSCKD ;Генератор классов для Кодификаторов %BS ; 15:45   05.09.2002
 ;
 ; Copyright (c) Serge W. Mikhaylenko
 ; All Rights Reserved
 ;
 Q
ALLKDF(UCI) ;КОМПИЛИРОВАТЬ ВСЕ КОДИФИКАТОРЫ КИПА
 I $G(UCI)="" G ALLK
 I $ZU(5)'=UCI,$$ZU^%ZAPM.ed.BSF4(UCI)
 I $ZU(5)'=UCI Q "No found "_UCI
ALLK N GL S GL="" F  S GL=$O(^$GLOBAL(GL)) Q:GL=""  D kdf(GL)
 Q 1
kdf(GL) I $E($G(@GL),1,11)="%BS-invert-" W !,"dictonary ",GL," " W $$START(GL,1,"")
 Q
START(GL,COMPILE,NC,DIR) ;СОЗДАНИЕ КЛАССА КОДИФИКАТОРА
 N FN,K,S,I,J,P,SS,BD,CBD,BSK,P3
 I $E(GL,1)'="^" S GL="^"_GL
 I '$D(@GL) Q "Undefine "_GL
 I $G(DIR)="" S DIR=$$TEMPDIR^%ZAPM.ed.BSCF1
 I $D(NOKILLER),NOKILLER[":\" S DIR=NOKILLER
 I $P(@GL,"@",1)'["%BS-invert-" Q "This no KDF"
 I $G(NC)="" S NC=$P($P($G(@GL),"@",1),"^",2) S:NC["]" NC=$P(NC,"]",2,99) S:NC["," NC=$P(NC,",",1) S:NC="" NC="KDF"
 I $E(NC,1,3)="%BS" S NC="BSS"
 I GL["]" S NC=NC_"."_$TR($P(GL,"]",2,99),"%","")
 E  S NC=NC_"."_$TR($P(GL,"^",2,99),"%","")
 S FN=DIR_NC_".CDL"
 I '$$OpenFile^%ZAPM.ed.BSCF1(FN,"W") Q "No access to file "_FN
 U FN
 D TITLE W "class ",NC,!,"{",!
 D SUPER,METOD("KodTxt"),METOD("TxtKod"),QUERY,QUERYALL,STORAGE
 W !,"}",!
 C FN
 I $G(COMPILE) D LF^%ZAPM.ed.BSCBD(FN) I '$D(NOKILLER),$$DelFile^%ZAPM.ed.BSCEXE(FN)
 Q "1 OK"
TITLE W !,"/***********************************************************************\"
 W !,"          File: ",FN
 W !,"        Author: Serge W. Mikhaylenko"
 W !,"          Date: ",$ZD($H,9)
 W !,"   Description: Dictonary from %BS"
 W !,"         Above: This File is Generated by %BS+++Cache"
 W !,"\***********************************************************************/",!!
 Q
SUPER W !,"description = {",!,$P(@GL,"@",2),!,"}",!
 W !,"   super = %Library.Persistent;",!
 W !,"persistent = KD;"
 W !,"index i1 { attributes = K1; extent = 0; idkey; primarykey = 0; unique = 0; }",!
 W !,"  attribute K1 { type = %String(MAXLEN=""""); calculated = 0; description = ""Код кодификатора. ""; not final; multidimensional = 0; public; required; sqlcomputed = 0; transient = 0; }"
 W !,"  attribute A1 { type = %String(MAXLEN=""""); calculated = 0; description = ""Текст кодификатора.""; not final; multidimensional = 0; public; required; sqlcomputed = 0; transient = 0; }"
 Q
METOD(LAB)
 W !!,"   method "_LAB_"(PID:%Library.String="""")",!
 W !,"   {",!
 W !,"   returntype = %Library.String;"
 W !,"   classmethod;"
 W !,"   not final;"
 W !,"   public;"
 W !,"   sqlproc = 0;"
 W !,"   code ="
 W !,"   ["
 W !,"             q $$"_LAB_"^%ZAPM.ed.BSCKD(PID)"
 W !,"   ]"
 W !,"   }",!
 Q
QUERY S S=""
 W !,"   query ListKD((Param1:%Library.String))"
 W !,"   {",!
 W !,"           type = %Library.SQLQuery(CONTAINID=0,ROWSPEC=""" D  W """);"
 .;K1:%String,K2:%String,P1:%String,P2:%String,P3:%Library.String,P4:%Library.String
 .W "K1:%String,A1:%String"
 W !,"           sqlquery ="
 W !,"           ["
 W !,"                   :SELECT K1, A1"
 W !,"                   :FROM "_$P(NC,".",$L(NC,"."))
 W !,"                   :WHERE (K1 = :Param1)"
 W !,"                   :ORDER BY K1"
 W !,"            ]"
 W !,"            sqlproc = 0;"
 W !,"            sqlview = 0;"
 W !,"   }",! Q
QUERYALL S S=""
 W !,"   query ALLListKD()"
 W !,"   {",!
 W !,"           type = %Library.SQLQuery(CONTAINID=0,ROWSPEC=""" D  W """);"
 .;K1:%String,K2:%String,P1:%String,P2:%String,P3:%Library.String,P4:%Library.String
 .W "K1:%String,A1:%String"
 W !,"           sqlquery ="
 W !,"           ["
 W !,"                   :SELECT K1, A1"
 W !,"                   :FROM "_$P(NC,".",$L(NC,"."))
 W !,"                   :ORDER BY K1"
 W !,"            ]"
 W !,"            sqlproc = 0;"
 W !,"            sqlview = 0;"
 W !,"   }",! 
 Q
STORAGE ;ХРАНЕНИЕ
 W !!,"       storage KD"
 W !,"       {"
 W !,"               description = ""Конструкция SQL доступа к Кодификаторам %BS"";"
 W !,"               type = %CacheSQLStorage;"
 W !,"               sql"
 W !,"               {"
 W !,"                       map Master"
 W !,"                       {"
 W !,"                               global = "_GL_";"
 W !,"                               structure = delimited;"
 W !,"                               type = data;"
 W !
 W !,"                               subscript 1"
 W !,"                               {"
 W !,"                                      expression = 1;"
 W !,"                                      nextcode ="
 W !,"                                      ["
 W !,"                                      ]"
 W !,"                               }"
 W !,"                               subscript 2"
 W !,"                               {"
 W !,"                                      expression = {K1};"
 W !,"                                      nextcode ="
 W !,"                                      ["
 W !,"                                      ]"
 W !,"                               }"
 W !,"                   data A1 { delimiter = ""@""; piece = 1; }"
 W !,"                       }" ;MAP1
 W !,"                       map Slove"
 W !,"                       {"
 W !,"                               global = "_GL_";"
 W !,"                               structure = delimited;"
 W !,"                               type = index;"
 W !
 W !,"                               subscript 1"
 W !,"                               {"
 W !,"                                      expression = 2;"
 W !,"                                      nextcode ="
 W !,"                                      ["
 W !,"                                      ]"
 W !,"                               }"
 W !,"                               subscript 2"
 W !,"                               {"
 W !,"                                      expression = {A1};"
 W !,"                                      nextcode ="
 W !,"                                      ["
 W !,"                                      ]"
 W !,"                               }"
 W !,"                   data K1 { delimiter = ""@""; piece = 1; }"
 W !,"                       }" ;MAP2
 W !,"               }" ;SQL
 W !,"       }"
 Q
KodTxt ;ПРЯМОЙ ДОСТУП
 Q 1
TxtKod ;
 Q 1
]]></Routine>


<Routine name="%ZAPM.ed.BSCRG" type="MAC" languagemode="0"><![CDATA[
%BSCRG ;Cache Relational Gateway - Functions ; 18:28   06.04.2003
 ;
 ; Copyright (c) Serge W. Mikhaylenko
 ; All Rights Reserved
 ;
 Q
 ;/////////////////////////// BStempSQL...//////////////////////////
RUN() ;запустить из VISM.ocx
 ;ВХОДНЫЕ ПЕРЕМЕННЫЕ
 ;P1=Data Sours Name
 ;P2=Name User
 ;P3=Password
 ;P4=SQL
 Q $$DSN(P1,P2,P3,P4)
 ;ВЫХОДНЫЕ ПЕРЕМЕННЫЕ
 ;P5=Second EXECUTIVE
 ;P6=Error
 ;P7=Time
 ;P8=Colomn
 ;P9=Rows
TEST ;ТЕСТЫ
 N DSN,SQL
 ;S DSN="EXZ",SQL="SELECT EKZ_VOP.TEXT_V, EKZ_OTV.TEXT_O FROM EKZ_VOP INNER JOIN EKZ_OTV ON EKZ_VOP.N_NOM = EKZ_OTV.N_VOP"
 ;S DSN="ISSBASE",SQL="SELECT [ConnectRazdel]![Pred] & ' ' & [STR_MENU]![HTML] & ' ' & [ConnectRazdel]![Post] AS HTML_STRING FROM (WORKGROUPS INNER JOIN (STR_MENU INNER JOIN ConnectRazdel ON STR_MENU.Kod = ConnectRazdel.PunktMenu) ON WORKGROUPS.ID_WORKGROUP = ConnectRazdel.Workgroup) INNER JOIN SOTR ON WORKGROUPS.ID_WORKGROUP = SOTR.WORKGROUP WHERE SOTR.NET_NAME='hodov' ORDER BY STR_MENU.Nomer"
 S DSN="KSP",SQL="SELECT * FROM KNH"
 W $$DSN(DSN,"","",SQL)
 Q
DSN(DSN,NAME,PASS,SQL) ;ВЫПОЛНЕНИЕ ЗАПРОСА И ФОРМИРОВАНИЕ УЗЛА ОБЕКТОВ
 N Con,Res,Sc,Pid,i,ErrOR,COL,JJ ;,P5,P6,P7,P8,P9
 s Pid=$I_","_$J ;ИДЕНТИФИКАТОР ПРОЦЕССА
 ;ПЕРЕЙТИ В СИСТЕМНЫЙ СПЭЙС
 I $zu(5,"%SYS")
 ;ВЫПОЛНЕНИЕ ЗАПРОСА
 S Con=##Class(%SQLGatewayConnection).%New()
 S Sc=Con.Connect(DSN,NAME,PASS)
 S Res=##Class(%ResultSet).%New("%DynamicQueryGW:SQLGW")
 K ^["%SYS"]BStempSql(Pid)
 S ^["%SYS"]BStempSql(Pid,"SQL",1)=SQL
 S ^["%SYS"]BStempSql(Pid,"SQL",2)=$ZD($H,9)
 S P5=$P($H,",",2)
 s Sc=Res.Prepare(SQL,,Con)
 I 'Res.QueryIsValid() S ErrOR="Недопустимый Запрос" G DSNend
 s Sc=Res.Execute()
 I 'Sc S ErrOR=$$Status(Sc) G DSNend
 S COL=Res.GetColumnCount()
 F J=1:1:COL S ^["%SYS"]BStempSql(Pid,"NAM",J)=Res.GetColumnName(J)
 ;F J=1:1:COL S ^["%SYS"]BStempSql(Pid,"HDR",J)=Res.GetColumnHeader(J)
 ;f i=1:1:10001 q:'Res.Next()  I i<5001 d                                         ;ОГРАНИЧЕНИЯ
 f i=1:1 q:'Res.Next()  D
 .F J=1:1:COL S JJ=Res.GetData(J) I JJ'="" S ^["%SYS"]BStempSql(Pid,i,J)=JJ
 S P6=$P($H,",",2),P5=P6-P5
 S ^["%SYS"]BStempSql(Pid,"SQL",3)=P5
 S (P8,^["%SYS"]BStempSql(Pid,"SQL",7))=COL ;КОЛ-ВО КОЛОНОК
 S (P9,^["%SYS"]BStempSql(Pid,"SQL",8))=i-1 ;КОЛ-ВО СТРОК
 S (P7,^["%SYS"]BStempSql(Pid,"SQL",5))=$ZT($P($H,",",2),1)
DSNend S (P6,^["%SYS"]BStempSql(Pid,"SQL",6))=$G(ErrOR)
 d Res.%Close()
 d Con.Disconnect()
 d Con.%Close()
 Q Pid ;ИДЕНТИФИКАТОР ПРОЦЕССА
Status(sc) ;СТАТУС
 N err,i,st1
 I ('sc) D  Q st1
 .D DecomposeStatus^%apiOBJ(sc,.err)
 .S st1="" F i=1:1:err S st1=st1_err(i)_". "
 Q ""
KILL(P) ;УДАЛЕНИЕ УЗЛА
 I $G(P)'="",$D(^["%SYS"]BStempSql(P)) K ^(P) Q 1
 Q 0
ROWS(P) ;КОЛ-ВО СТРОК
 I $G(P)'="" Q $G(^["%SYS"]BStempSql(P,"SQL",8))
 Q 0
SEC(P) ;КОЛ-ВО СЕКУНД
 I $G(P)'="" Q $G(^["%SYS"]BStempSql(P,"SQL",3))
 Q ""
COLS(P) ;КОЛ-ВО КОЛОНОК
 I $G(P)'="" Q $G(^["%SYS"]BStempSql(P,"SQL",7))
 Q 0
ERRORS(P) ;ОШИБКИ
 I $G(P)'="" Q $G(^["%SYS"]BStempSql(P,"SQL",6))
 Q 0
 ;///////////////////////////////////////////////////////
STREAM(DSN,USER,PASS) ;ВСЕ ТАБЛИЦЫ DSN КОПИРОВАТЬ В РАЗДЕЛ PART И ЗАГРУЗИТЬ ДАННЫЕ
 N PxPUSTO,AUTO
 D DSN2PART^%ZAPM.ed.BSCRG(DSN,"",$G(USER),$G(PASS))
 D PART2BSD^%ZAPM.ed.BSCRG("^"_DSN)
 S PxPUSTO="" D ALLPART^%ZAPM.ed.BSCBD("^"_DSN)
 D DSN2BS^%ZAPM.ed.BSCRG(DSN,$G(USER),$G(PASS))
 Q
DSN2PART(DSN,PART,USER,PASS) ;ВСЕ ТАБЛИЦЫ DSN КОПИРОВАТЬ В РАЗДЕЛ PART
 I $G(PART)="" S PART="^"_DSN
 N WEBSQL,I,II,flag
 I $$DescDsn(DSN)'="" s ErV=1 q
 I $P($G(@PART),"@",1)'="BaSe MsW " S @PART="BaSe MsW @Раздел таблиц импортированных из DSN="_DSN
 S I="0" F  S I=$O(WEBSQL(I)) Q:I=""  I WEBSQL(I,2)="TABLE" s flag=1 D TABLE2T(DSN,WEBSQL(I,1),$NA(@PART@($$TRANAME(WEBSQL(I,1)))),$G(USER),$G(PASS))
 i '$d(flag) s ErV=1
 Q
TABLE2T(DSN,TAB,GLO,USER,PASS) ;СТРУКТУРУ ТАБЛИЦЫ В ТАБЛИЦУ %BS
 N GL,I,St,S,NAME,NAME1,TAB1,N,BSR,BST,se,ke
 S S="^%ZAPM.ed.BSC(""BSG"")"
 S St=$$DescCol(DSN,$G(USER),$G(PASS),TAB,"GL")
 K @GLO S @GLO=St
 I St'="" Q
 ;ZW GL Q
 S St=TAB_"=",@GLO=@S,@GLO@(1,1)=@S@(1,1),@GLO@(1,2)=@S@(1,2)
 ;W S Q
 S $P(@GLO@(1,1),"@",15)=" DSN:"_DSN,$P(@GLO@(1,2),"@",15)=" TABLE:"_TAB
 S TAB1=$$TRANAME(TAB)
 ;W TAB1
 S I="" F N=1:1 S I=$O(GL(0,I)) Q:I=""  S NAME=GL(0,I),NAME1=$$TRANAME(NAME),@GLO@("DSN",NAME)=NAME1 D
 .S @GLO@(N+1,1)=@S@(2,1),@GLO@(N+1,2)=@S@(2,2)
 .S $P(@GLO@(N+1,1),"@",15)=NAME,$P(@GLO@(N+1,2),"@",18)=NAME1,St=St_NAME1_",",$P(@GLO@(N+1,2),"@",9)=1
 ;W 222 Q
 S $P(@GLO,"@",1)=St,$P(@GLO,"@",17)=1,@GLO@("DSN")=TAB
 S BSR=$QS(GLO,0),BST=$QS(GLO,1),ke=2,se=N ;D RESZER^%ZAPM.ed.BSF2
 D TABm^%ZAPM.ed.BSF1
 Q
TRANAME(N) Q $TR(N,"_/\","vso")      ;ТРАНСЛЯЦИЯ ИМЕН ТАБЛИЦ И ПОЛЕЙ
PART2BSD(PART,TAB) ;TAB="" --> ВСЕ ТАБЛИЦЫ РАЗДЕЛА СДЕЛАТЬ БАЗАМИ (1-1 КЛЮЧ, 2=2 КЛЮЧ И Т.Д.)
 N TA
 I $G(TAB)'="" D TA2BD(PART,TAB)
 S TA="" F  S TA=$O(@PART@(TA)) Q:TA=""  D TA2BD(PART,TA)
 Q
TA2BD(BSR,BST,NOBD,InDx) ;СДЕЛАТЬ БАЗАМИ //новая редакция
 N K,KK,S,BD,nk
 I '$D(@BSR@(BST,"DSN")) S Errors="Таблица не для DSN" Q
 S S="^%ZAPM.ed.BSC(""BSG"")"
 F K=2:1 Q:'$D(@BSR@(BST,K,2))  D
 .I $P(@BSR@(BST,K,2),"@",15)'="" d  q  ;идексы не должны совпадать
 ..d SetKK(+$P(@BSR@(BST,K,2),"@",15),$P(@BSR@(BST,K,1),"@",15),$p($P(@BSR@(BST,K,2),"@",18),"#",1),$P(@BSR@(BST,K,2),"@",21),$P(@BSR@(BST,K,2),"@",17))
 ..S $P(@BSR@(BST,K,2),"@",9)=1
 .;S $P(@BSR@(BST,K,2),"@",15)="" ;НЕ НАДО УДАЛЯТЬ
 .S $P(@BSR@(BST,K,2),"@",9)=2
 I '$D(NOBD) S BD=BSR_"."_BST K @BD,@BSR@(BST,"KEY") S @BD="BSD - MSW@"_BSR_"@"_BST S @BSR@(BST,"KEY")=BD
 S $P(@BSR@(BST),"@",17)=2
 S K="" F NK=1:1 S K=$O(KK(K)) Q:K=""  D NEWKEY($p(KK(K),"@",1),$p(KK(K),"@",2),$p(KK(K),"@",3),$p(KK(K),"@",4))
 F nk=NK:1:9 K @BSR@(BST,"KEY",nk) //УДАЛИТЬ СТАРЫЕ КЛЮЧИ
 I '$G(InDx) D NEWKEY("BSiD","BSiD",0,"")
 D SNX^%ZAPM.ed.BSChT1("S",$TR($NA(@BSR@(BST)),"@",""),"TABLE")
 Q
SetKK(i,s,f,t,d) f  q:'$d(KK(i))  s i=i+0.01
 s KK(i)=s_"@"_f_"@"_t_"@"_d
 q
NEWKEY(N,f,t,d) S @BSR@(BST,"KEY",NK)=@S@("KEY",1)
 S $P(@BSR@(BST,"KEY",NK),"@",5)="НОВОЕ ЗНАЧЕНИЕ "_N,$P(@BSR@(BST,"KEY",NK),"@",9)=NK_" ИНДЕКС"
 S $P(@BSR@(BST,"KEY",NK),"@",15)=N
 S $P(@BSR@(BST,"KEY",NK),"@",22)=f,$P(@BSR@(BST,"KEY",NK),"@",21)=t,$P(@BSR@(BST,"KEY",NK),"@",17)=d
 Q
DSN2BS(DSN,USER,PASS,PART) ;ЗАКАЧАТЬ ИНФОРМАЦИЮ ИЗ DSN В BS-БАЗУ (только 4 ключевую)
 I $G(PART)="" S PART="^"_DSN
 I '$D(@PART) S ErrOR="НЕТ РАЗДЕЛА "_PART Q
 N WEBSQL,I,II
 I $$DescDsn(DSN,$G(USER),$G(PASS))'="" Q
 S I="0" F  S I=$O(WEBSQL(I)) Q:I=""  I WEBSQL(I,2)="TABLE" D
 .D TAB2BSD(DSN,$G(USER),$G(PASS),WEBSQL(I,1),PART,$$TRANAME(WEBSQL(I,1)))
 .;D x^%ZAPM.ed.BS3($G(ErrOR,1))     ;---//--- для msm 4.x.x
 Q
TAB2BSD(DSN,USER,PASS,TAB,PART,TOBD) ;ЗАКАЧАТЬ ИНФОРМАЦИЮ ИЗ ТАБЛИЦЫ В БАЗУ
 N I,Con,Res,Sc,Pid,i,COL,J,JJ,clist,column,info,BD,K,K1,K2,K3,K4,K5,K6,K7,K8,K9,ARR,KEY,KK,XX
 ;ВЫПОЛНЕНИЕ ЗАПРОСА
 S Con=##Class(%SQLGatewayConnection).%New()
 S Sc=Con.Connect(DSN,$G(USER),$G(PASS))
 I 'Sc S ErrOR=$$Status(Sc) G TDsNend
 S Res=##Class(%ResultSet).%New("%DynamicQueryGW:SQLGW")
 S SQL="SELECT * FROM "_TAB
 s Sc=Res.Prepare(SQL,,Con)
 I 'Res.QueryIsValid() S ErrOR="Недопустимый Запрос" G TDsNend
 s Sc=Res.Execute()
 I 'Sc S ErrOR=$$Status(Sc) G TDsNend
 S COL=Res.GetColumnCount()
 F J=1:1:COL S ARR(0,J)=Res.GetColumnName(J),ARR(1,ARR(0,J))=J
 I $G(@PART@(TOBD,"DSN"))'=TAB S ErrOR="Несоответсвие полей таблицы "_$ZR_" -> "_TAB G TDsNend
 S BD=$P(@PART@(TOBD,"KEY"),"@",1)
 F KEY=1:1 Q:'$D(@PART@(TOBD,"KEY",KEY))  S KK(KEY)=$P($P(@PART@(TOBD,"KEY",KEY),"@",5),"НИЕ ",2)
 F K=1:1 Q:'$D(KK(K))  S POLE=KK(K) I POLE'="BSiD" S ARR(2,K)=ARR(1,POLE)
 S KEY=KEY-1
 F J=1:1:COL S ARR(0,J)=$G(@PART@(TOBD,"DSN",ARR(0,J)))
 f iD=1:1 q:'Res.Next()  D  ;Q:iD>50
 .I '$G(AUTO) W " ",iD
 .I KEY=1 S XX="S @BD@(iD,ARR(0,J))=JJ"
 .I KEY=2 S XX="S K1=Res.GetData(ARR(2,1)) S:K1="""" K1=""ZERRO"" S @BD@(K1,iD,ARR(0,J))=JJ"
 .I KEY=3 S XX="S K1=Res.GetData(ARR(2,1)) S:K1="""" K1=""ZERRO"" S K2=Res.GetData(ARR(2,2)) S:K2="""" K2=""ZERRO"" S @BD@(K1,K2,iD,ARR(0,J))=JJ"
 .I KEY=4 S XX="S K1=Res.GetData(ARR(2,1)) S:K1="""" K1=""ZERRO"" S K2=Res.GetData(ARR(2,2)) S:K2="""" K2=""ZERRO"" S K3=Res.GetData(ARR(2,3)) S:K3="""" K3=""ZERRO"" S @BD@(K1,K2,K3,iD,ARR(0,J))=JJ"
 .I KEY=5 S XX="S K1=Res.GetData(ARR(2,1)) S:K1="""" K1=""ZERRO"" S K2=Res.GetData(ARR(2,2)) S:K2="""" K2=""ZERRO"" S K3=Res.GetData(ARR(2,3)) S:K3="""" K3=""ZERRO"" S K4=Res.GetData(ARR(2,4)) S:K4="""" K4=""ZERRO"" S @BD@(K1,K2,K3,K4,iD,ARR(0,J))=JJ"
 .I KEY=6 S XX="S K1=Res.GetData(ARR(2,1)) S:K1="""" K1=""ZERRO"" S K2=Res.GetData(ARR(2,2)) S:K2="""" K2=""ZERRO"" S K3=Res.GetData(ARR(2,3)) S:K3="""" K3=""ZERRO"" S K4=Res.GetData(ARR(2,4)) S:K4="""" K4=""ZERRO"" S K5=Res.GetData(ARR(2,5)) S:K5="""" K5=""ZERRO"" S @BD@(K1,K2,K3,K4,K5,iD,ARR(0,J))=JJ"
 .I KEY=7 S XX="S K1=Res.GetData(ARR(2,1)) S:K1="""" K1=""ZERRO"" S K2=Res.GetData(ARR(2,2)) S:K2="""" K2=""ZERRO"" S K3=Res.GetData(ARR(2,3)) S:K3="""" K3=""ZERRO"" S K4=Res.GetData(ARR(2,4)) S:K4="""" K4=""ZERRO"" S K5=Res.GetData(ARR(2,5)) S:K5="""" K5=""ZERRO"" S K6=Res.GetData(ARR(2,6)) S:K6="""" K6=""ZERRO"" S @BD@(K1,K2,K3,K4,K5,K6,iD,ARR(0,J))=JJ"
 .I KEY=8 S XX="S K1=Res.GetData(ARR(2,1)) S:K1="""" K1=""ZERRO"" S K2=Res.GetData(ARR(2,2)) S:K2="""" K2=""ZERRO"" S K3=Res.GetData(ARR(2,3)) S:K3="""" K3=""ZERRO"" S K4=Res.GetData(ARR(2,4)) S:K4="""" K4=""ZERRO"" S K5=Res.GetData(ARR(2,5)) S:K5="""" K5=""ZERRO"" S K6=Res.GetData(ARR(2,6)) S:K6="""" K6=""ZERRO"" S K7=Res.GetData(ARR(2,7)) S:K7="""" K7=""ZERRO"" S @BD@(K1,K2,K3,K4,K5,K6,K7,iD,ARR(0,J))=JJ"
 .I KEY=9 S XX="S K1=Res.GetData(ARR(2,1)) S:K1="""" K1=""ZERRO"" S K2=Res.GetData(ARR(2,2)) S:K2="""" K2=""ZERRO"" S K3=Res.GetData(ARR(2,3)) S:K3="""" K3=""ZERRO"" S K4=Res.GetData(ARR(2,4)) S:K4="""" K4=""ZERRO"" S K5=Res.GetData(ARR(2,5)) S:K5="""" K5=""ZERRO"" S K6=Res.GetData(ARR(2,6)) S:K6="""" K6=""ZERRO"" S K7=Res.GetData(ARR(2,7)) S:K7="""" K7=""ZERRO"" S K8=Res.GetData(ARR(2,8)) S:K8="""" K8=""ZERRO"" S @BD@(K1,K2,K3,K4,K5,K6,K7,K8,iD,ARR(0,J))=JJ"
 .F J=1:1:COL I ARR(0,J)'="" S JJ=Res.GetData(J) I JJ'="" X XX
TDsNend ;КОНЕЦ
 I $D(Res) d Res.%Close()
 d Con.Disconnect()
 d Con.%Close()
 Q $G(ErrOR)
 Q
 ;///////////////////////////
DescDsn(DSN,USER,PASS) ;СОСТАВ DSN
 D intDSN^%ZAPM.ed.BSCG(DSN,$G(USER),$G(PASS))
 Q $G(ErV)
DescCol(DSN,USER,PASS,TAB,MAS) ;СОСТАВ КОЛОНОК ТАБЛИЦЫ TAB
 Q $$DsnSql(DSN,USER,PASS,"SELECT * FROM "_TAB,MAS,0,1)  ;ВЫПОЛНЕНИЕ ЗАПРОСА И ФОРМИРОВАНИЕ УЗЛА ОБЕКТОВ
DsnSql(DSN,USER,PASS,SQL,ARR,Rows,DescCol) ;ВЫПОЛНЕНИЕ ЗАПРОСА И ФОРМИРОВАНИЕ УЗЛА ОБЕКТОВ
 N Con,Res,Sc,Pid,i,ErrOR,COL,J,JJ,clist,column,info
 ;ВЫПОЛНЕНИЕ ЗАПРОСА
 S Con=##Class(%SQLGatewayConnection).%New()
 S Sc=Con.Connect(DSN,USER,PASS)
 I 'Sc S ErrOR=$$Status(Sc) G DsNend
 S Res=##Class(%ResultSet).%New("%DynamicQueryGW:SQLGW")
 s Sc=Res.Prepare(SQL,,Con)
 I 'Res.QueryIsValid() S ErrOR="Недопустимый Запрос" G DsNend
 s Sc=Res.Execute()
 I 'Sc S ErrOR=$$Status(Sc) G DsNend
 S COL=Res.GetColumnCount()
 F J=1:1:COL S @ARR@(0,J)=Res.GetColumnName(J)
 I $G(DescCol) G DsNend
 I '$G(Rows) S Rows=99999 ;ПОКА ТАК
 f i=1:1 q:'Res.Next()  I i<Rows D
 .F J=1:1:COL S JJ=Res.GetData(J) I JJ'="" S @ARR@(i,J)=JJ
DsNend ;КОНЕЦ
 I $D(Res) d Res.%Close()
 d Con.Disconnect()
 d Con.%Close()
 Q $G(ErrOR)
]]></Routine>


<Routine name="%ZAPM.ed.BSCRGL" type="MAC" languagemode="0"><![CDATA[
%BSCRGL ;Cache Relational Gateway - Functions ; 9:04   26.06.2001
 ;
 ; Copyright (c) Serge W. Mikhaylenko
 ; All Rights Reserved
 ;
 Q
RUN() ;запустить из VISM.ocx
 ;ВХОДНЫЕ ПЕРЕМЕННЫЕ
 ;P1=Data Sours Name 
 ;P2=Name User
 ;P3=Password
 ;P4=SQL
 Q $$DSN(P1,P2,P3,P4)
 ;ВЫХОДНЫЕ ПЕРЕМЕННЫЕ
 ;P5=Second EXECUTIVE
 ;P6=Error
 ;P7=Time
 ;P8=Colomn
 ;P9=Rows
TEST ;ТЕСТЫ
 N DSN,SQL
 ;S DSN="EXZ",SQL="SELECT EKZ_VOP.TEXT_V, EKZ_OTV.TEXT_O FROM EKZ_VOP INNER JOIN EKZ_OTV ON EKZ_VOP.N_NOM = EKZ_OTV.N_VOP"
 ;S DSN="ISSBASE",SQL="SELECT [ConnectRazdel]![Pred] & ' ' & [STR_MENU]![HTML] & ' ' & [ConnectRazdel]![Post] AS HTML_STRING FROM (WORKGROUPS INNER JOIN (STR_MENU INNER JOIN ConnectRazdel ON STR_MENU.Kod = ConnectRazdel.PunktMenu) ON WORKGROUPS.ID_WORKGROUP = ConnectRazdel.Workgroup) INNER JOIN SOTR ON WORKGROUPS.ID_WORKGROUP = SOTR.WORKGROUP WHERE SOTR.NET_NAME='hodov' ORDER BY STR_MENU.Nomer"
 S DSN="KSP",SQL="SELECT * FROM KNH"
 W $$DSN(DSN,"","",SQL)
 Q
DSN(DSN,NAME,PASS,SQL) ;ВЫПОЛНЕНИЕ ЗАПРОСА И ФОРМИРОВАНИЕ УЗЛА ОБЕКТОВ
 N Con,Res,Sc,Pid,i,ErrOR,COL,st ;,P5,P6,P7,P8,P9
 s Pid=$I_","_$J ;ИДЕНТИФИКАТОР ПРОЦЕССА
 ;ПЕРЕЙТИ В СИСТЕМНЫЙ СПЭЙС
 I $zu(5,"%SYS")
 ;ВЫПОЛНЕНИЕ ЗАПРОСА
 S Con=##Class(%SQLGatewayConnection).%New()
 S Sc=Con.Connect(DSN,NAME,PASS)
 S Res=##Class(%ResultSet).%New("%DynamicQueryGW:SQLGW")
 K ^["%SYS"]BStempSql(Pid)
 S $P(^["%SYS"]BStempSqlist(Pid,"SQL"),$C(0),1)=SQL
 S $P(^["%SYS"]BStempSqlist(Pid,"SQL"),$C(0),2)=$ZD($H,9)
 S P5=$P($H,",",2)
 s Sc=Res.Prepare(SQL,,Con)
 I 'Res.QueryIsValid() S ErrOR="Недопустимый Запрос" G DSNend
 s Sc=Res.Execute()
 I 'Sc S ErrOR=$$Status(Sc) G DSNend
 S COL=Res.GetColumnCount()
 F J=1:1:COL S $P(^["%SYS"]BStempSqlist(Pid,"NAM"),$C(0),J)=Res.GetColumnName(J)
 ;F J=1:1:COL S $P(^["%SYS"]BStempSqlist(Pid,"HDR"),$C(0),J)=Res.GetColumnHeader(J)
 ;f i=1:1:10001 q:'Res.Next()  I i<5001 d                                               ;ОГРАНИЧЕНИЯ 
 f i=1:1 q:'Res.Next()  D
 .S st="" F J=1:1:COL S st=st_Res.GetData(J)_$C(0)
 .S ^["%SYS"]BStempSqlist(Pid,i)=st
 S P6=$P($H,",",2),P5=P6-P5
 S $P(^["%SYS"]BStempSqlist(Pid,"SQL"),$C(0),3)=P5 ;КОЛ-ВО СЕКУНД
 S (P8,$P(^["%SYS"]BStempSqlist(Pid,"SQL"),$C(0),7))=COL ;КОЛ-ВО КОЛОНОК
 S (P9,$P(^["%SYS"]BStempSqlist(Pid,"SQL"),$C(0),8))=i-1 ;КОЛ-ВО СТРОК
 S (P7,$P(^["%SYS"]BStempSqlist(Pid,"SQL"),$C(0),5))=$ZT($P($H,",",2),1)
DSNend S (P6,$P(^["%SYS"]BStempSqlist(Pid,"SQL"),$C(0),6))=$G(ErrOR)
 d Res.%Close()
 d Con.Disconnect()
 d Con.%Close()
 Q Pid ;ИДЕНТИФИКАТОР ПРОЦЕССА
Status(sc) ;СТАТУС
 N err,i,st1
 I ('sc) D  Q st1
 .D DecomposeStatus^%apiOBJ(sc,.err)
 .S st1="" F i=1:1:err S st1=st1_err(i)_". "
 Q ""    
KILL(P) ;УДАЛЕНИЕ УЗЛА
 I $G(P)'="",$D(^["%SYS"]BStempSqlist(P)) K ^(P) Q 1
 Q 0
SEC(P) ;КОЛ-ВО СЕКУНД
 I $G(P)'="" Q $P($G(^["%SYS"]BStempSqlist(P,"SQL")),$C(0),3)
 Q ""
ROWS(P) ;КОЛ-ВО СТРОК
 I $G(P)'="" Q $P($G(^["%SYS"]BStempSqlist(P,"SQL")),$C(0),8)
 Q 0
COLS(P) ;КОЛ-ВО КОЛОНОК
 I $G(P)'="" Q $P($G(^["%SYS"]BStempSqlist(P,"SQL")),$C(0),7)
 Q 0     
ERRORS(P) ;ОШИБКИ
 I $G(P)'="" Q $P($G(^["%SYS"]BStempSqlist(P,"SQL")),$C(0),6)
 Q 0     
]]></Routine>


<Routine name="%ZAPM.ed.BSCSVG" type="MAC" languagemode="0"><![CDATA[
%BSCSVG ;ПРОГРАММА РАБОТЫ С SVG
 ;
 ;    Copyright Serge Mikhaylenko
 ;    All Rights Reserved
 ;
 ;
 Q
SVG ;ВЫВЕСТИ ВСЕ ГЛОБАЛЬНЫЕ БУФЕРА
 D BEG1^%ZAPM.ed.BSC4
 S BSLABEL="GET^~BSCSVG"
 D BSVG
 w "</HTML>",BK
 q
BSVG W "<BUTTON onclick=""open('"_$$ADDBSGET^%ZAPM.ed.BSC4_"','','toolbar=no,menubar=no,scrollbars=yes,width=800,height=600,status=1,resizable=1')"" title='Открыть SVG'>ЗАГРУЗИТЬ ФАЙЛ SVG</BUTTON>"
 Q
GET  W "HTTP/1.0 200 OK"_BK
 W "Content-type: image/svg+xml"_BK
 ;W "Set-Cookie: cookie_name=cookie_value; path=/;",CRLF
 ;W "Window-target: main_window",CRLF
 W BK
 D SVGOUT
 Q
SVGOUT I '$D(BK) S BK=$C(13,10)
 N M,MM
 ;S F="N:\InfoPortal\WebNodes\vv\svg\sample\anim[1].svg"
 S F="N:\InfoPortal\WebNodes\vv\svg\sample\mgwms32[4].svg"
 D File2Arr^%ZAPM.ed.BSCEXE(F,.M)
 d STR2MAS^%ZAPM.ed.BSCmail(.M,.MM,BK)
 S I="" F  S I=$O(MM(I)) Q:I=""  D
 .;W !,I,"-->>>>>>>>>",MM(I)_BK
 .I MM(I)'["<circle fill" W MM(I)_BK
 Q
 
]]></Routine>


<Routine name="%ZAPM.ed.BSCek" type="MAC" languagemode="0"><![CDATA[
%BSCek //Call-In ФУНКЦИИ Е.Каратаева
INIT(D) //ИНИЦИАЛИЗАЦИИ ФУНКЦИЙ
 N I,A,i S A="ekzlib.dll?ekelog.dll?ekguid.dll?ekreg.dll?ekimg.dll?ekscr.dll?ekntlm.dll",i=1
 F I="ekzlib","ekelog","ekguid","ekreg","ekimg","ekscr","ekntlm" S ^%eklib(I,"library")=D_$P(A,"?",i),i=i+1
 Q
NTLM //проверка пароля у пользователя
 w $$Validate^%zekntlm("","Mikhaylenko","123") 
 q
LOG //Cache': плагин для EventLogging
 s AppName="August Application"
 s EventType="I" ;E(rror) W(arning) I(nformation)
 s EventCategory="1"
 s EventID=1
 s EventMessage="Hello, event logging!"
 d LogData^%zekelog(AppName,EventType,EventCategory,EventID,EventMessage)
 q
SYSMSG(EventMessage,EventType,APP) //ЗАПИСАТЬ В СИСТЕМНЫЕ СООБЩЕНИЯ WINDOWS
 I $ZV'["Windows" Q
 S $ZT="SYSMSGerr" ; EventType=E(rror) W(arning) I(nformation)
 d LogData^%zekelog($G(APP,"%BS-Portal"),EventType,"","",EventMessage)
SYSMSGerr 
 Q
GUID //Cache' плагин для генерации GUID
 w $$GetGuid^%zekguid()
 q
REG //Cache': плагин для доступа к реестру
 I $ZV'["Windows" W $ZV Q
 K svc d GetKeyNames^%zekreg("HKLM","SYSTEM\CurrentControlSet\Services",$na(svc))
 zw svc
 w !,"----------",!
 s Key="SYSTEM\CurrentControlSet\Services\Cache_e-_cachesys"
 s Root="HKLM"
 d GetValueNames^%zekreg(Root,Key,$na(cache))
 zw cache
 W !!!!
 q
ZLIB //Cache': плагин для компрессора - декомпрессора zlib.
 n file,Source,Target,str,size,t
 w "stream test",!
 s t=$ztimestamp
 ; load zekzlib library
 d LoadLib^%zekzlib()
 s file=##class(%Library.File).%New("c:\!\cache.dat")
 d file.Open("RU")
 ; create ekzlib internal streams
 s Source=$$NewStream^%zekzlib()
 s Target=$$NewStream^%zekzlib()
 ; write entire file content into internal stream
 s size=32000
 f  q:size<1  d
 . s str=file.Read(.size)
 . d WriteStream^%zekzlib(Source,str)
 w t_" "_$ztimestamp,!
 s t=$ztimestamp
 d file.Close() ; close file system object
 d file.%Close() ; close Cache object
 ; restore stream location into first position
 d SetPosition^%zekzlib(Source,0)
 ; compress Source to Target using best compression level
 d Compress^%zekzlib(Source,Target)
 w t_" "_$ztimestamp,!
 s t=$ztimestamp
 w "Source size: "_$$GetStreamSize^%zekzlib(Source),!
 w "Target size: "_$$GetStreamSize^%zekzlib(Target),!
 ; remove source internal ekzlib streams
 d KillStream^%zekzlib(Source)
 d KillStream^%zekzlib(Target)
 ; unload zekzlib library
 d UnloadLib^%zekzlib()
 q
IMG //Cache': плагин для генерации графического файла 
 ;http://127.0.0.1:1972/csp/samples/ekImageTest.CSP
 /*
 <html><head>
  <title>This is image container</title>
</head>
<body>
 
<div align="center">
<table width=570 border=0 cellspacing=0 cellpadding=0>
<tr><td><hr>
<p>
<center>This is test image</center>
<p>
<center><img src="ekGetImage.csp"></center>
<p>
<hr>
</td></tr></table>
</div>
 
</body>
</html>
 */
 /*
 <script language=CACHE method=OnPreHTTP arguments="" returntype=%Boolean>
  ; no any symbols before opening tag!
  Set %response.ContentType="image/gif"
</script><script language=CACHE runat=server> ; we cannot insert any symbols between tags!
 n stream,str
 d LoadLib^%zekimg()
 
 ; create new image
 d CreateImage^%zekimg(400,300,8)
 
 ; create image content
 d MoveTo^%zekimg(10,10)
 d LineTo^%zekimg(30,50)
 d SetPenColor^%zekimg($ZH("FF0000"))  ; bgr blue - green - red
 d LineTo^%zekimg(100,60)
 d SetPenColor^%zekimg($ZH("00FF00"))  ; bgr blue - green - red
 d LineTo^%zekimg(150,100)
 d SetPenColor^%zekimg($ZH("0000FF"))  ; bgr blue - green - red
 d LineTo^%zekimg(300,200)
 d SetFontColor^%zekimg($ZH("FF00FF"))
 d SetFontSize^%zekimg(26)
 d SetFontName^%zekimg("Times New Roman")
 d TextOut^%zekimg(10,150,"Hello, World!")
 
 ; out image data
 s stream=$$NewStream^%zekimg()
 d GetGIFData^%zekimg(stream) ; image format must be the same as declared in Content-Type
 d SetPosition^%zekimg(stream,0)
 
 ; out all stream content to device
 f  s str=$$ReadStream^%zekimg(stream,32000) q:str=""  w str
 
 d KillStream^%zekimg(stream)
 d UnloadLib^%zekimg()
 ; no any symbols after closing tag!
</script>
 
 */
 q
]]></Routine>


<Routine name="%ZAPM.ed.BSCh" type="MAC" languagemode="0"><![CDATA[
%BSCh ;ФУНКЦИИ HTML  ; 13:48   12.09.2002
 ;
 ; Copyright (c) Serge W. Mikhaylenko
 ; All Rights Reserved
 ;
 ;D INIT^%ZAPM.ed.BSChW ;ПЕРВОНАЧАЛЬНАЯ ИНИЦИАЛИЗАЦИЯ КОМПЛЕКСА
 Q
APPVAL() ;ВЕРНУТЬ ГЛОБАЛЬНУЮ ССЫЛКУ ПРИЛОЖЕНИЯ ???
 N GS S GS=$$GETMP^%ZAPM.ed.BSCp($P($G(%KEY("BSUSER")),",",3),Grand) I $$Data^%ZAPM.ed.BSF12(GS) Q GS
 Q ""
ADMIN() ;ПОЛЬЗОВАТЕЛЬ - АДМИНИСТРАТОР ?
 N GS
 I $G(NameUS)'="" S GS=$$APPVAL I GS'="",$D(@GS@("-3")) Q 1
 Q 0
VAR ;СОЗДАНИЕ НУЖНЫХ ПЕРЕМЕННЫХ
 S GREEN="<font color=Green>",RED="<font color=Red>",BLUE="<font color=Blue>",MAROON="<font color=Maroon>",GOLD="<font color=GOLD>",AQUA="<font color=AQUA>"
 S AF="<font size=1 face='Arial, Helvetica, MS Sans Serif'>"
 S (BK,CRLF)=$C(13,10),EF="</font>",(BBK,BR)="<br>"_BK
 s $P(%BS(44),",",1)=$$GETOPT^%ZAPM.ed.BSC4cfgP("^%ZAPM.ed.BSETUP(""ISS"")","Aevlog")
 s $P(%BS(44),",",2)=$$GETOPT^%ZAPM.ed.BSC4cfgP("^%ZAPM.ed.BSETUP(""ISS"")","Aevlogmail")
 s $P(%BS(44),",",3)=$$GETOPT^%ZAPM.ed.BSC4cfgP("^%ZAPM.ed.BSETUP(""ISS"")","Aevlog1")
 Q
%(S) ;ТРАНСЛЯЦИЯ СТРОКИ //&nbsp;
 S S=$TR(S,"~|","%"_$C(34))
 I S["%20" S S=$$TR^%ZAPM.ed.BSsFUNM(S,"%20"," ")
 Q S
%T(S) ;ТРАНСЛЯЦИЯ СТРОКИ
 I S[" " S S=$$TR^%ZAPM.ed.BSsFUNM(S," ","%20")
 Q $TR(S,"%"_$C(34),"~|")
IMG I $G(%KEY("BSONLY")) W "<P><IMG "_$$0(5)_"></P>"_CRLF Q
 W "<P><A HREF="""_$$A()_$$NS()_"BSROU="_$G(MainRef,"MAIN^~BSCh1")_"""><IMG "_$$0(5)_"></A></P>"_CRLF
 Q
0(N) ;НОМЕР ПАРАМЕТРА ИЗ ^%ZAPM.ed.BSC("HTML"_?,N)
 I $G(NuMHtml)'="" S N=N+$S(NuMHtml=1:8,NuMHtml=2:12,NuMHtml=3:16,NuMHtml=4:20,1:1)-2
 I $D(MainTabl),$$Data^%ZAPM.ed.BSF12(MainTabl) Q $P($G(@MainTabl@(N,2)),"@",15)
 Q "" ;```$P($G(^%ZAPM.ed.BSETUP("HTML",N,2)),"@",15)
BACK ;ЯКОРЬ НАЗАД
 N A I $G(BSDOMAIN)'="" S A=" src='"_BSDOMAIN_"/img/back.gif' "
 E  S A=$$0(33) 
 I A="" S A="Назад"
 E  S A="<IMG "_A_" border=0 align=""bottom"">"
 W "<A HREF=""javascript:history.back(1)"">Возврат&nbsp;"_A_"</A>"_CRLF
 Q
CRT(T) ;ЗАГОТОВКА ТАБЛИЦЫ
 N CRLF
 S CRLF=$C(13,10)
 W "<TABLE BORDER>",CRLF
 W "<CAPTION><B><H3>",$G(T),"</H3></B></CAPTION>",CRLF
 Q
ENT W "</TABLE><HR>",$C(13,10)
 Q
FORMN(nA) ;НАЧАЛЬНЫЙ ТЕГ ФОРМЫ С ИМЕНЕМ
FORM ;НАЧАЛЬНЫЙ ТЕГ ФОРМЫ
 w "<form action="""_%KEY("MGWLIB")_"""" d  w " method=""POST"">",$G(BK)
 .i $d(nA) W " name="""_nA_""""
 ;I $G(%KEY("MGWLPN"))'="" w "<input type=""hidden"" name=""MGWLPN"" value="""_%KEY("MGWLPN")_""">",$G(BK)
 ;I $G(%KEY("MGWCHD"))'="" w "<input type=""hidden"" name=""MGWCHD"" value="""_%KEY("MGWCHD")_""">",$G(BK)
 ;I $G(%KEY("MGWAPP"))'="" w "<input type=""hidden"" name=""MGWAPP"" value="""_$G(%KEY("MGWAPP"))_"""></P>",$G(BK)
 I $G(%KEY("BSG"))'="" w "<input type=""hidden"" name=""BSG"" value="""_$G(%KEY("BSG"))_"""></P>",$G(BK)
 w "<input type=""hidden"" name=""BSUSER"" value="""_$G(%KEY("BSUSER"),"GUEST")_""">",$G(BK)
 Q
BK() Q $C(13,10)
Er(S) ;СООБЩЕНИЕ ОБ ОШИБКЕ
 D CRP(S,4,2),END(7)
 Q
Ok(S) ;СООБЩЕНИЕ
 D CRP(S,4,1),END(7)
 Q
JavaComm W "<!--",BK
 W BK,"// -->",BK Q
JavaS(NU) I $$0(NU)="" Q  ;ЕСЛИ НЕТ ДЖАВЫ-SCRIPT
 W BK,"<SCRIPT LANGUAGE=""JavaScript"" SRC="""_$$0^%ZAPM.ed.BSCh(NU)_""">",BK
 W "</SCRIPT>",BK Q
CRP(SaY,V,NuMHtml)  ;ЗАГОТОВКА СТАНДАРТНОЙ СТРАНИЦЫ
 N CRLF ; NuMHtml=1 OK 2-ER 3-? 4-!
 S CRLF=$C(13,10)
 W "<HTML>",CRLF I $G(%KEY("BSCAPTION"))'="" S SaY=%KEY("BSCAPTION")
 W "<HEAD><TITLE>"_$$0(2)_" "_$G(SaY)_"</TITLE>"
 W "</HEAD>",CRLF
 W "<BODY "_$$0(3)_">",CRLF
 W "<P>"
 D IMG
 I $G(V)'="" D
 .I +$G(V) W $$0(4)
 .E  W V
 W "</P>",CRLF
 W "<HR>"
 I $G(SaY)'="" W "<H2>"_$G(SaY)_"</H2>",CRLF
 Q
END(T) ;ЗАВЕРШЕНИЕ СТРАНИЦЫ
 I $G(%KEY("BSONLY")) G ENDe
 I $G(T)'="" D
 .I +$G(T) W "<H6>",$$0(T),"</H6>"
 .E  W "<H6>",$$MAIL(T),"</H6>"
ENDe W "<H6>%BS versions ",$G(^%ZAPM.ed.BS),",  ID proc=",$J,", Service=",$G(%KEY("MGWLPN")) I '$G(%KEY("BSONLY")) W ", NS=",BLUE,$$ZU^%ZAPM.ed.BS3(0),EF,", Storage=",$S,", UseDevice=",$I
 W "<br>",$zv," ",BLUE,$ZU(110),EF,"</H6>"
END2 W "</BODY>",BK
 W "</HTML>",BK
 Q
KILLJOB ;W "<a href="""_$$A()_$$NS()_"MGWCDN="_$G(%KEY("MGWCHD"))_"&BSROU=TERMIN^~BSCh1""><IMG "_$$0(6)_">Полностью Завершить Работу</a>"
 ;W "<P>"          _"&MGWCHD="_$G(%KEY("MGWCHD"))_"&"
 ;D FORM
 ;w "<input type=""hidden"" name=""MGWCTO"" value=""5"">"
 ;w "<input type=""hidden"" name=""BSROU"" value=""TERMIN^~BSCh1"">"
 ;w "<input type=""SUBMIT"" name=""B1"" value=""Полностью Завершить Работу"">"
 ;W "</P>"
 Q
MAIL(T) Q "<a href="""_$$A()_$$NS()_"BSROU="_$G(MainRef,"MAIN^~BSCh1")_"&BSLABEL=MAIL^~BSCh1"">"_T_"</a>"
NS() Q "BSNSPACE="_$$%T($G(%KEY("BSNSPACE"),"~SYS"))_"&"
A() N A S A="Z=A"
 ;I $G(%KEY("MGWLPN"))'="" S A=A_"&MGWLPN="_$G(%KEY("MGWLPN"))
 ;I $G(%KEY("MGWCHD"))'="" S A=A_"&MGWCHD="_$G(%KEY("MGWCHD"))
 ;I $G(%KEY("MGWAPP"))'="" S A=A_"&MGWAPP="_$G(%KEY("MGWAPP"))
 I $G(%KEY("BSONLY"))'="" S A=A_"&BSONLY="_%KEY("BSONLY")
 I $G(%KEY("BSG"))'="" S A=A_"&BSG="_$G(%KEY("BSG"))
 ;Q "http://"_$G(%CGIEVAR("SERVER_NAME"))_$G(%KEY("MGWLIB"))_"?"_A_"&BSUSER="_$G(%KEY("BSUSER"),"GUEST")_"&"
 Q $$ADDLIB^%ZAPM.ed.BSC4()_A_"&BSUSER="_$G(%KEY("BSUSER"),"GUEST")_"&"
ONLY() I $G(%KEY("BSONLY")) Q "&BSONLY="_%KEY("BSONLY")
 Q ""
WebServer() q "http://"_$G(%CGIEVAR("SERVER_NAME"))
3(A1,T1,A2,T2,A3,T3,A4,A5) ;ТРИ+1+1 ССЫЛКИ
 W "<table border=""0"" width=""100%"">"
 W "<tr>"
 I $G(A4)'="" W "<td width=""25%""><p align=""center"">",A4,"</td>"
 W "<td width=""25%""><p align=""center"">" I $G(A1)'="" W "<a href="""_$$A()_$$NS()_A1_""">"_T1_"</a></td>"
 W "<td width=""25%""><p align=""center"">" I $G(A2)'="" W "<a href="""_$$A()_$$NS()_A2_""">"_T2_"</a></td>"
 W "<td width=""25%""><p align=""center"">" I $G(A3)'="" W "<a href="""_$$A()_$$NS()_A3_""">"_T3_"</a></td>"
 I $G(A5)'="" W "<td width=""25%""><p align=""center"">",A5,"</td>"
 W "</tr>"
 W "</table>"
 Q
WHO ;КТО ЭТО
 Q:$G(NameUS)=""
 W "<P>Вы вошли в систему под именем: <FONT COLOR=RED>",NameUS W " (",$$TRAN($$FullName^%ZAPM.ed.BSCp(NameUS)),")</FONT>"
 W "<BR> Текущая Рабочая Область <FONT COLOR=RED>",$$ZU^%ZAPM.ed.BS3(0),"</FONT>"
 ;I $G(@%BS(18)@(NameUS,0,"9,4"))'="" S i=@$ZR W "<BR> Рабочая группа пользователей <FONT COLOR=RED>",i,"</FONT>"
 I $$ADMIN() W "<BR>ВЫ ИМЕЕТЕ ПРАВА АДМИНИСТРАТОРА." D
 .W "<a href="""_$$A()_$$NS()_"BSROU="_$G(MainRef,"MAIN^~BSCh1")_"&BSLABEL=EDIT^~BSChT1&BSTABL=MAIL&BSPART=^~BSC"" TITLE='база данных сообщений'> Messages |</a>"
 .W "<a href="""_$$A()_$$NS()_"BSROU="_$G(MainRef,"MAIN^~BSCh1")_"&BSLABEL=EDIT^~BSChT1&BSTABL=PROTECT&BSPART=^~BSC"" TITLE='база данных пользователей'> Users |</a>"
 .W "<a href="""_$$A()_$$NS()_"BSROU="_$G(MainRef,"MAIN^~BSCh1")_"&BSLABEL=EDIT^~BSChT1&BSTABL=GRAND&BSPART=^~BSC"" TITLE='база данных прав доступа'> Grand |</a>"
 .W "<a href="""_$$A()_$$NS()_"BSROU="_$G(MainRef,"MAIN^~BSCh1")_"&BSLABEL=EDIT^~BSChT1&BSTABL=TRM&BSPART=^~BSVOL"" TITLE='база данных терминалов'> Trm |</a>"
 .W "<a href="""_$$A()_$$NS()_"BSROU="_$G(MainRef,"MAIN^~BSCh1")_"&BSLABEL=EDIT^~BSChT1&BSTABL=VISIT&BSPART=^~BSC"" TITLE='база данных визитов'> Visits |</a>"
 .W "<a href="""_$$A()_$$NS()_"BSROU="_$G(MainRef,"MAIN^~BSCh1")_"&BSLABEL=OPTION^~BSChA"" TITLE='редактировать основные параметры'> Option |</a>"
 .W "<a href="""_$$A()_$$NS()_"BSROU="_$G(MainRef,"MAIN^~BSCh1")_"&BSLABEL=NETOPT^~BSChA"" TITLE='редактировать сетевые параметры'> NetOpt |</a>"
 w "</P><HR>"
I Q
TRAN(S) ;ТРАНСЛЯЦИЯ
 I $$IFDOS(S) N S1,S2 Q $$ANSI^%ZAPM.ed.BSre(S)
 Q S
IFDOS(S) ;ПРОВЕРКА КОДИРОВКИ
 I $TR(S,$C(128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175),"")'=S Q 1
 Q 0
 ;********************************************************************************
 ;  ПРОГРАММНЫЕ МОДУЛИ ВИЗИТОВ
 ;  P="P" попыток ,"R" регистаций ,"E" ошибок "Q" запросов к бд
 ;
TOBD() N TB,BD S TB=$S($G(APP)="":$$0^%ZAPM.ed.BSCh(25),1:"^%ZAPM.ed.BSC(""VISIT"")")
 S BD=$$KBD^%ZAPM.ed.BSF12(TB) I '$$Data^%ZAPM.ed.BSF12(BD) Q ""
 I '$D(CurUS) S CurUS=$$ADDRIP^%ZAPM.ed.BSC4
 Q BD
GetUsersVisit(P,APP) ;КОЛИЧЕСТВО ВИЗИТОВ ПОЛЬЗОВАТЕЛЕЙ С ТЕКУЩЕГО АДРЕСА
 S BD=$$TOBD I BD="" Q 0
 I $G(APP)'="" Q $G(@BD@("USERS",APP,CurUS,P))
 Q +$G(@BD@("USERS",CurUS,P))
GetAllVisit(P,APP) ;КОЛИЧЕСТВО ВСЕГО ВИЗИТОВ СО ВСЕХ АДРЕСОВ
 S BD=$$TOBD I BD="" Q 0
 I $G(APP)'="" Q $G(@BD@("ALL",APP,"ALLIP",P))
 Q +$G(@BD@("ALL","ALL",P))
ADDVISIT(P,APP) ;ВИЗИТ  P="P","R","E","Q"
 D MAINVAR^%ZAPM.ed.BSC4
 D Tex^%ZAPM.ed.BSMSMF("APP="_$G(APP)_" VISIT:"_P,$G(U)_","_$G(BSR)_","_$G(BST)_","_$G(EDIT)_","_$G(MODE)_","_$G(BSLOGIN)_","_$G(BSSES))
 Q
 /*N U1
 S BD=$$TOBD I BD="" Q
 S U1=$P($$h^%ZAPM.ed.BS3,",")
 S Time1=+$P($ZT($P($H,",",2),1),":")
 I $G(APP)'="" D  Q
 .S @BD@(U1,APP,CurUS,Time1,P)=$G(@BD@(U1,APP,CurUS,Time1,P))+1
 .S @BD@(U1,APP,CurUS,P)=$G(@BD@(U1,APP,CurUS,P))+1
 .S @BD@("USERS",APP,CurUS,P)=$G(@BD@("USERS",APP,CurUS,P))+1
 .S @BD@("USERS","ALLAPP",CurUS,P)=$G(@BD@("USERS","ALLAPP",CurUS,P))+1
 .S @BD@("ALL",APP,"ALLIP",P)=$G(@BD@("ALL",APP,"ALLIP",P))+1
 .S @BD@("ALL","ALLAPP","ALLIP",P)=$G(@BD@("ALL","ALLAPP","ALLIP",P))+1
 S @BD@(U1,CurUS,Time1,P)=$G(@BD@(U1,CurUS,Time1,P))+1
 S @BD@(U1,CurUS,P)=$G(@BD@(U1,CurUS,P))+1
 S @BD@("USERS",CurUS,P)=$G(@BD@("USERS",CurUS,P))+1
 S @BD@("ALL","ALL",P)=$G(@BD@("ALL","ALL",P))+1
 Q  */
ShowVisit(APP) Q
 /*W "<h5 align=""left""><font face=""Times New Roman"">Обращений к модулю :"
 W "&nbsp;&nbsp;Всего = "_$$GetAllVisit("Q",APP)_","
 W "&nbsp;&nbsp;"_"с данного компьютера ="_$$GetUsersVisit("Q",APP)_"</font></h5>",$c(13,10)
 Q  */
StatVisit(APP) ;СТАТИСТИКА
 S BD=$$TOBD I BD="" Q
 w BK,"<table border=""1"">",BK
 w "<tr>",BK
   w "<td>Статистика для текущего приложения '"_APP_"'</TD>"
   w "<td align=""center""><strong>Входов</strong></td>",BK
   w "<td align=""center""><strong>Регистраций</strong></td>",BK
   w "<td align=""center""><strong>Запросов в Базе Данных</strong></td>",BK
   w "<td align=""center""><strong>Ошибок</strong></td>",BK
 w "</tr>"
 w "<tr>"
   w "<td align=""right""><strong>с IP-адреса "_$g(CurUS)_"</strong></td>",BK
   w "<td>"_+$g(@BD@("USERS",APP,CurUS,"P"))_"</td>",BK
   w "<td>"_+$g(@BD@("USERS",APP,CurUS,"R"))_"</td>",BK
   w "<td>"_+$g(@BD@("USERS",APP,CurUS,"Q"))_"</td>",BK
   w "<td>"_+$g(@BD@("USERS",APP,CurUS,"E"))_"</td>",BK
 w "</tr>"
 w "<tr>"
   w "<td align=""right""><strong>Всего</strong></td>",BK
   w "<td>"_+$g(@BD@("ALL",APP,"ALLIP","P"))_"</td>",BK
   w "<td>"_+$g(@BD@("ALL",APP,"ALLIP","R"))_"</td>",BK
   w "<td>"_+$g(@BD@("ALL",APP,"ALLIP","Q"))_"</td>",BK
   w "<td>"_+$g(@BD@("ALL",APP,"ALLIP","E"))_"</td>",BK
 w "</tr>"
  w "</table>",BK
 Q
 ;********************************************************************************
]]></Routine>


<Routine name="%ZAPM.ed.BSCh0" type="MAC" languagemode="0"><![CDATA[
%BSCh0 ;HTML; 12:48   05.01.00 ; 13:27   04.01.2002
 ;
 ; Copyright (C) Serge W. Mikhaylenko
 ; All Rights Reserved
 ;
TESTING D TEST("Тестирование ...") Q
VARTEST D TEST("Показать Локальные Переменные","") Q
BSG(bsg) ;ДИСПЕТЧЕР ПРОГРАММ %BS+++CACHE WEB-LINK
 s $zt="ErrBSG^%ZAPM.ed.BSCh0"
 S bsd=$$KBD^%ZAPM.ed.BSF12("^%ZAPM.ed.BSC(""BSG"")")
 I bsd="" W $$CRP("БАЗА ДАННЫХ ССЫЛКИ '"_bsg_"' НЕ ОПРЕДЕЛЕНА !") Q
 I '$D(@bsd@(bsg)) W $$CRP("ССЫЛКА '"_bsg_"' ПУСТАЯ !") Q
 S BSROU=$G(@bsd@(bsg,"ROU")),NSPACE=$G(@bsd@(bsg,"NSP")) ;,ROU=$P(BSROU,"^",2) /////
 I $G(MGWLIB)["mgwms32.dll" I $G(@bsd@(bsg,"MGWSTO")) S MGWSTO=+@$ZR I MGWSTO<120 S MGWSTO=120
 I $G(@bsd@(bsg,"BSdebug"))'="" S BSdebug=@$ZR //ОТЛАДЧИК ВКЛЮЧЕН
 I $G(NSPACE)'="",'$$ZU^%ZAPM.ed.BSF4(NSPACE) W $$CRP("Нет NameSpace='"_NSPACE_"' !") Q
 I '$$EXIST^%R($P(BSROU,"^",2)_".INT") W $$CRP("В NameSpace='"_$zu(5)_"' НЕТ ПРОГРАММЫ '^"_BSROU_"' !") Q
 S %KEY("BSNSPACE")=NSPACE,%KEY("BSROU")=BSROU
 D @BSROU
 Q
CRP(S) Q "<H2>"_S_"</H2>"
ErrHEAD ;ЗАГОЛОВОК
 S ErrorCount=$G(ErrorCount)+1 I ErrorCount>10 H  //Если зацикливание...
 w $c(13,10)," <STYLE TYPE=""text/css"">",$c(13,10)
 w "  DIV {color:black; }",$c(13,10)
 w "  .expandedVAR {color:black; }",$c(13,10)
 w "  .collapsedVAR {display:none}",$c(13,10)
 w " </STYLE>",$c(13,10)
 w " <SCRIPT LANGUAGE=""JavaScript"">",$c(13,10)
 w "  function outlinerVAR() {",$c(13,10)
 w "      var child =",$c(13,10)
 w "        document.all[event.srcElement.getAttribute(""child"",",$c(13,10)
 w "           false)];",$c(13,10)
 w "     if (null != child) ",$c(13,10)
 w "        child.className = child.className == ""collapsedVAR"" ?",$c(13,10)
 w "           ""expandedVAR"" : ""collapsedVAR"";",$c(13,10)
 w "  }",$c(13,10)
 w " </SCRIPT>",$c(13,10)
 W $$meta^%ZAPM.ed.BSC4,$c(13,10)
 Q
ErrTxt(ZE) Q "<STRONG><FONT TITLE='"_$$ErrSay^%ZAPM.ed.BSF8(ZE)_"' COLOR=RED>"_$$TRa(ZE)_"</FONT></STRONG>"
ErrBSG I $ZE["<WRITE" Q
 S CRLF=$C(13,10) D ErrHEAD
 W "<TABLE><TR><TD>ОШИБКА:</TD><TD>"_$$ErrTxt($ZE)_"</TD></TR>"
 D Tex^%ZAPM.ed.BSMSMF("Error Web="_$ze,$G(bsg,"?")_","_$G(BSROU)_","_$ZN_","_$ZU(5)_","_$G(%KEY("MGWLPN"),"?")_","_$s_","_$G(BSSES))
 W "<TR><TD>WEBLINK ПРИЛОЖЕНИЕ:</TD><TD>",$G(bsg,"?"),"</TD></TR>"
 W "<TR><TD>ВЫЗЫВАЕМАЯ ПРОГРАММА:</TD><TD>",$G(BSLABEL,"?"),"</TD></TR>"
 W "<TR><TD>ВЫЗЫВАЮЩАЯ ПРОГРАММА:</TD><TD>",$ZN,"</TD></TR>"
 W "<TR><TD>РАБОЧАЯ ОБЛАСТЬ:</TD><TD>",$ZU(5),"</TD></TR>"
 W "<TR><TD>ID ПРОЦЕССА:</TD><TD>",$J,"</TD></TR>"
 W "<TR><TD>ИМЯ СЕРВИСА:</TD><TD>",$G(%KEY("MGWLPN"),"?"),"</TD></TR>"
 W "<TR><TD>РАЗМЕР РАЗДЕЛА</TD><TD>",$S,"</TD></TR></TABLE>"
 D LOCLIST(1)
 Q
RUN ;ДИСПЕТЧЕР ПРОГРАММ %BS+CACHE WEB-LINK
 N ROU,RO,OldNS,NSPACE
 s $zt="ErrBSG^%ZAPM.ed.BSCh0" 
 S ROU=$$%^%ZAPM.ed.BSCh(%KEY("BSROU")),RO=$P(ROU,"^",2)
 I $D(%KEY("BSNSPACE")) S NSPACE=$$%^%ZAPM.ed.BSCh(%KEY("BSNSPACE"))
 s OldNS=$zu(5)
 I $G(NSPACE)'="",$zu(5,NSPACE)
 D
 .I '$D(^ROUTINE(RO)) W "В NSP='"_$zu(5)_"' НЕТ ПРОГРАММЫ '"_ROU_"' !" Q
 .D @ROU
 s OldNS=$zu(5,OldNS)
 Q
TRQ(S) ;ТРАНСЛИРОВАТЬ ""
 Q $$TR^%ZAPM.ed.BSsFUNM(S,$C(34),"&quot;")
TRa(S) ;ТРАНСЛИРОВАТЬ <>
 S S=$$TR^%ZAPM.ed.BSsFUNM(S,"<","&lt;")
 Q $$TR^%ZAPM.ed.BSsFUNM(S,">","&gt;")
Err I $ZE["<WRITE" Q
 W RED_$$TRa($ZE)_EF,$C(13,10)
 D TEST("Error Executing ! "_$ZT,$ze)
 Q
ERRSEND ;ПОСЫЛКА ОШИБКИ АДМИНИСТРАТОРУ
 N BD,U1,U2,U3,NuMHtml,CurUS
 D MAINVAR^%ZAPM.ed.BSCh1
 S BD=$$KBD^%ZAPM.ed.BSF12($$0^%ZAPM.ed.BSCh(24)) I '$$Data^%ZAPM.ed.BSF12(BD) Q
 S U1=$P($$h^%ZAPM.ed.BS3,","),U2=$P($$h^%ZAPM.ed.BS3,",",2)
 S @BD@(U1,CurUS,U2,"B")=$G(ErR)
 S @BD@(U1,CurUS,U2,"U")=$G(%BS(CurUS))
 S @BD@(U1,CurUS,U2,"T")="<ERROR>"
 S @BD@(U1,CurUS,U2,"A")=4
 Q
TEST(SaY,ErR) ; Simple test page
 D MAINVAR^%ZAPM.ed.BSCh1
 D CRP^%ZAPM.ed.BSCh(SaY,"<H3>Тестовая страница</H3>",4)
 D VAR^%ZAPM.ed.BSCh D ErrHEAD
 I $D(ErR) W RED_$$TRa(ErR)_EF D ERRSEND
 W "<HR>"
 W "НОМЕР ЗАДАНИЯ $J=",RED,$J,EF," НА М-СЕРВЕРЕ=",RED,$G(%KEY("MGWLPN")),EF," ТЕКУЩАЯ NameSpace=",RED,$zu(5),EF,BR,BK
 W "ТЕКУЩЕЕ УСТРОЙСТВО $I=",RED,$I,EF," В РАЗДЕЛЕ $S=",RED,$S,EF," БАЙТ",BK
 W " ВЫЗЫВАЕМАЯ ПРОГРАММА :",RED,$G(BSROU,"?"),$C(13,10),EF
 W " ВЫЗЫВЮЩАЯ ПРОГРАММА :",RED,$ZN,$C(13,10),EF
 I $D(ErR) G TEST2
 I '$D(CurUS)!('$D(%BS(CurUS)))!('$D(%BS(18)))!('$D(%BS(CurUS))) G TEST1
 I '$$ADMIN^%ZAPM.ed.BSCh G TEST1
TEST2 D LOCLIST(0)
 W "<H5 child='LOC2' onclick=""outlinerVAR();"">ПЕРЕМЕННЫЕ (%KEY(Node)=Value)</H5>",CRLF
 W "<DIV ID='LOC2' CLASS='collapsedVAR'>",CRLF
 W "<TABLE BORDER>",CRLF
 W "<TR><TH>Node</TH><TH>Value</TH></TR>",CRLF
 S KEY=""  F  S KEY=$O(%KEY(KEY)) Q:KEY=""  W "<TR><TD>",KEY,"</TD><TD>",$G(%KEY(KEY)),"</TD></TR>",CRLF
 W "</TABLE></DIV>",CRLF
 
 W "<H5 child='LOC3' ONCLICK=""outlinerVAR();"">ПЕРЕМЕННЫЕ CGI ОКРУЖЕНИЯ (%CGIEVAR(Node)=Value)</H5>",CRLF
 W "<DIV ID='LOC3' CLASS='collapsedVAR'>",CRLF
 W "<TABLE BORDER>",CRLF
 W "<TR><TH>Node</TH><TH>Value</TH></TR>",CRLF
 S KEY=""  F  S KEY=$O(%CGIEVAR(KEY)) Q:KEY=""  W "<TR><TD>",KEY,"</TD><TD>",%CGIEVAR(KEY),"</TD></TR>",CRLF
 W "</TABLE></DIV>",CRLF
 
 W "<H5 child='LOC4' ONCLICK=""outlinerVAR();"">ПЕРЕМЕННЫЕ CGI ОКРУЖЕНИЯ (%CGI(Node)=Value)</H5>",CRLF
 W "<DIV ID='LOC4' CLASS='collapsedVAR'>",CRLF
 W "<TABLE BORDER>",CRLF
 W "<TR><TH>Node</TH><TH>Value</TH></TR>",CRLF
 S KEY=""  F  S KEY=$O(%CGI(KEY)) Q:KEY=""  W "<TR><TD>",KEY,"</TD><TD>",%CGI(KEY),"</TD></TR>",CRLF
 W "</TABLE></DIV>",CRLF
 
 W "<H5 child='LOC5' ONCLICK=""outlinerVAR();"">ПЕРЕМЕННЫЕ TP-WEB-LINK ОКРУЖЕНИЯ (%ZCS(Node)=Value)</H5>",CRLF
 W "<DIV ID='LOC5' CLASS='collapsedVAR'>",CRLF
 W "<TABLE BORDER>",CRLF
 W "<TR><TH>Node</TH><TH>Value</TH></TR>",CRLF
 S KEY=""  F  S KEY=$O(%ZCS(KEY)) Q:KEY=""  W "<TR><TD>",KEY,"</TD><TD>",%ZCS(KEY),"</TD></TR>",CRLF
 W "</TABLE></DIV>",CRLF
TEST1
 ;D RETURN("")
 D END^%ZAPM.ed.BSCh("")
 Q
HREFVAR(S) Q "<a href="""_$$A^%ZAPM.ed.BSCh()_"BSROU=VARTEST^~BSCh0"">"_S_"</a>"
RETURN(RETURN,CLOSE) I $G(%KEY("BSONLY")) Q
 W "<HR>",BK
 D 3^%ZAPM.ed.BSCh("BSROU="_$G(MainRef,"MAIN^~BSCh1"),"Вернуться в Главное Меню","BSROU=MAIN0^~BSCh1","Заново Регистрироваться","BSROU=MAIL^~BSCh1","Сообщения",$G(RETURN),$G(CLOSE))
 Q
LOCLIST(Tmp) ;ВЫВЕСТИ СПИСОК ЛОКАЛЬНЫХ ПЕРЕМЕННЫХ
 W "<A child='LOC11' style='color:blue; text-decoration:underline; cursor:hand;' onclick=""outlinerVAR();"" title='смотреть переменные, определенные на момент возникновения прерывания'>Current Local Variables</A>",CRLF
 W "<DIV ID='LOC11' CLASS='collapsedVAR'>",CRLF
 D locvar("",1)
 W "</DIV>",CRLF
 Q
locvar(%zz4,Tmp) W "<style type=""text/css"">"_CRLF
 W ".X1 {BACKGROUND:#FFFFB7; COLOR:BLACK; font-size: xx-small; font-family :FixedSys, Courier New, Courier; }"_CRLF
 W ".X0 {BACKGROUND:#FFFF37; COLOR:BLACK; font-size: xx-small; font-family :FixedSys, Courier New, Courier; }"_CRLF
 W "}</style>"_CRLF
 W "<TABLE BORDER=0 WIDTH=100%>",CRLF
 W "<TR><TD class=X0 style='font-weight: bold'>Name Variable</TD><TD class=X0 style='font-weight: bold'>Data Variable</TD></TR>",CRLF
 N %zz1,%zz0,%zz2,%zz3,%zz5,%zz6
 S %zz5="",%zz1="",%zz1=$O(@%zz1),%zz6=0 I '$D(Tmp) S Tmp=0
 S %zz0=0,%zz4=","_%zz4_"," F  Q:%zz1=""  D:%zz1'["%zz"  S %zz1=$O(@%zz1)
 .I "11"[$D(@%zz1) D LOCVAR(%zz1)
 .I $D(@%zz1)>9 S %zz3=%zz1 F  S %zz3=$Q(@%zz3) Q:%zz3=""  D LOCVAR(%zz3)
 W "</TABLE>"
 Q
LOCVAR(%z) I '$G(Tmp) I %z["%CGI"!(%z["%KEY")!(%z["%ZCS")!(%z["%CGIEVAR") Q
 I %zz4'=",,",%zz4'[(","_$QS(%z,0)_",") Q
 I %zz5'=$QS(%z,0) S %zz5=$QS(%z,0),%zz6=%zz6=0
 W "<TR><TD class=X"_%zz6_">",$G(%z),"</TD><TD class=X"_%zz6_">",$G(@%z),"</TD></TR>",$G(CRLF)
 Q
INTXT ;ВВОД ТЕКСТА В ГЛОБАЛ
 N L,dev,%ANS,IO,IOBS,IOF,IOM,IOPAR,IOSL,IOST,IOT,MSYS,POP,GLO,RMSDF,gui
1 W !,"ВВОД ПОЛНЫЙ ПУТЬ К ДОС-ФАЙЛУ:",! D IN^%IS Q:POP
 I IO=$I W !,"УСТРОЙСТВО ВВОДА НЕ ОПРЕДЕЛЕНО" G 1
 W !,"ВВЕДИТЕ ПОЛНУЮ ГЛОБАЛЬНУЮ ССЫЛКУ ^%ZAPM.ed.BSCh(""HTML"","""_$P($P(IO,"\",$L(IO,"\")),".")_""")" R GLO
 I GLO="" S GLO="^%ZAPM.ed.BSCh(""HTML"","""_$P($P(IO,"\",$L(IO,"\")),".")_""")"
 s dev=IO_":"_IOPAR I GLO'["^" S GLO="^"_GLO
 s gui=0
 S $ZT="ERRF^%ZAPM.ed.BSCh0"
 K @GLO
 F L=1:1 U IO R @GLO@(L)
EXIT C IO Q
ERRF I $ze["ENDOFILE"!($ze["ENDOFFILE") G EXIT
 W !,$ZE,*7 G EXIT
RGR ;ВВОД МАССИВОВ И ПРОГРАММ
 N L,dev,%ANS,IO,IOBS,IOF,IOM,IOPAR,IOSL,IOST,IOT,MSYS,POP,GLO,RMSDF,gui,NS,S,V,SS,NS1,OWER
RG W !,"ВВОД ПОЛНЫЙ ПУТЬ К ДОС-ФАЙЛУ:",! D IN^%IS Q:POP
 I IO=$I W !,"УСТРОЙСТВО ВВОДА НЕ ОПРЕДЕЛЕНО" G RG
 S NS=$E($P($P(IO,"\",$L(IO,"\")),"."),6,8) I NS="" S NS="USER"
 W !,"КУДА ВОССТАНАВЛИВАТЬ ? <",NS,"> " R NS1 I NS1="" S NS1=NS
 S $ZT="ERRGR^%ZAPM.ed.BSCh0"
 S NS=$$ZU^%ZAPM.ed.BS3(0)
 I NS1'="" I '$$ZU^%ZAPM.ed.BSF4(NS1) D ErrMsg^%ZAPM.ed.BSXfun("НЕ МОЖЕМ ТУДА ПЕРЕЙТИ !") Q
 I $D(%BS)["0" D CLr^%ZAPM.ed.BSF4
 D Yes^%ZAPM.ed.BSXfun("УЖЕ СУЩЕСТВУЮЩИЕ МАССИВЫ УДАЛЯЕМ ?") S OWER='(YES<0)
 s dev=IO_":"_IOPAR
 s gui=0
 U IO R S U 0 W !,"МАССИВЫ :",S,!
 U IO R S U 0 W !,"ПРОГРАММЫ :",S,!!
 S SS="" F  U IO R S,V D  I S="**" U IO R S,V Q
 .I S="*" S SS="" Q
 .I S="**" Q
 .I S="" Q
 .I SS="" S SS=$QS(S,0) U 0 W SS," " I OWER K @SS
 .S @S=V
 S S="F L=0:1 Q:'$D(V(L))  ZI V(L):+L"
 U 0 W !
 F  U IO R NM Q:NM=""  D
 .S NM=$P(NM,".") K V
 .F L=0:1 U IO R V(L) I V(L)="" K V(L) Q
 .S $ZT="ERROU^%ZAPM.ed.BSCh0"
 .X "ZR  X S ZS @NM U 0 W NM,"" """
RGEX U 0 W !,"ЗАВЕРШЕНО УСПЕШНО..."
RGEXIT C IO I $G(NS)'="" I '$$ZU^%ZAPM.ed.BSF4(NS) D ErrMsg^%ZAPM.ed.BSXfun("НЕ МОЖЕМ ВЕРНУТЬСЯ") Q
 Q
ERRGR U 0 I $ze["ENDOFILE"!($ze["ENDOFFILE") G RGEX
 W !,$ZE,*7 G RGEXIT
ERROU U 0 W !,NM," <--- ",$ZE,*7,! Q
]]></Routine>


<Routine name="%ZAPM.ed.BSCh1" type="MAC" languagemode="0"><![CDATA[
%BSCh1 ; пpогpамма %BS+Cache TP\Web-Link ; 13:38   12.09.2002
 ;
 ; Copyright (c) Serge W. Mikhaylenko
 ; All Rights Reserved
 ;
 ;!!!!!УСТАРЕЛАЯ ПРОГРАММА
 q
MAINVAR ;ОСНОВНЫЕ ПЕРЕМЕННЫЕ
 ;I '$D(%BS(1)) D %BS1^%ZAPM.ed.BSF4
 I '$D(GREEN) D VAR^%ZAPM.ed.BSCh
 S Grand="NAV" ;ИМЯ ГРАНДА ПРИЛОЖЕНИЯ
 S MainRef="MAIN^~BSCh1" ;ОСНОВНОЙ ВХОД <---------------------
 S MainTabl="^%ZAPM.ed.BSC(""HTML"")" ;ТАБЛИЦА ОСНОВНЫХ ПАРАМЕТРОВ
 S MainOpt="^%ZAPM.ed.BSETUP(""OPTION"")" ;ТАБЛИЦА ОСНОВНЫХ опций
 S CurUS=$$ADDRIP^%ZAPM.ed.BSC4
 S NameUS=$P($G(%KEY("BSUSER"),"?"),",") ;NAME
 Q
MAIN ;ОСНОВНОЙ ВХОД <---------------------
 N CurUS
 D MAINVAR
 ;РЕГИСТРАЦИЯ ОБЯЗАТЕЛЬНА
 I '$$GETOPT^%ZAPM.ed.BSCh2(MainOpt,"REG1") G MAINW
 I $G(%KEY("BSUSER"),"GUEST")="GUEST" D REGIST Q
 I '$$PASS^%ZAPM.ed.BSChh(Grand) D REGIST Q  ;ПРОВЕРКА НА КООРЕКТНОСТЬ ИМЕНИ ПОЛЬЗОВАТЕЛЯ
MAINW ;БЕЗ РЕГИСТРАЦИИ
 S NameUS=$P($G(%KEY("BSUSER"),"?"),",")
 I $G(%KEY("BSLABEL"))="MAIL^~BSCh1" S ROU=$$%^%ZAPM.ed.BSCh(%KEY("BSLABEL")) D @ROU Q
MAINR ;ДАЛЬШЕ
 D MGR^%ZAPM.ed.BS ;ПЕРЕЙТИ В СИСТЕМНУЮ ОБЛАСТЬ
 I $D(%KEY("BSLABEL")) S ROU=$$%^%ZAPM.ed.BSCh(%KEY("BSLABEL")) D @ROU Q
 I $G(%KEY("BSMENU"))=4 G TABL
 I $G(%KEY("BSMENU"))=3 G PART
 I $G(%KEY("BSMENU"))=2 G NSP
 N I,II,NS,P1,P9,BUFG,nI
Ma S (I,nI)=$$NS^%ZAPM.ed.BSCi(Grand,$$APPVAL^%ZAPM.ed.BSCh)
 D CRP^%ZAPM.ed.BSCh("Главное Меню",4)
 D WHO^%ZAPM.ed.BSCh
 W BR,"Рабочие Области Системы: ",BR F II=1:1 Q:$P(nI,$C(1),II,II+1)=""  I $P(nI,$C(1),II)'="" D
 .W "<a title=""перейти в область"" href="""_$$A^%ZAPM.ed.BSCh_"BSMENU=2&BSROU="_$G(MainRef,"MAIN^~BSCh1")_"&BSNSPACE="_$TR($P(nI,$C(1),II),"%","~")_"""> "_$P(nI,$C(1),II)_" |</a>",BK
 W BR,"<HR>"
 K BUFG F I=1:1 S BUFG(I)=$$BUFG^%ZAPM.ed.BSF12(I) I $G(BUFG(I))="" K BUFG(I) Q
 I $D(BUFG) W "Разделы готовых отчетов %BS-Системы:",BR D
 .S I="" F  S I=$O(BUFG(I)) Q:I=""  I BUFG(I)'="",$$Data^%ZAPM.ed.BSF12(BUFG(I)) D
 ..W "<P>- <a title=""зайти в раздел"" href="""_$$A^%ZAPM.ed.BSCh()_$$NS^%ZAPM.ed.BSCh()_"BSMENU=3&BSROU="_$G(MainRef,"MAIN^~BSCh1")_"&BSPART="_$$TAGS^%ZAPM.ed.BSHTML1($$%T^%ZAPM.ed.BSCh(BUFG(I)))_"""> "_$$TAGS^%ZAPM.ed.BSHTML1(BUFG(I))_" </a>"
 ..W $$TRAN^%ZAPM.ed.BSCh($P($G(@BUFG(I),"@Без Комментария"),"@",2)),"</P>",BR
 W "</P>"
 D RETURN^%ZAPM.ed.BSCh0("",$$CLOSE("Закрыть соединение"))
 W "<BR>" D StatVisit^%ZAPM.ed.BSCh("NAV")
 W "<BR><BR><A HREF=""/BS/DEVELOPER.htmL"">" D END^%ZAPM.ed.BSCh("") W "</A>"
 Q
A34(S) I S[$C(34) S S=$$TR^%ZAPM.ed.BSsFUNM(S,$C(34),$C(34,34))
 Q S
TABL ;ДИСПЕТЧЕР ТАБЛИЦ - СТАРЫЙ
 N I,II,NSPACE,GL,P1,P2,P3,P9,PART,TABL,TIP,BSR,BST,CFG,BS,JAVA
 D ADDVISIT^%ZAPM.ed.BSCh("Q","NAV")
 I '$$TABVAR Q
 D TABBEGIN
 i $d(@PART@(TABL,"OPT")) d ENTER^%ZAPM.ed.BSCh2 ;таблица опций
 D @("TIP"_TIP_"^%ZAPM.ed.BSChT")
 D RETURN^%ZAPM.ed.BSCh0($$ESC^%ZAPM.ed.BSChT)
 D END^%ZAPM.ed.BSCh(7) Q
 Q
TABBEGIN  W "<HTML>",BK
 W "<HEAD><TITLE>"_$P(@BS,"@")_"</TITLE></HEAD>",BK
 W "<BODY "_$$0^%ZAPM.ed.BSCh(3)_">",BK
 Q
TABVAR() ;ПРОВЕРИТЬ И СОЗДАТЬ ПЕРЕМЕННЫЕ ТАБЛИЦЫ
 I $D(%KEY("BSNSPACE")) S NSPACE=$$%^%ZAPM.ed.BSCh(%KEY("BSNSPACE")) I $G(NSPACE)'="",'$$ZU^%ZAPM.ed.BSF4(NSPACE) D Er^%ZAPM.ed.BSCh("НЕ МОЖЕМ ПЕРЕЙТИ В ОБЛАСТЬ :"_NSPACE) Q 0
 S PART=$$%^%ZAPM.ed.BSCh(%KEY("BSPART")),TABL=$$%^%ZAPM.ed.BSCh(%KEY("BSTABL"))
 I '$$Data^%ZAPM.ed.BSF12(PART) D Er^%ZAPM.ed.BSCh("РАЗДЕЛ "_PART_" НЕ ДОСТУПЕН") Q 0
 I '$D(@PART@(TABL)) D Er^%ZAPM.ed.BSCh("ТАБЛИЦА :"_TABL_" В РАЗДЕЛЕ :"_PART_" НЕ ДОСТУПНА") Q 0
 I '$D(NSPACE) S NSPACE=$$ZU^%ZAPM.ed.BS3(0)
 S BS=$$CurT^%ZAPM.ed.BSChT(NSPACE,PART,TABL)
 S TIP=$P(@BS,"@",17),CFG=$G(@BS@("HTML","CFG")),BSR=PART,BST=TABL
 Q 1
PART ;ЗАЙТИ В РАЗДЕЛ
 N I,II,NSPACE,GL,P1,P2,P3,P9,PART,tip,Tmp
 D ADDVISIT^%ZAPM.ed.BSCh("Q","NAV")
 I $D(%KEY("BSNSPACE")) S NSPACE=$$%^%ZAPM.ed.BSCh(%KEY("BSNSPACE")) I $G(NSPACE)'="",'$$ZU^%ZAPM.ed.BSF4(NSPACE) D Er^%ZAPM.ed.BSCh("НЕ МОЖЕМ ПЕРЕЙТИ В ОБЛАСТЬ :"_NSPACE) Q
 I $G(%KEY("BSPART"))="" D Er^%ZAPM.ed.BSCh("НЕТ РАЗДЕЛА В ОБЛАСТИ :"_NSPACE) Q
 S PART=$$%^%ZAPM.ed.BSCh(%KEY("BSPART"))
 I '$$Data^%ZAPM.ed.BSF12(PART) D Er^%ZAPM.ed.BSCh("РАЗДЕЛ "_PART_" НЕ ДОСТУПЕН") Q
 I $D(@PART)'=11 D CRP^%ZAPM.ed.BSCh("РАЗДЕЛ ПУСТОЙ"),END^%ZAPM.ed.BSCh(7) Q
 I '$D(NSPACE) S NSPACE=$$ZU^%ZAPM.ed.BS3(0)
 ;                 РАЗМЕРЫ ОКНА БРАУЗЕРА ! 640x480 800x600 1024x768 1280x1024
 N Wi,Hi S Wi=650,Hi=440 ;///////РАЗМЕР НОВОГО ОКНА БРАУЗЕРА
 D CRP^%ZAPM.ed.BSCh("Список Доступных Таблиц") D JavaS^%ZAPM.ed.BSCh(32)
 I '$G(%KEY("BSONLY")) W "Для пользователя :"_$$AMA($G(NameUS))_" в рабочей области :"_$$ANSP($G(NSPACE),1)_" в разделе :"_$$APART($G(PART)),CRLF
 w "<hr>"
 S I="" F  S I=$O(@PART@(I)) Q:I=""  I $E(I,1)'="@" D
 .s tip=$P($G(@PART@(I)),"@",17) w "<LI>"
 .i $$tip(tip) d
 ..I tip=2 D  Q  ;БАЗЫ ДАННЫХ
 ...W "<P><a title=""редактировать базу данных"" href="""_$$A^%ZAPM.ed.BSCh_$S($D(NSPACE):"BSNSPACE="_$$%T^%ZAPM.ed.BSCh(NSPACE)_"&",1:"")_"BSROU="_$G(MainRef,"MAIN^~BSCh1")_"&BSLABEL=EDIT^~BSChT1&BSTABL="_$$%T^%ZAPM.ed.BSCh(I)_"&BSPART="_$$%T^%ZAPM.ed.BSCh(PART)_""">"_$$%T^%ZAPM.ed.BSCh(I)_" [ BSDT ] </A>"
 ..i $d(@PART@(I,"OPT")) S Tmp=@$ZR d  q  ;таблица опций
 ...W "<a title=""редактировать таблицу опций"" href="""_$$A^%ZAPM.ed.BSCh_$S($D(NSPACE):"BSNSPACE="_$$%T^%ZAPM.ed.BSCh(NSPACE)_"&",1:"")_"BSROU="_$G(MainRef,"MAIN^~BSCh1")_"&BSLABEL=ENTER^~BSCh2&BSTABL="_$$%T^%ZAPM.ed.BSCh(I)_"&BSPART="_$$%T^%ZAPM.ed.BSCh(PART)_"""> "_I_" [OPT"_$S(Tmp=1:1,1:2)_"] </a>"
 ..W "<P><INPUT title=""показать таблицу в JAVA-аплете"" TYPE=""button"" VALUE="""_$$%T^%ZAPM.ed.BSCh(I)_""" onClick=""LoadText('"_$$A^%ZAPM.ed.BSCh_$S($D(NSPACE):"BSNSPACE="_$$%T^%ZAPM.ed.BSCh(NSPACE)_"&",1:"")_"BSROU="_$G(MainRef,"MAIN^~BSCh1")_"&BSLABEL=JAVA^~BSChT1("_Wi_","_Hi_")&BSTABL="_$$%T^%ZAPM.ed.BSCh(I)_"&BSPART="_$$%T^%ZAPM.ed.BSCh(PART)_"',"_Wi_","_Hi_");"">"
 ..W "<a title=""показать таблицу фрагментарно"" href="""_$$A^%ZAPM.ed.BSCh_$S($D(NSPACE):"BSNSPACE="_$$%T^%ZAPM.ed.BSCh(NSPACE)_"&",1:"")_"BSROU="_$G(MainRef,"MAIN^~BSCh1")_"&BSMENU=4&BSTABL="_$$%T^%ZAPM.ed.BSCh(I)_"&BSPART="_$$%T^%ZAPM.ed.BSCh(PART)_"""> [",$$TIP^%ZAPM.ed.BS(tip),"] </a>"
 .i '$$tip(tip) W "<P><A TITLE=""таблица пока не поддерживается"" HREF=""JAVASCRIPT:alert('?')"">"_$$%T^%ZAPM.ed.BSCh(I)_"  [",$$TIP^%ZAPM.ed.BS(tip),"] </A>"
 .W $$TRAN^%ZAPM.ed.BSCh($P($G(@PART@(I),"Без Комментария"),"@",1)),"</P></LI>",CRLF
 D RETURN^%ZAPM.ed.BSCh0($$ANSP($G(NSPACE),1))
 D END^%ZAPM.ed.BSCh(7) Q
 Q
tip(tip) ;поддерживается тип
 i "1,2,5"[tip   q 1
 q 0
CLOSE(S) Q "<A title=""закрыть сессию"" HREF="""_$$A^%ZAPM.ed.BSCh_"BSROU="_$G(MainRef,"MAIN^~BSCh1")_"&BSLABEL=CLOSE1^~BSCh1"_""">"_S_"</A>"
AMA(U,Q) Q "<A title=""вернуться в Главное меню"" HREF="""_$$A^%ZAPM.ed.BSCh_"BSROU="_$G(MainRef,"MAIN^~BSCh1")_"""> "_U_$S($D(Q):"&lt;==",1:"")_"</A>"
ANSP(NS,Q) Q "<a title=""вернуться в область"" href="""_$$A^%ZAPM.ed.BSCh_"BSMENU=2&BSROU="_$G(MainRef,"MAIN^~BSCh1")_"&BSNSPACE="_$TR(NS,"%","~")_"""> "_NS_$S($D(Q):"&lt;==",1:"")_" </a>"
apart(II) Q $$A^%ZAPM.ed.BSCh_$S($D(NSPACE):"BSNSPACE="_$$%T^%ZAPM.ed.BSCh(NSPACE)_"&",1:"")_"BSMENU=3&BSROU="_$G(MainRef,"MAIN^~BSCh1")_"&BSPART="_$$%T^%ZAPM.ed.BSCh(II)
APART(II,Q) Q "<a title=""вернуться в раздел"" href="""_$$apart(II)_"""> "_II_$S($D(Q):"&lt;==",1:"")_" </a>"
NSP ;ПЕРЕЙТИ В КИП
 N I,II,NSPACE,GL,P1,P2,P3,P9,AAA
 D ADDVISIT^%ZAPM.ed.BSCh("Q","NAV")
 I $D(%KEY("BSNSPACE")) S NSPACE=$$%^%ZAPM.ed.BSCh(%KEY("BSNSPACE")) I $G(NSPACE)'="",'$$ZU^%ZAPM.ed.BSF4(NSPACE) D Er^%ZAPM.ed.BSCh("НЕ МОЖЕМ ПЕРЕЙТИ В ОБЛАСТЬ :"_NSPACE) Q
 S GL=$$GD^%ZAPM.ed.BSCp("","P")
 I '$G(P1) D CRP^%ZAPM.ed.BSCh("В ОБЛАСТИ :"_NSPACE_" НЕТ РАЗДЕЛОВ"),END^%ZAPM.ed.BSCh(7) Q
 I '$D(NSPACE) S NSPACE=$$ZU^%ZAPM.ed.BS3(0)
 D CRP^%ZAPM.ed.BSCh("Список Доступных Разделов")
 I '$G(%KEY("BSONLY")) W "Для пользователя :"_$$AMA($G(NameUS),1)_" в рабочей области :"_$$ANSP($G(NSPACE))
 S AAA=$$ADMIN^%ZAPM.ed.BSCh w "<HR>" I $$GETOPT^%ZAPM.ed.BSCh2(MainOpt,"LIB1") S AAA=1
 S II="" F  S II=$O(@GL@(II)) S:$E(II,1)'="^" II="^"_II I II'="",$$Data^%ZAPM.ed.BSF12(II) D
 .I $E(II,2)="%",'AAA Q
 .W "<P>- <a title=""зайти в раздел"" href="""_$$A^%ZAPM.ed.BSCh_$S($D(NSPACE):"BSNSPACE="_$$%T^%ZAPM.ed.BSCh(NSPACE)_"&",1:"")_"BSMENU=3&BSROU="_$G(MainRef,"MAIN^~BSCh1")_"&BSPART="_$$%T^%ZAPM.ed.BSCh(II)_"""> "_II_" </a>"
 .W $$TRAN^%ZAPM.ed.BSCh($P($G(@II,"@Без Комментария"),"@",2)),"</P>",CRLF
 D RETURN^%ZAPM.ed.BSCh0($$AMA($G(NameUS),1))
 D END^%ZAPM.ed.BSCh(7)
 Q
MAIN0 ;ПЕРЕГИСТРАЦИЯ
 K %KEY("BSUSER") G MAIN
MAIL ;ПИСЬМО ПОДГОТОВИТЬ
 N CurUS
 D MAINVAR
 D CRP^%ZAPM.ed.BSCh("Подготовьте Сообщение для Администратора Системы",4)
 D FORM^%ZAPM.ed.BSCh
 w "<input type=""hidden"" name=""BSROU"" value=""RESEVE^~BSCh1"">"
 W "<p><textarea rows=""4"" name=mBST1 cols=""80""></textarea></p>"
 
 W "<p> ОТ КОГО СООБЩЕНИЕ <input type=""text"" name=""BST2"" " D  W "size=""32"">"
 .I $G(NameUS)'="" W "VALUE="""_$G(NameUS)_""" "
 W " ТЕЛЕФОН <input type=""text"" name=""BST3"" size=""7""></p>"
 
 W "<p><input type=""radio"" value=""1"" name=""BSR1""> СРОЧНОЕ СООБЩЕНИЕ"
 W "<input type=""radio"" value=""2"" name=""BSR1""> НЕ ОЧЕНЬ"
 W "<input type=""radio"" value=""3"" checked name=""BSR1"">СОВСЕМ НЕ СРОЧНОЕ</p>"
 
 W "<input type=""submit"" value=""ОТПРАВИТЬ"" name=""BSB1""> "
 W "<input type=""reset"" value=""ОЧИСТИТЬ"" name=""BSB2"">"
 W "</p></form>"
 D RETURN^%ZAPM.ed.BSCh0("")
 Q
RESEVE ;ПИСЬМО ПРИНЯТЬ
 N BD,U1,U2,U3,NuMHtml,CurUS
 D MAINVAR
 S BD=$$KBD^%ZAPM.ed.BSF12($$0^%ZAPM.ed.BSCh(24)) I '$$Data^%ZAPM.ed.BSF12(BD) D CRP^%ZAPM.ed.BSCh("БАЗА ДАННЫХ НЕ ДОСТУПНА",4,2) G RESE
 S U1=$P($$h^%ZAPM.ed.BS3,","),U2=$P($$h^%ZAPM.ed.BS3,",",2)
 I $G(%KEY("mBST1"))="" D CRP^%ZAPM.ed.BSCh("СООБЩЕНИЕ ПУСТОЕ !",4,2) G RESE
 I $G(%KEY("BST2"))="" D CRP^%ZAPM.ed.BSCh("ЭТО АНОНИМКА, ДА ?",4,2) G RESE
 I $G(%KEY("BST3"))="" D CRP^%ZAPM.ed.BSCh("КАК, А ТЕЛЕФОН !",4,2) G RESE
 S @BD@(U1,CurUS,U2,"B")=$TR($G(%KEY("mBST1")),$C(13,10),"")
 S @BD@(U1,CurUS,U2,"U")=$G(%KEY("BST2"))
 S @BD@(U1,CurUS,U2,"T")=$G(%KEY("BST3"))
 S @BD@(U1,CurUS,U2,"A")=$G(%KEY("BSR1"))
 D CRP^%ZAPM.ed.BSCh("СООБЩЕНИЕ ДЛЯ АДМИНИСТРАТОРА ПРИНЯТО",4,1)
RESE D RETURN^%ZAPM.ed.BSCh0("")
 D END^%ZAPM.ed.BSCh(7)
 Q
CHECKPAS ;ПРОВЕРИТЬ РЕГИСТРАЦИЮ
 D CHECKPA($G(%KEY("USERNAME")),$G(%KEY("USERPASS")))
 Q
CHECKPA(U,P) ;ПРОВЕРКА ПАРОЛЯ
 N BD,U1,U2,U3,NuMHtml,CurUS,AP,GAP
 D MAINVAR
 D ADDVISIT^%ZAPM.ed.BSCh("P","NAV")
 s AP=$$CheckPass^%ZAPM.ed.BSChh(U,P,Grand)
 i AP="" D OTLUP Q
 S NameUS=U
 ;**************************************************************************
 ;ОТКРЫТИЕ СЕССИИ = GAP
 S GAP=$E($$RANDFILE^%ZAPM.ed.BSF11,1,8)_$E($$RANDFILE^%ZAPM.ed.BSF11,1,8)
 D SETMP^%ZAPM.ed.BSCp(GAP,Grand,AP) ;СОХРАНЕНИЕ ПЕРЕМЕННОЙ
 ;**************************************************************************
 K %KEY("USERNAME"),%KEY("USERPASS")
 S %KEY("BSUSER")=U_","_$$CRC^%ZAPM.ed.BSChh(P)_","_GAP
 D ADDVISIT^%ZAPM.ed.BSCh("R","NAV")
 G MAIN
CLOSE1 ;ЗАКРЫТИЕ СЕССИИ
 ;**************************************************************************
 D KILLTMP^%ZAPM.ed.BSCp($P($G(%KEY("BSUSER")),",",3))
 ;**************************************************************************
 D CRP^%ZAPM.ed.BSCh("СЕССИЯ ЗАКРЫТА",4,1)
 D RETURN^%ZAPM.ed.BSCh0("")
 D END^%ZAPM.ed.BSCh(7)
 Q
OTLUP ;ОТКАЗ В РЕГИСТРАЦИИ
 D CRP^%ZAPM.ed.BSCh("ВАМ ОТКАЗАНО В РЕГИСТРАЦИИ ! ПРОВЕРЬТЕ ПРАВИЛЬНОСТЬ ВВЕДЕННОГО ИМЕНИ ПОЛЬЗОВАТЕЛЯ И ПАРОЛЯ.",4,2)
 D RETURN^%ZAPM.ed.BSCh0("")
 D END^%ZAPM.ed.BSCh(7)
 Q
REGIST ;РЕГИСТРАЦИЯ
 d KILLTMP^%ZAPM.ed.BSCp("")
 D CRP^%ZAPM.ed.BSCh("ЗАРЕГИСТРИРУЙТЕСЬ !",4)
 D FORM^%ZAPM.ed.BSCh
 w "<input type=""hidden"" name=""BSROU"" value=""CHECKPAS^~BSCh1"">",BK
 S I="" F  S I=$O(%KEY(I)) Q:I=""  I I'="BSROU",$E(I,1,2)="BS" D
 .w BK,"<input type=""hidden"" name="""_I_""" value="""_%KEY(I)_""">"
 w BK,"<table border=""0"">",BK
 w "<tr>",BK
   w "<td align=""right""><strong>Введите ваше имя</strong></td>",BK
   w "<td><input type=""text"" size=""27"" maxlength=""2048"" name=""USERNAME"" value=""КТО ВЫ ?""></td>",BK
 w "</tr>"
 w "<tr>"
   w "<td align=""right""><strong>и пароль</strong></td>",BK
   w "<td><input type=""password"" size=""27"" maxlength=""2048"" name=""USERPASS""></td>",BK
 w "</tr>"
  w "</table>",BK
  w "<p><input type=""submit"" name=""OK"" value=""ЗАРЕГИСТРИРОВАТЬСЯ""> <input type=""reset"" name=""ON"" value=""ПОВТОРИТЬ ВВОД""></p>",BK
  w "</form>",BK
 W "<BR><A HREF=""/BS/DEVELOPER.htmL"">" D END^%ZAPM.ed.BSCh("") W "</A>"
 Q
]]></Routine>


<Routine name="%ZAPM.ed.BSCh2" type="MAC" languagemode="0"><![CDATA[
%BSCh2 ;БИБЛИОТЕКА ФУНКЦИЙ РАБОТЫ С ОПЦИЯМИ ; 13:39   12.09.2002
  ;УСТАРЕЛАЯ ПРОГРАММА
 Q
VAR ;НАЧАЛО
 I '$$TABVAR^%ZAPM.ed.BSCh1 Q
 D TABBEGIN^%ZAPM.ed.BSCh1
 S O=$NA(@PART@(TABL))
 Q
BSVAR ;ПЕРЕМЕННЫЕ ДЛЯ ТАБЛИЦЫ
 w "<input type=""hidden"" name=""BSTABL"" value="""_%KEY("BSTABL")_""">",$G(BK)
 w "<input type=""hidden"" name=""BSPART"" value="""_%KEY("BSPART")_""">",$G(BK)
 w "<input type=""hidden"" name=""BSNSPACE"" value="""_%KEY("BSNSPACE")_""">",$G(BK)
 Q
ENTER ;основной вход в таблицу опций
 N O
 D VAR
 D TITLE(O)
 I $G(@O@("OPT"))'=1,'$P($G(@O@("OPT")),",",2) W "В ТАБЛИЦЕ ОПЦИЙ НЕ ВЕРНЫЙ ПАРАМЕТР",BK D BACK^%ZAPM.ed.BSCh Q
 D OPT(O)
 D BSVAR
 w "<input type=""hidden"" name=""BSLABEL"" value=""SAVE^~BSCh2"">"
 w "<input type=""SUBMIT"" name=""SubMit1"" value=""Запомнить"">"
 w "<input type=""RESET"" name=""Reset1"" value=""Отменить"">"
 W "</form>"
ENTE D END2^%ZAPM.ed.BSCh D BACK^%ZAPM.ed.BSCh
 Q
SAVE ;СОХРАНИТЬ НОВЫЕ ПАРАМЕТРЫ
 N O
 D VAR
 S O=$NA(@PART@(TABL))
 D SAVEOPT^%ZAPM.ed.BSCh2(O)
 D END2^%ZAPM.ed.BSCh
 q
TITLE(TBL) ;вывести заголовок
 W "<CENTER>"
 I $G(@TBL@("OPT"))=1 W "<H3>",$P(@TBL@(2,4),"@",15),"</H3>" I 1 ;D CRP^%ZAPM.ed.BSCh($P(@TBL@(2,4),"@",15),4) Q
 E  W "<H3>",$P(@TBL,"@",1),"</H3>"
 W "<HR></CENTER>"
 ;D CRP^%ZAPM.ed.BSCh($P(@TBL,"@",1),4)
 Q
OPT(TBL,NOFORM) ;ФОРМА С ПАРАМЕТРАМИ
 I '$G(NOFORM) D FORMN^%ZAPM.ed.BSCh($QS(TBL,1))
 I '$D(@TBL@("OPT")) W "В ТАБЛИЦЕ ОПЦИЙ ОТСУТСТВУЮТ БАЗОВЫЕ ПАРАМЕТРЫ",BK D BACK^%ZAPM.ed.BSCh G ENTE
 w "<input type=""hidden"" name=""BSROU"" value="""_$G(MainRef,"MAIN^~BSCh1")_""">"
 N I,II,P1,P2,P3,P4,P5,X,Y,S
 w BK,"<table border=0>",BK
 I $G(@TBL@("OPT"))'=1 S S=@$ZR F I=$S($P(S,",",3):$P(S,",",2),1:1):1 Q:'$D(@TBL@(I))  D  W BK
 .Q:'$P(S,",",2)  Q:'$P(S,",")
 .S P4=$P($G(@TBL@(I,+$P(S,",",1))),"@",15),P1=$P($G(@TBL@(I,+$P(S,",",2))),"@",15)
 .S P3=" SIZE=50 ",P5=$P($P($G(@TBL@(I,$P(S,",",2))),"@",18),"#")
 .I P4'="",$P($G(@TBL@(I,$P(S,",",2))),"@",5)="" D text1(P1,P3,P5)
 I $G(@TBL@("OPT"))=1 F I=3:1 Q:$P($G(@TBL@(I,2)),"@",15)=""  D  W BK
 .S P1=$P(@TBL@(I,1),"@",15),P2=$P(@TBL@(I,2),"@",15),P3=$P(@TBL@(I,3),"@",15)
 .S P4=$P(@TBL@(I,4),"@",15),P5=$P(@TBL@(I,5),"@",15)
 .D TAB
 w "</table>"
 Q
TAB ;ТЕКУЩАЯ СТРОКА
 I P2="textarea" D  Q
 .W "<tr><td align=""right""><textarea name="""_$$name(P5)_""" "_P3_" >"_P1_"</textarea></td><td>",$$TEGS^%ZAPM.ed.BSre(P4),"</td></tr>"
 I P2="text" D text(P1,P3,P5) Q
 I P2="checkbox" D  Q
 .W "<tr><td align=""right""><input type=""checkbox"" name="""_$$name(P5)_""" value="""_P1_""""_P3_$$ch(P1)_"></td><td>",$$TEGS^%ZAPM.ed.BSre(P4),"</td></tr>"
 I P2="radio" w "<p>",BK D  Q
 .F II=1:1:$L(P4,"~") W "<tr><td align=""right""><input type=""radio"" name="""_$$name(P5)_""" value="_II_" "_P3_$$ch(P1=II)_"></td><td>",$$TEGS^%ZAPM.ed.BSre($P(P4,"~",II)),"</td></tr>",BK
 .w "</p>"
 Q
text(P1,P3,P5) W "<tr><td align=""right""><input type=""text"" name="_$$name(P5)_" "_P3_" value='"_P1_"'></td><td>",$$TEGS^%ZAPM.ed.BSre(P4),"</td></tr>"
 Q
text1(P1,P3,P5) W "<tr><td align=""right"">",$$TEGS^%ZAPM.ed.BSre(P4),"</td><td><input type=""text"" name="_$$name(P5)_" "_P3_" value='"_P1_"'></td></tr>"
 Q
name(P) ;ИМЯ КОМПОНЕНТЫ
 I P="" Q $QS(TBL,1)_I
 Q P
ch(P) I P q " checked "
 q ""
SAVEOPT(TBL) ;ПРИСВОЕНИЕ
 N I,C,N,S
 W "<CENTER>"
 W "<H3>Опции запомнены</H3>"
 W "<HR></CENTER>"
 ;D CRP^%ZAPM.ed.BSCh("Опции запомнены",4)
 I $G(@TBL@("OPT"))'=1 S S=@$ZR F I=$S($P(S,",",3):$P(S,",",2),1:1):1 Q:'$D(@TBL@(I))  D
 .Q:'$P(S,",",2)  Q:'$P(S,",")  Q:$P($G(@TBL@(I,$P(S,",",2))),"@",5)'=""
 .;S P4=$P($G(@TBL@(I,+$P(S,",",1))),"@",15),P1=$P($G(@TBL@(I,+$P(S,",",2))),"@",15)
 .S N=$P($P($G(@TBL@(I,$P(S,",",2))),"@",18),"#") i N="" s N=$QS(TBL,1)_I
 .I $TR($G(%KEY(N)),"@","")=$G(%KEY(N)) S $P(@TBL@(I,$P(S,",",2)),"@",15)=$G(%KEY(N)) Q
 .S $P(@TBL@(I,$P(S,",",2)),"@",15)=$TR($G(%KEY(N)),"@","") D PROT(N)
 
 I $G(@TBL@("OPT"))=1 F I=3:1 Q:$P($G(@TBL@(I,2)),"@",15)=""  D
 .S C=$P($G(@TBL@(I,2)),"@",15)
 .I $P($G(@TBL@(I,5)),"@",15)'="" S N=$P($G(@TBL@(I,5)),"@",15)
 .E  S N=$QS(TBL,1)_I
 .I C="checkbox" D  Q
 ..I $D(%KEY(N)) S $P(@TBL@(I,1),"@",15)=1
 ..E  S $P(@TBL@(I,1),"@",15)=0
 .I $TR($G(%KEY(N)),"@","")=$G(%KEY(N)) S $P(@TBL@(I,1),"@",15)=$G(%KEY(N)) Q
 .S $P(@TBL@(I,1),"@",15)=$TR($G(%KEY(N)),"@","") D PROT(N)
 Q
PROT(N) ;ЗАПИСЬ ЗАПРЕЩЕННОГО
 W "<br>Параметр '"_N_"' имеет запрещенный символ '@': "_RED_$G(%KEY(N))_EF_"<br>"
 W "<br>Запомнили : "_GREEN_$TR($G(%KEY(N)),"@","")_EF_"<br>"
 Q
GETOPT(TBL,NO,NK) ;ВОЗВРАТИТЬ ЗНАЧЕНИЕ ОПЦИИ NO
 ;NO - ИМЯ ПОКАЗАТЕЛЯ
 ;NK - НОМЕР КОЛОНКИ В ТАБЛИЦЕ
 N N,I,Q S Q="?"
 F I=3:1 Q:$P($G(@TBL@(I,2)),"@",15)=""  D
 .I $P($G(@TBL@(I,5)),"@",15)'="" S N=$P($G(@TBL@(I,5)),"@",15)
 .E  S N=$QS(TBL,1)_I
 .I N=NO S Q=$P($G(@TBL@(I,$G(NK,1))),"@",15) Q
 Q Q
SETOPT(TBL,NO,Q) ;ПРИСВОИТЬ ЗНАЧЕНИЕ ОПЦИИ NO=Q
 N N,I
 F I=3:1 Q:$P($G(@TBL@(I,2)),"@",15)=""  D
 .I $P($G(@TBL@(I,5)),"@",15)'="" S N=$P($G(@TBL@(I,5)),"@",15)
 .E  S N=$QS(TBL,1)_I
 .I N=NO S $P(@TBL@(I,1),"@",15)=Q
 Q
UPLOAD ;UPLOAD FILES -=CSP=-
 ;&html<
 ;<form enctype="multipart/form-data" method=post action="upload.csp">
 ;Enter a file to upload here: <input type=file size=30 name=FileStream>
 ;<p>
 ;<ul><input type=submit value="Upload file"></ul>
 ;<p>
 ;</form>
 ;>
]]></Routine>


<Routine name="%ZAPM.ed.BSChA" type="MAC" languagemode="0"><![CDATA[
%BSChA ; пpогpамма ОПЦИЙ АДМИНИСТРАТОРА ; 15:16   25.01.2001
 Q
MAIL D TEST^%ZAPM.ed.BSCh0("ПОЧТA")
 Q
OPTION ;ТАБЛИЦА ОСНОВНЫХ ОПЦИЙ MainOpt=ИМЯ ТАБЛИЦЫ
 D SETOPT^%ZAPM.ed.BSCh2(MainOpt,"ROOT",$G(%CGIEVAR("PATH_TRANSLATED")))
 D TITLE^%ZAPM.ed.BSCh2(MainOpt)
 D OPT^%ZAPM.ed.BSCh2(MainOpt)
 w "<input type=""hidden"" name=""BSLABEL"" value=""SAVEOPT^~BSChA"">"
 w "<input type=""SUBMIT"" name=""SubMit1"" value=""Запомнить Опции"">"
 w "<input type=""RESET"" name=""Reset1"" value=""Очистить"">"
 W "</form>"
 D BACK^%ZAPM.ed.BSCh,END^%ZAPM.ed.BSCh("")
 Q
SAVEOPT ;СОХРАНИТЬ НОВЫЕ ПАРАМЕТРЫ
 D SAVEOPT^%ZAPM.ed.BSCh2(MainOpt)
 D BACK^%ZAPM.ed.BSCh,END^%ZAPM.ed.BSCh("")
 Q
NETOPT ;ТАБЛИЦА СЕТЕВЫХ ОПЦИЙ
 S TBL="^%ZAPM.ed.BSETUP(""SERVER"")"
 D TITLE^%ZAPM.ed.BSCh2(TBL)
 D OPT^%ZAPM.ed.BSCh2(TBL)
 w "<input type=""hidden"" name=""BSLABEL"" value=""SAVENOPT^~BSChA"">"
 w "<input type=""SUBMIT"" name=""SubMit1"" value=""Запомнить Опции"">"
 w "<input type=""RESET"" name=""Reset1"" value=""Очистить"">"
 W "</form>"
 D BACK^%ZAPM.ed.BSCh,END^%ZAPM.ed.BSCh("")
 Q
SAVENOPT ;СОХРАНИТЬ НОВЫЕ ПАРАМЕТРЫ
 S TBL="^%ZAPM.ed.BSETUP(""SERVER"")"
 D SAVEOPT^%ZAPM.ed.BSCh2(TBL)
 D BACK^%ZAPM.ed.BSCh,END^%ZAPM.ed.BSCh("")
 Q
]]></Routine>


<Routine name="%ZAPM.ed.BSChK" type="MAC" languagemode="0"><![CDATA[
%BSChK ;!!!!!!
 ;
 ;
 ;d PCD^%MGW("ISC",7001) ;СТАРТ Cache Web Linl TP ...... EXIT1+2^STU
 ;
 ;
TEST ; Simple test page
 N CRLF,KEY,SYSNAME
 S CRLF=$C(13,10)
 ;
 ;W "HTTP/1.0 200 OK",CRLF
 ;W "Content-type: text/html",CRLF
 ;W "Window-target: main_window",CRLF
 ;W CRLF
 ;
 S SYSNAME=$S($G(%CGIEVAR("SERVER_SOFTWARE"))["Cach":"Cach&eacute; WebLink",1:"Open M/WebLink")
 ;
 W "<HTML>",CRLF
 W "<HEAD><TITLE>",SYSNAME," Test !!!! Page</TITLE></HEAD>",CRLF
 W "<BODY>",CRLF
 W "<H2>",SYSNAME," Тестовая !!!!!!!! страница... </H2>",CRLF
 W "<HR><B> You are connected to the M System</B>",CRLF
 D FLUSH^%MGW
 W "<P>M Job Number ",$J," on M System ",$G(%KEY("MGWLPN")),CRLF
 W "<BR>Form returned by M routine ",$ZN,CRLF
 W "<HR>",CRLF
 W "<TABLE BORDER>",CRLF
 W "<CAPTION><B><I>User defined variables passed to your M System</I></B></CAPTION>",CRLF
 W "<TR><TH>Variable Name</TH><TH>Value</TH></TR>",CRLF
 D FLUSH^%MGW
 S KEY=""  F  S KEY=$O(%KEY(KEY)) Q:KEY=""  W "<TR><TD>",KEY,"</TD><TD>",$G(%KEY(KEY)),"</TD></TR>",CRLF D FLUSH^%MGW
 W "</TABLE>",CRLF
 W "<HR>",CRLF
 W "<TABLE BORDER>",CRLF
 W "<CAPTION><B><I>CGI Environment variables passed to your M System</I></B></CAPTION>",CRLF
 W "<TR><TH>Variable Name</TH><TH>Value</TH></TR>",CRLF
 D FLUSH^%MGW
 S KEY=""  F  S KEY=$O(%CGIEVAR(KEY)) Q:KEY=""  W "<TR><TD>",KEY,"</TD><TD>",%CGIEVAR(KEY),"</TD></TR>",CRLF D FLUSH^%MGW
 W "</TABLE>",CRLF
 W "<HR>",CRLF
 W "</BODY>",CRLF
 W "</HTML>",CRLF
 Q
]]></Routine>


<Routine name="%ZAPM.ed.BSChMGW" type="MAC" languagemode="0"><![CDATA[
%mgw3 ;(CM) Cache WebLink Application Launch Routine ; 10:51   23.01.2001
 ; Version 4.20.491
 ;
 ; +--------------------------------------------------------+
 ; | Copyright 1986-1999 by InterSystems Corporation,       |
 ; | Cambridge, Massachusetts, U.S.A.                       |
 ; | All rights reserved.                                   |
 ; |                                                        |
 ; | Confidential, unpublished property of InterSystems.    |
 ; |                                                        |
 ; | This media contains an authorized copy or copies       |
 ; | of material copyrighted by InterSystems and is the     |
 ; | confidential, unpublished property of InterSystems.    |
 ; | This copyright notice and any other copyright notices  |
 ; | included in machine readable copies must be reproduced |
 ; | on all authorized copies.                              |
 ; +--------------------------------------------------------+
 ;
A0 ; *** Do not edit this routine ***
 
 ;
 ; Copy this routine to %ZMGW2 (or %MGW2) and edit that copy.
 ; User's of Cache 3.x should launch their application code
 ; from %ZMGW2.  This routine will be protected when Cache is
 ; upgraded.
 ;
HTML ; Process incoming HTML form data
 ;
 ;--------------------------------------------------------------------------------------------
 ;  Эти строки вставлены Михайленко С.В. для подключения комплекса %BS-Portal
 I $G(%KEY("BSG"))'="" D BSG^%ZAPM.ed.BSCh0(%KEY("BSG")) Q  //новый вызов
 I $D(%KEY("BSROU")) D RUN^%ZAPM.ed.BSCh0 Q                 //старый вызов
 ;I $G(%KEY("UZN"))'="" I $$ZU^%ZAPM.ed.BSF4(%KEY("UZN")) D ^dispatcher Q  //это приблуда А.Миренбурга
 ;--------------------------------------------------------------------------------------------    
 D TEST
 Q
 ;
JAVA ; Process in-form Cache/M Method (Invoked by Java Applet)
 ; Receive request in %REQUEST
 ;    Associated parameters in %REQUEST(1->n)
 ;
 ; Send each line of response as sendline^%mgwj(<Data>)
 ;    Finally, quit from this code module
 ;
 D TESTJ
 Q
 ;
TIMEOUT ; General (default) timeout procedure for private sessions
 W "ВАШЕ ВРЕМЯ ИСТЕКЛО...<BR>!!!"
 ; This procedure won't be called if the application elects
 ; to deal with this event.
 Q
 ;
TEST ; Simple test page
 N CRLF,KEY,SYSNAME
 S CRLF=$C(13,10)
 ;
 ;W "HTTP/1.0 200 OK",CRLF
 ;W "Content-type: text/html",CRLF
 ;W "Set-Cookie: cookie_name=cookie_value; path=/;",CRLF
 ;W "Window-target: main_window",CRLF
 ;W CRLF
 ;
 S SYSNAME="Cach&eacute; WebLink"
 ;
 W "<HTML>",CRLF
 W "<HEAD><TITLE>",SYSNAME," Test Page</TITLE></HEAD>",CRLF
 W "<BODY>",CRLF
 W "<H2>",SYSNAME," Test Page</H2>",CRLF
 W "<HR><B> You are connected to the Server</B>",CRLF
 D flush^%mgw
 W "<P>Server Job Number <B>",$J,"</B> on Server <B>",$G(%KEY("MGWLPN")),"</B>, TCP Port: <B>",$G(%ZCS("PORT")),"</B>",CRLF
 W "<BR>Form returned by routine <B>",$ZN,"</B>",CRLF
 W "<BR>User-defined variables passed to this routine in the"
 I '$G(%ZCS("GLO")) W " local array: <B>%KEY</B>",CRLF
 I $G(%ZCS("GLO")) W " global: <B>^MGW(""%KEY"",$J,</B>",CRLF
 W "<HR>",CRLF
 W "<TABLE BORDER>",CRLF
 W "<CAPTION><B><I>User-defined variables passed to your Server</I></B></CAPTION>",CRLF
 W "<TR><TH>Variable Name</TH><TH>Value</TH></TR>",CRLF
 D flush^%mgw
 S KEY=""
 I '$G(%ZCS("GLO")) F  S KEY=$O(%KEY(KEY)) Q:KEY=""  W "<TR><TD>",KEY,"</TD><TD>",$G(%KEY(KEY)),"</TD></TR>",CRLF D flush^%mgw
 I $G(%ZCS("GLO")) F  S KEY=$O(^MGW("%KEY",$J,KEY)) Q:KEY=""  W "<TR><TD>",KEY,"</TD><TD>",$G(^MGW("%KEY",$J,KEY)),"</TD></TR>",CRLF D flush^%mgw
 W "</TABLE>",CRLF
 W "<HR>",CRLF
 W "<TABLE BORDER>",CRLF
 W "<CAPTION><B><I>CGI Environment variables passed to your Server</I></B></CAPTION>",CRLF
 W "<TR><TH>Variable Name</TH><TH>Value</TH></TR>",CRLF
 D flush^%mgw
 S KEY=""  F  S KEY=$O(%CGIEVAR(KEY)) Q:KEY=""  W "<TR><TD>",KEY,"</TD><TD>",%CGIEVAR(KEY) D CGI W "</TD></TR>",CRLF D flush^%mgw
 W "</TABLE>",CRLF
 W "<HR>",CRLF
 W "</BODY>",CRLF
 W "</HTML>",CRLF
 Q
 ;
CGI ; Additional CGI Environment Variable content
 N I
 F I=1:1 Q:'$D(%CGIEVAR(KEY,I))  W "<BR>",$G(%CGIEVAR(KEY,I))
 Q
 ;
TESTJ ; Simple response to client-side Java Applet
 D sendline^%mgwj("This is the response to '"_%REQUEST_"' from the Cache System")
 Q
 ;
VERS ; Return the version number
 D VERS^%mgw
 Q
 ;
VER() ; Return the version for this module
 Q "4.20.491"
 ;
]]></Routine>


<Routine name="%ZAPM.ed.BSChT" type="MAC" languagemode="0"><![CDATA[
%BSChT ; пpогpамма РАБОТЫ С ТАБЛИЦЕЙ ; 20:48   03.06.2000
 Q  ;17 ТИП -ТИП =.1 - ТАБЛИЦА БЕЗ БАЗЫ ДАННЫХ (САМА ПО СЕБЕ) (ПО УМОЛЧАНИЮ)
   ;              2 - -- / -- С БАЗОЙ ДАННЫХ (ОПИСАНИЕ БАЗ В ^BSR(BST,"KEY")
   ;              3 - ТАБЛИЦА-СПИСОК
   ;              4 - ТАБЛИЦА-СВОДКА
   ;              .5 - ТЕКСТ
   ;              6 - БЛАНК --- нет
   ;              7 - МЕНЮ ПОЛЬЗОВАТЕЛЯ
   ;              8 - ПАНЕЛЬ С КНОПКАМИ
   ;             
CurTBS() Q $$CurT($$%^%ZAPM.ed.BSCh(%KEY("BSNSPACE")),$$%^%ZAPM.ed.BSCh(%KEY("BSPART")),$$%^%ZAPM.ed.BSCh(%KEY("BSTABL")))
CurT(NS,PR,TB) I PR["^["_$C(34) Q $NA(@PR@(TB))
 Q $NA(@("^["""_NS_"""]"_$P(PR,"^",2))@(TB))
CFGTAB ;ЗАПИСАТЬ CFG
 N BS,CFG
 I $G(%KEY("C1")) S CFG="1,0,0,9,9,9,"_$G(%KEY("C2"))_","_$G(%KEY("PRESS"))_",1,1" D CFGTA Q
 I '$G(%KEY("C1")),$G(%KEY("STR"))=0,$G(%KEY("COL"))=0 S CFG="0,"_$P($$0^%ZAPM.ed.BSCh(28),"=",2)_","_$P($$0^%ZAPM.ed.BSCh(29),"=",2)_",9,9,9,"_$G(%KEY("C2"))_","_$G(%KEY("PRESS"))_",1,1" D CFGTA Q
 I $G(%KEY("STR"))=0,$G(%KEY("COL"))=0 S CFG="1,0,0,9,9,9,"_$G(%KEY("C2"))_","_$G(%KEY("PRESS"))_",1,1" D CFGTA Q
 S CFG="0,"_$G(%KEY("STR"))_","_$G(%KEY("COL"))_",578,578,578,"_$G(%KEY("C2"))_","_$G(%KEY("PRESS"))_",1,1"
CFGTA S BS=$$CurTBS(),@BS@("HTML","CFG")=CFG
GOM D TABBEGIN^%ZAPM.ed.BSCh1
 D TIP1
 D RETURN^%ZAPM.ed.BSCh0($$ESC())
 D END^%ZAPM.ed.BSCh(7) Q
 Q
GOMAP ;ДВИГАТЬ ТАБЛИЦУ
 N BS,CFG,GO,TX,TY,Limit
 S BS=$$CurTBS(),CFG=$G(%KEY("BSTABCFG")),GO=$G(%KEY("BSMAP")) D TITUL
 ;ИЗМЕНИМ 9-10 В CFG
 I GO'=""&(CFG)'="" D @($TR($E(GO,1,2),"КСТ","CPT")_"^%ZAPM.ed.BSChT0")
 G GOM
TITUL ;ТИТУЛ
 N T S T=$P(@BS,"@",19) I 'T S T=$P(@BS,"@",50)
 S TY=+$P(T,",",1),TX=+$P(T,",",2) S:'TY TY=1 S:'TX TX=1
 Q
WR ;ВЫВОД ТАБЛИЦЫ
 N T,I,J,II,JJ,X,Y,CurH,CurW,KolStr,KolP,KolX
 D TITUL
 S Y=$P(CFG,",",9),X=$P(CFG,",",10)
 I TY I $P(CFG,",",9,10)="1,1" S Y=TY,X=TX D  ;УГЛОВЫЕ ТОЧКИ ВЫВОДА
 .S $P(CFG,",",9)=TY
 .S $P(CFG,",",10)=TX
 S (CurH,CurW,KolStr)=0,KolX=$P(@BS,"@",29),KolP=$$0^%ZAPM.ed.BSCh(30) K S,CurWW,Limit
 I TY F I=1:1:TY-1 Q:'$D(@BS@(I))  Q:$$CurH(I)  D WRBS(I)
 F I=Y:1 Q:'$D(@BS@(I))  Q:$$CurH(I)  D WRBS(I)
 S $P(CFG,",",11)=I-1
 S $P(CFG,",",12)=$S($D(CurWW):CurWW-1,1:KolX)
 Q
WRITE ;ВЫВОД ТАБЛИЦЫ
 W BK,"<TT>" D RETRY($P(CFG,",",8),"<SMALL>")
 S I="" F  S I=$O(S(I)) Q:I=""  S J="" F  S J=$O(S(I,J)) Q:J=""  W "<NOBR>",$$CTRL($$SPA(S(I,J))),"</NOBR>",BR,BK
 ;S I="" F  S I=$O(S(I)) Q:I=""  S J="" F  S J=$O(S(I,J)) Q:J=""  W $$CTRL($$SPA(S(I,J))),BR,BK
 ;W "<TABLE BORDER=0>" D  W "</TABLE>" ;ВЫВОД ТАБЛИЦЕЙ
 ;.S I="" F  S I=$O(S(I)) Q:I=""  S J="" F  S J=$O(S(I,J)) Q:J=""  W "<TR>" D  W "</TR>"
 ;..F II=1:1 Q:$P(S(I,J),$C(0),II,II+1)=""  W "<TD>",$P(S(I,J),$C(0),II),"</TD>"
 W "<NOBR>Текущие строка ",$P(CFG,",",11)," Колонка ",$P(CFG,",",12),". Из - (",$P(@BS,"@",28),"x",$P(@BS,"@",29),") ",$P(@BS,"@"),"</NOBR>",BR,BK
 W "</TT>" D RETRY($P(CFG,",",8),"</SMALL>") K S
 I '$P(CFG,",",2) W "<NOBR>" D NAVIG W "</NOBR>" ;КОГДА ВСЯ ТАБЛИЦА
 Q
NAVIG W "Навигация по Таблице "
 I TY<$P(CFG,",",9) D  W "<a href="""_$$A^%ZAPM.ed.BSCh_$$ATAB_""">В_Начало</A> "
 .S I=1,II="N"
 I TY<$P(CFG,",",9) D  W "<a href="""_$$A^%ZAPM.ed.BSCh_$$ATAB_""">Назад</A> "
 .S I=2,II="N"
 I $D(Limit) D  W "<a href="""_$$A^%ZAPM.ed.BSCh_$$ATAB_""">Вперед</A> "
 .S I=3,II="N"
 I $P(@BS,"@",28)'=$P(CFG,",",11) D  W "<a href="""_$$A^%ZAPM.ed.BSCh_$$ATAB_""">В_Конец</A> "
 .S I=4,II="N"
 Q
RETRY(U,T) I U F I=1:1:U W T
 Q
WRC(I,J,BS,T) ;КЛЕТКА
 N d1,BSF
 S d1=$$CELL^%ZAPM.ed.BSCt(T,I,J) ;ДАННЫЕ КЛЕТКИ
 S l=$P(BS,"@",3)*$P(BS,"@",4)
 F BSF=1:1:$P(BS,"@",3) S S(I,BSF)=$G(S(I,BSF))_$E(d1_$J("",l),BSF*$P(BS,"@",4)-$P(BS,"@",4)+1,$P(BS,"@",4)+($P(BS,"@",4)*(BSF-1)))_$C(0)
 Q
WRBS(I) ;УГОЛ-ШАПКА-БОКОВИНА-СТРОКИ
 I TX F J=1:1:TX-1 Q:$$CurW(J)  D WRC(I,J,@BS@(I,J),BS)
 F J=X:1 Q:$$CurW(J)  D WRC(I,J,@BS@(I,J),BS)
 Q
SPA(S) S S=$$TR^%ZAPM.ed.BSsFUNM(S,"<","&lt;")
 S S=$$TR^%ZAPM.ed.BSsFUNM(S,">","&gt;")
 Q $$TR^%ZAPM.ed.BSsFUNM(S," ","&nbsp;") ;ПРОБЕЛЫ
CTRL(S) Q $TR(S,$C(0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31),"")
CurH(I) I '$P(CFG,",",2) D  Q:$D(Limit) 1 Q 0
 .S KolStr=KolStr+1 I KolP,(KolStr*KolX)>KolP S Limit=I Q
 S CurH=CurH+$P(@BS@(I,1),"@",3)
 I $P(CFG,",",2)<CurH Q 1
 Q 0
CurW(J) I '$D(@BS@(I,J)) S CurWW=J Q 1
 I '$P(CFG,",",3) Q 0
 I $D(CurWW) Q:J<CurWW 0 Q 1
 S CurW=$G(CurW)+$P(@BS@(1,J),"@",4)
 I $P(CFG,",",3)<CurW S CurWW=J Q 1
 Q 0
TIP1 ;ПРОСТАЯ                    4  5  6           9  10 11 12
 ;ЕСЛИ СТАТУС ТАБЛИЦЫ C1,STR,COL,AT,AP,AC,C2,PRESS,CY,CX,EY,EX
 I $G(CFG)="" S CFG="0,"_$P($$0^%ZAPM.ed.BSCh(28),"=",2)_","_$P($$0^%ZAPM.ed.BSCh(29),"=",2)_",578,578,578,0,0,1,1"
 N S,T,I,J,II,JJ,X,Y,CurH,CurW,Limit
 D WR I '$P(CFG,",",1) D Q^%ZAPM.ed.BSChT0
 D FORM
 D WRITE
 Q
FORM D FORM^%ZAPM.ed.BSCh
 N I,II,III
 w "<input type=""hidden"" name=""BSLABEL"" value=""CFGTAB^~BSChT"">",BK
 w "<input type=""hidden"" name=""BSROU"" value="""_$G(MainRef,"MAIN^~BSCh1")_""">",BK
 w "<input type=""hidden"" name=""BSNSPACE"" value="""_$$%^%ZAPM.ed.BSCh(%KEY("BSNSPACE"))_""">",BK
 w "<input type=""hidden"" name=""BSPART"" value="""_$$%^%ZAPM.ed.BSCh(%KEY("BSPART"))_""">",BK
 w "<input type=""hidden"" name=""BSTABL"" value="""_$$%^%ZAPM.ed.BSCh(%KEY("BSTABL"))_""">",BK
 W "<table bBorder=""0"" width=""100%"">",BK
 W "<tr>"
 W "<td width=""28%""><input type=""checkbox"" name=""C1"" value=""1""" D  W ">Таблицу показывать всю"
 .I $P(CFG,",",1) W " CHECKED "
 
 W "<p><select name=""STR"" size=""1"">",BK
 S II=$P(CFG,",",2) F I=$P($$0^%ZAPM.ed.BSCh(28),":"):$P($$0^%ZAPM.ed.BSCh(28),":",2):$P($P($$0^%ZAPM.ed.BSCh(28),":",3)," ") W "<option " D:I=II  W " value="""_I_""">"_I_"</option>",BK
 .W "selected"
 W "<option value=""0""" D  W " >..</option>",BK
 .I $P(CFG,",",2)=0 W " selected"
 W "</select>"
 
 W "строк<select name=""COL"" size=""1"">",BK
 S II=$P(CFG,",",3) F I=$P($$0^%ZAPM.ed.BSCh(29),":",1):$P($$0^%ZAPM.ed.BSCh(29),":",2):$P($P($$0^%ZAPM.ed.BSCh(29),":",3)," ") W "<option " D:I=II  W " value="""_I_""">"_I_"</option>",BK
 .W "selected"
 W "<option value=""0""" D  W " >..</option>",BK
 .I $P(CFG,",",3)=0 W " selected"
 W "</select>симв. </td>",BK
 
 W "<td width=""34%""><p><CENTER>" I $P(CFG,",",2) W "Таблица Страница Клетка",BR
 W "<MAP NAME=""AT"">",BK S II="ТАБЛИЦУ"
 I $P(CFG,",",4)=0 F I=1:1:8 D AREA(I)
 E  F I=1:1:$L($P(CFG,",",4)) D AREA($E($P(CFG,",",4),I))
 W "</MAP>"
 I $P(CFG,",",4)'=9 W "<IMG SRC="""_$$G($P(CFG,",",4))_""" BORDER=0 usemap=""#AT"">"
 
 W "<MAP NAME=""AP"">",BK S II="СТРАНИЦУ"
 I $P(CFG,",",5)=0 F I=1:1:8 D AREA(I)
 E  F I=1:1:$L($P(CFG,",",5)) D AREA($E($P(CFG,",",5),I))
 W "</MAP>",BK
 I $P(CFG,",",5)'=9 W "<IMG SRC="""_$$G($P(CFG,",",5))_""" BORDER=0 usemap=""#AP"">"
 
 W "<MAP NAME=""AC"">",BK S II="КЛЕТКУ"
 I $P(CFG,",",6)=0 F I=1:1:8 D AREA(I)
 E  F I=1:1:$L($P(CFG,",",6)) D AREA($E($P(CFG,",",6),I))
 W "</MAP>",BK
 I $P(CFG,",",6)'=9 W "<IMG SRC="""_$$G($P(CFG,",",6))_""" BORDER=0 usemap=""#AC"">"
 E  D NAVIG
 W "</CENTER></p></td>",BK
 
 W "<td width=""38%"">",BK
 
 W "<input type=""checkbox"" name=""C2"" value=""1""" D  W ">Убрать заголовок и сравнения.",$$ESC,BK
 .I $P(CFG,",",7) W "CHECKED "
 
 W "<p><select name=""PRESS"" size=""1"">",BK
 S II=$P(CFG,",",8) F I=0:1:2 W "<option " D:I=II  W " value="""_I_""">"_$S(I=0:"норма",I=1:"сжать",I=2:"сильнее")_"</option>",BK
 .W "selected"
 W "</select> "
 
 W "<input type=""submit"" value=""Запомнить"" name=""B1""></p></td>",BK
 W "</tr></table></FORM><HR>",BK
 Q
ESC() Q "<a TITLE=""Вернуться назад"" href="""_$$A^%ZAPM.ed.BSCh_"BSNSPACE="_$$%T^%ZAPM.ed.BSCh(%KEY("BSNSPACE"))_"&BSMENU=3&BSROU="_$G(MainRef,"MAIN^~BSCh1")_"&BSPART="_$$%T^%ZAPM.ed.BSCh(%KEY("BSPART"))_"""> &lt;== </a>"
G(F) ;ФАЙЛ НАПРАВЛЕНИЯ
 I F=0 Q $$0^%ZAPM.ed.BSCh(26)
 N I,E S I=$$0^%ZAPM.ed.BSCh(26),E=$P(I,".",2),I=$P(I,".")
 Q I_F_"."_E
SELe(I) Q $S(I=1:"ВЛЕВО-ВВЕРХ",I=2:"ВВЕРХ",I=3:"ВПРАВО-ВВЕРХ",I=4:"ВЛЕВО",I=5:"ВПРАВО",I=6:"ВЛЕВО-ВНИЗ",I=7:"ВНИЗ",I=8:"ВНИЗ-ВПРАВО",1:"")
ATAB() ;ССЫЛКА НА ТАБЛИЦУ
 Q "BSMAP="_I_II_"_"_$$SELe(I)_"&BSNSPACE="_$$%T^%ZAPM.ed.BSCh(%KEY("BSNSPACE"))_"&BSPART="_$$%T^%ZAPM.ed.BSCh(%KEY("BSPART"))_"&BSTABL="_$$%T^%ZAPM.ed.BSCh(%KEY("BSTABL"))_"&BSROU="_$G(MainRef,"MAIN^~BSCh1")_"&BSLABEL=GOMAP^~BSChT"_"&BSTABCFG="_$G(CFG)
AREA(I) ;ЧУСТВИТЕЛЬНАЯ ОБЛАСТЬ
 Q:I=9  W "<AREA TITLE="""_II_" "_$$SELe(I)_""" SHAPE=""RECT"" COORDS=""" D  W """ HREF="""_$$A^%ZAPM.ed.BSCh_$$ATAB_""">"
 .W $S(I=1:"0, 0, 25, 22",I=2:"27, 0, 50, 22",I=3:"55, 0, 79, 22",I=4:"0, 24, 25, 47",I=5:"52, 24, 79, 47",I=6:"0, 50, 25, 73",I=7:"27, 50, 50, 73",I=8:"52, 50, 79, 73",1:"")
 Q
TIP2 ;БАЗА ДАННЫХ
 W "??? "
 W $$ESC,BK
 Q
TIP3 ;3 - ТАБЛИЦА-СПИСОК
 G TIP11
TIP4 ;4 - ТАБЛИЦА-СВОДКА
 G TIP11
 Q
TIP ;НЕИЗВЕСТНЫЙ НАУКЕ ЗВЕРЬ
TIP5 ;5 - ТЕКСТ
 F I=1:1 Q:'$D(@BS@(I))  W @BS@(I),BR,BK
 W $$ESC,BK
 Q
TIP6 ;
TIP7 ;
TIP8 ;
TIP9 ;
TIP10 ;
TIP11 W "Данный тип объекта пока не поддерживается"
 Q
]]></Routine>


<Routine name="%ZAPM.ed.BSChT0" type="MAC" languagemode="0"><![CDATA[
%BSChT0 ; пpогpамма НАВИГАЦИИ ПО ТАБЛИЦЕ ; 12:01   09.02.2000
 Q
QQ(Q) S $P(CFG,",",4)=Q,$P(CFG,",",5)=Q,$P(CFG,",",6)=Q
 Q
Q ;ПРОВЕРКА КАРТИНКИ РОЗЫ ВЕТРОВ
 I TY<$P(CFG,",",9),TX<$P(CFG,",",10),$P(@BS,"@",28)'=$P(CFG,",",11),$P(@BS,"@",29)'=$P(CFG,",",12) D QQ(0) Q  ;-Ж-
 I TY'<$P(CFG,",",9),TX'<$P(CFG,",",10),$P(@BS,"@",28)=$P(CFG,",",11),$P(@BS,"@",29)=$P(CFG,",",12) D QQ(9) Q
 I TY'<$P(CFG,",",9) D  Q  ;-.-
 .I TX'<$P(CFG,",",10),$P(@BS,"@",28)=$P(CFG,",",11),$P(@BS,"@",29)'=$P(CFG,",",12) D QQ(5) Q
 .I TX'<$P(CFG,",",10),$P(@BS,"@",28)'=$P(CFG,",",11),$P(@BS,"@",29)'=$P(CFG,",",12) D QQ(578) Q
 .I TX'<$P(CFG,",",10),$P(@BS,"@",28)'=$P(CFG,",",11),$P(@BS,"@",29)=$P(CFG,",",12) D QQ(7) Q
 .I TX<$P(CFG,",",10),$P(@BS,"@",28)=$P(CFG,",",11),$P(@BS,"@",29)=$P(CFG,",",12) D QQ(4) Q
 .I TX<$P(CFG,",",10),$P(@BS,"@",28)'=$P(CFG,",",11),$P(@BS,"@",29)=$P(CFG,",",12) D QQ(467) Q
 .I TX<$P(CFG,",",10),$P(@BS,"@",28)'=$P(CFG,",",11),$P(@BS,"@",29)'=$P(CFG,",",12) D QQ(45678) Q
 .I TX<$P(CFG,",",10),$P(@BS,"@",28)=$P(CFG,",",11),$P(@BS,"@",29)'=$P(CFG,",",12) D QQ(45) Q
 I TX'<$P(CFG,",",10) D  Q  ;K-
 .I TY<$P(CFG,",",9),$P(@BS,"@",28)=$P(CFG,",",11),$P(@BS,"@",29)=$P(CFG,",",12) D QQ(2) Q
 .I TY<$P(CFG,",",9),$P(@BS,"@",28)=$P(CFG,",",11),$P(@BS,"@",29)'=$P(CFG,",",12) D QQ(235) Q
 .I TY<$P(CFG,",",9),$P(@BS,"@",28)'=$P(CFG,",",11),$P(@BS,"@",29)'=$P(CFG,",",12) D QQ(23578) Q
 .I TY<$P(CFG,",",9),$P(@BS,"@",28)'=$P(CFG,",",11),$P(@BS,"@",29)=$P(CFG,",",12) D QQ(27) Q
 I $P(@BS,"@",29)=$P(CFG,",",12) D  Q  ;-I
 .I TX<$P(CFG,",",10),TY<$P(CFG,",",9),$P(@BS,"@",28)=$P(CFG,",",11) D QQ(124) Q
 .I TX<$P(CFG,",",10),TY<$P(CFG,",",9),$P(@BS,"@",28)'=$P(CFG,",",11) D QQ(12467) Q
 I $P(@BS,"@",28)=$P(CFG,",",11) D  Q  ;_._
 .I TY<$P(CFG,",",9),TX<$P(CFG,",",10),$P(@BS,"@",29)'=$P(CFG,",",12) D QQ(12345) Q
 Q
2C ;^
 I TY'<$P(CFG,",",9) Q
 S $P(CFG,",",9)=$P(CFG,",",9)-1
 Q
4C ;<--
 I TX'<$P(CFG,",",10) Q
 S $P(CFG,",",10)=$P(CFG,",",10)-1
 Q
5C ;-->
 I $P(@BS,"@",29)=$P(CFG,",",12) Q
 S $P(CFG,",",10)=$P(CFG,",",10)+1
 Q
7C ;V
 I $P(@BS,"@",28)=$P(CFG,",",11) Q
 S $P(CFG,",",9)=$P(CFG,",",9)+1
 Q
6C D 4C,7C Q
3C D 2C,5C Q
1C D 2C,4C Q
8C D 5C,7C Q
 Q
3CELL(OT,SH,LONG) ;НА КАКОЙ КЛЕТКЕ ОСТАНОВИМСЯ
 N I,H,Limi,KolX,KolP S H=0,KolStr=0,KolX=$P(@BS,"@",29),KolP=$$0^%ZAPM.ed.BSCh(30)
 I TY'=1 F I=1:1:TY-1 Q:'$D(@BS@(I,1))  S H=H+$P(@BS@(I,1),"@",3)
 F I=OT:SH Q:H'<LONG  Q:'$D(@BS@(I,1))  S H=H+$P(@BS@(I,1),"@",3) I '$P(CFG,",",2) D  Q:$D(Limi)
 .S KolStr=KolStr+1 I KolP,(KolStr*KolX)>KolP S Limi=1
 Q I-SH
4CELL(OT,SH,LONG) ;НА КАКОЙ КЛЕТКЕ ОСТАНОВИМСЯ
 N I,H S H=0
 I TX'=1 F I=1:1:TX-1 Q:'$D(@BS@(1,I))  S H=H+$P(@BS@(1,I),"@",4)
 F I=OT:SH Q:H'<LONG  Q:'$D(@BS@(1,I))  S H=H+$P(@BS@(1,I),"@",4)
 Q I-SH
2P ;^
 I TY'<$P(CFG,",",9) Q
 S $P(CFG,",",9)=$$3CELL($P(CFG,",",9),"-1",$P(CFG,",",2))
 I TY'<$P(CFG,",",9) S $P(CFG,",",9)=TY
 Q
4P ;<--
 I TX'<$P(CFG,",",10) Q
 S $P(CFG,",",10)=$$4CELL($P(CFG,",",10),"-1",$P(CFG,",",3))
 I TX'<$P(CFG,",",10) S $P(CFG,",",10)=TX
 Q
5P ;-->
 I $P(@BS,"@",29)=$P(CFG,",",12) Q
 S $P(CFG,",",10)=$P(CFG,",",12)
 I $P(@BS,"@",29)<$P(CFG,",",10) S $P(CFG,",",10)=$$4CELL($P(@BS,"@",29),"-1",$P(CFG,",",3))
 Q
7P ;V
 I $P(@BS,"@",28)=$P(CFG,",",11) Q
 S Tmp=$P(CFG,",",11)-$P(CFG,",",9)
 S $P(CFG,",",9)=$P(CFG,",",11)
 I $P(@BS,"@",28)<$P(CFG,",",9) S $P(CFG,",",9)=$$3CELL($P(@BS,"@",28),"-1",$P(CFG,",",2))
 Q
8P D 5P,7P Q
6P D 4P,7P Q
1P D 2P,4P Q
3P D 2P,5P Q
5T ;-->
 I $P(@BS,"@",29)=$P(CFG,",",12) Q
 S $P(CFG,",",10)=$$4CELL($P(@BS,"@",29),"-1",$P(CFG,",",3))+1
 Q
7T ;V
 I $P(@BS,"@",28)=$P(CFG,",",11) Q
 S $P(CFG,",",9)=$$3CELL($P(@BS,"@",28),"-1",$P(CFG,",",2))+1
 Q
2T ;^
 I TY'<$P(CFG,",",9) Q
 S $P(CFG,",",9)=TY
 Q
4T ;<--
 I TX'<$P(CFG,",",10) Q
 S $P(CFG,",",10)=TX
 Q
8T D 5T,7T Q
3T D 2T,5T Q
1T D 2T,4T Q
6T D 4T,7T Q
1N S $P(CFG,",",9)=TY,$P(CFG,",",10)=TX
 Q
3N S $P(CFG,",",9)=$P(CFG,",",11)-1,$P(CFG,",",10)=TX
 Q
2N S $P(CFG,",",9)=$$3CELL($P(CFG,",",9),"-1",99999),$P(CFG,",",10)=TX
 Q
4N S $P(CFG,",",9)=$P(@BS,"@",28)-2,$P(CFG,",",10)=TX
 Q
]]></Routine>


<Routine name="%ZAPM.ed.BSChT1" type="MAC" languagemode="0"><![CDATA[
%BSChT1 ; пpогpамма работы с ДАННЫМИ ТАБЛИЦ ; 21:44   21.12.2002
 q
JAVA(WI,HE) ;ТАБЛИЦА
 N %BsWebL,%DEV,%BS,I,II,NSPACE,GL,P1,P2,P3,P9,PART,TABL,TIP,CFG,BS
 N JAVA,W,H,BODY,STR,COL,TIT,TIX,TIY,BYTE,S1,S2
 S %BsWebL=1 D JAVA^%ZAPM.ed.BSHTML1
 Q
EDIT ;РЕДАКТИРОВАНИЕ БАЗЫ ДАННЫХ
 D BEG1^%ZAPM.ed.BSC4
 w "<script LANGUAGE=""JavaScript"" SRC="""_BSDOMAIN_"/js/mfun.js""></script>",!
 D VAR N KEYS
 W "<title>"_TB_" : "_$P(@TB,"@",1)_" >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>></title>",!
 w "</head>",!
 S KEYS=$O(@TB@("KEY",""),-1)
 w "<frameset cols='30%,*,0%' border='false' frameborder=0 >",!
 w "<frameset rows='"_(KEYS*60+40)_",*,0' border='false' frameborder=0 >",!
 N BSROU,BSUSER,BSMENU,BSTOP
 //S BSPART=$$%T^%ZAPM.ed.BSCh(BSPART),BSTABL=$$%T^%ZAPM.ed.BSCh(BSTABL)
 S BSLABEL="EDIT1^~BSChT1",marg=5
 w "  <frame name=""E1"" scrolling=""AUTO"" marginwidth="_marg_" marginheight="_marg_" src="""_$$ADDBSGET^%ZAPM.ed.BSC4_""">",!
 S BSLABEL="EDIT4^~BSChT1"
 w "  <frame name=""E4"" scrolling=""AUTO"" marginwidth="_marg_" marginheight="_marg_" src="""_$$ADDBSGET^%ZAPM.ed.BSC4_""">",!
 w "  <frame name=""E5"" >",!
 w "</frameset>",!
 S BSLABEL="EDIT2^~BSChT1"
 w "  <frame name=""E2"" scrolling=""AUTO"" marginwidth="_marg_" marginheight="_marg_" src="""_$$ADDBSGET^%ZAPM.ed.BSC4_""">",!
 w "  <frame name=""E3"" >",!
 w "</frameset>",!
 D END^%ZAPM.ed.BSC4
 Q
VAR //СОЗДАТЬ ПЕРЕМЕННЫЕ
 S pP=$$%^%ZAPM.ed.BSCh(BSPART),pT=$$%^%ZAPM.ed.BSCh(BSTABL) I $E(pP,1)'="^" S pP="^"_pP
 S TB=$NA(@pP@(pT))
 S BD=$$KBD^%ZAPM.ed.BSF12(TB)
 S HTT=$$VARHTT()
 S ArrOUT=$$KBD^%ZAPM.ed.BSF12("^%ZAPM.ed.BSC4SNX(""OUT"")")
 S KOLK=$O(@TB@("KEY",""),-1)
 Q
VARHTT()
 N BSROU,BSUSER,BSMENU,BSTOP
 //S BSPART=$$%T^%ZAPM.ed.BSCh(P),BSTABL=$$%T^%ZAPM.ed.BSCh(T)
 Q $$ADDBSGET^%ZAPM.ed.BSC4
EDIT0 ;НАЧАЛО
 D BEG1^%ZAPM.ed.BSC4
 D JumpKey ;w "<script LANGUAGE=""JavaScript"" SRC=""/"_$G(BSDJS,"bs")_"/js/bsbd.js""></script>",!
 w "</head>",!
 D VAR
 Q
EDIT1 ;ФРэЙМ ИНДЕКСОВ
 N BD,TB,HTT,KOLK
 D EDIT0
 W "<BODY>"
 W BK,AF,"База данных "_RED_BD_EF_EF
 w "<form name=""EE1"">"_BK
 I $D(@TB@("KEY",0)) D KEYS(0) ;НУЛЕВОЙ ИМЕННОЙ КЛЮЧ
 e  w "<input type=""hidden"" name=""k0"" value="""">",BK
 F I=1:1:9 d
 .i $D(@TB@("KEY",I)) D KEYS(I)
 .e   w "<input type=""hidden"" name=""k"_I_""" value="""">",BK
 w "</form>"
 //w RED,"В индексах Запрещены символы ~%& ",EF
 D END
 Q
KEYS(I) ;ВЫВОД КЛЮЧЕЙ
 //W BK,"<BR> Key=",I," ",BLUE,$P(@TB@("KEY",I),"@",15),EF,"<BR>",BK
 W "Ключ=",I," ",BLUE,$P(@TB@("KEY",I),"@",15),EF,"<BR>",BK
 W " <INPUT name=b1u"_I_" title=""на первый ключ"" TYPE=""button"" VALUE=""&lt;&lt;"" onClick=""JumpKey("_I_",'BEG','"_HTT_"',EE1.k0.value,EE1.k1.value,EE1.k2.value,EE1.k3.value,EE1.k4.value,EE1.k5.value,EE1.k6.value,EE1.k7.value,EE1.k8.value,EE1.k9.value);"">",BK
 W "<INPUT name=b2u"_I_" title=""на предыдущий ключ"" TYPE=""button"" VALUE=""&lt;"" onClick=""JumpKey("_I_",'MIN','"_HTT_"',EE1.k0.value,EE1.k1.value,EE1.k2.value,EE1.k3.value,EE1.k4.value,EE1.k5.value,EE1.k6.value,EE1.k7.value,EE1.k8.value,EE1.k9.value);"">",BK
 W "<INPUT title=""Поле текущего ключа"" name=""k"_I_""" TYPE=""text"" SIZE=10 VALUE="""" " d  w "onClick=""JumpKey("_I_",'LIST','"_HTT_"',EE1.k0.value,EE1.k1.value,EE1.k2.value,EE1.k3.value,EE1.k4.value,EE1.k5.value,EE1.k6.value,EE1.k7.value,EE1.k8.value,EE1.k9.value);"">",BK
 .w "onkeypress='if (13 == event.keyCode) return false;' "
 W "<INPUT name=b3u"_I_" title=""на последущий ключ"" TYPE=""button"" VALUE=""&gt;"" onClick=""JumpKey("_I_",'MAX','"_HTT_"',EE1.k0.value,EE1.k1.value,EE1.k2.value,EE1.k3.value,EE1.k4.value,EE1.k5.value,EE1.k6.value,EE1.k7.value,EE1.k8.value,EE1.k9.value);"">",BK
 W "<INPUT name=b4u"_I_" title=""на последний ключ"" TYPE=""button"" VALUE=""&gt;&gt;"" onClick=""JumpKey("_I_",'END','"_HTT_"',EE1.k0.value,EE1.k1.value,EE1.k2.value,EE1.k3.value,EE1.k4.value,EE1.k5.value,EE1.k6.value,EE1.k7.value,EE1.k8.value,EE1.k9.value);"">",BK
 W "<INPUT name=b5u"_I_" title=""удалить ключ"" TYPE=""button"" VALUE=""del"" onClick=""if (confirm('Удаляем "_I_" узел ! Вы уверены ?')) { JumpKey("_I_",'DEL','"_HTT_"',EE1.k0.value,EE1.k1.value,EE1.k2.value,EE1.k3.value,EE1.k4.value,EE1.k5.value,EE1.k6.value,EE1.k7.value,EE1.k8.value,EE1.k9.value); }"">",BK
 Q
EDIT4 D BEG1^%ZAPM.ed.BSC4 W "<BODY><BR>" //"<center> Кликните 2 раза на ПОЛЕ КЛЮЧА для вывода перечня всех значений КЛЮЧА текущего уровня</center>"
 D END^%ZAPM.ed.BSC4
 Q
refresh() q "JumpKey("_$O(@TB@("KEY",""))_",'BEG','"_HTT_"','','','','','','','','','','');"
SAVECARD W "<input type=""submit"" value=""Сохранить изменения"" name=""BSB1"" onmouseover=""SaveKey();"">"
    W "<BUTTON title='ESC' onclick=""javascript:"_$$refresh_""">Отменить изменения</BUTTON>"
 q
EDIT2 ;ФРЭЙМ КАРТОЧКИ БД
 N BD,TB,Y,X,BS,st,dcell
 D EDIT0
 W BR,"<BODY ONLOAD="""_$$refresh_""">"
 W BK,"<H2>",BLUE,$P(@TB,"@"),EF,"</H2>"
 W "<form name='EE2' action="""_$$ADDLIB^%ZAPM.ed.BSC4()_""" method=""POST"" target='E5'>"
 d SAVECARD
 w "<table border=0>"
 F Y=1:1 Q:'$D(@TB@(Y))  D
 .W "<tr>"
 .F X=1:1 Q:'$D(@TB@(Y,X))  D
 ..W "<td class=s3 "_$S(X=1:"WIDTH=30%",1:"")_" >" S BS=@TB@(Y,X)
 ..I $P(BS,"@",9)=1 D  ;S dcell=$E($$CELL^%ZAPM.ed.BSCt(TB,Y,X),1,$P(BS,"@",4)*$P(BS,"@",3)) W:dcell'?1N dcell  ;ДАННЫЕ КЛЕТКИ
 ...S dcell=$$CELL^%ZAPM.ed.BSCt(TB,Y,X) W:dcell'?1N dcell
 ..E  D
 ...//I $P(BS,"@",21)=???
 ...I $P(BS,"@",21)=1 W "<TEXTAREA name=""X"_Y_"x"_X_""" cols="_$P(BS,"@",4)_" rows="_$S($P(BS,"@",3)<4:4,1:$P(BS,"@",3))_" title='Y:"_Y_" X:"_X_" Field:"_$P($p(BS,"@",18),"#",1)_" Type:"_$P(BS,"@",21)_"'></TEXTAREA>" Q
 ...W "<INPUT TYPE=""text"" name=""X"_Y_"x"_X_""" SIZE=115 VALUE="""" title='Y:"_Y_" X:"_X_" Field:"_$P($p(BS,"@",18),"#",1)_" Type:"_$P(BS,"@",21)_"'>" s st(Y)=$g(st(Y))_"'&y"_Y_"x"_X_"='+e(EE2.X"_Y_"x"_X_".value)+"
 ..W "</td>"
 .W "</tr>",BK
 w "</table>"
 S BSLABEL="HIDD^~BSChT1"
 //w "<input type=""hidden"" name=""BSNSPACE"" value="""_BSNSPACE_""">",BK
 //w "<input type=""hidden"" name=""BSROU"" value=""MAIN^~BSCh1"">",BK
 //w "<input type=""hidden"" name=""BSLABEL"" value=""HIDD^~BSChT1"">",BK
 //w "<input type=""hidden"" name=""BSPART"" value="""_BSPART_""">",BK
 //w "<input type=""hidden"" name=""BSTABL"" value="""_BSTABL_""">",BK
 w "<input type=""hidden"" name=""BSA"" value=""SAVE"">",BK
 w "<input type=""hidden"" name=""BSK"" value="""_KOLK_""">",BK
 F X=0:1:9 w "<input type=""hidden"" name=BSK"_X_" VALUE="""">",BK
 N BSTOP,BS
 D ADDBSPOST^%ZAPM.ed.BSC4reg
 d SAVECARD
 w "</form>"
 w BK,"<script LANGUAGE=""JavaScript"">",BK
 W "function SaveKey() {",BK
 W "parent.E2.EE2.BSK0.value=parent.E1.EE1.k0.value;",BK
 W "parent.E2.EE2.BSK1.value=parent.E1.EE1.k1.value;",BK
 W "parent.E2.EE2.BSK2.value=parent.E1.EE1.k2.value;",BK
 W "parent.E2.EE2.BSK3.value=parent.E1.EE1.k3.value;",BK
 W "parent.E2.EE2.BSK4.value=parent.E1.EE1.k4.value;",BK
 W "parent.E2.EE2.BSK5.value=parent.E1.EE1.k5.value;",BK
 W "parent.E2.EE2.BSK6.value=parent.E1.EE1.k6.value;",BK
 W "parent.E2.EE2.BSK7.value=parent.E1.EE1.k7.value;",BK
 W "parent.E2.EE2.BSK8.value=parent.E1.EE1.k8.value;",BK
 W "parent.E2.EE2.BSK9.value=parent.E1.EE1.k9.value;",BK
 ;W "alert(parent.E2.EE2.BSK1.value);",BK
 W "}",BK
 W "function SaveData(k,a,HTT,k0,k1,k2,k3,k4,k5,k6,k7,k8,k9) {",BK
 ;русские буквы
 //W "var s=HTT+'&BSK='+k+'&BSA='+a+'&"_$$BSDJS()_"BSLABEL=HIDD^~BSChT1'+'&BSK0='+k0+'&BSK1='+k1+'&BSK2='+k2+'&BSK3='+k3+'&BSK4='+k4+'&BSK5='+k5+'&BSK6='+k6+'&BSK7='+k7+'&BSK8='+k8+'&BSK9='+k9+"
 W "var s=HTT+'&BSK='+k+'&BSA='+a+'&BSLABEL=HIDD^~BSChT1'+'&BSK0='+k0+'&BSK1='+k1+'&BSK2='+k2+'&BSK3='+k3+'&BSK4='+k4+'&BSK5='+k5+'&BSK6='+k6+'&BSK7='+k7+'&BSK8='+k8+'&BSK9='+k9+"
 ;%$@#^!
 ;w "var s=HTT+'&BSK='+k+'&BSA='+a+'&"_$$BSDJS()_"BSLABEL=HIDD^~BSChT1'+'&BSK0='+k0+'&BSK1='+e(k1)+'&BSK2='+e(k2)+'&BSK3='+e(k3)+'&BSK4='+e(k4)+'&BSK5='+e(k5)+'&BSK6='+e(k6)+'&BSK7='+e(k7)+'&BSK8='+e(k8)+'&BSK9='+e(k9)+"
 S I=$O(st(""),-1),st(I)=$E(st(I),1,$L(st(I))-1)
 s i="" F  s i=$O(st(i)) Q:i=""  W st(i)
 W BK,"parent.E3.location=s",BK
 W "}",BK
 W "</script>",BK
END W "</BODY></HTML>",BK
 Q
RESET    W "<div align='right'><A HREF=""javascript:"_$$refresh_""">Отменить изменения</A></div>",BK
 Q
HIDD ;СКРЫТАЯ 3 ФОРМА = ДИСПЕТЧЕР
 N BD,TB,Y,X,BS,I,KEY,CBD,STOP,KOLK,ER1
 D BEG1^%ZAPM.ed.BSC4
 D JumpKey
 D VAR
 ;--------------
 w BK,"<script LANGUAGE=""JavaScript"">",BK
 W "function DoAction() {",BK
 ;W "alert(111);",BK
 ;F I=0:1:9 I $D(@("BSK"_I)) S KEY(I)=$G(@("BSK"_I))
 F I=0:1:9 S KEY(I)=$G(@("BSK"_I))
 ;W "/*",BK
 ;D WL("CBD")
 ;ZW KEY
 ;w BSK
 ;W BK,"*/",BK
 S CBD=BD
 I BSK>0 S CBD=BD_$G(BSK0) D HKK(0)
 F I=1:1:BSK-1  D HKK(I) D
 .I KEY(I)'="" S CBD=$NA(@CBD@(KEY(I))) Q
 .I KEY(I)="" S ER1=I_","_$G(ER1)
 I KEY(BSK)="",BSA="SAVE" S ER1=BSK
 I $D(ER1),BSA="SAVE" W "alert('Значение ключа #"_ER1_" пустое!'); ",BK
 I BSA'="LIST",'$D(ER1) D HIDACT
 W "}",BK
 W "</script>",BK
 ;--------------
 w "</head>",!
 W BK,"<BODY ONLOAD=""DoAction();"">"
 I BSA="LIST" d LIST
 D END
 Q
HKK(K) i BSA="LIST"!(BSA="DEL") q
 I '$D(KEY(K)) Q  W "alert('НЕТ "_K_" КЛЮЧА!');" Q
 W "parent.E1.EE1.k"_K_".value='"_KEY(K)_"';",BK
 Q
Keys2P3(BSK,BD,CBD)
 i BSK=0 d
 .S K=0,P0=$$GD^%ZAPM.ed.BSCp("","B") ;ТОЛЬКО БАЗЫ ДАННЫХ
 .K P3 I BD["]" S BD="^"_$P(BD,"]",2)
 .S i="" F  S i=$O(@P0@(i)) Q:i=""  S P1="^"_i I P1[BD,$P(P1,BD,2)'="" S P3($P(P1,BD,2))=""
 i BSK'=0 d
 .K P3
 .s i="" f  s i=$O(@CBD@(i)) q:i=""  S P3(i)=""
 Q
LIST ;перечень ключей
 W "<form name=""EE4"" action="""_$$ADDLIB^%ZAPM.ed.BSC4()_""" method=""POST"" target='E5'>"
 w "<table width=100% border=0>"
 w "<tr><td class=s1 align='right'>"_BSK_"</td>"
 W "<td class=s1>уровень. Значений <INPUT TYPE=""text"" DISABLED name=KOL SIZE=3 VALUE="""" ></td>"
 W "</tr>"
 N P1,P2,P3,K
 D Keys2P3(BSK,BD,CBD)
 S K=0
 s i="" f  s i=$O(P3(i)) q:i=""  D  S K=K+1
 .I K=0 w "<tr><td class=s3>"_$$GroupC("","")_"</td><td class=s3>" D ACT0 W $$GroupA_"</td></tr>",BK
 .w "<tr><td class=s1>"_$$GroupC(K,i)_"</td><td class=s1><a title='"_$G(@CBD@(i))_"' href=""javascript:NodeSet('"_i_"');"">",i,"</a></td></tr>",BK
 w "</table>"
 S BSLABEL="ActNode^~BSChT1",BSCBD1=$$%T^%ZAPM.ed.BSCh(BD)
 D ADDBSPOST^%ZAPM.ed.BSC4reg
 W "</form>"
 w BK,"<script LANGUAGE=""JavaScript"">",BK
 w "parent.E4.EE4.KOL.value="_K_";",BK
 W "function NodeSet(i) {",BK
    w "JumpKey("_(BSK+1)_",'BEG','"_HTT_"'"
    F I=0:1:BSK-1 w ",'"_KEY(I)_"'"
    w ",i"
    F I=BSK+1:1:9 w ",''"
 w ");",BK
 W "}",BK
 W "</script>",BK
 q
ActNode //групповое действие над узлом бд
 N BD,TB,Y,X,BS,I,KEY,CBD,STOP,KOLK,ER1
 D BEG1^%ZAPM.ed.BSC4
 D VAR
 N P1,P2,P3,K,MSG,AN
 S (BD,CBD)=$$%^%ZAPM.ed.BSCh(BSCBD1)
 I BSK>0 S CBD=BD_$G(BSK0)
 F I=1:1:+BSK-1 I @("BSK"_I)'="" S CBD=$NA(@CBD@(@("BSK"_I)))
 
 D Keys2P3(BSK,BD,CBD)
 S K=0,K1=0,MSG="Никаких действий не произведено..."
 I $G(Act0)=3 D  //...............УДАЛИТЬ
 .I $D(CheckW) D  Q  //ВСЕ УЗЛЫ
 ..K @CBD S MSG="Узел `"_CBD_"` удален" D SNX("K",$zr,TB)
 .s i="" f  s i=$O(P3(i)) q:i=""  D  S K=K+1
 ..I $D(@("CheckW"_K)) D CLEAR^%ZAPM.ed.BSCm4($NA(@CBD@(i)),TB) K @CBD@(i) D SNX("K",$zr,TB) S K1=K1+1
 .S MSG="Удалено "_K1_" узлов"
  /*
 I $G(Act0)=2 D  //...............ПОСЛАТЬ
 .I $D(CheckW) S AN=1
 .s i="" f  s i=$O(P3(i)) q:i=""  D  S K=K+1
 ..I $D(@("CheckW"_K))!($D(AN)) //S @CBD@(i) S K1=K1+1
 .S MSG="Помечено "_K1_" узлов"
 */
 w BK,"<script LANGUAGE=""JavaScript"">",BK
 W "function DoAction() {",BK
 I $D(MSG) W "alert('"_MSG_"');",BK
 ;W "/*",BK
 ;D WL("CBD")
 ;ZW KEY
 ;W BK,"*/",BK
 W "}",BK
 W "</script>",BK
 ;--------------
 w "</head>",!
 W BK,"<BODY ONLOAD=""DoAction();"">"
 D END
 Q
ACT0 ;ГРУППОВЫЕ ДЕЙСТВИЯ
 N I,T
 S T=1 W "<select name='Act0' size=1>"
 F I=" ",$$LNG^%ZAPM.ed.BSC4("..."),$$LNG^%ZAPM.ed.BSC4("Удалить",119) W "<option value='"_T_"'>"_I_"</option>" S T=T+1
 W "</select>"
 Q
GroupC(N,NN) Q "<input type=""checkbox"" title='"_$$LNG^%ZAPM.ed.BSC4("Групповая работа включая ",122)_$S(N="":$$LNG^%ZAPM.ed.BSC4("всех ",123)_CBD,1:$NA(@CBD@(NN)))_"' name='CheckW"_N_"' value=''>"
GroupA() Q "<input type=""submit"" name='ActOK0' title='"_$$LNG^%ZAPM.ed.BSC4("Групповое действие",79)_"' value='Выполнить'>"
HIDACT ;ДЕЙСТВИЕ
 N Er2,Er8
 I BSA="SAVE" D  Q
 .d CBD N N3 d SAVE
 .W BK,"alert('СОХРАНИЛИ В УЗЛЕ "_CBD_" - "_N3_" ЗНАЧЕНИЙ');",BK
 I BSA="DEL" D
 .i KEY(BSK)="" W BK,"alert('УЗЕЛ "_$zr_" ПУСТОЙ!');",BK G DEL1
 .I BSK=0 S Er8=$NA(@(CBD_KEY(BSK)))
 .E  S Er8=$NA(@CBD@(KEY(BSK)))
 .D CLEAR^%ZAPM.ed.BSCm4(Er8,TB)
 .K @Er8
 .W BK,"alert('УДАЛИЛИ УЗЕЛ "_$zr_" ');",BK
 .D SNX("K",$zr,TB)
DEL1 .S BSA="MIN"
 ;НУЛЕВОЙ ИМЕННОЙ КЛЮЧ
 I BSK=0,$D(@TB@("KEY",0)) W "parent.E1.EE1.k0.value='"_$$HKEY0(0)_"';",BK I $D(STOP) Q
 ;ИНДЕКСНЫЕ КЛЮЧИ
 S i=$S(BSK=0:1,1:BSK)
 F I=i:1:KOLK W "parent.E1.EE1.k"_I_".value='"_$$HKEY(I)_"';",BK I $D(STOP) Q
 I $D(Er2)       W "alert('"_Er2_"."_" Окно браузера будет закрыто.');",BK,"parent.window.close();"_BK Q
 I '$D(STOP) D HDATA ;КАРТА БД
 Q
CBD S CBD=$NA(@CBD@(KEY(BSK)))
 q
WL(L) ;ВЫВЕСТИ ЗНАЧЕНИЕ ЛОКАЛИ
 F I=1:1 Q:$P(L,",",I,I+1)=""  W "// ",$P(L,",",I),"=",$g(@$P(L,",",I),"undef..."),BK
 W BK Q
DI(N,Y) S Y=$S(Y=1:"YES",1:"") W "parent.E1.EE1.b"_N_"u"_I_".disabled='"_Y_"';",BK
 Q
DIS(G,U) ;ПРОВЕРКА
 I $O(@G@(U))="" D DI(3,1),DI(4,1)
 I $O(@G@(U))'="" D DI(3,0),DI(4,0)
 I $O(@G@(U),-1)="" D DI(1,1),DI(2,1)
 I $O(@G@(U),-1)'="" D DI(1,0),DI(2,0)
 Q
HKEY0(I) ;ИМЕННОЙ
 N P1,P2,P3,K
 S K=0,P0=$$GD^%ZAPM.ed.BSCp("","B") ;ТОЛЬКО БАЗЫ ДАННЫХ
 K P3 I BD["]" S BD="^"_$P(BD,"]",2)
 ;D WL("BD,P0")
 S i="" F  S i=$O(@P0@(i)) Q:i=""  S P1="^"_i I P1[BD,$P(P1,BD,2)'="" S P3($P(P1,BD,2))=""
 I '$D(P3) Q ""
 I BSA="MAX" I $$ZK(1) S KEY(K)=$O(P3(KEY(K))) D DIS("P3",KEY(K)),HK0  D DI(5,$S(KEY(K)="":1,1:0))
 I BSA="MIN" I $$ZK(-1) S KEY(K)=$O(P3(KEY(K)),-1) D DIS("P3",KEY(K)),HK0   D DI(5,$S(KEY(K)="":1,1:0))
 I BSA="BEG" S KEY(K)=$O(P3("")) D DIS("P3",KEY(K)),HK0  D DI(5,$S(KEY(K)="":1,1:0))
 I BSA="END" S KEY(K)=$O(P3(""),-1) D DIS("P3",KEY(K)),HK0  D DI(5,$S(KEY(K)="":1,1:0))
 Q KEY(K)
HKEY(K) ;ИНДЕКСЫ
 I '$$Data^%ZAPM.ed.BSF12(CBD) S Er2="Нет доступа до "_$G(CBD,"?") Q ""
 I K'=BSK D  Q KEY(K)
 .S KEY(K)=$O(@CBD@("")) D DIS(CBD,KEY(K)),HK
 ;I $D(KEY(K-1)),KEY(K-1)="" S KEY(K)="" Q ""
 I BSA="MAX" I $$ZK(1) S KEY(K)=$O(@CBD@(KEY(K))) D DIS(CBD,KEY(K)),HK   D DI(5,$S(KEY(K)="":1,1:0))
 I BSA="MIN" I $$ZK(-1) S KEY(K)=$O(@CBD@(KEY(K)),-1) D DIS(CBD,KEY(K)),HK   D DI(5,$S(KEY(K)="":1,1:0))
 I BSA="BEG" S KEY(K)=$O(@CBD@("")) D DIS(CBD,KEY(K)),HK   D DI(5,$S(KEY(K)="":1,1:0))
 I BSA="END" S KEY(K)=$O(@CBD@(""),-1) D DIS(CBD,KEY(K)),HK  D DI(5,$S(KEY(K)="":1,1:0))
 Q KEY(K)
HK I KEY(K)'="" S CBD=$NA(@CBD@(KEY(K)))
 Q
HK0 I KEY(K)'="" S CBD=CBD_KEY(K)
 Q
ZK(P) I KEY(K)="" G ZK1
 I K=0,$O(P3(KEY(K)),P)'="" Q 1
 I $O(@CBD@(KEY(K)),P)'="" Q 1
ZK1 W BK,"alert('ДАЛЬШЕ НЕЛЬЗЯ !');",BK S STOP=1
 Q 0
JumpKey ;
 w BK,"<script LANGUAGE=""JavaScript"">",BK
 W "function JumpKey(k,a,HTT,k0,k1,k2,k3,k4,k5,k6,k7,k8,k9) {",BK
 W "//русские буквы",BK
 W "var s=HTT+'&BSK='+k+'&BSA='+a+'&BSLABEL=HIDD^~BSChT1'+'&BSK0='+k0+'&BSK1='+k1+'&BSK2='+k2+'&BSK3='+k3+'&BSK4='+k4+'&BSK5='+k5+'&BSK6='+k6+'&BSK7='+k7+'&BSK8='+k8+'&BSK9='+k9;",BK
 ;W "//%$@#^!"
 ;W "//var s=HTT+"&BSK="+k+"&BSA="+a+"&BSLABEL=HIDD^~BSChT1"+"&BSK0="+k0+"&BSK1="+e(k1)+"&BSK2="+e(k2)+"&BSK3="+e(k3)+"&BSK4="+e(k4)+"&BSK5="+e(k5)+"&BSK6="+e(k6)+"&BSK7="+e(k7)+"&BSK8="+e(k8)+"&BSK9="+e(k9)
 W "if (a==""LIST"") { parent.E4.location=s;",BK
 ;   // alert(k+' '+a+' '+HTT);
 W "     return true;",BK
 W "     }",BK
  ;//  alert(k+' '+a+' '+HTT);
 W "parent.E3.location=s;",BK
 W "}",BK
 W "function e(S) { return escape(S);",BK
 W "}",BK
 W "function u(S) { return unescape(S);",BK
 W "}",BK
 W "</script>",BK
 Q
HDATA ;БД
 N N1,N2,N3,Y,X,BS
 F Y=1:1 Q:'$D(@TB@(Y))  D
 .F X=1:1 Q:'$D(@TB@(Y,X))  D
 ..S BS=@TB@(Y,X) I $P(BS,"@",9)=1 Q
 ..S N1="X"_Y_"x"_X
 ..I $P($P(BS,"@",18),"#")'="" S N2=$P($P(BS,"@",18),"#")
 ..E  S N2=Y_","_X
 ..S N3=$G(@CBD@(N2)),N3=$$CTRL^%ZAPM.ed.BSre(N3) ;УДАЛЕНИЕ УПРАВЛЯЮЩИХ СИМВОЛОВ из данных
 ..I N3'="" W "parent.E2.EE2."_N1_".value='"_N3_"';",BK
 ..E  W "parent.E2.EE2."_N1_".value='';",BK
 Q
SAVE ;сохранить
 ;D WL("CBD")
 I '$D(@(BD_KEY(0))) S @(BD_KEY(0))=$G(@BD,"BSD - MSW@")
 N N1,N2,Y,X,BS S N3=0
 F Y=1:1 Q:'$D(@TB@(Y))  D
 .F X=1:1 Q:'$D(@TB@(Y,X))  D
 ..S BS=@TB@(Y,X) I $P(BS,"@",9)=1 Q
 ..S N1=$g(%KEY("X"_Y_"x"_X))
 ..I $P($P(BS,"@",18),"#")'="" S N2=$P($P(BS,"@",18),"#")
 ..E  S N2=Y_","_X
 ..S N3=N3+$$DataSet(CBD,N2,N1)
 I N3 S @CBD=$H_","_$G(BSLOGIN)_",1" D SNX("S",$zr,TB)
 q
DataSet(CBD,NODE,VAL) //ПРИСВОИТЬ НОВЫЕ ЗНАЧЕНИЯ В БАЗУ ДАННЫХ
 N OLD   I NODE="" Q 0
 S $ZT="ERRDataSet"
 S OLD=$G(@CBD@(NODE))
 I VAL=OLD Q 0
 I VAL="" K @CBD@(NODE)
 E  S @CBD@(NODE)=VAL
 Q 1
ERRDataSet W " Ошибка присвоения! " Q 0
SNX(S,zr,PT,Arr) //ПРИСВОЕННЫЕ УЗЛЫ ДЛЯ СИСТЕМЫ СИНХРОНИЗАЦИИ
 i '$$GETOPT^%ZAPM.ed.BSC4cfgP("^%ZAPM.ed.BSC4SNX.Par","Aaa") q  //протокол выключен
 I $D(Arr) S ArrOUT=Arr ;".."_$INCREMENT(@(%BS(24,1)_".I")) S (^mtempBSsinx,^mtempBSprot)=1
 I '$D(ArrOUT) S ArrOUT=$$KBD^%ZAPM.ed.BSF12("^%ZAPM.ed.BSC4SNX(""OUT"")")
 S @ArrOUT@(+$H,$P($H,",",2)_".."_$INCREMENT(^mtempBSsinx),zr,"A")=S,^("D")=PT,^("L")=$G(BSLOGIN),^("NS")=$zu(5)
 Q
]]></Routine>


<Routine name="%ZAPM.ed.BSChW" type="MAC" languagemode="0"><![CDATA[
%BSChW ; пpогpамма BS WEB LINK ; 15:41   19.06.2002
 ;
 ; Copyright (c) Serge W. Mikhaylenko
 ; All Rights Reserved
 ;
 W "7,<BsWebLink>",$ZE,$C(13,10),!
 Q
Deamons(mdapi,TKweb,smtp,POP,Term) //КОНФИГУРАЦИЯ И ЗАПУСК ДЕМОНОВ
 //СОХРАНЕНИЕ ОБЩЕСИСТЕМНЫХ ПАРАМЕТРОВ (СИНИЙ МОЛОТОК)
 I TKweb'="" D SETOPT^%ZAPM.ed.BSC4cfgP("^%ZAPM.ed.BSETUP(""ISS"")","Atkweb","V",TKweb)
 I Term'="" D SETOPT^%ZAPM.ed.BSC4cfgP("^%ZAPM.ed.BSETUP(""ISS"")","Aterm","V",Term)
 I mdapi'="" D SETOPT^%ZAPM.ed.BSC4cfgP("^%ZAPM.ed.BSETUP(""ISS"")","Atmdapi","V",mdapi)
 I smtp'="" D SETOPT^%ZAPM.ed.BSC4cfgP("^%ZAPM.ed.BSETUP(""ISS"")","Atkmail","V",smtp_","_POP)
 D Save123^%ZAPM.ed.BSC4cfgP S P6=""
 I TKweb'="" J ^%ZAPM.ed.BSpgWEBC K St S $P(P6,",",2)=$$showstatus^%ZAPM.ed.BSCmdapi(.St,"%BSpgWEBC","|TCP|"_TKweb)
 I Term'="" J ^%ZAPM.ed.BSpgTEL K St S $P(P6,",",5)=$$showstatus^%ZAPM.ed.BSCmdapi(.St,"%BSpgTEL","|TCP|"_Term)
 I mdapi'="" D start^%ZAPM.ed.BSCmdapi K St S $P(P6,",",1)=$$showstatus^%ZAPM.ed.BSCmdapi(.St,"%BSCmdapi")
 I smtp'="" D STARTMAIL^%ZAPM.ed.BSpgWEBC  K St S $P(P6,",",3)=$$showstatus^%ZAPM.ed.BSCmdapi(.St,"%BSpgWEBC","|TCP|"_smtp)
 I POP'="" D STARTMAIL^%ZAPM.ed.BSpgWEBC  K St S $P(P6,",",4)=$$showstatus^%ZAPM.ed.BSCmdapi(.St,"%BSpgWEBC","|TCP|"_POP)
 Q $g(P6)
PrepFileCopy(P1,P2,P3) ;ПОДГОТОВИТЬ КОПИРОВАНИЕ
 K MM S M=1,P5=P2_$P(P3,P1,2)
 I $ZV["Windows" S P5=$TR(P5,"/","\") F I=1:1:$L(P5,"\")-1 S II=$P(P5,"\",1,I)_"\"  I $ZU(140,4,II)'=0 I $ZU(140,9,II)
 E  S P5=$TR(P5,"\","/")  F I=1:1:$L(P5,"/")-1 S II=$P(P5,"/",1,I)_"/"  I $ZU(140,4,II)'=0 I $ZU(140,9,II)
 ;I $ZU(140,5,P5) //УДАЛИТЬ ФАЙЛ
 Q
FileCopy(P4) ;КОПИРОВАНИЕ
 S MM(M)=P4,M=M+1
 Q
FileCopyEnd() ;КОПИРОВАНИЕ
 Q $$Arr2File^%ZAPM.ed.BSCEXE(.MM,P5)
CLEARGLAVK //ОЧИСТИТЬ ССЫЛКИ ОТ GLAVK
 S ^%ZAPM.ed.BSS("TRIGGER","KEY")="^%ZAPM.ed.BStrigg"
 S ^%ZAPM.ed.BSS("USER","KEY")="^%ZAPM.ed.BSuserS"
 S $P(^%ZAPM.ed.BSS("PATH",6,4),"@",15)="^%ZAPM.ed.BSprotkl"
 F I=2:2:12 S ^%ZAPM.ed.BSS("SERVER",I,4)=$$TR^%ZAPM.ed.BSsFUNM(^%ZAPM.ed.BSS("SERVER",I,4),"[""GLAVK""]","%")
 Q 
INIT ;первоначальная ИНИЦИАЛИЗАЦИЯ
 ;S ^MGWAPP("BSWEBLINK")="MGWAPP^%ZAPM.ed.BSChW" ;OCX КОМПОНЕНТА BsWebLTP
 ;S ^MGWAPP("BSQLG")="MAIN^%ZAPM.ed.BSCGH" ;%BS - SQL GateWay
 ;S ^MGWAPP("BSMAIN")="MAIN^%ZAPM.ed.BSCh1" ;Навигатор по ресурсам %BS+Cache'
 d initBD
 ;D ALLPART^%ZAPM.ed.BSCBD("^%ZAPM.ed.BSC") //КОМПИЛЯЦИЯ СИСТЕМНЫХ ТАБЛИЦ %BS
 ;D COMP^%ZAPM.ed.BSCm2 //КОМПИЛЯЦИЯ ПРИКЛАДНЫХ ТАБЛИЦ %BS
 ;d cpf^%ZAPM.ed.BSCm2 //перечитать без перезагрузки
 D upg(0) //обновление и рекомпиляция классов для 5 версии для всех кипов
 D INIT^%ZAPM.ed.BSC4reg
 D SYSXXX
 ;M ^login=^%ZAPM.ed.BS("login") //УСТАНОВКА НОВЫХ ТЕРМИНАЛЬНЫХ ПОЛЬЗОВАТЕЛЕЙ
 ;D BSS2PROT^%ZAPM.ed.BSCm2 //MSM+ISS ПОЛЬЗОВАТЕЛИ
 ;D 0^%ZAPM.ed.BSCm2 //ПРОКАЧКА БАЗЫ - GLAVK - ОЧИСТКА MSM-РУДИМЕНТОВ
 ;D SETUP^%ZAPM.ed.BSCm2(NEWPATH/)   // ПОСЛЕ ИНСТАЛЛЯЦИИ КОМПЛЕКСА - НАСТРОЙКА ISS+Portal //////
 ;D DelBS^%ZAPM.ed.BSC4r //УДАЛИТЬ ИСХОДНЫЕ ТЕКСТЫ ПРОГРАММ
 d zs
 d tkweb
 d setNameMainServer //установка основного почтового сервера и права админа
 
 //обновить узлы в FON для Табеля 2005
 F I=7:1 Q:'$D(^%ZAPM.ed.BSCiP("KEYS",I))  K ^%ZAPM.ed.BSCiP("KEYS",I) //ИСПРАВИТЬ ОШИБКУ
 I $D(^%ZAPM.ed.BStemp),$$ZU^%ZAPM.ed.BSF4("FON") N G S G="^%ZAPM.ed.BStemp" D FON^%ZAPM.ed.BSCAsIs1(G,0) ;K @G //ВОССТАНОВИТЬ МАССИВЫ В FON
 ZN "%SYS"
 Q 
iniT ;первоначальная ИНИЦИАЛИЗАЦИЯ
 d initBD
 D INIT^%ZAPM.ed.BSC4reg
 d zs
 d tkweb
 S BB="Аdministrator"
 S A=BB_" <B4I@"_$ZU(110)_">тел.911;)" //УСТАНОВИТЬ АДМИНИСТРАТОРОМ B4I
 D SETOPT^%ZAPM.ed.BSC4cfgP("^%ZAPM.ed.BSETUP(""ISS"")","Admin","V",A)
 d setNameMainServer
 q
zs
 ZN "%SYS"
 //???I '$D(tmp) X "ZL %BSCZSTU ZS ZSTU"
 X "ZL %BSCZSTU ZS ZSTU"
 X "ZL %BSCZSHT ZS ZSHUTDOW"
 X "ZL %BSCnewF11 ZS %BSF11"
 ;X "ZL %BS364 ZS %X364"
 ;X "ZL %BSZSTART ZS %ZSTART"
 ;X "ZL %BSZSTOP ZS %ZSTOP"
 q
initBD
 N BD 
 S Co=$ZU(5)
 S BD=$$KBD^%ZAPM.ed.BSF12("^%ZAPM.ed.BSC(""BSG"")") I BD="" Q
 S @BD@("SQL","REM")="МОНИТОР <<SQL GATE WAY>>"
 S @BD@("SQL","ROU")="MAIN^%ZAPM.ed.BSCGH"
 S @BD@("SQL","NSP")=Co
 S @BD@("BSWEBLINK","REM")="УТИЛИТА BSWEBLINK"
 S @BD@("BSWEBLINK","ROU")="MGWAPP^%ZAPM.ed.BSChW"
 S @BD@("BSWEBLINK","NSP")=Co
 S BD=$$KBD^%ZAPM.ed.BSF12("^%ZAPM.ed.BSC(""BSQLDSN"")") I BD="" Q
 S @BD@("127.0.0.1","CacheSYS")=""
 S @BD@("127.0.0.1","CacheGLAVK")=""
 S @BD@("127.0.0.1","SH1")=""
 S @BD@("127.0.0.1","KSP")=""
 S @BD@("SQL",1,"SQL1")="SELECT * FROM TABLE1 WHERE (FELD1) LIKE 'FIRST%'"
 S @BD@("SQL",2,"SQL1")="INSERT INTO TABLE1 (FELD1,FELD2) VALUES ('ЗНАЧЕНИЕ1','ЗНАЧЕНИЕ1')"
 S @BD@("SQL",3,"SQL1")="DELETE FROM TABLE1 WHERE FELD1='123'"
 S BD=$$KBD^%ZAPM.ed.BSF12("^%ZAPM.ed.BSC(""MAIL"")") S @BD@(1,1,1,"U")=""
 S BD=$$KBD^%ZAPM.ed.BSF12("^%ZAPM.ed.BSC(""VISIT"")") S @BD@(1,1,"P")=""
 q
tkweb
 //здесь были проблеммы!!!!
 I $G(^["%SYS"]tempBSDSR(-1))'="" S N=@$ZR D
 .S:N=1 N="C:\InfoPortal\" D SETTKWEB^%ZAPM.ed.BSCm2(N)
 .I '$$GETOPT^%ZAPM.ed.BSC4cfgP("^%ZAPM.ed.BSETUP(""ISS"")","Atkweb") D
 ..S A=$$GETOPT^%ZAPM.ed.BSC4cfgP("^%ZAPM.ed.BSETUP(""ISS"")","Atkweb","D") I 'A S A=1962
 ..D SETOPT^%ZAPM.ed.BSC4cfgP("^%ZAPM.ed.BSETUP(""ISS"")","Atkweb","V",A) S $P(^%ZAPM.ed.BSpgWEBC("Control"),",",7)=A
 .I '$$GETOPT^%ZAPM.ed.BSC4cfgP("^%ZAPM.ed.BSETUP(""ISS"")","Atmdapi") D
 ..S A=$$GETOPT^%ZAPM.ed.BSC4cfgP("^%ZAPM.ed.BSETUP(""ISS"")","Atmdapi","D") I 'A S A=1961
 ..D SETOPT^%ZAPM.ed.BSC4cfgP("^%ZAPM.ed.BSETUP(""ISS"")","Atmdapi","V",A) S ^%ZAPM.ed.BSCmdapicfg("port")=A
 q
setNameMainServer N NS,A,OO,B,BB S A=$$GETOPT^%ZAPM.ed.BSC4cfgP("^%ZAPM.ed.BSETUP(""ISS"")","Admin") 
 S NS=$P($P(A,"@",2),">") I $ZCONVERT(NS,"U")'=$ZU(110) D
 .S B=$$GETOPT^%ZAPM.ed.BSC4cfgP("^%ZAPM.ed.BSETUP(""ISS"")","Acfg") I B'="" S BB=$$GETOPT^%ZAPM.ed.BSC4cfg(B,"ENDUSER") 
 .I $G(BB)="" S BB="Аdministrator"
 .S A=BB_" <B4I@"_$ZU(110)_">тел.911;)" //УСТАНОВИТЬ АДМИНИСТРАТОРОМ B4I
 .D SETOPT^%ZAPM.ed.BSC4cfgP("^%ZAPM.ed.BSETUP(""ISS"")","Admin","V",A)
 S OO=$NA(@$$KBD^%ZAPM.ed.BSF12("^%ZAPM.ed.BSC4(""PROTECT"")")@("B4I","FNM")),@OO@("Amail","V")=1 D Save1234^%ZAPM.ed.BSC4cfgP //РАЗРЕШИТЬ ЕМУ ПРИНИМАТЬ ПОЧТУ
 q
SYSXXX ; W BBK,"Добавлен терминальный пользователь '"_BSLOGIN_"'"_BBK
 I $$ZV^%ZAPM.ed.BSCp>5 Q  //ЕСЛИ ВЕРСИЯ ВЫШЕ 5.0
 N i,ons S ons=$ZU(5)
 S i="" F  S i=$O(^login(i)) Q:i=""  K ^login(i)
 ZN "%SYS" i $$AddUser^%Wsusers("SYS~XXX~%SYS~^%ZAPM.ed.BSC~0,0")
 I $ZU(5,ons)
 Q
SETLOG(V,BSLOGIN) //ЗАПИСАТЬ В ЛОГ ПОВЫШЕНИЕ ВЕРСИИ
 S BSLOGIN=$TR(BSLOGIN,$C(0,13,10),"")
 D Tex^%ZAPM.ed.BSMSMF("UpdateVersion",V),SYSMSG^%ZAPM.ed.BSCek("UpdateVersion "_V,"W")
 Q
MGWAPP ;OCX КОМПОНЕНТА BsWebLTP !!! ЗАПРЕЩЕНЫ ~ и |
 N iDCODE,I,P0,P1,P2,P3,P4,P5,P6,P7,P8,P9,VALUE,CODE,NSPACE,OldNS,CIn,COu,SCode,S1,S2
 F I=0:1:9 S @("P"_I)=$$%^%ZAPM.ed.BSCh($G(%KEY("P"_I)))
 I $G(%KEY("CIn")) D INIT^%ZAPM.ed.BSre(+$G(%KEY("SCode"))) F I=0:1:9 S @("P"_I)=$TR(@("P"_I),S2,S1)
 S iDCODE=$G(%KEY("iD_CODE"))
 s $zt="Err^%ZAPM.ed.BSChW",VALUE=""
 I $G(%KEY("CODE"))="" W "1,<BsWebLink>,<NoCode> НЕТ ПРОГРАММНОГО КОДА ",$C(13,10),! Q
 S ROU=$$%^%ZAPM.ed.BSCh($G(%KEY("CODE")))
 I $D(%KEY("NSPACE")) S NSPACE=$$%^%ZAPM.ed.BSCh(%KEY("NSPACE"))
 s OldNS=$zu(5)
 I $G(NSPACE)'="",$zu(5,NSPACE)
 D
 .N %KEY
 .I $E(ROU,1)="$" X "S VALUE="_ROU Q
 .I $E(ROU,1,2)?1A1" " X ROU Q
 .D @ROU
 s OldNS=$zu(5,OldNS)
 W "0,<BsWebLink>, ОШИБОК НЕТ",$C(13,10),!
 I $G(%KEY("COu")) D INIT^%ZAPM.ed.BSre(+$G(%KEY("SCode"))) D  G FINAL
 .W $TR($G(VALUE),S1,S2),$C(13,10),! F I=0:1:9 W $TR($G(@("P"_I)),S1,S2),$C(13,10),!
 W $G(VALUE),$C(13,10),! F I=0:1:9 W $G(@("P"_I)),$C(13,10),!
FINAL W $$INFOC(),$C(13,10),!,$G(%KEY("iD_CODE")),$C(13,10),! Q
INFOC() Q "$J="_$J_",$I="_$I_",$ZV="_$ZV_",%BS v."_$G(^%ZAPM.ed.BS)_",MGWLPN="_$G(%KEY("MGWLPN"))_",USER_AGENT="_$G(%CGIEVAR("HTTP_USER_AGENT"))
Err ;ОШИБКА
 W "5,<BsWebLinkError>, ",$ZE,$C(13,10),!
 Q
GETTXT(T) ;ВОЗВРАТИТЬ ВЕСЬ ТЕСТ
 W $G(@T),$C(13,10),! F I=1:1 Q:'$D(@T@(I))  W $G(@T@(I)),$C(13,10),!
 Q
GET() S P1="" F I=1:1:15 S P1=P1_$H_"="_I_" " H 10
 Q P1
ROU S P1="TESTING...PROGRAMM" Q
upg(back) //РЕКОМПИЛЯЦИЯ КЛАСССОВ ПРИ ПЕРЕХОДЕ С 4 НА 5
 I $P($P($ZV,".")," ",$L($P($ZV,".")," "))'>4 q
 ;merge ^%qCacheMsg("ru")=^%qCacheMsg("en") ;ИСПРАВЛЕНИЕ ОШИБКИ В 5.0.2
 f i=1:1:$zu(90,0) s nslist($zu(90,2,0,i))=""
 s ns="" f  s ns=$o(nslist(ns)) q:ns=""  d
 . i "%CACHELIB,DOCBOOK,SAMPLES"[ns k nslist(ns) q
 . I $$ZV^%ZAPM.ed.BSCp>5 ZN ns Do $system.OBJ.Upgrade() Q  //ЕСЛИ ВЕРСИЯ ВЫШЕ 5.0
 . d CHECKUPDATE^%UPDATECLASSES
 i '$d(nslist) w !,"Classes in all namespaces are up to date" q
 I $$ZV^%ZAPM.ed.BSCp>5 Q
 ;;ИСПРАВЛЕНИЕ ОШИБКИ В ЖУРНАЛИРОВАНИИ ПРИ ПЕРЕХОДЕ С 4 НА 5
 K ^SYS("JOURNAL"),^%SYS("JOURNAL") ;ПОТОМ НУЖНА ПЕРЕЗАГРУЗКА
 k ^%SYS("RECOMPILECLASSES")
 w !!,"The following namespaces require that the classes be recompiled:",!
 s ns="" f  s ns=$o(nslist(ns)) q:ns=""  w !,ns
 s ns="",Count=0 f  s ns=$o(nslist(ns)) q:ns=""  d
 . s ^%SYS("RECOMPILECLASSES","QUEUE",ns)="" W !,ns
 . i Count<10 s Count=Count+1
 i back=1 d  q
 . w !,"Starting background processes"
 . f i=1:1:Count j UPGRADEOBJECTS^%UPDATECLASSES(back)::5 i $t w "."
 . w !,"Examine the CCONSOLE.LOG file for errors"
 d UPGRADEOBJECTS^%UPDATECLASSES(back)
 q
install(G,ForGlobal) ;ПРОГРАММА ПЕРВОНАЧАЛЬНОЙ ИНСТАЛЛЯЦИИ (СТАРАЯ ВЕРСИЯ)"
 N S,SS,I,II,III,IIII
 S S="",III=0,IIII=1 K @G@("ROU")
 F I=1:1 Q:'$D(@G@(I))  D
 .S S=S_@G@(I) F II=1:1:$L(S,$C(13,10))-1 S SS=$P(S,$C(13,10),II) D:'(I=1&(II<3))
 ..I SS="""" S III=0,IIII=IIII+1 Q
 ..S III=III+1,@G@("ROU",IIII,III)=SS
 .S S=$P(S,$C(13,10),II+1)
 G:$d(ForGlobal) CacheGR^%ZAPM.ed.BSCF1
 S SS="ZR  F I=1:1 Q:'$D(@G@(""ROU"",I))  X III ZS @NAME ZR  ",IIII="S NAME=$P(@$ZR,""."") S:NAME[""^"" NAME=$P(NAME,""^"")"
 S III="F II=1:1 Q:'$D(@G@(""ROU"",I,II))  X:II=1 IIII ZI:II'=1 @$ZR:+(II-2)" X SS K @G
 Q
BStemp(JOB)  ;ПРОГРАММА ПЕРВОНАЧАЛЬНОЙ ИНСТАЛЛЯЦИИ (НОВАЯ)
 N S,SS,I,II,III,IIII D ROU1(JOB) Q  
ROU1(G,F) S G="^mtempBS1("_G_")",S="",III=0,IIII=1 K @G@("ROU") F I=1:1 Q:'$D(@G@(I))  D  
 .S S=S_@G@(I) F II=1:1:$L(S,$C(13,10))-1 S SS=$P(S,$C(13,10),II) D:'(I=1&(II<3))  
 ..I SS="" S III=0,IIII=IIII+1 Q  
 ..S III=III+1,@G@("ROU",IIII,III)=SS
 .S S=$P(S,$C(13,10),II+1)
 F I=1:1 Q:'$D(@G@("ROU",I))  D  S SS(0)=III D ROUTINE^%R(NAME_"."_EXT,.SS,.err,"CS",0) 
 .K SS S NAME=$G(@G@("ROU",I,1)),EXT=$P(NAME,"^",2),NAME=$P(NAME,"^"),III=0 F II=2:1 Q:'$D(@G@("ROU",I,II))  S III=III+1,SS(III)=$G(@G@("ROU",I,II))
 K @G Q  
]]></Routine>


<Routine name="%ZAPM.ed.BSChh" type="MAC" languagemode="0"><![CDATA[
%BSChh ; пpогpамма ВАЖНЫХ ФУНКЦИЙ ; 17:53   03.03.2001
 Q
CheckPass(U,P,APP) ;ПРОВЕРКА
 Q $$CheckPass^%ZAPM.ed.BSCp(U,P,APP)
CRC(P) ;ГЕНЕРАЦИЯ КОНТРОЛЬНОЙ СУММЫ
 N U,C,A,B,D,J D SET
 Q D
PASS(APP) ;ПРОВЕКА УЖЕ СУЩЕСТВУЮЩЕГО ПАРОЛЯ И КОНТРОЛЬНОЙ СУММЫ
 N U,C,A,B,D,J D SET
 I $$GETMP^%ZAPM.ed.BSCp(J,APP)="" Q 0
 I C'=D Q 0 ;ПОКА ПРИМИТИВ=НОМЕР ДНЯ ДОЛЖЕН СОВПАДАТЬ !!!!!!!!!
 Q 1
SET S U=$P(%KEY("BSUSER"),",",1),C=$P(%KEY("BSUSER"),",",2),J=$P(%KEY("BSUSER"),",",3)
 S A=$$ADDRIP^%ZAPM.ed.BSC4
 S B=$P($P($P($G(%CGIEVAR("HTTP_USER_AGENT"),"?"),"(",2),")"),";",2,3)
 S D=$P($$h^%ZAPM.ed.BS3,",",1) ;НОМЕР ДНЯ
 Q
MGWAPP ;OCX КОМПОНЕНТА BsWebLink
 W "ОТВЕТ",$C(13,10),!
 Q
]]></Routine>


<Routine name="%ZAPM.ed.BSChobbit" type="MAC" languagemode="0"><![CDATA[
%BSChobbit ; пpогpамма транслции текста для ResHack + Promt и многое другое
 Q
 
 // 
CSV ;ВВОД И ТРАНСЛЯЦИЯ СТРОК ФАЙЛА В ТАБЛИЦУ HTML
 N L,dev,%ANS,IO,IOBS,IOF,IOM,IOPAR,IOSL,IOST,IOT,MSYS,POP,GLO,RMSDF,gui,NS,S,V,SS,NS1,OWER
RG W !,"ВВОД ПОЛНЫЙ ПУТЬ К ДОС-ФАЙЛУ:",! D IN^%IS Q:POP
 I IO=$I W !,"УСТРОЙСТВО ВВОДА НЕ ОПРЕДЕЛЕНО" G RG
 S NS=$E($P($P(IO,"\",$L(IO,"\")),"."),6,8)
 S $ZT="ERRGR^%ZAPM.ed.BSChobbit"
 I $D(%BS)["0" D CLr^%ZAPM.ed.BSF4
 s dev=IO_":"_IOPAR
 s gui=0
 S SS="" F I=1:1 U IO R S(I)
 Q
HTMLSAVE 
 N %FN,%DEV,NFN,LR,LTR
 S PR1="D:/!/TMP.HTM"
 D DOSOPN^%ZAPM.ed.BSBL1 I '$D(%FN) Q
 U %DEV
 S I="" F  S I=$O(S(I)) Q:I=""  D
 .I S(I)="" W !!,"---------------------------------------",!! Q
 .W "<tr>",!
 .F II=1:1:3 W "<td>",$P(S(I),";",II),"</td>",!
 .W "<td>1</td>",!,"<td>",$P(S(I),";",4),"</td>",!
 .W "</tr>",!
 W !!,"ЗАВЕРШЕНО УСПЕШНО...",!
 C %DEV Q
RGEX U 0 W !,"ЗАВЕРШЕНО УСПЕШНО...",!!!!
RGEXIT C IO G HTMLSAVE
 Q
ERRGR U 0 I $ze["ENDOFILE"!($ze["ENDOFFILE") G RGEX
 W !,$ZE,*7 G RGEXIT
 //////////////////////////////////////////////////////
VAR //ПЕРЕМЕННЫЕ
 D VAR^%ZAPM.ed.BSCh
 S GT="^mtempHobbit("_$J_")"
 S M="Z"
 Q
LABEL(S) D VAR
 S P4=$E($P(S,BK,1),1,50)
 I P4="!" Q "!" //FINISH
 I P4=P1 Q "P1" //ENGLISH WORD
 I P4=P2 Q "P2" //RUSSIAN WORD
 Q "0"   //ЗАПАКОВАТЬ
PARSER(T) //PARSER
 N I
 D VAR K S
 F I=1:1 Q:$P(T,BK,I,I+1)=""  S S(I)=$P(T,BK,I)
 Q
SBOR S S="",I="" F  S I=$O(S(I)) Q:I=""  S S=S_S(I)_BK
 Q
TRANS(S) I S
 Q S
OBRATNO(T)
 D PARSER(T)
 S I="" F  S I=$O(S(I)) Q:I=""  S S=S(I) D
 .I $L(S,M)=3 S S(I)=$$INC($P(S,M,2)) Q
 .S S(I)=$$INC($P(S,M,2))_$C(34)_$P($P(S,M_" ",2)," "_M,1)_$C(34)_$$INC($P(S,M,4)) Q
 K S(1)
 D SBOR
 Q "!"_BK_S
INC(N) S N=M_N_M
 Q $G(@GT@(N))   
TUDA(T)
 D PARSER(T)
 K @GT S N=100
 S I="" F  S I=$O(S(I)) Q:I=""  S S=S(I) D
 .I S="" Q
 .I S'[$C(34) S S(I)=$$ADD(S) Q
 .I S["FONT" S S(I)=$$ADD(S) Q
 .I S[$C(34) D
 ..I $P(S,$C(34),2)="" S S(I)=$$ADD(S) Q
 ..S S(I)=$$ADD($P(S,$C(34),1))_" "_$tr($P(S,$C(34),2),"&","")_" "_$$ADD($P(S,$C(34),3,99)) Q
 D SBOR
 Q P1_BK_S
ADD(S) S N=N+1,@GT@(M_N_M)=S
 Q M_N_M 
]]></Routine>


<Routine name="%ZAPM.ed.BSCi" type="MAC" languagemode="0"><![CDATA[
%BSCi ;ФУНКЦИИ ПРИЛОЖЕНИЙ ; 17:12   03.01.2002
 ;
 ; Copyright (c) Serge W. Mikhaylenko
 ; All Rights Reserved
 ;
 q
c(X,D) //ДЛЯ EXCEL
 Q $TR(+$TR($FN(X,"P",D)," ",""),".",",")
 
KeySort(KD4,KD5) ;KK,k1,k2,k3,k4,k5,k6,k7,k8,k9)
 ;S TX=$P($G(^["FON"]AsIKodNVC(1,k3)),"~",4)
 N TT,Ks4,Ks5
 S Ks4=$G(k4) I Ks4'="",KD4'="" d
 .I '$D(@("^[""FON""]AsIKod"_KD4)@(33)) D Creat33("^[""FON""]AsIKod"_KD4) 
 .S Ks4=$G(@("^[""FON""]AsIKod"_KD4)@(33,k4))
 .I Ks4="" S Ks4=$G(k4)
 S Ks5=$G(k5) I Ks5'="",KD5'="" d
 .I '$D(@("^[""FON""]AsIKod"_KD5)@(33)) D Creat33("^[""FON""]AsIKod"_KD5) 
 .S Ks5=$G(@("^[""FON""]AsIKod"_KD5)@(33,k5))
 .I Ks5="" S Ks5=$G(k5)
 S TT=$G(k2,"?")_"_"_$P($G(^["FON"]AsIKodNVC(1,k3)),"~",4)_"_"_$TR($J(Ks4,8)," ","0")_"_"_$TR($J(Ks5,8)," ","0")_"_$_"_$g(k1)_"_"_$g(k2)_"_"_$g(k3)_"_"_$g(k4)_"_"_$g(k5)
 I $D(@zr)
 Q TT
Creat33(GS) //создать 33 уровень для сортировки
 N I,D,K S I="",D=$G(@GS@(3)) F  S I=$O(@GS@(3,I)) Q:I=""  S K=$P(@GS@(3,I),D,1) I K'="" S @GS@(33,K)=I
 q
KeyS(K) I $L(K)=1 Q "00"
GetKey(NK,KD) N T,TT S (TT,T)=$G(@("k"_NK)) //УНИВЕРСАЛЬНАЯ ФУНКЦИЯ ДЛЯ СПИСКОВ НОВОГО ТАБЕЛЯ
 I NK=3 D
 .I '$D(BSokov1) D VARHIST^%ZAPM.ed.BSCAsIs4 N I F I=1:1:3 s @("BSokov"_I)=+$G(@BDHIST@("ReportParametrCustom",BST,I))
 .N T1,T2,T3 S TT=$G(@("^[""FON""]AsIKod"_KD)@(1,T))
 .I BSokov2 S T2="("_$P(TT,"~",2)_")"
 .I BSokov3 S T3="В/Ч "_T
 .I BSokov1 S T1=$P(TT,"~",1) S TT=T1_$G(T2)_$G(T3)
 .E  S TT=$G(T3)_$G(T2)
 I NK>3 D
 .N TX
 .I KD="NPP" Q
 .S TX=$G(@("^[""FON""]AsIKod"_KD_"s")@(1,T)) I TX'="" S TT=TX Q
 .I TX="" S TX=$G(@("^[""FON""]AsIKod"_KD)@(1,T))
 .S TT=$TR("("_T_") "_TX," ","_")
 
 ;I '$D(Fname) S Fname="N:\123.TXT" I $ZU(140,4,Fname)'=0 O Fname:"UWN" U Fname W "-----",! W  W "-------",! C Fname
 
 I $D(@zr)
 Q TT
GetTableBS(%N1,%N2,%N3,%N4,%N5) ;МОДУЛЬ ВЫВОДА ТЕКСТА ИЛИ ТАБЛИЦЫ ДЛЯ B4Y
 N A,GT,nx,DEL,S
 I %N1="" Q "?1"
 S GT=$$TMPG^%ZAPM.ed.BSF11,DEL=$C(0)
 S A=$$BS2EXCEL(%N1,GT,1,1000,DEL,%N2,%N3,%N4,%N5)
 I '$G(@GT) Q "?2"
 S S="<pre>",nx="" F  S nx=$O(@GT@(nx)) Q:nx=""  S A=$G(@GT@(nx)) I A'="" F ny=1:1 Q:$P(A,DEL,ny,ny+1)=""  S S=S_"<nobr>"_$P(A,DEL,ny)_"</nobr><br>"
 Q S_"</pre>"
 ;BS 2 EXCEL
BS2EXCEL(TABLE,GT,CourVV,BYTE,Delim,%NY1,%NY2,%NX1,%NX2,calconly) ;BS TO EXCEL ПРИЛОЖЕНИЕ ДЛЯ CACHE'  Bs2Exc.exe  !!!!!!! МОДУЛЬ ДУБЛИРОВАН ИЗ ^%ZAPM.ed.BSHTML
 N KBT,TIX,TIY,TIT,TISH,XB,YB,XE,YE,X,Y,I,SD,B,YT,XT,YXT,YdT,XdT,ASD,BS,ny,nx,d,d0,d1,LNG,N,NN,NNN,KS,BSR,BST,TIP,S1,S2,TableAlive
 K:$G(%NY1)="" %NY1 K:$G(%NY2)="" %NY2 K:$G(%NX1)="" %NX1 K:$G(%NX2)="" %NX2
 S (S2,S1)="" I $$IFDOS^%ZAPM.ed.BSHTML1($G(@TABLE)) D  ;ПЕРЕКОДИРОВАТЬ
 .D INIT^%ZAPM.ed.BSre($G(CourVV,1)) S TableAlive=1 ;!!!!!!ДЛЯ ФУНКЦИИ $$TIN^%ZAPM.ed.BSsFUNR
 S LNG=$G(BYTE,1000),N=0,NN="",KS=0,DEL=$G(Delim,$C(1))
 S BSR=$P(TABLE,"("),BST=$QS(TABLE,1),TIP=$P(@TABLE,"@",17)
 S KBT=0,TIY=1,TIX=1,TISH=+$P($G(@TABLE@("ExcelOut")),",",3)
 L +@BSR@(BST):0 E  S @GT@(1)="",@GT@(2)="   Таблица занята другим пользователем",N=2,KBT=$L(@GT@(2)) G bs2
 L -@BSR@(BST)
 D BS2TIT I $G(@BSR@(BST,"RSM"))'="" D XM^%ZAPM.ed.BSre(@$ZR) ;ВЫПОЛНИТЬ КОМАНДУ ВОССТАНОВЛЕНИЯ
 I $D(@BSR@(BST,"FCL")) D CALC^%ZAPM.ed.BSF3 //         ПЕРЕСчИТАТЬ ФОРМУЛЫ```
 ;????s @BSR@(BST,"calc")=$h //флаг о том что пересчитали формулы для EXcel загузчика
 i $g(calconly) q "calconly"
 F ny=$G(%NY1,1):1:$G(%NY2,999999) Q:'$D(@TABLE@(ny))  K S D
 .I TIP=5 S S(1)=$G(@TABLE@(ny)) ;ЭТО ТЕКСТ
 .E  Q:'$P(@TABLE@(ny,1),"@",3)  F nx=$G(%NX1,1):1:$G(%NX2,999999) Q:'$D(@TABLE@(ny,nx))  I $P(@TABLE@(ny,nx),"@",4) D
 ..I $P(TIT,",")=ny&($P(TIT,",",2)=nx) S TIX=$L($G(S(1)))+1,TIY=KS
 ..D CELL
 .S nx="" F  S nx=$O(S(nx)) Q:nx=""  S NNN=$TR(S(nx),S1,S2),KBT=KBT+$L(NNN) D
 ..I ($L(NN)+$L(NNN))>LNG S N=N+1,@GT@(N)=$E(NN,1,$L(NN)-$L(DEL)),NN=""
 ..S NN=NN_NNN_DEL,KS=KS+1
bs2 S N=N+1,@GT@(N)=$E(NN,1,$L(NN)-$L(DEL)),@GT=KS
 S P4="$"_$S(TISH'=0:TISH,1:TIY-2)_":$"_TIY
 S P5=TIX
 S P6=TIY+1 ;ТИТУЛ ПО СТРОКАМ
 S P7=$TR(BST,":!"_$C(34)_"[]","__")
 S P8=KBT ;КОЛ-БАЙТ
 S P9=$R(9)_$R(9)_$R(9)_".txt"
 D U^%ZAPM.ed.BS3($NA(@BSR@(BST))) //СНЯТЬ ЛОКИРОВКУ
 Q +N
 ;BS 2 EXCEL
BS2EXCELold(TABLE,GT,CourVV,BYTE,Delim) ;BS TO EXCEL ПРИЛОЖЕНИЕ ДЛЯ CACHE'  Bs2Exc.exe  !!!!!!! МОДУЛЬ ДУБЛИРОВАН ИЗ ^%ZAPM.ed.BSHTML
 N KBT,TIX,TIY,TIT,TISH,XB,YB,XE,YE,X,Y,I,SD,B,YT,XT,YXT,YdT,XdT,ASD,BS,ny,nx,d,d0,d1,LNG,N,NN,NNN,KS,BSR,BST,TIP,S1,S2,TableAlive
 S (S2,S1)="" I $$IFDOS^%ZAPM.ed.BSHTML1($G(@TABLE)) D  ;ПЕРЕКОДИРОВАТЬ
 .D INIT^%ZAPM.ed.BSre($G(CourVV,1)) S TableAlive=1 ;!!!!!!ДЛЯ ФУНКЦИИ $$TIN^%ZAPM.ed.BSsFUNR
 S LNG=$G(BYTE,1000),N=0,NN="",KS=0,DEL=$G(Delim,$C(1))
 S BSR=$P(TABLE,"("),BST=$QS(TABLE,1),TIP=$P(@TABLE,"@",17)
 S KBT=0,TIY=1,TIX=1,TISH=+$P($G(@TABLE@("ExcelOut")),",",3)
 D BS2TIT
 F ny=1:1 Q:'$D(@TABLE@(ny))  K S D
 .I TIP=5 S S(1)=$G(@TABLE@(ny)) ;ЭТО ТЕКСТ
 .E  Q:'$P(@TABLE@(ny,1),"@",3)  F nx=1:1 Q:'$D(@TABLE@(ny,nx))  I $P(@TABLE@(ny,nx),"@",4) D
 ..I $P(TIT,",")=ny&($P(TIT,",",2)=nx) S TIX=$L($G(S(1)))+1,TIY=KS
 ..D CELL
 .S nx="" F  S nx=$O(S(nx)) Q:nx=""  S NNN=$TR(S(nx),S1,S2),KBT=KBT+$L(NNN) D
 ..I ($L(NN)+$L(NNN))>LNG S N=N+1,@GT@(N)=$E(NN,1,$L(NN)-$L(DEL)),NN=""
 ..S NN=NN_NNN_DEL,KS=KS+1
 S N=N+1,@GT@(N)=$E(NN,1,$L(NN)-$L(DEL)),@GT=KS
 S P4="$"_$S(TISH'=0:TISH,1:TIY-2)_":$"_TIY
 S P5=TIX
 S P6=TIY+1 ;ТИТУЛ ПО СТРОКАМ
 S P7=$TR(BST,":!"_$C(34)_"[]","__")
 S P8=KBT ;КОЛ-БАЙТ
 S P9=$R(9)_$R(9)_$R(9)_".txt"
 Q +N
BS2TIT S TIT="1,1"
 I $P(@TABLE,"@",19) S TIT=$P(@TABLE,"@",19)
 E  I $P(@TABLE,"@",50) S TIT=$P(@TABLE,"@",50)
 Q
celltra(BSR,BST,ny,nx) N L,X,S,d,d1,d0 D CELLL Q d1
CELL ;ДАННЫЕ КЛЕТКИ !!!!!!! МОДУЛЬ ДУБЛИРОВАН ИЗ ^%ZAPM.ed.BSHTML -- А ТАМ УДАЛЕН!!!
	;УЩЕ ЕСТЬ АНАЛОГИЧНЫЕ ДУБЛИ В ^%ZAPM.ed.BSTM,^%ZAPM.ed.BST
 N L,BS
CELLL S BS=@BSR@(BST,ny,nx)
 I $P(BS,"@",9)=1 S (d1,d,d0)=$P(BS,"@",15)
 E  S (d1,d,d0)=$G(^%ZAPM.ed.BSbufB("BB"_$G(%BS(3),$P)_$J_"u"_$G(%BS(15),1),ny,nx))
 I $P(BS,"@",8)'="" S %zT=$ZT,$ZT="ERCEEL^%ZAPM.ed.BSCi" D  S $ZT=$G(%zT)
 .I d0="" S d0=0
 .I '$P(BS,"@",8) X $G(@(BSR_"(BST,""FTR"",ny,nx)")) Q
 .X $G(@(BSR_"(BST,""FTR"","_$P(BS,"@",8)_")"))
 S L=$P(BS,"@",3)*$P(BS,"@",4)
 F X=1:1:$P(BS,"@",3) S S(X)=$G(S(X))_$E(d1_$J("",L),X*$P(BS,"@",4)-$P(BS,"@",4)+1,$P(BS,"@",4)+($P(BS,"@",4)*(X-1)))
 Q
ERCEEL Q
NS(APP,APPVAL) ;ВСЕ ОБЛАСТИ ДЛЯ ПРИЛОЖЕНИЯ APP С ГРАНДОМ APPVAL
 n i,l,n,GS
 ;VALUE="NS1"_$C(1)_"NS2..."
 S P1=0,P2=""
 I '$$Data^%ZAPM.ed.BSF12(APPVAL) Q P2
 I $D(@APPVAL@("*")) D
 .i '$zu(90,0) Q
 .S P2="",P1=$zu(90,0)
 .f i=1:1:P1 s l($zu(90,2,0,i))=""
 .s l="" f  s l=$o(l(l)) q:l=""  I '$D(@APPVAL@("-"_l))  s P2=P2_l_$C(1)
 S l="" F  S l=$O(@APPVAL@(l)) Q:l=""  I $E(l,1)'="*",$E(l,1)'="-",'$D(l(l)) s P2=P2_$TR(l,"'",$C(34))_$C(1)
 Q $E(P2,1,$L(P2)-1)
 
BSR(NS,APP,APPVAL,TIPPA) ;ВСЕ РАЗДЕЛЫ  В ОБЛАСТИ ДЛЯ ГРАНДА ПРИЛОЖЕНИЯ
 i NS="Global Partition" Q $$LISTPART2^%ZAPM.ed.BSmirGL
 I $TR(NS," ","")="" Q ""
 ;P1=КОЛИЧЕСТВО
 ;P2=ТИПЫ_$C(1)_"...
 ;P3=КОМЕНТАРИИ_$C(1)_"...
 ;VALUE="GL1"_$C(1)_"GL2~..." МАССИВЫ
 N n,i,ii,l,KOL,PA
 S n=""
 I NS["""," S NS=$TR(NS,$C(34),"'")
 ;I NS'[",",($D(@APPVAL@(NS,"*"))!($D(@APPVAL@("*")))) 
 //все глобали
 S n=$$GD^%ZAPM.ed.BSCp(NS,$G(TIPPA,"P ;"))  ;ВСЕ ГЛОБАЛИ В НС
 S l=n I '$D(P1) Q "~"
 S l="",ii="" f  s ii=$O(@n@(ii)) q:ii=""  s PA(ii)=""
 // не приложение
 I 0,$D(@APPVAL@(NS)) D
 .S ii="" f  s ii=$O(PA(ii)) Q:ii=""  I $D(@APPVAL@(NS,"-"_ii))  K PA(ii)
 .S i="" F  S i=$O(@APPVAL@(NS,i)) Q:i=""  I $E(i,1)'="*",$E(i,1)'="-",'$D(PA(i)) s PA(i)=""
 S P2="",P3="",P1=0,i="",l="" F  S i=$O(PA(i)) Q:i=""  D
 .S P1=P1+1,l=l_i_$C(1)
 .S P2=P2_"P"_$C(1) ;ТИПЫ
 .S P3=P3_$P($$TIP^%ZAPM.ed.BSCp(i,1),"@",2)_$C(1) ;КОМЕНТАРИИ
 S P3=$$OEM2ANSI^%ZAPM.ed.BSCp(P3) ;ПЕРЕКОДИРОВАТЬ
 Q $E(l,1,$L(l)-1)
 
BST(BSR,APP,APPVAL,gP)  ;ВСЕ таблицы %BS В разделе BSR ДЛЯ APPVAL
 i $G(gP)="Global Partition" Q $$LISTTAB^%ZAPM.ed.BSmirGL(BSR)
 ;P1=КОЛИЧЕСТВО ТАБЛИЦ
 ;VALUE="T1"_$C(1)_"T2~..."
 S P1=0,(P3,P2,P4)=""
 N n,i,ii,S1,S2,MAS,NS
 S MAS=$P($P(BSR,"]",2),"(",1),NS=$TR($P($P(BSR,"""]",1),"[""",2),$C(34),"'")
 S (n,i)="" F  S i=$O(@BSR@(i)) Q:i=""  d
 .I $D(@APPVAL@(NS,MAS,"-"_i)) Q
 .S n=n_i_$C(1),P1=P1+1,ii=$G(@BSR@(i))
 .S P4=P4_$P(ii,"@",17)_$C(1)              ;ТИПЫ
 .S P2=P2_$$TIP^%ZAPM.ed.BS($P(ii,"@",17))_$C(1)  ;ТЕКСТ ТИПОВ
 .S P3=P3_$P(ii,"@")_$C(1)               ;КОМЕНТАРИИ
 S (S2,S1)="" I $$IFDOS^%ZAPM.ed.BSHTML1(P3) D  ;ПЕРЕКОДИРОВАТЬ
 .K S1,S2 I $$ANSI^%ZAPM.ed.BSre("")
 .S P3=$TR(P3,S1,S2),P2=$TR(P2,S1,S2),n=$TR(n,S1,S2)
 Q n
 
indexlist(index,total,GL) ;
 i index>@t s VALUE="",P4="" q
 s name=$g(@t@(0,index-1)) ;go back by one
 s VALUE="",P4="",P5="",P6="" I GL'["(" S P5=$G(@GL,$C(1))
 f i=1:1:total s name=$o(@GL@(name)) q:name=""  d
 .s VALUE=VALUE_name_$c(10)
 .s P4=P4_$G(@GL@(name),$C(1))_$c(0)
 .s P6=P6_$d(@GL@(name))_$c(0)
 q
Na(GL,I) i I="" S P9=$D(@GL) q GL
 s P9=$d(@GL@(I))
 q $NA(@GL@(I))
 ;
getname(index) ;
 s name=$g(@t@(0,index))
 Q name
 ;
X(x,P1,P2,P3,P4,P5,P6,P7,P8,P9) ;ВЫПОЛНИТЬ
 X x
 Q
F4(G,I,S) ;ПРИСВАИВАНИЕ
 S @G@(I)=S
 Q
getindex(name) ;
 i name="" q 0
 i $d(@t@(1,name)) q @t@(1,name)
 s name=$o(@t@(1,name))
 i name="" q @t+1
 q @t@(1,name)
 ;
ReInit(g) k ^temBS(g_"¤"_$j) L -@g q
init(g,PAR) k ^temBS(g_"¤"_$j) s t=$zr L +@g
 n n,i
 I g="" S P7=0,(P1,P2,P3,VALUE)="" Q
 s t=$zr
 s n="" f i=0:1 s n=$o(@g@(n)) q:n=""  d
 .s @t@(0,i)=n
 .s @t@(1,n)=i
 s (P7,@t)=i-1 ;всего узлов массива
 S VALUE=$$Data^%ZAPM.ed.BSF12(PAR) I VALUE S P1="Трансформация",P2="Значения ключа",P3="Вид представления индексов в списке" Q
 S P1="Потоком",P2="По индексам",P3="Проход по массиву" Q
 q
Save(I,A) ;СОХРАНИТЬ
 S ^%ZAPM.ed.BSCfg(I,$J)=A
 Q
Rest(I)  ;ВОСТАНОВИТЬ
 Q $G(^%ZAPM.ed.BSCfg(I,$J))
ASK() //ПОКАЗАТЬ ПРИГЛАШЕНИЕ К ВВОДУ ФАЙЛА PR1=DFLT   Q 0   НЕТ
 ;%FN,%DEV НАДО ВЕРНУТЬ С ОТКРЫТЬ ДЛЯ ЗАПИСИ
 Q 1
ADDD(S) //ДОБАВИТЬ ДИСК К ПУТИ
 Q $TR($G(^%ZAPM.ed.BS("DriveISS"),"N:\InfoPortal\")_S,"/","\")
]]></Routine>


<Routine name="%ZAPM.ed.BSCi0" type="MAC" languagemode="0"><![CDATA[
%BSCi0  ;ПРОГРАММА ПЕРВОНАЧАЛЬНОЙ ИНСТАЛЛЯЦИИ
 D ROU("^temBS(144)") Q  
ROU(G) S S="",III=0,IIII=1 K @G@("ROU") F I=1:1 Q:'$D(@G@(I))  D  
 .S S=S_@G@(I) F II=1:1:$L(S,$C(13,10))-1 S SS=$P(S,$C(13,10),II) D:'(I=1&(II<3))  
 ..I SS="" S III=0,IIII=IIII+1 Q  
 ..S III=III+1,@G@("ROU",IIII,III)=SS
 .S S=$P(S,$C(13,10),II+1)
 S SS="ZR  F I=1:1 Q:'$D(@G@(""ROU"",I))  X III ZS @NAME ZR  ",IIII="S NAME=$P(@$ZR,""."")"
 S III="F II=1:1 Q:'$D(@G@(""ROU"",I,II))  X:II=1 IIII ZI:II'=1 @$ZR:+(II-2)" X SS Q
]]></Routine>


<Routine name="%ZAPM.ed.BSClogin" type="MAC" languagemode="0"><![CDATA[
%BSClogin //РЕГИСТРАЦИЯ ПОЛЬЗОВАТЕЛЯ В СИСТЕМЕ
LOGIN ///z
    if $io["TRM" { s x="127.0.0.1" }
    else { s x=$p($zio,"/") } ; UNIX has no "/" here...
    if x?1A.E { // x=machine name; get ipaddr
         s machname=$P(x,".") d $ZU(67,12,machname,$JOB) ; Set machine name into pidtab
         set ipaddr=$PIECE($ZU(54,13,machname),",",1) ; IP lookup on name
         W $ZU(67,15,ipaddr,$JOB)     ; Set IP address into pidtab
    } else { // x=ipaddr; get machine name
         s ipaddr=x d $ZU(67,15,ipaddr,$JOB)
         s machname=$P($$dns(ipaddr),".")
         W $ZU(67,12,machname,$JOB)
    }
    q
dns(address) ; name lookup on IP
 s result=$ZU(54,14,$ZU(54,1,address))
 q $P(result,",",2)
 
 ///z
]]></Routine>


<Routine name="%ZAPM.ed.BSCm" type="MAC" languagemode="0"><![CDATA[
%BSCm ;МОДУЛЬ ДИСПЕТЧЕРА И ПОДДЕРЖАНИЯ ФУНКЦИОНАЛА ПАКЕТА %BS-MSM-MONITOR
 ;
 ;    Copyright (C) 2002 Serge W. Mikhaylenko
 ;    All Rights Reserved
 ;
 ;ЭТО НАДО ПЕРЕПИСАТЬ, ВСЕ КРИВО И НЕПРАВИЛЬНО
PARTS(P,D,Cm4,PERE) //РАЗДЕЛЫ
 N I S D=$G(D,$C(0))
 I P'[D D PART(P) Q
 F I=1:1 Q:$P(P,D,I,I+1)=""  D PART($P(P,D,I))
 Q
PART(pin) //РАЗДЕЛ
 D BEG1^%ZAPM.ed.BSC4
 I $E(pin,1)'="^" S pin="^"_pin
 I '$$Data^%ZAPM.ed.BSF12(pin) Q
 W "<table border=0 width=100%>" I pin["." S Tmp=$P(pin,"."),Tmp1=$P(pin,".",2),Tmp=$G(@(Tmp_".PRO")@(Tmp1,"REM"))
 I pin'["." S Tmp=$P($G(@(pin)),"@",2)
 W "<tr><td width=30% class=s3 ><strong>"_pin_"</strong></td><td width=70% class=s3 >"_Tmp_"</td></tr>"
 N I,N,BD,Sort,BSTOP
 S N="",I=0 I '$D(@(pin)) W "Нет раздела ! "_PART_" Обратитесь к Администратору" Q
 S Co=0,NWT1=$$GETOPT^%ZAPM.ed.BSC4cfg(MainOpt,"NWT1")
 F  S N=$O(@(pin)@(N)) Q:N=""  I $P($G(@(pin)@(N)),"@",17)=2 D
 .I N="ROU" Q
 .I $D(PERE),$$PERE Q 
 .S Co=Co+1,sta="OK"
 .W "<tr><td width=20% class=s1 >"
 .I $G(Cm4)=1 w $$PAframe
 .I $G(Cm4)=3 W $$PAlist,$$PAform,$$PAframe
 .I $G(Cm4)=2 W $$PAlist,$$PAform
 .W " "_N
 .W "</td><td class=s1 >"_AF,$P($G(@(pin)@(N)),"@",1),EF_"</td></tr>",BK
 W " </table>"
 D END^%ZAPM.ed.BSC4
 Q
PERE() I $G(PERE)=1 Q:$G(PERE(N))=1 0 Q 1
 I $G(PERE)=0 Q:$G(PERE(N))=0 1 Q 0
 Q 1
PAframe() Q "<a title='"_$G(TITl,"редактировать в фрейме")_"' "_$$AN(pin,N,"EDIT^~BSChT1")_"><img src='"_BSDOMAIN_"/img/"_$G(IMG,"const.gif")_"'></a>"
PAlist() Q "<a title='редактировать из списка' "_$$AN(pin,N,"List^~BSCm41")_"><img src='"_BSDOMAIN_"/img/tabl.gif'></a>"
PAform() Q "<a title='редактировать в форме' "_$$AN(pin,N,"T^~BSCm4")_"><img src='"_BSDOMAIN_"/img/form.gif'></a>"
AN(pin,N,BSLABEL,NOWIN)
 n BSTABL,BSPART,BSNSP,BSNSPACE,BSPARENT
 S BSPART=pin
 I pin["""]" S BSNSP=$P(pin,$C(34),2),BSPART="^"_$P(pin,"]",2)
 E  S BSNSP=$TR($ZU(5),"%","~")
 S BSPART=$$%T^%ZAPM.ed.BSCh(BSPART),BSTABL=$$%T^%ZAPM.ed.BSCh(N),BSPARENT=$$ANPAR()
 I $G(NOWIN) Q " href='"_$$ADDBSGET^%ZAPM.ed.BSC4()_"' "
 Q " class=u1 onclick='open("""_$$ADDBSGET^%ZAPM.ed.BSC4()_""","""_BSPARENT_""",""toolbar=no,menubar=no,scrollbars=yes,"_$G(NWT1,"width=800,height=600")_",status=1,resizable=1"");' "
ANPAR() Q "EditForm"_$ZCRC(BSPART_BSTABL,7)
EditRecord(P,T,BScurREC) //УСТАНОВКА НА РЕДАКТИРУЕМУ ЗАПИСЬ
 N BSLABEL
 S BSLABEL="EditRec^~BSCm"
 Q "<A title='редактировать данные таблицы' "_$$AN(P,T,BSLABEL)_"> РЕДАКТИРОВАТЬ </A>"
EditRec
 I '$$VAR^%ZAPM.ed.BSCm4 Q
 I '$D(@PT) Q ""
 I $$SetVar^%ZAPM.ed.BSC4(PT_" CurNode",BScurREC) ;УСТАНОВИТЬ ТЕКУЩУЮ ЗАПИСЬ
 I $G(BSPARENT)="" S BSPARENT=$$ANPAR()
 D T^%ZAPM.ed.BSCm4
 Q
]]></Routine>


<Routine name="%ZAPM.ed.BSCm1" type="MAC" languagemode="0"><![CDATA[
%BSCm1 ;МОДУЛЬ ДИСПЕТЧЕРА И ПОДДЕРЖАНИЯ ФУНКЦИОНАЛА <<MONITORING>>  ; 21:46   21.12.2002
 ;
 ;    Copyright Serge W. Mikhaylenko
 ;    All Rights Reserved
 ;
 Q
DT(H) I '$D(H) S H=$H
 I H="" Q "дата/время пустое"
 Q $ZD(H,3)_" "_$ZT($P(H,",",2),1)
TIB() q " title='вывести в файл репликации модифицированную информацию' "
SEND //ПОСЛАТЬ
 D VAR
 D BEG1^%ZAPM.ed.BSC4
 W "<BODY>"_BK
 W "<form action="""_$$ADDLIB^%ZAPM.ed.BSC4()_""" method=""POST"">"
 S BSLABEL="SEND1^~BSCm1"        D ADDBSPOST^%ZAPM.ed.BSC4reg
 S UZ=$O(@BDPR@("SEND",""),-1)
 W "Последняя выдача осуществлялась :"_RED_$$DT(UZ)_EF I UZ'="" W "Пользователем :"_RED_$G(@BDPR@("SEND",UZ,"LOGIN"))_EF
 W "<HR>"
 I KOLout="" S KOLout=100
 W " "_$$GetDirectTabN1^%ZAPM.ed.BSC4r("%BSC4SNX","Text","TD>>>","TXT")_BBK_BBK
 W "<DIV title='Дата,время - протокол всех последних "_KOLout_" выводов'> с даты "
 W "<select name='TDLIST' size=1 >"
 S UZ1="" F I=1:1:KOLout  S UZ1=$O(@BDPR@("SEND",UZ1),-1) Q:UZ1=""  D
 .W "<option " W:I=1 "selected" W " value='"_UZ1_"'>"_$$DT(UZ1)_"</option>"
 W "</select>"
 w " по " S UZ1=$$DT($H)
 W "<input type='TEXT' title='ГГГГ-ММ-ДД' name='sDATA' size=8 value='"_$P(UZ1," ",1)_"'>"
 W "<input type='TEXT' title='ЧЧ:ММ:СС' name='sTIME' size=8 value='"_$P(UZ1," ",2)_"'><br>"_BBK
 W "<input type='submit' name='sSEND3' value='СОЗДАТЬ ФАЙЛ РЕПЛИКАЦИИ>>' "_$$TIB_"></div>"_BBK
 ;W "<input type='submit' name='sSEND3' value='ПОСЛАТЬ>>' "_$$TIB_">"_BBK_BBK
 //
 W "<FIELDSET><LEGEND>Какие модифицированные данные выводить</LEGEND>"
 W "<input type='checkbox' name='cALL' value=0 size=35 checked> ВСЕ "_BBK
  N GetAccLU I $$GetAcc^%ZAPM.ed.BSC4cfgP(BSLOGIN,"MONA")=5 W "<input type='checkbox' name='cPRO' value=0 size=35 > ПРОЕКТЫ (программы, массивы, таблицы)"_BBK
  N GetAccLU I $$GetAcc^%ZAPM.ed.BSC4cfgP(BSLOGIN,"MONA")>3 W "<input type='checkbox' name='cUFD' value=0 size=35 > ОПИСАНИЕ Унифицированных Форм Донесений "_BBK
 W "<input type='checkbox' name='cDOC' value=0 size=35 > ДОКУМЕНТЫ заполненные по УФД"_BBK
 W "</FIELDSET>"_BK
 W "<FIELDSET><LEGEND>Как выводить</LEGEND>"
 W "<input type='radio' name='cDETAL' value=1 size=35  checked > Не детализировать, выводить все"_BBK
 W "<input type='radio' name='cDETAL' value=2 size=35 > Максимально детализировать, пометить все"_BBK
 W "<input type='radio' name='cDETAL' value=3 size=35 > Максимально детализировать, не помечать"_BBK
 W "</FIELDSET>"
 W "</form>"_BK
 Q
SENDAUTO D VAR
 s cDETAL=1
 D SEND2($O(@BDPR@("SEND",""),-1),$H,"1000",1)
 Q
SEND1 //РАЗБОР ПАРАМЕТРОВ
 D VAR
 N N,I,C
 S C="",I=0
 F N="cALL","cPRO","cUFD","cDOC" S I=I+1 I $D(@N) S $E(C,I)=1
 S TDLIST2=$$DATHR^%ZAPM.ed.BSsFUNR(8,$TR(sDATA,"-","")_$E($TR(sTIME,":",""),1,4))
 D SEND2(TDLIST,TDLIST2,C)
 Q
SEND2(TD,TD2,C,SAY) //ПОЕХАЛИ
 D VAR1,VAR3 i '$$GETOPT^%ZAPM.ed.BSC4cfgP("^%ZAPM.ed.BSC4SNX.Par","Ab") W BBK_BBK_"Send turn off" q
 D BEG1^%ZAPM.ed.BSC4
 W "<BODY>"_BK W "<h3>ПОСЫЛКА ДАННЫХ</h3>"
 I '$D(@BDAL@(CS)) W "Идентификатор текущей системы '"_CS_"' неопределен в БД "_BDAL_". Текущая система не реплицируема." G SEND3
 N U1,U2,U3,U4,NSP,PART,TABL,FNO,DOS,CON,KOLDOC,StringCtrl,size,DOS3
 S KOLDOC=0      ;новый вариант с бинарными файлами
 D DeltempBS^%ZAPM.ed.BSC4r4 ;ПОЧИСТИМ ВРЕМЕННЫЕ ПРОГРАММЫ ПЕРЕД СОЗДАНИЕМ
 D
 .N GetField,GR,MAS,MASF,T1,MASB,DOS1,DOS2,STOP
 .S T1="",MAS="TEMP",MASF="FILE" 
 .K @MASS S MASB=$ZR
 .I $G(SAY)="" W AF
 .;F  S T1=$O(@ArrOUT@(T1),-1) Q:T1=""!(T1<$P(TD,","))  S T2="" F  S T2=$O(@ArrOUT@(T1,T2),-1) Q:T2=""  Q:T1=$P(TD,",",1)&(T2<$P(TD,",",2))  D 
 .F  S T1=$O(@ArrOUT@(T1),-1) Q:T1=""  Q:$D(STOP)  S T2="" F  S T2=$O(@ArrOUT@(T1,T2),-1) Q:T2=""  Q:$D(STOP)  D
 ..I T1<$P(TD,",") S STOP=1 Q
 ..I T1>$P(TD2,",") Q 
 ..I T1=$P(TD,","),$P(T2,".")<$P(TD,",",2) S STOP=2 Q  //ПОЛНЫЙ ПЕРЕБОР 
 ..I T1=$P(TD2,","),$P(T2,".")>$P(TD2,",",2) Q
 ..N NS,L,A,D,RF,RF1,RF2,RF3,U1,U2,U3
 ..S T3="" F  S T3=$O(@ArrOUT@(T1,T2,T3)) Q:T3=""  D  ;W T3,BBK
 ...S RF=T3 I T3["(" S RF=$E(T3,1,$L(T3)-1)_","
 ...S (RF3,RF1)=$G(@ArrOUT@(T1,T2,T3,"D")),RF2=$G(@ArrOUT@(T1,T2,T3,"A")),NS=$G(@ArrOUT@(T1,T2,T3,"NS"))
 ...I NS="" Q  ;нет области
 ...I $D(@MAS@(NS,RF)) Q  ;совпадающие ссылки
 ...I $E(RF1,1)="^" S RF1="DAT" ;ЭТО редактированные документы
 ...D ADDNS(.RF),ADDNS(.RF3)
 ...S @MAS@(NS,RF1,RF)=T1_$C(0)_T2_$C(0)_T3_$C(0)_RF1_$C(0)_RF2_$C(0)_RF3_$C(0)_NS
 .S U1="" F  S U1=$O(@MAS@(U1)) Q:U1=""  I $$ZU^%ZAPM.ed.BSF4(U1) S U2="" F  S U2=$O(@MAS@(U1,U2)) Q:U2=""  D
 ..S U3="",UU="" F  S U3=$O(@MAS@(U1,U2,U3)) Q:U3=""  D
 ...I UU'="",U3[UU K @MAS@(U1,U2,U3) Q  ;очистить вхождения ссылок
 ...S UU=U3,GR=U3 I U3["(" S GR=$E(U3,1,$L(U3)-1)_")"
 ...S UA=$P(@MAS@(U1,U2,U3),$C(0),5) //ДЕЙСТВИЕ С ССЫЛКОЙ
 ...I $E(U2,1,3)="DAT",UA="S" D SOLID(GR,$P(@MAS@(U1,U2,U3),$C(0),6))
 ...S KOLDOC=KOLDOC+1 
 ...I ($g(cDETAL)'=1),$G(SAY)="" d  W "<input type='checkbox' name='cDOC"_KOLDOC_"' value=0 size=35 "_CHE_" >"_KOLDOC_". "_U1_" (",U2,") "_UA_" "_GR_BBK
 ....S CHE="" I $g(cDETAL)=2 S CHE="checked"
 ...I UA="S" M @MASB@(U1,U2,UA,GR)=@GR
 ...I UA="K" S @MASB@(U1,U2,UA,GR)=""
se4 .I KOLDOC=0 W EF_$$se6 Q
 .M @MASB@("%%FILE","FILE")=@MASF
 .I '$D(CON) S CON=$I
 .I $$ZU^%ZAPM.ed.BSF4("%SYS")
 .S DOS1=$$NEWFILE(DS,CS,"rgr") W "<!-- " D G2F^%ZAPM.ed.BSC4r4($E(MASS,2,99),DOS1,CON,"Пользователь '"_BSLOGIN_"' сделал файл репликации данных системы '"_CS_"' от ("_$$TD^%ZAPM.ed.BSC4base(TD)_") до ("_$$TD^%ZAPM.ed.BSC4base(TD2)_") "_MASS) W " -->"_BK
 .K @MASB
 .S DOS2=$$NEWFILE(DS,CS,"zls") S U1="" U DOS2 F  S U1=$O(@MASF@(U1)) Q:U1=""   W U1,!
 .W $ZCONVERT($tr(DOS1,"/","\"),"L"),!
 .C DOS2 U CON
 .S DOS3=$$NEWFILE(DS,CS,"rar",1)
 .D exec^%ZAPM.ed.BSCEXE(COMM_" "_Dbin_"\WINRar.exe a "_DOS3_" -m5 @"_DOS2,0) ;_" -ps3v9e3t6a8m9y0",0)
 .D del^%ZAPM.ed.BSCEXE(DOS1),del^%ZAPM.ed.BSCEXE(DOS2)
 .;S DOS=$$NEWFILE(DS,CS) U DOS D XMLBEG W "<![CDATA[" C DOS U CON
 .;S DOS1=$$NEWFILE(DS,CS,"txt") U DOS1 W "]]]]><![CDATA[>" D XMLEND C DOS1 U CON
 .;D exec^%ZAPM.ed.BSCEXE(COMM_" "_Dbin_"\merge.exe "_DOS_" "_DOS3_" "_DOS1,0)
 .I $G(SAY)="" W EF
se5 .W $$se6_" по состоянию на "_RED_$$DT(TD2)_EF_", в файл: "_BBK_RED_DOS3_EF D  //DOS --- DOS3
 .S size=$ZU(140,1,DOS3) W " (размер "_size_")"
 .I $G(DOS3)'="" D  //FTP  ... послать файлы синхронизации на ...FTP
 ..N ER
 ..S URI=$P($$GETOPT^%ZAPM.ed.BSC4cfgP("^%ZAPM.ed.BSETUP(""ISS"")","Aftpsinx"),"//",2,99) I URI="" Q
 ..D FtpAF^%ZAPM.ed.BSCmail($P($P(URI,"@",2),":"),$P($P(URI,"@",1),":"),$P($P(URI,"@",1),":",2),$P($P(URI,"@",2),":",2),DOS3,"",0) W BBK_GREEN_"Отправлено на FTP-сервер '"_$P($P(URI,"@",2),":")_"' под именем '"_$P($P(URI,"@",1),":")_"'"_EF
 ..I $G(ER)'=0 W RED_ER_EF
 .;W RED_$$NEWIN^%ZAPM.ed.BSC4base1($P(DOS,"\",$L(DOS,"\")),$$TR^%ZAPM.ed.BSsFUNM(DOS,"\","%5C"),"Смотреть файл ("_size_" байт)","OUTFILE^~BSCm1")_EF
 .S @BDPR@("SEND",TD2,"LOGIN")=BSLOGIN,@BDPR@("SEND",TD2,"CountDocs")=KOLDOC,@BDPR@("SEND",TD2,"PDateTime")=TD
 S SendDocs=KOLDOC
 //SMTP ... послать файлы синхронизации по эл.почте
SEND3 D BACKS
 D END^%ZAPM.ed.BSC4
 Q
ADDNS(RF) I $E(RF,1,2)'="^[" S RF="^["""_NS_"""]"_$E(RF,2,999)
 Q
PRE(M) W "<HR><PRE>" D  W "</PRE><HR>"
 .I $D(M) ZW M Q
 .W
 Q
BACKS S BSLABEL="SINX^~BSCm1" W BBK_BBK_"<A HREF='"_$$ADDBSGET^%ZAPM.ed.BSC4()_"'>Главное меню синхронизации</A>" Q      
se6() Q "<HR> Выведено "_RED_$G(KOLDOC,0)_EF_" документ(а,ов)"       
SOLID(CurNode,PT) ;где есть файлы собрать их в список для архивирования
 N FN1,Mf,ny,P,T,var1,FN2
 S FN1=$$GETOPT^%ZAPM.ed.BSC4cfgP($NA(@PT@("Parms")),"DF") I FN1="" Q
 S P=$QS(PT,0),T=$QS(PT,1)
 s Mf=$$GetField^%ZAPM.ed.BSC4rou(P,T,"Count",1) //количество полей
 ;проверить кол-во уровней
 s Mxi=$$GetField^%ZAPM.ed.BSC4rou(P,T,"Index",1)
 i $ql(CurNode)'=Mxi S Cu=$QS(CurNode,0) D  S CurNode=Cu
 .f i=1:1:Mxi s Cu=$NA(@Cu@($QS(CurNode,i)))
 F ny=1:1:Mf s var1=$$GetField^%ZAPM.ed.BSC4rou(P,T,ny,1) i $P(var1,"~",3)=6 D
 .S nf=$P(var1,"~",1),d=$G(@CurNode@(nf)) I d="" Q
 .S FN2=$$GETOPT^%ZAPM.ed.BSC4cfgP($NA(@PT@("ParmsCell",nf)),"xSubDir"),Tmp1=FN1_FN2_d I $ZU(140,4,Tmp1)'=0 Q
 .S @MASF@($TR(Tmp1,"/","\"))=CurNode
 Q
FNC(Tmp1) Q $ZCONVERT($tr(Tmp1,"/","\"),"L")
NAD(RF) I $E(RF1,1)="^" S RF1="DATE"
 S @MAS@(RF1,RF)=T1_$C(0)_T2_$C(0)_T3
 Q
XMLBEG //НАЧАЛО ДОКУМЕНТА
 W "<?xml version=""1.0"" encoding=""Windows-1251"" ?>"_BK
 W "<SendStream NameUser='"_$G(BSLOGIN)_"'  ReqSysDataTime='"_TD_"' SysName='"_CS_"' IDArhive='876'>"
 Q
XMLEND //ОКОНЧАНИЕ
 ;!!! $zcrc(?,7)
 W "<StreamInfo TotalDocs='"_$G(KOLDOC)_"' CurSysDataTime='"_$H_"' ></StreamInfo>"_BK
 W "</SendStream>"_BK
 Q
NEWFILE(DS,CS,EXT,QUIT) //СОЗДАТЬ И ОТКРЫТЬ НОВЫЙ ФАЙЛ ДЛЯ ЗАПИСИ
 N DOS S FNO=DS_$S($E(DS,$L(DS))="\":"",1:"\")_CS_"_"_$ZD(+$H,8)_"_"_$TR($ZT($P($H,",",2),1),":","")_"."_$G(EXT,"xml")
 I $G(QUIT)'="" Q FNO 
 I $$Open^%ZAPM.ed.BSXdos(FNO,"W")
 Q DOS
 //%BSC4inc      ;строенные функции
 //#include %BSC4inc
SINX //МЕНЕДЖЕР СИНХРОНИЗАЦИЙ
 D BEG1^%ZAPM.ed.BSC4
 W "<BODY>"_BK
 w "<hr><br>"_BK
 W "<form action="""_$$ADDLIB^%ZAPM.ed.BSC4()_""" method=""POST"">"
 S BSLABEL="SINX1^~BSCm1" D ADDBSPOST^%ZAPM.ed.BSC4reg
 W "<table border=0>"_BK
 W "<tr><td align='right'><img border=0 src='"_BSDOMAIN_"/img/REFR-BLU.gif' ><input type='submit' name='sAUTO' value='АВТОМАТИЧЕСКАЯ <<<>>>'></td><td> </td><td align='left'>"_$$GetDirectTabN1^%ZAPM.ed.BSC4r("%BSC4SNX","Text","auto","TXT")_"</td></tr>"_BK
 W "</table>"_BK
 w "<br><hr>"_BK
 W "<table border=0>"_BK
 W "<tr><td align='right'><img border=0 src='"_BSDOMAIN_"/img/REDO.gif' ><input type='submit' name='sSEND' value='ПОСЛАТЬ ДАННЫЕ >>>'></td><td> </td><td align='left'>"_$$GetDirectTabN1^%ZAPM.ed.BSC4r("%BSC4SNX","Text",">>>","TXT")_"</td></tr>"_BK
 W "<tr><td align='right'><img border=0 src='"_BSDOMAIN_"/img/UNDO1.gif' ><input type='submit' name='sRESV' value='ПРИНЯТЬ ДАННЫЕ <<<'></td><td> </td><td align='left'>"_$$GetDirectTabN1^%ZAPM.ed.BSC4r("%BSC4SNX","Text","<<<","TXT")_"</td></tr>"_BK
 W "</table>"_BK
 w "<br><hr>"_BK
  N GetAccLU I $$GetAcc^%ZAPM.ed.BSC4cfgP(BSLOGIN,"MONA")=5 D
 .W "<table border=0>"_BK
 .W "<tr><td align='right'>"_$$PARSNX D  W "</td><td align='left'>"_$$GetDirectTabN1^%ZAPM.ed.BSC4r("%BSC4SNX","Text","OPT","TXT")_" "_$$FTPBUTT_"</td></tr>"_BK
 ..I $$GRA^%ZAPM.ed.BSCGIS(BSLOGIN,"zDebug") W "<a title='"_$G(TITl,"редактировать в фрейме")_"' "_$$AN^%ZAPM.ed.BSCm("^%ZAPM.ed.BSC4SNX","Par","EDIT^~BSChT1")_"><img src='"_BSDOMAIN_"/img/"_$G(IMG,"const.gif")_"'></a>"
 .W "</table>"_BK
 .w "<br><hr>"_BK
 W "</form>"_BK
 D END^%ZAPM.ed.BSC4
 Q
FTPBUTT() I '$$GETOPT^%ZAPM.ed.BSC4cfgP("^%ZAPM.ed.BSETUP(""ISS"")","Aft") Q ""
 Q "<BUTTON TITLE='Открыть каталог синхронизации FTP-сервера' ONCLICK='open("""_$$FTP()_""",""FTP"",""toolbar=yes,menubar=yes,scrollbars=yes,status=1,resizable=1"");' ><img border=0 src='"_BSDOMAIN_"/img/open.gif' >FTP-SNX</BUTTON>"
FTP() Q $$GETOPT^%ZAPM.ed.BSC4cfgP("^%ZAPM.ed.BSETUP(""ISS"")","Aftpsinx")
PARSNX() N BSLABEL S BSLABEL="ENTER^~BSC4cfg"
 Q $$BP^%ZAPM.ed.BSC4cfgP("ПАРАМЕТРЫ СИНХРОНИЗАЦИИ","ПАРАМЕТРЫ СИНХРОНИЗАЦИИ","^%ZAPM.ed.BSC4SNX.Par","",1)
PARSNXI(IMG) N BSLABEL S BSLABEL="ENTER^~BSC4cfg"
 Q $$BP^%ZAPM.ed.BSC4cfgP("ПАРАМЕТРЫ СИНХРОНИЗАЦИИ","ПАРАМЕТРЫ СИНХРОНИЗАЦИИ","^%ZAPM.ed.BSC4SNX.Par","",1,IMG)
PARSNXIED(IMG) //КОНСТРУКТОР
 N pin,N,TITl S pin="^%ZAPM.ed.BSC4SNX",N="Par",TITl="КОНСТРУКТОР ШАБЛОНА ПАРАМЕТРОВ СИНХРОНИЗАЦИИ"
 Q $$PAframe^%ZAPM.ed.BSCm()
 
PARIP(IMG) N BSLABEL,A,B 
 S B="^[""%SYS""]BSC4.ISS.AppAccess" ;ШАБЛОН ПАРАМЕТРОВ
 S BSLABEL="ENTER^~BSC4cfg",A=$NA(@$$KBD^%ZAPM.ed.BSF12("^%ZAPM.ed.BSC4(""PROTECT"")")@(BSLOGIN,"FNM")) ;КУДА СОХРАНЯЕМ
 Q $$BP^%ZAPM.ed.BSC4cfgP("РЕДАКТИРОВАТЬ ПРАВА ДОСТУПА ДЛЯ ПОЛЬЗОВАТЕЛЯ `"_BSLOGIN_"`","ПАРАМЕТРЫ ПРАВ ДОСТУПА ДЛЯ `"_BSLOGIN_"`",B,A,1,IMG)
PARIPED(IMG) N TITl S TITl="КОНСТРУКТОР ШАБЛОНА ПРАВ ДОСТУПА!!! БУДЬТЕ ВНИМАТЕЛЬНЫ!!! РЕДАКТИРУЙТЕ ТОЛЬКО, ЕСЛИ ЗНАЕТЕ ЧТО ДЕЛАЕТЕ!!!"
 N pin,N,IMG S pin="^[""%SYS""]BSC4.ISS",N="AppAccess"
  Q $$PAframe^%ZAPM.ed.BSCm()
AUTO(BSLOGIN,A) i '$$GETOPT^%ZAPM.ed.BSC4cfgP("^%ZAPM.ed.BSC4SNX.Par","Aa") q "turn off"
 I '$G(A) N (BSLOGIN)
 D VAR^%ZAPM.ed.BSCh,SENDAUTO,RECVAUTO
 Q "SendDocs="_+$G(SendDocs)_", Receive="_+$G(KOLDOC)_" files,"_+$G(KOLDOC1)_" documents."
SINX1 D BEG1^%ZAPM.ed.BSC4
 I $D(sAUTO) W "АВТОМАТИЧЕСКАЯ РЕПЛИКАЦИЯ БАЗ ДАННЫХ МЕЖДУ СИСТЕМАМИ..." S A=$$AUTO(BSLOGIN,1) w BBK_BBK_A Q
 I $D(sSEND) D SEND
 I $D(sRESV) D RECV
 D BACKS,END^%ZAPM.ed.BSC4
 Q
RECV D VAR1
 D REC1
 Q
FTPGET   //ЧТО ПРИШЛО В ФТП
 N URI,MM,FIL,i,FILE,CDEV,%DEV
 S URI=$P($$GETOPT^%ZAPM.ed.BSC4cfgP("^%ZAPM.ed.BSETUP(""ISS"")","Aftpsinx"),"//",2,99) I URI="" q
 D FtpGD^%ZAPM.ed.BSCmail($P($P(URI,"@",2),":"),$P($P(URI,"@",1),":"),$P($P(URI,"@",1),":",2),$P($P(URI,"@",2),":",2),"\",.MM)
 W "<HR>"_GREEN_"Прием файлов с FTP:\\"_URI_EF
 I $G(ER)'=0 W RED_ER_EF G FTPEND
 S i="" F  S i=$O(MM(i)) Q:i=""  S FN=$P(MM(i)," ",$L(MM(i)," ")) D
 .I $$MY Q
 .S FIL(i)=FN
 //ПРИНЯТЬ ФАЙЛЫ ИЗ ФТП В RC
 D FtpGF^%ZAPM.ed.BSCmail($P($P(URI,"@",2),":"),$P($P(URI,"@",1),":"),$P($P(URI,"@",1),":",2),$P($P(URI,"@",2),":",2),.FIL,.FILE)
 W BBK_"<TEXTAREA cols=85 rows=4 >" I $O(FILE(""))="" W "ничего нет"
 S i="" F  S i=$O(FILE(i)) Q:i=""  S FN=$TR(RC,"/","\")_"\"_$P(i,"\",$L(i,"\")) W FN_" - приняли из FTP " D
 .S CDEV=$I I '$$OpenFile^%ZAPM.ed.BSCF1(FN,"W") Q
 .U %DEV S I="" F  S I=$O(FILE(i,I)) Q:I=""  W FILE(i,I)
 .U CDEV W "и скопировали"_BK
 .C %DEV
 W "</TEXTAREA>"
FTPEND w BBK Q
REC1 W "<BODY>"_BK
 D FTPGET
 W "<form action="""_$$ADDLIB^%ZAPM.ed.BSC4()_""" method=""POST"">"
 S BSLABEL="REC2^~BSCm1" D ADDBSPOST^%ZAPM.ed.BSC4reg
 N in,U1,MAS,FN,i
 S MAS="in" D FileListDir^%ZAPM.ed.BSCEXE(RC,MAS,2,"rar") ;xml")   W "<hr>" 
 S U1="",i=0 F  S U1=$O(@MAS@(U1)) Q:U1=""  D
 .S FN=$P(@MAS@(U1),"?",1) I $$MY Q
 .S i=i+1
 .W "<div title='Файл прислан из Системы:"_$P($P(FN,"\",$L(FN,"\")),"_")_" ДатаСоздания:"_$P($P(FN,"\",$L(FN,"\")),"_",2)_" ВремяСоздания:"_$P($P($P(FN,"\",$L(FN,"\")),"_",3),".")_" '>"_"<input type=checkbox title='пометить файлы для закачки' name=File"_U1_" value=''>"
 .W $P(FN,"\",$L(FN,"\"))_" (размер "_$P(@MAS@(U1),"?",3)_" байт) "
 .;I $D(@BPO@(FN)) W "<input type=checkbox title='переместить файлы в архив' name=Del"_U1_" value=''>"
 .W "</div>"
 .W BBK
 W "<hr>" 
 I i>0 D
 .I i>1 W "<input type=checkbox title='закачать все файлы' name=FileALL value=''> Все файлы обработать<hr>" 
 .W "<input type=SUBMIT title='закачать данные в буфер предварительной обработки' name=LISTREST value='ПОСМОТРЕТЬ ДАННЫЕ'>"
 .W "<input type=SUBMIT title='произвести репликацию данных' name=REST value='ВВЕСТИ ДАННЫЕ'>"
 E  W "файлов для ввода нет"
 Q
LI(F,S) W "<LI>"_AF_F_" - "_S_EF_"</LI>"
 Q
MY() N F S F=$ZCONVERT($P(FN,"\",$L(FN,"\")),"L") I $P(F,"_")=$ZCONVERT(CS,"L") D LI(FN,"СВОИ ФАЙЛЫ НЕЛЬЗЯ ВВОДИТЬ") Q 1
 I $D(@BPO@(F)) D LI(FN,"УЖЕ ВВОДИЛИ") Q 1
 I '$D(@BDAL@($P(F,"_"))) D LI(FN,"ИЗ ЭТОЙ СИСТЕМЫ ДАННЫЕ НЕ РЕПЛИЦИРУЮТСЯ") Q 1
 Q 0
REC2 i '$$GETOPT^%ZAPM.ed.BSC4cfgP("^%ZAPM.ed.BSC4SNX.Par","Ac") W BBK_BBK_"Receive turn off" q
 D BEG1^%ZAPM.ed.BSC4
 D VAR1,VAR3   W "<h3>ПРИЕМ ДАННЫХ</h3>"
 N in,U1,MAS
 S MAS="in",KOLDOC=0,KOLDOC1=0  D FileListDir^%ZAPM.ed.BSCEXE(RC,MAS,2,"rar") ;"xml")
 S U1="" F i=1:1 S U1=$O(@MAS@(U1)) Q:U1=""  D
 .S FN=$P(@MAS@(U1),"?",1) I $$MY Q
 .I $D(FileALL)!($D(@("File"_U1))) D REC3($$FNC($P(@MAS@(U1),"?",1)))
 W "<HR> Всего "_RED_$G(KOLDOC,0)_EF_" файл(а,ов)"      
 W "<HR> Всего "_RED_$G(KOLDOC1,0)_EF_" документ(а,ов)"      
 W "<hr>" 
 D BACKS,END^%ZAPM.ed.BSC4
 Q
REC3(FN) I $G(SAY)="" W "<hr><STRONG>"_FN_"</STRONG>"_BBK
 S RAR=$$FNC(Dtmp_"\"_$TR($P($ztimestamp,",",2),".","")_"\") ;ВРЕМЕННАЯ ДИРЕКТОРИЯ
 ;D exec^%ZAPM.ed.BSCEXE(COMM_" "_Dbin_"\merge.exe /s "_FN_" "_RAR,0)
 ;n x,i,xx,ii
 ;s x="",xx=$$GetFileC^%ZAPM.ed.BSCEXE(RAR_"x",.x)
 ;s i="" f ii=1:1 s i=$o(x(i)) q:i=""  S @BPO@(FN2,ii)=x(i)
 ;D del^%ZAPM.ed.BSCEXE(RAR_"x")
 D exec^%ZAPM.ed.BSCEXE(COMM_" "_Dbin_"\WINrar x "_FN_" "_RAR,0) ;РАСПАКОВКА АРХИВА
 N in,U1,MAS,i,FN1,FN2
 S MAS="in",KOLDOC1=0,FN2=$ZCONVERT($P(FN,"\",$L(FN,"\")),"L")
 D FileListDir^%ZAPM.ed.BSCEXE(RAR,MAS,2) ;СМОТРИМ ЧТО ПРИШЛО В АРХИВЕ
 S U1="" F i=1:1 S U1=$O(@MAS@(U1)) Q:U1=""  D
 .S FN1=$P(@MAS@(U1),"?",1) ;W FN_BBK
 .I $P(FN1,".",$L(FN1,"."))="rgr" D  //восстановление массивов в БПО 
 ..D RESTROU(FN1)  //ПРОГРАММЫ ВОССТАНОВИТЬ
 ..K @MASS D RestGlo^tempBS,DelRou^tempBS,DEL1^%ZAPM.ed.BSC4r4("tempBS.*")
 ..Q:$O(@MASS@(""))=""   K @BPO@(FN2,"rgr") M @BPO@(FN2,"rgr")=@MASS K @MASS
 ..D RESTGLO($NA(@BPO@(FN2,"rgr")),0) //1-эмуляция
 .I $P(FN1,".",$L(FN1,"."))="rr" D RESTROU(FN1,$NA(@BPO@(FN2,FN1))) //ПРОГРАММЫ ЗАПИСАТЬ В БПО
 I $D(REST) I $ZU(140,6,FN,Darhiv_"\"_$P(FN,"\",$L(FN,"\"))) ;ПЕРЕМЕСТИТЬ ФАЙЛ FN В АРХИВ
 D exec^%ZAPM.ed.BSCEXE(COMM_" rd /S /Q "_RAR,0) ;I $ZU(140,10,RAR) ;УДАЛИТЬ КАТАЛОГ RAR   //I $ZU(140,5,FN1) ;УБИТЬ ОТРАБОТАННЫЙ ФАЙЛ
 I '$D(REST) K @BPO@(FN2) ;БУФЕР ЧИСТИМ
 E  S @BPO@(FN2)=KOLDOC1
 S KOLDOC=KOLDOC+1
 Q
RESTGLO(BP,EMU) //ВООССТАНОВИТЬ АВТОМАТОМ ВСЕ УЗЛЫ ИЗ БПО
 N I1,I2,I3,I4,NSO,TMP
 i $G(SAY)="" W "<HR>"
 S I1="",NSO=$ZU(5) F  S I1=$O(@BP@(I1)) Q:I1=""  D
 .I I1="%%FILE" S I2="" F  S I2=$O(@BP@(I1,I2)) Q:I2=""  S I3="" F  S I3=$O(@BP@(I1,I2,I3)) Q:I3=""  D
 ..I $D(EMU) D EMU("COPYFILE",I3) Q:$G(EMU)
 ..D COPYFILE(RAR_$P(I3,":\",2,999),I3) //КУДА ПОЛОЖИТЬ ФАЙЛЫ И ДЛЯ КАКИХ ТАБЛИЦ? А если диск не N:....!!!!!!
 .i $G(SAY)="" W "<HR>"
 .I $$ZU^%ZAPM.ed.BS3(I1)="" Q  //переход в другой нс 
 .S I2="" F  S I2=$O(@BP@(I1,I2)) Q:I2=""  S I3="" F  S I3=$O(@BP@(I1,I2,I3)) Q:I3=""  S I4="" F  S I4=$O(@BP@(I1,I2,I3,I4)) Q:I4=""  D
 ..I $$Rules(0,CS,I1,I4) Q
 ..i $G(SAY)="" W "<LI>"_I3_" "_I4_"</LI>"
 ..I $D(REST) D
 ...I I3="K" D
 ....I $D(EMU) D EMU("Kill",I4) Q:$G(EMU)
 ....K @I4
 ...I I3="S" D
 ....I $D(EMU) D EMU("Set",I4) Q:$G(EMU)
 ....K @I4 M @I4=@BP@(I1,I2,I3,I4)
 ..S KOLDOC1=$G(KOLDOC1)+1
 I $ZU(5,NSO) //возврат нс 
 Q
Rules(n,sy,ns,GREF) N A,STOP S A="" F  S A=$O(@Rules@(n,A)) Q:A=""  I sy=$G(@Rules@(n,A,"sy"))!(^("sy")="*") I ns=$G(@Rules@(n,A,"ns")),@$G(@Rules@(n,A,"glref")) S STOP=0 Q
 Q $G(STOP,1)
EMU(S,G) W GREEN_" "_S_" "_EF_G_"<LI>" W:$G(EMU) BLUE_"эмуляция "_EF
 Q
COPYFILE(F1,F2)
 N DIR S DIR=$P(F2,"\",1,$L(F2,"\")-1) 
 I $D(REST) D
 .I $ZU(140,4,DIR)'=0 I $ZU(140,9,DIR) ;D exec^%ZAPM.ed.BSCEXE(COMM_" md "_DIR,0) //СОЗДАЕМ ТОЛЬКО ПОСЛЕДНЮЮ ДИРЕКТОРИЮ, А ЕСЛИ НАДО ВСЕ!!!!
 .I $ZU(140,6,F1,F2)
 .;D exec^%ZAPM.ed.BSCEXE(COMM_" copy "_F1_" "_F2_" /Y",0) //ЭТО ПЛОХО РАБОТАЕТ - ТОЛЬКО ДЛЯ ЛАТИНИЦЫ
 i $G(SAY)="" D
 .I '$D(REST)  W "<li>"_RED_F2_EF_" должен быть скопирован"_BK_"</li>" Q
 .I $ZU(140,4,F2)=0 W "<li>"_RED_F2_EF_" скопирован"_BK_"</li>" Q
 Q
RECVAUTO S FileALL=7,SAY=1,REST=1 D FTPGET
 G REC2
RESTROU(FN,BPO) I $d(BBK) W RED_FN_EF_BBK
 n x,i,xx,ii,STR,S,SS
 s x="",xx=$$GetFileC^%ZAPM.ed.BSCEXE(FN,.x),S=0 K STR
 s i="" f ii=1:1 s i=$o(x(i)) q:i=""  D
 .I ii<3 Q  W x(i),!,$G(BBK) Q  //ВЫВОД ЗАГОЛОВКА ФАЙЛА
 .i x(i)="" q
 .I $$RESTLABEL(x(i)) Q
 .S S=S+1,STR(S)=x(i)
 I $$RESTLABEL("zerrO^INT")
 Q
RESTLABEL(X) //РАЗДЕЛЕНИЕ ПОТОКА КОДА НА ПРОГРАММЫ И ВОССТАНОВЛЕНИЕ ИХ
 I X[" "!(X'["^")!(X[";") Q 0
 I $D(STR) S STR(0)=S S NR=$P(SS,"^",1)_"."_$P(SS,"^",2) D
 .i $D(BPO) M @BPO@(NR)=STR I '$D(REST) Q
 .I $G(SAY)="",$D(BPO) W "<li>"_GREEN_NR_EF_"</li>" 
 .D ROUTINE^%R(NR,.STR,.err,"CS",0) I $G(err) ZW err
 S S=0,SS=X K STR
 Q 1
VAR S BDPR=$$KBD^%ZAPM.ed.BSF12("^%ZAPM.ed.BSC4SNX(""Protokol"")") ;ПРОТОКОЛ ДАТ ВЫВОДА
 S KOLout=$$GETOPT^%ZAPM.ed.BSC4cfgP("^%ZAPM.ed.BSC4SNX.Par","KOLout") ;КОЛИЧЕСТВО ПОСЛЕДНИХ ДАТ ВЫВОДА ВЫВОДИТЬ В СПИСКЕ
 S ArrOUT=$$KBD^%ZAPM.ed.BSF12("^%ZAPM.ed.BSC4SNX(""OUT"")") ;ПРОТОКОЛ ССЫЛОК ПРИСВОЕННЫХ И УДАЛЕННЫХ УЗЛОВ ДАННЫХ И ПРОГРАММ
 S GRANT=$$GetVar^%ZAPM.ed.BSC4("GRANT","DFLT")
 Q
VAR1 S BDAL=$$KBD^%ZAPM.ed.BSF12("^%ZAPM.ed.BSC4SNX(""AllSys"")")
 S CS=$ZCONVERT($$GETOPT^%ZAPM.ed.BSC4cfgP("^%ZAPM.ed.BSETUP(""ISS"")","Asys"),"L") ;ИМЯ ТЕКУЩЕЙ СИСТЕМЫ
 S BPO=$$KBD^%ZAPM.ed.BSF12("^%ZAPM.ed.BSC4SNX(""BPO"")")
 S Rules=$$KBD^%ZAPM.ed.BSF12("^%ZAPM.ed.BSC4SNX(""Rules"")")
 S DS=$$GETOPT^%ZAPM.ed.BSC4cfgP("^%ZAPM.ed.BSC4SNX.Par","SEND")
 ;S POOL=$$GETOPT^%ZAPM.ed.BSC4cfgP("^%ZAPM.ed.BSC4SNX.Par","Rpool") ;FTP каталог
 S RC=$$GETOPT^%ZAPM.ed.BSC4cfgP("^%ZAPM.ed.BSC4SNX.Par","RESV")
 S Dbin=$$GETOPT^%ZAPM.ed.BSC4cfgP("^%ZAPM.ed.BSETUP(""ISS"")","bBIN")
 S Darhiv=$$GETOPT^%ZAPM.ed.BSC4cfgP("^%ZAPM.ed.BSC4SNX.Par","Rarhiv")
 S Dtmp=$$GETOPT^%ZAPM.ed.BSC4cfgP("^%ZAPM.ed.BSC4SNX.Par","RTmp")
 Q
VAR3 S COMM=$S($ZU(100):"COMMAND.COM",1:"CMD /C")
 S MASS="^%tempSNX"
 Q
]]></Routine>


<Routine name="%ZAPM.ed.BSCm3" type="MAC" languagemode="0"><![CDATA[
%BSCm3 ;МОДУЛЬ UFD (ЗАГОТОВКА ДЛЯ ПРОГРАММ БЕЗ ПОДДЕРЖАНИЯ СЕССИИ)
 ;
 ;    Copyright (C) Serge W. Mikhaylenko
 ;    All Rights Reserved
 ;
 Q
T //MAIN //W V1," ",V2
 D VAR
 W "<form action="""_$$ADDLIB^%ZAPM.ed.BSC4()_""" method=""POST"">"
 S BSLABEL="Act^~BSCm3"
 D ADDBSPOST^%ZAPM.ed.BSC4reg
 //W "<form name='EE1'><input type='hidden' name='k0' value=''>"_BK
 W 1,CurNode,2
 W "<table>"
 W "<tr><td><INPUT name=b1u1 title='на первый ключ' TYPE='submit' VALUE='&lt;&lt;' >"_BK
 W "<INPUT name=b2u1 title='на предыдущий ключ' TYPE='submit' VALUE='&lt;' ></td>"_BK
 //W "<INPUT title='Поле текущего ключа' name='k1' TYPE='text' SIZE=10 VALUE='' >"_BK
 w "<td><select name='Act0' size=1>"_BK
 F ind=1:1:100 S GLO=$$O(GLO,KY,1) Q:GLO=""  Q:$QL(GLO)="0"  W "<option value='"_ind_"' " D  W ">"_GLO_"</option>"_BK
 .I CurNode="",ind=1 S CurNode=GLO
 .I GLO=CurNode W "selected "
 I ind=100,GLO'="" W "<option value=''>...дальше</option>"_BK
 w "</select></td>"_BK
 W "<td><INPUT name=b3u1 title='на последущий ключ' TYPE='submit' VALUE='&gt;' >"_BK
 W "<INPUT name=b4u1 title='на последний ключ' TYPE='submit' VALUE='&gt;&gt;'></td>"_BK
 W "<td><INPUT name=b5u1 title='сохранить' TYPE='submit' VALUE='save' ><td>"_BK
 W "<td><INPUT name=b6u1 title='вставить' TYPE='submit' VALUE='new insert' ><td>"_BK
 W "<td><INPUT name=b7u1 title='удалить ключ' TYPE='submit' VALUE='delete' ><td>"_BK
 W "</tr></table>"
 W "</form>"_BK
 I $$SetVar^%ZAPM.ed.BSC4(BSwinID_"QQ",QQ)
 I $$SetVar^%ZAPM.ed.BSC4(BSwinID_"GGG",GGG)
 D SetVar^%ZAPM.ed.BSC4(BSwinID_"CurNode",CurNode)
 D END^%ZAPM.ed.BSC4
 Q
Act W 111
 Q       
 /*
 W "<PRE>"
 ZW  W " ",KY
 W "</PRE>"
 */
 
VAR //ПЕРЕМЕННЫЕ КОМПЛЕКСА
 S BStyle="MONITOR"
 W "<HTML><HEAD>"_BK_$$STYLE^%ZAPM.ed.BSC4
 S PT=$NA(@("^"_V1)@(V2))
 S BSwinID=$G(V3,"w123")
 W "<TITLE>"_PT_"</TITLE>"_BK
 M BD=@PT@("KEY")
 S KY=$O(BD(""),-1)
 S GLO=BD
 //GGG,QQ - СКВОЗНЫЕ ПЕРЕМЕННЫЕ
 S QQ=$$GetVar^%ZAPM.ed.BSC4(BSwinID_"QQ",$C(0))
 S GGG=$$GetVar^%ZAPM.ed.BSC4(BSwinID_"GGG","")
 S CurNode=$$GetVar^%ZAPM.ed.BSC4(BSwinID_"CurNode","")
 Q       
O(G,K,N) //$ORDER 
 N GG S GG=G
 S KK=$C(0)
 I G'["(",N=-1 S GG=$ZO(@(G_"("""")"),-1) I $$C Q $$Q
 F  S GG=$ZO(@GG,N) Q:GG=""  I $$C Q
 Q $$Q
C() //КОНТРОЛЬ
 I $QL(GG)>K Q 0
 I GG[KK Q 0
 S KK=$P(GG,",",1,K)
 I $P(GG,",",1,K)["(" S GGG=$S(GG'[")":$P(GG,",",1,K)_")",1:GG)
 E  S GGG=""
 Q 1
Q() I QQ=GGG Q ""
 S QQ=GGG
 Q GGG
]]></Routine>


<Routine name="%ZAPM.ed.BSCm4" type="MAC" languagemode="0"><![CDATA[
%BSCm4 ;МОДУЛЬ UFD
 ;
 ;    Copyright (C) Serge W. Mikhaylenko
 ;    All Rights Reserved
 ;
 Q
VAR3 N I
 I BSNODE="" S CurNode=$$O(GLO,KY,BSNAPR),BSNODE=$$Ke(CurNode) Q
 I BSNODE'="" S CurNode=BD F I=1:1 Q:$P(BSNODE,",",I,I+1)=""  S CurNode=$NA(@CurNode@($P(BSNODE,",",I)))
 Q
T N BSNOREG,BSGRANT
 I '$$VAR Q
 s BSNAPR=$$GETOPT^%ZAPM.ed.BSC4cfgP($NA(@PT@("Parms")),"Napr"),(STEP1,STEP2)=$$GETOPT^%ZAPM.ed.BSC4cfgP($NA(@PT@("Parms")),"NaprStep")
 S:'STEP1 (STEP1,STEP2)=5 S BSNAPR=$S(BSNAPR:1,1:-1)
TT I '$$VAR Q
 S KL=$$GETOPT^%ZAPM.ed.BSC4cfgP($NA(@PT@("Parms")),"NaprKL") I KL="" S KL=14
 i $G(BSList)=1 G List0^%ZAPM.ed.BSCm41
 i $G(BSList)=2 W $$B27
 I $G(BSgMODE)="NEW" S bMODE=4,BSgMODE="NEW1" G Act
 W "<form action="""_$$ADDLIB^%ZAPM.ed.BSC4()_""" method=""POST"" name='first1'>"
 N BSNamF,BSnf
 S BSLABEL="Act^~BSCm4"
 D ADDBSPOST^%ZAPM.ed.BSC4reg
 W "<INPUT name=bMODE TYPE='hidden' VALUE='0'>"
 D VAR3
 S DISABLE=0 I $$O(CurNode,KY,-BSNAPR)="" S DISABLE=1
 S Q="<table width=100%><tr><td CLASS=s5 ><table><tr>"
 //S Q=Q_"<td> <INPUT name=bSAV title='сохранить текущую коррекию' TYPE='submit' VALUE=''>"_BK
 //S Q=Q_"<BUTTON onclick='bMODE.value=1; submit();' title='сохранить текущую коррекию' VALUE='сохранить' ><IMG SRC='"_BSDOMAIN_"/img/save.gif'></BUTTON><td>"_BK
 S Q=Q_"<td>"
 S Q=Q_"<BUTTON onclick='bMODE.value=1;' title='сохранить текущую коррекию' TYPE='submit' VALUE='сохранить' ><IMG SRC='"_BSDOMAIN_"/img/save.gif'></BUTTON><td>"_BK
 S Q=Q_"<td><BUTTON onclick='reset();' title='отменить текущее изменение'><IMG SRC='"_BSDOMAIN_"/img/undo.gif' ></BUTTON><td>"_BK
 i $G(BSList)'=2 D 
 .S Q=Q_"<td><INPUT name=b1u1 title='на первую запись' TYPE='submit' VALUE='&lt;&lt;&lt;' "_$S($G(DISABLE)=1:"DISABLED",1:"")_" ></TD>"_BK
 .;S Q=Q_"<TD CLASS=s1><INPUT name=Au1 title='на шаг ...' TYPE='submit' VALUE='&lt;&lt;' "_$S($G(DISABLE)=1:"DISABLED",1:"")_" >"_BK
 .;S Q=Q_"<INPUT name=STEP1 title='шаг' size=3 maxlength=3 TYPE='TEXT' VALUE='"_$G(STEP1)_"'></TD>"_BK
 .S Q=Q_"<TD><INPUT name=b2u1 title='на предидущую запись' TYPE='submit' VALUE='&lt;' "_$S($G(DISABLE)=1:"DISABLED",1:"")_" ></td>"_BK
 .S BSLABEL="SETKEY^~BSCm4"
 .S Q=Q_"<td><select name=MODE1 size=1 onclick=""javascript: { if (''!=MODE1.value & ('"_BSNODE_"'!=MODE1.value)) parent.location='"_$$ADDBSGET^%ZAPM.ed.BSC4()_"&STEP1="_$G(STEP1)_"&STEP2="_$G(STEP2)_"&BSNODE='+MODE1.value; } "" >"_BK
 .S GLO=CurNode F ind=1:1:KL S GLO=$$O(GLO,KY,-BSNAPR) Q:GLO=""  S GLO1=$$Ke(GLO) S KL(ind)="<option value='"_GLO1_"' >"_GLO1_"</option>"_BK
 .I ind=KL,GLO'="" S KL(ind+1)="<option value='"_GLO1_"'>...дальше</option>"_BK
 .S ind="" F  S ind=$O(KL(ind),-1) Q:ind=""  S Q=Q_KL(ind)
 .S Q=Q_"<option value='"_BSNODE_"' SELECTED >"_BSNODE_"</option>"_BK
 .S GLO=CurNode F ind=1:1:KL S GLO=$$O(GLO,KY,BSNAPR) Q:GLO=""  S GLO1=$$Ke(GLO) S Q=Q_"<option value='"_GLO1_"'>"_GLO1_"</option>"_BK
 .I ind=KL,GLO'="" S Q=Q_"<option value='"_GLO1_"'>...дальше</option>"_BK
 .S Q=Q_"</select></td>"_BK
 .I $$O(CurNode,KY,BSNAPR)="" S DISABLE=2
 .S Q=Q_"<td><INPUT name=b3u1 title='на последущую запись' TYPE='submit' VALUE='&gt;' "_$S($G(DISABLE)=2:"DISABLED",1:"")_" ></td>"_BK
 .;S Q=Q_"<td class=s1><INPUT name=STEP2 title='шаг' size=3 maxlength=3 TYPE='TEXT' VALUE='"_$G(STEP2)_"'>"_BK
 .;S Q=Q_"<INPUT name=Au2 title='на шаг ...' TYPE='submit' VALUE='&gt;&gt;' "_$S($G(DISABLE)=2:"DISABLED",1:"")_" ></td>"_BK
 .S Q=Q_"<td><INPUT name=b4u1 title='на последнюю запись' TYPE='submit' VALUE='&gt;&gt;&gt;' "_$S($G(DISABLE)=2:"DISABLED",1:"")_" ></td>"_BK
 .n BSLABEL S BSLABEL="FIND^~BSCm4"
 .S Q=Q_"<td><BUTTON title='искать запись по ключевым атрибутам' onclick='open("""_$$ADDBSGET^%ZAPM.ed.BSC4()_""","""_BSPARENT_"find"",""toolbar=no,menubar=no,scrollbars=no,width=500,height=200,status=1,resizable=1"");'><IMG SRC='"_BSDOMAIN_"/img/find.gif'></<BUTTON><td>"_BK
 S Q=Q_"<td><BUTTON onclick='bMODE.value=4; submit();' title='вставить новую запись'><IMG SRC='"_BSDOMAIN_"/img/new.gif'></<BUTTON><td>"_BK
 S Q=Q_"<td>&nbsp;&nbsp;&nbsp;&nbsp;</td>"
 I $G(BSgMODE)'["NEW" S Q=Q_"<td><BUTTON onclick='bMODE.value=2; submit();' title='удалить текущую запись'><IMG SRC='"_BSDOMAIN_"/img/kill.gif'></<BUTTON><td>"_BK
 S Q=Q_"</tr></table></td></tr></table>"_BK
 S Q=Q_"<table>"_BK W Q
TTT N var1,Tab,%ZName,xClass,RO,TIT
 //K @BDSES@(BSSES,"VAR",PT,"CARD")
 s Maxfeild=$$GetField^%ZAPM.ed.BSC4rou(P,T,"Count",1) //количество полей
 s MaxIndxfeild=$$GetField^%ZAPM.ed.BSC4rou(P,T,"Index",1) //количество индексированных полей
 f ny=1:1:Maxfeild D  I MaxIndxfeild=ny,BSLABEL["FIND1" G TTTT
 .N TRANS,dflt
 .s var1=$$GetField^%ZAPM.ed.BSC4rou(P,T,ny,1) //взять все атрибуты текущего поля
 .s nf=$P(var1,"~",1) //вычленить имя поля
 .s Description=$P(var1,"~",2) //вычленить описание поля
 .i Description["|" s dflt=$p(Description,"|",2),Description=$p(Description,"|")
 .S xClass="s1" i MaxIndxfeild'<ny S xClass="s2"
 .S TIT="",RO=$$GETOPT^%ZAPM.ed.BSC4cfgP($NA(@PT@("ParmsCell",nf)),"xRO") I RO S TIT="(Только для чтения)"
 .w "<tr><td align='right' CLASS="_xClass_" title='"_$$ip_"'><strong>" //вывести начало строки таблицы
 .i MaxIndxfeild'<ny w "<FONT COLOR=RED> * </FONT>" //вывести красную звездочку если поле индексированное
 .w Description,"</strong></td>"
 .S xNAME="X"_$P(var1,"~",5) I '$D(xxNAME) D
 ..I $G(BSnFOCUS)="" S xxNAME=xNAME Q
 ..I $G(BSnFOCUS)=nf S xxNAME=xNAME
 .s Ta=$$GETOPT^%ZAPM.ed.BSC4cfgP($NA(@PT@("ParmsCell",nf)),"tA") I Ta="" S Ta="cols=32 rows=5"
 .s Tt=$$GETOPT^%ZAPM.ed.BSC4cfgP($NA(@PT@("ParmsCell",nf)),"tT") I Tt="" S Tt="size=40 maxlength=32000"
 .W "<td CLASS="_xClass_">" //------------------------------------------
 .S (d,d1,d0)=$$CELL() I d="" S d0=0 //ТЕКУЩИЕ ДАННЫЕ ПОЛЯ
 .S fTRN=$$GETOPT^%ZAPM.ed.BSC4cfgP($NA(@PT@("ParmsCell",nf)),"fTRN") I fTRN'="" D fTRN(fTRN) //ФУНКЦИЯ ТРАНСФОРМАЦИЯ
 .//I Tmp'="" S @BDSES@(BSSES,"VAR",PT,"CARD",nf)=Tmp //ЗАПИСАТЬ В БУФЕР
 .i $P(var1,"~",3)=1 D  G TTE
 ..D RO(1)
d .//ДАТЫ
 .i $P(var1,"~",3)=4 D  G TTE //дата
 ..D RO(0)
 ..I BSLABEL["FIND1",MaxIndxfeild'<ny Q
 ..S BS1=BSG,BS2="DATE^~BSCm4",BS3=nf,BS4=$S(MaxIndxfeild'<ny:ny,1:0)
 ..W $$B^%ZAPM.ed.BSC4cal(d,"Загрузить календарь",BSPARENT_"cal","EDITDATE^~BSC4cal")
 .//ПАРАМЕТРЫ
p .i $P(var1,"~",3)=7 D  G TTE
 ..D RO(0,BK_BK_"данные поля параметра не должны быть пустыми")
 ..I BSLABEL["FIND1",MaxIndxfeild'<ny Q
 ..Q:CurNode=""  N SH,SH1
 ..S BS1=BSG,BS2="PARA^~BSCm4",BS3=nf,BS4=$S(MaxIndxfeild'<ny:ny,1:0)
 ..S SH=$$GETOPT^%ZAPM.ed.BSC4cfgP($NA(@PT@("ParmsCell",nf)),"pSH") I SH="" S SH="^UNDEFINED"
 ..S SH1=$NA(@CurNode@(nf))
 ..W $$BP^%ZAPM.ed.BSC4cfgP("ПАРАМЕТРЫ "_BS3,"Редактировать параметры",SH,SH1,1)
 ..S d1="<A title='шаблон параметра"_BK_BK_"данные поля параметра не должны быть пустыми'>"_SH_"</a>"
 .//ФАЙЛЫ
f .i $P(var1,"~",3)=6 D  G TTE //файлы
 ..d RO(0)
 ..I BSLABEL["FIND1",MaxIndxfeild'<ny Q
 ..N BSS4,BSS8,BSS3,BSS1,x,FN1,FN2
 ..S BSLABEL="FILE^~BSCm4" D TmmP1
 ..I $ZU(140,7,Tmp1)<0 W "<A title='ошибка ! директории не существует :"_Tmp1_" '>!!!!</A>" Q
 ..S BS1=$TR(##class(%File).NormalizeDirectory(Tmp1)_$$ZCRC(PT_BSNODE_nf),":\","^~")
 ..S BS2=nf,BSS3=BSSES,BS3=MGWLIB,BSS8=$$BSADDVAR^%ZAPM.ed.BSC4(),BSS4=x
 ..W "<BUTTON title='прикрепить файл' onclick='open("""_$$ADDBSGET^%ZAPM.ed.BSC4()_""","""_BSPARENT_"file"",""toolbar=no,menubar=no,scrollbars=yes,width=500,height=200,status=1,resizable=1"");'><IMG SRC='"_BSDOMAIN_"/img/open.gif'></<BUTTON>"_BK
 ..I d'="" D  //Графика
 ...N GR,EX,BSGR1,BSLABEL,BS1,BS2,BS3,BS4,BSS4,BSS8,FN,TI
 ...D TmmP2
 ...S d1="<A target='showpic' "_BSGR1_" title='"_TI_"'><IMG border=0 "_IMG_" SRC='"_GR_"' ></A>"
 ...N BSGR1,BSNFLD S BSLABEL="DELFILE^~BSCm4",BSNFLD=nf,d1=d1_"<A target='showpic' href='"_$$ADDBSGET^%ZAPM.ed.BSC4()_"' title='Удалить файл'><IMG border=0 "_IMG_" SRC='"_BSDOMAIN_"/img/del.gif'></A>"
k .i $P(var1,"~",3)=8 D  G TTE //Кодификаторы
 ..D RO(0)
 ..I BSLABEL["FIND1",MaxIndxfeild'<ny Q
 ..N Tmp1,GL1,GL2,GL,BSKO,BSGL,BSKOD,BSKO,BS3,BS4,res
 ..S BSLABEL="KOD^~BSCm4",(BSKO,GL,GL1,GL2,GL3)="",BS3=nf,BS4=$S(MaxIndxfeild'<ny:ny,1:0)
 ..S GL1=$$GETOPT^%ZAPM.ed.BSC4cfgP($NA(@PT@("ParmsCell",nf)),"kS") I GL1'="" S GL=GL1,BSKO=1
 ..I $G(GL)="" S GL2=$$GETOPT^%ZAPM.ed.BSC4cfgP($NA(@PT@("ParmsCell",nf)),"kD") I GL2'="" S GL=$P(PT,".")_"."_$P(GL2,".",1,2),BSKO=$P(GL2,".",3)
 ..I $G(GL)="" S GL3=$$GETOPT^%ZAPM.ed.BSC4cfgP($NA(@PT@("ParmsCell",nf)),"kSQL") I GL3'="" D
 ...S BSKO=2,GL=$NA(@GTmp@(BSSES,"SQL",nf))
 ...I '$D(@GL) S res=$$SetSQL(GL,GL3,$$GETOPT^%ZAPM.ed.BSC4cfgP($NA(@PT@("ParmsCell",nf)),"kSQLns")) I 'res S ErrSave(xNAME)=res
 ..I $G(GL)=""  W "<A title='ошибка ! не определен словарь данных'>!!!!</A>" Q
 ..I '$$Data^%ZAPM.ed.BSF12(GL) W "<A title='Нет доступа к словарю данных `"_GL_"`'>!!!!</A>" Q
 ..S BSGL=$$%T^%ZAPM.ed.BSCh(GL),BSKOD=$$%T^%ZAPM.ed.BSCh(d),BSKO=$$%T^%ZAPM.ed.BSCh(BSKO)
 ..W "<BUTTON title='выбрать код из словаря данных' onclick='open("""_$$ADDBSGET^%ZAPM.ed.BSC4()_"&WEB=AAA#"_d_""","""_BSPARENT_"kod"",""toolbar=no,menubar=no,scrollbars=yes,width=500,height=600,status=1,resizable=1"");'><IMG SRC='"_BSDOMAIN_"/img/list.gif'></<BUTTON>"_BK
 ..I d'="" D
 ...I GL1'=""!(GL3'="") S d1=$G(@GL@(d),"код не определен")
 ...E  S d1=$G(@GL@(d,$P(GL2,".",3)),"код отсутствует")
 ...S d1="<A title='расшифровка кода'>"_d1_"</a>"
t .;простой показатель
 .D RO(0)
TTE .I d1=d S d1=""
 .W "</td><td class=s3>"_$G(d1)_BK 
 .i $d(ErrSave(xNAME)) W "</td><td class=s3> Ошибка "_$G(ErrSave(xNAME))_BK
 .w "</td></tr>"_BK
 I ny>20 D  //ПОВТОРЯТЬ ЕСЛИ МНОГО ПОЛЕЙ
 .S Q=$$TR^%ZAPM.ed.BSsFUNM($G(Q),"Au1","Ax1"),Q=$$TR^%ZAPM.ed.BSsFUNM($G(Q),"STEP1","STEPx1")
 .S Q=$$TR^%ZAPM.ed.BSsFUNM($G(Q),"Au2","Ax2"),Q=$$TR^%ZAPM.ed.BSsFUNM($G(Q),"STEP2","STEPx2")
 .W $$TR^%ZAPM.ed.BSsFUNM($G(Q),"MODE1","MODE2")
 W "</form>"_BK
 i $g(xxNAME)'="" D
 .D JS^%ZAPM.ed.BSCp
 .w "first1."_xxNAME_".focus();"_BK
 .D JSE^%ZAPM.ed.BSCp
 D SETVAR
 D END^%ZAPM.ed.BSC4
TTTT Q
TmmP1 S FN1=$$GETOPT^%ZAPM.ed.BSC4cfgP($NA(@PT@("Parms")),"DF"),FN2=$$GETOPT^%ZAPM.ed.BSC4cfgP($NA(@PT@("ParmsCell",nf)),"xSubDir"),Tmp1=FN1_FN2 I Tmp1="" S Tmp1="Z:/!!!/"
 Q
TmmP2 S Tmp1=##class(%File).NormalizeDirectory(Tmp1)_d
 I $ZU(140,4,Tmp1)'=0 S GR=BSDOMAIN_"/ext/error.gif",BSGR1="",TI="ошибка доступа к файлу"
 E  S GR=$$GETOPT^%ZAPM.ed.BSC4cfgP($NA(@PT@("Parms")),"WF")_FN2_d,BSGR1="href='"_GR_"'",TI="загрузить файл",EX=$ZCVT($P(GR,".",$L(GR,".")),"L") I EX'="","jpg*bmp*gif*png"'[EX S GR=BSDOMAIN_"/ext/"_EX_".gif"
 S IMG=$$GETOPT^%ZAPM.ed.BSC4cfgP($NA(@PT@("ParmsCell",nf)),"xSubIMG") I IMG="" S IMG="width=25"
 Q
SetSQL(TG,SQ,NS) //Сформирвать кодификатор
 N result,hhh,%msg,KOD,END,ONS
 S ONS=$ZU(5) I NS'="" I $ZU(5,NS)
 s result=$$DynSQLprep^%ZAPM.ed.BSC4r(SQ,.hhh)
 if +result'=1 S END=$G(%msg,result) G SetEnd
 n col,allcol,row2,COL,x,row1,STOP,row3
 s x=$$DynSQLColInfo^%ZAPM.ed.BSC4r(.COL,.hhh)
  for  Q:$$DynSQLfetch^%ZAPM.ed.BSC4r(.hhh,.row1,.STOP)=1  s row2=$G(row2)+1  D
  .if '$D(allcol) s allcol=$LISTLENGTH(row1) //for col=1:1:allcol W "<td bgcolor=#E4E4E4>",$LI($LI(COL,col),1),"</td>"  //цикл по колонкам
  .//for col=1:1:allcol W "<td>",$LI(row1,col),"</td>"
  .S KOD=$LI(row1,1) I KOD'="" S @TG@(KOD)=$LI(row1,2),row3=$G(row3)+1
 S END=$G(row3,"no rows")
SetEnd  I $$DynSQLclose^%ZAPM.ed.BSC4r(.hhh)
 I $ZU(5,ONS)
 Q END
fTRN(fTRN) ;ВЫПОЛНЕНИЕ ФУНКЦИИ ВИЗУАЛИЗАЦИИ
 S $ZT="fErrTRAN^%ZAPM.ed.BSCm4"
 X "S d1="_fTRN
 Q
fErrTRAN S d1=$ZE_"..."_fTRN,$ZT=""
 Q
KOD I $$VAR("Словарь данных")
 W $$B27
 I $G(FNDTXT)'="" W "Словарь данных по контексту '"_$$KO(FNDTXT)_"'<HR>"
 S GL=$$%^%ZAPM.ed.BSCh(BSGL),KOD=$$%^%ZAPM.ed.BSCh(BSKOD),BSKO=$$%^%ZAPM.ed.BSCh(BSKO)
 I '$$Data^%ZAPM.ed.BSF12(GL) W "Нет доступа к словарю данных '"_GL_"'" Q
 W "<form action="""_$$ADDLIB^%ZAPM.ed.BSC4()_""" method=""POST"" name='first1'>"
 S BSLABEL="KODFIND^~BSCm4"
 D ADDBSPOST^%ZAPM.ed.BSC4reg W "<INPUT name=bMODE TYPE='hidden' VALUE='0'>"
 S k="" W "<table width=100%>"_BK
 S Q="<TR><TD CLASS=s3>КОДЫ</TD>"
 S Q=Q_"<TD CLASS=s3>ТЕКСТ<INPUT name=FNDTXT title='Контекст поиска по расшифровке' size=20 TYPE='TEXT' VALUE=''> "
 S Q=Q_"<BUTTON name=Find1 onclick='bMODE.value=1;' type='submit' title='искать' ><IMG SRC='"_BSDOMAIN_"/img/find.gif'></BUTTON>"
 I BSKO'=2 D
 .S Q=Q_"<BUTTON name=VKS1 onclick='bMODE.value=2;' type='submit' title='вставить временно-кодированную сущность'><IMG SRC='"_BSDOMAIN_"/img/new.gif'></BUTTON>"
 .S Q=Q_"<INPUT name=VKSTXT title='текст временно-кодированной сущности' size=20 TYPE='TEXT' VALUE=''>"
 S Q=Q_"</td></tr>"_BK
 W Q
 I BSKO F  S k=$O(@GL@(k)) Q:k=""  D KOD1(k,@GL@(k))
 I 'BSKO F  S k=$O(@GL@(k)) Q:k=""  I $G(@GL@(k,BSKO))'="" D KOD1(k,@GL@(k,BSKO))
 S Q=$$TR^%ZAPM.ed.BSsFUNM($G(Q),"FNDTXT","FNDTXT1"),Q=$$TR^%ZAPM.ed.BSsFUNM($G(Q),"VKSTXT","VKSTXT1")
 W Q
 W "</table></FORM>"
 D JS^%ZAPM.ed.BSCp
 I $D(LOC) W LOC
 S BSLABEL="KOD2^~BSCm4"
 w "function ch1(K) {",BK
 w "location='"_$$ADDBSGET^%ZAPM.ed.BSC4()_"&CHO='+ K;",BK
 W "}"_BK
 D JSE^%ZAPM.ed.BSCp
 D END^%ZAPM.ed.BSC4
 Q
RO(T,ti)    I RO w "<input type='hidden' name='"_xNAME_"' value='"_d_"' >"_BK I $G(xxNAME)=xNAME S xxNAME=""
 //wrap=soft | hard | off
 I $G(T) W "<textarea wrap=off "_Ta_" title='"_nf_TIT_$g(ti)_"' name='"_xNAME_"' "_$S(RO:"DISABLED",1:"")_" >"_d_"</textarea>"_BK
 E  w "<input type='text' "_Tt_" title='"_nf_TIT_$g(ti)_"' name='"_xNAME_"' value='"_d_"' "_$S(RO:"DISABLED",1:"")_" >"_BK
 Q
KOD1(K,T) I $G(FNDTXT)'="",(K_T'[FNDTXT) Q
 N T1
 S T1="<TD CLASS=s"_$S(K=KOD:1,1:2)_"><A title='"_$S(K=KOD:"текущий",1:"выбрать")_"' href='javascript:ch1("""_K_""")'"
 W "<tr>"_T1_" name='#"_K_"' >"_$$KO(K)_"</a></td>"
 W T1_" >"_$$KO(T)_"</A></TD></tr>"_BK
 Q
KO(S) I $G(FNDTXT)'="",S[FNDTXT Q $$TR^%ZAPM.ed.BSsFUNM(S,FNDTXT,"<font color=WHITE>"_FNDTXT_"</FONT>")
 Q S
KOD2 D VAR1,VAR2
 N D S D=$G(CHO) I D="" Q
 D SETPAR(PT,BSNODE,BS3,BS4,D)
 Q               
KODFIND 
 I $G(bMODE)=1 S:$G(FNDTXT)="" FNDTXT=$G(FNDTXT1) G KOD
 I $G(bMODE)=2 S:$G(VKSTXT)="" VKSTXT=$G(VKSTXT1) D VKSADD(VKSTXT) S LOC="location='#"_NK_"';"_BK,BSKOD=NK G KOD
 Q
VKSADD(VTXT)
 S GL=$$%^%ZAPM.ed.BSCh(BSGL),KOD=$$%^%ZAPM.ed.BSCh(BSKOD)
 S GVKS=$$KBD^%ZAPM.ed.BSF12("^%ZAPM.ed.BSC4SNX(""VKS"")")
 S GVKS1="^%ZAPM.ed.BSC4SNX.VKSKOD" //СЧЕТЧИК КОДОВ ДЛЯ VKS
 I '$D(@GVKS1) S @GVKS1="10"
 D VAR1^%ZAPM.ed.BSCm1 ;CS
 S NK=CS_"-"_$I(@GVKS1)
 S @GVKS@(NK,"NDIC")=$$%^%ZAPM.ed.BSCh(BSGL),@GVKS@(NK,"NFIELD")=$$%^%ZAPM.ed.BSCh(BSKO)
 I BSKO=1 S @GL@(NK)=VTXT
 I BSKO'=1 S @GL@(NK,BSKO)=VTXT
 Q
DEL D CLEAR(CurNode,PT)
 K @CurNode D SNX^%ZAPM.ed.BSChT1("K",$zr,PT)
 w "Запись удалена"
 Q
CLEAR(CurNode,PT) ;почистить узлы, где есть файлы
 N FN1,Mf,ny,P,T,var1,FN2
 S FN1=$$GETOPT^%ZAPM.ed.BSC4cfgP($NA(@PT@("Parms")),"DF") I FN1="" Q
 S P=$QS(PT,0),T=$QS(PT,1)
 s Mf=$$GetField^%ZAPM.ed.BSC4rou(P,T,"Count",1) //количество полей
 F ny=1:1:Mf s var1=$$GetField^%ZAPM.ed.BSC4rou(P,T,ny,1) i $P(var1,"~",3)=6 D
 .S nf=$P(var1,"~",1),d=$G(@CurNode@(nf)) I d="" Q
 .I $G(BSNFLD)'="" I nf'=$G(BSNFLD) Q
 .S FN2=$$GETOPT^%ZAPM.ed.BSC4cfgP($NA(@PT@("ParmsCell",nf)),"xSubDir"),Tmp1=FN1_FN2_d I $ZU(140,4,Tmp1)'=0 Q
 .W "Удален файл "_Tmp1_BBK I $ZU(140,5,Tmp1)
 Q
DELFILE //УДАЛИТЬ ПРИКРЕПЛЕННЫЙ ФАЙЛ
 D VAR1,VAR2,VAR3
 D CLEAR(CurNode,PT)
 D SETPAR(PT,BSNODE,BSNFLD,0,"")
 ;D JS^%ZAPM.ed.BSCp
 ;W "alert('"_CurNode_"');"_BK
 ;W "window.close();"_BK
 ;D JSE^%ZAPM.ed.BSCp
 Q
ZCRC(S) I '$$GETOPT^%ZAPM.ed.BSC4cfgP($NA(@PT@("ParmsCell",nf)),"xSubRN") Q ""
 S S=$ZCRC(S,7)
 Q S_$TR($J("",13-$L(S))," ","0")_"_"
FILE S BSS1=""
 S BSS6="FILE1^~BSCm4"
 D UP^%ZAPM.ed.BSC4r3
 Q
TKFILE1 
 M Mas=@GL K @GL
 D Arr2File^%ZAPM.ed.BSCEXE(.Mas,path)
 K bytes,by S BSNamF=$P(path,"\",$L(path,"\")),MGWLIB=BS3,BSnf=BS2
 D JS^%ZAPM.ed.BSCp
 D OPEN($S($G(FILERR):"ERRCOPY^~BSCm4",1:"DUMMY^~BSCm4"))
 W "window.close();"_BK
 D JSE^%ZAPM.ed.BSCp
 D PRE
 Q
FILE1 D VAR^%ZAPM.ed.BSCh        //КОПИРОВАТЬ ФАЙЛ НА ДИСК СЕРВЕРА
 N I,bytes,path,FILERR
 D BSPARVAR^%ZAPM.ed.BSC4(BSS4,BSS8)
 s path=$TR(BS1,"^~",":\")_$TR($P(FiNa,"\",$L(FiNa,"\")),"'","")
 i $G(%("HOST:"))'="" G TKFILE1
 s filestream=##class(%File).%New(path)
 s status=filestream.Open("WN")
 I 'status G FILERR
 F I=0:30000:by D
 .S bytes=%request.GetMimeData("FileStream").Read(30000)
 .s status=filestream.Write(bytes)
 s status=filestream.%Close()
 I 'status G FILERR
FILE2 K bytes,by S BSNamF=$P(path,"\",$L(path,"\")),MGWLIB=BS3,BSnf=BS2
 D JS^%ZAPM.ed.BSCp
 D OPEN($S($G(FILERR):"ERRCOPY^~BSCm4",1:"DUMMY^~BSCm4"))
 W "window.close();"_BK
 D JSE^%ZAPM.ed.BSCp
 D PRE
 Q
OPEN(BSLABEL)
 W "open("""_$$ADDBSGET^%ZAPM.ed.BSC4()_""",""DUMMY"",""toolbar=no,menubar=no,scrollbars=no,width=300,height=100,status=1,resizable=1"");"_BK
 Q
Status(S) Q "window.defaultStatus = '"_S_"'"_BK   
B27(PA) Q "<BODY "_$$27_">"_BK_$$js^%ZAPM.ed.BSCp_$$Status("{Esc} - отмена, закрыть окно. {F5} - обновить окно")_$$jse^%ZAPM.ed.BSCp_BK
27() Q " onkeyPress='javascript: if (27 == event.keyCode) "_$G(PA)_"window.close();' "
ERRCOPY D ERR("Ошибка копирования файла") Q
ERR(S) D SAY1("ERROR",S),SAY2("OK") Q
SAY1(T,S) D BEG1^%ZAPM.ed.BSC4 W "<TITLE>"_T_"</TITLE>"_$$B27_"<CENTER>"_RED_"<BR><H3>"_S_"</H3>"_EF Q
SAY2(S) W "<BUTTON onclick='window.close();'>&nbsp;&nbsp;&nbsp;"_S_"&nbsp;&nbsp;&nbsp;</BUTTON><CENTER>"_BK  D END^%ZAPM.ed.BSC4 Q
DUMMY N BS1,BS2,BS3,BS4,BSS1,BSS2,BSS3,BSS4,BSS5,BSS6,BSS6,BSS7,BSS8,BSS9
 D VAR1,VAR2
 D SETPAR(PT,BSNODE,BSnf,0,BSNamF)
 Q
FILERR S FILERR=1 G FILE2
ip() I MaxIndxfeild<ny Q ""
 Q " обязательный (индексированный) показатель"  
CELL() //ДАННЫЕ КЛЕТКИ
 S $ZT="ERRCELL"
 I $D(@("BSocx"_nf)) q $G(@("BSocx"_nf)) //имя переменной совпадает с именем поля
 I MaxIndxfeild'<ny Q $P(BSNODE,",",ny)
 I CurNode=""!(nf="") Q ""
 Q $G(@CurNode@(nf),$g(dflt))
ERRCELL Q ""
Act D VAR1,VAR2 I $$VAR4
 F K=1:1:KY I $P(BSNODE,",",K)'=$G(%KEY("X"_K)) S $P(BSNODE,",",K)=$G(%KEY("X"_K))
 D VAR3
 I $D(Au1) D STEP(-BSNAPR,STEP1) I CurNode="" K Au1 S b1u1=1
 I $D(Ax1) D STEP(-BSNAPR,STEPx1) I CurNode="" K Ax1 S b1u1=1
 I $D(b1u1) S CurNode=$$O(BD,KY,BSNAPR) D Act1
 I $D(b2u1) S CurNode=$$O(CurNode,KY,-BSNAPR) D Act1
 I BSNODE'="",$G(bMODE)=2 D DEL K bDEL S b3u1=1
 I $D(b3u1) S CurNode=$$O(CurNode,KY,BSNAPR)  D Act1
 I $D(Au2) D STEP(BSNAPR,STEP2) I CurNode="" K Au2 S b4u1=1
 I $D(Ax2) D STEP(BSNAPR,STEPx2) I CurNode="" K Ax2 S b4u1=1
 I $D(b4u1) S CurNode=$$O(BD,KY,-BSNAPR) D Act1
 I $G(bMODE)=4 D INS D Act1
 ;I $G(bMODE)=3 D FND D Act1
 I BSNODE'="",$G(bMODE)=1 D SAVE
 I BSNODE'="",$D(bSAV) D SAVE
Act2 D SETVAR
 G TT
Act1 I CurNode'="" S BSNODE=$$Ke(CurNode) Q
 Q
DATE //ПРИНЯТЬ ДАТУ
 D VAR1,VAR2
 N D S D=$$RETURN^%ZAPM.ed.BSC4cal I D="" Q
 D SETPAR(PT,BSNODE,BS3,BS4,D)
 Q
SETPAR(PT,BSNODE,BS3,BS4,D)
 I $G(BS4) D  //
 .I BSNODE["," S $P(BSNODE,",",BS4)=D
 .E  S BSNODE=D
 D VAR3
 D SETVAR
 I '$G(BS4) S @CurNode@(BS3)=D D SNX^%ZAPM.ed.BSChT1("S",$ZR,PT,$$KBD^%ZAPM.ed.BSF12("^%ZAPM.ed.BSC4SNX(""OUT"")")) 
 D JS^%ZAPM.ed.BSCp
 n BSLABEL,BS1,BS2,BS3,BS4 S BSLABEL="T^~BSCm4"
 W "open("""_$$ADDBSGET^%ZAPM.ed.BSC4()_""","""_BSPARENT_""",""toolbar=no,menubar=no,scrollbars=no,width=800,height=600,status=1,resizable=1"");"_BK
 W "window.close();"_BK
 D JSE^%ZAPM.ed.BSCp
 Q
FIND I $$VAR("Поиск")
FIND2 n BSLABEL S BSLABEL="FIND1^~BSCm4"
 W "<BODY "_$$27_">"_BK
 W "Определите искомые ключевые параметры"
 W "<form action="""_$$ADDLIB^%ZAPM.ed.BSC4()_""" method=""POST"" name='first1'>"
 D ADDBSPOST^%ZAPM.ed.BSC4reg
 W "<table><tr>" D TTT W "</tr></table>"
 W "<INPUT name=bFIND title='найти и установить' TYPE='submit' VALUE='Поиск'>"_BK
 W " <INPUT name=bESC onclick='window.close();' title='отказ' TYPE='button' VALUE='Отказ'>"_BK
 D JS^%ZAPM.ed.BSCp
 w "first1."_xxNAME_".focus();"_BK
 D JSE^%ZAPM.ed.BSCp
 D END^%ZAPM.ed.BSC4
 Q
FIND1 I $$VAR("Результаты Поиска")
 s BSNODE=""
 f i=1:1 q:'$d(@("X"_i))  s BSNODE=BSNODE_@("X"_i)_","
 S BSNODE=$E(BSNODE,1,$L(BSNODE)-1)
 D VAR3
 I '$$Data^%ZAPM.ed.BSF12(CurNode) W BSNODE," Не существует."_BBK G FIND2
 D SETVAR
 D JS^%ZAPM.ed.BSCp
 n BSLABEL S BSLABEL="T^~BSCm4"
 W "open("""_$$ADDBSGET^%ZAPM.ed.BSC4()_""","""_BSPARENT_""",""toolbar=no,menubar=no,scrollbars=no,width=500,height=200,status=1,resizable=1"");"_BK
 W "window.close();"_BK
 D JSE^%ZAPM.ed.BSCp
 Q            
STEP(BSNAPR,STEP) N I F I=1:1:STEP S CurNode=$$O(CurNode,KY,BSNAPR) Q:CurNode=""
 D Act1
 Q
SETKEY D VAR1
 D SetVar^%ZAPM.ed.BSC4(PT_" CurNode",BSNODE)
 G TT
 //G BACK^%ZAPM.ed.BSCh
 //W "<A target='"_BSPARENT_"' href='"_$$ADDBSGET^%ZAPM.ed.BSC4()_"'>Жми...</A>"
PRE W "<PRE>"
 ZW  
 W "</PRE>"
 Q
 //
SETVAR //СОХРАНИТЬ УСТАНОВКИ
 I $$SetVar^%ZAPM.ed.BSC4(PT_" CurNode",BSNODE)
 Q
SAVE //СОХРАНИТЬ КОРРЕКЦИЮ
 N TB,CBD,KEY
 S KEY(0)="",TB=PT,CBD=CurNode
 d SAVE^%ZAPM.ed.BSChT1 //S ErrSave=1
 i $d(ErrSave) W "Ошибки контроля. В базу данных не записано" q
 W "В базу данных записано изменений= "_N3
 Q
INS S CurNode=$$O(BD,KY,BSNAPR) D Act1
 I BSNODE["," S BSNODE=$P(BSNODE,",",1,$L(BSNODE,",")-1)_","_($P(BSNODE,",",$L(BSNODE,","))+1)
 ;N C S C=$$GETOPT^%ZAPM.ed.BSC4cfgP($NA(@PT@("Parms")),"Count")
 ;I BSNODE["," S $P(BSNODE,",",KY)=$P(BSNODE,",",KY)+1
 E  S BSNODE=BSNODE+1
 ;D SETOPT^%ZAPM.ed.BSC4cfgP($NA(@PT@("Parms")),"Count","V",C)
 D VAR3
 W "Вводите новую запись"
 Q
Ke(G) I G="" Q ""
 N I,N S N=""
 F I=1:1:$QL(G) S N=N_$QS(G,I) I I'=$QL(G) S N=N_","
 Q N     
VAR(SAY) //ПЕРЕМЕННЫЕ КОМПЛЕКСА
 W "<HTML><HEAD>"_BK_$$STYLE^%ZAPM.ed.BSC4
 D VAR1
 I '$$ZU^%ZAPM.ed.BSF4(NS) W "Недоступна область '"_NS_"'" Q 0
 W "<TITLE>"_$G(SAY1)_$G(SAY,$P($G(@PT),"@"))_" ____________________________________________________________________________________________________________________</TITLE>"_BK
 D VAR2
 Q $$VAR4
VAR4() I $G(BSNODEpredUs)'="" S BSNODE=BSNODEpredUs D SETVAR K BSNODEpredUs Q 1
 S BSNODE=$$GetVar^%ZAPM.ed.BSC4(PT_" CurNode","")
 Q 1
VAR1 S P=$$%^%ZAPM.ed.BSCh(BSPART),T=$$%^%ZAPM.ed.BSCh(BSTABL),NS=$$%^%ZAPM.ed.BSCh(BSNSP)
 I '$$ZU^%ZAPM.ed.BSF4(NS) W "Недоступна область '"_NS_"'" Q
 I $E(P,1)'="^" S P="^"_P
 S PT=$NA(@P@(T))
 S ArrOUT=$$KBD^%ZAPM.ed.BSF12("^%ZAPM.ed.BSC4SNX(""OUT"")")
 Q
VAR2 M BD=@PT@("KEY")
 S KY=$O(BD(""),-1) //КОЛИЧЕСТВО КЛЮЧЕЙ
 S GLO=BD
 Q
ERRDataSet Q ""
O(G,K,N) //$O
 N GG,A,I S $ZT="ERRDataSet"
 I G="" Q ""
 I G'["(" D  Q $$Q(GG)
 .I N=-1 S GG=$ZO(@(G_"("""")"),N)
 .E  S GG=$ZO(@G,N)
 .I GG="" Q
 .I $QL(GG)'<K Q
 .F  S GG=$ZO(@GG) Q:GG=""  I $QL(GG)'<K Q
 //A - ШАБЛОН
 I $QL(G)'<K S A=$P(G,"(") D  S A=$P(A,")")
 .F I=1:1:K S A=$NA(@A@($QS(G,I)))
 E  S A=G
 S GG=G F  S GG=$ZO(@GG,N) Q:GG=""  I $QL(GG)'<K,GG'[A Q
 Q $$Q(GG)
Q(GG) I GG="" Q ""
 N A,I S A=$P(GG,"(") F I=1:1:K S A=$NA(@A@($QS(GG,I)))
 Q A
]]></Routine>


<Routine name="%ZAPM.ed.BSCm41" type="MAC" languagemode="0"><![CDATA[
%BSCm41 //СПИСОК ДАННЫХ ТАБЛИЦЫ
 ;
 ;    Copyright (C) Serge W. Mikhaylenko
 ;    All Rights Reserved
 ;
 Q       
 //i '$D(NoList),$$GETOPT^%ZAPM.ed.BSC4cfgP($NA(@PT@("Parms")),"CNavigList") G List
ListTab(CurNode,BSNODE,TX,St1,St2)
 N Q,I
 S Q="<tr>"
 f ny=1:1:Maxfeild D
 .N TRANS
 .s var1=$$GetField^%ZAPM.ed.BSC4rou(P,T,ny,1)
 .s nf=$P(var1,"~",1)
 .I $G(TX)'="" S Q=Q_"<td class=s3>"_nf_"</td>" Q
 .s Description=$P(var1,"~",2) //вычленить описание поля
 .S xClass="s"_St1 i MaxIndxfeild'<ny S xClass="s"_St2
 .S Q=Q_"<td class="_xClass_" title='Загрузить запись для коррекции'>"
 .S (d,d1,d0)=$$CELL^%ZAPM.ed.BSCm4 I d="" S d="&nbsp;"
 .I ny=1 S BSLABEL="Tn^~BSCm41",Q=Q_"<div class='u1' onclick='open("""_$$ADDBSGET^%ZAPM.ed.BSC4()_""","""_BSPARENT_""",""toolbar=no,menubar=no,scrollbars=yes,width=800,height=600,status=1,resizable=1"");'>"
 .S Q=Q_d
 .I ny=1 S Q=Q_"</div>"
 .S Q=Q_"</td>"
 S Q=Q_"</tr>"
 Q Q
Tn S BSList=2 d VAR1^%ZAPM.ed.BSCm4,SETVAR^%ZAPM.ed.BSCm4 G T^%ZAPM.ed.BSCm4      
List S BSList=1,SAY1="Список записей " G T^%ZAPM.ed.BSCm4
List0 //список данных
 //S DISABLE=0 I $$O(CurNode,KY,-BSNAPR)="" S DISABLE=1
 //S BSLABEL="SETKEY^~BSCm4"
 //S Q=Q_"<td><select name=MODE1 size=1 onclick=""javascript: { if (''!=MODE1.value & ('"_BSNODE_"'!=MODE1.value)) parent.location='"_$$ADDBSGET^%ZAPM.ed.BSC4()_"&STEP1="_$G(STEP1)_"&STEP2="_$G(STEP2)_"&BSNODE='+MODE1.value; } "" >"_BK
 S Tmp=BSPARENT N BSPARENT
 S BSPARENT=Tmp_"o"
 W "<table>" D VAR3^%ZAPM.ed.BSCm4
 s Maxfeild=$$GetField^%ZAPM.ed.BSC4rou(P,T,"Count",1)
 s MaxIndxfeild=$$GetField^%ZAPM.ed.BSC4rou(P,T,"Index",1)
 S GLO=CurNode F ind=1:1:KL S GLO=$$O^%ZAPM.ed.BSCm4(GLO,KY,-BSNAPR) Q:GLO=""  S GLO1=$$Ke^%ZAPM.ed.BSCm4(GLO) S KL(ind)=$$ListTab(GLO,GLO1,,1,2)
 S KL(ind+1)=$$ListTab(1,1,1,1,2)        I ind=KL,GLO'="" S KL(ind+2)="<tr><td>...дальше</td></tr>"_BK
 S ind="" F  S ind=$O(KL(ind),-1) Q:ind=""  W KL(ind)_BK
 S GLO1=$$Ke^%ZAPM.ed.BSCm4(CurNode) W $$ListTab(CurNode,GLO1,,2,1)_BK
 S GLO=CurNode F ind=1:1:KL S GLO=$$O^%ZAPM.ed.BSCm4(GLO,KY,BSNAPR) Q:GLO=""  S GLO1=$$Ke^%ZAPM.ed.BSCm4(GLO) W $$ListTab(GLO,GLO1,,1,2)_BK
 W $$ListTab(1,1,1,1,2)
 I ind=KL,GLO'="" W "<tr><td>...дальше</td></tr>"_BK
 W "</table>"
 //S Q=Q_"</select></td>"_BK
 //I $$O(CurNode,KY,BSNAPR)="" S DISABLE=2
 D JS^%ZAPM.ed.BSCp
 w "window.defaultStatus = '{F5} - обновить окно'"_BK
 D JSE^%ZAPM.ed.BSCp
 D END^%ZAPM.ed.BSC4
 q
]]></Routine>


<Routine name="%ZAPM.ed.BSCmBP" type="MAC" languagemode="0"><![CDATA[
%BSCmBP ;ПРОГРАММА ФУНКЦИЙ И МОДУЛЕЙ ДЛЯ БОЕВЫХ ПОТЕРЕЙ
 ;
 ;    Copyright Serge W. Mikhaylenko
 ;    All Rights Reserved
 ;
 Q
1 //ВЫГРУЗКА КЛАССИФИКАТОРОВ
 I $ZU(5,"GLAVK")
 F KD1="KPPOT","BPRBD","k056" D KD(KD1)
 Q
KD(KD) N %FN,%DEV
 S PR1="L:\!\"_KD D DOSOPN^%ZAPM.ed.BSBL1 I '$D(%FN) Q
 U %DEV W "KOD|TEXT|",!
 S KOD="^"_KD,S="" F  S S=$O(@KOD@(1,S)) Q:S=""  W S,"|",$G(@KOD@(1,S)),"|",!
 C %DEV
 Q
2 	//ВЫГРУЗИМ В ФАЙЛ
	S N="L:\!\U"
	O N:("WNS"):3 U N W ^%CDUaf,!
	S S="" F  S S=$O(^%CDUaf(S)) Q:S=""  W S,$C(0),$G(^%CDUaf(S)),!
	C N
	Q
3 //В ДРУГОЙ СНОВА ЗАГРУЗИМ
 K ^%CDUaaaa
 S A=$$File2Arr^%ZAPM.ed.BSCEXE("L:\!\U",.M) ;ЗАГРУЗИМ ФАЙЛ В ЛОКАЛЬ
 D STR2MAS^%ZAPM.ed.BSCmail(.M,.AA,$C(13,10)) ;ЛОКАЛЬ ПРИЧЕШЕМ
 S S="" F  S S=$O(AA(S)) Q:S=""  D
 .I S=1 S ^%CDUaaaa=AA(S) Q
 .S S1=$P(AA(S),$C(0),1),S2=$P(AA(S),$C(0),2),^%CDUaaaa(S1)=S2
 Q
]]></Routine>


<Routine name="%ZAPM.ed.BSCmBf" type="MAC" languagemode="0"><![CDATA[
rhBlowfish	;  ; Compiled January 31, 2005 23:39:40
	; Cache Object Script implementation of the Blowfish symmetric block cipher
	; Copyright (C) 2001 COD International BV
	; Naarden, The Netherlands <www.codgroep.nl>. All rights reserved.
	; You are free to use this code in your applications without liability
	; or compensation, but the courtesy of both notification of use and	
	; inclusion of due credit are requested. You must keep this copyright
	; notice intact.
	; It is PROHIBITED to distribute or reproduce this code for profit
	; or otherwise, on any web site, ftp server or BBS, or by any
	; other means, including CD-ROM or other physical media, without the
	; EXPRESS WRITTEN PERMISSION of the copyright holder.
	; Use at your own risk.
	; COD International BV offers no warranty of its fitness for any
	; purpose whatsoever, and accept no liability whatsoever for any
	; loss or damage incurred by its use.
	; If you use it, or found it useful, or can suggest an improvement
	; please let us know at <development@codgroep.nl>.
	; Author: Herman Slagman
	; Blowfish is a symmetric block cipher that can be used as a drop-in
	; replacement for DES or IDEA.
	; It takes a variable-length key, from 32 bits to 448 bits, making it
	; ideal for both domestic and exportable use.
	; Blowfish was designed in 1993 by Bruce Schneier as a fast, free
	; alternative to existing encryption algorithms.
	; Since then it has been analyzed considerably, and it is slowly gaining
	; acceptance as a strong encryption algorithm.
	; Blowfish is unpatented and license-free, and is available free for all uses. 
	; <www.counterpane.com/blowfish.html>
	; Restrictions.
	; This code relies heavily on macro preprocessor commands, it should
	; therefor be compiled as a Cache Object Script MAC routine.
	; It also uses the Cache 4.x and higher COS language enhancements, such
	; as multiline commands, and needs to be adjusted for use on earlier
	; Note.
	; Based on the Visual Basic implementation of David Ireland, DI Management Services Pty Ltd, Sydney Australia
	; <www.di-mgt.com.au>
EncryptString(sText,sKey)
	New i,nLen,nPad,sPad,nBlocks,sPlain,S,P,awData,sCipher,Bytes,j
	Do InitialiseKey(sKey)
	Set nLen = $Length(sText)
	Set nPad = ((nLen \ 8) + 1) * 8 - nLen
	Set sPad = $Translate($Justify("",nPad)," ",$Char(nPad))  ; Pad with # of pads (1-8)
	Set sPlain = sText_sPad
	Set nLen = $Length(sPlain)
	Set nBlocks = nLen \ 8
	; Split string into blocks of 2 x 32-bit words
	For i = 0:8:(nBlocks - 1*8) {
	    Set awData(i\8*2)=$Ascii(sPlain,i+1)*(16777216)+($Ascii(sPlain,i+2)*(65536))+($Ascii(sPlain,i+3)*256)+$Ascii(sPlain,i+4)
	    Set awData(i\8*2+1)=$Ascii(sPlain,i+5)*(16777216)+($Ascii(sPlain,i+6)*(65536))+($Ascii(sPlain,i+7)*256)+$Ascii(sPlain,i+8)
	}
	Do Enc(nBlocks * 2)
	; Put back into a string
	Set sCipher = ""
	For i = 0:1:nBlocks-1 {
	    Do WordSplit(awData(i * 2),.Bytes)
	    For j=0:1:3 Set sCipher = sCipher_$Char(Bytes(j))
	    Do WordSplit(awData(i * 2+1),.Bytes)
	    For j=0:1:3 Set sCipher = sCipher_$Char(Bytes(j))
	}
	Quit sCipher
Enc(nWords)
	New i,xL,xR
	For i = 0:2:nWords-1 {
	    Set xL = awData(i), xR = awData(i+1)
	    Do EncipherBlock(.xL,.xR)
	    Set awData(i) = xL, awData(i+1) = xR
	}
	Quit
EncryptFile(FileIn,FileOut,sKey)
	New i,nLen,nPad,sPad,nBlocks,sPlain,S,P,awData,sCipher,Bytes,j
	Open FileIn:"rs":0 If '$Test Quit
	Open FileOut:"wns":0 If '$Test Close FileIn Quit
	Do InitialiseKey(sKey)
	Set $Ztrap="EncEOF"
	For  {
	   Kill Bytes
	   For i=0:1:7 Use FileIn Read *Bytes(i)
	   Do EncryptBytes(.Bytes)
	   For i=0:1:7 Use FileOut Write $Char(Bytes(i))
	}
EncEOF
	If $ZE'["ENDOFFILE" Close FileIn,FileOut Write $ZE Quit
	Set nPad=8-$Order(Bytes(""),-1)
	For i=1:1:nPad Set Bytes(8-i)=nPad
	Do EncryptBytes(.Bytes)
	For i=0:1:7 Use FileOut Write $Char(Bytes(i))
	Close FileIn
	Close FileOut   
	Quit
EncryptBytes(Bytes)
	; Encrypt an array of 8 bytes
	New wordL,wordR
	; Convert to 2 x words
	Set wordL = Bytes(0)*(16777216)+(Bytes(1)*(65536))+(Bytes(2)*256)+Bytes(3)
	Set wordR = Bytes(4)*(16777216)+(Bytes(5)*(65536))+(Bytes(6)*256)+Bytes(7)
	; Encrypt it
	Do EncipherBlock(.wordL, .wordR)
	; Put back into bytes
	Set Bytes(0)=wordL#(4294967296)\(16777216)   
	Set Bytes(1)=wordL#(16777216)\(65536)
	Set Bytes(2)=wordL#(65536)\256   
	Set Bytes(3)=wordL#256
	Set Bytes(4)=wordR#(4294967296)\(16777216)   
	Set Bytes(5)=wordR#(16777216)\(65536)
	Set Bytes(6)=wordR#(65536)\256   
	Set Bytes(7)=wordR#256
	Quit
EncipherBlock(xL,xR)
	New i,temp
	For i = 0:1:15 {
	   Set xL = $$XOR(xL,P(i))
	   Set xR = $$XOR($$F(xL),xR)
	   Set temp = xL
	   Set xL = xR
	   Set xR = temp
	}
	Set temp = xL
	Set xL = xR
	Set xR = temp
	Set xR = $$XOR(xR,P(16))
	Set xL = $$XOR(xL,P(17))
	Quit
DecryptString(sCipher,sKey)
	New awData,D1,D2,i,j,sPlain,S,P,nPad
	New nLen,nBlocks,D,Bytes
	Do InitialiseKey(sKey)
	Set nLen = $Length(sCipher)
	Set nBlocks = nLen \ 8
	; Split string into blocks of 2 x 32-bit words
	For i = 0:8:(nBlocks - 1*8) {
	    Set awData(i\8*2) = $Ascii(sCipher,i+1)*(16777216)+($Ascii(sCipher,i+2)*(65536))+($Ascii(sCipher,i+3)*256)+$Ascii(sCipher,i+4)
	    Set awData(i\8*2+1) = $Ascii(sCipher,i+5)*(16777216)+($Ascii(sCipher,i+6)*(65536))+($Ascii(sCipher,i+7)*256)+$Ascii(sCipher,i+8)
	}
	; Decrypt it
	Do Dec(nBlocks * 2)
	; Put back into a string
	Set sPlain = ""
	For i = 0:1:nBlocks-1 {
	    Do WordSplit(awData(i * 2),.Bytes)
	    For j=0:1:3 Set sPlain = sPlain_$Char(Bytes(j))
	    Do WordSplit(awData(i * 2+1),.Bytes)
	    For j=0:1:3 Set sPlain = sPlain_$Char(Bytes(j))
	}
	; Strip padding
	Set nPad = $Ascii(sPlain,$Length(sPlain))
	Set sPlain = $Extract(sPlain,0, nLen - nPad)
	Quit sPlain
Dec(nWords)
	New i,xL,xR
	For i = 0:2:nWords-1 {
	   Set xL = awData(i),xR = awData(i+1)
	   Do DecipherBlock(.xL,.xR)
	   Set awData(i) = xL, awData(i+1) = xR
	}
	Quit
DecryptFile(FileIn,FileOut,Key)
	New i,nLen,nPad,sPad,nBlocks,sPlain,S,P,awData,sCipher,Bytes,j,InitByte
	Set $ZTrap=""
	Open FileIn:"rs":0 If '$Test Use 0 Write "Cannot open "_FileIn_" for input",! Quit
	Open FileOut:"wns":0 If '$Test Use 0 Write "Cannot open "_FileOut_" for output",! Close FileIn Quit
	Do InitialiseKey(Key)
	Set $ZTrap="DecEOF"
	; we need InitByte to detect EOF before writing the last 8 Bytes
	Use FileIn Read *InitByte
	For  {
	   Kill Bytes
	   Set Bytes(0)=InitByte
	   For i=1:1:7 Use FileIn Read *Bytes(i)
	   Do DecryptBytes(.Bytes)
	   ; we need to know if we are at EOF in order to remove padding
	   Use FileIn Read *InitByte
	   For i=0:1:7 Use FileOut Write $Char(Bytes(i))
	}
DecEOF	;
	If $ZE'["ENDOFFILE" Close FileIn,FileOut Use 0 Write "Error = "_$ZE,! Quit
	Set $ZTrap=""
	; Don't write pad bytes
	For i=0:1:7-Bytes(7) Use FileOut Write $Char(Bytes(i))
	Close FileIn
	Close FileOut   
	Quit
DecryptBytes(Bytes)
	; Decrypt an array of 8 bytes
	New wordL,wordR
	; Convert to 2 x words
	Set wordL = Bytes(0)*(16777216)+(Bytes(1)*(65536))+(Bytes(2)*256)+(Bytes(3))
	Set wordR = Bytes(4)*(16777216)+(Bytes(5)*(65536))+(Bytes(6)*256)+(Bytes(7))
	; Decrypt it
	Do DecipherBlock(.wordL, .wordR)
	; Put back into bytes
	Set Bytes(0)=wordL#(4294967296)\(16777216)   
	Set Bytes(1)=wordL#(16777216)\(65536)
	Set Bytes(2)=wordL#(65536)\256   
	Set Bytes(3)=wordL#256
	Set Bytes(4)=wordR#(4294967296)\(16777216)   
	Set Bytes(5)=wordR#(16777216)\(65536)
	Set Bytes(6)=wordR#(65536)\256   
	Set Bytes(7)=wordR#256
	Quit
DecipherBlock(xL,xR)
	New i,temp
	For i = 17:-1:2 {
	   Set xL = $$XOR(xL,P(i))
	   Set xR = $$XOR($$F(xL),xR)
	   Set temp = xL
	   Set xL = xR
	   Set xR = temp
	}
	Set temp = xL
	Set xL = xR
	Set xR = temp
	Set xR = $$XOR(xR,P(1))
	Set xL = $$XOR(xL,P(0))
	Quit
F(x)	
	New y,Bytes,B0,B1,B2,B3
	; x is a 4 byte word (32 bits)
	Set B0=x#(4294967296)\(16777216)   
	Set B1=x#(16777216)\(65536)
	Set B2=x#(65536)\256   
	Set B3=x#256
	Set y = $$WordAdd(S(0, B0), S(1, B1))
	Set y = $$XOR(y,S(2, B2))
	Set y = $$WordAdd(y, S(3, B3))
	Quit y
ShiftLeftBy8(wordX)
	New SL
	Set SL=wordX*256#4294967296
	If SL>2147483647 Set SL=SL-4294967296
	Quit SL
WordAdd(wordA,wordB)
	; Adds words A and B avoiding overflow
	New WA
	If wordA < 0 Set wordA = wordA + 4294967296
	If wordB < 0 Set wordB = wordB + 4294967296
	Set WA=wordA+wordB
	If WA > 2147483647 Set WA = WA - 4294967296
	Quit WA
WordSplit(Word,Bytes)
	;' Splits 32-bit word (long) into 4 x 8-bit bytes
	Set Bytes(0)=Word#(4294967296)\(16777216)   
	Set Bytes(1)=Word#(16777216)\(65536)
	Set Bytes(2)=Word#(65536)\256   
	Set Bytes(3)=Word#256
	Quit 
WordJoin(a,b,c,d)
	; Joins 4 x 8-bit bytes to form 32-bit word a.b.c.d
	Quit a*16777216+(b*65536)+(c*256)+d
UnsignedToLong(value)
	If value < 0 ! value '< 4294967296 Quit  ;Error 6 ' Overflow
	If value '> 2147483647 Quit value
	Quit value - 4294967296
LongToUnsigned(value)
	If value < 0 Quit value + 4294967296
	Quit value
AND(a,b)
	New r
	Set r=$ZBoolean(a,b,1)
	If r>2147483647 Set r=r-4294967296
	Quit r
XOR(a,b)
	New r   
	Set r = $ZBoolean(a,b,6)
	If r>2147483647 Set r=r-4294967296
	Quit r
OR(a,b)
	New r   
	Set r = $ZBoolean(a,b,7)
	If r>2147483647 Set r=r-4294967296
	Quit r
InitialiseKey(Key)
	New i,j,K,wData,wDataL,wDataR,Hash
	New S1,S2,P1
	; Because creating a key can take a while we save created keys in a global under an encrypted key
	Set Hash=$$Encrypt^%ZAPM.ed.BSCmd5(Key)
	If $Data(^rhBlowfish(Hash)) Do  Quit
	.   Set S1="" For  Set S1=$Order(^rhBlowfish(Hash,"S",S1)) Quit:S1=""  Do
	..      Set S2=""  For  Set S2=$Order(^rhBlowfish(Hash,"S",S1,S2)) Quit:S2=""  Set S(S1,S2)=^(S2)
	.   Set P1="" For  Set P1=$Order(^rhBlowfish(Hash,"P",P1)) Quit:P1=""  Set P(P1)=^(P1)
	Set NrBytes=$Length(Key)
	Do InitArrays
	Set j = 1
	For i = 0:1:17 {
	   Set wData = 0
	   For K = 0:1:3 {
	      Set wData = $$OR($$ShiftLeftBy8(wData),$Ascii(Key,j))
	      Set j = j + 1
	      If j>NrBytes Set j = 1
	   }
	   Set P(i) = $$XOR(P(i),wData)
	}
	Set wDataL = 0
	Set wDataR = 0
	For i = 0:2:17 {
	   Do EncipherBlock(.wDataL, .wDataR)
	   Set P(i) = wDataL
	   Set P(i + 1) = wDataR
	}
	For i = 0:1:3 {
	   For j = 0:2:255 {
	      Do EncipherBlock(.wDataL, .wDataR)
	      Set S(i, j) = wDataL
	      Set S(i, j + 1) = wDataR
	   }
	}
	; save the key for future use
	Set S1=""
	For  {
	   Set S1=$Order(S(S1))
	   If S1="" Quit
	   Set S2=""
	   For  {
	      Set S2=$Order(S(S1,S2))
	      If S2="" Quit
	      Set ^rhBlowfish(Hash,"S",S1,S2)=S(S1,S2)
	   }
	}
	Set P1=""
	For  {
	   Set P1=$Order(P(P1))
	   If P1="" Quit
	   Set ^rhBlowfish(Hash,"P",P1)=P(P1)
	}
	Quit
InitArrays	; Init arrays
	Kill S,P
	Set S(0,0)=3509652390,S(0,1)=2564797868,S(0,2)=805139163,S(0,3)=3491422135,S(0,4)=3101798381,S(0,5)=1780907670
	Set S(0,6)=3128725573,S(0,7)=4046225305,S(0,8)=614570311,S(0,9)=3012652279,S(0,10)=134345442,S(0,11)=2240740374
	Set S(0,12)=1667834072,S(0,13)=1901547113,S(0,14)=2757295779,S(0,15)=4103290238,S(0,16)=227898511,S(0,17)=1921955416
	Set S(0,18)=1904987480,S(0,19)=2182433518,S(0,20)=2069144605,S(0,21)=3260701109,S(0,22)=2620446009,S(0,23)=720527379
	Set S(0,24)=3318853667,S(0,25)=677414384,S(0,26)=3393288472,S(0,27)=3101374703,S(0,28)=2390351024,S(0,29)=1614419982
	Set S(0,30)=1822297739,S(0,31)=2954791486,S(0,32)=3608508353,S(0,33)=3174124327,S(0,34)=2024746970,S(0,35)=1432378464
	Set S(0,36)=3864339955,S(0,37)=2857741204,S(0,38)=1464375394,S(0,39)=1676153920,S(0,40)=1439316330,S(0,41)=715854006
	Set S(0,42)=3033291828,S(0,43)=289532110,S(0,44)=2706671279,S(0,45)=2087905683,S(0,46)=3018724369,S(0,47)=1668267050
	Set S(0,48)=732546397,S(0,49)=1947742710,S(0,50)=3462151702,S(0,51)=2609353502,S(0,52)=2950085171,S(0,53)=1814351708
	Set S(0,54)=2050118529,S(0,55)=680887927,S(0,56)=999245976,S(0,57)=1800124847,S(0,58)=3300911131,S(0,59)=1713906067
	Set S(0,60)=1641548236,S(0,61)=4213287313,S(0,62)=1216130144,S(0,63)=1575780402,S(0,64)=4018429277,S(0,65)=3917837745
	Set S(0,66)=3693486850,S(0,67)=3949271944,S(0,68)=596196993,S(0,69)=3549867205,S(0,70)=258830323,S(0,71)=2213823033
	Set S(0,72)=772490370,S(0,73)=2760122372,S(0,74)=1774776394,S(0,75)=2652871518,S(0,76)=566650946,S(0,77)=4142492826
	Set S(0,78)=1728879713,S(0,79)=2882767088,S(0,80)=1783734482,S(0,81)=3629395816,S(0,82)=2517608232,S(0,83)=2874225571
	Set S(0,84)=1861159788,S(0,85)=326777828,S(0,86)=3124490320,S(0,87)=2130389656,S(0,88)=2716951837,S(0,89)=967770486
	Set S(0,90)=1724537150,S(0,91)=2185432712,S(0,92)=2364442137,S(0,93)=1164943284,S(0,94)=2105845187,S(0,95)=998989502
	Set S(0,96)=3765401048,S(0,97)=2244026483,S(0,98)=1075463327,S(0,99)=1455516326,S(0,100)=1322494562,S(0,101)=910128902
	Set S(0,102)=469688178,S(0,103)=1117454909,S(0,104)=936433444,S(0,105)=3490320968,S(0,106)=3675253459,S(0,107)=1240580251
	Set S(0,108)=122909385,S(0,109)=2157517691,S(0,110)=634681816,S(0,111)=4142456567,S(0,112)=3825094682,S(0,113)=3061402683
	Set S(0,114)=2540495037,S(0,115)=79693498,S(0,116)=3249098678,S(0,117)=1084186820,S(0,118)=1583128258,S(0,119)=426386531
	Set S(0,120)=1761308591,S(0,121)=1047286709,S(0,122)=322548459,S(0,123)=995290223,S(0,124)=1845252383,S(0,125)=2603652396
	Set S(0,126)=3431023940,S(0,127)=2942221577,S(0,128)=3202600964,S(0,129)=3727903485,S(0,130)=1712269319,S(0,131)=422464435
	Set S(0,132)=3234572375,S(0,133)=1170764815,S(0,134)=3523960633,S(0,135)=3117677531,S(0,136)=1434042557,S(0,137)=442511882
	Set S(0,138)=3600875718,S(0,139)=1076654713,S(0,140)=1738483198,S(0,141)=4213154764,S(0,142)=2393238008,S(0,143)=3677496056
	Set S(0,144)=1014306527,S(0,145)=4251020053,S(0,146)=793779912,S(0,147)=2902807211,S(0,148)=842905082,S(0,149)=4246964064
	Set S(0,150)=1395751752,S(0,151)=1040244610,S(0,152)=2656851899,S(0,153)=3396308128,S(0,154)=445077038,S(0,155)=3742853595
	Set S(0,156)=3577915638,S(0,157)=679411651,S(0,158)=2892444358,S(0,159)=2354009459,S(0,160)=1767581616,S(0,161)=3150600392
	Set S(0,162)=3791627101,S(0,163)=3102740896,S(0,164)=284835224,S(0,165)=4246832056,S(0,166)=1258075500,S(0,167)=768725851
	Set S(0,168)=2589189241,S(0,169)=3069724005,S(0,170)=3532540348,S(0,171)=1274779536,S(0,172)=3789419226,S(0,173)=2764799539
	Set S(0,174)=1660621633,S(0,175)=3471099624,S(0,176)=4011903706,S(0,177)=913787905,S(0,178)=3497959166,S(0,179)=737222580
	Set S(0,180)=2514213453,S(0,181)=2928710040,S(0,182)=3937242737,S(0,183)=1804850592,S(0,184)=3499020752,S(0,185)=2949064160
	Set S(0,186)=2386320175,S(0,187)=2390070455,S(0,188)=2415321851,S(0,189)=4061277028,S(0,190)=2290661394,S(0,191)=2416832540
	Set S(0,192)=1336762016,S(0,193)=1754252060,S(0,194)=3520065937,S(0,195)=3014181293,S(0,196)=791618072,S(0,197)=3188594551
	Set S(0,198)=3933548030,S(0,199)=2332172193,S(0,200)=3852520463,S(0,201)=3043980520,S(0,202)=413987798,S(0,203)=3465142937
	Set S(0,204)=3030929376,S(0,205)=4245938359,S(0,206)=2093235073,S(0,207)=3534596313,S(0,208)=375366246,S(0,209)=2157278981
	Set S(0,210)=2479649556,S(0,211)=555357303,S(0,212)=3870105701,S(0,213)=2008414854,S(0,214)=3344188149,S(0,215)=4221384143
	Set S(0,216)=3956125452,S(0,217)=2067696032,S(0,218)=3594591187,S(0,219)=2921233993,S(0,220)=2428461,S(0,221)=544322398
	Set S(0,222)=577241275,S(0,223)=1471733935,S(0,224)=610547355,S(0,225)=4027169054,S(0,226)=1432588573,S(0,227)=1507829418
	Set S(0,228)=2025931657,S(0,229)=3646575487,S(0,230)=545086370,S(0,231)=48609733,S(0,232)=2200306550,S(0,233)=1653985193
	Set S(0,234)=298326376,S(0,235)=1316178497,S(0,236)=3007786442,S(0,237)=2064951626,S(0,238)=458293330,S(0,239)=2589141269
	Set S(0,240)=3591329599,S(0,241)=3164325604,S(0,242)=727753846,S(0,243)=2179363840,S(0,244)=146436021,S(0,245)=1461446943
	Set S(0,246)=4069977195,S(0,247)=705550613,S(0,248)=3059967265,S(0,249)=3887724982,S(0,250)=4281599278,S(0,251)=3313849956
	Set S(0,252)=1404054877,S(0,253)=2845806497,S(0,254)=146425753,S(0,255)=1854211946
	Set S(1,0)=1266315497,S(1,1)=3048417604,S(1,2)=3681880366,S(1,3)=3289982499,S(1,4)=2909710000,S(1,5)=1235738493
	Set S(1,6)=2632868024,S(1,7)=2414719590,S(1,8)=3970600049,S(1,9)=1771706367,S(1,10)=1449415276,S(1,11)=3266420449
	Set S(1,12)=422970021,S(1,13)=1963543593,S(1,14)=2690192192,S(1,15)=3826793022,S(1,16)=1062508698,S(1,17)=1531092325
	Set S(1,18)=1804592342,S(1,19)=2583117782,S(1,20)=2714934279,S(1,21)=4024971509,S(1,22)=1294809318,S(1,23)=4028980673
	Set S(1,24)=1289560198,S(1,25)=2221992742,S(1,26)=1669523910,S(1,27)=35572830,S(1,28)=157838143,S(1,29)=1052438473
	Set S(1,30)=1016535060,S(1,31)=1802137761,S(1,32)=1753167236,S(1,33)=1386275462,S(1,34)=3080475397,S(1,35)=2857371447
	Set S(1,36)=1040679964,S(1,37)=2145300060,S(1,38)=2390574316,S(1,39)=1461121720,S(1,40)=2956646967,S(1,41)=4031777805
	Set S(1,42)=4028374788,S(1,43)=33600511,S(1,44)=2920084762,S(1,45)=1018524850,S(1,46)=629373528,S(1,47)=3691585981
	Set S(1,48)=3515945977,S(1,49)=2091462646,S(1,50)=2486323059,S(1,51)=586499841,S(1,52)=988145025,S(1,53)=935516892
	Set S(1,54)=3367335476,S(1,55)=2599673255,S(1,56)=2839830854,S(1,57)=265290510,S(1,58)=3972581182,S(1,59)=2759138881
	Set S(1,60)=3795373465,S(1,61)=1005194799,S(1,62)=847297441,S(1,63)=406762289,S(1,64)=1314163512,S(1,65)=1332590856
	Set S(1,66)=1866599683,S(1,67)=4127851711,S(1,68)=750260880,S(1,69)=613907577,S(1,70)=1450815602,S(1,71)=3165620655
	Set S(1,72)=3734664991,S(1,73)=3650291728,S(1,74)=3012275730,S(1,75)=3704569646,S(1,76)=1427272223,S(1,77)=778793252
	Set S(1,78)=1343938022,S(1,79)=2676280711,S(1,80)=2052605720,S(1,81)=1946737175,S(1,82)=3164576444,S(1,83)=3914038668
	Set S(1,84)=3967478842,S(1,85)=3682934266,S(1,86)=1661551462,S(1,87)=3294938066,S(1,88)=4011595847,S(1,89)=840292616
	Set S(1,90)=3712170807,S(1,91)=616741398,S(1,92)=312560963,S(1,93)=711312465,S(1,94)=1351876610,S(1,95)=322626781
	Set S(1,96)=1910503582,S(1,97)=271666773,S(1,98)=2175563734,S(1,99)=1594956187,S(1,100)=70604529,S(1,101)=3617834859
	Set S(1,102)=1007753275,S(1,103)=1495573769,S(1,104)=4069517037,S(1,105)=2549218298,S(1,106)=2663038764,S(1,107)=504708206
	Set S(1,108)=2263041392,S(1,109)=3941167025,S(1,110)=2249088522,S(1,111)=1514023603,S(1,112)=1998579484,S(1,113)=1312622330
	Set S(1,114)=694541497,S(1,115)=2582060303,S(1,116)=2151582166,S(1,117)=1382467621,S(1,118)=776784248,S(1,119)=2618340202
	Set S(1,120)=3323268794,S(1,121)=2497899128,S(1,122)=2784771155,S(1,123)=503983604,S(1,124)=4076293799,S(1,125)=907881277
	Set S(1,126)=423175695,S(1,127)=432175456,S(1,128)=1378068232,S(1,129)=4145222326,S(1,130)=3954048622,S(1,131)=3938656102
	Set S(1,132)=3820766613,S(1,133)=2793130115,S(1,134)=2977904593,S(1,135)=26017576,S(1,136)=3274890735,S(1,137)=3194772133
	Set S(1,138)=1700274565,S(1,139)=1756076034,S(1,140)=4006520079,S(1,141)=3677328699,S(1,142)=720338349,S(1,143)=1533947780
	Set S(1,144)=354530856,S(1,145)=688349552,S(1,146)=3973924725,S(1,147)=1637815568,S(1,148)=332179504,S(1,149)=3949051286
	Set S(1,150)=53804574,S(1,151)=2852348879,S(1,152)=3044236432,S(1,153)=1282449977,S(1,154)=3583942155,S(1,155)=3416972820
	Set S(1,156)=4006381244,S(1,157)=1617046695,S(1,158)=2628476075,S(1,159)=3002303598,S(1,160)=1686838959,S(1,161)=431878346
	Set S(1,162)=2686675385,S(1,163)=1700445008,S(1,164)=1080580658,S(1,165)=1009431731,S(1,166)=832498133,S(1,167)=3223435511
	Set S(1,168)=2605976345,S(1,169)=2271191193,S(1,170)=2516031870,S(1,171)=1648197032,S(1,172)=4164389018,S(1,173)=2548247927
	Set S(1,174)=300782431,S(1,175)=375919233,S(1,176)=238389289,S(1,177)=3353747414,S(1,178)=2531188641,S(1,179)=2019080857
	Set S(1,180)=1475708069,S(1,181)=455242339,S(1,182)=2609103871,S(1,183)=448939670,S(1,184)=3451063019,S(1,185)=1395535956
	Set S(1,186)=2413381860,S(1,187)=1841049896,S(1,188)=1491858159,S(1,189)=885456874,S(1,190)=4264095073,S(1,191)=4001119347
	Set S(1,192)=1565136089,S(1,193)=3898914787,S(1,194)=1108368660,S(1,195)=540939232,S(1,196)=1173283510,S(1,197)=2745871338
	Set S(1,198)=3681308437,S(1,199)=4207628240,S(1,200)=3343053890,S(1,201)=4016749493,S(1,202)=1699691293,S(1,203)=1103962373
	Set S(1,204)=3625875870,S(1,205)=2256883143,S(1,206)=3830138730,S(1,207)=1031889488,S(1,208)=3479347698,S(1,209)=1535977030
	Set S(1,210)=4236805024,S(1,211)=3251091107,S(1,212)=2132092099,S(1,213)=1774941330,S(1,214)=1199868427,S(1,215)=1452454533
	Set S(1,216)=157007616,S(1,217)=2904115357,S(1,218)=342012276,S(1,219)=595725824,S(1,220)=1480756522,S(1,221)=206960106
	Set S(1,222)=497939518,S(1,223)=591360097,S(1,224)=863170706,S(1,225)=2375253569,S(1,226)=3596610801,S(1,227)=1814182875
	Set S(1,228)=2094937945,S(1,229)=3421402208,S(1,230)=1082520231,S(1,231)=3463918190,S(1,232)=2785509508,S(1,233)=435703966
	Set S(1,234)=3908032597,S(1,235)=1641649973,S(1,236)=2842273706,S(1,237)=3305899714,S(1,238)=1510255612,S(1,239)=2148256476
	Set S(1,240)=2655287854,S(1,241)=3276092548,S(1,242)=4258621189,S(1,243)=236887753,S(1,244)=3681803219,S(1,245)=274041037
	Set S(1,246)=1734335097,S(1,247)=3815195456,S(1,248)=3317970021,S(1,249)=1899903192,S(1,250)=1026095262,S(1,251)=4050517792
	Set S(1,252)=356393447,S(1,253)=2410691914,S(1,254)=3873677099,S(1,255)=3682840055
	Set S(2,0)=3913112168,S(2,1)=2491498743,S(2,2)=4132185628,S(2,3)=2489919796,S(2,4)=1091903735,S(2,5)=1979897079
	Set S(2,6)=3170134830,S(2,7)=3567386728,S(2,8)=3557303409,S(2,9)=857797738,S(2,10)=1136121015,S(2,11)=1342202287
	Set S(2,12)=507115054,S(2,13)=2535736646,S(2,14)=337727348,S(2,15)=3213592640,S(2,16)=1301675037,S(2,17)=2528481711
	Set S(2,18)=1895095763,S(2,19)=1721773893,S(2,20)=3216771564,S(2,21)=62756741,S(2,22)=2142006736,S(2,23)=835421444
	Set S(2,24)=2531993523,S(2,25)=1442658625,S(2,26)=3659876326,S(2,27)=2882144922,S(2,28)=676362277,S(2,29)=1392781812
	Set S(2,30)=170690266,S(2,31)=3921047035,S(2,32)=1759253602,S(2,33)=3611846912,S(2,34)=1745797284,S(2,35)=664899054
	Set S(2,36)=1329594018,S(2,37)=3901205900,S(2,38)=3045908486,S(2,39)=2062866102,S(2,40)=2865634940,S(2,41)=3543621612
	Set S(2,42)=3464012697,S(2,43)=1080764994,S(2,44)=553557557,S(2,45)=3656615353,S(2,46)=3996768171,S(2,47)=991055499
	Set S(2,48)=499776247,S(2,49)=1265440854,S(2,50)=648242737,S(2,51)=3940784050,S(2,52)=980351604,S(2,53)=3713745714
	Set S(2,54)=1749149687,S(2,55)=3396870395,S(2,56)=4211799374,S(2,57)=3640570775,S(2,58)=1161844396,S(2,59)=3125318951
	Set S(2,60)=1431517754,S(2,61)=545492359,S(2,62)=4268468663,S(2,63)=3499529547,S(2,64)=1437099964,S(2,65)=2702547544
	Set S(2,66)=3433638243,S(2,67)=2581715763,S(2,68)=2787789398,S(2,69)=1060185593,S(2,70)=1593081372,S(2,71)=2418618748
	Set S(2,72)=4260947970,S(2,73)=69676912,S(2,74)=2159744348,S(2,75)=86519011,S(2,76)=2512459080,S(2,77)=3838209314
	Set S(2,78)=1220612927,S(2,79)=3339683548,S(2,80)=133810670,S(2,81)=1090789135,S(2,82)=1078426020,S(2,83)=1569222167
	Set S(2,84)=845107691,S(2,85)=3583754449,S(2,86)=4072456591,S(2,87)=1091646820,S(2,88)=628848692,S(2,89)=1613405280
	Set S(2,90)=3757631651,S(2,91)=526609435,S(2,92)=236106946,S(2,93)=48312990,S(2,94)=2942717905,S(2,95)=3402727701
	Set S(2,96)=1797494240,S(2,97)=859738849,S(2,98)=992217954,S(2,99)=4005476642,S(2,100)=2243076622,S(2,101)=3870952857
	Set S(2,102)=3732016268,S(2,103)=765654824,S(2,104)=3490871365,S(2,105)=2511836413,S(2,106)=1685915746,S(2,107)=3888969200
	Set S(2,108)=1414112111,S(2,109)=2273134842,S(2,110)=3281911079,S(2,111)=4080962846,S(2,112)=172450625,S(2,113)=2569994100
	Set S(2,114)=980381355,S(2,115)=4109958455,S(2,116)=2819808352,S(2,117)=2716589560,S(2,118)=2568741196,S(2,119)=3681446669
	Set S(2,120)=3329971472,S(2,121)=1835478071,S(2,122)=660984891,S(2,123)=3704678404,S(2,124)=4045999559,S(2,125)=3422617507
	Set S(2,126)=3040415634,S(2,127)=1762651403,S(2,128)=1719377915,S(2,129)=3470491036,S(2,130)=2693910283,S(2,131)=3642056355
	Set S(2,132)=3138596744,S(2,133)=1364962596,S(2,134)=2073328063,S(2,135)=1983633131,S(2,136)=926494387,S(2,137)=3423689081
	Set S(2,138)=2150032023,S(2,139)=4096667949,S(2,140)=1749200295,S(2,141)=3328846651,S(2,142)=309677260,S(2,143)=2016342300
	Set S(2,144)=1779581495,S(2,145)=3079819751,S(2,146)=111262694,S(2,147)=1274766160,S(2,148)=443224088,S(2,149)=298511866
	Set S(2,150)=1025883608,S(2,151)=3806446537,S(2,152)=1145181785,S(2,153)=168956806,S(2,154)=3641502830,S(2,155)=3584813610
	Set S(2,156)=1689216846,S(2,157)=3666258015,S(2,158)=3200248200,S(2,159)=1692713982,S(2,160)=2646376535,S(2,161)=4042768518
	Set S(2,162)=1618508792,S(2,163)=1610833997,S(2,164)=3523052358,S(2,165)=4130873264,S(2,166)=2001055236,S(2,167)=3610705100
	Set S(2,168)=2202168115,S(2,169)=4028541809,S(2,170)=2961195399,S(2,171)=1006657119,S(2,172)=2006996926,S(2,173)=3186142756
	Set S(2,174)=1430667929,S(2,175)=3210227297,S(2,176)=1314452623,S(2,177)=4074634658,S(2,178)=4101304120,S(2,179)=2273951170
	Set S(2,180)=1399257539,S(2,181)=3367210612,S(2,182)=3027628629,S(2,183)=1190975929,S(2,184)=2062231137,S(2,185)=2333990788
	Set S(2,186)=2221543033,S(2,187)=2438960610,S(2,188)=1181637006,S(2,189)=548689776,S(2,190)=2362791313,S(2,191)=3372408396
	Set S(2,192)=3104550113,S(2,193)=3145860560,S(2,194)=296247880,S(2,195)=1970579870,S(2,196)=3078560182,S(2,197)=3769228297
	Set S(2,198)=1714227617,S(2,199)=3291629107,S(2,200)=3898220290,S(2,201)=166772364,S(2,202)=1251581989,S(2,203)=493813264
	Set S(2,204)=448347421,S(2,205)=195405023,S(2,206)=2709975567,S(2,207)=677966185,S(2,208)=3703036547,S(2,209)=1463355134
	Set S(2,210)=2715995803,S(2,211)=1338867538,S(2,212)=1343315457,S(2,213)=2802222074,S(2,214)=2684532164,S(2,215)=233230375
	Set S(2,216)=2599980071,S(2,217)=2000651841,S(2,218)=3277868038,S(2,219)=1638401717,S(2,220)=4028070440,S(2,221)=3237316320
	Set S(2,222)=6314154,S(2,223)=819756386,S(2,224)=300326615,S(2,225)=590932579,S(2,226)=1405279636,S(2,227)=3267499572
	Set S(2,228)=3150704214,S(2,229)=2428286686,S(2,230)=3959192993,S(2,231)=3461946742,S(2,232)=1862657033,S(2,233)=1266418056
	Set S(2,234)=963775037,S(2,235)=2089974820,S(2,236)=2263052895,S(2,237)=1917689273,S(2,238)=448879540,S(2,239)=3550394620
	Set S(2,240)=3981727096,S(2,241)=150775221,S(2,242)=3627908307,S(2,243)=1303187396,S(2,244)=508620638,S(2,245)=2975983352
	Set S(2,246)=2726630617,S(2,247)=1817252668,S(2,248)=1876281319,S(2,249)=1457606340,S(2,250)=908771278,S(2,251)=3720792119
	Set S(2,252)=3617206836,S(2,253)=2455994898,S(2,254)=1729034894,S(2,255)=1080033504
	Set S(3,0)=976866871,S(3,1)=3556439503,S(3,2)=2881648439,S(3,3)=1522871579,S(3,4)=1555064734,S(3,5)=1336096578
	Set S(3,6)=3548522304,S(3,7)=2579274686,S(3,8)=3574697629,S(3,9)=3205460757,S(3,10)=3593280638,S(3,11)=3338716283
	Set S(3,12)=3079412587,S(3,13)=564236357,S(3,14)=2993598910,S(3,15)=1781952180,S(3,16)=1464380207,S(3,17)=3163844217
	Set S(3,18)=3332601554,S(3,19)=1699332808,S(3,20)=1393555694,S(3,21)=1183702653,S(3,22)=3581086237,S(3,23)=1288719814
	Set S(3,24)=691649499,S(3,25)=2847557200,S(3,26)=2895455976,S(3,27)=3193889540,S(3,28)=2717570544,S(3,29)=1781354906
	Set S(3,30)=1676643554,S(3,31)=2592534050,S(3,32)=3230253752,S(3,33)=1126444790,S(3,34)=2770207658,S(3,35)=2633158820
	Set S(3,36)=2210423226,S(3,37)=2615765581,S(3,38)=2414155088,S(3,39)=3127139286,S(3,40)=673620729,S(3,41)=2805611233
	Set S(3,42)=1269405062,S(3,43)=4015350505,S(3,44)=3341807571,S(3,45)=4149409754,S(3,46)=1057255273,S(3,47)=2012875353
	Set S(3,48)=2162469141,S(3,49)=2276492801,S(3,50)=2601117357,S(3,51)=993977747,S(3,52)=3918593370,S(3,53)=2654263191
	Set S(3,54)=753973209,S(3,55)=36408145,S(3,56)=2530585658,S(3,57)=25011837,S(3,58)=3520020182,S(3,59)=2088578344
	Set S(3,60)=530523599,S(3,61)=2918365339,S(3,62)=1524020338,S(3,63)=1518925132,S(3,64)=3760827505,S(3,65)=3759777254
	Set S(3,66)=1202760957,S(3,67)=3985898139,S(3,68)=3906192525,S(3,69)=674977740,S(3,70)=4174734889,S(3,71)=2031300136
	Set S(3,72)=2019492241,S(3,73)=3983892565,S(3,74)=4153806404,S(3,75)=3822280332,S(3,76)=352677332,S(3,77)=2297720250
	Set S(3,78)=60907813,S(3,79)=90501309,S(3,80)=3286998549,S(3,81)=1016092578,S(3,82)=2535922412,S(3,83)=2839152426
	Set S(3,84)=457141659,S(3,85)=509813237,S(3,86)=4120667899,S(3,87)=652014361,S(3,88)=1966332200,S(3,89)=2975202805
	Set S(3,90)=55981186,S(3,91)=2327461051,S(3,92)=676427537,S(3,93)=3255491064,S(3,94)=2882294119,S(3,95)=3433927263
	Set S(3,96)=1307055953,S(3,97)=942726286,S(3,98)=933058658,S(3,99)=2468411793,S(3,100)=3933900994,S(3,101)=4215176142
	Set S(3,102)=1361170020,S(3,103)=2001714738,S(3,104)=2830558078,S(3,105)=3274259782,S(3,106)=1222529897,S(3,107)=1679025792
	Set S(3,108)=2729314320,S(3,109)=3714953764,S(3,110)=1770335741,S(3,111)=151462246,S(3,112)=3013232138,S(3,113)=1682292957
	Set S(3,114)=1483529935,S(3,115)=471910574,S(3,116)=1539241949,S(3,117)=458788160,S(3,118)=3436315007,S(3,119)=1807016891
	Set S(3,120)=3718408830,S(3,121)=978976581,S(3,122)=1043663428,S(3,123)=3165965781,S(3,124)=1927990952,S(3,125)=4200891579
	Set S(3,126)=2372276910,S(3,127)=3208408903,S(3,128)=3533431907,S(3,129)=1412390302,S(3,130)=2931980059,S(3,131)=4132332400
	Set S(3,132)=1947078029,S(3,133)=3881505623,S(3,134)=4168226417,S(3,135)=2941484381,S(3,136)=1077988104,S(3,137)=1320477388
	Set S(3,138)=886195818,S(3,139)=18198404,S(3,140)=3786409000,S(3,141)=2509781533,S(3,142)=112762804,S(3,143)=3463356488
	Set S(3,144)=1866414978,S(3,145)=891333506,S(3,146)=18488651,S(3,147)=661792760,S(3,148)=1628790961,S(3,149)=3885187036
	Set S(3,150)=3141171499,S(3,151)=876946877,S(3,152)=2693282273,S(3,153)=1372485963,S(3,154)=791857591,S(3,155)=2686433993
	Set S(3,156)=3759982718,S(3,157)=3167212022,S(3,158)=3472953795,S(3,159)=2716379847,S(3,160)=445679433,S(3,161)=3561995674
	Set S(3,162)=3504004811,S(3,163)=3574258232,S(3,164)=54117162,S(3,165)=3331405415,S(3,166)=2381918588,S(3,167)=3769707343
	Set S(3,168)=4154350007,S(3,169)=1140177722,S(3,170)=4074052095,S(3,171)=668550556,S(3,172)=3214352940,S(3,173)=367459370
	Set S(3,174)=261225585,S(3,175)=2610173221,S(3,176)=4209349473,S(3,177)=3468074219,S(3,178)=3265815641,S(3,179)=314222801
	Set S(3,180)=3066103646,S(3,181)=3808782860,S(3,182)=282218597,S(3,183)=3406013506,S(3,184)=3773591054,S(3,185)=379116347
	Set S(3,186)=1285071038,S(3,187)=846784868,S(3,188)=2669647154,S(3,189)=3771962079,S(3,190)=3550491691,S(3,191)=2305946142
	Set S(3,192)=453669953,S(3,193)=1268987020,S(3,194)=3317592352,S(3,195)=3279303384,S(3,196)=3744833421,S(3,197)=2610507566
	Set S(3,198)=3859509063,S(3,199)=266596637,S(3,200)=3847019092,S(3,201)=517658769,S(3,202)=3462560207,S(3,203)=3443424879
	Set S(3,204)=370717030,S(3,205)=4247526661,S(3,206)=2224018117,S(3,207)=4143653529,S(3,208)=4112773975,S(3,209)=2788324899
	Set S(3,210)=2477274417,S(3,211)=1456262402,S(3,212)=2901442914,S(3,213)=1517677493,S(3,214)=1846949527,S(3,215)=2295493580
	Set S(3,216)=3734397586,S(3,217)=2176403920,S(3,218)=1280348187,S(3,219)=1908823572,S(3,220)=3871786941,S(3,221)=846861322
	Set S(3,222)=1172426758,S(3,223)=3287448474,S(3,224)=3383383037,S(3,225)=1655181056,S(3,226)=3139813346,S(3,227)=901632758
	Set S(3,228)=1897031941,S(3,229)=2986607138,S(3,230)=3066810236,S(3,231)=3447102507,S(3,232)=1393639104,S(3,233)=373351379
	Set S(3,234)=950779232,S(3,235)=625454576,S(3,236)=3124240540,S(3,237)=4148612726,S(3,238)=2007998917,S(3,239)=544563296
	Set S(3,240)=2244738638,S(3,241)=2330496472,S(3,242)=2058025392,S(3,243)=1291430526,S(3,244)=424198748,S(3,245)=50039436
	Set S(3,246)=29584100,S(3,247)=3605783033,S(3,248)=2429876329,S(3,249)=2791104160,S(3,250)=1057563949,S(3,251)=3255363231
	Set S(3,252)=3075367218,S(3,253)=3463963227,S(3,254)=1469046755,S(3,255)=985887462
	For i=0:1:3 For j=0:1:255 If S(i,j)>2147483647 Set S(i,j)=S(i,j)-4294967296
	Set P(0)=608135816,P(1)=2242054355,P(2)=320440878,P(3)=57701188,P(4)=2752067618,P(5)=698298832
	Set P(6)=137296536,P(7)=3964562569,P(8)=1160258022,P(9)=953160567,P(10)=3193202383,P(11)=887688300
	Set P(12)=3232508343,P(13)=3380367581,P(14)=1065670069,P(15)=3041331479,P(16)=2450970073,P(17)=2306472731
	For i=0:1:17 If P(i)>2147483647 Set P(i)=P(i)-4294967296
	Quit
TestString(s)	
	New Key,String,t1,t2,t3,t4
	New E,D
	Set String=$Get(s)
	Set Key="Dog food is good for you, it makes you healthy and shiny too (Iggy Pop)"
	If $Get(String)="" {
	           Set String="Blowfish is a symmetric block cipher that can be used as a drop-in replacement for DES or IDEA. "
	              _"It takes a variable-length key, from 32 bits to 448 bits, making it ideal for both domestic and exportable use. "
	              _"Blowfish was designed in 1993 by Bruce Schneier as a fast, free alternative to existing encryption algorithms. "
	              _"Since then it has been analyzed considerably, and it is slowly gaining acceptance as a strong encryption algorithm. "
	              _"Blowfish is unpatented and license-free, and is available free for all uses."
	}
	Set t1=$zh
	Set E=$$EncryptString(String,Key)
	Set t2=$zh
	;Write "E=",E,!
	Set t3=$zh
	Set D=$$DecryptString(E,Key)
	Set t4=$zh
	;Write "D=",D,!
	If D'=String Write "*** ERROR ****",!,String,!,"E=",E,!,"D=",D,!
	Write "Encryption "_$Length(String)_" chars : ",t2-t1," s.",!
	Write "Decryption "_$Length(E)_" bytes : ",t4-t3," s.",!
	Quit
TestFile
	New Key,String,t1,t2,t3,t4
	New E,D,F1,F2,F3
	Set Key="Pecunia non olet"
	Set F1=$Piece($ZUtil(86),"*",1) ; Current configuration file
	Set F2=$Piece(F1,"\",1,$Length(F1,"\")-1)_"\md5.enc"
	Set F3=$Piece(F1,"\",1,$Length(F1,"\")-1)_"\md5.dec"
	Set t1=$zh
	Do EncryptFile(F1,F2,Key)
	Set t2=$zh
	Set t3=$zh
	Do DecryptFile(F2,F3,Key)
	Set t4=$zh
	Write "Encryption "_$ZUtil(140,1,F1)_" bytes : ",t2-t1," s.",!
	Write "Decryption "_$ZUtil(140,1,F2)_" bytes : ",t4-t3," s.",!
	;
	Quit
TestBytes
	New Key,String,t1,t2,t3,t4,S,P,Bytes,i
	New E,D,F1,F2,F3
	Set (E,D)=""
	Set Key="hebban olla uogala nestas bigunnan hinase hic enda thu"
	Do InitialiseKey(Key)
	Set String="ABCDEFGH"
	For i=0:1:7 Set Bytes(i)=$Ascii(String,i+1)
	Set t1=$zh
	Do EncryptBytes(.Bytes)
	Set t2=$zh
	For i=0:1:7 Set E=E_$Char(Bytes(i))
	Set t3=$zh
	Do DecryptBytes(.Bytes)
	Set t4=$zh
	For i=0:1:7 Set D=D_$Char(Bytes(i))
	If D'=String Write "**ERROR** String=",String," D=",D,!
	Write "Encryption: ",t2-t1," s.",!
	Write "Decryption: ",t4-t3," s.",!
	Quit
]]></Routine>


<Routine name="%ZAPM.ed.BSCmail" type="MAC" languagemode="0"><![CDATA[
%BSCmail ;ПОЧТОВЫЕ ОПЕРАЦИИ И СЕРВЕР FTP
 ;       
 ;  Copyright (C) Serge W. Mikhaylenko
 ;  All Rights Reserved
 Q
ADDNEWMAIL(BSLOGIN,OT,MSG,SUbg)
 S MDEAM=$$MainServerSMTP^%ZAPM.ed.BSvdaMAIL I MDEAM="" Q  //ПОЧТОВЫХ СЕРВЕРОВ НЕТ
 S otkogo=OT_"@"_MDEAM
 S komu=BSLOGIN_"@"_MDEAM
 I $$SMTP^%ZAPM.ed.BSvdaMAIL(MDEAM,MSG,otkogo,komu,$G(SUbg,"Администратор ИнфоПортала приветствует Вас !"))
 Q
FirstMail() Q "Добро пожаловать в ИП !!!!"
 
SMTP //  ; Compiled March 14, 2003 16:27:53 ; 10:23   17.03.2003
 // Instantiate a class
 S CUS=$I
 set s=##class(%Net.SMTP).%New()
 set s.smtpserver="ivcmsw"         // Specify SMTP server name.
 set s.timezone="-0400"  // Timezone by Grinwitch
 set m=##class(%Net.MailMessage).%New()
 set m.From="MSW@ivcmsw"        // From
 
         do m.To.Insert("SSS1@ivcmsw") // List of emails to send this mail
       ;  do m.To.Insert("IVCMSW@developer.ru")
 
 set m.Subject="!!!"     // Subject
 // Charset specification
 //set m.Charset="iso-8859-1"
 // Text
 
 do m.TextData.Write("Привет!!!.")
 do m.TextData.Write($char(13,10))
 do m.TextData.Write("!!!!!!!!!!!!!!!Ты что делаешь ?")
 do m.TextData.Write($char(13,10))
 
 // Attachments
 //set status=m.AttachFile("D:\!\","Onvv.t2e1")
 // Send letter
 
 set status=s.Send(m)
 if ('status) do DecomposeStatus^%apiOBJ(status,.err) write !,err(err),!
 do m.%Close()
 do s.%Close()
 U CUS I (status) W !,"OK"
 W !!!
 quit
 
POP3
 new mailserver,status,from,to,date,subject,messagesize,m,hdrs,key,mailMsg
 set mailserver=##class(%Net.POP3).%New()
 // Directory for attached documents
 set mailserver.AttachDir="d:\attach\"  ; need terminating \
 // if StoreAttachToFile=0 - then data attached will be saved in database
 set mailserver.StoreAttachToFile=1
 write !,"Calling Connect"
 // Connect("server","username","password")
 set status=mailserver.Connect("server","user1","pass1")
 write !,"Calling FetchMessage"
 // This method retrieves a single message. MessageNumber must be a valid message number and the message must not be currently marked for deletion.
 set status=mailserver.FetchMessage(MessageNumber,.from,.to,.date,.subject,.messagesize,.hdrs,.mailMsg,0)
 write !,"from="_from
 write !,"to="_to
 write !,"date="_date
 write !,"subject="_subject
 write !,"messagesize="_messagesize
 write !,"Closing mailserver="_mailserver.%Close()
 write !,"Closing mailMsg="_mailMsg.%Close()
 quit
 
 ; display mail but don't delete from mailbox
t6(MM) ;
 new mailserver,status,from,to,date,subject,messagesize,m,hdrs,key,mailMsg
 set mailserver=##class(%Net.POP3).%New()
 set mailserver.AttachDir="d:\!\1\"  ; need terminating \
 set mailserver.Debug=0
 set mailserver.StoreAttachToFile=1
 write !,"Calling Connect"
 set status=mailserver.Connect("IVCMSW","SSS1@IVCMSW","S")
 if ('status) do DecomposeStatus^%apiOBJ(status,.err) write !,err(err),!
 write !,"Calling FetchMessage"
 set status=mailserver.FetchMessage(MM,.from,.to,.date,.subject,.messagesize,.hdrs,.mailMsg,0)
 if ('status) do DecomposeStatus^%apiOBJ(status,.err) write !,err(err),! write "Closing p="_mailserver.%Close() quit
 write !,"from="_from
 write !,"to="_to
 write !,"date="_date
 write !,"subject="_subject
 write !,"messagesize="_messagesize
 do DumpMessage(mailMsg)
 write !,"Closing mailserver="_mailserver.%Close()
 write !,"Closing mailMsg="_mailMsg.%Close()
 quit
DumpMessage(msg)
 new i,index,value
 if msg.IsMultiPart do  quit
 . for i=1:1:msg.Parts.Count() w !,"Dumping part "_i do DumpMessage(msg.Parts.GetAt(i))
 s index=""  f  s value=msg.Headers.GetNext(.index) q:index=""  w !,"Headers("_index_")="_value
 if msg.IsBinary do
 . write !,"msg is binary, filename="_msg.FileName_" filename="_msg.GetAttribute("content-disposition","filename")
 else  do
 . w !,"Dumping text msg Filename="_msg.FileName_" filename="_msg.GetAttribute("content-disposition","filename"),!
 . set stream=msg.TextData
 . do stream.Rewind()
 . new len,line
 . for  set len=32763,line=stream.Read(.len) do  quit:stream.AtEnd
 . . write line
 quit
 
testmailsend3 ;
 ;  Replace information marked with [[ ]]
 set s=##class(%Net.SMTP).%New()
 set s.smtpserver="SMTP server name"
 set s.timezone="-0400" //  may remove this line to get Universal Time
 set m=##class(%Net.MailMessage).%New()
 set m.From="test@company.com"
 do m.To.Insert("receiver@another.com")
 write !,"s.port="_s.port
 write !,"s.localhost="_s.localhost
 set m.Subject="Sent by Cache' mail"
 do m.TextData.Write("This is the main body.")
 do m.TextData.Write($char(13,10))
 do m.TextData.Write("This is the second line.")
 do m.TextData.Write($char(13,10))
 set status=m.AttachFile("c:\winnt","notepad.exe")
 if ('status) do DecomposeStatus^%apiOBJ(status,.err) write !,err(err),! do m.%Close() do s.%Close() q
 set status=m.AttachFile("d:\temp","test.txt")
 if ('status) do DecomposeStatus^%apiOBJ(status,.err) write !,err(err),! do m.%Close() do s.%Close() q
 set nestedm=m.AttachNewMessage()
 set status=nestedm.AttachFile("c:\cachesys\bin","test.bin")
 do nestedm.%Close()
 if ('status) do DecomposeStatus^%apiOBJ(status,.err) write !,err(err),! do m.%Close() do s.%Close() q
 write !,"m.Parts.Count()="_m.Parts.Count()
 write !,"m.Parts.GetAt(3).Parts.GetAt(1).FileName="_m.Parts.GetAt(3).Parts.GetAt(1).FileName
 write !,"m.Parts.GetAt(3).Parts.Count()="_m.Parts.GetAt(3).Parts.Count()
 set status=s.Send(m)
 if ('status) do DecomposeStatus^%apiOBJ(status,.err) write !,err(err),! do m.%Close() do s.%Close() q
 do m.%Close()
 do s.%Close()
 q
FTP //СЕАНС ЗАГРУЗКИ ФАЙЛА
 Set ftp=##class(%Net.FtpSession).%New()
 //ftp.Connect("nameserver","name","pass","port")
 If 'ftp.Connect("127.0.0.1","sinxron","snx",22) Write "Not connected",! Quit
 Write "Ftp server messsage: ",ftp.ReturnMessage,!
 
 If 'ftp.System() W "No answer System" G FTPSTOP
 Write "Ftp server messsage: ",ftp.ReturnMessage,!
 
 If 'ftp.Binary() Write "Can not swap to binary mode",! G FTPSTOP
 Write "Mode now: ",ftp.Type,!
 /*/ ПРОЧИТАТЬ ДИРЕКТОРИЮ
 Set stream=##class(%GlobalCharacterStream).%New()
 W ! IF 'ftp.List("CLIeNT\*.F*",.stream) W !,"Error List" G FTPSTOP
 IF stream.Size>0 D
 .Write "-------- Length of file received: ",stream.Size," ------",!
 . new len,line
 . for  set len=32763,line=stream.Read(.len) do  quit:stream.AtEnd
 .. write line
 .Write !," -------- End of stream -----",!
 D stream.%Close() ;*/
 
 /*/ДОБАВИТЬ ФАЙЛ
 Set stream=##class(%GlobalCharacterStream).%New()
 for I=1:1:100 D stream.WriteLine(I_" ASASAS")
 If 'ftp.Append("CLIENT\AAA.TXT",stream) Write "Failed to PUT file",! G FTPSTOP
 D stream.%Close() ;*/
 
 /*/ВОЗВРАТИТЬ ФАЙЛ
 Set stream=##class(%GlobalCharacterStream).%New()
 If 'ftp.Retrieve("CLIENT\mAIN.FRM",stream) Write "Failed to get file",! G FTPSTOP
 IF stream.Size>0 D
 .Write "-------- Length of file received: ",stream.Size," ------",!
 . new len,line
 . for  set len=32763,line=stream.Read(.len) do  quit:stream.AtEnd
 .. write line
 .Write !," -------- End of stream -----",!!!!
 D stream.%Close() ;*/
FTPSTOP If 'ftp.Logout() S ER="Failed to logout"
 Do ftp.%Close()
 Q
LoginFtp(P0,P1) //ОТРАБОТКА ЗАПРОСОВ СЕРВЕРА
 N US,A
 I P0="ddr-adm",P1="shutdown_SERVER" S P4="EXIT" Q 0  //ОСТАНОВ СЕРВЕРА
 S P4="NO",P3=""  S $ZT="LoginError"
 I '$$GETOPT^%ZAPM.ed.BSC4cfgP("^%ZAPM.ed.BSETUP(""ISS"")","Aft") Q  //Cервер отключен!
 I P1="" Q P3
 I $P(P0,"-")="ddr" D  Q P3
 .S US=$P(P0,"-",2,99)      I US="" Q
 .S BDUSE=$$KBD^%ZAPM.ed.BSF12("^%ZAPM.ed.BSC4(""PROTECT"")") I '$D(@BDUSE@(US)) Q
 . N GetAccLU I P1=$ZCRC(US,7),$$GetAcc^%ZAPM.ed.BSC4cfgP(US,"Aftpddr") S P4="YES",P3=$$DDDR^%ZAPM.ed.BSCmDDR_US   //ПОЛЬЗОВАТЕЛЬ ДОМАШНЕГО КАТАЛОГА
 .S BDSES=$$KBD^%ZAPM.ed.BSF12("^%ZAPM.ed.BSC4(""SESSIONS"")") I '$D(@BDSES@($P(P1,"-"))) Q
 .S BSSES=$P(P1,"-")
 .I $G(@BDSES@(BSSES,"NM"))=US,$G(@BDSES@(BSSES,"CHR"))="" S P4="YES",P3=$$GetVar^%ZAPM.ed.BSC4("RootDir-"_$P(P1,"-",2,99),"") //ОТДАТЬ ПРОИЗВОЛЬНЫЙ КАТАЛОГ
 S A=$P($$GETOPT^%ZAPM.ed.BSC4cfgP("^%ZAPM.ed.BSETUP(""ISS"")","Aftpsinx"),"//",2)
 I P0=$P($P(A,"@"),":"),P1=$P($P(A,"@"),":",2) S P4="YES" Q $$GETOPT^%ZAPM.ed.BSC4cfgP("^%ZAPM.ed.BSC4SNX.Par","Rpool") //КАТАЛОГ СИНХРОНИЗАЦИИ
 Q P3
LoginError Q P3
STOPFTP() //СЕАНС ЗАКРЫТИЯ СЕРВЕРА - эмуляция спец-регистрации
 Set ftp=##class(%Net.FtpSession).%New(),$ZT="STOPERR"
 If 'ftp.Connect($$ipS^%ZAPM.ed.BSCp2,"ddr-adm","shutdown_SERVER",22) Write "Not connected",! Quit 0
STOPERR W !,"OK" Q 1
 ;
 ;
STR2MASold(MM,M,BK)  //```КАК СОБРАТЬ МАССИВ ИЗ ПОТОКА ///  //РАЗОБРАТЬ МАССИВ MM ПО РАЗДЕЛИТЕЛЮ BK. РЕЗУЛЬТАТ В M
 N I,L,II S I="",L=0 F  S I=$O(MM(I)) Q:I=""  D
 .I $G(M(L))'="" S MM(I)=$G(M(L))_MM(I) K M(L)
 .F II=1:1:$L(MM(I),BK) S L=L+1,M(L)=$P(MM(I),BK,II) I $G(M(L))="" K M(L)
 Q
STR2MAS(MM,M,BK)  //РАЗОБРАТЬ МАССИВ MM ПО РАЗДЕЛИТЕЛЮ BK. РЕЗУЛЬТАТ В M
 N I,L,II S I="",L=0 F  S I=$O(MM(I)) Q:I=""  D
 .I $G(M(L))'="" S MM(I)=$G(M(L))_MM(I) K M(L) S L=L-1
 .F II=1:1:$L(MM(I),BK) S L=L+1,M(L)=$P(MM(I),BK,II) I $G(M(L))="" K M(L)
 Q 
FtpGD(S,N,Pa,Po,D,M) //ПРОЧИТАТЬ ДИРЕКТОРИЮ D в массив M
 N I,line,len,MM,II,MST,L
 Set ftp=##class(%Net.FtpSession).%New(),ER=0,BK=$C(13,10),MST=32000
 If 'ftp.Connect(S,N,Pa,Po)  S ER="Not connected" Q
 Set stream=##class(%GlobalCharacterStream).%New()
 IF 'ftp.List(D,.stream) S ER="Error List" G FTPSTOP
 IF stream.Size>0 D
 .F I=0:MST:stream.Size D
 ..s len=MST,line=stream.Read(.len)
 ..s MM(I)=line
 ;S I="",L=0 F  S I=$O(MM(I)) Q:I=""  D  //```КАК СОБРАТЬ МАССИВ ИЗ ПОТОКА
 ;.I $G(M(L))'="" S MM(I)=$G(M(L))_MM(I) K M(L)
 ;.F II=1:1:$L(MM(I),BK) S L=L+1,M(L)=$P(MM(I),BK,II) I $G(M(L))="" K M(L)
 D STR2MAS(.MM,.M,BK)
 D stream.%Close()
 G FTPSTOP
FtpGF(S,N,Pa,Po,F,M) //ПРОЧИТАТЬ ФАЙЛ .F в массив .M
 N I,line,len,f,MST
 Set ftp=##class(%Net.FtpSession).%New(),ER=0,MST=32000
 If 'ftp.Connect(S,N,Pa,Po)  S ER="Not connected" Q
 s f="" F  S f=$O(F(f)) Q:f=""  D
 .Set stream=##class(%GlobalCharacterStream).%New()
 .If 'ftp.Retrieve(F(f),stream) S ER="Failed to GET file" G FTPSTOP
 .IF stream.Size>0 D
 ..F I=0:MST:stream.Size D
 ...s len=MST,line=stream.Read(.len)
 ...s M(F(f),I)=line
 .D stream.%Close()
 G FTPSTOP
FtpAF(S,N,Pa,Po,FN,DF,AP) //ДОБАВИТЬ ФАЙЛ FN в директорию DF  AP=1- добавлять  0-перезаписывать
 N I,line,len,Mas
 Set ftp=##class(%Net.FtpSession).%New(),ER=0
 If 'ftp.Connect(S,N,Pa,Po)  S ER="Not connected" Q
 Set stream=##class(%GlobalCharacterStream).%New()
 D File2Arr^%ZAPM.ed.BSCEXE(FN,.Mas)
 S I="" F  S I=$O(Mas(I)) Q:I=""  D stream.Write(Mas(I))
 I $G(AP)=0 If 'ftp.Delete(DF_"\"_$P(FN,"\",$L(FN,"\")))
 If 'ftp.Append(DF_"\"_$P(FN,"\",$L(FN,"\")),stream) S ER="Failed to APPEND file" G FTPSTOP
 D stream.%Close()
 G FTPSTOP
SERV4URL(U) Q $P($p(U,"://",2),"/",1)
HTTP(url,OK,OUT,ProxS,ProxP) //СОДЕРЖАНИЕ сетевого ресурса
 ; OK=1 возвратить только заголовок в OUT("Header"
 ; OK=2 возвратить заголовок и все данные в OUT("Data"
 S $ZT="HTTPER"
 N A,B,I,len,SZ,err,httprequest,Po,content Set httprequest=##class(%Net.HttpRequest).%New(),SZ=32000
 I $G(ProxS)'="" Set http.ProxyServer=ProxS,http.ProxyPort=ProxP
 S A=$P($p(url,"://",2),"/",1) I A="" Q "ERROR! SERVERNAME"
 I A[":" S Po=$P(A,":",2),A=$P(A,":",1) Set httprequest.Port=Po
 Set httprequest.Server=A
 S A="/"_$P($p(url,"://",2),"/",2,991)
 I A["?" D
 .S B=$P(A,"?",2,999)
 .F I=1:1 Q:$P(B,"&",I,I+1)=""   Do httprequest.InsertFormData($P($P(B,"&",I),"="),$P($P(B,"&",I),"=",2))
 .Do httprequest.Post($P(A,"?",1))
 E  Do httprequest.Get(A)
 S A=httprequest.HttpResponse.StatusLine
 I $P(A," ",2)'=200 G HTTPS
 ;Do httprequest.HttpResponse.OutputToDevice()
 I $G(OK)'="" S B="" F  S B=httprequest.HttpResponse.GetNextHeader(B) Q:B=""  S OUT("Header",B)=httprequest.HttpResponse.GetHeader(B)
 I $G(OK)=2 If httprequest.HttpResponse.Data.Size>0 D
 .F I=0:SZ:httprequest.HttpResponse.Data.Size D
 ..s len=SZ,B=httprequest.HttpResponse.Data.Read(.len)
 ..s OUT("Data",I)=B
HTTPS Do httprequest.%Close() ;ZW OUT
 q A
HTTPER I $ZE["<INVALID OREF>" Q "ERROR! SERVER NO ACCESS? "_$ZE
 do DecomposeStatus^%apiOBJ(%objlasterror,.err) 
 Q $G(err(err))
http1 ;ПРИМЕР КОГДА ТЫ ВОЗВРАЩАЕШЬ СТАТИКУ ИЗ  http://mswdell/iss/iss.htm
 Set httprequest=##class(%Net.HttpRequest).%New()
 Set httprequest.Server="MSWDELL"
 Do httprequest.Get("/iss/iss.htm")
 ;Do httprequest.HttpResponse.OutputToDevice()
 Write httprequest.HttpResponse.StatusLine,$C(13,10)
 If httprequest.HttpResponse.Data.Size>0 Write $C(13,10) Do httprequest.HttpResponse.Data.OutputToDevice()
 Write !
 Do httprequest.%Close()
 q
http2 ;ПРИМЕР КОГДА ТЫ ВОЗВРАЩАЕШЬ ДИНАМИКУ ИЗ  http://mswdell/scripts/mgwms32.dll?BSG=Phone&WEBPAGE=FRAMES
 S A="/scripts/mgwms32.dll?BSG=B4I&BSDOMAIN=/b4y&BSKNH=001&BSLABEL=LISTREGION^~BSCSVVT&BSROU=GKVV^%ZAPM.ed.BSCSVVT&BStyle=JEANS-"
 Set httprequest=##class(%Net.HttpRequest).%New()
 Set httprequest.Server="MSWDELL"
 ;Do httprequest.InsertFormData("BSG","Phone")
 ;Do httprequest.InsertFormData("WEBPAGE","FRAMES")
 ;Do httprequest.Post("/scripts/mgwms32.dll")
 D
 .S B=$P(A,"?",2,999)
 .F I=1:1 Q:$P(B,"&",I,I+1)=""   Do httprequest.InsertFormData($P($P(B,"&",I),"="),$P($P(B,"&",I),"=",2))
 .Do httprequest.Post($P(A,"?",1))
 S SZ=32000
 ;Do httprequest.HttpResponse.OutputToDevice()
  If httprequest.HttpResponse.Data.Size>0 D
 .F I=0:SZ:httprequest.HttpResponse.Data.Size D
 ..s len=SZ,B=httprequest.HttpResponse.Data.Read(.len)
 ..W !,B
 Do httprequest.%Close()
 q
http3
 Set http=##class(%Net.HttpRequest).%New()
 ;Set http.ProxyServer="192.168.6.1"
 ;Set http.ProxyPort=8080
 ;;;Set http.Server="www.intersystems.ru"
 ;S url="www.intersystems.ru"
 s url="http://WEBSERVER/iss/iss.htm"
 Do http.Get(url)
  S siz=http.HttpResponse.Data.Size
 S b=32000
 IF siz>0 D
 .F I=0:b:siz D
 ..s len=b,z=http.HttpResponse.Data.Read(.len)
 ..s MM(I)=z
 Do http.HttpResponse.OutputToDevice()
 Q
 ////////////////// ПОДРОБНЕЕ В ДОКУМЕНТАЦИИ ПО КЛАССАМ %Net.HttpRequest %Net.HttpResponse ////////////////////////////////////////////////
 ///////////// ЗАХОДИШЬ В ОБЪЕКТ-АРХИТЕКТОР В ОБЛАСТЬ %SYS, НАХОДИШЬ ЭТИ КЛАССЫ И ПРАВОЙ КНОПКОЙ ЗАГРУЖАЕШЬ - Показать документацию класса
 //ТЕСТЫ
1 K M D FtpGD^%ZAPM.ed.BSCmail("127.0.0.1","sinxron","snx",22,"\",.M) ZW M W !!! Q
2 K M S F(1)="home_20031004_160107.rar",F(2)="home_20031007_000004.rar"
  D FtpGF^%ZAPM.ed.BSCmail("127.0.0.1","sinxron","snx",22,.F,.M) ZW M W "OK",!!! Q
3 ;D File2Arr^%ZAPM.ed.BSCEXE("D:\_AUDIO\np\playlist.m3u",.Mas) ZW Mas
 D FtpAF^%ZAPM.ed.BSCmail("127.0.0.1","sinxron","snx",22,"G:\MSW\TheBatBackCopy\20031006.tbk","")
 W !!! Q
 ///////////////////////////////////////////////// http ////////////////////////////////// для ССС /////////////////////
 //тест для HTTP
4 N AA,A W $$HTTP^%ZAPM.ed.BSCmail("http://LOCALHOST/vv/u/REPORT/MOL/FULL/Spravka.xls",2,.AA) ;ПОЛУЧИТЬ ОТ СЕРВЕРА
 ;M A=AA("Data") W !,$$Arr2File^%ZAPM.ed.BSCEXE(.A,"C:\!\1.xls") ;И СОХРАНИТЬ НА ДИСКЕ
 ZW AA W !!!!
 q
5 K AA,A,AAA W $$HTTP^%ZAPM.ed.BSCmail("http://home:81/iportal/wakka.php?wakka=GCASUVV/files.xml&action=download&file=SEGAL04.zip",2,.AA),!! 
 ;K ^%ZZZ M ^%ZZZ=AA("Header")   ;M AAA=AA("Data") D STR2MAS(.AAA,.A,$C(13,10)) ZW A 
 q
51 K AA,A,AAA 
 W $$HTTP^%ZAPM.ed.BSCmail("http://home/scripts/mgwms32.dll?BSG=B4I&BSAA=_book-2\home\proverbs.zip&BSDOMAIN=/b4y&BSGRANT=DEMIURG&BSLABEL=RESBOOKA^~BSCbook&BSLNG=RUS&BSLOGIN=Styx&BSLOGINDFLT=Styx&BSNSP=~SYS&BSREF=1&BSSES=47.7997567&BSTOP=ПОИСК&BSaX=1&BSdebug=1&BSstr=ПАК&BStyle=GREEN&MGWSTO=300",2,.AA),!!
 ; K ^%ZZZ M ^%ZZZ=AA("Header")  ;D STR2MAS(.AAA,.A,$C(13,10)) ZW A 
 q
 ;http://mswdell/vv/gkvv-doc/img/iss.ico
6 K AA W !,$$HTTP^%ZAPM.ed.BSCmail("http://mswdell:82/vv/gkvv-doc/img/iss.ico",2,.AA),!!!! ZW AA 
 q
7 ;ТЕСТ
 W !,"ПРИВЕТ СЕРГЕЙ !!!!!!"
 W "<form action=""/scripts/mgwms32.dll"" method=""POST"">"
 W "<input type='hidden' name='BSG' value='ZZ1'>"
 W "<input type='hidden' name='BSLABEL' value='WWW1'>"
         W "кТО У АППАРАТА ? <input type=""text"" name=""T1"" size=""28"">"
 w "<input type=""submit"" name=""OK"" value=""ПОСЛАТЬ"">",$c(13,10)
 W "</FORM>"
 Q
AAA ;ДИСПЕТЧЕР
 D %KEY
 I $G(BSLABEL)'="" D @BSLABEL Q  
 Q
%KEY S I="" F  S I=$O(%KEY(I)) Q:I=""  S @I=%KEY(I)
 Q
WWW1 ;
 W "ПРИШЛА ПЕРЕМЕННАЯ ",T1
 Q
]]></Routine>


<Routine name="%ZAPM.ed.BSCmd5" type="MAC" languagemode="0"><![CDATA[
rhMD5	; Implementation of RFC 1321 MD5 algorithm  ; Compiled January 31, 2005 23:37:32
	; Cache Object Script implementation of RFC 1321 MD5
	; Copyright (C) 2001 COD International BV
	; Naarden, The Netherlands <www.codgroep.nl>. All rights reserved.
	; You are free to use this code in your applications without liability
	; or compensation, but the courtesy of both notification of use and	
	; inclusion of due credit are requested. You must keep this copyright
	; notice intact.
	; It is PROHIBITED to distribute or reproduce this code for profit
	; or otherwise, on any web site, ftp server or BBS, or by any
	; other means, including CD-ROM or other physical media, without the
	; EXPRESS WRITTEN PERMISSION of the copyright holder.
	; Use at your own risk.
	; COD International BV offers no warranty of its fitness for any
	; purpose whatsoever, and accept no liability whatsoever for any
	; loss or damage incurred by its use.
	; If you use it, or found it useful, or can suggest an improvement
	; please let us know at <development@codgroep.nl>.
	; Authors: Gertjan Klein & Herman Slagman
	; RFC 1312 the MD5 message-digest algorithm.
	; The algorithm takes as input a message of arbitrary length and produces
	; as output a 128-bit "fingerprint" or "message digest" of the input.
	; It is conjectured that it is computationally infeasible to produce
	; two messages having the same message digest, or to produce any
	; message having a given prespecified target message digest. The MD5
	; algorithm is intended for digital signature applications, where a
	; large file must be "compressed" in a secure manner before being
	; encrypted with a private (secret) key under a public-key cryptosystem
	; such as RSA.
	; Note.
	; Theoretically it has been proven that MD5 has a collision risk, ie two different strings resulting in the same digest,
	; therefore SHA-1 (secure hash algorithm) is recommended for PKCS (RFC 2437 Public Key Cryptography Specification)
	; Restrictions.
	; This code relies heavily on macro preprocessor commands, it should
	; therefor be compiled as a Cache Object Script MAC routine.
	; Based on the RFC's reference implementation written in C
Encrypt(Message)	;
	New i,Result,Digest,Length,Pad,Byte,X,A,B,C,D,NrOfBlocks,j,StartPos,AA,BB,CC,DD,p,Powers
	Do Powers
	; Step 1.
	;   Pad the string until the length is a multiple of 64 bytes minus 8 bytes
	;   The first byte is a 10000000 byte (128) the rest are 00000000 bytes
	Set Length=$Length(Message)*8  ;(In bits)
	Set Digest=Message_$C(128)
	For  Quit:$Length(Digest)#64=56  Set Digest=Digest_$C(0)
	; Step 2.
	;   Append the original length as a 64 bits value
	Set Pad=""
	For i=1:1:8 Set Byte=Length#256,Length=Length\256,Pad=Pad_$Char(Byte)
	Set Digest=Digest_Pad
	; Step 3.
	;   Initialise the MD buffer
	Set A=1732584193 ;$ZHex("67452301")
	Set B=4023233417 ;$ZHex("efcdab89")
	Set C=2562383102 ;$Zhex("98badcfe")
	Set D=271733878 ;$Zhex("10325476")
	; MD5 uses 64 values calculated as followes:
	;   F i=1:1:64 Set T(i)=4294967296*$zabs($zsin(i))\1
	; Step 4.
	;   Process the Message in 16 word blocks (32 bytes)
	Set NrOfBlocks=$Length(Digest)-1\64+1
	For i=0:1:NrOfBlocks-1 Do
	.    ; Copy the Block in 16 X(0-15) words 
	.    Set StartPos=i*64+1
	.    For j=0:1:15 Do
	..        Set p=StartPos+(j*4)
	..        Set X(j)=$Ascii(Digest,p+3)*16777216+($Ascii(Digest,p+2)*65536)+($Ascii(Digest,p+1)*256)+$Ascii(Digest,p)
	.    Set AA=A
	.    Set BB=B
	.    Set CC=C
	.    Set DD=D
	.    ; Round 1
	.    ;    [ABCD  0  7  1]  [DABC  1 12  2]  [CDAB  2 17  3]  [BCDA  3 22  4]
	.    ;    [ABCD  4  7  5]  [DABC  5 12  6]  [CDAB  6 17  7]  [BCDA  7 22  8]
	.    ;    [ABCD  8  7  9]  [DABC  9 12 10]  [CDAB 10 17 11]  [BCDA 11 22 12]
	.    ;    [ABCD 12  7 13]  [DABC 13 12 14]  [CDAB 14 17 15]  [BCDA 15 22 16]
	. 
	.   Set A=((B+(($ZBoolean(((A+($ZBoolean($ZBoolean((B),(C),1),$ZBoolean((B),(D),4),7))+X(0)+3614090360)#4294967296)*Powers(7)#4294967296,((A+($ZBoolean($ZBoolean((B),(C),1),$ZBoolean((B),(D),4),7))+X(0)+3614090360)#4294967296)\Powers(32-7),7))))#4294967296)
	.   Set D=((A+(($ZBoolean(((D+($ZBoolean($ZBoolean((A),(B),1),$ZBoolean((A),(C),4),7))+X(1)+3905402710)#4294967296)*Powers(12)#4294967296,((D+($ZBoolean($ZBoolean((A),(B),1),$ZBoolean((A),(C),4),7))+X(1)+3905402710)#4294967296)\Powers(32-12),7))))#4294967296)
	.   Set C=((D+(($ZBoolean(((C+($ZBoolean($ZBoolean((D),(A),1),$ZBoolean((D),(B),4),7))+X(2)+606105819)#4294967296)*Powers(17)#4294967296,((C+($ZBoolean($ZBoolean((D),(A),1),$ZBoolean((D),(B),4),7))+X(2)+606105819)#4294967296)\Powers(32-17),7))))#4294967296)
	.   Set B=((C+(($ZBoolean(((B+($ZBoolean($ZBoolean((C),(D),1),$ZBoolean((C),(A),4),7))+X(3)+3250441966)#4294967296)*Powers(22)#4294967296,((B+($ZBoolean($ZBoolean((C),(D),1),$ZBoolean((C),(A),4),7))+X(3)+3250441966)#4294967296)\Powers(32-22),7))))#4294967296)
	.   Set A=((B+(($ZBoolean(((A+($ZBoolean($ZBoolean((B),(C),1),$ZBoolean((B),(D),4),7))+X(4)+4118548399)#4294967296)*Powers(7)#4294967296,((A+($ZBoolean($ZBoolean((B),(C),1),$ZBoolean((B),(D),4),7))+X(4)+4118548399)#4294967296)\Powers(32-7),7))))#4294967296)
	.   Set D=((A+(($ZBoolean(((D+($ZBoolean($ZBoolean((A),(B),1),$ZBoolean((A),(C),4),7))+X(5)+1200080426)#4294967296)*Powers(12)#4294967296,((D+($ZBoolean($ZBoolean((A),(B),1),$ZBoolean((A),(C),4),7))+X(5)+1200080426)#4294967296)\Powers(32-12),7))))#4294967296)
	.   Set C=((D+(($ZBoolean(((C+($ZBoolean($ZBoolean((D),(A),1),$ZBoolean((D),(B),4),7))+X(6)+2821735955)#4294967296)*Powers(17)#4294967296,((C+($ZBoolean($ZBoolean((D),(A),1),$ZBoolean((D),(B),4),7))+X(6)+2821735955)#4294967296)\Powers(32-17),7))))#4294967296)
	.   Set B=((C+(($ZBoolean(((B+($ZBoolean($ZBoolean((C),(D),1),$ZBoolean((C),(A),4),7))+X(7)+4249261313)#4294967296)*Powers(22)#4294967296,((B+($ZBoolean($ZBoolean((C),(D),1),$ZBoolean((C),(A),4),7))+X(7)+4249261313)#4294967296)\Powers(32-22),7))))#4294967296)
	.   Set A=((B+(($ZBoolean(((A+($ZBoolean($ZBoolean((B),(C),1),$ZBoolean((B),(D),4),7))+X(8)+1770035416)#4294967296)*Powers(7)#4294967296,((A+($ZBoolean($ZBoolean((B),(C),1),$ZBoolean((B),(D),4),7))+X(8)+1770035416)#4294967296)\Powers(32-7),7))))#4294967296)
	.   Set D=((A+(($ZBoolean(((D+($ZBoolean($ZBoolean((A),(B),1),$ZBoolean((A),(C),4),7))+X(9)+2336552879)#4294967296)*Powers(12)#4294967296,((D+($ZBoolean($ZBoolean((A),(B),1),$ZBoolean((A),(C),4),7))+X(9)+2336552879)#4294967296)\Powers(32-12),7))))#4294967296)
	.   Set C=((D+(($ZBoolean(((C+($ZBoolean($ZBoolean((D),(A),1),$ZBoolean((D),(B),4),7))+X(10)+4294925233)#4294967296)*Powers(17)#4294967296,((C+($ZBoolean($ZBoolean((D),(A),1),$ZBoolean((D),(B),4),7))+X(10)+4294925233)#4294967296)\Powers(32-17),7))))#4294967296)
	.   Set B=((C+(($ZBoolean(((B+($ZBoolean($ZBoolean((C),(D),1),$ZBoolean((C),(A),4),7))+X(11)+2304563134)#4294967296)*Powers(22)#4294967296,((B+($ZBoolean($ZBoolean((C),(D),1),$ZBoolean((C),(A),4),7))+X(11)+2304563134)#4294967296)\Powers(32-22),7))))#4294967296)
	.   Set A=((B+(($ZBoolean(((A+($ZBoolean($ZBoolean((B),(C),1),$ZBoolean((B),(D),4),7))+X(12)+1804603682)#4294967296)*Powers(7)#4294967296,((A+($ZBoolean($ZBoolean((B),(C),1),$ZBoolean((B),(D),4),7))+X(12)+1804603682)#4294967296)\Powers(32-7),7))))#4294967296)
	.   Set D=((A+(($ZBoolean(((D+($ZBoolean($ZBoolean((A),(B),1),$ZBoolean((A),(C),4),7))+X(13)+4254626195)#4294967296)*Powers(12)#4294967296,((D+($ZBoolean($ZBoolean((A),(B),1),$ZBoolean((A),(C),4),7))+X(13)+4254626195)#4294967296)\Powers(32-12),7))))#4294967296)
	.   Set C=((D+(($ZBoolean(((C+($ZBoolean($ZBoolean((D),(A),1),$ZBoolean((D),(B),4),7))+X(14)+2792965006)#4294967296)*Powers(17)#4294967296,((C+($ZBoolean($ZBoolean((D),(A),1),$ZBoolean((D),(B),4),7))+X(14)+2792965006)#4294967296)\Powers(32-17),7))))#4294967296)
	.   Set B=((C+(($ZBoolean(((B+($ZBoolean($ZBoolean((C),(D),1),$ZBoolean((C),(A),4),7))+X(15)+1236535329)#4294967296)*Powers(22)#4294967296,((B+($ZBoolean($ZBoolean((C),(D),1),$ZBoolean((C),(A),4),7))+X(15)+1236535329)#4294967296)\Powers(32-22),7))))#4294967296)
	. 
	.
	.   Set A=((B+(($ZBoolean(((A+($ZBoolean($ZBoolean((B),(D),1),$ZBoolean((C),(D),2),7))+X(1)+4129170786)#4294967296)*Powers(5)#4294967296,((A+($ZBoolean($ZBoolean((B),(D),1),$ZBoolean((C),(D),2),7))+X(1)+4129170786)#4294967296)\Powers(32-5),7))))#4294967296)
	.   Set D=((A+(($ZBoolean(((D+($ZBoolean($ZBoolean((A),(C),1),$ZBoolean((B),(C),2),7))+X(6)+3225465664)#4294967296)*Powers(9)#4294967296,((D+($ZBoolean($ZBoolean((A),(C),1),$ZBoolean((B),(C),2),7))+X(6)+3225465664)#4294967296)\Powers(32-9),7))))#4294967296)
	.   Set C=((D+(($ZBoolean(((C+($ZBoolean($ZBoolean((D),(B),1),$ZBoolean((A),(B),2),7))+X(11)+643717713)#4294967296)*Powers(14)#4294967296,((C+($ZBoolean($ZBoolean((D),(B),1),$ZBoolean((A),(B),2),7))+X(11)+643717713)#4294967296)\Powers(32-14),7))))#4294967296)
	.   Set B=((C+(($ZBoolean(((B+($ZBoolean($ZBoolean((C),(A),1),$ZBoolean((D),(A),2),7))+X(0)+3921069994)#4294967296)*Powers(20)#4294967296,((B+($ZBoolean($ZBoolean((C),(A),1),$ZBoolean((D),(A),2),7))+X(0)+3921069994)#4294967296)\Powers(32-20),7))))#4294967296)
	.   Set A=((B+(($ZBoolean(((A+($ZBoolean($ZBoolean((B),(D),1),$ZBoolean((C),(D),2),7))+X(5)+3593408605)#4294967296)*Powers(5)#4294967296,((A+($ZBoolean($ZBoolean((B),(D),1),$ZBoolean((C),(D),2),7))+X(5)+3593408605)#4294967296)\Powers(32-5),7))))#4294967296)
	.   Set D=((A+(($ZBoolean(((D+($ZBoolean($ZBoolean((A),(C),1),$ZBoolean((B),(C),2),7))+X(10)+38016083)#4294967296)*Powers(9)#4294967296,((D+($ZBoolean($ZBoolean((A),(C),1),$ZBoolean((B),(C),2),7))+X(10)+38016083)#4294967296)\Powers(32-9),7))))#4294967296)
	.   Set C=((D+(($ZBoolean(((C+($ZBoolean($ZBoolean((D),(B),1),$ZBoolean((A),(B),2),7))+X(15)+3634488961)#4294967296)*Powers(14)#4294967296,((C+($ZBoolean($ZBoolean((D),(B),1),$ZBoolean((A),(B),2),7))+X(15)+3634488961)#4294967296)\Powers(32-14),7))))#4294967296)
	.   Set B=((C+(($ZBoolean(((B+($ZBoolean($ZBoolean((C),(A),1),$ZBoolean((D),(A),2),7))+X(4)+3889429448)#4294967296)*Powers(20)#4294967296,((B+($ZBoolean($ZBoolean((C),(A),1),$ZBoolean((D),(A),2),7))+X(4)+3889429448)#4294967296)\Powers(32-20),7))))#4294967296)
	.   Set A=((B+(($ZBoolean(((A+($ZBoolean($ZBoolean((B),(D),1),$ZBoolean((C),(D),2),7))+X(9)+568446438)#4294967296)*Powers(5)#4294967296,((A+($ZBoolean($ZBoolean((B),(D),1),$ZBoolean((C),(D),2),7))+X(9)+568446438)#4294967296)\Powers(32-5),7))))#4294967296)
	.   Set D=((A+(($ZBoolean(((D+($ZBoolean($ZBoolean((A),(C),1),$ZBoolean((B),(C),2),7))+X(14)+3275163606)#4294967296)*Powers(9)#4294967296,((D+($ZBoolean($ZBoolean((A),(C),1),$ZBoolean((B),(C),2),7))+X(14)+3275163606)#4294967296)\Powers(32-9),7))))#4294967296)
	.   Set C=((D+(($ZBoolean(((C+($ZBoolean($ZBoolean((D),(B),1),$ZBoolean((A),(B),2),7))+X(3)+4107603335)#4294967296)*Powers(14)#4294967296,((C+($ZBoolean($ZBoolean((D),(B),1),$ZBoolean((A),(B),2),7))+X(3)+4107603335)#4294967296)\Powers(32-14),7))))#4294967296)
	.   Set B=((C+(($ZBoolean(((B+($ZBoolean($ZBoolean((C),(A),1),$ZBoolean((D),(A),2),7))+X(8)+1163531501)#4294967296)*Powers(20)#4294967296,((B+($ZBoolean($ZBoolean((C),(A),1),$ZBoolean((D),(A),2),7))+X(8)+1163531501)#4294967296)\Powers(32-20),7))))#4294967296)
	.   Set A=((B+(($ZBoolean(((A+($ZBoolean($ZBoolean((B),(D),1),$ZBoolean((C),(D),2),7))+X(13)+2850285829)#4294967296)*Powers(5)#4294967296,((A+($ZBoolean($ZBoolean((B),(D),1),$ZBoolean((C),(D),2),7))+X(13)+2850285829)#4294967296)\Powers(32-5),7))))#4294967296)
	.   Set D=((A+(($ZBoolean(((D+($ZBoolean($ZBoolean((A),(C),1),$ZBoolean((B),(C),2),7))+X(2)+4243563512)#4294967296)*Powers(9)#4294967296,((D+($ZBoolean($ZBoolean((A),(C),1),$ZBoolean((B),(C),2),7))+X(2)+4243563512)#4294967296)\Powers(32-9),7))))#4294967296)
	.   Set C=((D+(($ZBoolean(((C+($ZBoolean($ZBoolean((D),(B),1),$ZBoolean((A),(B),2),7))+X(7)+1735328473)#4294967296)*Powers(14)#4294967296,((C+($ZBoolean($ZBoolean((D),(B),1),$ZBoolean((A),(B),2),7))+X(7)+1735328473)#4294967296)\Powers(32-14),7))))#4294967296)
	.   Set B=((C+(($ZBoolean(((B+($ZBoolean($ZBoolean((C),(A),1),$ZBoolean((D),(A),2),7))+X(12)+2368359562)#4294967296)*Powers(20)#4294967296,((B+($ZBoolean($ZBoolean((C),(A),1),$ZBoolean((D),(A),2),7))+X(12)+2368359562)#4294967296)\Powers(32-20),7))))#4294967296)
	. 
	.     
	.   Set A=((B+(($ZBoolean(((A+($ZBoolean($ZBoolean((B),(C),6),(D),6))+X(5)+4294588738)#4294967296)*Powers(4)#4294967296,((A+($ZBoolean($ZBoolean((B),(C),6),(D),6))+X(5)+4294588738)#4294967296)\Powers(32-4),7))))#4294967296)
	.   Set D=((A+(($ZBoolean(((D+($ZBoolean($ZBoolean((A),(B),6),(C),6))+X(8)+2272392833)#4294967296)*Powers(11)#4294967296,((D+($ZBoolean($ZBoolean((A),(B),6),(C),6))+X(8)+2272392833)#4294967296)\Powers(32-11),7))))#4294967296)
	.   Set C=((D+(($ZBoolean(((C+($ZBoolean($ZBoolean((D),(A),6),(B),6))+X(11)+1839030562)#4294967296)*Powers(16)#4294967296,((C+($ZBoolean($ZBoolean((D),(A),6),(B),6))+X(11)+1839030562)#4294967296)\Powers(32-16),7))))#4294967296)
	.   Set B=((C+(($ZBoolean(((B+($ZBoolean($ZBoolean((C),(D),6),(A),6))+X(14)+4259657740)#4294967296)*Powers(23)#4294967296,((B+($ZBoolean($ZBoolean((C),(D),6),(A),6))+X(14)+4259657740)#4294967296)\Powers(32-23),7))))#4294967296)
	.   Set A=((B+(($ZBoolean(((A+($ZBoolean($ZBoolean((B),(C),6),(D),6))+X(1)+2763975236)#4294967296)*Powers(4)#4294967296,((A+($ZBoolean($ZBoolean((B),(C),6),(D),6))+X(1)+2763975236)#4294967296)\Powers(32-4),7))))#4294967296)
	.   Set D=((A+(($ZBoolean(((D+($ZBoolean($ZBoolean((A),(B),6),(C),6))+X(4)+1272893353)#4294967296)*Powers(11)#4294967296,((D+($ZBoolean($ZBoolean((A),(B),6),(C),6))+X(4)+1272893353)#4294967296)\Powers(32-11),7))))#4294967296)
	.   Set C=((D+(($ZBoolean(((C+($ZBoolean($ZBoolean((D),(A),6),(B),6))+X(7)+4139469664)#4294967296)*Powers(16)#4294967296,((C+($ZBoolean($ZBoolean((D),(A),6),(B),6))+X(7)+4139469664)#4294967296)\Powers(32-16),7))))#4294967296)
	.   Set B=((C+(($ZBoolean(((B+($ZBoolean($ZBoolean((C),(D),6),(A),6))+X(10)+3200236656)#4294967296)*Powers(23)#4294967296,((B+($ZBoolean($ZBoolean((C),(D),6),(A),6))+X(10)+3200236656)#4294967296)\Powers(32-23),7))))#4294967296)
	.   Set A=((B+(($ZBoolean(((A+($ZBoolean($ZBoolean((B),(C),6),(D),6))+X(13)+681279174)#4294967296)*Powers(4)#4294967296,((A+($ZBoolean($ZBoolean((B),(C),6),(D),6))+X(13)+681279174)#4294967296)\Powers(32-4),7))))#4294967296)
	.   Set D=((A+(($ZBoolean(((D+($ZBoolean($ZBoolean((A),(B),6),(C),6))+X(0)+3936430074)#4294967296)*Powers(11)#4294967296,((D+($ZBoolean($ZBoolean((A),(B),6),(C),6))+X(0)+3936430074)#4294967296)\Powers(32-11),7))))#4294967296)
	.   Set C=((D+(($ZBoolean(((C+($ZBoolean($ZBoolean((D),(A),6),(B),6))+X(3)+3572445317)#4294967296)*Powers(16)#4294967296,((C+($ZBoolean($ZBoolean((D),(A),6),(B),6))+X(3)+3572445317)#4294967296)\Powers(32-16),7))))#4294967296)
	.   Set B=((C+(($ZBoolean(((B+($ZBoolean($ZBoolean((C),(D),6),(A),6))+X(6)+76029189)#4294967296)*Powers(23)#4294967296,((B+($ZBoolean($ZBoolean((C),(D),6),(A),6))+X(6)+76029189)#4294967296)\Powers(32-23),7))))#4294967296)
	.   Set A=((B+(($ZBoolean(((A+($ZBoolean($ZBoolean((B),(C),6),(D),6))+X(9)+3654602809)#4294967296)*Powers(4)#4294967296,((A+($ZBoolean($ZBoolean((B),(C),6),(D),6))+X(9)+3654602809)#4294967296)\Powers(32-4),7))))#4294967296)
	.   Set D=((A+(($ZBoolean(((D+($ZBoolean($ZBoolean((A),(B),6),(C),6))+X(12)+3873151461)#4294967296)*Powers(11)#4294967296,((D+($ZBoolean($ZBoolean((A),(B),6),(C),6))+X(12)+3873151461)#4294967296)\Powers(32-11),7))))#4294967296)
	.   Set C=((D+(($ZBoolean(((C+($ZBoolean($ZBoolean((D),(A),6),(B),6))+X(15)+530742520)#4294967296)*Powers(16)#4294967296,((C+($ZBoolean($ZBoolean((D),(A),6),(B),6))+X(15)+530742520)#4294967296)\Powers(32-16),7))))#4294967296)
	.   Set B=((C+(($ZBoolean(((B+($ZBoolean($ZBoolean((C),(D),6),(A),6))+X(2)+3299628645)#4294967296)*Powers(23)#4294967296,((B+($ZBoolean($ZBoolean((C),(D),6),(A),6))+X(2)+3299628645)#4294967296)\Powers(32-23),7))))#4294967296)
	. 
	. 
	.   Set A=((B+(($ZBoolean(((A+($ZBoolean((C),$ZBoolean((B),(D),11),6))+X(0)+4096336452)#4294967296)*Powers(6)#4294967296,((A+($ZBoolean((C),$ZBoolean((B),(D),11),6))+X(0)+4096336452)#4294967296)\Powers(32-6),7))))#4294967296)
	.   Set D=((A+(($ZBoolean(((D+($ZBoolean((B),$ZBoolean((A),(C),11),6))+X(7)+1126891415)#4294967296)*Powers(10)#4294967296,((D+($ZBoolean((B),$ZBoolean((A),(C),11),6))+X(7)+1126891415)#4294967296)\Powers(32-10),7))))#4294967296)
	.   Set C=((D+(($ZBoolean(((C+($ZBoolean((A),$ZBoolean((D),(B),11),6))+X(14)+2878612391)#4294967296)*Powers(15)#4294967296,((C+($ZBoolean((A),$ZBoolean((D),(B),11),6))+X(14)+2878612391)#4294967296)\Powers(32-15),7))))#4294967296)
	.   Set B=((C+(($ZBoolean(((B+($ZBoolean((D),$ZBoolean((C),(A),11),6))+X(5)+4237533241)#4294967296)*Powers(21)#4294967296,((B+($ZBoolean((D),$ZBoolean((C),(A),11),6))+X(5)+4237533241)#4294967296)\Powers(32-21),7))))#4294967296)
	.   Set A=((B+(($ZBoolean(((A+($ZBoolean((C),$ZBoolean((B),(D),11),6))+X(12)+1700485571)#4294967296)*Powers(6)#4294967296,((A+($ZBoolean((C),$ZBoolean((B),(D),11),6))+X(12)+1700485571)#4294967296)\Powers(32-6),7))))#4294967296)
	.   Set D=((A+(($ZBoolean(((D+($ZBoolean((B),$ZBoolean((A),(C),11),6))+X(3)+2399980690)#4294967296)*Powers(10)#4294967296,((D+($ZBoolean((B),$ZBoolean((A),(C),11),6))+X(3)+2399980690)#4294967296)\Powers(32-10),7))))#4294967296)
	.   Set C=((D+(($ZBoolean(((C+($ZBoolean((A),$ZBoolean((D),(B),11),6))+X(10)+4293915773)#4294967296)*Powers(15)#4294967296,((C+($ZBoolean((A),$ZBoolean((D),(B),11),6))+X(10)+4293915773)#4294967296)\Powers(32-15),7))))#4294967296)
	.   Set B=((C+(($ZBoolean(((B+($ZBoolean((D),$ZBoolean((C),(A),11),6))+X(1)+2240044497)#4294967296)*Powers(21)#4294967296,((B+($ZBoolean((D),$ZBoolean((C),(A),11),6))+X(1)+2240044497)#4294967296)\Powers(32-21),7))))#4294967296)
	.   Set A=((B+(($ZBoolean(((A+($ZBoolean((C),$ZBoolean((B),(D),11),6))+X(8)+1873313359)#4294967296)*Powers(6)#4294967296,((A+($ZBoolean((C),$ZBoolean((B),(D),11),6))+X(8)+1873313359)#4294967296)\Powers(32-6),7))))#4294967296)
	.   Set D=((A+(($ZBoolean(((D+($ZBoolean((B),$ZBoolean((A),(C),11),6))+X(15)+4264355552)#4294967296)*Powers(10)#4294967296,((D+($ZBoolean((B),$ZBoolean((A),(C),11),6))+X(15)+4264355552)#4294967296)\Powers(32-10),7))))#4294967296)
	.   Set C=((D+(($ZBoolean(((C+($ZBoolean((A),$ZBoolean((D),(B),11),6))+X(6)+2734768916)#4294967296)*Powers(15)#4294967296,((C+($ZBoolean((A),$ZBoolean((D),(B),11),6))+X(6)+2734768916)#4294967296)\Powers(32-15),7))))#4294967296)
	.   Set B=((C+(($ZBoolean(((B+($ZBoolean((D),$ZBoolean((C),(A),11),6))+X(13)+1309151649)#4294967296)*Powers(21)#4294967296,((B+($ZBoolean((D),$ZBoolean((C),(A),11),6))+X(13)+1309151649)#4294967296)\Powers(32-21),7))))#4294967296)
	.   Set A=((B+(($ZBoolean(((A+($ZBoolean((C),$ZBoolean((B),(D),11),6))+X(4)+4149444226)#4294967296)*Powers(6)#4294967296,((A+($ZBoolean((C),$ZBoolean((B),(D),11),6))+X(4)+4149444226)#4294967296)\Powers(32-6),7))))#4294967296)
	.   Set D=((A+(($ZBoolean(((D+($ZBoolean((B),$ZBoolean((A),(C),11),6))+X(11)+3174756917)#4294967296)*Powers(10)#4294967296,((D+($ZBoolean((B),$ZBoolean((A),(C),11),6))+X(11)+3174756917)#4294967296)\Powers(32-10),7))))#4294967296)
	.   Set C=((D+(($ZBoolean(((C+($ZBoolean((A),$ZBoolean((D),(B),11),6))+X(2)+718787259)#4294967296)*Powers(15)#4294967296,((C+($ZBoolean((A),$ZBoolean((D),(B),11),6))+X(2)+718787259)#4294967296)\Powers(32-15),7))))#4294967296)
	.   Set B=((C+(($ZBoolean(((B+($ZBoolean((D),$ZBoolean((C),(A),11),6))+X(9)+3951481745)#4294967296)*Powers(21)#4294967296,((B+($ZBoolean((D),$ZBoolean((C),(A),11),6))+X(9)+3951481745)#4294967296)\Powers(32-21),7))))#4294967296)
	. 
	.   Set A=((A+AA)#4294967296)
	.   Set B=((B+BB)#4294967296)
	.   Set C=((C+CC)#4294967296)
	.   Set D=((D+DD)#4294967296)
	;// Step 5
	Set Result=$$Reverse(A)_$$Reverse(B)_$$Reverse(C)_$$Reverse(D)
	Quit Result
Reverse(S)	 ;
	Set S=$ZHex(S)
	Set S=$Extract("00000000",0,8-$Length(S))_S
	Quit $Extract(S,7,8)_$Extract(S,5,6)_$Extract(S,3,4)_$Extract(S,1,2)
Powers	; To avoid the extremely slow 2**x function 
	Set Powers(0)=1
	Set Powers(1)=2
	Set Powers(2)=4
	Set Powers(3)=8
	Set Powers(4)=16
	Set Powers(5)=32
	Set Powers(6)=64
	Set Powers(7)=128
	Set Powers(8)=256
	Set Powers(9)=512
	Set Powers(10)=1024
	Set Powers(11)=2048
	Set Powers(12)=4096
	Set Powers(13)=8192
	Set Powers(14)=16384
	Set Powers(15)=32768
	Set Powers(16)=65536
	Set Powers(17)=131072
	Set Powers(18)=262144
	Set Powers(19)=524288
	Set Powers(20)=1048576
	Set Powers(21)=2097152
	Set Powers(22)=4194304
	Set Powers(23)=8388608
	Set Powers(24)=16777216
	Set Powers(25)=33554432
	Set Powers(26)=67108864
	Set Powers(27)=134217728
	Set Powers(28)=268435456
	Set Powers(29)=536870912
	Set Powers(30)=1073741824
	Set Powers(31)=2147483648
	Set Powers(32)=4294967296                  
	Quit
Test	;MD5 test suite:
	;;d41d8cd98f00b204e9800998ecf8427e
	;a;0cc175b9c0f1b6a831c399e269772661
	;abc;900150983cd24fb0d6963f7d28e17f72
	;message digest;f96b697d7cb7938d525a2f31aaf161d0
	;abcdefghijklmnopqrstuvwxyz;c3fcd3d76192e4007dfb496cca67e13b
	;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789;d174ab98d277d9f5a5611c2c9f419d9f
	;12345678901234567890123456789012345678901234567890123456789012345678901234567890;57edf4a22be3c955ac49da2e2107b67a
	;
	New i,Test,Result,TestResult,Msg
	For i=1:1:7 Do
	.   Set Test=$Text(Test+i),Msg=$Piece(Test,";",2),TestResult=$Piece(Test,";",3)
	.   Set Result=$$Encrypt(Msg)
	.   Write $C(34),Msg,$C(34)," = ",TestResult," : "
	.   If $ZCVT(Result,"l")=TestResult Write "OK",! Quit
	.   Write " <> ",Result,!
	Quit
pwencrypt(pw) Q $$pwencrypt^%MLOGIN(pw) //ЕЩЕ ОДИН АЛГОРИТМ
]]></Routine>


<Routine name="%ZAPM.ed.BSCmdapi" type="MAC" languagemode="0"><![CDATA[
%BSCmdapi ;; MAPI v0.05 Copyright 2004 Maksim Merzhvinsky
 ;	Based on MDAPI v0.05 by Maksim Merzhvinsky
 ;	Модифицировано Евгением Колупаевым. cci.ocx
 Q 
start
  Set ^%ZAPM.ed.BSCmdapicfg("stopsig")=0
  Job server
  Write "MDAPI started..."_$ZTIME($PIECE($HOROLOG,",",2),1)
  Quit
stop
  Set ^%ZAPM.ed.BSCmdapicfg("stopsig")=1
  Write "MDAPI stoped..."_$ZTIME($PIECE($HOROLOG,",",2),1)  
  Quit
showstatus(St,ROU,DEV) S St=""
  New pid,name,ns,dev,user Set pid=""
  For  Set pid=$O(^$JOB(pid)) Quit:pid=""  Do
    .Set name=$ZU(67,5,pid),ns=$ZU(67,6,pid),dev=$ZU(67,7,pid),user=$ZU(67,11,pid)
    .If (name=$G(ROU,$ZN)) && ($JOB'=pid) && (dev=$G(DEV,dev)) S St=$G(St)+1,St(pid)="PID="_pid_", rtn="_name_", namespace="_ns_", device="_dev_", user="_user
    .;W !,St
  Quit $G(St) //КОЛИЧЕСТВО ПРОЦЕССОВ АКТИВНО 
clear
  Kill ^%ZAPM.ed.BSCmdapilog
  Quit
  // config set server port
setport(newport)
  Set ^%ZAPM.ed.BSCmdapicfg("port")=+$Get(newport,10001)
  Write "Setting up new port... ", newport
  Quit
  // If yes then use direct socket instead of spool
setnospool(yes)
  Set ^%ZAPM.ed.BSCmdapicfg("nospool")=$S($Get(yes,0)=0:0,1:1)
  Quit
  // add system user
adduser(user,pass)
  If ($G(user)="") || (user["*/?.,") Write "Bad user name!",! Quit
  If ($G(pass)="") Write "Bad password!",! Quit
  If ($L(pass)<6) Write "Password is less than 6 symbols !",! Quit
  Set ^%ZAPM.ed.BSCmdapicfg("users",user,"pass")=$$CRC^%ZAPM.ed.BSCp(user,pass)
  Quit
  // delete system user
deluser(user)
  If ($G(user)="") Write "Bad user name!",! Quit
  Kill ^%ZAPM.ed.BSCmdapicfg("users",user)
  Quit
  // 
setdefault(noauth)
  Set ^%ZAPM.ed.BSCmdapicfg("noauth")=$Get(noauth,0)
  Quit
  // Set default access rights: 0 - all deny, 1 - all allow
setdefrights(deny)
  Set ^%ZAPM.ed.BSCmdapicfg("dr")=$S($Get(deny,0)=0:0,1:1)
  Quit
  // set default command access rights
setdefcmdrights(cmdid,deny)
  If ($Get(cmdid)="") Write "Bad cmdid!",! Quit
  Set ^%ZAPM.ed.BSCmdapicfg("dr","cmd",+$Get(cmdid))=$S($Get(deny,0)=0:0,1:1)
  Quit 
  // set users command access rights
setusercmdrights(cmdid,user,deny)
  If ($Get(cmdid)="") Write "Bad cmdid!",! Quit
  If ($Get(user)="") Write "Bad user name!",! Quit
  Set ^%ZAPM.ed.BSCmdapicfg("users",user,"r","cmd",+cmdid)=$S($Get(deny,0)=0:0,1:1)  
  Quit
  // Function return true if command "cmdid" allowed
  // defr - default rights loaded by thread
  // user - user name
iscmdallowed(cmdid,defr,user)
  New res
  Set res=$S($G(defr,0)=0:+$Get(^%ZAPM.ed.BSCmdapicfg("dr","cmd",+$G(cmdid)),0),1:+$Get(^%ZAPM.ed.BSCmdapicfg("dr","cmd",+$G(cmdid)),1))
  If ($Get(user)'="") && ($D(^%ZAPM.ed.BSCmdapicfg("users",user,"r","cmd",+$G(cmdid)))) Do
	.Set res=$S($G(defr,0)=0:+$Get(^%ZAPM.ed.BSCmdapicfg("users",user,"r","cmd",+$G(cmdid)),0),1:+$Get(^%ZAPM.ed.BSCmdapicfg("users",user,"r","cmd",+$G(cmdid)),1))
  Quit res
isglobalallowed(globname,defr,user)
  New res Set res=+$Get(defr,0)
  If $Get(globname)="" Quit 0
  If $Get(user)="" Quit +res
  If $D(^%ZAPM.ed.BSCmdapicfg("users",user,"r","glb",globname)) Quit (+^%ZAPM.ed.BSCmdapicfg("users",user,"r","glb",globname)>0)
  If $D(^%ZAPM.ed.BSCmdapicfg("dr","glb",globname)) Quit (^%ZAPM.ed.BSCmdapicfg("dr","glb",globname)>0)
  Quit res
isprocallowed(procname,defr,user)
  New res Set res=+$Get(defr,0)
  If $Get(procname)="" Quit 0
  If $Get(user)="" Quit +res
  If $D(^%ZAPM.ed.BSCmdapicfg("users",user,"r","proc",procname)) Quit (+^%ZAPM.ed.BSCmdapicfg("users",user,"r","proc",procname)>0)
  If $D(^%ZAPM.ed.BSCmdapicfg("dr","proc",procname)) Quit (^%ZAPM.ed.BSCmdapicfg("dr","proc",procname)>0)
  Quit res
isuciallowed(uciname,defr,user)
  New res Set res=+$Get(defr,0)
  If $Get(uciname)="" Quit 0
  If $Get(user)="" Quit +res
  If $D(^%ZAPM.ed.BSCmdapicfg("users",user,"r","uci",uciname)) Quit (+^%ZAPM.ed.BSCmdapicfg("users",user,"r","uni",uniname)>0)
  If $D(^%ZAPM.ed.BSCmdapicfg("dr","uci",uciname)) Quit (^%ZAPM.ed.BSCmdapicfg("dr","uci",uniname)>0)
  Quit res
showusers()
  New u Set u=""
  W !,"Users ------ mdapi ------",!
  For i=1:1  Set u=$O(^%ZAPM.ed.BSCmdapicfg("users",u)) Quit:u=""  Write i,". User mdapi: ",u,!
  W !,"Users ------- ip -------- access grand",!
  N BDSES,P9,noPASS,WW,GC
  S GC=$$KBD^%ZAPM.ed.BSF12("^%ZAPM.ed.BSC4(""PROTECT"")")
  For i=1:1 Set u=$O(@GC@(u)) Quit:u=""  Write i,". User ip: ",$$JF^%ZAPM.ed.BSC4r4(u,20),"  ",$G(@GC@(u,"GRANT")),!
  Quit
  /*
    Server thread
  */
server
  New dev,port,cli,ip
  //Set P0=""
  //Set P1=""
  Set $ZTrap="serr"
  Set port=$Get(^%ZAPM.ed.BSCmdapicfg("port"),10001)
  L ^%ZAPM.ed.BSpgWEBC(port):0 E  H
  Set dev="|TCP|"_port
  Open dev:(:port:"A"):5
  If '$T Quit
  Set ^%ZAPM.ed.BSCmdapicfg("CurSrvPid")=$JOB
  Do log(0,"Server started (port="_port_")...")
  For  Use dev Read cli:1  Do:$T   Quit:$Get(^%ZAPM.ed.BSCmdapicfg("stopsig"),0)
 	.Set ip=$A($ZU(111,0),1)_"."_$A($ZU(111,0),2)_"."_$A($ZU(111,0),3)_"."_$A($ZU(111,0),4)_":"_($A($ZU(111,0),5)*256+$A($ZU(111,0),6))
	.Do log(3,"Server new connection IP="_ip)
    .Job thread:(:5:dev:dev) If $ZCHILD=0 Do log(1,"Server can't create new JOB!")	 
  Close dev
  Set ^%ZAPM.ed.BSCmdapicfg("CurSrvPid")=""
  Do log(0,"Server stopped.")
  Quit
serr
  Set $ZTrap=""
  If $D(dev) Close dev
  Do log(1,"Server error: $ZE="_$ZE_"; $ZC="_$ZC)
  Quit
 /*
   Client thread
   first - read sinchro signal, then read packet
   Packet format:    
    ofs | size | description
     0  |   1  | MAPI version
     1  |   1  | command ID
     2  |   1  | 0..99 
     3  |   1  | param count
     1
     ...
     N - params:
     size | description
       1  | type
      1..4| length
      0..N| param
 */
thread
  New s,mver,cmd,pktseq,pcount,auth,logout,seq,user,dr,nospool
  Do log(3,"Client thread started... "_$P)
  Set logout=0,seq=0,user=""  
  Set dr=+$Get(^%ZAPM.ed.BSCmdapicfg("dr"),0)  // Get default rights
  Set auth=+$Get(^%ZAPM.ed.BSCmdapicfg("noauth"),0)  // If ini noauth=1 then no ask login
  Set nospool=+$Get(^%ZAPM.ed.BSCmdapicfg("nospool"),0)  // Don't use spool but use socket direct
tnxt
  Set $ZTrap="terr"
  For  Do:$$twaitsinh(10)   Quit:(logout || ($Get(^%ZAPM.ed.BSCmdapicfg("stopsig"),0)))  W !
    .// read header		  
	.If $$tread(.s,4,1) Do  Quit
	  ..Set seq=seq+1
	  ..Set mver=$A(s,1),cmd=$A(s,2),pktseq=$A(s,3),pcount=$A(s,4)
	  ..Do log(3,"Client: cmd="_cmd_", pktseq="_pktseq_", params="_pcount)
	  ..Do $CASE(cmd,0:cmdnull,1:cmdlogin,2:cmdlogout,3:cmdget,4:cmdset,5:cmdkill,6:cmdorder,7:cmddata,8:cmddo,9:cmdxecute,10:cmdcversion,11:cmdlock,12:cmdunlock,14:cmdgetuci,13:cmdsetuci,20:cmdtstart,21:cmdtrollback,22:cmdtcommit,23:cmdinc,101:cmdFSend,102:cmdFRecv,103:cmdFListSend,104:cmdSetP,105:cmdGetP,:cmdunknown)	  
    .If (s'="") Do log(3,"len="_$L(s)_", hdr="_s)    
  Lock
  Close $P
  Quit
cmdlogin
  New pass
  Do log(3,"cmdlogin.")
  //If auth Do log($$$LogLvlInfo,"Already logged in") Quit
  //If (pcount<2) Do log($$$LogLvlInfo,"Too little params") Quit
  If auth Do sendanswear(3,"Already logged in") Quit
  If (pcount<2) Do sendanswear(5,"Too little params") Quit
  If '$$treadparam(.user,10) Do sendanswear(5,"Bad user name") Quit
  If '$$treadparam(.pass,1) Do sendanswear(5,"Bad password") Quit
  Do log(3,"cmdlogin: user="_user_", pass=******")
  Set auth=$$auth(user,pass),pass=""
  Do sendanswear($S(auth:0,1:4),$S(auth:"",1:"Bad user name or password"))
  Quit
cmdlogout
  Do log(3,"cmdlogout.")
  Set logout=1
  Do sendanswear(0,"Bye")
  Quit
  /*
---------------------------------------------------------------------
  */
cmdSetP
  New PNum, DataLen, DataBuf, act
  Do log(3, "cmdSetP")
  Do treadparam(.PNum, 1)
  Do treadparam(.DataLen, 1)
  if (DataLen>0) D
  	.Do sendanswear(13, "Ready to recieve.")
  	.Read DataBuf#DataLen:15
  	.Set act="P"_PNum
  	.Set @act=DataBuf
  Else  D
    .Set act="P"_PNum
    .Set @act=""
  Quit
cmdGetP
  New PNum, PEntry
  Do log(3, "cmdGetP")
  Do treadparam(.PNum, 1)
  Set PEntry="P"_PNum
  Do sendanswear(13, "Ready to send.")
   If ($G(@PEntry) = "") Write $ZLC(0)
   Else  Write $ZLC($L(@PEntry)),@PEntry
  Quit
cmdFRecv
  New FName, FLen, DataBuf, BlockLen
  Do log(3, "cmdFileReceive")
  Do treadparam(.FName, 10)
  Do treadparam(.FLen, 1)
  Do treadparam(.BlockLen, 1)
  Set DestFile = ##class(%File).%New(FName)
  Set ok = DestFile.Open("WSN")
  If 'ok Do sendanswear(14, "Can't open specified file.") Quit
  Do sendanswear(13, "Ready to receive.")
  For i=1:1 {
    If (FLen < BlockLen) Set BlockLen = FLen
  	Read DataBuf#BlockLen:15
  	Do DestFile.Write(DataBuf)
  	Set FLen = FLen - BlockLen
  	If (FLen '> 0) Quit
  }
  Do DestFile.Close()
  Do sendanswear(0, "Transfer successed: "_FName_", length: "_FLen)
  Quit
cmdFSend
  New FName, FLen, DataBuf, BlockLen
  Do log(3, "cmdFileSend")
  Do treadparam(.FName, 10)
  Do treadparam(.BlockLen, 1)
  Set SrcFile = ##class(%File).%New(FName)
  Set ok = SrcFile.Open("RU")
  If 'ok Do sendanswear(14,"Can't open specified file.") Quit
  Set FLen = SrcFile.SizeGet
  If (FLen > 0) {
    Do sendanswear(13,"Ready to send.")
    Write $ZLC(FLen)
  } Else {
	Do SrcFile.Close()
	Do sendanswear(14,"Zero-length file. Nothing to send.")
    Quit
  }
  For i=1:1 {
    If (FLen < BlockLen) Set BlockLen = FLen
    Set DataBuf = SrcFile.Read(BlockLen)
    Write DataBuf
    Set FLen = FLen - $Length(DataBuf)
    If (FLen '> 0) Quit
  }
  Do SrcFile.Close()
  Do sendanswear(0, "Transfer successed: "_FName_", length: "_FLen)
  Quit
cmdFListSend
  New Path, Wildcard, Mode, rset, ResultBuf
  Do log(3, "cmdFListSend")
  Do treadparam(.Path, 10)
  Do treadparam(.Wildcard, 10)
  Do treadparam(.Mode, 10)
  If ('##class(%File).DirectoryExists(Path)) {
    Do sendanswear(14, "Specified path did not exists.")
    Quit
  }
  Set rset = ##class(%ResultSet).%New("%Library.File:FileSet")
  Do rset.Execute(Path, Wildcard, "ItemName", 1)
  Set ResultBuf = ""
  While (rset.Next(.fEnt)) {
    If ($SYSTEM.Status.IsOK(fEnt)) {
	  If (Mode = "1") {
	  	Set ResultBuf = ResultBuf _ rset.Data("ItemName") _ ":" _ rset.Data("Type") _ ";"
	  } ElseIf (Mode = "0") {
		If (rset.Data("Type") = "F") {
	      Set ResultBuf = ResultBuf _ rset.Data("ItemName") _ ";"
		}
	  } ElseIf (Mode = "2") {
	    If (rset.Data("Type") = "D") {
	      Set ResultBuf = ResultBuf _ rset.Data("ItemName") _ ";"
	    }
	  }
    }
  }
  If ($SYSTEM.Status.IsError(fEnt)) {
    Do sendanswear(14, "Query error.")
    Quit
  } Else {
	  Do sendanswear(13, "Ready to send. Block length:"_$ZLC($Length(ResultBuf)))
	  Write $ZLC($Length(ResultBuf))
  }
  Do rset.Close()
  If ($Length(ResultBuf) > 0) {
  	Do sendanswear(13, "Ready to send. Folder content.")
  	Write ResultBuf
  } Else {
    Do sendanswear(0, "Nothing to send.")
  }
  Quit
  /*
---------------------------------------------------------------------
  */
cmdset
  New gname,keys,newval,flags,olduci
  Do log(3,"cmdset.")
  If 'auth Do sendanswear(4,"") Quit
  If ('$$iscmdallowed(cmd,dr,user)) Do sendanswear(8,"") Quit
  Do treadparam(.gname,10)  
  Do treadparam(.keys,1)
  Do treadparam(.newval,1)
  Do treadparam(.flags,1)
  If (gname="") Do sendanswear(5,"More parameters needed") Quit
  If '$$isglobalallowed(gname,dr,user) Do sendanswear(8,"") Quit
  Set gname="^"_gname_$S(keys="":"",1:"("_keys_")")
  Do log(3,"global -> "_gname)  
  Set @gname=newval  
  Do sendanswear(0,"New value assigned")
  Quit
cmdget
  New gname,keys,def,flags,res
  Do log(3,"cmdget.")  
  If 'auth Do sendanswear(4,"") Quit
  If ('$$iscmdallowed(cmd,dr,user)) Do sendanswear(8,"") Quit
  Do treadparam(.gname,10)  
  Do treadparam(.keys,1)
  Do treadparam(.def,1)
  Do treadparam(.flags,1)
  If (gname="") Do sendanswear(5,"More parameters needed") Quit
  If '$$isglobalallowed(gname,dr,user) Do sendanswear(8,"") Quit
  Set gname="^"_gname_$S(keys="":"",1:"("_keys_")")
  Do log(3,"global -> "_gname)
  Set res=$Get(@gname,def)
  Do sendanswear(0,res)
  Quit
cmdkill
  New gname,keys,flags
  Do log(3,"cmdkill.")
  If 'auth Do sendanswear(4,"") Quit
  If ('$$iscmdallowed(cmd,dr,user)) Do sendanswear(8,"") Quit
  Do treadparam(.gname,10)  
  Do treadparam(.keys,1)
  Do treadparam(.flags,1)
  If (gname="") Do sendanswear(5,"More parameters needed") Quit
  If '$$isglobalallowed(gname,dr,user) Do sendanswear(8,"") Quit  
  Set gname="^"_gname_$S(keys="":"",1:"("_keys_")")
  Do log(3,"global -> "_gname)
  Kill @gname
  Do sendanswear(0,"Global killed")    
  Quit
cmdorder
  New gname,keys,flags,res
  Do log(3,"cmdorder.")
  If 'auth Do sendanswear(4,"") Quit
  If ('$$iscmdallowed(cmd,dr,user)) Do sendanswear(8,"") Quit
  Do treadparam(.gname,10)  
  Do treadparam(.keys,1)
  Do treadparam(.flags,1)
  If (gname="") Do sendanswear(5,"More parameters needed") Quit
  If '$$isglobalallowed(gname,dr,user) Do sendanswear(8,"") Quit
  Set gname="^"_gname_$S(keys="":"",1:"("_keys_")")
  Do log(3,"global -> "_gname)
  Set res=$Order(@gname)
  Do sendanswear(0,res)
  Quit
cmddata
  New gname,keys,flags,res
  Do log(3,"cmddata.")
  If 'auth Do sendanswear(4,"") Quit
  If ('$$iscmdallowed(cmd,dr,user)) Do sendanswear(8,"") Quit
  Do treadparam(.gname,10)  
  Do treadparam(.keys,1)
  Do treadparam(.flags,1)
  If (gname="") Do sendanswear(5,"More parameters needed") Quit
  If '$$isglobalallowed(gname,dr,user) Do sendanswear(8,"") Quit
  Set gname="^"_gname_$S(keys="":"",1:"("_keys_")")
  Do log(3,"global -> "_gname)
  Set res=$Data(@gname)
  Do sendanswear(0,res)
  Quit
cmddo
  New proc,ofs,args,flags,i,j,res,v
  Do log(3,"cmddo.")
  If 'auth Do sendanswear(4,"") Quit
  If ('$$iscmdallowed(cmd,dr,user)) Do sendanswear(8,"") Quit
  Do treadparam(.proc,10)
  Do treadparam(.ofs,1)
  Do treadparam(.args,1)
  Do treadparam(.flags,1)
  If (proc="") Do sendanswear(5,"More parameters needed") Quit
  If '$$isprocallowed(proc,dr,user) Do sendanswear(8,"") Quit
  Set proc=ofs_"^"_proc_$S(args="":"",1:"("_args_")")
  Set j=$JOB
  Open 2:(j)
  Use 2 Do @proc
  Close 2
  Set i="",res=""
  For  Set i=$O(^SPOOL(j,i)) Quit:(i="")||(i'<2147483647)  Set v=$G(^SPOOL(j,i)) Quit:($L(res)+$L(v)>32000)  Set res=res_v      
  Kill ^SPOOL(j)
  Do sendanswear(0,res)
  Quit
cmdxecute
  New xstr,j,i,res,v
  Do log(3,"cmdxecute.")
  If 'auth Do sendanswear(4,"") Quit
  If ('$$iscmdallowed(cmd,dr,user)) Do sendanswear(8,"") Quit
  Do treadparam(.xstr,10)
  If (xstr="") Do sendanswear(5,"More parameters needed") Quit
  Do log(3,"xstr=<"_xstr_">, job="_$JOB)
  Set j=$JOB
  Open 2:(j)
  Use 2 Xecute xstr
  Close 2
  Set i="",res=""
  For  Set i=$O(^SPOOL(j,i)) Quit:(i="")||(i'<2147483647)  Set v=$G(^SPOOL(j,i)) Quit:($L(res)+$L(v)>32000)  Set res=res_v    
  Kill ^SPOOL(j)  
  Do sendanswear(0,res)
  Quit
cmdcversion
  Do log(3,"cmdcversion.")
  Do sendanswear(0,$ZV)
  Quit
cmdlock
  If 'auth Do sendanswear(4,"") Quit
  If ('$$iscmdallowed(cmd,dr,user)) Do sendanswear(8,"") Quit
  New gname,keys,flags Set (gname,keys)="",flags=0  
  Do log(3,"cmdLock")
  Do treadparam(.gname,1)
  Do treadparam(.keys,1)
  Do treadparam(.flags,1)
  If (gname="") || ($L(gname)>56) Do sendanswear(5,"Bad global name") Quit
  Set gname=$S(+flags:"",1:"^")_gname_$S(keys="":"",1:"("_keys_")")
  Do log(3,"cmdlock: global -> +"_gname)
  Lock +@gname
  Do sendanswear(0,"Locked")
  Quit
cmdunlock
  If 'auth Do sendanswear(4,"") Quit
  If ('$$iscmdallowed(cmd,dr,user)) Do sendanswear(8,"") Quit
  New gname,keys,flags Set (gname,keys)="",flags=0
  Do log(3,"cmdUnlock")
  Do treadparam(.gname,1)
  Do treadparam(.keys,1)
  Do treadparam(.flags,1)
  Do log(3,"cmdunlock: global -> -"_gname)
  If ($L(gname)>56) Do sendanswear(5,"Bad global name") Quit
  If (gname'="") Set gname=$S(+flags:"",1:"^")_gname_$S(keys="":"",1:"("_keys_")")  
  Lock:(gname="")
  Lock:(gname'="") -@gname
  Do sendanswear(0,"Unlocked")
  Quit
cmdsetuci
  If 'auth Do sendanswear(4,"") Quit
  If ('$$iscmdallowed(cmd,dr,user)) Do sendanswear(8,"") Quit
  New newuci Set newuci=""
  Do log(3,"cmdSetUCI")
  Do treadparam(.newuci,5)
  If (newuci="") Do sendanswear(5,"Bad UCI name") Quit
  If '$$isuciallowed(newuci,dr,user) Do sendanswear(8,"") Quit
  Do log(3,"cmdSetUCI: newuci="_newuci)
  If ($ZNSPACE=newuci) Do sendanswear(0,"Namespace already set") Quit
  If ($ZU(90,10,newuci)=1) Set $ZNSPACE=newuci Do sendanswear(0,"Namespace was set") Quit
  Do sendanswear(6,"Namespace not exist "_$ZNSPACE)
  Quit
cmdgetuci
  If 'auth Do sendanswear(4,"") Quit
  If ('$$iscmdallowed(cmd,dr,user)) Do sendanswear(8,"") Quit
  Do log(3,"cmdGetUCI")
  Do sendanswear(0,$ZNSPACE)
  Quit
cmdtstart
  If 'auth Do sendanswear(4,"") Quit
  If ('$$iscmdallowed(cmd,dr,user)) Do sendanswear(8,"") Quit
  Do log(3,"cmdTStart")
  TSTART
  Do sendanswear(0,$TLEVEL)
  Quit
cmdtrollback
  If 'auth {Do sendanswear(4,"") Quit}
  If ('$$iscmdallowed(cmd,dr,user)) Do sendanswear(8,"") Quit
  Do log(3,"cmdTRollback")
  If ($TLEVEL=0) Do sendanswear(7,"Transaction not started") Quit
  TROLLBACK
  Do sendanswear(0,"Rollback complite")
  Quit
cmdtcommit
  If 'auth Do sendanswear(4,"") Quit
  If ('$$iscmdallowed(cmd,dr,user)) Do sendanswear(8,"") Quit
  Do log(3,"cmdTCommit")
  If ($TLEVEL=0) Do sendanswear(7,"Transaction not started") Quit
  TCOMMIT
  Do sendanswear(0,"Transaction commited")
  Quit
cmdinc
  New gname,keys,flags,res
  If 'auth Do sendanswear(4,"") Quit
  If ('$$iscmdallowed(cmd,dr,user)) Do sendanswear(8,"") Quit
  Do log(3,"cmdInc")
  Do treadparam(.gname,10)  
  Do treadparam(.keys,1)
  Do treadparam(.flags,1)
  If (gname="") Do sendanswear(5,"More parameters needed") Quit
  If '$$isglobalallowed(gname,dr,user) Do sendanswear(8,"") Quit
  Set gname="^"_gname_$S(keys="":"",1:"("_keys_")")
  Set res=$Increment(@gname)
  Do sendanswear(0,+res)  
  Quit
cmdnull Quit  // Null command
cmdunknown
  Do log(2,"Unknown command ID <"_cmd_">")
  Do sendanswear(3,"Unknown command ID <"+cmd+">")
  Quit
auth(user,pass)  
  New upass
  Q 1 If ($G(user)="") Quit 0    
  i $d(^%ZAPM.ed.BSCmdapicfg("users",user)) Set upass=$Get(^%ZAPM.ed.BSCmdapicfg("users",user,"pass")) Quit (upass'="")&&(upass=($$CRC^%ZAPM.ed.BSCp(user,pass))) //inoaaei e noa?uo iiuciaaoaeae
  Q $$CHECK(user,pass)
CHECK(user,pass)  N BDSES,P9,noPASS,WW,GC
  S GC=$$KBD^%ZAPM.ed.BSF12("^%ZAPM.ed.BSC4(""PROTECT"")")
  S BDSES=$$KBD^%ZAPM.ed.BSF12("^%ZAPM.ed.BSC4(""SESSIONS"")")
  I $D(@GC@(user)),$$PROTECT^%ZAPM.ed.BSCp(user,pass) Q 1 //password is valid
  I $D(@BDSES@(pass)),'$D(@BDSES@(pass,"CHR")),$G(@BDSES@(pass,"NM"))=user Q 1 //id session as tempory key
  Q 0 
sendanswear(error,msg)
  New pkt
  Do tflush()
  Set pkt=$C(2)_$ZLC(+$Get(error))_$ZLC($L($Get(msg)))_$Get(msg)
  Write pkt,!
  Quit
treadparam(str,tout)
  New a,len,res Set str=""
  Read a#1:1 If '$T Quit 0  
  If ($A(a)=0) Quit 1
  If ($A(a)=1) Set res=$$tread(.len,1,5),res=$$tread(.str,$A(len),5) Quit res
  If ($A(a)=2) Set res=$$tread(.len,4,5),res=$$tread(.str,$ZLA(len),5) Quit res
  If ($A(a)=3) Set res=$$tread(.a,4,5),str=$ZLA(a) Quit res
  Quit 0
tread(str,len,tout)  
  Set len=$Get(len,0),tout=$Get(tout,1)
  If (len=0) Quit 0
  Read str#len:tout
  Quit $T &&($L(str)=len)
tflush()
  //New s Set s=""
  Read *a:0.5 Quit:(a=-1)||('$T)  //Set s=s_a
  //If ($L(s)>0) Do log($$$LogLvlInfo,"flush ("_$L(s)_")>"_s)
  Quit 1
twaitsinh(tout)
  New i,a,t1,za Set i=0,tout=$Get(tout,5),t1=$ZH
  For  Do   Quit:(i=4)||($Get(^%ZAPM.ed.BSCmdapicfg("stopsig"),0))||((tout>0)&&($ZH-t1>tout))
   .Read *a:1 Set za=$ZA,zh=$ZH
   .If (a>0) Set i=$S(a=254:i+1,1:0)   
  Quit (i=4)
terr
  Set $ZTrap=""
  Do log(1,"Thread error: $ZE="_$ZE_"; $ZC="_$ZC)
  Lock
  Close 2
  Kill ^SPOOL($JOB)  
  ;If (($F($ZE,"<SYNTAX>")'=0) || ($F($ZE,"<UNDEFINED>")'=0)) Do sendanswear($$$errSystem,$ze) Goto tnxt
  If $ZE'="" Do sendanswear(1,$ze) Goto tnxt
  Close $P  
  Quit
log(lvl,v)
  Do DISABLE^%NOJRN
  Set ^%ZAPM.ed.BSCmdapilog($I(^%ZAPM.ed.BSCmdapilog))=$ZDT($H,4,1)_"["_$G(lvl,0)_"]: "_$G(v)
  Do ENABLE^%NOJRN
  Quit
]]></Routine>


<Routine name="%ZAPM.ed.BSCnewF11" type="MAC" languagemode="0"><![CDATA[
%BSF11 ; ДОПОЛНИТЕЛЬНЫЕ ПРОВЕРКИ ; 11:45   04.05.2001
 Q
COP2L(si,st) ;КОПИРОВАНИЕ СТРОКИ si В ЛОКАЛЬ
 S bsr="BUF"
 I $D(@BSR@(BST,si,1)) F kj=1:1 Q:'$D(@BSR@(BST,si,kj))  S @bsr@(BSt,st,kj)=@$ZR D
 .I 'fo F f="FCL","FTR","COL" S $P(@bsr@(BSt,st,kj),"@",$S(f="COL":13,f="FCL":7,f="RTR":16,1:8))=""
 .I fo D
 ..I "2345"'[$P(@BSR@(BST,si,kj),"@",7),$D(@BSR@(BST,"FCL",si,kj)) S @bsr@(BSt,"FCL",st,kj)=@$ZR
 ..I $D(@BSR@(BST,"FTR",si,kj)) S @bsr@(BSt,"FTR",st,kj)=@$ZR
 ..I '$P(B,"@",27) I $D(@BSR@(BST,"COL",si,kj)) S @bsr@(BSt,"COL",st,kj)=@$ZR D
 ...I $D(@BSR@(BST,"COL",si,kj,1)) S @bsr@(BSt,"COL",st,kj,1)=@$ZR
 Q
COPY(si) ;КОПИРОВАНИЕ СТРОКИ si ИЗ ЛОКАЛИ
 S St=St+1 X WA F kj=1:1 Q:'$D(@bsr@(BSt,si,kj))  S @(BSr_"(BSt,St,kj)")=@bsr@(BSt,si,kj) D
 .I 'fo F f="FCL","FTR","COL" S $P(@$ZR,"@",$S(f="COL":13,f="FCL":7,f="RTR":16,1:8))=""
 .I fo D
 ..F f="FCL","FTR" I $D(@bsr@(BSt,f,si,kj)) S @(BSr_"(BSt,f,St,kj)")=@bsr@(BSt,f,si,kj)
 ..I '$P(B,"@",27) I $D(@bsr@(BSt,"COL",si,kj)) S @BSr@(BSt,"COL",St,kj)=@bsr@(BSt,"COL",si,kj) D
 ...I $D(@bsr@(BSt,"COL",si,kj,1)) S @BSr@(BSt,"COL",St,kj,1)=@bsr@(BSt,"COL",si,kj,1)
 Q
LASTHIS(key,ny) N %HIS D HIS^%ZAPM.ed.BSF1($$NHIS()) Q $D(@%HIS@(1))
INSERT(key,ny) N %HIS D HIS^%ZAPM.ed.BSF1($$NHIS()) Q $G(@%HIS@(1))
NHIS() Q "TabelKey"_key_"String"_ny
PREDTEMP ;ПРЕДОБРАБОТКА ВЫБОРКИ ДЛЯ КЛЮЧЕЙ
 Q:R1>332
 I R1=13 D  Q  ;ЗАПИСЬ В ИСТОРИЮ
 .I d'["#",key'=0 Q:ny>4
 .D AddHist($$NHIS(),d)
 I R1=27,R2=91,R3=68!(R3=67) D  ;ЗАСВЕТКА СПИСКА ИСТОРИЙ
 .N %HIS,TTT D HIS^%ZAPM.ed.BSF1($$NHIS()) S TTT=$P($P(%HIS,"(",2),$C(34),2)
 .s Tmp=$$History^%ZAPM.ed.BSXfun("^%ZAPM.ed.BSbufB",TTT) I Tmp=""!(YES<1) S R1=-2 Q
 .S d=Tmp,R1=0,R2=18 Q
 I ny>4,R1>31,R2=-1,R3=-1 S R1=-4,li=$P($G(@BSR@(BST,ny,2)),"@",15)_"#"_$P($G(@BSR@(BST,"COL",ny,3)),"I ",2,99)
 Q
AddHist(f,d) Q:d=""  N %HIS D HIS^%ZAPM.ed.BSF1(f) D AddHist^%ZAPM.ed.BSXuse(%HIS,d)
 Q
SETEMP ;ВРЕМЕННАЯ ВЫБОРКА
 S ^%ZAPM.ed.BSbufB("KCH"_$G(%BS(3),$P)_$J_"u"_%BS(15),COMP,key,3)="I "_$P(d,"#",2,999)
 S ^%ZAPM.ed.BSbufB("KCH"_$G(%BS(3),$P)_$J_"u"_%BS(15),COMP,key,4)="TXTC#"_$P(d,"#")
 Q
CREA(F) ;ФОРМУЛА НА БОКОВИНУ
 N FF
 I F["LongString" S F=$$GLRET^%ZAPM.ed.BSF12(F)
 I F["$$TSV" X "S FF="_F
 I F'["$$TSV" S FF="I "_F
 Q FF
TSVV(kod) Q "I "_kod
CREAT(M,Y,X,RA,EN) D Wait^%ZAPM.ed.BSXfun("КОПИРОВАНИЕ М\ЗАПРОСОВ В СВОДКУ")
 G creat:$E(SVo,1)=0
 N si,MM,fo,MMM,bsr,BUF
 S MM="",MMM=Y,fo=1 K SP(5) D COP2L(Y,1) S fo=0 D COP2L(RA,2)
 F  S MM=$O(@M@(1,MM)) Q:MM=""  D  S MMM=MMM+2
 .S Tmp=$$GLRET^%ZAPM.ed.BSF12($NA(@M@(1,MM))),fo=1 D COPY(1) S @BSr@(BSt,St)=1,n(MMM)=n,n=n+1 D  F C=2:1:COMP D COPY(1) S @BSr@(BSt,St)=C,$P(@BSr@(BSt,St,TSVV),"@",15)=""
 ..S $P(@BSr@(BSt,St,TSVV),"@",15)=$P(Tmp,"@")
 ..S SP(5,MMM)=$$CREA($P(Tmp,"@",2,9999))
 .I $O(@M@(1,MM))'="" S fo=0 D COPY(2)
 S si=EN,fo=0 D COP^%ZAPM.ed.BSSV
 Q
creat ;КОПИРОВАНИЕ М\ЗАПРОСОВ В СВОДКУ (СТАРЫЙ ВАРИАНТ)
 N si,MM,fo,MMM
 S MM="",MMM=Y K SP(5)
 F  S MM=$O(@M@(1,MM)) Q:MM=""  D  S MMM=MMM+2
 .S si=Y,fo=1 D COP^%ZAPM.ed.BSSV S @BSr@(BSt,St)=1,n(MMM)=n,n=n+1 D  F C=2:1:COMP D COP^%ZAPM.ed.BSSV S @BSr@(BSt,St)=C,$P(@BSr@(BSt,St,TSVV),"@",15)=""
 ..S $P(@BSr@(BSt,St,TSVV),"@",15)=$P(@M@(1,MM),"@")
 ..S SP(5,MMM)=$$CREA($P(@M@(1,MM),"@",2,999))
 .I $O(@M@(1,MM))'="" S si=RA,fo=0 D COP^%ZAPM.ed.BSSV
 S si=EN,fo=0 D COP^%ZAPM.ed.BSSV
 Q
CHO(MM,NO,x,zz) ;ВЫБОР
 N M,BSr,BSt,Fk,se,Obraz
 S YES=1,%zT=$ZT,$ZT="ERMA^%ZAPM.ed.BSF11"
 D TempT^%ZAPM.ed.BSTT
 F M=1:1 Q:$P(MM,"@",M)=""  D TempTX^%ZAPM.ed.BSTT($P(MM,"@",M)_" "_$P($G(@$P(MM,"@",M)),"@",2))
 D TempTXT^%ZAPM.ed.BSTT("<<< Выберите БОКОВИНУ для сводки >>>",$G(@%BS(20)@("ErrorTXT")))
 d ^%ZAPM.ed.BSX("TEXT",BSr,BSt) Q:YES<1
 S M=YES I YES D Yes^%ZAPM.ed.BSXfun("Будем УТОЧНЯТЬ БОКОВИНУ ?",2) S Tmp=YES,YES=1 I Tmp D TEMPZAPR($P(MM,"@",M))
 S $P(@x,"#",9)=$P(MM,"@",M),$P(@x,"#",10)=NO
 ;```???```I $D(NZP),$D(@BSR@(BST,"ZPR",NZP,0)) S $P(@$ZR,"#",9)=$P(MM,"@",M),$P(@$ZR,"#",10)=NO
 Q
TEMPZAPR(GL) ;РАЗОВЫЕ М-ЗАПРОСЫ
 N TG,TT,BSR,BST,BSr,BSt,IntTmp,i,j,s1,s2,s6i,l1,l2,col,ke,Fk,tIT,IYI,txt,kod,%INV1,%INV2
 N k1,k2,k3,k4,k5,k6,k7,k8,k9,%INV,Tmp,Shab
 S TT=$$TMPG^%ZAPM.ed.BSF11,BSR=$P(TT,"("),BST=$P($P($P(TT,"(",2),")"),$C(34),2),IntTmp=1
 S Shab="^%ZAPM.ed.BSS(""OPout"")" I $D(zz),$$Data^%ZAPM.ed.BSF12(zz) S Shab=zz
 S @BSR@(BST)=@Shab
 S s1="dinamo",Fk="",Tmp=0
 D Int I $D(@Shab@("AF2")) S @BSR@(BST,"AF2")=@Shab@("AF2")
AGAIN S IYI=BSR_"("_BST D NE^%ZAPM.ed.BSN I R1=27 S YES=0 Q
 S %INV="TempZap"_$G(%BS(3),$P)_$J_"u",%INV=$$BSR^%ZAPM.ed.BSA($NA(^%ZAPM.ed.BSbufB(%INV))) K @%INV S %INV2=1,%INV1=2,s6=0,@%INV="%BS-dimamo-@Temporary"
 S do="D TEMPZ^%ZAPM.ed.BSF11(j)" D BLOK^%ZAPM.ed.BSF1 I YES<1!('s6) G AGAIN
 S YES=1,MM=%INV,M=1
 Q
TEMPZ(j) ;СОЗДАНИЕ TEMP.М\ЗАПРОСОВ
 Q:Tmp=i
 D DINA^%ZAPM.ed.BSS I YES<1 S i=999999 Q
 S Tmp=i Q
ERMA D ErrMsg^%ZAPM.ed.BSXfun($$ErrSay^%ZAPM.ed.BSF8($ZE)) S $ZT=$G(%zT),YES=0 Q
TS ;ПОИСК ДИНАМИЧЕСКОЙ БОКОВИНЫ
 N F S ls=1
 S F=$G(@BSR@(BST,"FCL",id,jd)) X "I "_F
 Q
TSVD(M,N,T,Z) I '$D(@BSR@(BST,N)) S ls="В ФУНКЦИИ $TSVD НЕТ СТРОКИ С НОМЕРОМ "_N Q 0
 I '$D(@BSR@(BST,T)) S ls="В ФУНКЦИИ $TSVD НЕТ СТРОКИ С НОМЕРОМ "_T Q 0
 S @BSR@(BST,"TSV",1,3)=$G(M),@BSR@(BST,"TSV",1,3,1)=+$G(N)_","_+$G(T)_","_id_","_jd
 I $D(Z) S @BSR@(BST,"TSV",1,3,2)=Z
 Q 1
INVTAB S s1="invert" G DINS ;ОБРАТНАЯ ОПЕРАЦИЯ
DINTAB S s1="dinamo"
DINS I BST'["@" D ErrMsg^%ZAPM.ed.BSXfun("ОПЕРАЦИЯ ВОЗМОЖНА В РЕЖИМЕ РЕДАКТИРОВАНИЯ ТАБЛИЦЫ <F4>") G D
 D Yes^%ZAPM.ed.BSXfun("ТЕКУЩАЯ ТАБЛИЦА СИЛЬНО ИЗМЕНИТСЯ ! ВЫ ГОТОВЫ К ЭТОМУ ?",2) I YES<1 G D
 S li="^" D GLO^%ZAPM.ed.BSF3 I $G(GL)="" G D
 I $P($G(@GL),"@")'[("%BS-"_s1_"-") D ErrMsg^%ZAPM.ed.BSXfun("НУ, ЭТО СОВСЕМ НЕ ТО !") G D
Int S s2=@BSR@(BST) K @BSR@(BST) S @BSR@(BST)=s2,$P(@$ZR,"@",29)=2,ke=2,s2=0
 S i="",BSr=BSR,BSt=BST
 I s1["mo" F  S i=$O(@GL@(1,i)) Q:i=""  D DINSM($P($G(^(i)),"@"))
 I s1'["mo" F  S i=$O(@GL@(1,i)) Q:i=""  D DINSM(i)
 S s2=s2+1 I s2>50 S s2=50
 S l1=s2,l2=75-l1,(col(1),col(2))=$P(%BS,"!",4) D DINSE(" КОДЫ"," "_$S(s1'["mo":"ТЕКСТЫ",1:"ФОРМУЛЫ (для включения в М\Запрсы их надо ПОМЕТИТЬ)"))
 S col(1)=$P(%BS,"!",5),col(2)=$P(%BS,"!",6),a=""
 I s1["mo" F  S a=$O(@GL@(1,a)) Q:a=""  D DINSE($P(@GL@(1,a),"@"),$P(@GL@(1,a),"@",2,999))
 I s1'["mo" F  S a=$O(@GL@(1,a)) Q:a=""  D DINSE(a,@GL@(1,a))
 D CREAT^%ZAPM.ed.BSN S $P(@BSr@(BSt),"@")=$P($G(@GL,"@???"),"@",2)
 Q:$D(IntTmp)
 D TIT^%ZAPM.ed.BST,W^%ZAPM.ed.BST G B^%ZAPM.ed.BSTM
DINSM(t1) I $L(t1)>s2 S s2=$L(t1)
 Q
DINSE(t1,t2) D CR^%ZAPM.ed.BSN Q
ERCMD ;ОШИБКИ В ФОРМУЛАХ СПИСКОВ И СВОДОК
 D TempT^%ZAPM.ed.BSTT
 D TempTX^%ZAPM.ed.BSTT($$ErrSay^%ZAPM.ed.BSF8($ZE)),TempTX^%ZAPM.ed.BSTT("")
 D TempTX^%ZAPM.ed.BSTT("    ВОЗМОЖНО ОШИБКА В ФОРМУЛАХ:"),TempTX^%ZAPM.ed.BSTT("")
 I $D(iii),$D(SP(2,iii)) D TempTX^%ZAPM.ed.BSTT("номер="_iii_" Логики на Шапку"),TempTX^%ZAPM.ed.BSTT(SP(2,iii))
 I $D(iii),$D(SP(4,iii)) D TempTX^%ZAPM.ed.BSTT("номер="_iii),TempTX^%ZAPM.ed.BSTT(SP(4,iii))
 I $G(iS),$D(SP(5,iS)) D TempTX^%ZAPM.ed.BSTT("номер="_iS_" Логики на Боковину"),TempTX^%ZAPM.ed.BSTT(SP(5,iS))
 I $D(i),$D(C),$D(CH(C,i,3)) D TempTX^%ZAPM.ed.BSTT(" Логика Выборки="_CH(C,i,3))
 D TempTXT^%ZAPM.ed.BSTT("ОШИБКА !!!",$G(@%BS(20)@("ErrorTXT")))
 D TempTXTE^%ZAPM.ed.BSTT
 Q
D G 0^%ZAPM.ed.BSTM
DIN ;МИКРОЗАПРОСЫ ИЗ СВОДКИ В МАССИВ
 S do="I j=%INV1 D DINASE^%ZAPM.ed.BSS($P(^(j),""@"",15),$G(@BSR@(BST,""FCL"",i,j)))"
 D SETKD^%ZAPM.ed.BSS S s6=0
 D BLOK^%ZAPM.ed.BSF1 G ENDIN^%ZAPM.ed.BSS
S(C) Q:C'["]" 0 N U,S
 S U=$P(C,$C(34),2),S=$P(C,$C(34),4) I $$ZU^%ZAPM.ed.BS3(U,S) Q 0
 Q 1
F(S) I $$S(S)=0 Q "НОВЫЙ ФОНОВЫЙ НАСЧЕТ"
 Q "НОВЫЙ ЛОКАЛЬНЫЙ ФОНОВЫЙ НАСЧЕТ"
H(S) I $$S(S)=0 Q "НОВЫЙ НАСЧЕТ"
 Q "НОВЫЙ ЛОКАЛЬНЫЙ НАСЧЕТ"
R(C) ;УДАЛЕННЫЕ НАСЧЕТЫ
 N %TAB,%TAA
 D UU(C) I '$D(UU) Q
 S %TAB=%OLDII I UU=$$BSR^%ZAPM.ed.BSA("^%ZAPM.ed.BSbufS") Q
 F  S %TAB=$O(@(UU_"(%TAB)")) Q:%TAB=""  Q:%TAB'[%OLDII  I %TAB'["@"&(%TAB'["&") S i=i+1 D
 .S @TS@(i,1)="@@1@75@@@@@1@"_$P(%BS,"!",5)_"@@@@@ "_$P(%TAB,"!",3)_$J("",13-$L($P(%TAB,"!",3)))_$S($P(@(UU_"(%TAB)"),"@",30)="":".....",1:$E($P(@$ZR,"@",30),1,5))_";REMOTE;1;"_$P(@$ZR,"@")
 ;```S (%TAB,%TAA)=%OLDII
 ;```F  S %TAB=$O(@(UU_"(%TAB)")) Q:%TAB=""  Q:%TAB'[%TAA  I %TAB'["@"&(%TAB'["&") S i=i+1 D
 ;```.S @TS@(i,1)="@@1@75@@@@@1@"_$P(%BS,"!",5)_"@@@@@ "_$P(%TAB,"!",3)_$J("",13-$L($P(%TAB,"!",3)))_$S($P(@(UU_"(%TAB)"),"@",30)="":".....",1:$E($P(@$ZR,"@",30),1,5))_";REMOTE;1;"_$P(@$ZR,"@")
 Q
UU(C) N U ;ОПРЕДЕЛЕНИЕ ССЫЛКИ СЕТЕВОГО РАЗДЕЛА
 S U="^["""_$P(C,$C(34),2)_""","""_$P(C,$C(34),4)_"""]BSdirddp",U=$P($G(@U),"@",2) I U="" G UUu
 S UU="^["""_$P(U,",")_""","""_$P(U,",",2)_"""]%BSbufS" I $$Data^%ZAPM.ed.BSF12(UU) Q
UUu S UU="^[""MGR"","""_$P($G(^%ZAPM.ed.BSETUP("SERVER",14,4)),"@",15)_"""]%BSbufS" I $$Data^%ZAPM.ed.BSF12(UU) Q
 S UU=$$BSR^%ZAPM.ed.BSA("^%ZAPM.ed.BSbufS") Q
DEL S %TAB=$P(d," ",2) S %OLDII1=$S(%OLDII'["^%":$E(%OLDII,4,6)_":"_$E(%OLDII,10,12)_":"_$P($P(%OLDII,"]",2),"!",1,9),1:%OLDII)
 I $D(%DIA) S do="S d=$P(^(j),""@"",15) K Temp D DE^%ZAPM.ed.BSF11(d) I $D(Temp) S %TAB=%OLDII1_$P($P($P(^(j),""@"",15),"" "",2),""."",2) D DEL^%ZAPM.ed.BS(Temp,$S($ZV[""Cach"":%OLDII_$P(%TAB,""."",2),1:%OLDII1_$P(%TAB,""."",2)))" D BLOK^%ZAPM.ed.BSF1 Q
 Q:ny<4  K Temp D DE(d) I $D(Temp) D DEL^%ZAPM.ed.BS(Temp,$S($ZV["Cach"||($ZV["IRIS"):%OLDII_$P(%TAB,".",2),1:%OLDII1_$P(%TAB,".",2)))
 Q
DE(d) I d[";REMOTE;" S Temp=UU Q
 I d[";LOCKAL;" S Temp=%nAM
 Q
OUTGLO(GLO,FN) ;КОПИРОВАНИЕ НОВОЙ ВЕРСИИ В СЕТЕВУЮ ГЛОБАЛЬ
 I GLO'["^" Q
 N DOS,I,II
 S %zT=$ZT,$ZT="OG^%ZAPM.ed.BSF11",YES=0,II=1
 F DOS=51:1:54 O DOS::0 Q:$T
 I $$Open^%ZAPM.ed.BSXdos(FN,"R")<0 Q
 D L^%ZAPM.ed.BS3(GLO)
 U 0 d Wait^%ZAPM.ed.BSXfun("Копирование в "_GLO) K @GLO@("LAST") S @GLO@("LAST")=0
 F  U DOS Q:$ZC'=0  R I S @GLO@("LAST",II)=I,II=II+1 I '(II#50) U 0 X $G(WA)
 S @GLO@("LAST")=^%ZAPM.ed.BS
 S YES=1 D U^%ZAPM.ed.BS3(GLO) C DOS
 Q
OG I $ZE["<ENDOFFILE" G OGO
 D ErrMsg^%ZAPM.ed.BSXfun($$ErrSay^%ZAPM.ed.BSF8($ZE))
OGO S $ZT=$G(%zT),YES=0 D U^%ZAPM.ed.BS3(GLO) C DOS
 Q
SCAN(%FN) ;СКАНИРОВАНИЕ
 C %FN K fT2
 N I,WRITE,DOS,FN,DOSO,FNO,FIRST,M,CU,v,ST,STOPSCAN,DOSIN,DOSOUT,say
 I $D(^%ZAPM.ed.BSDDR("DDRPARM")) F CU=2:2:16 S CU(CU)=$P(^%ZAPM.ed.BSDDR("DDRPARM",CU,4),"@",15)
 I %IN["%BS-SCANINIG" G SCA
 ;S FN=$$BaseDir^%ZAPM.ed.BSDOS_$$DIR^%ZAPM.ed.BSMSMF_$$TEMPFILE,FNO=%FN
 ;C %DEV 
 I $ZV["Cach"||($ZV["IRIS") D  G SCA1
 .S say="без перекодировки" S (S2,S1)="" I $$IFDOS^%ZAPM.ed.BSHTML1(%IN) D  S say="с перекодировкой" 
 ..N (S1,S2) D INIT^%ZAPM.ed.BSre(1)
 ;F %DEV=$G(%Dev,51):1:54 O %DEV::0 Q:$T
 ;S DOS=%DEV
 ;F %DEV=$G(DOS,51)+1:1:54 O %DEV::0 Q:$T
SCA1 ;I $$Open^%ZAPM.ed.BSXdos(FNO,"R")<0 G STOPSCAN
 ;S DOSO=DOS,DOS=%DEV I $$Open^%ZAPM.ed.BSXdos(FN,"W")<0 G STOPSCAN
 ;S DOSIN=DOSO,DOSOUT=DOS X $G(CU(16)) I $G(STOPSCAN) G STOPSCAN
 k fT2 d fT1(.fT1,.fT2) k fT1 m fT1=fT2 k fT2
 d Wait^%ZAPM.ed.BSXfun("освобождения от мусора и разрезка "_%FN)
 S %zT=$ZT,$ZT="ERFILE^%ZAPM.ed.BSF11"
 ;U DOS W "%BS-SCANINIG ",$G(say),!
 D fT2("%BS-SCANINIG "_$G(say))
 ;S ST="" F v=1:1 U DOSO  R I D  D:I'="" CUT(I) //I '(v#10) U 0 X $G(WA) /////Q:$ZC'=0
 S ST="",i="" F v=1:1 S i=$O(fT1(i)) Q:i=""  S I=fT1(i) D  D:I'="" CUT(I)
 .S I=$TR(I,CU(2),CU(4))
 .I $P(CU(14),"/",3)="Y" S I=$$Cut^%ZAPM.ed.BSF10(I)
 .I $P(CU(14),"/",2)="Y" S I=$$Cut^%ZAPM.ed.BSF10(I,1)
 .I I[CU(6),I'[CU(8) S I=$$TR^%ZAPM.ed.BSsFUNM(I,CU(6),CU(8))
 .I I[CU(10),I'[CU(12) S I=$$TR^%ZAPM.ed.BSsFUNM(I,CU(10),CU(12))
 .I $P(CU(14),"/",1)="Y" F M=1:1 Q:$E(I,M)=""  I $A($E(I,M))<32 S I=$E(I,1,M-1)_$E(I,M+1,$L(I))
 .I '$D(FIRST),I'[CU(12) S I=""
 .I '$D(FIRST),I[CU(12) S FIRST=1
STOPSCAN ;I $P(CU(14),"/",4)'="Y" S %FN=FN C DOSO,DOS G SCA
 ;C DOSO,DOS W /CUP(22,1) D EXE^%ZAPM.ed.BSDOS("COPY "_FN_" "_FNO,1) 
 ;W /CUP(22,1) D EXE^%ZAPM.ed.BSDOS("DEL "_FN,1)
SCA ;I $ZV["Cach"||($ZV["IRIS") C FN,FNO S %DEV=%FN G SCA2
 ;C %DEV F %DEV=$G(%Dev,51):1:54 O %DEV::0 Q:$T
 ;S DOS=%DEV
SCA2 ;I $$Open^%ZAPM.ed.BSXdos(%FN,"R")
 ;U %DEV R %IN
 S fT2=$O(fT2("")),%IN=$G(fT2(fT2)) 
 Q
fT2(S) S fT2=$G(fT2)+1,fT2(fT2)=S //ЗАПИСЬ В НОВЫЙ МАССИВ
 Q
fT1(fT2,fT1) n i s i="" F  S i=$O(fT2(i)) Q:i=""  I $G(fT2(i))'="" D  S fT1(i)=fT2(i) I $G(fT1)="" S fT1=i
 .I $E(fT2(i),$L(fT2(i)))="="!(fT2(i)["+++") Q  //выравнивание по =
 .N A,ii,AA S AA=fT2(i),A=$P(fT2(i),"=",$L(fT2(i),"=")),fT2(i)=$P(fT2(i),"=",1,$L(fT2(i),"=")-1)_"="
 .S ii=$O(fT2(i)) I ii="" S fT2(i)=AA Q
 .S fT2(ii)=A_$G(fT2(ii))
 q
ERFILE S $ZT=$G(%zT) I $ZE["<ENDOFFILE" G STOPSCAN
 D ErrMsg^%ZAPM.ed.BSXfun($ZE_" "_$$ErrSay^%ZAPM.ed.BSF8($ZE))
 Q
CUT(I) ;РАЗРЕЗКА
 I $L(ST_I)>4000 D CU(ST)
 S ST=ST_I I ST["=++" D CU(ST) D fT2($TR(ST,S1,S2)) S ST="" //U DOS W $TR(ST,S1,S2),! S ST=""
 Q
CU(S) N SS
 S SS=""
 F M=1:1 Q:$P(S,"=",M,M+1)=""  S SS=SS_$P(S,"=",M)_"=" I $L(SS)>74 D fT2($TR(SS,S1,S2)) S SS="" //U DOS W $TR(SS,S1,S2),! S SS=""
 S ST=SS
 Q
UNMARK(U) N I,J ;СНЯТЬ ПОМЕТКУ С ТАБЛИЦЫ
 F I=1:1 Q:$G(@U@(I,1))=""  F J=1:1 Q:$G(@U@(I,J))=""  S $P(@U@(I,J),"@",12)=""
 S $P(@U,"@",3)="" Q
TEMPFILE() ;ВРЕМЕННЫЙ ФАЙЛ
 Q "%BSTEMP.TMP"
RANDFILE() ;СЛУЧАЙНОЕ ИМЯ ФАЙЛА
 Q $R(10)_$R(10)_$R(10)_$R(10)_$R(10)_$R(10)_$R(10)_$R(10)_".TMP"
TMPG() ;СЛУЧАЙНАЯ ССЫЛКА ВРЕМЕННОГО МАССИВА
TMR N T S T=$NA(@"^%ZAPM.ed.BSbufB"@("TMP"_$TR($$RANDFILE(),".","")_$G(%BS(3),$P)_$J_"u1")) I $D(@T) G TMR
 Q T
MARK(U,M) N I,J,P ;ПОМЕТИТЬ ТАБЛИЦУ ПО ДАННЫМ В КЛЕТКАХ -->M
 S P=0 F I=1:1 Q:$G(@U@(I,1))=""  F J=1:1 Q:$G(@U@(I,J))=""  I $P(@U@(I,J),"@",15)'="",$D(@M@($P(@U@(I,J),"@",15))) S $P(@U@(I,J),"@",12)=1,P=P+1
 I 'P S $P(@U,"@",3)="" K %DIA Q
 S %DIA=1,$P(@U,"@",3)=P Q
STAT ;СТАТИСТИКА -=АС НЕФЕДОВ=-
 N (%BS) D SA^%ZAPM.ed.BSsBUF,^%ZAPM.ed.BSTAT,RE^%ZAPM.ed.BSsBUF
 Q
MENU ;ОБНОВЛЕНИЕ ВРЕМЕНИ В МЕНЮ
 Q:R1>332  I '$D(%BS(2,1)),$ZV'["Cach"&&($ZV'["IRIS") S %BS(2,1)=%BS(2),%BS(2)="1-D MENU^%ZAPM.ed.BST" Q
 I R1=13,R2=-1,R3=-1 D UNDOMENU Q
 I R1=27,R2=-1,R3=-1 D UNDOMENU
 Q
UNDOMENU I $D(%BS(2,1)) S %BS(2)=%BS(2,1) K %BS(2,1) Q
 D CLr^%ZAPM.ed.BSF4 Q
]]></Routine>


<Routine name="%ZAPM.ed.BSCocx" type="MAC" languagemode="0"><![CDATA[
%BSCocx ; пpогpамма связи с КОМПОНЕНТОЙ - КЛЮЧИ БАЗЫ ДАННЫХ ; 14:56   06.11.2001
 ;
 ; Copyright (c) Serge W. Mikhaylenko
 ; All Rights Reserved
 ;
 Q
ACCES(BSLOGIN,BSSES) D VARKEY1 //ОБЩИЕ ПРАВА ДОСТУПА
 Q aCC1
VARKEY  S BSPART=$$Normalize^%ZAPM.ed.BSCGIS($G(BSocxP0kD)),BSTABL=$G(BSocxP0kS),PT=$NA(@BSPART@(BSTABL))
 S BD=$$KBD^%ZAPM.ed.BSF12(PT),gB=$NA(@BDSES@(BSSES,"VAR","KEYS",PT))
 M K=@PT@("KEY")
 M KK=@gB
 S STEP=$G(STEP,2) //ШАГ ПРИ ДВИЖЕНИИ В КОЛОНКАХ
 S DEL=$C(1) //РАЗДЕЛИТЕЛЬ
 S DEL0=$C(0)
 S gBuf=$NA(@BDSES@(BSSES,"VAR","BUFF",BSPART,BSTABL))
 S gBuf1=$NA(@BDSES@(BSSES,"VAR","BUF1",BSPART,BSTABL))
 S gBufCurKey=$NA(@BDSES@(BSSES,"VAR","CurKey")) 
VARKEY1 S BDUSE=$$KBD^%ZAPM.ed.BSF12("^%ZAPM.ed.BSC4(""PROTECT"")")
 I '$D(BSLOGIN) S BSLOGIN=$G(@BDSES@(BSSES,"NM"),"?")
 D VARaCC^%ZAPM.ed.BSCAsIs
varBLOCK S BDBLOCK=$$KBD^%ZAPM.ed.BSF12("^[""FON""]AsI(""BLOCK"")") //БД БЛОКИРОВОК
 Q
HISTORY //ИСТОРИЯ КЛЮЧЕЙ
 n BSkeH,BSkeH1
 W "<div align='LEFT'><TABLE BORDER=0><TR>"_BK d  W "</TR></TABLE></div>"_BK_BK
 .n t,y,i,N S t="<TD>"_GREEN,y=EF_"</TD>",N=$O(KK(""),-1),BSLABEL="HKEY0^~BSCocx",BSkeH=$S(BSkeyN>0:$G(KK(0)),1:""),BSkeH1=0
 .w t_$$TITHIS_y_t_" <A HREF='"_$$ADDBSGET^%ZAPM.ed.BSC4()_"'>"_BSkeH_"</A> \ "_y_BK                                                                                                                                                                                                     ;$S(i=N:" \ )",1:",")
 .I N'="" S BSLABEL="HKEY0^~BSCocx" F i=1:1:N  Q:i=""  Q:i>(BSkeyN-1)  I $G(KK(i))'=""  S BSkeH=KK(i),BSkeH1=i W t_"<A HREF='"_$$ADDBSGET^%ZAPM.ed.BSC4()_"'>"_KK(i)_"</A> \ "_y_BK
 Q
TITHIS() N A S A=$P(@PT,"@",1) I A'="" Q A 
 Q "Ключи базы данных "_BD
HKEY0 D BEG1^%ZAPM.ed.BSC4 W $$TITL^%ZAPM.ed.BSCGIS("База Данных: раздела ("_$$Normalize^%ZAPM.ed.BSCGIS($G(BSocxP0kD))_") и таблицы ("_$G(BSocxP0kS)_")")
 W $$B27^%ZAPM.ed.BSCGIS S BSPART=$$Normalize^%ZAPM.ed.BSCGIS($G(BSocxP0kD)),BSTABL=$G(BSocxP0kS),PT=$NA(@BSPART@(BSTABL)),BSkeyN=BSkeH1
 ;w "<hr>"_$g(BSkeH,"?")_"<hr>"
 g KEYS  
BSkeyCu I '$D(@gBufCurKey@(BSkeyCu)) Q
 N BSkeyCu1
 S BSkeyCu1=$G(@gBufCurKey@(BSkeyCu))
 S BSkeyN=$L(BSkeyCu1,",")-1 D  //УЖЕ ВХОДИЛИ В КЛЮЧИ
 .K KK F i=1:1 Q:$P(BSkeyCu1,",",i,i+1)=""  S KK(i-1)=$P(BSkeyCu1,",",i),BSkeH=KK(i-1)
 Q
 //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
KEYS //ПОХОД ПО всем КЛЮЧАМ
 N K,KK,InsDel
 N BSTOP2,BSaX,BSLOGINDFLT
 D VARKEY i $O(K(""))="" W "Ключей нет" Q
 K @gBuf1
 I $G(BSkeyCu)'="",'$D(BSkeyN) D BSkeyCu
KEYS1 I $G(BSkeyN)="" D  //ПЕРВЫЙ ВХОД
 .I $D(K(0)) S BSkeyN=0 Q
 .E  S BSkeyN=1
 D HISTORY I '$D(K(BSkeyN)) Q
 I $G(BSFlagRecord)'="" w "<form action="""_$$ADDLIB^%ZAPM.ed.BSC4()_""" method=""POST"">" S BSLABEL="Packet^~BSCocx" D ADDBSPOST^%ZAPM.ed.BSC4reg
 W "<TABLE BORDER=0>"_BK d  W "</TABLE>"
 .n t,y,i,N
 .W "<TR><TD class=s4>Значения</TD><TD class=s4>ОПИСАНИЕ</TD><TD class=s3></TD></TR>"_BK
 .D
 ..I '$$ACCE(2)!($G(BSFlagRecord)'="") Q  //ВСТАВЛЯТЬ НЕЛЬЗЯ
 ..S BSLABEL="KEYNE^~BSCocx" W "<TR><TD class=s3></TD><TD class=s3><IMG BORDER=0 SRC='/b4y/img/ins.gif'><A HREF='"_$$ADDBSGET^%ZAPM.ed.BSC4()_"' TARGET='NEWKEY' title='Ввести новый ключ'>"_GREEN_$$NewKey(BSkeyN)_EF_"</A></TD><TD class=s3></TD></TR>"_BK
 .I $D(K(BSkeyN)) D KEYN(BSkeyN)
 W InsDel
 I $G(BSFlagRecord)'="" w "</form>"
 q
KEYN(KEY)  n sT,blockc,aProk,aProk1
 S InsDel=BK_$$js^%ZAPM.ed.BSCp_$$InsDel_$$jse^%ZAPM.ed.BSCp_BK
 I KEY=2 S aProk=$$GETOPT^%ZAPM.ed.BSC4cfgP("^[""FON""]AsI.PAR.OPT","aProk") I aProk S aProk1=$$GETOPT^%ZAPM.ed.BSC4cfgP("^[""FON""]AsI.PAR.OPT","aProk","O")
 I KEY D  G kk  //ИНДЕКСНЫЙ КЛЮЧ
 .D key(1)
 .S BSkey="" F kk=1:1 S BSkey=$O(@%NAm@(BSkey)) Q:BSkey=""  D
 ..d sT  W "<TR><TD class="_sT_">"_$$CHECKFLAG(kk)_"<A " D  W " ><IMG BORDER=0 SRC='"_$S(KEY=$O(K(""),-1):"/iss/img/list.gif",1:"/b4y/logo/open0.gif")_"'> "_BSkey_"</A></TD>" D TRAN(BSkey) W $$erase(0)_"</TR>"_BK
 ...I KEY=$O(K(""),-1) D  Q
 ....I '$$ACCE^%ZAPM.ed.BSCocx(3) W " TITLE='Раскрыть нельзя'" Q  ;W "У ВАС НЕТ ПРАВ РЕДАКТИРОВАТЬ ЗАПИСЬ"
 ....W "HREF=""javascript:Ins1('"_BSkey_"');"" TITLE='Редактировать'"
 ...I $G(BSFlagRecord)'="",'$D(K(BSkeyN+2)) Q  //РАСКРЫВАТЬ ДАЛЬШЕ НЕКУДА
 ...W "HREF=""javascript:Ins1('"_BSkey_"');"" TITLE='Раскрыть'"
 N M,GLL D CLO^%ZAPM.ed.BSCp,OPO^%ZAPM.ed.BSCp //ИМЕННОЙ КЛЮЧ
 S GLL=$P(BD,"]",2) F kk=1:1 S GLL=$$O^%ZAPM.ed.BSCp(GLL) Q:GLL=""  S M="^"_GLL I M[("^"_$P(BD,"]",2)),$P($G(@M),"@")="BSD - MSW" D
 .S BSkey=$E(GLL,$L(GLL)-1,$L(GLL)) d sT
 .W "<TR><TD class="_sT_"><A HREF=""javascript:Ins1('"_BSkey_"');"" TITLE='Раскрыть'><IMG BORDER=0 SRC='/b4y/logo/open1.gif'> "_BSkey_"</A></TD>" D TRAN(BSkey) W $$erase(0)_"</TR>"_BK
kk S sT="s3" W "<TR><TD class=s4>Количество узлов</TD><TD class=s4>"_(kk-1)_"</TD>"_$$erase(1)_"</TR>"
 Q
BLOCK() N Q,CH,BSref1 //БЛОКИРОВАТЬ\РАЗБЛОКИРОВАТЬ ЗАПИСЬ
 I $G(BDBLOCK)="" Q ""
 I BSkeyN'=2 Q ""
 I '$$ACCE^%ZAPM.ed.BSCocx(5) Q ""
 S BSref=$P($NA(@%NAm@(BSkey)),"AsIs",2)
 S CH=$$block(BSref)
 S Q="<input type=checkbox onclick=""open('"_$$ADDBSGET^%ZAPM.ed.BSC4(,"BLOCKON^~BSCocx")_"','','width=1,height=1');"" name=BLOCK "_$S(+CH:"CHECKED",1:"")_" title='БЛОКИРОВАТЬ\РАЗБЛОКИРОВАТЬ ЗАПИСЬ от РЕДАКТИРОВАНИЯ"_(BK_BK_$$BLOCKH($P(CH,"*",1)))_"'>"
 S BSref1=1,Q=Q_"<A HREF='' onclick='open("""_$$ADDBSGET^%ZAPM.ed.BSC4(,"BLOCKON^~BSCocx")_""",""Hist"",""toolbar=no,menubar=no,scrollbars=no,width=800,height=500,status=1,resizable=1"");' TITLE='история блокировок'>?</A>"
 Q Q
BLOCKH(CH) Q "BLOCK"_$P(CH,",",1,2)_","_$$TD^%ZAPM.ed.BSC4base($P(CH,",",3,4))
BLOCKON D VARKEY S CH=$$block(BSref)
 I '$G(BSref1) D  Q  //переключатель
 .S @BDBLOCK@($P(BSref,"."),$P($P(BSref,".",2),"("),$P($P(BSref,",",1),"(",2),$P($P(BSref,",",2),")",1),"BLK")=$S(+CH:"0",1:1)_","_BSLOGIN_","_$H_"*"_$E($G(@BDBLOCK@($P(BSref,"."),$P($P(BSref,".",2),"("),$P($P(BSref,",",1),"(",2),$P($P(BSref,",",2),")",1),"BLK")),1,32000)
 .W $$js^%ZAPM.ed.BSCp W "window.close();"_BK W $$jse^%ZAPM.ed.BSCp_BK
 D BEG1^%ZAPM.ed.BSC4 W $$TITL^%ZAPM.ed.BSCGIS("история блокировок для узла "_BSref),$$B27^%ZAPM.ed.BSCGIS(1)
 W "<H4>Блокировки действуют только для Excel-интерфейса и потокового ввода</H4>"
 F I=1:1 Q:$P(CH,"*",I,I+1)=""  W "<LI>"_$$BLOCKH($P(CH,"*",I))
 W "<HR>" D BUTT^%ZAPM.ed.BSCGIS,END^%ZAPM.ed.BSC4
 Q
sT s sT="s"_$S(BSkey=$G(BSkeH):"2",1:"1")
 q
stdflt() Q $g(sT,"s1")
R2L(S) Q $TR(S,"Б","B")
L2R(S) Q $TR(S,"B","Б")
CHECKFLAG(i) i $G(BSFlagRecord)="" Q ""
 N Q S Q="<input type=SUBMIT name=BSx"_$$R2L(BSkey)_" value='пакет' title='Запустить формирование пакета'>"
 i $G(aProk) S Q=Q_"<input type=SUBMIT name=BSprok value='прокачка' title='"_aProk1_"'>" ;K aProk
 S Q=Q_"<input type=checkbox name=BSz"_$$R2L(BSkey)_" value='' title='Включить в формирование пакета'>"
 Q Q
PaRec(G) //РЕКУРСИВ ПО УЗЛАМ
 N K1,GG S K1="" F  S K1=$O(@G@(K1)) Q:K1=""  S GG=$NA(@G@(K1)) D  ;W BBK_GG_"--"_$QL(GG) D
 .I KEYS=($QL(GG)+1) D BD2BUF1(GG,zip,KEYS) Q
 .D PaRec(GG)
 Q
ZIP() q $s($g(BSFlagRecord,2)=2:0,1:1) //НАДО ЛИ ПОДЖИМАТЬ СТРОКИ
Packet D VARKEY ;ФОРМИРОВАНИЕ ПАКЕТА
 N I,II,Y,X,i,ii,KEYS,%NAm1,PACKET,zip S Y=0,PACKET=1,zip=$$ZIP()
 N KKK
 D KODSET K @gBuf1
 ;I U1=3 
 S DEL=$C(9)
 S I="" F  S I=$O(%KEY(I)) Q:I=""  I $E(I,1,3)="BSx"!($E(I,1,3)="BSz") S KKK($$L2R($E(I,4,99)))=""
 I $G(BSprok)'=""  D Prok^%ZAPM.ed.BSCAsIs5(BD,.KKK) Q
 S I="" F  S I=$O(KKK(I)) Q:I=""  S KK(BSkeyN)=I D key(0) D
 .I KEYS>(BSkeyN+1) D PaRec(%NAm) Q
 .I KEYS=(BSkeyN+1) D BD2BUF1(%NAm,zip,KEYS) Q
 S $P(@gBuf1,DEL0,6)=U1 //ВИД КОДИФИКАТОРА В БОКОВИНЕ 3-4
 S $P(@gBuf1,DEL0,3)=Y //КОЛ-ВО СТРОК ВСЕГО В КОДИФИКАТОРЕ ИЛИ ВСЕЙ МАТРИЦЕ
 S $P(@gBuf1,DEL0,1)=DEL
 S $P(@gBuf1,DEL0,2)="...Пакет"
 I $G(BSkeyCu)'="" D
 .S @gBufCurKey@(BSkeyCu)=CKey //МАССИВ В БД СЕССИЙ ^BSSES(ActiveSheet.Name)=CurentKey
 .I $$EditCount(gBufCurKey,BSkeyCu,0) //ОБНУЛИТЬ СЧЕТЧИК РЕДАКТИРВАНИЙ
 W $$js^%ZAPM.ed.BSCp_BK
 W "status='Status :CloseWin:Report:"_$G(BSSES)_":"_$G(PT)_":"_$G(%NAm)_"'"_BK
 W $$jse^%ZAPM.ed.BSCp_BK
 ;D locvar^%ZAPM.ed.BSCh0("")
 Q
key(N) S %NAm=BD_$G(KK(0)),CKey=$G(KK(0))
 F ii=1:1:BSkeyN-N Q:'$D(KK(ii))  D
 .S %NAm=$NA(@%NAm@(KK(ii)))
 .S CKey=CKey_","_$G(KK(ii))
 Q
erase(BSocxM) //КНОПКА ДЛЯ УДАЛЕНИЯ УЗЛОВ
 I BSocxM=1,$G(blockc) G ee
 I BSkeyN=0&(BSocxM=1) G ee
 I '$$ACCE(BSocxM)!($G(BSFlagRecord)'="") G ee  //ЕСЛИ НЕ ПОЛОЖЕНО ТО НЕЛЬЗЯ
 I $$blockIS($NA(@%NAm@(BSkey))) S blockc=$G(blockc)+1 G ee  //ЗАБЛОКИРОВАН
 I '$D(aCC1) D VARKEY1
 i aCC1<4 g ee //удалять узлы нельзя
 N Q,BSLABEL 
 S Q="<TD class="_$$stdflt_"><A HREF=""javascript:Del1('"_$G(BSkey)_"','"_BSocxM_"','"_BSkeyN_"');"" title='"_$S(BSocxM=1:$$erase1,1:$$erase2)_"'><IMG SRC='"_BSDOMAIN_"/img/kill"_$S(BSocxM=1:"1",1:"")_".gif' BORDER=0></A>"
 q Q_"</TD>"
ee Q "<TD></TD>"
erase1() q "Удалить все ключи текущего уровня"
erase2() q "Удалить ключ со всеми потомками"
ERA //УДАЛИТЬ
 N K,KK  D VARKEY
 S KK(BSkeyN)=BSkey
 D key(BSocxM) 
 ;проверим на блокировку
 i $$block^%ZAPM.ed.BSCocx($P(%NAm,"AsIs",2))  W BLUE_"Узел блокирован !!!"_%NAm_EF_BBK I 1
 E  K @%NAm W RED_"Удалили узел "_%NAm_EF_BBK
 G HKEY0
 Q
InsDel() //МОДУЛИ - ВСТАВИТЬ-УДАЛИТЬ
 S BSLABEL="KEYNA^~BSCocx"
 N Q S Q="function Ins1(K) {"_BK D
 .N BSkey
 .S Q=Q_"location='"_$$ADDBSGET^%ZAPM.ed.BSC4()_"&BSkey='+ K;"_BK
 S Q=Q_"}"_BK
 S BSLABEL="ERA^~BSCocx"
 S Q=Q_"function Del1(K,KK,KKK) {"_BK D
 .N BSkey,BSkeH1
 .S Q=Q_"var s='"_$$erase2_"';"_BK
 .S Q=Q_"if (KK=='1') { s='"_$$erase1_"'; }"_BK
 .S Q=Q_"var a=prompt(s+' `'+K+'`! Удалить? Да=1, Нет=0','1');"_BK
 .S Q=Q_"if (a=='1') { location='"_$$ADDBSGET^%ZAPM.ed.BSC4()_"&BSkey='+ K + '&BSocxM='+ KK + '&BSkeH1='+ KKK; }"_BK
 S Q=Q_"}"_BK
 Q Q
ACCE(KOD) //ПРАВА ДОСТУПА
 ;KOD=1 - УДАЛЕНИЕ ВСЕХ УЗЛОВ НА УРОВНЕ
 ;KOD=0 - УДАЛЕНИЕ ОДНОГО УЗЛА
 ;KOD=2 - ВСТАВКА НОВЫХ УЗЛОВ
 ;KOD=3 - РЕДАКТИРОВАТЬ ЗАПИСЬ
 ;KOD=4 - РЕДАКТИРОВАТЬ КОНКРЕТНУЮ ЗАПИСЬ
 ;KOD=5 - РЕДАКТИРОВАТЬ ТОБД
 ;Может потом попозже сделать матрицу параметров с CHECKbox-ами в перекрестиях
 I '$D(aCC1) D VARKEY1
 i KOD=5,aCC1>4 Q 1
 i KOD=5,aCC1'>4 Q 0
 I aCC1<3 Q 0
 Q 1
NewKey(KEY) N A S A=$P(K(KEY),"@",5) I A'="" Q A
 Q "Ввести "_$S(BSkeyN:"",1:"Именной")_" новый ключ"
TRAN(D) W "<TD class="_$$stdflt_">" D  W $$BLOCK_"</TD>"
 .I D="" W ".." 
 .W $$TRANKEY(KEY,D)
 Q
TRANKEY(Ke,KDa) N d,d0,d1,nx,ny
 S (d,d1,d0)=KDa //ТРАНСФОРМАЦИЯ ДАННЫХ КЛЮЧЕЙ
 I 'Ke Q "Год"
 I $G(K(Ke,3))'="" S $ZT="ERTRA" D  S $ZT=$G(%zT)
 .I d0="" S d0=0
 .S ny=1,nx=1 X K(Ke,3)
 Q d1 
KEYNA //РЕДАКТИРОВАТЬ
 N K,KK  D VARKEY
 I $D(BSkey) D
 .S KK(BSkeyN)=BSkey
 .M @gB=KK
 S BSkeyN=BSkeyN+1
 I '$D(K(BSkeyN+1)) D  Q:$G(BSnoTABEL)=""  //КЛЮЧИ КОНЧИЛИСЬ
 .I $G(BSnoTABEL)'="" Q  //ЭТО НЕ ТАБЕЛЬ
 .D key(1),BD2BUF ;D locvar^%ZAPM.ed.BSCh0("",1) Q
 .S $P(@gBuf1,DEL0,1)=DEL
 .S $P(@gBuf1,DEL0,2)=CKey
 .I $G(BSkeyCu)'="" D
 ..S @gBufCurKey@(BSkeyCu)=CKey //МАССИВ В БД СЕССИЙ ^BSSES(ActiveSheet.Name)=CurentKey
 ..I $$EditCount(gBufCurKey,BSkeyCu,0) //ОБНУЛИТЬ СЧЕТЧИК РЕДАКТИРВАНИЙ
 .W $$js^%ZAPM.ed.BSCp_BK
 .W "status='Status :CloseWin:Report:"_$G(BSSES)_":"_$G(PT)_":"_$G(%NAm)_"'"_BK
 .W $$jse^%ZAPM.ed.BSCp_BK
 I $G(BSnoTABEL)'="",'$D(K(BSkeyN)) D EDIT^%ZAPM.ed.BSC4news S BSkeyN=BSkeyN-1 
 D VAR^%ZAPM.ed.BSCGIS //ЭТО НЕ ТАБЕЛЬ---ПРОДОЛЖЕНИЕ
 D BEG1^%ZAPM.ed.BSC4 W $$TITL^%ZAPM.ed.BSCGIS("Редактирование БД : раздела ("_$$Normalize^%ZAPM.ed.BSCGIS($G(BSocxP0kD))_") и таблицы ("_$G(BSocxP0kS)_")")
 W $$B27^%ZAPM.ed.BSCGIS
 D KEYS1 I $G(BSkeyCC)'="" D BUTT^%ZAPM.ed.BSCGIS
 Q
RETURNGR(BSSES,BSocxP0kD,BSocxP0kS) D MAINVAR^%ZAPM.ed.BSC4 //ВОЗВРАТИТЬ ССЫЛКУ НА МАТРИЦУ ЗНАЧЕНИЙ КЛЮЧЕЙ
 D VARKEY I '$D(@gBuf1) Q ""
 ZN P6
 f i=1:1:3 s P=$g(@PT@("KEYexcel",i)) D  //НОМЕРА СТРОК,КОЛОНОК...
 .s @("P"_(5+i))="" i $p(P,"-",3),($p(P,"-",2)[",") s @("P"_(5+i))=$p(P,"-",2)
 Q gBuf1
 //////////////////////////////////////////////////////////////////////////////////////////
BD2BUF //собрать данные из БД в буфер
 D KODSET K @gBuf1 ; D locvar^%ZAPM.ed.BSCh0("ky") Q
 I '$D(U1) Q
 I U1=3 S DEL=$C(9)
 S Y=0 
 D BD2BUF1(%NAm,$$ZIP(),BSkeyN)
 S $P(@gBuf1,DEL0,6)=U1 //ВИД КОДИФИКАТОРА В БОКОВИНЕ 3-4
 S $P(@gBuf1,DEL0,3)=Y //КОЛ-ВО СТРОК ВСЕГО В КОДИФИКАТОРЕ ИЛИ ВСЕЙ МАТРИЦЕ
 S $P(@gBuf1,DEL0,4)=ky(BSkeyN,1) //КОЛОНКА ГДЕ ЛЕЖИТ TXT
 S $P(@gBuf1,DEL0,7)=$$blockIS(%NAm) //заблокированна ли эта ссылка от коррекции
 Q
block(BSref) i '$d(BDBLOCK) D varBLOCK
 q:$P(BSref,".")="" "" q:$P($P(BSref,".",2),"(")="" "" q:$P($P(BSref,",",1),"(",2)="" "" q:$P($P(BSref,",",2),")",1)="" ""
 Q $G(@BDBLOCK@($P(BSref,"."),$P($P(BSref,".",2),"("),$P($P(BSref,",",1),"(",2),$P($P(BSref,",",2),")",1),"BLK"))
blockIS(G) N BSref,I,STOP I $G(BDBLOCK)="" Q 0
 I $QS(G,2)'="" S BSref=$P($P(G,"AsIs",2),"(")_"("_$QS(G,1)_","_$QS(G,2)_")" Q +$$block(BSref)
 I $QL(G)=1,$QS(G,1)'="" S I="" F  S I=$O(@G@(I)) Q:I=""  S BSref=$P($P(G,"AsIs",2),"(")_"("_$QS(G,1)_","_I_")" I +$$block(BSref) S STOP=1 Q
 Q +$g(STOP)
BD2BUF1(%NAm,ZIP,BSkeyN) N I,II,X,i,ii,d1
 S I="" F  S I=$O(@KODS@(U1,I)) Q:I=""  S Y=Y+1 D
 .S ID1=$S(U1=1:I,1:$P(@KODS@(U1,I),DEL0,1))
 .D  ;I U1=3 d  //U1=3 КОДИФИКАТОР    U1=4 ЭТО ПРЕДМЕТНАЯ БОКОВИНА
 ..f i=1:1:BSkeyN-1 i $d(ky(i)) S $P(@gBuf1@(Y),DEL,ky(i))=$QS(%NAm,i) ;$p(CKey,",",i+1)
 ..//А ЭТО РАСШИФРОВКА КОДА
 ..;I U1=3,$G(ky(BSkeyN,1)) S $P(@gBuf1@(Y),DEL,ky(BSkeyN,1))=$s(KODS["]AsIKodNVC":$P($G(@KODS@(1,ID1)),"~",1)_" "_$P($G(@KODS@(1,ID1)),"~",2),1:$G(@KODS@(1,ID1))) //TXT
 ..D
 ...I '$D(PACKET),U1=4 Q
 ...I $G(ky(BSkeyN,1)) S $P(@gBuf1@(Y),DEL,ky(BSkeyN,1))=$s(KODS["]AsIKodNVC":$P($G(@KODS@(1,ID1)),"~",1)_" "_$P($G(@KODS@(1,ID1)),"~",2),1:$G(@KODS@(1,ID1))) //TXT
 ...S $P(@gBuf1@(Y),DEL,ky(BSkeyN))=ID1 //КОД
 .;S X=$S(U1'=3:2,1:$p(BSkeyCC,",",2)-1)
 . S X=$p(BSkeyCC,",",2)-1
 .S II="",d1=0 F  S II=$O(@KODL@(U2,II)) Q:II=""   D
 ..S ID2=$S(U2=4:$P(@KODL@(U2,II),DEL0,1),1:II),X=X+1
 ..S d=$G(@%NAm@(ID1,ID2)) I d'="" S d1=d1+1
 ..S $P(@gBuf1@(Y),DEL,X)=d
 .I ZIP i 'd1 K @gBuf1@(Y) S Y=Y-1 //ЕСЛИ ВКЛ ПОДЖАТИЕ И ПУСТАЯ СТРОКА
 ;.s $P(@gBuf1@(Y),DEL,10)=ZIP
 S $P(@gBuf1,DEL0,4)=ky(BSkeyN,1) //КОЛОНКА ГДЕ ЛЕЖИТ TXT
 Q
KODSET S KEYS=$O(K(""),-1) I '$D(@PT@("KEYexcel")) Q
 S KODS=@PT@("KEYexcel",KEYS,1) //КОДИФИКАТОРЫ
 S KODL=@PT@("KEYexcel",KEYS+1,1)
 f U1=4,3,1 I $D(@KODS@(U1)) Q
 f U2=4,3,1 I $D(@KODL@(U2)) Q
 N i,ii //ky(i,1) ГДЕ И КАК ВЫВОДИТЬ КЛЮЧИ
 K ky F i=1:1:KEYS S ii=@PT@("KEYexcel",i),ky(i)=$P($P(ii,"^",2),",",2) D
 .I $P($P(ii,"^",2),",",1)=1,$P(ii,"-",2)'["," D
 ..S ky(i,1)=$P($P(ii,"-",2),":",1) I ky(i,1)="" S ky(i,1)=ky(i)
 Q
EditCount(GB,ASName,C)
 I $D(C) D
 .I C=0 S @GB@(ASName,"EditCount")=C Q
 .S @GB@(ASName,"EditCount")=$G(@GB@(ASName,"EditCount"))+C
 Q $G(@GB@(ASName,"EditCount"))
INV(KD,%2,%3) //ИНВЕРТИРОВАННЫЕ МАССИВЫ
	N i2 I $D(@KD@(1)) D  Q 1
	.S i2="" 
	.i '$d(@KD@(3)) F  S i2=$O(@KD@(1,i2)) Q:i2=""  W "<OPTION VALUE="_i2_">"_i2_" ==="_$P($G(@KD@(1,i2)),"~",1,2)_"</OPTION>"
	.i $d(@KD@(3)) s DEL=$g(@KD@(3),$c(0)) F  S i2=$O(@KD@(3,i2)) Q:i2=""  W "<OPTION VALUE="_$P($G(@KD@(3,i2)),DEL,1)_">"_$P($G(@KD@(3,i2)),DEL,1)_" ==="_$P($G(@KD@(3,i2)),DEL,2,99)_"</OPTION>"
	Q KD
inv S $ZT="inverr"	X "S i1="_i2	Q
inverr W "<OPTION VALUE=''>Error="_$ZE_"</OPTION>" Q
LISTKEY //СПИСОК КЛЮЧЕЙ
	N i1,i2
	;W "<BUTTON onclick='alert(11);' title='Выбрать из списка'><IMG SRC='"_BSDOMAIN_"/img/tabl.gif'></BUTTON>"
	W "<SELECT NAME=BSKeY"_ii_" " d  w "><OPTION></OPTION>"_BK
	.;w "size=1 onclick=""javascript: {if (''!=BSKeY"_ii_".value & 'undefined'!=BSKeY"_ii_".value) NK"_ii_".value=BSKeY"_ii_".value;}"" "
	I ii=0,$P(K(ii),"@",5)["ГОД" F i1=1:1:6 S i2="0"_i1 W "<OPTION VALUE="_i2_">"_i2_"</OPTION>"
	I ii=1,$P(K(ii),"@",5)["ДАТ" S i2=20040128 W "<OPTION VALUE="_i2_">"_i2_"</OPTION>"
	S i2=$G(K(ii,2)) I i2["$$INV" D inv I '$G(i1) W "<OPTION VALUE=''>NoMass="_i1_"</OPTION>"
	W "</SELECT>"_BK
	Q
KEYNE //НОВЫЙ КЛЮЧ
 N K,KK D VARKEY,BEG1^%ZAPM.ed.BSC4 W $$TITL^%ZAPM.ed.BSCGIS("Ввод новых ключей. Для Раздела ("_$$Normalize^%ZAPM.ed.BSCGIS($G(BSocxP0kD))_") и таблицы ("_$G(BSocxP0kS)_")") W $$B27^%ZAPM.ed.BSCm4
 W "<form name='NEWK1' action="""_$$ADDLIB^%ZAPM.ed.BSC4()_""" method=""POST"">"
 N BSLABEL,BSTOP,BSNSP1,FirstNam
 S BSLABEL="SAVEKEY^~BSCocx"
 D ADDBSPOST^%ZAPM.ed.BSC4reg
 W BK_"<TABLE BORDER=0>"_BK d  W "</TABLE>"
 .F ii=0:1:BSkeyN-1 I $G(KK(ii))'="" W "<TR><TD class=s3>"_ii_"</TD><TD class=s3>"_$P(K(ii),"@",9)_"</TD><TD class=s3>"_GREEN_$G(KK(ii))_EF_"</TD></TR>"_BK
 .N x1 S x1=$S($G(BSnoTABEL)="":1,1:0)
 .F ii=BSkeyN:1:($O(K(""),-1)-x1) D  //I $P(K(ii),"@",6)'="HiddenLastKey" d
 ..W "<TR><TD class=s3>"_ii_"</TD><TD class=s3>"_$P(K(ii),"@",5)_"</A></TD><TD class=s3><input type=text size=20 maxlength=48 name='NK"_ii_"' value=''>"
 ..D LISTKEY
 ..W "</TD></TR>"_BK
 W "</TABLE>"
 W "<HR>" D BU2^%ZAPM.ed.BSC4cfgP W "</FORM>"_BK
 Q
SAVEKEY //СОХРАНИТЬ НОВЫЕ КЛЮЧИ
 N K,KK,NKK D VARKEY
 M NNK=KK ;D locvar^%ZAPM.ed.BSCh0("KK,NNK")
 F ii=0:1:$O(K(""),-1) d
 .I $G(@("BSKeY"_ii))'="" S NNK(ii)=$G(@("BSKeY"_ii))
 .I $G(@("NK"_ii))'="" S NNK(ii)=$G(@("NK"_ii))
 s A=$$CHECKEY(.NNK) I A'="" D   G KEYNE
 .w RED_A_EF
 I '$D(@%NAm) S @%NAm=$$h^%ZAPM.ed.BS3()_","_$G(BSLOGIN)_",#,"_$$h^%ZAPM.ed.BS3(),A=$QS(%NAm,0) I $P($G(@A),"@")'["BSD - MSW" S @A="BSD - MSW"
 S BSkeH1=BSkeyN,BSkeH=NNK(BSkeH1) ;W BSkeH1,NNK(BSkeH1) G KEYNE
 N BSkeyN
 d  ;ОБНОВИТЬ РОДИТЕЛЬСКИЙ ФРЭЙМ 
 .W $$js^%ZAPM.ed.BSCp_BK s BSLABEL="HKEY0^~BSCocx"
 .W "opener.location='"_$$ADDBSGET^%ZAPM.ed.BSC4()_"';"_BK
 .W "window.close();"_BK
 .W $$jse^%ZAPM.ed.BSCp_BK
 Q
CHECKEY(KK) N Q S Q=""  //ПРОВЕКА КЛЮЧЕЙ НА ВАЛИДНОСТЬ
 N N,ii,BSkeyN,GOD S BSkeyN=$O(K(""),-1) 
 F ii=0:1:BSkeyN D
 .Q:'$D(KK(ii))  I $G(KK(ii))="" S Q=Q_BBK_ii_" Ключ. Пустое значение у ключа" Q
 .I ii=1,KK(ii)'="" S GOD=KK(ii)
 .N ls,%0,YES
 .S %0=$$CHECKEYRTR(ii,KK(ii)) 
 .I 'YES S Q=ii_" Ключ. Ошибка : "_$G(ls) Q //СИНТАКСИЧЕСКИЙ КОНТРОЛЬ
 .I $G(BSnoTABEL)="",ii=2,$E(%0,1,4)'=GOD S Q=ii_" Ключ. Ошибка НЕСООТВЕТВИЕ ДАТЫ ГОДУ "
 .S KK(ii)=%0
 I Q="" D key(0)
 Q Q
CHECKEYRTR(Ke,KDa) N d,d0,d1,nx,ny S (d,d1,d0)=KDa,ls="",YES=1 //ТРАНСФОРМАЦИЯ ДАННЫХ КЛЮЧЕЙ
 I $G(K(Ke,1))="" Q d
 S $ZT="ERTRA"
 I d0="" S d0=0
 S ny=1,nx=1 X K(Ke,1) I YES S ls=""
 Q d1
 /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
FCount N A,ny,nx,L,FErr,Log //ВЫЧИСЛЕНИЯ
 D SETL("FCL")
 S ny=R1-1,FErr=0  F  S ny=$O(@G@(ny)) Q:ny=""  D
 .N A F nx=1:1:C2-C1+1 I $P($G(@G@(ny)),DEL0,nx)'="" S A=1
 .I $G(A) S nx="" F  S nx=$O(L(nx)) Q:nx=""  D FCouD(ny,nx)
 I FErr,$D(Log) M @BDSES@(BSSES,"VAR","ERR","COU")=Log s P5=P5+FErr
 Q
FCouD(ny,nx) N d1 S $ZT="FCountE^%ZAPM.ed.BSCocx"
 X L(nx)  S:d1["." d1=$TR($FN(d1,"P",2)," ","") S $P(@G@(ny),DEL0,nx-C1+1)=d1
 Q
FCountE ;I $ZE["<DIVIDE>" Q  //МОЖЕТ ПОКА ТАК!
 N A,AA S FErr=FErr+1,Log(ny,nx,"ER")=$$TRa^%ZAPM.ed.BSCh0($ZE)
 I $ZE["<DIVIDE>" S Log(ny,nx,"ER")=Log(ny,nx,"ER")_" !!! Деление на нуль !!!" D
 .S Log(ny,nx,1)=L(nx,1) ;,Log(ny,nx,2)=L(nx,2)
 .S A="S AA="""_$$TR^%ZAPM.ed.BSsFUNM($$TR^%ZAPM.ed.BSsFUNM(L(nx,2),"{","{""_$$A^%ZAPM.ed.BSCocx("),"}",")_""}")_""""  //ПОДСТАВИТЬ ТЕКУЩИЕ ЗНАЧЕНИЯ
 .X A I AA["{}/{}"!(AA["{0}/{0}")!(AA["{0}/{}")!(AA["{}/{0}") K Log(ny,nx) S FErr=FErr-1 Q  //НЕ СЧИТАЕТСЯ ОШИБКОЙ
 .S Log(ny,nx,2)=AA
 Q
 ////////////////////////////////////////////////////////////////////////////////////////////
FLogE S FErr=FErr+1,Log(ny,nx,"ER")=$$TRa^%ZAPM.ed.BSCh0($ZE)  //ЛОГ КОНТРОЛЬ
 Q
FLogD(ny,nx) N A,AA S $ZT="FLogE^%ZAPM.ed.BSCocx"
 X L(nx) E  S FErr=FErr+1 D
 .S Log(ny,nx,1)=L(nx,1)
 .S A="S AA="""_$$TR^%ZAPM.ed.BSsFUNM($$TR^%ZAPM.ed.BSsFUNM(L(nx,2),"{","{""_$$A^%ZAPM.ed.BSCocx("),"}",")_""}")_""""  //ПОДСТАВИТЬ ТЕКУЩИЕ ЗНАЧЕНИЯ
 .X A S Log(ny,nx,2)=AA
 Q
FLogErr() N A,ny,nx,L,FErr,Log S Log="Ошибки ЛОГИЧЕСКОГО КОНТРОЛЯ"_BK_BK,FLogErr=0
 D SETL("COL")
 S ny=R1-1,FErr=0  F  S ny=$O(@G@(ny)) Q:ny=""  D
 .N A F nx=1:1:C2-C1+1 I $P($G(@G@(ny)),DEL0,nx)'="" S A=1
 .I $G(A) S nx="" F  S nx=$O(L(nx)) Q:nx=""  D FLogD(ny,nx)
 I FErr M @BDSES@(BSSES,"VAR","ERR","LOG")=Log
 Q FErr
SETL(F)  S ny="",UGX=$P($P(RCYXSS,"-",2),",",2),UGY=$P($P(RCYXSS,"-",2),",",1)
  F  S ny=$O(@BSR@(BST,F,ny)) Q:ny=""  S nx=""  D  Q
  .F  S nx=$O(@BSR@(BST,F,ny,nx)) Q:nx=""  D
  ..I $G(@BSR@(BST,F,ny,nx,5)) D
  ...N XX S XX=@BSR@(BST,F,ny,nx,5)
  ...S L(XX)=$$TR^%ZAPM.ed.BSsFUNM($G(@BSR@(BST,F,ny,nx,3)),"$$A^%ZAPM.ed.BSA(","$$A^%ZAPM.ed.BSCocx(") //ФОРМУЛЫ НА ЛЮБУЮ СТРОКУ
  ...S L(XX,1)=$G(@BSR@(BST,F,ny,nx,1))
  ...S L(XX,2)=$G(@BSR@(BST,F,ny,nx,4))
 Q
A(ny,nx) Q $TR($P($G(@G@(ny)),DEL0,nx-C1+1),",",".") //ДЛЯ ПЕРЕВЫЧИСЛЕНИЯ
Buf2bd(BSSES,BSLOGIN,G,BSocxP0kD,BSocxP0kS,DEL0,RCYXSS,BSkeyCu,BSNSP,LOGFLAG) //СОХРАНИТЬ ИЗ БУФЕРА В БД
 D MAINVAR^%ZAPM.ed.BSC4
 D VARKEY 
 K @gBuf1,@gBuf,KK D BSkeyCu I '$D(KK) Q "НЕТ БУФЕРА ТЕКУЩИХ КЛЮЧЕЙ!"
 S BSR=BSPART,BST=BSTABL
 S C1=$P($P(RCYXSS,"-",1),",",2),C2=$P($P(RCYXSS,"-",1),",",4),R1=$P($P(RCYXSS,"-",1),",",1),R2=$P($P(RCYXSS,"-",1),",",3)
 S BSkeyN=BSkeyN+1,Korr=0
 D key(1) D KODSET K @BDSES@(BSSES,"VAR","ERR")
 S P5=0 I $D(@BSR@(BST,"FCL")) D FCount ;I P5 Q P5 //ВЫЧ
 I LOGFLAG I $D(@BSR@(BST,"COL")) S ErrLog=$$FLogErr I ErrLog S P5=ErrLog Q "Всего ошибок "_ErrLog //ЛОГ
 S I="",R=R1 F  S I=$O(@KODS@(U1,I)) Q:I=""  D
 .S ID1=$S(U1=1:I,1:$P(@KODS@(U1,I),DEL0,1))
 .S C=0
 .S II="" F  S II=$O(@KODL@(U2,II)) Q:II=""   D
 ..S ID2=$S(U2=4:$P(@KODL@(U2,II),DEL0,1),1:II),C=C+1
 ..S d=$P($G(@G@(R)),DEL0,C)
 ..I d'="",$G(@%NAm@(ID1,ID2))'=d S @%NAm@(ID1,ID2)=d,Korr=Korr+1 
 ..I d="",$G(@%NAm@(ID1,ID2))'="" K @$ZR S Korr=Korr+1
 .S R=R+1
 D FLAG^%ZAPM.ed.BSF(%NAm,"?",BSLOGIN)
 I $$EditCount(gBufCurKey,BSkeyCu,0) //ОБНУЛИТЬ СЧЕТЧИК РЕДАКТИРВАНИЙ
 Q "Записано. "_Korr_" Испавлений."
OLDVALUE(r1,c1) //ВОЗВРАТИТЬ СТАРОЕ ЗНАЧЕНИЕ
 K @gBuf1,@gBuf,KK S BSkeyCu=ASName
 D BSkeyCu I '$D(KK) Q "НЕТ БУФЕРА ТЕКУЩИХ КЛЮЧЕЙ!"
 S C1=$P($P(RCYXSS,"-",1),",",2),C2=$P($P(RCYXSS,"-",1),",",4),R1=$P($P(RCYXSS,"-",1),",",1),R2=$P($P(RCYXSS,"-",1),",",3)
 S BSkeyN=BSkeyN+1,BD=$$KBD^%ZAPM.ed.BSF12(PT) ;Q BD ;+1 ;Q KK(3)
 D key(1) M K=@PT@("KEY") ;Q ","_K_","
 D KODSET K d ;Q %NAm ;"?"  ;U1","_U2
 S I="",R=R1 F  S I=$O(@KODS@(U1,I)) Q:I=""  D  Q:$D(d)
 .S ID1=$S(U1=1:I,1:$P(@KODS@(U1,I),DEL0,1))
 .S C=C1-1
 .S II="" F  S II=$O(@KODL@(U2,II)) Q:II=""   D  Q:$D(d)
 ..S ID2=$S(U2=4:$P(@KODL@(U2,II),DEL0,1),1:II),C=C+1
 ..I R=r1,C=c1 S d=$G(@%NAm@(ID1,ID2)) Q  ;,d=ID1_","_ID2 Q
 .Q:$D(d)
 .S R=R+1 
 Q $G(d)
Y1(r1) ;Q (r1-$P($P(RCYXSS,"-",1),",",1))*$P(RCYXSS,"-",4)+$P($P(RCYXSS,"-",2),",",1)
 Q $P($P(RCYXSS,"-",2),",",1)
X1(c1) Q (c1-$P($P(RCYXSS,"-",1),",",2))*$P(RCYXSS,"-",3)+$P($P(RCYXSS,"-",2),",",2)
 // СИНТАКСИЧЕСКИЙ КОНТРОЛЬ
ReturnSNX(BSSES,BSocxP0kD,BSocxP0kS,BSNSP,r1,c1,RCYXSS,li,ASName,BSLOGIN) //СИНТАКСИЧЕСКИЙ КОНТРОЛЬ
 D MAINVAR^%ZAPM.ed.BSC4
 D VARKEY S BSR=BSPART,BST=BSTABL
 I $$ZU^%ZAPM.ed.BSF4(BSNSP)="" Q "Ошибка доступа к рабочей области "_BSNSP 
 I aCC1<3 S P2=$$OLDVALUE(r1,c1) Q "Пользователь `"_BSLOGIN_"` редактировать не имеет право"
 S nx=$$X1(c1)
 S ny=$$Y1(r1) ;Q ny_","_nx
 I '$D(@BSR@(BST,ny,nx)) Q "Нет узла "_$ZR
 I $P(@BSR@(BST,ny,nx),"@",9)<2 Q 1
 I $$EditCount(gBufCurKey,ASName,1)
 S BS=$G(@BSR@(BST,ny,nx)),YES=$$RTR(BS,BSR,BST,.li,ny,nx) I 'YES S P2=$$OLDVALUE(r1,c1) ;СТАРОЕ ЗНАЧЕНИЕ
 S P9=li //А ЭТО НОВОЕ ТРАНСФОРМИРОВАННОЕ ЗНАЧЕНИЕ
 Q YES
RTR(BS,BSR,BST,li,ny,nx) N %0,YES,ls,BD S YES=1 D  S P1=$G(ls) Q YES
 .I li="" S YES=1 Q
 .I $P(BS,"@",16)'="" K %0 S $ZT="ERTRA",YES=1,(d,d0)=li K ls D  S:YES li=$G(d,li) I 'YES S ls=$G(ls,"СИНТАКСИЧЕСКАЯ ОШИБКА ") Q
 ..I '$P(BS,"@",16) X $G(@BSR@(BST,"RTR",ny,nx)) S $ZT=$G(%zT) Q
 ..X $G(@(BSR_"(BST,""RTR"","_$P(BS,"@",16)_")")) S $ZT=$G(%zT)
 .I li["@" S ls=" Запрещенный Символ @ " Q
ERTRA Q $ZE
 
]]></Routine>


<Routine name="%ZAPM.ed.BSCp" type="MAC" languagemode="0"><![CDATA[
%BSCp ;СИСТЕМНЫЕ "ПРИМИТИВЫ" Cache' ; 13:32   21.07.2005
 ;
 ; Copyright (c) Serge W. Mikhaylenko
 ; All Rights Reserved
 ;
 Q
clone ;сделать суперюзера  m m
 m ^%ZAPM.ed.BScPROT("m")=^%ZAPM.ed.BScPROT("B4I")
 s ^%ZAPM.ed.BScPROT("m","PSW")="m"
 q
VerTelnet() //версия телнет
 i $$ZV^%ZAPM.ed.BSCp>2008 q ""
 i $$ZV^%ZAPM.ed.BSCp>5 q "RU"
 q ""
DelUser(u,sess) //удалить временного пользователя Каши для v.5.2
 i $$ZV<2000 q
 n x,e,%objlasterror,ons
 s ons=$zu(5) zn "%sys"
 s x=##Class(Security.Users).Delete("IpUser"_$p(sess,".",1))
 zn ons
 q
CreateUser(u,sess) //создать временного пользователя Каши для v.5.2
 i $$ZV<2000 q
 n x,e,%objlasterror,ons
 s ons=$zu(5) zn "%sys"
 s x=##Class(Security.Users).Create("IpUser"_$p(sess,".",1),"%All",$p(sess,".",2),"Временный пользователь ИнфоПортала ("_u_") Сессия: "_sess_" Создан:"_$$TD^%ZAPM.ed.BSC4base($H),"%SYS") //,ASU,"^%ZAPM.ed.BSC")
 ;D DecomposeStatus^%apiOBJ(%objlasterror,.e) zw e
 zn ons
 q
Unicode() q $e($G(^%SYS("LOCALE","CURRENT"),"enu8"),4)="w"
CFGSN() //ИМЯ СЕРВЕРА ТЕКУЩЕЙ КОНФИГУРАЦИИ
 Q $G(^%ZAPM.ed.BS("Config","Server"))
CFG() //ИМЯ ТЕКУЩЕЙ КОНФИГУРАЦИИ ПОРТАЛА
 Q $G(^%ZAPM.ed.BS("Config"))
ZV() //НОМЕР ВЕРСИИ КАШИ
 Q $P($P($ZV," (Build",1),") ",2)
 N I F I=1:1 Q:$P($ZV," ",I)?1N1"."1N.E
 ;Q "5.1"
 Q $P($ZV," ",I)
TR(S,A,B) //REPLACE
 Q $$TR^%ZAPM.ed.BSsFUNM(S,A,B)
TL //TRAP LOC VAR
 D locvar^%ZAPM.ed.BSCh0("",1)
 Q
DOEVENTS //PAUSE
    i $f($zv,"2.") d  q
    .i $$InVB^%mvb d DoEvents^%mvb
    i $$InVB^%CDSrv d DoEvents^%CDSrv
   q
CacheSysDir(ADD) //ДОМАШНИЙ КАТАЛОГ СУБД
 N tmp S tmp=$ZU(86)
 I $ZV["Windows" Q $P(tmp,"\",1,$L(tmp,"\")-1)_$G(ADD)
 Q $P(tmp,"/",1,$L(tmp,"/")-1)_$TR($G(ADD),"\","/") ;ДЛЯ UNIX
Exec I $D(PutJSEx) Q  //УЖЕ ВЫВОДИЛИ
 w BK,BK ;AsysEInoActivX
 D JS
 W "function Exec(R,P,D) {"_BK
 ;w "alert(P);"_BK
 w "status='Status :Exec:*'+R+'*'+P+'*'+D+'*';"_BK  ;R=Path\\Prog.exe  R="parametrs in command line"  D=/directory/run
 ;i $G(@BDSES@(BSSES,"VAR","DirRun"))'="" 
 w "status='Ждите, программа запускается...';"_BK
 ;e  w "status='"_$ZR_" Ошибка запуска ! Клиет ИП должен был загружен программой WebView.exe';"_BK
 W "}"_BK S PutJSEx=1
 D JSE W BK,BK
 q
ExecTel I $D(PutJSExTel) Q  //УЖЕ ВЫВОДИЛИ
 w BK,BK ;AsysEInoActivX
 D JS
 W "function ExecTel(NS,PART,TABL,TITLE) {"_BK
  N A,FTerm,TelPort,R
 S FTerm=$$FTerm^%ZAPM.ed.BSCmDDR
 I FTerm=1 D
 .S R="BSCacheTel.exe"
 .//S A=$P($$ADDSN^%ZAPM.ed.BSC4,":")_" /s="_BSLOGIN_" /i="_BSSES_" /p="_$$PortTerm^%ZAPM.ed.BSCp2_" /t="_TABL_" /n="_NS_" /y=1 /v="_$$VerTelnet^%ZAPM.ed.BSCp_" /x="_PART_" /f="_$$nse^%ZAPM.ed.BSCmDDR_TITLE
 .W "var Par='"_$P($$ADDSN^%ZAPM.ed.BSC4,":")_" /s="_BSLOGIN_" /i="_BSSES_" /p="_$$PortTerm^%ZAPM.ed.BSCp2_" /t='+TABL+' /n='+NS+' /v="_$$VerTelnet^%ZAPM.ed.BSCp_" /y=1 /x='+PART+' /f="_$$nse^%ZAPM.ed.BSCmDDR_"'+TITLE;"_BK
 .;W "prompt('Вот она!',Par);"_BK 
 I FTerm=2 D
 .S R="AdvSockTerm.exe"
 .W "var cmdline='D BST^%ZAPM.ed.BSC(""""'+NS+'"""",""""'+PART+'"""",""""'+TABL+'"""",""""1"""","""""""","""""_BSLOGIN_""""","""""_BSSES_""""")'; "_BK
 .//W "prompt('Вот она!',cmdline);"_BK
 .w "var Par='server="""_$P($$ADDSN^%ZAPM.ed.BSC4,":")_""" port="""_$$PortTerm^%ZAPM.ed.BSCp2_""" user=""SYS"" psw=""XXX"" cmdline=""'+cmdline+'"" title="""_$$nse^%ZAPM.ed.BSCmDDR_"'+TITLE+'""' ;"_BK
 .//W "prompt('Вот она!',Par);"_BK
 ;w "alert(Par);"_BK
 w "status='Status :Exec:*"_R_"*'+Par+'*"_$$DirClientIP^%ZAPM.ed.BSCp2_"*';"_BK  ;R=Path\\Prog.exe  R="parametrs in command line"  D=/directory/run
 w "status='Ждите, программа запускается...';"_BK
 W "}"_BK S PutJSExTel=1
 D JSE W BK,BK
 q
 /*
  I FTerm=1 D
 .W "var cmdline='"_$P($$ADDSN^%ZAPM.ed.BSC4,":")_" /s="_BSLOGIN_" /i="_BSSES_" /p="_$G(tcpPORT,$G(TelPort,23))_" /t='+TABL+' /n='+NS+' /v="_$$VerTelnet^%ZAPM.ed.BSCp_" /y=1 /x='+PART+' /f="_$$nse^%ZAPM.ed.BSCmDDR_"'+TITLE;"_BK
 .;W "prompt('Вот она!',cmdline);"_BK 
 .//BSCacheTel.exe 190.98.101.61 /s=Styx /i=124 /t=$ /n=1 /y=1 /x=$ /f=(mswdell)_BS+TELNET
 .//D BST^%ZAPM.ed.BSC("1","$","$","1","","Styx","124")<13><10>
 .;////OLD////  w "parent."_$G(rd1,"rd1.")_"RDos.Command='BSCacheTel.exe "_$P($$ADDSN^%ZAPM.ed.BSC4,":")_" /s="_BSLOGIN_" /i="_BSSES_" /t='+TABL+' /n='+NS+' /y=1 /x='+PART+' /f="_$$nse_"'+TITLE;"_BK
 .I '$G(Ext) w "parent."_$G(rd1,"rd1.")_"RDos.Command='BSCacheTel.exe '+cmdline;"_BK Q
 .w "var Rou='BSCacheTel.exe';"_BK
 .w "var Par=cmdline;"_BK
 .w "var Dir='"_$G(WorkDir)_"';"_BK
 .w "status='Status :Exec:*'+Rou+'*'+Par+'*'+Dir+'*';"_BK
 .w "status='Ждите, программа запускается...';"_BK
 I FTerm=2 D
 .W "var cmdline='D BST^%ZAPM.ed.BSC(""""'+NS+'"""",""""'+PART+'"""",""""'+TABL+'"""",""""1"""","""""""","""""_BSLOGIN_""""","""""_BSSES_""""")'; "_BK
 .;W "prompt('Вот она!',cmdline);"_BK
 .I '$G(Ext) w "parent."_$G(rd1,"rd1.")_"RDos.Command='AdvSockTerm.exe server="""_$P($$ADDSN^%ZAPM.ed.BSC4,":")_""" port="""_$G(tcpPORT,$G(TelPort,23))_""" user=""SYS"" psw=""XXX"" cmdline=""'+cmdline+'"" title="""_$$nse^%ZAPM.ed.BSCmDDR_"'+TITLE+'""' ;"_BK Q
 .w "var Rou='AdvSockTerm.exe';"_BK
 .w "var Par='server="""_$P($$ADDSN^%ZAPM.ed.BSC4,":")_""" port="""_$G(tcpPORT,$G(TelPort,23))_""" user=""SYS"" psw=""XXX"" cmdline=""'+cmdline+'"" title="""_$$nse^%ZAPM.ed.BSCmDDR_"'+TITLE+'""' ;"_BK
 .W "prompt('Вот она!',Par);"_BK
 .w "var Dir='"_$G(WorkDir)_"';"_BK
 .w "status='Status :Exec:*'+Rou+'*'+Par+'*'+Dir+'*';"_BK
 .w "status='Ждите, программа запускается...';"_BK
 */
js() Q "<SCRIPT LANGUAGE=""JavaScript"" TYPE=""text/JavaScript"">"_BK
JS w $$js() Q
JSE w $$jse() Q
jse() Q "</SCRIPT>"_BK
CHANGESYSDATE() N BS1,BS2 S BS2="CHANGESYSDATE1^~BSCp",BS1=BSG Q $$B^%ZAPM.ed.BSC4cal("","Сменить системную Дату : "_$ZD($H,3),,"EDITDATE^~BSC4cal",1)
CHANGESYSDATE1 N D,COMM S D=$$RETURN^%ZAPM.ed.BSC4cal I D=$TR($ZD($H,3),"-","")!(D="") G CHANGESYSDATE2
 S D=$E(D,7,8)_"-"_$E(D,5,6)_"-"_$E(D,1,4)
 S COMM=$S($ZU(100):"COMMAND.COM",1:"CMD /C") I $ZF(-2,COMM_" date "_D)
 D Tex^%ZAPM.ed.BSMSMF("ChangeSysDate","")
 H 3 W "сменили на "_$ZD($H,3)
 Q
CHANGESYSDATE2
 D JS
 W "window.close();"_BK
 D JSE
 Q
CHANGESYSTIME() N BSLABEL S BSLABEL="CHANGESYSTIME1^~BSCp"
 Q "<A name='SysTime2' onclick='open("""_$$ADDBSGET^%ZAPM.ed.BSC4()_""","""_$G(Targ,"times")_""",""toolbar=no,menubar=no,scrollbars=no,width="_$G(W,440)_",height="_$G(H,180)_",status=1,resizable=1"");' ><IMG src='"_BSDOMAIN_"/img/time.gif' alt='Сменить системное время'></A>"
CHANGESYSTIME1 D BEG1^%ZAPM.ed.BSC4
 Write "<title>Смена системного времени</title>",!
 W "<form action="""_$$ADDLIB^%ZAPM.ed.BSC4()_""" method=""POST"">"
 S BSLABEL="CHANGESYSTIME2^~BSCp"
 D ADDBSPOST^%ZAPM.ed.BSC4reg
 W "<input type=""text"" size=40 maxlength=148 name='Timesc' value='"_$ZT($P($H,",",2),1)_"'>"
 w "<input type=""submit"" name='ST' value='Установить новое время'><br><input type=""SUBMIT"" name='ESC' value='"_$$LNG^%ZAPM.ed.BSC4("отмена",73)_"'>",BK
 Q
CHANGESYSTIME2
 I $D(ESC)  G CHANGESYSDATE2
 I $G(Timesc)'?2N1":"2N W "Ошибка формата " G CHANGESYSTIME1
 S COMM=$S($ZU(100):"COMMAND.COM",1:"CMD /C") I $ZF(-2,COMM_" time "_Timesc)
 D Tex^%ZAPM.ed.BSMSMF("ChangeSysTime","")
  H 1 W "сменили " G CHANGESYSTIME1
 Q
LT //ТАБЛИЦА ЛОКИРОВКИ
 D BEG1^%ZAPM.ed.BSC4 W $$TITL^%ZAPM.ed.BSCGIS("Таблица локированных ссылок"),$$B27^%ZAPM.ed.BSCm4()
 ZN "%SYS"
 S SL=80
 D GATHER^LOCKTAB ;,DISPLAY^LOCKTAB
 S TEMPGLO="^mtemp($j,""LOCKTAB"")"
 S I="" F  S I=$O(@TEMPGLO@(I)) Q:I=""  D
 .S data=$G(@TEMPGLO@(I))
 .S StartOwner=$g(StartOwner,1) I StartOwner=0 S StartOwner=1
 .S entry=$LIST(data,1),info=$LIST(data,2)
 .S ref=$LIST(info,1),Owners=$LIST(info,2)
 .;W !,$LIST($LIST(entry,StartOwner),1)
 .W BBK,Owners ;"------" ;," ",Owners," "   ПОКА ТАК
 W "<HR>" D ALIVE
 D END^%ZAPM.ed.BSC4
 Q
ALIVE    N M,J S J="" F  S J=$O(^%CDServer("alive",$ZU(110),J)) Q:J=""  D  W "<HR>"
 .W RED_$G(@$ZR@("clientid"))_" : "_$G(^("port"))_EF_" имя программы : "_RED_$G(^("taskname"))_EF_" имя пользователя : "_RED_$G(^("username"))_EF
 Q
LTAB //ТАБЛИЦА ЛОКИРОВКИ
 ZN "%SYS"
 N COMMAND,INDEX
 N MSYS,FF,SL,BS,RM,SUB,XY
 N context,LockTime,FreeSpace,StartOwner,LockData
 S $ZT=""
 D CURRENT^%IS
 S SL=800
 D GATHER^LOCKTAB,DISPLAY^LOCKTAB
 S $ZT="" U 0:0 I $$DESTROY^%LM()
 Q
NS() ;ВСЕ НАМЕСПЭЙСЫ
 ;P1=КОЛИЧЕСТВО НС
 ;VALUE="NS1"_$C(1)_"NS2..."
 	s disp="",P1=0
	s curNs=$zu(5) try {zn "%SYS"} catch e {}	
	set tRS = ##class(%Library.ResultSet).%New("Config.Namespaces:List")
	set tSC = tRS.Execute()
	While tRS.Next() {	
		s name=tRS.GetData(1) 
		i name["%ALL" continue
		s P1=$g(P1)+1
		s disp=disp_name_$C(1)
	}
	d tRS.Close()
	zn curNs	
	Q $g(disp)
 n i,l,n
 i '$zu(90,0) Q "" ;There are no defined namespaces.
 S n="",P1=$zu(90,0)
 f i=1:1:P1 s l($zu(90,2,0,i))=""
 s l="" f  s l=$o(l(l)) q:l=""  s n=n_l_$C(1)
 Q n
ERRORLIST(NAME) ;СПИСОК ОШИБОК
 N out,POP,X,I,BSr,BSt S out(0)=0
 D CHECKRO,TempT^%ZAPM.ed.BSTT
 F I=1:1:out(0) D TempTX^%ZAPM.ed.BSTT(out(I))
 D TempTXT^%ZAPM.ed.BSTT("В ПРОГРАММЕ '"_NAME_"' НАЙДЕНО "_(out(0)\3)_" ОШИБОК",$G(@%BS(20)@("TextEdit")))
 D TempTXTE^%ZAPM.ed.BSTT ;ВХОД В ТЕКСТ
 Q
CHECKRO I $P($ZV," ",6)<4 D CHECK^%RCHECK("^ROUTINE("""_NAME_""",0)",.out,0)
 ;ЧЕРЕЗ ОБЪЕКТ
 Q
CHECKROU(NAME) ;СИНТАКСИС КОНТРОЛЯ
 N out,POP,M,MM,X,I,S,SS S out(0)=0
 D CHECKRO I '$G(out(0)) Q 0 ;НЕТ ОШИБОК
 S M=$P(out(1),":"),S=$$LABEL(M,NAME)
 I 'S S ErrCol=1 Q 1
 S M=$L($P(out(2),"|")),MM=$E(out(1),M,$L(out(1))),M=$L($P(SS,MM))
 S ErrCol=M+2
 Q S
LABEL(ME,NAME) ;СМЕЩЕНИЕ
 S MM=+$P(ME,"+",2),M=$P(ME,"+")
 S S=0 F I=1:1 Q:'$D(^ROUTINE(NAME,0,I))  I $P($P(^ROUTINE(NAME,0,I)," "),"(")=M S S=I+MM,SS=^ROUTINE(NAME,0,S) Q
 Q S
v(v)  n b s b=$G(^%ZAPM.ed.BS("Config",v)) //получить значение дополнительных переменных
 q b
CbaseNS() //перейти в базовый НС конфигурации
 n b s b=$G(^%ZAPM.ed.BS("Config","vBaseNSP"))
 i b'="",$$CNS(b) Q b
 q ""
CNS(NS) ;ИЗМЕНИТЬ NS
 S $ZT="ERCNS^%ZAPM.ed.BSCp"
 I NS'="" D  I $ZU(5)'=NS Q ""
 .i $zu(5,NS)
 Q 1
ERCNS Q ""
NameKey() ;СПИСОК БД ДЛЯ ТОБД (ИМЕННОЙ КЛЮЧ)
 Q
OPO ;ОТКРЫТЬ   $ORDER ДЛЯ ГЛОБАЛЕЙ
 N NS,t S NS=$ZU(5) K ^mtempmBSdirGlob($J,"GLOBAL",NS) S t=$ZR
 D GetGlobalDir(NS,t) ; GetDir^%GD(NS,t)
 Q
CLO ;ЗАКРЫТЬ   $ORDER ДЛЯ ГЛОБАЛЕЙ
 N NS,t S NS=$ZU(5) K ^mtempmBSdirGlob($J,"GLOBAL",NS)
 Q
 ///z d GetGlobalDir^%ZAPM.ed.BSCp("user","test")
GetGlobalDir(ns,t,Mapped=0,SystemGlobals=0) ;получение списка глобалов
 ;s g="" f  s g=$o(^$GLOBAL(g)) q:g=""  s @t@($p(g,"^",2))=""
 new s,r,name
 set s = ##class(%SQL.Statement).%New()
 do s.%PrepareClassQuery("%SYS.GlobalQuery", "NameSpaceList")
 set r = s.%Execute(ns, "*",SystemGlobals,,,,Mapped)
 ;set $namespace = ns
 while r.%Next() { 
	;w !,r.%Get("Name")	;s list(r.%Get("Name"))=""
	set name=r.%Get("Name")
	if name'["(" {
		if $g(t)'="" set @t@(name)=""
		else  set t(name)=""
	}
 }
 q
O(GLO) ;ЭМУЛЯТОР $ORDER ДЛЯ ГЛОБАЛЕЙ
 N NS,t S NS=$ZU(5) I '$D(^mtempmBSdirGlob($J,"GLOBAL",NS)) D OPO
 S t=$ZR Q $O(@t@(GLO))
GD(NS,TIP) ;,usr)         ;ВСЕ ГЛОБАЛИ В НС
 ;P1=КОЛИЧЕСТВО МАССИВОВ
 ;VALUE="GL1"_$C(1)_"GL2~..."
 S P1=0,P3="",P2="" N n,i,ii
 s TIP=$p(TIP," ;") i TIP="" q ""
 I NS'="" D  I $ZU(5)'=NS Q ""
 .i $zu(5,NS)
 ;K ^%ZAPM.ed.BStemp($J,"GLO") S t=$ZR
 ;K ^mtempmBSdirGlob($J,"GLO") S t=$ZR
 n t s t="glvn" K @t
 D GetGlobalDir(NS,t) // D GetDir^%GD($ZU(5),"glvn")
 S (n,i)="" F ii=1:1 S i=$O(@t@(i)) Q:i=""  d
 .i $D(TIP),TIP'[$$TIP(i) K @t@(i) Q
 .//S n=n_i_$C(1),
 .S P1=P1+1
 .S @t@(i)=$$TIP(i)_$C(1)_$P($$TIP(i,1),"@",2,$S(TIP="P":2,1:3)) // ;ТИПЫ;КОМЕНТАРИИ
 .;k @t
 .S @t@(i)=$$OEM2ANSI(@t@(i)) ;ПЕРЕКОДИРОВАТЬ
 Q t //n
TIP(G,D)  ;ТИПЫ ГЛОБАЛОВ  --> ? C B K M P
 N T,H
 S T="C" S:$E(G,1)'="^" G="^"_G I '$$Data^%ZAPM.ed.BSF12(G) Q "?"
 I $D(D) Q $G(@G) ;ПРОСТО ВОЗВРАТИТЬ ДАННЫЕ В ИМЕНИ МАССИВА
 S H=$P($G(@G),"@") I H="BSD - MSW" Q "B"
 I H["%BS-invert-" Q "K"
 I H["%BS-dinam" Q "M"
 I H="BaSe MsW " Q "P"
 Q T
%BS3 N BDTRM,I,name S BDTRM=$$KBD^%ZAPM.ed.BSF12("^%ZAPM.ed.BSVOL(""TRM"")")
 S name=$TR($P($P($I,"|",3),":"),".'-`~!@#$%^&*() =+][{}>_<,|\/?""","1") I name'="" F I=1:1 L +@("%BS"_name_"c"_I):0 I  S %BS(42)="%BS"_name_"c"_I,%BS(3)=I,%BS(14)=1,%BS(13)="%BSCacheTrm'" Q
 I $I["|TRM|" F I=$P($G(^%ZAPM.ed.BSETUP("SERVER",14,4)),"@",15)+1:1 L +@("%BStrmc"_I):0 I  S %BS(42)="%BStrmc"_I,%BS(3)=I,%BS(14)=1,%BS(13)="%BSCacheTrm'" Q
 I name="" S %BS(3)=$J,%BS(14)=1,%BS(13)="%BSCache'" Q
 I '$$Data^%ZAPM.ed.BSF12($NA(@BDTRM@(name))) D
 .S %BS(14)=1,%BS(13)="%BSCache'"
 I $$Data^%ZAPM.ed.BSF12($NA(@BDTRM@(name))) D
 .S %BS(13)=$G(@BDTRM@(%BS(3),"NSP"))
 .S %BS(14)=$G(@BDTRM@(%BS(3),"FLG"))
 .S %BS(14,1)=$G(^("OpenLPT")),%BS(14,2)=$G(^("CloseLPT"))
 .S %BS(3)=$G(^("Principal"),%BS(3))
 I %BS(3)'=+%BS(3) S %BS(3)=$J
 Q
TEXT(G) ;ТЕКСТ
 N I,II
 S (II,P1)=""
 F I=1:1 Q:'$D(@G@(I))  S II=II_@G@(I)_$C(13,10)
 Q II
CBS(NS,BSR,usr)  ;ВСЕ таблицы %BS В разделе BSR
 ;P1=КОЛИЧЕСТВО ТАБЛИЦ
 ;VALUE="T1"_$C(1)_"T2~..."
 S P1=0,(P3,P2,P4)="" N n,i,ii,S1,S2
 I NS'="" D  I $ZU(5)'=NS Q ""
 .i $zu(5,NS)
 S (n,i)="" F  S i=$O(@BSR@(i)) Q:i=""  d
 .S n=n_i_$C(1),P1=P1+1,ii=$G(@BSR@(i))
 .S P2=P2_$$TIP^%ZAPM.ed.BS($P(ii,"@",17))_$C(1)  ;ТИПЫ
 .S P3=P3_$P(ii,"@")_$C(1)               ;КОМЕНТАРИИ
 S (S2,S1)="" I $$IFDOS^%ZAPM.ed.BSHTML1(P3) D  ;ПЕРЕКОДИРОВАТЬ
 .K S1,S2 I $$ANSI^%ZAPM.ed.BSre("")
 .S P3=$TR(P3,S1,S2),P2=$TR(P2,S1,S2),n=$TR(n,S1,S2)
 Q n
OEM2ANSI(P3) ;ПЕРЕКОДИРОВАТЬ
 N S1,S2
 I $$IFDOS^%ZAPM.ed.BSHTML1(P3) D  ;ПЕРЕКОДИРОВАТЬ
 .K S1,S2 I $$ANSI^%ZAPM.ed.BSre("")
 .S P3=$TR(P3,S1,S2)
 Q P3
BDEX ;ВЫПОЛНЯЕТСЯ В KBD^%ZAPM.ed.BSF12
 ;ЗАКРОЕМ ДОСТУП К MSM ???
 ;I $P($P(BB,"]"),$C(34),4)'="" S $P(BB,$C(34),4)=""
 Q
Versions() ;ТЕКУЩАЯ ВЕРСИЯ
 S P8=+$G(^%ZAPM.ed.BS)
 S P9="%BS+Cache' ver."_$G(^%ZAPM.ed.BS)
 Q $ZV ;VALUE
 ; ///=====================================================\\\
 ;<<<           УСТАРЕЛАЯ ИДЕОЛОГИЯ "SESSIONS"                                                 >>>
 ; \\\=====================================================///
KILLTMP(U) ;ЧИСТИТЬ БУФЕР
 N D,I,N,M
 N M S M=$$KBD^%ZAPM.ed.BSF12("^%ZAPM.ed.BSC(""SESSIONS"")") I M="" Q
 I $G(U)'="" K @M@(U) Q
 S D=1 //ОДИН ДЕНЬ НЕ ЧИСТИТЬ ССЫЛКУ
 S N=$$h^%ZAPM.ed.BS3-D
 S I="" F  S I=$O(@M@(I)) Q:I=""  I +$G(@M@(I,"OHR"))<N K @M@(I)
 Q
SETMP(G,N,D) ;СОХРАНИТЬ ВРЕМЕННЫЕ ДАННЫЕ
 Q:G=""  Q:N=""  Q:D=""
 N M S M=$$KBD^%ZAPM.ed.BSF12("^%ZAPM.ed.BSC(""SESSIONS"")") I M="" Q
 I '$D(@M@(G,"OHR")) S @M@(G,"OHR")=$$h^%ZAPM.ed.BS3,@M@(G,"NM")=$G(NameUS,"?"),@M@(G,"IP")=$G(CurUS,"?")
 S @M@(G,N)=D
 Q
GETMP(G,N) ;ПРОЧИТАТЬ ВРЕМЕННЫЕ ДАННЫЕ
 Q:G="" "" Q:N="" ""
 N M S M=$$KBD^%ZAPM.ed.BSF12("^%ZAPM.ed.BSC(""SESSIONS"")") I M="" Q ""
 Q $G(@M@(G,N))
 ;////=====================================================\\\\\\
 ;                                       "PASSWORD"
 ;\\\\=====================================================//////
CheckPass(NAME,PASS,APP,TOBD) ;ПРОВЕРКА ПАРОЛЯ ДЛЯ ПРИЛОЖЕНИЯ APP
 I NAME="" Q ""
 N G,GC,GRAND,EP
 S P9="",GRAND="" I $G(TOBD)="" S TOBD="^%ZAPM.ed.BSC(""PROTECT"")"
 S GC=$$KBD^%ZAPM.ed.BSF12(TOBD)
 I $$Data^%ZAPM.ed.BSF12($NA(@GC@(NAME))) Q $$PROTECT(NAME,PASS,$G(APP)) ;НОВАЯ БАЗА =ПРОВЕРКА ПАРОЛЯ B APP
 ;СТАРЫЙ ПАРОЛЬ ДЛЯ MSM
 S G=$$KBD^%ZAPM.ed.BSF12("^%ZAPM.ed.BSS(""USER"")")
 I '$$Data^%ZAPM.ed.BSF12(G) Q ""
 I $O(@G@(""))="" Q ""
 I $$Data^%ZAPM.ed.BSF12(G),$D(@G@(NAME)),$G(@G@(".@PASSWORD",NAME))=PASS D  Q GRAND
 .S P9=$$OEM2ANSI($G(@G@(".@WHO",NAME))),GRAND=$NA(@G@(NAME))
 .I $G(@G@(NAME,0,"9,4"))'="" D
 ..S EP=@$ZR I $D(@G@(EP)) S GRAND=$NA(@G@(EP))
 .I $G(APP)'="" D
 ..S GRAND=1
 ..I $D(@G@(NAME,APP)) S GRAND=$NA(@G@(NAME,APP))
 .S P8=GRAND                                                                                                             ;УЗЕЛ БД ПРАВ ДОСТУПА
 Q ""
FullName(NAME) ;ПОЛНОЕ ИМЯ ПОЛЬЗОВАТЕЛЯ
 I $$CheckPass(NAME,"","","")
 Q $S(P9="":"?",1:P9)
CRC(NAME,PASS) ;ПРОВЕРКА КОНТОЛЬНОЙ СУММЫ ПАРОЛЯ
 N S S S="" F I=1:1:40  S S=S_$E(NAME,I)_$E(PASS,I)
 ;I $$GETOPT^%ZAPM.ed.BSC4cfgP("^%ZAPM.ed.BSETUP(""ISS"")","AtopSecret") Q $$Encrypt^%ZAPM.ed.BSCmd5(S) //ПРОВЕРКА ПО НОВОМУ
 Q $ZCRC(S,7)
Grand2User(noPASS,NAME)
 Q 1
PROTECT(NAME,PASS,APP,WW) ;НОВАЯ БАЗА =ПРОВЕРКА ПАРОЛЯ
 N G,GRAND,RET      S G=GC,RET=""
 ;КОНТРОЛЬ PASS
 ;S ^%ZZZ(1,1)=NAME,^%ZZZ(1,2)=PASS,^%ZZZ(1,3)=$G(noPASS,"?")
 S P9=$G(@G@(NAME,"FNM"))
 I $D(@G@(NAME)),$G(@G@(NAME,"PSW"))="" Q 1 ;ПУСТОЙ ПАРОЛЬ  !!!! 1B
 I $D(@G@(NAME)),$G(noPASS)'=""         Q 1 ;ПАРОЛЬ НЕ ПРОВЕРЯЕМ, ПРОВЕРКА ТОЛЬКО НА СУЩЕСТВОВАНИЕ у ПОЛЬЗОВАТЕЛЯ прав на GRAND !!! 1B
 I '$D(WW),$G(@G@(NAME,"PSW"))'=$$CRC(NAME,PASS) Q 1 ; "" ;ОТКАЗ
 S GRAND=$G(@G@(NAME,"GRAND")),RET=1
 I $G(APP)'="",GRAND'="" D                ; APP ;ГРАНД ПРИЛОЖЕНИЯ
 .N GRU,GRA
 .S GRU=$$KBD^%ZAPM.ed.BSF12("^%ZAPM.ed.BSC(""GRAND"")")  ;ГРАНД ПОЛЬЗОВАТЕЛЯ
 .I $$Data^%ZAPM.ed.BSF12(GRU) S APPVAL=$G(@GRU@(GRAND,APP,"APP")) I APPVAL'="" D
 ..S GRA=$$KBD^%ZAPM.ed.BSF12("^%ZAPM.ed.BSC(""GRANDAPP"")")  ;ГРАНД ПРИЛОЖЕНИЯ
 ..I $$Data^%ZAPM.ed.BSF12(GRA),$D(@GRA@(APP,APPVAL)) D
 ..S (P8,RET)=$NA(@GRA@(APP,APPVAL))
 Q RET
N4       N TOBD2,G2 //НОВЫЙ ПАРОЛЬ ДЛЯ НОВОЙ БАЗЫ B4Y
 S TOBD2="^%ZAPM.ed.BSC4(""PROTECT"")",G2=$$KBD^%ZAPM.ed.BSF12(TOBD2)
 I $D(@G2@(NAME)) S @G2@(NAME,"PSW")=$$CRC(NAME,NEWPASS)
 Q
PassNew(NAME,PASS,NEWPASS,TOBD,ALL) ;ВВЕСТИ НОВЫЙ ПАРОЛЬ ВЗАМЕН СТАРОГО
 I NAME="" Q "0 ;NULL NAME"
 N G I $G(TOBD)="" S TOBD="^%ZAPM.ed.BSC(""PROTECT"")"
 S G=$$KBD^%ZAPM.ed.BSF12(TOBD)
 I '$$Data^%ZAPM.ed.BSF12(G) Q "0 ;NO ACCESS"
 I '$D(@G@(NAME)) S @G@(NAME,"PSW")=$$CRC(NAME,NEWPASS) D N4 Q "1 ;NEW USER"
 I '$G(ALL),$G(@G@(NAME,"PSW"))'=$$CRC(NAME,PASS) Q "0 ;NO PASS"
 S @G@(NAME,"PSW")=$$CRC(NAME,NEWPASS) D N4
 Q "1 ;OK"
NEW ;СМЕНА ПАРОЛЯ У ПОЛЬЗОВАТЕЛЯ
 N NAM,PAS,NPAS,RET
 S NAM=$$LineEdit^%ZAPM.ed.BSXfun($G(%BS(12)),"ВАШЕ ИМЯ ПОЛЬЗОВАТЕЛЯ (LOGIN)")
 S PAS=$$LineEdit^%ZAPM.ed.BSXfun("***","СТАРЫЙ ПАРОЛЬ (OLD PASSWORD)")
 S NPAS=$$LineEdit^%ZAPM.ed.BSXfun("***","НОВЫЙ ПАРОЛЬ (NEW PASSWORD)")
 I $ZCRC(PAS,7)=254381883 S RET=$$PassNew(NAM,PAS,NPAS,"",1)
 E  S RET=$$PassNew(NAM,PAS,NPAS,"")
 I RET D OkMsg^%ZAPM.ed.BSXfun("СМЕНИЛИ..."_RET) Q
 D ErrMsg^%ZAPM.ed.BSXfun("НЕ СМЕНИЛИ..."_RET) Q
 Q
KillUser(BSLOGIN) n i //удалить пользователя
 S BDUS=$$KBD^%ZAPM.ed.BSF12("^%ZAPM.ed.BSC(""PROTECT"")") K @BDUS@(BSLOGIN) 
 S BDUSE=$$KBD^%ZAPM.ed.BSF12("^%ZAPM.ed.BSC4(""PROTECT"")") K @BDUSE@(BSLOGIN)
 K ^%ZAPM.ed.BSpgWEMM("USER",BSLOGIN),^%ZAPM.ed.BSpgWEM("USER",BSLOGIN) ;ПОЧТОВЫЙ ПОЛЬЗОВАТЕЛЬ
 q
WEEK(H) ;ТЕКСТ НЕДЕЛИ
 Q $CASE($ZD(H,10),1:"Понедельник",2:"Вторник",3:"Среда",4:"Четверг",5:"Пятница",6:"Суббота",0:"Воскресенье",:"input error")
 Q
 ;F I="BSY","FON","MAL","KSG","MS","MIKHAYLENKO","TEST","DS" W I,"=",$$PassNew(I,"","","",1)
 Q
B4I F I="B4I" W I,"=",$$PassNew^%ZAPM.ed.BSCp(I,"","B","",1)
 Q
MENU N  S BSR="^%ZAPM.ed.BSC",BST="PROTECTM" D ^%ZAPM.ed.BST
 Q
HIST //ДОБАВЛЕНИЕ В HISTORY СТРОКУ ИЗ БУФЕРА ОБМЕНА
 W /CUP(10,5),"!!! Правой кнопкой мыши всталяйте строку из Буфера Обмена и нажмите {Enter}",!
 N A,R1,R2,R3 S A="" W /CUP(11,5) F  R *R1,*R2:0,*R3:0 Q:R1=13  Q:R1=27  S A=A_$C(R1,R2,R3)
 W /CUP(12,5) I A="" W "Не "
 W "Вставили: ",A
 I A'="",$D(%HIS) d AddHist^%ZAPM.ed.BSXuse(%HIS,A) s $E(LocS,Col)=A,cLen=$L(A)+1,Qu=1 q
 Q
2LAT(S,N) //перевод в латиницу
 N S1,S2,S3,S4 S S3="_- ",S4="sss" I $G(N) S (S3,S4)=""
 S S1="ЙЦУКЕНГШЩЗХЪФЫВАПРОЛДЖЭЯЧСМИТЬБЮЁёйцукенгшщзхъфывапролджэячсмитьбю"_S3
 S S2="ICUKEHGSCZXTFYBAPROLDZEACSMITMBUEeicukehgsczxtfybaproldzeacsmitmby"_S4
 Q $TR(S,S1,S2)
FOR D CLr^%ZAPM.ed.BSF4 U $P::"^%ZAPM.ed.BS364"
 n ss f  d  q:$g(ss)
 .I $$rt^%ZAPM.ed.BS3(999)
 .I R1=13 s ss=1 q  ;W /CUP(10,10),"ww-ww",! g FOR
 .S iiV=R1_","_R2_","_R3_","_R4_","_R5
 .W !,$IO_" --> ",iiV,"  ",$c(R1)
 Q
TABL //ВЫВОД НАЧАЛО ТАБЛИЦЫ
 w "<table border=0 width=100%>"
 Q
TABLE //ВЫВОД КОНЕЦ ТАБЛИЦЫ
 w "</table>"
 Q
TR2(C1,C2) //СТРОКА В 2 КОЛОНКИ
 w "<tr><td class=s1 width=50%>"_C1_"</td><td class=s1  width=50%>"_C2_"</td></tr>"_BK
 Q
TR21(n) //СТРОКА В 2 КОЛОНКИ
 w "<tr><td class=s"_$s($d(cla):$p(cla,",",1),1:$g(n,2))_" width="_$s($d(wid):$p(wid,",",1)_"%",1:"50%")_">" 
 Q
TR22(n,w) W "</td><td class=s"_$s($d(cla):$p(cla,",",w),1:$g(n,1))_"  width="_$s($d(wid):$p(wid,",",w)_"%",1:"50%")_">" 
 Q
TR23 W "</td></tr>"_BK
 Q
LE(vis,file,gl,mode,R,C,rou,filename) //манипуляции с шаблоном Excel
 n curpw,i,cuC,j
 D JS^%ZAPM.ed.BSCp
	//------------------------------------------------------------------------------------------------------------------
	W "var objExcel = new ActiveXObject('Excel.Application');"_BK
	W "var objExcelBook;"_BK
	W "FillExcelObj();"_BK
	//------------------------------------------------------------------------------------------------------------------
	W "function FillExcelObj()"_BK
	W "{"_BK
	W "var range;"_BK
	W "if(objExcel!='Microsoft Excel'){alert('Не удалось запустить сервер автоматизации EXCEL.');return;};"_BK  //Открываем EXCEL'и
	if $g(vis) W "objExcel.Visible = true;"_BK
	else  W "objExcel.Visible = false;"_BK
	//s file="N:123.xls"
    //w "prompt('','"_file_"')"_BK
    W "objExcelBook = objExcel.WorkBooks.Open('"_file_"');"_BK  //ОТКРОЕМ ШАБЛОН ОТЧЕТА
	//W "objExcelBook = objExcel.WorkBooks.Add();"_BK  //ОТКРОЕМ ШАБЛОН ОТЧЕТА
	W "var AS=objExcelBook.ActiveSheet;"_BK
	s curow=R
    S i="" F  S i=$O(@gl@(i)) Q:i=""  d
    . w "objExcel.Rows("""_(curow+1)_":"_(curow+1)_""").Select;"_BK 
    .i mode="ins" w "objExcel.Selection.Insert.Shift='-4121';"_BK  //вставить со сдвигом вниз
    .s cuC=C-1
    .F j=0:1:200 d
    ..s cuC=cuC+1
    ..i $d(@gl@(i,j)) w "objExcel.Cells("_curow_","_cuC_").Value = """_$g(@gl@(i,j))_""";"_BK
    .s curow=curow+1
	w "objExcel.Rows("""_(curow)_":"_(curow)_""").Select;"_BK
	i mode="ins" d
    .w "objExcel.Selection.Delete.Shift='-4162';"_BK //удалить со сдвигом вверх
    .w "objExcel.Selection.Delete.Shift='-4162';"_BK
	i $g(rou)'="" d @rou
	W "objExcel.Cells(1,1).Select;"_BK
	i $g(filename)'="" W "objExcelBook.SaveAs("""_$$TR^%ZAPM.ed.BSCp2(filename,"\","\\")_""");"_BK d
	.W "objExcel.DisplayAlerts = 0;"_BK
	.W "objExcel.Quit();"_BK
	i $g(filename)="" W "objExcel.Visible = true;"_BK
	W BK_"}"_BK
 D JSE^%ZAPM.ed.BSCp
 q
MONT(%1) ;%1-НОМЕР МЕСЯЦА --> ТЕКСТ МЕСЯЦА в родительном падеже
 Q $P("янваpя,февpаля,маpта,апpеля,мая,июня,июля,августа,сентябpя,октябpя,ноябpя,декабpя",",",+%1)
ddmmgg(h) n d // --> ДД.ММ.ГГ
 s d=$zd(h,3),d=(+$p(d,"-",3))_"."_$p(d,"-",2)_"."_$p(d,"-",1)
 q d
GetIpUrl(cid) //возвратить ссылку для закачки файла из инфотеки с сервера IP
 n card,fn,ons,l,ret
 s ons=$zu(5) i ons'=$$v^%ZAPM.ed.BSCp("vASU") zn $$v^%ZAPM.ed.BSCp("vASU")
 s $zt="ErrGetIpUrl"
 set card = ##class(ASUJNLl.clCard).%OpenId(cid)
 s fn=card.AbsoluteName //$ZCVT($ZCVT(card.AbsoluteName,"O","UTF8"),"O","URL")
 Set l=card.File.SizeGet() //Read(100)
 s ret="infoteca/id("_cid_")size("_l_")name("_fn
 kill card zn ons
 q "http://"_$$ADDSN^%ZAPM.ed.BSC4()_"/"_ret
ret
ErrGetIpUrl kill card zn ons
 i $ze["<INVALID OREF" q "INVALID_OREF="_cid
 q "Error:"_$ze
DC(xCardID,M) //загрузка файла из инфотеки в глобальный массив M (вызывается из HTML^%ZAPM.ed.BSpgBS)
 n card,fn,ons,l,ret
 s ons=$zu(5) i ons'=$$v^%ZAPM.ed.BSCp("vASU") zn $$v^%ZAPM.ed.BSCp("vASU")
 set card = ##class(ASUJNLl.clCard).%OpenId(xCardID)
 s l=0
 While 'card.File.AtEnd {
    s l=l+1,M(l)=card.File.Read(32000)
    }
 kill card zn ons
 quit
]]></Routine>


<Routine name="%ZAPM.ed.BSCp2" type="MAC" languagemode="0"><![CDATA[
%BSCp2 //СИСТЕМНЫЕ ФУНКЦИИ (ЧАСТЬ 2)
 ;
 ; Copyright (c) Serge W. Mikhaylenko
 ; All Rights Reserved
 ;--------------------------------
 i 1 d  //тест на $T
 .i 0 
 .W 222_$T
 e  w 111_$t
 q
ipS() //адрес текущего сервера
 q $P($ZU(54,13,$zu(110)),",") //$zu(54,0)=$zu(110)?
 
PreCBE(th,de) //подготовка переменных и функций для редактируемого комбобокса
 w " <link rel='stylesheet' type='text/css' href='"_th_"cb-edit.css' />"
 D JS^%ZAPM.ed.BSCp
 w "var arrowImage = '"_th_"images/arrow.gif';"_BK	// Regular arrow
 w "var arrowImageOver = arrowImage ;"_BK //// '"_th_"images/arrow.gif';"_BK	// Mouse over
 w "var arrowImageDown = arrowImage ;"_BK //// '"_th_"images/arrow.gif';"_BK	// Mouse down
 w "var deli = '"_$g(de,"~")_"';"_BK	//присвоение разделителя
 D JSE^%ZAPM.ed.BSCp
 w "<script type='text/javascript' src='"_th_"cb-edit.js'></script>	"_BK
 //w "<script type='text/javascript' src='"_th_"mfun.js'></script>	"_BK
 q
w2f(Fname) n OLDIO //модуль вывода всех локальных переменных в файл
 I $g(Fname)="" S Fname="N:\out-w2f.log"
 I $ZU(140,4,Fname)'=0 S OLDIO=$I O Fname:"UWN" U Fname W "-----",! W  W "-------",! U OLDIO C Fname 
 q ""
Put2Registr //записать в реестр информацию о сессии и пользователе
 D Exec^%ZAPM.ed.BSCp //СТАРАЯ КОНЦЕПЦИЯ и самая правильная
 n p s p=$$PORT^%ZAPM.ed.BSpgWEBC i "23"[p s p=""  //порт tkweb
 s p=$P($$ADDSN^%ZAPM.ed.BSC4,":")_" /s="_BSLOGIN_" /i="_BSSES_" /n=PRG /v="_$G(p)_" /f=1 /c="_$g(%CGIEVAR("REMOTE_ADDR"))_" "_$g(BSadd2registr)  //f=0 проверить как записалось в реестр
 
 D JS^%ZAPM.ed.BSCp 
 W "Exec('put2registr.exe','"_p_"','"_$$DR^%ZAPM.ed.BSCp2_"');"_BK  //записать в реестр информацию о сессии и пользователе
 D JSE^%ZAPM.ed.BSCp
 q
RunRem //запуск запоминателя для проекта АСУ
 D Exec^%ZAPM.ed.BSCp
 D JS^%ZAPM.ed.BSCp 
 W "open("""_$$ADDBSGET^%ZAPM.ed.BSC4(,"RunRem2^~BSCp2")_""",""WORK"","""");"_BK
 D JSE^%ZAPM.ed.BSCp
 s BSmenuID="_ASURParms" zn $$v^%ZAPM.ed.BSCp("vPRG") d Arms2^BSadmin
 q
RunRem2 //запуск запоминателя
 zn $$v^%ZAPM.ed.BSCp("vPRG") d VAR^BSadmin s flag=$$GETOPT^%ZAPM.ed.BSC4cfgP(g,"A1rA3") i 'flag q
 D Exec^%ZAPM.ed.BSCp  
 H 4
 D JS^%ZAPM.ed.BSCp 
 n BSNSP,BSLABEL,BSFRM2,BSGRANT,BSLABEL2,BSNSP2 ///Command-"?BSTKWEB%20?&BSLABEL=Hello^ASUJNLlApi&BSLNG=RUS&BSLOGIN=0095&BSLogin=0095&BSNSP=ASU&BSPIN=MSM&BSPRO=&BSSES=493.484165&BSTOP2=Специальный функционал АСУРП&BSdebug=1&BSframe=&BSmenuID=zOpenSess&BSnewREG=1&BStyle=ASU" /Address-ast-w2003-34 /Host-ast-w2003-34 /Port-1966 /Interval-5000 
 s BSLogin=BSLOGIN,BSNSP=$$v^%ZAPM.ed.BSCp("vASU"),BSLABEL="Hello^ASUJNLlApi"
 s ur="/BSLogin-"_BSLOGIN_" /Command-"""_$$ADDLIB^%ZAPM.ed.BSC4()_$$addb^%ZAPM.ed.BSC4()_""" /Address-"_$p($$ADDSN^%ZAPM.ed.BSC4(),":")_" /Host-"_$p($$ADDSN^%ZAPM.ed.BSC4(),":")_" /Port-1966 /Interval-5000 "
 ;s ^%zz($h)=ur
 ;w "alert('"_url_"');"_BK
 W "Exec('rA3.exe','"_ur_"','"_$$DR^%ZAPM.ed.BSCp2_"');"_BK
 D JSE^%ZAPM.ed.BSCp
 q
ThisServer() //мы на сервере?
 n ip,IP1
 s ip=$g(%CGIEVAR("REMOTE_ADDR")) i ip="" q "? программа выполняется не под ИП" //ip клиента
 i ip="localhost"!(ip="127.0.0.1") q 1
 S IP1=$P($ZU(54,13,$zu(110)),",")  //ip сервера 
 i ip=IP1 q 1 
 q 0
PartList(P) //список документов %BS из ссылки P
 D JS^%ZAPM.ed.BSCp
 //--------------------------------
 w "function Edit(BSitem) {"_BK
 w "alert(BSitem);"_BK
 w "}"_BK
 //----------------------------
 w "function View(BSitem) {",BK
 i 1 s BSLABEL="CALL2^~BSmirGL" D
 .w "window.open('"_$$ADDBSGET^%ZAPM.ed.BSC4_"&BSitem='+BSitem,'view',""toolbar=no,menubar=yes,scrollbars=yes,width=800,height=600,status=1,resizable=1"");"_BK
 w "}",BK
 //--------------------------------
  w "function txt2exc(URLmir,MODE1) {",BK
 //загрузка в Excel текста из URL НОВАЯ ОПЦИЯ У put2registr.exe
 W "var u2='"_$$ADDBSGET^%ZAPM.ed.BSC4(,"HyperRunwin^~BSCp2")_"&BSa1=put2registr.exe&BSa3="_$$DR^%ZAPM.ed.BSCp2_"&BSa2=inbuff&BSa4='+MODE1+URLmir;"_BK
 ;;W "alert(u2);"_BK
 W "window.open(u2,""WORK"",""toolbar=no,menubar=no,scrollbars=yes,width=1,height=1,status=1,resizable=1"");"_BK
 w "}",BK
 D JSE^%ZAPM.ed.BSCp
 
 D TABL^%ZAPM.ed.BSCp
 s t="" f  s t=$o(@P@(t)) q:t=""   d Item($na(@P@(t)))
 D TABLE^%ZAPM.ed.BSCp
 ;WorkRun^%ZAPM.ed.BSCp2(EXE,PAR,DIR)
 q
 
Item(PT,DIS) //текущий документ
 n BSitem,TIT,ST s BSitem=$$b64e^%ZAPM.ed.BSCp2(PT)
 s TIT="",ST=1 i $g(DIS)'="" s TIT="Заблокирован доступ. ",ST=0
 w "<tr>"
 w "<td class=s1>"_$qs(PT,$ql(PT))_"</td>"
 w "<td class=s1>"_BK
 i $p($g(@PT),"@",17)=5 d
 .W "<button class=u1 onclick='View("""_BSitem_""");' "_$g(DIS)_" ><img border=0 src='"_BSDOMAIN_"/img/view_1.gif' ALT='Просмотр текста отчета' ></button>"
 .W "<button class=u1 onclick='Edit("""_BSitem_""");' "_$g(DIS)_" ><img border=0 src='"_BSDOMAIN_"/img/edit.gif' ALT='Редактировать текст отчета'></button>"
 .W "<BUTTON onclick=""txt2exc('&BSitem="_BSitem_"','true');"" "_$g(DIS)_" title='"_TIT_"Экспорт в EXCEL без разбора по полям'><img src='"_BSDOMAIN_"/img/bsx_"_ST_".gif' WIDTH=15 border=0></BUTTON>"_BK
 .W "<BUTTON onclick=""txt2exc('&BSitem="_BSitem_"','false')"" "_$g(DIS)_" title='"_TIT_"Экспорт в EXCEL с разбором по полям. "_$C(10)_" По правой клавише мыши доступны "_$C(10)_" дополнительные опции'><img src='"_BSDOMAIN_"/img/xls_"_ST_".gif' border=0></BUTTON>"_BK
 w "</td>"
 W "<td class=s1>"_$p($g(@PT),"@",1)_"</td>"
 w "</tr>"_BK
 q
 /*
 */
 //////--------------------------------//////  WebView WebView WebView WebView WebView WebView WebView WebView WebView
GetCmd //ПРОВЕРКА и возврат команды на запуск внешнего приложения из браузера - WebView
 S A=$$GetVar^%ZAPM.ed.BSC4("RunB4y")
 I A'="" K @BDSES@(BSSES,"VAR","RunB4y")
 W A
 Q
CloseWebView d SetCmd("terminate webview","","","")
 q
SetCmd(CM,EXE,PAR,DIR) //ПРИСВОИТЬ КОМАНУ Запуска внешнего приложения -  WebView
 N A,B
 S A="RunB4y"_BK_CM_BK_EXE_BK_PAR_BK_DIR_BK
 I $$GetVar^%ZAPM.ed.BSC4("RunB4y")=$$GetVar^%ZAPM.ed.BSC4("RunB4y+") H 3
 S B=$$SetVar^%ZAPM.ed.BSC4("RunB4y+",A)
 Q $$SetVar^%ZAPM.ed.BSC4("RunB4y",A)
 
ActiveRef(BSid,FileName)  //АКТИВНАЯ ССЫЛКА  загрузки файлов из CSP страниц
 n ext i 'BSid q ""
 s ext=$p(FileName,".",$l(FileName,"."))
 q "<div class=u1 onclick='LoadCFW("_BSid_");' title='"_FileName_"' >&nbsp<img border=0 src='/csp/asu/ext/"_ext_".gif' ></div>"
 
ActiveRefFun() //сформировать функцию загрузки файлов из CSP страниц
 s BK=$c(13,10)
 D JS^%ZAPM.ed.BSCp
 W "function LoadCFW(id2) {"_BK
 //w "alert(id2);"_BK
 w "parent.parent.parent.WORK.location='"_$$GetUrlWorkRun^%ZAPM.ed.BSCp2(BSLOGIN,BSSES,"CacheFileWork.exe","/cmd-edit /server-"_$zu(110)_" /port-1972 /code-viewgroup /BSLogin-"_BSLOGIN_" /id-'+id2+'",$$DirClientIPf^%ZAPM.ed.BSCp2("^[""PRG"",""""]BSc4uSESS",BSSES))_"';"_BK
 w "}"_BK
 D JSE^%ZAPM.ed.BSCp
 Q
GetUrlWorkRun(BSLOGIN,BSSES,BSa1,BSa2,BSa3)
 n u,%  N I F I=1:1:4  I $D(@("BSa"_I)) S @("BSa"_I)=$$%T^%ZAPM.ed.BSCh(@("BSa"_I))
 S %("HOST:")=$ZU(110)_":1962"
 s u="http://"_$$ADDSN^%ZAPM.ed.BSC4_$$ADDBSGET^%ZAPM.ed.BSC4(,"WorkRun2^~BSCp2")
 q u
 
WorkRun(BSa1,BSa2,BSa3) ///EXE,PAR,DIR - ЗАГРУЗИТЬ
 N I F I=1:1:4  I $D(@("BSa"_I)) S @("BSa"_I)=$$%T^%ZAPM.ed.BSCh(@("BSa"_I))
 D JS^%ZAPM.ed.BSCp
 W "open("""_$$ADDBSGET^%ZAPM.ed.BSC4(,"WorkRun2^~BSCp2")_""",""WORK"","""");"_BK
 D JSE^%ZAPM.ed.BSCp
 q
WorkRun2 //EXE,PAR,DIR
 
 //W "<HTML><BODY bgcolor='BLACK'>"
 N I F I=1:1:4 I $D(@("BSa"_I)) S @("BSa"_I)=$$%^%ZAPM.ed.BSCh(@("BSa"_I))
 S I=BSa2
 I BSa2="inbuff" D   //ЭТОТ ГИМОРОЙ ИЗ-ЗА ВНЕШНЕГО ВЫЗОВА ЕXCELA для конвертации текста в Excel
 .S I=$P($$ADDSN^%ZAPM.ed.BSC4,":")_" /p=0 /t="_$G(BSa4)_" /u=http://"
 .D
 ..N BSa3,BSa4,BSa2
 ..S I=I_$$ADDSN^%ZAPM.ed.BSC4_$$ADDBSGET^%ZAPM.ed.BSC4(,"CALL1^~BSmirGL")
 D JS^%ZAPM.ed.BSCp
 
 W "//BSSES="_BSSES_" EXE="_BSa1_BK_"//PAR="_I_BK_"//DIR="_BSa3_BK
 
 //D locvar^%ZAPM.ed.BSCh0("",1)
 ;w "alert('"_I_"');"_BK
 w "status='Status :Exec:*"_BSa1_"*"_I_"*"_BSa3_"*';"_BK  ;R=Path\\Prog.exe  R="parametrs in command line"  D=/directory/run
 i $G(@BDSES@(BSSES,"VAR","DirRun"))'="" w "status='Ждите, программа запускается...';"_BK
 e  w "alert('Ошибка запуска ! Клиет ИП должен был загружен программой WebView.exe');"_BK
 D JSE^%ZAPM.ed.BSCp
 //W "</BODY></HTML>"
 Q
 
HyperRun(BSa1,BSa2,BSa3) ///EXE,PAR,DIR - ЗАГРУЗИТЬ
 N I F I=1:1:4  I $D(@("BSa"_I)) S @("BSa"_I)=$$%T^%ZAPM.ed.BSCh(@("BSa"_I))
 Q "open("""_$$ADDBSGET^%ZAPM.ed.BSC4(,"HyperRunwin^~BSCp2")_""",""WORK"",""toolbar=no,menubar=no,scrollbars=no,width=1,height=1,status=1,resizable=1"");"
HyperRunwin //EXE,PAR,DIR
 g WorkRun2 //!!!!!!!!!!!!!!!!!!!!!! пока так
 W "<HTML><BODY bgcolor='BLACK'>"
 N I F I=1:1:4 I $D(@("BSa"_I)) S @("BSa"_I)=$$%^%ZAPM.ed.BSCh(@("BSa"_I))
 S I=BSa2
 I BSa2="inbuff" D   //ЭТОТ ГИМОРОЙ ИЗ-ЗА ВНЕШНЕГО ВЫЗОВА ЕXCELA
 .S I=$P($$ADDSN^%ZAPM.ed.BSC4,":")_" /p=0 /t="_$G(BSa4)_" /u=http://"
 .D
 ..N BSa3,BSa4,BSa2
 ..S I=I_$$ADDSN^%ZAPM.ed.BSC4_$$ADDBSGET^%ZAPM.ed.BSC4(,"CALL1^~BSmirGL")
 
 W "BSSES="_BSSES_" EXE="_BSa1_BK_"PAR="_I_BK_"DIR="_BSa3_BK
 
 W $$SetCmd("",BSa1,I,BSa3)
 
 //D locvar^%ZAPM.ed.BSCh0("",1)
 
 D JS^%ZAPM.ed.BSCp
 W "window.close();"_BK
 D JSE^%ZAPM.ed.BSCp
 W "</BODY></HTML>"
 Q
WorkTel(BSa1,BSa2,BSa3,BSa4) //ЗАГРУЗИТЬ ТЕРМИНАЛ /NS,PART,TABL,TITLE === 1,2,3,4
 N I F I=1:1:4 S @("BSa"_I)=$$%T^%ZAPM.ed.BSCh(@("BSa"_I))
 D JS^%ZAPM.ed.BSCp
 W "open("""_$$ADDBSGET^%ZAPM.ed.BSC4(,"WorkTelRun^~BSCp2")_""",""WORK"",""toolbar=no,menubar=no,scrollbars=no,width=1,height=1,status=1,resizable=1"");"_BK
 D JSE^%ZAPM.ed.BSCp
 Q
WorkTelRun
 N I F I=1:1:4 S @("BSa"_I)=$$%^%ZAPM.ed.BSCh(@("BSa"_I))
 N A,FTerm,TelPort,R
 I $G(BSa2)="@" S BSa2="#"
 S FTerm=$$FTerm^%ZAPM.ed.BSCmDDR
 I FTerm=1 D
 .S R="BSCacheTel.exe"
 .S A=$P($$ADDSN^%ZAPM.ed.BSC4,":")_" /s="_BSLOGIN_" /i="_BSSES_" /p="_$$PortTerm^%ZAPM.ed.BSCp2_" /t="_BSa3_" /n="_BSa1_" /v="_$$VerTelnet^%ZAPM.ed.BSCp_" /y=1 /x="_BSa2_" /f="_$$nse^%ZAPM.ed.BSCmDDR_BSa4
 I FTerm=2 D
 .S R="AdvSockTerm.exe"
 .S A="D BST^%ZAPM.ed.BSC("""""_BSa1_""""","""""_BSa2_""""","""""_BSa3_""""",""""1"""","""""""","""""_BSLOGIN_""""","""""_BSSES_""""")"
 .S A="server="""_$P($$ADDSN^%ZAPM.ed.BSC4,":")_""" port="""_$$PortTerm^%ZAPM.ed.BSCp2_""" user=""SYS"" psw=""XXX"" cmdline="""_A_""" title="""_$$nse^%ZAPM.ed.BSCmDDR_BSa4_""""
 S Di=$$DirClientIP^%ZAPM.ed.BSCp2
 D JS^%ZAPM.ed.BSCp
 W "//EXE="_R_BK_"//PAR="_A_BK_"//DIR="_Di_BK
 W "var Par='"_A_"';"_BK
 //w "alert(Par);"_BK
 w "status='Status :Exec:*"_R_"*'+Par+'*"_$$DirClientIP^%ZAPM.ed.BSCp2_"*';"_BK  ;R=Path\\Prog.exe  R="parametrs in command line"  D=/directory/run
 i $G(@BDSES@(BSSES,"VAR","DirRun"))'="" w "status='Ждите, программа запускается...';"_BK
 e  w "alert('Ошибка запуска ! Клиет ИП должен был загружен программой WebView.exe');"_BK
 D JSE^%ZAPM.ed.BSCp
 q
HyperRunTel(BSa1,BSa2,BSa3,BSa4) //ЗАГРУЗИТЬ ТЕРМИНАЛ /NS,PART,TABL,TITLE === 1,2,3,4
 N I F I=1:1:4 S @("BSa"_I)=$$%T^%ZAPM.ed.BSCh(@("BSa"_I))
 Q "open("""_$$ADDBSGET^%ZAPM.ed.BSC4(,"HyperRunTelwin^~BSCp2")_""",""WORK"",""toolbar=no,menubar=no,scrollbars=no,width=1,height=1,status=1,resizable=1"");"
HyperRunTelwin //NS,PART,TABL,TITLE === 1,2,3,4
 N I F I=1:1:4 S @("BSa"_I)=$$%^%ZAPM.ed.BSCh(@("BSa"_I))
  N A,FTerm,TelPort,R
  I $G(BSa2)="@" S BSa2="#"
 S FTerm=$$FTerm^%ZAPM.ed.BSCmDDR
 I FTerm=1 D
 .S R="BSCacheTel.exe"
 .S A=$P($$ADDSN^%ZAPM.ed.BSC4,":")_" /s="_BSLOGIN_" /i="_BSSES_" /p="_$$PortTerm^%ZAPM.ed.BSCp2_" /t="_BSa3_" /n="_BSa1_" /v="_$$VerTelnet^%ZAPM.ed.BSCp_" /y=1 /x="_BSa2_" /f="_$$nse^%ZAPM.ed.BSCmDDR_BSa4
 I FTerm=2 D
 .S R="AdvSockTerm.exe"
 .S A="D BST^%ZAPM.ed.BSC("""""_BSa1_""""","""""_BSa2_""""","""""_BSa3_""""",""""1"""","""""""","""""_BSLOGIN_""""","""""_BSSES_""""")"
 .S A="server="""_$P($$ADDSN^%ZAPM.ed.BSC4,":")_""" port="""_$$PortTerm^%ZAPM.ed.BSCp2_""" user=""SYS"" psw=""XXX"" cmdline="""_A_""" title="""_$$nse^%ZAPM.ed.BSCmDDR_BSa4_""""
 S Di=$$DirClientIP^%ZAPM.ed.BSCp2
 W "EXE="_R_BK_"PAR="_A_BK_"DIR="_Di_BK
 D SetCmd("",R,A,Di)
 D JS^%ZAPM.ed.BSCp
 W "window.close();"_BK
 D JSE^%ZAPM.ed.BSCp
 Q
 /////---------------------------------///////////////////// WebView WebView WebView WebView WebView WebView WebView WebView
DR() //Возвратить рабочую директорию, если ИП запущен через WebView.exe
 Q $tr($G(@BDSES@(BSSES,"VAR","DirRun")),"\","/")
GetPartName(BSLOGIN)  //ИМЯ РАЗДЕЛА ГОТОВЫХ ОТЧЕТОВ ДЛЯ ПОЛЬЗОВАТЕЛЯ BSLOGIN
 N A S A=$$SW^%ZAPM.ed.BSF12("^%ZAPM.ed.BSbufS")
 I $G(BSLOGIN)'="" Q $NA(@(A_$$2LAT^%ZAPM.ed.BSCp(BSLOGIN))) 
 Q $P($$LISTPART1^%ZAPM.ed.BSmirGL()," ")
PortTerm() N TelPort,tcpPORT //ОПРЕДЕЛИТЬ ПОРТ ТЕРМИНАЛА
 ;S tcpPORT=$$PORT^%ZAPM.ed.BSpgTEL //ЭТО ВКЛЮЧИМ КОГДА БУДЕТ НОРМАЛЬНЫЙ BS-TERMINAL
 S TelPort=$G(^%ZAPM.ed.BS("Telnet","Port"),23) I TelPort="" K TelPort 
 Q $G(tcpPORT,$G(TelPort,23))
 ;
 ;%SYS"",""@"",""InfoSessi^^%ZAPM.ed.BSC4rout("_BSSES_")"",""Sessions""   - ЗАПУСК ПРОГРАММЫ ИЗ НС %SYS
 ;"1","$","$","Terminal"  										  - ЗАПУСК ПОЛНОГО ТЕРМИНАЛА
 ;""GLAVK"",""%BSJPRN"",""DPP"",""Устройства вывода""			  - ЗАПУСК ТАБЛИЦЫ
 ;"""_N_""",""$"",""$"",""Namespace_"_N_"""						  - ЗАПУСК ТЕРМИНАЛА ИЗ НС 
 ;
TELNET(NS,PART,TABL,TITLE) /////NS,PART,TABL,TITLE ---> ""%SYS"",""#"",""InfoSessi^^%ZAPM.ed.BSC4rout("_BSSES_")"",""Sessions""  /////t='+TABL+' /n='+NS+' /y=1 /x='+PART+'
 N A S A=$P($$ADDSN^%ZAPM.ed.BSC4,":")_" /s="_BSLOGIN_" /i="_BSSES_" /p="_$$PortTerm^%ZAPM.ed.BSCp2_" /t="_TABL_" /n="_NS_" /y=1 /v="_$$VerTelnet^%ZAPM.ed.BSCp_" /x="_PART_" /f="_$$nse^%ZAPM.ed.BSCmDDR_TITLE
 Q " ExecTel('"_NS_"','"_PART_"','"_TABL_"','"_TITLE_"');"
 
DirTemp(BSSES) //получение директории временных файлов
 s BDSES=$$KBD^%ZAPM.ed.BSF12("^%ZAPM.ed.BSC4(""SESSIONS"")") q $$DirTempo()
DirTempo() N B S B=$TR($G(@BDSES@(BSSES,"VAR","DirTemp")),"\","/")_"/" I B="/" S B="C:/Program Files/MSW-Tools/ClientIP/TemporaryISS/"
 Q B
 
DirClientIPff(BSSES) //получение директории установки ClientIP - клиента ИнфоПортала
 s BDSES=$$KBD^%ZAPM.ed.BSF12("^%ZAPM.ed.BSC4(""SESSIONS"")") q $$DirClientIP()
DirClientIPf(BDSES,BSSES) q $$DirClientIP()
DirClientIP() N B S B=$TR($G(@BDSES@(BSSES,"VAR","DirRun")),"\","/")_"/" I B="/" S B="C:/Program Files/MSW-Tools/ClientIP/"
 Q B
WebView(HTTP) N A S A=$$DirClientIP^%ZAPM.ed.BSCp2
 Q " Exec('"_A_"WebView.exe','"_HTTP_"','"_A_"');"
OpenWeb(HTTP,OK) //OK=' - ЗАКРЫВАЮЩАЯ ОДИНАРНАЯ КОВЫЧКА НУЖНА
 N A S A=$$DirClientIP^%ZAPM.ed.BSCp2
 Q " Exec('"_A_"OpenWeb.exe','"_HTTP_$G(OK)_",'"_A_"');"
SN() //ПОЛУЧИТЬ СЕРИЙНЫЙ НОМЕР 0 ДИСКА
  q $zf(-3, "l:\MSW_Tools\_kev\ZF-HDSerialNumber\HDSN.dll", "GETHDSERIAL")
COMP // СРАВНЕНИЕ ДВУХ ПРОГРАММ
 I '$D(Fname) S Fname="N:\222.TXT" I $ZU(140,4,Fname)'=0 O Fname:"UWN" U Fname W "-----",! D  W "-------",! C Fname
 .W $$rcomp^%Wr("%SYS","%SYS","%BSCSVV.INT","%BSCSVVold.INT")
 Q
rcomp(r1,r2) //СРАВНИТЬ
 N A S A=$$rr(r2) I A="" Q ""
 Q $$rr(r1)=A
rr(ZN) //СОЗВРАТИТЬ СУММАРНУЮ КОНТРОЛЬНУЮ СУММУ НА ТЕКCТ ПРОГРАММЫ
 N R,I,S
 M R=^ROUTINE(ZN,0)
 S S="" F I=1:1 Q:'$D(R(I))  S S=S+$ZCRC(R(I),7)
 Q S
CRO(RN,EXT,SS) //ТОЛЬКО СРАВНИТЬ
 N R,T
 S T=$NA(^mtempBSCOMP($J)),R="^tempoCompBs"
 D ROUTINE^%R(R_"."_EXT,.SS,.err,"CS",0)
 S @T@(RN)=$$rcomp(R,RN)
 Q
COMPLOG() //ОТДАТЬ ПРОТОКОЛ
 N T,S,I,BK S $ZT="COMPLOGerr"
 S T=$NA(^mtempBSCOMP($J)),S="------ Протокол сравнения программ --------",I="",BK=$C(13,10)
 F  S I=$O(@T@(I)) Q:I=""  I I'["tempBS",'$G(@T@(I)) S S=S_BK_I_" новая "_$S($G(@T@(I))=0:"версия",1:"")
 K @T
 Q S_BK_"--------------"_BK
COMPLOGerr Q "------ Протокол сравнения программ --------<MXSTR>!!!!!!"
 ///////////////Символы для браузеров
check1() //checkBOX
 Q "<FONT face='Wingdings' >ю</FONT> "
check0() //checkBOX
 Q "<FONT face='Wingdings' >Ё</FONT> "
SYMBOL //ВЫВЕСТИ ВСЕ СИМВОЛЫ
 D BEG1^%ZAPM.ed.BSC4 W $$TITL^%ZAPM.ed.BSCGIS("Step1 for NewTabel"),$$B27^%ZAPM.ed.BSCGIS(1)
 S F="Webdings" D  F II=""," 2"," 3" S F="Wingdings"_II D
 .W BBK_RED_F_EF_BBK
 .F I=1:1:255 W "<FONT face='"_F_"' TITLE='FontFace="_F_" symbol="_I_"'>"_$C(I)_"</FONT> "
 W "<HR>",! w BK F I=9332:1:9839 W "<FONT TITLE='"_I_"'>&#"_I_";</FONT>" 
 D BUTT^%ZAPM.ed.BSCGIS,END^%ZAPM.ed.BSC4
 Q
S(F,C,s) I F=1 S F="Webdings"
 E  S F="Wingdings"_F
 Q "<FONT face='"_F_"' size='"_$G(s,3)_"' >"_$C(C)_"</FONT>"
 
spell ;TRANSLATE FOX2MUMPS ONIX ;[ 01/17/06   4:21 PM ]
 ;;GENERATED from 14012000;1493052321 MGR,REC spell v1 17Jan06 4:21pm
 ;ПО МОТИВАМ Newsgroups: fido7.ru.foxpro
 ;СУММА ПРОПИСЬЮ...
 ;что добавить? вынести числа прописью в отдельную переменную, для
 ;того что бы транслироватть на другие языки.ru.ua..:
 ;и добавить цикл в переменные
 ;  for i="0c","1c",... s n=$$repl(i,var(i))
 w !,"num:" r num
 w !,"sump:",$$sump(num)
 q
 ;
sump(n) ;$$;преобразование
 s n=+$j($tr(n,","),"",2)
 ;w !,$fn(num,",",2),!
 s n=$$tran(n)_"k"
 ;составляем разряды
 s n=$$repl(n,",,,,,,,","eT")
 s n=$$repl(n,",,,,,,","eM")
 s n=$$repl(n,",,,,,","em")
 s n=$$repl(n,",,,,","et")
 s n=$$repl(n,",,,","e")
 s n=$$repl(n,",,","d")
 s n=$$repl(n,",","c")
 ;убрать пустые значения
 s n=$$repl(n,"0c0d0eT","")
 s n=$$repl(n,"0c0d0et","")
 s n=$$repl(n,"0c0d0em","")
 s n=$$repl(n,"0c0d0eM","")
 ;заменяем соответвующие значения на пропись
 s n=$$repl(n,"0c","")
 s n=$$repl(n,"1c","сто ")
 s n=$$repl(n,"2c","двести ")
 s n=$$repl(n,"3c","триста ")
 s n=$$repl(n,"4c","четыреста ")
 s n=$$repl(n,"5c","пятьсот ")
 s n=$$repl(n,"6c","шестьсот ")
 s n=$$repl(n,"7c","семьсот ")
 s n=$$repl(n,"8c","восемьсот ")
 s n=$$repl(n,"9c","девятьсот ")
 ;
 s n=$$repl(n,"1d0e","десять ")
 s n=$$repl(n,"1d1e","одиннадцать ")
 s n=$$repl(n,"1d2e","двенадцать ")
 s n=$$repl(n,"1d3e","тринадцать ")
 s n=$$repl(n,"1d4e","четырнадцать ")
 s n=$$repl(n,"1d5e","пятнадцать ")
 s n=$$repl(n,"1d6e","шестнадцать ")
 s n=$$repl(n,"1d7e","семьнадцать ")
 s n=$$repl(n,"1d8e","восемнадцать ")
 s n=$$repl(n,"1d9e","девятнадцать ")
 ;
 s n=$$repl(n,"0d","")
 s n=$$repl(n,"2d","двадцать ")
 s n=$$repl(n,"3d","тридцать ")
 s n=$$repl(n,"4d","сорок ")
 s n=$$repl(n,"5d","пятьдесят ")
 s n=$$repl(n,"6d","шестьдесят ")
 s n=$$repl(n,"7d","семьдесят ")
 s n=$$repl(n,"8d","восемьдесят ")
 s n=$$repl(n,"9d","девяносто ")
 ;
 s n=$$repl(n,"0e","")
 s n=$$repl(n,"5e","пять ")
 s n=$$repl(n,"6e","шесть ")
 s n=$$repl(n,"7e","семь ")
 s n=$$repl(n,"8e","восемь ")
 s n=$$repl(n,"9e","девять ")
 ;
 s n=$$repl(n,"1e.","один рубль ")
 s n=$$repl(n,"2e.","два рубля ")
 s n=$$repl(n,"3e.","три рубля ")
 s n=$$repl(n,"4e.","четыре рубля ")
 s n=$$repl(n,"1et","одна тысяча ")
 s n=$$repl(n,"2et","две тысячи ")
 s n=$$repl(n,"3et","три тысячи ")
 s n=$$repl(n,"4et","четыре тысячи ")
 s n=$$repl(n,"1em","один миллион ")
 s n=$$repl(n,"2em","два миллиона ")
 s n=$$repl(n,"3em","три миллиона ")
 s n=$$repl(n,"4em","четыре миллиона ")
 s n=$$repl(n,"1eM","один милиард ")
 s n=$$repl(n,"2eM","два милиарда ")
 s n=$$repl(n,"3eM","три милиарда ")
 s n=$$repl(n,"4eM","четыре милиарда ")
 s n=$$repl(n,"1eT","один триллион ")
 s n=$$repl(n,"2eT","два триллиона ")
 s n=$$repl(n,"3eT","три триллиона ")
 s n=$$repl(n,"4eT","четыре триллиона ")
 ;копейки
 s n=$$repl(n,"11k","11 копеек")
 s n=$$repl(n,"12k","12 копеек")
 s n=$$repl(n,"13k","13 копеек")
 s n=$$repl(n,"14k","14 копеек")
 s n=$$repl(n,"1k","1 копейка")
 s n=$$repl(n,"2k","2 копейки")
 s n=$$repl(n,"3k","3 копейки")
 s n=$$repl(n,"4k","4 копейки")
 ;пустые позиции
 s n=$$repl(n,"et","")
 s n=$$repl(n,"em","")
 s n=$$repl(n,"eM","")
 s n=$$repl(n,"eT","")
 ;если число <1
 s:$p(n,".")="" n="ноль "_n
 ;
 s n=$$repl(n,".","рублей ")
 s n=$$repl(n,"t","тысяч ")
 s n=$$repl(n,"m","миллионов ")
 s n=$$repl(n,"M","милиардов ")
 s n=$$repl(n,"T","триллионов ")
 s n=$$repl(n,"k"," копеек")
 ;НЕРАСПОЗНАННЫЕ ОСТАТКИ ОТ ПРЕОБРАЗОВАНИЯ
 s n=$tr(n,".ecdtmMkT")
 ;w !,n
 q n
 ;
tran(n) ;$$;приводим в форму пригодную для замены
 s n=$tr($j(n,18,2)," ","0")
 s n=$tr("q,w,,e,,,,,,,r,t,,y,,,,,,u,i,,o,,,,,p,a,,s,,,,d,f,,g,,,.hj","qwertyuiopasdfg.hj",n)
 ;w !,n
 q n
 ;
TR(%1,%2,%3) N p,l,l3 ;ТРАНСФОРМАЦИЯ !!!!!
 I %2="" Q %1
 I %1'[%2 Q %1
 S p=1,l=$L(%2),l3=$L(%3),%z=$ZT,$ZT="TRMAX^%ZAPM.ed.BSsFUNM"
 F  S p=$F(%1,%2,p) Q:p=0  S $E(%1,p-l,p-1)=%3,p=p+l3-l
 S $ZT=$G(%z) Q %1
 
repl(s,s0,sn) ;$$; поиск s0 замена в строке s строкой sn  ---- $$TR^%ZAPM.ed.BSsFUNM
 S $ZT="TRMAX^%ZAPM.ed.BSsFUNM"
 f  q:s'[s0  s s=$p(s,s0,1)_$g(sn)_$p(s,s0,2,1E9)
 q s
 ;
T1 //ТЕСТ ЭФФЕКТИВНОСТИ
 S B="12213330901901-343143434109023914-2-01234-2314242-0-201114-211410"
 S A=$P($ZTIMESTAMP,",",2)
  F I=1:1:100000 D
  .S B=$$repl(B,"1"," ONE ")
  .;S B=$$TR(B,"1"," ONE ")
  W !,$P($ZTIMESTAMP,",",2)-A," сек."
 
BUTTBSWV(ROU,GIF,FNAME,TIT,H,W) 
 D Exec^%ZAPM.ed.BSCp
 Q "<BUTTON onclick="" "_$$WebView^%ZAPM.ed.BSCp2("http://"_$$ADDSN^%ZAPM.ed.BSC4_$$ADDBSGET^%ZAPM.ed.BSC4(,ROU))_" "" title='"_TIT_"'><img src='"_BSDOMAIN_"/img/"_$G(GIF,"ham-red.gif")_"' border=0></BUTTON>"_BK
 
BUTTBS(ROU,GIF,FNAME,TIT,H,W,TXT)
 Q "<BUTTON onclick=""open('"_$$ADDBSGET^%ZAPM.ed.BSC4(,ROU)_"','"_FNAME_"','toolbar=no,menubar=no,scrollbars=yes,width="_$G(W,800)_",height="_$G(H,500)_",status=1,resizable=1');"" title='"_TIT_"'><img src='"_BSDOMAIN_"/img/"_$G(GIF,"ham-red.gif")_"' border=0>"_$G(TXT)_"</BUTTON>"_BK
BUTTHR(HREF,GIF,FNAME,TIT,H,W)
 Q "<BUTTON onclick=""open('"_HREF_"','"_FNAME_"','toolbar=no,menubar=no,scrollbars=yes,width="_$G(W,800)_",height="_$G(H,500)_",status=1,resizable=1');"" title='"_TIT_"'><img src='"_BSDOMAIN_"/img/"_$G(GIF,"ham-red.gif")_"' border=0></BUTTON>"_BK
 
GetHDSerial() S $ZT="EGetHDSerial"
  n T s T=$$CacheSysDir^%ZAPM.ed.BSCp("\bin\") 
  q $zf(-3, T_"\ekHDSN.dll", "GETHDSERIAL")
EGetHDSerial Q "-1"
Ab64e(s,k) q $tr($System.Encryption.AESBase64Encode(s,$g(k,"mSw")),"+=/"_$c(32,13,10),"_-$~@^")
Ab64d(s,k) q $System.Encryption.AESBase64Decode($tr(s,"_-$~@^","+=/"_$c(32,13,10)),$g(k,"mSw"))
b64e(s) q $tr($System.Encryption.Base64Encode(s),"+=/"_$c(32,13,10),"_-$~@^")
b64d(s) q $System.Encryption.Base64Decode($tr(s,"_-$~@^","+=/"_$c(32,13,10)))
WebPort() q $p($g(^%ZAPM.ed.BS("Startup","WebServer"),"ON,8972"),",",2)
TKWEBPort() q $$GETOPT^%ZAPM.ed.BSC4cfgP("^%ZAPM.ed.BSETUP(""ISS"")","Atkweb")
 
GetA(BSLOGIN,BSarm,b64) //вернуть права доступа
 n r,M //код права доступа
  s r=3 //пока так
  //смешать все версии АРМа для групп пользователей и прочитать $$GetValTree^%ZAPM.ed.BSCtree(g,"B1")
 n WG,AR,G,HSS,MA,SM,US,bST,g,gg
 D VAR^BSadmin,VARTREE^BSissJ
 D MENU^BSadmin(.M)
 i '$d(M(BSarm)) q "N"
 s b64=$$Ab64d(b64)
 s r="M("""_BSarm_""","_b64 i $g(@r)="" q "N"
 q $$GetA^%ZAPM.ed.BSCtree($$GetValTree^%ZAPM.ed.BSCtree(@r,"B1"))
l //список переменных 
 D locvar^%ZAPM.ed.BSCh0("",1)
 Q 
 ///////////////////////////////////////////////////////////////////////
CSS //<!--ВЫТАЩИТЬ ВСЕ BS-ПЕРЕМЕННЫЕ И ПРИМЕНИТЬ ТЕКУЩИЕ СТИЛИ
 D BSREST
 D MAINVAR^%ZAPM.ed.BSC4,GRA^%ZAPM.ed.BSC4 N BSGRANT
 W $$STYLE^%ZAPM.ed.BSC4  S %("HOST:")=$ZU(110)_":"_$$TKWEBPort()
 Q
BSREST N name,index 
 s name = ""
 for  
 {
    s name = $order(%request.Data(name)) 
    q:name=""
    continue:'(name?1"BS".E)
    s index = ""
    for  
    {
        s index = $order(%request.Data(name,index))
        q:index=""
        ;w "<br>" 
        ;w "name = "_name_"///index = "_index_"///value = "_%request.Get(name,,index)
        S @name=%request.Get(name,,index)
    }    
 }
 Q
RESTALL(s) //восановить все переменные из реквеста
 N name,index 
 i $g(s)="s" g resses
 s name = ""
 for  
 {
    s name = $order(%request.Data(name)) 
    q:name=""
    //continue:'(name?1"BS".E)
    s index = ""
    for  
    {
        s index = $order(%request.Data(name,index))
        q:index=""
        w "<li>" w name_"  ,index="_index_"   ,value="_%request.Get(name,,index)
      //  S @name=%request.Get(name,,index)
    }    
 }
 Q ""
resses //из сессии
 s name = ""
 for  
 {
    s name = $order(%session.Data(name)) 
    q:name=""
    //continue:'(name?1"BS".E)
    s index = ""
    for  
    {
        s index = $order(%session.Data(name,index))
        q:index=""
        w "<li>" w name_"  ,index="_index_"   ,value="_%session.Get(name,,index)
      //  S @name=%request.Get(name,,index)
    }    
 }
 Q ""
 
lp(ClassName,pr) //list property from %BSCRG1 //получить свойства у класса 
 n %objlasterror,i,pro,s,count,ii,ClassOref,NORM,a
  s ClassOref=##class(%Library.ClassDefinition).%OpenId(ClassName)
  g:'ClassOref lpe
  s count=ClassOref.Properties.Count()
  s pro=ClassOref.Description
  f i=1:1:count d
  .s pro(i)=ClassOref.Properties.GetAt(i).Name 
  .s a=$$FindDesc^%occName(ClassName,"a",pro(i))
  .s so=+$p(a,";",2) 
  .s pro(i,"filt")=$p(a,";",3) //это фильтр для формы редактирования
  .s pro(i,"spec")=$p(a,";",4)
  .s pro(i,"w")=$p(a,";",5)
  .s pro(i,"prof")=$tr($p(a,";",6),"()")
  .s s=$$NORM^%ZAPM.ed.BSCrr(so,3)_$$NORM^%ZAPM.ed.BSCrr(i,3),s(s)=i,a=$p(a,";")
  .s pro(i,"desc")=a
  .s pro(i,"type")=ClassOref.Properties.GetAt(i).Type
 d ClassOref.%Close()
  S i="",pr=pro F  S i=$O(s(i)) Q:i=""  s pr(i)=pro(s(i)) f ii="desc","type","filt","spec","w","prof" i $g(pro(s(i),ii))'="" s pr(i,ii)=pro(s(i),ii)
lpe i $g(%objlasterror)'="" w !,"Ошибка! :"_$System.Status.GetErrorText(%objlasterror)
 q
]]></Routine>


<Routine name="%ZAPM.ed.BSCpool" type="MAC" languagemode="0"><![CDATA[
%BSCpool ;работа со спулером
 ;
 ; Copyright (c) Serge W. Mikhaylenko
 ; All Rights Reserved
 ;
 Q
COPY2BSSES(US,ID,BST) Q:US'=2  Q:$G(%BS(40))=""  
 N BSSES
 S BSSES=%BS(40)
 D MAINVAR^%ZAPM.ed.BSC4 
 I $D(^SPOOL(ID)) D Spool2BSSES(ID,BST)
 Q
Spool2BSSES(ID,BST) //Копировать из спулера в переменную окружения сессии
 N last
 s last=$O(^SPOOL(ID,""),-1) I last="" Q
 I ^SPOOL(ID,last)="" k ^SPOOL(ID,last)
 I $G(BSSES)="" Q
 M @BDSES@(BSSES,"VAR","SPOOL",BST)=^SPOOL(ID)
 K ^SPOOL(ID)
 Q
Spool2Mass(ID,GL) //Копировать из спулера в переменную окружения сессии
 N last
 s last=$O(^SPOOL(ID,""),-1)
 I ^SPOOL(ID,last)="" k ^SPOOL(ID,last)
 M @GL=^SPOOL(ID)
 K ^SPOOL(ID)
 Q
Test(a) w !!,a,! q a  //это тест
OutSpool(What)  //вывод в спулер
 n io,file,start,last
     s io=$IO,$ZT="OutErr"
     s file=+$J
     s start=1
     k ^SPOOL(file)
     o 2:(file:start)
     u 2
     x What
     u io
     c 2
     s last=$O(^SPOOL(file,""),-1)
     k ^SPOOL(file,last)
     Quit $na(^SPOOL(file))
OutErr U io C 2
 Q $na(^SPOOL(file))
TT S A="W $$rcomp^%Wr1(""%SYS"",""%SYS"",""%BSCSVV.INT"",""%BSCSVVold.INT"")"
 S B=$$OutSpool(A)
 D ^%ZAPM.ed.BSMSMG(B)
 Q
 
T //TEST
 S A="ZL %BSTM P  "
 S B=$$OutSpool(A)
 D ^%ZAPM.ed.BSMSMG(B)
 Q
 /* ------------------------------------------------------------------
 Message: 6         
   Date: Thu, 09 Dec 2004 15:12:31 +0300
   From: Eugene Karataev <ekarataev@mail.ru>
Subject: Re[2]: "Memory" Cache I/O Device
 
Добрый день.
 
> > Не поможете со следующей ситуацией:
> > Вызывается некоторый метод класса, пишущий в
> > Current I/O device.
> > Необходимо перехватить данный вывод (затем обработь
> > как целое).
 
Нужно сделать 
1) отдельную рутину, в которой будет делаться такой перехват
2) указать девайсу эту рутину в команде use
3) включить это перенаправление
 
Делается это так.
rstr(len,to)
 D $ZU(82,12,0)
 if $D(len)&&$D(to) d
 . R data#len:to
 e  i $D(len) d
 . R data#len
 e  i $D(to) d
 . R data:to
 e  d
 . R data 
 D $ZU(82,12,1)
 Q $G(data)
rchr(to)
 D $ZU(82,12,0)
 R *data 
 D $ZU(82,12,1)
 Q data
 // W expr
wstr(expr) 
 D $ZU(82,12,0)
 W $$Перекодируем(expr)
 D $ZU(82,12,1)
 Q
 // W *expr      
wchr(expr) 
 D $ZU(82,12,0)
 W *expr
 D $ZU(82,12,1)
 Q
 // W ?expr
wtab(expr)
 D $ZU(82,12,0)
 W ?expr
 D $ZU(82,12,1)
 Q
 // W !
wnl
 D $ZU(82,12,0)
 W ! 
 D $ZU(82,12,1)
 Q
 // W #
wff
 D $ZU(82,12,0)
 W # 
 D $ZU(82,12,1)
 Q  
 
И используем так.
 
        u dev::"^ПЕРЕХВАТЧИК" ; указываем какую мнемонику использовать
        D $ZU(82,12,1)   ; реально включаем флаг использования
        d normal() ; что будет писать в текущий девайс
        D $ZU(82,12,0)   ; перед закрытием девайса возвращаем флажок
        c dev
 
У себя мы такое использовали для выдачи csp страниц
в кодировке ISO8859-5, хотя вся разработка велась
в win1251. В каше 5 такие трюки используются например в ^%XDTM2.
 
Хотя, если неохота связываться с подозрительными $zu,
то можно включить вывод в спулер, и потом поднять из него.
Будет примерно то же самое что сначала в файл, потом из него,
только через глобаль.
 
С уважением,
Евгений Каратаев.
Фирма Эскейп
 
 
________________________________________________________________________
_______________
 */ 
]]></Routine>


<Routine name="%ZAPM.ed.BSCrr" type="MAC" languagemode="0"><![CDATA[
%BSCrr ; пpогpамма работы с Rational Rose
 ;
 ;    Copyright Serge W. Mikhaylenko
 ;    All Rights Reserved
 ;
 w "пpогpамма управления программами"
 Q
RR D BEG1^%ZAPM.ed.BSC4 W $$TITL^%ZAPM.ed.BSCGIS("Import from Rational Rose"),$$B27^%ZAPM.ed.BSCGIS(1)
 ;I $$File2Arr^%ZAPM.ed.BSCEXE("N:\InfoPortal\WebNodes\b4y\docs\ReadmePTL2BS.htm",.Mas1) S f1="" F  S f1=$O(Mas1(f1)) Q:f1=""  W Mas1(f1)
 I $P($$HTTP^%ZAPM.ed.BSCmail("http://"_$$ADDSN^%ZAPM.ed.BSC4_"/b4y/docs/RotionalRose2BS-Portal.htm",2,.OUT)," ",2)=200  D
 .S f1="" F  S f1=$O(OUT("Data",f1)) Q:f1=""  W $G(OUT("Data",f1))
 
  //UPLOAD FILE TO SERVER
 S BSS1=""
 S BSS6="FILE1^~BSCrr" //ПРОГРАММА КОТОРАЯ ИСПОЛНЯЕТСЯ ПОСЛЕ ЗАГУЗКИ ФАЙЛА
 S BS1="" ;$TR(##class(%File).NormalizeDirectory(Tmp1)_$$ZCRC(PT_BSNODE_nf),":\","^~")
 S BS2="" ;nf,
 S BSS3=BSSES,BS3=MGWLIB,BSS8=$$BSADDVAR^%ZAPM.ed.BSC4(),BSS4="" ;x
 D UP^%ZAPM.ed.BSC4r3
 Q
END D BUTT^%ZAPM.ed.BSCGIS,END^%ZAPM.ed.BSC4
 Q
FILE1 D BEG1^%ZAPM.ed.BSC4 W $$TITL^%ZAPM.ed.BSCGIS("Import from Rational Rose. Step 2"),$$B27^%ZAPM.ed.BSCGIS(1)
 W RED_$G(FiNa)_EF_BBK
 ;N Mas,M,STOP,OC,O,OCC,GU,S,SS
 M Mas=@GL K @GL //МАССИВ В КОТОРОМ ЛЕЖИТ ЗАГРУЖЕННЫЙ ФАЙЛ
 S NoCloseWin=1 //ФЛАГ=НЕ ЗАКРЫВАТЬ ОКНО
 //ИМПОРТИРОВАТЬ СТРУКТУРУ ИЗ root_usecase_package 	(object Class_Category "Use Case View"
 //РАБОЧИХ ГРУПП=ACTORS, 
 //СОСТАВНЫХ ГРАНДОВ=PACKAGE
 //АТОМАРНЫХ ГРАНДОВ=USE_CASE
 S N1="root_usecase_package 	(object Class_Category ""Use Case View""" //НАЧАЛО
 S N2="(object Class_Category ""Logical View""" //КОНЕЦ
 S OC="(object Class ",OCC="(object Class_Category "
 S I="",S="" F i=1:1 S I=$O(Mas(I)) Q:I=""  D  Q:$G(STOP)
 .I i>1&(i<6) S S=S_Mas(I)
 .I Mas(I)[N1 S M(I)="" Q  ;Mas(I)
 .I $D(M) S M(I)=Mas(I) ;W "<LI>"_M(I)
 .I Mas(I)[N2 S STOP=1 Q
  I '$D(M) G DENID
 
 S I="",STOP=0 F  S I=$O(M(I)) Q:I=""  D  Q:$G(STOP)  //ОСНОВНЫЕ ПАРАМЕТРЫ USE CACE VIEW
 .I M(I)["("  S STOP=1 Q
 .S II=$P($TR(M(I),$C(13,10,9))," ") I II="" Q
 .I II="documentation",M(I)'[$C(34) D  S I=III Q
 ..S III=I F ii=1:1 S III=$O(M(III)) Q:III=""  Q:M(III)'["|"  S SS(III)=$P(M(III),"|",2,99) S:ii=1 SS=$P(M(III),"|",2,99)
 .I II="documentation" S SS=$P(M(I),$C(34),2) 
 S TIT=$$TIT(SS) I TIT="" W RED_"Не определен имя ГРАНДА!!!"_EF G DENID
 
 W GREEN_S_EF_BBK W "Обнаружены следующие объекты"
 K STOP S I="",STOP=0 F  S I=$O(M(I)) Q:I=""  D  Q:$G(STOP)
 .I M(I)["root_category" S STOP=1 Q
 .D REC(0,OC,"O(1)")
 .D REC(1,OCC,"O(0)")
 
 N V,VV
 K STOP S I="",STOP=0 F  S I=$O(M(I)) Q:I=""  D  Q:$G(STOP)
 .I M(I)["root_category" S STOP=1 Q
 .D REC1("(object DependencyView ","V")
  K STOP S I="",STOP=0 F  S I=$O(M(I)) Q:I=""  D  Q:$G(STOP)
 .I M(I)["root_category" S STOP=1 Q
 .D REC1("(object ClassView ""Class"" ","VV")
  K STOP S I="",STOP=0 F  S I=$O(M(I)) Q:I=""  D  Q:$G(STOP)
 .I M(I)["root_category" S STOP=1 Q
 .D REC1("(object CategoryView ","VV")
 D GPAR(.V),GPAR(.VV)
 
 S G="" F  S G=$O(O(0,G)) Q:G=""  K M M M=O(0,G) K O(0,G) S O(0,G)="" D
 .K STOP S I="",STOP=0 F i=1:1 S I=$O(M(I)) Q:I=""  D  Q:$G(STOP)
 ..I i=1 Q  //ПРОПУСТИМ ПЕРВУЮ СТРОКУ
 ..D REC(0,OCC,$NA(O(0,G)))
 S GG="" F  S GG=$O(O(0,GG)) Q:GG=""  S G="" F  S G=$O(O(0,GG,G)) Q:G=""  K M M M=O(0,GG,G) K O(0,GG,G) S O(0,GG,G)="" D
 .K STOP S I="",STOP=0 F i=1:1 S I=$O(M(I)) Q:I=""  D  Q:$G(STOP)
 ..I i=1 Q  //ПРОПУСТИМ ЕЩЕ ПЕРВУЮ СТРОКУ
 ..D REC(0,OCC,$NA(O(0,GG,G)))
 W BBK_GREEN_"Cтруктура ГРАНДОВ И ПУНКТОВ МЕНЮ:"_EF_BBK
 D STR(0)
 S G="" F  S G=$O(O(1,G)) Q:G=""  D  I '$G(OK) K O(1,G)
 .S s="",OK=0  F  S s=$O(O(1,G,s)) Q:s=""  I O(1,G,s)["stereotype",O(1,G,s)["Actor" S OK=1 Q
 S OCC="(object Dependency_Relationship"
  S G="" F  S G=$O(O(1,G)) Q:G=""  K M M M=O(1,G) K O(1,G) S O(1,G)="" D
 .K STOP S I="",STOP=0 F i=1:1 S I=$O(M(I)) Q:I=""  D  Q:$G(STOP)
 ..I i=1 Q  //ПРОПУСТИМ ПЕРВУЮ СТРОКУ
 ..D REC(0,OCC,$NA(O(1,G)))
 S G="" F  S G=$O(GU(G)) Q:G=""  D  //РАЗОБРАТЬ ПАРАМЕТРЫ У ОБЪЕКТОВ
 .S I=0,STOP=0 F i=1:1 S I=$O(GU(G,I)) Q:I=""  D  Q:STOP
 ..I i=1 S nOC=$P($P(GU(G,I),"object ",2)," ") S GU(G,0,0)=nOC Q
 ..I GU(G,I)["("  S STOP=1 Q
 ..S II=$P($TR(GU(G,I),$C(13,10,9))," ") I II="" Q
 ..I II="documentation",GU(G,I)'[$C(34) D  S I=III Q
 ...S III=I F ii=1:1 S III=$O(GU(G,III)) Q:III=""  Q:GU(G,III)'["|"  S GU(G,0,II,III)=$P(GU(G,III),"|",2,99) S:ii=1 GU(G,0,II)=$P(GU(G,III),"|",2,99)
 ..S GU(G,0,II)=$P(GU(G,I),$C(34),2) 
 
  S I="" F  S I=$O(V(I)) Q:I=""  D  //ПОСТРОИЛИ ПОДЧИНЕННОСТЬ ПО ДИАГРАММЕ
 .S G=$TR($G(V(I,0,"client")),"@") I G="" Q
 .S GG=$G(VV(G,0,"quidu")) Q:GG=""  I $G(GU(GG,0,"stereotype"))'="Actor" Q
 .S G=$TR($G(V(I,0,"supplier")),"@") I G="" Q
 .S G=$G(VV(G,0,"quidu")) I G="" Q
 .S O(8,GG,G)=$TR($G(GU($G(V(I,0,"quidu")),0,"documentation")),$C(13,10,9,32,34)) //ПРАВА ЗАВИСИМОСТИ
 K O(1) M O(1)=O(8) K O(8)
 M O(10)=VV S O(10)="ДИАГРАММА - КЛАССЫ И КАТЕГОРИИ"
 M O(9)=V  S O(9)="ДИАГРАММА - ЗАВИСИМОСТИ"
 
 W BBK_GREEN_"Cтруктура ПОЛЬЗОВАТЕЛЕЙ И ИХ ПРАВ ДОСТУПА К ПУНКТАМ МЕНЮ:"_EF_BBK
 D STR1  I STOP G DENID
 S BSSES=BSS3,BSLOGIN=$P(BSS8,"@",10),O(4)=FiNa,O(2)=S M O(3)=SS
 K @BDSES@(BSSES,"VAR","RRObj") M @BDSES@(BSSES,"VAR","RRObj")=O   ;K ^XXX M ^XXX=O ;ДЕРЕВО ПОДЧИНЕННОСТИ
 K @BDSES@(BSSES,"VAR","RRGuid") M @BDSES@(BSSES,"VAR","RRGuid")=GU ;  K ^XXG M ^XXG=GU ;ПАРАМЕТРЫ GUID
 w "<form action="""_$$ADDLIB^%ZAPM.ed.BSC4()_""" method=""POST"">"
 S BSLABEL="Form^~BSCrr"
 D ADDBSPOST^%ZAPM.ed.BSC4reg
 w "<input type=submit name=sDUB value='Создать профили рабочих групп, Гранды и пункты меню' title=''>"_BK
 w "</form>"
 W "<HR>" G END
STR1  S I="",STOP=0 F  S I=$O(O(1,I)) Q:I=""  W "<LI>"_$$WG(I)_"</LI>"_BK D
 .S AA=$$Par($$WG(I,,"documentation"),"ShortName:") w " ("_GREEN_AA_EF_")" I AA="" W RED_"Неправильно Определен параметр ShortName:(НЕ ДОЛЖЕН БЫТЬ ПУСТОЙ)"_EF S STOP=1
 .W "<UL>"_BK S II="" F  S II=$O(O(1,I,II)) Q:II=""  W "<LI>"_$G(GU(II))_"</LI>"_BK 
 .W "</UL>"_BK
 Q 
GPAR(GU) N STOP,G,I,II,III,i,ii,nOC S G="" F  S G=$O(GU(G)) Q:G=""  D  //РАЗОБРАТЬ ПАРАМЕТРЫ У ОБЪЕКТОВ ДИАГРАММЫ
 .S I=0,STOP=0 F i=1:1 S I=$O(GU(G,I)) Q:I=""  D  Q:STOP
 ..S II=$P($TR(GU(G,I),$C(13,10,9))," ") I II="" Q
 ..F ii="quidu","client","supplier" I II=ii S GU(G,0,II)=$TR($P(GU(G,I),ii,2,3),$C(32,34,10,13,9))
 Q
REC1(OCC,R) N nOC,OS,ZS,GUID //РАЗБОР ДИАГРАММЫ
 I M(I)[OCC D  Q
 .S II=I,nOC=$TR($P(M(I)," ",$L(M(I)," ")),"@"_$C(13,10,9,34)),(OS,ZS)=0
 .;S GUID=$$GUID(M(I+1)) .W "<LI>"_nOC_" "_GUID_BBK
 .;S @R@(GUID)=nOC 
 .D  F  S II=$O(M(II)) Q:II=""  D  I ((OS-ZS)<1)  Q  ;W "<LI>"_nOC_"---"_OS_" "_ZS_BBK Q
 ..S @R@(nOC,II)=M(II),OS=OS+$L(M(II),"(")-1,ZS=ZS+$L(M(II),")")-1 ;W GREEN_II_EF_"."
 .;M GU(GUID)=@R@(GUID) S GU(GUID)=nOC 
 .Q:II=""  S I=II ;W RED_I_EF
 Q 
VO(TIT)  M O=@GB@(TIT,"O") M GU=@GB@(TIT,"G")
 Q
VAR  S GB=$$SW^%ZAPM.ed.BSF12("^%ZAPM.ed.BSCRrose")
 S BDG=$$KBD^%ZAPM.ed.BSF12("^%ZAPM.ed.BSC4(""GRAND"")")
 S BDP=$$KBD^%ZAPM.ed.BSF12("^%ZAPM.ed.BSC4(""Profile"")")
 Q 
Form D BEG1^%ZAPM.ed.BSC4 W $$TITL^%ZAPM.ed.BSCGIS("Import from Rational Rose. Step 3"),$$B27^%ZAPM.ed.BSCGIS(1)
 M O=@BDSES@(BSSES,"VAR","RRObj") S O="ДЕРЕВО ПОДЧИНЕННОСТИ",O(1)="ПОЛЬЗОВАТЕЛИ" 
 M GU=@BDSES@(BSSES,"VAR","RRGuid") S GU="ПАРАМЕТРЫ GUID",O(0)="КАТЕГОРИИ"
 D VAR 
 S TIT=$$TIT(O(3)) W TIT
 S O(11)="СООТВЕТСТВИЕ КОРОТКОГО ИМЕНИ И ЕГО GUID"
 S PR="_"
 S I="" F  S I=$O(O(1,I)) Q:I=""  D
 .S A=$$WG(I),A1=$$Par($$WG(I,,"documentation"),"ShortName:"),AA=PR_A1 
 .S O(11,A1)=I
 .W "<LI>Для новых пользователей группы "_RED_A_EF
 .K @BDP@(AA) S @BDP@(AA,"SOS")="MSM,"_AA_",ISS-???,NAV-ADM,EXC-ADMIN,DFLTMSM"
 .K @BDG@(AA) S @BDG@(AA,"REM")=A,@BDG@(AA,"Z1")="zOpenSess,xMAIL,"_PR_AA
 .S AA=PR_AA 
 .D CreateAtom(AA,A,A1)
 .W " создан профиль "_RED_PR_A1_EF_". Создан составной гранд "_RED_PR_A1_EF_", который включает в себя созданный атомарный гранд "_RED_PR_PR_A1_EF_"."
 S SU="__super"_ShortName
 D CreateAtom(SU,"Администратор","") 
 S SUP="SUPERVISOR"
 W "<HR>Дополнительно создан атомарный гранд "_RED_SU_EF_" и включен в составной гранд "_RED_SUP_EF
 S A=@BDG@(SUP,"Z1") I A'[SU S @BDG@(SUP,"Z1")=$$TR^%ZAPM.ed.BSsFUNM(A,",zProject,",",zProject,"_SU_",")
 W "<HR>Можете редактировать профили и гранды"
  D STY^%ZAPM.ed.BSCm2(0),DIV^%ZAPM.ed.BSCm2(0,"Редактивать системные БД","ОБЩИЕ ПАРАМЕТРЫ КОМПЛЕКСА")
 D   D DI^%ZAPM.ed.BSCm2 
 .N ta
 .s ta=1,ta("GRAND")=1,ta("Profile")=1 //ТОЛЬКО УКАЗАННЫЕ
 .D PARTS^%ZAPM.ed.BSCm("^%ZAPM.ed.BSC4","|",1,.ta)
 W "<HR>Можете создавать нового пользователя: "_$$NEWUSERS^%ZAPM.ed.BSC4rout
 K @GB@(TIT) S @GB@(TIT)=ShortName M @GB@(TIT,"O")=O M @GB@(TIT,"G")=GU
 W "<HR>" G END
 Q
CreateAtom(AA,A,A1)
 K @BDG@(AA) S @BDG@(AA,"REM")=TIT
 S @BDG@(AA,"MENU")="menu^%ZAPM.ed.BSC4b"
 S (@BDG@(AA,"TOPIC1"),@BDG@(AA,"TITLE"))=TIT_" ("_A_")"
 S @BDG@(AA,"PROG")="RRUN^~BSCrr("""_TIT_""","""_A1_""")"
 S @BDG@(AA,"NSP")=$P($P(O(3),"Namespace:",2)," ")
 S @BDG@(AA,"TOPIC")=$P(@BDG@("xTELNET","TOPIC"),">")_">"_TIT
 Q 
Par(TIT,N)  S TIT=$P(TIT,N,2) I TIT[$C(34) S TIT=$P(TIT,$C(34),2)
 E  S TIT=$P(TIT," ",1)
 Q TIT
TIT(TIT) S ShortName=$TR($P($P(TIT,"ShortName:",2)," "),$C(10,13,9))
 S TIT=$P(TIT,"Name:",2) I TIT[$C(34) S TIT=$P(TIT,$C(34),2)
 E  S TIT=$P(TIT," ",1)
 I TIT="" S TIT=$P($P(O(4),"."),"\",$L(O(4),"\"))
 Q TIT
STR(N)  S I="",STOP=0 F  S I=$O(O(N,I)) Q:I=""  W "<LI>"_$$WG(I)_"</LI>"_BK D
 .I N S AA=$$Par($$WG(I,,"documentation"),"ShortName:") w " ("_GREEN_AA_EF_")" I AA="" W RED_"Неправильно Определен параметр ShortName:(НЕ ДОЛЖЕН БЫТЬ ПУСТОЙ)"_EF S STOP=1
 .W "<UL>"_BK S II="" F  S II=$O(O(N,I,II)) Q:II=""  W "<LI>"_$$WG(II,1)_"</LI>"_BK D:'N
 ..W "<UL>"_BK D
 ...S III="" F  S III=$O(O(N,I,II,III)) Q:III=""  W "<LI>"_$$WG(III)_"</LI>"_BK 
 ..W "</UL>"
 .W "</UL>"_BK
 Q
WG(G,GG,PAR) I $G(PAR)'="" Q $G(GU(G,0,PAR))
 I $G(N),$G(GG) Q $G(GU(G,0,"supplier"))
 Q $G(GU(G))
REC(T,OCC,R) N nOC,OS,ZS,GUID
 I M(I)[OCC D  D:$G(T) TEA($NA(@R@(GUID))) Q  //CLASS_CATEGORY ДО UseCaseDiagram ""Main
 .S II=I,nOC=$TR($P(M(I),OCC,2),$C(13,10,9,34)),(OS,ZS)=0,GUID=$$GUID(M(I+1)) ;W "<LI>"_nOC_" "_GUID_BBK
 .S @R@(GUID)=nOC 
 .D  F  S II=$O(M(II)) Q:II=""  D  I ((OS-ZS)<1)  Q  ;W "<LI>"_nOC_"---"_OS_" "_ZS_BBK Q
 ..S @R@(GUID,II)=M(II),OS=OS+$L(M(II),"(")-1,ZS=ZS+$L(M(II),")")-1 ;W GREEN_II_EF_"."
 .M GU(GUID)=@R@(GUID) S GU(GUID)=nOC Q:II=""  S I=II ;W RED_I_EF
 Q 
DENID W RED_"НЕВЕРНЫЙ ФОРМАТ ФАЙЛА!!"_EF
 G END 
GUID(S) I S'["quid " Q "???"
 Q $P(S,$C(34),2) 
TEA(R) N RR W "<TEXTAREA COLS=80 ROWS=6>"
 S RR=R F  S RR=$ZO(@RR) Q:RR'[$E(R,1,$L(R)-1)   W @RR
 W "</TEXTAREA>"
 Q
BUTCLOSE //КНОПКА О ЗАКРЫТИИ ОКНА ДЛЯ OpenWeb.exe при $$B27^%ZAPM.ed.BSCGIS(0)
 N BSocxP0kD S BSocxP0kD=1 D BUTT^%ZAPM.ed.BSCGIS
 Q 
 ///////////////////////////////////////////////////////////////////////////
Tree1 ; D locvar^%ZAPM.ed.BSCh0("",1)
 D VAR,VO(BSTIT) 
 S RO=$$Par($$WG(TrID,,"documentation"),"Routine:") 
 I $G(RO)="" W $$js^%ZAPM.ed.BSCp_BK_"status='Status :CloseWin:'"_BK_$$jse^%ZAPM.ed.BSCp_BK Q
 D BEG1^%ZAPM.ed.BSC4 W $$TITL^%ZAPM.ed.BSCGIS($g(GU(TrID))),$$B27^%ZAPM.ed.BSCGIS(0)
 S MR=$E($$Par($$WG(TrID,,"documentation"),"Mode:"),1) I MR="" S MR="T"
 S NS=$$Par($$WG(TrID,,"documentation"),"Namespace:") I NS="" S NS=BSNSP
 S RI=$G(@BDSES@(BSSES,"VAR","Rights",TrID),"N")
 S RO=$ZCVT(RO,"U") //ВСЕГДА БОЛЬШИМИ БУКВАМИ
 I RO["^" S ROU=$P(RO,"^",2)
 ;S NS="PRG" //?
 W "<li>Routine: "_ROU_"<li>Mode: "_MR_"<li>Namespace: "_NS_"<li>"_RI_BBK
 I $$EXIST^%R(ROU_".INT",NS) d
 .I MR="T" D  Q  //ЗАПУСК В ТЕРМИНАЛЬНОМ РЕЖИМЕ
 ..;I RO["^",$P(RO,"^")="" ;S ROU="^^ULARX5" //_ROU ////? IntRun^???
 ..;E  
 ..S ROU=$$TR^%ZAPM.ed.BSsFUNM(RO,"^","^^")
 ..W BBK_"Запускаем "_ROU
 ..D Exec^%ZAPM.ed.BSCp
 ..W $$js^%ZAPM.ed.BSCp_BK
 ..W $$TELNET^%ZAPM.ed.BSCp2(NS,"#",ROU,$G(GU(TrID)))_BK
 ..W "status='Status :CloseWin:';"_BK
 ..W $$jse^%ZAPM.ed.BSCp_BK
 .I MR="O" D @ROU
 E  W RED_"Программы в рабочей области нет !!!"
 D BUTCLOSE,END^%ZAPM.ed.BSC4
 Q
RRUN(BSTIT,SN)  //УНИВЕРСАЛЬЫЙ ЗАПУСК ПРОГРАММ RR
 N BSLABEL,BSTOP3,BSTOP,BSTOP2
 D BEG1^%ZAPM.ed.BSC4
 D VAR,VO(BSTIT)
 I SN="" W RED_"Включены привелегии Администратора!"_EF
 D Tree
 D END^%ZAPM.ed.BSC4
 Q
Tree
 ;W RED_"<li>Выберите ЗАКАЗЧИКА, тему и раздел темы кликая на + и -"_EF
 ;W RED_"<li>Для отправки сообщения в заказ нужно правой кнопкой мыши выбрать требуемый режим"_EF
 ;D Var^siMSW 
 D TreeStyle,TreeJS
 D CMenuJS("Tree1^~BSCrr",1),ContextMenuGO("ALLTXT")
 D END^%ZAPM.ed.BSC4
 Q
TreeStyle
  Write "",!
	Write "<STYLE>",!
	Write ".button_light {",!
	Write "        BORDER-RIGHT: #bfcfde 1px solid; BORDER-TOP: #bfcfde 1px solid; FONT-SIZE: 12px; BORDER-LEFT: #bfcfde 1px solid; COLOR: #000000; BORDER-BOTTOM: #bfcfde 1px solid;",!
	Write "}",!
	Write ".text_light {",!
	Write "        FONT-SIZE: 14px; COLOR: #000000;",!
	Write "}",!
	Write ".body_grey {",!
	Write "        BACKGROUND-COLOR: #85C0F2; FONT-SIZE: 14px; COLOR: #000000;",!
	Write "}",!
	Write ".tbl_list_user_uti1l {",!
	Write "        FONT-SIZE: 8pt; COLOR: #000000;",!
	Write "}",!
	Write ".body_grey1 {",!
	Write "        BACKGROUND-COLOR: #85C0F2; FONT-SIZE: 8px; COLOR: #000000;",!
	Write "}",!
	Write ".text {",!
	Write "        FONT-SIZE: 9pt; COLOR: #5679af; FONT-FAMILY: Verdana, arial",!
	Write "}",!
	Write ".tariftext {",!
	Write "        FONT-SIZE: 9px; FONT-FAMILY: Verdana, arial; BACKGROUND-COLOR: #f1f1f1",!
	Write "}",!
	Write ".tarif {",!
	Write "        FONT-SIZE: 9px",!
	Write "}",!
	Write ".cmstarif {",!
	Write "        FONT-SIZE: 9px; BACKGROUND-COLOR: #f1f1f1",!
	Write "}",!
	Write ".cmstarif2 {",!
	Write "        FONT-SIZE: 9px; BACKGROUND-COLOR: #e1e1e1",!
	Write "}",!
	Write ".as {",!
	Write "        PADDING-RIGHT: 10px; PADDING-LEFT: 10px; FONT-SIZE: 8pt; PADDING-BOTTOM: 10px; COLOR: #5679af; PADDING-TOP: 10px; FONT-FAMILY: Verdana, arial; align: justify",!
	Write "}",!
	Write "BODY {",!
	Write "        BACKGROUND-IMAGE: url(images/bg2.gif); BACKGROUND-REPEAT: repeat-x",!
	Write "}",!
	Write "A {",!
	Write "        COLOR: #26497f; TEXT-DECORATION: none",!
	Write "}",!
	Write "A:visited {",!
	Write "        COLOR: #26497f; TEXT-DECORATION: none",!
	Write "}",!
	Write "A:hover {",!
	Write "        COLOR: #7699cf; TEXT-DECORATION: none",!
	Write "}",!
	Write "A:active {",!
	Write "        COLOR: #7699cf; TEXT-DECORATION: none",!
	Write "}",!
	Write ".off {",!
	Write "        DISPLAY: none",!
	Write "}",!
	Write ".menu {",!
	Write "        FONT-WEIGHT: bold; FONT-SIZE: 12px; COLOR: #494949; FONT-FAMILY: Tahoma; valign: top",!
	Write "}",!
	Write ".menu:visited {",!
	Write "        COLOR: #494949",!
	Write "}",!
	Write ".menu:hover {",!
	Write "        COLOR: #494949",!
	Write "}",!
	Write ".menu:active {",!
	Write "        COLOR: #494949",!
	Write "}",!
	Write "IMG.blackBorder {",!
	Write "        BORDER-RIGHT: #000 1px solid; BORDER-TOP: #000 1px solid; BORDER-LEFT: #000 1px solid; BORDER-BOTTOM: #000 1px solid",!
	Write "}",!
	Write ".linkator_td {",!
	Write "        FONT-SIZE: 10px; FONT-FAMILY: Verdana",!
	Write "}",!
	Write ".linkator_a {",!
	Write "        FONT-SIZE: 12px; FONT-FAMILY: Verdana",!
	Write "}",!
	Write ".linkator_url {",!
	Write "        FONT-SIZE: 12px; FONT-FAMILY: Verdana",!
	Write "}",!
	Write ".linkator_table {",!
	Write "        BORDER-TOP: #000000 1px solid",!
	Write "}",!
	Write "</STYLE>",!
 
 ;	Write "</HEAD>",!
 ;	Write "<BODY marginwidth='0'   class='body_grey' >",!
	Write "<TABLE id='list' border='0'>",!
	Write "<TR><TD></TD></TR>",!
	Write "</TABLE>",!
    Write "<!-- SSSSSSSSSSSSSSSSSSSS ->",!
    Q
CMenuJS(ROU,ON)
	Write "<STYLE>",!
	Write "#ie5menu{",!
	Write "position:absolute;",!
	Write "border:2px solid black;",!
	Write "background-color:#BBBBBB;",!
	Write "font-family:Courier New;",!
	Write "font-size:15px;",!
	Write "line-height:18px;",!
	Write "cursor:default;",!
	Write "visibility:hidden;",!
	Write "}",!
	Write ".menuitems{",!
	Write "padding-left:15px;",!
	Write "padding-right:15px;",!
	Write "}",!
	Write "</STYLE>",!
  D Exec^%ZAPM.ed.BSCp
	Write "<SCRIPT language=JavaScript1.2>",!
	Write "var display_url=1;",!
	Write "function showmenuie5(){",!
	Write "var rightedge=document.body.clientWidth-event.clientX;",!
	Write "var bottomedge=document.body.clientHeight-event.clientY;",!
	Write "if (rightedge<ie5menu.offsetWidth)",!
	Write "ie5menu.style.left=document.body.scrollLeft+event.clientX-ie5menu.offsetWidth;",!
	Write "if (rightedge >= ie5menu.offsetWidth)",!
	Write "ie5menu.style.left=document.body.scrollLeft+event.clientX;",!
	Write "if (bottomedge<ie5menu.offsetHeight)",!
	Write "ie5menu.style.top=document.body.scrollTop+event.clientY-ie5menu.offsetHeight;",!
	Write "else",!
	Write "ie5menu.style.top=document.body.scrollTop+event.clientY;",!
	Write "ie5menu.style.visibility='visible';",!
	Write "return false;",!
	Write "}",!
	Write "function hidemenuie5(){",!
	Write "ie5menu.style.visibility='hidden';",!
	Write "}",!
	Write "function ReturnFalse(){",!
	Write "return false;",!
	Write "}",!
	Write "function highlightie5(){",!
	Write "if (event.srcElement.className=='menuitems'){",!
	Write "event.srcElement.style.backgroundColor='highlight';",!
	Write "event.srcElement.style.color='white';",!
	Write "if (display_url==1)",!
	Write "window.status=event.srcElement.url;",!
	Write "}",!
	Write "}",!
	Write "function lowlightie5(){",!
	Write "if (event.srcElement.className=='menuitems'){",!
	Write "event.srcElement.style.backgroundColor='';",!
	Write "event.srcElement.style.color='black';",!
	Write "window.status='';",!
	Write "}",!
	Write "}",!
	Write "function jumptoie5(){",!
	Write "if (event.srcElement.className=='menuitems')",!
	Write "window.location=event.srcElement.url;",!
	Write "}",!
  
	Write "function DO(param)",!
	Write "    {",!  
	;Write "    window.open("""_$$ADDBSGET^%ZAPM.ed.BSC4(,ROU)_"""+param"_$S($G(ON):"+""&TrID=""+CurrentElementOfTree",1:"")_","""","""");",!
	W " "_$$OpenWeb^%ZAPM.ed.BSCp2("http://"_$$ADDSN^%ZAPM.ed.BSC4_$$ADDBSGET^%ZAPM.ed.BSC4(,ROU)_"'+param"_$S($G(ON):"+'&TrID='+CurrentElementOfTree",1:""))
	Write "    };",!
	Write "</SCRIPT>",!
	Q
ContextMenuGO(LAB)
	Write "<DIV id=ie5menu onmouseover=highlightie5() style='LEFT: 207px; VISIBILITY: hidden; TOP: 78px' onmouseout=lowlightie5()>",!
	D @LAB
	Write "</DIV>",!
	Write "<SCRIPT language=JavaScript1.2>",!
	Write "document.body.onclick=hidemenuie5;",!
	Write "</SCRIPT>",!
	Write "",!
 Q
ALLPG 	Write "<DIV width='100%' class=menuitems style='COLOR: black' onclick='DO(""&Mode=Check"");' >Помеченные записи в заказ...</DIV>",!
	;Write "<DIV class=menuitems style='COLOR: black' onclick='if(confirm(""Вы уверены?"")){location=""?LBL_=INDEX_tree_editor*tree_editor&TBL_=oldtree&OPEN_=1=0;2=0;3=0;4=0;5=0;6=0;7=0;8=0;9=0;10=0;11=0;12=0;13=0;14=0;15=0;21=0;19=0;20=0;28=0;29=0;30=0;31=0;92=0;81=0;79=0;91=0;90=0;86=0;74=0;88=0;89=0;83=0;93=0;85=0;94=0;95=0;96=0;97=0;98=0;99=0;100=0;101=0;102=0;103=0;104=1;105=0;&SESS=1144240589*41985476&OPENER_RELOAD_=1&TBL_=oldtree&SPEC=DELROW&ID_=""+CurrentElementOfTree+""&OPEN_=""+GetOpen();}' >Удалить</DIV>",!
	Write "<DIV class=menuitems style='COLOR: black' onclick='DO(""&Mode=ALLPG"");' >Все записи страницы в заказ...</DIV>",!
	;I $D(%fmin) Write "<DIV class=menuitems style='COLOR: black' onclick='DO(""&Mode=ALL"");' >Все записи фильтра в заказ...</DIV>",!
	Write "<DIV>-------------</DIV>",!
	Write "<DIV class=menuitems style='COLOR: black' onclick='if(confirm(""Удалить! Вы уверены?"")){DO(""&Mode=KILLALLPG"");}' >Удалить помеченные записи</DIV>",!
	Q 
ALLTXT 	Write "<DIV width='100%' class=menuitems style='COLOR: black' onclick='DO(""&Mode=ANONS"");' >Анонс</DIV>",!
	Write "<DIV class=menuitems style='COLOR: black' onclick='DO(""&Mode=ALLTXT"");' >Весь текст</DIV>",!
	Q 
TreeJS
	Write " <SCRIPT>",!
	Write " var Tree = '';var widgetWidth = 12;var widgetHeight = 12;var CurrentElementOfTree=-1;",!
	Write "var fillerImg = new Image(1,1);fillerImg.src = '"_BSDOMAIN_"/img/ico/filler.gif';minus = new Image(widgetWidth,widgetHeight);minus.src = '"_BSDOMAIN_"/img/ico/minus.gif';var plus = new Image(widgetWidth,widgetHeight);plus.src = '"_BSDOMAIN_"/img/ico/plus.gif';var end = new Image(widgetWidth,widgetHeight);end.src = '"_BSDOMAIN_"/img/ico/end.gif';var pCell=document.getElementById('list').rows[0].cells[0];var BR='';",!
	Write "var db = new Array();",!
	Write "function GetOpen()",!
	Write "{",!
	Write "    var open=';';",!
	Write "    for(var i=0;i<countRow;i++)",!
	Write "              {",!
	Write "                  open+=db[i].id+'='+db[i].open+';';",!
	Write "              }",!
	Write "    open=open.substr(1);",!
	Write "    return open;",!
	Write "};",!
	Write "function SetVisible(i)",!
	Write "{",!
	Write "    db[i].open==0?db[i].open=1*1:db[i].open=0*1;Tree='';GetChild(0,0);pCell.innerHTML=Tree;",!
	Write "};",!
	Write "function dbRecord(id,name,parent,open,tit)",!
	Write "{",!
	Write "    this.id = id;",!
	Write "    this.name = name;",!
	Write "    this.parent = parent;",!
	Write "    this.open = open*1;",!
	Write "    this.tit = tit;",!
	Write "    return this;",!
	Write "};",!
	Write "function GetChild(id,level)",!
	Write "{",!
	Write "   var onclk;",!
	Write "   for(var i=0;i<countRow;i++)",!
	Write "          {",!
	Write "                 if(db[i].parent==id)",!
	Write "      {",!
	Write "      isHaveChild(db[i].id)?(db[i].open==1?ico='minus':ico='plus'):ico='end';",!
	Write "      ico=='end'?onclk='':onclk='SetVisible('+i+');';",!
	Write "      Tree+=(""<IMG SRC='"_BSDOMAIN_"/img/ico/filler.gif' HEIGHT='1' WIDTH='""+level*15+""'>"");",!
	;Write "      Tree+=(""<IMG style='cursor:hand;' onclick='""+onclk+""hidemenuie5();' oncontextmenu='hidemenuie5();return false;' SRC='"_BSDOMAIN_"/img/ico/""+ico+"".gif' HEIGHT='12' WIDTH='12' BORDER='0'>"");",!
	Write "      Tree+=(""<IMG style='cursor:hand;' onclick='""+onclk+""hidemenuie5();' SRC='"_BSDOMAIN_"/img/ico/""+ico+"".gif' HEIGHT='12' WIDTH='12' BORDER='0'>"");",!
	Write "      Tree+=(""<IMG SRC='"_BSDOMAIN_"/img/ico/filler.gif' HEIGHT='1' WIDTH='5'>"");",!
	;Write "      Tree+=""<SPAN  style='cursor:hand;' ONCLICK='alert(CurrentElementOfTree=""+db[i].id+"");' oncontextmenu='CurrentElementOfTree=""+db[i].id+"";showmenuie5();return false;'>""+db[i].name+'</SPAN><BR>'+'\r\n';",!
	Write "      Tree+=""<SPAN title='""+db[i].tit+""' style='cursor:hand; text-decoration:underline;' ONCLICK='DO(CurrentElementOfTree=""+db[i].id+"");' >""+db[i].name+'</SPAN><BR>'+'\r\n';",!
	Write "      if(db[i].open==1){GetChild(db[i].id,level+1)};",!
	Write "      }",!
	Write "    }",!
	Write "    return 0;",!
	Write "};",!
	Write "function isHaveChild(id)",!
	Write "{",!
	Write "   for(var i=0;i<countRow;i++)",!
	Write "          {",!
	Write "                 if(db[i].parent==id){return 1;}",!
	Write "          }",!
	Write "return 0;",!
	Write "}",!
 N SO,OO S NORM=9000 
 I SN'="" D  //КАСТРИРУЕМ ПОЛНОЕ ДЕРЕВО ПОД КАЖДОГО ПОЛЬЗОВАТЕЛЯ
 .K OO(0) S SNG=O(11,SN)
 .S I="" F  S I=$O(O(1,SNG,I)) Q:I=""  D
 ..I $D(O(0,I)) M OO(0,I)=O(0,I)
 ..S OO(0,I)=$g(O(1,SNG,I)) //присвоим права доступа
 .K O(0) M O(0)=OO(0)  
 E  S I="" F  S I=$O(O(0,I)) Q:I=""  S O(0,I)="Rights:RWD"
 K OO
 S I="" F  S I=$O(O(0,I)) Q:I=""  S T=$$NORM($$Par($$WG(I,,"documentation"),"Tag:"),5) S SO(T)=I
 S T="" F  S T=$O(SO(T)) Q:T=""  S I=SO(T) D
 .S (OO(I),RI)=$G(O(0,I))
 .Write "db[db.length] = new dbRecord('"""_I_"""', '"_$g(GU(I))_"', '0', 0,'"_$TR(RI_" "_$$WG(I,,"documentation"),$C(34,10,13))_" id="_I_"');",!
 .S II="" F  S II=$O(O(0,I,II)) Q:II=""  S T2=$$NORM($$Par($$WG(II,,"documentation"),"Tag:"),5) S SO(T,T2)=II
 .S T2="" F  S T2=$O(SO(T,T2)) Q:T2=""  S II=SO(T,T2) D
 ..S RI1=$G(O(0,I,II)) I RI1="" S (OO(II),O(0,I,II),RI1)=RI
 ..Write "db[db.length] = new dbRecord('"""_II_"""', '"_$g(GU(II))_"', '"""_I_"""', 1,'"_$TR(RI1_" "_$$WG(II,,"documentation"),$C(34,10,13))_" id="_II_"');",!
 ..S I2="" F  S I2=$O(O(0,I,II,I2)) Q:I2=""  S T3=$$NORM($$Par($$WG(I2,,"documentation"),"Tag:"),5) S SO(T,T2,T3)=I2
 ..S T3="" F  S T3=$O(SO(T,T2,T3)) Q:T3=""  S I2=SO(T,T2,T3) D
 ...S RI2=$G(O(0,I,II,I2)) I RI2="" S (OO(I2),RI2,O(0,I,II,I2))=RI1
 ...Write "db[db.length] = new dbRecord('"""_ID2_"""', '"_$g(GU(I2))_"', '"""_ID_"""', 1,'"_$TR(RI2_" "_$$WG(I2,,"documentation"),$C(34,10,13))_" id="_I2_"');",!
 K @BDSES@(BSSES,"VAR","Rights") M @BDSES@(BSSES,"VAR","Rights")=OO
	Write "countRow=db.length;",!
	Write "GetChild(0,0);pCell.innerHTML=Tree;</SCRIPT>",!
 Q
NORM(S,N) I S="" S NORM=$G(NORM,9000)+1,S=NORM
 Q $TR($J(S,N)," ","0")
]]></Routine>


<Routine name="%ZAPM.ed.BSCsys" type="MAC" languagemode="0"><![CDATA[
%BSCsys ; пpогpамма управления программами ; 11:12   12.09.2002
 ;
 ;    Copyright Serge W. Mikhaylenko
 ;    All Rights Reserved
 ;
 Q
S() N BSLABEL
 Q "<A name='SS2' onclick='open("""_$$ADDBSGET^%ZAPM.ed.BSC4(,"SS^%ZAPM.ed.BSCsys")_""",""RESULT3"",""toolbar=no,menubar=no,scrollbars=yes,width=800,height=400,status=1,resizable=1"");' ><IMG src='"_BSDOMAIN_"/img/ham-red.gif' alt='Статус системы'></A>"
SS N CK,I,II,AK,Fname,CKK,DD
 D BEG1^%ZAPM.ed.BSC4 W $$TITL^%ZAPM.ed.BSCGIS("Сервер: "_$ZU(110)_". Cостояние системы"),$$B27^%ZAPM.ed.BSCGIS(1)
 w "<BODY>"
 w "<form action="""_$$ADDLIB^%ZAPM.ed.BSC4()_""" method=""POST"">"
 S BSLABEL="Form^~BSCsys",DD=$$TEMPDIR^%ZAPM.ed.BSpgBS
 D ADDBSPOST^%ZAPM.ed.BSC4reg
 I $G(BSSES)="" W "надо зарегистрироваться!"
 E  D
 . zn "%sys" ;D OutSpool^%ZAPM.ed.BSCpool("D ALL^%SS"),Spool2BSSES^%ZAPM.ed.BSCpool(+$J,"^%SS") M CK=@BDSES@(BSSES,"VAR","SPOOL","^%SS")
 .S Fname=DD_"SS"_$J_".log" S OLDIO=$I O Fname:"UWN" U Fname D ALL^%SS U OLDIO C Fname 
 .d File2Arr^%ZAPM.ed.BSCEXE(Fname,.CKK),DelFile^%ZAPM.ed.BSCEXE(Fname)
 .D STR2MAS^%ZAPM.ed.BSCmail(.CKK,.CK,BK)
 .W "<table border=0 width=100%>" D  W "</table><HR>"
 ..S I="" F II=1:1 S I=$O(CK(I)) Q:I=""  I II'=1 W "<tr>" D  W "</tr>" 
 ...W "<td class=s1><PRE>"_$$SSS(II,CK(I))_"</PRE></td>"
 w "<input type=submit name=sDUB value='Завершить помеченные процессы' title='Завершить помеченные процессы'>"_BK
 D BUTT^%ZAPM.ed.BSCGIS 
 w "</form>"
 D END^%ZAPM.ed.BSC4
 Q
Form N PID zn "%sys"
 S I="" F  S I=$O(%KEY(I)) Q:I=""  I $E(I,1,3)="PID" D
 .S PID=$E(I,4,99)
 .I $$INT^RESJOB(PID) W GREEN_BBK_"процесс "_PID_" cнят"_EF Q
 .W RED_BBK_"процесс "_PID_" не может быт cнят"_EF
 G SS
SSS(N,S) N C1,C2,PID,ROU,WAR S (C1,C2)="",WAR=""
 I N>3,$E(S,1)=" " D
 .S PID=$$CutS^%ZAPM.ed.BSF10($E(S,1,6))
 .I PID D
 ..I $D(^%ZAPM.ed.BSlog(PID)) S C1=MAROON,C2=EF
 ..E   S C1=GREEN,C2=EF
 ..S ROU=$P($E(S,41,83)," ")
 ..I $E(ROU,1,3)="%BS" S S=$$Cut^%ZAPM.ed.BSF10(S)_" <input type=checkbox "_$$SSSS(PID,ROU)_" name=PID"_PID_" value='' title='Пометить процесс для завершения'> "_WAR
 Q C1_S_C2
SSSS(P,R) N H I R="%BSpgWEBC" Q "DISABLED"
 I $$exists^%ZAPM.ed.BSCEXE(DD_"Scra"_P) S H=$ZU(140,3,DD_"Scra"_P) I +H=+$H,($P($H,",",2)-$P(H,",",2))>180 D  Q "CHECKED"
 .S C1=RED,C2=EF,WAR="Процесс порожден BSTKWEB. Работает "_(($P($H,",",2)-$P(H,",",2))\60)_" мин."
 Q "" 
 
]]></Routine>


<Routine name="%ZAPM.ed.BSCt" type="MAC" languagemode="0"><![CDATA[
%BSCt ;ФУНКЦИИ ТАБЛИЦ И ТЕКСТОВ ; 0:20   22.01.2000
 ;
 ; Copyright (c) Serge W. Mikhaylenko
 ; All Rights Reserved
 ;
 Q
TEXT(G) ;ТЕКСТ
 N I,II
 S (II,P1)=""
 F I=1:1 Q:'$D(@G@(I))  S II=II_@G@(I)_$C(13,10)
 Q II
TabColSize(T,D) ;РАЗМЕР КОЛОНОК В ТАБЛИЦЕ T
 I +$G(D)=0 S D=$P(@T,"@",29)
 S II="" F I=1:1:D S II=II_$P(@T@(1,I),"@",4)_","
 S P1=D
 Q II
TabRowSize(T,D) ;РАЗМЕР СТРОК В ТАБЛИЦЕ T
 I +$G(D)=0 S D=$P(@T,"@",28)
 S II="" F I=1:1:D S II=II_$P(@T@(I,1),"@",3)_","
 S P1=D
 Q II
TabShab(T) ;ШАПКА В ТАБЛИЦЕ T
 N D,TS,K,S
 I +$G(D)=0 S D=$P(@T,"@",29) ;КОЛИЕСТВО КОЛОНОК
 S TS=+$P($P(@T,"@",19),",") I TS<2 Q "" ;ШАПКИ НЕТ
 S II="" F S=1:1:TS-1 D  S II=II_$C(2) ;КОНЕЦ СТРОКИ
 .F K=1:1:D S II=II_$$DATACELL(T,S,K)_$C(1)
 Q II
TabCell(T,OT,DO) ;ДАННЫЕ В ТАБЛИЦЕ T
 N D,TS,K,S
 I +$G(D)=0 S D=$P(@T,"@",29) ;КОЛИЕСТВО КОЛОНОК
 S II="" F S=OT:1:DO D  S II=II_$C(2) ;КОНЕЦ СТРОКИ
 .F K=1:1:D S II=II_$$DATACELL(T,S,K)_$C(1)
 Q II
DATACELL(T,S,K) ;ДАННЫЕ КЛЕТКИ РАЗБИТЫЕ _$C(13,10)
 N D,W,I,II,H,J
 S D=$$CELL(T,S,K),II=""
 I $P(@T@(S,K),"@",3)=1 Q D
 S H=$P(@T@(S,K),"@",3),W=$P(@T@(S,K),"@",4)
 F I=1:1:H S II=II_$E(D,(I*W)-W+1,W+(W*(I-1)))_$C(13,10)
 Q II
CELL(T,ny,nx) ;ДАННЫЕ КЛЕТКИ
 N BSR,BST,BS,B,d,d1,d0,st,ke,se
 S se=+$O(@T@(" "),-1),ke=+$O(@T@(1,""),-1)
 ;S BSR=$P(T,"("),BST=$O(@T),BST=$O(@BSR@(BST),-1)
 S BSR=$P(T,"("),BST=$QS(T,1)
 I '$D(@BSR@(BST,ny,nx)) Q ""
 S BS=@BSR@(BST,ny,nx),B=@BSR@(BST)
 I $P(BS,"@",9)=1 S (d1,d,d0)=$P(BS,"@",15)
 E  S (d1,d,d0)=$G(^%ZAPM.ed.BSbufB("BB"_$J_"u1",ny,nx)) ;ДЛЯ БАЗ ДАННЫХ БУДЕТ ПО ДРУГОМУ
 I d0="" S d0=" " ;????
 I $P(BS,"@",8)'="" D
 .I $P(BS,"@",8)=0 X $G(@(BSR_"(BST,""FTR"","_ny_","_nx_")")) S d0=d1 Q
 .X $G(@(BSR_"(BST,""FTR"","_$P(BS,"@",8)_")")) S d0=d1
 Q d1
]]></Routine>


<Routine name="%ZAPM.ed.BSCtemplate" type="MAC" languagemode="0"><![CDATA[
%BSCtemplate ; Портал B4I ; 14:50 12.01.2003
 ;
 ;    Copyright Serge W. Mikhaylenko
 ;    All Rights Reserved
 Q
OP1()
 N Q S Q="<option value='BegEnd'  >M; Начало и конец станицы портала</option>"
 S Q=Q_"<option value='OpenWIN'   >S; Начало и конец страницы для окна </option>"
 S Q=Q_"<option value='HIDDEN'    >S; Скрываемый(Раскрываемый) элемент DHTML</option>"
 S Q=Q_"<option value='Form'      >S; Form форма страницы портала</option>"
 S Q=Q_"<option value='aGet'      >F; Anchor...Get  //Anker c BSGET </option>"
 S Q=Q_"<option value='bGet'      >F; Button...Get  //Button c BSGET </option>"
 S Q=Q_"<option value='CHECKBOX'  >F; Вывести CHECKBOX</option>"
 S Q=Q_"<option value='select'       >M; Вывести Select</option>"
 S Q=Q_"<option value='FRAMES'       >M; FRAMES //FRAMESet</option>"
 S Q=Q_"<option value='Table3'       >S; Table //таблицу со стилями на 3 колонки</option>"
 S Q=Q_"<option value='aParam'       >M; Кнопка с параметрами и получить параметр с конструктором</option>"
 S Q=Q_"<option value='LocVar'    >S; Вывести переменные текущей сессии в Брузер в виде таблицы</option>"
 S Q=Q_"<option value='ctrl'      >F; Удалить управляющие символы</option>"
 S Q=Q_"<option value='bd'        >F; Имя массива БД %BS</option>"
 S Q=Q_"<option value='Data'      >F; Существование массива $$Data</option>"
 S Q=Q_"<option value='GetV'      >F; Cохранить, Возвратить данные в БД текущей сессии</option>"
 S Q=Q_"<option value='TR'     >S; Замена подстоки в строке $$TR^%ZAPM.ed.BSsFUNM</option>"
 S Q=Q_"<option value='TRA'    >S; Замена %'' в строке на ~| и обратно для URL</option>"
 S Q=Q_"<option value='TRE'    >F; Замена угловых скобок в строке на &lt для HTML</option>"
 S Q=Q_"<option value='WEB'    >M; создать переменные В4Y интерфейса</option>"
 S Q=Q_"<option value='SYSLOG' >M; Записать в %BS-системмный протокол</option>"
 S Q=Q_"<option value='info'   >M; Информация о %BS-Portale</option>"
 S Q=Q_"<option value='JSE'    >S; Добавить скобки JavaScript ... JSE</option>"
 S Q=Q_"<option value='ASN'    >F; Добавить имя сервера с именем библиотеки</option>"
 S Q=Q_"<option value='BSLOG'    >F; %BS-СИСТЕМНЫЙ ПРОТОКОЛ</option>"
 S Q=Q_"<option value='EXE'      >M; ЗАГРУЗКА ТЕРМИНАЛОВ,EXE ФАЙЛОВ,КОНВЕРТЕРА в EXCELL из-под ИП (пример Гранда)</option>"
 S Q=Q_"<option value='GUCI'     >F; ФУНКЦИЯ ПЕРЕХОДА В РАБОЧУЮ ОБЛАСТЬ</option>"
 S Q=Q_"<option value='TD'       >F; ДАТА \ ВРЕМЯ</option>"
 S Q=Q_"<option value='WOUT'     >M; Выгрузить в файл буфер локальных переменных</option>"
 S Q=Q_"<option value='bssyslog' >F; программа протоколирования действий пользователей BS</option>"
 S Q=Q_"<option value='TmpDir'   >F; Каталог для временных файлов</option>"
 S Q=Q_"<option value='open1'    >F; Открыть окно браузера</option>"
 S Q=Q_"<option value='CutS'     >S; Удалить начальные и коцевые пробелы</option>"
 S Q=Q_"<option value='VERBS'    >F; Версия bs-portala</option>"
 S Q=Q_"<option value='CHISLO'   >F; Число прописью</option>"
 S Q=Q_"<option value='KBD'      >F; Тригерное имя БД, или Глобала</option>"
 S Q=Q_"<option value='JF'       >S; JUSTIFY пробелы в конце</option>"
 S Q=Q_"<option value='UPLOAD'   >M; UPLOAD FILES TO SERVER</option>"
 S Q=Q_"<option value='File2Arr' >F; Читать Файл в массив и разбор массива по контексту</option>"
 Q Q
OP3()
 N Q S Q="<option value='USER' >M; Добавить\Удалить Прямого И терминального пользователя (Cache5.0.x)</option>"
 S Q=Q_"<option value='DNS' >F; Имя сервера и\или IP-адрес</option>"
 S Q=Q_"<option value='ODBC' >M; Получить список источников DNS ODBC (%BS SQL-менеджер)</option>"
 S Q=Q_"<option value='conv' >F; $ZCNVT() - конверировать в большие и маленькие буквы</option>"
 S Q=Q_"<option value='ini' >M; РАЗБОР ФАЙЛА .INI</option>"
 S Q=Q_"<option value='LIC' >M; Информация о Лицензии Cache'</option>"
 S Q=Q_"<option value='md5' >F; криптокодирование Blow Fish и MD5</option>"
 S Q=Q_"<option value='ExRou' >F; Существует ли программа</option>"
 S Q=Q_"<option value='DecomposeStatus' >F; Сообщение об ошибке</option>"
 S Q=Q_"<option value='REACT' >M; Реактивация конфигурации СУБД</option>"
 S Q=Q_"<option value='RESTART' >M; Рестарт СУБД</option>"
 Q Q
 //----------------------------------------------%bs МОДУЛИ
1(A,type1,RN,NS,PR,ST,US)
 //I $$CTRL^%ZAPM.ed.BSChT(ST)'=ST S ST="ControlSymbol???!!!"
 //I $$2LAT^%ZAPM.ed.BSCp(ST,1)'=ST S ST="CyrilicSymbol!!!"
 I ST="" S ST="ST"
 ;I $G(NewTop)'="" W $G(NewTop) Q 
 if A=1,(type1="select") {   
 w "  W ""<SELECT name=base1 onchange=""""open('""_$$ADDBSGET^%ZAPM.ed.BSC4(,""onchange^"_$P($TR(RN,"%","~"),".")_""")_""&Base2='+base1.value,'','toolbar=no,menubar=no,width=1,height=1');"""">""  D  W ""</SELECT>"" ",!
 w "  .N I W ""<OPTION value='' selected >--</OPTION>"" ",!
 }
 ;M; 
 if A=1,(type1="UPLOAD") {   
 w "  //UPLOAD FILE TO SERVER",!
 w " S BSS1=""""",!
 w " S BSS6=""FILE1^"_$P($TR(RN,"%","~"),".")_""" //ПРОГРАММА КОТОРАЯ ИСПОЛНЯЕТСЯ ПОСЛЕ ЗАГУЗКИ ФАЙЛА",!
 w " S BS1="""" ",!
 w " S BS2=""""  I $$SetVar^%ZAPM.ed.BSC4(""NSpace"",BSNSP) ",!
 w " S BSS3=BSSES,BS3=MGWLIB,BSS8=$$BSADDVAR^%ZAPM.ed.BSC4(),BSS4="""" ",!
 w " D UP^%ZAPM.ed.BSC4r3",!
 w " Q ",!
 w "FILE1 D BEG1^%ZAPM.ed.BSC4 W $$TITL^%ZAPM.ed.BSCGIS(""UPLOAD. Step 2""),$$B27^%ZAPM.ed.BSCGIS(1) ",!
 w " W RED_$G(FiNa)_EF_BBK //ИМЯ ФАЙЛА",!
 w " S NoCloseWin=1 //ФЛАГ НЕ ЗАКРЫВАТЬ ОКНА",!
 W " M Mas=@GL K @GL //МАССИВ В КОТОРОМ ЛЕЖИТ ЗАГРУЖЕННЫЙ ФАЙЛ",!
 W " //TO DO",!
 w " D END^%ZAPM.ed.BSC4",!
 }
 ;M; 
 if A=1,(type1="File2Arr") {   
 w " K fT1,fT2 D File2Arr^%ZAPM.ed.BSCEXE(FN,.fT1),STR2MAS^%ZAPM.ed.BSCmail(.fT1,.fT2,$C(13,10)) K fT1 S i="""" F  S i=$O(fT2(i)) Q:i=""""  I $G(fT2(i))'="""" //TODO",!
 }
 
 if A=1,(type1="JF") {   
 w " W ""$$JF^%ZAPM.ed.BSC4r4("_ST_",45)"" //ADD 45 SPACE TO END",!
 w " W ""$TR($J("""",9),"" "",""*"")"" //WRITE 9 *",!
 }
 
 if A=1,(type1="CHISLO") {   
 w " W ""$$sump^%ZAPM.ed.BSCp2("_ST_")"" //",!
 }
 
 if A=1,(type1="KBD") {   
 w " S GL=$$KBD^%ZAPM.ed.BSF12(""^PART(""""TAB"""")"") //TRIGGERED BD",!
 w " S GL=$$SW^%ZAPM.ed.BSF12(""^GLO"") //SWITHER GLOBAL, USE zBS4cfg=Currently configuration portal",!
 }
 
 if A=1,(type1="VERBS") {   
 w " W ""$$ver^%ZAPM.ed.BSC()""",!
 }
 
 if A=1,(type1="CutS") {   
 w " W ""$$CutS^%ZAPM.ed.BSF10("_ST_")""",!
 }
 
 if A=1,(type1="open1") {   
 w " W ""open(""""""_$$ADDBSGET^%ZAPM.ed.BSC4(,""Lab^"_$P($TR(RN,"%","~"),".")_""")_"""""",""""xxx"""",""""toolbar=no,menubar=no,scrollbars=no,width=500,height=200,status=1,resizable=1"""");""_BK",!
 }
 
 if A=1,(type1="bssyslog") {   
 w " D Tex^%ZAPM.ed.BSMSMF(""UpdateVersion"",V),SYSMSG^%ZAPM.ed.BSCek(""UpdateVersion ""_V,""W"")",!
 }
 
 if A=1,(type1="TmpDir") {   
 w " s T=$$CacheSysDir^%ZAPM.ed.BSCp(""\dev\"")",!
 }
 //
 if A=1,(type1="EXE") {
 w "KID //SAMPLE ^%ZAPM.ed.BSCprivOVV",!
  w " D BEG1^%ZAPM.ed.BSC4",!
 w " ; D locvar^%ZAPM.ed.BSCh0("""",1)",!
 
 w "  N HREF,TA,BSTOP,BSTOP2,BSLABELt",!
  w " S BSPGM=""KID"",BSLAB1=""KID3"" ",!
  w " W ""<HR><BUTTON onclick=""""open('""_$$ADDBSGET^%ZAPM.ed.BSC4(,""KID2^KID"")_""','','width=1,height=1');"""" title='Загрузить в терминале KID' VALUE='' ><IMG SRC='""_BSDOMAIN_""/img/term.gif'> КОМПЛЕКС КИД</BUTTON>""_BK",!
  w " W ""<HR><BUTTON onclick=""""open('""_$$ADDBSGET^%ZAPM.ed.BSC4(,""KID4^KID"")_""','','width=1,height=1');"""" title='Загрузить в терминале KID' VALUE='' ><IMG SRC='""_BSDOMAIN_""/img/term.gif'> КОМПЛЕКС КИД</BUTTON>""_BK",!
  w " D END^%ZAPM.ed.BSC4",!
  w " ;D Read^%ZAPM.ed.BSCG(""URO"",""SELECT * FROM FeniaNorm"",1,,""^mtemple"")",!
  w " ;W !,$G(^mtemle(0),""?"")",!
 w "  Q",!
 w "KID2 D RunProSess^%ZAPM.ed.BSC4rout(""TELNETP(""""KID"""",""""#"""",""""""_BSLAB1_""""^^""_BSPGM_"""""",""""--КИД--"""");"") Q",!
  w " Q",!
 w "KID3 ;ZW %BS",!
  w "   S BSR=""^Kmen"",BST=""M0"" D ^%ZAPM.ed.BST",!
 w "  Q   ",!
 w "KID4 ;D RunProSess^%ZAPM.ed.BSC4rout(""ExeRun2("""""""",""""ExT2E.exe"""",""""*fn:http://urovv2:1962/vv/struct/111.txt *c:1 *d:, *s:3""""); "",""ExeRun1"") Q",!
 w " D RunProSess^%ZAPM.ed.BSC4rout(""ExeRun2("""""""",""""ExT2E.exe"""",""""*fn:http://urovv2:1962/vv/struct/111.txt *c:0 *alls""""); "",""ExeRun1"") Q",!
 w " Q",! 
 }
 
 if A=1,(type1="JSE") {
 w " D JS^%ZAPM.ed.BSCp",!
 w " w ""var=parent.location;""_BK",!
 w " D JSE^%ZAPM.ed.BSCp",!
 }
 
 if A=1,(type1="TD") {
 w " W $$TD^%ZAPM.ed.BSC4base($H)",!
 }
 
 if A=1,(type1="WOUT") {
 w " I '$D(Fname) S Fname=""N:\123.TXT"" I $ZU(140,4,Fname)'=0 S OLDIO=$I O Fname:""UWN"" U Fname W ""-----"",! W  W ""-------"",! U OLDIO C Fname ",!
 w " //или w $$w2f^%ZAPM.ed.BSCp2(Fname)",!
 }
 
 if A=1,(type1="BSLOG") {
 w " D Tex^%ZAPM.ed.BSMSMF(""TEXT"",MODE)",!
 }
 
 if A=1,(type1="GUCI") {
 w " I $$ZU^%ZAPM.ed.BSF4(""FON"") //OK",!
 }
 
 if A=1,(type1="ASN") {
 w "$$ADDSN^%ZAPM.ed.BSC4()_$$ADDLIB^%ZAPM.ed.BSC4()",!
 }
 
 if A=1,(type1="CHECKBOX") {
 w " W ""<input type=checkbox name=SubMitPop value='' title='...'>""",!
 }
 
 if A=1,(type1="HIDDEN") {
 w " D STY^%ZAPM.ed.BSCm2(2),DIV^%ZAPM.ed.BSCm2(2,""TEXT"",""TEXT2222"")",!
 w " ",ST,!
 w " D DI^%ZAPM.ed.BSCm2",!
 }
 
 if A=1,(type1="LocVar") {
 W " D locvar^%ZAPM.ed.BSCh0("""_ST_""",1)",!
 }
 
 if A=1,(type1="OpenWIN") {
 W " D BEG1^%ZAPM.ed.BSC4 W $$TITL^%ZAPM.ed.BSCGIS(""Step1 for NewTabel""),$$B27^%ZAPM.ed.BSCGIS(1)",!
    //W " "_ST_" //TODO",!
 W " D BACK^%ZAPM.ed.BSCh,END^%ZAPM.ed.BSC4",!
 }
 
 if A=1,(type1="Table3") {
 W " w ""<table border=0 width=100%>""",!
 W " w ""<tr><td class=s1 width=5%></td><td class=s1  width=75%><strong><strong></td><td class=s1 width=20%></td></tr>"",BK",!
    w " ",ST,!
 W " w ""</table>""",!
 }
 
 if A=1,(type1="FRAMES") {
 W " w ""<FRAMESET rows='0%,*'  framespacing=0 border=false frameborder=0 >""_BK",!
 W " w ""<FRAME SRC='/iss/RD/RunDos.htm' name='rd1' frameborder=0 >""_BK",! 
 w " S BSLABEL=""ROU^~BSCAsIs""",!
 W " w ""<FRAME SRC='""_$$ADDBSGET^%ZAPM.ed.BSC4_""' NAME='LIST' frameborder=0 >""_BK",!
    W " ",ST,!     
 W " w ""</FRAMESET>""",!
 Q
 }
 
 if A=1,(type1="BegEnd") {
	w " D BEG1^%ZAPM.ed.BSC4",!
	w " D BACK^%ZAPM.ed.BSCh,END^%ZAPM.ed.BSC4",!
 }
 
 if A=1,(type1="Form") {
 W " w ""<BODY>""",!
 W " w ""<form action=""""""_$$ADDLIB^%ZAPM.ed.BSC4()_"""""" method=""""POST"""">""",!
 w " S BSLABEL=""Form^"_$P($TR(RN,"%","~"),".")_"""",!
 w " D ADDBSPOST^%ZAPM.ed.BSC4reg",!
 w " ",ST,!
 W " w ""<input type=submit name=sDUB value='Copy' title='copy...'>""_BK",!
 W " w ""</form>""",!
 w " G BACK^%ZAPM.ed.BSCh ",!
 }
 
 if A=1,(type1="bGet") {
    w " w ""<BUTTON onclick='messages.DE.value=1; submit();' title='save currently setting' ><IMG SRC='""_BSDOMAIN_""/img/save.gif'>save</BUTTON>""_BK",!
    w " //OR"
    W " $$BUTTBS^%ZAPM.ed.BSCp2(ROU,GIF,FNAME,TIT,H,W) ",!
 }
 
 if A=1,(type1="aGet") { w " q ""<a href='""_$$ADDBSGET^%ZAPM.ed.BSC4(,""aGET^"_$P($TR(RN,"%","~"),".")_""")_""' target=new TITLE='""_dt_""'>""_t_""</a>""",!
 }
 
 if A=1,(type1="aParam") {
 w " s g=""^AsI.PAR.OPT""",!
 w " w $$BP^%ZAPM.ed.BSC4cfgP(""Main option"",""Main option2"",g,g,1)_$$Param3()",!
 w " w $$GETOPT^%ZAPM.ed.BSC4cfgP(g,""aTamplete"")_""<hr>""",!
 w "Param3() N pin,N S pin=$P(g,""."",1,2),N=$P(g,""."",3)",!
 w " Q "" Construction Options ""_$$PAframe^%ZAPM.ed.BSCm()",!
 }
 
 if A=1,(type1="TR") {
 W " A=$$TR^%ZAPM.ed.BSsFUNM("_ST_",REPL,TO)",!
 }
 
 if A=1,(type1="TRA") {
 W " S BSPART=$$%T^%ZAPM.ed.BSCh("_ST_") //%-->~",!
 W " S BSTABL=$$%^%ZAPM.ed.BSCh(BSTABL) //~-->%",!
 }
 
 if A=1,(type1="TRE") {
 W " W $$TRa^%ZAPM.ed.BSCh0($ZE)",!
 }
 
 if A=1,(type1="info") {
 W " d InfoSess^%ZAPM.ed.BSC4rout",!  
 }
 
 if A=1,(type1="WEB") {
 W " I '$D(GREEN) D VAR^%ZAPM.ed.BSCh  ",!  
 }
 
 if A=1,(type1="ctrl") { W "$$CTRL^%ZAPM.ed.BSChT("_ST_")"
 }
 
 if A=1,(type1="bd") {
 w " S BD=$$KBD^%ZAPM.ed.BSF12(""^%ZAPM.ed.BSC4(""""PROTECT"""")"")",!
 }
 
 if A=1,(type1="Data") {
 W " I $$Data^%ZAPM.ed.BSF12(G)",! 
 }
 
 if A=1,(type1="GetV") {
 W " S BSMODE=$$GetVar^%ZAPM.ed.BSC4(""STR_MODE"")",! 
 W " S A=$$SetVar^%ZAPM.ed.BSC4(""STR_MODE"",BSMODE)",!
 }
 
 //------------------------------------------------------------... ФУНКЦИИ
 if A=3,(type1="USER") {
 W " D RegSave^%ZAPM.ed.BSCm2 //SAVE",!
 }
 
 //	Error Message
 if A=3,(type1="DecomposeStatus") {
 W " Do DecomposeStatus^%apiOBJ(status,.err,""-d"")  ",!  
 }
 
 ;	Reactivation
 if A=3,(type1="REACT") {
  W " D cpf^%ZAPM.ed.BSCm2 ",!  
 }
 
 ;	Restarted
 if A=3,(type1="RESTART") {
 W " D RESTART^%ZAPM.ed.BSCm2  ",!  
 }
 
 if A=3,(type1="ODBC") {
  W " N LD,svc,I D DSNLIST1^%ZAPM.ed.BSCGH S I="""" F  S I=$O(LD(I)) Q:I=""""  ",!  
 }
 
 if A=3,(type1="DNS") {
  w "$$ipS^%ZAPM.ed.BSCp2 //W "" S IP1=$P($ZU(54,13,NAME1),"","")   S NAME2=$P($zu(54,14,$zu(54,1,IP2)),"","",2) ",!  
 }
 
 if A=3,(type1="conv") {
 W " s a=$ZCONVERT(a,""U"")),b=$ZCONVERT(b ,""L"")   ",!  
 }
 
 if A=3,(type1="SYSLOG") {
 W " D Tex^%ZAPM.ed.BSMSMF(""OpenSess"",$G(U)_"",""_$G(BSR)_"",""_$G(BST)_"",""_$G(EDIT)_"",""_$G(MODE)_"",""_$G(BSLOGIN)_"",""_$G(BSSES))",!  
 }
 
 if A=3,(type1="ini") {
 W " d INI^%ZAPM.ed.BSCindx(FNINI,.MS) //N O D parseCfg^%DMCONFIG(FNINI,.O) //Sample parse file .INI  ",!  
 }
 
 if A=3,(type1="LIC") {
 W " d $SYSTEM.License.CKEY()",!  
 }
 
 if A=3,(type1="md5") {
 W " d TestString^%ZAPM.ed.BSCBlowfish(""TEST"")",!  
 }
 
 if A=3,(type1="ExRou") {
 W " I '$$EXIST^%R(""%GKDOC.INT"") Q  //No exist",!  
 }
 
 
]]></Routine>


<Routine name="%ZAPM.ed.BSCtemplate2" type="MAC" languagemode="0"><![CDATA[
%BSCtemplate2 ; Портал B4I ; 14:50 12.01.2003
 ;
 ;    Copyright Serge W. Mikhaylenko
 ;    All Rights Reserved
 Q
rou(ns,rou) i $g(ns)'="" ZN ns
 D 1(rou) 
 Q
ROU(ns,rou,RN) ;ПОДГОТОВКА ПУНКТОВ ПРИМЕРОВ
 I '$D(GREEN) D VAR^%ZAPM.ed.BSCh  D Gen^%ZAPM.ed.BSCtemplate3($g(RN))
 N S,L,I,i,ii,X 
 w "<hr>" d BSDOC w "<hr>" D rou($g(ns),$g(rou))
 w "<h3>Примеры из программы : "_BLUE_$g(rou,"%BSCtemplate2")_EF_" Рабочей области : "_RED_$g(ns,"%SYS")_EF_"</H3>"
 S I="" F  S I=$O(X(2,I)) Q:I=""  S L=X(2,I) D
 .I L[";;" W "<HR>"_MAROON_$P(L,";;",2)_EF_"<HR>" Q
 .W "<LI><INPUT NAME='NewTop' TYPE=Submit TITLE='"_$ZCVT($$RES(L),"O","HTML")_"' VALUE='"_L_"'>"_L(L) 
 Q ""
1(R) i $g(R)="" k R
 X "ZL "_$G(R,"%BSCtemplate2")_" F I=1:1 S S(I)=$T(+I) Q:S(I)="""" "
 F i=1:1:I-1 D
 .I S(i)[";;" S L=$P(S(i)," ;;") S:L="" X(2,i)=S(i) I L'[" ",L'="" S L(L)=$P(S(i)," ;;",2,99) D
 ..F ii=i+2:1 q:S(ii)["*///"!(S(ii)[";>>;")  S L(L,ii)=S(ii)
 ..S X(2,i)=L,i=ii,X(1,L)=$S(S(ii)[";>>;":1,1:0)
 Q
RES(A) N Q S Q="",i="" F  S i=$O(L(A,i)) Q:i=""  S Q=Q_L(A,i)_$C(13,10)
 Q Q
Result(R,RN,NS,PR,ST,US,ns,rou,Clname,ModeSel,fn,proF) N S,L,I,i,ii,X //ВЫВОД ПРИМЕРОВ В ПРОРАММУ
 i R="Генерить!" d rn^%ZAPM.ed.BSCtemplate3(Clname,ModeSel,proF) q  //генерация класса редактирования по его свойствам
 i R="Генерить из CSV" d fn^%ZAPM.ed.BSCtemplate3(fn) q  //генерация класса из текстового файла
 D rou($g(ns),$g(rou)) I 'X(1,R) W $$RES(R)
 E  S i="" F  S i=$O(L(R,i)) Q:i=""  X $P(L(R,i),$C(13,10))
 Q 
Result2(R,RN,NS,PR,ST,US,ns,rou,fn) N S,L,I,i,ii,X
 i R="Генерить" d fn^%ZAPM.ed.BSCtemplate3(fn) q  //генерация класса из текстового файла
 q
BSDOC D VAR^%ZAPM.ed.BSCh S %("HOST:")=1,HTT="http://"_$$ipS^%ZAPM.ed.BSCp2_":1962"_$$ADDBSGET^%ZAPM.ed.BSC4(,"BSDOC^~BSC4r3")
 W "<A TITLE='Зарузить в новом окне документаию по порталу' Href='"_HTT_"'>Документация по порталу B4Y</A>"
 Q
 ///////////////////////////////////////////////////ПОКА НЕ ВСТАВЛЯТЬ КИРИЛИЦУ В ТЕКСТ ПРИМЕРОВ!!!///////////////////////////////////////
 ;;Слова и заготовки
FOR ;;M; Классическое начало FOR
 /*
  S i="" F  S i=$O(@a@(i)) Q:i=""
 *///
 Q  
Kz ;;M; Ловушка через глобал
 /*
  k ^%z m ^%z=M
 *///
 Q  
LOCAL ;;M; Посмотреть все локальные переменные
 /*
   D l^%ZAPM.ed.BSCp2
 *///
 Q  
NewClass ;;M; Заготовка под новый класс
 /*
/// имя параметра;1;f;;160
Property NameOpt As %String [ Required ];
 
/// описание параметра;2;f;
Property DescOpt As %String(MAXLEN = 1000);
 
/// значение параметра;2;f;
Property ValOpt As %String(MAXLEN = 1000);
 
Index NameOptIndex On NameOpt [ Unique ];
 *///
 Q  
ANY ;;M; Приглашение ввести любую клавишу
 /*
 D ANY^%ZAPM.ed.BSC4r4
 *///
 Q  
align ;;W; Слово - Выравнивание
 /*
  align
 *///
 Q
width ;;W; Слово - Длина
 /*
  width
 *///
 Q
height ;;W; Слово - Высота
 /*
  height
 *///
 Q
 //////////////////////////////////////////////////////
Write2File ;;F; вывести все локальные переменные в файл
 /*
 $$w2f(Fname)
 *///
 q
 ;;Функции
ZV ;;F; Номер версии Каши
 /*
 $$ZV^%ZAPM.ed.BSCp
 *///
 q
CbaseNS ;;F; Перейти в базовую рабочую область конфигурации
 /*
 $$CbaseNS^%ZAPM.ed.BSCp
 *///
 q
BDSES ;;F; Обращение к бд СЕССИИ и запись в неё данных
 /*
 k @BDSES@(BSSES,"VAR","CheckDocs")
 *///
 q
TRansLIT ;;F; транслитерация  (кирилицу переводим в латиницу)
 /*
 $$2LAT^%ZAPM.ed.BSCp(S,N)
 *///
 q
 
base64 ;;F; Обратимая функция Base64
 /*
 $$b64e^%ZAPM.ed.BSCp2(s)
 *///
 q
GetOpt ;;Sv; Функция получения значения параметра АРМ
 /*
 $$GetOpt^%ZAPM.ed.BSCtree(Packet,.sc,NameOpt) 
 *///
 q
SetOpt ;;Sv; Функция присвоения значения параметра АРМ
 /*
 $$SetOpt^%ZAPM.ed.BSCtree(Packet,.sc,NameOpt) 
 *///
 q
 
GetASUOpt ;;Sv; Функция получения значения параметра ИП и пользователя, если они совпадают  
 /*
 $$GetASUOpt^%ZAPM.ed.BSCtree("A2fileMaxSize",BSLOGIN)
 *///
 q
GetVal ;;Sv; Функция получения значения параметра для узла дерева  
 /*
 $$GetValTree^%ZAPM.ed.BSCtree(ValNODe,NameVal)
 *///
 q
SetVal ;;Sv; Функция изменения значения параметра для узла дерева  
 /*
 $$SetValTree^%ZAPM.ed.BSCtree(ValNODe,NameVal,NewVal)
 *///
 q
GetSQL ;;Sv; Функция выполнения SQL запроса
 /*
 s r=$$GetSQL^%ZAPM.ed.BSCtree("select AnsKod, AnsMess from ASUNACm.Answer where AnswerUser='"_user_"' and LogID='"_BSoSel_"'",кол-во колонок2,.R,"ASU") //r=количество найденных строк
 *///
 q
GetField ;;Sv; Функция получения значения поля из записи таблицы  
 /*
 $$GetF^%ZAPM.ed.BSCtree(T,F1,D1,F,ns) //возвратить значение поля F для первой найденной записи из таблицы T при условии F1=D1
 //например :$$GetF^%ZAPM.ed.BSCtree("ASUEHGm","NameOpt","NarXlsTemplate","ValOpt","ASU")
 ;$$GetOpt^%ZAPM.ed.BSCtree(Packet,status,NameOpt) //функция, специально для получения значений опции для ИП
 ;$$SetOpt^%ZAPM.ed.BSCtree(Packet,status,NameOpt,ValOpt) //функция, специально для присвоения значения опции для ИП
 *///
 q
 
GetA ;;Sv; Функция получения прав доступа на элемент доступа 
 ;>;
 w " S BSac=$$GetA^%ZAPM.ed.BSCtree($$GetValTree^%ZAPM.ed.BSCtree("_ST_",""B1""))",!
 ;>>;
 q
ZCVRT ;;Ss; Функция конвертирования тегов HTML в специальные коды
 ;>;
 W " S str=$ZCVT("""_ST_""",""O"",""HTML"")",!
 ;>>;
 Q 
norm ;;F; Добавить ведущие нули в число S. N=количество знаков
 /*
 s $$NORM^%ZAPM.ed.BSCrr(S,N)
 *///
 q
RESALL ;;Sv; Восстановить все переменные %session, %request
 /*
 w $$RESTALL^%ZAPM.ed.BSCp2("s")_"<hr>"_$$RESTALL^%ZAPM.ed.BSCp2()
 *///
 q
 ////////////////////////////////////////////////////
 ;;Модули
innerHTML ;;M; Управление динамическими html портала
  /*
 D JS^%ZAPM.ed.BSCp
  W " parent.parent.logo.Ugol.innerHTML='...';",!
  W " parent.parent.L1.BodyL1.innerHTML='...';",!
 D JSE^%ZAPM.ed.BSCp
 *///
ComboBoxEdit ;;M; Пример применения редактируемого ComboBox
  /*
 D BEG1^%ZAPM.ed.BSC4
 w "<head>"
 d PreCBE^%ZAPM.ed.BSCp2("http://"_$$ADDSN^%ZAPM.ed.BSC4()_"/b4y/js/cb-edit/")
 w "</head><body>"
 w "<input type=text name=myText value='Norway' selectBoxOptions='Canada~Denmark~Finland~Mexico~Nor way~United States'>"_BK
 w "<input type=text name=myText2 value='' selectBoxOptions='Amy;Andrew'>"_BK
 D JS^%ZAPM.ed.BSCp
 w "createEditableSelect(document.getElementById('myText'));"_BK
 w "document.getElementById('myText2').selectBoxOptions='ZZZZZ~QQQQ~EEE             E       E    EEEEEE';"_BK
 w "createEditableSelect(document.getElementById('myText2'));"_BK
 D JSE^%ZAPM.ed.BSCp
 D END^%ZAPM.ed.BSC4
 *///
 q
IMG ;;M; Картинка портала
  /*
  W "<img border=0 src='"_BSDOMAIN_"/img/person.gif' ALT='Insert...'>"
 *///
IFRAME ;;M; Пример строки URL для B4Y портала и  IFRAME
 /*
 w "<IFRAME HEIGHT='98%' width='98%' SRC='"_$$ADDBSGET^%ZAPM.ed.BSC4(,"stub^~BSCrep")_"' name='RECEIVE' SCROLLING='auto'></IFRAME><BR>"
 *///
 Q
TREE ;;M; Универсальный модуль организации редактирования массива как дерева
 /*
 D BEG1^%ZAPM.ed.BSC4
 D TreeStyle^%ZAPM.ed.BSCtree("Create^%ZAPM.ed.BSCtree",GLO,"LClick^BSissJ","IDISS")
 D CMenuJS^%ZAPM.ed.BSCtree("PClick^~BSCtree","FRAMETREE","TREE^BSissJ") 
 d Context^%ZAPM.ed.BSCtree("EDITGLO^%ZAPM.ed.BSCtree")
 D END^%ZAPM.ed.BSC4
 Q  
 *///
Table2 ;;M; Обрамление элементов в таблицу (2 колонки) со текущими стилями
 /*
 D TABL^%ZAPM.ed.BSCp
 D TR21^%ZAPM.ed.BSCp
 D TR22^%ZAPM.ed.BSCp 
 D TR23^%ZAPM.ed.BSCp
 D TRHR
 D TABLE^%ZAPM.ed.BSCp
 Q
TRHR W "<tr><td></td><td></td></tr>" Q 
 *///
WorkTel ;;M; ЗАГРУЗИТЬ ТЕРМИНАЛ
 /*
 ;%SYS"",""@"",""InfoSessi^^%ZAPM.ed.BSC4rout("_BSSES_")"",""Sessions""   - ЗАПУСК ПРОГРАММЫ ИЗ НС %SYS
 ;"1","$","$","Terminal"  										  - ЗАПУСК ПОЛНОГО ТЕРМИНАЛА
 ;""GLAVK"",""%BSJPRN"",""DPP"",""Устройства вывода""			  - ЗАПУСК ТАБЛИЦЫ
 ;"""_N_""",""$"",""$"",""Namespace_"_N_"""						  - ЗАПУСК ТЕРМИНАЛА ИЗ НС 
 d WorkTel^%ZAPM.ed.BSCp2(NS,PART,TABL,TITLE)
 *///
 
DirClientIPff ;;F; получение директории установки ClientIP - клиента ИнфоПортала
 /*
 =$$DirClientIPff(BSSES) //получение директории установки ClientIP - клиента ИнфоПортала
 *///
CacheSysDir ;;F;  получение директории установки Cache'
 /*
 $$CacheSysDir^%ZAPM.ed.BSCp("\Cache.cpf")
 *///
WorkRun ;;M; ЗАГРУЗИТЬ EXE программу
 /*
 d WorkRun^%ZAPM.ed.BSCp2("notepad.exe",$$CacheSysDir^%ZAPM.ed.BSCp("\Cache.cpf"),$$CacheSysDir^%ZAPM.ed.BSCp(""))
 *///
GetIpUrl ;;F; возвратить ссылку для закачки файла из инфотеки с сервера IP
 /* 
 s url=$$GetIpUrl^%ZAPM.ed.BSCp(gl)
 */// 
CspUrl ;;F; Правильно сформированный URL csp страницы с вызовом через IP адрес
 /*
 s url="http://"_$$ipS^%ZAPM.ed.BSCp2_":"_$$WebPort^%ZAPM.ed.BSCp2_"/"_Csp_"?"_$$addb^%ZAPM.ed.BSC4()
 *///
HttpUrl ;;F; Правильно сформированный URL с именем сервера ИП
 /*
 s url="http://"_$$ADDSN^%ZAPM.ed.BSC4()_$$ADDLIB^%ZAPM.ed.BSC4()
 *///
LoadExcel ;;M; Загрузка шаблона Excel и манипуляция с ним
 /*
  d LE^%ZAPM.ed.BSCp("1-видим шаблон сразу",$ZU(110)_":"_$$WebPort^%ZAPM.ed.BSCp2_"/csp/asu/html/asurp/docum/arm/24/xls/шаблон_наряда.xls","^mas",R,C,rou)
 *///
RecompileZen ;;M; Рекомпиляция всего пакета %ZEN
 /*
  Do $system.OBJ.CompilePackage("%ZEN") 
 *///
 
]]></Routine>


<Routine name="%ZAPM.ed.BSCtemplate3" type="MAC" languagemode="0"><![CDATA[
%BSCtemplate3 ; Портал B4I ; 14:50 12.01.2003
 ;
 ;    Copyright Serge W. Mikhaylenko
 ;    All Rights Reserved
 Q
Gen(rn)
 i rn="" q
 i $zconvert($p(rn,".",$l(rn,".")),"L")'="cls" q
 w "<hr> " s clna=$p(rn,".",1,$l(rn,".")-1) i $e(clna,$l(clna))?1n s prof=$e(clna,$l(clna))
 w "<INPUT NAME='NewTop' TYPE=Submit TITLE='Генерить страницу для экземплятов класса ' VALUE='Генерить!'>"
 W "<input type=text name=Clname value='"_$p(clna,"Edit")_"' title='введите имя класса без расширения :NamePacket.NameClass для которого будем генерить пользовательский интерфейс' size=50>"
 W "<input type=text name='Profile3' value='"_$g(prof)_"' title='введите номер профиля (шестое поле по ; в коментариях полей класса' size=2>"
 w "<select name='ModeSel' >"
 w "<option value='1'>Режим редактирования с фильтрами на колонки</option>",!
 w "<option value='2'>Режим редактирования без фильтра, но с параметром</option>",!
 w "<option value='3'>Режим просмотра</option>",!
 w "</select>",!
 w "<hr>"
 w "<INPUT NAME='NewDef' TYPE=Submit TITLE='Генерить описание класса из CSV файла' VALUE='Генерить из CSV'>"
 W "<input type=file name=Cfile value='"_$p(rn,".",1,$l(rn,".")-1)_"' title='введите имя файла'>"
 q
fn(fn) ;генерация класса из текстового файла
 n ccn,m,i,ii,da
 s ccn=$p(RN,".",1,$l(RN,".")-1)
 w "///  Это описание класса автоматически сгенерено из файл "_fn,!
 w " Class "_ccn_" Extends %Persistent",!
 w "{",!!
 n fT1,fT2 D File2Arr^%ZAPM.ed.BSCEXE(fn,.fT1),STR2MAS^%ZAPM.ed.BSCmail(.fT1,.fT2,$C(13,10)) K fT1
 S i="" F  S i=$O(fT2(i)) Q:i=""  I $G(fT2(i))'="" s m=$G(fT2(i)) q
 F i=1:1 q:$p(m,",",i,i+1)=""  S ii=$tr($p(m,",",i),$c(34)) d
 .w !," /// "_ii_";"_i_";1;"_$s(ii["DATE":"date",1:"")_";" i ii["DATE" s da(i)=""
 .w !,"Property "_$tr(ii,"_","p")_" As %String(MAXLEN = 1000);",!
 
 w !!,"/// Импорт данных из текстового файла "_fn
 w !,"/// W ##CLASS("_ccn_").Import("""")"
 w !,"ClassMethod Import(fn as %String) As %String"
 w !,"{"
 w !," if $g(fn)="""" s fn="""_fn_""""
 w !," s sc=##class("_ccn_").%KillExtent()"
 w !," i 'sc w sc q"
 w !," D File2Arr^%ZAPM.ed.BSCEXE(fn,.fT1),STR2MAS^%ZAPM.ed.BSCmail(.fT1,.fT2,$C(13,10)) K fT1 s S1=$$s1^%ZAPM.ed.BSre(0),S2=$$s2^%ZAPM.ed.BSre(0)"
 w !," S i="""" F i2=1:1 S i=$O(fT2(i)) Q:i=""""  I i2>1 s m=$G(fT2(i)) d  w i2_"" "" "
 w !," .s ii="""" F i1=1:1 q:$p(m,""@"",i1,i1+1)=""""  s da=$tr($p(m,""@"",i1),S1,S2) d  S ii=ii_da_"","" "
 S i="" F  S i=$O(da(i)) Q:i=""  w !," ..i i1="_i_" s da=$c(34)_$tr($p(da,""."",3),$c(34))_""-""_$p(da,""."",2)_""-""_$tr($p(da,""."",1),$c(34))_$c(34)" 
 w !," ..s da=$c(34)_$tr($e(da,2,$l(da)-1),$c(34),""`"")_$c(34)" 
 w !," .s ii=$e(ii,1,$l(ii)-1)"
 w !," .x ""i ##class("_ccn_"Edit).Add(""_ii_"")"" "
 w !," q 1"
 w !,"}",!
 g GenEnd 
 
rn(cn,Mode,proFile) ;генерация класса редактирования по его свойствам
 n pr,i,ccn
 s ccn=$p(RN,".",1,$l(RN,".")-1)
 d lp^%ZAPM.ed.BSCp2(cn,.pr)
 i $O(pr(""))=""  w "Нет свойств!" q
 w "///Эта %Zen страница предназначена для редактирования класса :"_cn_" на основе",!
 w "/// класса Template.TableEditor                                        (c) D.Krytenev",!
 w "///Она автоматически сгенерена программой %BSCtemiate3 шаблона BsLIB   (c) S.Mikhaylenko",!
 w !
 w "///коментарии у класса "_cn_" используются следующим образом:",!
  w "/// ////Текст коментария;K;O",!
  w "///Текст коментария применяем как заголовок таблицы",!
  w "///K - кол-во строк выводимых на страницу",!
  w "///O - имя поля по которому упорядочиваем строки",!
 w !
 w "///коментарии у свойств класса "_cn_" используются следующим образом:",!
 w "/// ////Текст коментария;x;f;date;w;(1,2,7)",!
 w "///    1   Текст коментария - заголовок колонки и коментарий в поле редактирования",!
 w "///    2   x - код сортировки поля при формирования таблицы просмотра",!
 w "///    3   f - нужен ли фильтр для этого поля",!
 w "///    4   date - свойство имеет тип %String, но там лежит дата в формате ГГГГММДД",!
 w "///    5   w - значение параметра width при формировании панели навигации",!
 w "///    6   ("_proF_") - номера профилей по которым программа будет включать это поле при формировании панели навигации. Если пусто, то включается во все профили",!
 w "///",!
 w " Class "_ccn_" Extends Template.TableEditor",!
 w "{",!!
 
 w "///Параметр - заголовок таблицы",!
 w "Parameter PAGENAME = """_$p(pr,";",1)_""";",!!
 
 w "/// Свойство - заоловок таблицы",!
 w "Property PageTitle As %ZEN.Datatype.string [ InitialExpression = {..#PAGENAME} ];",!!
 
 w "/// Свойство - панель таблицы",!
 w "Property TablePaneId As %ZEN.Datatype.string [ InitialExpression = ""table"", ReadOnly ];",!!
 
 i Mode=2 {
 w " /// cgi-переменная CgiPar2 - должна быть в URL",!
 w "Property CgiPar1 As %String(ZENEXPRESSION = 1, ZENURL = ""CgiPar2"") [ InitialExpression = ""table"" ];",!!
 }
 
 s PageSise=$p(pr,";",2) //количество строк в странице
 i PageSise="" s PageSise=5
 
 w " /// переопределение таблицы",!
 w "XData tablePane [ XMLNamespace = ""http://www.intersystems.com/zen"" ]",!
 w "{",!
 w "<pane xmlns=""http://www.intersystems.com/zen"">",!
 w "<tablePane id=""table""",!
 
  //упорядочивание по умолчанию
 s order="" i $p(pr,";",3)'="" s order=" orderByClause="""_$p(pr,";",3)_""" "
 	 
 	 w "onupdate=""zenPage.getTableHeight()"" ",!
 i Mode=3 {
	 w "bodyHeight=""100%"" ",!
	 w "autoExecute=""true"" ",!
	 w "width=""100%"" ",!
	 w order,!
	 w "useSnapshot=""true"" ",!
	 w "maxRows="""" ",!
	 w "pageSize="""_PageSise_""" ",!
	 w "tableName="""_cn_""" ",!
	 w "valueColumn=""ID"" ",!
	 w "showQuery=""false"" ",!
	 w "showZebra=""true"" ",!
	 w "useKeys=""false"" ",!
	 w "fixedHeaders=""true"" ",!
	 w "headerLayout=""headersOnTop"" ",!
	 w "nowrap=""false"" ",!
 
  }
  i Mode'=3 {  i Mode=2 s sq="sql=""select Id As ID" d
 	.S i="" F  S i=$O(pr(i)) Q:i=""   s sq=sq_","_pr(i) 
 	.s sq=sq_" from "_cn_" where CgiPar1 = ?"" " w sq,!
 	i Mode=1 w "tableName="""_cn_""" ",!
 	w "dataSource=""columns"" ",!
	 w order,!
 	w "valueColumn=""ID"" ",!
 	w "showRowNumbers=""0""",!
 	w "showRowSelector=""0""",!
 	w "useSnapshot=""true""",!
 	w "nowrap=""false""",!
 	w "maxRows="""" ",!
 	w "fixedHeaders=""true"" ",!
 	w "autoExecute=""true"" ",!
 	w "pageSize="""_PageSise_""" ",!
 	w "onselectrow=""zenPage.rowSelected();"" ",!
  }
 
 w ">",!
 w "<column colName=""ID"" hidden=""true""/>",!
 S i="" F  S i=$O(pr(i)) Q:i=""  i $g(pr(i,"prof"))[proFile w "<column colName="""_pr(i)_""" cellTitle="""_pr(i)_""" " d  w " header="""_$g(pr(i,"desc"),"?"_pr(i))_"""/>",!
 .i $g(pr(i,"w"))'="" w "width="""_pr(i,"w")_""""
 .i "13"[Mode,$g(pr(i,"filt"))'="" d
 ..s ii="контекст" i pr(i,"type")="%Date"!($g(pr(i,"spec"))="date") w " filterType=""date"" " s ii="дату"
 ..e  w " filterType=""text"" "
 ..w " filterTitle=""введите "_ii_" фильтра"" "
 i Mode=2 w "<parameter id=""p1"" value=""#(%page.CgiPar1)#"" />",!
 w "</tablePane>",!
 w "<tableNavigator tablePaneId=""table""/>",!
 w "</pane>",!
 w "}",!
 
 
 
 
 w "/// переопределение формы редактирования полей",!
 w "XData formPane [ XMLNamespace = ""http://www.intersystems.com/zen"" ]",!
 w "{",!
 w "<pane xmlns=""http://www.intersystems.com/zen"">",!
  i Mode=3 g Gen2
 w "<!--<vgroup >-->",!
  S i="" F  S i=$O(pr(i)) Q:i=""  i $g(pr(i,"prof"))[proFile  d
 .i pr(i,"type")="%Date"!($g(pr(i,"spec"))="date") w "<dateText id="""_pr(i)_""" label="""_$g(pr(i,"desc"),"?"_pr(i))_""" size=""10"" />",! q
 .w "<text id="""_pr(i)_""" label="""_$g(pr(i,"desc"),"?"_pr(i))_""" size=""140"" />",! q
 w "<!--</vgroup>-->",!
Gen2 w "</pane>",!
 w "}",!
  i Mode=3 d ModeView g GenEnd
  
  
  
 w "/// заполнение полей формы редактирования записи  - должно быть переопределено в подклассах",!
 w "/// Id - ид объекта",!
 w "/// Form - форма редактирования полей",!
 w "ClassMethod openObject(Id, Form As %ZEN.Component.form) As %Status [ ZenMethod ]",!
 w "{",!
 w "	s cur = ##class("_cn_").%OpenId(Id)",!
 S i="" F  S i=$O(pr(i)) Q:i=""  i $g(pr(i,"prof"))[proFile  d
 .i pr(i,"type")="%Date" w "	d Form.%page.%SetValueById("""_pr(i)_""",$zdt(cur."_pr(i)_",3))",! q
 .w "	d Form.%page.%SetValueById("""_pr(i)_""",cur."_pr(i)_")",!
 w "	q $$$OK",!
 w "}",!
 
 
 
 
 w "/// добавление/редактирование записи(сервер) - должно быть переопределено в подклассах",!
 w "ClassMethod addRowS(Id = 0, Form As %ZEN.Component.form) As %String [ ZenMethod ]",!
 w "{",!
 w "	i 'Id s cur = ##class("_cn_").%New()",!
 w "	else  s cur = ##class("_cn_").%OpenId(Id)",!
 w "	 //запись		",!
 w "	//	s cur.XXX = Form.%page.CgiPar1",!
 S i="" F  S i=$O(pr(i)) Q:i=""  i $g(pr(i,"prof"))[proFile  d
 .I pr(i,"type")="%Date" w "		s cur."_pr(i)_" = $zdh(Form.%page.%GetValueById("""_pr(i)_"""),3)",! q
 .w "		s cur."_pr(i)_" = Form.%page.%GetValueById("""_pr(i)_""")",!
 w "		s sc = cur.%Save()",!
	w !	
 w "	i 'sc ",!
 w "	{ ",!
 w "		s mes = $System.Status.GetErrorText(sc)",!
 w "			&js<alert('#(""Ошибка занесения информации! :""_$zcvt(mes,""O"",""JS""))#');>",!
 w "		s Id = 0",!
 w "	} ",!
 w "	else ",!
 w "	{",!
 w "		s Id = cur.%Id()",!
 w "	}",!
 w "	q Id",!
 w "}",!
 w !
 w "/// удаление записи(сервер) - должно быть переопределено в подклассах",!
 w "ClassMethod delRowS(Id) As %Boolean [ ZenMethod ]",!
 w "{",!
 w "	s sc = ##class("_cn_").%DeleteId(Id)",!
 w "	i 'sc ",!
 w "	{ ",!
 w "   			s mes = $tr($System.Status.GetErrorText(sc),""'"",""`"")",!
 w " 			&js<alert('#(""Ошибка занесения информации! :""_$zcvt(mes,""O"",""JS""))#');>",!
 w " 			q 0",!
 w " 	}",!
 w "	q 1",!
 w "}",!!
 //
 w "///В этом методе присваиваем значения по умолчанию",!
 w "Method %OnAfterCreatePage() As %Status",!
 w "{",!
 S i="" F  S i=$O(pr(i)) Q:i=""  i $g(pr(i,"prof"))[proFile  d
 .w "	d ..%SetValueById("""_pr(i)_""","""")",!
 w "	Quit $$$OK",!
 w "}",!!
 //
 
   d Add(""),Add("RecId") 
 
 //
 
 w "/// показать статус или ошибку",!
 w "ClassMethod ShowStatus(s As %String, sc As %String) As %String",!
 w "{",! 
 w " W s,+sc,! ",!
 w " I $$$ISERR(sc) D",!
 w " .D DecomposeStatus^%apiOBJ(sc,.err)",!
 w " .F i=1:1:err W err(i),!",!
 w " Q sc",!
 w "}",!
GenEnd 
 ;w "///Это конец, а где же пистолет? (c) M.Shtirlich",!
 w "}",!!!
 q
Add(m)
 w " /// Добавить запись в базу данных"  i m'="" w " и возвратить новый ID в переменной newId"
 w ".",!
 w " ///Пример > w ##class("_ccn_").Add"_m_"(" i m'="" w ".newId,"
 s sq=""
 S i="" F  S i=$O(pr(i)) Q:i=""   d  s sq=sq_","
 .i pr(i,"type")="%Date" s sq=sq_"+$h" q
 .s sq=sq_""""_pr(i)_"2""" 
 s sq=$e(sq,1,$l(sq)-1) w sq_")",!
 
 s sq="ClassMethod Add"_m_"(" i m'="" s sq=sq_"newID As %String,"
 S i="" F  S i=$O(pr(i)) Q:i=""   d  s sq=sq_","
 .s sq=sq_pr(i)_" As "
 .i pr(i,"type")="%Date" s sq=sq_"%Date"
 .e  s sq=sq_"%String = """" "
 s sq=$e(sq,1,$l(sq)-1)
 w sq_") As %String",!
 w "{",!
 w " S o=##class("_cn_").%New()",!
 S i="" F  S i=$O(pr(i)) Q:i=""   d 
 .w " s o."_pr(i)_"="_pr(i),!
 w " S sc=o.%Save()",!
 i m'="" w " s newID=o.%Id()",!
 w " i sc'=1 d ..ShowStatus(""Ошибка :"",sc)",!
 w " D o.%Close()",!
 w " q sc",!
 w "}",!
 
 q
ModeView 
 w " /// This Style block contains page-specific CSS style definitions.",!
 w "XData Style",!
 w "{",!
 w "<style type='text/css'>",!
 
 w "<!-- стиль для таблицы, цепляется по ид компонента -->",!
 w "#table {",!
 w "	height: 100%;",!
 w "	width: 900px;",!
 w "	overflow: auto;",!
 w "	border: 1px solid darkblue;",!
 w "}",!
 w "</style>",!
 w "}",!
 
 w "XData mainPane [ XMLNamespace = ""http://www.intersystems.com/zen"" ]",!
 w "{",!
 w "<pane xmlns=""http://www.intersystems.com/zen"">",!
 
 w "<vgroup width=""100%"" height=""100%"">",!
 w "<pane paneName=""tablePane"" width=""100%""/>",!
 w "</vgroup>",!
 
 w "</pane>",!
 w "}",!
 
 q
]]></Routine>


<Routine name="%ZAPM.ed.BSCtree" type="MAC" languagemode="0"><![CDATA[
%BSCtree ; пpогpамма работы с деревом
 ;
 ;    Copyright Serge W. Mikhaylenko
 ;    All Rights Reserved
 ;
 Q
TreeStyle(LAB,GLO,ROU,frn,ico,open) //ВЫВЕСТИ СТИЛИ
  //LAB - программа формирования дерева
  //GLO - массив который будем редактировать
  //ROU - программа вызываемая по левому клику
  //frn - имя фрэйма куда выводить результат
  //ico - поддиректория иконок для узлов дерева
  i $G(ico)="" s ico="ico_plus"
  Write "",!
	Write "<STYLE>",!
	Write ".button_light {",!
	Write "        BORDER-RIGHT: #bfcfde 1px solid; BORDER-TOP: #bfcfde 1px solid; FONT-SIZE: 12px; BORDER-LEFT: #bfcfde 1px solid; COLOR: #000000; BORDER-BOTTOM: #bfcfde 1px solid;",!
	Write "}",!
	Write ".text_light {",!
	Write "        FONT-SIZE: 14px; COLOR: #000000;",!
	Write "}",!
	Write ".body_grey {",!
	Write "        BACKGROUND-COLOR: #85C0F2; FONT-SIZE: 14px; COLOR: #000000;",!
	Write "}",!
	Write ".tbl_list_user_uti1l {",!
	Write "        FONT-SIZE: 8pt; COLOR: #000000;",!
	Write "}",!
	Write ".body_grey1 {",!
	Write "        BACKGROUND-COLOR: #85C0F2; FONT-SIZE: 8px; COLOR: #000000;",!
	Write "}",!
	Write ".text {",!
	Write "        FONT-SIZE: 9pt; COLOR: #5679af; FONT-FAMILY: Verdana, arial",!
	Write "}",!
	Write ".tariftext {",!
	Write "        FONT-SIZE: 9px; FONT-FAMILY: Verdana, arial; BACKGROUND-COLOR: #f1f1f1",!
	Write "}",!
	Write ".tarif {",!
	Write "        FONT-SIZE: 9px",!
	Write "}",!
	Write ".cmstarif {",!
	Write "        FONT-SIZE: 9px; BACKGROUND-COLOR: #f1f1f1",!
	Write "}",!
	Write ".cmstarif2 {",!
	Write "        FONT-SIZE: 9px; BACKGROUND-COLOR: #e1e1e1",!
	Write "}",!
	Write ".as {",!
	Write "        PADDING-RIGHT: 10px; PADDING-LEFT: 10px; FONT-SIZE: 8pt; PADDING-BOTTOM: 10px; COLOR: #5679af; PADDING-TOP: 10px; FONT-FAMILY: Verdana, arial; align: justify",!
	Write "}",!
	//Write "BODY {",!
	//Write "        BACKGROUND-IMAGE: url(images/bg2.gif); BACKGROUND-REPEAT: repeat-x",!
	//Write "}",!
	Write "A {",!
	Write "        COLOR: #26497f; TEXT-DECORATION: none",!
	Write "}",!
	Write "A:visited {",!
	Write "        COLOR: #26497f; TEXT-DECORATION: none",!
	Write "}",!
	Write "A:hover {",!
	Write "        COLOR: #7699cf; TEXT-DECORATION: none",!
	Write "}",!
	Write "A:active {",!
	Write "        COLOR: #7699cf; TEXT-DECORATION: none",!
	Write "}",!
	Write ".off {",!
	Write "        DISPLAY: none",!
	Write "}",!
	Write ".menu {",!
	Write "        FONT-WEIGHT: bold; FONT-SIZE: 12px; COLOR: #494949; FONT-FAMILY: Tahoma; valign: top",!
	Write "}",!
	Write ".menu:visited {",!
	Write "        COLOR: #494949",!
	Write "}",!
	Write ".menu:hover {",!
	Write "        COLOR: #494949",!
	Write "}",!
	Write ".menu:active {",!
	Write "        COLOR: #494949",!
	Write "}",!
	Write "IMG.blackBorder {",!
	Write "        BORDER-RIGHT: #000 1px solid; BORDER-TOP: #000 1px solid; BORDER-LEFT: #000 1px solid; BORDER-BOTTOM: #000 1px solid",!
	Write "}",!
	Write ".linkator_td {",!
	Write "        FONT-SIZE: 10px; FONT-FAMILY: Verdana",!
	Write "}",!
	Write ".linkator_a {",!
	Write "        FONT-SIZE: 12px; FONT-FAMILY: Verdana",!
	Write "}",!
	Write ".linkator_url {",!
	Write "        FONT-SIZE: 12px; FONT-FAMILY: Verdana",!
	Write "}",!
	Write ".linkator_table {",!
	Write "        BORDER-TOP: #000000 1px solid",!
	Write "}",!
	Write "</STYLE>",!
 
 	Write "<TABLE id='list' border='0'>",!
	Write "<TR><TD></TD></TR>",!
	Write "</TABLE>",!
    //////////////////////////////////////////////////////////////////////
	Write " <SCRIPT>",!
	Write " var Tree = '';var widgetWidth = 12;var widgetHeight = 12;var CurrentElementOfTree=-1; var Prev1='1';",!
	Write "var fillerImg = new Image(1,1);fillerImg.src = '"_BSDOMAIN_"/img/"_ico_"/filler.gif';minus = new Image(widgetWidth,widgetHeight);minus.src = '"_BSDOMAIN_"/img/"_ico_"/minus.gif';var plus = new Image(widgetWidth,widgetHeight);plus.src = '"_BSDOMAIN_"/img/"_ico_"/plus.gif';",!
 
	w "var end = new Image(widgetWidth,widgetHeight);end.src = '"_BSDOMAIN_"/img/"_ico_"/end.gif';var pCell=document.getElementById('list').rows[0].cells[0];var BR='';",!
	Write "var db = new Array();",!
	
	Write "function GetOpen()",!
	Write "{",!
	Write "    var open=';';",!
	Write "    for(var i=0;i<countRow;i++)",!
	Write "              {",!
	Write "                  open+=db[i].id+'='+db[i].open+';';",!
	Write "              }",!
	Write "    open=open.substr(1);",!
	Write "    return open;",!
	Write "};",!
	
	Write "function SetVisible(i)",!
	Write "{",!
	Write "    db[i].open==0?db[i].open=1*1:db[i].open=0*1;Tree='';GetChild(0,0);pCell.innerHTML=Tree;",!
	Write "};",!
	
	Write "function dbRecord(id,name,parent,open,tit)",!
	Write "{",!
		W "    this.id = id;",!
	Write "    this.name = name;",!
	Write "    this.parent = parent;",!
	Write "    this.open = open*1;",!
	Write "    this.tit = tit;",!
	//Write "     if (this.tit==undefined) {this.tit='id узла:'+id;} ",!  
	Write "     if (this.tit==undefined) {this.tit='Выберите требуемый режим';} ",!  
	//Write "     if (this.tit==undefined) {this.tit='Правой кнопкой мыши выберите требуемый режим';} ",!  
	Write "    return this;",!
	Write "};",!
 
	Write "function DOclick()",!
	Write "    {",!  
	//w "alert(' ='+CurrentElementOfTree+' ='+CurrentI+' ='+db[CurrentI].name);",!
	W " window.open("""_$$ADDBSGET^%ZAPM.ed.BSC4(,ROU)_"&TrID=""+CurrentElementOfTree,"""_$g(frn)_""","""");",!
	Write "    };",!
 
	Write "function Cur(tt)",!
	Write "    {",!  
	W "        if (Prev1=='2') {Prev.style.fontWeight='normal';}"_BK
	W "        tt.style.fontWeight='800';"_BK
	W "        Prev=tt; Prev1='2';",!
	Write "    };",!
	
	Write "function GetChild(id,level)",!
	Write "{",!
	Write "   var onclk;",!
	Write "   for(var i=0;i<countRow;i++)",!
	Write "          {",!
	Write "                 if(db[i].parent==id)",!
	Write "      {",!
	Write "      isHaveChild(db[i].id)?(db[i].open==1?ico='minus':ico='plus'):ico='end';",!
	Write "      ico=='end'?onclk='':onclk='SetVisible('+i+');';",!
	Write "      Tree+=(""<IMG SRC='"_BSDOMAIN_"/img/"_ico_"/filler.gif' HEIGHT='1' WIDTH='""+level*15+""'>"");",! //картинка отступа
	             //картинка ветки дерева
	W "    if (ico=='plus')  {tle='Раскрыть узел';}",!
	W "    if (ico=='minus')  {tle='Закрыть узел';}",!
		W "    if (ico=='end')  {tle='';}",!
	w "          Tree+=(""<IMG style='cursor:hand;' onclick='""+onclk+""hidemenuie5();' oncontextmenu='hidemenuie5();return false;' SRC='"_BSDOMAIN_"/img/"_ico_"/""+ico+"".gif' HEIGHT='18' WIDTH='18' BORDER='0' title='""+tle+""'>"");",! //12
	
	//Write "      Tree+=(""<IMG style='cursor:hand;' onclick='""+onclk+""hidemenuie5();' SRC='"_BSDOMAIN_"/img/"_ico_"/""+ico+"".gif' HEIGHT='12' WIDTH='12' BORDER='0'>"");",!
                 //снова отступ	
	Write "      Tree+=(""<IMG SRC='"_BSDOMAIN_"/img/"_ico_"/filler.gif' HEIGHT='1' WIDTH='5'>"");",!
	             //узел дерева
	//Write "      Tree+=""<SPAN title='""+db[i].tit+""'  style='cursor:hand;' ONCLICK='alert(CurrentElementOfTree=""+db[i].id+"");' oncontextmenu='CurrentElementOfTree=""+db[i].id+"";showmenuie5();return false;'>""+db[i].name+'</SPAN><BR>'+'\r\n';",!
	Write "      Tree+=""<SPAN title='""+db[i].tit+""' style='cursor:hand; text-decoration:underline;' ONCLICK='Cur(this); CurrentI=""+i+""; CurrentElementOfTree=""+db[i].id+""; DOclick();' oncontextmenu='Cur(this); CurrentI=""+i+""; CurrentElementOfTree=""+db[i].id+""; DOclick(); showmenuie5(); return false;'>""+db[i].name+'</SPAN><BR>'+'\r\n';",!
	
	Write "      if(db[i].open==1){GetChild(db[i].id,level+1)};",!
	Write "      }",!
	Write "    }",!
	Write "    return 0;",!
	Write "};",!
	
	Write "function isHaveChild(id)",!
	Write "{",!
	Write "   for(var i=0;i<countRow;i++)",!
	Write "          {",!
	Write "                 if(db[i].parent==id){return 1;}",!
	Write "          }",!
	Write "return 0;",!
	Write "}",!
  D @LAB //А ЗДЕcЬ СФОРМИРУМЕМ ДЕРЕВО, КАК ПРАВИЛО ПО МАССИВУ GLO
	Write "countRow=db.length;",!
	Write "GetChild(0,0);",!
	//W "alert(Tree);",!
	W "pCell.innerHTML=Tree;</SCRIPT>",!
    Q
CMenuJS(ROU,frn,BSrouLoop) //ROU - программа вызываемая по правому клику
    //ON - флаг...
    //frn - имя фрэйма куда отправить результат
	Write "<STYLE>",! //СТИЛИ КОНТЕКСТНОГО МЕНЮ
	Write "#ie5menu{",!
	Write "position:absolute;",!
	Write "border:1px solid black;",!
	Write "background-color:#BBBBBB;",!
	Write "font-family:Arial;",!
	Write "font-size:10px;",!
	Write "line-height:10px;",!
	//Write "cursor:default;",!
	Write "cursor:hand;",!
	Write "visibility:hidden;",!
	Write "}",!
	Write ".menuitems{",!
	Write "padding-left:10px;",!
	Write "padding-right:10px;",!
	Write "}",!
	Write "</STYLE>",!
   
   // D Exec^%ZAPM.ed.BSCp
	
	Write "<SCRIPT language=JavaScript1.2>",!
	Write "var display_url=1;",!
	
	Write "function showmenuie5(){",!
	/* MSW
	Write "var rightedge=document.body.clientWidth-event.clientX;",!
	Write "var bottomedge=document.body.clientHeight-event.clientY;",!
	;W "alert(document.body.clientWidth+'W-X'+event.clientX+'--'+document.body.clientHeight+'H-Y'+event.clientY);",!
	Write "if (rightedge<ie5menu.offsetWidth)",!
	Write "ie5menu.style.left=document.body.scrollLeft+event.clientX-ie5menu.offsetWidth;",!
	Write "if (rightedge >= ie5menu.offsetWidth)",!
	Write "ie5menu.style.left=document.body.scrollLeft+event.clientX;",!
	Write "if (bottomedge<ie5menu.offsetHeight)",!
	Write "ie5menu.style.top=document.body.scrollTop+event.clientY-ie5menu.offsetHeight;",!
	Write "else",!
	Write "ie5menu.style.top=document.body.scrollTop+event.clientY;",!
	*/
	Write "ie5menu.style.top=document.body.scrollTop+event.clientY;",!
	Write "ie5menu.style.left=document.body.scrollLeft+event.clientX;",!
	
	Write "ie5menu.style.visibility='visible';",!
	Write "return false;",!
	Write "}",!
	
	Write "function hidemenuie5(){",!
	Write "ie5menu.style.visibility='hidden';",!
	Write "}",!
	
	Write "function ReturnFalse(){",!
	Write "return false;",!
	Write "}",!
	
	Write "function highlightie5(){",!
	Write " if (event.srcElement.className=='menuitems'){",!
	Write " event.srcElement.style.backgroundColor='highlight';",!
	Write " event.srcElement.style.color='white';",!
	Write " if (display_url==1)",!
	Write " window.status=event.srcElement.url;",!
	Write " }",!
	Write "}",!
	
	Write "function lowlightie5(){",!
	Write " if (event.srcElement.className=='menuitems'){",!
	Write " event.srcElement.style.backgroundColor='';",!
	Write " event.srcElement.style.color='black';",!
	Write " window.status='';",!
	Write " }",!
	Write "}",!
	
	Write "function jumptoie5(){",!
	Write " if (event.srcElement.className=='menuitems')",!
	Write " window.location=event.srcElement.url;",!
	Write "}",!
  
	Write "function DO(param)",!
	Write "    {",!  
	//w "alert(param+' '+CurrentElementOfTree);",!
	Write "    window.open("""_$$ADDBSGET^%ZAPM.ed.BSC4(,ROU)_"""+param+""&TrID=""+CurrentElementOfTree,"""_$g(frn)_""","""");",!
	//W " "_$$OpenWeb^%ZAPM.ed.BSCp2("http://"_$$ADDSN^%ZAPM.ed.BSC4_$$ADDBSGET^%ZAPM.ed.BSC4(,ROU)_"'+param"_$S($G(ON):"+'&TrID='+CurrentElementOfTree",1:""))
	Write "    };",!
	
	Write "</SCRIPT>",!
	Q
Context(LAB) //ПУНКТЫ КОНТЕКСТНОГО МЕНЮ
	Write "<DIV id=ie5menu onmouseover=highlightie5() style='LEFT:207px; VISIBILITY:hidden; TOP:78px' onmouseout=lowlightie5()>",!
	D @LAB //РЕЖИМЫ КОНТЕКСТНОГО МЕНЮ (см.пример в ^%ZAPM.ed.BSCrr)
	Write "</DIV>",!
	Write "<SCRIPT language=JavaScript1.2>",!
	Write "document.body.onclick=hidemenuie5;",!
	Write "</SCRIPT>",!
	Write "",!
 Q
RESTGLO  I $G(BSnumber)="" Q
 s GLO=$G(@BDSES@(BSSES,"VAR","IDNumber",BSnumber))
 I $G(GLO)="" Q
 S GB=$NA(@BDSES@(BSSES,"VAR","ID",GLO))
 Q  //
PClick ////РЕЖИМЫ РЕДАКТИРОВАНИЯ ДЕРЕВА; D locvar^%ZAPM.ed.BSCh0("",1)
 I $G(TrID)="" W "идентификатор массива пустой" Q
 I $G(Mode)="" W "имя режима пусто" Q
 D RESTGLO
 S GL=@GB@(TrID) 
 D @Mode 
 G @BSrouLoop
Copy D A S @BDSES@(BSSES,"VAR","IDExpand",GLO)=GL K @BDSES@(BSSES,"VAR","TreeCopy") M @BDSES@(BSSES,"VAR","TreeCopy")=@GL //,$QS(GL,$QL(GL)))=@GL 
 Q
Paste D A M @GL=@BDSES@(BSSES,"VAR","TreeCopy") 
 Q
KILL D A K @GL q 
Edit D A
 M @A@(Node)=@GL K @GL
 Q
A S A=$P(GL,"(") F I=1:1:$QL(GL)-1 S A=$NA(@A@($QS(GL,I)))
 S @BDSES@(BSSES,"VAR","IDExpand",GLO)=A //УСТАНОВИМ УКАЗАТЕЛЬ ДЛЯ РАСКРЫТИЯ ДЕРЕВА, НА РОДИТЕЛЬСКИЙ УЗЕЛ 
 Q
Ins D A
 S @A@(Node)=""
 q
InsC D A
 S @GL@(Node)=""
 q
EDITGLO 
    //CurrentI - текущий номер массива db
    W $$i(),!
    W $$mi("Изменить","var Node=prompt(""Введите имя узла"",db[CurrentI].name); if (Node!=""""&&Node!=null) {DO(""&Mode=Edit&Node=""+Node);}","Изменить текст текущего узла"),!
	;Write "<DIV class=menuitems style='COLOR: black' onclick='if(confirm(""Вы уверены?"")){location=""?LBL_=INDEX_tree_editor*tree_editor&TBL_=oldtree&OPEN_=1=0;2=0;3=0;4=0;5=0;6=0;7=0;8=0;9=0;10=0;11=0;12=0;13=0;14=0;15=0;21=0;19=0;20=0;28=0;29=0;30=0;31=0;92=0;81=0;79=0;91=0;90=0;86=0;74=0;88=0;89=0;83=0;93=0;85=0;94=0;95=0;96=0;97=0;98=0;99=0;100=0;101=0;102=0;103=0;104=1;105=0;&SESS=1144240589*41985476&OPENER_RELOAD_=1&TBL_=oldtree&SPEC=DELROW&ID_=""+CurrentElementOfTree+""&OPEN_=""+GetOpen();}' >Удалить</DIV>",!
	W $$i(1),!
	W $$mi("Добавить узел","var Node=prompt(""Введите имя узла"",""""); if (Node!=""""&&Node!=null) {DO(""&Mode=Ins&Node=""+Node);}","Добавить новый узел"),!
	W $$i(1),!
	W $$mi("Добавить уровень","var Node=prompt(""Введите имя узла для нового уровня"",""""); if (Node!=""""&&Node!=null) {DO(""&Mode=InsC&Node=""+Node);}","Добавить новый уровень"),!
	W $$i(3),!
	W $$mi("Копировать","DO(""&Mode=Copy"");","Копировать ветку в буфер обмена"),!
	W $$i(1),!
	W $$mi("Вставить","DO(""&Mode=Paste"");","Вставить ветку из буфера обмена"),!
	W $$i(3),!
	W $$mi("Удалить","if(confirm(""Удалить узел со всеми потомками! `""+db[CurrentI].name+""` Вы уверены?"")){DO(""&Mode=KILL"");}","Удалить текущий узел"),!
	W $$i(),!
	Q
i(S) N HR I $G(S)'="" S HR="<HR size="_$G(S,1)_" color=BLACK>" 
 Q "<DIV>"_$G(HR,"&nbsp;")_"</DIV>"
mi(TEXT,JSonCLICK,TIT)
 Q "<DIV title='"_$G(TIT)_"' class=menuitems style='COLOR: black' onclick='"_JSonCLICK_"' >"_TEXT_"</DIV>"
 
Exp(id) i $g(open) q 1 //открыто все дерево сразу 
 Q $S($G(@BDSES@(BSSES,"VAR","IDExpand",GLO))[$P($G(@GL@(id)),")"):1,1:0)
Create //Формируем дерево по массиву GLO (Ограничено 9 уровнями) 
 N ID,GL,I,I1,I2,I3,I4,I5,I6,I7,I8,I9
 I '$D(@GLO) Q
 K @BDSES@(BSSES,"VAR","ID",GLO) S GL=$ZR,@GL=10 
 S I1="" F  S I1=$O(@GLO@(I1)) Q:I1=""  D
 .S ID1=$I(@GL),@GL@(ID1)=$NA(@GLO@(I1))
 .W "db[db.length] = new dbRecord('"_ID1_"', '"_I1_"', '0', "_$$Exp(ID1)_");",!
 .S I2="" F  S I2=$O(@GLO@(I1,I2)) Q:I2=""  D
 ..S ID2=$I(@GL),@GL@(ID2)=$NA(@GLO@(I1,I2))
 ..W "db[db.length] = new dbRecord('"_ID2_"', '"_I2_"', '"_ID1_"', "_$$Exp(ID2)_");",!
 ..S I3="" F  S I3=$O(@GLO@(I1,I2,I3)) Q:I3=""  D
 ...S ID3=$I(@GL),@GL@(ID3)=$NA(@GLO@(I1,I2,I3))
 ...W "db[db.length] = new dbRecord('"_ID3_"', '"_I3_"', '"_ID2_"', "_$$Exp(ID3)_");",!
 ...S I4="" F  S I4=$O(@GLO@(I1,I2,I3,I4)) Q:I4=""  D
 ....S ID4=$I(@GL),@GL@(ID4)=$NA(@GLO@(I1,I2,I3,I4))
 ....W "db[db.length] = new dbRecord('"_ID4_"', '"_I4_"', '"_ID3_"', "_$$Exp(ID4)_");",!
 ....S I5="" F  S I5=$O(@GLO@(I1,I2,I3,I4,I5)) Q:I5=""  D
 .....S ID5=$I(@GL),@GL@(ID5)=$NA(@GLO@(I1,I2,I3,I4,I5))
 .....W "db[db.length] = new dbRecord('"_ID5_"', '"_I5_"', '"_ID4_"', "_$$Exp(ID5)_");",!
 .....S I6="" F  S I6=$O(@GLO@(I1,I2,I3,I4,I5,I6)) Q:I6=""  D
 ......S ID6=$I(@GL),@GL@(ID6)=$NA(@GLO@(I1,I2,I3,I4,I5,I6))
 ......W "db[db.length] = new dbRecord('"_ID6_"', '"_I6_"', '"_ID5_"', "_$$Exp(ID6)_");",!
 ......S I7="" F  S I7=$O(@GLO@(I1,I2,I3,I4,I5,I6,I7)) Q:I7=""  D
 .......S ID7=$I(@GL),@GL@(ID7)=$NA(@GLO@(I1,I2,I3,I4,I5,I6,I7))
 .......W "db[db.length] = new dbRecord('"_ID7_"', '"_I7_"', '"_ID6_"', "_$$Exp(ID7)_");",!
 .......S I8="" F  S I8=$O(@GLO@(I1,I2,I3,I4,I5,I6,I7,I8)) Q:I8=""  D
 ........S ID8=$I(@GL),@GL@(ID8)=$NA(@GLO@(I1,I2,I3,I4,I5,I6,I7,I8))
 ........W "db[db.length] = new dbRecord('"_ID8_"', '"_I8_"', '"_ID7_"', "_$$Exp(ID8)_");",!
 ........S I9="" F  S I9=$O(@GLO@(I1,I2,I3,I4,I5,I6,I7,I8,I9)) Q:I9=""  D
 .........S ID9=$I(@GL),@GL@(ID9)=$NA(@GLO@(I1,I2,I3,I4,I5,I6,I7,I8,I9))
 .........W "db[db.length] = new dbRecord('"_ID9_"', '"_I9_"', '"_ID8_"', "_$$Exp(ID9)_");",!
 Q
SavePost2Tree //СОХРАНИТЬ ДАННЫЕ ПО ШАБЛОНУ ТАБЛИЦЫ-ПАРАМЕТРОВ (OO) В В УЗЕЛ ДЕРЕВА (GL)
 S StopSave=2,val=""
 N STOP,mp s mp=$g(aMp,"&")
 S I="" F  S I=$O(@OO@(I)) Q:I=""   S val=val_I_"="_$G(@OO@(I,"V"))_mp I $G(@OO@(I,"V"))[mp S STOP(I)="Ошибка! Запрещенный символ "_mp
 I $D(STOP) W RED ZW STOP W EF Q 
 D RESTGLO^%ZAPM.ed.BSCtree
 S GL=@GB@(BSTrID)
 S @GL=TBL_mp_val_"zDataSave="_$tr($ZD($H,3),"-")_" "_$ZT($P($H,",",2),1)_" "_$g(BSLOGIN,"?")
 
 W GREEN_"Сохранено"_EF
 Q
PreOpen
PreOpn  //ПОДГОТОВКА ПАРАМЕТРОВ
 N G,I,V,D
  F I=2:1 Q:$P(val,"&",I,I+1)=""  i $P(val,"&",I)'="" S V=$P($P(val,"&",I),"="),D=$P($P(val,"&",I),"=",2,999) D
  .S @BSBD1@(V,"V")=D
 Q
PreOpnAmpFree(w)  //ПОДГОТОВКА ПАРАМЕТРОВ, амперсант разрешен
 N G,I,V,D
  F I=2:1 Q:$P(val,w,I,I+1)=""  i $P(val,w,I)'="" S V=$P($P(val,w,I),"="),D=$P($P(val,w,I),"=",2,999) D
  .S @BSBD1@(V,"V")=D
 Q
 
PreSaveAmpFree(aMp) //ЛОГИКА ПРОВЕРОК
 D BEG1^%ZAPM.ed.BSC4
 D SavePost2Tree^%ZAPM.ed.BSCtree
 D END^%ZAPM.ed.BSC4
 q
PreSave //ЛОГИКА ПРОВЕРОК
 D BEG1^%ZAPM.ed.BSC4
 D SavePost2Tree^%ZAPM.ed.BSCtree
 D END^%ZAPM.ed.BSC4
 q
GetValTree(NOD,V,w) Q $P($P(NOD,$g(w,"&")_V_"=",2),$g(w,"&")) //получить значение показателя из узла дерева
SetValTree(val,V1,NewVal,w) //Присвоить новое значение
 n a,I,V,D 
 F I=2:1 Q:$P(val,$g(w,"&"),I,I+1)=""  i $P(val,$g(w,"&"),I)'="" S V=$P($P(val,$g(w,"&"),I),"="),D=$P($P(val,$g(w,"&"),I),"=",2,999) s V(V)=$tr(D,$g(w,"&"))
 s V(V1)=NewVal
 s a=$p(val,$g(w,"&"))_$g(w,"&") S I="" F  S I=$O(V(I)) Q:I=""   S a=a_I_"="_$G(V(I))_$g(w,"&") 
 Q a //и возвратить значение всего узла
GetA(R) I R="" S R=2 //ПОКА ТАК
 Q $S(+R<2:"N",R=2:"R",R=3:"W",1:"X")
 ////////////////////////////////////////////////////////////////
GetSQL(sql,Col,R,ns) //возвратить sql утверждения и положить его в лок.массив по ссылке
 n curns,ErrOR,Res,Sc,COL,i,j,J,ret,%ROWCOUNT,SQLCODE,%ROWID
 s ns=$g(ns,"ASU") s curns=$zu(5)
 i $zu(5)'=ns zn ns
 S Res=##Class(%ResultSet).%New()
 s Sc=Res.Prepare(sql) I 'Sc S ErrOR=$$Status^%ZAPM.ed.BSCtree(Sc) G DSNend31
 I 'Res.QueryIsValid() S ErrOR="Недопустимый Запрос" G DSNend31
 s Sc=Res.Execute()
 I 'Sc S ErrOR=$$Status^%ZAPM.ed.BSCtree(Sc) G DSNend31
 f i=1:1 q:'Res.Next()  f j=1:1:Col s R(i,j)=Res.GetData(j)
DSNend31 ;zw ErrOR
 k Res ;d Res.%Close()
 i curns'=$zu(5) zn curns
 i $d(ErrOR) q $g(ErrOR)
 q $g(i) //количкство найденных строк
GetF(T,F1,D1,F,ns) //возвратить значение поля F для первой найденной записи из таблицы T при условии F1=D1
 n curns,ErrOR,Res,Sc,sql,COL,i,J,ret,%ROWCOUNT,SQLCODE,%ROWID
 s ns=$g(ns,"ASU") s curns=$zu(5)
 i $zu(5)'=ns zn ns
 S Res=##Class(%ResultSet).%New()
 s sql="select "_F_" from "_T_" where "_F1_"='"_D1_"'" ;s ^%zz=sql
 s Sc=Res.Prepare(sql) I 'Sc S ErrOR=$$Status^%ZAPM.ed.BSCtree(Sc) G DSNend3
 I 'Res.QueryIsValid() S ErrOR="Недопустимый Запрос" G DSNend3
 s Sc=Res.Execute()
 I 'Sc S ErrOR=$$Status^%ZAPM.ed.BSCtree(Sc) G DSNend3
 f i=1:1 q:'Res.Next()  s ret=Res.GetData(1) q 
DSNend3 ;zw ErrOR
 k Res ;d Res.%Close()
 i curns'=$zu(5) zn curns
 i $d(ErrOR) q $g(ErrOR)
 q $g(ret,"?.")
Status(sc) ;СТАТУС
 N err,i,st1
 I ('sc) D  Q st1
 .D DecomposeStatus^%apiOBJ(sc,.err)
 .S st1="" F i=1:1:err S st1=st1_err(i)_". "
 Q ""  
GetASUOpt(name,BSLOGIN) //параметры ИП и пользователя, если они совпадают
 n u
 s u=$$GETOPT^%ZAPM.ed.BSC4cfgP($na(@"^[""PRG""]BSc4uSERS"@(BSLOGIN,"FNM","ASU")),name,,"^[""PRG""]MSM.ASURP.OPTuser")
 i u="" q $$GETOPT^%ZAPM.ed.BSC4cfgP("^[""PRG""]MSM.ASURP.OPTOIN",name)
 q u
 //"ASUEHGm.opt","NameOpt","NarIdDir","ValOpt","ASU"
GetOpt(Packet,sc,NameOpt) //функция, специально для получения значений опции для ИП
 n r,%objlasterror,%msg
 s r=$$GetF(Packet_".opt","NameOpt",NameOpt,"ValOpt","ASU")
 i $d(%objlasterror) m sc=%objlasterror s r=""
 e  s sc="1 ок"
 i r="?." s sc="2 undef",r=""
 q r
SetOpt(Packet,sc,NameOpt,ValOpt) //функция, специально для присвоения значения опции для ИП
 n id,cur,ns,curns
 s id=$$GetF(Packet_".opt","NameOpt",NameOpt,"ID","ASU")
  s ns=$g(ns,"ASU") s curns=$zu(5)
 i $zu(5)'=ns zn ns
  x "s cur = ##class("_Packet_".opt).%OpenId(id)"
	s cur.ValOpt = ValOpt
	s sc = cur.%Save()
	k cur
	i curns'=$zu(5) zn curns
	 i 'sc q sc
 q id
 ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
WebTreeEdit(BSns,BSgl,BSglMode) //редактор массивов в виде дерева
 i $g(ns)'="" s ns=$$%^%ZAPM.ed.BSCh(ns)
 e  s ns=$zu(5)
 n BSNSP i ns'=$zu(5) zn ns
 s BSNSP=$zu(5)
 D BEG1^%ZAPM.ed.BSC4
 w "<table border=0>"_BK
 w "<tr>"_BK
 w "<td ><DIV class=s3 id='span1'>Рабочая область/Глобал/Индексы:"_BLUE_ns_EF_"</DIV></td>"_BK
 w "<td ><DIV class=s3 id='span2'>Характеристики</DIV></td>"_BK
 w "</tr><tr>"_BK
 W "<td valign=top >"_$$Tree1("Str","Tree12^%ZAPM.ed.BSCtree",450,400)
 w "</td>"
 W "<td valign=top >"_$$Tree1("Atr","Tree0^%ZAPM.ed.BSCtree",450,400)
 W "<td valign=top >"_$$Tree1("Wrk","Tree0^%ZAPM.ed.BSCtree",450,400)
 w "</td>"
 W "</tr>"_BK
 W "</table>"
 w "<DIV class=s3 id='spanStaus' >...</DIV>"
 D END^%ZAPM.ed.BSC4 
 q
Tree1(IDIF,ROU,H,W) //ВЫВОД ИФРЭЙМА
 Q BK_"<IFRAME HEIGHT='"_H_"px' "_$s($g(W):"width='"_W_"px'",1:"")_" SRC='"_$$ADDBSGET^%ZAPM.ed.BSC4(,ROU)_"' name='"_IDIF_"' SCROLLING='auto'></IFRAME><BR>"_BK 
Tree0
 D BEG1^%ZAPM.ed.BSC4 D END^%ZAPM.ed.BSC4
 q
bb  i $d(BDSES) s bb=$na(@BDSES@(BSSES,"VAR","str"_$g(BSns)_$g(BSgl))) //буферный массив идентификаций узлов дерева
 q
Tree12 //первый уровень редактора глобала
 D BEG1^%ZAPM.ed.BSC4 
 n LIST,noSay,mm,i,ii
 d bb s mm=1
 i $g(BSgl)="" s noSay=1 d addGlo^%ZAPM.ed.BSC4r4("*")  S i="" F ii=1:1 S i=$O(LIST(i)) Q:i=""  d AddGl(ii,"^"_$p(i,".GBL"))
 i $g(BSgl)'=""  d AddGl(1,BSgl)
 d Lev1^%ZAPM.ed.BSCtree(.mm,"Level^%ZAPM.ed.BSCtree(2)","","ClickImg2^%ZAPM.ed.BSCtree","ClickTxt^%ZAPM.ed.BSCtree("_$g(BSglMode)_")")
 q
AddGl(ii,g) s mm(ii)=BLUE_g_EF,mm(ii,1)=g i $o(@g@(""))="" s mm(ii,0)=1
 q
ClickTxt(Mode) d bb s s=@bb@(id)
 D BEG1^%ZAPM.ed.BSC4 
 w RED_@bb@(id,1)_EF_"="_MAROON_$g(@@bb@(id,1))_EF
 i $g(Mode,0)=0 g ClickTxtEnd
 //Редактировать
 s gg=@bb@(id,1),i=$p(gg,$qs(gg,0)_"(",2)
 w "<hr>" w "<BODY>" w "<form action="""_$$ADDLIB^%ZAPM.ed.BSC4()_""" method=""POST"">"
 S BSLABEL="SaveEditGlo^~BSCtree" D ADDBSPOST^%ZAPM.ed.BSC4reg
 D TABL^%ZAPM.ed.BSCp
 D TR21^%ZAPM.ed.BSCp W "Рабочая область" D TR22^%ZAPM.ed.BSCp w " <input size=33 type=textbox name=nameGln value='"_$zu(5)_"' title='Редактируйте'>"  D TR23^%ZAPM.ed.BSCp
 D TR21^%ZAPM.ed.BSCp W "Имя массива" D TR22^%ZAPM.ed.BSCp w " <input size=33 type=textbox name=nameGl value='"_$p($qs(gg,0),"^",2)_"' title='Редактируйте имя массива'>"  D TR23^%ZAPM.ed.BSCp
 D TR21^%ZAPM.ed.BSCp W "Индексы " D TR22^%ZAPM.ed.BSCp w " <input  size=33 type=textbox name=nameGli value='"_$e(i,1,$l(i)-1)_"' title='Редактируйте индексы'>" D TR23^%ZAPM.ed.BSCp
 s i=$$Quote^%cspQuote($g(@gg,"<undef>"))
 D TR21^%ZAPM.ed.BSCp W "Данные в узле " D TR22^%ZAPM.ed.BSCp w " <input  size=43  type=textbox name=nameGld value='"_$e(i,1,$l(i)-1)_"' title='Редактируйте индексы'>" D TR23^%ZAPM.ed.BSCp
 D TABLE^%ZAPM.ed.BSCp
 w "<input type=submit name=sDUB value='Copy' title='copy...'>"_BK
 w "</form>"
ClickTxtEnd D END^%ZAPM.ed.BSC4
 q
SaveEditGlo //сохранение изменений
 D BEG1^%ZAPM.ed.BSC4
 w 1,nameGld,1
 W "записано" 
 D END^%ZAPM.ed.BSC4
 q
ClickImg2 //раскрытие\закрытие любого уровня
  D bb d ClickImg^%ZAPM.ed.BSCtree
  q
Level(l)  n i,mm,g
  S mm=l,g=@bb@(id,1)
  s i="" F  S i=$O(@g@(i)) Q:i=""  d
  .s mm(i)=$tr(i,"'"_$c(34),"``")  //текст узла
  .s mm(i,1)=$na(@g@(i)) 
  .s mm(i,2)=$tr($na(@g@(i)),"'"_$c(34),"``") //всплывающий текст ссылки на узел
  .i $o(@g@(i,""))="" s mm(i,0)=1 //если дальше нет, то заглушим
  d Lev2^%ZAPM.ed.BSCtree(l-1,.mm,"Level^%ZAPM.ed.BSCtree("_(l+1)_")",(l-1)_" индекс масива")
  q
 ////////////////////////////новое правильное дерево
Lev1(mm,L2,Tit,RouImg,RouTxt) //%%%%%%%%%%%%цикл по первому уровню
 //bb - буфер от сессии
 D BEG1^%ZAPM.ed.BSC4 k @bb
  S i="" F i1=1:1 S i=$O(mm(i)) Q:i=""  d
  .s id=$i(@bb) s @bb@(id)=$g(mm)_"&"_i_"&"_1_"&"_L2_"&0&"
  .i $d(mm(i,1)) s @bb@(id,1)=mm(i,1)
  .w "<div id='s"_id_"'>" s ico="plus",tit="Раскрыть узел",on="onclick=""ClickImg("_id_");"" "
  .i $d(mm(i,0)) s ico="end",tit="Узел не имеет потомков",on=""
  .i $d(mm(i,2)) s Tit=$TR(mm(i,2),"'"_$C(34),"``")
  .s ti="title='"_Tit_"'>"_mm(i)
  .s $p(@bb@(id),"&",8)=ti 
  .w "<img border=0 src='"_BSDOMAIN_"/img/ico_plus/"_ico_".gif' ALT='"_tit_"' "_on_" >" 
  .w " <SPAN  class=u1 onclick=""Cur(this); ClickTxt("_id_");"" "_ti_"</SPAN>"
  .w "</div>"_BK
 w BK
 D JS^%ZAPM.ed.BSCp
  W "function ClickImg(id) {"_BK
  w "open("""_$$ADDBSGET^%ZAPM.ed.BSC4(,RouImg)_"&id=""+id,""Wrk"","""");"_BK
  w "}"_BK
  W "function ClickTxt(id) {"_BK
  w "open("""_$$ADDBSGET^%ZAPM.ed.BSC4(,RouTxt)_"&id=""+id,""Atr"","""");"_BK
  w "}"_BK
    w "var Prev1='1';"_BK
  	Write "function Cur(tt)"_BK
	Write "    {"_BK
	W "        if (Prev1=='2') {Prev.style.fontWeight='normal';}"_BK
	W "        tt.style.fontWeight='800';"_BK
	W "        //alert(Prev1);"_BK
	w "        Prev=tt; Prev1='2';"_BK
	Write "    };"_BK
	
 D JSE^%ZAPM.ed.BSCp
 D END^%ZAPM.ed.BSC4
 q
ClickImg //%%%%%%%%%%% раскрытие\закрытие любого уровня
 n s,rou,i
 s s=$g(@bb@(id)) i s="" w "!!!!!!" q
 D JS^%ZAPM.ed.BSCp
 w "var s1="""_$$sp($p(s,"&",5))_"<img border=0 src='"_BSDOMAIN_"/img/ico_plus/"_$$icon_".gif' onclick='ClickImg("_id_");'  >""; "_BK 
 w " s1=s1+"" <SPAN class=u1 onclick='Cur(this); ClickTxt("_id_");' "_$p(s,"&",8)_"</SPAN>"";"_BK
 i '$p(s,"&",3) s $p(@bb@(id),"&",3)=1 g CC //вкл\выкл
 s rou=$p(s,"&",4) i rou'="" d @rou //подключается программа добавления узлов ноовго уровня
 s $p(@bb@(id),"&",3)=0
CC W "parent.Str.s"_id_".innerHTML=s1;"_BK
 D JSE^%ZAPM.ed.BSCp
 q 
 //&#160;
sp(n) n i,s s s="" i 'n q ""  //%%%%%% n-номер уровня
 f i=1:1:n  s s=s_"<img border=0 src='"_BSDOMAIN_"/img/ico_plus/empty.gif' >"
 q s
icon() i '$p(s,"&",3) q "plus" //%%%% имя картинки
  i $p(s,"&",3) q "minus"
 q "end"
 
Lev2(Lev,mm,L3,Tit) //%%%%% второй, и все последующие уровени
 i '$d(mm) w " s1=s1+""<div>"_$$sp(1)_"...пусто</div>"";"_BK q
 n id,i,q
  S i="" F  S i=$O(mm(i)) Q:i=""  d
  .s id=$i(@bb) 
  .s @bb@(id)=$g(mm)_"&"_i_"&"_1_"&"_L3_"&"_Lev_"&"
  .i $g(mm(i))="" s mm(i)="_"
  .i $d(mm(i,1)) s @bb@(id,1)=mm(i,1)
  .i $d(mm(i,2)) s Tit=$TR(mm(i,2),"'"_$C(34),"``")
  .s ti="title='"_Tit_"'>"_mm(i)_" "
  .s $p(@bb@(id),"&",8)=ti
  .s q="<div id='s"_id_"'>" s ico="plus",tit="Раскрыть узел",on="onclick='ClickImg("_id_");' "
  .i $d(mm(i,0)) s ico="end",tit="Узел не имеет потомков",on="" 
  .s q=q_$$sp(Lev)_"<img border=0 src='"_BSDOMAIN_"/img/ico_plus/"_ico_".gif' ALT='"_tit_"' "_on_" >" 
  .s q=q_" <SPAN  class=u1 onclick='Cur(this); ClickTxt("_id_");' "_ti_"</SPAN>"
  .w " s1=s1+"" "_q_"</div> "";"_BK
 q
GetTemplateUrl(pack,ParName) //получить ТК-WEB url шаблона из Инфотеки из параметра
 n gl,url,err
 ZN $$v^%ZAPM.ed.BSCp("vASU")
 s gl=$$GetOpt^%ZAPM.ed.BSCtree(pack,.err,ParName) //шаблон
 i +err'=1 w RED_err_EF  q ""
 n BSDOMAIN,BSFRM2,BSGRANT,BSLABEL,BSLABEL2,BSNSP,BSNSP2,BSac,BSarm,BSdebug,BStyle,BSpath
 s BSNSP="ASU"
 s url=$$GetIpUrl^%ZAPM.ed.BSCp(gl)
 i url["size(0)" w RED_"В Инфотеке в карточке №"_gl_" расположен пустой файл!"_EF g GetTemplateUrl2
 i url["Error:" w RED_"Ошибка загрузки файла из Инфотеки в карточке №"_gl_".<b>"_BBK_$ZCVT(url,"O","HTML")_"</b>"_EF g GetTemplateUrl2
 W "Формируем ... и выводим его в MS-Excel - шаблон :"_RED_url_EF_"<hr>" 
 q url
GetTemplateUrl2
 q "" 
 
 
]]></Routine>


<Routine name="%ZAPM.ed.BSD" type="MAC" languagemode="0"><![CDATA[
%BSD ;КАТАЛОГИ %BS ; 14:00   02.04.99
 N NUM,IntBSD,BSR,BST
 D SI^%ZAPM.ed.BSN S NUM=%BS(15)
 D NNN^%ZAPM.ed.BSN(",NUM") S %BS(15)=999,IntBSD=%BS,$P(%BS,"!",4)=$P(%BS,"!",11),$P(%BS,"!",5)=$P(%BS,"!",12)
 D MGR^%ZAPM.ed.BS I $ZV["MSM" D UCI^%ZAPM.ed.BS
 I $ZV["Cach"||($ZV["IRIS") D DIR^%ZAPM.ed.BSCF2
 S %BS=IntBSD,%BS(15)=NUM
 I $D(BSR),$D(BST) S %BsR=BSR,%BsT=BST D
 .I %BsR["]" S %File=%BsT_","_$P(%BsR,"]",2)_","_$P(%BsR,$C(34),2)_","_$P(%BsR,$C(34),4)
 .E  S %File=%BsT_","_$P(%BsR,"^",2)_","_$P($$ZU^%ZAPM.ed.BS3(0),",")_","_$P($$ZU^%ZAPM.ed.BS3(0),",",2)
 K ^%ZAPM.ed.BSbufB("T"_$G(%BS(3),$P)_$J_"u"_%BS(15)),^%ZAPM.ed.BSbufB("R"_$G(%BS(3),$P)_$J_"u"_%BS(15)),^%ZAPM.ed.BSbufB("BUF"_$G(%BS(3),$P)_$J_"u"_%BS(15)),^%ZAPM.ed.BSbufB("fT"_$G(%BS(3),$P)_$J_"u"_%BS(15)),^%ZAPM.ed.BSbufB("uCI"_$G(%BS(3),$P)_$J_"u"_%BS(15))
 D QQQ^%ZAPM.ed.BSN("")
 Q
 ;СТАРАЯ
 D SI^%ZAPM.ed.BSN D NNN^%ZAPM.ed.BSN("")
0 D CLr^%ZAPM.ed.BSF4 ;U $I::%BS(32) U 0:(0::::#10080)
 D WAIT^%ZAPM.ed.BSF2 G UCI:$$ZU^%ZAPM.ed.BS3(0)=$$ZU^%ZAPM.ed.BS3(1,0),RAZD
MGR G MGR^%ZAPM.ed.BS
UCI S MRMR="W /CUP(23,1),/EL(0),$$clr^%ZAPM.ed.BS3(6),"" <Enter>-РАСКРЫТЬ КИП !!! РЕЖИМ ВЫБОРА ТАБЛИЦЫ !!! <Esc>-ОТМЕНА  """
 S %uCI=$V(2,$J,2) D MGR
 S BSR="^%ZAPM.ed.BSbufB",BST="ftT"_$G(%BS(3),$P)_$J_"u"_%BS(15) I $D(@(BSR_"(BST,""STA"")")) D STA^%ZAPM.ed.BST G UCIE
 K ^%ZAPM.ed.BSbufB("ftT"_$G(%BS(3),$P)_$J_"u"_%BS(15)),^%ZAPM.ed.BSbufB("utCI"_$G(%BS(3),$P)_$J_"u"_%BS(15)) S i=-1,YES=1
 F I=0:1:7 I $$ZU^%ZAPM.ed.BS3(1,I)'="" S i=i+1,(%BS(8,i),^%ZAPM.ed.BSbufB("utCI"_$G(%BS(3),$P)_$J_"u"_%BS(15),i))=$P($$ZU^%ZAPM.ed.BS3(1,I),",",2) D VOL^%ZAPM.ed.BSH(@$ZR,i) G EXIT:'YES F J=1:1 Q:$$ZU^%ZAPM.ed.BS3(J,I)=""  S ^%ZAPM.ed.BSbufB("utCI"_$G(%BS(3),$P)_$J_"u"_%BS(15),i,J)=$P($$ZU^%ZAPM.ed.BS3(J,I),",")
 S j=0,(se,ke)=0 F I=0:1 Q:'$D(^%ZAPM.ed.BSbufB("utCI"_$G(%BS(3),$P)_$J_"u"_%BS(15),I))  S sys=^%ZAPM.ed.BSbufB("utCI"_$G(%BS(3),$P)_$J_"u"_%BS(15),I) D
 .I %BS(12)'="",'$D(@%BS(18)@(%BS(37),"*")),'$D(@%BS(18)@(%BS(37),sys)) Q
 .S j=j+1,^%ZAPM.ed.BSbufB("ftT"_$G(%BS(3),$P)_$J_"u"_%BS(15),1,j)="@@1@11@@@@"_$S(I=0:0,1:"1,1")_"@1@"_$P(%BS,"!",4)_"@@@@@"_I,i=2,^%ZAPM.ed.BSbufB("ftT"_$G(%BS(3),$P)_$J_"u"_%BS(15),i,j)="@@1@11@@@@@1@@@@@@ -----------"
 .F J=1:1 Q:'$D(^%ZAPM.ed.BSbufB("utCI"_$G(%BS(3),$P)_$J_"u"_%BS(15),I,J))  D  ;
 ..I %BS(12)'="",'$D(@%BS(18)@(%BS(37),"*")),'$D(@%BS(18)@(%BS(37),sys,"*")),'$D(@%BS(18)@(%BS(37),sys,^%ZAPM.ed.BSbufB("utCI"_$G(%BS(3),$P)_$J_"u"_%BS(15),I,J))) Q
 ..S i=i+1,^%ZAPM.ed.BSbufB("ftT"_$G(%BS(3),$P)_$J_"u"_%BS(15),i,j)="@@1@11@@@@"_$S(J=1&(I=0):0,1:"3,1")_"@1@"_$P(%BS,"!",5)_"@@@@@"_I_","_J
 ..S:se<i se=i S:ke<j ke=j
 I se=0 S ls=" НЕТ ДОСТУПНЫХ КИПов ! " D O^%ZAPM.ed.BSF7 G EXIT
 S ^%ZAPM.ed.BSbufB("ftT"_$G(%BS(3),$P)_$J_"u"_%BS(15))="@@@@@@@1@1@22@80@@X MRMR@@@1@1@@3,1@@@@@@1"
 S ^%ZAPM.ed.BSbufB("ftT"_$G(%BS(3),$P)_$J_"u"_%BS(15),"FTR",1,1)="S d1="" ±­· ""_^%ZAPM.ed.BSbufB(""utCI""_$G(%BS(3),$P)_$J_""u""_%BS(15),d)"
 S ^%ZAPM.ed.BSbufB("ftT"_$G(%BS(3),$P)_$J_"u"_%BS(15),"FTR",3,1)="S d1="" ±­· ""_^%ZAPM.ed.BSbufB(""utCI""_$G(%BS(3),$P)_$J_""u""_%BS(15),$P(d,"",""),$P(d,"","",2))"
 D RESZER^%ZAPM.ed.BSF2,TAB^%ZAPM.ed.BSF1,^%ZAPM.ed.BST
UCIE I $D(%BS(8,+d)) D UCI^%ZAPM.ed.BSH(%BS(8,+d),+d) G EXIT:'YES S %VGI=+d ;D CKD^%ZAPM.ed.BSF5(+d)
 I $D(TABLfind) G TAB
 I $D(NEWVOLUM) K NEWVOLUM,^%ZAPM.ed.BSbufB("ftT"_$G(%BS(3),$P)_$J_"u"_%BS(15)) G UCI
 I R1=27!(ny<3)!(d="") G EXIT
 S BSbufR="@@1@77@@@@@1@"_$P(%BS,"!",4)_"@@@@@·­±.. "_^%ZAPM.ed.BSbufB("utCI"_$G(%BS(3),$P)_$J_"u"_%BS(15),$P(d,","),$P(d,",",2))_"         ;   Комментарии к разделам"
 V 2:$J:+$P(d,",")*32+$P(d,",",2):2 K ^%ZAPM.ed.BSbufB("Rt"_$G(%BS(3),$P)_$J_"u"_%BS(15))
RAZD ;ВЫБОР РАЗДЕЛА
 S MRMR="W /CUP(23,1),/EL(0),$$clr^%ZAPM.ed.BS3(6),"" <Enter>-ВЫБОР РАЗДЕЛА !!! РЕЖИМ ВЫБОРА ТАБЛИЦЫ !!! <Esc>-ОТМЕНА """
 S BSR="^%ZAPM.ed.BSbufB",BST="Rt"_$G(%BS(3),$P)_$J_"u"_%BS(15) I $D(@(BSR_"(BST,""STA"")")) D STA^%ZAPM.ed.BST G RAZDE
 S %NAM="^",i=1,^%ZAPM.ed.BSbufB("Rt"_$G(%BS(3),$P)_$J_"u"_%BS(15),1,1)=$G(BSbufR,"@@1@77@@@@@1@1;6;80;45@@@@@·­±.. "_$$ZU^%ZAPM.ed.BS3(0)_"        ;   Комментарии к разделам")
 S %zT=$ZT,$ZT="PRO^%ZAPM.ed.BS"
 W /CUP(1,1),%BS(12)
RAZPR F  S %NAM=$O(@%NAM) Q:%NAM=""  S %NAM="^"_%NAM X $G(WA) D
 .I %BS(12)'="",'$D(@%BS(18)@(%BS(37),"*")),'$D(@%BS(18)@(%BS(37),$P($$ZU^%ZAPM.ed.BS3(0),",",2),"*")),'$D(@%BS(18)@(%BS(37),$P($$ZU^%ZAPM.ed.BS3(0),",",2),$P($$ZU^%ZAPM.ed.BS3(0),","),"*")),'$D(@%BS(18)@(%BS(37),$P($$ZU^%ZAPM.ed.BS3(0),",",2),$P($$ZU^%ZAPM.ed.BS3(0),","),$P(%NAM,"^",2))) Q
 .S i=i+1,^%ZAPM.ed.BSbufB("Rt"_$G(%BS(3),$P)_$J_"u"_%BS(15),i,1)="@@1@77@@@@@1@"_$P(%BS,"!",5)_"@@@@@"_$$PPP(%NAM)_" "_%NAM_$J("",14-$L(%NAM))_";"_$$HEADGLO^%ZAPM.ed.BSMSM(%NAM)
 S $ZT=%zT,^%ZAPM.ed.BSbufB("Rt"_$G(%BS(3),$P)_$J_"u"_%BS(15))="@@@@@@@1@1@22@80@@X MRMR@@@1@1@@@@@@@@1",se=i,ke=1
 D TAB^%ZAPM.ed.BSF1,^%ZAPM.ed.BST
RAZDE I $D(%BS(8)),$D(%VGI),$D(%BS(8,%VGI)) D UCI^%ZAPM.ed.BSH(%BS(8,%VGI),%VGI) G EXIT:'YES
 I $D(TABLfind) G TAB
 I R1=27!(ny=1) K ^%ZAPM.ed.BSbufB("Rt"_$G(%BS(3),$P)_$J_"u"_%BS(15)) S R1=27 G UCIE:$D(BSMGR) G UCI
 I d'["%BS-Раздел ;" S %BsR=$P(d," ",2),%BsT="<???>" G EX
 S %NAM=$P(d," ",2) K HIDDR
TAB K %BS(9) ;ВЫБОР ТАБЛИЦЫ
 S MRMR="W /CUP(23,1),/EL(0),$$clr^%ZAPM.ed.BS3(6),"" <Enter>-ВЫБОР ТАБЛИЦЫ !!! РЕЖИМ ВЫБОРА ТАБЛИЦЫ !!! <Esc>-ОТМЕНА """
 K EXITout,TABLfind S Ii=$S(%NAM="^%ZAPM.ed.BSbufS":79,1:77)
 S BSR="^%ZAPM.ed.BSbufB",BST="Tt"_$G(%BS(3),$P)_$J_"u"_%BS(15) I $D(@(BSR_"(BST,""STA"")")) D STA^%ZAPM.ed.BST G TABE
 S %TAB="",i=1 K ^%ZAPM.ed.BSbufB("Tt"_$G(%BS(3),$P)_$J_"u"_%BS(15)),SPSV S ^%ZAPM.ed.BSbufB("Tt"_$G(%BS(3),$P)_$J_"u"_%BS(15),1,1)="@@1@"_Ii_"@@@@@1@"_$P(%BS,"!",4)_"@@@@@·­±.. "_%NAM_$J("",9-$L(%NAM)+Ii-77)_"        ; ТИП  ;   Комментарии к таблицам"
 S:Ii'=79 ^%ZAPM.ed.BSbufB("Tt"_$G(%BS(3),$P)_$J_"u"_%BS(15),2,1)="@@1@"_Ii_"@@@@@1@"_$P(%BS,"!",5)_"@@@@@·­± ~new table    "_$J("",Ii-77)_" ;      ;",i=i+1 S i=i+1,^%ZAPM.ed.BSbufB("Tt"_$G(%BS(3),$P)_$J_"u"_%BS(15),i,1)="@@0@"_Ii_"@@@@0@1@@@@@@"
 S ^%ZAPM.ed.BSbufB("Tt"_$G(%BS(3),$P)_$J_"u"_%BS(15),"FTR",i,1)="S m=$P($P(d,""~"",2),"" ""),d1=$S($P($G(@(%NAM_""(m)"")),""@"",30)="""":d,1:$P(d,"".."")_$P($G(@(%NAM_""(m)"")),""@"",30)_$J("""",7-$L($P($G(@$ZR),""@"",30)))_"";""_$P(d,"";"",2,99))"
 S Iii=i I Ii=79 S @$ZR=$P(@$ZR,",d1")_",m=""^[""""""_$P(m,"":"")_"""""":""""""_$P(m,"":"",2)_""""""]""_$P(m,"":"",3),d1"_$P(@$ZR,",d1",2,99)
 S sys=$P($$ZU^%ZAPM.ed.BS3(0),",",2),uc=$P($$ZU^%ZAPM.ed.BS3(0),",") F  S %TAB=$O(@(%NAM_"(%TAB)")) Q:%TAB=""  X $G(WA) I %TAB'["@"&(%TAB'[$G(HIDD,"&")) D  ;
 .I %BS(12)'="",'$D(@%BS(18)@(%BS(37),"*")),'$D(@%BS(18)@(%BS(37),sys,"*")),'$D(@%BS(18)@(%BS(37),sys,uc,"*")),'$D(@%BS(18)@(%BS(37),sys,uc,"*")),'$D(@%BS(18)@(%BS(37),sys,uc,$P(%NAM,"^",2),"*")),'$D(@%BS(18)@(%BS(37),sys,uc,$P(%NAM,"^",2),%TAB)) Q
 .I Ii=79 D  S i=i+1,^%ZAPM.ed.BSbufB("Tt"_$G(%BS(3),$P)_$J_"u"_%BS(15),i,1)="@@1@"_Ii_"@@@@"_Iii_",1@1@"_$P(%BS,"!",5)_"@@@@@·­± ~"_IIi_$J("",18-$L(IIi)-7+Ii-55)_".......;"_%3_";"_$P(^(%TAB),"@") Q
 ..S IIi=$E(%TAB,4,6)_":"_$E(%TAB,10,12)_":"_$P(%TAB,"]",2,99),%3=$S($P(@(%NAM_"(%TAB)"),"@",24)="S":"СписоК",$P(@$ZR,"@")["ГОТОВ":"СводкА",1:"      ")
 .Q:%TAB["."  S %3=$$TIP^%ZAPM.ed.BS($P(@(%NAM_"(%TAB)"),"@",17)),i=i+1,^%ZAPM.ed.BSbufB("Tt"_$G(%BS(3),$P)_$J_"u"_%BS(15),i,1)="@@1@"_Ii_"@@@@3,1@1@"_$P(%BS,"!",5)_"@@@@@·­± ~"_%TAB_$J("",18-$L(%TAB)-7+Ii-77)_".......;"_%3_";"_$P(^(%TAB),"@")
 K HIDD,IIi,Ii,Iii K:$D(^%ZAPM.ed.BSbufB("Tt"_$G(%BS(3),$P)_$J_"u"_%BS(15),"FTR",i)) @$ZR,^%ZAPM.ed.BSbufB("Tt"_$G(%BS(3),$P)_$J_"u"_%BS(15),i) S ^%ZAPM.ed.BSbufB("Tt"_$G(%BS(3),$P)_$J_"u"_%BS(15))="@@@@@@@1@1@22@80@@X MRMR@@@1@1@@@@@@@@1",se=i,ke=1
 D TAB^%ZAPM.ed.BSF1,^%ZAPM.ed.BST
TABE I $D(%BS(8)),$D(%VGI),$D(%BS(8,%VGI)) D UCI^%ZAPM.ed.BSH(%BS(8,%VGI),%VGI) G EXIT:'YES
 I $D(TABLfind) G TAB
 I R1=27!(ny=1) K ^%ZAPM.ed.BSbufB("Tt"_$G(%BS(3),$P)_$J_"u"_%BS(15)) G RAZD
 S %BsR=%NAM,(BST,%BsT)=$P($P(d,"~",2)," ")
 I %NAM="^%ZAPM.ed.BSbufS" S %BsT="^["""_$P(BST,":")_""":"""_$P(BST,":",2)_"""]"_$P(BST,":",3,99)
EX I $D(%BsR),$D(%BsT) S %File=%BsT_","_$P(%BsR,"^",2)_","_$P($$ZU^%ZAPM.ed.BS3(0),",")_","_$P($$ZU^%ZAPM.ed.BS3(0),",",2)
 K ^%ZAPM.ed.BSbufB("Tt"_$G(%BS(3),$P)_$J_"u"_%BS(15)),^%ZAPM.ed.BSbufB("Rt"_$G(%BS(3),$P)_$J_"u"_%BS(15)),^%ZAPM.ed.BSbufB("ftT"_$G(%BS(3),$P)_$J_"u"_%BS(15)) G EXIT
PRO I $ZE["<PROT" S $ZT="PRO^%ZAPM.ed.BS" G RAZPR
 S ls=$ZE D O^%ZAPM.ed.BSF7 G RAZPR
D G 0^%ZAPM.ed.BSTM
EXIT D QQQ^%ZAPM.ed.BSN("") Q
e Q
PPP(%NAM) I $P($G(@%NAM),"@")="BaSe MsW " Q "par"
 Q "·­±"
]]></Routine>


<Routine name="%ZAPM.ed.BSD1" type="MAC" languagemode="0"><![CDATA[
%BSD1 ;DDP идеология ; 11:11   29.04.99
 Q
O(%NAM) ;СЛЕДЮЩИЙ РАЗДЕЛ
 S %zT=$ZT,$ZT="OOER^%ZAPM.ed.BSD1" X $G(WA)
 I $ZV["Cach"||($ZV["IRIS") F  S %NAM=$$O^%ZAPM.ed.BSCp(%NAM) G:%NAM="" OQ I $P($G(@%NAM),"@")="BaSe MsW ",$P($G(@$ZR),"@",3)="",$$OU($P(%NAM,"^",2)) G OQ
 I '$D(%BS("Tmp",4)) F  S %NAM=$O(@%NAM) G:%NAM="" OQ S %NAM="^"_%NAM I $P($G(@%NAM),"@")="BaSe MsW ",$P($G(@$ZR),"@",3)="",$$OU($P(%NAM,"^",2)) G OQ
 I $D(%BS("Tmp",4)) F  S %NAM=$O(@%BS("Tmp",6)@(%NAM)) G:%NAM="" OQ I $$OOO(%NAM) G OQ
OQ Q %NAM
OQUIT Q ""
OOER S $ZT=$G(%zT) Q ""
OOO(%NAM) S %zT=$ZT,$ZT="OOER^%ZAPM.ed.BSD1"
 I $P($G(@%NAM),"@")="BaSe MsW ",$P($G(@$ZR),"@",3)="",$$OU($P(%NAM,$E(%BS("Tmp",5),2),+%BS("Tmp",5))) Q 1
 Q 0
OU(N) I %BS(12)'="",'$D(@%BS(18)@(%BS(37),"*")),'$D(@%BS(18)@(%BS(37),%BS("Tmp",1),"*")),'$D(@%BS(18)@(%BS(37),%BS("Tmp",1),%BS("Tmp",2),"*")),'$D(@%BS(18)@(%BS(37),%BS("Tmp",1),%BS("Tmp",2),N)) Q 0
 Q 1
OBD(%NAM) ;СЛЕДЮЩИЙ ИМЕННОЙ КЛЮЧ
 S %zT=$ZT,$ZT="OOER^%ZAPM.ed.BSD1" X $G(WA)
 I $ZV["Cach"||($ZV["IRIS") N GLL S GLL=$P(%NAM,"]",2,999) F  S GLL=$$O^%ZAPM.ed.BSCp(GLL) G:GLL="" OQUIT S %NAM="^"_GLL I %NAM[("^"_$P(BSD,"]",2)),$P($G(@%NAM),"@")="BSD - MSW" D OBDDP(%NAM)
 I '$D(%BS("Tmp",4)) F  S %NAM=$O(@%NAM) G:%NAM="" OQ S %NAM="^"_%NAM I %NAM[("^"_$P(BSD,$$ver^%ZAPM.ed.BSF9(2),2)),$P($G(@%NAM),"@")="BSD - MSW" D OBDDP(%NAM)
 I $D(%BS("Tmp",4)) F  S %NAM=$O(@($P(BSD,"]")_"]BSdirddp")@(%NAM)) G:%NAM="" OQ I %NAM[BSD,$P($G(@%NAM),"@")="BSD - MSW" D OBDDP(%NAM)
OBDQ Q %NAM
OBDDP(%NAm) S i=i+1,ii=$P(%NAm,$P(BSD,$$ver^%ZAPM.ed.BSF9(2),2),2)
 S ^%ZAPM.ed.BSbufB("0k"_$G(%BS(3),$P)_$J_"u"_%BS(15),i,1)=LineT_ii_"@@@@"_$P(@%NAm,"@",4),ii3=1
 Q
TAB(K,T) ;ТАБЛИЦА ИЗ ОПИСАНИЯ КЛЮЧЕЙ
 I '$$Data^%ZAPM.ed.BSF12(T) Q 0
 N Ui S @K=@T,$P(@K,"@",17)=1,$P(@K,"@",16)=1,@K@(1,1)=@T@(1,1)
 S @K@(2,1)=@T@(2,1),@K@(3,1)=$G(@T@(3,1),$G(@T@(2,1),@T@(1,1))),$P(@$ZR,"@",3)="",$P(@$ZR,"@",8)=0
 S LineT=$P(@T@(1,1),"@",1,15),$P(LineT,"@",15)=""
 S k14=$P(@K@(2,1),"@",14),$P(@K@(2,1),"@",14)=""
 I $D(@T@("FTR",3,1)) S @K@("FTR",3,1)=@T@("FTR",3,1),$P(LineT,"@",8)="3,1" I kd1 S @K@("FTR",3,1)=@K@("FTR",3,1)_" I $P(BS,""@"",19)'="""" S d1=d1_$$KeyTime^%ZAPM.ed.BSsFUNR(BS)"
 I $D(@T@("RTR",3,1)) S @K@("RTR",3,1)=@T@("RTR",3,1)
 N Ui I $P(@K,"@",12)'="" S $P(@K,"@",12)="X MRMR"
 I $D(@T@("AF2")) S @K@("AF2")=@T@("AF2")
 I $P(@K,"@",13)'="" S $P(@K,"@",13)=1
 I $P(@K,"@",15)'="" S $P(@K,"@",15)="%FKR^%ZAPM.ed.BST1"
 S $P(@$ZR,"@",25)=1,$P(@$ZR,"@",39)=$S(k20="":"^%ZAPM.ed.BSHLP(KEY_BD",1:k20)
 S Ui=$P($$IYI^%ZAPM.ed.BSF10(IMQ),"@",41) I Ui["TreeCopy^%ZAPM.ed.BSF10" Q 1
 S $P(@K,"@",41)="TreeCopy^%ZAPM.ed.BSF10"_$S(Ui'="":","_Ui,1:"") Q 1
KW K @$NA(@"^%ZAPM.ed.BSbufB"@("Video"_$G(%BS(3),$P)_$J_"u1",IMQ)) Q
SW(key) ;СОХРАНИТЬ ЭКРАН ДЛЯ КЛЮЧА
 d SaveWinV^%ZAPM.ed.BSXfun(1,1,25,80,$NA(@"^%ZAPM.ed.BSbufB"@("Video"_$G(%BS(3),$P)_$J_"u1",IMQ,key)),1) Q
LW(key) ;ВОССТАНОВИТЬ ЭКРАН ДЛЯ КЛЮЧА
 I $D(@$NA(@"^%ZAPM.ed.BSbufB"@("Video"_$G(%BS(3),$P)_$J_"u1",IMQ,key))) d LoadWinV^%ZAPM.ed.BSXfun($NA(@"^%ZAPM.ed.BSbufB"@("Video"_$G(%BS(3),$P)_$J_"u1",IMQ,key)),1)
 Q
DDPVOL ;ТОМА
 Q:'$D(@%BS(18)@(%BS(37),1))  N d1,d2,d3
 S d1=""
 F  S d1=$O(@%BS(18)@(%BS(37),1,d1)) Q:d1=""  D UCIDDP(d1)
 Q:'$D(d2)  S d1=""
 F  S d1=$O(d2(d1)) Q:d1=""  D SYS(d1) S d3="" F  S d3=$O(d2(d1,d3)) Q:d3=""  D UCI(d3)
 Q
UCIDDP(us) ;ПОИСК ^BSdirddp
 N bsd
 Q:$$ZU^%ZAPM.ed.BS3($P(us,","),$P(us,",",2))
 S %zT=$ZT,$ZT="ER1^%ZAPM.ed.BSD1"
 S bsd=$$DDPGLO(us) I '$D(@bsd) G UCIQ
 S d2($P(us,",",2),$P(us,","))=bsd
UCIQ S $ZT=$G(%zT) Q
DDPGLO(us) Q $$DDPGL(us)_"BSdirddp"
DDPGL(us) Q "^["""_$P(us,",")_""","""_$P(us,",",2)_"""]"
SYS(I) N B ;ТОМ
 S j=j+1,^%ZAPM.ed.BSbufB("fT"_$G(%BS(3),$P)_$J_"u"_%BS(15),1,j)="@@1@9@@@@2,1@1@"_$P(%BS,"!",4)_"@@@@@"_I
 S i=2,B="???" I $O(d2(d1,""))'="" S B=d2(d1,$O(d2(d1,""))),B=$P($P($G(@B),"@",2),",",2)
 S ^%ZAPM.ed.BSbufB("fT"_$G(%BS(3),$P)_$J_"u"_%BS(15),2,j)="@@1@9@@@@@1@@@@@@ ddp-"_B
 Q
UCI(J) ;КИП
 S i=i+1,^%ZAPM.ed.BSbufB("fT"_$G(%BS(3),$P)_$J_"u"_%BS(15),i,j)="@@1@9@@@@2,1@1@"_$P(%BS,"!",5)_"@@@@@"_d3
 S:se<i se=i S:ke<j ke=j
 Q
ER1 G UCIQ
NEWDIR ;НОВЫЙ DDP КАТАЛОГ
 N PRO,%NAM,WA,COMD I '$$RP^%ZAPM.ed.BSGCH("^BSdirddp") Q  ;МЫ В RVG
 Q:'$G(%BS(23))  D L^%ZAPM.ed.BS3("^BSdirddp")
 S COMD=$P($G(^BSdirddp,"..."),"@") K ^BSdirddp
 S %NAM="^",^BSdirddp=COMD_"@"_$$ZU^%ZAPM.ed.BS3(1,0) D Wait^%ZAPM.ed.BSXfun("Создаю DDP каталог")
 F  S %NAM=$O(@%NAM) Q:%NAM=""  S %NAM="^"_%NAM X $G(WA) D NEWDI
 D CP^%ZAPM.ed.BSGCH("^BSdirddp","4334")
NEWQ S $ZT=$G(%zt) D U^%ZAPM.ed.BS3("^BSdirddp") Q
NEWDI S %zt=$ZT,$ZT="ER2^%ZAPM.ed.BSD1"
 S PRO=$$RP^%ZAPM.ed.BSGCH(%NAM) I +PRO>1,$E(PRO,2)>1 S ^BSdirddp($$DDPGL($$ZU^%ZAPM.ed.BS3(0))_$P(%NAM,"^",2))=""
NEWDQ Q
ER2 G NEWQ
PST(P) N uc,Pddp
 I P["%BSbufB" S %w(6,1)="%BSbufB",%w(6,2)=$P($$ZU^%ZAPM.ed.BS3(1,0),","),%w(6,3)=$P($$ZU^%ZAPM.ed.BS3(1,0),",",2) Q
 D PS(P) S %w(6,1)=Pddp,%w(6,2)=%BS("Tmp",2),%w(6,3)=%BS("Tmp",1) Q
PS(P) ;РАСЩЕПЛЕНИЕ ССЫЛОК
 I P'[$$ver^%ZAPM.ed.BSF9(2) S %BS("Tmp",1)=$P($$ZU^%ZAPM.ed.BS3(0),",",2),(uc,%BS("Tmp",2))=$P($$ZU^%ZAPM.ed.BS3(0),","),Pddp=$P(P,"^",2) G PSQ
 ;4.;I P["|" D  G PSQ
 .I $P(P,"|",2)["," S %BS("Tmp",1)=$P(P,$C(34),4),(uc,%BS("Tmp",2))=$P(P,$C(34),2),Pddp=$P(P,"|",3) Q
 .E  S (uc,%BS("Tmp",2))=$P(P,$C(34),2),Pddp=$P(P,"|",3),%BS("Tmp",1)=$P($$ZU^%ZAPM.ed.BS3(0),",",2) Q
 I $P(P,"]")["," S %BS("Tmp",1)=$P(P,$C(34),4),(uc,%BS("Tmp",2))=$P(P,$C(34),2),Pddp=$P(P,"]",2)
 E  S (uc,%BS("Tmp",2))=$P(P,$C(34),2),Pddp=$P(P,"]",2),%BS("Tmp",1)=$P($$ZU^%ZAPM.ed.BS3(0),",",2)
PSQ I '$$ZU^%ZAPM.ed.BS3(%BS("Tmp",2),%BS("Tmp",1)) S %BS("Tmp",2)=%BS("Tmp",2)_","_%BS("Tmp",1),%BS("Tmp",1)=1
 Q
GDE(us) ;us="[""UCI"",""SYS""]"
 N UC,SY,d2
 S us=$TR(us,"[]""|",""),UC=$P(us,","),SY=$P(us,",",2)
 Q:$$ZU^%ZAPM.ed.BS3(UC,SY) $$ZU^%ZAPM.ed.BS3(UC,SY) ;СМОНТИРОВАН us
 D UCIDDP(us) I $D(d2) Q "DDP"
 Q ""
]]></Routine>


<Routine name="%ZAPM.ed.BSD2" type="MAC" languagemode="0"><![CDATA[
%BSD2 ; СТОППОР %BS  ; 10:18   15.02.2000
 Q
S D M,BUY S (%BSssdO,AUTO)=2 G SSD ;ОСТАНОВ БЕЗУСЛОВНЫЙ
SS D M,BUY S (%BSssdO,AUTO)=1 G SSD ;ОСТАНОВ ЕСЛИ НЕТ АКТИВНЫХ ЛИНИЙ DDP
M G MGR^%ZAPM.ed.BS
SSD I $ZV["Wind"!($ZV["Cach"||($ZV["IRIS")) Q
 D M N YYY
 S YYY=$P($P($G(^%ZAPM.ed.BSETUP("SERVER",6,4)),"@",15),"\",4) I YYY'="N" D CLEAR
 I $D(%BS)["0" D LV^%ZAPM.ed.BSF4 ;ОСТАНОВ СО ВСЕМИ ОСТАНОВКАМИ
 I $G(^%ZAPM.ed.BSS("XECUTE","KEY"))'="" D XEC^%ZAPM.ed.BSF10($$KBD^%ZAPM.ed.BSF12("^%ZAPM.ed.BSS(""XECUTE"")"),9)
 D Int^%ZAPM.ed.BSERV("D KILLS^%ZAPM.ed.BSERVER(G,S)") G:$G(%BSssdO)=2 SSSD
 U 0::%BS(32) D CHECK W $$atr^%ZAPM.ed.BS3(0) I YES<1 S Tmp="" Q
 D OP^%ZAPM.ed.BSF4 D CHEKPRN^%ZAPM.ed.BSJPRN I YES<1 S Tmp="" Q
SSSD D ERASER^%ZAPM.ed.BSJPRN(1),ALLKILLB^%ZAPM.ed.BS1
 I $$4() D CONTINUE^SSD
 G ^SSD
BUY W !!!!!!!!!!!!,"До Свидания.. ",$G(%BS(38)) Q
4() Q $P($ZV,"Version ",2)'<4
CHECK 
 N CIR,CIRNAME,CIRSTA,EADR,I,ID,J,LCB,LNK,LNKSTA,PROTN,RTYTM,SV,UPDATE,VG,X
 D VERIFDDP
 S YES=1 I $G(VG)="" Q
 D CHECKDDP("ALL") Q
CHECKDDP(V) ;V-НОМЕР ГРУППЫ ТОМОВ
 Q:'%BS(23)  D EnterP^%ZAPM.ed.BSF8("^%ZAPM.ed.BSS(""SSD"",""BUT"")") S YES=$S(d=1&(R1=13):1,1:0)
 I YES,$E(%BS(1),6)=1 S YES=0 D EnterP^%ZAPM.ed.BSF8("^%ZAPM.ed.BSS(""MSM-SERVER"",""BUT"")") S YES=$S(d=1&(R1=13):1,1:0) I YES D PASCHECK^%ZAPM.ed.BS1("^%ZAPM.ed.BSETUP","SETUP",2,"Введите пароль Администратора Системы","Tmp") I YES W # Q
 Q
PA D DosRead^%ZAPM.ed.BSS1(51,$$AddFile^%ZAPM.ed.BSDOS2($$DIR^%ZAPM.ed.BSMSMF_"%BS-FULL.XXX")) Q:'$D(%FN)
 X "U %DEV R R X R H  "
 Q
VERIFDDP ;ПРОВЕРКА АКТИВНОСТИ DDP
 W #,$$clr^%ZAPM.ed.BS3(10)
 I $$4() N (VG) S ID=2,UPDATE=1 D CIRSTA^DDPCIR Q
 N (VG) S UPDATE=1,ID=1,SV=33566904 D CIRSTA^DDPCIR
 Q
CLEAR ;ЗАЧИСТКА ДО DKFUL
 I $ZV["Cach"||($ZV["IRIS") Q
 G CLE:YYY="A" I "Y"[YYY D Yes^%ZAPM.ed.BSXfun("Будем затирать мусор на томе "_$P($$ZU^%ZAPM.ed.BS3(0),",",2)_" ?",2) I YES>0 G CLE
 Q
CLE N zS,zJ,zM
 I $ZV["Cach"||($ZV["IRIS") Q
 S $ZT="END^%ZAPM.ed.BSD2",zM="^cccccccc" W !,"WipeInfo in "_$P($$ZU^%ZAPM.ed.BS3(0),",",2)
 S zS=$TR($J("",$$LNG^%ZAPM.ed.BSF12)," ","c") F zJ=1:1 S @zM@(zJ)=zS I '(zJ#100) W "."
 Q
END K @zM
 Q
]]></Routine>


<Routine name="%ZAPM.ed.BSDIR" type="MAC" languagemode="0"><![CDATA[
%BSDIR ;КАТАЛОГИЗАТОР ; 13:37 18-DEC-98
D(ot,do,fi,co,fo,r,t,com,new,cmdl,Fk,comnew,PrEd) ;d-cквозная локаль
 ;new=1 СТРОКА НОВОГО ОБ'ЕКТА ОБЯЗАТЕЛЬНА
 ;new=2 СТРОКА НОВОГО ОБ'ЕКТА ТОЛЬКО ПРИ ОТСУТСТВИИ ОБ'ЕКТОВ
 ;new="" СТРОКА НОВОГО ОБ'ЕКТА НЕ НУЖНА
 ;cmdl КОМАНДА СПЕЦ-ПОДСКАЗКИ
 ;PrEd - ПРОГРАММА ПРЕДОБРАБОТКИ
 S d=ot,v=1,l1=78,ke=1,BSr=r,BSt=t,cl=$P(%BS,"!",4),t1=" .. "_com_" в "_$$ZU^%ZAPM.ed.BS3(0) D CR^%ZAPM.ed.BSN
 I $G(new)=1 D NEWLINE
 K LINEDIR S ls=com D WAITS^%ZAPM.ed.BSF2
 S cl=$P(%BS,"!",5) F  X co Q:do[d  X WA I @fi X fo D CR^%ZAPM.ed.BSN S LINEDIR=1
 I $G(new)=2,'$D(LINEDIR) D NEWLINE
 D CREAT^%ZAPM.ed.BSN I $G(cmdl)'="" S $P(@(BSR_"(BST)"),"@",13)=cmdl
e Q
NEWLINE S cl=$P(%BS,"!",5),t1=" ..  "_comnew D CR^%ZAPM.ed.BSN Q
 
]]></Routine>


<Routine name="%ZAPM.ed.BSDOS" type="MAC" languagemode="0"><![CDATA[
%BSDOS ;ДОС-ИНТЕРФЕЙС ; 15:29   15.04.2003
 D 0 G D
0 I %BS(12)'="" G PROT^%ZAPM.ed.BSMSM:'$$SizeFile^%ZAPM.ed.BSDOS2(1)
 S OO=31,OOO="^%ZAPM.ed.BS" K %JB D 24^%ZAPM.ed.BSTM,^%ZAPM.ed.BSB,ZA^%ZAPM.ed.BSF Q:R1=27  I %B=3 S ls=$$ZOS4() D O^%ZAPM.ed.BSF7 W $$r^%ZAPM.ed.BS3 G 0
 I %B=2 D DRV D:$D(%DRV) DSPACE G 0
 I %B=1 D DOS
 G 0
D D TIT^%ZAPM.ed.BST,W^%ZAPM.ed.BST Q
EXE(EXE,O,S) ;ВЫЗОВ НА ВЫПОЛНЕНИЕ ДОС-ПРОЦЕССА
 I $ZV["Cach"||($ZV["IRIS") D EXE^%ZAPM.ed.BSCEXE(EXE) Q
 I $P($ZV,"Version ",2)<4 Q
 I '$G(O),$V($V(44)+392) Q:$G(S)=""  D ErrMsg^%ZAPM.ed.BSXfun(S) Q
 I $E(%BS(1),6) W $$bel^%ZAPM.ed.BS3 Q  ;```D ErrMsg^%ZAPM.ed.BSXfun("Для М-Сервера запрещено ! "_$G(S)) Q
 S EXE=$$JOB^%HOSTCMD(EXE)
 Q
ZOS1(D) ;Set Current Drive
 I $ZV["MSM" Q $ZOS(1,D)
 Q $$SCDrive^%ZAPM.ed.BSCEXE(D)
ZOS2(D) ;Delete a File
 I $ZV["MSM" Q $ZOS(2,D)
 I $$DelFile^%ZAPM.ed.BSCEXE(D) Q ""
 Q 1
ZOS3(S,D) ;Rename a File
 I $ZV["MSM" Q $ZOS(3,S,D)
 Q $$RenFile^%ZAPM.ed.BSCEXE(S,D)
ZOS4() ;Get MS-DOS Version Number
 I $ZV["MSM" Q "MS-DOS "_$ZOS(4)
 Q $$Ver^%ZAPM.ed.BSCEXE()
ZOS5(F) ;Set File Attributes
 I $ZV["MSM" Q $ZOS(5,F)
 Q $$AtrFile^%ZAPM.ed.BSCEXE(F)
ZOS6(D) ;Create a New Directory
 I $ZV["MSM" Q $ZOS(6,D)
 Q $$CNDir^%ZAPM.ed.BSCEXE(D)
ZOS7(D) ;Remove an Existing Directory
 I $ZV["MSM" Q $ZOS(7,D)
 Q $$DelDir^%ZAPM.ed.BSCEXE(D)
ZOS8(D) ;Change Current Directory
 I $ZV["MSM" Q $ZOS(8,D)
 Q $$CCDir^%ZAPM.ed.BSCEXE(D)
ZOS9(D) ;Get Drive Parameters
 I $ZV["MSM" Q $ZOS(9,D)
 Q $$GetDPar^%ZAPM.ed.BSCEXE(D)
ZOS10(D) ;Get File Attributes
 I $ZV["MSM" Q $ZOS(10,D)
 Q $$ExsFile^%ZAPM.ed.BSCEXE(D)
ZOS11(D) ;Get Current Directory for Drive
 I $ZV["MSM" Q $ZOS(11,D)
 Q $$GCDir^%ZAPM.ed.BSCEXE(D)
ZOS12(D,V) ;Begin Directory Search
 I $ZV["MSM" Q $ZOS(12,D,V)
 Q $$BegDir^%ZAPM.ed.BSCEXE(D,V)
ZOS13(D) ;Continue Directory Search
 I $ZV["MSM" Q $ZOS(13,D)
 Q $$ContDir^%ZAPM.ed.BSCEXE(D)
ZOS14() ;Get Current Drive
 I $ZV["MSM" Q $ZOS(14)
 Q $$CurDisk^%ZAPM.ed.BSCEXE()
BaseDir() ;БАЗОВАЯ ДИРЕКТОИЯ
 N D S D=$P($G(^%ZAPM.ed.BSETUP("PATH",12,4)),"@",15)
 Q D
CurDisk() ;ТЕКУЩИЙ ДИСК
 N D S D=$P($P($G(^%ZAPM.ed.BSETUP("PATH",12,4)),"@",15),":")
 I $ZV["MSM" Q $S(D'="":D,1:$ZOS(14))
 Q $S(D'="":D,1:$$CurDisk^%ZAPM.ed.BSCEXE()) ;Cach
CurDir(Disk) ;ТЕКУЩАЯ ПОДДИРЕКТОРИЯ
 N D S D=$P($P($G(^%ZAPM.ed.BSETUP("PATH",12,4)),"@",15),":",2,999)
 I $ZV["MSM" Q $S(D'="":D,1:$ZOS(11,Disk))
 Q $S(D'="":D,1:$$GCDir^%ZAPM.ed.BSCEXE(Disk)) ;Cach
DRV N %B K M,DR S M=" A: B: ",i="CDEFGHIJKLMNOPQRSTUVWXYZ",T=$$ZOS14() F ii=1:1:$L(i) S %ER=$$ZOS1($E(i,ii)) I %ER>0 S %ER=$$ZOS11($E(i,ii)) I '(%ER<0) S M=M_$E(i,ii)_": "
 I $D(%BS)["0" D CLr^%ZAPM.ed.BSF4
 S M(1,1)=M_"@6@ @0",OO=1,OOO="M",%B=$L($P(M,T)," ")-1,%ER=$$ZOS1(T) D 24^%ZAPM.ed.BSTM,^%ZAPM.ed.BSB,ZA^%ZAPM.ed.BSF G DR:R1=27 S %DRV=$P($P(M," ",%B+1),":")
 K M,EXITout Q
DR W $$bel^%ZAPM.ed.BS3 K %DRV,EXITout Q
DSPACE D SPACE^%ZAPM.ed.BSERV
e Q
DOS I $ZV["Cach"||($ZV["IRIS") D DirDDR^%ZAPM.ed.BSCmDDR Q  ;```
 D DRV G:'$D(%DRV) DIREXIT
 D SI^%ZAPM.ed.BSN N (%BS,vl,%zT,%KAT,%File,%DRV) D SI^%ZAPM.ed.BSN,SA^%ZAPM.ed.BSsBUF,DIR,RE^%ZAPM.ed.BSsBUF Q
DIR ;ДИРЕКТОРИЯ
 S %D=%DRV,%ER=$$ZOS11(%D),%D=$S(%ER<0:"^",1:%D_":"_%ER_$S(%ER="\":"",1:"\")_"*.*")
 S BL="ABCDEFGHIJKLMNOPQRSTUVWXYZАБВГДЕЁЖЗИЙКЛМНОПРСТУФХЦЧЬЪШЩЭЮЯ"
 S LL="abcdefghijklmnopqrstuvwxyzабвгдеежзийклмнопpстуфхцчьъшщэюя"
DIRNEW S ls="Сканиpование "_%D D WAITS^%ZAPM.ed.BSF2
 S %X=%D,%A=$L(%X,"\"),%B=$P(%X,"\",%A) I %B'="",%B'["*",%B'["." I $ZB(+$$ZOS10(%X),16,1) S %X=%X_"\*.*"
 I $E(%X,$L(%X))=":"!($E(%X,$L(%X))="\") S %X=%X_"*.*"
 S %ER=$$ZOS12(%X,32+16+4+1) I %ER<0 D ^%ZAPM.ed.BSDOS1 G DIREXIT
 S MRMR="W /CUP(23,1),/EL(0),$$clr^%ZAPM.ed.BS3(4),"" <Enter>-ВХОД <F3>-СМОТР.<F4>-РЕДАКТ <F6>-AKT <F8>-УДАЛИТЬ <F10>-ВЫБОР И ВЫХОД """
DIRO S BSR="^%ZAPM.ed.BSbufB",BST=%X_$G(%BS(3),$P)_$J_"u"_%BS(15) I $D(@(BSR_"(BST,""STA"")")) D STA^%ZAPM.ed.BST G DIRE
 S i=1,(kod,kof,kb)=0,STR="@@1@55@@@@1,1@1@"_$P(%BS,"!",5)_"@@@@@",%Y=%ER,^%ZAPM.ed.BSbufB(BST,"FTR",1,1)="I d'["" <DIR> "" S d1=$TR(d,BL,LL)"
DI S %I=$P(%Y,"^"),%J=$P(%Y,"^",2,999)
 S %K=$A(%J,22)
 I $ZB(%K,16,1) G:$E(%I)="." DIREC S ST=" "_$P(%I,".")_$J("",8-$L($P(%I,".")))_$S(%I[".":".",1:" ")_$J($P(%I,".",2),3)_" <DIR> ",kod=kod+1
 E  S %A=$A(%J,27),%B=$A(%J,28),%C=$A(%J,29),%D=$A(%J,30) S ST=" "_$P(%I,".")_$J("",8-$L($P(%I,".")))_$S(%I[".":".",1:" ")_$J($P(%I,".",2),3)_" "_$J("-"_(%A+(%B*256)+(%C*256*256)+(%D*256*256*256))_"-",11) D  ;
 .S kof=kof+1,kb=kb+(%A+(%B*256)+(%C*256*256)+(%D*256*256*256))
 S ST=ST_$J("",23-$L(ST)) S %A=$A(%J,25),%B=$A(%J,26),%C=256*%B+%A,%D=%C#32,%C=%C\32,%E=%C#16,%C=%C\16,%C=%C+1980
 S ST=ST_"  "_$E("  ",1,2-$L(%E))_%E_"-"_$E("00",1,2-$L(%D))_%D_"-"_%C_"  " ;ДАТА
 S %A=$A(%J,23),%B=$A(%J,24),%C=%B*256+%A,%D=%C#32*2,%C=%C\32,%E=%C#64,%C=%C\64,%A=%C\12,%B=%C#12 S:%B=0 %B=12
 S ST=ST_$E("  ",1,2-$L(%B))_%B_":"_$E("00",1,2-$L(%E))_%E_$S(%A:"p",1:"a") ;ВРЕМЯ
 S i=i+1,^%ZAPM.ed.BSbufB(BST,i,1)=STR_ST
DIREC S %Y=$$ZOS13(%Y) G:%Y'<0&($P(%Y,"^")'="") DI S ^%ZAPM.ed.BSbufB(BST,1,1)="@@1@55@@@@@1@"_$P(%BS,"!",4)_"@@@@@ .. "_$P(%X,"*")_"  "_$FN(kb,",")_" bytes  files-"_kof_" dir-"_kod
 S ^%ZAPM.ed.BSbufB(BST)="@@@@@@@1@1@22@80@@X MRMR@@%FK^%ZAPM.ed.BSDOS2@1@1@@@@@@@@1@@@@@@@@@@@@@@@@DelF8^%ZAPM.ed.BSDOS",se=i,ke=1,$P(@$ZR,"@",36)="2,1" D TAB^%ZAPM.ed.BSF1,^%ZAPM.ed.BST
DIRE I $D(EXITout) G DIREXIT
 D Kdf^%ZAPM.ed.BSDOS2
 I R1=27!(ny=1) D Kdf^%ZAPM.ed.BSDOS2 K @(BSR_"(BST)") S R1=27,%D=$P(%X,"\",1,$L(%X,"\")-2)_"\" D DIF G DIRD:%D="\",DIRNEW
 I d[" <DIR> " D Kdf^%ZAPM.ed.BSDOS2 S %D=$P(%X,"*")_$TR($E(d,2,13)," ","")_"\" D DIF G DIRO:%D["\\",DIRNEW
 D DIF I %File[".%BS" D VIEW^%ZAPM.ed.BSDOS2("View*.*") G DIRO ;???ЗАЧЕМ Я НЕ ПОМНЮ
 I R1=13 S EXITout=1,R1=13 D DIA,DIF,GLKL^%ZAPM.ed.BSDOS2 G DIREXIT
 G DIRO
DIRD D DRV G:$G(R1)=27 DIREXIT I '$D(%DRV) G DIRD
 G DIR
DIA N FF,F Q:'$P(@BSR@(BST),"@",3)  F FF=1:1 Q:'$D(@BSR@(BST,FF))  I $D(@BSR@(BST,FF,1)),$P(@BSR@(BST,FF,1),"@",12),$P(@BSR@(BST,FF,1),"@",15)'[" <DIR>" S F=$$FULLNAME($P(@BSR@(BST,FF,1),"@",15)) I F'="" S %BS("Tmp","DosFiles",F)=$P($P(@BSR@(BST,FF,1),"@",15),"-",2)
 Q
DelF8 I $E(%BS(1),17),R1=127 S R1=27,R2=79,R3=87 Q
 Q
DIREXIT K kod,kof,kb Q
DIF S %File=$$FULLNAME(d) Q
FULLNAME(d) Q $P(%X,"*")_$S($E(d,2,3)'="..":$TR($E(d,2,13)," ",""),1:"")
FILE(%X,M) ;M=1 - РАЗМЕР ФАЙЛА
         ;M=2 - ДАТА
         ;M=3 - ВРЕМЯ
 I $ZV["Cach"||($ZV["IRIS") Q $$FileAtr^%ZAPM.ed.BSCEXE(%X,M)
 N %ER,%J,%I,%A,%B,%C,%D,%Y,%K
 S %ER=$$ZOS12(%X,32+16+4+1) I %ER<0 Q ""
 S %Y=%ER,%I=$P(%Y,"^"),%J=$P(%Y,"^",2,999),%K=$A(%J,22)
 I $ZB(%K,16,1) Q:$E(%I)="." ""  I M=1 Q "<DIR>"
 E  S %A=$A(%J,27),%B=$A(%J,28),%C=$A(%J,29),%D=$A(%J,30) I M=1 Q (%A+(%B*256)+(%C*256*256)+(%D*256*256*256))
 S %A=$A(%J,25),%B=$A(%J,26),%C=256*%B+%A,%D=%C#32,%C=%C\32,%E=%C#16,%C=%C\16,%C=%C+1980
 I M=2 Q %E_"-"_$E("00",1,2-$L(%D))_%D_"-"_%C
 S %A=$A(%J,23),%B=$A(%J,24),%C=%B*256+%A,%D=%C#32*2,%C=%C\32,%E=%C#64,%C=%C\64,%A=%C\12,%B=%C#12 S:%B=0 %B=12
 Q %B_":"_$E("00",1,2-$L(%E))_%E_$S(%A:"p",1:"a") ;ВРЕМЯ
]]></Routine>


<Routine name="%ZAPM.ed.BSDOS1" type="MAC" languagemode="0"><![CDATA[
%BSDOS1 ;ФОРМИРОВАНИЕ ОШИБОК DOSа
 ;MICRONETICS DESIGN CORP. (C) 1986
 S %ER=+$G(%ER,0),T=$T(@($S(%ER>-1:%ER,1:-%ER))) S ls="DOS ОШИБКА - "_$S(T'="":$P(T,";",2,999),1:"НЕЗНАКОМЫЙ ТИП ОШИБКИ:"_%ER)_" " D O^%ZAPM.ed.BSF7
e Q
1 ;НЕДОПУСТИМЫ НОМЕР ФУНКЦИИ
2 ;ФАЙЛ НЕ НАЙДЕН
3 ;ПУТЬ НЕ НАЙДЕН
4 ;СЛИШКОМ МНОГО ФАЙЛОВ ОТКРЫТО
5 ;В ДОСТУПЕ ОТКАЗАНО
6 ;ВРУЧНУЮ НЕДОПУСТИМО
7 ;БЛОКИ УПРАВЛЕНИЯ ПАМЯТИ РАЗРУШЕНЫ
8 ;НЕДОСТАТОЧНО ПАМЯТИ
9 ;АДРЕС БЛОКА ПАМЯТИ НЕВЕРЕН
10 ;НЕДОПУСТИМАЯ ОПЕРАЦИОННАЯ СРЕДА
11 ;НЕДОПУСТИМЫЙ ФОРМАТ
12 ;НЕДОПУСТИМЫЙ КОД ДОСТУПА
13 ;ОШИБКА ДАННЫХ
15 ;ОШИБКА ДИСКОВОДА
16 ;ПОПЫТКА ПЕРЕНОСА ТЕКУЩЕЙ ДИРЕКТОРИИ
17 ;НЕ ПОДХОДЯЩЕГО УСТРОЙСТВА
18 ;НЕТ БОЛЬШЕ ФАЙЛОВ
19 ;ЗАПИСЬ НА ДИСК ЗАЩИЩЕНА
20 ;НЕИЗВЕСТНЫЙ ЭЛЕМЕНТ
21 ;ДИСКОВОД НЕ ГОТОВ
22 ;НЕЗНАКОМАЯ КОМАНДА
23 ;ОШИБКА ДАННЫХ (CRC)
24 ;НЕПРАВИЛЬНЫЙ ЗАПРОС СТРУКТУРНОЙ ДЛИНЫ
25 ;ОШИБКА УСТАНОВКИ ГОЛОВОК
26 ;НЕИЗВЕСТНЫЙ ТИП НОСИТЕЛЯ
27 ;СЕКТОР НЕ НАЙДЕН
28 ;ПРИНТЕР БЕЗ БУМАГИ
29 ;ОШИБКА ЗАПИСИ
30 ;ОШИБКА ЧТЕНИЯ
31 ;ОБЩИЙ ПРОВАЛ
32 ;ЧАСТИЧНОЕ РАЗРУШЕНИЕ
33 ;БЛОКИРОВКА РАЗРУШЕНИЯ
34 ;СМЕНА ДИСКА ОШИБОЧНА
35 ;FCB НЕГОДНО
80 ;ФАЙЛ УЖЕ СУЩЕСТВУЕТ
82 ;НЕ МОЖЕМ СОЗДАТЬ ДИРЕКТОРИЮ
83 ;fail on int 24H (critical error interupt)
256 ;ОШИБКА ЗАЩИТЫ ЗАПИСИ
257 ;НЕЗНАКОМЫЙ МОДУЛЬ
258 ;ДИСКОВОД НЕ ГОТОВ
259 ;НЕЗНАКОМАЯ КОМАНДА
260 ;ОШИБКА ДАННЫХ (bad CRC)
261 ;ПЛОХОЙ ЗАПРОС СТРУКТУРНОЙ ДЛИНЫ
262 ;ОШИБКА УСТАНОВКИ ГОЛОВОК
263 ;НЕЗНАКОМЫЙ ТИП НОСИТЕЛЯ
264 ;СЕКТОР НЕ НАЙДЕН
265 ;ПРИНТЕР БЕЗ БУМАГИ
266 ;ОШИБКА ЗАПИСИ
267 ;ОШИБКА ЧТЕНИЯ
268 ;ОБЩИЙ ПРОВАЛ
]]></Routine>


<Routine name="%ZAPM.ed.BSDOS2" type="MAC" languagemode="0"><![CDATA[
%BSDOS2 ;ФУНКЦИАНАЛЬНЫЕ КЛАВИШИ DOS-ИНТЕРФЕЙСА ; 13:22   16.05.2000
%FK I R3=89 S EXITout=1,R1=13 D DIA^%ZAPM.ed.BSDOS,DIF^%ZAPM.ed.BSDOS,GLKL Q
 I R3=82,d'[" <DIR> " D DIF^%ZAPM.ed.BSDOS,VIEW("View*.*") G D
 I R3=87 D DIA^%ZAPM.ed.BSDOS,DIF^%ZAPM.ed.BSDOS,DEL S R1=27 Q  ;УДАЛЕНИЕ
 I R3=85,d'[" <DIR> " D DIA^%ZAPM.ed.BSDOS,DIF^%ZAPM.ed.BSDOS,ACTF6,W^%ZAPM.ed.BST G B^%ZAPM.ed.BSTM ;ГРУППОВЫЕ РАБОТЫ
 I R3=83,d'[" <DIR> " D DIF^%ZAPM.ed.BSDOS,VIEW("Edit*.*"),OVER G D
 G D
D G 0^%ZAPM.ed.BSTM
ACT6(SIZE,FILE,CMD) ;ДЕЙСТВИЯ НАД ФАЙЛОМ
 D Wait^%ZAPM.ed.BSXfun(FILE) X CMD
 Q
ACTF6 ;ГРУППОВЫЕ ДЕЙСТВИЯ НАД ФАЙЛАМИ
 N CMD,UZ,X,XX I '$$SizeFile(3) D ErrMsg^%ZAPM.ed.BSXfun("Эта команда для вас запрещена %BS-Системными установками") Q
 S UZ=$$UZEL^%ZAPM.ed.BSVOL("ACTFILE","%BSVOL","","","ВЫБЕРИТЕ УЗЕЛ ДЛЯ ДЕЙСТВИЙ С ФАЙЛАМИ") Q:UZ=""
 S CMD=@UZ@("NSP")
 S %zT=$ZT,$ZT="ACTER^%ZAPM.ed.BSDOS2"
 I $D(%DIA) S X="" D  G ACTF
 .F  S X=$O(%BS("Tmp","DosFiles",X)) Q:X=""  S XX=%BS("Tmp","DosFiles",X) I XX'="" D ACT6(XX,X,CMD)
 I '$D(%DIA) S X=$P(d,"-",2) I X'="" D ACT6(X,%File,CMD)
ACTF D OkMsg^%ZAPM.ed.BSXfun("Групповая Операция Закончена Успешно")
 G Kdf
ACTER D ErrMsg^%ZAPM.ed.BSXfun($ZE_" "_$$ErrSay^%ZAPM.ed.BSF8($ZE)) S $ZT=$G(%zT) Q
DEL ;УДАЛЕНИЕ
 N X,XX I '$$SizeFile(3) D ErrDe Q
 I $D(%DIA) S X="" Q:$$YYY("Помеченные файлы")<1  D  G Kdf
 .F  S X=$O(%BS("Tmp","DosFiles",X)) Q:X=""  S XX=$$ZOS(%BS("Tmp","DosFiles",X),X) I XX'="" D ErrDel(XX,X)
 I '$D(%DIA) Q:$$YYY(" файл "_%File)<1  S X=$$ZOS($P(d,"-",2),%File) I X'="" D ErrDel(X,%File)
Kdf K %BS("Tmp","DosFiles")
 Q
YYY(S) D Yes^%ZAPM.ed.BSXfun("Киляем "_S_", Вы уверены ?") Q YES
ZOS(K,N) ;удаление файла
 Q:($$SizeFile(3)<K) -1
 I $ZV["Cach"||($ZV["IRIS") Q $$DelFile^%ZAPM.ed.BSCEXE(N)
 Q $ZOS(2,N)
 
AccesMSM(P) I $D(%BS)["0" D CLr^%ZAPM.ed.BSF4
 if $g(%BS(37))="" quit 1
 I %BS(12)'="",$D(@%BS(18)@(%BS(37),0,"3,4")) Q ($P($G(@%BS(18)@(%BS(37),0,"3,4")),"/",P)="Y")
 Q $P($G(%BS(34)),"/",P)="Y"
 
SizeFile(P) I %BS(12)'="",$D(@%BS(18)@(%BS(37),0,"5,4")) Q ($P($G(@%BS(18)@(%BS(37),0,"5,4")),"/",P)*1024)
 Q $P($G(%BS(33)),"/",P)*1024
 
ErrDel(XX,X) I XX'=-1 D ErrMsg^%ZAPM.ed.BSXfun($S(XX=-2:"Не найден",XX=-3:"Не найден путь к",XX=-5:"Отказано в доступе к",1:"")_" "_X) Q
ErrDe D ErrMsg^%ZAPM.ed.BSXfun("Удаление "_X_" для вас запрещено %BS-Системными установками") Q
OVER ;ПЕРЕЗАПИСЬ ФАЙЛА
 N U,X,S,%FN,%DEV,ls
 S ls="Учтите,если в файле были управляющие символы, то они пропадут. Перезаписываем ?" D YES^%ZAPM.ed.BSF I 'YES Q
 D DosOpn^%ZAPM.ed.BSBL1(51,%File) Q:'$D(%FN)  S U=$NA(@BSr@(BSt)),X="I g'=Head U %DEV W @g,! U 0"
 D XGlob^%ZAPM.ed.BSF9(U,X,1) C %DEV Q
VIEW(V) S BSr="^%ZAPM.ed.BSbufB",BSt=V_$G(%BS(3),$P)_$J_"u"_%BS(15) Q:'$$View(%File,BSr,BSt)  I V["Edit*" d ^%ZAPM.ed.BSX("EDIT",BSr,BSt) Q
 S IYI=BSr_","_BSt D NE^%ZAPM.ed.BSN Q
GLKL S II="" F  S II=$O(^%ZAPM.ed.BSbufB(II)) Q:II=""  I $P($P(II,"*.*",2),"u")=$I K ^%ZAPM.ed.BSbufB(II)
e Q
AddFile(%File) ;I %File'[":\" S %File=$$CurDisk^%ZAPM.ed.BSDOS()_":"_$$CurDir^%ZAPM.ed.BSDOS($$CurDisk^%ZAPM.ed.BSDOS())_$S($E(%File,1)="\":"",1:"\")_%File Q %File
 Q %File
ON D O^%ZAPM.ed.BSF7 Q
FILE Q:'$D(%IN)  D SI^%ZAPM.ed.BSN N (%BS,vl,%FN,%IN) S %SDEV="HISTORY" D  S:'$D(%FN) %FN="" D OP^%ZAPM.ed.BSF4 Q
 .I %IN=0 D DOSOPN^%ZAPM.ed.BSBL1 Q
 .I %IN=1 D DOSREAD^%ZAPM.ed.BSS1 Q
View(%File,BSr,BSt,P,OT,DO) N %DEV,%FN,i,UP,t1,ii ;ФАЙЛ В МАССИВ
 ;S %File=$$AddFile(%File)
 I '$G(P),BSt["View*",($P(d,"-",2)>$$SizeFile(1)) D ErrMsg^%ZAPM.ed.BSXfun("ФАЙЛ "_%File_" ДЛЯ ПРОСМОТРА СЛИШКОМ ВЕЛИК !") Q 0
 I '$G(P),BSt["Edit*",($P(d,"-",2)>$$SizeFile(2)) D ErrMsg^%ZAPM.ed.BSXfun("ФАЙЛ "_%File_" ДЛЯ РЕДАКТИРОВАНИЯ СЛИШКОМ ВЕЛИК !") Q 0
 S %FN=%File 
 ;I $ZV["Cach"||($ZV["IRIS") Q:$$Open^%ZAPM.ed.BSCF1(%FN,"R")<0 0 S %DEV=DOS G Vi
 ;F %DEV=51:1:54 O %DEV::0 Q:$T
 ;I '$T S ls=" Все файловые устpойства ДОС заняты " D ON Q 0
 ;O %DEV:%FN U %DEV I $ZA=-1 U 0 S ls=" Файл "_%FN_" не найден " D ON Q 0
 ;O %DEV:(%FN:"R") U %DEV I $ZA<0 U 0 S ls=" Ошибка откpытия файла "_%FN D ON Q 0
Vi S %zT=$ZT,$ZT="ERFILE^%ZAPM.ed.BSDOS2"
 U 0 S UP="" F i=0:1:8,10:1:31 S UP=UP_$C(i)
 K @(BSr_"(BSt)") S $P(@$ZR,"@")=%File,$P(@$ZR,"@",17)=5
 set file=%FN
 set f=##class(%File).%New(file)
 set ok=f.Open("RSK")     if 'ok do f.%Close() Q ok
 S ls="Load... "_%FN D WAITS^%ZAPM.ed.BSF2 
 set len=$zu(140,1,file),i=0
 while 'f.AtEnd {
     set str = f.ReadLine()
     D ViewIn(str,UP,BSr,BSt)
  }
 do f.%Close()
 ;S ls="Load... "_%FN D WAITS^%ZAPM.ed.BSF2 
 ;S:'$D(OT) OT=1 S:'$D(DO) DO=9999999
 ;S i=0 F ii=OT:1:DO U %DEV R %LINE#509 Q:$ZC  I ii'<OT D ViewIn(%LINE,UP,BSr,BSt)
ViEND ;I %LINE'="" D ViewIn(%LINE,UP,BSr,BSt)
 U 0 ;C %DEV 
 S $P(@BSr@(BSt),"@",28)=i
 Q 1
ERFILE U 0 I $ZE["<INRP" S ls=" ПРЕРВАНО..." G EREFILE
 I $ZE["<ENDOFFILE" G ViEND
 I $ZE["<MXSTR" S ls=" Слишком длинная строка считана " G EREFILE
EREFILE D ErrMsg^%ZAPM.ed.BSXfun($ZE_" "_$$ErrSay^%ZAPM.ed.BSF8($ZE)) S $ZT=$G(%zT) Q 0
 
ViewIn(%LINE,UP,BSr,BSt) I '$D(i) S i=0
 U 0 S i=i+1,t1=$TR(%LINE,UP,$TR($J("",$L(UP))," ","¬")) D  S @(BSr_"(BSt,i)")=t1 X $G(WA)
 .i t1[$C(9) S t1=$E($$TR^%ZAPM.ed.BSsFUNM(t1,$C(9),"         "),1,509)
 .I '$D(S1),$$IFDOS^%ZAPM.ed.BSHTML1(t1) D INIT^%ZAPM.ed.BSre(1)
 .s t1=$TR(t1,$G(S1),$G(S2))
 Q
INITHELP ;ИНИЦИАЛИЗАЦИЯ СПРАВОЧНОЙ СИСТЕМЫ
 Q:$D(^%ZAPM.ed.BSGER("MSMHELP"))  Q:'$D(^%ZAPM.ed.BSHLP("MSMDOC"))  N I
 S I="" F  S I=$O(^%ZAPM.ed.BSHLP("MSMDOC",I)) Q:I=""  S ^%ZAPM.ed.BSGER("MSMHELP",$P(^%ZAPM.ed.BSHLP("MSMDOC",I)," "))=$P(^%ZAPM.ed.BSHLP("MSMDOC",I)," ",2,4)
 S ^%ZAPM.ed.BSGER("MSMHELP")=$P($P($G(^%ZAPM.ed.BSHLP("MSMDOC")),"@"),":",2,99)
 Q
MSMHELP(S) ;СПРАВОЧНАЯ СИСТЕМА ПО MSM
 Q:'$D(^%ZAPM.ed.BSGER("MSMHELP"))
 N SS,FN,DOS,OT,DO,SSS
 S FN=^%ZAPM.ed.BSGER("MSMHELP") Q:FN=""  S SS=S
 I '$D(^%ZAPM.ed.BSGER("MSMHELP",S)) S (SSS,SS)=$O(^%ZAPM.ed.BSGER("MSMHELP",S)) I ("@"_SS)'[("@"_S) D ErrMsg^%ZAPM.ed.BSXfun("СПРАВКИ ПО ?"_S_" НЕТ") Q
 S OT=$P(^%ZAPM.ed.BSGER("MSMHELP",SS)," "),DO=$P(^%ZAPM.ed.BSGER("MSMHELP",SS)," ",2)
 I '$$View(FN,"^%ZAPM.ed.BSbufB","MsmHelp%BS*.*"_$G(%BS(3),$P),1,OT,DO) Q
 S IYI="^%ZAPM.ed.BSbufB,MsmHelp%BS*.*"_$P D NE^%ZAPM.ed.BSN Q
 Q
DOSTXT(FN) I '$$View(FN,"^%ZAPM.ed.BSbufB","View%BS*.*"_$G(%BS(3),$P),1) Q
 S IYI="^%ZAPM.ed.BSbufB,View%BS*.*"_$P D NE^%ZAPM.ed.BSN Q
DOCBS(BS,ST) I '$$View($P($G(^%ZAPM.ed.BSETUP("PATH",ST,4),$G(^%ZAPM.ed.BSS("PATH",ST,4))),"@",15)_BS,"^%ZAPM.ed.BSbufB","Help%BS*.*"_$G(%BS(3),$P)_$J_"u1",1) Q
 S IYI="^%ZAPM.ed.BSbufB,Help%BS*.*"_$G(%BS(3),$P)_$J_"u1" D NE^%ZAPM.ed.BSN Q
HELPP(N) D DOCBS("BSP"_N,8) Q  ;ПОМОЩЬ ПО ОПИСАНИЮ %BS ПРИЛОЖЕНИЯ
HELP(N) D DOCBS("BS"_$S(N?.N:"C",1:"")_N,8) Q  ;ПОМОЩЬ ПО ОПИСАНИЮ %BS
NEW(N) D DOCBS("BS_Release_notes.txt",2) Q  ;ЧТО НОВОГО ?
]]></Routine>


<Routine name="%ZAPM.ed.BSER" type="MAC" languagemode="0"><![CDATA[
%BSER ;RTM;MSM ПАКЕТНОЕ РЕДАКТИРОВАНИЕ ПРОГРАММ ; 13:39   31.05.99
 S IYI="^%ZAPM.ed.BSS(EditRou" D NE^%ZAPM.ed.BSN Q
%RSEL() ;ФУНКЦИЯ ВЫБОРА ПРОГРАММ
 I $ZV["MSM" K QUIT D  I $D(QUIT) I '%FLG Q 0
 .D INT^%RSEL S %Jo=$J
 I $ZV["Cach"||($ZV["IRIS") D  I %R=0 Q 0
 .D ^%RSET S %Jo=%JO
 Q 1
E(No) ;1=МЕТКА     2-ПОИСК    3-ПОИСК И ЗАМЕНА    4-ПОИСК И РЕДАКТИРОВАНИЕ
 S %FLG=0 W /ED(2),/CUP(1,1)
ASK1 U 0 I '$$%RSEL() D ErrMsg^%ZAPM.ed.BSXfun("Программы не выбраны") G EXIT
 G @No
3 S %FLG=1,%ST=0 S $ZT="ERROR^%ZAPM.ed.BSER"
ASK2 U 0 s %X=$$LineEdit^%ZAPM.ed.BSXfun("","Что Замещать") d Echo^%ZAPM.ed.BSXfun(1) I %X="" S %FLG=0 G ASK1
 S %ST=%X
 s %RP=$$LineEdit^%ZAPM.ed.BSXfun("","На что    : ") d Echo^%ZAPM.ed.BSXfun(1)
VER R !!,"С подтверждением ? <N> ",%V G ASK2:%V="^",EXIT:%V="^Q"
 S %V=$S(%V?1"Y".E:1,%V?1"N".E:0,%V="":0,1:-1) I %V<0 W "  ??",*7 G VER
 S BSr="^%ZAPM.ed.BSbufB",BSt="%RSEBUF3",Obraz(12)=1,Obraz(21)=1,CR="S t=t+1,t(t)=%CC_""+""_%I_"": ""_%T"
 S t0="-  Поиск И Замена строк в программах. Введите <Enter> для входа в редактор " D CR^%ZAPM.ed.BSTT
 S CRT1="X CRT K t S t=0",CRT="S t=0 F  S t=$O(t(t)) Q:'t  S t0=t(t) D CR^%ZAPM.ed.BSTT",t=0
 S t0="-  "_$$ESDAY^%ZAPM.ed.BSsFUNR(9,$$h^%ZAPM.ed.BS3()) D CR^%ZAPM.ed.BSTT
 S t0="-  Заменяем :<"_%ST_"> На    :<"_%RP_">" D CR^%ZAPM.ed.BSTT
 W !! U 0
 W !,?22,"Изменения В программах "
 I $ZV["MSM" D ^%GUCI
 I $ZV["Cach"||($ZV["IRIS") D ^%DIR
 W !!,t0 K END
LK S %LK="F %I=1:1 S %T=$T(+%I) Q:%T=""""  S %K=$L(%T,%ST) I %K>1 X %LM I '%ER S %F=1 X %LL X %LN Q:$D(END)  I %UF ZI %M:+(%I) ZR +%I U 0 I '%V U 0 W !,%CC,""+"",%I-1,"": "",%M X CR"
LL S %LL="S %M="""" F %J=1:1:%K S %M=%M_$P(%T,%ST,%J) S:%J'=%K %M=%M_%RP"
 I $ZV["MSM" ;S %X=$S($ZB($V(140,$J,2),#800,1):1000,1:255)
 I $ZV["Cach"||($ZV["IRIS") S %X=1000 ;?
LM S %LM="S %ER=$S(($L(%T)-(%K-1*$L(%ST))+(%K-1*$L(%RP)))>"_%X_":1,1:0) I %ER W !,%CC,""+"",%I-1,"": Not changed - New line is greater than "_%X_" characters"""
LN S %LN="S %UF=1 Q:'%V  U 0 X CR W !!,%CC,""+"",%I-1,!,""OLD: "",%T,!,""NEW: "",%M F %VN=1:1 R !!,""Замещаем <Y> "",%VA,! S:%VA=""^"" END=1 Q:$D(END)  S %UF=$S(%VA=""N"":0,%VA=""Y"":1,%VA="""":1,1:-1) Q:%UF'<0  W ""  ??"",*7"
RSEL ;
 S $ZT="RSEL2^%ZAPM.ed.BSER",%CC=-1,%PCT=0,%FND=0,%F=0
RSEL1 ;
 F %I=1:0 S %CC=$N(^UTILITY(%Jo,%CC)) Q:%CC<0  I %CC'=0 X "ZL @%CC U 0 X:0'=$I ""W %CC,""""  """""" U 0 X %LK Q:$D(END)  ZS:%F @%CC" S %PCT=%PCT+1 S:%F %FND=%FND+1,%F=0 X CRT1
 D OkMsg^%ZAPM.ed.BSXfun("Обработано "_%PCT_" Программ(а)")
 S %ST=0
 S Coment="Список Замен в программах.Состояние до Редактирования" K t,t0
 D CREAT^%ZAPM.ed.BSTT S %FLG=0 W /CUP(1,1),/ED(2)
 G ASK2
RSEL2 ;
 U 0 I $F($ZE,"<NOPGM>") S $ZT="RSEL2^%ZAPM.ed.BSER" W !,"Routine: ",%CC," not found." G RSEL1
 G ERROR
EXIT ;
 U 0 I $D(%DEV),%DEV'=$I,+%DEV C %DEV
 K %,%BLK,%CC,%DEV,%ER,%F,%FLG,%FND,%J,%K,%LK,%LL,%LM,%M,%PCT,%RP,%ST,%T,%UCI,%UCN,%X,%I,%LN,%UF,%V,%VA,%VN,QUIT
 Q
ERROR ;
 I $F($ZE,"<INRPT>") U 0 W !!,"...Aborted." D EXIT ZQ:$ZV["Wind"!($ZV["Cach"||($ZV["IRIS"))  ;V 0:$J:$ZB($V(0,$J,2),#0400,7):2
 ZQ
REDIT ;ВХОД В РЕДАКТОР ПО ТОЧКЕ ПРЕРЫВАНИЯ
 Q:$ZE=""  I $ZV["MSM" d ^%ZAPM.ed.BSX("PROG",$P($P($ZE,"^",2),":"),$P($P($ZE,"+",2),"^")) Q
 d ^%ZAPM.ed.BSX("PROG",$P($P($ZE,"^",2),":"),$$LABEL^%ZAPM.ed.BSCp($P($P($ZE,">",2),"^"),$P($P($ZE,">",2),"^",2))) ;ДЛЯ CACHE'
 Q
]]></Routine>


<Routine name="%ZAPM.ed.BSER1" type="MAC" languagemode="0"><![CDATA[
%BSER1 ;ПАКЕТНЫЕ ОПЕРАЦИИ С ПРОГРАММАМИ ; 13:01   02.06.99
4 S Txx=4,Tx="Строки поиска для редактирования" G GO
1 S Txx=1,Tx="Метки поиска" G GO
2 S Txx=2,Tx="Строки поиска"
GO S %FLG=1,%ST=0 K %SE S $ZT="ERROR^%ZAPM.ed.BSER1"
ASK2 U 0
ASK3 D OP^%ZAPM.ed.BSF4 s %X=$$LineEdit^%ZAPM.ed.BSXfun("","Введите "_Tx,"","","",$$HISFIND^%ZAPM.ed.BSS()) D Echo^%ZAPM.ed.BSXfun(1) I %X="",'$D(%SE(1)) S %FLG=0 W /ED(2) G ASK1^%ZAPM.ed.BSER
 I %X'="" S %ST=%ST+1,%SE(%ST)=%X G ASK3
 W !! U 0
 W !,?22,"Поиск в программах  " W !
 S BSr="^%ZAPM.ed.BSbufB",BSt="%RSEBUF"_Txx,Obraz(12)=1,Obraz(21)=1,CR="S t=t+1,t(t)=%CC_""+""_%I_"": ""_%T"
 S t0="-  "_Tx_" в программах. Введите <Enter> для входа в редактор " D CR^%ZAPM.ed.BSTT
 S CRT1="X CRT K t S t=0",CRT="S t=0 F  S t=$O(t(t)) Q:'t  S t0=t(t) D CR^%ZAPM.ed.BSTT",t=0
 S t0="-  "_$$ESDAY^%ZAPM.ed.BSsFUNR(9,$$h^%ZAPM.ed.BS3()) D CR^%ZAPM.ed.BSTT
 F %I=1:1:%ST W ?(33-($L(%SE(%I))\2)),%SE(%I),! S t0="- "_%SE(%I) D CR^%ZAPM.ed.BSTT
 I Txx=4 D
 .S %LK="F %I=1:1 S %T=$T(+%I) Q:%T=""""  F %J=1:1:%ST I %T[%SE(%J) W /CUP(1,1),/ED(2),!,%CC,""+"",%I S li=%T,YES=0 X NNNN ZL @%CC S %F=1 I YES X NNN,CR"
 .S NNN="ZI li:+(%I) ZR +%I ZS @%CC",NNNN="N (li,%BS,YES) S li=$$Edit^%ZAPM.ed.BSXuse(li,3,1,7,79,""@"") Q  "
 I Txx=2 S %LK="F %I=1:1 S %T=$T(+%I) Q:%T=""""  F %J=1:1:%ST I %T[%SE(%J) W !,%CC,""+"",%I,"": "",%T S %F=1 X CR Q  "
 I Txx=1 S %LK="F %I=1:1 S %T=$T(+%I) Q:%T=""""  F %J=1:1:%ST I $P(%T,"" "")[%SE(%J) W !,%CC,""+"",%I,"": "",%T S %F=1 X CR Q  "
RSEL ;
 S %CC=-1,%PCT=0,%FND=0,%F=0
RSEL1 ;
 S $ZT="RSEL2^%ZAPM.ed.BSER1"
 F %K=1:1 S %CC=$N(^UTILITY(%Jo,%CC)) Q:%CC<0  I %CC'=0 X "ZL @%CC U 0 X:0'=$I ""W:'(%K-1#8) ! W ?(%K-1)#8*10,%CC,""""  """""" U 0 X %LK" X CRT1 S %PCT=%PCT+1 S:%F %FND=%FND+1,%F=0
 D OkMsg^%ZAPM.ed.BSXfun(%PCT_" Программ обработано.")
 U 0
 S Coment="Программы."_Tx_$S(Txx=4:".Состояние до Редактирования",1:"") K t,t0
 D CREAT^%ZAPM.ed.BSTT
 K %SE S %ST=0 W /CUP(1,1),/ED(2) G ASK2
RSEL2 ;
 I $F($ZE,"<NOPGM>") W !,"Routine: ",%CC," not found." G RSEL1
 G ERROR
EXIT ;
 U 0
 K %,%BLK,%CC,%DEV,%F,%FLG,%FND,%LK,%I,%J,%K,%PCT,%SE,%ST,%T,%X,QUIT Q
ERROR ;
 I $F($ZE,"<INRPT>") U 0 W !!,"...Aborted." D EXIT ZQ:$ZV["Wind"!($ZV["Cach"||($ZV["IRIS"))  ;V 0:$J:$ZB($V(0,$J,2),#0400,7):2
 ZQ
]]></Routine>


<Routine name="%ZAPM.ed.BSERV" type="MAC" languagemode="0"><![CDATA[
%BSERV ;пpогpамма FOR-SERVER ; 12:20   21.03.99
 Q
JOB N T,G,S,LIST I '$$LO Q
 I $$ACTIV(G,T,S,0)=1 Q
 J JOB^%ZAPM.ed.BSERVER(G,T,S):20:1 E  W $$bel^%ZAPM.ed.BS3
 Q
JOBING(PR,XP) N T,G,S,LIST I '$$LO Q 0
 S @G@("OTK",S)="J?" N I,II
 S @G@("CMD",S)="J "_PR_"(XP)::1 S:$T @G@(""OTK"",S)=""JOB!OK""" F I=1:1:T+2 H 1 I $G(@G@("OTK",S))="JOB!OK" S II=1 Q
 Q +$G(II)
ACTIV(G,T,S,N) N WA,ls,li I $G(N) D Wait^%ZAPM.ed.BSXfun("Проверка Активности %BS-Сервера системы "_S)
 S @G@("OTK",S)="?" N I,II
 S @G@("CMD",S)="D ACT^%ZAPM.ed.BSERVER" F I=1:1:T*2 H 1 X:$G(N) WA I $G(@G@("OTK",S))="!" S II=1 Q
 Q +$G(II)
LIST W #,"                 Активны следующие М-Сервера" K LIST
 S I="" F II=1:1 S I=$O(@G@("STA",I)) Q:I=""  D
 .I $$ACTIV(G,T,I,1) W /CUP(II+2,1),II,".",I," Time ",($P($$h^%ZAPM.ed.BS3(),",")-$P(@G@("STA",I),",")),"\ ",$$Time^%ZAPM.ed.BSsFUNR($P($$h^%ZAPM.ed.BS3(),",",2)-$P(@G@("STA",I),",",2)) D  S LIST(II)=I Q
 ..W " "_$E($G(@G@("CMT",I)),1,59)
 .S II=II-1
 I II=1 D ErrMsg^%ZAPM.ed.BSXfun("Нет активных Серверов")
 Q
NUM I $D(LIST(S)) S S=LIST(S)
 I S=0 S S="All"
 Q
COCO(I) ;ВНУТРЕННИЕ КОМАНДЫ КОМАНДЕРУ
 S I=$P(I," ;") I I="LIST" D LIST Q 1
 I I="LAST" D LastMsg^%ZAPM.ed.BSERVF Q 1
 I I="GO" D JOB^%ZAPM.ed.BSERV Q 1
 I $E(I,1,3)'?3U X I Q 1
 Q 0
SEND ;ПОСЛАТЬ СООБЩЕНИЕ
 N T,G,S,I,II,MS I '$$LO Q
 K I
SEN S I=$$LineEdit^%ZAPM.ed.BSXfun($G(I),"Посылайте Текст сообщения в формате: SYS Сам текст... Циркулярно,то All",$C(34),"","","^%ZAPM.ed.BSbufB(""HISTMSGSRV"")") q:YES<1
 I $$COCO(I) G SEN
 S S=$P(I," ") Q:S=""  S MS=$P(I," ",2,999) I S?.N D NUM
 I S'="All",'$D(@G@("STA",S)) D ErrMsg^%ZAPM.ed.BSXfun("Система "_S_" Не активна") G SEN
 I $D(@G@("STA",S)) D MSG(G,T,S,MS) Q
 I S="All" S I="" F II=1:1 S I=$O(@G@("STA",I)) Q:I=""  D MSG(G,T,I,MS)
 Q
MSG(G,T,S,M) ;ПОСЛАТЬ СООБЩЕНИЕ БЕЗ ОЖИДАНИЯ ПОДТВЕРЖЕНИЯ
 S M="Сообщение "_$P($$ZU^%ZAPM.ed.BS3(1,0),",",2)_"-->"_S_" :"_M
 S @G@("CMD",S)="D MSG^%ZAPM.ed.BSERVER("""_$TR(M,$C(34),"")_""")"
 Q
CTRL ;КОНТРОЛЬ
 I '$$AccesMSM^%ZAPM.ed.BSDOS2(4) Q
 N T,G,S,I,II,MS I '$$LO Q
 K I
CTR S I=$$LineEdit^%ZAPM.ed.BSXfun($G(I),"Посылайте Команду %BS-Серверам: SYS Команда... Циркулярно,то All","","","^%ZAPM.ed.BSHLP,CMDSRV","^%ZAPM.ed.BSbufB(""HISTCMDSRV"")") q:YES<1
 I $$COCO(I) G CTR
 S S=$P(I," ") Q:S=""  S MS=$P(I," ",2,999) I S?.N D NUM
 I S'="All",'$D(@G@("STA",S)) D ErrMsg^%ZAPM.ed.BSXfun("Система "_S_" Не активна") G CTR
 I $D(@G@("STA",S)) D CMD(G,T,S,MS) Q
 I S="All" S I="" F II=1:1 S I=$O(@G@("STA",I)) Q:I=""  D CMD(G,T,I,MS)
 Q
CMD(G,T,S,C) ;ПОСЛАТЬ КОМАНДУ
 S @G@("CMD",S)=C
 Q
IntCMD(C) ;ВНУТРЕННЯЯ ТОЧКА КОМАНД М-СЕРВЕРУ
 N T,G,S,I,II,MS I '$$LO Q
 D CMD(G,T,S,C)
 Q
Int(C) ;ВНУТРЕННЯЯ ТОЧКА КОМАНД
 N T,G,S,I,II,MS I '$$LO Q
 X C
 Q
LO() S G=$P($G(^%ZAPM.ed.BSETUP("SERVER",4,4)),"@",15)
 S T=+$P(G,"\") Q:'T 0
 I '$$Data^%ZAPM.ed.BSF12($NA(@$P(G,"\",2))) Q 0
 S S=$P($$ZU^%ZAPM.ed.BS3(1,0),",",2),G=$ZR
 D CLr^%ZAPM.ed.BSF4
 Q 1
SPACE ;ПРОСТРАНСТО ДИСКОВ
 D TempT^%ZAPM.ed.BSTT N B D TempTX^%ZAPM.ed.BSTT("")
 F I="C","D","E","F" S B=$$ZOS9^%ZAPM.ed.BSDOS(I) I +B>0 D SPA(I,B)
 D TempTXT^%ZAPM.ed.BSTT("Распределение Дискового пространства",$G(@%BS(20)@("ErrorTXT")))
 D TempTXTE^%ZAPM.ed.BSTT
 Q
SPA(D,B) N I,C
 F I=1:1:4 S C(I)=$P(B,"^",I)
 D TempTX^%ZAPM.ed.BSTT(" Total space on drive "_D_$J("("_$FN(C(1)*C(3)*C(4),",")_" bytes)",25))
 D TempTX^%ZAPM.ed.BSTT("                 Free "_D_$J("("_$FN(C(1)*C(2)*C(3),",")_" bytes)",25))
 Q
 
DSP N %X,%Y,%A,%B,%C,%I S %X=%DRV Q:%X=-1  S %Y=$$ZOS9^%ZAPM.ed.BSDOS(%X) F %I=1:1:4 S @("%"_$C(64+%I))=$P(%Y,"^",%I)
 S i1=" Free  space on drive "_%X_" "_$J(%A*%B*%C,10)_" bytes  ("_(%A*%B*%C\104857.6/10)_" Megabytes)"
 S i2=" Total space on drive "_%X_" "_$J(%A*%C*%D,10)_" bytes  ("_(%A*%C*%D\104857.6/10)_" Megabytes)" Q
]]></Routine>


<Routine name="%ZAPM.ed.BSERVER" type="MAC" languagemode="0"><![CDATA[
%BSERVER ;%BS-SERVER ; 17:01 10-JUN-98
JOB(G,T,S) ;ЗАПУСК
 D MGR^%ZAPM.ed.BS S @G@("STA",S)=$$h^%ZAPM.ed.BS3(),@G@("CMT",S)="MSM v."_$P($ZV,"Version ",2)_" §"
 F  H T D
 .I $$Data^%ZAPM.ed.BSF12($NA(@G@("EVENT",S))) S CMD=@$ZR D EVE(CMD) I $G(STOP) D KILLS(G,S) H
 .I $$Data^%ZAPM.ed.BSF12($NA(@G@("CMD",S))) S CMD=@$ZR D CMD(CMD) I $G(STOP) D KILLS(G,S) H
 Q
ACT ;АКТИВНЫЙ
 S @G@("OTK",S)="!"
 Q
STOP ;ОСТАНОВ СЕРВЕРА
 S STOP=1 Q
CMD(C) ;КОМАНДЕР СЕРВЕРА
 S %zT=$ZT,$ZT="ERC^%ZAPM.ed.BSERVER"
 X C S @G@("$T",S)=$T,@G@("ERR",S)="OK" K @G@("CMD",S) Q
 Q
EVE(C) ;ПРОВЕРКА СОВЕРШЕНИЯ СОБЫТИЯ
 S %zT=$ZT,$ZT="EVER^%ZAPM.ed.BSERVER"
 X C
 Q
EVER S @G@("EVER",S)=$$ErrSay^%ZAPM.ed.BSF8($ZE) G ER
ERC S @G@("ERR",S)=$$ErrSay^%ZAPM.ed.BSF8($ZE),@G@("$T",S)=0 K @G@("CMD",S)
ER S $ZT=$G(%zT)
 Q
MSMSTOP ;ОСТАНОВ M
 Q
SEND(S,M) ;ПОСЛАТЬ СООБЩЕНИЕ БЕЗ ОЖИДАНИЯ ПОДТВЕРЖЕНИЯ
 D MSG^%ZAPM.ed.BSERV(G,T,S,M) ;ПОСЛАТЬ СООБЩЕНИЕ БЕЗ ОЖИДАНИЯ ПОДТВЕРЖЕНИЯ
 Q
MSG(M) N I,II ;ТОБЕ ПАКЕТ !
 S II=$E(M,1,79) ZU 0 W *27,"[1;1H" ZU 0 W *27,"[1;6;33;41m" ZU 0 W *27,"[K" F I=1:1:$L(II) ZU 0 W $E(II,I),*7
 S @G@("LastMsg",S)=$E($$ESDAY^%ZAPM.ed.BSsFUNR(8,$$h^%ZAPM.ed.BS3())_"\"_M,1,$$LNG^%ZAPM.ed.BSF12)
 Q
KILLS(G,S) K @G@("STA",S),@G@("$T",S),@G@("ERR",S),@G@("OTK",S),@G@("CMT",S) Q
]]></Routine>


<Routine name="%ZAPM.ed.BSERVF" type="MAC" languagemode="0"><![CDATA[
%BSERVF ; ФУНКЦИИ FOR-%BS-SERVER ; 12:55   17.10.2003
 Q
LastMsg N T,G,S,LIST I '$$LO^%ZAPM.ed.BSERV Q
 D OkMsg^%ZAPM.ed.BSXfun($G(@G@("LastMsg",S),"СООБЩЕНИЙ НЕ БЫЛО !")) Q
EXIT(ku,Sec) ;ОСТАНОВ MSM-СТАНЦИИ БЕЗУСЛОВНЫЙ
 D MSG^%ZAPM.ed.BSERVER("!!! ВАШЕМУ %BS-СЕРВЕРУ ДАЛИ КОМАНДУ СРОЧНО ОСТАНОВИТЬСЯ !!!")
 H +$G(Sec,5)
 I ku=2 D S^%ZAPM.ed.BSD2
 I ku=1 D SS^%ZAPM.ed.BSD2
 Q
UPG(U)
 D MSG^%ZAPM.ed.BSERVER("!!! ВАШ ПРОЦЕСС ОСТАНОВЯТ ДЛЯ ПРИНУДИТЕЛЬНОГО ПОВЫШЕНИЯ ВЕРСИИ %BS !!!") H 5
 D %BSKJ J IntSELF^%ZAPM.ed.BSMENU(U):20:1 ;АВТОМАТИЧЕСКОЕ ПОВЫШЕНИЕ ВЕРСИИ %BS
 Q
%BSKJ N I ;ТОРМОЗ ЗАДАНИЯ ОСНОВНОГО ПРОЦЕССА %BS
 S I=$$%BSJ I I D KJ(I)
 Q
%BSJ() N I,II ;НОМЕР ЗАДАНИЯ ОСНОВНОГО ПРОЦЕССА %BS
 S II=0 F I=1:1:20 D  Q:II
 .L +@("%BSj"_I):1 E  S II=I
 .L -@("%BSj"_I)
 Q II
KJ(J) D MGR^%ZAPM.ed.BS,KILL^KILLJOB(J,1)
 Q
EXE(EXE,N) ;ДОС-ПРОЦЕСС ДАЖЕ НА М-СЕРВЕРЕ
 I N=1 S EXE=$$JOB^%HOSTCMD(EXE) Q
 D LV^%ZAPM.ed.BSF4 D EXE^%ZAPM.ed.BSDOS(EXE,1)
 Q
PEEK(SYS,H) ;ПОДГЛЯДЕТЬ ЭКРАН, СКОЛЬКО СЕКУНД ОЖИДАТЬ ОТКЛИКА
 I $ZV["Wind"!($ZV["Cach"||($ZV["IRIS")) Q
 N I
 I '$$LO^%ZAPM.ed.BSERV Q
 K @G@("SCR",SYS) S @G@("CMD",SYS)="D SCRSAVE^%ZAPM.ed.BSERVF" F I=1:1:H H 1 I $D(@G@("SCR",SYS)) S I=$ZR D LoadWinV^%ZAPM.ed.BSXfun($NA(@G@("SCR",SYS)),1) W $$bel^%ZAPM.ed.BS3,$$bel^%ZAPM.ed.BS3,$$bel^%ZAPM.ed.BS3,$$r^%ZAPM.ed.BS3 K @I Q
 Q
SCRSAVE ;D SaveWinV^%ZAPM.ed.BSXfun(1,1,25,80,$NA(@G@("SCR",S)),1)
 Q
]]></Routine>


<Routine name="%ZAPM.ed.BSF" type="MAC" languagemode="0"><![CDATA[
%BSF ;КОМАНДЫ И РЕЖИМЫ F-КЛАВИШ ; 13:42   13.01.2003
 S LAB=$TR(%JB(%JB),",","")_%B G @LAB
10 D 333 D d G:$D(NAZAD) 0^%ZAPM.ed.BSTM
100 S %zT=$ZT,$ZT="P^%ZAPM.ed.BSF" S:'$P(@(BSR_"(BST)"),"@",23) (@(BSR_"(BST,""STA"")"),%BS("Tmp","LastTabl"))=ny_","_nx_"@"_BSY(BS0)_"@"_BSX(BS0)_"@"_R1_"@"_R2_"@"_R3_"@"_MY_"@"_MX_"@"_$P(BS,"@",15)
1000 S $P(@(BSR_"(BST)"),"@",30)="" D  D d I BSR'="^%ZAPM.ed.BSbufB",$D(^%ZAPM.ed.BSbufB("LOGS"_$G(%BS(3),$P)_$J_$P($$ZU^%ZAPM.ed.BS3(1,0),",",2)_"u1")) K @$ZR
 .I $E(BST)="@" S I=$E(BST,2,99),$P(@(BSR_"(I)"),"@",30)=""
END S $ZT=$G(%zT) I $D(BSR) D U^%ZAPM.ed.BS3($NA(@BSR@(BST)))
 I $P($G(@BSR@(BST)),"@",41)'="" D  ;ПРЕДОБР.ПЕРЕД ВЫХОДОМ
 .N R1 S R1=999 D Pred^%ZAPM.ed.BSF12($P($G(@BSR@(BST)),"@",41)) Q
 K S,STATUS,VYC,BS0,BSX,BSY,B,BX,BY,x,t,zr,t1,%VDB,%CAL,%X1,%X2,%Y1,%Y2,%TIT,MR,%w(2),M1,BS,%w(4),%w(5),%DIA,%DI,%ZAP,%FK,i,j,ii,jj,se,ke,j1,j2,j3,MX,MY,M,BS1,BS2,BSF,BSX1,BSX2,BSY1,BSY2,CLR,ENDLI,BSI,BSII,NAZAD,li,ls,lo
 ;K MR23,MR24,MR25,%Cu
 K ColrMenu,ObOi,RA,PREDMOV,MxX,MyY,My,Mx,COLOR,EXITout,%FN,%DEV,es,ek,h,hi,hl,%INV,%INV1,%INV2,v,vv,vvv
 K Ukaz,GGG,Na,POSt,PredOb,Sel,TmP,Tmp,Sort,Ny,%BSTM,AllWAY,KsP,%BStree
 Q
 ;ЗАПИСЬ В Б.Д.
3333 Q:$P(@(BSR_"(BST,ny,nx)"),"@",9)<2  I $D(@gBuf@(ny,nx)) S zr=@$ZR D  Q
 .I $D(Hid) D  Q  ;HiddenLastKey
 ..Q:$P($P(@BSR@(BST,ny,nx),"@",18),"#",2)=""  S nynx=$P($P(^(nx),"@",18),"#",2)
 ..Q:'$D(@Hid@(ny))  I $$BSDAT(%NAm,@Hid@(ny))
 ..I zr="" K @$ZR@(nynx) Q
 ..S @$ZR@(nynx)=zr
 .I $P($P(@(BSR_"(BST,ny,nx)"),"@",18),"#")'="" S nynx=$P($P(^(nx),"@",18),"#")
 .E  S nynx=ny_","_nx
 .I zr="" K @(%NAm_"nynx)") Q
 .S @(%NAm_"nynx)")=zr ;ЗАПИСЬ В Б.Д.
 Q
BSDAT(N,H) S N=$E(N,1,$L(N)-1)_")" I $D(@N@(H))
 Q $T
 ;
22 D BLout^%ZAPM.ed.BSout G D   ;ВЫВОД БЛОКА
21111 D Kout^%ZAPM.ed.BSout0(1) K in G D   ;ВЫВОД НА ПРИНТ. (ВСЕ)
21121 D Kout^%ZAPM.ed.BSout0(2) K in G D   ;ВЫВОД В ФАЙЛ (ВСЕ)
21131 D Kout^%ZAPM.ed.BSout0(3) K in G D   ;ВЫВОД В ТЕКСТ (ВСЕ)
21141 D Kout^%ZAPM.ed.BSout0(4) K in G D   ;ВЫВОД НА РТА (ВСЕ)
2115 D OUTHTML^%ZAPM.ed.BSre G D
2116 D OUTJAVA^%ZAPM.ed.BSHTML1 G D
2117 D OUTHTMLT^%ZAPM.ed.BSre G D
2121 D DTout^%ZAPM.ed.BSout3(1) G D   ;ВЫВОД ДАННЫХ НА ПРИНТ.(ВСЕ)
2122 D DTout^%ZAPM.ed.BSout3(2) G D   ;ВЫВОД ДАННЫХ В ФАЙЛ (ВСЕ)
2123 D DTout^%ZAPM.ed.BSout3(3) G D   ;ВЫВОД ДАННЫХ В ТЕКСТ (ВСЕ)
2124 D DTout^%ZAPM.ed.BSout3(4) G D   ;ВЫВОД ДАННЫХ НА РТА (ВСЕ)
 G D
R Q
41 S li=d G LE^%ZAPM.ed.BSTM
42 I $E($G(%BS(14)),3) S ls=" С УСТРОЙСТВА "_$G(%BS(3),$P)_"  КОРРЕКЦИЯ ЗАПРЕЩЕНА " D O^%ZAPM.ed.BSF7 G D
 I $P(@(BSR_"(BST)"),"@",22) S ls=" ТАБЛИЦА ОПТИМИЗИРОВАНА, КОРРЕКЦИЯ ЗАПРЕЩЕНА " D O^%ZAPM.ed.BSF7 G D
 I '$D(%w(4)) D PASE^%ZAPM.ed.BST1 E  H 1 G D
 D PASE^%ZAPM.ed.BST1 E  G D
 S LOC=1,YES=1 D EDCOPY,0 G D:'LOC,D:BST'["@" K Ukaz S OO=2,OOO="^%ZAPM.ed.BS" K %JB D 24^%ZAPM.ed.BSTM,^%ZAPM.ed.BSB,ZA,MEO G D:R1=27 S LAB="E"_$TR(%JB(%JB),",","")_%B_"^%ZAPM.ed.BSF",LAB=LAB_$S(LAB["E15":4,1:1)
 D  G:'$D(%GO) @LAB D @%GO S ls="готово" D WAITS^%ZAPM.ed.BSF2 H 1 G D:'$D(Quit)
 .;D OkMsg^%ZAPM.ed.BSXfun("LAB="_LAB_",%GO="_$G(%GO))
 G B^%ZAPM.ed.BSTM:$G(Quit)'=2 Q
E3 S li=$P(BS,"@",6) W /CUP(25,1),$$atr^%ZAPM.ed.BS3(0),"K Вводите / Корректируйте символьное имя Клетки (До 4 символов)" D 24^%ZAPM.ed.BSTM,LINE^%ZAPM.ed.BSF1 I  S $P(@(BSR_"(BST,ny,nx)"),"@",6)=$E(li,1,4) D 24^%ZAPM.ed.BSTM Q
 Q
43 I '$D(%DIA) S ls=" Блок не определен " D O^%ZAPM.ed.BSF7 G D
 ;ЭКРАННОЕ РЕДАКТИРОВАНИЕ ВИДИМОЙ ЧАСТИ БЛОКА !!!!
 D SCREEN^%ZAPM.ed.BSTT G D
44 G D:$D(%ZAP) I '$D(%w(5)) D PASD^%ZAPM.ed.BST1 E  G D
 S ls=" ВЫ УВЕРЕНЫ ? ЧТО ХОТИТЕ ДАННЫЕ КЛЕТКИ КОПИРОВАТЬ В БЛОК ? " D YESp^%ZAPM.ed.BSF G D:'YES S li=d,do="D SET" D BLOK^%ZAPM.ed.BSF1 I  D W^%ZAPM.ed.BST
 G D
51 S bf=1 K ^%ZAPM.ed.BSbufB(2,$G(%BS(3),$P),bf) S i=ny,j=nx D  G D
 .S ^%ZAPM.ed.BSbufB(2,$G(%BS(3),$P),bf,i,j)=@(BSR_"(BST,i,j)") F f="FTR","FCL","COL","RTR","CMD" I $D(@(BSR_"(BST,f,i,j)")) S z=$ZR,z1=$G(^(j,1)),^%ZAPM.ed.BSbufB(2,$G(%BS(3),$P),bf,f,i,j)=@z I z1'="" S ^(j,1)=z1
52 S bf=2 K ^%ZAPM.ed.BSbufB(2,$G(%BS(3),$P),bf) S do="D BUF" D BLOK^%ZAPM.ed.BSF1 G D
53 S bf=3 I $D(@(BSR_"(BST)")) S TRe1=$P($ZR,")"),TRe2="^%ZAPM.ed.BSbufB(2,"_$G(%BS(3),$P)_",3" K NOKILLER D TREE^%ZAPM.ed.BSTK
 G D
541 G SAVED^%ZAPM.ed.BSF3
542 G RESTO^%ZAPM.ed.BSF3
551 D TXTSAVB^%ZAPM.ed.BSTT G D
552 D TXTSAVA^%ZAPM.ed.BSTT G D
651 G CONT^%ZAPM.ed.BSS
652 G CONTAB^%ZAPM.ed.BSS
66 D ^%ZAPM.ed.BSMSM G D
67 D ^%ZAPM.ed.BSDOS G D
68 S lo=0 D:'$D(%CAL) CALC^%ZAPM.ed.BSF3 D CALOGIC^%ZAPM.ed.BSF3 G D
69 ;АВТОФОРМАТИРОВАНИЕ
 I $G(@BSR@(BST,"sp"))="S" D ErrMsg^%ZAPM.ed.BSXfun("РЕЖИМ ПРОВЕРКИ ФОРМАТА ДЛЯ СПИСКОВ И СВОДОК НАДО ВЫСТАВИТЬ В РЕЖИМЕ РЕДАКТИРОВАНИЯ ОПИСАНИЯ") G D
 S Tmp=$S(TIP=2:3,1:1) I $P(@BSR@(BST),"@",47) S Tmp=$P(@BSR@(BST),"@",47)
 D CHECKF^%ZAPM.ed.BSF10(Tmp) ;АВТОФОРМАТ
 G D
61 D CALC^%ZAPM.ed.BSF3 G D
610 G TITUL^%ZAPM.ed.BSF12
71 S fi=nx G FIND^%ZAPM.ed.BSS
72 S fi=0 G FIND^%ZAPM.ed.BSS
73 G FIDD^%ZAPM.ed.BSS
74 S fi=0,Tmp="Mark" G FIND^%ZAPM.ed.BSS
62 G ^%ZAPM.ed.BSS
6311 G INV^%ZAPM.ed.BSS
6312 G INVTAB^%ZAPM.ed.BSF11
6321 G DIN^%ZAPM.ed.BSS
6322 G DINTAB^%ZAPM.ed.BSF11
633 G AF2^%ZAPM.ed.BSN
634 D ButtPan^%ZAPM.ed.BSF8 G 0^%ZAPM.ed.BSTM
64 G REM^%ZAPM.ed.BSF5
ZA D CL^%ZAPM.ed.BSF4 Q
81 S i=ny,j=nx I $D(@(BSR_"(BST,i,j)")) D DEL^%ZAPM.ed.BSF1 D:$D(%CAL) CALC^%ZAPM.ed.BSF3 G D
82 S do="D DEL" D BLOK^%ZAPM.ed.BSF1 I  D W^%ZAPM.ed.BST D:$D(%CAL) CALC^%ZAPM.ed.BSF3
 G D
9 D INFO^%ZAPM.ed.BSF6 G D
1 S IYI="^%ZAPM.ed.BSHLP(GUIDE" D NE^%ZAPM.ed.BSN
D G 0^%ZAPM.ed.BSTM
d Q
P I $ZE'["<PRO" S ls=$ZE D O^%ZAPM.ed.BSF7
 S $ZT=$G(%zT) G END
0 W $$atr^%ZAPM.ed.BS3(0) Q
YESp D YES2(ls) Q
YES2(ls) N col,co S col=7,M(1,1)="  ДА  ",M(1,2)="  НЕТ  " G OK1 //OK
ER(ls) N col,co S col=9,co=8 G OKp //ERROR
OK(ls) N col,co S col=7 G OKp //OK
OKp N M,GLZ 
 S M(1,1)="  OK  "
OK1 S GLZ=$ZR,M(0,1)=$E(ls,1,70),M(0,2)=$E(ls,71,140),M(0,3)=$E(ls,141,210),Refresh=1
 S M="/"_$P(%BS,"!",col),M(0)=$P(%BS,"!",col),M(1)=$P(%BS,"!",col)_"/"_$P(%BS,"!",$G(co,3))
 S %B=$$TxtPanel^%ZAPM.ed.BSXfun1("M",0,0,$G(%B,1)) I YES=0 S R1=27
 S YES=$S(R1=27!(%B=2):0,1:1) I GLZ'[$C(34),$D(@GLZ)
 Q
YES ;ВЫБОР
 I %BS(13)'="%BS-PC" G YES1
 N M,GLZ S GLZ=$ZR,M(0,1)=$E(ls,1,70),M(0,2)=$E(ls,71,140),M(0,3)=$E(ls,141,210),M(1,1)="  ДА  ",M(1,2)="  НЕТ  "
 S M="/"_$P(%BS,"!",8),M(0)=$P(%BS,"!",8),M(1)=$P(%BS,"!",8)_"/"_$P(%BS,"!",3)
 S %B=$$TxtPanel^%ZAPM.ed.BSXfun1("M",0,0,$G(%B,1)) I YES=0 S R1=27
 S YES=$S(R1=27!(%B=2):0,1:1) I GLZ'[$C(34),$D(@GLZ)
 Q
YES1 N OO,OOO,M,%JB
 W /CUP(25,1) D 0 W /EL(0),$$clr^%ZAPM.ed.BS3(8),$E(ls,1,79) S OOO="M",OO=1,M(1,1)=" .Yes. .No. @6@ @0" 
 D 0,24^%ZAPM.ed.BSTM,^%ZAPM.ed.BSB S YES=$S(R1=27!(%B=2):0,1:1) W /CUP(25,1),/EL(0) 
 Q
EDCOPY Q:$E(BST,1)="@"  S i="@"_BST D L^%ZAPM.ed.BS3($NA(@BSR@(i))) Q:'LOC  D L^%ZAPM.ed.BS3($NA(@BSR@(BST))) I 'LOC Q
 I $D(@(BSR_"(i)")) S ls=" Существуют результаты предидущей коррекции описания таблицы. Игнорируем их ? " D YESp G:'YES EDC I YES K @(BSR_"(i)") D EDCO Q
EDCO S (BSr1,BSr2)=BSR,BSt1=BST,BSt2="@"_BST,YES=1 D COPY^%ZAPM.ed.BSTK I 'YES Q
EDC S BST="@"_BST K ^%ZAPM.ed.BSbufB("I"_$G(%BS(3),$P)_$J_"u"_%BS(15)) D W^%ZAPM.ed.BST,KLE^%ZAPM.ed.BSTM,W^%ZAPM.ed.BSTM Q
MEO S $P(@(BSR_"(BST)"),"@",7)=1 Q  ;МЕТКА О КОРРЕКЦИИ О.T.
MED S $P(@(BSR_"(BST)"),"@",6)=1 Q  ;МЕТКА О КОРРЕКЦИИ ДАННЫХ
3 D 333 G D
333 I BST["@" K NAZAD D  Q:$D(NAZAD)  K ^%ZAPM.ed.BSbufB("I"_$G(%BS(3),$P)_$J_"u"_%BS(15))
 .S ls=" Описание таблицы корректировалось ! Cохраним новое описание ? ",%B=1 D YESp S:R1=27 NAZAD=1 Q:$D(NAZAD)  I 'YES G KILL
 .I $P(@(BSR_"(BST)"),"@",17)=3!($P(@$ZR,"@",17)=4) S NOKEY=1 D TEST^%ZAPM.ed.BST3,CL^%ZAPM.ed.BSF4 G:YES Z3 D ZZ3 Q
 .I $P(@(BSR_"(BST)"),"@",17)=2 D Free^%ZAPM.ed.BSF12
 .I $P(@(BSR_"(BST)"),"@",17)=7 D SETMENU^%ZAPM.ed.BSF4($ZR)
Z3 .S @BSR@(BST,"LST")=$$h^%ZAPM.ed.BS3()_","_$G(%BS(12)) D SNX("S",$NA(@BSR@($P(BST,"@",2,99))),"TAB")
 .S ls="ПЕРЕЗАПИСЬ" D WAITS^%ZAPM.ed.BSF2 ;!!!I LONG ??????
 .I $D(@(BSR_"(BST)")) S i=$E(BST,2,99),(jj,j)=$ZR K vv,@(BSR_"(i)") S @(BSR_"(i)")=@j F  S j=$ZO(@j) Q:j=""!(j'[($P(jj,")")_","))  X WA D  S @(BSR_"(i,"_$P($P(j,"(",2),",",2,999))=g
 ..S g=@j I g["^[""" F v=2:1 Q:$P(g,"^[""",v)=""  I $P($P($P(g,"^[""",v),"""]"),",""",2)'=""  S vv($P($P($P(g,"^[""",v),"""]"),",""",2))=""
 ..Q:"""FCL""COL""RTR""KEY""FTR"""'[$P($P(j,"(",2),",",2)  Q:g'[BST  S g=@j F  S g=$P(g,BST)_$E(BST,2,99)_$P(g,BST,2,255) Q:g'[BST
 .I $ZV["MSM" I $D(vv) S v="" K vvv F  S v=$O(vv(v)) Q:v=""  F %VGI=0:1 Q:$$ZU^%ZAPM.ed.BS3(1,%VGI)=""  I v=$P($$ZU^%ZAPM.ed.BS3(1,%VGI),",",2) D INT^%SP I $G(%BS(4),"!")[$P($S($$ver^%ZAPM.ed.BSF7()="]":%SPDBNA,1:VOLDBNA),"/") S vvv(v)=$S($$ver^%ZAPM.ed.BSF7()="]":%SPDBNA,1:VOLDBNA)
KILL .K @(BSR_"(BST)") S BST=$E(BST,2,99) I '$D(vvv) K @(BSR_"(BST,""HVL"")") S $P(@(BSR_"(BST)"),"@",37)=""
 .I $D(vvv) S $P(@(BSR_"(BST)"),"@",37)=1,v="" F  S v=$O(vvv(v)) Q:v=""  S @(BSR_"(BST,""HVL"",v)")=vvv(v)
 .D U^%ZAPM.ed.BS3($NA(@BSR@("@"_BST))),U^%ZAPM.ed.BS3($NA(@BSR@(BST)))
33 K NAZAD Q:$D(NOKEY)!($D(%ZAP))  ;СОХР БД
 ;```S lo=0,$P(B,"@",48)="" D:"1"[$G(%CAL)  D COL^%ZAPM.ed.BSF3 S B=@BSR@(BST)
 S lo=$P(B,"@",48),$E(lo,1)=0,$P(B,"@",48)=lo,lo=0,gBuf=$NA(^%ZAPM.ed.BSbufB("BB"_$G(%BS(3),$P)_$J_"u"_%BS(15)))
 D:"1"[$G(%CAL)  D COL^%ZAPM.ed.BSF3 S B=@BSR@(BST)
 .D CALC^%ZAPM.ed.BSF3
 I lo S ls=" ВНИМАНИЕ !!! Есть ОШИБКИ ДАННЫХ ! Снова будем редактировать ? " D YESp I YES S NAZAD=1 Q
 Q:TIP'=2  I '$P($G(@gBuf),"@",2) D %NAm^%ZAPM.ed.BST1,U^%ZAPM.ed.BS3(%NAm) Q  ;```,FLAG(%NAm,lo) Q
 G:$P(@BSR@(BST),"@",45) ZAPIS S ls=$S($P(@BSR@(BST),"@",49):$P(@BSR@(BST),"@")_" РЕДАКТИРОВАЛСЯ.",1:"")_" Записываем в Базу Данных результаты коррекции ? "_$S(lo:"С ОШИБКАМИ !?! ",1:"") S %B=$S(lo:2,1:1) W:lo $$bel^%ZAPM.ed.BS3 D YESp I 'YES S $P(@gBuf,"@",2)=1 Q
 I lo S ls=" ЗАПИШЕМ КАРТУ БАЗЫ ДАННЫХ С "_lo_" ОШИБКАМИ ! ВЫ УВЕРЕНЫ ? ",%B=2 W $$bel^%ZAPM.ed.BS3 D YESp I 'YES S $P(@gBuf,"@",2)=1 Q
ZAPIS D %NAm^%ZAPM.ed.BST1,FOR^%ZAPM.ed.BSF3,L^%ZAPM.ed.BS3(%NAm) I 'LOC Q  //BUF 2 BD
 S %zT=$ZT,$ZT="ER333^%ZAPM.ed.BSF"
 N zapi
 I $P(B,"@",41)'="" N R1 S R1=777 D Pred^%ZAPM.ed.BSF12($P(B,"@",41)) ;ПРЕДОБР.ДО ЗАПИСИ
 X I_" D 3333" D FLAG(%NAm,lo)
 S $P(@gBuf,"@",2)=""
 I $P(B,"@",41)'="" N R1 S R1=888 D Pred^%ZAPM.ed.BSF12($P(B,"@",41)) ;ПРЕДОБР.ПОСЛЕ ЗАПИСИ
 S $ZT=$G(%zT) Q
 ;```!!!!K ^%ZAPM.ed.BSbufB("BB"_$G(%BS(3),$P)_$J_"u"_%BS(15))
FLAG(%NAm,lo,II) N I,III,BSLOGIN D U^%ZAPM.ed.BS3(%NAm)
 I $D(@($E(%NAm,1,$L(%NAm)-1)_")"))["0" S I=$$h^%ZAPM.ed.BS3() I 1
 E  S I=$P($G(@$ZR),",",5,6) I $G(I)="" S I="?,?"
 S III=$P($G(@($E(%NAm,1,$L(%NAm)-1)_")")),",",3)
 S BSLOGIN=$S($G(II):III,1:$G(%BS(12)))
 S @($E(%NAm,1,$L(%NAm)-1)_")")=$$h^%ZAPM.ed.BS3()_","_BSLOGIN_","_$S(lo:3,1:1)_","_I
 D SNX("S",$ZR,"DAT")
 Q
SNX(A,R,T) I $ZV["Cach"||($ZV["IRIS") D SNX^%ZAPM.ed.BSChT1(A,R,T)
 Q
ZZ3 S ls=" ВНИМАНИЕ !!! ОШИБКИ ТРАНСЛЯЦИИ ФОРМУЛ ! Снова будем редактировать ? " D YESp S:YES NAZAD=1 Q
ER333 D ErrMsg^%ZAPM.ed.BSXfun($ZE_" "_$$ErrSay^%ZAPM.ed.BSF8($ZE)) S $ZT=$G(%zT) S NAZAD=1 Q
]]></Routine>


<Routine name="%ZAPM.ed.BSF1" type="MAC" languagemode="0"><![CDATA[
%BSF1 ;КОРРЕКЦИЯ ОПИСАНИЯ ТАБЛИЦЫ ; 8:39   31.10.2001
BLOK N EndLoop D WAIT^%ZAPM.ed.BSF2 I '$P(@(BSR_"(BST)"),"@",3) S ls=" Блок не определен " D O^%ZAPM.ed.BSF7 X "I 0" Q
 F i=1:1 Q:'$D(@(BSR_"(BST,i)"))  X $G(WA) F j=1:1 Q:'$D(@(BSR_"(BST,i,j)"))  I $P(^(j),"@",12) X do G:$D(EndLoop) Blo
Blo I 1 Q
DEL I $P(^(j),"@",5)!($D(%ZAP)) Q
 I $P(^(j),"@",9)=1 S Tmp=$ZR D AHI("DAT",$P(^(j),"@",15)) S $P(@Tmp,"@",15)="" Q
 S $P(^%ZAPM.ed.BSbufB("BB"_$G(%BS(3),$P)_$J_"u"_%BS(15)),"@",2)=1 I $D(^%ZAPM.ed.BSbufB("BB"_$G(%BS(3),$P)_$J_"u"_%BS(15),i,j)) S Tmp1=$ZR,Tmp=@Tmp1,@Tmp1="" D:Tmp'="" AHI("DAT",Tmp)
 Q
SET I $P(^(j),"@",5)!($D(%ZAP)) Q
 I $P(^(j),"@",9)=1 S $P(^(j),"@",15)=li Q
 S $P(^%ZAPM.ed.BSbufB("BB"_$G(%BS(3),$P)_$J_"u"_%BS(15)),"@",2)=1 S ^%ZAPM.ed.BSbufB("BB"_$G(%BS(3),$P)_$J_"u"_%BS(15),i,j)=li Q
BUF S ^%ZAPM.ed.BSbufB(2,$G(%BS(3),$P),bf,i,j)=^(j) F f="FTR","FCL","COL","RTR" I $D(@(BSR_"(BST,f,i,j)")) S z=$G(@$ZR),z1=$G(@$ZR@(1)),z2=$G(^(2)) I z'="" S ^%ZAPM.ed.BSbufB(2,$G(%BS(3),$P),bf,f,i,j)=z,^(j,1)=z1 I z2'="" S ^(2)=z2
 I $D(@(BSR_"(BST,""CMD"",i,j)")) S ^%ZAPM.ed.BSbufB(2,$G(%BS(3),$P),bf,"CMD",i,j)=@$ZR
 Q
E111 S nOy=ny,nOx=nx D CLR20E S:COLORS'="" $P(@(BSR_"(BST,nOy,nOx)"),"@",10)=COLORS K nOx,nOy G D
CLR2 Q:R1=27  S $P(@(BSR_"(BST)"),"@",31)=COLORS,COLOR=COLORS Q
E112 D CLR20E,CLR1 G E111E
E114 D CLR20E,CLR2 G E111E
CLR1 Q:R1=27  S do="S $P(^(j),""@"",10)=COLORS" D BLOK Q
Color(Color) N COLORS,i,j ;Вызов палитры
 D CLR20E Q $G(COLORS)
CLR20E D SA^%ZAPM.ed.BSsBUF D  D RE^%ZAPM.ed.BSsBUF Q
 .D SI^%ZAPM.ed.BSN N (%BS,vl,%zT,%KAT,%File,COLORS,R1,Color)
 .I '$D(^%ZAPM.ed.BSbufB("CLR")) S BSr1="^%ZAPM.ed.BSS",(BSt2,BSt1)="CLR",BSr2="^%ZAPM.ed.BSbufB" D COPY^%ZAPM.ed.BSTK
 .I $D(Color) F i=1:1:8 F j=1:1:16 I $P(^%ZAPM.ed.BSbufB("CLR",i,j),"@",10)=Color S $P(^%ZAPM.ed.BSbufB("CLR","STA"),"@",7)=i+9,$P(^%ZAPM.ed.BSbufB("CLR","STA"),"@",8)=j*4+6 Q
 .S BSR="^%ZAPM.ed.BSbufB",BST="CLR" D STA^%ZAPM.ed.BST S COLORS=$S(R1=27:"",1:$P(@(BSR_"(BST,ny,nx)"),"@",10)) Q:R1=27  S ls=" Мерцание нужно ? ",%B=2 D YES^%ZAPM.ed.BSF I YES S $P(COLORS,";",2)=5 Q
E113 S d=$P(BS,"@",10),do="S $P(^(j),""@"",10)=d" D BLOK
E111E D CL^%ZAPM.ed.BSF4 D TIT^%ZAPM.ed.BST,W^%ZAPM.ed.BST G D
E72 S do="I '$D(^%ZAPM.ed.BSbufB(""f""_$G(%BS(3),$P)_$J_""u""_%BS(15),i)) S ^(i)=1" K ^%ZAPM.ed.BSbufB("f"_$G(%BS(3),$P)_$J_"u"_%BS(15)) D BLOK G D:'$T D E710 S s=0 F  S s=$O(^%ZAPM.ed.BSbufB("f"_$G(%BS(3),$P)_$J_"u"_%BS(15),s)) Q:s=""  D HSTR
 K ^%ZAPM.ed.BSbufB("f"_$G(%BS(3),$P)_$J_"u"_%BS(15)) D TAB,W^%ZAPM.ed.BST G B^%ZAPM.ed.BSTM
E710 S s=ny,(ii,li)=$P(BS,"@",3)
 S ls=" Корректируйте высоту строки" D LINE,E711 G E710:$D(ERRO) Q
A25 W /CUP(25,1),$$atr^%ZAPM.ed.BS3(0),/EL(0) Q
E71 ;ВЫСОТА КЛЕТКИ
 D E710 G D:'YES I ii'=li D HSTR,TAB,W^%ZAPM.ed.BST,KLE^%ZAPM.ed.BSTM
 G D
HSTR ;s- СТРОКА li- НОВАЯ ВЫСОТА
 I $D(@(BSR_"(BST,s,1)")) F ii=1:1 Q:'$D(^(ii))  S $P(^(ii),"@",3)=li
 Q
WinL(L) Q ($P(@BSR@(BST),"@",L)-$P(@BSR@(BST),"@",L-2)+1)
ErrWin S ERRO=1 D O^%ZAPM.ed.BSF7 Q
E711 K ERRO S li=+li I $$WinL(10)<li S ls=" Высота строки БОЛЬШЕ высоты окна" G ErrWin
 I li<1!(li>20) S ls=" Нарушение диапазона 1:20 " G ErrWin
e Q
E811 K ERRO S list=li,li=+li I $$WinL(11)<li S ls=" Длина колонки БОЛЬШЕ длины окна" G ErrWin
 I li<1!(li>77) S ls=" Нарушение диапазона 1:77 " G ErrWin
 Q
E810 S k=nx,s=ny,(ii,li)=$P(BS,"@",4)
 S ls="Корректируйте длину колонки (раздвижка: N>-справа N<-слева N<>-центрир)" D LINE,E811 G E810:$D(ERRO) Q
E82 S do="I '$D(^%ZAPM.ed.BSbufB(""f""_$G(%BS(3),$P)_$J_""u""_%BS(15),j)) S ^(j)=1" K ^%ZAPM.ed.BSbufB("f"_$G(%BS(3),$P)_$J_"u"_%BS(15)) D BLOK G D:'$T D E810 S k=0 F  S k=$O(^%ZAPM.ed.BSbufB("f"_$G(%BS(3),$P)_$J_"u"_%BS(15),k)) Q:k=""  D LSTR
 K ^%ZAPM.ed.BSbufB("f"_$G(%BS(3),$P)_$J_"u"_%BS(15)) D TAB,W^%ZAPM.ed.BST G B^%ZAPM.ed.BSTM
E81 ;ДЛИНА КОЛОНКИ
 D E810 G D:'YES I ii'=li D LSTR,TAB,W^%ZAPM.ed.BST,KLE^%ZAPM.ed.BSTM
 G D
LSTR ;k- КОЛОНКА li- НОВАЯ ДЛИНА
 F ii=1:1 Q:'$D(@(BSR_"(BST,ii,k)"))  D
 .I list[">"!(list["<")!(list["<>") D RAZ($P(^(k),"@",4),$P(^(k),"@",3),list,$P(^(k),"@",15))
 .I '(list[">"!(list["<")!(list["<>")),$E(%BS(1),10) D RAZ($P(^(k),"@",4),$P(^(k),"@",3),list_$S($E(%BS(1),10)=1:">",$E(%BS(1),10)=2:"<",1:"<>"),$P(^(k),"@",15))
 .S $P(^(k),"@",4)=li
 Q
RAZ(LO,H,LST,D) ;РАЗДВИЖКА
 N L,M,I
 Q:D=""  I $D(AFORM),$P(^(k),"@",12) Q
 F I=1:1:H S M(I)=$E(D,I*LO-LO+1,LO+(LO*(I-1)))
 I (LST-LO)>0 S L=LST-LO D  G RAZSET
 .I LST["<>" D  Q
 ..F I=1:1:H S M(I)=$$RA($$RAZS(L,1),$E(M(I),1))_M(I)_$$RA($$RAZS(L,2),$E(M(I),$L(M(I))))
 .I LST[">" F I=1:1:H S M(I)=M(I)_$$RA(L,$E(M(I),$L(M(I))))
 .I LST["<" F I=1:1:H S M(I)=$$RA(L,$E(M(I),1))_M(I)
 I (LST-LO)<0 S L=LO-LST D  G RAZSET
 .I LST["<>" D  Q
 ..F I=1:1:H S M(I)=$E(M(I),$$RAZS(L,1)+1,$L(M(I))-$$RAZS(L,2))
 .I LST[">" F I=1:1:H S M(I)=$E(M(I),1,$L(M(I))-L)
 .I LST["<" F I=1:1:H S M(I)=$E(M(I),L+1,$L(M(I)))
RAZSET S M="" F I=1:1:H S M=M_M(I)
 S $P(^(k),"@",15)=$$Cut^%ZAPM.ed.BSF10(M) Q
RAZS(W,N) ;ПОПАЛАМ
 I '(W#2) Q (W\2)
 I N=1 Q (W\2)+1
 Q (W\2)
RA(L,S) ;ПОВТОР
 I '($A(S)>178&($A(S)<220)) S S=" "
 Q $TR($J("",L)," ",S)
TAB D Wait^%ZAPM.ed.BSXfun("ФормированиеТаблицы")
TABM G:$P($ZV,"Version ",2)<4&($ZV'["Cach"&&($ZV'["IRIS")) TABm ;АВТОФОРМАТИРОВАНИЕ
 N i,j,x,y,h,l,L,H S ke=$O(@BSR@(BST,1,"&"),-1) X WA G:ke>4092 TABm
 F j=1:1:ke S $E(L,j)=$C($P(@BSR@(BST,1,j),"@",4))
 S se=$O(@BSR@(BST,"&"),-1) G:se>4092 TABm X WA F i=1:1:se S $E(H,i)=$C($P(@BSR@(BST,i,1),"@",3))
 F i=1:1:se S y=$S('$D(y):1,1:y+h),h=$A($E(H,i)) D  K x I '(i#50) X WA
 .F j=1:1:ke S x=$S('$D(x):1,1:x+l),l=$A($E(L,j)),$P(@BSR@(BST,i,j),"@",1,2)=y_"@"_x
 S $P(@BSR@(BST),"@",28)=se,$P(@$ZR,"@",29)=ke
SaveM I $G(@BSR@(BST,"SVM"))'="" D XM^%ZAPM.ed.BSre(@$ZR)
 Q
TABm ;```СТАРЫЙ МОДУЛЬ
 N x,y,h,l F i=1:1 Q:'$D(@(BSR_"(BST,i)"))  S y=$S('$D(y):1,1:y+h),h=$P(@(BSR_"(BST,i,1)"),"@",3) D  K x I '(i#50) X $G(WA)
 .F j=1:1 Q:'$D(@(BSR_"(BST,i,j)"))  S Tmp=@$ZR,x=$S('$D(x):1,1:x+l),$P(Tmp,"@",2)=x,$P(Tmp,"@")=y,l=$P(Tmp,"@",4) S:$D(TSV)&($P(Tmp,"@",15)=0) $P(Tmp,"@",15)="" S ^(j)=Tmp
 K x,y,l,h S $P(@(BSR_"(BST)"),"@",28)=i-1,$P(@$ZR,"@",29)=j-1
 G SaveM
 Q
LINE ;КОРРЕКЦИЯ СТРОКИ
 S ll="@# " D LE^%ZAPM.ed.BSTT I YES
 Q  ;I 1 Q
LIF X "I 0" Q
LINF N say1,say2 S say1=ls,say2=%hlp ;КОРРЕКЦИЯ ФУНКЦИЙ *
LINEFUN S ll="" D LE^%ZAPM.ed.BSTT I YES D E1F I 'YES S ls=say1,%hlp=say2 G LINEFUN
 Q  ;I 1 Q
E41 S i=$P(BS,"@",9),k=$S(i=1:2,1:1) D:k=2 BDCN I YES S $P(@(BSR_"(BST,ny,nx)"),"@",9)=k G D
 G D
E421 S k=1 G E4
E422 S k=2 D BDCN I 'YES G D
E4 S do="S $P(^(j),""@"",9)=k" D BLOK I  D W^%ZAPM.ed.BST
D G 0^%ZAPM.ed.BSTM
BDCN I '$D(BSCN) S YES=0 I $G(@(BSR_"(BST,""KEY"")"))'["^" S ls=" ВАША ТАБЛИЦА БУДЕТ ПРИКРЕПЛЯТЬСЯ К КАКОЙ-НИБУДЬ БАЗЕ ДАННЫХ ? " D YES^%ZAPM.ed.BSF I 'YES Q
 S YES=1,BDCN=1 Q
E61 S i=$P(BS,"@",5),$P(@(BSR_"(BST,ny,nx)"),"@",5)=$S(i=1:"",1:1) G D
E621 S k="" G E6
E622 S k=1
E6 S do="S $P(^(j),""@"",5)=k" D BLOK G D
E631 S k="" G E6A
HIS(f) S %HIS=$NA(^%ZAPM.ed.BSbufB("HIStory"_f_$S('$E(%BS(1),12):$G(%BS(3),$P)_$G(%BS(12)),$E(%BS(1),12)=1:"1"_$G(%BS(12)),1:"1")))
 Q
AHI(f,d) Q:d=""  N %HIS D HIS(f) D AddHist^%ZAPM.ed.BSXuse(%HIS,"Удалено{"_ny_","_nx_","_BST_"}="_d)
 Q
E632 S k=1
E6A S do="S $P(^(j),""@"",5)=k" D ALLT^%ZAPM.ed.BSS1 G D
EE11 S li1=$G(@(BSR_"(BST,f,ny,nx)")),li=$G(^(nx,1)) I li="" S li=$P($G(@BSR@(BST,ny,nx)),"@",$S(f="FCL":7,f="FTR":8,f="COL":13,1:16)) Q
 Q
E11 S f="FCL" D EE11,HIS(f) S YES=0,%hlp="^%ZAPM.ed.BSHLP(200",ls=" Вводите / Корректируйте формулу вычисления в клетке {"_ny_","_nx_"}. Помощь-F1" D LINF I YES S i=ny,j=nx D E1Z D:$D(%CAL) CALC^%ZAPM.ed.BSF3
 G D
E141 S f="COL" D EE11,HIS(f) S YES=0,%hlp="^%ZAPM.ed.BSHLP(203",ls=" Вводите / Корректируйте формулу логического контроля (F1)" D LINF I YES S i=ny,j=nx D E1Z
 G D
E142 S f="COL",do="D E1Z" D EE11,BLOK I  D W^%ZAPM.ed.BST
 G D
E143 D TXTLOG^%ZAPM.ed.BSF8 G D
E12 S f="FCL",do="D E1Z",ft=$P(BS,"@",7) D EE11 I li1'="" D Yes^%ZAPM.ed.BSXfun("Формулу ТРАНСЛИРОВАТЬ ?",2) I YES D CalcTran^%ZAPM.ed.BSF10(li)
 D BLOK I  D W^%ZAPM.ed.BST
 G D
E1zz S ny=i,nx=j,Oli=li,Oli1=li1 X "S Tmp="_TAR S li=$$TR^%ZAPM.ed.BSsFUNM(li,SOU,Tmp),li1=$$TR^%ZAPM.ed.BSsFUNM(li1,SOU,Tmp) D E1Z S li=Oli,li1=Oli1 Q
E1Z I li'="" S:li'?.N1",".N @(BSR_"(BST,f,i,j)")=li1,^(j,1)=li,$P(@(BSR_"(BST,i,j)"),"@",$S(f="FCL":7,f="FTR":8,f="COL":13,1:16))=$S(f="FCL":$G(ft,1),1:0) D:li?.N1",".N  G 23
 .K @(BSR_"(BST,f,i,j)") S $P(@(BSR_"(BST,i,j)"),"@",$S(f="FCL":7,f="FTR":8,f="COL":13,1:16))=li S:"FCLCOL"[f $P(@(BSR_"(BST)"),"@",$S(f="FCL":32,1:33))=1 D C11 Q
 E  K @(BSR_"(BST,f,i,j)") S $P(@(BSR_"(BST,i,j)"),"@",$S(f="FCL":7,f="FTR":8,f="COL":13,f="RTR":16,1:7))="" D C11
23 D 24^%ZAPM.ed.BSTM Q
C11 Q:f'="COL"  S $P(@(BSR_"(BST,i,j)"),"@",11)="" Q
E1F ;СИНТ & ЛОГ КОНТРОЛЬ ФОРМУЛ И ФУНКЦИИ ЛОГИКИ
 S YES=1 Q:li=""  Q:li&($P(li,","))&($P(li,",",2))&('$P(li,",",3))  G ^%ZAPM.ed.BSFTF ;!!!
E21 S f="FTR" D EE11,HIS(f) S YES=0,%hlp="^%ZAPM.ed.BSHLP(201",ls=" Вводите / Корректируйте функцию трансформации (F1)" D LINF I YES S i=ny,j=nx D E1Z
 G D
E22 S f="FTR",do="D E1Z" D EE11,BLOK I  D W^%ZAPM.ed.BST
 G D
E17 D POST^%ZAPM.ed.BSF9 G D
E161 S f="RTR" D EE11,HIS(f) S YES=0,%hlp="^%ZAPM.ed.BSHLP(204",ls=" Корректируйте функцию синтаксического контроля на ввод данных (F1)" D LINF I YES S i=ny,j=nx D E1Z
 G D
E162 S f="RTR",do="D E1Z" D EE11,BLOK I  D W^%ZAPM.ed.BST
 G D
E91 G E91^%ZAPM.ed.BSF2
E52 G EXPORT^%ZAPM.ed.BSBL1
E531 s YES=$$Dbf2Tab^%ZAPM.ed.BSXdbf1()
 i YES=0 d CopySons^%ZAPM.ed.BSXfun1(BSR,BST,$E(BST,2,$L(BST))) s YES=-4
 i YES=-4 g 100^%ZAPM.ed.BSF k @(BSR_"(BST)")
 G D
E532 D In^%ZAPM.ed.BSXdbf1($NA(@BSR@(BST)),0) G D
E533 D In^%ZAPM.ed.BSXdbf1($NA(@BSR@(BST)),1) G D
E54 G EXPORTXT^%ZAPM.ed.BSBL1
  G 10^%ZAPM.ed.BSF
E92 G E92^%ZAPM.ed.BSF2
E10 G E10^%ZAPM.ed.BSTK ;КЛЮЧИ
E131 G E131^%ZAPM.ed.BSF2
E132 G E132^%ZAPM.ed.BSF2
E133 G E133^%ZAPM.ed.BSS2
E134 G E134^%ZAPM.ed.BSS2
E1351 G E1351^%ZAPM.ed.BSS2
E1352 G E1352^%ZAPM.ed.BSS2
E1353 G E1353^%ZAPM.ed.BSS2
E1354 G E1354^%ZAPM.ed.BSS2
E136 K @(BSR_"(BST,""DBF"")") G D
E137 S do="S ls=$P(^(j),""@"",15),li=$$ClearSpc^%ZAPM.ed.BSF7(ls) I li'=ls S $P(^(j),""@"",15)=li" D BLOK G D
E138 G D:TIP'=8 K @BSR@(BST,"BUT") S TIP=1,$P(@BSR@(BST),"@",17)=1 G D
E311 D XBD^%ZAPM.ed.BSS1 G D
E312 D PRI^%ZAPM.ed.BSS1 G D
E321 D OUT^%ZAPM.ed.BSS1 G D
E322 D BLK^%ZAPM.ed.BSS1 G D
E323 D SSS^%ZAPM.ed.BSS1 G D
E34 D EDIT^%ZAPM.ed.BSIND G D
E121 D TAB^%ZAPM.ed.BSF3 G D
E122 D CMD^%ZAPM.ed.BSF3 G D
E123 D COPYCMD^%ZAPM.ed.BSF8 G D
E171 S sr=1 G E170 ;?
E172 S sr=2 G E170
E173 S sr=3
E170 G SHR^%ZAPM.ed.BSSR
]]></Routine>


<Routine name="%ZAPM.ed.BSF10" type="MAC" languagemode="0"><![CDATA[
%BSF10 ; РАБОТА С КЛЮЧАМИ И etc ; 14:57   13.01.2003
 Q
CHECKF(Fo) D Yes^%ZAPM.ed.BSXfun("Формат ДАННЫХ В ТАБЛИЦЕ проверять ?",2) Q:YES<1
 N i,j,A,K D Wait^%ZAPM.ed.BSXfun("ПРОВЕРКА ФОРМАТА ДАННЫХ В ТАБЛИЦЕ")
 S i="",K=0,A=","_$$GLRET^%ZAPM.ed.BSF12($NA(@BSR@(BST,"AFO")))
 F  S i=$O(@BSR@(BST,i)) Q:'i  F j=1:1 S j=$O(@BSR@(BST,i,j)) Q:'j  D
 .I Fo="3",$P(@BSR@(BST,i,j),"@",9)=2 D CHEC($G(^%ZAPM.ed.BSbufB("BB"_$G(%BS(3),$P)_$J_"u"_%BS(15),i,j))) Q
 .I Fo["1",$P(@BSR@(BST,i,j),"@",7) D CHEC($P(@BSR@(BST,i,j),"@",15))
 .I Fo["2",(A[(","_j_",")),$G(@BSR@(BST,i)) D CHEC($P(@BSR@(BST,i,j),"@",15))
 I K D Yes^%ZAPM.ed.BSXfun("Найдено "_K_" нарушений формата ! Делаем АвтоРаздвижку колонок ?",2) I YES D AFOR Q
 Q
CHEC(d) X WA
 I $L(d)>($P(@BSR@(BST,i,j),"@",3)*$P(@BSR@(BST,i,j),"@",4)) S $P(@BSR@(BST,i,j),"@",12)=1,K=K+1
 Q
AFOR ;АВТОФОРМАТ
 N S,K,k,li,list,do,AFORM
 S k="",do="S S=$L($P(^(j),""@"",15)) S:S>$G(K(j),0) K(j)=S",$P(@BSR@(BST),"@",3)=1
 I Fo["3" S do="S S=$L($G(^%ZAPM.ed.BSbufB(""BB""_$G(%BS(3),$P)_$J_""u""_%BS(15),i,j))) S:S>$G(K(j),0) K(j)=S"
 D BLOK^%ZAPM.ed.BSF1 S AFORM=1
 F  S k=$O(K(k)) Q:'k  S li=K(k),list=li_">" D LSTR^%ZAPM.ed.BSF1
 D TAB^%ZAPM.ed.BSF1,TIT^%ZAPM.ed.BST,W^%ZAPM.ed.BST
 Q
XEC(BD,EV) ;ВЫПОЛНЕНИЕ М-ПРОЦЕССОВ
 N i,ii
 S %zT=$ZT,$ZT="ERXEC^%ZAPM.ed.BSF10"
 I '$$Data^%ZAPM.ed.BSF12(BD) Q
 S i="",ii=$ZR F  S i=$O(@ii@(i)) Q:i=""  I $G(@ii@(i,"5,4"))=EV,$G(@ii@(i,"7,4"))'="" D XEC^%ZAPM.ed.BSTT(@ii@(i,"7,4"))
 Q
ERXEC ;I $ZE'["NO" D ErrMsg^%ZAPM.ed.BSXfun($$ErrSay^%ZAPM.ed.BSF8($ZE))
 W $$bel^%ZAPM.ed.BS3 S $ZT=$G(%zT) Q
DEL(G,T) ;УДАЛЕНИЕ СЕКРЕТНОЕ
 N ZR
 I $D(@G)=0 Q
 S A=$P($G(^%ZAPM.ed.BSETUP("SERVER",6,4)),"@",15)       I $P(A,"\",+T)="Y" D Copy^%ZAPM.ed.BSF8(254,G,1,"затираем перед удалением "_G)
 ;ПРОТОКОЛИРОВАНИЕ УДАЛЕНИЯ УЗЛОВ
 D Tex^%ZAPM.ed.BSMSMF("KillNode :"_G,$G(@G@("LST")))
 K @G D SNX^%ZAPM.ed.BSF("K",G,"DAT")
 Q
SPIS ;ВХОД В СПИСОК
 Q:TIP'=3  Q:$P(@$ZR,"@")["ПУСТО"
 ;```СТАРОЕ```I $D(ZPN),ZPN'="",$D(BSrz),$P($G(@BSrz@(BStz,"ZPR",ZPN)),"@",5) S nx=$P($G(@BSrz@(BStz,"ZPR",ZPN)),"@",5) S B=@BSR@(BST),IntSort=1 D CALC^%ZAPM.ed.BSF3,^%ZAPM.ed.BSS K IntSort
SPI D ^%ZAPM.ed.BST
 Q
CalcTran(FO) ;ТРАНСЛЯЦИЯ ФОРМУЛ
 N ls,li,li1
 S YES=1,ls="Какой контекст в формуле транслировать ?",li=FO D LE^%ZAPM.ed.BSTT Q:'YES  Q:li=""  I FO'[li D ErrMsg^%ZAPM.ed.BSXfun("ВАШ КОНТЕКСТ НЕ ВХОДИТ В ФОРМУЛУ !") S YES=0 Q
 S SOU=li,ls="Введите формулу трансляции (ny,nx- ТЕКУЩИЕ НОМЕРА КЛЕТОК)",li="" D LE^%ZAPM.ed.BSTT Q:'YES  Q:li=""  I '(li["ny"!(li["nx")) D ErrMsg^%ZAPM.ed.BSXfun("В ФОРМУЛУ НЕ ВХОДИТ ny nx ???!!!") S YES=0 Q
 S TAR=li X "S Tmp="_TAR S do="D E1zz" Q
LOG ;ЛОГИЧЕСКИЙ КОНТРОЛЬ
 I key=0 S ls=" ИМЕННОЙ КЛЮЧ КОНТРОЛИРОВАТЬ НЕЛЬЗЯ " G O
 I key'=endkey S ls=" ВЫ ХОТИТЕ КОНТРОЛИРОВАТЬ КЛЮЧИ НЕ ПОСЛЕДНЕГО УРОВНЯ !" G O
 I '$D(%DIA) S ls=" НЕ ПОМЕЧЕНЫ КОНТРОЛИРУЕМЫЕ КЛЮЧИ " G O
 K ^%ZAPM.ed.BSbufB("LOGS"_$G(%BS(3),$P)_$J_$P($$ZU^%ZAPM.ed.BS3(1,0),",",2)_"u1"),^%ZAPM.ed.BSbufB("VarLogS"_$G(%BS(3),$P)_$J_"u1")
 S do="D:i>3 LO^%ZAPM.ed.BSF10(i)" D BLOK^%ZAPM.ed.BSF1
 I '$D(^%ZAPM.ed.BSbufB("LOGS"_$G(%BS(3),$P)_$J_$P($$ZU^%ZAPM.ed.BS3(1,0),",",2)_"u1")) D OkMsg^%ZAPM.ed.BSXfun("ОШИБОК НЕ НАЙДЕНО") G ENDD
 S I="LOGS"_$G(%BS(3),$P)_$J_$P($$ZU^%ZAPM.ed.BS3(1,0),",",2)_"u1",IYI="^%ZAPM.ed.BSbufB,"_I D NE^%ZAPM.ed.BSN K ^%ZAPM.ed.BSbufB("LOGS"_$G(%BS(3),$P)_$J_$P($$ZU^%ZAPM.ed.BS3(1,0),",",2)_"u1"),^%ZAPM.ed.BSbufB("VarLogS"_$G(%BS(3),$P)_$J_"u1")
ENDD K l,j,TRe1,TRe2,ii,%iii,NOKILLER,KILLER S R1=27 Q
SUU(%iii) S %NAm=$$BSD^%ZAPM.ed.BSA(BSD,$G(%KEYS(0))) F ii=1:1:key-1 Q:'$D(%KEYS(ii))  S %NAm=%NAm_$S(%KEYS(ii)=+%KEYS(ii):%KEYS(ii),1:$C(34)_%KEYS(ii)_$C(34))_","
 I key=0 S %NAm=BSD_%iii Q
 S %NAm=%NAm_$S(%iii=+%iii:%iii,1:$C(34)_%iii_$C(34))_","
 Q
LO(uzel) ;МОДУЛЬ КОНТРОЛЯ
 S uzel=$P(@BSR@(BST,uzel,1),"@",15)
 N (IMQ,uzel,%BS,vl,BSD,%KEYS,key)
 S BST=$P(IMQ,",",$L(IMQ,",")),BSR=$P(IMQ,",",1,$L(IMQ,",")-1)
 D TIP^%ZAPM.ed.BST,SUU(uzel)
 D BSDv^%ZAPM.ed.BST1 ;БУФЕР
 D COL^%ZAPM.ed.BSF3 I $G(lo) D FLAG^%ZAPM.ed.BSF(%NAm,lo,1)
 Q
O D O^%ZAPM.ed.BSF7
D K KILLER G 0^%ZAPM.ed.BSTM
STRUKT ;ПРЕДОБРАБОТКА ДЛЯ СТРУКТУРИРОВАННОГО КОДИФИКАТОРА
 I R1=27,R2=79,R3=89,$D(IMQ) D  ;F10
 .S (date,%BS("Tmp","EXIToutBD",IMQ))=$S(ny<3:"",1:d)
 .S R1=27,(R3,R2)=-1
 Q
IYI(IYI) N BSR,BST
 S BSR=$P(IYI,",",1,$L(IYI,",")-1),BST=$P(IYI,",",$L(IYI,",")) S:BSR'["^" BSR="^"_BSR
 Q $G(@BSR@(BST))
ChP(I) Q:$ZV["Cach"||($ZV["IRIS")
 N ChP S %zT=$ZT,$ZT="CP^%ZAPM.ed.BSF10" ;ПЕРЕОПРЕДЕЛЕНИЕ ТЕКУЩЕГО КАТАЛОГА
 I $D(%BS("Tmp","ChPath")) D  K %BS("Tmp","ChPath") Q
 .I $$ZOS1^%ZAPM.ed.BSDOS($P(%BS("Tmp","ChPath"),":"))
 .I $$ZOS8^%ZAPM.ed.BSDOS(%BS("Tmp","ChPath"))
 I $D(@$P(^%ZAPM.ed.BSS("USER","KEY"),"@")) S ChP=$NA(@$ZR@($S($G(%BS(12))="":"?",1:%BS(12)),2,$S(I=1:"IN",1:"OUT"))) S ChP=$O(@ChP@("")) D
 .I $$ZOS1^%ZAPM.ed.BSDOS($P(ChP,":"))
 .I $$ZOS8^%ZAPM.ed.BSDOS(ChP)
 Q
CP S $ZT=$G(%zT) Q
CutS(S) Q $$Cut($$Cut(S,0),1)
Cut(s,N) N i I $G(N) f i=1:1:$L(s) I $E(s,i)'=" "  S N=$L(s) Q
 I '$G(N) f i=$L(s):-1:0 I $E(s,i)'=" "  S N=i,i=1 Q
 Q $E(s,i,N)
TreeCopy ;ПРЕДОБРАБОТКА ДЛЯ УЗЛОВ БД
 N dd,N,NN
 I $E(%BS(1),17),R1=127 S R1=27,R2=79,R3=87 Q  ;DEL=F8
 I R1=0,R2=23 N EndINDi S EndINDi=1 D B1^%ZAPM.ed.BSBD S R1=-2 Q  ;ALT-I
 I R1=0,R2=98,R3=-1,ny>2 D  S R1=-2 Q  ;КОПИ В БУФЕР   SH-F5
 .K ^%ZAPM.ed.BSbufB(2,$G(%BS(3),$P),11)
 .D %NAm S TRe1=$NA(@(N_$S(d=+d:d,1:$C(34)_d_$C(34))_")")),TRe2=$NA(@("^%ZAPM.ed.BSbufB(2,$G(%BS(3),$P),11)")) D Copy^%ZAPM.ed.BSF8(TRe1,TRe2,1,1)
 .S ^%ZAPM.ed.BSbufB(2,$G(%BS(3),$P),12)=key_","_endkey,^%ZAPM.ed.BSbufB(2,$G(%BS(3),$P),12,1)=d
 .D OkMsg^%ZAPM.ed.BSXfun("Узел "_TRe1_" скопирован в Буфер") Q
 ;
 I R1=0,R2=99,R3=-1,ny>2 D  S R1=-2 Q  ;КОПИ ИЗ БУФЕРА    SH-F6
 .I '$D(^%ZAPM.ed.BSbufB(2,$G(%BS(3),$P),11)) D ErrMsg^%ZAPM.ed.BSXfun("Буфер Пуст") Q
 .I key'=($P(^%ZAPM.ed.BSbufB(2,$G(%BS(3),$P),12),",")-1) D ErrMsg^%ZAPM.ed.BSXfun("Команду можно выполнить на "_($P(^%ZAPM.ed.BSbufB(2,$G(%BS(3),$P),12),",")-1)_" Уровне") Q
 .D %NAm S dd=$G(^%ZAPM.ed.BSbufB(2,$G(%BS(3),$P),12,1)) I dd="" D ErrMsg^%ZAPM.ed.BSXfun("Буфер Пуст") Q
 .S NN=$NA(@(N_$S(d=+d:d,1:$C(34)_d_$C(34))_","_$S(dd=+dd:dd,1:$C(34)_dd_$C(34))_")"))
 .I $D(@NN) D Yes^%ZAPM.ed.BSXfun("Узел ("_$P(NN,"(",2,99)_") Уже существует !!! Перезапишем ?",2) Q:'YES  K @NN
 .D Copy^%ZAPM.ed.BSF8($NA(@("^%ZAPM.ed.BSbufB(2,$G(%BS(3),$P),11)")),NN)
 .D OkMsg^%ZAPM.ed.BSXfun("Перезаписали...,"_d_")") Q
 Q
%NAm S N=$$BSD^%ZAPM.ed.BSA(BSD,$G(%KEYS(0))) I '$D(%KEYS) Q
 F ii=1:1:key-1 Q:'$D(%KEYS(ii))  S N=N_$S(%KEYS(ii)=+%KEYS(ii):%KEYS(ii),1:$C(34)_%KEYS(ii)_$C(34))_","
 Q
OB ;ОБОИ ТАБЛИЦЫ
 S l4=19,Xx=nx,Yy=ny,$P(@(BSR_"(BST,ny,nx)"),"@",19)=$P(@(BSR_"(BST)"),"@",46) D TAB2^%ZAPM.ed.BSF3 S l4=$P(@(BSR_"(BST,Yy,Xx)"),"@",19),$P(@$ZR,"@",19)="" D R^%ZAPM.ed.BSF4(46,l4) K l4,Xx,Yy Q
OBWRITE ;ЗАВСЕТКА ОБОЕВ
 S %zT=$ZT,$ZT="ERR^%ZAPM.ed.BSF10"
 N T,C,I S T=$P(B,"@",46),ObOi=$P($P(@T,"@",31),"/",5),C=$P(@T,"@",8,11) W $$atr^%ZAPM.ed.BS3(ObOi)
 F I=$P(C,"@",1):1:$P(C,"@",4) W /CUP(I,$P(C,"@",2)),$G(@T@(I-$P(C,"@",1)+1)),$J("",$P(C,"@",4)-$P(C,"@",2)+1-$L($G(@T@(I-$P(C,"@",1)+1))))
 Q
ERR W $$bel^%ZAPM.ed.BS3 S $ZT=$G(%zT) Q
PDM(U) ;МОДУЛЬ МЕНЮ 1 УРОВЕНЬ
 Q:R1>332
 G PD2:U=2
 I $G(%BS("Tmp","PallDown"))=2 D  S %BS(2)=%BS("Tmp","PallDown",2) K %BS("Tmp","PallDown") Q
 .S R1=13,(R2,R3)=-1
 I $G(%BS("Tmp","PallDown"))=1 D  S %BS("Tmp","PallDown")=2 ;Q
 .I $D(%BS("Tmp","PallDown",1)) S R1=27,R2=91,R3=%BS("Tmp","PallDown",1) Q
 I R1=27,R2=91,R3=66 S R1=13,(R2,R3)=-1 Q  ;DOWN
 I R1=27,R2=91,R3=68,nx=1 K %EN S R1=0,R2=79 Q
 I R1=27,R2=91,R3=67,nx=ke K %HO S R1=0,R2=71 Q
 Q
PD2 ;  2 УРОВЕНЬ
 I R1=27,R2=91,R3=67 D PD1(R3) S R1=27,(R2,R3)=-1 Q  ;--->
 I R1=27,R2=91,R3=68 D PD1(R3) S R1=27,(R2,R3)=-1 Q  ;<---
 Q
PD1(R) S %BS("Tmp","PallDown")=1,%BS("Tmp","PallDown",1)=R
 S %BS("Tmp","PallDown",2)=%BS(2),%BS(2)=0 Q
]]></Routine>


<Routine name="%ZAPM.ed.BSF11" type="MAC" languagemode="0"><![CDATA[
%BSF11 ; ДОПОЛНИТЕЛЬНЫЕ ПРОВЕРКИ ; 11:45   04.05.2001
 Q
COP2L(si,st) ;КОПИРОВАНИЕ СТРОКИ si В ЛОКАЛЬ
 S bsr="BUF"
 I $D(@BSR@(BST,si,1)) F kj=1:1 Q:'$D(@BSR@(BST,si,kj))  S @bsr@(BSt,st,kj)=@$ZR D
 .I 'fo F f="FCL","FTR","COL" S $P(@bsr@(BSt,st,kj),"@",$S(f="COL":13,f="FCL":7,f="RTR":16,1:8))=""
 .I fo D
 ..I "2345"'[$P(@BSR@(BST,si,kj),"@",7),$D(@BSR@(BST,"FCL",si,kj)) S @bsr@(BSt,"FCL",st,kj)=@$ZR
 ..I $D(@BSR@(BST,"FTR",si,kj)) S @bsr@(BSt,"FTR",st,kj)=@$ZR
 ..I '$P(B,"@",27) I $D(@BSR@(BST,"COL",si,kj)) S @bsr@(BSt,"COL",st,kj)=@$ZR D
 ...I $D(@BSR@(BST,"COL",si,kj,1)) S @bsr@(BSt,"COL",st,kj,1)=@$ZR
 Q
COPY(si) ;КОПИРОВАНИЕ СТРОКИ si ИЗ ЛОКАЛИ
 S St=St+1 X WA F kj=1:1 Q:'$D(@bsr@(BSt,si,kj))  S @(BSr_"(BSt,St,kj)")=@bsr@(BSt,si,kj) D
 .I 'fo F f="FCL","FTR","COL" S $P(@$ZR,"@",$S(f="COL":13,f="FCL":7,f="RTR":16,1:8))=""
 .I fo D
 ..F f="FCL","FTR" I $D(@bsr@(BSt,f,si,kj)) S @(BSr_"(BSt,f,St,kj)")=@bsr@(BSt,f,si,kj)
 ..I '$P(B,"@",27) I $D(@bsr@(BSt,"COL",si,kj)) S @BSr@(BSt,"COL",St,kj)=@bsr@(BSt,"COL",si,kj) D
 ...I $D(@bsr@(BSt,"COL",si,kj,1)) S @BSr@(BSt,"COL",St,kj,1)=@bsr@(BSt,"COL",si,kj,1)
 Q
LASTHIS(key,ny) N %HIS D HIS^%ZAPM.ed.BSF1($$NHIS()) Q $D(@%HIS@(1))
INSERT(key,ny) N %HIS D HIS^%ZAPM.ed.BSF1($$NHIS()) Q $G(@%HIS@(1))
NHIS() Q "TabelKey"_key_"String"_ny
PREDTEMP ;ПРЕДОБРАБОТКА ВЫБОРКИ ДЛЯ КЛЮЧЕЙ
 Q:R1>332
 I R1=13 D  Q  ;ЗАПИСЬ В ИСТОРИЮ
 .I d'["#",key'=0 Q:ny>4
 .D AddHist($$NHIS(),d)
 I R1=27,R2=91,R3=68!(R3=67) D  ;ЗАСВЕТКА СПИСКА ИСТОРИЙ
 .N %HIS,TTT D HIS^%ZAPM.ed.BSF1($$NHIS()) S TTT=$P($P(%HIS,"(",2),$C(34),2)
 .s Tmp=$$History^%ZAPM.ed.BSXfun("^%ZAPM.ed.BSbufB",TTT) I Tmp=""!(YES<1) S R1=-2 Q
 .S d=Tmp,R1=0,R2=18 Q
 I ny>4,R1>31,R2=-1,R3=-1 S R1=-4,li=$P($G(@BSR@(BST,ny,2)),"@",15)_"#"_$P($G(@BSR@(BST,"COL",ny,3)),"I ",2,99)
 Q
AddHist(f,d) Q:d=""  N %HIS D HIS^%ZAPM.ed.BSF1(f) D AddHist^%ZAPM.ed.BSXuse(%HIS,d)
 Q
SETEMP ;ВРЕМЕННАЯ ВЫБОРКА
 S ^%ZAPM.ed.BSbufB("KCH"_$G(%BS(3),$P)_$J_"u"_%BS(15),COMP,key,3)="I "_$P(d,"#",2,999)
 S ^%ZAPM.ed.BSbufB("KCH"_$G(%BS(3),$P)_$J_"u"_%BS(15),COMP,key,4)="TXTC#"_$P(d,"#")
 Q
CREA(F) ;ФОРМУЛА НА БОКОВИНУ
 N FF
 I F["LongString" S F=$$GLRET^%ZAPM.ed.BSF12(F)
 I F["$$TSV" X "S FF="_F
 I F'["$$TSV" S FF="I "_F
 Q FF
TSVV(kod) Q "I "_kod
CREAT(M,Y,X,RA,EN) D Wait^%ZAPM.ed.BSXfun("КОПИРОВАНИЕ М\ЗАПРОСОВ В СВОДКУ")
 G creat:$E(SVo,1)=0
 N si,MM,fo,MMM,bsr,BUF
 S MM="",MMM=Y,fo=1 K SP(5) D COP2L(Y,1) S fo=0 D COP2L(RA,2)
 F  S MM=$O(@M@(1,MM)) Q:MM=""  D  S MMM=MMM+2
 .S Tmp=$$GLRET^%ZAPM.ed.BSF12($NA(@M@(1,MM))),fo=1 D COPY(1) S @BSr@(BSt,St)=1,n(MMM)=n,n=n+1 D  F C=2:1:COMP D COPY(1) S @BSr@(BSt,St)=C,$P(@BSr@(BSt,St,TSVV),"@",15)=""
 ..S $P(@BSr@(BSt,St,TSVV),"@",15)=$P(Tmp,"@")
 ..S SP(5,MMM)=$$CREA($P(Tmp,"@",2,9999))
 .I $O(@M@(1,MM))'="" S fo=0 D COPY(2)
 S si=EN,fo=0 D COP^%ZAPM.ed.BSSV
 Q
creat ;КОПИРОВАНИЕ М\ЗАПРОСОВ В СВОДКУ (СТАРЫЙ ВАРИАНТ)
 N si,MM,fo,MMM
 S MM="",MMM=Y K SP(5)
 F  S MM=$O(@M@(1,MM)) Q:MM=""  D  S MMM=MMM+2
 .S si=Y,fo=1 D COP^%ZAPM.ed.BSSV S @BSr@(BSt,St)=1,n(MMM)=n,n=n+1 D  F C=2:1:COMP D COP^%ZAPM.ed.BSSV S @BSr@(BSt,St)=C,$P(@BSr@(BSt,St,TSVV),"@",15)=""
 ..S $P(@BSr@(BSt,St,TSVV),"@",15)=$P(@M@(1,MM),"@")
 ..S SP(5,MMM)=$$CREA($P(@M@(1,MM),"@",2,999))
 .I $O(@M@(1,MM))'="" S si=RA,fo=0 D COP^%ZAPM.ed.BSSV
 S si=EN,fo=0 D COP^%ZAPM.ed.BSSV
 Q
CHO(MM,NO,x,zz) ;ВЫБОР
 N M,BSr,BSt,Fk,se,Obraz
 S YES=1,%zT=$ZT,$ZT="ERMA^%ZAPM.ed.BSF11"
 D TempT^%ZAPM.ed.BSTT
 F M=1:1 Q:$P(MM,"@",M)=""  D TempTX^%ZAPM.ed.BSTT($P(MM,"@",M)_" "_$P($G(@$P(MM,"@",M)),"@",2))
 D TempTXT^%ZAPM.ed.BSTT("<<< Выберите БОКОВИНУ для сводки >>>",$G(@%BS(20)@("ErrorTXT")))
 d ^%ZAPM.ed.BSX("TEXT",BSr,BSt) Q:YES<1
 S M=YES I YES D Yes^%ZAPM.ed.BSXfun("Будем УТОЧНЯТЬ БОКОВИНУ ?",2) S Tmp=YES,YES=1 I Tmp D TEMPZAPR($P(MM,"@",M))
 S $P(@x,"#",9)=$P(MM,"@",M),$P(@x,"#",10)=NO
 ;```???```I $D(NZP),$D(@BSR@(BST,"ZPR",NZP,0)) S $P(@$ZR,"#",9)=$P(MM,"@",M),$P(@$ZR,"#",10)=NO
 Q
TEMPZAPR(GL) ;РАЗОВЫЕ М-ЗАПРОСЫ
 N TG,TT,BSR,BST,BSr,BSt,IntTmp,i,j,s1,s2,s6i,l1,l2,col,ke,Fk,tIT,IYI,txt,kod,%INV1,%INV2
 N k1,k2,k3,k4,k5,k6,k7,k8,k9,%INV,Tmp,Shab
 S TT=$$TMPG^%ZAPM.ed.BSF11,BSR=$P(TT,"("),BST=$P($P($P(TT,"(",2),")"),$C(34),2),IntTmp=1
 S Shab="^%ZAPM.ed.BSS(""OPout"")" I $D(zz),$$Data^%ZAPM.ed.BSF12(zz) S Shab=zz
 S @BSR@(BST)=@Shab
 S s1="dinamo",Fk="",Tmp=0
 D Int I $D(@Shab@("AF2")) S @BSR@(BST,"AF2")=@Shab@("AF2")
AGAIN S IYI=BSR_"("_BST D NE^%ZAPM.ed.BSN I R1=27 S YES=0 Q
 S %INV="TempZap"_$G(%BS(3),$P)_$J_"u",%INV=$$BSR^%ZAPM.ed.BSA($NA(^%ZAPM.ed.BSbufB(%INV))) K @%INV S %INV2=1,%INV1=2,s6=0,@%INV="%BS-dimamo-@Temporary"
 S do="D TEMPZ^%ZAPM.ed.BSF11(j)" D BLOK^%ZAPM.ed.BSF1 I YES<1!('s6) G AGAIN
 S YES=1,MM=%INV,M=1
 Q
TEMPZ(j) ;СОЗДАНИЕ TEMP.М\ЗАПРОСОВ
 Q:Tmp=i
 D DINA^%ZAPM.ed.BSS I YES<1 S i=999999 Q
 S Tmp=i Q
ERMA D ErrMsg^%ZAPM.ed.BSXfun($$ErrSay^%ZAPM.ed.BSF8($ZE)) S $ZT=$G(%zT),YES=0 Q
TS ;ПОИСК ДИНАМИЧЕСКОЙ БОКОВИНЫ
 N F S ls=1
 S F=$G(@BSR@(BST,"FCL",id,jd)) X "I "_F
 Q
TSVD(M,N,T,Z) I '$D(@BSR@(BST,N)) S ls="В ФУНКЦИИ $TSVD НЕТ СТРОКИ С НОМЕРОМ "_N Q 0
 I '$D(@BSR@(BST,T)) S ls="В ФУНКЦИИ $TSVD НЕТ СТРОКИ С НОМЕРОМ "_T Q 0
 S @BSR@(BST,"TSV",1,3)=$G(M),@BSR@(BST,"TSV",1,3,1)=+$G(N)_","_+$G(T)_","_id_","_jd
 I $D(Z) S @BSR@(BST,"TSV",1,3,2)=Z
 Q 1
INVTAB S s1="invert" G DINS ;ОБРАТНАЯ ОПЕРАЦИЯ
DINTAB S s1="dinamo"
DINS I BST'["@" D ErrMsg^%ZAPM.ed.BSXfun("ОПЕРАЦИЯ ВОЗМОЖНА В РЕЖИМЕ РЕДАКТИРОВАНИЯ ТАБЛИЦЫ <F4>") G D
 D Yes^%ZAPM.ed.BSXfun("ТЕКУЩАЯ ТАБЛИЦА СИЛЬНО ИЗМЕНИТСЯ ! ВЫ ГОТОВЫ К ЭТОМУ ?",2) I YES<1 G D
 S li="^" D GLO^%ZAPM.ed.BSF3 I $G(GL)="" G D
 I $P($G(@GL),"@")'[("%BS-"_s1_"-") D ErrMsg^%ZAPM.ed.BSXfun("НУ, ЭТО СОВСЕМ НЕ ТО !") G D
Int S s2=@BSR@(BST) K @BSR@(BST) S @BSR@(BST)=s2,$P(@$ZR,"@",29)=2,ke=2,s2=0
 S i="",BSr=BSR,BSt=BST
 I s1["mo" F  S i=$O(@GL@(1,i)) Q:i=""  D DINSM($P($G(^(i)),"@"))
 I s1'["mo" F  S i=$O(@GL@(1,i)) Q:i=""  D DINSM(i)
 S s2=s2+1 I s2>50 S s2=50
 S l1=s2,l2=75-l1,(col(1),col(2))=$P(%BS,"!",4) D DINSE(" КОДЫ"," "_$S(s1'["mo":"ТЕКСТЫ",1:"ФОРМУЛЫ (для включения в М\Запрсы их надо ПОМЕТИТЬ)"))
 S col(1)=$P(%BS,"!",5),col(2)=$P(%BS,"!",6),a=""
 I s1["mo" F  S a=$O(@GL@(1,a)) Q:a=""  D DINSE($P(@GL@(1,a),"@"),$P(@GL@(1,a),"@",2,999))
 I s1'["mo" F  S a=$O(@GL@(1,a)) Q:a=""  D DINSE(a,@GL@(1,a))
 D CREAT^%ZAPM.ed.BSN S $P(@BSr@(BSt),"@")=$P($G(@GL,"@???"),"@",2)
 Q:$D(IntTmp)
 D TIT^%ZAPM.ed.BST,W^%ZAPM.ed.BST G B^%ZAPM.ed.BSTM
DINSM(t1) I $L(t1)>s2 S s2=$L(t1)
 Q
DINSE(t1,t2) D CR^%ZAPM.ed.BSN Q
ERCMD ;ОШИБКИ В ФОРМУЛАХ СПИСКОВ И СВОДОК
 D TempT^%ZAPM.ed.BSTT
 D TempTX^%ZAPM.ed.BSTT($$ErrSay^%ZAPM.ed.BSF8($ZE)),TempTX^%ZAPM.ed.BSTT("")
 D TempTX^%ZAPM.ed.BSTT("    ВОЗМОЖНО ОШИБКА В ФОРМУЛАХ:"),TempTX^%ZAPM.ed.BSTT("")
 I $D(iii),$D(SP(2,iii)) D TempTX^%ZAPM.ed.BSTT("номер="_iii_" Логики на Шапку"),TempTX^%ZAPM.ed.BSTT(SP(2,iii))
 I $D(iii),$D(SP(4,iii)) D TempTX^%ZAPM.ed.BSTT("номер="_iii),TempTX^%ZAPM.ed.BSTT(SP(4,iii))
 I $G(iS),$D(SP(5,iS)) D TempTX^%ZAPM.ed.BSTT("номер="_iS_" Логики на Боковину"),TempTX^%ZAPM.ed.BSTT(SP(5,iS))
 I $D(i),$D(C),$D(CH(C,i,3)) D TempTX^%ZAPM.ed.BSTT(" Логика Выборки="_CH(C,i,3))
 D TempTXT^%ZAPM.ed.BSTT("ОШИБКА !!!",$G(@%BS(20)@("ErrorTXT")))
 D TempTXTE^%ZAPM.ed.BSTT
 Q
D G 0^%ZAPM.ed.BSTM
DIN ;МИКРОЗАПРОСЫ ИЗ СВОДКИ В МАССИВ
 S do="I j=%INV1 D DINASE^%ZAPM.ed.BSS($P(^(j),""@"",15),$G(@BSR@(BST,""FCL"",i,j)))"
 D SETKD^%ZAPM.ed.BSS S s6=0
 D BLOK^%ZAPM.ed.BSF1 G ENDIN^%ZAPM.ed.BSS
S(C) Q:C'["]" 0 N U,S
 S U=$P(C,$C(34),2),S=$P(C,$C(34),4) I $$ZU^%ZAPM.ed.BS3(U,S) Q 0
 Q 1
F(S) I $$S(S)=0 Q "НОВЫЙ ФОНОВЫЙ НАСЧЕТ"
 Q "НОВЫЙ ЛОКАЛЬНЫЙ ФОНОВЫЙ НАСЧЕТ"
H(S) I $$S(S)=0 Q "НОВЫЙ НАСЧЕТ"
 Q "НОВЫЙ ЛОКАЛЬНЫЙ НАСЧЕТ"
R(C) ;УДАЛЕННЫЕ НАСЧЕТЫ
 N %TAB,%TAA
 D UU(C) I '$D(UU) Q
 S %TAB=%OLDII I UU=$$BSR^%ZAPM.ed.BSA("^%ZAPM.ed.BSbufS") Q
 F  S %TAB=$O(@(UU_"(%TAB)")) Q:%TAB=""  Q:%TAB'[%OLDII  I %TAB'["@"&(%TAB'["&") S i=i+1 D
 .S @TS@(i,1)="@@1@75@@@@@1@"_$P(%BS,"!",5)_"@@@@@ "_$P(%TAB,"!",3)_$J("",13-$L($P(%TAB,"!",3)))_$S($P(@(UU_"(%TAB)"),"@",30)="":".....",1:$E($P(@$ZR,"@",30),1,5))_";REMOTE;1;"_$P(@$ZR,"@")
 ;```S (%TAB,%TAA)=%OLDII
 ;```F  S %TAB=$O(@(UU_"(%TAB)")) Q:%TAB=""  Q:%TAB'[%TAA  I %TAB'["@"&(%TAB'["&") S i=i+1 D
 ;```.S @TS@(i,1)="@@1@75@@@@@1@"_$P(%BS,"!",5)_"@@@@@ "_$P(%TAB,"!",3)_$J("",13-$L($P(%TAB,"!",3)))_$S($P(@(UU_"(%TAB)"),"@",30)="":".....",1:$E($P(@$ZR,"@",30),1,5))_";REMOTE;1;"_$P(@$ZR,"@")
 Q
UU(C) N U ;ОПРЕДЕЛЕНИЕ ССЫЛКИ СЕТЕВОГО РАЗДЕЛА
 S U="^["""_$P(C,$C(34),2)_""","""_$P(C,$C(34),4)_"""]BSdirddp",U=$P($G(@U),"@",2) I U="" G UUu
 S UU="^["""_$P(U,",")_""","""_$P(U,",",2)_"""]%BSbufS" I $$Data^%ZAPM.ed.BSF12(UU) Q
UUu S UU="^[""MGR"","""_$P($G(^%ZAPM.ed.BSETUP("SERVER",14,4)),"@",15)_"""]%BSbufS" I $$Data^%ZAPM.ed.BSF12(UU) Q
 S UU=$$BSR^%ZAPM.ed.BSA("^%ZAPM.ed.BSbufS") Q
DEL S %TAB=$P(d," ",2) S %OLDII1=$S(%OLDII'["^%":$E(%OLDII,4,6)_":"_$E(%OLDII,10,12)_":"_$P($P(%OLDII,"]",2),"!",1,9),1:%OLDII)
 I $D(%DIA) S do="S d=$P(^(j),""@"",15) K Temp D DE^%ZAPM.ed.BSF11(d) I $D(Temp) S %TAB=%OLDII1_$P($P($P(^(j),""@"",15),"" "",2),""."",2) D DEL^%ZAPM.ed.BS(Temp,$S($ZV[""Cach"":%OLDII_$P(%TAB,""."",2),1:%OLDII1_$P(%TAB,""."",2)))" D BLOK^%ZAPM.ed.BSF1 Q
 Q:ny<4  K Temp D DE(d) I $D(Temp) D DEL^%ZAPM.ed.BS(Temp,$S($ZV["Cach"||($ZV["IRIS"):%OLDII_$P(%TAB,".",2),1:%OLDII1_$P(%TAB,".",2)))
 Q
DE(d) I d[";REMOTE;" S Temp=UU Q
 I d[";LOCKAL;" S Temp=%nAM
 Q
OUTGLO(GLO,FN) ;КОПИРОВАНИЕ НОВОЙ ВЕРСИИ В СЕТЕВУЮ ГЛОБАЛЬ
 I GLO'["^" Q
 N DOS,I,II
 S %zT=$ZT,$ZT="OG^%ZAPM.ed.BSF11",YES=0,II=1
 F DOS=51:1:54 O DOS::0 Q:$T
 I $$Open^%ZAPM.ed.BSXdos(FN,"R")<0 Q
 D L^%ZAPM.ed.BS3(GLO)
 U 0 d Wait^%ZAPM.ed.BSXfun("Копирование в "_GLO) K @GLO@("LAST") S @GLO@("LAST")=0
 F  U DOS Q:$ZC'=0  R I S @GLO@("LAST",II)=I,II=II+1 I '(II#50) U 0 X $G(WA)
 S @GLO@("LAST")=^%ZAPM.ed.BS
 S YES=1 D U^%ZAPM.ed.BS3(GLO) C DOS
 Q
OG I $ZE["<ENDOFFILE" G OGO
 D ErrMsg^%ZAPM.ed.BSXfun($$ErrSay^%ZAPM.ed.BSF8($ZE))
OGO S $ZT=$G(%zT),YES=0 D U^%ZAPM.ed.BS3(GLO) C DOS
 Q
SCAN(%FN) ;СКАНИРОВАНИЕ
 C %FN K fT2
 N I,WRITE,DOS,FN,DOSO,FNO,FIRST,M,CU,v,ST,STOPSCAN,DOSIN,DOSOUT,say
 I $D(^%ZAPM.ed.BSDDR("DDRPARM")) F CU=2:2:16 S CU(CU)=$P(^%ZAPM.ed.BSDDR("DDRPARM",CU,4),"@",15)
 I %IN["%BS-SCANINIG" G SCA
 ;S FN=$$BaseDir^%ZAPM.ed.BSDOS_$$DIR^%ZAPM.ed.BSMSMF_$$TEMPFILE,FNO=%FN
 ;C %DEV 
 I $ZV["Cach"||($ZV["IRIS") D  G SCA1
 .S say="без перекодировки" S (S2,S1)="" I $$IFDOS^%ZAPM.ed.BSHTML1(%IN) D  S say="с перекодировкой" 
 ..N (S1,S2) D INIT^%ZAPM.ed.BSre(1)
 ;F %DEV=$G(%Dev,51):1:54 O %DEV::0 Q:$T
 ;S DOS=%DEV
 ;F %DEV=$G(DOS,51)+1:1:54 O %DEV::0 Q:$T
SCA1 ;I $$Open^%ZAPM.ed.BSXdos(FNO,"R")<0 G STOPSCAN
 ;S DOSO=DOS,DOS=%DEV I $$Open^%ZAPM.ed.BSXdos(FN,"W")<0 G STOPSCAN
 ;S DOSIN=DOSO,DOSOUT=DOS X $G(CU(16)) I $G(STOPSCAN) G STOPSCAN
 k fT2 d fT1(.fT1,.fT2) k fT1 m fT1=fT2 k fT2
 d Wait^%ZAPM.ed.BSXfun("освобождения от мусора и разрезка "_%FN)
 S %zT=$ZT,$ZT="ERFILE^%ZAPM.ed.BSF11"
 ;U DOS W "%BS-SCANINIG ",$G(say),!
 D fT2("%BS-SCANINIG "_$G(say))
 ;S ST="" F v=1:1 U DOSO  R I D  D:I'="" CUT(I) //I '(v#10) U 0 X $G(WA) /////Q:$ZC'=0
 S ST="",i="" F v=1:1 S i=$O(fT1(i)) Q:i=""  S I=fT1(i) D  D:I'="" CUT(I)
 .S I=$TR(I,CU(2),CU(4))
 .I $P(CU(14),"/",3)="Y" S I=$$Cut^%ZAPM.ed.BSF10(I)
 .I $P(CU(14),"/",2)="Y" S I=$$Cut^%ZAPM.ed.BSF10(I,1)
 .I I[CU(6),I'[CU(8) S I=$$TR^%ZAPM.ed.BSsFUNM(I,CU(6),CU(8))
 .I I[CU(10),I'[CU(12) S I=$$TR^%ZAPM.ed.BSsFUNM(I,CU(10),CU(12))
 .I $P(CU(14),"/",1)="Y" F M=1:1 Q:$E(I,M)=""  I $A($E(I,M))<32 S I=$E(I,1,M-1)_$E(I,M+1,$L(I))
 .I '$D(FIRST),I'[CU(12) S I=""
 .I '$D(FIRST),I[CU(12) S FIRST=1
STOPSCAN ;I $P(CU(14),"/",4)'="Y" S %FN=FN C DOSO,DOS G SCA
 ;C DOSO,DOS W /CUP(22,1) D EXE^%ZAPM.ed.BSDOS("COPY "_FN_" "_FNO,1) 
 ;W /CUP(22,1) D EXE^%ZAPM.ed.BSDOS("DEL "_FN,1)
SCA ;I $ZV["Cach"||($ZV["IRIS") C FN,FNO S %DEV=%FN G SCA2
 ;C %DEV F %DEV=$G(%Dev,51):1:54 O %DEV::0 Q:$T
 ;S DOS=%DEV
SCA2 ;I $$Open^%ZAPM.ed.BSXdos(%FN,"R")
 ;U %DEV R %IN
 S fT2=$O(fT2("")),%IN=$G(fT2(fT2)) 
 Q
fT2(S) S fT2=$G(fT2)+1,fT2(fT2)=S //ЗАПИСЬ В НОВЫЙ МАССИВ
 Q
fT1(fT2,fT1) n i s i="" F  S i=$O(fT2(i)) Q:i=""  I $G(fT2(i))'="" D  S fT1(i)=fT2(i) I $G(fT1)="" S fT1=i
 .I $E(fT2(i),$L(fT2(i)))="="!(fT2(i)["+++") Q  //выравнивание по =
 .N A,ii,AA S AA=fT2(i),A=$P(fT2(i),"=",$L(fT2(i),"=")),fT2(i)=$P(fT2(i),"=",1,$L(fT2(i),"=")-1)_"="
 .S ii=$O(fT2(i)) I ii="" S fT2(i)=AA Q
 .S fT2(ii)=A_$G(fT2(ii))
 q
ERFILE S $ZT=$G(%zT) I $ZE["<ENDOFFILE" G STOPSCAN
 D ErrMsg^%ZAPM.ed.BSXfun($ZE_" "_$$ErrSay^%ZAPM.ed.BSF8($ZE))
 Q
CUT(I) ;РАЗРЕЗКА
 I $L(ST_I)>4000 D CU(ST)
 S ST=ST_I I ST["=++" D CU(ST) D fT2($TR(ST,S1,S2)) S ST="" //U DOS W $TR(ST,S1,S2),! S ST=""
 Q
CU(S) N SS
 S SS=""
 F M=1:1 Q:$P(S,"=",M,M+1)=""  S SS=SS_$P(S,"=",M)_"=" I $L(SS)>74 D fT2($TR(SS,S1,S2)) S SS="" //U DOS W $TR(SS,S1,S2),! S SS=""
 S ST=SS
 Q
UNMARK(U) N I,J ;СНЯТЬ ПОМЕТКУ С ТАБЛИЦЫ
 F I=1:1 Q:$G(@U@(I,1))=""  F J=1:1 Q:$G(@U@(I,J))=""  S $P(@U@(I,J),"@",12)=""
 S $P(@U,"@",3)="" Q
TEMPFILE() ;ВРЕМЕННЫЙ ФАЙЛ
 Q "%BSTEMP.TMP"
RANDFILE() ;СЛУЧАЙНОЕ ИМЯ ФАЙЛА
 Q $R(10)_$R(10)_$R(10)_$R(10)_$R(10)_$R(10)_$R(10)_$R(10)_".TMP"
TMPG() ;СЛУЧАЙНАЯ ССЫЛКА ВРЕМЕННОГО МАССИВА
TMR N T S T=$NA(@"^%ZAPM.ed.BSbufB"@("TMP"_$TR($$RANDFILE(),".","")_$G(%BS(3),$P)_$J_"u1")) I $D(@T) G TMR
 Q T
MARK(U,M) N I,J,P ;ПОМЕТИТЬ ТАБЛИЦУ ПО ДАННЫМ В КЛЕТКАХ -->M
 S P=0 F I=1:1 Q:$G(@U@(I,1))=""  F J=1:1 Q:$G(@U@(I,J))=""  I $P(@U@(I,J),"@",15)'="",$D(@M@($P(@U@(I,J),"@",15))) S $P(@U@(I,J),"@",12)=1,P=P+1
 I 'P S $P(@U,"@",3)="" K %DIA Q
 S %DIA=1,$P(@U,"@",3)=P Q
STAT ;СТАТИСТИКА -=АС НЕФЕДОВ=-
 N (%BS) D SA^%ZAPM.ed.BSsBUF,^%ZAPM.ed.BSTAT,RE^%ZAPM.ed.BSsBUF
 Q
MENU ;ОБНОВЛЕНИЕ ВРЕМЕНИ В МЕНЮ
 Q:R1>332  I '$D(%BS(2,1)),$ZV'["Cach"&&($ZV'["IRIS") S %BS(2,1)=%BS(2),%BS(2)="1-D MENU^%ZAPM.ed.BST" Q
 I R1=13,R2=-1,R3=-1 D UNDOMENU Q
 I R1=27,R2=-1,R3=-1 D UNDOMENU
 Q
UNDOMENU I $D(%BS(2,1)) S %BS(2)=%BS(2,1) K %BS(2,1) Q
 D CLr^%ZAPM.ed.BSF4 Q
]]></Routine>


<Routine name="%ZAPM.ed.BSF12" type="MAC" languagemode="0"><![CDATA[
%BSF12 ;Функции общего назначения; 16:28  5-DEC-97 ; 16:41   28.12.2001
 Q
KillTab ;ПРОТОКОЛИРОВАНИЕ УДАЛЕНИЯ ТАБЛИЦ
 N G Q:%NAM["%BSbuf"  S G=$NA(@%NAM@(%TAB)) Q:"15"[$P($G(@G),"@",17)
 D Tex^%ZAPM.ed.BSMSMF("In "_$$ZU^%ZAPM.ed.BS3(0)_" KillTab :"_G)
 Q
TITUL I $G(%TIT) G TT0^%ZAPM.ed.BSF2
 D Yes^%ZAPM.ed.BSXfun("Устанавливаем Титул на таблицу ?") I YES<1 G D^%ZAPM.ed.BS
 G TT1^%ZAPM.ed.BSF2
PEREXOD(%NAM) I %NAM["^[" N I1,I2,I3 S I1=$P($P(%NAM,"[",2),"]",1),I2=$P(I1,$C(34),2),I3=$P(I1,$C(34),4) I $$ZU^%ZAPM.ed.BSF4(I2,I3)
 Q
PARTIT(%NAM) ;ВХОД В РАЗДЕЛ
 N ucI S ucI=$$ZU^%ZAPM.ed.BS3(0)
 D PEREXOD(%NAM) D
 .N Pddp,IntBS,ucI S IntBS=1 D TAB^%ZAPM.ed.BS
 I $$ZU^%ZAPM.ed.BSF4($P(ucI,","),$P(ucI,",",2)) 
 Q
SHIFTF5 S $P(@BSR@(BST,1,4),"@",15)=$TR(KKK,".]:[^""","___")
LISTBUF ;СПИСОК ГЛОБАЛЬНЫХ БУФЕРОВ
 S I="",II=4 F  S I=$O(BUFG(I)) Q:I=""  I BUFG(I)'="",$$Data(BUFG(I)) D
 .S $P(@BSR@(BST,II,4),"@",15)=BUFG(I),$P(@BSR@(BST,II,2),"@",15)=$P($G(@BUFG(I),"@Без Комментария"),"@",2)
 .S II=II+2
 Q
SELBUF(R) ;ВЫБОР ГЛОБАЛЬНОГО БУФЕРА
 N (R,KKK,Refresh,%BS) I $ZV["Cach"||($ZV["IRIS") S Refresh=1
 F I=1:1 S BUFG(I)=$$BUFG(I) I $G(BUFG(I))="" K BUFG(I) Q
 I '$D(BUFG) D ErrMsg^%ZAPM.ed.BSXfun("РАЗДЕЛЫ НЕОПРЕДЕЛЕНЫ ИЛИ НЕДОСТУПНЫ") Q ""
 S I=$$LOAD^%ZAPM.ed.BSscrF("^%ZAPM.ed.BSVOL("_R_")","4#1#12",2,"~",R_"^%ZAPM.ed.BSF12") I $P(%BS("Tmp","LastTabl"),"@",4)=27 Q ""
 S BUFG=$P(%BS("Tmp","LastTabl"),"@",9) I '$$Data(BUFG) W $$bel^%ZAPM.ed.BS3 Q ""
 S KKK=$P(I,"~",1)
 Q BUFG
BUFENTER N BUFG S BUFG=$$SELBUF("LISTBUF")
 I '$$Data(BUFG) W $$bel^%ZAPM.ed.BS3 Q
 N Pddp,%NAM,IntBS S %NAM=BUFG,IntBS=1 D TAB^%ZAPM.ed.BS
 Q
BUFG(P) Q $P($P($G(^%ZAPM.ed.BSETUP("SERVER",8,4)),"@",15)," ",$G(P,1)) ;БУФЕРА
Buf ;КОПИРОВАТЬ В БУФЕР ПОТОК ТАБЛИЦ
 N i,j,KK,KKK,BUFG,R1,IntPoint
 D
 .N BSR,BST,KK,KKK,IntPoint
 .S BSR="Tmp",BST="Tmp",IntPoint=1 D BUFAGA
 I $D(%DIA) S do="I i>2 S %TAB=$P($P($P(^(j),""@"",15),""~"",2),"" "") D COPY^%ZAPM.ed.BSF12(%NAM,%TAB,BUFG)" D BLOK^%ZAPM.ed.BSF1
 I '$D(%DIA) D COPY^%ZAPM.ed.BSF12(%NAM,%TAB,BUFG)
 D OkMsg^%ZAPM.ed.BSXfun("Копия закончена")
 Q
COPY(BSR,BST,BUF) ;КОПИРОВАНИЕ
 D Copy^%ZAPM.ed.BSF8($NA(@BSR@(BST)),$NA(@BUFG@(BST)),"",1)
 S @BUFG@(BST,"LST")=$H_","_$G(%BS(12))_",BuffCopy"
 Q
BUFCOPY N KK,KKK,BUFG
 I $E(BST,1)="@" D ErrMsg^%ZAPM.ed.BSXfun("СНАЧАЛО НЕ ПЛОХО БЫ ВЫЙТИ ИЗ РЕЖИМА РЕДАКТИРОВАНИЯ") Q
 I BSR["%BSbufB" Q:$P($G(@BSR@(BST)),"@",17)'=5
BUFAGA S KKK=BST,BUFG=$$SELBUF("SHIFTF5") I BUFG="" Q
BUFAGAIN G:KKK="" BUFAGA I $D(@BUFG@(KKK)) S KK=$ZR D Yes^%ZAPM.ed.BSXfun("ТАБЛИЦА "_KK_" УЖЕ СУЩЕСТВУЕТ ЗАМЕЩАЕМ ?",2) D  Q:YES<1  G BUFAGAIN
 .I YES<1 S KKK=$$LineEdit^%ZAPM.ed.BSXfun(KKK,"ВВЕДИТЕ НОВОЕ ИМЯ, ПОД КОТОРЫМ ЗАПИШЕМ В БУФЕР") Q
 .K @KK S YES=1
BUFCO Q:$D(IntPoint)
 D Copy^%ZAPM.ed.BSF8($NA(@BSR@(BST)),$NA(@BUFG@(KKK)),"",1),OkMsg^%ZAPM.ed.BSXfun("Копия закончена")
 S R1=-99 Q
T S TmpTime=+$P($$h^%ZAPM.ed.BS3(),",",2) Q  ;НАЧАЛО
Ti D OkMsg^%ZAPM.ed.BSXfun("Работало "_($P($$h^%ZAPM.ed.BS3(),",",2)-TmpTime)_" сек.")
 Q
LNG() ;ДЛИНА ГЛОБАЛА/ОГРАНИЧЕНИЕ СТРОКИ В РЕДАКТОРЕ
 I $G(%maxLen) Q %maxLen
 I $ZV["Cach"||($ZV["IRIS") Q 32767
 I $P($P($ZV," ",3),".",2)>0 Q 7000
 E  Q 511
GLSET(G,S) ;ПРИСВОИТЬ ДЛИННУЮ СТРОКУ В ГЛОБАЛЬ
 N I,LNG
 S LNG=$$LNG() S @G=$E(S,1,LNG) F I=1:1:17 K @G@("&"_I)
 Q:$E(S,LNG+1)=""  S @G@("&1")=$E(S,LNG+1,LNG+LNG) ;K @G@("&2")
 Q:$E(S,LNG*2+1)=""  S @G@("&2")=$E(S,LNG*2+1,LNG*3) ;K @G@("&3")
 F I=3:1 Q:$E(S,LNG*I+1)=""  S @G@("&"_I)=$E(S,LNG*I+1,LNG*(I+1)) ;K @G@("&"_(I+1))
 Q
GLRET(G) N Tmp ;ВЕРНУТЬ ДЛИННУЮ СТРОКУ
 S Tmp=$G(@G) Q:'$D(@G@("&1")) Tmp S Tmp=Tmp_@$ZR
 Q:'$D(@G@("&2")) Tmp S Tmp=Tmp_@$ZR Q:'$D(@G@("&3")) Tmp S Tmp=Tmp_@$ZR
 Q:'$D(@G@("&4")) Tmp S Tmp=Tmp_@$ZR Q:'$D(@G@("&5")) Tmp S Tmp=Tmp_@$ZR
 Q:'$D(@G@("&6")) Tmp S Tmp=Tmp_@$ZR Q:'$D(@G@("&7")) Tmp S Tmp=Tmp_@$ZR
 Q:'$D(@G@("&8")) Tmp S Tmp=Tmp_@$ZR Q:'$D(@G@("&9")) Tmp S Tmp=Tmp_@$ZR
 Q:'$D(@G@("&10")) Tmp S Tmp=Tmp_@$ZR Q:'$D(@G@("&11")) Tmp S Tmp=Tmp_@$ZR
 Q:'$D(@G@("&12")) Tmp S Tmp=Tmp_@$ZR Q:'$D(@G@("&13")) Tmp S Tmp=Tmp_@$ZR
 Q:'$D(@G@("&14")) Tmp S Tmp=Tmp_@$ZR Q:'$D(@G@("&15")) Tmp S Tmp=Tmp_@$ZR
 Q:'$D(@G@("&16")) Tmp S Tmp=Tmp_@$ZR Q:'$D(@G@("&17")) Tmp S Tmp=Tmp_@$ZR
 Q Tmp
%BSPIC I $D(^%ZAPM.ed.BSR(1,0))
 F I=1:1:23 W $TR(^(I),">",""),!
 Q
REC I %BS(13)'="%BS-PC" W /CUP(22,1),$ZV,"  ",$$WEEKEND^%ZAPM.ed.BSsFUNR(1,$$h^%ZAPM.ed.BS3()),"  ",$$ESDAY^%ZAPM.ed.BSsFUNR(6,$$h^%ZAPM.ed.BS3()),"  %BS Version ",^%ZAPM.ed.BS Q
 N I W $$clear^%ZAPM.ed.BS3,/ED(2),$$atr^%ZAPM.ed.BS3("1;6;33;46") D %BSPIC
 W /CUP(16,4),$ZV D LICEN(17,4),SAY^%ZAPM.ed.BS3(16,38) W $$atr^%ZAPM.ed.BS3(0)
 Q
LICEN(y,x) I $P($ZV,"Version ",2)'<4 D
 .N B,LN,S,X,LC S X=$$LICINFO^%MSMOPS,(B,LN,S)="" S:$ZB(+$P(X,"^",2),32,1) EXP=1
 .W /CUP(y,x),"Serial #..: ",+X
 .W /CUP(y+1,x)
 .I $P(X,"^",3)>1 W "Users.....: ",$P(X,"^",3)
 .E  W "Single User" W:$P(X,"^",3) " Multi-job"
 .W:$P(X,"^",2)#2 ",Runtime"
 .W:$P(X,"^",2)\2#2 ",Demo"
 .I $P(X,"^",5)<($$h^%ZAPM.ed.BS3()+365) W " (Expires ",$ZHL(1,"Month d, yyyy",$P(X,"^",5)),")"
 .W /CUP(y+2,x),"Supplier..: ",$P(X,"^",10)
 .W /CUP(y+3,x),"End-User..: ",$P(X,"^",11)
 .I $P(X,"^",2)>3 W /CUP(y+4,x),"Options...: " S X=+$P(X,"^",2) DO
 ..I $ZB(X,4,1) W "NET"
 ..I $ZB(X,8,1) W ", LAT"
 ..I $ZB(X,16,1) W:$ZB(X,4+8+16,1)>16 ", " W "SECURITY"
 ..I $ZB(X,32,1) W:$ZB(X,4+8+16+32,1)>32 ", " W "EXP"
 ..I $ZB(X,64,1) W:$ZB(X,4+8+16+32+64,1)>64 ", " W "GUI"
 .W /CUP(y+5,x),"NameSystem: ",$P($$ZU^%ZAPM.ed.BS3(0),",",2)
 Q
CHANGE(X) ;СМЕНА ПАРОЛЯ ИЛИ КОМЕНТАРИЯ
 N BSD,d
 S BSD=$$KBD^%ZAPM.ed.BSF12("^%ZAPM.ed.BSS(""USER"")"),d=%BS(12) I d="" Q
 I X=1 G CHCM
CHPW Q:d[" "  N PO,PN,US
 S PO=$G(@BSD@(".@PASSWORD",d)),US=d
 S PN=$$LineEdit^%ZAPM.ed.BSXfun(PO,"Вводите новый пароль для пользователя "_US) I YES<0 Q
 I PN=PO D ErrMsg^%ZAPM.ed.BSXfun(" Не сменили... ") Q
 S @BSD@(".@PASSWORD",US)=PN G CHok
 Q
CHCM Q:d[" "  N PO,PN,US
 S PO=$G(@BSD@(".@WHO",d)),US=d
 S PN=$$LineEdit^%ZAPM.ed.BSXfun(PO,"Вводите новый коментарий для пользователя "_US) I YES<0 Q
 I PN=PO D ErrMsg^%ZAPM.ed.BSXfun(" Не сменили... ") Q
 S @BSD@(".@WHO",US)=PN
CHok D OkMsg^%ZAPM.ed.BSXfun("  сменили... ")
 Q
SETCOL(T,N) S $P(^%ZAPM.ed.BSHLP(T),"@",31)=$P(^%ZAPM.ed.BSHLP(N),"@",31) Q
AF10 ;ПРЕДОБРАБОТКА ДЛЯ БС-ИНТЕРФЕЙСА
 ;I R1=90 D SETCOL($E($P(d," ",2),2,99),0) Q  Z  ...ТАК НАДО БЫЛО....
 ;I R1=67 D SETCOL($E($P(d," ",2),2,99),1) Q  C
 I MRMR'["EXCEL" S MRMR=$TR(MRMR,"><","")_","" B-EXCEL """
 I R1=43!(R1=45) Q
 I $E(%BS(1),17),R1=127 S R1=27,R2=79,R3=87 Q  //ЗАМЕНА BACKSPACE НА ESC
 I R1=66!(R1=98),R2=-1 G EXCEL^%ZAPM.ed.BSCAsIs2
 I R1<332,$E(%BS(1),3)=2,'$E($G(%BS(14)),4),R1>31,R1'=127 D CM^%ZAPM.ed.BSF6 S (R1,R2,R3)=0
 Q
TR ;ТРАНСЛЯЦИЯ ПСЕВДОГРАФИКИ НА ПЕЧАТЬ
 S tr(1)=$P($G(^%ZAPM.ed.BSETUP("PARPRN",8,2)),"@",15),tr(1)=$S(tr(1)="":"||||||--|+||==||=-==-=--==-====-=---==-",1:tr(1))
 S tr(2)=$P($G(^%ZAPM.ed.BSETUP("PARPRN",9,2)),"@",15),tr(2)=$S(tr(2)="":"||||||--|+||==##=--=-=--==-====-=---==-",1:tr(2))
 Q
GETDDP(G) S %zT=$ZT,$ZT="GETERR^%ZAPM.ed.BSF12"
 I $D(@G) S $ZT=$G(%zT) Q 1
 S $ZT=$G(%zT) Q 0
GETERR I '$D(CALCFON),$ZE["PROT>" D ErrMsg^%ZAPM.ed.BSXfun("МАССИВ "_G_" НЕДОСТУПЕН ИЛИ НЕСУЩЕСТВУЕТ")
 S $ZT=$G(%zT) Q 0
KBD(B) ;B-TOBD ПЕРЕАДРЕСАЦИЯ МАССИВОВ БАЗЫ ДАННЫХ
 S %zT=$ZT,$ZT="ERGETBD^%ZAPM.ed.BSF12" ;S ^%ZZZ($I(^%ZZZ))=B 
 N NB,NI,zr,BB,AccKBD
 S BB=$P(@B@("KEY"),"@") 
 ;I $E(B,14,15)="]%" S B="^%"_$E(B,16,999) ;|||||
 I B["]%" S B="^%"_$P(B,"]%",2)
 
 ;I $ZV["Cach"||($ZV["IRIS") D BDEX^%ZAPM.ed.BSCp
 ;;;I "%SYS"'[$G(BSworkNSP),"/OPTIONs/PROTECT/BSG/GRAND/"[("/"_$QS(B,1)_"/") S BB="^["""_BSworkNSP_"""]BSC."_$QS(B,1)
 ;W !,BB R R
 I BB="^%ZAPM.ed.BStree" Q $G(%BS("Tmp","Tree"),"^%ZAPM.ed.BStree") ;ДЛЯ F5 РЕДАКТОРА Массивов
 D zr(1)
 ;D x^%ZAPM.ed.BS3(B)
 I $G(%BS(12))'="",$G(%BS(18))'="" I $D(@%BS(18)@(%BS(37),4,$$TIL(B))) D
 .S NB=$$TIL(B),NI=$O(@%BS(18)@(%BS(37),4,NB,"")) I NI=1 D  Q
 ..S NI=$O(@%BS(18)@(%BS(37),4,NB,1,"")) I NI'="" S:NI="*" NI="RWD" S AccKBD=NI
 .I NI'="" S BB=$$TILL(NI) ;ПЕРЕАДРЕСАЦИЯ ИМЕНИ БАЗЫ ДАННЫХ ДЛЯ ПОЛЬЗОВАТЕЛЕЙ
 I $G(%BS("TRIGGER"))'="",$D(^%ZAPM.ed.BSS("TRIGGER","KEY")) S NB=@$ZR I $$Data^%ZAPM.ed.BSF12(NB),$G(@NB@(%BS("TRIGGER"),$$TIL(BB),0))'="" S BB=@$ZR
 S %BS("Tmp","AKBD",$$TILL(BB))=$G(AccKBD,"RWD") ;ПРАВА ДОСТУПА НА БД
 ;D x^%ZAPM.ed.BS3($G(AccKBD,"?RWD"))
 I $D(^%ZAPM.ed.BSCiP.TREEGER($$TIL(B))) D  //ПЕРЕКЛЮЧАТЕЛЬ НАХОДИТСЯ ^%ZAPM.ed.BSCiP("TREEGER")
 .S g=BB X "I "_$G(^%ZAPM.ed.BSCiP.TREEGER($$TIL(B),"IF"),1)_" "_$G(^%ZAPM.ed.BSCiP.TREEGER($$TIL(B),"SET")) S BB=g
 
 S BB=$$SW(BB)
 ;S ^%ZZ=BB
 D zr(0)
 Q $$TILL(BB)
SW(G) //Глобальный переключатель
 D zr(1)
 I '$D(zBS4cfg) S zBS4cfg=$G(^%ZAPM.ed.BS("Config")) 
 I zBS4cfg="" D zr(0) Q G 
 N A S A=$G(^%ZAPM.ed.BSCiP.Switch(zBS4cfg,G,"NEW")) I A="" D zr(0) Q G
 D zr(0) Q A
TILL(NI) Q $TR(NI,"~",$C(34))
TIL(NI) Q $TR(NI,$C(34),"~")
ERGETBD S $ZT=$G(%zT) Q $G(BB)
zr(N) I N=1 S zr=$ZR Q  ;СОХРАНИТЬ
 S $ZT="Erzr"
 I $D(zr),$D(@zr) ;ВОССТАНОВИТЬ
 Q
Erzr Q 
Pred(R) S %zT=$ZT,$ZT="ERPred^%ZAPM.ed.BSF12" ;ПРЕДОБРАБОТКА
 D @R S $ZT=$G(%zT) Q
ERPred W $$bel^%ZAPM.ed.BS3 D Wait^%ZAPM.ed.BSXfun($ZE_" "_$$ErrSay^%ZAPM.ed.BSF8($ZE))
 S $ZT=$G(%zT) Q
Data(G) S %zT=$ZT,$ZT="ERGETGLB^%ZAPM.ed.BSF12" ;СУЩЕСТВОВАНИЕ УЗЛА
 I $D(@G) S $ZT=$G(%zT) Q 1
 S $ZT=$G(%zT) Q 0
ERGETGLB S $ZT=$G(%zT) Q "00"
Free N NoFree
 S do="I $P(^(j),""@"",7),$P(^(j),""@"",9)=1 S NoFree=1" D ALLT^%ZAPM.ed.BSS1
 I '$D(NoFree) S @BSR@(BST,"Free")=$$h^%ZAPM.ed.BS3()
 Q
%(bsr) I $E(bsr,1,2)'="^[" Q "^["""_$P($$ZU^%ZAPM.ed.BS3(1,0),",")_""","""_$P($$ZU^%ZAPM.ed.BS3(1,0),",",2)_"""]"_$P(bsr,"^",2,99)
 I $P($P(bsr,"]"),"[",2)'["," N bs S bs=$P($P($P(bsr,"]"),"[",2),$C(34),2) Q "^["""_bs_""","""_$P($$ZU^%ZAPM.ed.BS3(1,0),",",2)_"""]"_$P(bsr,"]",2,99)
 Q bsr
SS() ;ПОЛНАЯ ССЫЛКА КЛЕТКИ
 N W S W="{"_ny_","_nx_","""_BST_""","""_%w(6,1)_""","""_%w(6,2)_""","""_$S(%w(6,3):"",1:%w(6,3))_""""
 I TIP=2,$P(BS,"@",9)'=1 D  ;
 .I $D(NOKEY) S W=W_",...???" Q
 .S W=W_","_$S($D(%KEYS(0)):%KEYS(0),1:"""""")
 .F pi=1:1:9 I $D(%KEYS(pi)) S W=W_","_$S(%KEYS(pi)=+%KEYS(pi):%KEYS(pi),1:$C(34)_%KEYS(pi)_$C(34))
 I $D(Hid),$D(@Hid),$D(@Hid@(ny)) S W=W_","_$S(@$ZR=+@$ZR:@$ZR,1:$C(34)_@$ZR_$C(34))
 S W=W_"}" Q W
SSS D AddHist^%ZAPM.ed.BSXuse("^%ZAPM.ed.BSbufB(""HISCTL"_$S('$E(%BS(1),12):$G(%BS(3),$P)_$G(%BS(12)),$E(%BS(1),12)=1:"1"_$G(%BS(12)),1:"1")_""")",$$SS())
 Q
D G 0^%ZAPM.ed.BSTM
 ; МИФИЧЕСКАЯ_КЛЕТКА @6@ @0@@@;;MIFB^%ZAPM.ed.BSF12
ADRESS S li=$$LineEdit^%ZAPM.ed.BSXfun("1,0?","Вводите адрес Мифической клетки: например 1,07 или 1,009") Q:YES<1  I li'?1"1,0".N D ErrMsg^%ZAPM.ed.BSXfun("НЕ ПРАВИЛЬНЫЙ ФОРМАТ МИФ.КЛЕТКИ") G ADRESS
 S ny=1,nx=$P(li,",",2) Q
MIFT D ADRESS G D:YES<1 G E21^%ZAPM.ed.BSF1
MIFB D ADRESS G D:YES<1 G E11^%ZAPM.ed.BSF1
 ;
]]></Routine>


<Routine name="%ZAPM.ed.BSF13" type="MAC" languagemode="0"><![CDATA[
%BSF13 ; пpогpамма ДОПОЛНИТЕЛЬНЫХ ФУНКЦИЙ КОМПЛЕКСА ; 13:49   15.04.2003
 Q
%PopTAB(BSr,BSt,KY,ke,v,LX) ;СОЗДАТЬ ТЕСТОВУЮ ТАБЛИЦУ
 N se,i,l,TmpTime
 ;ke-КОЛ-ВО КОЛОНОК
 ;v- ВЫСОТА ТЕКУЩЕЙ СТРОКИ
 D %Pop
 F i=1:1:KY D
 .S se=se+1 F j=1:1:ke S @BSr@(BSt,se,j)="@@"_$G(v,1)_"@"_LX_"@@@@@1@@@@@@ Line="_i_", Colomn="_j
 S @BSr@(BSt)="ТЕСТОВАЯ ТАБЛИЦА ("_KY_"x"_ke_")@@@@@@@1@1@22@80@1@@1@1@@1@@@1@"
 S BSR=BSr,BST=BSt
 S:$D(Fk) $P(@$ZR,"@",15)=Fk S:$D(PrEd) $P(@$ZR,"@",41)=PrEd
 D RESZER^%ZAPM.ed.BSF2,TABm^%ZAPM.ed.BSF1
 D %PopE
 Q
%PopE S TmpTime=$P($H,",",2)-TmpTime,$P(@BSr@(BSt),"@")=$P(@BSr@(BSt),"@")_" Создавалась "_(TmpTime/60)_" Мин."
 Q
%Pop S:$D(@BSr)["0" $P(@BSr,"@")="BaSe MsW @ТЕСТОВЫЙ РАЗДЕЛ"
 S se=0 K @BSr@(BSt) S TmpTime=$P($H,",",2) ;НАЧАЛО
 Q
%PopTXT(BSr,BSt,KY,LX) ;СОЗДАТЬ ТЕКСТ
 N i
 D %Pop
 S @BSr@(BSt)="ТЕСТОВЫЙ ТЕКСТ ("_KY_"x"_LX_")@@@@@@@1@1@22@80@1@@1@1@@1@@@1@"
 F i=1:1:KY S @BSr@(BSt,i)="Строка="_i_$J(" Line="_i,LX-8-$L(i))
 S $P(@BSr@(BSt),"@",17)=5,$P(@$ZR,"@",28)=KY,$P(@$ZR,"@",29)=""
 D %PopE
 Q
DoLINK ;ВХОД В ТИП ТАБЛИЦЫ LINK
 N P1,T1,S1
 I $P(@BSR@(BST,3,2),"@",15)="" D Yes^%ZAPM.ed.BSXfun("ЗАГРУЖАЕМ ТАБЛИЦУ ?",1) I YES<1 G GOO^%ZAPM.ed.BST
 S P1=$P(@BSR@(BST,1,2),"@",15),T1=$P(@BSR@(BST,2,2),"@",15) G GOO^%ZAPM.ed.BST:P1=""!(T1="")
 S S1=$NA(@P1@(T1)) I $$Data^%ZAPM.ed.BSF12(S1),$P(@S1,"@",17)'=6 S BSR=P1,BST=T1 G ^%ZAPM.ed.BST
 G GOO^%ZAPM.ed.BST
TNAME(BSR,BST) ;ТРАНСЛИРОВАТЬ ИМЯ ОТЧЕТА
 N A I $ZV["Cach"||($ZV["IRIS") D  Q A
 .S A=$TR($$BSR^%ZAPM.ed.BSA(BSR),",^""",":")_"!1!"_BST
 .I A[":""""]" S A=$$TR^%ZAPM.ed.BSsFUNM(A,":""""]",":""MSW""]")
 Q $TR($$BSR^%ZAPM.ed.BSA(BSR),",",":")_"!1!"_BST
SetTBD(N) ;ПЕРЕКЛЮЧИТЬ
 N NB
 S NB=$$KBD^%ZAPM.ed.BSF12($NA(^%ZAPM.ed.BSS("TRIGGER"))) I $$Data^%ZAPM.ed.BSF12(NB),$D(@NB@(N)) S %BS("TRIGGER")=N Q 1
 Q 0
ClearTBD ;ОЧИСТИТЬ ПЕРЕКЛЮЧАТЕЛЬ БАЗ ДАННЫХ
 K %BS("TRIGGER")
 Q
ShowTBD() Q $G(%BS("TRIGGER"),"UNDEFINED")
USERSBAS ;ПРОГА ЧИСТКИ КОМЕНТАРИЕВ И ПАРОЛЕЙ В БАЗЕ ДАННЫХ ПОЛЬЗОВАТЕЛЕЙ ^%ZAPM.ed.BSS("USER")
 I R1=999 D  Q
 .N I,II,III
 .S I="" F  S I=$O(@BSD@(I)) Q:I=""  Q:I'[".@"  S II="" F  S II=$O(@BSD@(I,II)) Q:II=""  I '$D(@BSD@(II)) K @BSD@(I,II)
 Q
]]></Routine>


<Routine name="%ZAPM.ed.BSF2" type="MAC" languagemode="0"><![CDATA[
%BSF2 ;КОРРЕКЦИЯ ОПИСАНИЯ ТАБЛИЦЫ II ; 21:19 24-FEB-99
LI D LE^%ZAPM.ed.BSTT Q
A24 W /CUP(24,1),$$atr^%ZAPM.ed.BS3(0),/EL(0) Q
RES I '$D(^%ZAPM.ed.BSbufB(2,$G(%BS(3),$P),bf)) S ls=" Буфера нет " D O^%ZAPM.ed.BSF7 G D
 S (mj,mi)=0,ls=" Восстанавливаем "_$S(bf=1:"КЛЕТКУ",bf=2:"БЛОК",bf=3:"ТАБЛИЦУ",1:"ТЕКСТ")_" ,Вы уверены ? " D YES^%ZAPM.ed.BSF I 'YES G D
 I bf=4 D TXTREST^%ZAPM.ed.BSTT S $P(B,"@",23)=1 D 10^%ZAPM.ed.BSF S Quit=2 Q
 S %zT=$ZT,$ZT="ERV^%ZAPM.ed.BSF2" D REND,DEND I bf=1 S i=$O(^%ZAPM.ed.BSbufB(2,$G(%BS(3),$P),bf,"")),j=$O(^%ZAPM.ed.BSbufB(2,$G(%BS(3),$P),bf,i,"")),si=ny-i,sj=nx-j,ii=si+i,jj=sj+j D RESKL,RESB G RESEND
 I bf=3 S TRe1="^%ZAPM.ed.BSbufB(2,"_$G(%BS(3),$P)_",3" G:'$D(@(BSR_"(BST)")) D S TRe2=$P($ZR,")"),BSr=BSR,BSt=BST D TREE^%ZAPM.ed.BSTK,TRANS^%ZAPM.ed.BSS1 G RESEND
 D RESHOME K ^%ZAPM.ed.BSbufB("u"_$G(%BS(3),$P)_$J_"u"_%BS(15)) S si=ny-hi,sj=nx-hj S i="" F  S i=$O(^%ZAPM.ed.BSbufB(2,$G(%BS(3),$P),bf,i)) Q:'i  S j="" F  S j=$O(^%ZAPM.ed.BSbufB(2,$G(%BS(3),$P),bf,i,j)) Q:'j  D RESKL
 I mi>se!(mj>ke) S:mi>se se=mi S:mj>ke ke=mj D RESZER,RESB G RESEND
 D RESB
RESEND K ^%ZAPM.ed.BSbufB("u"_$G(%BS(3),$P)_$J_"u"_%BS(15)),z,z1,mi,mj,ii,jj,si,sj,se,ke,hi,hj,i,h
 K BSr1,BSr2,BSt2,BSt1
 S Quit=1 G E92E
RESZER F i=1:1:se F j=1:1:ke I '$D(@(BSR_"(BST,i,j)")) S @(BSR_"(BST,i,j)")="@@"_$P($G(@(BSR_"(BST,i,1)"),"@@1"),"@",3)_"@"_$P($G(@(BSR_"(BST,1,j)"),"@@@5"),"@",4)_"@@@@@1@@@@@@"
e Q
RESB S i="" F  S i=$O(^%ZAPM.ed.BSbufB("u"_$G(%BS(3),$P)_$J_"u"_%BS(15),i)) Q:i=""  S j="" F  S j=$O(^%ZAPM.ed.BSbufB("u"_$G(%BS(3),$P)_$J_"u"_%BS(15),i,j)) Q:j=""  S l=$P(^(j),",",2),h=$P(^(j),",") D
 .I j=1 F jj=1:1:ke I $D(@(BSR_"(BST,i,jj)")) S $P(@$ZR,"@",3)=h
 .I i=1 F ii=1:1:se I $D(@(BSR_"(BST,ii,j)")) S $P(@$ZR,"@",4)=l
 Q
RESKL S h=$P(^%ZAPM.ed.BSbufB(2,$G(%BS(3),$P),bf,i,j),"@",3),l=$P(^(j),"@",4),@(BSR_"(BST,i+si,j+sj)")=^(j) S:(i+si)>mi mi=i+si S:(j+sj)>mj mj=j+sj I (i+si)'=1,'$D(^%ZAPM.ed.BSbufB("u"_$G(%BS(3),$P)_$J_"u"_%BS(15),i+si,1)) S $P(^%ZAPM.ed.BSbufB("u"_$G(%BS(3),$P)_$J_"u"_%BS(15),i+si,1),",")=h
 I (j+sj)'=1,'$D(^%ZAPM.ed.BSbufB("u"_$G(%BS(3),$P)_$J_"u"_%BS(15),1,j+sj)) S $P(@$ZR,",",2)=l
 F f="FTR","FCL","COL","RTR","CMD" I $D(@(BSR_"(BST,f,si+i,sj+j)")) K @$ZR
RESKL1 F f="FTR","FCL","COL","RTR" I $D(^%ZAPM.ed.BSbufB(2,$G(%BS(3),$P),bf,f,i,j)) D  I YES S @(BSR_"(BST,f,si+i,sj+j)")=li1,^(sj+j,1)=li
 .D  I 'YES S $P(@(BSR_"(BST,si+i,sj+j)"),"@",$S(f="COL":13,f="FCL":7,f="RTR":16,1:8))=""
 ..S li=^(j,1) D SI^%ZAPM.ed.BSN N (%BS,vl,%zT,%KAT,%File,TIP,li,li1,BSB,BSR,BST,YES,f,se,ke,k0,k1,k2,k3,k4,k5,k6,k7,k8,k9)
 ..D ^%ZAPM.ed.BSFT Q
 I $D(^%ZAPM.ed.BSbufB(2,$G(%BS(3),$P),bf,"CMD",i,j)) S @(BSR_"(BST,""CMD"",si+i,sj+j)")=@$ZR,$P(@(BSR_"(BST,si+i,sj+j)"),"@",14)=(si+i)_","_(sj+j)
 Q
RESHOME S hi=$O(^%ZAPM.ed.BSbufB(2,$G(%BS(3),$P),bf,"")),hj=9999999,i="" F  S i=$O(^%ZAPM.ed.BSbufB(2,$G(%BS(3),$P),bf,i)) Q:'i  S j=$O(^%ZAPM.ed.BSbufB(2,$G(%BS(3),$P),bf,i,"")) I j<hj S hj=j
 Q
E91 S s=ny D E999 G D:'YES D WAIT,DEND
 F i=se:-1:s+1  F j=1:1 Q:'$D(@(BSR_"(BST,i,j)"))  D E99,EE91
 F i=s+1:1:s+li F j=1:1 Q:'$D(@(BSR_"(BST,s,j)"))  D E99I,EE91Z
 G E92E
EE91Z S @(BSR_"(BST,i,j)")=i1 Q
EE91 S @(BSR_"(BST,i+li,j)")=i1 F f="FTR","FCL","COL","RTR" I f(f)'="" S @(BSR_"(BST,f,i+li,j)")=f(f),^(j,1)=f(f,1)
 Q
E92 S k=nx D E999 G D:'YES D WAIT,REND
 F i=1:1 Q:'$D(@(BSR_"(BST,i)"))  D  ;
 .F j=ke:-1:k+1 I $D(@(BSR_"(BST,i,j)")) D E99,EE92
 .F j=k+1:1:k+li I $D(@(BSR_"(BST,i,k)")) D E99I,EE91Z
 K Quit
E92E D TAB^%ZAPM.ed.BSF1,TIT^%ZAPM.ed.BST,TIP^%ZAPM.ed.BST,W^%ZAPM.ed.BST,MEO^%ZAPM.ed.BSF S $ZT=$G(%zT) Q:$G(Quit)  G B^%ZAPM.ed.BSTM
EE92 S @(BSR_"(BST,i,j+li)")=i1 F f="FTR","FCL","COL","RTR" I f(f)'="" S @(BSR_"(BST,f,i,j+li)")=f(f),^(j+li,1)=f(f,1)
 Q
E999 S li=1,ls=" Сколько Строк / Колонок" D LI Q
D G 0^%ZAPM.ed.BSTM
WAIT S ls="ЖДИТЕ"
WAITS S WA="" I $D(GuiCall) W "<P>"_BLUE_ls_EF_"</P>" Q
 Q:$G(TIP)=7&($G(BST)'["@")  Q:$D(%BS)["0"  Q:$G(CALCFON)
 ;U $I:(0::::#10080)
 W /CUP(24,1),$$atr^%ZAPM.ed.BS3(0),/EL(0),$$clr^%ZAPM.ed.BS3(12),"...",$E(ls,1,67),"...",$$atr^%ZAPM.ed.BS3(0)
WAI S WAI=0,WA="S WAI=WAI+1 I '(WAI#2) W $$atr^%ZAPM.ed.BS3(0),/CUP(24,"_($L($E($G(ls),1,67))+7)_"),WAI" W /CUP(25,1),/EL(0)
 Q
E99 S i1=@$ZR F f=15,7,6,8,13 S $P(@$ZR,"@",f)=""
 K f F f="RTR","FTR","FCL","COL" S f(f)=$G(@(BSR_"(BST,f,i,j)")),z=$ZR,f(f,1)=$G(^(j,1)) K @z
 Q
E99I S i1=@$ZR,$P(i1,"@",15)="",$P(i1,"@",7)="",$P(i1,"@",5)="",$P(i1,"@",8)="",$P(i1,"@",13)="",$P(i1,"@",16)="" Q
E131 S s=ny D E999 G D:'YES D WAIT,DEND I li>(se-s) S li=se-s
 F i=s+li+1:1:se  F j=1:1 Q:'$D(@(BSR_"(BST,i,j)"))  D E99,E13S1
 F i=se-li+1:1:se F j=1:1 Q:'$D(@(BSR_"(BST,i,j)"))  D E13K
 K Quit G E92E
E13S1 S @(BSR_"(BST,i-li,j)")=i1 F f="FTR","FCL","COL","RTR" I f(f)'="" S @(BSR_"(BST,f,i-li,j)")=f(f),^(j,1)=f(f,1)
 Q
E13S2 S @(BSR_"(BST,i,j-li)")=i1 F f="FTR","FCL","COL","RTR" I f(f)'="" S @(BSR_"(BST,f,i,j-li)")=f(f),^(j-li,1)=f(f,1)
 Q
E13K K @(BSR_"(BST,i,j)"),@(BSR_"(BST,""FTR"",i,j)"),@(BSR_"(BST,""FCL"",i,j)"),@(BSR_"(BST,""COL"",i,j)"),@(BSR_"(BST,""RTR"",i,j)") Q
E132 S k=nx D E999 G D:'YES D WAIT,REND I li>(ke-k) S li=ke-k
 F i=1:1 Q:'$D(@(BSR_"(BST,i)"))  D  ;
 .F j=k+li+1:1:ke I $D(@(BSR_"(BST,i,j)")) D E99,E13S2
 .F j=ke-li+1:1:ke I $D(@(BSR_"(BST,i,j)")) D E13K
 G E92E
ColMax S ColM=0
REND ;ke-ПОСЛЕДНЯЯ КОЛОНКА
 F j=1:1 Q:'$D(@(BSR_"(BST,1,j)"))  I $D(ColM),$P(@BSR@(BST,1,j),"@",4)>ColM S ColM=$P(@BSR@(BST,1,j),"@",4)
 S ke=j-1 Q
StrMax S StrM=0
DEND ;se-ПОСЛЕДНЯЯ СТРОКА
 F i=1:1 Q:'$D(@(BSR_"(BST,i)"))  I $D(StrM),$P(@BSR@(BST,i,1),"@",3)>StrM S StrM=$P(@BSR@(BST,i,1),"@",3)
 S se=i-1 Q
BS I $D(%TIT) S ls=" Сначало снимите титул !!! " D O^%ZAPM.ed.BSF7 Q
 S li=$P(@(BSR_"(BST)"),"@",8,11),li=$TR(li,"@",",") D  D LI Q:'YES  I $P(li,",")<1&($P(li,",")>22)!($P(li,",")>$P(li,",",3))!($P(li,",",2)>$P(li,",",4)) S ls=" Некорректные границы " D O^%ZAPM.ed.BSF7 G BS
 .S ls=" Корректируйте :Y1,X1,Y2,X2"
 D ColMax,StrMax I ($P(li,",",3)-$P(li,",")+1)<StrM D ErrMsg^%ZAPM.ed.BSXfun(" Высота окна меньше Максимальной высоты строки в Таблице") G BS
 I ($P(li,",",4)-$P(li,",",2)+1)<ColM D ErrMsg^%ZAPM.ed.BSXfun(" Ширина окна меньше Максимальной длины колонки в Таблице") G BS
 S li=$TR(li,",","@"),$P(@(BSR_"(BST)"),"@",8,11)=li D TIT^%ZAPM.ed.BST
BSSS W /ED(2) D W^%ZAPM.ed.BST,KLE^%ZAPM.ed.BSTM,W^%ZAPM.ed.BSTM Q
I1 S $P(@(BSR_"(BST)"),"@",12)=1,$P(^(BST),"@",14)=1,$P(^(BST),"@",13)="" G II
I2 S $P(@(BSR_"(BST)"),"@",12)="",$P(^(BST),"@",14)="",$P(^(BST),"@",13)=1 G II
I3 S $P(@(BSR_"(BST)"),"@",12)="",$P(^(BST),"@",14)="",$P(^(BST),"@",13)=""
II S B=@$ZR D MR^%ZAPM.ed.BST Q
FK1 D R^%ZAPM.ed.BSF4(15,1) G II
FK2 D R^%ZAPM.ed.BSF4(15,"") G II
Z0 D R^%ZAPM.ed.BSF4(16,"") G II
Z1 D R^%ZAPM.ed.BSF4(16,1) G II
TT0 S $P(@(BSR_"(BST)"),"@",19)="" D TIT^%ZAPM.ed.BST,W^%ZAPM.ed.BST K MY,MX D KLE^%ZAPM.ed.BSTM G D
TT1 I $D(%TIT) W $$bel^%ZAPM.ed.BS3 G D
 I '(BSX(0)=1&(BSY(0)=1)) S ls=" УСТАНОВИТЕ ТАБЛИЦУ НА НАЧАЛО:<Home><Home><Home> " D O^%ZAPM.ed.BSF7 G D
 ;I '$$CHECKTIT ;КОНТРОЛЬ НА РАЗМЕРЫ ОСТАВШЕГОСЯ ОКНА
 S $P(@BSR@(BST),"@",19)=ny_","_nx,B=@$ZR D TIT^%ZAPM.ed.BST S BSY(BS0)=$P($G(%TIT,1),","),BSX(BS0)=$P($G(%TIT,"1,1"),",",2) D TW^%ZAPM.ed.BST
 D KLE^%ZAPM.ed.BSTM G D
V1 S i=1 G V
V2 S i=2 G V
V3 S i=3 G V
V4 S i=4
V D R^%ZAPM.ed.BSF4(18,i) Q
ERV S ls=$ZE D O^%ZAPM.ed.BSF7 W $$r^%ZAPM.ed.BS3 K:$E(BST,1)="@" @(BSR_"(BST)") S R1=27 G END^%ZAPM.ed.BSF
]]></Routine>


<Routine name="%ZAPM.ed.BSF3" type="MAC" languagemode="0"><![CDATA[
%BSF3 ;ПЕРЕНАСЧЕТ,ЛОГИЧЕСКИЙ КОНТРОЛЬ,ОКНА,ТАБ&КОМ ; 13:19   09.08.2000
 Q
FOR S VYC=$P($G(@BSR@(BST)),"@",18) I VYC="" S VYC=1
 S se=$P(@$ZR,"@",28),ke=$P(@$ZR,"@",29)
 S I=$S(VYC=1:"F ny=1:1:se F nx=1:1:ke",VYC=2:"F ny=se:-1:1 F nx=1:1:ke",VYC=3:"F ny=1:1:se F nx=ke:-1:1",1:"F ny=se:-1:1 F nx=ke:-1:1")
 Q
 ;ВЫЧИСЛЕНИЯ
CALC Q:'$D(@BSR@(BST,"FCL"))
 D L^%ZAPM.ed.BS3($NA(@BSR@(BST))) I 'LOC Q
 D FOR S WA="",ls="ВычислениЯ" D WAITS^%ZAPM.ed.BSF2
 S %zT=$ZT,$ZT="ERR^%ZAPM.ed.BSF3" N BsD
 I '$P(@BSR@(BST),"@",32),VYC=1 S ny="",nx="" F  S ny=$O(@(BSR_"(BST,""FCL"",ny)")) G:ny="" 6666 F  S nx=$O(@(BSR_"(BST,""FCL"",ny,nx)")) Q:nx=""  D CAL
 X I_" D CAL"
6666 S $ZT=$G(%zT) I '$D(BX) D U^%ZAPM.ed.BS3($NA(@BSR@(BST))) Q
 I WAI D MED^%ZAPM.ed.BSF S:$D(BsD) $P(^%ZAPM.ed.BSbufB("BB"_$G(%BS(3),$P)_$J_"u"_%BS(15)),"@",2)=1
666 S do="I ""23""'[$P(@$ZR,""@"",7) D W^%ZAPM.ed.BSTM" D U^%ZAPM.ed.BS3($NA(@BSR@(BST)))
66 I '$D(BX) D U^%ZAPM.ed.BS3($NA(@BSR@(BST))) Q
 S iy=MY,ix=MX,MR=0,MY="" F  S MY=$O(BY(MY)) Q:MY=""  S MX="" F  S MX=$O(BX(MX)) Q:MX=""  I $D(@(BSR_"(BST,"_BY(MY)_","_BX(MX)_")")) X do
 S MY=iy,MX=ix,MR=1 K iy,ix
 Q
CAL S %zT=$ZT,$ZT="ERR^%ZAPM.ed.BSF3" //добавил ловушку
 Q:"2345"[$P(@(BSR_"(BST,ny,nx)"),"@",7)  X $G(WA) K d1 I $P(@$ZR,"@",7)?.N1",".N Q:'$D(@(BSR_"(BST,""FCL"","_$P(@$ZR,"@",7)_")"))  X $$TR(@$ZR,"^%ZAPM.ed.BSA","") G CAL1
 X $$TR($G(@BSR@(BST,"FCL",ny,nx)),"^%ZAPM.ed.BSA","")
CAL1 I $P($G(@BSR@(BST,ny,nx),"@@@@@@@@1"),"@",9)=1 S $P(^(nx),"@",15)=$S(d1["@":"<!.!ERROR!.!>",1:d1) Q
 E  S ^%ZAPM.ed.BSbufB("BB"_$G(%BS(3),$P)_$J_"u"_%BS(15),ny,nx)=$G(d1),BsD=1
 Q
ERRO S ls=" Ошибка В вызванной Таблице " D O^%ZAPM.ed.BSF7 S ls=$ZE D O^%ZAPM.ed.BSF7 R *i:0,*i,*i S $ZT=$G(%zT) Q
ERR S d1=" Ошибка: "_$S($ZE["<DIV":"DIVIDE",1:$ZE) W $$bel^%ZAPM.ed.BS3 Q:'$D(@(BSR_"(BST,ny,nx)"))
 I $P(@$ZR,"@",9)=1,$D(d1) S $P(@$ZR,"@",15)=d1 K d1 Q
 E  S ^%ZAPM.ed.BSbufB("BB"_$G(%BS(3),$P)_$J_"u"_%BS(15),ny,nx)=d1 K d1
 Q
 ;
 ;ЛОГИКА
COL Q:$P(B,"@",27)
CALOGIC Q:'$D(@(BSR_"(BST,""COL"")"))  S ls="ЛОГИЧЕСКИЙ КОНТРОЛЬ "_$G(uzel)
 D FOR,WAITS^%ZAPM.ed.BSF2 S lo=0,YES=0,Ny=ny,Nx=nx,%zT=$ZT,$ZT="PRO^%ZAPM.ed.BSF3"
 I '$P(@(BSR_"(BST)"),"@",33) S ny="",nx="" F  S ny=$O(@(BSR_"(BST,""COL"",ny)")) G:ny="" LLLL F  S nx=$O(@(BSR_"(BST,""COL"",ny,nx)")) Q:nx=""  D LOG
 X I_" D LOG"
LLLL S $ZT=$G(%zT) I $D(uzel) D:lo LOGS^%ZAPM.ed.BSLOG Q  ;```D:lo LOGS^%ZAPM.ed.BSF6 Q
 K ^%ZAPM.ed.BSbufB("LOGS"_$G(%BS(3),$P)_$J_$P($$ZU^%ZAPM.ed.BS3(1,0),",",2)_"u1")
 I lo I '$E($P(B,"@",48),2) D LOB I YES D LOGS^%ZAPM.ed.BSLOG ;```D LOGS^%ZAPM.ed.BSF6
 S do="I $P(@$ZR,""@"",12) D W^%ZAPM.ed.BSTM" G 66
PRO I $ZE'["<PRO" S ls=$ZE D O^%ZAPM.ed.BSF7
 S $ZT=$G(%zT) Q
LOG Q:$P(@BSR@(BST,ny,nx),"@",13)=""  X WA S (d0,d,d1)=$S($P(@(BSR_"(BST,ny,nx)"),"@",9)=1:$P(^(nx),"@",15),1:$G(^%ZAPM.ed.BSbufB("BB"_$G(%BS(3),$P)_$J_"u"_%BS(15),ny,nx)))
 ;```I $P(@(BSR_"(BST,ny,nx)"),"@",13) X $G(@(BSR_"(BST,""COL"","_$P(^(nx),"@",13)_")")) S:'$T lo=lo+1 S $P(@BSR@(BST,ny,nx),"@",11)=$S($T:"",1:1) Q:'$P(B,"@",48)  D:'$T VLOG($NA(@(BSR_"(BST,""COL"","_$P(^(nx),"@",13)_")"))) Q
 ;```I $P(@(BSR_"(BST,ny,nx)"),"@",13)=0 X $G(@(BSR_"(BST,""COL"",ny,nx)")) S:'$T lo=lo+1 S $P(@BSR@(BST,ny,nx),"@",11)=$S($T:"",1:1) Q:'$P(B,"@",48)  D:'$T VLOG($NA(@(BSR_"(BST,""COL"",ny,nx)"))) Q
 I $P(@(BSR_"(BST,ny,nx)"),"@",13) X $$TR($G(@(BSR_"(BST,""COL"","_$P(^(nx),"@",13)_")")),"^%ZAPM.ed.BSA","") S:'$T lo=lo+1 S $P(@BSR@(BST,ny,nx),"@",11)=$S($T:"",1:1) Q:'$E($P(B,"@",48),1)  D:'$T VLOG($NA(@(BSR_"(BST,""COL"","_$P(^(nx),"@",13)_")"))) Q
 I $P(@(BSR_"(BST,ny,nx)"),"@",13)=0 X $$TR($G(@(BSR_"(BST,""COL"",ny,nx)")),"^%ZAPM.ed.BSA","") S:'$T lo=lo+1 S $P(@BSR@(BST,ny,nx),"@",11)=$S($T:"",1:1) Q:'$E($P(B,"@",48),1)  D:'$T VLOG($NA(@(BSR_"(BST,""COL"",ny,nx)"))) Q
 Q
LOB S ls=" Найдено "_lo_" ОШИБОК ! Будем СМОТРЕТЬ СПИСОК ЛОГИЧЕСКИХ НЕСООТВЕТСТВИЙ ? " W $$bel^%ZAPM.ed.BS3 D YESp^%ZAPM.ed.BSF Q
VLOG(FL) ;ВЫЧИСЛЕНИЕ ДАННЫХ В КЛЕТКАХ
 Q:'$D(@FL@(1))  N i,ii,iii,vi
 S (iii,FL)=@$ZR
 I FL["{" F i=2:1 Q:$P(FL,"{",i,i+1)=""  S ii=$P($P(FL,"{",i),"}") X "S vi=$$A^%ZAPM.ed.BSA("_ii_")" S iii=$$TR^%ZAPM.ed.BSsFUNM(iii,"{"_ii_"}",+vi)
 I FL'=iii S ^%ZAPM.ed.BSbufB("VarLogS"_$G(%BS(3),$P)_$J_"u1",$NA(@BSR@(BST,ny,nx)))=iii,$P(@BSR@(BST,ny,nx),"@",11)=1
 Q
O S ls=" РЕЖИМ В ПРОЦЕССЕ ОТЛАДКИ " D O^%ZAPM.ed.BSF7 Q
C R *R,*RR:0,*RR:0
CW D RE^%ZAPM.ed.BSsBUF W $$atr^%ZAPM.ed.BS3(0) K COLO Q
WIN1 ;ОТКРЫТИЕ ПСЕВДО-ОКНА
WIND D SA^%ZAPM.ed.BSsBUF
 W $$clr^%ZAPM.ed.BS3($G(COLO,3)),/ED(2) Q
GLO S:$E($G(li))'="^" li="^" S ll="",ls=" "_$namespace_": Enter the name of the global array. Enter * - directory",%HIS="^%ZAPM.ed.BSbufB(""HISARREY"_$S('$E(%BS(1),12):$G(%BS(3),$P)_$G(%BS(12)),$E(%BS(1),12)=1:"1"_$G(%BS(12)),1:"1")_""")" D LE^%ZAPM.ed.BSTT I 'YES Q
 I li="^" S YES=0 Q
GL I li["~D"||(li["*") S GL="~D",YES=1 Q
 S %zT=$ZT,$ZT="NGLO^%ZAPM.ed.BSF3" I '$D(@li)
 S $ZT=$G(%zT),GL=li,YES=1 Q
BUF D BU Q
BU D ErrMsg^%ZAPM.ed.BSXfun("РЕЖИМ ОТМЕНЕН !!!")
 Q
SAVE S %Y1=1,%X1=1,%Y2=25,%X2=80 G 3^%ZAPM.ed.BSsBUF
VB0 S $P(@(BSR_"(BST)"),"@",21)="",B=@$ZR K @(BSR_"(BST,""VST"")") Q
VB1 D BU Q
VS0 S $P(@(BSR_"(BST)"),"@",23)=1,B=@$ZR K @(BSR_"(BST,""STA"")") Q
VS1 S $P(@(BSR_"(BST)"),"@",23)="",B=@$ZR Q
 ;
CMD S li="" I $P(BS,"@",14)=(ny_","_nx) S li=ny_","_nx,li=$G(@(BSR_"(BST,""CMD"","_li_")"),"???")
 S ls=" Вводите / Корректируйте команду MSM (F1-Помощь)",ll="",%hlp="^%ZAPM.ed.BSHLP(H_CMD" D LE^%ZAPM.ed.BSTT I 'YES G QUIT
 I li="" S $P(@(BSR_"(BST,ny,nx)"),"@",14)="" K @(BSR_"(BST,""CMD"",ny,nx)") G QUIT
 E  S $P(@(BSR_"(BST,ny,nx)"),"@",14)=ny_","_nx,@(BSR_"(BST,""CMD"",ny,nx)")=li
 S XEC=li I li?.N1",".N S XEC=@(BSR_"(BST,""CMD"","_li_")")
 D command S $ZT=$G(%zT)
QUIT Q
XEC S XEC=$G(@(BSR_"(BST,""CMD"","_IYI_")")) D command S li=$G(li) Q
command S r=$G(BSR),t=$G(BST) D SA^%ZAPM.ed.BSsBUF,ZR,OP^%ZAPM.ed.BSF4,UCIS,comm,UCIR,RE^%ZAPM.ed.BSsBUF,CL^%ZAPM.ed.BSF4 Q
comm D SI^%ZAPM.ed.BSN,NNN^%ZAPM.ed.BSN(",r,t,nx,ny,XEC,d") S %zT=$ZT,$ZT="ERCMD" X XEC U $I::%BS(32)
ECMD S $ZT=$G(%zT) G REBUF
REBUF D QQQ^%ZAPM.ed.BSN(",r,t,nx,ny,li,R1") Q
UCIS S uci=$$ZU^%ZAPM.ed.BS3(0) Q
UCIR Q:$G(uci)=$$ZU^%ZAPM.ed.BS3(0)   q:'$d(uci)  //$G(
  D %GU^%ZAPM.ed.BSF4 H:uci'=$$ZU^%ZAPM.ed.BS3(0)  
  Q
ZR Q:r=""!(t="")!('$D(ny))!('$D(nx))  I $D(@(BSR_"(BST,ny,nx)"))
 Q
C3 S (i,%CAL)=2 G CA
C1 S (i,%CAL)=1 G CA
C2 S i="" K %CAL
CA D R^%ZAPM.ed.BSF4(20,i) Q
TAB S l4=14
TAB2 S li=$P(@(BSR_"(BST,ny,nx)"),"@",l4) S:li?.N1",".N li="" D TIR^%ZAPM.ed.BST4
TAB1 D RIT I 'YES Q
 I li="" S $P(@(BSR_"(BST,ny,nx)"),"@",l4)="" Q
 I BSr=BSR,BSt=BST S ls=" ОСТОРОЖНО !!! Рекурсив !!! " D O^%ZAPM.ed.BSF7 G TAB1
 S TmP=$S($D(PBD):PBD,1:$$GLOBAL^%ZAPM.ed.BSF9(BSr_","_BSt)) K PBD S $ZT=$G(%zT)
 ;;;S $P(@(BSR_"(BST,ny,nx)"),"@",l4)=$S(BSr'["]%":BSr,1:"^"_$P(BSr,"]",2,99))_","_BSt D:$D(PBD)  K PBD S $ZT=$G(%zT) D NEW^%ZAPM.ed.BSN ;!!!I $D(%CAL) D CALC
 ;;;.S $P(@(BSR_"(BST,ny,nx)"),"@",l4)=PBD
 S $P(@(BSR_"(BST,ny,nx)"),"@",l4)=TmP
 D NEW^%ZAPM.ed.BSN
 Q
G G D^%ZAPM.ed.BS
SE D SA^%ZAPM.ed.BSsBUF Q
RE D RE^%ZAPM.ed.BSsBUF Q
RIT ;РАЗДЕЛ И ТАБЛИЦА --> BSr,BSt   NoCheck=1 - НЕ ПРОВЕРЯТЬ СУЩЕСТВОВАНИЕ
 S YES=1,%hlp="^%ZAPM.ed.BSHLP(RIT",ls=" ВВОДИТЕ ссылку на таблицу:(TABL,PART,UCI,SYS) <F3>-КАТАЛОГ <F1>-ПОМОЩЬ",ll=" @",%KAT="D DIR^%ZAPM.ed.BSF6" D LE^%ZAPM.ed.BSTT Q:li=""  I 'YES S li="" Q
RII S BSr=$P(li,",",2),BSt=$P(li,","),BSu=$P(li,",",3),BSs=$P(li,",",4),%zT=$ZT,$ZT="NOFILE^%ZAPM.ed.BSF3" G:$E(BSr,1,2)["%" %RIT S:BSu="" BSu=$P($$ZU^%ZAPM.ed.BS3(0),",") S:BSs="" BSs=$P($$ZU^%ZAPM.ed.BS3(0),",",2) S:BSr="" BSr=$S(BSR["]":$P(BSR,"]",2),1:$P(BSR,"^",2))
 I '$D(@("^["""_BSu_""","""_BSs_"""]"_BSr)) G NOR
RI S TmP=$$BSR^%ZAPM.ed.BSA($ZR) I BSt="<INV>",$G(@$ZR)["%BS-invert-" S ls=" ВЫ ХОТИТЕ ВЫЗЫВАТЬ ФОРМИРУЕМУЮ ТАБЛИЦУ КОДИФИКАТОРА ? " D YES^%ZAPM.ed.BSF G:'YES RIT S BSr=$P(TmP,"(") Q
 I '$G(NoCheck),'$D(@TmP@(BSt)) S ls=" Таблицы "_$ZR_" не существует " D O^%ZAPM.ed.BSF7 S YES=0 Q:$D(MaS)  G RIT
 I li["<>",$P(@$ZR,"@",17)=2 S ls=" ВЫ ХОТИТЕ ВЫЗЫВАТЬ ФОРМИРУЕМУЮ ТАБЛИЦУ ЗНАЧЕНИЙ КЛЮЧЕЙ БАЗЫ ДАННЫХ ? ",PBD=li D YES^%ZAPM.ed.BSF G:'YES RIT S BSr=$P(TmP,"(") Q
 S BSr=$P(TmP,"("),YES=1 Q
%RIT S:BSr'["^" BSr="^"_BSr G NOR:'$D(@BSr),RI
NOR S ls=" Раздела "_$ZR_" не существует " D O^%ZAPM.ed.BSF7 S YES=0 Q:$D(MaS)  G RIT
NOFILE S ls=" Ошибка В Cсылке на Раздел и Таблицу "_$ZE D O^%ZAPM.ed.BSF7 S $ZT=$G(%zT),YES=0 G RIT
ERCMD S ls=" Ошибка:"_$ZE_$$ErrSay^%ZAPM.ed.BSF8($ZE) D O^%ZAPM.ed.BSF7 G ECMD
ERROR ;S ls=" Ошибка В Команде "_$ZE D O^%ZAPM.ed.BSF7 S $ZT=$G(%zT) D REBUF,UCIR,RE^%ZAPM.ed.BSsBUF,CL^%ZAPM.ed.BSF4 G G
 W $$bel^%ZAPM.ed.BS3 D REBUF,UCIR,RE^%ZAPM.ed.BSsBUF,CL^%ZAPM.ed.BSF4 G G
CMDERR ;S ls=" Ошибка В Команде "_$ZE D O^%ZAPM.ed.BSF7 S $ZT=$G(%zT) D REBUF G CMD
 W $$bel^%ZAPM.ed.BS3 D REBUF G CMD
NOGLO S ls=" Ошибка В Cсылке НА МАССИВ "_$ZE D O^%ZAPM.ed.BSF7 S $ZT=$G(%zT) G BU
NGLO S ls=" Ошибка В Cсылке НА МАССИВ "_$ZE D O^%ZAPM.ed.BSF7 S $ZT=$G(%zT),YES=0 Q
SAVED ;СОХР ДАННЫХ В БУФЕРE
 K ^%ZAPM.ed.BSbufB(0,$G(%BS(3),$P),3) S do="S li=$S($P(^(j),""@"",9)=1:$P(^(j),""@"",15),1:$G(^%ZAPM.ed.BSbufB(""BB""_$G(%BS(3),$P)_$J_""u""_%BS(15),i,j))) S:li'="""" ^%ZAPM.ed.BSbufB(0,$G(%BS(3),$P),3,i,j)=li",ls="СОХРАНЯЕТСЯ" D WAITS^%ZAPM.ed.BSF2,BLOK^%ZAPM.ed.BSF1 G G
RESTO ;ВОССТ ДАННЫХ ИЗ БУФЕРА
 S i="",ls="ВОССТАНОВЛЕНИЕ" D WAITS^%ZAPM.ed.BSF2 F  S i=$O(^%ZAPM.ed.BSbufB(0,$G(%BS(3),$P),3,i)) Q:i=""  S j="" F  S j=$O(^%ZAPM.ed.BSbufB(0,$G(%BS(3),$P),3,i,j)) Q:j=""  S li=^(j) I $D(@(BSR_"(BST,i,j)")) D
 .I $P(^(j),"@",5)!($D(%ZAP)) Q
 .I $P(^(j),"@",9)=1 S $P(^(j),"@",15)=li Q
 .S $P(^%ZAPM.ed.BSbufB("BB"_$G(%BS(3),$P)_$J_"u"_%BS(15)),"@",2)=1 S ^%ZAPM.ed.BSbufB("BB"_$G(%BS(3),$P)_$J_"u"_%BS(15),i,j)=li Q
 D TIT^%ZAPM.ed.BST,W^%ZAPM.ed.BST G G
 ;
 ;МОДУЛЬ ИЗ %BSA
 ;
A(p1,p2,p3,p4,p5,p6,p7,p8,p9,p10,p11,p12,p13,p14,p15,p16) S pp=$P($G(BSR),"^",2),ps=$S(pp'[",":$P($$ZU^%ZAPM.ed.BS3(0),",",2),1:$P(pp,$C(34),4))
 S pu=$S(pp'["[":$P($$ZU^%ZAPM.ed.BS3(0),","),1:$P(pp,$C(34),2)),pt=$G(BST) I $E(pp,1)="[" S pp=$P(pp,"]",2)
 S %zT=$ZT,$ZT="TRAP^%ZAPM.ed.BSA"
 I $D(p4) S pp=p4 I pp["^" S pp=$P(pp,"^",2)
 I $G(p3)'="" S pt=p3
 I $G(p5)'="" S pu=$TR(p5,"[]|""","") I pu["," S ps=$P(pu,",",2),pu=$P(pu,",")
 I $G(p6)'="" S ps=$TR(p6,"[]|""","") I ps["," S pu=$P(ps,","),ps=$P(ps,",",2)
 ;I $E(pp,1)="%" S pp="^"_pp ;`BSA
 S pp="^["""_pu_""","""_ps_"""]"_pp
 I $D(@(pp_"(pt,p1,p2)"))
 S bS=$ZR I $P(@pp@(pt,p1,p2),"@",9)=1 Q $P($G(@$ZR),"@",15)
 I '$D(p8),BST=pt,$$BSR(BSR)=pp Q $G(^%ZAPM.ed.BSbufB("BB"_$G(%BS(3),$P)_$J_"u"_%BS(15),p1,p2))
 S pb=$$KBD^%ZAPM.ed.BSF12($NA(@pp@(pt))),pb=$$BSD(pb,$G(p7))
 F pi=1:1:9 Q:'$D(^(pi))  Q:'$D(@("p"_(pi+7)))  S pb=pb_$S(@("p"_(pi+7))=+@("p"_(pi+7)):@("p"_(pi+7)),1:$C(34)_@("p"_(pi+7))_$C(34))_","
 S pij=p1_","_p2 I $P($G(@pp@(pt,"KEY",pi-1)),"@",6)="HiddenLastKey",$P($P(@(pp_"(pt,p1,p2)"),"@",18),"#",2)'="" D  Q $G(@$ZR,"<NO_VALUE>")
 .S pij=$P($P(@$ZR,"@",18),"#",2) I $D(@(pb_$C(34)_pij_""")"))
 I $P($P(@(pp_"(pt,p1,p2)"),"@",18),"#")'="" S pij=$P($P(@$ZR,"@",18),"#")
 I $D(@(pb_$C(34)_pij_""")")) Q @$ZR
 Q "<NO_VAL>"  ;$ZR
BSD(BSD,%NAm) ;ССЫЛКА НА УЗЕЛ БАЗЫ ДАННЫХ
 S %NAm=BSD_$G(%NAm)_$S(BSD["(":"",1:"(") I $E(%NAm,$L(%NAm))=")" S %NAm=$E(%NAm,1,$L(%NAm)-1)_","
 Q %NAm
BSR(bsr) N bs ;ПОЛНАЯ ССЫЛКА
 I $E(bsr,1,2)="^%" Q $$%^%ZAPM.ed.BSF12(bsr)
 ;4.;I $P($ZV,"Version ",2)'<4,bsr'["|" Q "^|"""_$P($$ZU^%ZAPM.ed.BS3(0),",")_""","""_$P($$ZU^%ZAPM.ed.BS3(0),",",2)_"""|"_$P(bsr,"^",2)
 ;4.;I $P($ZV,"Version ",2)'<4,$P(bsr,"|",2)'["," S bs=$P($P(bsr,"|",2),$C(34),2) Q "^|"""_bs_""","""_$P($$ZU^%ZAPM.ed.BS3(0),",",2)_"""|"_$P(bsr,"|",2)
 I bsr'["]" Q "^["""_$P($$ZU^%ZAPM.ed.BS3(0),",")_""","""_$P($$ZU^%ZAPM.ed.BS3(0),",",2)_"""]"_$P(bsr,"^",2)
 I $P($P(bsr,"]"),"[",2)'["," S bs=$P($P($P(bsr,"]"),"[",2),$C(34),2) Q "^["""_bs_""","""_$P($$ZU^%ZAPM.ed.BS3(0),",",2)_"""]"_$P(bsr,"]",2)
 Q bsr
TR(%1,%2,%3) N p,l,l3 ;ТРАНСФОРМАЦИЯ !!!!!ИЗ %BSsFUNM
 I %2="" Q %1
 I %1'[%2 Q %1
 S p=1,l=$L(%2),l3=$L(%3),%z=$ZT,$ZT="TRMAX^%ZAPM.ed.BSsFUNM"
 F  S p=$F(%1,%2,p) Q:p=0  S $E(%1,p-l,p-1)=%3,p=p+l3-l
 S $ZT=$G(%z) Q %1
TRMAX W $$bel^%ZAPM.ed.BS3 S $ZT=$G(%z) Q %1
]]></Routine>


<Routine name="%ZAPM.ed.BSF4" type="MAC" languagemode="0"><![CDATA[
%BSF4 ;РЕДАКТИРОВАНИЕ ОПЦИЙ ТАБЛИЦЫ ; 10:34   05.07.2001
D G 0^%ZAPM.ed.BSTM
E1561 G TT0^%ZAPM.ed.BSF2
E1562 G TT1^%ZAPM.ed.BSF2
E15103 D ErrMsg^%ZAPM.ed.BSXfun("ЭТО УЖЕ РУДИМЕНТ !") G D
E151011 G USM
E151012 S $P(@(BSR_"(BST)"),"@",17)=1 K @(BSR_"(BST,""USM"")") D TIP^%ZAPM.ed.BST G D
USM I TIP'=7,TIP>1 S ls=" ПОЛЬЗОВАТЕЛЬСКИМ МЕНЮ МОЖЕТ БЫТЬ ТОЛЬКО ПРОСТАЯ ТАБЛИЦА " D O^%ZAPM.ed.BSF7 G D
 I $D(%TIT) S ls=" СНИМИТЕ ТИТУЛ С ТАБЛИЦЫ " D O^%ZAPM.ed.BSF7 G D
 D LONG S i1=$S(LY'<17:6,1:5+((17-LY)\2)),i2=(80-LX)\2-1,i3=i1+LY-1 S:i2<2 i2=2 S i4=i2+LX-1 S:i3>22 i3=22 S:i4>78 i4=78 I $D(@(BSR_"(BST)")) F i=1:1:4 S $P(@$ZR,"@",7+i)=@("i"_i)
 F i=12,13,14,15,18,21 S $P(@$ZR,"@",i)=""
 F i=16,25,34 S $P(@$ZR,"@",i)=1
 S $P(@(BSR_"(BST)"),"@",17)=7,TIP=7
 D SETMENU($ZR)
 K CCC,LY,LX,i1,i2,i3,i4,BFL,%ZAP G 10^%ZAPM.ed.BSF
SETMENU(G) N A S A=$P(@G,"@",41) S A=$$TR^%ZAPM.ed.BSsFUNM(A,",MENU^%ZAPM.ed.BSF11","")
 I A["MENU^%ZAPM.ed.BSF11" S $P(@G,"@",41)=A Q
 S $P(@G,"@",41)="MENU^%ZAPM.ed.BSF11"_$S(A'="":","_A,1:"")
 Q
LONG D DEND^%ZAPM.ed.BSF2,REND^%ZAPM.ed.BSF2 S LY=$P(@(BSR_"(BST,se,1)"),"@")+$P(^(1),"@",3)-1,LX=$P(@(BSR_"(BST,1,ke)"),"@",2)+$P(^(ke),"@",4)-1 Q
E15102 S ls=" ВЫ ХОТИТЕ ЧТОБЫ ВАША ТАБЛИЦА СТАЛА ТЕКСТОМ ? " D YES^%ZAPM.ed.BSF I 'YES G D ;TEXT
 D OOO G D:'YES D TXT^%ZAPM.ed.BSTT,R(17,5) K %ZAP S $P(B,"@",23)=1 G 10^%ZAPM.ed.BSF
E15111 D R(25,"") Q
E15112 D R(25,1) Q
E15151 D R(34,"") Q
E15152 D R(34,1) Q
E15121 D R(26,1) Q
E15122 D R(26,"") Q
E15131 D R(27,"") Q  ;ЛОГИКА
E15132 D R(27,1) Q
E151621 D R(35,"") Q  ;СПИСКИ
E151622 S li=$P(B,"@",35),li=$S("1"[li:2,1:li),ls="'ДЛИНА#X1,X2,...,Xn' ,где Xi - колонки ,данные которых должны быть в списке"
 D LE^%ZAPM.ed.BSTT I YES D R(35,li)
 Q
R(i,ii) S $P(@(BSR_"(BST)"),"@",i)=ii S B=@$ZR Q
E151641 S Fi=$P(@(BSR_"(BST)"),"@",40)
 S li=$P(Fi,","),ls="По КАКОЙ КОЛОНКЕ ПОИСК ? (ALL-ПО ВСЕЙ ТАБЛИЦЕ)" D LE^%ZAPM.ed.BSTT Q:'YES  S $P(Fi,",")=li
 S li=$P(Fi,",",2),ls="С КАКОЙ СТРОКИ ВСЕГДА НАЧИНАТЬ ПОИСК ? (DFLT-С ТЕКУЩЕЙ)" D LE^%ZAPM.ed.BSTT Q:'YES  S $P(Fi,",",2)=li
 D Yes^%ZAPM.ed.BSXfun("УЧИТЫВАТЬ РЕГИСТР ПРИ ПОИСКЕ ?") S $P(Fi,",",3)=YES
 D R(40,Fi) Q
E151642 D R(40,"") Q
E15165 D OOO G D
E151631 D R(38,"") Q
E15169 D PRED^%ZAPM.ed.BSF9 G D
E151632 D RAML D:YES R(38,1) Q  ;РАМКИ
E151633 D RAML D:YES R(38,2) Q
E151634 D RAML D:YES R(38,3) Q
E1514 G OPT^%ZAPM.ed.BSF5
OOO D R(8,$G(BSY1(3),BSY1(0))) D R(9,$G(BSX1(3),BSX1(0))) S y=$O(BY(""),-1),x=$O(BX(""),-1) I $D(@(BSR_"(BST,"_BY(y)_","_BX(x)_")")) S l=$P(@$ZR,"@",3),ll=$P(@$ZR,"@",4) D R(10,y+l-1),R(11,x+ll-1) Q
 S ls=" НЕУДАЧА ",YES=0 D O^%ZAPM.ed.BSF7 Q
RAML S B=@(BSR_"(BST)") I $P(B,"@",21) S ls=" У ТАБЛИЦЫ ВКЛЮЧЕН ВИДЕОСТАТУС !!! ",YES=0 D O^%ZAPM.ed.BSF7 Q
 I $P(B,"@",8)<2!($P(B,"@",9)<2)!($P(B,"@",10)>79) S ls=" ДЛЯ РАМКИ ОКНО ВЫВОДА ТАБЛИЦЫ СЛИШКОМ ВЕЛИКО ",YES=0 D O^%ZAPM.ed.BSF7 Q
 S YES=1,ls=" ОБЖИМАТЬ ГРАНИЦЫ ОКНА БУДЕМ ? " D YES^%ZAPM.ed.BSF D:YES OOO Q
E151611 S Sort=$P(@BSR@(BST),"@",36) I TIP=3 D Yes^%ZAPM.ed.BSXfun("ВКЛЮЧИТЬ ОБЯЗАТЕЛЬНУЮ СОРТИРОВКУ СПИСКА ?",1) G D:YES<1 S Sort="1,1,0,"_$P(Sort,",",4) D SO^%ZAPM.ed.BSF9 G SETSORT
 S li=$P(Sort,","),ls=" СОРТИРОВАТЬ С КАКОЙ СТРОКИ" D LE^%ZAPM.ed.BSTT G D:'YES,D:'+li S $P(Sort,",")=+li
 S li=$P(Sort,",",2),ls=" С КАКИМ ШАГОМ" D LE^%ZAPM.ed.BSTT G D:'YES,D:'+li S $P(Sort,",",2)=+li D SORT^%ZAPM.ed.BSF9
SETSORT D R(36,Sort) K Sort G D
E151612 D R(36,"") G D ;СОРТИРОВКА ТАБЛИЦ
PAROL S ls="Enter password for partition",li="",s=4,PARROL=1 K k D P12 Q
USER S ls="Вводите ваш ПАРОЛЬ",li="",s=4,PARROL=1 K k D P12 S ls=" Введите комментаpий...",ll="@" D LE^%ZAPM.ed.BSTT Q
E1571 D PASSWORD(BSR,BST,2,"Вводите пароль на вход в таблицу") G D
E1572 D PASSWORD(BSR,BST,5,"Вводите пароль на коррекцию данных") G D
E1573 D PASSWORD(BSR,BST,4,"Вводите пароль на коррекцию описания таблицы") G D
P12 S ll="@" D LINE^%ZAPM.ed.BSF1 I ('$D(k)) S k=li,ls=" Again ... "_ls,li="" G P12
 I li'=k S ls=" Ничего ... не понимаю " D O^%ZAPM.ed.BSF7 Q
 I $D(PARROL) S %PAROL=li K PARROL Q
 S $P(@(BSR_"(BST)"),"@",s)=li K k,s Q
PASSWORD(MAS,TAB,s,ls,VAR) N k,li,ll S li="" I TAB'="" S MAS=MAS_"(TAB)"
PA S ll="@" D LE^%ZAPM.ed.BSTT I YES,('$D(k)) S k=li,ls=" Again ... "_ls,li="" G PA
 I li'=k S ls=" Ничего ... не понимаю " D O^%ZAPM.ed.BSF7 Q
 I $D(PARROL) S %PAROL=li K PARROL Q
 S $P(@MAS,"@",s)=li K s Q
e Q
TBD I R3=89 ZT "F10"
 I R3=83 D COM^%ZAPM.ed.BS2 G D
 I R3=85 D SRV^%ZAPM.ed.BSF5 G D^%ZAPM.ed.BSF5
 I R3=86 D FIND^%ZAPM.ed.BSF5 G D
 I R3=88 S OO=20,OOO="^%ZAPM.ed.BS" K %JB D 24^%ZAPM.ed.BSTM,^%ZAPM.ed.BSB,ZA^%ZAPM.ed.BSF G D:R1=27,MOUN:%B=1,UNMO:%B=2,SETUP:%B=3,Screen:%B=5 I %B=4 D:$G(%BS(23)) EraseD,LOCKTAB^%ZAPM.ed.BSF6,PAUSE D MGR^%ZAPM.ed.BS,TIT^%ZAPM.ed.BST,W^%ZAPM.ed.BST
 G D
Screen D NEW Q
EraseD W $$atr^%ZAPM.ed.BS3(0),/ED(2) Q
PAUSE W $$r^%ZAPM.ed.BS3 Q
15 W /CUP(20,1) Q
OP I $ZV["Cach"||($ZV["IRIS") U 0:(80:"") Q
 U $I:(80:::::1) Q
CL I $ZV["Cach"||($ZV["IRIS") U 0:("IS") Q
 U $I:(0::::1) Q
UNMO N SYS,M,I,i D OP,15 S i=0 K SYS F I=1:1:7 I $$ZU^%ZAPM.ed.BS3(1,I)'="" S i=i+1,SYS(i)=I
 I '$D(SYS) S ls=" ДЕМОНТИРОВАТЬ НЕЧЕГО " D CL,O^%ZAPM.ed.BSF7 G NEW
 S X=SYS(i)
UNMO1 D UNM,CL G NEW
UNM I $ZV["Wind"!($ZV["Cach"||($ZV["IRIS")) Q
 ZF  S YES=1 ZF  D CHECKDDP^%ZAPM.ed.BSD2($G(X,1)) Q:YES<1  D MGR^%ZAPM.ed.BS D ^UMOUNT Q
M D MOU,CL G NEW
MOUN D  D:'(R1=27!(%BShNAME="")) OP,15,MOU,CL G NEW
 .D SI^%ZAPM.ed.BSN N (%BS,vl,%zT,%KAT,%File,R1,%BShNAME,%BSrs,%BSvg) S BSR="^%ZAPM.ed.BSETUP",BST="MOUNT" D CHECK,^%ZAPM.ed.BST
 .S %BShNAME=$P($G(^%ZAPM.ed.BSETUP("MOUNT",ny,2)),"@",15) I $L(%BShNAME)'=3!(%BShNAME["\") S %BShNAME=$$AddFile^%ZAPM.ed.BSDOS2(%BShNAME) Q
 .S %BSvg=$P($G(^%ZAPM.ed.BSETUP("MOUNT",ny,3)),"@",15),%BSrs=%BShNAME
MOU I $ZV["Wind"!($ZV["Cach"||($ZV["IRIS")) Q
 D SI^%ZAPM.ed.BSN N (%BS,vl,%BShNAME,%BSrs,%BSvg) ZF  ZF  D OP,15,MGR^%ZAPM.ed.BS
 I $D(%BSrs) D ^MOUNTRVG
 I '$D(%BSrs) D ^DBMAINT3,DDPDIR^%ZAPM.ed.BSMSMF ;ОБНОВИТЬ ССЫЛКИ В ^BSdirddp
 D MOUNT^%ZAPM.ed.BSMSMF($G(VGNAME)) Q
SETUP S BSR="^%ZAPM.ed.BSETUP",BST="SETUP" D ^%ZAPM.ed.BST,CONF^%ZAPM.ed.BSH,CLr
NEW S NEWVOLUM=1,R1=27 D  K SYS,M,OO,OOO G END^%ZAPM.ed.BSF
 .S %BS(18)=$$%BSU^%ZAPM.ed.BSF7()
CHECK D MGR^%ZAPM.ed.BS Q:$D(@(BSR_"(BST)"))  S BSr1="^%ZAPM.ed.BSS",BSt1="MOUNT",BSr2="^%ZAPM.ed.BSETUP",BSt2=BST D COPY^%ZAPM.ed.BSTK Q
LOCK D:$D(%BS)["0" CLr U $I::%BS(32) Q
%BS1 S %BS(1)=$P($G(^%ZAPM.ed.BSETUP("SETUP",20,2)),"@",15) ;```I $E(%BS(1),8),$D(^ ("%MOUSE")) D ^%ZAPM.ed.BSMOUSE
 S $E(%BS(1),19)=$S($ZV'["Cach"&&($ZV'["IRIS"):0,$E(%BS(1),19):$E(%BS(1),19)+3,1:0)
 S %BS(18)=$$%BSU^%ZAPM.ed.BSF7()
 Q
LV S IntP=1
CLr I $ZV'["Cach"&&($ZV'["IRIS") N I,II,uci,SGCNFG S uci=$$ZU^%ZAPM.ed.BS3(0) I '$D(IntP) D
 .D MGR^%ZAPM.ed.BS I '$D(^%ZAPM.ed.BS("SYSGEN")) D CONF^%ZAPM.ed.BSH S ^%ZAPM.ed.BS("SYSGEN")=""
 .E  D BUFERS^%ZAPM.ed.BSH
 ;I $P($$LICINFO^%MSMOPS,"^")_","_$ZU(0)'=("10"_"00"_"00"_"0,"_"MG"_"R,M"_"SW") H
 I '$D(^%ZAPM.ed.BSETUP("PATH")) S BSr1="^%ZAPM.ed.BSS",BSt1="PATH",BSr2="^%ZAPM.ed.BSETUP",BSt2=BSt1 D COPY^%ZAPM.ed.BSTK
 I '$D(^%ZAPM.ed.BSETUP("SETUP")) S BSr1="^%ZAPM.ed.BSS",BSt1="SETUP",BSr2="^%ZAPM.ed.BSETUP",BSt2=BSt1 D COPY^%ZAPM.ed.BSTK
 I '$D(^%ZAPM.ed.BSETUP("SERVER")) S BSr1="^%ZAPM.ed.BSS",BSt1=$S($ZV["MSM":"SERVER",1:"CacheServ"),BSr2="^%ZAPM.ed.BSETUP",BSt2="SERVER" D COPY^%ZAPM.ed.BSTK
 S %BS(32)="X3.64-1979" I $P'=1 ;   S %BS(32)=???
 I $ZV["Wind"!($ZV["Cach"||($ZV["IRIS")) D %BS35^%ZAPM.ed.BSre ;ЗАГРУЗКА ТАБЛИЦЫ ПЕРЕКОДИРОВКИ
 I '$D(IntP) D NS
 ;```D %BS35^%ZAPM.ed.BSre ;ЗАГРУЗКА ТАБЛИЦЫ ПЕРЕКОДИРОВКИ
 ;
 I $ZV["MSM-Workstation" ;S ^$DISPLAY($PDISPLAY,"ZOEMDB")=1
 I $ZV["Cach"||($ZV["IRIS") D CACHERUN^%ZAPM.ed.BSC
 I $ZV["MSM-PC" D ADRMEM
 D %BS1 B $E(%BS(1),15)=0
 D INITHELP^%ZAPM.ed.BSDOS2
 S %BS(2)=$P($G(^%ZAPM.ed.BSETUP("SETUP",3,2)),"@",15)
 S %BS(6)=$P($G(^%ZAPM.ed.BSETUP("SETUP",2,2)),"@",15) I '%BS(6) K %BS(6)
 S %BS(23)=+$P($G(^%ZAPM.ed.BSETUP("SETUP",10,2)),"@",15)
 S %BS(18)=$$%BSU^%ZAPM.ed.BSF7(),%BS(15)=+$G(%BS(15))
 S %BS(24,1)=$$KBD^%ZAPM.ed.BSF12("^%ZAPM.ed.BSVOL(""PROTOKOL"")")
 S %BS(24,2)=$P($G(^%ZAPM.ed.BSETUP("PATH",4,4)),"@",15)
 S %BS(21)=$P($G(^%ZAPM.ed.BSETUP("SETUP",14,2)),"@",15) K:'(+%BS(21)=1!(+%BS(21)=2))!('$D(^%ZAPM.ed.BS("COM",+%BS(21)))) %BS(21) I $D(%BS(21)) S %BS(21)=^%ZAPM.ed.BS("COM",+%BS(21))_" "_$P(%BS(21)," ",2,99)
 S %BS(33)=$P($G(^%ZAPM.ed.BSETUP("SETUP",4,2)),"@",15)
 I '$D(^%ZAPM.ed.BSETUP("MOUNT")) S BSr1="^%ZAPM.ed.BSS",BSt1="MOUNT",BSr2="^%ZAPM.ed.BSETUP",BSt2=BSt1 D COPY^%ZAPM.ed.BSTK
 S %BS(34)=$P($G(^%ZAPM.ed.BSETUP("SETUP",5,2)),"@",15)
 S %BS(34)=$S(%BS(34)'["/":"Y/Y/Y",1:%BS(34))
 S %BS(33)=$S(%BS(33)'["/":"10/0/0",1:%BS(33))
 I $D(^%ZAPM.ed.BSETUP("YEAR",1)) S %BS(36)=$H+$G(^%ZAPM.ed.BSETUP("YEAR",1))
 S %BS(20)=$P($G(^%ZAPM.ed.BSETUP("SETUP",12,2)),"@",15)
 S %BS(20)=$S(%BS(20)'["^":"",1:%BS(20))
 I $G(%BS(20))'="" S %BS(22)=$P($G(@%BS(20)@("CharGlob",1,4),"@@@@@@@@@@@@@@4114,4114,4114"),"@",15)
 E  S %BS(22)="4114,4114,4114"
 S %BS(5)=$P($G(^%ZAPM.ed.BSETUP("SETUP",15,2)),"@",15) S:%BS(5)>2 %BS(5)=0
 S %BS(16)=$P($G(^%ZAPM.ed.BSETUP("SETUP",16,2)),"@",15) S:%BS(16)>2 %BS(16)=0
 I '$D(%BS(12)) S %BS(12)=""
 I '$D(^%ZAPM.ed.BSETUP("COLOR")) S BSr1="^%ZAPM.ed.BSS",BSt1="COLOR",BSr2="^%ZAPM.ed.BSETUP",BSt2=BSt1 D COPY^%ZAPM.ed.BSTK
 S %BS="" F I=2:1:13 S %BS=%BS_$S($P($G(^%ZAPM.ed.BSETUP("COLOR",I,2)),"@",15)'="":$P($G(@$ZR),"@",15),1:"0")_"!"
 I '$D(^%ZAPM.ed.BSETUP("PRNDFLT")) S BSr1=%BS(20),BSt1="PRNDFLT",BSr2="^%ZAPM.ed.BSETUP",BSt2=BSt1 D COPY^%ZAPM.ed.BSTK
 I '$D(^%ZAPM.ed.BSETUP("PARPRN")) S BSr1=%BS(20),BSt1="PARPRN",BSr2="^%ZAPM.ed.BSETUP",BSt2=BSt1 D COPY^%ZAPM.ed.BSTK
 I '$D(^%ZAPM.ed.BSbufB("INFO_K")) S BSr1="^%ZAPM.ed.BSS",BSt1="INFO_K",BSr2="^%ZAPM.ed.BSbufB",BSt2=BSt1 D COPY^%ZAPM.ed.BSTK
 K vD,%BS(7) S I=1 F  S I=$O(^%ZAPM.ed.BSETUP("MOUNT",I)) Q:'I  D
 .I $P($P(^%ZAPM.ed.BSETUP("MOUNT",I,2),"@",15),":")'="" S vD($P($P(@$ZR,"@",15),":"))=$S("N"[$P($G(^%ZAPM.ed.BSETUP("MOUNT",I,4)),"@",15):0,1:1)
 .I $P(^%ZAPM.ed.BSETUP("MOUNT",I,3),"@",15)'="",$P($G(^(5)),"@",15)="Y" S %BS(7,$P(^(3),"@",15))=""
 S (%BS(4),I)="" D  S %BS(4)=$TR(%BS(4),"QWERTYUIOPASDFGHJKLZXCVBNM","qwertyuiopasdfghjklzxcvbnm") K vD
 .F  S I=$O(vD(I)) Q:I=""  I vD(I) S %BS(4)=%BS(4)_I_":"
 K vD S:'%BS(2) %BS(2)="9999-1"
%GU N I S YES=0 ;ПЕРЕХОД ИЗ КИПА В КИП      uci="КИП,ТОМ"
 Q:$G(uci)=""  
 I $ZV["Cach"||($ZV["IRIS") D  Q  ;Cache' from InterSystems
 .I $$ZU(uci) S YES=1
 S I=$$ZU^%ZAPM.ed.BS3($P(uci,","),$P(uci,",",2)) I I'="" V 2:$J:$P(I,",",2)*32+$P(I,","):2 K np S YES=1 Q
 I '$D(np) S ls=" Кип,Том <"_uci_"> НЕдоступны " D O^%ZAPM.ed.BSF7
 K np Q
ZU(UCI,SYS) ;ПЕРЕЙТИ В НУЖНЫЙ КИП
 I $ZV["Cach"||($ZV["IRIS") Q $$CNS^%ZAPM.ed.BSCp(UCI)
 I '$$ZU^%ZAPM.ed.BS3(UCI,SYS) Q 0 ;
 V 2:$J:$P($ZU(UCI,SYS),",",2)*32+$P($ZU(UCI,SYS),","):2
 Q 1
ADRMEM N VT,CPU386 ;D VTYPE^%VIDEO S %BS(17)=$S(VT&CPU386:#B8000,'VT&CPU386:#B0000,VT&'CPU386:#B8000000,1:#B0000000) Q
 q
NS I $ZV["Wind"!($ZV["Cach"||($ZV["IRIS")) S %BS(13)="%BS-PC" U $I::%BS(32) D  Q
 .I $ZV["Cach"||($ZV["IRIS") D %BS3^%ZAPM.ed.BSCp
]]></Routine>


<Routine name="%ZAPM.ed.BSF5" type="MAC" languagemode="0"><![CDATA[
%BSF5 ;ПОМЕТКА;СЕРВИС БАЗЫ ДАННЫХ,ПОИСК,МЕНЮ                ; 15:40   02.02.2000
SRV K M S M(1,1)=" MUMPS MS-DOS ТEST-MSM TEST-%BS СТАТИСТИКА BACKCOPY " I $E(BST)="R",BSR["%BSbufB",ny>2 S M(1,1)=M(1,1)_"ХАРАКТЕРИСТИКИ_РАЗДЕЛОВ "
 S M(1,1)=M(1,1)_"@6@ @0",OO=1,OOO="M" D 24^%ZAPM.ed.BSTM,^%ZAPM.ed.BSB,ZA^%ZAPM.ed.BSF Q:R1=27  I %B=1 D ^%ZAPM.ed.BSMSM Q
 I %B=2 D ^%ZAPM.ed.BSDOS Q
 I %B=3 D TEST^%ZAPM.ed.BSMSM Q
 I %B=4 D ^%ZAPM.ed.BSI Q
 I %B=5 D STAT^%ZAPM.ed.BSF11 Q
 I %B=6 D COPYINF^%ZAPM.ed.BSVOL Q
 D %GBL^%ZAPM.ed.BS2:%B=6 Q
FIND S li=$G(^%ZAPM.ed.BSbufB(0,$G(%BS(3),$P),2)),ls=" Введите контекст ПОИСКА ;имя таблицы ",ll="@ " D LE^%ZAPM.ed.BSTT Q:'YES  ;ТАБЛИЦ
STA K END S St=1,(uci,Uci)=$$ZU^%ZAPM.ed.BS3(0),^%ZAPM.ed.BSbufB(0,$G(%BS(3),$P),2)=$G(li) D FIUCI G:$D(END) FEND
 K BSuCI S UCI=$P($$ZU^%ZAPM.ed.BS3(0),","),SYS=$P($$ZU^%ZAPM.ed.BS3(0),",",2)
 F I=0:1 Q:$$ZU^%ZAPM.ed.BS3(1,I)=""  S BSuCI(I)=$P($$ZU^%ZAPM.ed.BS3(1,I),",",2) F J=1:1 Q:$$ZU^%ZAPM.ed.BS3(J,I)=""  S BSuCI(I,J)=$P($$ZU^%ZAPM.ed.BS3(J,I),",") I '(BSuCI(I)=SYS&(BSuCI(I,J)=UCI)) S uci=BSuCI(I,J)_","_BSuCI(I) D %GU^%ZAPM.ed.BSF4 I YES D FIUCI G:$D(END) FEND
 I '$D(DOX)&('$D(DOPART))&('$D(DOBD))&('$D(DOKD))&('$D(DOMASS)) S ls=" ТАБЛИЦА "_li_" НЕ НАЙДЕНА " D O^%ZAPM.ed.BSF7
 S uci=UCI_","_SYS D %GU^%ZAPM.ed.BSF4
FEND K l,St,STa,Uci,uci,iI,i,END,UCI,SYS,BSuCI Q
FIUCI I $D(DOUCI) X DOUCI E  Q
 S i="^" F  S i=$O(@i) Q:i=""  S i="^"_i I i'="^%ZAPM.ed.BSbufB" D  G:$D(END) FFND
 .S ls=uci_"  "_i D WAITS^%ZAPM.ed.BSF2
 .I $G(DOBD)'="",$P($G(@i),"@")="BSD - MSW" X DOBD,WA Q  ;БАЗЫ
 .I $G(DOKD)'="",$P($G(@i),"@")["%BS-invert-" X DOKD,WA Q  ;КОДИФИКАТОРЫ
 .I $G(DOMASS)'="" X DOMASS,WA Q  ;МАССИВЫ````` недавно перенес
 .I $P($G(@i),"@")="BaSe MsW " D  Q  ;РАЗДЕЛЫ %BS
 ..I $D(DOPART) X DOPART,WA Q
 ..S iI="" F  S iI=$O(@i@(iI)) Q:iI=""  D  Q:$D(END)
 ...I $D(DOX) X DOX,WA Q  ;ТАБЛИЦЫ
 ...I ("@"_iI)[("@"_li) I $D(@(i_"(iI)")) S ls=$ZR_"   "_$P(@$ZR,"@")_"; ГОДИТСЯ ? " D YES^%ZAPM.ed.BSF I YES S END=i,TABLfind=iI Q
e Q
BSSS(ll) F l=1:1:19 S @(BSR_"(BST,St,l)")=^%ZAPM.ed.BSS("STA",ll,l)
 Q
FFND S EXITout=$$ZU^%ZAPM.ed.BS3(0) D  S uci=Uci D %GU^%ZAPM.ed.BSF4 D  S uci=EXITout D %GU^%ZAPM.ed.BSF4
 .K ^%ZAPM.ed.BSbufB("T"_$G(%BS(3),$P)_$J_"u"_%BS(15)),^%ZAPM.ed.BSbufB("R"_$G(%BS(3),$P)_$J_"u"_%BS(15)),^%ZAPM.ed.BSbufB("fT"_$G(%BS(3),$P)_$J_"u"_%BS(15))
 S %NAM=END Q
SERV N YES1 S %B=1,M(1,1)=^%ZAPM.ed.BS(27,1),ls="" D Copy^%ZAPM.ed.BSF8("^%ZAPM.ed.BS(25)","M(25)")
 K Dark I $G(%BS("Tmp","AKBD",BSD),"RWD")'="RWD" S Dark(1,1)=" 1 1 0 1 1 0 0"
 D MEN K Dark G D:'YES,DUBLI:%B=2,FIND^%ZAPM.ed.BSBD:%B=3,COPDEL:%B=4,VIC:%B=5,LOG^%ZAPM.ed.BSF10:%B=6,MUK^%ZAPM.ed.BSLOG:%B=7
SUM I key=0 S ls=" ИМЕННОЙ КЛЮЧ СУММИРОВАТЬ НЕЛЬЗЯ " G O
 I key'=endkey S ls=" ВЫ ХОТИТЕ СУММИРОВАТЬ КЛЮЧИ НЕ ПОСЛЕДНЕГО УРОВНЯ ! ВЫ УВЕРЕНЫ ? " W $$bel^%ZAPM.ed.BS3 D YES^%ZAPM.ed.BSF G:'YES O
 I '$D(%DIA) S ls=" НЕ ПОМЕЧЕНЫ СЛАГАЕМЫЕ КЛЮЧИ " G O
 D:key NEWKEY1^%ZAPM.ed.BST1 D:'key NEWKEY0^%ZAPM.ed.BST1 G:'YES D S %iii=d D SUU
 X "I $D(@%NAm)" S do="D:i>3 SU^%ZAPM.ed.BSF5",TRe2=$P($ZR,")") D TRE2 I YES<1 D Yes^%ZAPM.ed.BSXfun("Смешиваем существующий узел и Сумму ?",2) I YES<1 G ENDD
 I YES D BLOK^%ZAPM.ed.BSF1 S @(TRe2_")")=$$ESDAY^%ZAPM.ed.BSsFUNR(9,$$h^%ZAPM.ed.BS3())
ENDD K l,j,TRe1,TRe2,ii,%iii,NOKILLER,KILLER S R1=27 Q
SU S %iii=$P(^(j),"@",15) D SUU I $D(@%NAm)
 S TRe1=$P($ZR,")"),ls="Суммиpование.."_TRe1_" В "_TRe2_"..." D WAITS^%ZAPM.ed.BSF2
 N Calc S Calc=$$CALC($NA(@Bsr@(Bst)))
 S l=TRe1_")",ll=TRe1_"," F  S l=$ZO(@l) Q:l'[ll  D
 .I Calc'="",Calc[("@"_$QS(l,$QL(l))_"@") Q  ;НЕ ВЫЧИСЛЯТЬ НЕКОТОРЫЕ
 .S @(TRe2_","_$P(l,ll,2,9))=$G(@(TRe2_","_$P(l,ll,2,9)))+@l
 Q
CYES ;РАЗРЕШИТЬ
 N A S A=$P(@BSR@(BST,ny,nx),"@",18)
 S $P(A,"#",4)="",$P(@BSR@(BST,ny,nx),"@",18)=A
 K @BSR@(BST,"NoCalcCell",1)
 Q
CNO ;ЗАПРЕТИТЬ
 N A S A=$P(@BSR@(BST,ny,nx),"@",18)
 S $P(A,"#",4)=1,$P(@BSR@(BST,ny,nx),"@",18)=A
 S @BSR@(BST,"NoCalcCell")="ЕСТЬ КЛЕТКИ ЗАПРЕЩЕННЫЕ К СУММИРОВАНИЮ И ВЫЧИТАНИЮ"
 Q
CALC(S) ;ВЕРНУТЬ СТРОКУ ИЗ ,СИХБ, ЗАПРЕЩЕННЫХ К СУММИРОВАНИЮ И ВЫЧИТАНИЮ
 I '$D(@S@("NoCalcCell")) Q ""
 I $D(@S@("NoCalcCell",1)) Q $$GLRET^%ZAPM.ed.BSF12($ZR)
 N i,j,s,z S s="" F i=1:1 Q:'$D(@S@(i))  F j=1:1 Q:'$D(@S@(i,j))  I $P($P(@S@(i,j),"@",18),"#",4) D  S s=s_"@"_z
 .I $P($P(@S@(i,j),"@",18),"#",1) S z=$P($P(@S@(i,j),"@",18),"#",1) Q
 .S z=i_","_j
 I s="" K @S@("NoCalcCell") Q ""
 D GLSET^%ZAPM.ed.BSF12($NA(@S@("NoCalcCell",1)),s_"@")
 Q s_"@"
SUU S %NAm=$$BSD^%ZAPM.ed.BSA(BSD,$G(%KEYS(0))) F ii=1:1:key-1 Q:'$D(%KEYS(ii))  S %NAm=%NAm_$S(%KEYS(ii)=+%KEYS(ii):%KEYS(ii),1:$C(34)_%KEYS(ii)_$C(34))_","
 I key=0 S %NAm=BSD_%iii Q
 S %NAm=%NAm_$S(%iii=+%iii:%iii,1:$C(34)_%iii_$C(34))_")" Q
VIC I '$D(%DIA) S ls="НЕ ПОМЕЧЕН ВЫЧИТАЕМЫЙ КЛЮЧ" G O
 K KILLER,VIC D DUBL G D:'YES1 S do="I i>2 S VIC=$P(^(j),""@"",15),i=9999999" D BLOK^%ZAPM.ed.BSF1
 D SUU X "I $D(@%NAm)" S TRe1=$P($ZR,")") I '$D(VIC) S ls="ПОМЕЧЕННЫЙ КЛЮЧ НЕ НАЙДЕН" G O
 S %iii=VIC D SUU X "I $D(@%NAm)" S TRe2=$P($ZR,")")
 S ls="Вычитание из"_TRe1_" - "_TRe2_"..." D WAITS^%ZAPM.ed.BSF2
 N Calc S Calc=$$CALC($NA(@Bsr@(Bst)))
 S l=TRe2_")",ll=TRe2_"," F  S l=$ZO(@l) Q:l'[ll  D
 .I Calc'="",Calc[("@"_$QS(l,$QL(l))_"@") Q  ;НЕ ВЫЧИСЛЯТЬ
 .I '$D(@(TRe1_","_$P(l,ll,2,9))) S @$ZR=0 X WA
 S l=TRe1_")",ll=TRe1_"," F  S l=$ZO(@l) Q:l'[ll  D
 .I Calc'="",Calc[("@"_$QS(l,$QL(l))_"@") Q  ;НЕ ВЫЧИСЛЯТЬ
 .S @l=@l-$G(@(TRe2_","_$P(l,ll,2,9))) X WA
 G ENDD
DUBLI K KILLER D DUBL G ENDD:YES1,D
COPDEL S KILLER=1 D DUBL G ENDD:YES1,D
DUBL S YES1=0 Q:ny<3  S %iii=d D SUU X "I $D(@%NAm)" S TRe1=$P($ZR,")")
 D:key NEWKEY1^%ZAPM.ed.BST1 D:'key NEWKEY0^%ZAPM.ed.BST1 Q:'YES  S %iii=d D SUU X "I $D(@%NAm)" S TRe2=$P($ZR,")") D  S YES1=1 Q
 .S YES1=1 D TRE2 I YES<1 D Yes^%ZAPM.ed.BSXfun("Смешиваем существующий узел и Дублируемый ?",2) I YES<1 Q
 .S NOKILLER=1 I 'YES Q
 .I 'key D TRE^%ZAPM.ed.BSTK
 .I key D TREE^%ZAPM.ed.BSTK S @(TRe2_")")=$$h^%ZAPM.ed.BS3()_","_$G(%BS(12))_",1,"_$$h^%ZAPM.ed.BS3()
 .Q:'$D(KILLER)  I '$D(%w(3)) D PASDD^%ZAPM.ed.BST1 E  S YES=0 Q
 .D DEL^%ZAPM.ed.BSF10($NA(@(TRe1_$S(key:")",1:""))),2) Q
TRE2 I $D(@(TRe2_$S(key:")",1:""))) S ls=" КЛЮЧ "_d_" УЖЕ СУЩЕСТВУЕТ , УДАЛЯЕМ ? " D YES^%ZAPM.ed.BSF Q:'YES
 I '$D(%w(3)) D PASDD^%ZAPM.ed.BST1 E  S YES=0 Q
 D DEL^%ZAPM.ed.BSF10($NA(@(TRe2_$S(key:")",1:""))),2) Q
PL G D:TIP=7 S %zT=$ZT,$ZT="ERP^%ZAPM.ed.BSF5",%B=1 D MENU(^%ZAPM.ed.BS(22,1)_"ОСОБАЯ "," ******* ПОМЕТКА КЛЕТОК ******* ",5) S %DIAP=1 G D:'YES,7:%B=4,71:%B=2,OS:%B=5
76 I %B=1 D P S:$G(%DIAP) $P(@(BSR_"(BST)"),"@",3)=1,%DIA="" F i=1:1 Q:'$D(@(BSR_"(BST,i)"))  I $D(@(BSR_"(BST,i,nx)")) S $P(^(nx),"@",12)=$G(%DIAP)
 I %B=3 D P S:$G(%DIAP) $P(@(BSR_"(BST)"),"@",3)=1,%DIA="" F j=1:1 Q:'$D(@(BSR_"(BST,ny,j)"))  I $D(@(BSR_"(BST,ny,j)")) S $P(^(j),"@",12)=$G(%DIAP)
 G 70
O D O^%ZAPM.ed.BSF7
D K KILLER G 0^%ZAPM.ed.BSTM
MENU(m,ms,b) N OO,OOO,M,%JB S M(1,1)=m_"@6@ @0",OO=1,OOO="M",ls=ms ;БЛОЧНОЕ МЕНЮ
MEN W /CUP(25,1) D 0^%ZAPM.ed.BSF W /EL(0),$$clr^%ZAPM.ed.BS3(8),ls S OOO="M",OO=1 S:$G(b) %B=b D 0^%ZAPM.ed.BSF,24^%ZAPM.ed.BSTM,^%ZAPM.ed.BSB S YES=$S(R1=27:0,1:1) D A25^%ZAPM.ed.BSF1 Q
MI G D:TIP=7 S %B=1,%zT=$ZT,$ZT="ERP^%ZAPM.ed.BSF5" D MENU(^%ZAPM.ed.BS(22,1)," ******* СНЯТИЕ ПОМЕТКИ ******* ",2) S %DIAP="" G D:'YES,7:%B=4,71:%B=2,76
P S ls=$S($G(%DIAP):"ПОМЕТКА КЛЕТОК",1:"СНЯТИЕ ПОМЕТКИ") D WAITS^%ZAPM.ed.BSF2 Q
7 S OOO="M",OO=1,M(1,1)=" ОТКАЗ ПЕРВАЯ_ГРАНИЧНАЯ_ТОЧКА_" S:$D(%DI) M(1,1)=M(1,1)_"{"_%DI_"}" I $D(%DI) S M(1,1)=M(1,1)_" ВТОРАЯ_ГРАНИЧНАЯ_ТОЧКА"_$S($D(%DIA):"{"_%DIA_"}",1:"")
 S M(1,1)=M(1,1)_" @6@ @0" D 24^%ZAPM.ed.BSTM,^%ZAPM.ed.BSB,ZA^%ZAPM.ed.BSF G D:R1=27!(%B=1),@("7"_%B)
73 S %DIA=ny_","_nx I $P(%DI,",")<$P(%DIA,",") S i1=$P(%DI,","),i2=$P(%DIA,",")
 E  S i1=$P(%DIA,","),i2=$P(%DI,",")
 I $P(%DI,",",2)<$P(%DIA,",",2) S j1=$P(%DI,",",2),j2=$P(%DIA,",",2)
 E  S j1=$P(%DIA,",",2),j2=$P(%DI,",",2)
 D P S:$G(%DIAP) $P(@(BSR_"(BST)"),"@",3)=1 F i=i1:1:i2 Q:'$D(@(BSR_"(BST,i)"))  F j=j1:1:j2 Q:'$D(@(BSR_"(BST,i,j)"))  S $P(^(j),"@",12)=$G(%DIAP)
70 D 0^%ZAPM.ed.BSF,W^%ZAPM.ed.BST K i,j,i1,i2,j1,j2,%DI S $ZT=$G(%zT) G D
71 K:'$G(%DIAP) %DIA,%DI G 74
72 S %DI=ny_","_nx K %DIA G D
74 D 75 D:$D(%DIA) 0^%ZAPM.ed.BSF,W^%ZAPM.ed.BST K:'$G(%DIAP) %DIA,i,j G D
75 S $P(@(BSR_"(BST)"),"@",3)=$G(%DIAP) D P F i=1:1 Q:'$D(@(BSR_"(BST,i)"))  F j=1:1 Q:'$D(@(BSR_"(BST,i,j)"))  S $P(^(j),"@",12)=$G(%DIAP),%DIA=1
 Q
OS ;ОСОБАЯ ПОМЕТКА
 D MENU(" С_ШАГОМ_? ХРАНимые_В_БАЗЕ ИНВЕРсия ОЧИСТить ПУСТЫЕ_ДАННЫЕ БАЗА_ПОМЕТОК "," Эти pежимы pаботают от указателя ВПРАВО и ВНИЗ (База пометок в ^%ZAPM.ed.BSVOL,MARK)",1) G D:'YES
 I %B=1!(%B=4) S e=$$LineEdit^%ZAPM.ed.BSXfun($S(%B=1:2,1:1),"Так с каким шагом "_$S(%B=1:"ПОМЕЧАТЬ",1:"СНИМАТЬ ПОМЕТКУ")) G D:'YES
 I %B=6 D GOMARK^%ZAPM.ed.BSVOL G 70
 S $P(@(BSR_"(BST)"),"@",3)=1,%DIA=1
 S e=$S(%B=1:e,1:1) D P F i=ny:e:se F j=nx:e:ke I $D(@(BSR_"(BST,i,j)")) S $P(^(j),"@",12)=$S(%B=1:1,%B=2:$P(^(j),"@",9)'=1,%B=3:'$P(^(j),"@",12),%B=5:$P(^(j),"@",15)="",1:"")
 G 70
ERP S ls="ОШИБКА ПРИ ПОМЕТКИ !!! " I $ZE["<PROT" S ls=ls_" ТАБЛИЦА ЗАЩИЩЕНА"
 E  S ls=ls_$ZE
 D O^%ZAPM.ed.BSF7 G 70
OPT ;ОПТИМИЗАЦИЯ
 I $P(@(BSR_"(BST)"),"@",22) S ls=" ТАБЛИЦА УЖЕ БЫЛА ОПТИМИЗИРОВАНА " D O^%ZAPM.ed.BSF7 G D
 S ls=" !!!! ВНИМАНИЕ !!!! " D O^%ZAPM.ed.BSF7 S ls=" ЭТО НЕОБРАТИМЫЙ ПРОЦЕСС, КОРРЕКЦИЯ ТАБЛИЦЫ БУДЕТ ЗАПРЕЩЕНА, ВЫ УВЕРЕНЫ ? " W *7 S %B=2 D YES^%ZAPM.ed.BSF I YES S ls=" ВЫ ТОЧНО УВЕРЕНЫ ? ",%B=2 W $$bel^%ZAPM.ed.BS3 D YES^%ZAPM.ed.BSF
 S ls=" OPT^%ZAPM.ed.BSF5 " D O^%ZAPM.ed.BSF7 G D ;!!!!!!! ЗАКРЫТО
 G D:'YES S ls="ОПТИМИЗАЦИЯ" D WAITS^%ZAPM.ed.BSF2 S $P(@(BSR_"(BST)"),"@",22)=1,BSr=BSR,BSt=BST
 F f="FTR","FCL","COL","RTR" I $D(@(BSr_"(BSt,f)")) S i="" F  S i=$O(@(BSr_"(BSt,f,i)")) Q:i=""  S j="" F  S j=$O(@(BSr_"(BSt,f,i,j)")) Q:j=""  K ^(j,1)
 F k=0:1:13 I $D(@(BSR_"(BST,""KEY"",k)")) K ^(k,2),^(4) S zr=$ZR F kk=10:1 X "I $D(@zr)" Q:'$D(^(kk))  K ^(kk,2)
 D TIT^%ZAPM.ed.BST,W^%ZAPM.ed.BST,CALC^%ZAPM.ed.BSF3 G B^%ZAPM.ed.BSTM
REM ;       РЕМОНТ
 D EnterP^%ZAPM.ed.BSF8("^%ZAPM.ed.BSS(""REPAIR"",""BUT"")") S YES=$S(d=1&(R1=13):1,1:0)
 G D:'YES S ls="РЕМОНТ ТАБЛИЦЫ" D WAITS^%ZAPM.ed.BSF2,REMONT(BSR,BST)
 D TIT^%ZAPM.ed.BST,W^%ZAPM.ed.BST,CALC^%ZAPM.ed.BSF3 G B^%ZAPM.ed.BSTM
REMONT(BSR,BST) 
 K ^%ZAPM.ed.BSbufB("u"_$G(%BS(3),$P)_$J_"u"_%BS(15)) 
 F i=1:1 Q:'$D(@(BSR_"(BST,i)"))  S $P(^%ZAPM.ed.BSbufB("u"_$G(%BS(3),$P)_$J_"u"_%BS(15),i,1),"#")=$S($P(@(BSR_"(BST,i,1)"),"@",3)="":1,1:$P(@(BSR_"(BST,i,1)"),"@",3))
 F j=1:1 Q:'$D(@(BSR_"(BST,1,j)"))  S $P(^%ZAPM.ed.BSbufB("u"_$G(%BS(3),$P)_$J_"u"_%BS(15),1,j),"#",2)=$S($P(^(j),"@",4)="":1,1:$P(^(j),"@",4)) X $G(WA)
 S do="S zr=$ZR,$P(@zr,""@"",3)=$P(^%ZAPM.ed.BSbufB(""u""_$G(%BS(3),$P)_$J_""u""_%BS(15),i,1),""#""),$P(@zr,""@"",4)=$P(^%ZAPM.ed.BSbufB(""u""_$G(%BS(3),$P)_$J_""u""_%BS(15),1,j),""#"",2),$P(@zr,""@"",11)="""""
 D ALLT^%ZAPM.ed.BSS1 S $P(@(BSR_"(BST)"),"@",24)="" 
 K ^%ZAPM.ed.BSbufB("u"_$G(%BS(3),$P)_$J_"u"_%BS(15)) 
 D TAB^%ZAPM.ed.BSF1 
 I '$P(@(BSR_"(BST)"),"@",22) S ls=" РЕТРАНСЛЯЦИЮ ФОРМУЛ БУДЕМ ДЕЛАТЬ ? " D YES^%ZAPM.ed.BSF I YES S BSr=BSR,BSt=BST D TRANS^%ZAPM.ed.BSS1
 Q
CKD(%VGI) Q:'$D(%BS(6))  Q:'$D(%VGI)  D INT^%SP I %BS(6)>%FTOTBLK S ls=" ВНИМАНИЕ !!! На Томе "_$P($$ZU^%ZAPM.ed.BS3(1,%VGI),",",2)_" Осталось "_%FTOTBLK_" Свободных Блоков " D O^%ZAPM.ed.BSF7
 C 63 Q
]]></Routine>


<Routine name="%ZAPM.ed.BSF6" type="MAC" languagemode="0"><![CDATA[
%BSF6 ;ИНФО,DIR-%BS,ТЕМНЫЕ БЛОКИ МЕНЮ ; 10:57   05.01.2001
INFO Q:BSR="^%ZAPM.ed.BSS"&(BST="INFO")  D KILBF K %KAT S %KAT(1)=$S_"!"_$G(BSR)_"!"_$G(BST),%KAT(2)=$G(@(BSR_"(BST)")) I $D(ny) S %KAT(3)=$G(@BSR@(BST,ny,nx))
 S %KAT(7,"LST")=$G(@BSR@(BST,"LST"))
 I $D(MY) S %KAT(4)="{"_ny_","_nx_"}" D
 .F f="FCL","COL","FTR","RTR","CMD" I $D(@(BSR_"(BST,f,ny,nx)"))=11 S %KAT(4,f)=@$ZR D
 ..I $D(@(BSR_"(BST,f,ny,nx,1)")) S %KAT(4,f,1)=@$ZR
 ..I $D(@(BSR_"(BST,f,ny,nx,2)")) S %KAT(4,f,2)=@$ZR
 .F f="FCL","COL","FTR","RTR","CMD" D
 ..S ff=$S(f="FCL":7,f="COL":13,f="FTR":8,f="RTR":16,f="CMD":14,1:999),nynx="0,0" I $P(@(BSR_"(BST,ny,nx)"),"@",ff)?.N1",".N S nynx=$P(@$ZR,"@",ff)
 ..I f="COL",$P(@(BSR_"(BST,ny,nx)"),"@",13)?.N1",".N,$D(@(BSR_"(BST,f,ny,nx,2)")) S %KAT(4,f,2)=@$ZR
 ..I $D(@(BSR_"(BST,f,"_nynx_")")) S %KAT(4,f)=@$ZR I $D(@(BSR_"(BST,f,"_nynx_",1)")) S %KAT(4,f,1)=@$ZR
 I $D(@(BSR_"(BST,""KEY"")")) S %KAT(5)=$P(@$ZR,"@") S i="" F  S i=$O(@(BSR_"(BST,""KEY"",i)")) Q:i=""  S %KAT(5,i)=$G(@(BSR_"(BST,""KEY"",i)")) S ii="" F  S ii=$O(@(BSR_"(BST,""KEY"",i,ii)")) Q:ii=""  S %KAT(5,i,ii)=$G(@(BSR_"(BST,""KEY"",i,ii)")) D
 .S iii="" F  S iii=$O(@BSR@(BST,"KEY",i,ii,iii)) Q:iii=""  S %KAT(5,i,ii,iii)=$G(@BSR@(BST,"KEY",i,ii,iii))
 I $D(@(BSR_"(BST,""Key"")")) S i="" F  S i=$O(@(BSR_"(BST,""Key"",i)")) Q:i=""  S %KAT(6,i)=$G(@(BSR_"(BST,""Key"",i)")) S ii="" F  S ii=$O(@(BSR_"(BST,""Key"",i,ii)")) Q:ii=""  S %KAT(6,i,ii)=$G(@(BSR_"(BST,""Key"",i,ii)")) D
 .S iii="" F  S iii=$O(@BSR@(BST,"Key",i,ii,iii)) Q:iii=""  S %KAT(6,i,ii,iii)=$G(@BSR@(BST,"Key",i,ii,iii))
 I $D(BSTABL) Q
 S IYI="^%ZAPM.ed.BSS,INFO" D NE^%ZAPM.ed.BSN K %KAT,f Q
KILBF ;УДАЛЕНИЕ СТАРЫХ БУФЕРОВ
 F f="S ff=$P(^(j),""@"",14)","S ff=$P($P(^(j),""@"",18),""#"",2)","S ff=$P($P(^(j),""@"",18),""#"")","COL","RTR","FTR","FCL","CMD" S BSr="^%ZAPM.ed.BSbufB",BSt="INF"_f_$G(%BS(3),$P)_$J_"u"_BSR_","_BST K @(BSr_"(BSt)")
 Q
LOS S I="LOGS"_$G(%BS(3),$P)_$J_$P($$ZU^%ZAPM.ed.BS3(1,0),",",2)_"u1",IYI="^%ZAPM.ed.BSbufB,"_I D NE^%ZAPM.ed.BSN G 1^%ZAPM.ed.BSTM
DARK S Dark(1,1,2,2,1)=" 0 1",Dark(1,1,2,2,2)=" 0 1"
 S Dark(1,1,2,2,3)=" 0 1",Dark(1,1,4)=" 0 0 1 1",Dark(1,1,5)=" 0 1 0 1",Dark(1,1,6,3,1)=" 1 0",Dark(1,1,6,5)=" 0 1",Dark(1,1,8)=" 0 1",Dark(1,1,6,3,2)=" 1 0"
 Q
AF ;РЕДАКТИРОВАНИЕ БЛОК-МЕНЮ
 D SA^%ZAPM.ed.BSsBUF N oo,o1,o0,o2,o3,o4,o5,o6,o7,o8,o9
 I $E(O0,1)'="^" S ls=" МАССИВ БЛОК-МЕНЮ НЕ ГЛОБАЛЬНЫЙ " D O^%ZAPM.ed.BSF7 G AFE
 S BSr1="^%ZAPM.ed.BSS",BSt1="ALTF",BSr2="^%ZAPM.ed.BSbufB",BSt2="ALTF"_$G(%BS(3),$P)_$J_"u" D COPY^%ZAPM.ed.BSTK S $P(@(BSr2_"(BSt2)"),"@",6)=""
 S o3=$G(@(O0_")")),$P(@(BSr2_"(BSt2,1,2)"),"@",15)=$P(o3,O4,O6+1)
 S $P(@(BSr2_"(BSt2,2,2)"),"@",15)=$P(o3,"@",5)
 I $P(o3,"@",5)'="" S $P(@(BSr2_"(BSt2,3,2)"),"@",15)=$G(@(OOO_"("_$P(o3,"@",5)_","_O6_")"))
 S $P(@(BSr2_"(BSt2,4,2)"),"@",15)=$P(o3,"@",2)
 S $P(@(BSr2_"(BSt2,5,2)"),"@",15)=$P($P(o3,"@",8),";",O6)
 S $P(@(BSr2_"(BSt2,6,2)"),"@",15)=$P($P(o3,"@",7),";",O6)
 S $P(@(BSr2_"(BSt2,8,2)"),"@",15)=O0
 S $P(@(BSr2_"(BSt2,9,2)"),"@",15)=$O(@($P(OOO,"(")_"($C(1))"),-1)
 S $P(@(BSr2_"(BSt2,7,2)"),"@",15)=$P($P(o3,"@",6),";",O6),IYI=BSr2_","_BSt2 D NE^%ZAPM.ed.BSN
 G AFE:'$P(@(BSr2_"(BSt2)"),"@",6) S ls=" ЗАПИЩЕМ РЕЗУЛЬТАТЫ КОРРЕКЦИИ БЛОКА МЕНЮ ? " D YES^%ZAPM.ed.BSF G AFE:'YES
 S %zT=$ZT,$ZT="ERR^%ZAPM.ed.BSF6",O0=$P(^(BSt2,8,2),"@",15) F i1=1:1:8 S @("o"_i1)=$P(@(BSr2_"(BSt2,i1,2)"),"@",15)
 G AFE:o1=""!(o1[" ") S o0=$G(@(O0_")")),$P(o0,O4,O6+1)=o1,$P(o0,"@",5)=o2 I o2'="" S @(OOO_"("_o2_","_O6_")")=o3
 S $P(o0,"@",2)=o4,oo=$P(o0,"@",8),$P(oo,";",O6)=o5,$P(o0,"@",8)=oo
 S oo=$P(o0,"@",7),$P(oo,";",O6)=o6,$P(o0,"@",7)=oo
 S oo=$P(o0,"@",6),$P(oo,";",O6)=o7,$P(o0,"@",6)=oo
 S @(O0_")")=o0,$ZT=$G(%zT)
AFE D RE^%ZAPM.ed.BSsBUF Q
HISET() Q "^%ZAPM.ed.BSbufB(""HISCOMMAND"_$S('$E(%BS(1),12):$G(%BS(3),$P)_$G(%BS(12)),$E(%BS(1),12)=1:"1"_$G(%BS(12)),1:"1")_""")"
 Q
ERR S ls=" ОШИБКА "_$ZE D O^%ZAPM.ed.BSF7 G AFE
CMint S BSLOGIN=$G(%BS(12)),BSSES=$G(%BS(40)),CMint="N (BSLOGIN,BSSES) "
CM D LOCK^%ZAPM.ed.BSF4 N %BSenter
 D SA^%ZAPM.ed.BSsBUF,OP^%ZAPM.ed.BSF4,UCIS^%ZAPM.ed.BSF3,CMD,UCIR^%ZAPM.ed.BSF3,RE^%ZAPM.ed.BSsBUF,CL^%ZAPM.ed.BSF4,CLr^%ZAPM.ed.BSF4,CCC^%ZAPM.ed.BSC Q
CMD W $$atr^%ZAPM.ed.BS3(0),/ED(2) D SI^%ZAPM.ed.BSN N (%BS,vl,Tmp,CMint,BSLOGIN,BSSES) D SI^%ZAPM.ed.BSN G ERCMD
SHELL N ls,%HIS S %BSenter=1,ls="Область: <"_$$ZU^%ZAPM.ed.BS3(0)_"> Устройство="_$G(%BS(3),$P)_" ("_$P_") Задание="_$J_" Версия ("_$G(^%ZAPM.ed.BS)_")"
 S %HIS=$$HISET ;D Tex^%ZAPM.ed.BSMSMF("%BS-Cmd. Change Variable","")
 S Tmp=$$LineEdit^%ZAPM.ed.BSXfun("",ls,"","","^%ZAPM.ed.BSHLP(""ALT-F10"")",%HIS,"")
 I Tmp'="",$$Data^%ZAPM.ed.BSF12($NA(@$$KBD^%ZAPM.ed.BSF12("^%ZAPM.ed.BSS(""CMD"")")@(Tmp))),$G(^(Tmp,"S"))'="",$$DelHist^%ZAPM.ed.BSXuse(%HIS,1) Q
 Q
CMD1 S %zT=$ZT,$ZT="ERCMD^%ZAPM.ed.BSF6"
 F  D SHELL Q:Tmp="EXIT"!(Tmp="exit")!(Tmp=".")!(Tmp="1")!(YES=0)!(Tmp="Msw")  H:Tmp="2"  D:Tmp="DOS"!(Tmp="dos")!(Tmp="3") SSD^%ZAPM.ed.BSD2 D  X $G(CMint)_Tmp
   .D CLEAR
   .I Tmp'="" D
   ..I $E(Tmp)="?",Tmp'="?" D MSMHELP^%ZAPM.ed.BSDOS2($$BIGL^%ZAPM.ed.BSsFUNM($E(Tmp,2,999))) S Tmp="" Q
   ..I $$Data^%ZAPM.ed.BSF12($NA(@$$KBD^%ZAPM.ed.BSF12("^%ZAPM.ed.BSS(""CMD"")")@(Tmp))) S Tmp=$G(^(Tmp,"c")) I Tmp'="" Q
   ..I $D(^%ZAPM.ed.BScmd(Tmp)) S Tmp=$G(^(Tmp,"c")) Q
   .I $E(Tmp,1)="!" S Tmp="D EXE^%ZAPM.ed.BSDOS("_$C(34)_$E(Tmp,2,999)_$C(34)_",1)"
 S $ZT=$G(%zT)
 Q
CLEAR W $$atr^%ZAPM.ed.BS3(0),/CUP(1,1),/ED(2) D Echo^%ZAPM.ed.BSXfun(1) Q
LOCKTAB N  S uci=$$ZU^%ZAPM.ed.BS3(0) D MGR^%ZAPM.ed.BS,^LOCKTAB,%GU^%ZAPM.ed.BSF4 Q
ERCMD I $ZE["<NOSYS"!($ZE["<NAMESPACE") S CCMMDD="^%ZAPM.ed.BScmd"
 U 0 W ! W:$ZE'="" "Последняя Ошибка: ",$ZE,! W !,"Введите '?' для помощи по Командам и 'F1' - режимы строчного редактора",!
 S mtempXERROR=$G(mtempXERROR)+1 I mtempXERROR>5 W !,"Произошло зацикливание с ошибкой !!!" R *R H
 ;W !!,"1. Возвpат в %BS  введите : 'EXIT','.' или клавиша <Esc>",!!,"2. Выход в MSM  введите :'HALT'",!!,"3. Уйти в DOS  введите : 'DOS'",! 
 G CMD1
HELP S IYI="%BSS,CMD" D ENTER^%ZAPM.ed.BSN D CLEAR Q
DIR ;ВХОД В КАТАЛОГ %BS
 D SA^%ZAPM.ed.BSsBUF,UCIS^%ZAPM.ed.BSF3 D  D UCIR^%ZAPM.ed.BSF3,RE^%ZAPM.ed.BSsBUF Q
 .D ^%ZAPM.ed.BSD
F1 S l4=19,Xx=nx,Yy=ny,$P(@(BSR_"(BST,ny,nx)"),"@",19)=$P(@(BSR_"(BST)"),"@",39) D TAB2^%ZAPM.ed.BSF3 S l4=$P(@(BSR_"(BST,Yy,Xx)"),"@",19),$P(@$ZR,"@",19)="" D R^%ZAPM.ed.BSF4(39,l4) K l4,Xx,Yy Q
F1K S l4=20 D TAB2^%ZAPM.ed.BSF3 K l4 Q
F1KCOPY S l4=$P(BS,"@",20),do="S $P(^(j),""@"",20)=l4" D BLOK^%ZAPM.ed.BSF1 K l4 Q
]]></Routine>


<Routine name="%ZAPM.ed.BSF7" type="MAC" languagemode="0"><![CDATA[
%BSF7 ;ФУНКЦИИ %BS ; 14:22   05.03.2001
%BSUSER() ;ПЕРЕОПРЕДЕЛЕНИЕ ИМЕНИ ПОЛЬЗОВАТЕЛЯ
 S YES=1 D PPP^%ZAPM.ed.BS1 I '$D(%BS(12)) S YES=0 Q $C(0)
 I %BS(12)'="",$G(@%BS(18)@(%BS(12),0,"9,4"))'="" S %BS(37)=@$ZR
 Q %BS(12)
e ;
ENTERPAS(B) N i ;ОПРЕДЕЛЕНИЕ ПАРОЛЕЙ ТАБЛИЦЫ
 F i=2,4,5 K %w(i) S %w(i)=$P(B,"@",i) I %w(i)'="" D
 .I $G(%BS(12))="" K %w(i) Q
 .I $G(@%BS(18)@(".@PASSWORD",%BS(12)),"¤")=%w(i) Q
 .K %w(i)
 Q
 ;???? K KEYPAS S li=IMQ D TIR S:BSr'["^" BSr="^"_BSr I $G(@(BSr_"(BSt,""KEY"",key,6)"))["$KEYPAS(" S KEYPAS='$$KEYPAS^%ZAPM.ed.BSF7(BSD,.%KEYS)
CHECK(GL) N GL1 I $G(%BS(12))'="",$G(@%BS(18)@(".@PASSWORD",%BS(12)),"¤@")=@GL Q 1
 I $G(@GL)="" D L^%ZAPM.ed.BS3(GL) K @GL D U^%ZAPM.ed.BS3(GL) Q 1
 D PASCHECK^%ZAPM.ed.BS1(GL,"",1,"На Узел существует пароль ! Введите ","GL1") I '$D(GL1) Q 0
 Q 1
PASS(G,K) N GL,GL1 ;ПАРОЛИРОВАНИЕ УЗЛОВ БАЗЫ ДАННЫХ
 S G=$$BSD^%ZAPM.ed.BSA(G,$G(K(0))) I $D(K) F ii=1:1:key-1 Q:'$D(K(ii))  S G=G_$S(K(ii)'=+K(ii):$C(34)_K(ii)_$C(34),1:K(ii))_","
 S G=G_$S(d'=+d:$C(34)_d_$C(34),1:d)_","
 I $D(@(G_"""@PASSWORD"")")) S GL=$ZR D PASCHECK^%ZAPM.ed.BS1(GL,"",1,"На Узел '"_d_"' существует пароль ! Введите ","GL1") I '$D(GL1) Q
 S:'$D(GL) GL=$ZR S ls=" Будем вводить новый пароль на Узел '"_d_"'" D YES^%ZAPM.ed.BSF I 'YES Q
 D L^%ZAPM.ed.BS3(GL),PASSWORD^%ZAPM.ed.BSF4(GL,"",1,"Вводите пароль На Узел '"_d_"'","GL1"),U^%ZAPM.ed.BS3(GL) I '$D(GL1) Q
 Q
O I $G(%BS(13))="%BS-PC" d ErrMsg^%ZAPM.ed.BSXfun(ls) Q  ;СООБЩЕНИЕ ОБ ОШИБКЕ
OSH n x I $ZV'["Cach"&&($ZV'["IRIS") ;U $I:(0::::#10080)
 W $$bel^%ZAPM.ed.BS3,/CUP(23,1),$$clr^%ZAPM.ed.BS3($G(CoLoR,10)),$E(ls,1,153),$$atr^%ZAPM.ed.BS3(0),$J("",153-$L($E(ls,1,153)))
 W $$clr^%ZAPM.ed.BS3($G(CoLoR,10))," <Ok>",$$atr^%ZAPM.ed.BS3(0),$$rt^%ZAPM.ed.BS3(9999),/CUP(23,1) X "I 0" I R1=0,R2=140 D x^%ZAPM.ed.BS3("Ловушка...пользователя")
 W $$atr^%ZAPM.ed.BS3(0),/CUP(23,1),/EL(0),/CUP(24,1),/EL(0),/CUP(25,1),/EL(0)
 Q
CHNAME ;СМЕНА ИМЕНИ
 S ls=" ВАШЕ ТЕКУЩЕЕ ИМЯ :"_%BS(12)_" ,ХОТИТЕ РАБОТАТЬ ПОД ДРУГИМ ? " D YES^%ZAPM.ed.BSF
 I YES D OP^%ZAPM.ed.BSF4 S Me=%BS(12),MeCtO=$$%BSUSER D CL^%ZAPM.ed.BSF4 S %BS(12)=Me Q:MeCtO=$C(0)  S %BS(12)=MeCtO
 Q
AF ;ВЫЗОВ АНАЛИТИЧЕСКИХ ФОРМ
 N MeCtO,FLAG S FLAG=$E(%BS(1),11)
AFin S MeCtO=$$ZU^%ZAPM.ed.BS3(0) I $$ZU^%ZAPM.ed.BSF4("MOL","VOI") D  S uci=MeCtO D %GU^%ZAPM.ed.BSF4 I 'YES H
 .N MeCtO
 .S IYI=$S('FLAG:"^[""MOL"",""VOI""]ENTER,M0",1:"^[""MOL"",""VOI""]ENTER,L")
 .D NEB^%ZAPM.ed.BSN
 Q
DDR ;ВЫЗОВ DDR
 N MeCtO,FLAG S FLAG=$E(%BS(1),11)
DDRin S MeCtO=$$ZU^%ZAPM.ed.BS3(0) D MGR^%ZAPM.ed.BS
 S IYI=$S('FLAG:"^%ZAPM.ed.BSDDR,DDRM0",1:"^%ZAPM.ed.BSMDDR,Z") D  S uci=MeCtO D %GU^%ZAPM.ed.BSF4
 .N MeCtO,FLAG
 .D NEB^%ZAPM.ed.BSN
         I 'YES H
 Q
DDRint(FLAG) G DDRin
SAY N I,QQ S QQ=$$SW^%ZAPM.ed.BSF12("^%ZAPM.ed.BSS(""OWNER"")")
 W !,$G(@QQ@(1))," §",^%ZAPM.ed.BS F I=2:1 Q:'$D(@QQ@(I))  W !,@QQ@(I)
 Q
HIDON D R^%ZAPM.ed.BSF4(42,1) Q
HIDOFF D R^%ZAPM.ed.BSF4(42,"") Q
EdNumF S ls=" Вводите / Корректируйте Номер ПОЛЯ DBF",li=$P(@(BSR_"(BST,ny,nx)"),"@",6) D LE^%ZAPM.ed.BSTT I YES G:'YES EdNumF S $P(@(BSR_"(BST,ny,nx)"),"@",6)=li Q
 Q
CoNumF S li=$P(@(BSR_"(BST,ny,nx)"),"@",6),do="S $P(^(j),""@"",6)=li" D BLOK^%ZAPM.ed.BSF1
 Q
CtrDBF S YES=1 I '$D(@(BSR_"(BST,""DBF"")")) S YES=0 D ErrMsg^%ZAPM.ed.BSXfun("ДЛЯ ТАБЛИЦЫ ЕЩЁ НЕ ОПРЕДЕЛЕНА СТРУКТУРА DBF") Q
 Q
CtrNum S YES=1  I +$G(@(BSR_"(BST,""DBF"",4,1)"))<li G CtrNumEr
 I li<1 G CtrNumEr
 Q
CtrNumEr S YES=0 D ErrMsg^%ZAPM.ed.BSXfun("В СТРУКТУРЕ DBF "_$G(@$ZR)_" ПОЛЕЙ ! А ВЫ ВВОДИТЕ "_li_" ?") Q
ClearSpc(s) N i f i=$L(s):-1:0 q:$E(s,i)'=" "
 q $E(s,i>0,i)
WIND N x,y S ls=" Вводите / Корректируйте Размер Окна Коррекции Y,X ",li=$P(@(BSR_"(BST,ny,nx)"),"@",21)
WIN D LE^%ZAPM.ed.BSTT I YES D:li'="" CtlWIND G:'YES WIN D  Q
 .D Yes^%ZAPM.ed.BSXfun("В клетках ВСЕЙ таблицы ?",2) I YES D R^%ZAPM.ed.BSF4(26,li) Q
 .S $P(@(BSR_"(BST,ny,nx)"),"@",21)=li
CtlWIND S YES=1 I li="" Q
 S y=$P(li,","),x=$P(li,",",2) I (x*y)>500 D ErrMsg^%ZAPM.ed.BSXfun("ОЧЕНЬ БОЛЬШОЕ ОКНО") S YES=0 Q
 I (x*y)<1 D ErrMsg^%ZAPM.ed.BSXfun("ОЧЕНЬ МАЛЕНЬКОЕ ОКНО") S YES=0 Q
 I x>70&(x<5) D ErrMsg^%ZAPM.ed.BSXfun("НЕПРАВИЛЬНЫЙ ДИАПАЗОН ПО X (от 5 до 70)") S YES=0 Q
 I y>10&(x<2) D ErrMsg^%ZAPM.ed.BSXfun("НЕПРАВИЛЬНЫЙ ДИАПАЗОН ПО Y (от 2 до 10)") S YES=0 Q
 Q
BA S li=$$BigEdit^%ZAPM.ed.BSXuse(li,y1,x1,y2,x2,"@") K x,y,x1,x2,y1,y2 Q
BAR(y,x) S y1=($P(BS,"@")+1-BS1+BSY1(BS0)),y2=($P(BS,"@")-BS1+BSY1(BS0)+$P(BS,"@",3))
 ;~~~S y=+$P(BS,"@",21),x=$P($P(BS,"@",21),",",2)
 I (y+2)<y1 S y1=2,y2=y1+y-1 D BARX G BA
 I y<(24-y2) S y1=y2+2,y2=y1+y-1 D BARX G BA
 S y1=8,y2=y1+y D BARX G BA
BARX S x1=(79-x)\2,x2=x1+x Q
UPG ;ПОВЫШЕНИЕ ВЕРСИИ ТАБЛИЦЫ
 S Tab=$$DclTab^%ZAPM.ed.BSGFUN0("") Q:Tab=""
 S Glo=$$TranTab^%ZAPM.ed.BSGFUN0(Tab) Q:Glo=""  I $D(@Glo) D Yes^%ZAPM.ed.BSXfun("ТАБЛИЦА "_Tab_" УЖЕ СУЩЕСТВУЕТ ! ПЕРЗАПИСЫВАЕМ ?",2) Q:YES<1
 I $D(@(BSR_"(BST)")) S Tab=$ZR
 I Tab=Glo D ErrMsg^%ZAPM.ed.BSXfun(" ТЕКУЩУЮ НЕЛЬЗЯ !!!") Q
 D UpGraid^%ZAPM.ed.BSGFUN0(Tab,Glo) Q
%BSU() ;Имя базы данных пользователей %BS
 I $ZV["Cach"||($ZV["IRIS") Q "%BS(39)"
 N RAZ S RAZ=0
RAZ I $D(^%ZAPM.ed.BSS("USER","KEY")),$$Data^%ZAPM.ed.BSF12($NA(@$P(^%ZAPM.ed.BSS("USER","KEY"),"@"))) Q $ZR
 I $G(%BS(23)) S RAZ=RAZ+1 I RAZ<5 W $$bel^%ZAPM.ed.BS3,$$bel^%ZAPM.ed.BS3 H 1 G RAZ
 Q "^%ZAPM.ed.BSuDFLT"
 ;
ver() i $P($ZV,"Version ",2)'<4 Q "|" ;Полная ссылка в MSM 4.0
 Q "]"
]]></Routine>


<Routine name="%ZAPM.ed.BSF8" type="MAC" languagemode="0"><![CDATA[
%BSF8 ;ЭКРАН В ДОС,ПАНЕЛЬ,msmHistory,Copy-Merge...; 17:08  6-MAR-95 ; 14:19   14.09.99
Shift(R2) D SA^%ZAPM.ed.BSsBUF
 I $$Data^%ZAPM.ed.BSF12($$KBD^%ZAPM.ed.BSF12("^%ZAPM.ed.BSS(""CMD"")")),$D(@$ZR@("ShiftF"_(R2-83))),$D(@$ZR@("c")) X @$ZR G ShE
 I $D(^%ZAPM.ed.BScmd("ShiftF"_(R2-83))),$D(@$ZR@("c")) X @$ZR
ShE D RE^%ZAPM.ed.BSsBUF Q
AltKey I R3=-1 D
 .I R2=139,$E(%BS(1),4),'$E($G(%BS(14)),4) D WiL Q
 .I R2=140,$E(%BS(1),5),'$E($G(%BS(14)),4) D Trap Q
 .I R2=84 S IYI="^%ZAPM.ed.BSS(ShiftF1" D NE^%ZAPM.ed.BSN Q
 .I R2=88,$D(BSR),$D(BST) D BUFCOPY^%ZAPM.ed.BSF12 Q
 Q
TPr(BT) ;УСТАНОВКА ТИТУЛА ПО ТИТУЛУ ПЕЧАТИ
 N yt,xt S yt=+$P($P(@BT,"@",50),","),xt=+$P($P(@BT,"@",50),",",2) I yt,($P($G(@BT@(yt,xt)),"@")+$P($G(@BT@(yt,xt)),"@",3))'>20 S $P(@BT,"@",19)=yt_","_xt
 Q
Trap N R1,R2,R3,YES,li,lop,ls D x^%ZAPM.ed.BS3("Alt-F12") Q
WiL N Wi,i,ii,iii,%,%FN,%DEV,%DEVTYPE,%GO,%JB,Ox,Oy,R1,R2,R3,YES,li,lop,ls
 S %FN="%BSPRN.SCR"
 D SaveLock^%ZAPM.ed.BSsBUF("Wi",1,1,25,80)
 D SA^%ZAPM.ed.BSsBUF
 D DosOpn^%ZAPM.ed.BSBL1(54,%FN) Q:'$D(%FN)  U %DEV W "---------- Экран ... ",$TR($J("",58)," ","-"),"-",!
 F i=1:1 Q:'$D(Wi(i))  U %DEV W "|",$E($$Wi(Wi(i)),1,78),"|",!
 U %DEV W "-",$TR($J("",78)," ","-"),"-",!
 D CLO^%ZAPM.ed.BSS1,RE^%ZAPM.ed.BSsBUF Q
Wi(Wi) N iii,ii S iii="" F ii=1:2 Q:$E(Wi,ii)=""  S iii=iii_$E(Wi,ii)
 Q iii
 ;
MSMHIST ; ДОБАВЛЕНИЕ В HISTORY СТРОКУ ИЗ ТЕКСТА ДЛЯ MSM
 I $ZV["Cach"||($ZV["IRIS") D HIST^%ZAPM.ed.BSCp Q
 N uci,i,lHisT S lHisT=$E($G(LocS,@Bstr),Col,$$LNG^%ZAPM.ed.BSF12),uci=$$ZU^%ZAPM.ed.BS3(0) D MGR^%ZAPM.ed.BS
 S i=$O(^MSMSHIST($J,""),-1)+1,^MSMSHIST($J,i)=lHisT D %GU^%ZAPM.ed.BSF4 W $$bel^%ZAPM.ed.BS3
 D Say^%ZAPM.ed.BSXfun("В History MSM положена строка '"_lHisT_"'") Q
 ;
COPYCMD ;КОПИРОВАНИЕ ТАБ В БЛОК
 S l4=14
COPY S li=$P(@(BSR_"(BST,ny,nx)"),"@",l4),do="S $P(^(j),""@"",l4)=li" D BLOK^%ZAPM.ed.BSF1 K l4,li Q
 ;
TXTLOG ;ТЕКСТ ОБ ОШИБКЕ
 I ('$D(@BSR@(BST,"COL",ny,nx))!$P(@BSR@(BST,ny,nx),"@",13)="") D ErrMsg^%ZAPM.ed.BSXfun("СНАЧАЛО ВВЕДИТЕ ФОРМУЛУ ЛОГ.КОНТРОЛЯ") Q
 S li=$G(@BSR@(BST,"COL",ny,nx,2)),ll="{}",ls="Редактируйте Текст об ошибке в Формуле Логического Контроля" D LE^%ZAPM.ed.BSTT I 'YES Q
 I li="" K @BSR@(BST,"COL",ny,nx,2) D OkMsg^%ZAPM.ed.BSXfun("ТЕКСТ УДАЛЕН",1) Q
 S @BSR@(BST,"COL",ny,nx,2)=li Q
 ;
ErrSay(ZE) ;ВОЗВРАТ ТЕКСТА ОШИБКИ ПО КОДУ
 N S S S=$ZR I $ZV["Cach"||($ZV["IRIS") Q:$P(ZE,">")="" "" Q $G(^%ZAPM.ed.BSCGER($P(ZE,">")))_". $ZR="_S
 Q $G(^%ZAPM.ed.BSGER(+$P(ZE,":",4)))_". "_$G(^%ZAPM.ed.BSGER(+$P(ZE,":",4),+$P(ZE,":",5)))_". $ZR="_S
 ;
ButtPan ;СОЗДАНИЕ ПАНЕЛИ С КНОПКАМИ
 N i,j,M,P1,P2,GGG S ny=1,nx=1
 F i=ny:1 Q:$$DataCell(BSR,BST,i,nx)=""  S M(0,i)=$$DataCell(BSR,BST,i,nx) I $$ColrCell(BSR,BST,i,nx)'="" S M(0,i,1)=$$ColrCell(BSR,BST,i,nx)
 S j=0 F i=ny:1 Q:$$DataCell(BSR,BST,i,nx+1)=""  S j=j+1,M(1,i)=$$DataCell(BSR,BST,i,nx+1) D
 .I j=1,$$ColrCell(BSR,BST,i,nx+1)'="" S P1=$$ColrCell(BSR,BST,i,nx+1)
 .I j=2,$$ColrCell(BSR,BST,i,nx+1)'="" S P2=$$ColrCell(BSR,BST,i,nx+1)
 .I $$DataCell(BSR,BST,i,nx+2)'="" S M(4,j)=$$DataCell(BSR,BST,i,nx+2) ;DATA
 .I $$EntrCell(BSR,BST,i,nx+1)'="" S M(3,j)=$$EntrCell(BSR,BST,i,nx+1) ;DO
 .I $$LogCell(BSR,BST,i,nx+1)'="" S M(2)=j                             ;PRED
 .I $$DataCell(BSR,BST,i,nx+3)="GO" S M(5,j)=1                         ;GO
 S M(1)=$G(P1)_"/"_$G(P2),M=$P(@BSR@(BST),"@",1)_"/"_$P(@BSR@(BST),"@",31)
 S M(6,1)=$S($P(@BSR@(BST),"@",8)=1:0,1:$P(@BSR@(BST),"@",8)),M(6,2)=$S($P(@BSR@(BST),"@",9)=1:0,1:$P(@BSR@(BST),"@",9))
 S M(0)=$P(@BSR@(BST),"@",31) I $D(@BSR@(BST,"BUT")) S GGG=$ZR,ls="Заменяем старую панель ?" D YES^%ZAPM.ed.BSF I 'YES Q
 I '$D(GGG) S GGG=$ZR
 D Copy("M",GGG) S $P(@BSR@(BST),"@",17)=8
 Q
DoButt ;ВХОД В ТАБЛИЦУ-ПАНЕЛЬ С КНОПКАМИ
 I '$D(@BSR@(BST,"BUT"))
 D EnterP($ZR) I d<0 W $$bel^%ZAPM.ed.BS3 G GO^%ZAPM.ed.BST
 Q
Go W $$bel^%ZAPM.ed.BS3 S R1=27 Q
EnterP(GGG) N Bu,But
 I '$D(@GGG) S d=-5 G Go
 ;```I $G(%BS(14)) G TrmPanel
 s Bu=$G(@GGG@(2),1) ;ПРЕДУСТАНОВКА
EnteP S Mouse(1)=$G(Mouse),Mouse=2,d=$$TxtPanel^%ZAPM.ed.BSXfun1(GGG,$G(@GGG@(6,1),0),$G(@GGG@(6,2),0),Bu) S Mouse=$G(Mouse(1))
 I d=-4 G Go
 I d<0 G Go
 I YES=0 S R1=27 Q
 I $D(@GGG@(3,d)) S IYI=@$ZR D NEB^%ZAPM.ed.BSN I d'="",'$D(@GGG@(5,d)) S Bu=d G EnteP
 S R1=13,d=$G(@GGG@(4,$S(d="":0,1:d)),d)
 Q
TrmPanel ;ЭМУЛЯЦИЯ ПАНЕЛИ С КНОПКАМИ ДЛЯ ТЕРМИНАЛОВ
 N A,AA,T,TT,X,XXx,P,%B,ls,li,IYI
 S AA="" F A=1:1 Q:'$D(@GGG@(0,A))  S AA=AA_$$Cut^%ZAPM.ed.BSF10($$Cut^%ZAPM.ed.BSF10(@GGG@(0,A),0),1)_" "
 S TT=" " F T=1:1 Q:'$D(@GGG@(1,T))  S TT=TT_$TR($G(@GGG@(1,T))," ","_")_" "
 S P=$G(@GGG@(2)),AA=" "_AA_" "
TrmPa D MENU^%ZAPM.ed.BSF5(TT,$E(AA,1,79),P) I R1=0,R2=33 S d=-7 Q
 I YES<1 S R1=27 Q
 I '%B G Go
 S XXx=%B I $D(@GGG@(3,XXx)) S IYI=@$ZR D NEB^%ZAPM.ed.BSN I XXx'="",'$D(@GGG@(5,XXx)) S P=XXx G TrmPa
 S R1=13,d=$G(@GGG@(4,XXx),0)
 Q
DataCell(BSR,BST,i,j) Q $P($G(@BSR@(BST,i,j)),"@",15)
ColrCell(BSR,BST,i,j) Q $P($G(@BSR@(BST,i,j)),"@",10)
EntrCell(BSR,BST,i,j) Q $P($G(@BSR@(BST,i,j)),"@",14)
LogCell(BSR,BST,i,j) Q $P($G(@BSR@(BST,i,j)),"@",13)
 ;
Copy(TRe1,TRe2,NOKILLER,S)  ;Копирование Узла в ...  S=1 - Выводить счет узлов
 N j,jj,WA,WAI,R,r,Sec,TRe3,v ;NOKILLER=1   Неудалять Целевой узел
                            ;NOKILLER=""  УДАЛЯТЬ
                            ;!!!ЕСЛИ TRe1=Код СИМВОЛА ,КАКИМ ПЕРЕЗАПИСЫВАТЬ
                            ;      УДАЛЯЕМЫЕ ДАННЫЕ В УЗЛЕ TRe2
                            ;TRe2=Номер Устройства ВЫВОДА УЗЛОВ TRe1
 S %zT=$ZT,$ZT="ERFILE^%ZAPM.ed.BSF8"
 S R="]",r=2 ;4.;I $P($ZV,"Version ",2)'<4 S R="|",r=3
 I TRe2?.N S TRe2=+TRe2
 I TRe2'?.N,TRe1'?.N,$G(NOKILLER)="" K @TRe2
 I $P($ZV,"Version ",2)'<4,TRe2'?.N,"1"'[$G(NOKILLER) M @TRe2=@TRe1 Q
 I TRe2'?.N D
 .I TRe1?.N S:$D(@TRe2)'["0" @TRe2=$TR($J("",$L(@TRe2))," ",$C(+TRe1)) Q
 .S:$D(@TRe1)'["0" @TRe2=@TRe1
 I TRe2?.N U TRe2 W:$D(@TRe1)'["0" TRe1,!,@TRe1,! Q:$ZC
 I $G(S)'="" U 0 D Wait^%ZAPM.ed.BSXfun($S(S=1:"Копируем "_TRe1_" в "_TRe2_"...",1:S))
 I TRe1?.N,TRe2'?.N S Sec=+TRe1,TRe1=TRe2
 S (j,TRe3)=TRe1 I $E(TRe1,$L(TRe1))=")" S TRe1=$E(TRe1,1,$L(TRe1)-1)
 S jj=$S(TRe1[R:$P(TRe1,R,r,99),1:$P(TRe1,"^",2,99))_$S(TRe1["(":",",1:"(")
 I TRe2?.N D  Q
 .F v=1:1 S j=$ZO(@j) Q:$S(j[R:$P(j,R,r,99),1:j)'[jj  U TRe2 W j,!,@j,! Q:$ZC  I '(v#50),$G(S)'="" U 0 X WA
 I $E(TRe2,$L(TRe2))=")" S TRe2=$E(TRe2,1,$L(TRe2)-1)
 I $G(Sec)'="" D  K:$G(NOKILLER)="" @TRe3 Q
 .F  S j=$ZO(@j) Q:$S(j[R:$P(j,R,r,99),1:j)'[jj  S @j=$TR($J("",$L(@j))," ",$C(Sec)) I $G(S)'="" U 0 X WA
 F  S j=$ZO(@j) Q:$S(j[R:$P(j,R,r,99),1:j)'[jj  S @(TRe2_$S(TRe2["(":",",1:"(")_$P(j,jj,2,9))=@j I $G(S)'="" U 0 X WA
 Q
ERFILE D ErrMsg^%ZAPM.ed.BSXfun($ZE_" "_$$ErrSay^%ZAPM.ed.BSF8($ZE)) S $ZT=$G(%zT) Q
VLY0 D R^%ZAPM.ed.BSF4(48,+$E($P(@(BSR_"(BST)"),"@",48),1)_"0") Q
VLY1 D R^%ZAPM.ed.BSF4(48,+$E($P(@(BSR_"(BST)"),"@",48),1)_"1") Q
VL1 D R^%ZAPM.ed.BSF4(48,"1"_+$E($P(@(BSR_"(BST)"),"@",48),2)) Q
VL0 D R^%ZAPM.ed.BSF4(48,"0"_+$E($P(@(BSR_"(BST)"),"@",48),2)) Q
UK0 D R^%ZAPM.ed.BSF4(43,"") Q
UK1 D R^%ZAPM.ed.BSF4(43,1) Q
KM0 D R^%ZAPM.ed.BSF4(49,"") Q
KM1 D R^%ZAPM.ed.BSF4(49,1) Q
TitPrO N li
TitPr S li=$P(@BSR@(BST),"@",50)
 S li=$$LineEdit^%ZAPM.ed.BSXfun(li,"ВВЕДИТЕ ТИТУЛ ДЛЯ ПЕЧАТИ (В ФОРМАТЕ:Y,X)") Q:YES<1  I li'="",li'?1N.N1","1N.N D ErrMsg^%ZAPM.ed.BSXfun("ОШИБКА ФОРМАТА") G TitPr
 D R^%ZAPM.ed.BSF4(50,li) Q
PK0 D R^%ZAPM.ed.BSF4(45,1) Q
PK1 D R^%ZAPM.ed.BSF4(45,"") Q
AF0 D R^%ZAPM.ed.BSF4(47,"") Q
AF1 S li=$$LineEdit^%ZAPM.ed.BSXfun(2,"Проверять формат: 1= где ВЫЧ, 2= для СводокИсписков, 3=БД, 12= и то и то")
 D R^%ZAPM.ed.BSF4(47,li) Q
 ;
UKA ;ДВИЖЕНИЕ УКАЗАТЕЛЯ
Right I R3=67 S MR=0,M1=MX D WO^%ZAPM.ed.BSTM S MR=1 D  S MX=M1 Q
 .F  S M1=$O(BX(M1)) Q:M1=""  I $P($G(@BSR@(BST,BY(MY),BX(M1))),"@",5)="" Q
 .I M1="" F  S M1=$O(BX(M1)) Q:M1=MX  I $P($G(@BSR@(BST,BY(MY),BX(M1))),"@",5)="" Q
Lift I R3=68 S MR=0,M1=MX D WO^%ZAPM.ed.BSTM S MR=1 D  S MX=M1 Q
 .F  S M1=$O(BX(M1),-1) Q:M1=""  I $P($G(@BSR@(BST,BY(MY),BX(M1))),"@",5)="" Q
 .I M1="" F  S M1=$O(BX(M1),-1) Q:M1=MX  I $P($G(@BSR@(BST,BY(MY),BX(M1))),"@",5)="" Q
Down I R3=66 S MR=0,M1=MY D WO^%ZAPM.ed.BSTM S MR=1 D  S MY=M1 Q
 .F  S M1=$O(BY(M1)) Q:M1=""  I $P($G(@BSR@(BST,BY(M1),BX(MX))),"@",5)="" Q
 .I M1="" F  S M1=$O(BY(M1)) Q:M1=MY  I $P($G(@BSR@(BST,BY(M1),BX(MX))),"@",5)="" Q
Up I R3=65 S M1=MY,MR=0 D WO^%ZAPM.ed.BSTM S MR=1 D  S MY=M1 Q
 .F  S M1=$O(BY(M1),-1) Q:M1=""  I $P($G(@BSR@(BST,BY(M1),BX(MX))),"@",5)="" Q
 .I M1="" F  S M1=$O(BY(M1),-1) Q:M1=MY  I $P($G(@BSR@(BST,BY(M1),BX(MX))),"@",5)="" Q
 Q
TA K MxS,MyS,MsS S mx=MX,my=MY D  I $D(MsS) S MX=mx,MY=my K MxS,MyS,MsS,mx,my,Na Q
 .F  S MX=$O(BX(MX),Na) D:MX=""  Q:$D(MsS)  I $P($G(@(BSR_"(BST,"_BY(MY)_","_BX(MX)_")")),"@",5)="" S MyS=1 Q
 ..S MX=$O(BX(""),Na),MY=$O(BY(MY),Na) D:MY=""  Q:$D(MsS)
 ...I $D(MxS) S MsS=1 Q
 ...S MxS=1,MY=$O(BY(""),Na)
 I $D(MyS) K MxS,MyS,MsS,mx,my,Na Q
 Q
HO S MR=0,Na=1 D WO^%ZAPM.ed.BSTM,SET S MR=1 I $P($G(@BSR@(BST,BY(MY),BX(MX))),"@",5)="" Q
 G TA
EN S MR=0,Na=-1 D WO^%ZAPM.ed.BSTM,SET S MR=1 I $P($G(@BSR@(BST,BY(MY),BX(MX))),"@",5)="" Q
 G TA
SET S MX=$O(BX(""),Na),MY=$O(BY(""),Na) Q
]]></Routine>


<Routine name="%ZAPM.ed.BSF9" type="MAC" languagemode="0"><![CDATA[
%BSF9 ;ДОПОЛНИТЕЛЬНЫЕ ФУНКЦИИ ; 17:24   27.12.1999
SecyKill(G) ;СЕКРЕТНОЕ УДАЛЕНИЕ УЗЛА МАССИВА
 N GG I $D(@G)'["0" S @G=$J("",$L(@G))
 S GG=G F  S GG=$ZO(@GG) Q
 Q
SORT ;СОРТИРОВКА ПО МНОГИМ КОЛОНКАМ
 D Yes^%ZAPM.ed.BSXfun("СОРТИРОВАТЬ ДАННЫЕ ПО-ВОЗРАСТАНИЮ ?",$S(+$P(Sort,",",3):2,1:1)) S $P(Sort,",",3)='YES
 D Yes^%ZAPM.ed.BSXfun("СОРТИРОВАТЬ ДАННЫЕ ТОЛЬКО ПО ОДНОЙ ТЕКУЩЕЙ КОЛОНКЕ",$S(+$P(Sort,",",4):2,1:1)) I YES S $P(Sort,",",4)="" Q
SO S li=$TR($P(Sort,",",4),"!",","),ls="ВВЕДИТЕ ЧЕРЕЗ ЗАПЯТУЮ НОМЕРА КОЛОНОК ПО КОТОРЫМ СОРТИРОВАТЬ" D LE^%ZAPM.ed.BSTT Q:'YES  Q:'+li  S $P(Sort,",",4)=$TR(li,",","!") Q
POST ;ПОСТДВИЖЕНИЕ
 N PO,M,Pr
 S PO=$P(@BSR@(BST),"@",44),Pr=$S(PO="":4,PO=0:3,1:PO)
 S M(0,1)="Определите движение указателя после",M(0,2)="редактирования данных клетки ,для текущей таблицы"
 S M(1,1)=" ВНИЗ ",M(1,2)=" ВПРАВО ",M(1,3)=" НЕТ ",M(1,4)=" ОБЩЕСИСТЕМНОЕ "
 S M="/"_$P(%BS,"!",8),M(0)=$P(%BS,"!",8),M(1)=$P(%BS,"!",8)_"/"_$P(%BS,"!",3)
 S %B=$$TxtPanel^%ZAPM.ed.BSXfun1("M",0,0,$G(Pr,1)) I YES=0 Q
 S POSt=$S(%B=4:"",%B=3:0,1:%B),$P(@BSR@(BST),"@",44)=POSt Q
PRED ;ПРЕДОБРАБОТКА КЛАВИШ
 S li=$P(@BSR@(BST),"@",41)
 S ls="Введите программу выполняемую по DO перед стандартной отработкой" D LE^%ZAPM.ed.BSTT I 'YES Q
 I li'="" S $ZT="PREDER^%ZAPM.ed.BSF9",(R1,R2,R3)=0 D Pred^%ZAPM.ed.BSF12(li)
 D R^%ZAPM.ed.BSF4(41,li) Q
PREDER D ErrMsg^%ZAPM.ed.BSXfun("Ошибка В ссылке на программу ! "_$$ErrSay^%ZAPM.ed.BSF8($ZE)) G PRED
 ;
SelZ ;ПРЕДОБРАБОТКА КЛАВИШ (ЗАВИСИМАЯ) НУЖНА ТРАН - $$SelecBut^%ZAPM.ed.BSsFUNM(T)
 Q:R1>332
 I R1>31,R1<333,$D(Sel(0)),$D(Sel(ny,nx)) D
 .N N1,N2,N3,N4,N5,N6 S N1=ny,N2=nx,N3=MY,N4=MX
 .S MR=0,ny=$P($G(Sel(0),1),","),nx=$P($G(Sel(0),",1"),",",2),Sel(0)=(N1_","_N2)
 .S N5="" F  S N5=$O(BY(N5)) Q:N5=""  I BY(N5)=ny Q
 .S N6="" F  S N6=$O(BX(N6)) Q:N6=""  I BX(N6)=nx Q
 .I N5'=""&(N6'="") S MY=N5,MX=N6 D W^%ZAPM.ed.BSTM
 .S MR=1,ny=N1,nx=N2,MY=N3,MX=N4
 .S R1=-2
 I R1=13,R2=-1,R3=-1 S (d,d0,d1)=$G(Sel(+$P(Sel(0),","),+$P(Sel(0),",",2))),R1=-3 Q
 I R1=27,R2=-1,R3=-1 S (d0,d1,d)="",R1=-3 Q
 Q
ViewT ;СМОТРЕТЬ d1 У КЛЕТКИ
 Q:R1>332
 I R1=0,R2=18!(R2=31) D
 .S li=d1,$P(BS,"@",21)=(($L(d1)\60+1)_","_60) D BAR^%ZAPM.ed.BSF7 S R1=-2
 Q
B5 ;ВОССТАНОВЛЕНИЕ АТРИБ
 I '$D(^%ZAPM.ed.BSbufB(2,$G(%BS(3),$P),3)) D ErrMsg^%ZAPM.ed.BSXfun(" Буффер пуст !!!") Q
 S TRe1=$ZR,ls=" Ваша ТАБЛИЦА изменится до неузнаваемости ! Восстанавливаем АТРИБУТЫ КЛЕТОК ? " D YES^%ZAPM.ed.BSF I 'YES Q
 S do="D BATR^%ZAPM.ed.BSF9(i,j)" D BLOK^%ZAPM.ed.BSF1 E  Q
 S i="" F  S i=$O(@TRe1@(i)) Q:i=""  I 'i,"FTR$$r^%ZAPM.ed.BS3TR/COL/FCL/CMD/TSP/TSV/KEY"'[i D Copy^%ZAPM.ed.BSF8($NA(@TRe1@(i)),$NA(@BSR@(BST,i)))
 S BSr=BSR,BSt=BST D TRANS^%ZAPM.ed.BSS1
 G RESEND^%ZAPM.ed.BSF2
BATR(i,j) N l,h,d,c,f
 S l=$P(@$ZR,"@",4),h=$P(@$ZR,"@",3),d=$P(@$ZR,"@",15),c=$P(@$ZR,"@",10)
 Q:'$D(@TRe1@(i,j))  S @BSR@(BST,i,j)=@TRe1@(i,j),$P(@$ZR,"@",15)=d,$P(@$ZR,"@",3)=h,$P(@$ZR,"@",4)=l,$P(@$ZR,"@",10)=c
 F f="FTR","RTR","COL","FCL","CMD" I $D(@TRe1@(f,i,j)) D Copy^%ZAPM.ed.BSF8($NA(@TRe1@(f,i,j)),$NA(@BSR@(BST,f,i,j)))
 Q
PgUp S M1=$O(BY("")),s=BY(M1),t1=BSY(BS0),t=$P($G(%TIT,1),",") D  S BSY(BS0)=$S(i=t:t,1:i+1)
 .S h=0 F i=s:-1:t S h=h+$P(@(BSR_"(BST,i,1)"),"@",3) Q:h>(BSY2(BS0)-BSY1(BS0))
 Q:t1=BSY(BS0)  D VW^%ZAPM.ed.BST,KLE^%ZAPM.ed.BSTM Q
PgLt S M1=$O(BX("")),k=BX(M1),t=$P($G(%TIT,",1"),",",2),t1=BSX(BS0) D  S BSX(BS0)=$S(j=t:t,1:j+1)
 .S l=0 F j=k:-1:t S l=l+$P(@(BSR_"(BST,1,j)"),"@",4) Q:l>(BSX2(BS0)-BSX1(BS0))
 Q:t1=BSX(BS0)  D GW^%ZAPM.ed.BST,KLE^%ZAPM.ed.BSTM Q
PROTALL ;ХАРАКТЕРИСТИКИ В БЛОК
 I '$P($G(@BSR@(BST,ny,nx)),"@",12) D NEWDIR^%ZAPM.ed.BSD1 Q
 N PROTE,GLB,NAM
 S GLB=%NAM
 S PROTE=$$RP^%ZAPM.ed.BSGCH(GLB) I PROTE<1 W $$bel^%ZAPM.ed.BS3 Q
 D Yes^%ZAPM.ed.BSXfun("Всем помеченным Глобалам присвоить харрактеристики "_PROTE_" ! Вы уверены ?",2) Q:YES<1
 S do="I i>$S($E(BST)=""R"":2,1:1) S NAM=$P(^(j),""@"",15),NAM=$P(NAM,"" "",$S($E(NAM)=""^"":1,1:2)) D L^%ZAPM.ed.BS3(NAM) I LOC D CP^%ZAPM.ed.BSGCH(NAM,PROTE),U^%ZAPM.ed.BS3(NAM)" D BLOK^%ZAPM.ed.BSF1
 D NEWDIR^%ZAPM.ed.BSD1
 Q
ver(S) ;4.;i $P($ZV,"Version ",2)'<4 Q "|" ;Полная ссылка в MSM 4.0
 Q $S(S=1:"[",1:"]")
GLOBAL(R) ;ПОЛНАЯ ССЫЛКА
 N T,P    ;   ^[U,S]P,T --> ^[U,S]P(T)
 Q:$E(R,$L(R))=")" R  Q:R?.N1",".N R
 I R[$$ver(1),$P($P(R,$$ver(1),2),$$ver(2))["," S T=$P(R,",",3),P=$P(R,",",1,2) G GLOB
 I R[$$ver(1),$P($P(R,$$ver(1),2),$$ver(2))'["," S T=$P(R,",",2),P=$P(R,",",1) G GLOB
 E  S T=$P(R,",",2),P=$P(R,",")
GLOB S P=$$BSR^%ZAPM.ed.BSA(P)
 S T=$S(T=+T:T,1:$C(34)_T_$C(34)) Q (P_"("_T_")")
SYSFIX ;Перестроенные томов баз даных
 I $ZV["Cach"||($ZV["IRIS") Q
 I +Version<263,$P($ZV,"Version ",2)<4 D SysUpg
 I +Version<377 D PRN
 N A
AGAIN D  ;W !,"ВЫСТАВИТЬ ОПЦИЮ ФОРМИРОВАНИЯ ПОЛНОЙ ДАТЫ В ФОРМАТЕ (ГГГГММДД) [Y/N]" R A G:A="" AGAIN Q:"^N"[A  G:"Yy"'[A AGAIN
 .S A=$P(^%ZAPM.ed.BSETUP("SETUP",20,2),"@",15),$E(A,14)=1,$P(^%ZAPM.ed.BSETUP("SETUP",20,2),"@",15)=A
 .S A=$P(^%ZAPM.ed.BSS("SETUP",20,2),"@",15),$E(A,14)=1,$P(^%ZAPM.ed.BSS("SETUP",20,2),"@",15)=A
 ;W !,"ДЛЯ АВТОМАТИЧЕСКОЙ ПЕРЕСТРОКИ БАЗ ДАННЫХ ПОДДЕРЖИВАЮЩИХ 2000 ГОД ВЫПОЛНИТЕ",!,"КОМАНДУ >D Y2000K^%ZAPM.ed.BSF9",!
 ;D Y2000K
 Q
PRN ;Перестроенные томов PRN
 D CLr^%ZAPM.ed.BSF4,Yes^%ZAPM.ed.BSXfun("ВНИМАНИЕ ! У вас старая версия %BS ! Перенастраиваем во таблицах НОВЫЙ ФОРМАТ ОПЦИЙ ВЫВОДА  ?",1) Q:YES<1
 N i,I,II,III
 S DOX="X a1,a2",a1="I $D(@i@(iI,""PRN"")),$P(@$ZR,""#"")=3 S $P(@$ZR,""#"")=1,a3=a3+1"
 S a2="I $D(@i@(iI,""PRN"")),$P(@$ZR,""@"")=3 S $P(@$ZR,""@"")=1,a3=a3+1",a3=0
 D STA^%ZAPM.ed.BSF5 D OkMsg^%ZAPM.ed.BSXfun("ПРОИЗОШЛО "_a3_" ЗАМЕН")
 D OkMsg^%ZAPM.ed.BSXfun("Для нормальной работы смонтируйте ещё не Перестроенные тома баз дааных и введите команду >D PRN^%ZAPM.ed.BSF9") Q
SysUpg ;Перестроенные тома баз даных для работы в DDP
 D CLr^%ZAPM.ed.BSF4,Yes^%ZAPM.ed.BSXfun("ВНИМАНИЕ ! У вас старая версия %BS ! Перенастраиваем ВСЕ разделы ВСЕХ томов под работу в DDP ?",1) Q:YES<1
 N i,I,II,III
 S DOX="I i'[""^%ZAPM.ed.BS"" D PartU^%ZAPM.ed.BSF9($NA(@i@(iI)))" D STA^%ZAPM.ed.BSF5
 D OkMsg^%ZAPM.ed.BSXfun("Для нормальной работы в DDP, смонтируйте ещё не Перестроенные тома баз дааных и введите команду >D SysUpg^%ZAPM.ed.BSF9") Q
PartU(P) D Wait^%ZAPM.ed.BSXfun("Перенастраиваем:"_P)
 I $P(@P,"@",39)'="" S $P(@P,"@",39)=$$GLOBAL($P(@P,"@",39))
 S II="" F  S II=$O(@P@(II)) Q:'II  S III="" F  S III=$O(@P@(II,III)) Q:III=""  D  X WA
 .I $P(@P@(II,III),"@",14)'="" S $P(@P@(II,III),"@",14)=$$GLOBAL($P(@P@(II,III),"@",14))
 .I $P(@P@(II,III),"@",20)'="" S $P(@P@(II,III),"@",20)=$$GLOBAL($P(@P@(II,III),"@",20))
 Q
RGDOUT ;ВЫВОД ПРОГРАММ И МАССИВОВ КАЖДОГО КИПА
 D ^%SDEV I '$G(%DEV) Q
 S DOUCI="I $ZU(0)'=""MGR,MSW"" D RGDO^%ZAPM.ed.BSF9 I 0"
 D STA^%ZAPM.ed.BSF5
 Q
RGDO U %DEV D  U 0 Q
 .N  D ^%RD,^%GD
Y2000K ;Перестроение баз даных
 D CLr^%ZAPM.ed.BSF4,Yes^%ZAPM.ed.BSXfun("У ВАС ЕСТЬ ПРОБЛЕМЫ 2000 ГОДА ? Перенастраиваем ВСЕ разделы ВСЕХ томов ? (РЕКОМЕНДУЮ ПРЕДВАРИТЕЛЬНО СДЕЛАТЬ КОПИЮ)",1) Q:YES<1
 N i,I,II,III
 S DOX="I i'[""^%ZAPM.ed.BS"" D Y2TAB^%ZAPM.ed.BSTABY2($NA(@i@(iI)),iI)"
 S DOBD="D BD^%ZAPM.ed.BSTABY2($NA(@i))"
 D STA^%ZAPM.ed.BSF5 D OkMsg^%ZAPM.ed.BSXfun("Для РЕШЕНИЯ ПРОБЛЕМ 2000 ГОДА, смонтируйте ещё не Перестроенные тома баз дааных и введите команду >D Y2000K^%ZAPM.ed.BSF9")
 Q
MMAIN ;СОЗДАНИЕ ГЛАВНОГО МЕНЮ
 N li,i,I,II,M1,M2,M3,M4,M5,MMb,i,iI
 S li=$$LineEdit^%ZAPM.ed.BSXfun("??","ВВЕДИТЕ УЗЕЛ ГЛАВНОГО МЕНЮ ") Q:YES<1  Q:li=""
 S MMb=$$KBD^%ZAPM.ed.BSF12("^%ZAPM.ed.BSVOL(""MainMenu"")"),MMb=$NA(@MMb@(li))
 I $D(@MMb) D Yes^%ZAPM.ed.BSXfun("УЖЕ СУЩЕСТВУЕТ УЗЕЛ"_$ZR_" ! УДАЛЯЕМ ?") I YES=1 K @MMb
 S DOUCI="S M1=$P($ZU(0),"","",2) I 1"
 S DOX="S M2="" ""_$P($ZU(0),"","",1)_"" ""_i_"" ""_$TR($P(@i,""@"",2),$C(34),""`""),M4=""*"",M3="" ""_iI_"" ... ;""_$$TIP^%ZAPM.ed.BS($P(@i@(iI),""@"",17))_""; ""_$TR($P(@i@(iI),""@"",1),$C(34),""`""),@MMb@(M1,M2,M3,M4,""USPT"")=$$MMS^%ZAPM.ed.BSF9(i,iI),@MMb@(M1,M2,M3,M4,""NS"")=$$MMNS^%ZAPM.ed.BSF9()"
 D STA^%ZAPM.ed.BSF5
 D OkMsg^%ZAPM.ed.BSXfun("РЕЗУЛЬТАТЫ БУДУТ В ^%ZAPM.ed.BSVOL(""MainMenu"")")
 Q
MMNS() I $$ZU^%ZAPM.ed.BS3(0)=$$ZU^%ZAPM.ed.BS3(1,0) Q 0
 Q $P($$ZU^%ZAPM.ed.BS3(0),",")_","_$P($$ZU^%ZAPM.ed.BS3(0),",",2)
MMS(i,iI) I i["^%" Q $NA(@i@(iI))
 Q $NA(@("^["""_$P($$ZU^%ZAPM.ed.BS3(0),",")_""","""_$P($$ZU^%ZAPM.ed.BS3(0),",",2)_"""]"_$P(i,"^",2))@(iI))
BSrBSt(IMQ) ;ФОРМИРОВАНИЕ  BSr BSt
 I IMQ'["(" S BSr=$P(IMQ,",",1,$L(IMQ,",")-1),BSt=$P(IMQ,",",$L(IMQ,",")) Q
 I IMQ["("  S BSr=$P(IMQ,"("),BSt=$P($P(IMQ,"(",2),")") Q
 Q
XGlob(U,X,S) ;X=Действие с Узлом @g S=1 - Выводить счет узлов
 N j,jj,WA,WAI,R,r,g,Head,STOP ;Head - голова узла
 S R="]",r=2,Head=U ;4.;I $P($ZV,"Version ",2)'<4 S R="|",r=3
 I $D(@U)'["0" s g=U X X
 I $G(S) U 0 D Wait^%ZAPM.ed.BSXfun("Действие с "_U)
 S j=U I $E(U,$L(U))=")" S U=$E(U,1,$L(U)-1)
 S jj=$S(U[R:$P(U,R,r,99),1:$P(U,"^",2,99))_$S(U["(":",",1:"(")
 F  S j=$ZO(@j) Q:$S(j[R:$P(j,R,r,99),1:j)'[jj  S g=j X X Q:$D(STOP)  I $G(S) U 0 X WA
 Q
Statis(U,T,N,S) ;Статистика Узла U    S=1 - Выводить счет узлов
 ;T - цель результата  N=0 - имена массивов
 ;                     N=1 - полные ссылки узлов массивов
 N X S X="D Stati",N=+$G(N) D XGlob(U,X,+$G(S)) Q
Stati Q:@g'["^"  N S,SS,i,ii S S=@g F i=1:1 Q:$P(S,"^",i)=""  S SS=$P($P(S,"^",i),"@") D
 .I 'N D  Q
 ..S SS=$P(SS,"(")
 ..D Stat
 .D Stat
 Q
Stat S @T@(SS)=$G(@T@(SS))+1 Q
]]></Routine>


<Routine name="%ZAPM.ed.BSFF" type="MAC" languagemode="0"><![CDATA[
%BSFF ; пpогpамма ГОРЯЧИХ ФУНКЦИЙ ; 13:25   27.07.2000
 Q
TODAY() Q $$ESDAY^%ZAPM.ed.BSsFUNR(8,$$h^%ZAPM.ed.BS3)
]]></Routine>


<Routine name="%ZAPM.ed.BSFT" type="MAC" languagemode="0"><![CDATA[
%BSFT ;CТАРАЯ ТРАНСЛЯЦИЯ ФОРМУЛ ; 13:13   16.07.99
 S (li1,i0)=li,ft=1 ;li-ИСХОДНЫЙ ТЕКСТ li1-ОТТРАНСЛИРОВАННЫЙ ТЕКСТ
 I i0["$$TSP" S ft=2 G TSP ;СПИСОК
 I i0["$$TSV" S ft=3 G TSV ;СВОДКА
 S %zT=$ZT,$ZT="ERRO^%ZAPM.ed.BSFT"
 I i0["$$" D FUN ;->i0
 D AAA
 S (d3,d,d0,d1)=1,li1=$S(f="COL":"I ",1:"S d1=")_li1 X li1 S ^%ZAPM.ed.BSbufB(0,$G(%BS(3),$P),5)=li1,$ZT=$G(%zT),YES=1 Q
AAA F i=2:1 Q:i0'["{"  S i0=$P(i0,"{")_"$$A^%ZAPM.ed.BSA("_$P(i0,"{",2,9999)
 S i0=$TR(i0,"}",")"),li1=i0 Q
FUN ;ФУНКЦИИ ОБЩЕГО НАЗНАЧЕНИЯ
 S i1=i0,YES=1 F  Q:i1'["$$"  S i5=$P($P(i1,"$$",2,255),"(") D  Q:'YES
 .I '$D(@("^%ZAPM.ed.BSFUN(i5)")) S YES=1 D  Q  //S ls=" ФУНКЦИЯ "_i5_" НЕ ОПРЕДЕЛЕНА В %BS !!! ЭТО ВАША ФУНКЦИЯ ? " D YES^%ZAPM.ed.BSF D  Q
 ..I YES S i1=$P(i1,"$$")_"||"_$P(i1,"$$",2,9999) Q
 .I i5["TS" S i1=$P(i1,"$$")_"||"_$P(i1,"$$",2,9999) Q
 .S pr=$G(^%ZAPM.ed.BSFUN(i5,"9,4"))_"!"_$G(^%ZAPM.ed.BSFUN(i5,"11,4")),i2=$P($P(i1,"$$",2,9999),"(",2,9999)
 .;I ^%ZAPM.ed.BS("FUN")[i5 D F
 .I $G(^%ZAPM.ed.BSFUN(i5,"7,4"))=1 D F
 .S i2=$P($P(i1,"$$",2,9999),"(",2,9999)
 .S i1=$P(i1,"$$")_"||"_$P(pr,"!",2)_"("_$P($P(i1,"$$",2,9999),"(",2,9999) Q
 S (li1,i0)=$TR(i1,"|","$") K i1,i2,i3,i4,i5,i6,i7,ii1,ii2,ii3,ii4 Q
TSP ;СПИСКОВЫЕ ФУНКЦИИ
 G:f'="FCL" OTL I TIP=3 G TS
 I TIP>1 S ls=" ВАША ТАБЛИЦА УЖЕ НЕ МОЖЕТ БЫТЬ СПИСКОМ " G OTLUP
 I TIP<2 S ls=" Вы хотите что-бы ваша таблица:"_BSR_","_BST_" стала списком ? Вы уверены " D YES^%ZAPM.ed.BSF I 'YES S ls=" ОТМЕНА " G OTLUP
 S $P(@(BSR_"(BST)"),"@",17)=3,TIP=3 G TS
TSV ;СВОДКОВЫЕ ФУНКЦИИ
 G:f'="FCL" OTL I TIP=4 G TS
 I TIP>1 S ls=" ВАША ТАБЛИЦА УЖЕ НЕ МОЖЕТ БЫТЬ СВОДКОЙ " G OTLUP
 I TIP<2 S ls=" Вы хотите что-бы ваша таблица стала сводкой ? Вы уверены ? " D YES^%ZAPM.ed.BSF I 'YES S ls=" ОТМЕНА " G OTLUP
 S $P(@(BSR_"(BST)"),"@",17)=4,TIP=4
TS S i1=i0,YES=1,i6=$P(i1,"$$",2,255),i5=$P(i6,"(") I '$D(@("^%ZAPM.ed.BSFUN(i5)")) S ls=" ФУНКЦИЯ "_i5_" НЕ ОПРЕДЕЛЕНА !!!" D O^%ZAPM.ed.BSF7 S YES=0 Q
 S:i6["$$TS" i6=$P($P(i6,"$$TS"),")",1,$L($P(i6,"$$TS"),")")-1)_")" S %zT=$ZT,$ZT="ERRO^%ZAPM.ed.BSFT",li1="S YES=$$"_i5_"^%ZAPM.ed.BSsFUNR("_$P(i6,"(",2,999) I li1[",," F  Q:li1'[",,"  S li1=$P(li1,",,")_$C(44,34,44)_$P(li1,",,",2,999)
 X li1 S $ZT=$G(%zT),li1=i0 Q
ERRO I $ZE["<MXSTR" S ls=" ДЛИНА СТРОКИ ПОСЛЕ ТРАНСЛЯЦИИ БОЛЬШЕ ДОПУСТИМОЙ " G ERR
 I $ZE["PARM>"!($ZE["<FUN") S ls=" ОШИБКА В ПАРАМЕТРАХ ФУНКЦИИ ИЛИ НЕВЕРНЫЙ АДРЕС КЛЕТКИ " ;G ERR
 S ls=" ОШИБКА "_$E($ZE,1,21) D O^%ZAPM.ed.BSF7 S ls=$G(li1,"???")
ERR D O^%ZAPM.ed.BSF7 S YES=0,li1="" Q
OTL S ls=" ФОРМУЛЫ $$TS* РАЗРЕШЕНЫ ТОЛЬКО В ФОРМУЛАХ ВЫЧИСЛЕНИЯ ! "
OTLUP D O^%ZAPM.ed.BSF7 S (ft,li,li1)="" Q
F ;ЗАМЕНА "{}" НА "Її" ДЛЯ ФУНКЦИИЙ ТИПА SUM,MAX,MIN,PLU...
 S i4=1 F i3=1:1:$L(i2) Q:$E(i2,i3)=""  S:$E(i2,i3)="(" i4=i4+1 S:$E(i2,i3)=")" i4=i4-1 Q:$E(i2,i3)=")"&(i4=0)
 S p0="FU("_$E(i2,1,i3) D @p0 I $D(p44) S i3=i3-$L(p44)-1-$L(p44,$C(34))
 S i1=$P(i1,"$$")_"$$"_$P($P(i1,"$$",2),"(")_"("_$TR($E(i2,1,i3),"{}","")_$E(i2,i3+1,9999) Q
FU(p1,p2,p3,p4) I $D(p4) S p44=p4
e Q
]]></Routine>


<Routine name="%ZAPM.ed.BSFTF" type="MAC" languagemode="0"><![CDATA[
%BSFTF ;БЫСТРАЯ ТРАНСЛЯЦИЯ ФОРМУЛ ; 15:24  4-DEC-97
 ;li-ИСХОДНЫЙ ТЕКСТ
 ;li1-ОТТРАНСЛИРОВАННЫЙ ТЕКСТ
 ;f-тип ФУНКЦИИ f="FCL"-Calc ;f="FTR"-Tran ;f="COL"-Logs ;f="RTR" Read
 ;ft - ПАРАМЕТР ИСПОЛНЯЕМОСТИ ФУНКЦИИ =1 ДА   ВСЁ ОСТАЛЬНОЕ - НЕТ
 N i0,i,d3,d,d0,d1,l
 S (li1,i0)=li,ft=1
 I i0["$$FCl" S ft=4 D TST(9,"БЫСТРЫМ СПИСКОМ") Q  ;БЫСТРЫЙ НАСЧЕТ
 I i0["$$FCs" S ft=5 D TST(10,"БЫСТРОЙ СВОДКОЙ") Q  ;БЫСТРЫЙ НАСЧЕТ
 I i0["$$TSP" S ft=2 G TSP^%ZAPM.ed.BSFT ;D TST(3,"СПИСКОМ") Q
 I i0["$$TSV" S ft=3 G TSV^%ZAPM.ed.BSFT ;D TST(4,"СВОДКОЙ") Q
 S %zT=$ZT,$ZT="ERRO^%ZAPM.ed.BSFTF"
 S YES=0,li1=$$FunTrans(i0,f)
 S (d3,d,d0,d1)=1 X li1 S ^%ZAPM.ed.BSbufB(0,$G(%BS(3),$P),5)=li1,$ZT=$G(%zT),YES=1 Q
FunTrans(li,f) N i
 I li["$$" S i="" F  S i=$O(^%ZAPM.ed.BSFUN(i)) Q:i=""  I $D(^%ZAPM.ed.BSFUN(i,"11,4")) S l="$$"_i_"(",li=$$TR^%ZAPM.ed.BSsFUNM(li,l,"$$"_@$ZR_"(")
 I li["{" D
 .S li=$$TR^%ZAPM.ed.BSsFUNM(li,"{{","$$A^%ZAPM.ed.BSA("),li=$$TR^%ZAPM.ed.BSsFUNM(li,"}}",")")
 .S li=$$TR^%ZAPM.ed.BSsFUNM(li,$C(34)_"{",$C(0,1)),li=$$TR^%ZAPM.ed.BSsFUNM(li,"}"_$C(34),$C(2,3))
 .S li=$$TR^%ZAPM.ed.BSsFUNM(li,"{","$$A^%ZAPM.ed.BSA("),li=$$TR^%ZAPM.ed.BSsFUNM(li,"}",")")
 .S li=$$TR^%ZAPM.ed.BSsFUNM(li,$C(0,1),$C(34)_"{"),li=$$TR^%ZAPM.ed.BSsFUNM(li,$C(2,3),"}"_$C(34))
 Q $S(f="COL":"I "_li,1:"S d1="_li)
TST(TI,S) G:f'="FCL" OTL I TIP=TI G TS
 I TIP>1 S ls=" ВАША ТАБЛИЦА УЖЕ НЕ МОЖЕТ БЫТЬ "_S G OTLUP
 I TIP<2 S ls=" Вы хотите что-бы ваша таблица стала "_S_" ? Вы уверены ? " D YES^%ZAPM.ed.BSF I 'YES S ls=" ОТМЕНА " G OTLUP
 S TIP=TI
TS S $P(@BSR@(BST),"@",17)=TIP
 S %zT=$ZT,$ZT="ERRO^%ZAPM.ed.BSFTF",li1=li I li1["$$" S i="" F  S i=$O(^%ZAPM.ed.BSFUN(i)) Q:i=""  I $D(^%ZAPM.ed.BSFUN(i,"11,4")) S l="$$"_i_"(",li1=$$TR^%ZAPM.ed.BSsFUNM(li1,l,"$$"_@$ZR_"(")
 S li1="S YES="_li1
 X li1 S $ZT=$G(%zT),li1=li Q
ERRO S ls="" I $ZE["<MXSTR" S ls=" ДЛИНА СТРОКИ ПОСЛЕ ТРАНСЛЯЦИИ БОЛЬШЕ ДОПУСТИМОЙ "
 I $ZE["PARM>"!($ZE["<FUN") S ls=" ОШИБКА В ПАРАМЕТРАХ ФУНКЦИИ ИЛИ НЕВЕРНЫЙ АДРЕС КЛЕТКИ "
 I $ZE["LINER>" S ls=" ОШИБКА В ИМЕНИ ФУНКЦИИ "
 S ls=ls_$ZE_" "_$$ErrSay^%ZAPM.ed.BSF8($ZE) D O^%ZAPM.ed.BSF7 S ls=$G(li1,"???")
ERR D O^%ZAPM.ed.BSF7 S YES=0,li1="" Q
OTL S ls="СПИСКОВЫЕ И СВОДКОВЫЕ ФУНКЦИИ РАЗРЕШЕНЫ ТОЛЬКО В ФОРМУЛАХ ВЫЧИСЛЕНИЯ !"
OTLUP D O^%ZAPM.ed.BSF7 S (ft,li,li1)="" Q
 Q
]]></Routine>


<Routine name="%ZAPM.ed.BSGLOB" type="MAC" languagemode="0"><![CDATA[
%BSGLOB ;РАБОТА С ГЛОБАЛЬНЫМ СПИСКОМ ОБ"ЕКТОВ ; 16:53   12.12.1999
 I '$D(^%ZAPM.ed.BSbufB("ALINS"_$G(%BS(3),$P)_$J_"u")) S ls=" НЕТ СПИСКА МИКРОЗАПРОСОВ !  ДЛЯ ВКЛЮЧЕНИЯ В СПИСОК ВВЕДИТЕ <ALT-Insert> В ТАБЛИЦЕ ОПИСЫВАЮЩЕЙ МИКРОЗАПРОСЫ" D O^%ZAPM.ed.BSF7 Q
 S g1=BSR,g2=BST,g3=se,g4=ke,BST="ALINS"_$G(%BS(3),$P)_$J_"u",BSR="^%ZAPM.ed.BSbufB" D DEND^%ZAPM.ed.BSF2,REND^%ZAPM.ed.BSF2,TAB^%ZAPM.ed.BSF1 S IYI=BSR_","_BST,BSR=g1,BST=g2,se=g3,ke=g4 D NE^%ZAPM.ed.BSN
 D Yes^%ZAPM.ed.BSXfun("Удаляем ВРЕМЕННУЮ ТАБЛИЦУ ?") Q:YES<1  D DEL^%ZAPM.ed.BSF10($NA(^%ZAPM.ed.BSbufB("ALINS"_$G(%BS(3),$P)_$J_"u")),1)
 Q
I(g1,g2,g3,g4,g5) N Gl,F1,F2 ;ПОМЕТКА <ALT-INSERT>
 N F1,F2,j,ii,i
 I g2=("ALINS"_$G(%BS(3),$P)_$J_"u") W /BEL Q
 I BSR["%BSbufB",$E(BST,1,2)="TZ" D PACKETZ(BSrz,BStz,$P(d," ",2)) Q
 I BSR["%BSbufB",$E(BST,1,2)="1k",$D(BSD),$P($P(BSD,"(",2),",",2)["ZPr" D PACKETZ($P(BSD,"("),$TR($P($P(BSD,"(",2),","),$C(34),""),d) Q
 I nx=2 S F2=g5,F1=$P($G(@BSR@(BST,ny,1)),"@",15)
 I nx=1 S F1=g5,F2=$P($G(@BSR@(BST,ny,2)),"@",15)
 I F2'["k" W /BEL G ESC
 I '$D(^%ZAPM.ed.BSbufB("ALINS"_$G(%BS(3),$P)_$J_"u")) S ii=$ZR,@ii=^%ZAPM.ed.BSS("ALINS"),i=2 D  G II
 .F j=1:1 Q:'$D(^%ZAPM.ed.BSS("ALINS",1,j))  S ^%ZAPM.ed.BSbufB("ALINS"_$G(%BS(3),$P)_$J_"u",1,j)=^%ZAPM.ed.BSS("ALINS",1,j) I "34"[j S $P(@$ZR,"@",4)=""
 S ii=$ZR,i=$P(@ii,"@",28)+1
II F j=1:1 Q:'$D(^%ZAPM.ed.BSS("ALINS",2,j))  S ^%ZAPM.ed.BSbufB("ALINS"_$G(%BS(3),$P)_$J_"u",i,j)=^%ZAPM.ed.BSS("ALINS",2,j),$P(@$ZR,"@",15)=$G(@("F"_j))
 S $P(@ii,"@",28)=i Q
ESC S R1=27,R2=-1,R3=-1 Q
PACKETZ(Pr,Tb,Zp) ;ДОБАВИТЬ ЗАПРОС В ПАКЕТ
 N PA,NZ
 D SA^%ZAPM.ed.BSsBUF
 S PA=$$UZEL^%ZAPM.ed.BSVOL("PACKET","^%ZAPM.ed.BSVOL","",""," В КАКОЙ ПАКЕТ ВСТАВЛЯТЬ ЗАПРОС "_Zp_". НОВЫЙ МОЖНО ВВЕСТИ")
 D RE^%ZAPM.ed.BSsBUF Q:PA=""  S NZ=$O(@PA@(""),-1),NZ=NZ+1
 S @PA@(NZ,"N")=Zp,@PA@(NZ,"PT")=$NA(@Pr@(Tb)),@PA@(NZ,"K")=$G(@Pr@(Tb,"ZPr",Zp,"^","K"))
 S @PA@(NZ,"ST")=1 ;СТАТУС
 ;S @PA@(NZ,"BP")=1 ;СТАТУС
 G ESC
Ksp ;ВЫБОРОЧНОЕ
 ;I '$D(Ksp) S li="",ls="ВВЕДИТЕ ДВЕ ЦИФРЫ КСП ,ЗА КОТОРОЕ ИНФОРМАЦИЮ ОСТАВИТЬ" D LE^%ZAPM.ed.BSTT S:YES Ksp=li I 'YES S END=1 Q
 ;S Ksp1=$E($P($P(g,",",2),")"),1,2)
 ;I Ksp1'="",Ksp1'=Ksp,Ksp1=+Ksp1 K @g
 W /BEL
 Q
KBD ;УБИЙЦА БАЗ ДАННЫХ
 N i,I,II,III,BD,DOPART,DOBD,VOL,k,k1,k2,k3,k4,k5,key,st,f1
 D CLr^%ZAPM.ed.BSF4 D VOl Q:'$D(VOl)
 D Yes^%ZAPM.ed.BSXfun("ОСТАВИТЬ ИНФОРМАЦИЮ ПО КАКОМУ-ТО КЛЮЧУ, УВЕРЕНЫ ?",1) I YES>0 S st=0 D  I st=1 Q
 .S ls="Давайте номер ключа для выборочного сохранения",li=1 D LE^%ZAPM.ed.BSS I li<1!(li>9) S st=1 Q
 .S key=li,ls="Вводите ФОРМУЛУ для IF (Значение ключа в key),(например:$E(k2,1,2)=21)",li="" D LE^%ZAPM.ed.BSS I li'["k" S st=1 Q
 .S f1=li Q
 Q:$G(st)=1  D Yes^%ZAPM.ed.BSXfun("ВНИМАНИЕ ! Сейчас начнётся ТОТАЛЬНОЕ УДАЛЕНИЕ БАЗ ДАННЫХ в "_VOl_" ! УВЕРЕНЫ ?",1) Q:YES<1
 S DOBD=DOPART_" I i'[""^%ZAPM.ed.BS""&(i'[""^BS"") D KILLBD^%ZAPM.ed.BSGLOB(i)" K DOPART D STA^%ZAPM.ed.BSF5
 D OkMsg^%ZAPM.ed.BSXfun("УБИТЫ ВСЕ...") Q
KILLBD(BD) I '$D(st),$D(@BD)=11 K @BD Q
 S BD1=BD F  S BD1=$ZO(@BD1) Q:BD1=""  S @("k"_key)=$QS(BD1,key) D
 .Q:@("k"_key)=""  X "I "_f1 E  K @BD1
 Q
VOl ;ВЫБОР ТОМА
 K VOl S li="",ls="УКАЖИТЕ ТРАНСЛИРУЕМЫЙ ТОМ или КИП,ТОМ" D LE^%ZAPM.ed.BSTT Q:'YES  Q:li=""  S VOl=li
 I $L(VOl)=3 S DOPART="I $P($$ZU^%ZAPM.ed.BS3(0),"","",2)=VOl" G VO
 I $L(VOl)=7 S DOPART="I $$ZU^%ZAPM.ed.BS3(0)=VOl" G VO
 E  W /BEL K VOl,DOPART
VO Q
TranGlob ;ГЛОБАЛЬНАЯ ТРАНСЛЯЦИЯ
 N SS,SZ,VOl,TRA,i,DOPART
 D VOl Q:'$D(VOl)
 S li="",ls="УКАЖИТЕ ССЫЛКУ - КИП,ТОМ   КОТОРУЮ ТРАНСЛИРОВАТЬ !!!" D LE^%ZAPM.ed.BSTT Q:'YES  S SS=li
 S li="",ls="УКАЖИТЕ ССЫЛКУ - КИП,ТОМ  НА КАКУЮ ЗАМЕЩАТЬ !!!" D LE^%ZAPM.ed.BSTT Q:'YES  S SZ=li
 S DOPART=DOPART_",i'[""^%ZAPM.ed.BS"",i'[""^BS"" D Tran^%ZAPM.ed.BSGLOB(i)"
 S TRA(0)="",TRA(0,1)=$P(SS,","),TRA(0,2)=$P(SS,",",2),i=0
 D SETT^%ZAPM.ed.BSZRAP,SETTRA^%ZAPM.ed.BSZRAP(SZ)
 D Yes^%ZAPM.ed.BSXfun("ВНИМАНИЕ ! Сейчас начнётся Трансляция массивов "_VOl_" ! УВЕРЕНЫ ?",1) Q:YES<1
 D STA^%ZAPM.ed.BSF5
 D OkMsg^%ZAPM.ed.BSXfun("...ВСЁ...") Q
Tran(II) N ii
 I $D(@II)'["0" D TRA^%ZAPM.ed.BSZRAP(II)
 F ii=1:1 S II=$ZO(@II) Q:II=""  D TRA^%ZAPM.ed.BSZRAP(II) I '(ii#50) U 0 X WA
 Q
Diag ;ДИАГНОСТИКА ТОМА
 N ii,i,DOPART,VOl,BSr,BSt,II,III,iii,IIII,TI
 D VOl Q:'$D(VOl)
 D Yes^%ZAPM.ed.BSXfun("ВНИМАНИЕ ! Сейчас начнётся ДИАГНОСТИКА разделов на ссылки "_VOl_" ! УВЕРЕНЫ ?",1) Q:YES<1
 S DOPART=DOPART_" D Dia^%ZAPM.ed.BSGLOB(i)",BSt="DiagPart"_$G(%BS(3),$P),BSr="^%ZAPM.ed.BSbufB"
 D MGR^%ZAPM.ed.BS,DiaK,STA^%ZAPM.ed.BSF5,Diagn
 I '$D(se) D OkMsg^%ZAPM.ed.BSXfun("ССЫЛКИ ОТСУТСТВУЮТ...") Q
 S Coment="Диагностика "_VOl D CREATE^%ZAPM.ed.BSTT
DiaK K ^%ZAPM.ed.BSbufB("DiagPart"),^%ZAPM.ed.BSbufB("DiagPart"_$G(%BS(3),$P)) Q
Dia(II) S TI=99 F ii=1:1 S II=$ZO(@II) Q:II=""  S:$L(II,",")=1 TI=$P($G(@II),"@",17) D:@II["]"&("56"'[TI)  I '(ii#50) U 0 X WA
 .S III=@II F iii=1:1 Q:$P(III,"]",iii)'["["  D
 ..S IIII=$TR($P($P(III,"]",iii),"[",2),",""",".") S IIII=$S(IIII="":"?="_II,1:IIII)
 ..S ^%ZAPM.ed.BSbufB("DiagPart",$TR($$ZU^%ZAPM.ed.BS3(0),",","."),$P(II,"("),IIII)=$G(^%ZAPM.ed.BSbufB("DiagPart",$TR($$ZU^%ZAPM.ed.BS3(0),",","."),$P(II,"("),IIII))+1
 Q
Diagn S II="^%ZAPM.ed.BSbufB(""DiagPart"")" F ii=1:1 S II=$ZO(@II) Q:II'["^%ZAPM.ed.BSbufB(""DiagPart"""  D  I '(ii#50) U 0 X WA
 .S t0=" в Томе "_$TR($P(II,",",2),".",",")_" Разделе "_$P(II,",",3)_" ссылка "_$TR($P($P(II,",",4),")"),".",",")_" встречается "_@II_" раз" D CR^%ZAPM.ed.BSTT
 Q
TipMass(i) 
 I $P($G(@i),"@")="BSD - MSW" Q 3 ;БАЗЫ
 I $P($G(@i),"@")["%BS-invert-" Q 2
 I $P($G(@i),"@")="BaSe MsW " Q 1 ;РАЗДЕЛЫ %BS
 Q 0
]]></Routine>


<Routine name="%ZAPM.ed.BSH" type="MAC" languagemode="0"><![CDATA[
%BSH ;РЕКОНФИГУРАЦИЯ MSM и :%BS,РАБОТА с HFS ; 16:17   01.04.2001
 Q
CONF I $ZV["Wind"!($ZV["Cach"||($ZV["IRIS")) Q
 D MGR^%ZAPM.ed.BS ;I $P($ZV,"Version ",2)<4,'$D(^ ("SGDDBNS")) W !!," В системе нет оптционального пакета NAMESPACE ! ",*7 S STOPBS=1 Q
 N MODIF X "ZL %GR S:$T(ASK+4)'[""Overw"" MODIF=1 ZL %BSH" I $G(MODIF) D
 .W !!!,"Модификация системмных и библиотечных утилит "
 .I $P($ZV,"Version ",2)<4 D  ;ДЛЯ 3
 ..S DB="ZL DBMAINT3 X:$T(HNAME)=""HNAME ;"" DB1 ZL %BSH",DB1="W $ZN,"" "" ZI ^%ZAPM.ed.BS(""HNAME""):HNAME ZR HNAME ZS DBMAINT3" X DB
 ..S DB="ZL %SP X:$T(INT)'[""%SPDBNA"" DB1 ZL %BSH",DB1="W $ZN,"" "" ZI ^%ZAPM.ed.BS(""INT^%SP""):INT ZR INT ZS %SP" X DB
 ..S DB="ZL DBMAINT3 X:$T(ADDV)="""" DB1 ZL %BSH",DB1="W $ZN,"" "" ZI ^%ZAPM.ed.BS(""HADDV""):VGSLOT ZS DBMAINT3" X DB
 ..S DB="ZL %GSEL X:$T(GS1)'[""%BS"" DB1 ZL %BSH",DB1="W $ZN,"" "" ZI ^%ZAPM.ed.BS(""%GSEL""):GS1 ZR GS1 ZS %GSEL" X DB
 .I $P($ZV,"Version ",2)'<4 D  ;ДЛЯ 4
 ..S DB="ZL DBMAINT8 X:$T(HNAME)=""HNAME ;"" DB1 ZL %BSH",DB1="W $ZN,"" "" ZI ^%ZAPM.ed.BS(""HNAME""):HNAME ZR HNAME ZS DBMAINT8" X DB
 ..S DB="ZL %SP X:$T(INT)'[""VOLDBNA"" DB1 ZL %BSH",DB1="W $ZN,"" "" ZI ^%ZAPM.ed.BS(""INT^%SPmsm4""):INT ZR INT ZS %SP" X DB
 ..S DB="ZL %GSEL X:$T(GS1+2)'[""%BS"" DB1 ZL %BSH",DB1="W $ZN,"" "" ZI ^%ZAPM.ed.BS(""%GSEL4""):GS1+2 ZR GS1+2 ZS %GSEL" X DB
 ..S DB="ZL MOUNTRVG X:$T(RCIR+1)'[""?"" DB1 ZL %BSH",DB1="W $ZN,"" "" ZI ^%ZAPM.ed.BS(""RVG8""):RCIR+1 ZR RCIR+1 ZS MOUNTRVG" X DB
 ..S DB="ZL MOUNTRVG X:$T(RVGN+1)'[""%BSvgT"" DB1 ZL %BSH",DB1="W $ZN,"" "" ZI ^%ZAPM.ed.BS(""RVG18""):RVGN+1 ZR RVGN+1 ZS MOUNTRVG" X DB
 .S DB="ZL %RSEL X:$T(L0+1)'[""%BS"" DB1 ZL %BSH",DB1="W $ZN,"" "" ZI ^%ZAPM.ed.BS(""%RSEL""):L0+1 ZR L0+1 ZS %RSEL" X DB
 .S DB="ZL %SDEV X:$T(HFS1+1)'[""FILE^%ZAPM.ed.BSDOS2"" DB1 ZL %BSH",DB1="W $ZN,"" "" ZI ^%ZAPM.ed.BS(""HFILE""):HFS1+1 ZR HFS1+1 ZS %SDEV" X DB
 .S DB="ZL SGDDB X:$T(PROMPT)["";"" DB1 ZL %BSH",DB1="W $ZN,"" "" ZI ^%ZAPM.ed.BS(""SGDDB""):PROMPT ZR PROMPT ZS SGDDB" X DB
 .S DB="ZL %RR X:$T(R0+2)'[""already exist"" DB1 ZL %BSH",DB1="W $ZN,"" "" ZI ^%ZAPM.ed.BS(""%RR""):R0+2 ZR R0+2 ZS %RR" X DB
 .S DB="ZL %GR X:$T(ASK+4)'[""already exist"" DB1 ZL %BSH",DB1="W $ZN,"" "" ZI ^%ZAPM.ed.BS(""%GR""):ASK+4 ZR ASK+4 ZS %GR" X DB
 .W !,"Для продолжения нажмите любую клавишу" R *R1
 K ^%ZAPM.ed.BS("LPT"),^("NS"),^("COM") S C=$P(^SYS("CONFIG"),";"),C=$P(^SYS("CONFIG",C),";") D NAS F I=1:1:90 I $D(^SYS(C,"DDB",I)) D
 .I $P(@$ZR,",",2)?1"LPT"1N S ^%ZAPM.ed.BS("LPT",I)=$P(@$ZR,",",5) Q
 .I $P(^SYS(C,"DDB",I),",",12) S ^%ZAPM.ed.BS("NS",I)=$G(NS($P(@$ZR,",",12)))
 .I $P(^SYS(C,"DDB",I),",",2)["COM" S ^%ZAPM.ed.BS("COM",$E($P(^SYS(C,"DDB",I),",",2),4))=I_","_+$E($P(^SYS(C,"DDB",I),",",3),2,3)
 I $G(^%ZAPM.ed.BSbufB("CLR","FTR",1,1))["/YX" K ^%ZAPM.ed.BSbufB("CLR") S BSr1="^%ZAPM.ed.BSS",BSr2="^%ZAPM.ed.BSbufB",(BSt1,BSt2)="CLR" D COPY^%ZAPM.ed.BSTK S ^%ZAPM.ed.BSbufB="БУФЕР"
 D BUFERS
 ;I $ZV["3.0.1",$G(%BS(23)),$D(^ ("DDPSRV")) X "ZL DDPSRV I $T(ZUSE)[""%BSddp""" E  S I=$ZT,$ZT="DDPJOB^%ZAPM.ed.BSH" D  S $ZT=I
 .;I $P($ZV,"Version ",2)="3.0.10",$D(^ ("DDPSRV10")) X "ZL DDPSRV10 ZS DDPSRV"
 .;I $P($ZV,"Version ",2)="3.0.12",$D(^ ("DDPSRV12")) X "ZL DDPSRV12 ZS DDPSRV"
NS I $ZV["Wind"!($ZV["Cach"||($ZV["IRIS")) S %BS(13)="%BS-PC" U $I::%BS(32) D  Q
 .I $ZV["Cach"||($ZV["IRIS") D %BS3^%ZAPM.ed.BSCp
 ;I $P($ZV,"Version ",2)<4,'$D(^ ("SGDDBNS")) W !!," В системе нет оптционального пакета NAMESPACE ! ",*7 H
 N BDTRM S %BS(3)=$I,BDTRM=$$KBD^%ZAPM.ed.BSF12("^%ZAPM.ed.BSVOL(""TRM"")") I $$Data^%ZAPM.ed.BSF12($NA(@BDTRM@($I))) D  Q
 .U $I::$G(%BS(32),"X3.64-1979")
 .S %BS(13)=$G(@BDTRM@($I,"NSP")),%BS(14)=$G(@BDTRM@($I,"FLG"))
 .S %BS(14,1)=$G(^("OpenLPT")),%BS(14,2)=$G(^("CloseLPT"))
 .S %BS(3)=$G(^("Principal"),$I)
 I $I'=1 W !,"Комплекс не настроен для устройства "_$P R *R H
 S %BS(13)="%BS-PC" U $I::$G(%BS(32),"X3.64-1979")
 Q
 I %BS(3)'=+%BS(3) S %BS(3)=$J
 Q
BUFERS I $ZV["Wind"!($ZV["Cach"||($ZV["IRIS")) Q
 I $E($$RP^%ZAPM.ed.BSGCH("^%ZAPM.ed.BSbufB"),2,3)'="44" S ^%ZAPM.ed.BSbufB="Буфер %BS" D CP^%ZAPM.ed.BSGCH("^%ZAPM.ed.BSbufB","0440")
 I $E($$RP^%ZAPM.ed.BSGCH("^%ZAPM.ed.BSbufP"),2,3)'="44" S ^%ZAPM.ed.BSbufP="BaSe MsW @БУФЕРА ПРИНТ-СЕРВЕРОВ" D CP^%ZAPM.ed.BSGCH("^%ZAPM.ed.BSbufP","0440")
 I $E($$RP^%ZAPM.ed.BSGCH("^%ZAPM.ed.BSETUP"),2,3)'="44" D CP^%ZAPM.ed.BSGCH("^%ZAPM.ed.BSETUP","0440")
 I $E($$RP^%ZAPM.ed.BSGCH("^%ZAPM.ed.BSHLP"),2,3)'="44" D CP^%ZAPM.ed.BSGCH("^%ZAPM.ed.BSHLP","0440")
 I $E($$RP^%ZAPM.ed.BSGCH("^%ZAPM.ed.BS"),2,3)'="44" D CP^%ZAPM.ed.BSGCH("^%ZAPM.ed.BS","0440")
 I $E($$RP^%ZAPM.ed.BSGCH("^%ZAPM.ed.BSdel"),2,3)'="44" D CP^%ZAPM.ed.BSGCH("^%ZAPM.ed.BS","0440")
 I $E($$RP^%ZAPM.ed.BSGCH("^%ZAPM.ed.BSJPRN"),2,3)'="44" D CP^%ZAPM.ed.BSGCH("^%ZAPM.ed.BSJPRN","0440")
 I $E($$RP^%ZAPM.ed.BSGCH($G(%BS(20),"^%ZAPM.ed.BSDFLT")),2,3)'="44" D CP^%ZAPM.ed.BSGCH($G(%BS(20),"^%ZAPM.ed.BSDFLT"),"0440")
 I $E($$RP^%ZAPM.ed.BSGCH("^%ZAPM.ed.BSbufS"),2,3)'="44" S ^%ZAPM.ed.BSbufS="BaSe MsW @РАЗДЕЛ НАСЧИТАННЫХ СВОДОК И СПИСКОВ" D CP^%ZAPM.ed.BSGCH("^%ZAPM.ed.BSbufS","0440")
 I $E($$RP^%ZAPM.ed.BSGCH("^%ZAPM.ed.BSDDR"),2,3)'="44" S $P(^%ZAPM.ed.BSDDR,"@",5)="" D CP^%ZAPM.ed.BSGCH("^%ZAPM.ed.BSDDR","0440")
 Q
NAS S I="" F  S I=$O(^SYS("namespace",I)) Q:I=""  I $E(I,1,4)="%BS-" S NS(I)=""
e Q
NASL D NAS S I="" F  S I=$O(NS(I)) Q:I=""  W !,I
 W !,"КАКУЮ NAMESPASE ПРИКРЕПИТЬ К УСТРОЙСТВУ #",$P R "  <%BS-PC>  :",I S:I="" I="%BS-PC" Q:"^."[I  I '$D(NS(I)) G NASL
 S ^%ZAPM.ed.BS("NS",$G(%BS(3),$P))=I Q
VOLNEW ;ПЕРЕАДРЕСАЦИЯ ПУТИ К ТОМУ
 S (HNAME,VOLNA(I))=%BShNAME(2)_"\"_$P(HNAME,"\",$L(HNAME,"\")) D CHKNAME^DBMAINT3 Q
VOL(vol,%VGI) S YES=1 ;ПРОВЕРКА ТОМА
 I $D(^%ZAPM.ed.BSbufB("VOLu"_$G(%BS(3),$P),vol)),$G(%BS(4))[$P(@$ZR,"/") D CHE(@$ZR) I 'YES G END
 I '$D(^%ZAPM.ed.BSbufB("VOLu"_$G(%BS(3),$P),vol)) ZF  D INT^%SP S ^%ZAPM.ed.BSbufB("VOLu"_$G(%BS(3),$P),vol)=$S($$ver^%ZAPM.ed.BSF7()="]":%SPDBNA,1:VOLDBNA),YES=1 G END
 Q
UCI(vol,%VGI) S YES=1 I $D(^%ZAPM.ed.BSbufB("VOLu"_$G(%BS(3),$P),vol)),$G(%BS(4))[$P(@$ZR,"/") S %FN=@$ZR D CHE(%FN) G:'YES END S %BS(9)=%FN
 Q
CHKSUM(%R) ;ВЫЧИСЛЕНИЕ КОНТРОЛЬНОЙ СУММЫ У ПРОГРАММЫ
 I $ZV["Wind"!($ZV["Cach"||($ZV["IRIS")) Q -1
 ;I '$ZBN(^ (%R)) Q -1
 N %T,%J,%K
 S %T=0 X "ZL @%R F %J=1:1 S %K=$T(+%J) Q:%K=""""  S %T=%T+$ZCRC(%K,1)"
 Q %T
CHECK ;ПРОВЕРКА HFS
 I $ZV["Wind"!($ZV["Cach"||($ZV["IRIS")) Q
 S YES=1 Q:'$D(@(BSR_"(BST,""HVL"")"))  S MR="" F  S MR=$O(@(BSR_"(BST,""HVL"",MR)")) Q:MR=""  S %FN=@(BSR_"(BST,""HVL"",MR)") I %FN'="" S vv=0 D CHE(%FN) Q:'YES
 I $D(%FN) S %BS(9)=%FN
END K %FN,%DEV Q
CHE(%FN) ;
CH S YES=$$CHECKHFS(%FN) I YES Q
 S ls=" ОШИБКА ЧТЕНИЯ БАЗЫ ДАННЫХ "_%FN_" !!!.ПОВТОРИТЬ ? " W $$bel^%ZAPM.ed.BS3 D YES^%ZAPM.ed.BSF I 'YES S ls=" ОШИБКА ДОСТУПА К "_%FN_" !!! " Q
 G CH
CHECKHFS(%FN) G E:%FN="" F %DEV=51:1:54 O %DEV::0 Q:$T
 G:'$T E O %DEV:%FN U %DEV I $ZA=-1 G E
U O %DEV:(%FN:"R") U %DEV I $ZA<0 G E
 C %DEV U $P Q 1
E C %DEV U $P Q 0
DDPJOB I $ZE["LOBR>" W !,"   Остановите Сервер DDP и выполните D CONF^%ZAPM.ed.BSH",$$bel^%ZAPM.ed.BS3 H 2 Q
 Q
TABVAR I $$VAR(1) D ErrMsg^%ZAPM.ed.BSXfun("НЕ ОПРЕДЕЛЕНЫ")
 Q
VAR(A) ;ПРОЛЬЗОВАТЕЛЬСКИЕ ПЕРЕМЕННЫЕ
 N DI,BSR,BST,VA,D,ER,BX,WA
 S DI=$P($G(^%ZAPM.ed.BSETUP("SERVER",12,4)),"@",15) Q:DI="" 4 I '$$Data^%ZAPM.ed.BSF12(DI) S DI=$NA(@%BS(20)@("Variables")) I '$D(@DI) Q 3
 S BSR=$P(DI,"("),BST=$TR($P($P(DI,"(",2),")"),$C(34),"") I $G(A) D ^%ZAPM.ed.BST Q ""
 D CALC^%ZAPM.ed.BSF3,U^%ZAPM.ed.BS3($NA(@BSR@(BST)))
 Q 1
C123 ;
]]></Routine>


<Routine name="%ZAPM.ed.BSHTML" type="MAC" languagemode="0"><![CDATA[
%BSHTML ; пpогpамма ВЫГРУЗКИ ТАБЛИЦЫ В HTML ; 16:20   07.09.2001
 Q
HTML(TABLE) 
 ;Header of HTML Program
 N XB,YB,XE,YE,X,Y,I,SD,B,YT,XT,YXT,YdT,XdT,ASD,BS,ny,nx,d,d0,d1
 D ADD("<!--%BS VERSION "_$G(^%ZAPM.ed.BS)_"-->")
 D ADD("<HTML>")
 D ADD("<HEAD>")
 D ADD("<TITLE>"_$TR($P(@TABLE,"@"),S1,S2)_"</TITLE>")
 D ADD("</HEAD>")
 D ADD("<BODY>")
 D Wait^%ZAPM.ed.BSXfun("вывод в HTML")
 I $G(OUThtml) D TABCEL
 E  D TABLE
 D End
 Q
TABCEL ;ВЫВОД ТАБЛИЦЫ В HTML В ВИДЕ ТАБЛИЦЫ
 N n1 D ADD("<FONT FACE=""Courier New""><SMALL><SMALL><TABLE BORDER=0>")
 F ny=1:1 Q:'$D(@TABLE@(ny))  K S D  X $G(WA)
 .D ADD("<TR>")
 .F nx=1:1 Q:'$D(@TABLE@(ny,nx))  K S D
 ..D CELL^%ZAPM.ed.BSCi D ADD("<TD>")
 ..S n1="" F  S n1=$O(S(n1)) Q:n1=""  D ADD($$HTm^%ZAPM.ed.BSre($TR(S(n1),S1,S2))_"<BR>")
 ..D ADD("</TD>")
 .D ADD("</TR>")
 D ADD("</TABLE></SMALL></SMALL></FONT>")
 Q
TABLE ;OF HTML
 D ADD("<CENTER><SMALL><SMALL><PRE>")
 F ny=1:1 Q:'$D(@TABLE@(ny))  K S D  X $G(WA)
 .F nx=1:1 Q:'$D(@TABLE@(ny,nx))  D CELL^%ZAPM.ed.BSCi
 .S nx="" F  S nx=$O(S(nx)) Q:nx=""  D ADD($$HTm^%ZAPM.ed.BSre($TR(S(nx),S1,S2)))
 D ADD("</PRE></SMALL></SMALL></CENTER>")
 Q
End ;of HTML Program
 D ADD("</BODY>")
 D ADD("</HTML>")
 Q
ADD(S) U %DEV W S,! U 0
 Q
BS2EXCEL(TABLE,GT) ;BS TO EXCEL ПРИЛОЖЕНИЕ ДЛЯ CACHE'  Bs2Exc.exe
 N TIX,TIY,TIT,XB,YB,XE,YE,X,Y,I,SD,B,YT,XT,YXT,YdT,XdT,ASD,BS,ny,nx,d,d0,d1,LNG,N,NN,NNN,KS,BSR,BST,TIP
 S (S2,S1)="" I $$IFDOS^%ZAPM.ed.BSHTML1($G(@TABLE)) D  ;ПЕРЕКОДИРОВАТЬ
 .K S1,S2 I $$ANSI^%ZAPM.ed.BSre("")
 S LNG=1000,N=0,NN="",KS=0,BSR=$P(TABLE,"("),BST=$QS(TABLE,1),TIP=$P(@TABLE,"@",17)
 D BS2TIT
 F ny=1:1 Q:'$D(@TABLE@(ny))  K S D
 .I TIP=5 S S(1)=$G(@TABLE@(ny)) ;ЭТО ТЕКСТ
 .E  F nx=1:1 Q:'$D(@TABLE@(ny,nx))  D:$P(TIT,",")=ny&($P(TIT,",",2)=nx)  D CELL^%ZAPM.ed.BSCi
 ..S TIX=$L($G(S(1)))+1,TIY=KS
 .S nx="" F  S nx=$O(S(nx)) Q:nx=""  S NNN=$TR(S(nx),S1,S2) D
 ..I ($L(NN)+$L(NNN))>LNG S N=N+1,@GT@(N)=$E(NN,1,$L(NN)-1),NN=""
 ..S NN=NN_NNN_$C(1),KS=KS+1
 S N=N+1,@GT@(N)=$E(NN,1,$L(NN)-1),@GT=KS
 S P4="$"_(TIY-2)_":$"_TIY,P5=TIX+1 ;ПЛЮС ПЕРВЫЙ ПРОБЕЛ В EXCEL
 Q +N
BS2TIT S TIT="1,1"
 I $P(@TABLE,"@",19) S TIT=$P(@TABLE,"@",19)
 E  I $P(@TABLE,"@",50) S TIT=$P(@TABLE,"@",50)
 Q
]]></Routine>


<Routine name="%ZAPM.ed.BSHTML1" type="MAC" languagemode="0"><![CDATA[
%BSHTML1 ; пpогpамма работы с Java & JavaScript ; 15:07   04.05.2003
 q
NETDIR() ;СЕТЕВАЯ ДИРЕКТОРИЯ
 N Ns S Ns=$P($G(^%ZAPM.ed.BSETUP("SERVER",15,4)),"@",15) I Ns="" S Ns="C:\TEMP\"
 Q Ns
UNAME() N A S A=$TR($$h^%ZAPM.ed.BS3(),",","_") Q $E(A,$L(A)-8,$L(A))
NAMEFILE() N N1,N2 S N1=$P($P(BST,"!",3),".",1)
 ;это для молнии
 I N1="" S N1=$E(BST,1,8) Q $$TOM()_"\"_$$KIP()_"\"_$$UNAME()
 ;это для табеля
 S:$E(N1,2)="P" $E(N1,2)="" S N2=$E(N1,7) I N2="" S N2="_"
 I $E(N1,2,6)["KOM" S N1="_KOM" ;командировки --------------
 Q $$TOM()_"\"_$$KIP()_"\"_$E(N1,2,6)_"\"_$$UNAME()
KIP() N Ns S Ns=$P(BST,$C(34),2)
 I Ns="" S Ns=$p($P(BST,"!",3),".",1)
 I Ns="" D  Q Ns
 .I $P(BST,"_",1)["INSP" S Ns="INSP"
 .E  S Ns=$P(BST,"_",1)
 Q Ns
TOM() N Ns S Ns=$P(BST,$C(34),4)
 I Ns="" d
 .S Ns=$p($P(BST,"!",3),".",1)
 .i Ns["Q"!(Ns["SP") S Ns="TAB"
 I Ns="" Q "MOL"
 Q Ns
INTJAVA(BSR,BST,%FN) ;ВЫВОД ТАБЛИЦЫ В JAVA-APPLET ВНУТРЕННЯЯ ТОЧКА
 N S1,S2,BUF,BUF1,BUF2,%DEV,S,DOS,FNO,PR1,N1,N2
 S DOS=52 I $$Open^%ZAPM.ed.BSXdos(%FN,"W")<0 Q
 I '$D(S1) D INIT^%ZAPM.ed.BSre(1)
 I $ZV["Cach"||($ZV["IRIS") S (S1,S2)=""
 U DOS D JAVA C DOS
 Q
OUTJAVA ;ВЫВОД ТАБЛИЦЫ В JAVA-APPLET
 N S1,S2,BUF,BUF1,BUF2,%DEV,%FN,S,DOS,FNO,PR1,N1,N2
 S PR1=$$NETDIR()_$$NAMEFILE_".HTM" D DOSOPN^%ZAPM.ed.BSBL1 Q:'$D(%FN)
 I '$D(S1) D INIT^%ZAPM.ed.BSre(1)
 I $ZV["Cach"||($ZV["IRIS") S (S1,S2)=""
 D Wait^%ZAPM.ed.BSXfun("Идет вывод")
 U %DEV D JAVA
 C %DEV
 U 0 D OkMsg^%ZAPM.ed.BSXfun("Вывод Завершен")
 Q
Desc() ;ЗАГОЛОВКИ
 N N I $D(@BSR@(BST,"PERHEAD")) Q $G(@BSR@(BST,"PERHEAD")) ;TAF
 S N=$P($G(@BS),"@") I $P(N,"~~~",2)'="" Q $P(N,"~~~",2) ;ТАБЕЛЬ
 I $P(N,"|",2)'="" Q $P(N,"|",2)
 Q N
SCREEN ; РАЗРЕШЕНИЕ АПЛЕТА
 ;РАЗРЕШЕНИЕ МОНИТОРА      screen.availWidth screen.availHeight
 ;S W=620,H=350   ;640x480 !!! ВЗАВИСИМОСТИ ОТ COOKIE ИЛИ IP\ADRESSA
 ;S W=801,H=601    ;800x600
 S W=1023,H=760   ;1024x768
 ;S W=1280,H=1024   ;1280x1024
 Q
CODEBASE() I $G(%BsWebL) Q $$0^%ZAPM.ed.BSCh(31)
 N Ns S Ns=$P($G(^%ZAPM.ed.BSETUP("SERVER",16,4)),"@",15) I Ns="" S Ns="CACHESERVER"
 Q "http://"_Ns_"/iss/tabview/"
PERDAT(G) ;ПЕРИОД ДАТ В ТИТУЛ ДОКУМЕНТА
 N T,C S T="Насчет от "_$P($G(@G@("PERDATE")," ..?")," ",2)
 I $D(@G@("PER",1)) F C=1:1 Q:'$D(@G@("PER",C))  S T=T_BK_@G@("PER",C)
 Q T
JAVA ;ФОРМИРОВАНИЕ ТАБЛИЦЫ ДЛЯ АПЛЕТА
 S UsBS12=$G(%BS(12))
 N %BS,I,II,NSPACE,GL,P1,P2,P3,P9,PART,TABL,TIP,CFG,BS
 N JAVA,W,H,BODY,STR,COL,TIT,TIX,TIY,BYTE,S1,S2
TE I $G(%BsWebL),'$$TABVAR^%ZAPM.ed.BSCh1 Q
 I '$G(%BsWebL) D VARLOC
 S (S2,S1)="" I $$IFDOS($P($G(@BS),"@")) K S1,S2 I $$ANSI^%ZAPM.ed.BSre("")
 D SCREEN ;640x480 РАЗРЕШЕНИЕ АПЛЕТА
APPLET ;ФОРМИРОВАНИЕ ТАБЛИЦЫ
 W "<HTML>",BK
 W "<HEAD><TITLE>"_$TR($$Desc(),S1,S2)_"</TITLE>",BK
 W "<!--%BS + "_$ZV_"-->",BK
 W "<!--%BS "_BST_$TR(" Выводил "_$G(UsBS12)_" из Cистемы "_$$ZU^%ZAPM.ed.BS3(1,0)_" , а насчитывал "_$G(@BSR@(BST,"PERUSER")),S1,S2)_"-->",BK
 W "<!--<BSTITLE> "_$TR($$PERDAT($NA(@BSR@(BST))),S1,S2)_"</BSTITLE>-->"
 ;W BK,"<SCRIPT LANGUAGE=""JavaScript"" SRC="""_$$CODEBASE()_"TabView.JS"">",BK
 ;W "</SCRIPT>",BK
 W BK,"<SCRIPT LANGUAGE=""JavaScript""><!--",BK
 W "function NewSize() {",BK
 W "var W=document.body.clientWidth;",BK
 W "var H=document.body.clientHeight;",BK
 W "document.TabView.SetOptionApplet(W-10,H-15,""0"",0,0,0);",BK
 W "}//--></SCRIPT>",BK
 W "<SCRIPT LANGUAGE=""JavaScript"" EVENT=""onresize"" FOR=""window""> NewSize();",BK
 W "</SCRIPT>",BK
 W "<SCRIPT LANGUAGE=""JavaScript"" EVENT=""onscroll"" FOR=""window""> window.scroll(0,0);",BK
 W "</SCRIPT>",BK
 W "</HEAD>",BK
 W "<BODY onload=""NewSize();"">",BK
 D BODY I '$D(@BODY) W STR G FINAL
 W "<APPLET CODE=TabView.class CODEBASE="""_$$CODEBASE()_""" ID=TabView WIDTH="_W_" HEIGHT="_H_">",BK
 W "<PARAM NAME=COMMENT VALUE="""_1_""">",BK
 W "<PARAM NAME=t2tFontN VALUE=""Courier"">",BK
 W "<PARAM NAME=t2tFontH VALUE=12>",BK
 S Tmp=$$GLRET^%ZAPM.ed.BSF12($NA(@BODY@(1)))
 I $E(Tmp,1)=" "!($E(Tmp,1)="") W "<PARAM NAME=FirstChar VALUE=1>",BK D GLSET^%ZAPM.ed.BSF12($NA(@BODY@(1)),"F"_$E(Tmp,2,9999))
 W "<PARAM NAME=t2tstr VALUE="_STR_">",BK
 W "<PARAM NAME=t2tcol VALUE="_COL_">",BK
 I $G(TIT) W "<PARAM NAME=t2tituls VALUE="_$G(TIY,1)_">",BK,"<PARAM NAME=t2titulc VALUE="_$G(TIX,1)_">",BK
 W "<PARAM NAME=t2t VALUE=""",BK
 S BYTE=0,BYT=0 F I=1:1 Q:'$D(@BODY@(I))  S II=$$GLRET^%ZAPM.ed.BSF12($NA(@BODY@(I)))_$J("",COL-$L($$GLRET^%ZAPM.ed.BSF12($NA(@BODY@(I)))))_BK,BYTE=BYTE+$L(II) D
 .I (BYTE+$L(II))>35000 I $E(II,$L(II)-2)=" " S $E(II,$L(II)-2)="_"
 .I BYTE>35000 D
 ..S BYTE=$L(II),BYT=BYT+1 W """>",BK,"<PARAM NAME=t2t"_BYT_" VALUE=""",BK
 ..I $E(II,1)=" " S $E(II,1)="_"
 .W $TR(II,S1,S2)
 W """></APPLET>",BK
FINAL W "</BODY>","</HTML>",BK
 Q
BYTEPLUS I $E(II,$L(II))=" " S $E(II,$L(II))="_"
 Q
BODY S COL=0,STR=0,BODY=$$TMPG^%ZAPM.ed.BSF11
 I $P(@BS,"@",17)=5 D  Q  ;ТЕКСТ
 .S COL=0 F I=1:1 Q:'$D(@PART@(TABL,I))  D  I COL<$L(Tmp) S COL=$L(Tmp)
 ..S Tmp=$$CTRL^%ZAPM.ed.BSre($TR($G(@PART@(TABL,I)),$C(34),"'"))
 ..D GLSET^%ZAPM.ed.BSF12($NA(@BODY@(I)),Tmp)
 .S STR=I-1
 I $P(@BS,"@",17)=1 D  Q  ;ТАБЛИЦА
 .N X,S,ny,nx,d,d1,d0,BSR,BST ;МОДУЛЬ ИЗ ^%ZAPM.ed.BSHTML
 .S TABLE=BS,STR=0,%BS(15)=1,BSR=PART,BST=TABL,TIT="1,1"
 .I $P(@BS,"@",19) S TIT=$P(@BS,"@",19)
 .E  I $P(@BS,"@",50) S TIT=$P(@BS,"@",50)
 .F ny=1:1 Q:'$D(@TABLE@(ny))  K S D  I $D(%DEV) U 0 X WA U %DEV
 ..F nx=1:1 Q:'$D(@TABLE@(ny,nx))  D:$P(TIT,",")=ny&($P(TIT,",",2)=nx)  D CELL^%ZAPM.ed.BSCi
 ...S TIX=$L($G(S(1)))+1,TIY=STR+1
 ..S nx="" F  S nx=$O(S(nx)) Q:nx=""  S STR=STR+1 D  I COL<$L(Tmp) S COL=$L(Tmp)
 ...S Tmp=$$CTRL^%ZAPM.ed.BSre($TR(S(nx),$C(34),"'"))
 ...D GLSET^%ZAPM.ed.BSF12($NA(@BODY@(STR)),Tmp)
 S STR="УКАЗАННЫЙ ТИП ОБЪЕКТА ПОКА НЕ ПОДДЕРЖИВАЕТСЯ"
 Q
TAGS(S) ;ESCAPE КОДИРОВАНИЕ
 I S[" " S S=$$TR^%ZAPM.ed.BSsFUNM(S," ","&nbsp;")
 I S["<" S S=$$TR^%ZAPM.ed.BSsFUNM(S,"<","&lt;")
 I S[">" S S=$$TR^%ZAPM.ed.BSsFUNM(S,">","&gt;")
 I S[$C(34) S S=$$TR^%ZAPM.ed.BSsFUNM(S,$C(34),"&quot;")
 ;I S["%" S S=$$TR^%ZAPM.ed.BSsFUNM(S,"%","%25")
 ;I S["\" S S=$$TR^%ZAPM.ed.BSsFUNM(S,"\","%5C")
 ;I S[":" S S=$$TR^%ZAPM.ed.BSsFUNM(S,":","%3A")
 Q S
IFDOS(S) ;ПРОВЕРКА КОДИРОВКИ
 I $TR(S,$C(128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175),"")'=S Q 1
 Q 0
TEST S (BST,TABL)="A1000_20000417_1",(BSR,PART)="^[""MGR"",""WNT""]%BSMOLN",BK=""
 S BS=$NA(@PART@(TABL))
 D TE
 Q
VARLOC ;ЛОКАЛЬНЫЕ ПЕРЕМЕННЫЕ
 S BK=$C(13,10),TABL=BST,PART=BSR,BS=$NA(@PART@(TABL))
 Q
]]></Routine>


<Routine name="%ZAPM.ed.BSI" type="MAC" languagemode="0"><![CDATA[
%BSI ;ТЕСТ ТАБЛИЦ (Е.Истомин) недоделанная ; 20:15   13.03.99
 I $ZV["Cach"||($ZV["IRIS") D ErrMsg^%ZAPM.ed.BSXfun(" НЕТ РЕЖИМА В "_$ZV) Q
 N j,do,CountUCI,CountVOL,MesStr,BStmp,TmpVOL,TmpUCI,Buf
 S $ZT="ErrGlo^%ZAPM.ed.BSI"
 D SA^%ZAPM.ed.BSsBUF,zzz,RE^%ZAPM.ed.BSsBUF,CL^%ZAPM.ed.BSF4 Q
zzz W /CUP(1,1),$$atr^%ZAPM.ed.BS3(0),*27,"[0J"
 S MesStr=""
 S Way=1
 K ^%ZAPM.ed.BSbufB("Mes"_$G(%BS(3),$P)_$J_"u")
 K BStmp,TmpVOL,TmpUCI,Buf
 D MGR^%ZAPM.ed.BS
 I $P($$ZU^%ZAPM.ed.BS3(0),",",2)'=$P($$ZU^%ZAPM.ed.BS3(1,0),",",2) D  Q
 .S MesStr="Перейдите в системный том."
 .D ErrGlo^%ZAPM.ed.BSI
 .Q
 D Ramka^%ZAPM.ed.BSXfun(4,20,12,60,2,"47;30;6",1)
 W /CUP(5,25),$$atr^%ZAPM.ed.BS3("47;30"),"0%           Тома            0%"
 W /CUP(9,25),"0%           Кипы            0%"
 W /CUP(6,25),$$atr^%ZAPM.ed.BS3("44;34;1;5"),"                               "
 W /CUP(10,25),"                               ",$$atr^%ZAPM.ed.BS3("40;37;6;2")
 D Ramka^%ZAPM.ed.BSXfun(14,10,22,70,2,"47;30;6",1)
 W /CUP(14,30)," Диагностика таблиц "
 F CountVOL=0:1 Q:$$ZU^%ZAPM.ed.BS3(1,CountVOL)=""  D
 .F CountUCI=1:1 Q:$$ZU^%ZAPM.ed.BS3(CountUCI,CountVOL)=""  D
 ..S TmpUCI($$ZU^%ZAPM.ed.BS3(CountUCI,CountVOL))=CountUCI Q
 .S BStmp($P($$ZU^%ZAPM.ed.BS3(1,CountVOL),",",2))=CountUCI-1
 .S TmpVOL($P($$ZU^%ZAPM.ed.BS3(1,CountVOL),",",2))=CountVOL+1
 .Q
 S OldVOL=$P($$ZU^%ZAPM.ed.BS3(1,0),",",2)
 S Str=15
 S DOX="D START^%ZAPM.ed.BSI(i,iI)" D STA^%ZAPM.ed.BSF5
 W /CUP(1,1),*27,"[0J"
 I '$D(^%ZAPM.ed.BSbufB("Mes"_$G(%BS(3),$P)_$J_"u")) D  G Ex
 .D OkMsg^%ZAPM.ed.BSXfun("Повреждений не обнаружено.")
 I $D(^%ZAPM.ed.BSbufB("Mes"_$G(%BS(3),$P)_$J_"u")) S ls=" Диагностика закончена. Просмотр ошибок ? " D YES^%ZAPM.ed.BSF G Ex:YES<1 I YES=1 D  Q
 .D Select Q
 S ls="Попытаемся отремонтировать таблицу "_$P(Buf(Cou),";")_" ?"
 D YES^%ZAPM.ed.BSF I YES=1 D
 .S uci=""_$P(Buf(Cou),";",3)_","_$P(Buf(Cou),";",4)_"" D %GU^%ZAPM.ed.BSF4
 .D REMONT^%ZAPM.ed.BSF5($P(Buf(Cou),";",2),$P(Buf(Cou),";",1))
 .D x^%ZAPM.ed.BS3("I+40")
Ex ;D RE^%ZAPM.ed.BSsBUF
 Q
 
START(BSR,BST) 
 S Scrol1=TmpVOL($P($$ZU^%ZAPM.ed.BS3(0),",",2))/CountVOL*31
 S Scrol2=TmpVOL($P($$ZU^%ZAPM.ed.BS3(0),",",2))/CountVOL*100
 W /CUP(6,25),$$atr^%ZAPM.ed.BS3("44;34;2;6"),$TR($J("",Scrol1)," ",$C(219))
 W $$atr^%ZAPM.ed.BS3("47;30"),/CUP(5,52),$J(Scrol2,3,0),"%"
 S Scrol3=TmpUCI($$ZU^%ZAPM.ed.BS3(0))/BStmp($P($$ZU^%ZAPM.ed.BS3(0),",",2))*31
 S Scrol4=TmpUCI($$ZU^%ZAPM.ed.BS3(0))/BStmp($P($$ZU^%ZAPM.ed.BS3(0),",",2))*100
 I $P($$ZU^%ZAPM.ed.BS3(0),",",2)'=OldVOL W /CUP(10,25),$$atr^%ZAPM.ed.BS3("44;34;1;5"),"                               "
 W /CUP(10,25),$$atr^%ZAPM.ed.BS3("44;34;2;6"),$TR($J("",Scrol3)," ",$C(219))
 W $$atr^%ZAPM.ed.BS3("47;30"),/CUP(9,52),$J(Scrol4,3,0),"%"
 I BSR="^%ZAPM.ed.BSbufS"!(BSR="^%ZAPM.ed.BSX") G EXIT
 
 ;``РАЗОВАЯ ПРОКАЧКА - ИСПРАВЛЕНИЕ БАГА
 ;``I $P(@(BSR_"(BST)"),"@",41)'="" S zXz=$ZR D
 ;``.N A S A=$P(@zXz,"@",41) I A["MENU^%ZAPM.ed.BSF11,MENU^%ZAPM.ed.BSF11" S $P(@zXz,"@",41)="MENU^%ZAPM.ed.BSF11"
 ;``G EXIT
 
 I $P(@(BSR_"(BST)"),"@",17)=5 G EXIT
 I Str=22 S StrBST(8)=" "_BST_$TR($J(0,20-$L(BST)),"0",":") F TT=1:1:7 D
 .S StrBST(TT)=StrBST(TT+1)
 .W /CUP(TT+14,15),$$atr^%ZAPM.ed.BS3("47;30;6"),StrBST(TT)
 .W:TT=7 /CUP(TT+14,15),$$atr^%ZAPM.ed.BS3("47;30;6"),StrBST(TT+1) D:TT=7 PROV
 I Str<22&(Str>15) S StrBST(Str-14)=" "_BST_$TR($J(0,20-$L(BST)),"0",":") D
 .W /CUP(Str,15),$$atr^%ZAPM.ed.BS3("47;30;6"),StrBST(Str-14) D PROV S Str=Str+1 Q
 I Str=15 S StrBST(Str-14)=" "_BST_$TR($J(0,20-$L(BST)),"0",":") D
 .W /CUP(Str,15),$$atr^%ZAPM.ed.BS3("47;30;6"),StrBST(Str-14) D PROV S Str=Str+1 Q
 D MaxY^%ZAPM.ed.BSI S MaxHighY=TempY
 D MaxX^%ZAPM.ed.BSI S MaxHighX=TempX
 S FlagEr=0
 F u=1:1:MaxHighX-1 F m=1:1:MaxHighY-1  D  G JUMP:FlagEr
 .I '$D(@(BSR_"(BST,m,u)")) S FlagEr=1 D Mess Q
 .S ColDiag=$S($P(@(BSR_"(BST,m,u)"),"@",3)="":1,1:$P(@(BSR_"(BST,m,u)"),"@",3))
 .S ColDiag=ColDiag+$S($P(@(BSR_"(BST,m,u)"),"@",1)="":1,1:$P(@(BSR_"(BST,m,u)"),"@",1))
 .I $D(@(BSR_"(BST,m+1,u)")) I $P(@(BSR_"(BST,m+1,u)"),"@",1)'=ColDiag D  Q
 ..D Mess S FlagEr=1 Q
 .Q
 F h=1:1:MaxHighY-1 F j=1:1:MaxHighX-1  D  G JUMP:FlagEr
 .I '$D(@(BSR_"(BST,h,j)")) S FlagEr=1 D Mess Q
 .S StrDiag=$S($P(@(BSR_"(BST,h,j)"),"@",4)="":1,1:$P(@(BSR_"(BST,h,j)"),"@",4))
 .S StrDiag=StrDiag+$S($P(@(BSR_"(BST,h,j)"),"@",2)="":1,1:$P(@(BSR_"(BST,h,j)"),"@",2))
 .I $D(@(BSR_"(BST,h,j+1)")) I $P(@(BSR_"(BST,h,j+1)"),"@",2)'=StrDiag  D   Q
 ..D Mess S FlagEr=1 Q
 .Q
 F u=1:1:MaxHighX-1 D  G JUMP:FlagEr
 .I (u+1)'>(MaxHighX-1) D  Q
 ..I $P(@(BSR_"(BST,MaxHighY-1,u)"),"@",3)'=$P(@(BSR_"(BST,MaxHighY-1,u+1)"),"@",3) S FlagEr=1 D Mess Q
 F h=1:1:MaxHighY-1 D  G JUMP:FlagEr
 .I (h+1)'>(MaxHighY-1) D  Q
 ..I $P(@(BSR_"(BST,h,MaxHighX-1)"),"@",4)'=$P(@(BSR_"(BST,h+1,MaxHighX-1)"),"@",4) S FlagEr=1 D Mess Q
 D OK S StrBST(Str-15)=StrBST(Str-15)_" Ok ...       " G EXIT
JUMP D Error S StrBST(Str-15)=StrBST(Str-15)_" ошибка ...   "
 ;S do="S zr=$ZR,$P(@zr,""@"",3)=$P(^%ZAPM.ed.BSbufB(""u""_$G(%BS(3),$P)_$J_""u""_%BS(15),m,1),""#""),$P(@zr,""@"",4)=$P(^%ZAPM.ed.BSbufB(""u""_$G(%BS(3),$P)_$J_""u""_%BS(15),1,j),""#"",2)"
 ;D ALLT^%ZAPM.ed.BSS1
EXIT S OldVOL=$P($$ZU^%ZAPM.ed.BS3(0),",",2)
 Q
 
PROV S x=$X,y=$Y W $$atr^%ZAPM.ed.BS3("47;31")," проверяю ... " Q
OK S $X=x,$Y=y W $$atr^%ZAPM.ed.BS3("47;30;6")," Ok ...       " Q
Error S $X=x,$Y=y W $$atr^%ZAPM.ed.BS3("47;30;6")," ошибка ...   " Q
 
Mess 
 I '$D(^%ZAPM.ed.BSbufB("Mes"_$G(%BS(3),$P)_$J_"u")) S ^%ZAPM.ed.BSbufB("Mes"_$G(%BS(3),$P)_$J_"u")="Error"
 S ^%ZAPM.ed.BSbufB("Mes"_$G(%BS(3),$P)_$J_"u",Way)=BST_";"_BSR_";"_$P($$ZU^%ZAPM.ed.BS3(0),",")_";"_$P($$ZU^%ZAPM.ed.BS3(0),",",2)
 S Way=Way+1
 Q
 
Bord(%1,%2,%3,%4) 
 W /CUP(%1,$G(%3)),$$atr^%ZAPM.ed.BS3(%4),$C(220)
 W /CUP($G(%1)+1,$G(%2)+1),$$atr^%ZAPM.ed.BS3(%4),$TR($J("",$G(%3)-$G(%2))," ",$C(223))
 Q
 
EnterBut(%1,%2,%3) 
 Q
 
ErrGlo 
 N Delay,I
 D Ramka^%ZAPM.ed.BSXfun(8,15,14,65,2,"41;33;1",1)
 I MesStr="" S MesStr=$ZE W /CUP(8,35)," Ошибка ! "
 S Delay=$P(%BS(2),"-",3)*1000
 W /CUP(10,(65-15-$L(MesStr))\2+15),$$atr^%ZAPM.ed.BS3("41;37;1"),$E(MesStr,1,40)
 D Bord(12,36,44,"41;30;2") D CL^%ZAPM.ed.BSF4
 W /CUP(12,36),$$atr^%ZAPM.ed.BS3("47;30;2;6"),"  Ввод  ",*R D OP^%ZAPM.ed.BSF4
 W /CUP(12,36),$$atr^%ZAPM.ed.BS3("41")," ",$$atr^%ZAPM.ed.BS3("47;30;2;6"),"  Ввод  "
 W /CUP(13,36),$$atr^%ZAPM.ed.BS3("41"),"         "
 F I=1:1:Delay
 D Bord(12,36,44,"41;30;2")
 W /CUP(12,36),$$atr^%ZAPM.ed.BS3("47;30;2;6"),"  Ввод  "
 F I=1:1:Delay
 ;W /CUP(1,1),$$atr^%ZAPM.ed.BS3(0),*27,"[0J"
 D CL^%ZAPM.ed.BSF4,RE^%ZAPM.ed.BSsBUF
 Q
 
Select 
 D Ramka^%ZAPM.ed.BSXfun(6,15,20,65,2,"44;36;1",1)
 W /CUP(7,17),$$atr^%ZAPM.ed.BS3("40;33"),"           Таблица            Раздел           ",$$atr^%ZAPM.ed.BS3(0)
 W /CUP(8,16),$$atr^%ZAPM.ed.BS3("44;36;1"),"-------------------------------------------------",$$atr^%ZAPM.ed.BS3(0)
 S Index1=""
 F k=1:1 S Index1=$O(^%ZAPM.ed.BSbufB("Mes"_$G(%BS(3),$P)_$J_"u",Index1)) Q:Index1=""  D
 .S Buf(k)=$G(^%ZAPM.ed.BSbufB("Mes"_$G(%BS(3),$P)_$J_"u",Index1))
 .Q
 F j=1:1:$S(k-1<11:k-1,1:11)  W /CUP(8+j,17),$$atr^%ZAPM.ed.BS3("44;36;1"),"           ",$P(Buf(j),";"),$J("",18-$L($P(Buf(j),";"))),$P(Buf(j),";",2),$J("",18-$L($P(Buf(j),";",2)))
 W /CUP(9,17),$$atr^%ZAPM.ed.BS3("40;32;1"),"           ",$P(Buf(1),";"),$J("",18-$L($P(Buf(1),";"))),$P(Buf(1),";",2),$J("",18-$L($P(Buf(1),";",2)))
 S Str=9,Cou=1,i=0
Rotat D CL^%ZAPM.ed.BSF4 R *R D OP^%ZAPM.ed.BSF4
 I R=66&(Str=19) D  G Rotat
 .I Cou<(k-1) S i=i+1,Cou=Cou+1 D
 ..F j=1:1:$S(k-1<11:k-1,1:11)  W /CUP(8+j,17),$$atr^%ZAPM.ed.BS3("44;36;1"),"           ",$P(Buf(j+i),";"),$J("",18-$L($P(Buf(j+i),";"))),$P(Buf(j+i),";",2),$J("",18-$L($P(Buf(j+i),";",2)))
 ..W /CUP(Str,17),$$atr^%ZAPM.ed.BS3("40;32;1"),"           ",$P(Buf(j+i),";"),$J("",18-$L($P(Buf(j+i),";"))),$P(Buf(j+i),";",2),$J("",18-$L($P(Buf(j+i),";",2)))
 I R=66 D  G Rotat
 .I (Cou+1)<k D
 ..W /CUP(Str,17),$$atr^%ZAPM.ed.BS3("44;36;1"),"           ",$P(Buf(Cou),";"),$J("",18-$L($P(Buf(Cou),";"))),$P(Buf(Cou),";",2),$J("",18-$L($P(Buf(Cou),";",2)))
 ..W /CUP(Str+1,17),$$atr^%ZAPM.ed.BS3("40;32;1"),"           ",$P(Buf(Cou+1),";"),$J("",18-$L($P(Buf(Cou+1),";"))),$P(Buf(Cou+1),";",2),$J("",18-$L($P(Buf(Cou+1),";",2)))
 ..S Str=Str+1,Cou=Cou+1
 I R=65&(Str=9) D  G Rotat
 .I Cou'<2 S i=i-1,Cou=Cou-1 D
 ..F j=1:1:$S(k-1<11:k-1,1:11)  W /CUP(8+j,17),$$atr^%ZAPM.ed.BS3("44;36;1"),"           ",$P(Buf(j+Cou-1),";"),$J("",18-$L($P(Buf(j+Cou-1),";"))),$P(Buf(j+Cou-1),";",2),$J("",18-$L($P(Buf(j+Cou-1),";",2)))
 ..W /CUP(Str,17),$$atr^%ZAPM.ed.BS3("40;32;1"),"           ",$P(Buf(Cou),";"),$J("",18-$L($P(Buf(Cou),";"))),$P(Buf(Cou),";",2),$J("",18-$L($P(Buf(Cou),";",2)))
 I R=65 D  G Rotat
 .W /CUP(Str,17),$$atr^%ZAPM.ed.BS3("44;36;1"),"           ",$P(Buf(Cou),";"),$J("",18-$L($P(Buf(Cou),";"))),$P(Buf(Cou),";",2),$J("",18-$L($P(Buf(Cou),";",2)))
 .W /CUP(Str-1,17),$$atr^%ZAPM.ed.BS3("40;32;1"),"           ",$P(Buf(Cou-1),";"),$J("",18-$L($P(Buf(Cou-1),";"))),$P(Buf(Cou-1),";",2),$J("",18-$L($P(Buf(Cou-1),";",2)))
 .S Str=Str-1,Cou=Cou-1
 I R=13 Q
 G Rotat
 
MaxY 
 S TempY=0
 F t=1:1 D  Q:'$D(@(BSR_"(BST,1,t+1)"))&('$D(@(BSR_"(BST,1,t+2)")))
 .F HighY=1:1 Q:'$D(@(BSR_"(BST,HighY,t)"))
 .I TempY<HighY S TempY=HighY
 .Q
 
MaxX 
 S TempX=0
 F t=1:1 D  Q:'$D(@(BSR_"(BST,t+1,1)"))&('$D(@(BSR_"(BST,t+2,1)")))
 .F HighX=1:1 Q:'$D(@(BSR_"(BST,t,HighX)"))
 .I TempX<HighX S TempX=HighX
 .Q
]]></Routine>


<Routine name="%ZAPM.ed.BSIND" type="MAC" languagemode="0"><![CDATA[
%BSIND ; пpогpамма РАБОТЫ С ИНДЕКСИРОВАННЫМИ ПОКАЗАТЕЛЯМИ И КЛЮЧАМИ ; 18:06   11.06.2003
 Q
DELNODE(BSR,BST,ny,nx) ;УДАЛИТЬ ИНДЕКСЫ
 N B,BD S B=$$MASS Q:B=""
 K @B@(BST_","_ny_","_nx)
 Q
FINDCEL(F,ny,nx,BSR,BST) ;ИНДЕКСИРОВАННЫЕ ПОКАЗАТЕЛИ
 N B,BD,T1,T2,T3,k0,k1,k2,k3,k4,k5,k6,k7,k8,k9,FF,FFF,LOO,LOOP,i
 S %zT=$ZT,$ZT="ERRO^%ZAPM.ed.BSIND"
 S B=$$MASS I B="" D ErrMsg^%ZAPM.ed.BSXfun("ОШИБКА ! В ДОСТУПЕ К БД-ПОИСКА "_BD) Q
 I '$D(@B@(BST_","_ny_","_nx))!(F="@+")!($$PORA()) D DELNODE(BSR,BST,ny,nx) I '$$GREAT(F) Q
 I F="@-" D DELNODE(BSR,BST,ny,nx),OkMsg^%ZAPM.ed.BSXfun("УДАЛИЛИ ИНДЕКСЫ") Q
 S BD=$NA(@B@(BST_","_ny_","_nx)),F=$E(F,2,9999)
 S FF=$O(@B@(F),-1)
 S i=$$LOAD^%ZAPM.ed.BSscrF("^%ZAPM.ed.BSVOL(INDEX)",1,2,"~","FF^%ZAPM.ed.BSIND")
 S i=$G(%BS("Tmp","BSD")),j=$P($G(%BS("Tmp","LastTabl")),"@",9)
 I $QS(i,$QL(i))=j S i=$NA(@i)
 E  S i=$NA(@i@(j))
 I '$$Data^%ZAPM.ed.BSF12(i) W /BEL Q
 I $D(@i)'=1 S k1=$O(@i@("")) I $D(@i@(k1))'=1 S k2=$O(@i@(k1,"")) I $D(@i@(k1,k2))'=1 S k3=$O(@i@(k1,k2,"")) I $D(@i@(k1,k2,k3))'=1 S k4=$O(@i@(k1,k2,k3,"")) I $D(@i@(k1,k2,k3,k4))'=1 S k5=$O(@i@(k1,k2,k3,k4,"")) I $D(@i@(k1,k2,k3,k4,k5))'=1 S k6=$O(@i@(k1,k2,k3,k4,k5,"")) I $D(@i@(k1,k2,k3,k4,k5,k6))'=1 S k7=$O(@i@(k1,k2,k3,k4,k5,k6,"")) I $D(@i@(k1,k2,k3,k4,k5,k6,k7))'=1 S k8=$O(@i@(k1,k2,k3,k4,k5,k6,k7,"")) I $D(@i@(k1,k2,k3,k4,k5,k6,k7,k8))'=1
 S i=$ZR I '$$Data^%ZAPM.ed.BSF12(i) W /BEL Q
 D Yes^%ZAPM.ed.BSXfun("Установим на узел ? "_@i) Q:YES<1
 S END=2,zr=@i,j=")"
 Q
PORA() ;ПОРА ЛИ ОБНОВИТЬ ИНДЕКС
 N S
 S S=$G(@B@(BST_","_ny_","_nx)) I S="" Q 1
 I $P(S,"~",3),($P($$h^%ZAPM.ed.BS3,",")=$P(S,"~",3)) Q 0
 Q 1
FF S @BSR@(BST,"KEY")=BD
 Q
GREAT(F) ;СОЗДАТЬ ИНДЕКСЫ
 N I,FFF,II,LOOP,LOO
 S FF=F I $P(F,"@",2)'["BSD" S FF=$G(@BSR@(BST,"INDEX",ny,nx),"@F k0=95:1:99,""00"",""01"",""02"",""03"",""04"",""05"" S k1="""" F  S k1=$O(@(BSD_k0)@(k1)) Q:k1=""  S k2="""" F  S k2=$O(@(BSD_k0)@(k1,k2)) Q:k2=""""  S k3="""" F  S k3=$O(@(BSD_k0)@(k1,k2,k3)) Q:k3=""""  S k4="""" F  S k4=$O(@(BSD_k0)@(k1,k2,k3,k4)) Q:k4=""""  I k4>0 D CRE($NA(@(BSD_k0)@(k1,k2,k3,k4)),""$E($G(^(57),0),1,3)"",""$G(^(57),0)"",""$G(^(58),0)"")")
 D Wait^%ZAPM.ed.BSXfun("Создаем индекс для "_BST_","_ny_","_nx)
 S LOOP=0
 S %zT=$ZT,$ZT="EREX^%ZAPM.ed.BSIND"
 X FF
 S @B@(BST_","_ny_","_nx)=LOOP_"~"_LOO_"~"_$P($$h^%ZAPM.ed.BS3,",")_"~"_FF
 Q 1
CRE(S,U1,U2,U3,U4,U5,U6,U7,U8,U9) ;ПРИСВОЕНИЕ УЗЛА
 I '$D(FFF) D
 .S FFF=$NA(@B@(BST_","_ny_","_nx)),FFF=$E(FFF,1,$L(FFF)-1)
 .F I=1:1:9 I $D(@("U"_I)) S FFF=FFF_","_@("U"_I)
 .S FFF=FFF_")"
 I $D(@S@("3,3"))
 S LOOP=LOOP+1,@FFF@(LOOP)=S
 I '$D(LOO) S LOO=$QL($ZR)
 X WA
 Q
FINDKEY(F,ny,nx,BSR,BST) ;ИНДЕКСИРОВАННЫЕ КЛЮЧИ
 D OkMsg^%ZAPM.ed.BSXfun("ОТЛАДКА;-)") Q
 
 ;S END=2,c=...
 Q
MASS() N li,ll,YES,ls S (BD,B)=$G(@BSR@(BST,"INDEX"))
 ;I B="" D EDIT S:li'="" B=li I B="" Q ""
 I $$Data^%ZAPM.ed.BSF12(B)="00" W /BEL Q ""
 I $$Data^%ZAPM.ed.BSF12(B)=0 S @B="%BS-index-"
 Q B
DECODE(S,C,OT,KU) ;ПЕРЕКОДИРОВКА
 Q:'$D(ny)!('$D(nx))!('$D(R1))!('$D(R2))!('$D(R3))
 I ny=S,nx=C,R1=$P(OT,",",1),R2=$P(OT,",",2),R3=$P(OT,",",2) S R1=$P(KU,",",1),R2=$P(KU,",",2),R3=$P(KU,",",3)
 Q
EnterYX(Y0,X0) ;ВКЛЮЧИТЬ ПЕРЕКОДИРОВАНИЯ <ENTER> НА <ALT-Y> ДЛЯ КЛЕТКИ {Y,X}
 Q:'$D(ny)!('$D(nx))!('$D(R1))
 I ny=Y0,nx=X0,R1=13,R2=-1,R3=-1 S R1=0,R2=21
 Q
ENTER ;ВКЛЮЧИТЬ ПЕРЕКОДИРОВАНИЯ <ENTER> НА <ALT-Y> ДЛЯ КЛЕТКИ {26,2}
 Q:'$D(ny)!('$D(nx))!('$D(R1))
 I ny=26,nx=2,R1=13,R2=-1,R3=-1 S R1=0,R2=21
 Q
INDEXP S $P(@BSR@(BST,2,2),"@",15)=S,$P(@BSR@(BST,3,2),"@",15)=SSS
 S $P(@BSR@(BST,1,2),"@",15)=SS
 Q
EDIT ;РЕДАКТИРОВАНИЕ ССЫЛКИ ИНДЕКСИРОВАНИЯ ДЛЯ КЛЕТКИ
 ;N SS,S,i,SSS,SSSS
 ;S SS=$P($P(BS,"@",18),"#",1),SSS=BST,SSSS=BSR I SS="" S SS=ny_":"_nx
 ;
 ;I S="" S S=$$BSR^%ZAPM.ed.BSA("^X11111"),S=$NA(@S@(SSS))
 ;N BS,B,BST,BSR,BSY,BSX
 ;S i=$$LOAD^%ZAPM.ed.BSscrF("^%ZAPM.ed.BSVOL(INDEXP)","2#1#8",2,"~","INDEXP^%ZAPM.ed.BSIND") I R1=27 Q
 ;D x^%ZAPM.ed.BS3(i)     ;---//--- для msm 4.x.x
 ;Q
 I $G(@BSR@(BST,"INDEX"))="" D
 .S li=$$LineEdit^%ZAPM.ed.BSXfun($G(@BSR@(BST,"INDEX")),"СНАЧАЛО ВВЕДИТЕ ССЫЛКУ НА МАССИВ ИНДЕКСИРОВАНИЯ")
 .I YES S @BSR@(BST,"INDEX")=li
 I $G(@BSR@(BST,"INDEX"))="" Q
 S li=$$LineEdit^%ZAPM.ed.BSXfun($G(@BSR@(BST,"INDEX",ny,nx)),"ВВЕДИТЕ ОПЦИИ ФОРМИРОВАНИЯ ИНДЕКСИРОВАННОГО МАССИВА (F1)","","","^%ZAPM.ed.BSHLP(Find")
 I YES S @BSR@(BST,"INDEX",ny,nx)=li
 Q
ERRO D ErrMsg^%ZAPM.ed.BSXfun($ZE_" "_$$ErrSay^%ZAPM.ed.BSF8($ZE)) S $ZT=$G(%zT) Q
EREX D ErrMsg^%ZAPM.ed.BSXfun("ОШИБКА ФОРМИРОВАНИЯ ИНДЕКСА !"_$ZE_" "_$$ErrSay^%ZAPM.ed.BSF8($ZE)) S $ZT=$G(%zT) Q ""
]]></Routine>


<Routine name="%ZAPM.ed.BSJPRN" type="MAC" languagemode="0"><![CDATA[
%BSJPRN ;ПРИНТ-СЕРВЕРА; 21:28 29-JUL-96 ; 8:42   07.03.99
 Q
START() ;СТАРТ СЕРВЕРА
 S %zT=$ZT,$ZT="ER1^%ZAPM.ed.BSJPRN" D Wait^%ZAPM.ed.BSXfun("ЗАПУСК\АКТИВАЦИЯ ПРИНТ-СЕРВЕРА")
 I $$U("A")=1,$$U("D") D E("ПРИНТ-СЕРВЕР ЗАНЯТ, ИЗ "_$G(@UStro@("Z"),"?")) Q 0
 I $$U("A")=1,$$U("D")=0,$$U("Z")="" D S("O",""),S("C",$$ZU^%ZAPM.ed.BS3(1,0)_"u"_$G(%BS(3),$P)) G ZAPR
 I '$$U("A"),$$JOBSR(UStro) G ZAPR
EX Q 0
ER1 D ErrMsg^%ZAPM.ed.BSXfun($$ErrSay^%ZAPM.ed.BSF8($ZE)) S $ZT=$G(%zT) Q
ZAPR F Z=1:1 Q:$$U("O")=($$ZU^%ZAPM.ed.BS3(1,0)_"u"_$G(%BS(3),$P))  H 1 X WA I Z=$$PAR^%ZAPM.ed.BSprint(3) D E("ПРИНТ-СЕРВЕР НЕ АКТИВИРУЕТСЯ") G EX
 D S("O",""),S("C","!")
 F Z=1:1 Q:$$U("O")'=""  H 1 X WA I Z=$$PAR^%ZAPM.ed.BSprint(3) G XXX
 I $$U("O")=1 D E("У ПРИНТ-СЕРВЕРА НЕ ГОТОВО УСТРОЙСТВО ПЕЧАТИ")
 I $$U("O")=0 D E("У ПРИНТ-СЕРВЕРА ЧТО-ТО С НОМЕРОМ ПЕЧАТИ")
 I $$U("O")'="OK" G XXX
 D BUF,S("Z",$$ZU^%ZAPM.ed.BS3(1,0)),S("B",BUF),S("US",uS),S("UL",uL),S("UK",uK),S("OT",oT),S("RP",rP),S("EXE",uE)
 D S("O",""),S("C","P")
 Q 1
BUF ;СДЕЛАТЬ БУФЕР И ПЕРЕМЕННЫЕ
 ;TXT
 S uK=$G(^%ZAPM.ed.BSbufB("W"_$G(%BS(3),$P)_$J_"u","SHR")),uS=$P(uK,"#"),uL=$P(uK,"#",2),uK=$P(uK,"#",3)
 S uE=$P($G(^%ZAPM.ed.BSbufB("W"_$G(%BS(3),$P)_$J_"u","TXT")),"#",2)
 S oT=$P($G(^%ZAPM.ed.BSbufB("W"_$G(%BS(3),$P)_$J_"u","DOS")),"#"),rP=$P($G(^%ZAPM.ed.BSbufB("W"_$G(%BS(3),$P)_$J_"u","DOS")),"#",2)
 S BUF=$NA(^%ZAPM.ed.BSbufP($P($$RANDFILE^%ZAPM.ed.BSF11,".")))
 D Copy^%ZAPM.ed.BSF8($NA(^%ZAPM.ed.BSbufB("uP"_$G(%BS(3),$P)_$J_"u")),BUF,0,1) S @BUF=@%BS(20)@("TextEdit"),$P(@BUF,"@")="Для "_$G(date)_" от "_$$ZU^%ZAPM.ed.BS3(1,0)_" "_$$ESDAY^%ZAPM.ed.BSsFUNR(9,$$h^%ZAPM.ed.BS3())
 Q
XXX D E("У ПРИНТ-СЕРВЕРА ЧТО-ТО ПЕЧАТЬЮ") G EX
CN(UStro) N Z D Wait^%ZAPM.ed.BSXfun("КОНТРОЛЬ СЕРВЕРА")
 D S("O",""),S("C","?")
 F Z=1:1 Q:$$U("O")="?"  H 1 X WA I Z=$$PAR^%ZAPM.ed.BSprint(3) D Yes^%ZAPM.ed.BSXfun("МНЕ КАЖЕТСЯ, ЧТО СЕРВЕР ПОМЕР...ПОХОРОНИМ ?") G:YES<1 CNN D EXIT^%ZAPM.ed.BSprint G CNN
 D S("O",""),OkMsg^%ZAPM.ed.BSXfun("СЕРВЕР ЕЩЕ ЖИВОЙ, ЗАГАСИТЬ ЕГО МОЖЕТЕ КОМАНДОЙ 'D'")
CNN Q 1
JOBSR(UStro) ;ЗАПУСК СЕРВЕРА
 X "J ^%ZAPM.ed.BSprint(UStro)["""_$$TR^%ZAPM.ed.BSsFUNM($$PR(19),",",""",""")_"""]:$$PAR^%ZAPM.ed.BSprint(6):1" E  D E("ПРИНТ-СЕРВЕР НЕ ХОЧЕТ ЗАПУСКАТЬСЯ...неполадки с мотором, наверное") Q 0
 D S("O",""),S("C",$$ZU^%ZAPM.ed.BS3(1,0)_"u"_$G(%BS(3),$P))
 Q 1
STOP ;
 Q
 ;US,UO -УСТРОЙСТВО
 ;UStro -ССЫЛКА
 ;ExZ - КОЛ-ВО ЭКЗЕМПЛЯРОВ
S(U,S) S @UStro@(U)=S Q
U(U) Q $G(@UStro@(U))
E(E) D ErrMsg^%ZAPM.ed.BSXfun(E) Q
INIT(UO) ;ПЕРЕОПРЕДЕЛЕНИЕ US
 U 0 N B,BUF,uK,uL,oT,rP,uS,uE
 S ExZ=1 I +UO S ExZ=+UO
 S %zT=$ZT,$ZT="ERR^%ZAPM.ed.BSJPRN"
 S B=$$KBD^%ZAPM.ed.BSF12("^%ZAPM.ed.BSJPRN(""PRN"")")
 I $$9'=0,B'="",$O(@B@(""))'="" G CHOISE
DF S US=$$DFLT
DF1 Q 1
9() Q $E(%BS(1),9)
CHOISE ;ВЫБОР ПРИНТЕРА
 D SA^%ZAPM.ed.BSsBUF
 S IYI="PRN,%BSJPRN,,,<>" D ENTER^%ZAPM.ed.BSN D RE^%ZAPM.ed.BSsBUF I date="" Q 0
 S UStro=$NA(@B@(date)) I $$9=1,$$PR(19)=$$ZU^%ZAPM.ed.BS3(1,0) S US=$$PR(17) G DF1
 I $$START Q 0
 D Yes^%ZAPM.ed.BSXfun("Может будем использовать ЛОКАЛЬНЫЙ принтер БЕЗ ПРИНТ-СЕРВЕРА",1) I YES>0 G DF
 Q 0
ERR S US=$$DFLT W $$bel^%ZAPM.ed.BS3 S $ZT=$G(%zT) G DF
PR(P) I UStro["PRNDFLT" Q $P($G(^%ZAPM.ed.BSETUP("PRNDFLT",P,2),@%BS(20)@("PRNDFLT",P,2)),"@",15)
 Q $G(@UStro@((P_",2")))
DFLT() I $D(^%ZAPM.ed.BSETUP("PRNDFLT")) S UStro=$NA(^%ZAPM.ed.BSETUP("PRNDFLT"))
 E  S UStro=$NA(@%BS(20)@("PRNDFLT"))
 Q $$PR(17)
MAX(UO) I UO=2 Q $J //ДЛЯ КАШИ!!!
 Q $S('$$PR(18):255,1:$$PR(18))
SBROS(UO) ;Сброс параметров
 Q $C($$PR(15))
CTRL(S,UO) ;УПРАВЛЕНИЕ ПРИНТЕРОМ
 I S["@" S S=$TR(S,"@","#")
 I S["27," Q S
 F I=1:1:3 S II=$P($P(S,"#",I),",") I II'="" S $P(S,"#",I)=$$PR(II)
 Q S
COM ;КОМАНДА СЕРВЕРУ
 S IYI="^%ZAPM.ed.BSJPRN,PCMD" D NE^%ZAPM.ed.BSN I date="" G CO
 N E
 I $E(date,1)="E" D  G CO
 .I $G(@%BS("Tmp","BSD")@("D"))=2 S E=$$LineEdit^%ZAPM.ed.BSXfun($G(@%BS("Tmp","BSD")@("EXE"))) I YES>0,E S @%BS("Tmp","BSD")@("EXE")=E Q
 .W $$bel^%ZAPM.ed.BS3
 I $E(date,1)="?" D  G CO
 .I $$CN(%BS("Tmp","BSD"))
 I $E(date,1)="A" D  G CO
 .I '$G(@%BS("Tmp","BSD")@("A")),$$JOBSR(%BS("Tmp","BSD")) Q
 .W $$bel^%ZAPM.ed.BS3
 I $E(date,1)'="" S @%BS("Tmp","BSD")@("C")=$E(date,1) G CO
 Q
CO S R1=-1 Q
TRAN ;ПЕРЕРИСОВКА КЛЕТОК
 S do="I $P(@$ZR,""@"",8)'="""",$P(@$ZR,""@"",9)'=1 D W^%ZAPM.ed.BSTM" D 66^%ZAPM.ed.BSF3
 Q
TRANS ;
 Q:R1>332
 I %BS(2)'["^" S %BS(2,1)=%BS(2),%BS(2)="2-D TRAN^%ZAPM.ed.BSJPRN" S R1=-1 Q
 ;I R1=13,R2=-1,R3=-1 D UNDO Q
 I R1=27,R2=-1,R3=-1 D UNDO Q
 Q
UNDO I %BS(2)["^" S %BS(2)=%BS(2,1) K %BS(2,1)
 I %BS(2)["^" D CLr^%ZAPM.ed.BSF4
 Q
ERASER(Y) N I ;ЧИСТИЛЬЩИК
 I '$G(Y) Q:$P($G(^%ZAPM.ed.BSETUP("PARPRN",7,2)),"@",15)'="Y"  Q:$O(^%ZAPM.ed.BSbufP(""))=""
ERA S I="" F  S I=$O(^%ZAPM.ed.BSbufP(I)) Q:I=""  D L^%ZAPM.ed.BS3($NA(^%ZAPM.ed.BSbufP(I)),1) D  D U^%ZAPM.ed.BS3($NA(^%ZAPM.ed.BSbufP(I)))
 .I 'LOC,$G(Y) K ^%ZAPM.ed.BSbufP(I) Q
 .I LOC K ^%ZAPM.ed.BSbufP(I)
 Q
CHEKPRN N B,S,UStro,SS ;ПРОВЕРКА АКТИВНЫХ СЕРВЕРОВ
 S %zT=$ZT,$ZT="ERB^%ZAPM.ed.BSJPRN"
 S B=$$KBD^%ZAPM.ed.BSF12("^%ZAPM.ed.BSJPRN(""PRN"")") I $$9'=0,B'="",$D(@B) D
 .S S="",SS="" F  S S=$O(@B@(S)) Q:S=""  S UStro=$NA(@B@(S)) I $$PR(19)=$$ZU^%ZAPM.ed.BS3(1,0),$$U("A") S SS=SS_S_","
 S YES=1 I $G(SS)'="" D Yes^%ZAPM.ed.BSXfun("В СИСТЕМЕ АКТИВНЫ ПРИНТ-СЕРВЕРА:"_SS_",ПРЕРЫВАЕМ ИХ ?",2) I YES D
 .S S="" F  S S=$O(@B@(S)) Q:S=""  S UStro=$NA(@B@(S)) I $$PR(19)=$$ZU^%ZAPM.ed.BS3(1,0),$$U("A") D EXIT^%ZAPM.ed.BSprint
 Q
ERB D BEL^%ZAPM.ed.BSprint S $ZT=$G(%zT) Q
BEGINER N B,S ;НАЧАЛО
 Q:$P($G(^%ZAPM.ed.BSETUP("PARPRN",2,2)),"@",15)=""  S S=$P($G(^%ZAPM.ed.BSETUP("PARPRN",2,2)),"@",15)
 S %zT=$ZT,$ZT="ERB^%ZAPM.ed.BSJPRN"
 S B=$$KBD^%ZAPM.ed.BSF12("^%ZAPM.ed.BSJPRN(""PRN"")") I $$9'=0,B'="",$D(@B@(S)) S S=$NA(@B@(S)) D  Q
 .I '$G(@S@("A")),$$JOBSR(S) Q
 Q
]]></Routine>


<Routine name="%ZAPM.ed.BSLOG" type="MAC" languagemode="0"><![CDATA[
%BSLOG ; пpогpамма ЛОГИЧЕСКОГО КОНТРОЛЯ ; 14:02   14.09.99
 Q
MUK ;МЕЖУРОВНЕВЫЙ КОНТРОЛЬ
 S MUse=se
 I ny<3 G D
 I 'key D ErrMsg^%ZAPM.ed.BSXfun("НА НУЛЕВОМ УРОВЕНЕ КОНТРОЛЬ НЕ ПРОИЗВОДИТСЯ") G D
 D TempT^%ZAPM.ed.BSTT ;ПОДГОТОВКА НОВОГО ОТЧЕТА
 K MU,MUNO,MUBD,MUER
 S MUER=0 D Wait^%ZAPM.ed.BSXfun("МЕЖУРОВНЕВЫЙ КОНТРОЛЬ")
 I '$G(%DIA) D MUKL(d) G:$D(MUNO) MUKILL G MUEND
 S do="S d=$P(^(j),""@"",15) D MUKL^%ZAPM.ed.BSLOG(d)" D BLOK^%ZAPM.ed.BSF1 I $D(MUNO) G MUKILL
 D UNMARK^%ZAPM.ed.BSF11($NA(@BSR@(BST))) K %DIA D W^%ZAPM.ed.BST
MUEND ;ЗАВЕРШЕНИЕ ОТЧЕТА
 I 'MUER D TempTX^%ZAPM.ed.BSTT("КОНТРОЛЬ ПРОШЕЛ УСПЕШНО"),TempTX^%ZAPM.ed.BSTT("")
 G:$D(MUNO)!('$D(@BSr@(BSt,2))) MUKILL
 D TempTXT^%ZAPM.ed.BSTT("ОТЧЕТ МЕЖУРОВНЕВОГО КОНТРОЛЯ",$G(@%BS(20)@("TextEdit")))
 D TempTXTE^%ZAPM.ed.BSTT ;ВХОД В ТЕКСТ
MUKILL K @BSr@(BSt) ;УДАЛЕНИЕ ОТЧЕТА
D S se=MUse
 K KILLER,MU,MUse,MUNO,MUBD,LB,F,ERTX G 0^%ZAPM.ed.BSTM
MUKL(d) N i,Tmp
 Q:d=""  I '$D(%KEYS) S Tmp=BSD_d
 E  S Tmp=BSD_$G(%KEYS(0))
 I key D
 .F i=1:1:key I $D(%KEYS(i)) S Tmp=$NA(@Tmp@(%KEYS(i)))
 .S Tmp=$NA(@Tmp@(d))
 D MU(Tmp,$NA(@Bsr@(Bst)),key)
 Q
MU(B,BSG,U) ;САМ КОНТРОЛЬ
 N er S er=$$CHECK(BSG) I 'er D:'$D(MUNO) ErrMsg^%ZAPM.ed.BSXfun("ДЛЯ "_BSG_" НЕ ОПИСАНЫ ФОРМУЛЫ МЕЖУРОВНЕГО КОНТРОЛЯ В "_$G(MUBD)_". Ошибка:"_er) S MUNO=1 Q
 S %zT=$ZT,$ZT="ERMU^%ZAPM.ed.BSLOG"
 N k0,k1,k2,k3,k4,k5,k6,k7,k8,k9
 F I1=0:1 Q:'$D(%KEYS(I1))  S @("k"_I1)=%KEYS(I1)
 S I1="",ER=0 F  S I1=$O(MU(BSG,I1)) Q:I1=""  D
 .I I1<U S I2="" D  Q
 ..F  S I2=$O(MU(BSG,I1,I2)) Q:I2=""  D TempTX^%ZAPM.ed.BSTT("ФОРМУЛА МЕЖУРОВНЕГО КОНТРОЛЯ: "_MU(BSG,I1,I2,1)),TempTX^%ZAPM.ed.BSTT(" , ПРЕДНАЗНАЧЕННАЯ ДЛЯ РАБОЫ НА "_I1_" УРОВНЕ, НЕ БУДЕТ ИСПОЛЬЗОВАНА."),TempTX^%ZAPM.ed.BSTT("  ДЛЯ ВКЛЮЧЕНИЯ ЕЕ В РАБОТУ ПЕРЕЙДИТЕ НА "_I1_" УРОВЕНЬ"),TempTX^%ZAPM.ed.BSTT(""),E
 .I I1=U S I2="" D  Q
 ..F  S I2=$O(MU(BSG,I1,I2)) Q:I2=""  X MU(BSG,I1,I2,1) E  D TempTX^%ZAPM.ed.BSTT("НА УЗЛЕ "_B_" ОШИБКА !!! ФОРМУЛА :"_MU(BSG,I1,I2,1)),TempTX^%ZAPM.ed.BSTT(MU(BSG,I1,I2,2)),ERTX,TempTX^%ZAPM.ed.BSTT(""),E
 .I (I1-U)=1 S I4="",BB=B D  Q  ;ТОЛЬКО НА УРОВЕНЬ ВЫШЕ
 ..F  S I4=$O(@BB@(I4)) Q:I4=""  I I4'["@" S B=$NA(@BB@(I4)) D
 ...S I2="" F  S I2=$O(MU(BSG,I1,I2)) Q:I2=""  X MU(BSG,I1,I2,1) E  D TempTX^%ZAPM.ed.BSTT("НА УЗЛЕ "_B_" ОШИБКА !!! ФОРМУЛА :"_MU(BSG,I1,I2,1)),TempTX^%ZAPM.ed.BSTT(MU(BSG,I1,I2,2)),ERTX,TempTX^%ZAPM.ed.BSTT(""),E
 .I (I1-U)>1 S I2="" D  Q
 ..F  S I2=$O(MU(BSG,I1,I2)) Q:I2=""  D TempTX^%ZAPM.ed.BSTT("ФОРМУЛА МЕЖУРОВНЕГО КОНТРОЛЯ: "_MU(BSG,I1,I2,1)),TempTX^%ZAPM.ed.BSTT(" , ПРЕДНАЗНАЧЕННАЯ ДЛЯ РАБОЫ НА "_I1_" УРОВНЕ, НЕ БУДЕТ ИСПОЛЬЗОВАНА."),TempTX^%ZAPM.ed.BSTT("  ДЛЯ ВКЛЮЧЕНИЯ ЕЕ В РАБОТУ ПЕРЕЙДИТЕ НА "_I1_" УРОВЕНЬ"),TempTX^%ZAPM.ed.BSTT(""),E
 Q
GTX N EK,ERT,I,F,J,S,O ;ТЕКСТ ЗНАЧЕНИЙ У ГРУПП
 S F=$P(GTX,"@"),O=$P(GTX,"@",2),S=$P(GTX,"@",3),GTX(-1)="",GTX(-3)="",GTX(-4)=""
 F J=1:1 Q:$P(GTX(-2),"@",J,J+1)=""  D
 .S I="" F  S I=$O(GTX(I)) Q:I=""  I '(I=-3!(I=-1)!(I=-2)!(I=-4)) D
 ..I F=",ALL," D  Q
 ...I S[(","_I_",") S $P(GTX(-4),"@",J)=$P(GTX(-4),"@",J)+$P(GTX(I),"@",J) Q
 ...S $P(GTX(-1),"@",J)=$P(GTX(-1),"@",J)+$P(GTX(I),"@",J) Q
 ..I S=",ALL," D  Q
 ...I F[(","_I_",") S $P(GTX(-1),"@",J)=$P(GTX(-1),"@",J)+$P(GTX(I),"@",J) Q
 ...S $P(GTX(-4),"@",J)=$P(GTX(-4),"@",J)+$P(GTX(I),"@",J) Q
 ..I F[(","_I_",") S $P(GTX(-1),"@",J)=$P(GTX(-1),"@",J)+$P(GTX(I),"@",J) Q
 ..I S[(","_I_",") S $P(GTX(-4),"@",J)=$P(GTX(-4),"@",J)+$P(GTX(I),"@",J) Q
 .Q:'$D(GTX(-1))!('$D(GTX(-4)))
 .I $P(GTX(-3),"@",J)<$L($P(GTX(-1),"@",J)) S $P(GTX(-3),"@",J)=$L($P(GTX(-1),"@",J))
 .I $P(GTX(-3),"@",J)<$L($P(GTX(-2),"@",J)) S $P(GTX(-3),"@",J)=$L($P(GTX(-2),"@",J))
 .I $P(GTX(-3),"@",J)<$L($P(GTX(-4),"@",J)) S $P(GTX(-3),"@",J)=$L($P(GTX(-4),"@",J))
 F J=1:1 Q:$P(GTX(-2),"@",J,J+1)=""  D
 .S I="" F  S I=$O(GTX(I)) Q:I=""  I I'=-3 D
 ..I '$D(ERT(I)) S ERT(I)=$S(I=-1:"(1 СУМ) |",I=-4:"(2 СУМ) |",I=-2:"  КОДЫ  |",1:$J(I,7)_" |")
 ..S ERT(I)=ERT(I)_$J($P(GTX(I),"@",J),$P(GTX(-3),"@",J)+1)
 D ERT,TempTX^%ZAPM.ed.BSTT(ERT(-2)),ERT
 S I="" F  S I=$O(ERT(I)) Q:I=""  I '(I=-3!(I=-1)!(I=-2)!(I=-4)) D
 .I F=",ALL," D  Q
 ..I S'[(","_I_",") D TempTX^%ZAPM.ed.BSTT(ERT(I))
 .I F[(","_I_",") D TempTX^%ZAPM.ed.BSTT(ERT(I))
 D TempTX^%ZAPM.ed.BSTT($TR(ERT(-1)," ","_")),TempTX^%ZAPM.ed.BSTT($TR(ERT(-4)," ","_"))
 S I="" F  S I=$O(ERT(I)) Q:I=""  I '(I=-3!(I=-1)!(I=-2)!(I=-4)) D
 .I S=",ALL," D  Q
 ..I F'[(","_I_",") D TempTX^%ZAPM.ed.BSTT(ERT(I))
 .I S[(","_I_",") D TempTX^%ZAPM.ed.BSTT(ERT(I))
 D ERT K GTX Q
E S MUER=MUER+1 Q
ERTX G:$D(GTX) GTX Q:'$D(ERTX)  N ERT,I,K,J ;ТЕКСТ ЗНАЧЕНИЙ
 S K=ERTX(-1),ERTX(-1)="",ERTX(-3)="" Q:'$D(ERTX(K))
 F J=1:1 Q:$P(ERTX(-2),"@",J,J+1)=""  D
 .S I="" F  S I=$O(ERTX(I)) Q:I=""  I '(I=-3!(I=-1)!(I=-2)) D
 ..I I'=K S $P(ERTX(-1),"@",J)=$P(ERTX(-1),"@",J)+$P(ERTX(I),"@",J) Q
 .I $P(ERTX(-3),"@",J)<$L($P(ERTX(-1),"@",J)) S $P(ERTX(-3),"@",J)=$L($P(ERTX(-1),"@",J))
 .I $P(ERTX(-3),"@",J)<$L($P(ERTX(-2),"@",J)) S $P(ERTX(-3),"@",J)=$L($P(ERTX(-2),"@",J))
 .I $P(ERTX(-3),"@",J)<$L($P(ERTX(K),"@",J)) S $P(ERTX(-3),"@",J)=$L($P(ERTX(K),"@",J))
 F J=1:1 Q:$P(ERTX(-2),"@",J,J+1)=""  D
 .S I="" F  S I=$O(ERTX(I)) Q:I=""  I I'=-3 D
 ..I '$D(ERT(I)) S ERT(I)=$S(I=-1:"  (СУМ) |",I=-2:"  КОДЫ  |",1:$J(I,7)_" |")
 ..S ERT(I)=ERT(I)_$J($P(ERTX(I),"@",J),$P(ERTX(-3),"@",J)+1)
 D ERT,TempTX^%ZAPM.ed.BSTT(ERT(-2)),ERT,TempTX^%ZAPM.ed.BSTT(ERT(K)),TempTX^%ZAPM.ed.BSTT($TR(ERT(-1)," ","_"))
 S I="" F  S I=$O(ERT(I)) Q:I=""  I '(I=-3!(I=-1)!(I=-2)!(I=K)) D TempTX^%ZAPM.ed.BSTT(ERT(I))
 D ERT K ERTX Q
ERT D TempTX^%ZAPM.ed.BSTT($TR($J("",$L(ERT(-2)))," ","-")) Q
ERMU I $ZE["LINER" D ErrMsg^%ZAPM.ed.BSXfun(" НЕПРАВИЛЬНАЯ ФУНКЦИЯ КОНТРОЛЯ В ФОРМУЛЕ "_I2_" !") S $ZT=$G(%zT) Q
 I $ZE["<ZOPER" D ErrMsg^%ZAPM.ed.BSXfun(" НЕПРАВИЛЬНАЯ АРИФМЕТИЧЕСКАЯ ОПЕРАЦИЯ В ФОРМУЛЕ "_I2_" !") S $ZT=$G(%zT) Q
 I $ZE["<ZFEST" D ErrMsg^%ZAPM.ed.BSXfun(" НЕПРАВИЛЬНЫЕ ПАРАМЕТРЫ В ФОРМУЛЕ "_I2_" !") S $ZT=$G(%zT) Q
 D ErrMsg^%ZAPM.ed.BSXfun("ОШИБКА В ФОРМУЛЕ "_I2_" !!! "_$ZE_" "_$$ErrSay^%ZAPM.ed.BSF8($ZE)) S $ZT=$G(%zT) Q
CHECK(BSG) ;ПРОВЕРКА СООТВЕТСТВИЯ ТОБД И ДДР
 N BD,I1,I2,I3
 Q:$D(MU(BSG)) 1 S (MUBD,BD)=$$Bd^%ZAPM.ed.BSMDDR1 I BD="" Q 0
 I '$D(@BD@("@S")) D SETINDX
 I $D(@BD@("@S",BSG)) S I1=$P(@BD@("@S",BSG),"§") Q:I1="" "I1"
 I '$D(@BD@("@S",BSG)) D  Q:I1="" "I10"_BD_BSG
 .S I1="" F  S I1=$O(@BD@(I1)) Q:I1=""  I $G(@BD@(I1,"^","S"))'="",@BD@(I1,"^","S")=BSG S @BD@("@S",BSG)=I1_"§"_"^§S" Q
 Q:'$D(@BD@(I1)) "BDI1" S I2="" F  S I2=$O(@BD@(I1,I2)) Q:I2=""  I $E(I2)="K",$G(@BD@(I1,I2,"KE")) S I3=@$ZR D
 .S MU(BSG,I3,I2,1)=$G(@BD@(I1,I2,"FO")),MU(BSG,I3,I2,2)=$G(@BD@(I1,I2,"TX"))
 S F=I1 I '$$LBD^%ZAPM.ed.BSMDDR1($NA(@BD@(I1)),"1") Q "LBD"
 I $D(MU(BSG)) Q 1
 Q "?0"
SETINDX ;ИНДЕКСИРОВАНИЕ БАЗЫ ДАННЫХ
 S I1="" F  S I1=$O(@BD@(I1)) Q:I1=""  I $G(@BD@(I1,"^","S"))'="" S @BD@("@S",@BD@(I1,"^","S"))=I1_"§"_"^§S"
 Q
GROUP(FI,O,S,EK,EP) ;СУММА КОДОВ ГРУППЫ F ПО ВСЕМ ПОКАЗАТЕЛЯМ
             ;ДОЛЖНА БЫТЬ O (O-АРИФМЕТИЧЕСКАЯ ОПЕРАЦИЯ) ПО ОТНОШЕНИЮ К СУММЕ
             ;ГРУППЫ S ПО ВСЕМ ПОКАЗАТЕЛЯМ, КРОМЕ EK КОДОВ И EP ПОКАЗАТЕЛЕЙ
 N I,II,III,QQ,I1 X $G(WA)
 K GTX S FI=","_$G(FI)_",",S=","_$G(S)_"," I FI=",,"!(S=",,") ZT "FEST"
 I FI=",ALL,"&(S=",ALL,") ZT "FEST"
 I O=""!(O'?.P) ZT "OPER"
 S GTX=FI_"@"_O_"@"_S
 S I1="",QQ=0 F  S I1=$O(LB(F,"I",I1)) Q:I1=""  I $P(LB(F,"I",I1),"@",2)'="" D
 .I $G(EP)'="",(","_EP_",")[(","_I1_",") Q
 .S QQ=QQ+'$$GROU($P(LB(F,"I",I1),"@",2),+I1),$P(GTX(-2),"@",+I1)=I1
 Q 'QQ
GROU(P,P1) S I="",II=0,III=0 F  S I=$O(@B@(I)) Q:I=""  D
 .I $G(EK)'="",(","_EK_",")[(","_I_",") Q
 .I FI=",ALL," D  Q
 ..I S[(","_I_",") S III=III+$G(@B@(I,P)),$P(GTX(I),"@",P1)=$G(@B@(I,P)) Q
 ..S II=II+$G(@B@(I,P)),$P(GTX(I),"@",P1)=$G(@B@(I,P)) Q
 .I S=",ALL," D  Q
 ..I FI[(","_I_",") S II=II+$G(@B@(I,P)),$P(GTX(I),"@",P1)=$G(@B@(I,P)) Q
 ..S III=III+$G(@B@(I,P)),$P(GTX(I),"@",P1)=$G(@B@(I,P)) Q
 .I FI[(","_I_",") S II=II+$G(@B@(I,P)),$P(GTX(I),"@",P1)=$G(@B@(I,P)) Q
 .I S[(","_I_",") S III=III+$G(@B@(I,P)),$P(GTX(I),"@",P1)=$G(@B@(I,P)) Q
 X "I II"_O_"III" Q $T
SumKP(K,P) ;СУММА КОДОВ КРОМЕ К ПО ПОКАЗАТЕЛЮ P РАВНА КОДУ К ПО ПОКАЗАТЕЛЮ P
           ;ЕСЛИ P="" ТО ПОВСЕМ ПОКАЗАТЕЛЯМ
 N I,II,III,QQ,I1 X $G(WA) K ERTX S ERTX(-1)=K
 I '$D(P) D  Q 'QQ
 .S I1="",QQ=0 F  S I1=$O(LB(F,"I",I1)) Q:I1=""  I $P(LB(F,"I",I1),"@",2)'="" S QQ=QQ+'$$Sum($P(LB(F,"I",I1),"@",2),+I1),$P(ERTX(-2),"@",+I1)=I1
 I $P(LB(F,"I",P),"@",2)'="" D  I $$Sum($P(LB(F,"I",P),"@",2),+P) Q 1
 .S $P(ERTX(-2),"@",+P)=P
 Q 0
Sum(P,P1) S I="",II=0,III=0 F  S I=$O(@B@(I)) Q:I=""  D
 .I I'=K S II=II+$G(@B@(I,P)),$P(ERTX(I),"@",P1)=$G(@B@(I,P)) Q
 .I I=K S III=+$G(@B@(I,P)),$P(ERTX(I),"@",P1)=$G(@B@(I,P)) Q
 I II=III Q 1
 Q 0
YesKod(K) ;ЕСТЬ ЛИ КОД ?
 X $G(WA)
 I $D(@B@(K)) Q 1
 Q 0
OnlyKod(K) ;ПРЕДСТАВЛЕН ТОЛКО ОДИН КОД
 N I,II,III X $G(WA)
 S I="" F  S I=$O(@B@(I)) Q:I=""  D
 .I I'=K S II=I Q
 .I I=K S III=K
 I $D(II) Q 0
 I $D(III) Q 1
 Q 0
KP(K,P) ;ДАННЫЕ КОДА И ПОКАЗАТЕЛЯ
 X $G(WA) I P'="" D  Q P
 .I $P(LB(F,"I",P),"@",2)'="" S P=$P(LB(F,"I",P),"@",2),P=$G(@B@(K,P)) Q
 .S P=""
 Q ""
LER D ErrMsg^%ZAPM.ed.BSXfun($ZE_" "_$$ErrSay^%ZAPM.ed.BSF8($ZE)) S $ZT=$G(%zT) Q
LOGS ;СПИСОК ЛОГИЧЕСКИХ ОШИБОК
 N lO,lOg,NoKiTab,s1,s2,s3,s4,ny,nx,i3,i4,t1,t2,t0,i,ii,i1,i2,iii,Obraz
 S s1=se,s2=ke,s3=BSR,s4=BST S %zT=$ZT,$ZT="LER^%ZAPM.ed.BSLOG"
L S ny="",t0="/// Лог.Ошибки для:"_BSR_"("_BST_") "
 S BSr="^%ZAPM.ed.BSbufB",BSt="LOGS"_$G(%BS(3),$P)_$J_$P($$ZU^%ZAPM.ed.BS3(1,0),",",2)_"u1" S:$D(uzel) NoKiTab=1 D CR^%ZAPM.ed.BSTT I $D(uzel) S t0=" //"_$G(uzel) D CR^%ZAPM.ed.BSTT
 F  S ny=$O(@(BSR_"(BST,ny)"))  Q:'ny  S nx="" F  S nx=$O(@(BSR_"(BST,ny,nx)"))  Q:nx=""  I $P(@(BSR_"(BST,ny,nx)"),"@",11),$P(@$ZR,"@",3) D
 .S i3=ny,i4=nx
 .I $P(@$ZR,"@",13)?.N1",".N S i3=+$P($P(@$ZR,"@",13),","),i4=+$P($P(@$ZR,"@",13),",",2)
 .S t1="{"_ny_","_nx_"} ",t2=$G(@(BSR_"(BST,""COL"",i3,i4,1)")) I $D(^(2)) S t2=@$ZR
 .I $D(@BSR@(BST,"COL",ny,nx,2)) S t2=@$ZR
 .S t2=$$TR^%ZAPM.ed.BSsFUNM(t2,"ny",ny)
 .S t2=$$TR^%ZAPM.ed.BSsFUNM(t2,"nx",nx) D:+$P(B,"@",35)  S:t2="" t2=" ИСХОДНЫЕ ТЕКСТЫ ФОРМУЛ ОТСУТСТВУЮТ !!!" S t0=t1_"--> "_t2 D CR^%ZAPM.ed.BSTT
 ..S lOg=$S($P(B,"@",35)=1:"9#2",1:$P(B,"@",35)),lOg=$P(lOg,"#",2)
 ..S t1="" F lO=1:1 Q:+$P(lOg,",",lO)=0  S t1=t1_$$A^%ZAPM.ed.BSA(ny,+$P(lOg,",",lO))_" "
 ..F iii=2:1 Q:$P(t2,"{",iii)=""  S ii=$P($P(t2,"{",iii),"}") D  I ii?.N1",".N,$D(@(BSR_"(BST,"_ii_")")),$P($P(@$ZR,"@",18),"#",2)'="" S t2=$P(t2,"{",1,iii-1)_"{§"_$P($P(@$ZR,"@",18),"#",2)_"§}"_$P($P(t2,"{",iii,9999),"}",2,9999)
 ...X "S i1="_$P(ii,","),"S i2="_$P(ii,",",2) S ii=i1_","_i2
 ..S t2=" "_$$TR^%ZAPM.ed.BSsFUNM($$TR^%ZAPM.ed.BSsFUNM(t2,"{§","["),"§}","]")
 .Q:'$E($P(B,"@",48),1)  S t0=" ----> "_$G(^%ZAPM.ed.BSbufB("VarLogS"_$G(%BS(3),$P)_$J_"u1",$NA(@BSR@(BST,ny,nx))),"???") D CR^%ZAPM.ed.BSTT
 S Obraz=@%BS(20)@("TextEdit"),Obraz(1)="Логические ошибки" D CREAT^%ZAPM.ed.BSTT
 S IYI=BSr_","_BSt,BSR=s3,BST=s4,se=s1,ke=s2 Q:$D(uzel)
 D NE^%ZAPM.ed.BSN
 Q
PROK //ПРОКАЧАТЬ ДЛЯ КАШИ
 S I="",G="^DDRm(""@S"")" F  S I=$O(@G@(I)) Q:I=""  D
 .S II=$P($P(I,"[",2),"]"),I1=$$TR^%ZAPM.ed.BSsFUNM(I,II,"""GLAVK"",""""")
 .S @G@(I1)=@G@(I) K @G@(I)
 .W !,I," - ",I1
 Q       
]]></Routine>


<Routine name="%ZAPM.ed.BSMDDR" type="MAC" languagemode="0"><![CDATA[
%BSMDDR ; НОВЫЙ DDR ; 10:58   28.11.1999
 Q
Z ;ЗАКАЧКА ИЗ БАЗЫ СТАРОГО ТИМОФЕЕВСКОГО ddRА В НОВЫЙ МОЙ
 ;N BD,BDN,I,II,III,F,S,K,P,W
 ;S BD=$$KBD^%ZAPM.ed.BSF12("^%ZAPM.ed.BSDDR(""DDR"")") I '$$Data^%ZAPM.ed.BSF12(BD) W $$bel^%ZAPM.ed.BS3 Q
 ;S BDN=$$KBD^%ZAPM.ed.BSF12("^%ZAPM.ed.BSMDDR(""DDR"")") I '$$Data^%ZAPM.ed.BSF12(BDN) W $$bel^%ZAPM.ed.BS3 Q
 ;S I="" F  S I=$O(@BD@(I)) Q:I=""  S F=@BD@(I,"3,4") I F'="" D
 ;.I $G(@BD@(I,"5,4"))="" Q
 ;.I $G(@BD@(I,"4,4"))="" Q
 ;.S S=$P(@BD@(I,"5,4"),",",2),S=$S(S=+S:S,1:$C(34)_S_$C(34)),S="^"_@BD@(I,"4,4")_$P(@BD@(I,"5,4"),",")_"("_S_")"
 ;.S P=$G(@BD@(I,"18,4")),W=$G(@BD@(I,"19,4")),K=$G(@BD@(I,"23,4")),PI="ПКЗ,ГРП,СУМ,"
 ;.F II="K","S","P","W","PI" I @II'="" S @BDN@(F,"^",II)=@II
 ;.F II=7:1:16 I $D(@BD@(I,II_",4")) S @BDN@(F,II-7,"F")=$P(@BD@(I,II_",4"),"#") I @BD@(I,II_",4")["#" S @BDN@(F,II-7,"M")="Y"
 Q
ZZ ;ПРОКАЧКА БАЗЫ НОВОГО DDR ДАТЫ ПРИВЕДЕНИЯ
 ;N BD,BDN,I,II,III,F,S,K,P,W
 ;S BDN=$$KBD^%ZAPM.ed.BSF12("^%ZAPM.ed.BSMDDR(""DDR"")") I '$$Data^%ZAPM.ed.BSF12(BDN) W $$bel^%ZAPM.ed.BS3 Q
 ;S I="" F  S I=$O(@BDN@(I)) Q:I=""  D
 ;.I $D(@BDN@(I,0,"F")),@$ZR="$E({""ДАТ""},5,6)" S @$ZR="$E($$DatGuKBB({""ДАТ""}),1,2)"
 ;.I $D(@BDN@(I,1,"F")),@$ZR="$E({""ДАТ""},5,6)_$E({""ДАТ""},3,4)_$E({""ДАТ""},1,2)" S @$ZR="$$DatGuKBB({""ДАТ""})"
 Q
OTKAT ;УДАЛЕНИЕ УЗЛОВ БД РАНЕЕ ЗАНЕСЕННЫХ
 D 333^%ZAPM.ed.BSF
 N BD,LB,zzRrLast,PR
 S BD=$$Bd^%ZAPM.ed.BSMDDR1 Q:BD=""
 D CTRL^%ZAPM.ed.BSMDDR1(BSD,%KEYS(1),%KEYS(2),BD,1,"KILL")
 S ^%ZAPM.ed.BSbufB("BB"_$G(%BS(3),$P)_$J_"u"_%BS(15),2,1)=@zzRrLast
 D TW^%ZAPM.ed.BST,KLE^%ZAPM.ed.BSTM
 Q
]]></Routine>


<Routine name="%ZAPM.ed.BSMDDR0" type="MAC" languagemode="0"><![CDATA[
%BSMDDR0() ; пpогpамма ДЛЯ ТРАНСФОРМАЦИИ ОШИБОЧЕК ; 12:03  6-JAN-98
 N I,ZR W /CUP(11,1),$$atr^%ZAPM.ed.BS3(0) F I=1:1:12 W /EL(0),!
 I $D(@%BS("Tmp","BSD")@(ny)) S ZR=$ZR W $$clr^%ZAPM.ed.BS3(11),/CUP(11,1) D  W $$atr^%ZAPM.ed.BS3(0)
 .F I=1:1:12 W /EL(0),!
 .W /CUP(11,1) F I=1:1 Q:'$D(@ZR@(I))  W @$ZR,! Q:$Y>23
 Q d1
]]></Routine>


<Routine name="%ZAPM.ed.BSMDDR1" type="MAC" languagemode="0"><![CDATA[
%BSMDDR1 ;ДИСПЕТЧЕР ВВОДА ДАННЫХ (НОВЫЙ РЕЛИЗ); 18:24  7-APR-97 ; 17:34   20.06.2001
 Q
VVOD ;СЧИТЫВАНИЕ DOS-ФАЙЛА
 K %BS("Tmp","DosFiles")
int N S,TM,%IN,BP,BD,N,D,F,FN,%FN,%DEV,XN,LB,zzRrLast,S1,S2,T,TmpND,NEWFORMAT
 S TM=$$TMPG^%ZAPM.ed.BSF11 D REST(TM) D USE0 Q:'$D(%FN)
 S BD=$$Bd Q:BD=""
 S BP=$$KBD^%ZAPM.ed.BSF12("^%ZAPM.ed.BSMDDR(""BPO"")") I '$$Data^%ZAPM.ed.BSF12(BP) S @BP="восстановил "_$H ; D ErrMsg^%ZAPM.ed.BSXfun("Буфер "_BP_" не Доступен") Q
 S FN="" F  S FN=$O(@TM@(FN)) Q:FN=""  S N=@TM@(FN),F=$P(FN,"\",$L(FN,"\")) D
 .I '$D(GuiCall) I $D(@BP@("@HFS",N)) D Yes^%ZAPM.ed.BSXfun("ИЗ `"_$P(N,"?",3)_"` ДОКУМЕНТЫ УЖЕ ВВОДИЛ "_$$ESDAY^%ZAPM.ed.BSsFUNR(9,$P(@$ZR,"?",1))_" :"_$P(@$ZR,"?",2)_". ПОВТОРИМ ?",2) I YES<1 K @TM@(FN) Q
 .S @BP@("@HFS",N)=$$h^%ZAPM.ed.BS3()_"?"_$G(%BS(12)) I $D(GuiCall) D
 ..N fN S fN=$P(FN,".",1,$L(FN,".")-1)
 ..I '$ZU(140,4,fN) S @BP@("@HFS",$ZU(140,1,fN)_"?"_$P(fN,"\",$L(fN,"\")))=$$h^%ZAPM.ed.BS3()_"?"_$G(%BS(12))
 D TempT^%ZAPM.ed.BSTT
 I $D(NEWFORMAT) D BP^%ZAPM.ed.BSBD1 G tm
 S FN="",TmpND=0 F  S FN=$O(@TM@(FN)) Q:FN=""  D Wait^%ZAPM.ed.BSXfun("обработка "_FN) S D="" F  S D=$O(@TM@(FN,D)) Q:D=""  D  X WA
 .S N="" F  S N=$O(@TM@(FN,D,N)) Q:N=""  S S=@TM@(FN,D,N) I S'="" S S1=$G(@TM@(FN,D,N+1)) D
 ..I N=1 S F=$P($P(S,"-=",2),"=") D
 ...D FORMAF^%ZAPM.ed.BSBD1
 ...S S2=S_S1 D RAZ(S2)
 ...S S=$E(S2,1,v) I $E(S2,v+1,9999)["+",$TR($E(S2,v+1,9999),"+=","")="" S S=S_"+++",S2="" S @TM@(FN,D,N+1)="" Q
 ...I $L($E(S2,v+1,9999))>($$LNG^%ZAPM.ed.BSF12-1) D PEREST($E(S2,v+1,9999),N) Q
 ...S @TM@(FN,D,N+1)=$E(S2,v+1,9999)
 ..S @BP@(F,ND,(N+1)_",2")=S
 .D U^%ZAPM.ed.BS3($NA(@BP@(F,ND)))
 .D CTRL(BP,F,ND,BD)
tm D SC ;AN
 K @TM
 I TmpND>0 D  
 .D TempTX^%ZAPM.ed.BSTT("    .... ИТОГО ВВЕДЕНО В БУФЕР ("_TmpND_") ДОКУМЕНТОВ")
 .D TempTXT^%ZAPM.ed.BSTT("ФАЙЛ *ФОРМА* ?НОМЕР ДОКУМЕНТА? //СТАТУС",$G(@%BS(20)@("TextEdit")))
 .I $D(GuiCall) W "<H3>"_$P($G(@BSr@(BSt)),"@",1)_"</H3>" D  W "<HR>" Q
 ..N S,ST,DIS,ND,CHE F i=1:1 Q:'$D(@BSr@(BSt,i))  S ST=$G(@BSr@(BSt,i))_" //"_$$STATUS($P($G(@BSr@(BSt,i)),"*",2),$P($G(@BSr@(BSt,i)),"?",2)) D
 ...I S="?" W ST Q
 ...W "<LI>"_i_".<input type='checkbox' "_DIS_" name='chDOC"_ND_"' value=0 size=35 "_CHE_" >"_ST
 . D TempTXTE^%ZAPM.ed.BSTT Q
 Q
STATUS(F,ND1) S ND=ND1,DIS="DISABLED",CHE=""  I F=""!(ND="") Q "?"
 S S=$G(@BP@(F,ND,"2,1"))
 I S=4 Q "Занесено в БД"
 I S=3 S DIS="",CHE="CHECKED" Q GREEN_"Готова к Занесению в БД"_EF
 Q RED_"Есть ошибки..."_S_EF
RAZ(S2) ;РАЗРЕЗ
 F v=80:-1:1 Q:$E(S2,v)="="
 I $E(S2,v)'="=" F v=80:1:$L(S2) Q:$E(S2,v)="="
 Q
PEREST(S3,N) ;ПРИМЕР РЕКУРСИИ !!!
 N I,II,v
PER S I=$O(@TM@(FN,D,""),-1) F II=I:-1:N+2 S @TM@(FN,D,II+1)=@TM@(FN,D,II)
 D RAZ(S3)
 S @TM@(FN,D,N+1)=$E(S3,1,v)
 I $L($E(S3,v+1,9999))>($$LNG^%ZAPM.ed.BSF12-1) S S3=$E(S3,v+1,9999),N=N+1 G PER
 S @TM@(FN,D,N+2)=$E(S3,v+1,9999)
 Q
SCANING S BP=$$KBD^%ZAPM.ed.BSF12("^%ZAPM.ed.BSMDDR(""BPO"")") G SC
SCAN D Yes^%ZAPM.ed.BSXfun("ПЕРЕНАСЧИТЫВАЕМ ОБЩЕЕ КОЛИЧЕСТВО ОШИБОК В БУФЕРЕ ПРЕДВВОДА ?",2) Q:YES<1
SC ;D Wait^%ZAPM.ed.BSXfun("сканирование буфера") 
 N C1,C2,C3
 S F="" F  S F=$O(@BP@(F)) Q:F=""  I F'["@" S (C3,C1,C2)=0 D  D SCANI
 .S N="" F  S N=$O(@BP@(F,N)) Q:N=""  I N'["@" D SCA X $G(WA)
 Q
SCANI S @BP@(F)="ВСЕГО="_(C3+C2+C1)_" "_$S(C3:"ОШИБОЧНЫХ="_C3,1:"")_" "_$S(C1:"ГОТОВЫХ "_C1,1:"")_" "_$S(C2:"ЗАНЕСЕНЫХ "_C2,1:"") Q
SCA I $G(@BP@(F,N,"2,1"))=3 S C1=C1+1 Q
 I $G(@BP@(F,N,"2,1"))=4 S C2=C2+1 Q
 S C3=C3+1
 Q
ZAP ;ЗАПИСЬ В БД
 S com="ЗАПИСЬ В БД ",F=$P($$CHOIS^%ZAPM.ed.BSMDDR2(com,"Z"),"§",2) Q:F=""
 S BD=$$Bd Q:BD=""
 I F'=" " D ZAPI(F) G ZAPIS
 S F="" F  S F=$O(@BP@(F)) Q:F=""  D ZAPI(F)
ZAPIS D OkMsg^%ZAPM.ed.BSXfun(com_"ЗАВЕРШЕН") Q
ZAPI(F) N N,S,K,C3,C1,C2 S (C3,C1,C2)=0
 D Wait^%ZAPM.ed.BSXfun($NA(@BP@(F)))
 S N="" F  S N=$O(@BP@(F,N)) Q:N=""  I N'["@" D
 .D CTRL(BP,F,N,BD,1)
 .D SCA X WA
 D SCANI
 Q
SIN ;СИНТАКСИЧЕСКИЙ КОНТРОЛЬ
 S com="СИНТАКСИЧЕСКИЙ КОНТРОЛЬ ",F=$P($$CHOIS^%ZAPM.ed.BSMDDR2(com,"S"),"§",2) Q:F=""
 S BD=$$Bd Q:BD=""
 I F'=" " D SINT(F) G SINTX
 S F="" F  S F=$O(@BP@(F)) Q:F=""  D SINT(F)
SINTX D OkMsg^%ZAPM.ed.BSXfun(com_"ЗАВЕРШЕН") Q
SINT(F) N N,S,K,C3,C1,C2 S (C3,C1,C2)=0
 D Wait^%ZAPM.ed.BSXfun($NA(@BP@(F)))
 S N="" F  S N=$O(@BP@(F,N)) Q:N=""  I N'["@" D CTRL(BP,F,N,BD),SCA X WA
 D SCANI
 Q
Bd() S BD=$$KBD^%ZAPM.ed.BSF12($$DDRTOBD^%ZAPM.ed.BSBD)
 I '$$Data^%ZAPM.ed.BSF12(BD) D ErrMsg^%ZAPM.ed.BSXfun("База Описания Ввода "_BD_" не Доступна") Q ""
 Q BD
CTRL(BP,F,ND,BD,Z,uzel) 
 ;Z="" СИНТ. КОНТРОЛЬ ДОКУМЕНТА
 ;Z=1 ЗАНЕСЕНИЕ В БД
 ;Z=1,$G(uzel)'="" ЛОГ. КОНТРОЛЬ ДОКУМЕНТА БЕЗ ЗАНЕСЕНИЯ В БД
 ;Z=1,$G(uzel)="KILL" ОТКАТ-УДАЛЕНИЕ УЗЛОВ БД ДОКУМЕНТА
 ;BP-МАСССИВ БПО
 ;F - ИМЯ ФОРМЫ
 ;ND - НОМЕР ДОКУМЕНТА
 N N,S,K,STOP,P,PO,LB1,LB2,OS,OSN,ls,GG,d,bd,bd1,Ke,KK,Wt,REC,RECK,DUBL,POK,KEYALL
 N OldP,rlo,PLU,REC1,RECK1,oTl,KaE,LastKey,ErrKey
 I $G(@BP@(F,ND,"2,1"))=4 S zzRrLast=$ZR Q:$G(uzel)=""
 D L^%ZAPM.ed.BS3($NA(@BP@(F,ND)),1) I 'LOC Q  ;ЗАЛОКИРОВАН
 D CTT
 D U^%ZAPM.ed.BS3($NA(@BP@(F,ND)))
 Q
CTT S OS=0,OldP=$G(@BP@(F,ND,"2,1"))
 S @BP@(F,ND,"2,1")="",zzRrLast=$ZR F N=2:1 Q:'$D(@BP@(F,ND,N_",2"))  K @BP@(F,ND,N)
 I '$D(@BD@(F)) D PROT(2,"НА ФОРМУ "_F_" НЕТ ОПИСАНИЯ В "_BD),ER(1,"1 !!!") Q
 I '$D(LB(F)) S GG=$$LBD($NA(@BD@(F)),$G(Z)) I 'GG D PROT(2,GG) Q
 I $G(LB(F,"XECTIME"))=2 X $G(LB(F,"XEC")) Q  ;СПЕЦ.ПРОГА ДЛЯ ВВОДА ИЗ БПО
 ;D x^%ZAPM.ed.BS3(1)     ;---//--- для msm 4.x.x
 D LO I S(2)["NODE_DDR" D CTT^%ZAPM.ed.BSBD1 Q
 F K=0:1:9 I $D(LB(F,K)) S LastKey=K I '$D(LB(F,K,1)) D CTRK(K,.Ke) Q:$D(ErrKey)  S Ke(K)=d
 I $D(ErrKey) D PROT(2,"ОШИБКА В ОПИСАНИИ КЛЮЧА "_K) Q
 S KK=LastKey ;ПОСЛЕДНИЙ КЛЮЧ
 S %zT=$ZT,$ZT="ERPOK^%ZAPM.ed.BSMDDR1"
 S bd=$P(LB(F,"KEY"),"@")_$G(Ke(0))
 I '$$Data^%ZAPM.ed.BSF12(bd) S @bd="BSD - MSW@" ;D PROT(2,"НЕ ДОСТУПНА БАЗА "_bd_" !  ВОЙДИТЕ НА 0-Й КЛЮЧ И СОЗДАЙТЕ НОВЫЙ УЗЕЛ БАЗЫ ДАННЫХ") Q
 F K=0:1:9 I $D(LB(F,K,1)) S LB1(K)=$P(LB(F,K),$C(34),2),LB2($P(LB(F,K),$C(34),2))=K
ctr K ls,POK I $G(LB(F,"W"))="!!!" S Wt=1 ;РАЗРЕШИТЬ ДУБЛИРОВАНИЕ
 S N=1 F  S N=$O(S(N)) Q:N=""  S OSN=0 D  I OSN D ER("в"_(N-1),OSN)
 .F P=1:1 Q:$P(S(N),"=",P,P+1)=""  S PO=$P(S(N),"=",P) D
 ..I PO["++" S PLU=N Q
 ..Q:PO["--"!(PO="")  I N=2 Q:PO=F
 ..D d
 ..I $G(LB(F,"PI"))[(PO_",") Q
 ..I $G(LB(F,"W"))=PO D  Q
 ...I d=0,$G(uzel)'="KILL" D PROT(N,"ПОКАЗАТЕЛЬ "_PO_d_" ТРЕБУЕТ УДАЛЕНИЕ ДОКУМЕНТА ! ЭТО МОЖНО ВЫПОЛНИТЬ КОМАНДОЙ <ALT-F2> --> <ОТКАТ>") S OS=OS+1,OSN=OSN+1 Q
 ...S Wt=$S(d=1:1,1:PO) Q
 ..I '$D(LB(F,"I",PO)) D
 ...D PROT(N,"НЕСУЩЕСТВУЮЩИЙ ПОКАЗАТЕЛЬ "_PO_" !!!") S OS=OS+1,OSN=OSN+1 K ls
 ..I $D(LB(F,"I",PO,1)) D
 ...I $D(LB(F,"SPO")),LB(F,"SPO")[(PO_",") Q  ;СНЯТИЕ КОНТРОЛЯ
 ...S YES=1 X LB(F,"I",PO,1) I 'YES D PROT(N,PO_"="_d_" !!! "_$G(ls,"СИНТ.ОШИБКА")) S OS=OS+1,OSN=OSN+1 K ls Q
 ..I $G(Z)=2,$G(LB(F,"I",PO))["@" S REC(PO)=d
 ..I '$D(LB(F,"P")) D
 ...I $D(POK(PO)) D PROT(N,"ПОКАЗАТЕЛЬ "_PO_d_" ДУБЛИРУЕТСЯ ! УЖЕ БЫЛ В "_POK(PO)_" СТРОКЕ") S OS=OS+1,OSN=OSN+1 Q
 ...I '$D(POK(PO)) S POK(PO)=N-1
 ..I $D(LB2(PO)) D  K POK Q
 ...I $D(LB(F,"KEY",LB2(PO),1)) D
 ....I $D(LB(F,LB2(PO),2)) Q
 ....S YES=1 X LB(F,"KEY",LB2(PO),1) I 'YES D PROT(N,PO_"="_d_" !!! "_$G(ls,"СИНТ.ОШИБКА")) S OS=OS+1,OSN=OSN+1 K ls Q
 ...I d="" D PROT(N,"КЛЮЧ НОМЕР "_LB2(PO)_" ПУСТОЙ !") S OS=OS+1,OSN=OSN+1 Q
 ...S Ke(LB2(PO))=d
 ...I KK=LB2(PO) S KaE=1 D
 ....S bd1=bd
 ....I $D(LB(F,"P")) D
 .....F K=1:1:KK-1 Q:'$D(Ke(K))  S bd1=$NA(@bd1@(Ke(K))) ;```:KK-1
 .....I $G(Z)'=2,$G(uzel)="" D RECCHP K REC1,RECK1 S REC1=bd1,RECK1=Ke(KK) I $G(LB(F,"I",PO))["@" S REC1(PO)=d
 ....I '$D(LB(F,"P")) D
 .....F K=1:1:KK Q:'$D(Ke(K))  S bd1=$NA(@bd1@(Ke(K)))
 .....I $G(uzel)="",$D(@bd1),'$G(Wt) D PROT(N,bd1_". УЖЕ СУЩЕСТВУЕТ И НЕТ "_$G(Wt,"""КОР1""")) S OS=OS+1 Q
 .....I $G(uzel)="",$D(DUBL(bd1)) D PROT(N,bd1_" УЖЕ ВСТРЕЧАЛОСЬ В ЭТОМ ДОКУМЕНТЕ, В СТРОКЕ "_DUBL(bd1)) S OS=OS+1 Q
 ....S DUBL(bd1)=N-1
 ....I $G(Z)=2 D REC K REC,RECK S REC=bd1,RECK=Ke(KK) I $G(LB(F,"I",PO))["@" S REC(PO)=d
 I '$D(PLU) D PROT(N,"НЕТ НОРМАЛЬНОГО ЗАВЕРШЕНИЯ ДОКУМЕНТА ""=+++"" !") S OS=OS+1,OSN=OSN+1
 I '$D(KaE),'$D(LB(F,"Singl")) D  D PROT(N,"КЛЮЧ !!! НЕ ЗАВЕРШИЛСЯ ПОСЛЕДНИМ !") S OS=OS+1,OSN=OSN+1
 I $D(LB(F,"Singl")) S bd1=$$SingB I $D(@bd1),'$G(Wt) D PROT(N,bd1_".. УЖЕ СУЩЕСТВУЕТ И НЕТ "_$G(Wt,"""КОР1""")) S OS=OS+1 Q
 I $D(LB(F,"P")),$G(Z)'=2 D RECCHP K REC1,RECK1
 I 'OS S:$G(uzel)="" @BP@(F,ND,"2,1")=3 I $G(Z)=1 K REC,DUBL S Z=2 G ctr
 I OS D ER(" всего",OS) Q
 I $G(Z)=2 D REC S:$G(uzel)'="" @BP@(F,ND,"2,1")=OldP I "KILL"'[$G(uzel) S $P(@BP@(F,ND,"INF"),"?",6)=$S($D(oTl):"",1:+$G(rlo))
 I $G(uzel)="KILL" S Z="" K REC,DUBL,uzel G ctr ;ЭМУЛЯЦИЯ СИНТ.КОНТРОЛЯ
 Q
SingB() ;ФОРМИРОВАНИЕ ССЫЛКИ БД
 N bd1
 S bd1=bd F K=1:1:9 Q:'$D(Ke(K))  S bd1=$NA(@bd1@(Ke(K)))
 Q bd1
REC N K,KK
 S %zT=$ZT,$ZT="ERREC^%ZAPM.ed.BSMDDR1"
 I $D(LB(F,"XEC")) X LB(F,"XEC")
 I $D(LB(F,"Singl")),$D(REC)="10" D  G REs
 .S REC=$$SingB
 Q:'$D(RECK)
REs D L^%ZAPM.ed.BS3(REC,1) I 'LOC D ErrMsg^%ZAPM.ed.BSXfun("ОШИБКА ЛОКИРОВАНИЯ УЗЛА "_REC) Q
 I $G(uzel)="KILL" D  G RE1
 .D Yes^%ZAPM.ed.BSXfun("УДАЛЯЕМ УЗЕЛ "_REC_" ! ВЫ ХОРОШО ПОДУМАЛИ ?") Q:YES<1  K @REC
 I $D(uzel) D  G RE1
 .D L^%ZAPM.ed.BS3(LB(F,"S"),1) I 'LOC Q  D ErrMsg^%ZAPM.ed.BSXfun("ОШИБКА ЛОКИРОВАНИЯ ТОБД "_LB(F,"S")) Q
 .S uzel="# Док."_ND_" узел "_REC D LOGREC^%ZAPM.ed.BSMDDR2 S rlo=$G(rlo)+$G(lo)
 .D U^%ZAPM.ed.BS3(LB(F,"S"))
 D RE S @BP@(F,ND,"2,1")=4
RE1 D U^%ZAPM.ed.BS3(REC)
 Q
RE I $D(LB(F,"P")) D  D record(REC),re Q
 .F K=1:1 Q:$P(LB(F,"I",LB(F,"P")),"@",K,K+1)=""  I $P(LB(F,"I",LB(F,"P")),"@",K)=RECK D  Q
 ..S KK="" F  S KK=$O(REC(KK)) Q:KK=""  D
 ...I $P(LB(F,"I",KK),"@",K)="" D PROT(N,"ОШИБКА НАСТРОКИ !!! В ТОБД НА """_LB(F,"P")_"""="_RECK_" ПОКАЗАТЕЛЬ "_KK_" НЕ ХРАНИТСЯ В БД !") S OS=OS+1,OSN=OSN+1 Q
 ...D rec($NA(@REC@($P(LB(F,"I",KK),"@",K))),REC(KK))
 S KK="" F  S KK=$O(REC(KK)) Q:KK=""  D rec($NA(@REC@($P(LB(F,"I",KK),"@",2))),REC(KK))
 D record(REC),re
 Q
re D record($NA(@BP@(F,ND))) Q
record(g) S @g=$$h^%ZAPM.ed.BS3()_","_$G(%BS(12))_",1" Q
rec(g,d) I d="" K @g Q
 S @g=d Q
d S (d,d1,d0)=$E(PO,4,9999),PO=$E(PO,1,3) Q
RECCHP ;КОНТРОЛЬ МНОГОЛИНЕЙНЫХ ТОБД
 Q:'$D(RECK1)
 N K,KK
 I $D(@bd1),'$G(Wt) D PROT(N,bd1_"... УЖЕ СУЩЕСТВУЕТ И НЕТ "_$G(Wt,"""КОР1""")) S OS=OS+1 Q
 ;???I $D(DUBL(bd1)) D PROT(N,bd1_" УЖЕ ВСТРЕЧАЛОСЬ В ЭТОМ ДОКУМЕНТЕ, В СТРОКЕ "_DUBL(bd1)) S OS=OS+1 Q
 F K=1:1 Q:$P(LB(F,"I",LB(F,"P")),"@",K,K+1)=""  I $P(LB(F,"I",LB(F,"P")),"@",K)=RECK1 D  Q
 .S KK="" F  S KK=$O(REC1(KK)) Q:KK=""  D
 ..I $P(LB(F,"I",KK),"@",K)="" D PROT(N,"ОШИБКА НАСТРОКИ !!! В ТОБД НА """_LB(F,"P")_"""="_RECK1_" ПОКАЗАТЕЛЬ "_KK_" НЕ ХРАНИТСЯ В БД !") S OS=OS+1,OSN=OSN+1 Q
 Q
ERPOK D PROT($G(Iv,2),"!ПОКАЗАТЕЛЬ! "_$G(PO)_" !!! "_$ZE_" "_$$ErrSay^%ZAPM.ed.BSF8($ZE)) S $ZT=$G(%zT),OS=OS+1 Q
ERREC D PROT($G(Iv,2),"ОШИБКА ПРИ ЗАПИСИ В БД!!! "_$ZE_" "_$$ErrSay^%ZAPM.ed.BSF8($ZE)) S $ZT=$G(%zT),OS=OS+1 Q
CTRK(K,%KEYS) ;КОНТРОЛЬ КЛЮЧЕЙ ИЗ НЕПОВТОРЯЮЩИХСЯ ПОКАЗАТЕЛЕЙ
 N FO,d1,d0,YES,Iv,ls,%NAm,ii
 S %zT=$ZT,$ZT="ERKEY^%ZAPM.ed.BSMDDR1"
 S %NAm=$$BSD^%ZAPM.ed.BSA($P(LB(F,"KEY"),"@"),$G(%KEYS(0))) F ii=1:1:9 Q:'$D(%KEYS(ii))  S %NAm=%NAm_$S(%KEYS(ii)=+%KEYS(ii):%KEYS(ii),1:$C(34)_%KEYS(ii)_$C(34))_","
 S FO=$$TR^%ZAPM.ed.BSsFUNM(LB(F,K),"{","$$FOR("),FO=$$TR^%ZAPM.ed.BSsFUNM(FO,"}",")")
 X "S (d1,d,d0)="_FO
 I d="" D PROT(2,"КЛЮЧ НОМЕР "_K_" ПУСТОЙ !") S OS=OS+1 Q
 I $D(LB(F,"KEY",K,1)) D
 .I $D(LB(F,K,2)) Q
 .X LB(F,"KEY",K,1) I 'YES D PROT($G(Iv,2),"ОШИБКА ДАННЫХ КЛЮЧА НОМЕР "_K_" "_$G(ls)) S OS=OS+1 K ls Q
 Q
ERKEY D PROT($G(Iv,2),"!!!КЛЮЧ "_K_" !!! "_$$ErrSay^%ZAPM.ed.BSF8($ZE)) S $ZT=$G(%zT) S OS=OS+1
 S ErrKey=1 Q
DatGuKBB(D) ;ДАТУ ОТЧЕТА ДДММГГ-->ПРИВОДИТ НА ГГГГММ28
 N G,M  ;Y2000 УДАЛИТЬ МОДУЛЬ !!!!!!!!
 S D=$$REVERS^%ZAPM.ed.BSsFUNR(D)
 I '$$DAT^%ZAPM.ed.BSsFUNR(6,D) Q "???" ;Y2000
 S G=$$Y^%ZAPM.ed.BSsFUNR(D),M=+$$M^%ZAPM.ed.BSsFUNR(D),D=+$$D^%ZAPM.ed.BSsFUNR(D) I D'>20 S M=M-1
 I $D(F),"\15101\15301\50404\15203\55102\15201\55101\14205\55105\15202\20601\55103\55106\"[("\"_F_"\") S M=M-1
 I M<1 S G=G-1,M=12
 I G<0 S G=99
 S:G?1N G="0"_G S:M?1N M="0"_M
 S G=$$ADDYEAR^%ZAPM.ed.BSsFUNR(G)
 Q G_M_"28"
FOR(P) ;ФУНКЦИЯ {}
 S Iv=1 F  S Iv=$O(S(Iv)) Q:Iv=""  I ("="_S(Iv))[("="_P) Q
 Q $P($P(("="_S(Iv)),("="_P),2),"=")
LO F N=2:1:301 I $G(@BP@(F,ND,N_",2"))'=""  S S(N)=@$ZR,S=N
 Q
ER(S,K) S @BP@(F,ND,"2,1")=$G(@BP@(F,ND,"2,1"))_S_"="_K_" " Q  ;КОЛИЧЕСТВО ОШИБОК
LBD(G,K) ;СОЗДАНИЕ ЛОКАЛЯ ПО ТОБЗ
 N I,II,BS,IM,VT,GG,GGG,Iz,QQ
 I $S<25000 D SIZE^%ZAPM.ed.BSN(25) I $S<25000 K LB
 F I=0:1:9 I $D(@G@(I,"F"))  S LB(F,I)=@$ZR D
 .I $D(@G@(I,"SKO")) S LB(F,I,2)="Y"
 .I $D(@G@(I,"M")),'$D(NEWFORMAT) S LB(F,I,1)="Y",QQ=1 //!!!!!!!!!!!!! ЕСЛИ ЧТО-ТО СЛОМАЕТСЯ $D(NEWFORMAT)
 I '$D(QQ) S LB(F,"Singl")=1
 F I="PI","S","P","W","NK","SPO","XEC","XECTIME" I $D(@G@("^",I)) S LB(F,I)=@$ZR
 I '$D(LB(F,"S")) Q "НЕ ОПИСАНА ССЫЛКА на ТОБД В "_G
 S GG=LB(F,"S") I GG["#" D  Q GGG
 .F Iz=1:1 Q:$P(LB(F,"S"),"#",Iz,Iz+1)=""  S GG=$P(LB(F,"S"),"#",Iz),GGG=$$l(GG)
 Q $$l(GG)
l(GG) I '$$Data^%ZAPM.ed.BSF12(GG) Q "НЕДОСТУПНА ТАБЛИЦА ОПИСАНИЯ БД "_$G(GG)
 I $P(@GG,"@",17)'=2 Q "ТАБЛИЦА "_$G(GG)_" НЕ ЯВЛЯЕТСЯ ТОБД"
 D Copy^%ZAPM.ed.BSF8($NA(@GG@("KEY")),$NA(LB(F,"KEY")))
 F II=0:1:9 I $D(LB(F,"KEY",II)) F I=10:1 Q:'$D(LB(F,"KEY",II,I))  K LB(F,"KEY",II,I)
 F I=1:1 Q:'$D(@GG@(I))  F II=1:1 Q:'$D(@GG@(I,II))  S BS=@$ZR D
 .Q:$P($P(BS,"@",18),"#",2)=""  S IM=$P($P(BS,"@",18),"#",2) K VT
 .I $P(BS,"@",16)'="" D  ;СИНТАКСИС
 ..I $P(BS,"@",16)="0" S VT=$G(@GG@("RTR",I,II)) Q
 ..S VT=$G(@GG@("RTR",+$P($P(BS,"@",16),","),+$P($P(BS,"@",16),",",2)))
 .I IM=$G(LB(F,"P")) S $P(LB(F,"I",IM),"@",I)=$P($G(@GG@(I,$G(LB(F,"NK"),II))),"@",15) Q
 .I $G(K),$P(BS,"@",9)=2 D
 ..I $D(uzel) S LB(F,"L",IM)=I_","_II
 ..I $D(LB(F,"P")) S $P(LB(F,"I",IM),"@",I)=$S($P($P(BS,"@",18),"#")'="":$P($P(BS,"@",18),"#"),1:I_","_II) Q
 ..S $P(LB(F,"I",IM),"@",2)=$S($P($P(BS,"@",18),"#")'="":$P($P(BS,"@",18),"#"),1:I_","_II)
 .S:$G(LB(F,"I",IM))'["@" LB(F,"I",IM)=""
 .I $D(VT) S LB(F,"I",IM,1)=VT
 Q 1
PROT(N,TX) ;ЗАПИСЬ ПРОТОКОЛА
 N NN
 I 'N S N=2
 S $ZT="PROTERR"
 S NN=$O(@BP@(F,ND,N,""),-1)+1,@BP@(F,ND,N,NN)=TX I $D(GuiCall) w "<LI>"_F_" #"_ND_" "_RED_TX_EF
 Q
PROTERR 
 I $ZE["<WRITE" H
 Q
REST(TM) N fT1,fT2,i
 I '$D(GuiCall) D DOSREAD^%ZAPM.ed.BSS1 I '$D(%FN) Q
 I $D(%BS("Tmp","DosFiles")) S XN="" F  S XN=$O(%BS("Tmp","DosFiles",XN)) G:XN="" XNE D XNOPN I $D(%FN) D XN
XN //работаем файл
 D USE0 S %zT=$ZT,$ZT="ERFILE^%ZAPM.ed.BSMDDR1"
 q:'$D(%DEV)  S FR=%DEV D CLO 
 I $P(%FN,".",$L(%FN,"."))'="",",jpg,bmp,doc,rtf,xls,cdr,avi,mp3,wav,html,htm,tab,ppt,pps,"[(","_$$LITL^%ZAPM.ed.BSsFUNM($P(%FN,".",$L(%FN,".")))_",") g Vi
 K fT1,fT2 D File2Arr^%ZAPM.ed.BSCEXE(%FN,.fT1),STR2MAS^%ZAPM.ed.BSCmail(.fT1,.fT2,$C(13,10)) K fT1 S i="" F  S i=$O(fT2(i)) Q:i=""  I $G(fT2(i))'="" S fT1(i)=fT2(i) I $G(fT1)="" S fT1=i
 S %IN=$G(fT1(fT1)) K fT2 M fT2=fT1 //первая строчка файла
 ; U %DEV R %IN
RES I %IN'["%BS-SCANINIG"&(%IN'["%BS-FORMAT")  D SCAN^%ZAPM.ed.BSF11(%FN) I 'YES G Vi ;ПРЕДСКАНИРОВАНИЕ ФАЙЛА
 S S=%IN
 D USE0 D Wait^%ZAPM.ed.BSXfun("Ввод ИНФОРМАЦИИ из "_%FN) S @TM@(%FN)=$$FILE^%ZAPM.ed.BSDOS(%FN,1)_"?"_$P(%FN,"\",$L(%FN,"\"))
 I S["%BS-FORMAT" D PFLREAD^%ZAPM.ed.BSBD1 Q
 S D=0,SS=""
 ;D  F  U %DEV R S Q:$ZC'=0  D  I '(D#10) D USE0  X WA ;`CACHE'
 S i="" F  S i=$O(fT2(i)) Q:i=""  S S=fT2(i) D
 .I S["%BS-SCANINIG" Q
 .I $TR(S," ","")="" Q
 .I S["-=" S D=D+1,N=0,SS=""
 .S SS=SS_S
 .I S'["=" Q
 .S N=N+1,@TM@(%FN,D,N)=SS,SS=""
Vi I '$D(N) D USE0 D ErrMsg^%ZAPM.ed.BSXfun("ОШИБКА ФОРМАТА ДОКУМЕНТА '"_%FN) K %FN G EEE
 I (SS_S)'="",$G(@TM@(%FN,D,N))'=(SS_S) S N=N+1,@TM@(%FN,D,N)=SS_S //закрытие докумета в БПО
EEE S $ZT=$G(%zT) D CLO
 Q //работать с текущим закончили
ERFILE I $ZE["<ENDOFFILE"  G Vi
 D ErrMsg^%ZAPM.ed.BSXfun($ZE_" "_$$ErrSay^%ZAPM.ed.BSF8($ZE)) S $ZT=$G(%zT) G CLO
XNOPN //открываем текущий файл
 ;N DOS K %DEV,%FN S DOS=$$OpenDOS^%ZAPM.ed.BSXdos() Q:DOS<0
 ;Q:$$Open^%ZAPM.ed.BSXdos(XN,"R")<0  S %DEV=DOS,
 S (%DEV,%FN)=XN
 Q
XNE K %BS("Tmp","DosFiles") //закрываем список файлов
CLO D USE0
 C:$D(%DEV) %DEV 
 Q
USE0 I '$D(GuiCall) U 0
 E  U GuiI
 Q
]]></Routine>


<Routine name="%ZAPM.ed.BSMDDR2" type="MAC" languagemode="0"><![CDATA[
%BSMDDR2 ; ЗАПИСЬ В БАЗУ, ПРОТОКОЛ & ETC ; 12:29   28.11.99
 Q
NEWYEAR ;ПЕРЕНУМЕРАЦИЯ
 N li
 S BP=$$KBD^%ZAPM.ed.BSF12("^%ZAPM.ed.BSMDDR(""BPO"")") I '$$Data^%ZAPM.ed.BSF12(BP) D ErrMsg^%ZAPM.ed.BSXfun("Буфер "_BP_" не Доступен") Q
 S li=$$LineEdit^%ZAPM.ed.BSXfun(+$G(@BP@("@Last")),"Вводите\Корректируйте НОМЕР для "_BP)
 I YES>0 S @BP@("@Last")=+li K @BP@("@HFS")
 Q
CellTab(T,Z) ;ФУНКЦИЯ ВЫЗОВА ТАБЛИЦЫ И ВОЗВРАТ КЛЕТКИ
 N BSr,BSt,IYI,MaS
 S $ZT="ER^%ZAPM.ed.BSMDDR2"
 S li=$G(@%BS("Tmp","BSD")@(T))
Cell I li="" D BEL(T) Q
 D TIR^%ZAPM.ed.BST4 I li="" G ER
 S (MaS,YES)=1
 D RII^%ZAPM.ed.BSF3 I YES<1 S li="" G ER
 S IYI=BSr_"("_BSt D ENTER^%ZAPM.ed.BSN I date="" S li="" Q
 I '$G(Z) S li=$P(%BS("Tmp","LastTabl"),"@")
 S:$G(Z) li="" Q
ER W $$bel^%ZAPM.ed.BS3 Q
BEL(T) D ErrMsg^%ZAPM.ed.BSXfun("Данные В узле '"_T_"' Отсутствуют или не записаны в Базу Данных")
 q
CTKBD ;КОНТРОЛЬ ИЗ КАРТЫ БД
 D 333^%ZAPM.ed.BSF
 N BD,LB,zzRrLast
 S BD=$$Bd^%ZAPM.ed.BSMDDR1 Q:BD=""
 D CTRL^%ZAPM.ed.BSMDDR1(BSD,%KEYS(1),%KEYS(2),BD)
 I $D(zzRrLast) S ^%ZAPM.ed.BSbufB("BB"_$G(%BS(3),$P)_$J_"u"_%BS(15),2,1)=@zzRrLast I @zzRrLast=4 D ErrMsg^%ZAPM.ed.BSXfun("СИНТ.КОНТРОЛЬ ДЕЛАТЬ НЕ БУДУ! ДОКУМЕНТ ЗАНЕСЕН") Q
 D TW^%ZAPM.ed.BST,KLE^%ZAPM.ed.BSTM
 D OkMsg^%ZAPM.ed.BSXfun("КОНТРОЛЬ ПРОИЗВЕДЕН...")
 Q
LOGCON ;ЛОГ. КОНТРОЛЬ ИЗ КАРТЫ БД
 D 333^%ZAPM.ed.BSF
 N BD,LB,zzRrLast,PR,NUM,%BS,loo,lo
 S BD=$$Bd^%ZAPM.ed.BSMDDR1 Q:BD=""  D LV^%ZAPM.ed.BSF4
 K ^%ZAPM.ed.BSbufB("LOGS"_$G(%BS(3),$P)_$J_$P($$ZU^%ZAPM.ed.BS3(1,0),",",2)_"u1"),^%ZAPM.ed.BSbufB("VarLogS"_$G(%BS(3),$P)_$J_"u1")
 S %BS(15)=999,%BS(13)="%BS-WS" ;???
 D CTRL^%ZAPM.ed.BSMDDR1(BSD,%KEYS(1),%KEYS(2),BD,1,1)
 G LOGIC
LOG ;ЛОГИЧЕСКИЙ КОНТРОЛЬ
 N l,j,TRe1,TRe2,ii,%iii,NOKILLER,KILLER,lo,loo
 S com="ЛОГИЧЕСКИЙ КОНТРОЛЬ ",F=$P($$CHOIS(com,"L"),"§",2) Q:F=""
 S BD=$$Bd^%ZAPM.ed.BSMDDR1 Q:BD=""
 K ^%ZAPM.ed.BSbufB("LOGS"_$G(%BS(3),$P)_$J_$P($$ZU^%ZAPM.ed.BS3(1,0),",",2)_"u1"),^%ZAPM.ed.BSbufB("VarLogS"_$G(%BS(3),$P)_$J_"u1")
 I F'=" " D LOGI(F) G LOGIC
 D Yes^%ZAPM.ed.BSXfun("ЛОГ.КОНТРОЛЬ ПО ВСЕМ !!!,ВЫ УВЕРЕНЫ ?") Q:YES<1  S F="" F  S F=$O(@BP@(F)) Q:F=""  D LOGI(F)
LOGIC I '$D(^%ZAPM.ed.BSbufB("LOGS"_$G(%BS(3),$P)_$J_$P($$ZU^%ZAPM.ed.BS3(1,0),",",2)_"u1")) D OkMsg^%ZAPM.ed.BSXfun("ПРОСМОТРЕНО "_+$G(loo)_" УЗЛОВ В ДОКУМЕНТАХ. ЛОГИЧ.ОШИБОК НЕ НАЙДЕНО") G ENDD
 S I="LOGS"_$G(%BS(3),$P)_$J_$P($$ZU^%ZAPM.ed.BS3(1,0),",",2)_"u1"
 d ^%ZAPM.ed.BSX("TEXT","^%ZAPM.ed.BSbufB","LOGS"_$G(%BS(3),$P)_$J_$P($$ZU^%ZAPM.ed.BS3(1,0),",",2)_"u1") K ^%ZAPM.ed.BSbufB("LOGS"_$G(%BS(3),$P)_$J_$P($$ZU^%ZAPM.ed.BS3(1,0),",",2)_"u1"),^%ZAPM.ed.BSbufB("VarLogS"_$G(%BS(3),$P)_$J_"u1")
ENDD Q
rec(Y,X,d) I d="" Q
 S ^%ZAPM.ed.BSbufB("BB"_$G(%BS(3),$P)_$J_"u"_%BS(15),Y,X)=d Q
LOGI(F) N N,S,K,C3,C1,C2 S (C3,C1,C2)=0
 D Wait^%ZAPM.ed.BSXfun($NA(@BP@(F)))
 S N="" F  S N=$O(@BP@(F,N)) Q:N=""  I N'["@" D
 .I "34"[$G(@BP@(F,N,"2,1")) D CTRL^%ZAPM.ed.BSMDDR1(BP,F,N,BD,1,1)
 .D SCA^%ZAPM.ed.BSMDDR1 X WA
 D SCANI^%ZAPM.ed.BSMDDR1
 Q
LOGREC ;ДЕЛАЕМ БУФЕР И КОНТРОЛЬ
 K ^%ZAPM.ed.BSbufB("BB"_$G(%BS(3),$P)_$J_"u"_%BS(15)),oTl
 S %NAm=$E(REC,1,$L(REC)-1)_",",li=LB(F,"S"),loo=$G(loo)+1
 I $D(LB(F,"P")) D  G LO
 .F K=1:1 Q:$P(LB(F,"I",LB(F,"P")),"@",K,K+1)=""  I $P(LB(F,"I",LB(F,"P")),"@",K)=RECK D  Q
 ..S KK="" F  S KK=$O(REC(KK)) Q:KK=""  D
 ...I $P(LB(F,"I",KK),"@",K)["," D rec(+$P($P(LB(F,"I",KK),"@",K),","),+$P($P(LB(F,"I",KK),"@",K),",",2),REC(KK)) Q
 ...S oTl=1
 S KK="" F  S KK=$O(REC(KK)) Q:KK=""  D rec($P(LB(F,"L",KK),","),$P(LB(F,"L",KK),",",2),REC(KK))
LO I $D(oTl) D PROT^%ZAPM.ed.BSMDDR1(2,"ЛОГ.КОНТР.ИЗ ""DDR"" ПРОИЗВЕСТИ НЕВОЗМОЖНО") S $ZT=$G(%zT) Q
 D  ;МОДУЛЬ КОНТРОЛЯ
 .N (uzel,%BS,vl,BSD,Ke,%NAm,li,lo) S PO="Лог.Контр."
 .D TIR^%ZAPM.ed.BST4 I li="" D PROT^%ZAPM.ed.BSMDDR1(2,"ЛОГ.КОНТР! "_li_" !!! "_$$ErrSay^%ZAPM.ed.BSF8($ZE)) S $ZT=$G(%zT) Q
 .D RII^%ZAPM.ed.BSF3 S BSR=BSr,BST=BSt,(nx,ny)=1
 .S K="" F  S K=$O(Ke(K)) Q:K=""  S %KEYS(K)=Ke(K),@("k"_K)=Ke(K)
 .D TIP^%ZAPM.ed.BST
 .D COL^%ZAPM.ed.BSF3
 Q
ERL D ErrMsg^%ZAPM.ed.BSXfun($ZE_" "_$$ErrSay^%ZAPM.ed.BSF8($ZE)) S $ZT=$G(%zT) Q
CHAN N TI S TI=$G(^%ZAPM.ed.BSbufB("BB"_$G(%BS(3),$P)_$J_"u"_%BS(15),2,1),1)
 S TI=$$LineEdit^%ZAPM.ed.BSXfun(TI,"Меняйте ПРИЗНАК обработки (*2*-ошибки,3-готова,4-занесена)") Q:YES<1
 S ^%ZAPM.ed.BSbufB("BB"_$G(%BS(3),$P)_$J_"u"_%BS(15),2,1)=TI,$P(^%ZAPM.ed.BSbufB("BB"_$G(%BS(3),$P)_$J_"u"_%BS(15)),"@",2)=1 D TW^%ZAPM.ed.BST,KLE^%ZAPM.ed.BSTM
 Q
ZAPBD ;ЗАПИСЬ В БД И КОНТРОЛЬ ИЗ КАРТЫ БД
 D 333^%ZAPM.ed.BSF
 N BD,LB,zzRrLast,PR
 S BD=$$Bd^%ZAPM.ed.BSMDDR1 Q:BD=""
 I $G(@BSD@(%KEYS(1),%KEYS(2),"2,1"))=4 D ErrMsg^%ZAPM.ed.BSXfun("УЖЕ ЖЕ ЗАНЕСЕНО ?!!!...") Q
 D CTRL^%ZAPM.ed.BSMDDR1(BSD,%KEYS(1),%KEYS(2),BD,1)
 S (PR,^%ZAPM.ed.BSbufB("BB"_$G(%BS(3),$P)_$J_"u"_%BS(15),2,1))=@zzRrLast
 I PR<4 D ErrMsg^%ZAPM.ed.BSXfun("ЕСТЬ ОШИБКИ !!! ИСПРАВЛЯЙТЕ...")
 I PR=4 D OkMsg^%ZAPM.ed.BSXfun("ЗАНЕСЕНО В БД")
 D TW^%ZAPM.ed.BST,KLE^%ZAPM.ed.BSTM
 Q
PRO N F,BP,com,NR,TI
 S com="ПРОТОКОЛ ",F=$P($$CHOIS(com,"P"),"§",2) Q:F=""
 D Table^%ZAPM.ed.BSN("^%ZAPM.ed.BSMDDR","PRO") Q:$P(YES,"@",4)=27  S NR=$P($P(YES,"@"),","),com=com_$P(YES,"@",9)
 S TI=$$LineEdit^%ZAPM.ed.BSXfun($TR($$ESDAY^%ZAPM.ed.BSsFUNR(6,$$h^%ZAPM.ed.BS3()-362),".","")_"-"_$TR($$ESDAY^%ZAPM.ed.BSsFUNR(6,$$h^%ZAPM.ed.BS3()),".",""),"введите диапазон дат ввода в буфер, в формате: ДДММГГ-ДДММГГ") Q:YES<1
 D TempT^%ZAPM.ed.BSTT S com=com_" "_TI
 I F'=" " D PROTO(F) G PROTOK
 S F="" F  S F=$O(@BP@(F)) Q:F=""  D PROTO(F)
PROTOK D TempTXT^%ZAPM.ed.BSTT(com,$G(@%BS(20)@("TextEdit")))
 D TempTXTE^%ZAPM.ed.BSTT K @BSr@(BSt)
 Q
PROTO(F) N N,S,K D Wait^%ZAPM.ed.BSXfun($NA(@BP@(F)))
 S N="" F  S N=$O(@BP@(F,N)) Q:N=""  I N'["@" D LIST(BP,F,N,NR,$G(TI)) D  K S X WA
 .F K=1:1 Q:'$D(S(K))  D TempTX^%ZAPM.ed.BSTT(S(K))
 Q
CHE(M,T) I M="S",T'["ОШИБ" Q 0
 I M="Z",T'["ГОТОВ" Q 0
 I M="L",'(T["ГОТОВ"!(T["ЗАНЕС")) Q 0
 Q 1
CHOIS(com,MO) ;ВЫБОР РЕЖИМА РАБОТЫ
 N F,BSr,BSt,YES
 S BP=$$KBD^%ZAPM.ed.BSF12("^%ZAPM.ed.BSMDDR(""BPO"")") I '$$Data^%ZAPM.ed.BSF12(BP) S @BP="восстановил!!! "_$H ;D ErrMsg^%ZAPM.ed.BSXfun("Буфер "_BP_" не Доступен") Q ""
 D TempT^%ZAPM.ed.BSTT,TempTX^%ZAPM.ed.BSTT(" § §РАБОТАТЬ ПО ВСЕМ ФОРМАМ§ §")
 S F="" F  S F=$O(@BP@(F)) Q:F=""  I F'["@",$$CHE(MO,$G(@BP@(F))) D TempTX^%ZAPM.ed.BSTT("ТОЛЬКО §"_F_"§  "_$G(@BP@(F)))
 D TempTXT^%ZAPM.ed.BSTT("РЕЖИМ работы с буфером: "_$G(com),$G(@%BS(20)@("ErrorTXT")))
 d ^%ZAPM.ed.BSX("TEXT",BSr,BSt) Q:YES<1 ""
 Q $G(@BSr@(BSt,YES))
PROTLIST ;ПРОТОКОЛ ИЗ КАРТЫ БД
 N S
 D LIST(BSD,%KEYS(1),%KEYS(2),6) I '$D(S) W $$bel^%ZAPM.ed.BS3 Q
 D TempT^%ZAPM.ed.BSTT F N=1:1 Q:'$D(S(N))  D TempTX^%ZAPM.ed.BSTT(S(N))
 D TempTXT^%ZAPM.ed.BSTT(S(1),$G(@%BS(20)@("TextEdit"))) ;И ШАБЛОН
 D TempTXTE^%ZAPM.ed.BSTT
 Q
TT(T) Q $$DATHR^%ZAPM.ed.BSsFUNR(6,$$REVERS^%ZAPM.ed.BSsFUNR(T))
TIME(TI,HR) Q:TI="" 1 N T1,T2 S T1=$$TT($P(TI,"-")),T2=$$TT($P(TI,"-",2))
 I HR'<T1&(HR'>T2) Q 1
 Q 0
LIST(BP,F,ND,NR,TI) ;ПРОТОКОЛ КОНТРОЛЯ ДОКУМЕНТА
 N N,K,PO,IN,H
 S PO=$G(@BP@(F,ND,"2,1")) I '(NR=5&(PO=4)!(NR=4&(PO=3))!(NR=3&('PO))!(NR=6)) Q
 S IN=$G(@BP@(F,ND,"INF")) I $G(TI)'["*",'$$TIME($G(TI),+$P(IN,"?",2)) Q
 D LI("--------------------------------------------------------------------")
 D LI("|ДОКУМЕНТ ФОРМЫ "_F_"   N "_ND)
 D LI("|ПОЛУЧЕН ИЗ "_$P(IN,"?")_" "_$$ESDAY^%ZAPM.ed.BSsFUNR(9,$P(IN,"?",2))_", ПОЛЬЗОВАТЕЛЕМ: "_$P(IN,"?",3))
 D LI("|СТАТУС: "_$S(PO=3:"ГОТОВ К ЗАНЕСЕНИЮ",PO=4:"УЖЕ ЗАНЕСЕН",1:"¶!¶ СИНТ.ОШИБКИ В :"_PO)_", ЛОГИЧ.ОШИБОК:"_$S($P(IN,"?",6)="":"???¶",'$P(IN,"?",6):"НЕТ",1:" ¶!¶!¶!¶ "_$P(IN,"?",6)))
 D LI("|-------------------------------------------------------------------")
 F N=2:1 Q:'$D(@BP@(F,ND,N_",2"))  D LI("|"_@$ZR) F K=1:1 Q:'$D(@BP@(F,ND,N,K))  D LI("|  "_@$ZR)
 D LI("------------------------------ ВЫДАН "_$$ESDAY^%ZAPM.ed.BSsFUNR(9,$$h^%ZAPM.ed.BS3())_", ПОЛЬЗОВАТЕЛЕМ: "_%BS(12))
 Q
LI(T) Q:T=""  S S=$G(S)+1,S(S)=T Q
]]></Routine>


<Routine name="%ZAPM.ed.BSMENU" type="MAC" languagemode="0"><![CDATA[
%BSMENU ;ПРИМЕРНЫЙ МОДУЛЬ ВЫЗОВА ПОЛЬЗОВАТЕЛЬСКИХ АРМов ; 11:46   04.05.2001
KKK ;КАДРЫ
 D SELF
 S uci="KDR,CEN" D %GU^%ZAPM.ed.BSF4 H:'YES  ;ПЕРЕХОД В НУЖНЫЙ КИП,ТОМ
 ;I $P=4 D ^KK H ;СТАРТ ЗАДАЧИ ИЗ ПРИКРЕПЛЕННОГО ТЕРМИНАЛА
K1 S BSR="^KDR",BST="MENUPRIM" D ^%ZAPM.ed.BST ;СТАРТ ОСНОВНОГО МЕНЮ
 I ny=7!(R1=27) D ^%SSD ;ВЫХОД ИЗ MSM
 I ny=2 D OP^%ZAPM.ed.BSF4,^PRK G K1
 I ny=1 D ^KK G K1
 G K1
 ;
KBB ;АРМ КОМАНДУЮЩЕГО
 D SELF
0 S uci="ASU,CEN" D %GU^%ZAPM.ed.BSF4
1 S BSR="^KBB",BST="MENU" D ^%ZAPM.ed.BST I R1=27!(ny=10) D MGR^%ZAPM.ed.BS G ^%SSD
 I ny=1 S uci="KDR,CEN" D %GU^%ZAPM.ed.BSF4,OP^%ZAPM.ed.BSF4 I YES D ^PRK G 0
 G 1
 ;
LASTVERS(GLO) ;САМОПОВЫШЕНИЕ ВЕРСИИ
 N DI,DII
 S %zT=$ZT,$ZT="OG^%ZAPM.ed.BSMENU",YES=0
 I '$$Data^%ZAPM.ed.BSF12(GLO) S DI=$P($G(^%ZAPM.ed.BSETUP("PATH",10,4)),"@",15) I DI>1 F DII=1:1:DI-1 I $$Data^%ZAPM.ed.BSF12(GLO) Q
 S Zv=$G(@GLO@("LAST"))
 I $G(IntSe,1)=1,'$$VERS Q
 I $G(NOAUTO) D YES I YES'="Y" Q
 S %FN=$$AddFile^%ZAPM.ed.BSDOS2($$DIR^%ZAPM.ed.BSMSMF_"%BS.PAC") F DOS=51:1:54 O DOS::0 Q:$T
 I $$Open^%ZAPM.ed.BSXdos(%FN,"W")<0 Q
 I '$D(IntSe) W #,"... Подготовка к повышению версии "
 D L^%ZAPM.ed.BS3(GLO,1)
 S X="" F  S X=$O(@GLO@("LAST",X)) Q:X=""  U DOS W @GLO@("LAST",X),! I '(X#150) I '$D(IntSe) U 0 W "."
 C DOS U 0 S YES=1 D U^%ZAPM.ed.BS3(GLO)
 Q
OG W $$bel^%ZAPM.ed.BS3 S $ZT=$G(%zT),YES=0 D U^%ZAPM.ed.BS3(GLO)
 Q
VERS() Q:Zv=^%ZAPM.ed.BS 0 Q:+Zv<+^%ZAPM.ed.BS 0 Q 1
YES U 0 W !!,"Выставлен Флаг Повышения %BS Версии ",Zv,". Приступим ? [Y/N] <N> " R YES S YES=$TR(YES,"yn","YN") Q
IntSELF(IntSe) G SELF
SEL S NOAUTO=1
SELF S %zT=$ZT,$ZT="SELFER^%ZAPM.ed.BSMENU" ;АВТО-ПОВЫШЕНИЕ
 N Zv,FIR,X,DOS S FIR=1
 I $P($G(^%ZAPM.ed.BSETUP("SERVER",2,4)),"@",15)'="" D LASTVERS($P($P($G(^%ZAPM.ed.BSETUP("SERVER",2,4)),"@",15),"\",2,99)) I YES S FIR=0 G SE
 S %FN=$$DIR^%ZAPM.ed.BSMSMF_"%BSVER.DAT"
SE F %DEV=51:1:54 O %DEV::0 Q:$T
 G:'$T E O %DEV:%FN U %DEV I $ZA=-1 G E
U O %DEV:(%FN:"R") U %DEV I $ZA<0 G E
 R X I FIR G E:X'="§" R X S Zv=$P(X,"§",2) G E:'$$VERS
 I FIR,$G(NOAUTO) D YES I YES'="Y" G E
 ;```=$$DIR^%ZAPM.ed.BSMSMF_"%BS.PAC"
 I FIR S FIR=0,%FN=$$BaseDir^%ZAPM.ed.BSDOS_$$DIR^%ZAPM.ed.BSMSMF_"%BS.PAC" C %DEV G SE
 X X
E U 0 C %DEV K %DEV,%FN G SELFER
SELFER S $ZT=$G(%zT) W $$bel^%ZAPM.ed.BS3 Q
]]></Routine>


<Routine name="%ZAPM.ed.BSMOUSE" type="MAC" languagemode="0"><![CDATA[
%BSMOUSE  ; пpогpамма работа С МЫШьЮ ; 22:56 11-NOV-96
INIT      ; Check if mouse is installed
          S init=$$INIT^%MOUSE()  ; mouse installed?
          I 'init G END
TYPE      ; Determine type of mouse
          S info=$$INFO^%MOUSE()  ; get <type>,<irq>,<version>
          I $$HIDE^%MOUSE()
          ;S %BS(25,1)=$$REPORT^%MOUSE(),Mouse=1
          ;S %BS(25)="F  R *R1:0,*R2:0,*R3:0 Q:R1'=-1  I $G(%BS(25,1))'=$$REPORT^%MOUSE() D MOUSE^%ZAPM.ed.BSMOUSE Q:R1'=-1  F  R *R:0 E  Q"
          S MouseYes(1)=$$REPORT^%MOUSE(),Mouse=1
          S MouseYes="F  R *R1:0,*R2:0,*R3:0 Q:R1'=-1  I $G(MouseYes(1))'=$$REPORT^%MOUSE() D MOUSE^%ZAPM.ed.BSMOUSE Q:R1'=-1  F  R *R:0 E  Q"
END       Q
MOUSE     N co ; F  R *R1:0,*R2:0,*R3:0 Q:R1'=-1  I $G(MouseYes(,1))'=$$REPORT^%MOUSE() D  Q:R1'=-1  F  R *R:0 E  Q
          S co=$$REPORT^%MOUSE()
          I "1"[$G(Mouse),$P(co,",",2)>$P(MouseYes(1),",",2) S R1=27,R2=91,R3=66 S:$P(co,",",2)=192 $P(co,",",2)=190 G M
          I "1"[$G(Mouse),$P(co,",",2)<$P(MouseYes(1),",",2) S R1=27,R2=91,R3=65 S:$P(co,",",2)=0 $P(co,",",2)=1 G M
          I "2"[$G(Mouse),$P(co,",",1)>$P(MouseYes(1),",",1) S R1=27,R2=91,R3=67 S:$P(co,",",1)=632 $P(co,",",1)=630 G M
          I "2"[$G(Mouse),$P(co,",",1)<$P(MouseYes(1),",",1) S R1=27,R2=91,R3=68 S:$P(co,",",1)=0 $P(co,",",1)=1 G M
M         S MouseYes(1)=co ;!!!I $$PUT^%MOUSE($P(co,",",1),$P(co,",",2))
          Q:'$P(co,",",3)
          I $ZB(+$P(co,",",3),1,1) S R1=13
          I $ZB(+$P(co,",",3),2,1) S R1=27
A         S R2=-1,R3=-1 Q
]]></Routine>


<Routine name="%ZAPM.ed.BSMSM" type="MAC" languagemode="0"><![CDATA[
%BSMSM ;MUMPS-ИНТЕРФЕЙС ; 13:38 18-DEC-98
 D 0 G D
0 I '$$AccesMSM^%ZAPM.ed.BSDOS2(1) G PROT
 S OO=29,OOO="^%ZAPM.ed.BS" K %JB D 24^%ZAPM.ed.BSTM,^%ZAPM.ed.BSB,ZA^%ZAPM.ed.BSF Q:R1=27  I %B=1 S IYI="^%ZAPM.ed.BSS(UTILITY" D ENTER^%ZAPM.ed.BSN Q
 I %B=3!(%B=4) S Br=BSR,Bt=BST,FIL=1 S:%B=4 FIL="d[""%BS""" D  S BST=Bt,BSR=Br K Br,Bt G 0
 .D D^%ZAPM.ed.BSDIR("","",FIL,"S d=$O(^ (d))","S t1=d_$J("""",9-$L(d)) S d1=$S ZL @d S t1=t1_$J(d1-$S,5)_"" ;""_$P($T(+1),"";"",2,99)","^%ZAPM.ed.BSbufB","RDIR"_$G(%BS(3),$P)_$J_"u","ПРОГРАММЫ",2,"D ROLI^%ZAPM.ed.BSMSM","ROFK^%ZAPM.ed.BSMSM","  новая пpогpамма","DelF8^%ZAPM.ed.BSDOS")
 .S IYI=BSr_","_BSt
RR .D ENTER^%ZAPM.ed.BSN I R1=27 Q
 .I R1=13 S IntGO=$P(@BSR@(BST),"@",15) I IntGO["^" S R3=83 D @IntGO
 .G RR
 I %B=6 S FIL="$P($G(@d),""@"")=""BSD - MSW""",ls="БАЗЫ ДАННЫХ" G G
 I %B=7 S FIL="$P($G(@d),""@"")[""%BS-invert-""!(d[""in"")",ls="КОДИФИКАТОРЫ" G G
 I %B=8 S FIL="$P($G(@d),""@"")[""%BS-dinam""",ls="ДИНАМИЧЕСКИЕ БОКОВИНЫ СВОДКИ" G G
 I %B=5 S FIL="$P($G(@d),""@"")=""BaSe MsW """,ls="РАЗДЕЛЫ ПОЛЬЗОВАТЕЛЯ" G G
 I %B=2 S FIL=1,ls="КАТАЛОГ МАССИВОВ" G G
 I %B=9 I $$PROTFUN D ^%ZAPM.ed.BSMSMF G 0
 G 0
G S Br=BSR,Bt=BST D   S BST=Bt,BSR=Br K Br,Bt G 0
 .D D^%ZAPM.ed.BSDIR("^","^",FIL,"S d=""^""_$O(@d)","S t1=d_$J("""",10-$L(d))_"";""_$$HEADGLO^%ZAPM.ed.BSMSM(d)","^%ZAPM.ed.BSbufB","GDIR"_$G(%BS(3),$P)_$J_"u"_$G(%BS(3),$P),ls,2,"D GLOLI^%ZAPM.ed.BSMSM","GLOFK^%ZAPM.ed.BSMSM","  новый массив","DelF8^%ZAPM.ed.BSDOS")
 .S IYI=BSr_","_BSt
GG .D ENTER^%ZAPM.ed.BSN I R1=27 Q
 .I R1=13 S IntGO=$P(@BSR@(BST),"@",15) I IntGO["^" S R3=83 D @IntGO
 .G GG
D D TIT^%ZAPM.ed.BST,W^%ZAPM.ed.BST Q
HEADGLO(d) I d="^BSrecord" Q "%BS-pазделение доступа в кип"
 I d="^BShigh" Q "%BS-самоповышение веpсии"
 I $E(d,$L(d)-1,$L(d))="in",$P($G(@$P(d,"in")),"@")["%BS-invert-" Q "%BS-Инвеpтиpованный к "_$P(d,"in")
 I $D(@d)["0" Q "?"
 S d=@d I $P(d,"@")="BSD - MSW" Q "%BS-База данных PART="_$P(d,"@",2)_" TABL="_$P(d,"@",3)
 I $P(d,"@")="BaSe MsW " Q "%BS-Раздел ;"_$P(d,"@",2)
 I $P(d,"@")["%BS-invert-" Q "%BS-Кодификатоp из PART="_$P($P($P(d,"@"),"-",3),",",1,2)_" TABL="_$P($P($P(d,"@"),"-",3),",",3)_" ;"_$P(d,"@",2)
 I $P(d,"@")["%BS-dinam" Q "%BS-М/Запросы PART="_$P($P($P(d,"@"),"-",3),",",1,2)_" TABL="_$P($P($P(d,"@"),"-",3),",",3)_" ;"_$P(d,"@",2)
 Q $$DELCTL^%ZAPM.ed.BSsFUNM(d)
e Q
GLOFK S %NAM=$P(d," ")
 I R3=83 S ^%ZAPM.ed.BSbufB(2,$G(%BS(3),$P),7)=%NAM D S,^%ZAPM.ed.BSMSMG(),CL^%ZAPM.ed.BSF4,R I $D(IntGO) K IntGO Q
 I R3=85 D  I %NAM["^" S %GLB=%NAM K %PAROL D ^%ZAPM.ed.BSGCH,PROTALL^%ZAPM.ed.BSF9
 .I '$$RP^%ZAPM.ed.BSGCH("^BSdirddp") S %NAM="" D ERRRVG^%ZAPM.ed.BS2 Q
 I R3=87 G DD:ny<2 D  K AllWAY Q:R1=27
 .I '$$AccesMSM^%ZAPM.ed.BSDOS2(3) D PROT^%ZAPM.ed.BSMSM Q
 .K AllWAY I $D(%DIA) S do="I i>1 S %NAM=$P($P(^(j),""@"",15),"" "") I %NAM'="""" D DelG^%ZAPM.ed.BSMSM(%NAM)" D BLOK^%ZAPM.ed.BSF1 Q
 .D DelG^%ZAPM.ed.BSMSM(%NAM) Q
 G DD
DelG(G) Q:G=""  D L^%ZAPM.ed.BS3($NA(@G)) Q:'LOC  D  D U^%ZAPM.ed.BS3($NA(@G)) Q
 .D YEG Q:'YES  K @G S R1=27 Q
 Q
YEG I '$D(%DIA) S ls=" УДАЛЯЕМ МАССИВ "_G_", ВЫ УВЕРЕНЫ ? ",%B=2 W $$bel^%ZAPM.ed.BS3 D YES^%ZAPM.ed.BSF Q
 I $D(%DIA),'$G(AllWAY) D Yes^%ZAPM.ed.BSXfun("УДАЛЯЕМ МАССИВ "_G_". Удалять С ПОДТВЕРЖДЕНИЕМ !!!",1) Q:YES<0  I 'YES D Yes^%ZAPM.ed.BSXfun(" ВЫ УВЕРЕНЫ ? Удалять ВСЕ ПОМЕЧЕННЫЕ МАССИВЫ БЕЗ ПОДТВЕРЖДЕНИЯ !",1) Q:YES<1  S AllWAY=1
 Q
DelR(G) Q:G=""  D YER Q:'YES  X "ZR  ZS @G ZL %BSMSM" S R1=27,ny=1
 Q
YER I '$D(%DIA) S ls=" УДАЛЯЕМ ПРОГРАММУ "_G_", ВЫ УВЕРЕНЫ ? ",%B=2 W $$bel^%ZAPM.ed.BS3 D YES^%ZAPM.ed.BSF Q
 I $D(%DIA),'$G(AllWAY) D Yes^%ZAPM.ed.BSXfun("УДАЛЯЕМ ПРОГРАММЫ "_G_". Удалять С ПОДТВЕРЖДЕНИЕМ !!!",1) Q:YES<0  I 'YES D Yes^%ZAPM.ed.BSXfun(" ВЫ УВЕРЕНЫ ? Удалять ВСЕ ПОМЕЧЕННЫЕ ПРОГРАММЫ БЕЗ ПОДТВЕРЖДЕНИЯ !",1) Q:YES<1  S AllWAY=1
 Q
ROFK S %NAM=$P(d," ")
 I R3=83 S ^%ZAPM.ed.BSbufB(2,$G(%BS(3),$P),4,4)=%NAM D S,^%ZAPM.ed.BSXprog(),CL^%ZAPM.ed.BSF4,R I $D(IntGO) K IntGO Q
 I R3=87 G DD:ny<2 D  K AllWAY Q:R1=27
 .I '$$AccesMSM^%ZAPM.ed.BSDOS2(3) D PROT^%ZAPM.ed.BSMSM Q
 .K AllWAY I $D(%DIA) S do="I i>1 S %NAM=$P($P(^(j),""@"",15),"" "") I %NAM'="""" D DelR^%ZAPM.ed.BSMSM(%NAM)" D BLOK^%ZAPM.ed.BSF1 Q
 .D DelR^%ZAPM.ed.BSMSM(%NAM) Q
DD G D^%ZAPM.ed.BS
TEST D OP^%ZAPM.ed.BSF4,SA^%ZAPM.ed.BSsBUF,^%ZAPM.ed.BSMSMV,RE^%ZAPM.ed.BSsBUF Q
S D SA^%ZAPM.ed.BSsBUF Q
R D RE^%ZAPM.ed.BSsBUF Q
PROTFUN() I $P($$ZU^%ZAPM.ed.BS3(0),",")'=$P($$ZU^%ZAPM.ed.BS3(1,0),",") D ErrMsg^%ZAPM.ed.BSXfun("Вы находитесь не в системном КИПе") Q 0
 I '$$AccesMSM^%ZAPM.ed.BSDOS2(2) D PROT^%ZAPM.ed.BSMSM Q 0
 Q 1
PROT D ErrMsg^%ZAPM.ed.BSXfun("Нарушение прав доступа для пользователя '"_$G(%BS(12))_"'") Q
ROLI W /CUP(23,1),$$clr^%ZAPM.ed.BS3(4),/EL(0),"    <Esc> - ОТМЕНА      <F4> - РЕДАКТИРОВАТЬ      <F8> - УДАЛИТЬ  ",$$atr^%ZAPM.ed.BS3(0) Q
GLOLI W /CUP(23,1),$$clr^%ZAPM.ed.BS3(4),/EL(0)," <Esc> - ОТМЕНА <F4> - РЕДАКТИРОВАТЬ <F6> - ХАРАКТЕРРИСТИКИ <F8> - УДАЛИТЬ ",$$atr^%ZAPM.ed.BS3(0) Q
]]></Routine>


<Routine name="%ZAPM.ed.BSMSMF" type="MAC" languagemode="0"><![CDATA[
%BSMSMF ;РЕДАКТИРОВАНИЕ ФУНКЦИЙ                             ; 10:18   17.06.99
 S IYI="^%ZAPM.ed.BSS(FUN_ED" D ENTER^%ZAPM.ed.BSN Q
ROU ;ВХОД В ПРОГРАММУ
 S LA=$P(d,"^"),RO=$P(d,"^",2) ;X:'$D(^ (RO)) "ZR  ZI LA_"" ;..."" ZS @RO" X "ZL @RO F i=0:1 Q:$T(+i)=""""  I $P($P($T(+i),"" ""),""("")=LA Q"
 D ^%ZAPM.ed.BSX("PROG",RO,i_",1") Q
HELP Q:d=""  S Br=$P(d,"("),Bt=$P(d,"(",2) Q:Bt=""  I '$D(@(Br_"(Bt)")) S $P(@$ZR,"@",17)=5 ;BSr1="^%ZAPM.ed.BSS",BSt1="NEW4",BSr2=Br,BSt2=Bt D COPY^%ZAPM.ed.BSTK
 S IYI=d D NE^%ZAPM.ed.BSN
e Q
RSE(N) ;ВХОД В ПРОГРАММУ ИЗ СПИСКА
 N (%BS,vl,N)
RS S BSR="^%ZAPM.ed.BSbufB",BST="%RSEBUF"_N D ^%ZAPM.ed.BST Q:$G(YES)<1
 S d=$P($G(@BSR@(BST,YES)),":") Q:$E(d)="-"  S RO=$P(d,"+"),i=$P(d,"+",2)
 D ^%ZAPM.ed.BSX("PROG",RO,i_",1") G RS
 Q
DosRec(NumDev,%FN) ;ОТКРЫТИЕ УСТРОЙСТВА HFS=%DEV ДЛЯ ДОЗАПИСИ
 I $ZV["Cach"||($ZV["IRIS") Q "ПОКА НЕ УМЕЮ ДОПИСЫВАТЬ В ФАЙЛ"
 S YES=1,%zT=$ZT,$ZT="DosErr^%ZAPM.ed.BSMSMF"
 F %DEV=$G(NumDev,51):1:54 O %DEV::0 Q:$T
 I '$T K %DEV S YES=-1 G DosEnd
 O %DEV:(%FN:"A") U %DEV I $ZA<0 U 0 S YES=-2 C %DEV G DosEnd
DosEnd U 0 Q YES
DosErr S $ZT=$G(%zT) Q $ZE
Tex(T,MODE) ;СИСТЕМНЫЙ ПРОТОКОЛ
 N %DEV,%FN i '$d(%BS(44)) D VAR^%ZAPM.ed.BSCh 
 I '$P($G(%BS(44)),",",3) Q  //ЛОГИ ОТКЛЮЧЕНЫ
 i $G(%BS(24,1))="" d VARI^%ZAPM.ed.BSC4
 I $E(%BS(24,1))="^" D  Q
 .n msg,t1 S msg(2)=": "_$G(MODE)_" :IP="_$G(%BS(41))_" :$J="_$J_" :%BScfg="_$$CFG^%ZAPM.ed.BSCp
 .S @%BS(24,1)@($P($$h^%ZAPM.ed.BS3(),","),$ZT($P($$h^%ZAPM.ed.BS3(),",",2),1)_".."_$INCREMENT(^mtempBSprot),"U")=$G(%BS(12),$G(BSLOGIN,"???"))
 .s msg(1)="User: "_@$zr
 .S ^("S")=msg(2)
 .S ^("A")=T  s msg(3)="Action: "_T I $E(T,1,5)="Error" d
 ..i $P($g(%BS(44)),",",1) D SYSMSG^%ZAPM.ed.BSCek(T,"E")
 ..i $P($g(%BS(44)),",",2) D ADDNEWMAIL^%ZAPM.ed.BSCmail($P($P($$GETOPT^%ZAPM.ed.BSC4cfgP("^%ZAPM.ed.BSETUP(""ISS"")","Admin"),"@",1),"<",2),"BSystemGuard",msg(3)_$C(13,10)_msg(2)_$C(13,10)_msg(1),T)
 .I T["Change" D
 ..i $P($g(%BS(44)),",",2) D ADDNEWMAIL^%ZAPM.ed.BSCmail($P($P($$GETOPT^%ZAPM.ed.BSC4cfgP("^%ZAPM.ed.BSETUP(""ISS"")","Admin"),"@",1),"<",2),"BSystemGuard",msg(3)_$C(13,10)_msg(2)_$C(13,10)_msg(1),T)
 I $ZV["Cach"||($ZV["IRIS") Q
 Q:$$DosRec(51,$$AddFile^%ZAPM.ed.BSDOS2(%BS(24,1)))'=1
 S T="§"_$$ESDAY^%ZAPM.ed.BSsFUNR(9,$$h^%ZAPM.ed.BS3())_"§User:"_$G(%BS(12),"???")_"§SysVol:"_$P($$ZU^%ZAPM.ed.BS3(1,0),",",2)_"§$$:"_T_"§$$h^%ZAPM.ed.BS3():"_$$h^%ZAPM.ed.BS3()
 U %DEV W T,! C %DEV Q
LOCK I $E(%BS(24,1))="^",$$Data^%ZAPM.ed.BSF12(%BS(24,1)) L +@%BS(24,1)@($P($$ZU^%ZAPM.ed.BS3(1,0),",",2),$G(%BS(12),"???")):0 E  W /BEL,!!!,"Конфликт систем MSM !",!,$P($$ZU^%ZAPM.ed.BS3(1,0),",",2)," Уже работает !" H
 Q
UNLOCK I $E(%BS(24,1))="^",$$Data^%ZAPM.ed.BSF12(%BS(24,1)) L -@%BS(24,1)@($P($$ZU^%ZAPM.ed.BS3(1,0),",",2),$G(%BS(12),"???"))
 Q
REGO I $ZV["Cach"||($ZV["IRIS") Q  //D Tex("Login") Q       
 D Tex("Begin%BSv"_+^%ZAPM.ed.BS),LOCK Q
REGB D Tex("BeginStop") Q
REGE I $ZV["Cach"||($ZV["IRIS") D Tex("TermLogout") Q      
 D Tex("Exit%BSv"_+^%ZAPM.ed.BS),UNLOCK Q
MOUNT(I) D Tex("Mount"_I_" ") Q
UNMOU(I) D Tex("Dismount "_I_" ") Q
ER D Tex("Error:"_$G(ls)_" ="_$ZE_" "_$$ErrSay^%ZAPM.ed.BSF8($ZE)) Q
SAVE ;СОХРАНЕНИЕ ТЕКСТА ТЕСТА
 N V,%DEV,I,II,%FN Q:$G(%BS(24,2))=""  Q:$$DosRec(51,$$AddFile^%ZAPM.ed.BSDOS2(%BS(24,2)))'=1
 S T="§"_$$ESDAY^%ZAPM.ed.BSsFUNR(9,$$h^%ZAPM.ed.BS3())_"§User:"_$G(%BS(12),"???")_"§SysVol:"_$P($$ZU^%ZAPM.ed.BS3(1,0),",",2)_"§$$:TestSys§$$h^%ZAPM.ed.BS3():"_$$h^%ZAPM.ed.BS3()
 U %DEV W !,$TR($J("",78)," ","="),!,T,!,$TR($J("",78)," ","-")
 U %DEV W !,"=="
 S V="" F I=1:1  Q:'$D(@BSR@(BST,I))  S II=$P(@BSR@(BST,I,1),"@",15) D  I II'="" U %DEV W !,II U 0
 .I $E(II,1)=" " S $E(II,1,2)="| " Q
 .I $E(II,6,8)=V  S II="| "_II Q
 .S V=$E(II,6,8) U %DEV W !,"|=" S II="| "_II Q
 U %DEV W !,"==",! C %DEV U 0 Q
DDPDIR ;ОБНОВЛЕНИЕ ССЫЛКИ
 ;|I '$$RP^%ZAPM.ed.BSGCH("^BSdirddp") Q  ;МЫ В RVG
 S DOUCI="S $P(^BSdirddp,""@"",2)=$$ZU^%ZAPM.ed.BS3(1,0) I 0",DOX="" D STA^%ZAPM.ed.BSF5 Q
DIR() N A S A=$P($G(^%ZAPM.ed.BSETUP("PATH",2,4)),"@",15) I A="" Q A
 I $E(A,$L(A))'="\" S A=A_"\"
 Q A
]]></Routine>


<Routine name="%ZAPM.ed.BSMSMG" type="MAC" languagemode="0"><![CDATA[
%BSMSMG(G) ;ПРОСМОТР МАССИВОВ ; 15:12   14.01.2000
 I '$$AccesMSM^%ZAPM.ed.BSDOS2(1) G PROT^%ZAPM.ed.BSMSM
 D LOCK^%ZAPM.ed.BSF4 I $G(%BS(13))="%BS-PC" d SaveWin^%ZAPM.ed.BSXfun(1,1,25,80),ClearDis
 U $I::%BS(32) N IntRef
 I $G(G)'="",G["^" S ^%ZAPM.ed.BSbufB(2,$G(%BS(3),$P),7)=G K G
0 K GL S li=$G(^%ZAPM.ed.BSbufB(2,$G(%BS(3),$P),7))
00 I $D(G),G'["^",G'="",$D(@G)>0 S GL=G,IntRef=G K G G 000
 D GLO^%ZAPM.ed.BSF3 G:'$D(GL) EXIT G:'YES EXIT
 I GL["~D" D ^%ZAPM.ed.BSMSMS(2,GL) G:dat="" 0 S GL="^"_dat
000 S glo=GL I '$D(@GL) D Yes^%ZAPM.ed.BSXfun(" Global "_GL_" does not exist!, we will create?",2) G:'YES ESHE F i=1,2,3 S @(GL_"(i)")=i
 S ^%ZAPM.ed.BSbufB(2,$G(%BS(3),$P),7)=GL
 N Sp,FIL,L,Pg,Ha
 S Sp=8000,FIL=$G(^%ZAPM.ed.BSbufB(2,$G(%BS(3),$P),7,1)) D CL^%ZAPM.ed.BSF4 S L=0,LL=20 I FIL="" S FIL="I 1"
H D HOME S L=0,g1=g
 ;ОБЩИЙ ЦИКЛ
L S g=$$ZO(g,Ha) I g="" S g=$S(Ha>0:glo,1:glo_"("""")"),L=0 W $$bel^%ZAPM.ed.BS3 G PAUSE:HHH,PAUSE:FIL'=1 D  G L
 .I g["(" D HOME Q
 .E  D END
 W $$clr^%ZAPM.ed.BS3(8),g,$$atr^%ZAPM.ed.BS3(0),$$W(@g),$$atr^%ZAPM.ed.BS3(0),!
 I Pg D LO I L>LL G PAUSE
 I 'Pg,Sp F i=1:1:Sp S ii=123 ;ЗАДЕРЖКА
READ R *r1:0,*r2:0,*r3:0 G L:r1<0
 I r1=43,r2=-1 S Sp=Sp-1000 S:Sp<0 Sp=0 G L
 I r1=45,r2=-1 S Sp=Sp+1000 S:Sp>8000 Sp=8000 G L
PAUSE W $$clr^%ZAPM.ed.BS3(4),/CUP(24,1),/EL(0)," <F1>-Help <F4>-Edit <F5>-Tree <F6>-Filter <F7>-Index <+->-SPEED: " D  W " ",$S(Pg:" ",Ha>0:"=",1:"=")," ",$$atr^%ZAPM.ed.BS3(0)
 .W $S(Sp=8000:"MIN",Sp=7000:"MIn",Sp=6000:"Min",Sp=5000:"min",Sp=4000:"max",Sp=3000:"Max",Sp=2000:"MAx",1:"MAX")
PA W $$rt^%ZAPM.ed.BS3(+$G(%BS(2),9999)) S HHH=0,L=0,LL=20 I R1=-1,%BS(13)="%BS-PC" D GLUC^%ZAPM.ed.BSXgluc G PA
 I R1=27,R2=-1 K GL G:$D(IntRef) EXIT G 0
 S L=0 I R1=27,R2=91,R3=66 S Pg=0,Ha=1 W ! G L ;ВНИЗ
 I R1=27,R2=91,R3=65 S Pg=0,Ha=-1 W ! G L      ;ВВЕРХ
 I R1=0,R2=71 D HOME G L
 I R1=0,R2=79 D END G L
 I R1=0,R2=81 S Pg=1,Ha=1,L=0 D P G L
 I R1=0,R2=73 S Pg=1,Ha=-1,L=0 D P G L
 I R1=27,R2=79,R3=84 D ^%ZAPM.ed.BSTREE(glo),HOME G L
 I R1=27,R2=79,R3=83 D  G L
 .I '$$AccesMSM^%ZAPM.ed.BSDOS2(2) D PROT^%ZAPM.ed.BSMSM Q
 .D:Ha>0  D EDIT,CL^%ZAPM.ed.BSF4 S Pg=1,Ha=1,L=0 S:G'="" g=G W /CUP(1,1),/ED(2)
 ..S GG=g F i=1:1:15 S GG=$$ZO(GG,-1) Q:GG=""  S g=GG
 I R1=27,R2=79,R3=86 D INDX S Ha=1,L=0,Pg=1 W /CUP(1,1),/ED(2) G L
 I R1=27,R2=79 D  G L:$ZV["Cach"||($ZV["IRIS"),PAUSE
 .I R3=80 D HELP Q
 .I R3=85 D FILT Q
 G PAUSE
e Q
 ///z 
ClearDis w $$esc^%ZAPM.ed.BS3(7),$$atr^%ZAPM.ed.BS3("2;37;44"),/CUP(1,1),/ED(2)
 //zw /CUP(22,47),"%ZAPM.editor "_+^%ZAPM.ed.BS
 w $$atr^%ZAPM.ed.BS3("2;37;40"),/CUP(23,1),/EL(0),/CUP(24,1),/EL(0),/CUP(25,1),/EL(0),/CUP(1,1) 
 Q
ZO(g,Ha) 
Z1 I g[")("""")" S g=$$TR^%ZAPM.ed.BSsFUNM(g,")("""")",")")
 S g=$ZO(@g,Ha) I g="" Q ""
 X FIL I  Q g
 G Z1
W(g) //i $tr(%S,$c(127,5))'=%S s %S=$tr(%S,$c(127,5),$c(174,169))
 I $TR(g,$C(0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,127),"")'=g W $$clr^%ZAPM.ed.BS3(10)
 Q $TR(g,$C(0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,127),$c(174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174))
P W /ED(2),/CUP(1,1) Q
LO S L=L+(($L(g)+$L($G(@g)))\79)+1 Q
HI W /ED(2),/CUP(1,1),$$clr^%ZAPM.ed.BS3(12),g,$$atr^%ZAPM.ed.BS3(0) I $D(@g)'["0" W $$W(@g),$$atr^%ZAPM.ed.BS3(0)
 W ! D LO Q
HELP S IYI="^%ZAPM.ed.BSHLP(HELPGL" D N^%ZAPM.ed.BSN("IYI"),ENTER^%ZAPM.ed.BSN,Q^%ZAPM.ed.BSN("IYI") D  Q
 .I $ZV["Cach"||($ZV["IRIS") D HOME
EDIT S:g["("""")" g=$P(g,"(") D ^%ZAPM.ed.BSMSMGE(g) Q
FILT S li=FIL,%hlp="^%ZAPM.ed.BSHLP(HELP_F",ls=" Enter View Filter (g = link, @g = data) F1-Help "
 S %HIS="^%ZAPM.ed.BSbufB(""HISARREYFILTR"_$S('$E(%BS(1),12):$G(%BS(3),$P)_$G(%BS(12)),$E(%BS(1),12)=1:"1"_$G(%BS(12)),1:"1")_""")" D LE^%ZAPM.ed.BSTT Q:'YES
 S %zT=$ZT,$ZT="ERRF^%ZAPM.ed.BSMSMG" S:li="" li="I 1" X li
 S $ZT=%zT,FIL=li I $ZV["Cach"||($ZV["IRIS") D HOME
 Q
INDX S li=$S($G(^%ZAPM.ed.BSbufB(0,$G(%BS(3),$P),8))[$P(g,"("):$G(^%ZAPM.ed.BSbufB(0,$G(%BS(3),$P),8)),1:g),li=$$LineEdit^%ZAPM.ed.BSXfun(li,"Введите ссылку массива ","","","","^%ZAPM.ed.BSbufB(""HISARREYINDX"_$S('$E(%BS(1),12):$G(%BS(3),$P)_$G(%BS(12)),$E(%BS(1),12)=1:"1"_$G(%BS(12)),1:"1")_""")") Q:'YES!(li="")
 S %zT=$ZT,$ZT="ERR^%ZAPM.ed.BSMSMG" I $D(@li)'["0" S li=$$ZO(li,-1)
 S $ZT=%zT,Ha=1,(g,^%ZAPM.ed.BSbufB(0,$G(%BS(3),$P),8))=li Q
END S g=$$ZO((glo_"("""")"),-1),Ha=-1,Pg=1,HHH=1 D HI Q
HOME S g=glo,Ha=1,Pg=1,HHH=1 D HI Q
ESHE S li=GL G 00
EXIT D OP^%ZAPM.ed.BSF4 D LoadWin^%ZAPM.ed.BSXfun W $$esc^%ZAPM.ed.BS3(8) Q
ERRF S ls=$ZE D O^%ZAPM.ed.BSF7 G FILT
ERR S ls=$ZE D O^%ZAPM.ed.BSF7 G INDX
]]></Routine>


<Routine name="%ZAPM.ed.BSMSMGE" type="MAC" languagemode="0"><![CDATA[
%BSMSMGE(GLO) ;ПОЛНОЭКРАННЫЙ РЕДАКТОР МАССИВОВ (I PART) ; 13:36   28.02.99
 N GG,i,ii,iii,Y1,Y2,YY,XX,Y,X,YES,%YES,W,S,M,EDI,R1,R2,R3,%CO,%LO,%LL,q0,q3,%ES,%EC,I,II,III,I1,I2
 D L^%ZAPM.ed.BS3(GLO) I 'LOC G EXIT
 I '$D(FIL) S FIL="I 1"
 S EDI=0,%YES=1 D LOCK^%ZAPM.ed.BSF4
 D CL^%ZAPM.ed.BSF4,%LOCK^%ZAPM.ed.BSMSMGI G %U
D ;Delite
 S K1=($L($P(M($P(S(YY),"/",3),1),"(",2))+$L(S($P(S(YY),"/",3),1)))\(79-$L($P(M($P(S(YY),"/",3),1),"(")))+1
DBEG I YY=$P(S(YY),"/",3) G:XX=$P(S(YY),"/") %C S S(YY,1)=$E(S(YY,1),1,XX-$P(S(YY),"/")-1)_$E(S(YY,1),XX-$P(S(YY),"/")+1,$$LNG^%ZAPM.ed.BSF12),XX=XX-1 D  G DEND
 .W /CUP(YY,XX),/EL(0),$E(S(YY,1),XX-$P(S(YY),"/")+1,$P(S(YY),"/",5)) S III=YY F  S III=$O(S(III)) Q:III=""  Q:$P(S(III),"/",3)'=YY  W /CUP(III,$P(S(III),"/")),/EL(0),$E(S(YY,1),$P(S(III),"/",4),$P(S(III),"/",5))
 I XX'>$P(S(YY),"/") S YY=YY-1,XX=80 G DBEG
 S S($P(S(YY),"/",3),1)=$E(S($P(S(YY),"/",3),1),1,$P(S(YY-1),"/",2)+XX-$P(S(YY),"/")-1)_$E(S($P(S(YY),"/",3),1),$P(S(YY-1),"/",2)+XX-$P(S(YY),"/")+1,$$LNG^%ZAPM.ed.BSF12),XX=XX-1 D  ;
 .W /CUP(YY,XX),/EL(0),$E(S($P(S(YY),"/",3),1),$P(S(YY),"/",4)+(XX-$P(S(YY),"/")),$P(S(YY),"/",5)) S III=YY,II=$P(S(YY),"/",3)
 .F  S III=$O(S(III)) Q:III=""  Q:$P(S(III),"/",3)'=II  W /CUP(III,$P(S(III),"/")),/EL(0),$E(S($P(S(YY),"/",3),1),$P(S(III),"/",4),$P(S(III),"/",5))
DEND S K2=($L($P(M($P(S(YY),"/",3),1),"(",2))+$L(S($P(S(YY),"/",3),1)))\(79-$L($P(M($P(S(YY),"/",3),1),"(")))+1
 S YES="",M($P(S(YY),"/",3),3)="" I K1>K2 D YES S (I3,Y)=$P(S(YY),"/",3) D  D PUT,REM I XX<$P(S(YY),"/") S YY=YY-1,XX=80
 .S G=M(Y,1),Y=I3 D  D FOR,LOO S Y=I3-1 Q
 ..F I=I3:1:25 K M(I),S(I)
 G %C
KS(%1,%2) Q ($L($P(%1,"(",2))+$L(%2))\(79-$L($P(%1,"(")))+1
%U W /CUP(1,1),$$atr^%ZAPM.ed.BS3(0),/ED(2)
 S W=$E($$GetLock^%ZAPM.ed.BSXfun()),P=1 ;P=0-ПОЛЕ ИНДЕКСОВ/МЕТОК,1-СТРОК ;
BEGI I $D(@GLO)=0 G EXIT
 S Y=1,G=GLO K M,S D:$D(@G)'["0" FOR D CL,LOO S Y=0 D PUT,REM S YY=$O(S("")),Y1=1,Y2=0,XX=$P(S(YY),"/")
%C F  R *R:0  E  Q
 W /CUP(YY,XX) W $$rt^%ZAPM.ed.BS3(+$G(%BS(2),9999)) I R1=-1,%BS(13)="%BS-PC" D GLUC^%ZAPM.ed.BSXgluc G %C
 I R1=27,R2<0 D YES G EXIT
 I R1=12 D YES G H^%ZAPM.ed.BSMSMGO
 I R1=20 D YES G N^%ZAPM.ed.BSMSMGO
 I R1=10 G J^%ZAPM.ed.BSMSMGO //UNDO
 I R1=11 D YES G K^%ZAPM.ed.BSMSMGO
 G %C:$E(%CO,R1+1)=" ",@$E(%CO,R1+1):$E(%CO,R1+1)'="S" D  G %C
 .D ref(1) q
 .S K1=($L($P(M($P(S(YY),"/",3),1),"(",2))+$L(S($P(S(YY),"/",3),1)))\(79-$L($P(M($P(S(YY),"/",3),1),"(")))+1 I $L(S($P(S(YY),"/",3),1))>509,W W $$bel^%ZAPM.ed.BS3 D REM Q
 .I YY=$P(S(YY),"/",3) S S(YY,1)=$S(XX'=$P(S(YY),"/"):$E(S(YY,1),1,XX-$P(S(YY),"/")),1:"")_$C(R1)_$E(S(YY,1),XX-$P(S(YY),"/")+2-W,$$LNG^%ZAPM.ed.BSF12) W $C(R1) D:W  G SEND
 ..W $E(S(YY,1),XX-$P(S(YY),"/")+2,$P(S(YY),"/",5)) S III=YY F  S III=$O(S(III)) Q:III=""  Q:$P(S(III),"/",3)'=YY  W /CUP(III,$P(S(III),"/")),$E(S(YY,1),$P(S(III),"/",4),$P(S(III),"/",5))
 .I ($P(S(YY-1),"/",2)+XX-$P(S(YY),"/")+1)=509 W $$bel^%ZAPM.ed.BS3 D REM Q
 .S S($P(S(YY),"/",3),1)=$E(S($P(S(YY),"/",3),1),1,$P(S(YY-1),"/",2)+XX-$P(S(YY),"/"))_$C(R1)_$E(S($P(S(YY),"/",3),1),$P(S(YY-1),"/",2)+XX-$P(S(YY),"/")+2-W,$$LNG^%ZAPM.ed.BSF12) W $C(R1) D:W  ;
 ..W $E(S($P(S(YY),"/",3),1),$P(S(YY),"/",4)+(XX-$P(S(YY),"/")+1),$P(S(YY),"/",5)) S III=YY,II=$P(S(YY),"/",3)
 ..F  S III=$O(S(III)) Q:III=""  Q:$P(S(III),"/",3)'=II  W /CUP(III,$P(S(III),"/")),$E(S($P(S(YY),"/",3),1),$P(S(III),"/",4),$P(S(III),"/",5))
SEND .S K2=($L($P(M($P(S(YY),"/",3),1),"(",2))+$L(S($P(S(YY),"/",3),1)))\(79-$L($P(M($P(S(YY),"/",3),1),"(")))+1
 .S YES="",M($P(S(YY),"/",3),3)="" I K1<K2 D YES S (I3,Y)=$P(S(YY),"/",3) D  D PUT,REM
 ..F I=Y:1 Q:'$D(S(I))  Q:Y'=$P(S(I),"/",3)
 ..I I>23 S GG=M($P(S(YY),"/",3),1),G=$O(M(0)),G=M(G,1),Y=0 K M,S D LOO D  S Y=0 W $$atr^%ZAPM.ed.BS3(0),/ED(2),/CUP(1,1) Q
 ...S YY="" F  S YY=$O(S(YY),-1) Q:M($P(S(YY),"/",3),1)=GG
 ...S XX=$P(S(YY),"/") Q
 ..S G=M(Y,1),Y=I3 D  D FOR,LOO S Y=I3-1 Q
 ...F I=I3:1:25 K M(I),S(I)
 .S XX=XX+1 I XX>80 S YY=YY+1 W /CUP(YY,1)," " S XX=$P($G(S(YY),XX),"/")+1 W /CUP(YY,XX-1),$C(R1) Q
E ;ESC-КОДЫ
 I %ES[R3 S I=$F(%ES,R3)-2 G @$E(%EC,I,I+1):$T(@$E(%EC,I,I+1))'=""
 G %C
Z ;НОЛЬ-КОДЫ
 I R2=113,$E(%BS(1),3) D YES G ALTF10^%ZAPM.ed.BSMSMGO
 I R2=84 D YES D SHIFTF1^%ZAPM.ed.BSMSMGO,SCREEN G HM^%ZAPM.ed.BSMSMGE
 I R2=20 D YES G ALTT^%ZAPM.ed.BSMSMGO
 I R2=37 D YES G KILL^%ZAPM.ed.BSMSMGO
 ;I R2=97 D YES D ref(1),SCREEN G HM^%ZAPM.ed.BSMSMGE  //F4
 I R2=98 D YES G F5^%ZAPM.ed.BSMSMGO
 I R2=99 D YES G F6^%ZAPM.ed.BSMSMGO
 I R2=100 D YES G F6^%ZAPM.ed.BSMSMGO
 I %ES[R2 S I=$F(%ES,R2)-2 G @$E(%EC,I,I+1):$T(@$E(%EC,I,I+1))'=""
 G %C
I ;
 S YY=YY+1 D:'$D(S(YY))  S XX=$P($G(S(YY),XX),"/") G %C
 .D YES S Y=0,GG=$$ZO(G,1) I GG="" W $$bel^%ZAPM.ed.BS3 D REM S YY=YY-1 Q
 .D WAIT S G=GG,K1=$$KS(G,@G) S K2=0 F  S Y=$O(M(Y)),K2=K2+$$KS(M(Y,1),S(Y,1)) Q:K1'>K2
 .S G=M(Y,1),Y=0 K M,S D LOO S Y=0 W $$atr^%ZAPM.ed.BS3(0),/ED(2),/CUP(1,1) D PUT F YY=23:-1:1 Q:$D(S(YY))
 .D REM Q
T ;
 S XX=XX+10 D  G %C
 .I XX>79 S YY=YY+1,XX=$P($G(S(YY),79),"/") Q
 .I $P(S(YY),"/",3)=YY,(XX-$P(S(YY),"/")+1)>$L(S(YY,1)) S XX=$P(S(YY),"/")+$L(S(YY,1)) Q
 .I $P(S(YY),"/",3)'=YY,(XX-$P(S(YY),"/")+1+$P(S(YY-1),"/",2))>$L(S($P(S(YY),"/",3),1)) S XX=$L(S($P(S(YY),"/",3),1))-$P(S(YY-1),"/",2)+$P(S(YY),"/") Q
ref(m) D
 .n i,g,G,ii,YES //РЕДАКТИРОВАТЬ В СТРОЧНОМ РЕДАКТОРЕ
 .S $ZT="ErRef"
 .S i=$P(S(YY),"/",3),G=M(i,1)
 .N S,M,YY,XX,oldata
 .S oldata=$G(@G)
 .I m=1 S i=$D(@G),ii=$G(@G),txt=G_"==="_$S(i["0":"НЕОПРЕДЕЛЕНО",ii="":"ПУСТО",1:"")
 .E  S i="",ii=G,txt="Редактируем индекс="_G
 .// //i $tr(%S,$c(127,5))'=%S s %S=$tr(%S,$c(127,5),$c(174,169))
 .i $TR(ii,$C(127,5),"")'=ii s ii=$TR(ii,$C(127,5),$c(174,169))
 .S S=$$LineEdit^%ZAPM.ed.BSXfun(ii,txt) Q:YES<1
 .i $tr(S,$c(174,169))'=S  s S=$tr(S,$c(174,169),$c(127,5))
 .I m,i["0",S="" D Yes^%ZAPM.ed.BSXfun("ВЫ ХОТИТЕ ВВЕСТИ ПУСТОЕ ЗНАЧЕНИЕ ?") Q:YES<1
 .i 'm S @S=oldata Q  //ИНДЕКС
 .S @G=S
 D SCREEN
 Q
ErRef D ErrMsg^%ZAPM.ed.BSXfun($ZE)
 Q
P ;ПЕРЕХОД НА ПОЛЕ ИНДЕКСОВ
F2 D YES D ref(0) g %C
 ;I '$D(Fname) S Fname="N:\123.TXT" I $ZU(140,4,Fname)'=0 O Fname:"UWN" U Fname W "-----",! W  W "-------",! U 0 C Fname 
 G ^%ZAPM.ed.BSMSMGI
TA ;
 S XX=XX-10 D  G %C
 .I XX<$P(S(YY),"/"),YY=$P(S(YY),"/",3) S XX=$P(S(YY),"/") Q
 .I XX<$P(S(YY),"/") S XX=79,YY=YY-1 Q
 .Q
LT ;
 S XX=XX-1 D  G %C
 .i '$d(S(YY)) Q
 .I XX<$P(S(YY),"/"),YY=$P(S(YY),"/",3) S XX=$P(S(YY),"/") Q
 .I XX<$P(S(YY),"/") S XX=79,YY=YY-1 Q
 .Q
RT ;
 S XX=XX+1 D  G %C
 .I XX>79 S YY=YY+1,XX=$P($G(S(YY),78),"/") Q
 .i '$d(S(YY)) Q
 .I $P(S(YY),"/",3)=YY,(XX-$P(S(YY),"/")+1)>$L(S(YY,1)) S XX=$P(S(YY),"/")+$L(S(YY,1)) Q
 .I $P(S(YY),"/",3)'=YY,(XX-$P(S(YY),"/")+1+$P(S(YY-1),"/",2))>$L(S($P(S(YY),"/",3),1)) S XX=$L(S($P(S(YY),"/",3),1))-$P(S(YY-1),"/",2)+$P(S(YY),"/") Q
 .Q
UP ;
 S YY=YY-1 D  G %C
 .I '$D(S(YY)) D YES D  Q
 ..S Y=0 I $$ZO(M($O(M("")),1),-1)="" W $$bel^%ZAPM.ed.BS3 S YY=YY+1 Q
 ..S G=$$ZO(M($O(M("")),1),-1) S Y2=1,Y=1 K M,S D FOR,LOO S Y=0 W $$atr^%ZAPM.ed.BS3(0),/ED(2),/CUP(1,1) D PUT,REM S YY=1,XX=$P($G(S(YY),XX),"/") Q
 .I XX<$P(S(YY),"/"),YY=$P(S(YY),"/",3) S XX=$P(S(YY),"/") Q
 .I $P(S(YY),"/",3)=YY,(XX-$P(S(YY),"/")+1)>$L(S(YY,1)) S XX=$P(S(YY),"/")+$L(S(YY,1)) Q
 .I $P(S(YY),"/",3)'=YY,(XX-$P(S(YY),"/")+1+$P(S(YY-1),"/",2))>$L(S($P(S(YY),"/",3),1)) S XX=$L(S($P(S(YY),"/",3),1))-$P(S(YY-1),"/",2)+$P(S(YY),"/") Q
 .Q
DN ;
 S YY=YY+1 D  G %C
 .I '$D(S(YY)) D YES D  Q
 ..S Y=0 S:G'="" GG=$$ZO(G,1) S:G="" GG=G I GG="" W $$bel^%ZAPM.ed.BS3 D REM S YY=YY-1 Q
 ..D WAIT S G=GG,K1=$$KS(GG,@GG),K2=0 F  S Y=$O(M(Y)),K2=K2+$$KS(M(Y,1),S(Y,1)) Q:K1'>K2
 ..S G=M(Y,1),Y=0 K M,S D LOO S Y=0 W $$atr^%ZAPM.ed.BS3(0),/ED(2),/CUP(1,1) D PUT S YY=$O(S(""),-1)
 ..D REM S XX=$P($G(S(YY),XX),"/") Q
 .I XX<$P(S(YY),"/"),YY=$P(S(YY),"/",3) S XX=$P(S(YY),"/") Q
 .I $P(S(YY),"/",3)=YY,(XX-$P(S(YY),"/")+1)>$L(S(YY,1)) S XX=$P(S(YY),"/")+$L(S(YY,1)) Q
 .I $P(S(YY),"/",3)'=YY,(XX-$P(S(YY),"/")+1+$P(S(YY-1),"/",2))>$L(S($P(S(YY),"/",3),1)) S XX=$L(S($P(S(YY),"/",3),1))-$P(S(YY-1),"/",2)+$P(S(YY),"/") Q
U ;
 D ref(1) G %C
 S K1=($L($P(M($P(S(YY),"/",3),1),"(",2))+$L(S($P(S(YY),"/",3),1)))\(79-$L($P(M($P(S(YY),"/",3),1),"(")))+1
 I YY=$P(S(YY),"/",3) S S(YY,1)=$E(S(YY,1),1,XX-$P(S(YY),"/"))_$E(S(YY,1),XX-$P(S(YY),"/")+2,$$LNG^%ZAPM.ed.BSF12) D  G DLED
 .W /CUP(YY,XX),/EL(0),$E(S(YY,1),XX-$P(S(YY),"/")+1,$P(S(YY),"/",5)) S III=YY F  S III=$O(S(III)) Q:III=""  Q:$P(S(III),"/",3)'=YY  W /CUP(III,$P(S(III),"/")),/EL(0),$E(S(YY,1),$P(S(III),"/",4),$P(S(III),"/",5))
 S S($P(S(YY),"/",3),1)=$E(S($P(S(YY),"/",3),1),1,$P(S(YY-1),"/",2)+XX-$P(S(YY),"/"))_$E(S($P(S(YY),"/",3),1),$P(S(YY-1),"/",2)+XX-$P(S(YY),"/")+2,$$LNG^%ZAPM.ed.BSF12) D  G DLED
 .W /CUP(YY,XX),/EL(0),$E(S($P(S(YY),"/",3),1),$P(S(YY),"/",4)+(XX-$P(S(YY),"/")),$P(S(YY),"/",5)) S III=YY,II=$P(S(YY),"/",3)
 .F  S III=$O(S(III)) Q:III=""  Q:$P(S(III),"/",3)'=II  W /CUP(III,$P(S(III),"/")),/EL(0),$E(S($P(S(YY),"/",3),1),$P(S(III),"/",4),$P(S(III),"/",5))
DLED S K2=($L($P(M($P(S(YY),"/",3),1),"(",2))+$L(S($P(S(YY),"/",3),1)))\(79-$L($P(M($P(S(YY),"/",3),1),"(")))+1
 S YES="",M($P(S(YY),"/",3),3)="" I K1>K2 W $$esc^%ZAPM.ed.BS3("[J") D YES S (I3,Y)=$P(S(YY),"/",3) D  D PUT,REM I XX'>$P(S(YY),"/"),YY'=$P(S(YY),"/",3) S YY=YY-1,XX=80
 .S G=$G(M(Y,2),M(Y,1)),Y=I3 D  D FOR,LOO S Y=I3-1 Q
 ..F I=I3:1:25 K M(I),S(I)
 G %C
IN ;
 S W=$S(W=0:1,1:0) D REM G %C ;ВСТАВКА СИМВОЛА
L ;
 S K1=($L($P(M($P(S(YY),"/",3),1),"(",2))+$L(S($P(S(YY),"/",3),1)))\(79-$L($P(M($P(S(YY),"/",3),1),"(")))+1
 I YY=$P(S(YY),"/",3) S S(YY,1)=$E(S(YY,1),1,XX-$P(S(YY),"/")) W /CUP(YY,XX),/EL(0) G ELED
 S S($P(S(YY),"/",3),1)=$E(S($P(S(YY),"/",3),1),1,$P(S(YY-1),"/",2)+XX-$P(S(YY),"/")) W /CUP(YY,XX),/EL(0)
ELED S K2=($L($P(M($P(S(YY),"/",3),1),"(",2))+$L(S($P(S(YY),"/",3),1)))\(79-$L($P(M($P(S(YY),"/",3),1),"(")))+1
 S YES="",M($P(S(YY),"/",3),3)="" I K1>K2 W $$esc^%ZAPM.ed.BS3("[J") D YES S (I3,Y)=$P(S(YY),"/",3) D  D PUT,REM I XX'>$P(S(YY),"/"),YY'=$P(S(YY),"/",3) S YY=YY-1,XX=80
 .S G=$G(M(Y,2),M(Y,1)),Y=I3 D  D FOR,LOO S Y=I3-1 Q
 ..F I=I3:1:25 K M(I),S(I)
 G %C
PD ;
 D YES S G=M($O(M(""),-1),1) I $$ZO(G,1)="" W $$bel^%ZAPM.ed.BS3 D REM G %C
 S Y=0 K M,S D LOO S Y=0,YY=0,Y2=0 W $$atr^%ZAPM.ed.BS3(0),/ED(2),/CUP(1,1) D PUT,REM G I
HM ;
 S YY=$P(S(YY),"/",3),XX=$P($G(S(YY),XX),"/") G %C
PU ;
 D YES I $O(M(""))="" W $$bel^%ZAPM.ed.BS3 G HM
 I $$ZO(M($O(M("")),1),-1)="" W $$bel^%ZAPM.ed.BS3 G HM
 D PUU G I
PUU S Y=0,GG=$O(M("")) I GG="" S G=GLO G PUU1
 S (GG,G)=M($O(M("")),1) F i=1:1:20 S GG=$$ZO(GG,-1) Q:GG=""  S G=GG
PUU1 S:GG'="" G=GG K M,S D LOO S Y=0,YY=0 W $$atr^%ZAPM.ed.BS3(0),/ED(2),/CUP(1,1) D PUT,REM Q
WAIT D WAIT^%ZAPM.ed.BSF2 Q
EN ;
 S i=$P(S(YY),"/",3) F ii=YY:1 Q:$P($G(S(ii)),"/",3)'=i  S iii=ii
 S YY=iii,XX=78 G RT
F1 ;
 S IYI="^%ZAPM.ed.BSHLP(HELPGE" D F0 D  G %C
 .I $ZV["Cach"||($ZV["IRIS") D SCREEN
F0 D N^%ZAPM.ed.BSN("IYI"),ENTER^%ZAPM.ed.BSN,Q^%ZAPM.ed.BSN("IYI"),%LOCK^%ZAPM.ed.BSMSMGI Q
YES Q:'$D(YES)  S %zT=$ZT,$ZT="ERR^%ZAPM.ed.BSMSMGI"
YE S I="" F  S I=$O(M(I)) Q:I=""  I M(I)="KILL" X $S(%YES:"K @M(I,1),M(I)",1:"S EDI=EDI+1,EDI(EDI)=0,EDI(EDI,1)=M(I,1)")
 S I="" F  S I=$O(M(I)) Q:I=""  I $D(M(I,3)) X $S(%YES:"S @M(I,1)=S(I,1)",1:"S EDI=EDI+1,EDI(EDI)=1,EDI(EDI,1)=M(I,1),EDI(EDI,2)=S(I,1)")
 K YES S $ZT=$G(%zT) Q
FOR ;ФОРМИРОВАНИЕ СТРОКИ G-ГЛ.ССЫЛКА,Y-ИНДЕКСЫ   M(...,S(...
 S M(Y,1)=G,M(Y)=($L($P(G,"("))+1),S(Y)=($L(G)+1)_"/"_(79-$L(G))_"/"_Y_"/1/"_(79-$L(G)),II1=(79-$L(G)),S(Y,1)=@G,II=0
 S K1=($L($P(M(Y,1),"(",2))+$L(S(Y,1)))\(79-$L($P(M(Y,1),"(")))+1
 I K1>1 S I1=80-$L(G) F II=1:1:K1-1 S II1=II1+(79-M(Y)+1),S(Y+II)=M(Y)_"/"_II1_"/"_Y_"/"_I1_"/"_(I1+(79-M(Y))),I1=I1+(79-M(Y)+1)
 S Y=Y+II Q
PUT ;ПЕЧАТЬ СТРОКИ
 S I=$O(M(Y)) Q:I=""  D:I'["."  F  S I=$O(M(I)) Q:I=""  I I'["." D  ;
 .W /CUP(I,1) //,$$esc^%ZAPM.ed.BS3("[J")
 .W $$clr^%ZAPM.ed.BS3(11),M(I,1),$$atr^%ZAPM.ed.BS3(0),$E(S(I,1),1,$P(S(I),"/",5)) S III=I F  S III=$O(S(III)) Q:III=""  Q:$P(S(III),"/",3)'=I  W /CUP(III,$P(S(III),"/")),$E(S(I,1),$P(S(III),"/",4),$P(S(III),"/",5))
 .Q
 Q
LOO ;ЦИКЛ ПО ГЛОБАЛИ G=^NAM(...)
 S I2=G F  Q:Y>23  S Y=Y+1,I2=G,G=$$ZO(G,1) Q:G=""  D FOR
 I $D(S(Y)) S II=$P(S(Y),"/",3) F I=II:1:Y K M(I),S(I)
 Q
ZO(g,Ha) ;
Z1 S g=$ZO(@g,Ha) I g="" Q ""
 X FIL I  Q g
 G Z1
EXIT D U^%ZAPM.ed.BS3(GLO) D OP^%ZAPM.ed.BSF4 W $$atr^%ZAPM.ed.BS3(0) Q
CL D CL^%ZAPM.ed.BSF4 Q
SCREEN S Y=0,G=M($O(M("")),1),GG=$$ZO(G,-1) S:GG="" GG=$P(G,"(") S:GG'="" G=GG K M,S D LOO S Y=0 W $$atr^%ZAPM.ed.BS3(0),/ED(2) D PUT,REM Q
OP D OP^%ZAPM.ed.BSF4 Q
REM W $$clr^%ZAPM.ed.BS3(4),/CUP(24,1),/EL(0)," <F1>-Help <Ctrl-K>-Delete node <Ctrl-P>-Indexes <Esc>-Exit " D  W $$atr^%ZAPM.ed.BS3(0) Q
 .W $S(W:"Insert",1:"Replace")  ;"Insert",1:"Replace") 
e Q
]]></Routine>


<Routine name="%ZAPM.ed.BSMSMGF" type="MAC" languagemode="0"><![CDATA[
%BSMSMGF ; ПАКЕТНАЯ РАБОТА С ГЛОБАЛАМИ ; 17:54   23.12.1999
 Q
PROTOKOL(N) ;ПРОТОКОЛ РАБОТЫ
 N (%BS,vl,N) S BSR="^%ZAPM.ed.BSbufB",BST="%RSGBUF"_N D ^%ZAPM.ed.BST
 Q
NAKED(G) ;РАБОТА С ССЫЛКОЙ
 S t0=G_" ="_@G W !,t0 D CR^%ZAPM.ed.BSTT
 Q
FIND N PROX ;ПОИСК
 S PROX=1
FI N %GSEL,%GTEMP,FIND,%SE,%ST,%X,G,GG,g,g,t,t0,Coment,BSr,BSt,Obraz,%G,%JO
 S %zT=$ZT,$ZT="ER^%ZAPM.ed.BSMSMGF"
 Q:'$$SEL
ASK3 D OP^%ZAPM.ed.BSF4 S %X=$$LineEdit^%ZAPM.ed.BSXfun("","Введите подстроку","","","",$$HISFIND^%ZAPM.ed.BSS()) I %X="",'$D(%SE(1)) Q
 I '$G(REPLAY),%X'="" S %ST=$G(%ST)+1,%SE(%ST)=%X G ASK3
 I $G(REPLAY) S %SE(1)=%X,%ST=1,REPLAY=$$LineEdit^%ZAPM.ed.BSXfun("","На что заменим ?") D Yes^%ZAPM.ed.BSXfun("С подтверждением ?",1) S REPLA=YES
GO D TXT(PROX) S G="" F  S G=$O(@%GTEMP@(G)) Q:G=""  S g="^"_G F  S g=$ZO(@g) Q:g=""  D  I $D(STOP) ZT "EXIT"
 .F I=1:1:%ST I @g[%SE(I) D NAKED(g) I $D(REPLAY) D REPL(REPLA>0) U 0 W $$atr^%ZAPM.ed.BS3(0),/ED(2),/CUP(1,1)
EXIT D QU Q
ER I $ZE["ZEXI" D ErrMsg^%ZAPM.ed.BSXfun("Прервано...") S $ZT=$G(%zT) G EXIT
 D ErrMsg^%ZAPM.ed.BSXfun($ZE_" "_$$ErrSay^%ZAPM.ed.BSF8($ZE)) S $ZT=$G(%zT) G EXIT
REPL(Y) I Y W !!,"Заменим на: ",$$TR^%ZAPM.ed.BSsFUNM(@g,%SE(1),REPLAY),!!,"[E]-Редактор ручками...Есть варианты, выберай [Y/N/E/Q] <N>" R *Y S Y=$C(Y) Q:("N"_$C(13))[Y  I Y="E" D  Q
 .S Y=$$LineEdit^%ZAPM.ed.BSXfun(@g,g) Q:YES<0  S @g=Y
 I "^Q"[Y S STOP=1
 S @g=$$TR^%ZAPM.ed.BSsFUNM(@g,%SE(1),REPLAY)
 Q
SEL() U 0 W $$atr^%ZAPM.ed.BS3(0),/ED(2),/CUP(1,1) D OP^%ZAPM.ed.BSF4
 I $ZV["MSM" D ^%GSEL,CL^%ZAPM.ed.BSF4 S %Jo=$J,%G=%GSEL I +$G(%GSEL)=0 G NOSEL
 I $ZV["Cach"||($ZV["IRIS") D ^%GSET S %Jo=%JO,%GTEMP="^UTILITY(%JO)",%GSEL=%G I '%G G NOSEL
 D CL^%ZAPM.ed.BSF4
 I $D(@%GTEMP@("%BSbufB")) K @%GTEMP@("%BSbufB")
 Q 1
NOSEL D ErrMsg^%ZAPM.ed.BSXfun("Массивы не выбраны") Q 0
QU D OkMsg^%ZAPM.ed.BSXfun("Обработан(о) "_$G(%GSEL,%G)_" Массив(ов)")
 S Coment=$$TX D CREAT^%ZAPM.ed.BSTT
 Q
TX() Q "- Поиск "_$S(PROX=2:"И Замена данных",PROX=3:"по фильтру",1:"")_" в массивах."
TXT(PROX) ;ПОДГОТОВКА ПРОТОКОЛА
 S BSr="^%ZAPM.ed.BSbufB",BSt="%RSGBUF"_PROX,Obraz(12)=1,Obraz(21)=1
 S t0=$$TX_" Введите <ALT-G> для входа в редактор" D CR^%ZAPM.ed.BSTT U 0 W !,$$TX,!
 I $D(%SE) F I=1:1:$G(%ST,1) S t0="- "_%SE(I) W t0,! D CR^%ZAPM.ed.BSTT
 I $D(FIL) S t0="- "_FIL W t0,! D CR^%ZAPM.ed.BSTT
 S t0=" " D CR^%ZAPM.ed.BSTT
 Q
REPLAY ;ЗАМЕНА
 N REPLAY,PROX,REPLA
 S REPLAY=1,PROX=2 G FI
FILTER ;ФИЛЬТР
 N FIL,%GSEL,%GTEMP,PROX,FIND,%SE,%ST,%X,G,GG,g,t,t0,Coment,BSr,BSt,Obraz
 S %zT=$ZT,$ZT="ER^%ZAPM.ed.BSMSMGF"
 Q:'$$SEL  S FIL="",PROX=3,g="^%ZAPM.ed.BSbufB" D FILT^%ZAPM.ed.BSMSMG Q:$G(FIL)=""
 D TXT(3) S G="" F  S G=$O(@%GTEMP@(G)) Q:G=""  S g="^"_G F  S g=$ZO(@g) Q:g=""  X FIL_" D NAKED(g)"
 D QU Q
]]></Routine>


<Routine name="%ZAPM.ed.BSMSMGI" type="MAC" languagemode="0"><![CDATA[
%BSMSMGI ;ПОЛНОЭКРАННЫЙ РЕДАКТОР ИНДЕКСОВ ; 21:20 24-FEB-99
 W $$clr^%ZAPM.ed.BS3(11) S P=1,YY=$P(S(YY),"/",3),XX=$L($P(M(YY,1),"("))+2
 
  G %C
D ;ЗАБОЙ
 I '$D(M(YY,2)) S M(YY,2)=M(YY,1)
 S M(YY,1)=$E(M(YY,1),1,XX-2)_$E(M(YY,1),XX,255),XX=XX-1
 W $$clr^%ZAPM.ed.BS3(11),/CUP(YY,XX),$E(M(YY,1),XX,255)
 S YES="",M(YY,3)=""
%C W /CUP(YY,XX) W $$rt^%ZAPM.ed.BS3(+$G(%BS(2),9999)) I R1=-1,%BS(13)="%BS-PC" D GLUC^%ZAPM.ed.BSXgluc G %C
 G %C:$E(%CO,R1+1)=" ",%C:$T(@$E(%CO,R1+1))="",@$E(%CO,R1+1):$E(%CO,R1+1)'="S" D  G %C
 .I '$D(M(YY,2)) S M(YY,2)=M(YY,1)
S .;SET
 .I $L(M(YY,1))>77 W $$bel^%ZAPM.ed.BS3 D REM Q
 .S M(YY,1)=$E(M(YY,1),1,XX-1)_$C(R1)_$E(M(YY,1),XX+1-W,255) I $E(M(YY,1),$L(M(YY,1)))'=")" S M(YY,1)=M(YY,1)_")"
 .W $$clr^%ZAPM.ed.BS3(11),$C(R1),$E(M(YY,1),XX+1,255)
 .S YES="",M(YY,3)="",XX=XX+1 Q
E ;ESC-КОДЫ
 I R2<0 D LOG E  G END
 I %ES[R3 S I=$F(%ES,R3)-2 G @$E(%EC,I,I+1):$T(@$E(%EC,I,I+1))'=""
 G %C
Z ;
 I %ES[R2 S I=$F(%ES,R2)-2 G @$E(%EC,I,I+1):$T(@$E(%EC,I,I+1))'=""
 G %C
I ;
 D LOG I  G %C
II S YY=$O(M(YY)) G:YY="" II S XX=$L($P(M(YY,1),"("))+2 G %C
P ;ПЕРЕХОД НА ПОЛЕ ДАННЫХ
 D LOG I  G %C
 G END
LT ;ВЛЕВО
 S XX=XX-1 D  G %C
 .I XX<($L($P(M(YY,1),"("))+2) S XX=$L($P(M(YY,1),"("))+2
 .Q
RT ;
 S XX=XX+1 D  G %C
 .I XX>($L(M(YY,1))) S XX=($L(M(YY,1))) Q
 .Q
UP ;
 D LOG I  G %C
UUPP F I=YY-1:-1:-2 Q:$D(M(I))
 I I<1 S YY=26 G UUPP
 S YY=I
UPP I XX>($L(M(YY,1))) S XX=($L(M(YY,1)))
 G %C
DN ;
 D LOG I  G %C
DNN S YY=$O(M(YY)) G:YY="" DNN
 G UPP
IN ;
 S W=$S(W=0:1,1:0) D REM G %C ;ВСТАВКА СИМВОЛА
LOG ;КОНТРОЛЬ ИНДЕКСА И ЗАПИСЬ В БАЗУ
 S %zT=$ZT,$ZT="INDER^%ZAPM.ed.BSMSMGI" K III
 S @("III("_$P(M(YY,1),"(",2))=123 S:$D(III) III=0 I '$D(III) D INDE Q
 S $ZT=$G(%zT)
YES Q:'$D(M(YY,3))
 I $D(@M(YY,1))'["0" S ls=" "_M(YY,1)_" УЖЕ СУЩЕСТВУЕТ, ПЕРЕЗАПИШЕМ ? " D YES^%ZAPM.ed.BSF W $$clr^%ZAPM.ed.BS3(11) I 'YES&($D(M(YY,2))) S M(YY,1)=M(YY,2) D  K M(YY,3),YES G YYYY
 .W $$clr^%ZAPM.ed.BS3(11),/CUP(I,1),/EL(0),M(I,1),$$atr^%ZAPM.ed.BS3(0),$E(S(I,1),1,$P(S(I),"/",5)) S III=I F  S III=$O(S(III)) Q:III=""  Q:$P(S(III),"/",3)'=I  D  W $E(S(I,1),$P(S(III),"/",4),$P(S(III),"/",5))
 ..W /CUP(III,1),$$esc^%ZAPM.ed.BS3("[J"),/CUP(III,$P(S(III),"/")) Q
 X $S(%YES:"S @M(YY,1)=S(YY,1)",1:"S EDI=EDI+1,EDI(EDI)=1,EDI(EDI,1)=M(YY,1),EDI(EDI,2)=S(YY,1)")
 K M(YY,3),YES
YYYY D SCREEN^%ZAPM.ed.BSMSMGE
 S YY=$S($D(M(YY)):YY,1:$O(M(YY))) S:YY="" YY=$O(M(YY)) S XX=$L($P(M(YY,1),"("))+2 Q
INDER D INDE S $ZT=$G(%zT) Q
INDE D ErrMsg^%ZAPM.ed.BSXfun(" ОШИБКА В ИНДЕКСЕ "),REM Q
WAIT Q
K ;
 D ErrMsg^%ZAPM.ed.BSXfun(" УДАЛИТЬ МОЖНО ТОЛЬКО ИЗ ПОЛЯ ДАННЫХ "),REM G %C
F1 ;
 S IYI="^%ZAPM.ed.BSHLP,HELPGI" D F0^%ZAPM.ed.BSMSMGE G %C
END D SCREEN^%ZAPM.ed.BSMSMGE
 S YY=$S($D(M(YY)):YY,1:$O(M(YY))) S:YY="" YY=$O(M(YY)) S XX=$P(S(YY),"/") W $$atr^%ZAPM.ed.BS3(0) G %C^%ZAPM.ed.BSMSMGE
CL D CL^%ZAPM.ed.BSF4 Q
OP D OP^%ZAPM.ed.BSF4 Q
REM W $$clr^%ZAPM.ed.BS3(4),/CUP(24,1),/EL(0)," <F1>-ПОМОЩЬ  <Ctrl-P>-ИНДЕКСЫ <Esc>-ВЫХОД " D  W $$clr^%ZAPM.ed.BS3(11) Q
 .W $S(W:"Insert",1:"Replace") 
 ;
%LOCK ;ЛОКАЛЬНЫЕ ПЕРЕМЕННЫЕ
 S %ES="65,66,67,68,71,82,73,81,79,00,80,81,82,83,84,85,86,87,88,89,15"
 S %EC="UP,DN,RT,LT,HM,IN,PU,PD,EN,DL,F1,F2,F3,F4,F5,F6,F7,F8,F9,F0,TA"
 S %CO="Z       DTJKHI  P   N      E L  ",%CO=%CO_$TR($J("",220)," ","S")
 S $E(%CO,128)="U",%W=0 Q
BEGIN ;O 0:(0::::#10080) Q
e ;
ERR S ls=$ZE D O^%ZAPM.ed.BSF7 W $$r^%ZAPM.ed.BS3 D SCREEN^%ZAPM.ed.BSMSMGE Q
]]></Routine>


<Routine name="%ZAPM.ed.BSMSMGO" type="MAC" languagemode="0"><![CDATA[
%BSMSMGO ;ПОЛНОЭКРАННЫЙ РЕДАКТОР МАССИВОВ (II PART) ; 21:21 24-FEB-99
%C G %C^%ZAPM.ed.BSMSMGE
H ;
 D AddHist^%ZAPM.ed.BSXuse("^%ZAPM.ed.BSbufB(""HISCTL"_$S('$E(%BS(1),12):$G(%BS(3),$P)_$G(%BS(12)),$E(%BS(1),12)=1:"1"_$G(%BS(12)),1:"1")_""")",$$LEND()) G %C
N ;OUT HISTORY
 S Tmp1=$G(^%ZAPM.ed.BSbufB("HISCTL"_$S('$E(%BS(1),12):$G(%BS(3),$P)_$G(%BS(12)),$E(%BS(1),12)=1:"1"_$G(%BS(12)),1:"1"),1))
SETN S Tmp=$E($$LBEG()_Tmp1_$S(W:$$LEND(),1:$E($$LEND(),$L(Tmp1)+1,$$LNG^%ZAPM.ed.BSF12)),1,509)
 S i=YY,Y=$P(S(YY),"/",3) S @M(Y,1)=Tmp D SCREEN^%ZAPM.ed.BSMSMGE G %C
J ;ОТМЕНА
 ;S S(YY,1)=@M($P(S(YY),"/",3),1) D SCREEN^%ZAPM.ed.BSMSMGE
 K M($P(S(YY),"/",3),3) D SCREEN^%ZAPM.ed.BSMSMGE
 G HM^%ZAPM.ed.BSMSMGE
ALTT s Tmp1=$$History^%ZAPM.ed.BSXfun("^%ZAPM.ed.BSbufB","HISCTL"_$S('$E(%BS(1),12):$G(%BS(3),$P)_$G(%BS(12)),$E(%BS(1),12)=1:"1"_$G(%BS(12)),1:"1")) G:'YES %C G SETN
SHIFTF1 S IYI="^%ZAPM.ed.BSS(ShiftF1" D SA^%ZAPM.ed.BSsBUF,F0^%ZAPM.ed.BSMSMGE,RE^%ZAPM.ed.BSsBUF Q  ;;G %C
ALTF10 D CM^%ZAPM.ed.BSF6 G %C
K ;УДАЛЕНИЕ УЗЛА БЕЗ ПОДТВЕРЖДЕНИЯ
 I '$$AccesMSM^%ZAPM.ed.BSDOS2(3) D PROT^%ZAPM.ed.BSMSM G %C
 S i=YY,Y=$P(S(YY),"/",3) I $D(@M(Y,1))'=1 S ls=" УДАЛЯТЬ "_$ZR_" !!! ВЫ УВЕРЕНЫ ? " D YES^%ZAPM.ed.BSF I 'YES G %C
KI S G=M(Y,1),%zT=$ZT,$ZT="ERR^%ZAPM.ed.BSMSMGI" D  S $ZT=$G(%zT),(I3,Y)=Y-1 D LOO^%ZAPM.ed.BSMSMGE W /CUP(I3,80),$$esc^%ZAPM.ed.BS3("[J") S Y=I3 D PUT^%ZAPM.ed.BSMSMGE,REM^%ZAPM.ed.BSMSMGE S I=$O(S(""),-1)
 .K @M(Y,1) F I=Y:1:25 K M(I),S(I)
 I I="" D PUU^%ZAPM.ed.BSMSMGE Q  ;G I
 S YY=$S('$D(S(i)):I,1:i),XX=$P(S(YY),"/") G %C
F5 ;КОПИРОВАНИЕ ДЕРЕВА В БУФЕР
 S i=YY,Y=$P(S(YY),"/",3) I $D(@M(Y,1))=1 D ErrMsg^%ZAPM.ed.BSXfun("Потомков Нет") G %C
 D CopyF5(10,$ZR)
 G %C
CopyF5(U,TRe1) N UU K ^%ZAPM.ed.BSbufB(2,$G(%BS(3),$P),U)
 S TRe2=$NA(@("^%ZAPM.ed.BSbufB(2,$G(%BS(3),$P),U,"_$P(TRe1,"(",2,99))),UU=TRe1
 D Copy^%ZAPM.ed.BSF8(TRe1,TRe2,0,1),OkMsg^%ZAPM.ed.BSXfun("Узел ("_$P(UU,"(",2,999)_" скопирован в Буфер") Q
CopyF6(TRe1,TRe2) D Copy^%ZAPM.ed.BSF8(TRe1,TRe2,1,1) D OkMsg^%ZAPM.ed.BSXfun("Узел из Буфера Смешали с ("_$P(TRe2,"(",2,99)) Q
F6 ;КОПИРОВАНИЕ ИЗ БУФЕРА В ТЕКУЩИЙ УЗЕЛ
 S i=YY,Y=$P(S(YY),"/",3) I $D(@M(Y,1))
 S TRe2=$ZR I '$D(^%ZAPM.ed.BSbufB(2,$G(%BS(3),$P),10)) D ErrMsg^%ZAPM.ed.BSXfun("Буфер Пуст") G %C
 S TRe1=$ZR S TRe1=$$LineEdit^%ZAPM.ed.BSXfun(TRe1,"Можете редактировать исходный узел")
 S TRe2=$$LineEdit^%ZAPM.ed.BSXfun(TRe2,"Можете редактировать целевой узел")
 D CopyF6(TRe1,TRe2)
 S G=M(Y,1),%zT=$ZT,$ZT="ERR^%ZAPM.ed.BSMSMGI" S $ZT=$G(%zT),(I3,Y)=Y-1 D LOO^%ZAPM.ed.BSMSMGE W /CUP(I3,80),$$esc^%ZAPM.ed.BS3("[J") S Y=I3 D PUT^%ZAPM.ed.BSMSMGE,REM^%ZAPM.ed.BSMSMGE S I=$O(S(""),-1)
 I I="" D PUU^%ZAPM.ed.BSMSMGE Q  ;G I
 S YY=$S('$D(S(i)):I,1:i),XX=$P(S(YY),"/") G %C
KILL ;G %C ;!!!УДАЛЕНИЕ УЗЛА БЕЗ УДАЛЕНИЯ ПОТОМКОВ
 I '$$AccesMSM^%ZAPM.ed.BSDOS2(3) D PROT^%ZAPM.ed.BSMSM G %C
 S i=YY,Y=$P(S(YY),"/",3) I $D(@M(Y,1))=1 G KI
 S TRe1=$P($ZR,")"),TRe2="^%ZAPM.ed.BSbufB(2,"_$G(%BS(3),$P)_$J_",9,"_$P(TRe1,"(",2,99) K ^%ZAPM.ed.BSbufB(2,$G(%BS(3),$P),9) D TREE K @(TRe1_")")
 S TRe2=$P(TRe1,"(")_"(",TRe1="^%ZAPM.ed.BSbufB(2,"_$G(%BS(3),$P)_$J_",9" D TREE
 S G=M(Y,1),%zT=$ZT,$ZT="ERR^%ZAPM.ed.BSMSMGI" S $ZT=$G(%zT),(I3,Y)=Y-1 D LOO^%ZAPM.ed.BSMSMGE W /CUP(I3,80),$$esc^%ZAPM.ed.BS3("[J") S Y=I3 D PUT^%ZAPM.ed.BSMSMGE,REM^%ZAPM.ed.BSMSMGE S I=$O(S(""),-1)
 I I="" D PUU^%ZAPM.ed.BSMSMGE Q  ;G I
 S YY=$S('$D(S(i)):I,1:i),XX=$P(S(YY),"/") G %C
TREE S ls="Копи..."_TRe1_" В "_TRe2_"..." D WAITS^%ZAPM.ed.BSF2 S j=TRe1_")"
 S jj=$S(TRe1["]":$P(TRe1,"]",2,99),1:$P(TRe1,"^",2,99))_","
 S jjj=$S($E(TRe2,$L(TRe2))="(":"",1:",")
 F  S j=$ZO(@j) Q:$S(j["]":$P(j,"]",2,99),1:j)'[jj  S @(TRe2_jjj_$P(j,jj,2,9))=@j X WA
 Q
ZO(g,Ha) ;
Z1 S g=$ZO(@g,Ha) I g="" Q ""
 X FIL I  Q g
 G Z1
CL D CL^%ZAPM.ed.BSF4 Q
OP D OP^%ZAPM.ed.BSF4 Q
LEND() I YY=$P(S(YY),"/",3) Q $E(S(YY,1),XX-$P(S(YY),"/")+1,$$LNG^%ZAPM.ed.BSF12)
 Q $E(S($P(S(YY),"/",3),1),$P(S(YY-1),"/",2)+XX-$P(S(YY),"/")+1,$$LNG^%ZAPM.ed.BSF12)
LBEG() I YY=$P(S(YY),"/",3) Q $E(S(YY,1),1,XX-$P(S(YY),"/"))
 Q $E(S($P(S(YY),"/",3),1),1,$P(S(YY-1),"/",2)+XX-$P(S(YY),"/"))
e Q
]]></Routine>


<Routine name="%ZAPM.ed.BSMSMS" type="MAC" languagemode="0"><![CDATA[
%BSMSMS(ObEkT,KaTvY,T) ; пpогpамма КАТАЛОГА ПРОГРАММ И МАССИВОВ ;  9:47 28-APR-97
 ;ObEkT=1/2 ПРОГ\МАСС KaTvY=~D\~L ВЕСЬ КАТАЛОГ\ВЫБРАННЫЕ  T=МАССИВ ВЫБОРКИ
 N G,I,II,III,J,JJ,L,BSR,BST,NEW,P
 I KaTvY="~D" G:$D(T) DI D P,@ObEkT,TAB Q
 I KaTvY="~L" G LI
 W !,"Команды ",KaTvY," нет" Q
DI D P,@ObEkT,MARK,TAB,MODIF G EX
LI D P,L,MARK,TAB,MODIF
EX W /CUP(1,1),/ED(2)
 D OP^%ZAPM.ed.BSF4 Q
ADD(I) ;ДОБАВЛЕНИЕ
 I $D(NEW) K NEW S L=L+1,J=0 F JJ=1:1:4 S @G@(L,JJ)=^%ZAPM.ed.BSS("DIR2",2,2)
 S J=J+1
 S $P(@G@(L,J),"@",15)=I I '(J#4) S NEW=1
 Q
TAB S li=G D TIR^%ZAPM.ed.BST4
 S BSR=$P(li,",",2),BST=$P(li,","),ke=4,se=L D RESZER^%ZAPM.ed.BSF2,TAB^%ZAPM.ed.BSF1
 S IYI=BSR_"("_BST N (IYI,%BS,vl,dat) D ENTER^%ZAPM.ed.BSN S:R1=27 dat=""
 Q
MODIF ;ПОСТМОДИФИКАЦИЯ
 K @T S L=1,@P=0 F  S L=$O(@G@(L)) Q:'L  F J=1:1:4 I $P(@G@(L,J),"@",15)'="",$P(@G@(L,J),"@",12) S @T@($P(@G@(L,J),"@",15))="",@P=@P+1
 Q
MARK D MARK^%ZAPM.ed.BSF11(G,T) Q
P ;ПОДГОТОВКА
 S G=$$TMPG^%ZAPM.ed.BSF11 D Copy^%ZAPM.ed.BSF8("^%ZAPM.ed.BSS(""DIR2"")",G)
 S J=0,L=2,II=@G@(2,3),$P(@G@(1,3),"@",15)=$S($G(ObEkT)=1:"routines",1:"globals")
 S $P(@G@(1,2),"@",15)=" "_$S($G(KaTvY)="~D":"Directory",1:"Selected")
 S P=$S($G(ObEkT)=1:"%RSN",1:"%GSN") Q
L S I=""
 F  S I=$O(@T@(I)) Q:I=""  D ADD(I)
 Q
 ///z Routines
1 S I=""
 F  {	 S I=$O(^ROUTINE(I)) Q:I=""  
 	if $namespace'="%SYS",$e(I,1)="%" continue
 	D ADD(I)
 }
 Q
 ///z Globals
2 S I="" new list 
 d GetGlobalDir^%ZAPM.ed.BSCp($namespace,.list)
 F  S I=$Order(list(I)) Q:I=""  Do ADD(I)
 Q
]]></Routine>


<Routine name="%ZAPM.ed.BSN" type="MAC" languagemode="0"><![CDATA[
%BSN ;ВЫЗОВ ТАБЛИЦ,ДИНАМИЧЕСКИЙ РАЗДЕЛ,СОЗДАНИЕ МЕНЮ И ТАБЛИЦ ; 16:41   01.04.2001
S(%z,%zz) S ^(%z)=$E(%zz,1,$$LNG^%ZAPM.ed.BSF12) Q  ;!!!!!!!!
N(%zzzzz) D %nN(1) K ^%ZAPM.ed.BSbufB("AN"_$G(%BS(3),$P)_$J_"u"_$G(%nN)) I $D(^("AN"_$G(%BS(3),$P)_$J_"u"_$G(%nN),1))
 I $ZV["MSM" ;S %zzz=$O()
 I $ZV["Cach"||($ZV["IRIS") S %zzz="",%zzz=$O(@%zzz)
 S %zzzzz=","_%zzzzz_",%nN," F  S %zzz=$O(@%zzz) Q:%zzz=""  I %zzz'["%zzz",%zzzzz'[(","_%zzz_",") D
 .I $D(@%zzz)=1 D S(%zzz,@%zzz) Q
 .D:$D(@%zzz)=11 S(%zzz,@%zzz) S %zzzz=%zzz F  S %zzzz=$Q(@%zzzz) Q:%zzzz=""  D S(%zzzz,@%zzzz)
K X "K (%BS,"_$P(%zzzzz,",",2,$L(%zzzzz,",")-1)_")" Q
Q(%zzzzz) S %zzzzz=","_%zzzzz_",%zzzzz,%nN," D K,%nN(0) S %zzz="" F  S %zzz=$O(^%ZAPM.ed.BSbufB("AN"_$G(%BS(3),$P)_$J_"u"_$G(%nN),%zzz)) Q:%zzz=""  I %zzzzz'[(","_$P(%zzz,"(")_",") S @%zzz=^(%zzz)
 K %zzz,^%ZAPM.ed.BSbufB("AN"_$G(%BS(3),$P)_$J_"u"_$G(%nN)) D %nN(-1) K %nN Q
%nN(z) S %nN=$G(^%ZAPM.ed.BSbufB("AN"_$G(%BS(3),$P)_$J_"u"),0)+z S ^%ZAPM.ed.BSbufB("AN"_$G(%BS(3),$P)_$J_"u")=%nN Q
BSTG(IYI,trig) D NE Q $S($G(trig):$G(date),1:dat)
BST(tr,trig) D  D NE Q $S($G(trig):$G(date),1:dat)
 .S IYI=$P(tr,",") Q  ;!!!!!!!!!!!!!!!!!!
NEM S li="" Q
Table(P,T) N IYI,ny,nx,dat,date,d,d1,d0 S IYI=P_","_T D NE^%ZAPM.ed.BSN S YES=$G(%BS("Tmp","LastTabl"))_"@"_date Q
NEW S IYI=$P(@(BSR_"(BST,ny,nx)"),"@",$G(l4,14))
NEB G XEC^%ZAPM.ed.BSF3:IYI?.N1",".N,NEM:IYI?1"I ".N D NE S $ZT=$G(%zT),li=$G(date) K date D:$D(%CAL) CALC^%ZAPM.ed.BSF3 Q
NE D SA^%ZAPM.ed.BSsBUF,ENTER S ENTERkk=1 D RE^%ZAPM.ed.BSsBUF S Refresh=1 K IYI,ENTERkk Q
ENTER D SI ;```I $ZV["Cach"||($ZV["IRIS") N (%BS,vl,EXITout,d,FLine,%zT,%KAT,%File,IYI,date,R1,dat,Key0,Key1,Key2,Key3,Key4,Key5,Key6,Key7,Key8,Key9)
 D NNN(",Key0,Key1,Key2,Key3,Key4,Key5,Key6,Key7,Key8,Key9")
 ;N (%BS,EXITout,d,%zT,%KAT,%File,IYI,date,R1,dat) D SI
 ;N S,STATUS,VYC,BS0,BSX,BSY,B,BX,BY,x,t,zr,t1,%VDB,%CAL,%X1,%X2,%Y1,%Y2,%TIT,MR,%w(2),M1,BS,%w(4),%w(5),%DIA,%DI,%DIAP,%ZAP,%FK,i,j,ii,jj,se,ke,j1,j2,j3,MX,MY,M,BS1,BS2,BSF,BSX1,
 ;...BSX2,BSY1,BSY2,CLR,ENDLI,BSI,BSII,MR23,MR24,MR25,NAZAD,li,ls,lo,BSR,BST,RA,PREDMOV,MxX,MyY,My,Mx,COLOR,EXITout,%FN,%DEV,%Cu,es,ek,h,hi,hl,%INV,%INV1,%INV2,v,vv,vvv,%Co,%R,%a,%r,%JB,%BS(5),LAB,OO,OOO,TAB,TIP,f,ft D SI
 ;N BSR,BST,RA,PREDMOV,MxX,MyY,My,Mx,COLOR,EXITout,%FN,%DEV,%Cu,es,ek,h,hi,hl,%INV,%INV1,%INV2,v,vv,vvv,%Co,%R,%a,%r,%JB,%BS(5),LAB,OO,OOO,TAB,TIP,f,ft D SI
 S YES=1 I IYI[")" S BSR=$P(IYI,"("),BST=$P($P(IYI,"(",2),")") S BST=$S(BST=+BST:BST,1:$P(BST,$C(34),2)) G ENT1 ;D IN^%ZAPM.ed.BST(IYI) G ENTE
 I IYI["(" S BSR=$P(IYI,"("),BST=$P(IYI,"(",2) S:BSR'["^" BSR="^"_BSR G ENT1
 I IYI["<>" D PBD(IYI) G QQ:'YES,ENT
 E  S BSR=$P(IYI,",",1,$L(IYI,",")-1),BST=$P(IYI,",",$L(IYI,",")) S:BSR'["^" BSR="^"_BSR
ENT1 I BST="<INV>" D INV G:'YES QQ
ENT D STA^%ZAPM.ed.BST
ENTE I $D(IMQ),$D(%BS("Tmp","EXIToutBD",IMQ)) S d=%BS("Tmp","EXIToutBD",IMQ),R1=13 K %BS("Tmp","EXIToutBD",IMQ)
 S date=$S($G(R1,27)=27:"",1:$G(d)),dat=$G(d)
QQ D QQQ("") Q
NNN(fzq) D N("%BS,vl,EXITout,d,FLine,%zT,%KAT,%File,IYI,date,R1,dat"_$G(fzq)) Q
QQQ(fzq) D Q("%BS,vl,EXITout,d,%zT,%KAT,FLine,%File,IYI,date,R1,dat"_$G(fzq)) Q
e Q
SI D:$S<20000 SIZE(20) Q
SIZE(%Sz) I $ZV["Wind"!($ZV["Cach"||($ZV["IRIS")) Q
 Q:'$G(%Sz)  S %Sz=($V(108,$J,4)\1024)+%Sz
 I $S ;%Sz-НА СКОЛЬКО КБАЙТ УВЕЛИЧИТЬ РАЗДЕЛ
 V 108:$J:%Sz*1024:4 Q
DEL I R3=85 D PASE^%ZAPM.ed.BST1 I $D(%w(4)) S ls=" ВНИМАНИЕ !!!! ВЫ ТОЧНО ХОТИТЕ НАСИЛЬНО ОСВОБОДИТЬ ФАЙЛ-СЕРВЕР ? ",R1=27 D YES^%ZAPM.ed.BSF I YES I $D(gl) K @gl
 I R3=86 D PASE^%ZAPM.ed.BST1 I $D(%w(4)) D  S ls=" ВЫ ХОТИТЕ НАСИЛЬНО ПРЕКРАТИТЬ СЕАНС РАБОТЫ ПОЛЬЗОВАТЕЛЯ "_$P(i1,",",3)_" ? ",R1=27 D YES^%ZAPM.ed.BSF I YES I $D(gl) S @(gl_"(2,"_i1_")")="OUT"
 .S i1="" F j=2,4,6 S i2=$P(@(BSR_"(BST,ny,j)"),"@",15),i1=i1_$S(i2=+i2:i2,1:""""_i2_"""")_$S(j=6:"",1:",")
 I R3=87 G D^%ZAPM.ed.BS:ny<2 D  Q:R1=27
 .I '$D(%w(4)) D PASE^%ZAPM.ed.BST1 I '$D(%w(4)) Q
 .I $D(%DIA) S do="D DE^%ZAPM.ed.BSN" D BLOK^%ZAPM.ed.BSF1 Q
 .S i=ny D DE Q
D G D^%ZAPM.ed.BS
DE S %NAM="^"_$P(@(BSR_"(BST,i,12)"),"@",15),%TAB=$P(^(10),"@",15),uci=$P(^(14),"@",15)_","_$P(^(16),"@",15) Q:uci["="!(%TAB="")
 S ls=" ОСВОБОДИМ "_%TAB_","_$P(%NAM,"^",2)_","_uci_" ВЫ УВЕРЕНЫ ? " D YES^%ZAPM.ed.BSF I 'YES Q
 D %GU^%ZAPM.ed.BSF4 ;!!!I %NAM="^%ZAPM.ed.BSbufS" S %TAB="^["""_$P(%TAB,":")_""":"""_$P(%TAB,":",2)_"""]"_$P(%TAB,":",3,99)
 S $P(@(%NAM_"(%TAB)"),"@",30)="",R1=27 Q
INV ;ПСЕВДО-ТАБЛИЦА
 I $D(^%ZAPM.ed.BSbufB("INV"_$G(%BS(3),$P)_$J_"u"_BSR)),$P(@$ZR,"@")=$P(@BSR,"@",7) S BST="INV"_$G(%BS(3),$P)_$J_"u"_BSR,BSR="^%ZAPM.ed.BSbufB" Q
 S ke=2,BSr="^%ZAPM.ed.BSbufB",BSt="INV"_$G(%BS(3),$P)_$J_"u"_BSR,ii="",ls="ДЕЛАЕТСЯ ПСЕВДО-ТАБЛИЦА" D WAITS^%ZAPM.ed.BSF2
 S %zT=$ZT,$ZT="ERFOR^%ZAPM.ed.BSN"
 S head=$P(@BSR,"@",7),col(1)=$P(%BS,"!",6),col(2)=$P(%BS,"!",7) I $P(@BSR,"@",8) D  F  S ii=$O(@BSR@(1,ii)) Q:ii=""  S t1=ii,t2=@BSR@(1,ii) D CR S v=1
 .I $P($ZV,"Version ",2)'<4 S l1=$L($O(@BSR@(1,""),-1))+1,l2=79-l1 Q
 .S l1=9,l2=71
 I '$P(@BSR,"@",8) F  S ii=$O(@(BSR_"(ii)")) Q:ii=""  S l1=$L(ii)+1 S t1=ii,t2=@(BSR_"(ii)") S l2=79-l1 D CR S v=1 I '(ii#10) X $G(WA)
 S Fk="" D CREAT S $P(@(BSr_"(BSt)"),"@")=head,YES=1,$ZT=$G(%zT) K head Q
ERFOR D ErrMsg^%ZAPM.ed.BSXfun($ZE) S YES=0 Q
PBD(IYI) N Fk,tIT,BKs,l1,BSt,BSr,GL,BSd,ke,t1,i,ii,se,cc ;ТАБЛИЦА ЗНАЧЕНИЙ КЛЮЧЕЙ БАЗЫ ДАННЫХ
 S %zT=$ZT,$ZT="ERFOR^%ZAPM.ed.BSN"
 S BSr=$P(IYI,",",2),BSt=$P(IYI,",",1) S:BSr["^" BSr=$P(BSr,"^",2) S BSr="^["""_$P(IYI,",",3)_""","""_$P(IYI,",",4)_"""]"_BSr S BSd=$P($G(@(BSr_"(BSt,""KEY"")")),"@") I BSd="" S YES=0 Q
 S ii=0 F i=5:1 Q:$P(IYI,",",i)="<>"  Q:i'=5&($P(IYI,",",i)="")  S BKs(ii)=$P(IYI,",",i),ii=ii+1
 S cc=$P($G(@(BSr_"(BSt,""KEY"",ii)")),"@",10),ff=$G(@(BSr_"(BSt,""KEY"",ii,3)"))
 S BSr="^%ZAPM.ed.BSbufB",BSt="KEYS"_$G(%BS(3),$P)_$J_"u"_BSd,ls="ДЕЛАЕТСЯ ТАБЛИЦА" D WAITS^%ZAPM.ed.BSF2
 S GL=$$BSD^%ZAPM.ed.BSA(BSd,$G(BKs(0))) F ii=1:1 Q:'$D(BKs(ii))  S GL=GL_$S(BKs(ii)=+BKs(ii):BKs(ii),BKs(ii)?1"Key".N&($D(@BKs(ii))):$S(@BKs(ii)=+@BKs(ii):BKs(ii),1:$C(34)_@BKs(ii)_$C(34)),1:$C(34)_BKs(ii)_$C(34))_","
 S v=1,ke=1,t1=$G(FLine," ЗНАЧЕНИЯ: "_GL),l1=60,cl=$P(%BS,"!",4) D CR S t1="" D CR S $P(@$ZR,"@",8)=0,$P(@$ZR,"@",3)=0,@(BSr_"(BSt,""FTR"",2,1)")=ff
 S cl=cc,ii="" F  S ii=$O(@(GL_"ii)")) Q:ii=""  I ii'["@" S t1=ii D CR S $P(@$ZR,"@",8)="2,1"
 I se=2 D ErrMsg^%ZAPM.ed.BSXfun(" У УЗЛА:"_GL_" ЗНАЧЕНИЙ НЕТ ") S YES=0 Q
 S Fk="" D CREAT S YES=1,$ZT=$G(%zT) Q
CR ;l1,l2,...ln-ДЛИНЫ КОЛОНОК t1,t2,...tn-СОДЕРЖАНИЕ КОЛОНОК,ke-КОЛ-ВО КОЛОНОК
 ;v- ВЫСОТА ТЕКУЩЕЙ СТРОКИ
 ;NoKiTab=1 - НЕ УДАЛЯТЬ СТАРУЮ ТАБЛИЦУ
 Q:'$D(ke)  I '$D(CReATe) K:'$D(NoKiTab) @(BSr_"(BSt)") S:$D(@BSr)["0" $P(@BSr,"@")="BaSe MsW " S CReATe=$$h^%ZAPM.ed.BS3(),se=0 D:$D(NoKiTab)  S WA=$G(WA) F i=1:1:ke S @("l"_i)=$S('$D(@("l"_i)):70,1:@("l"_i))
 .F i=1:1 Q:'$D(@BSr@(BSt,i))  S se=i
 S se=se+1 F j=1:1:ke S @(BSr_"(BSt,se,j)")="@@"_$G(v,1)_"@"_(@("l"_j))_"@@@@@1@"_$G(cl,$G(col(j)))_"@@@@@"_$G(@("t"_j))
 Q
CREAT K CReATe,i,j,cl,col S @BSr@(BSt)="@@@@@@@1@1@22@80@1@@1@1@@1@@"_$G(tIT)_"@1@"_$P($G(@BSr@(BSt)),"@",21,99),BSR=BSr,BST=BSt S:$D(Fk) $P(@$ZR,"@",15)=Fk S:$D(PrEd) $P(@$ZR,"@",41)=PrEd D RESZER^%ZAPM.ed.BSF2,TABm^%ZAPM.ed.BSF1 Q
CREATE D CREAT K BSr,BSt,tIT,Fk D ^%ZAPM.ed.BST Q

DOAF2 D SI G:'$D(@(BSR_"(BST,""AF2"")")) OO I $G(@$ZR)="" S OOO=BSR,BLo=BST G DOA
 S OOO=$P(@$ZR,",",1,$L(@$ZR,",")-1),BLo=$P(@$ZR,",",$L(@$ZR,","))
DOA S OO=$S(BLo=+BLo:BLo,1:""""_BLo_"""")_",""AF2"",1"
 I '$D(@(OOO_"("_OO_",1)")) G OO
 W /CUP(25,1) D 0^%ZAPM.ed.BSF W /EL(0) D 0^%ZAPM.ed.BSF,24^%ZAPM.ed.BSTM,^%ZAPM.ed.BSB S YES=$S(R1=27:0,1:1) D A25^%ZAPM.ed.BSF1 Q
OO Q:TIP=7  S ls=" БЛОЧНОЕ МЕНЮ ОТСУТСТВУЕТ " G O^%ZAPM.ed.BSF7
AF2 I BST["@" S ls=" СНАЧАЛО ВЫЙДИТЕ ИЗ РЕЖИМА КОРРЕКЦИИ <F3> " D O^%ZAPM.ed.BSF7 G D
 S ls=" Вы хотите создать НА ОСНОВЕ ЭТОЙ ТАБЛИЦЫ БЛОЧНОЕ МЕНЮ для дpугой таблицы ? " D YES^%ZAPM.ed.BSF I 'YES G D
 S li=$G(@(BSR_"(BST,""AFG"",1)")) D TIR^%ZAPM.ed.BST4,RIT^%ZAPM.ed.BSF3 I 'YES G D
 I $D(@(BSr_"(BSt,""AF2"")")) S ls=" У "_BSr_","_BSt_" УЖЕ СУЩЕСТВУЕТ БЛОЧНОЕ ПРИКРЕПЛЕННОЕ МЕНЮ" D MENU^%ZAPM.ed.BSF5(" ОБНОВЛЯЕМ УДАЛЯЕМ ОТКАЗ ",ls) G D:'YES!(%B=3) K @(BSr_"(BSt,""AF2"")") G D:%B=2
 S (BSr2,BSr1)=BSr,(BSt2,BSt1)=BSt,ls=" ХРАНИТЬ БУДЕМ В ТОЙ ЖЕ ТАБЛИЦЫ " S %B=1 D YES^%ZAPM.ed.BSF I 'YES S li=$G(@(BSR_"(BST,""AFG"",2)")) D TIR^%ZAPM.ed.BST4,RIT^%ZAPM.ed.BSF3 G D:'YES S BSr2=BSr,BSt2=BSt
 S I=ny,IN="M(1,1)",YES=1 D M(I,IN) G D:'YES S I="M",@(BSR_"(BST,""AFG"",1)")=$$BSR^%ZAPM.ed.BSA(BSr1)_","_BSt1,^(2)=$$BSR^%ZAPM.ed.BSA(BSr2)_","_BSt2,@(BSr1_"(BSt1,""AF2"")")=$$BSR^%ZAPM.ed.BSA(BSr2)_","_BSt2 F  S I=$Q(@I) Q:I=""  S @(BSr2_"(BSt2,""AF2"","_$P(I,"(",2,99))=@I
 G D
M(i,m) N h,j,c,g S (g,c)="",@m=" ",h=+("9"_$TR($P($P(m,"(",2),")"),",","")) F j=1:1:ke Q:$P($P(@(BSR_"(BST,i,j)"),"@",15)," ")=""  D  Q:'YES
 .S @m=@m_$P($P(@(BSR_"(BST,i,j)"),"@",15)," ")_" ",M(h,j)=$P($P(@$ZR,"@",15)," ",2,999)
 .I $P(@$ZR,"@",14)?.N1",".N S II=$P(@$ZR,"@",14) I $D(@(BSR_"(BST,""CMD"","_II_")")) D
 ..I @$ZR?1"I ".N S I=+$P(@$ZR,"I ",2),IN=$P(m,")")_","_j_")" D M(I,IN) Q
 ..E  S $P(c,";",j)=@$ZR
 .I "0"'[$P(@$ZR,"@",14) S $P(c,";",j)="S IYI="""_$$TR^%ZAPM.ed.BSsFUNM($P(@$ZR,"@",14),$C(34),($C(34)_$C(34)))_""" D NEB^%ZAPM.ed.BSN"
 I $L(@m)>78 S ls="ВЫХОД ТЕКСТА БЛОКОВ ЗА ПРЕДЕЛЫ 78 СИМВОЛОВ" G O
 I $L(@m_"@6@ @0@BLo,""AF2"","_h_"@"_c_"@"_g)>($$LNG^%ZAPM.ed.BSF12-1) S ls="ВЫХОД КОМАНД МЕНЮ ЗА ПРЕДЕЛЫ "_($$LNG^%ZAPM.ed.BSF12-1)_" СИМВОЛОВ" G O
 S @m=@m_"@6@ @0@BLo,""AF2"","_h_"@"_c_"@"_g Q
O S ls="В СТРОКЕ "_i_" "_ls D O^%ZAPM.ed.BSF7 S YES=0 Q
]]></Routine>


<Routine name="%ZAPM.ed.BSPK" type="MAC" languagemode="0"><![CDATA[
%BSPK ;ПАКЕТНЫЙ РЕЖИМ ```ОТЛАДКА; 16:14 30-MAY-97 ; 16:51 10-JUN-98
 Q
START ;НАСЧЕТ ПАКЕТОВ
 N U,I,Err,PACKET,ObR
 S U=$$CHOPAK,YES=0 Q:U=""
 S I="",PACKET=$$h^%ZAPM.ed.BS3() F  S I=$O(@U@(I)) Q:I=""  I $G(@U@(I,"ST")) D CALC($NA(@U@(I)))
 Q
CALC(P) ;СЧИТАТЬ ЗАПРОС
 N NZ,PT,I,U,T,R
 S NZ=$G(@P@("N")) I NZ="" D ErrPACK($NA(@P@("TT")),"Имя ЗАПРОСА пусто !") Q
 S PT=$G(@P@("PT")) I '$$Data^%ZAPM.ed.BSF12(PT) D ErrPACK($NA(@P@("TT")),"Нет доступа к СПИСОКУ\СВОДКЕ !") Q
 S R=$$PT(PT,1),T=$$PT(PT,0)
 I '$D(@R@(T,"ZPr",NZ)) D ErrPACK($NA(@P@("TT")),"ЗАПРОСА "_NZ_" В "_R_","_T_" УЖЕ НЕТ") Q
 S ObR=P F I="TT","BT","TZ","TB","TP" K @P@(I)
 D ZPSTART^%ZAPM.ed.BSZPS(NZ,R,T)
 Q
PT(PT,N) ;ИЗ ПОЛНОЙ ССЫЛКИ В 1=РАЗДЕЛ 2=ТАБЛИЦА
 I N Q $P(PT,"(")
 Q $TR($P($P(PT,"(",2),")"),$C(34),"")
ErrPACK(G,T) 
 S @G=T,Err=$G(Err)+1,Err(Err)=T
 Q
FBP ;ФОРМИРОВАНИЕ БУФЕРОВ ПЕЧАТИ
 Q
PBP ;ПЕЧАТЬ БУФЕРОВ
 Q
CLEARBUF ;ЧИСТКА БУФЕРОВ ПЕЧАТИ
 Q
PACKET ;ПАКЕТ ПАКЕТОВ
 Q
CHOPAK() ;ВЫБРАТЬ ПАКЕТ
 Q $$UZEL^%ZAPM.ed.BSVOL("PACKET","%BSVOL","",""," НАДО ВЫБРАТЬ ПАКЕТ, КОТОРЫЙ БУДЕМ СЧИТАТЬ")
 
]]></Routine>


<Routine name="%ZAPM.ed.BSPK1" type="MAC" languagemode="0"><![CDATA[
%BSPK1 ;КАРТА ВЫВОДА И ПЕЧАТЬ ДЛЯ ПАКЕТОВ ```ОТЛАДКА; 16:52 10-JUN-98 ; 14:01 24-FEB-99
 Q
OUTCARDS ;КАРТА ВЫВОДА
 N CARD
 S CARD=$NA(^%ZAPM.ed.BSbufB("TmpCardOut"_$G(%BS(3),$P)_$J_"u1"))
 D FC(BSR,BST,$G(@BSR@(BST,"PRN"),$P(^%ZAPM.ed.BSS("OPout1",2,1),"@",15)),CARD)
 D Table^%ZAPM.ed.BSN(BSR,BST)
 D Yes^%ZAPM.ed.BSXfun("Запомним Карту вывода") I YES>0
 Q
PACKCARD ;КАРТА ВЫВОДА ПАКЕТ
 N CARD
 S CARD=$NA(^%ZAPM.ed.BSbufP("Card§"_BSR_"§"_BST_"§"))
 D FC(BSR,BST,$G(@BSR@(BST,"PRN"),$P(^%ZAPM.ed.BSS("OPout1",2,1),"@",15)),CARD)

 Q
 
FC(P,T,O,C) ;ФОРМИРОВАНИЕ КАРТЫ
 I $D(@P@(T,"CRD"))
 D ErrMsg^%ZAPM.ed.BSXfun("РЕЖИМ НА ОТЛАДКЕ") Q
 ;D x^%ZAPM.ed.BS3("19+PK1")     ;---//--- для msm 4.x.x
 Q
]]></Routine>


<Routine name="%ZAPM.ed.BSPRN" type="MAC" languagemode="0"><![CDATA[
%BSPRN ;ВЫВОД НА ПЕЧАТЬ (А.Тимофеев) ; 14:48   02.03.99
 I '$D(%CAL) D CALC^%ZAPM.ed.BSF3
TWA S IMQ1=BSR_","_BST S:$D(%TIT) IMQ2=BSY2(1)_","_BSX2(2) D TWA1 D Q^%ZAPM.ed.BSN("%BS,PRF,%zT,%KAT,%File,k0,k1,k2,k3,k4,k5,IMQ1,IMQ2,BSB,PRN,DOS,SR,SR1,SR2,SR3,PRA,PRA1")
 K SR,SR1,SR2,SR3 D TIT^%ZAPM.ed.BST,W^%ZAPM.ed.BST D:$D(%FN) C^%ZAPM.ed.BSBL1 G D^%ZAPM.ed.BS
TWA1 D SI^%ZAPM.ed.BSN D N^%ZAPM.ed.BSN("%BS,PRF,%zT,%KAT,%File,k0,k1,k2,k3,k4,k5,IMQ1,IMQ2,BSB,PRN,DOS,SR,SR1,SR2,SR3,PRA,PRA1") D SI^%ZAPM.ed.BSN
 D IMQ1 S:$D(IMQ2) BSY2(1)=$P(IMQ2,","),BSX2(2)=$P(IMQ2,",",2) S %I=$I
SPR ;СОЗДАНИЕ ПЕРЕМЕННЫХ ИЗ ОПЦИИ ДЛЯ ПЕЧАТИ
 I $D(PR2) G SK
 I DOS=1 G SPR1
 I $D(PRA) F ii=1:1:8 S @("PR"_ii)=$P(PRA,"@",ii) G:ii=8 OPR
 I $D(@(BSR_"(BST,""PRN"")")) S PRA=@$ZR F i=1:1:8 S @("PR"_i)=$P(PRA,"@",i) G:i=8 OPR
 F ii=2:1:9 S i=ii-1,@("PR"_i)=$P(^%ZAPM.ed.BSS("LPT",ii,2),"@",15) Q:ii=9
OPR S PR2=PR2-PR5 F i=4,6,7,8 S @("PR"_i)=$S(@("PR"_i)="Y":1,@("PR"_i)="N":0,1:"") G:i=8 SK
SPR1 ;ДЛЯ DOS-ФАЙЛА
 I $D(PRA1) F ii=1:1:8 S @("PR"_ii)=$P(PRA1,"@",ii) G:ii=8 OPR1
 I $D(@(BSR_"(BST,""HFS"")")) S PRA=@(BSR_"(BST,""HFS"")") F i=1:1:8 S @("PR"_i)=$P(PRA,"@",i) G:i=8 OPR1
 F ii=2:1:9 S i=ii-1,@("PR"_i)=$P(^%ZAPM.ed.BSS("HFS",ii,2),"@",15) Q:ii=9
OPR1 S:PR2="M" PR2=255 S PR2=PR2-PR5 F i=4,6,7,8 S @("PR"_i)=$S(@("PR"_i)="Y":1,@("PR"_i)="N":0,1:"") Q:i=8
SK ;НАЧАЛО
 I DOS=1 D DOSOPN^%ZAPM.ed.BSBL1 Q:'YES
 I $D(^%ZAPM.ed.BSbufB("uP"_$G(%BS(3),$P)_$J_"u"_%BS(15))) S IMQ3=$G(^%ZAPM.ed.BSbufB("uP"_$G(%BS(3),$P)_$J_"u"_%BS(15))) I IMQ3=IMQ1 S ls="ЕСТЬ ГОТОВЫЙ ФАЙЛ ВЫВОДА,БУДЕМ ВЫДАВАТЬ ?",%B=2 D YES^%ZAPM.ed.BSF I YES G:DOS'=1 PRN2^%ZAPM.ed.BSPRN1 D:DOS=1 DOSIN^%ZAPM.ed.BSBL1 U 0 Q
 K ^%ZAPM.ed.BSbufB("uP"_$G(%BS(3),$P)_$J_"u"_%BS(15)) S ^%ZAPM.ed.BSbufB("uP"_$G(%BS(3),$P)_$J_"u"_%BS(15))=IMQ1 I PRN=1 G KW^%ZAPM.ed.BSPRN1
 ;ВЫВОД БЛОКА
 I BSR="^%ZAPM.ed.BSbufB" S ls=" Это уже блок , извини , выводи всю ! " D O^%ZAPM.ed.BSF7 Q
 S ls="ФОРМИРУЕТСЯ БЛОК" D WAITS^%ZAPM.ed.BSF2
 D ^%ZAPM.ed.BSBL S BSR="^%ZAPM.ed.BSbufB",BST="L"_$G(%BS(3),$P)_$J_"u"_%BS(15) D TAB^%ZAPM.ed.BSF1,^%ZAPM.ed.BST K ^%ZAPM.ed.BSbufB("L"_$G(%BS(3),$P)_$J_"u"_%BS(15)) Q
IMQ1 S BSR=$P(IMQ1,",",1,$L(IMQ1,",")-1),BST=$P(IMQ1,",",$L(IMQ1,",")) Q
BEG ;ОСНОВНОЙ БЛОК ПОДГОТОВКИ ФАЙЛА ВЫВОДА
 D IMQ1 S BS0=0,BSX(BS0)=BSWX,BSY(BS0)=BSWY,(BSUY,BSUX)=1 S:BSWX=1 BSUX=0 S:BSWY=1 BSUY=0
WRITE S ls="ФОРМИРУЕТСЯ ФАЙЛ ВЫВОДА" D WAITS^%ZAPM.ed.BSF2,TIT ;PRN^%ZAPM.ed.BSPRN1
 Q
W S BSP=1 K BS1,BS2,BS  ;СОЗДАНИЕ БУФЕРНОГО ФАЙЛА ВЫВОДА
 K ENDDN S BSI=BSY(BS0)-1,BSDOS=1*DOS*PR4*AN6,PRF1=0 S:BSWY'=1 BSI=BSI+1 F  S BSI=$O(@(BSR_"(BST,BSI)")) Q:'BSI  K AN2,AN5 D  S PRF1=PRF1+1 D AN S BSDOS=$S(BSDOS=1:0,BSDOS=0:1,1:"") Q:$D(ENDDN)
 .K ENDRI S BSII=BSX(BS0)-1,BSDOS1=1*DOS*PR4 F  S BSII=$O(@(BSR_"(BST,BSI,BSII)")) Q:BSII=""  D WR S BSDOS1=$S(BSDOS1=1:0,BSDOS1=0:1,1:"")*DOS I $D(ENDRI)!($D(ENDDN)) Q
 Q
AN S BSF="",BSP0=$S(BS0=0:4,BS0=3:1,BS0=1:2,BS0=2:3,1:"") F  S BSF=$O(AN2(BSF)) Q:BSF=""  D  X WA
 .I DOS=0 S ^%ZAPM.ed.BSbufB("uP"_$G(%BS(3),$P)_$J_"u"_%BS(15),BSIT,BSP0,BSP)=AN2(BSF),BSP=BSP+1 Q
 .I PR4=0 S ^%ZAPM.ed.BSbufB("uP"_$G(%BS(3),$P)_$J_"u"_%BS(15),BSIT,BSP0,BSP)=AN2(BSF),BSP=BSP+1 Q
 .S AN8=$S(AN7=1:" ",AN7=0:"",1:""),AN10=$S(AN7=1:"#",AN7=0:"",1:""),^%ZAPM.ed.BSbufB("uP"_$G(%BS(3),$P)_$J_"u"_%BS(15),BSIT,BSP0,0)=AN10_AN5(BSF) I BSDOS=0 S ^%ZAPM.ed.BSbufB("uP"_$G(%BS(3),$P)_$J_"u"_%BS(15),BSIT,BSP0,BSP)=AN8_AN2(BSF),BSP=BSP+1 Q
 .S AN9=$S(AN7=1:"X",AN7=0:"",1:""),^%ZAPM.ed.BSbufB("uP"_$G(%BS(3),$P)_$J_"u"_%BS(15),BSIT,BSP0,BSP)=AN9_AN2(BSF),BSP=BSP+1
e Q
WR S CLR="" I $D(@(BSR_"(BST,BSI,BSII)")) S BS=^(BSII) I '$D(BS1) S BS1=$P(BS,"@")+1,BS2=$P(BS,"@",2)+1
 I (($P(BS,"@")+$P(BS,"@",3)-2)-BS1+2+(BSY1(BS0)*BSUY))*BSY2(BS0)>(BSY2(BS0)*BSY2(BS0)) S ENDDN=1,BSPY=BSI Q
 I $D(PRF) I $P(@(BSR_"(BST,BSI,1)"),"@",15)=PRF D  I PRF1>1 S ENDDN=1,BSPY=BSI Q
 .I BSWY=1 S PRF1=2 Q
 I (($P(BS,"@",2)+$P(BS,"@",4)-2)-BS2+1+(BSX1(BS0)*BSUX))>BSX2(BS0) S ENDRI=1 Q
 I $P(BS,"@",9)=1 S (d1,d,d0)=$P(BS,"@",15)
 E  S (d1,d,d0)=$G(^%ZAPM.ed.BSbufB("BB"_$G(%BS(3),$P)_$J_"u"_%BS(15),BSI,BSII))
 I BSWY'=1&($G(PRF)<2)&(BSII=1)&(d=$G(PRF)) S (d,d0,d1)=" "
 I d0="" S d0=0
 I $P(BS,"@",8)'="" S ny=BSI,nx=BSII,%zT=$ZT,$ZT="FISH^%ZAPM.ed.BSPRN" D  S $ZT=$G(%zT)
 .I '$P(BS,"@",8) X $G(@(BSR_"(BST,""FTR"","_BSI_","_BSII_")")) Q
 .X $G(@(BSR_"(BST,""FTR"","_$P(BS,"@",8)_")"))
 F BSF=1:1:$P(BS,"@",3) Q:($P(BS,"@")+BSF-BS1)*BSY2(BS0)>(BSY2(BS0)*BSY2(BS0))  D WRD S AN2(BSF)=AN2(BSF)_AN1,AN5(BSF)=AN5(BSF)_AN4
 Q
WRD S AN1=$E(d1,BSF*$P(BS,"@",4)-$P(BS,"@",4)+1,$P(BS,"@",4)+($P(BS,"@",4)*(BSF-1))),AN3=$S(BSDOS1=1:"X",BSDOS1=0:" ",1:""),AN4=$TR($J("",$P(BS,"@",4))," ",AN3)
 I '$D(AN2(BSF)) S AN2(BSF)="",AN5(BSF)=""
 I $L(AN1)<$P(BS,"@",4) S AN1=AN1_$J("",($P(BS,"@",4)-$L(AN1)))
 Q
TIT ;БЛОК ОПРЕДЕЛЕНИЯ ТИТУЛА И ГРАНИЧ. ТОЧЕК
 ;S:PR3'=+PR3 PRF=PR3,PR3=0
 I $P(@(BSR_"(BST)"),"@",19) S %TIT=$P(^(BST),"@",19)
 I $P(@(BSR_"(BST)"),"@",50) S %TIT=$P(^(BST),"@",50) ;ТИТУЛ ПЕЧАТИ```MSW
 E  K %TIT  ;G W
 I $P(@(BSR_"(BST)"),"@",8) S:$D(%TIT) BSTIT=%TIT*PR6 D  ;
 .I '$D(%TIT)!($G(BSTIT)=0) S BS0=0,BSY1(0)=$P(^(BST),"@",8),BSX1(0)=$P(^(BST),"@",9),BSY2(0)=PR3,BSX2(0)=PR2 S (AN6,AN7)=1 D W,PRN^%ZAPM.ed.BSPRN1 Q  ;ЕСЛИ БЕЗ ТИТУЛА
 .S BS0=0,BSY2(BS0)=PR3,BSX2(BS0)=PR2 D  S BSY1(BS0)=$P(@(BSR_"(BST,"_%TIT_")"),"@"),BSX1(BS0)=$P(@$ZR,"@",2)
 ..S BSY1(0)=+$P(^(BST),"@",8),BSX1(0)=+$P(^(BST),"@",9)
 .S BS0=1,(BSY1(3),BSY1(BS0))=+$P(@(BSR_"(BST)"),"@",8),BSX1(BS0)=BSX1(0),(BSY2(3),BSY2(BS0))=BSY1(0)-1,BSX2(BS0)=+PR2
 .S BS0=2,BSY1(BS0)=BSY1(0),(BSX1(3),BSX1(BS0))=+$P(^(BST),"@",9),BSY2(BS0)=PR3,(BSX2(3),BSX2(BS0))=BSX1(0)-1
 .S (BSY(3),BSX(3),BSY(1),BSX(2))=1,BSY(2)=BSY(0),BSX(1)=BSX(0) D
 ..I BSWX=1&(BSWY=1) S BS0=0,AN6=1,AN7=1 D W Q
 ..I BSWY=1 I BSWX'=1 S BS0=2,AN6=1,AN7=1 D W S BS0=0,AN6=$S(BSDOS=1:0,BSDOS=0:1,1:""),AN7=0 D W Q
 ..I BSWX=1 S BS0=1,AN6=1,AN7=1 D W S BS0=0,AN6=$S(BSDOS=1:0,BSDOS=0:1,1:""),AN7=1 D W Q
 ..S BS0=3,(AN6,AN7)=1 D W S BS0=1,AN6=1,AN7=0 D W S BS0=2,AN6=$S(BSDOS=1:0,BSDOS=0:1,1:""),AN10=AN6,AN7=1 D W S BS0=0,AN6=AN10,AN7=0 D W Q
 Q
FISH W $$bel^%ZAPM.ed.BS3 I $ZE["<NOPGM" S @$ZR=""
 S $ZT=$G(%zT) Q
]]></Routine>


<Routine name="%ZAPM.ed.BSPRN1" type="MAC" languagemode="0"><![CDATA[
%BSPRN1 ;ВЫВОД НА ПЕЧАТЬ II (А.Тимофеев) ; 17:04 10-JUN-98
PRN ;СОЗДАНИЕ СТРОКИ ВЫВОДА
 I $D(^%ZAPM.ed.BSbufB("uP"_$G(%BS(3),$P)_$J_"u"_%BS(15),BSIT,1)) D  Q
 .Q:'$D(^(1,BSP))  S STR=^(BSP)_$G(^%ZAPM.ed.BSbufB("uP"_$G(%BS(3),$P)_$J_"u"_%BS(15),BSIT,2,BSP))
 I $D(^%ZAPM.ed.BSbufB("uP"_$G(%BS(3),$P)_$J_"u"_%BS(15),BSIT,2)) Q:'$D(^(2,BSP))  S STR=^(BSP)
 Q
PRN1 I $D(^%ZAPM.ed.BSbufB("uP"_$G(%BS(3),$P)_$J_"u"_%BS(15),BSIT,3)) D  Q
 .Q:'$D(^(3,BSP))  S STR=^(BSP)_^%ZAPM.ed.BSbufB("uP"_$G(%BS(3),$P)_$J_"u"_%BS(15),BSIT,4,BSP)
 Q:'$D(^%ZAPM.ed.BSbufB("uP"_$G(%BS(3),$P)_$J_"u"_%BS(15),BSIT,4,BSP))  S STR=^%ZAPM.ed.BSbufB("uP"_$G(%BS(3),$P)_$J_"u"_%BS(15),BSIT,4,BSP)
e Q
PRN2 S %I=$P ;ВЫВОД НА ПЕЧАТЬ
PRN20 S ls=" Готово устройство печати ? " D YES^%ZAPM.ed.BSF Q:'YES
 S US=PR1,BSP="",%I=$P O US:255:1 E  S ls=" ПЕЧАТЬ ЗАНЯТА " D O^%ZAPM.ed.BSF7 G PRN2
 S %zT=$ZT,$ZT="STOP^%ZAPM.ed.BSPRN1"
 U US W $C(27,80) W $C(27,51,39) S SR=$G(@(BSR_"(BST,""SHR"")")) I SR'="" S SR1=$P(SR,"@"),SR2=$P(SR,"@",2),SR3=$P(SR,"@",3) D  ;ЕСЛИ ОПРЕДЕЛЕНЫ ПАРАМЕТРЫ
 .U US W:$G(SR1)'="" @("$C("_SR1_")") W:$G(SR2)'="" @("$C("_SR2_")") W:$G(SR3)'="" @("$C("_SR3_")")
 U %I R *R:0 I R=27 G STOP
 S ls=" Вывод информации " D WAITS^%ZAPM.ed.BSF2
 S BSIT="",QZ="" F  S BSIT=$O(^%ZAPM.ed.BSbufB("uP"_$G(%BS(3),$P)_$J_"u"_%BS(15),BSIT)) Q:BSIT=""  D  Q:QZ=1  D END
 .S BSP=0,STR="" D PRN I STR'="" D PRN3 Q:QZ=1
 .F BSP=1:1 S STR="" D PRN Q:STR=""  Q:QZ=1  D PRN3
 .Q:QZ=1  S BSP=0,STR="" D PRN1 I STR'="" D PRN3
 .Q:QZ=1  F BSP=1:1 S STR="" D PRN1 Q:STR=""  Q:QZ=1  D PRN3
 Q:QZ=1  G END1
PRN3 U US W !,$J("",PR5),STR U %I X $G(WA) R *R:0 I R=27 G STOP
 Q
END U US W:PR4=1 ! W:PR4=0 #
 Q
END1 U US W $C(27,80) W $C(27,51,39)
 C US U %I S $ZT=$G(%zT) R *R:0,*R:0,*R:0
 S R=1,ls="ЕЩЕ ЭКЗЕМПЛЯР ?",%B=2 D YES^%ZAPM.ed.BSF I YES>0 G PRN20
 Q
STOP W $$bel^%ZAPM.ed.BS3 S ls=" ПЕЧАТЬ ПРЕРВАНА ",QZ=1 D O^%ZAPM.ed.BSF7
 W $ZE
 G END1
BF ;ОПЦИИ ВЫВОДА
 K ^%ZAPM.ed.BSbufB("uP"_$G(%BS(3),$P)_$J_"u"_%BS(15))
BFB D SA^%ZAPM.ed.BSsBUF,R^%ZAPM.ed.BS3($NA(@BSR@(BST))),BF2,D^%ZAPM.ed.BS3($NA(@BSR@(BST))),RE^%ZAPM.ed.BSsBUF Q
BF2 I $D(@(BSR_"(BST,""PRN"")")) S PRA=@(BSR_"(BST,""PRN"")") F i=1:1:8 S @("PR"_i)=$P(PRA,"@",i) G:i=8 BF1
 F ii=2:1:9 S i=ii-1,@("PR"_i)=$P(^%ZAPM.ed.BSS("LPT",ii,2),"@",15) G:ii=9 BF1
BF1 K ^%ZAPM.ed.BSbufB("fTS"_$G(%BS(3),$P)_$J_"u"_%BS(15)),BSd,BSk S kk="LPT",j="^%ZAPM.ed.BSS(kk)",ii=@j D  F jj=2,4,5,12,13,14,15 S $P(ii,"@",jj)=""
 .S BSr1="^%ZAPM.ed.BSS",BSt1=kk,BSr2="^%ZAPM.ed.BSbufB",BSt2="fTS"_$G(%BS(3),$P)_$J_"u"_%BS(15) D COPY^%ZAPM.ed.BSTK Q
 S ^%ZAPM.ed.BSbufB("fTS"_$G(%BS(3),$P)_$J_"u"_%BS(15))=ii F PRB=2:1:9 S i=PRB-1,$P(^%ZAPM.ed.BSbufB("fTS"_$G(%BS(3),$P)_$J_"u"_%BS(15),PRB,2),"@",15)=@("PR"_i) Q:PRB=9
 S YYY=BSR_","_BST D  K ^%ZAPM.ed.BSbufB("fTS"_$G(%BS(3),$P)_$J_"u"_%BS(15)) Q
 .D SI^%ZAPM.ed.BSN N (%BS,vl,PRF,%zT,%KAT,%File,YYY,BSB,PRA)
 .S BST="fTS"_$G(%BS(3),$P)_$J_"u"_%BS(15),BSR="^%ZAPM.ed.BSbufB" D ^%ZAPM.ed.BST Q:R1=27  F PRB=2:1:9 S i=PRB-1,@("PR"_i)=$P(^%ZAPM.ed.BSbufB("fTS"_$G(%BS(3),$P)_$J_"u"_%BS(15),PRB,2),"@",15) Q:PRB=9
 .D  I PR8="Y" S $P(PRA,"@",8)="N",@($P(YYY,",",1,$L(YYY,",")-1)_"(($P(YYY,"","",$L(YYY,"",""))),""PRN"")")=PRA
 ..S PRA="" F i=1:1:8 S PRA=PRA_@("PR"_i)_"@" Q:i=8
 .Q
KW ;КАРТА ВЫВОДА
 S:PR3'=+PR3 PRF=PR3,PR3=0
 I '$D(ke) D REND^%ZAPM.ed.BSF2 I '$D(se) D DEND^%ZAPM.ed.BSF2
 K ^%ZAPM.ed.BSbufB("W"_$G(%BS(3),$P)_$J_"u"_%BS(15))
 U 0 S ls="ФОРМИРУЕТСЯ КАРТА" D WAITS^%ZAPM.ed.BSF2
 S (BSGY,BSGX)=0
 I $P(@(BSR_"(BST)"),"@",19) S BSGY=BSY2(1)*PR6,BSGX=BSX2(2)*PR6
KW1 K BSPX S I=0,J=2,UX=1,UY=0 F BSII1=1:1:ke X WA S BSII=BSII1-UY Q:BSII=""  I $D(@(BSR_"(BST,1,BSII)")) D  I $D(BSPX) S ^%ZAPM.ed.BSbufB("W"_$G(%BS(3),$P)_$J_"u"_%BS(15),1,J)="@@3@10@@@@@1@1;6;33;45@@@@@С КОЛОНКИ           :"_UX,J=J+1,UX=BSII,UY=PR6+UY,I=BSGX*PR6 K BSPX
 .I ($P(^(BSII),"@",4)+I)>(PR2) S BSPX=1 Q
 .S I=I+$P(^(BSII),"@",4) Q
 S ^%ZAPM.ed.BSbufB("W"_$G(%BS(3),$P)_$J_"u"_%BS(15),1,J)="@@3@10@@@@@1@1;6;33;45@@@@@С КОЛОНКИ           :"_UX,ke=J
 K BSPY S I=0,J=2,UY=1,UX=0 F BSI1=1:1:se X WA S BSI=BSI1-UX Q:BSI=""  I $D(@(BSR_"(BST,BSI,1)")) D  I $D(BSPY) S ^%ZAPM.ed.BSbufB("W"_$G(%BS(3),$P)_$J_"u"_%BS(15),J,1)="@@2@10@@@@@1@1;6;33;45@@@@@СО СТРОКИ :"_UY,J=J+1,UY=BSI-1,UX=PR6+UX,I=BSGY*PR6 K BSPY
 .I $D(PRF) D  Q
 ..I ($P(^(1),"@",15))=PRF S BSPY=1,UX=UX-1 Q
 ..S I=I+$P(^(1),"@",3) Q
 .I ($P(^(1),"@",3)+I)*PR3>(PR3*PR3) S BSPY=1 Q
 .S I=I+$P(^(1),"@",3) Q
 S ^%ZAPM.ed.BSbufB("W"_$G(%BS(3),$P)_$J_"u"_%BS(15),J,1)="@@2@10@@@@@1@1;6;33;45@@@@@СО СТРОКИ :"_UY,se=J
 S ^%ZAPM.ed.BSbufB("W"_$G(%BS(3),$P)_$J_"u"_%BS(15),1,1)="@@3@10@@@@@1@1;6;33;45@@@@@  КАРТА     ВЫВОДА  "
 S ^%ZAPM.ed.BSbufB("W"_$G(%BS(3),$P)_$J_"u"_%BS(15))="@@@@@@@1@1@22@80@@X MRMR@@OFK^%ZAPM.ed.BSPRN1@1@1@@"
 G:PR7=0 WBK S BST="W"_$G(%BS(3),$P)_$J_"u"_%BS(15),BSR="^%ZAPM.ed.BSbufB"
 ;```D RESZER^%ZAPM.ed.BSF2,TAB^%ZAPM.ed.BSF1,TIT^%ZAPM.ed.BST
 D TAB^%ZAPM.ed.BSF1,TIT^%ZAPM.ed.BST D x^%ZAPM.ed.BS3("72+PRN1")     ;---//--- для msm 4.x.x
 I DOS=1 S MRMR="W /CUP(23,1),/EL(0),$$clr^%ZAPM.ed.BS3(4),"" <F2> - Вывод в DOS-файл <ENTER> - На экран  <ESC> - Отмена """ G KW2
 S MRMR="W /CUP(23,1),/EL(0),$$clr^%ZAPM.ed.BS3(4),"" <F2> - Вывод на печать <ENTER> - На экран  <ESC> - Отмена """
KW2 D STA^%ZAPM.ed.BST I R1=27 Q  ;ДЛЯ ЭКРАНА
 S BSWX=$P($P(^%ZAPM.ed.BSbufB("W"_$G(%BS(3),$P)_$J_"u"_%BS(15),1,nx),"@",15),":",2),BSWY=$P($P(^%ZAPM.ed.BSbufB("W"_$G(%BS(3),$P)_$J_"u"_%BS(15),ny,1),"@",15),":",2),BSIT=1 D  G KW2
 .D SI^%ZAPM.ed.BSN N (%BS,vl,PRF,%zT,%KAT,%File,k0,k1,k2,k3,k4,k5,BSB,BSWX,BSWY,IMQ1,PR1,PR2,PR3,PR4,PR5,PR6,PR7,PR8,BSIT,DOS,%FN,%DEV,%I,SR1,SR2,SR3,SR) D BEG^%ZAPM.ed.BSPRN,WTV Q
 Q
KW3 S BSWX=$P($P(^%ZAPM.ed.BSbufB("W"_$G(%BS(3),$P)_$J_"u"_%BS(15),1,nx),"@",15),":",2),BSWY=$P($P(^%ZAPM.ed.BSbufB("W"_$G(%BS(3),$P)_$J_"u"_%BS(15),ny,1),"@",15),":",2),$P(^%ZAPM.ed.BSbufB("W"_$G(%BS(3),$P)_$J_"u"_%BS(15),ny,nx),"@",15)="  ВЫДАН  " D  Q  ;ДЛЯ ПЕЧАТИ
 .D SI^%ZAPM.ed.BSN N (%BS,vl,PRF,%zT,%KAT,%File,k0,k1,k2,k3,k4,k5,BSB,BSWX,BSWY,IMQ1,PR1,PR2,PR3,PR4,PR5,PR6,PR7,PR8,DOS,%FN,%DEV,BSIT,%I,SR1,SR2,SR3,SR)
 .S BSIT=1 D BEG^%ZAPM.ed.BSPRN D  Q
 ..I DOS=1 D DOSIN^%ZAPM.ed.BSBL U 0 Q
 ..D PRN2
WBK ;ВЫВОД БЕЗ КАРТЫ
 D SI^%ZAPM.ed.BSN N (%BS,vl,PRF,%zT,%KAT,%File,k0,k2,k1,k3,k4,k5,BSB,BSIK,BSIIK,BSIT,IMQ1,PR1,PR2,PR3,PR4,PR5,PR6,PR7,PR8,DOS,%FN,%DEV,%I,SR1,SR2,SR3,SR)
 S BSIT=0,BSIK=1 F  S BSIK=$O(^%ZAPM.ed.BSbufB("W"_$G(%BS(3),$P)_$J_"u"_%BS(15),BSIK)) Q:BSIK=""  S BSWY=$P($P(^%ZAPM.ed.BSbufB("W"_$G(%BS(3),$P)_$J_"u"_%BS(15),BSIK,1),"@",15),":",2),BSIIK=1 D  ;
 .F  S BSIIK=$O(^%ZAPM.ed.BSbufB("W"_$G(%BS(3),$P)_$J_"u"_%BS(15),1,BSIIK)) Q:BSIIK=""  S BSWX=$P($P(^(BSIIK),"@",15),":",2) S BSIT=BSIT+1 D BEG^%ZAPM.ed.BSPRN
 I DOS=1 D DOSIN^%ZAPM.ed.BSBL1 U 0 Q
 G PRN2
WTV ;ВЫВОД НА ЭКРАН
 W /ED(2),/CUP(1,1)
 S %I=$I,BSIT="" F  S BSIT=$O(^%ZAPM.ed.BSbufB("uP"_$G(%BS(3),$P)_$J_"u"_%BS(15),BSIT)) Q:BSIT=""  D
 .F BSP=1:1:21 S STR="" D PRN Q:STR=""  D WTV2
 .F BSP=1:1:21 S STR="" D PRN1 Q:STR=""  D WTV2
 K ^%ZAPM.ed.BSbufB("uP"_$G(%BS(3),$P)_$J_"u"_%BS(15)) S ls=" Отказ - <ESC>  " D O^%ZAPM.ed.BSF7 W $$r^%ZAPM.ed.BS3 Q
 G END1
WTV1 W $$r^%ZAPM.ed.BS3 Q
D D D^%ZAPM.ed.BS3($NA(@BSR@(BST))) G 0^%ZAPM.ed.BSTM
OFK I R3=81 D KW3
 G D
RPRN ;ПОВТОР ПЕЧАТИ
 I '$D(^%ZAPM.ed.BSbufB("ZP"_$G(%BS(3),$P)_$J_"u"_%BS(15))) Q
 S DAT=^%ZAPM.ed.BSbufB("ZP"_$G(%BS(3),$P)_$J_"u"_%BS(15)),PR1=$P(DAT,"."),PR4=$P(DAT,".",2),PR5=$P(DAT,".",3),SR=$P(DAT,".",4),SR1=$P(DAT,".",5),SR2=$P(DAT,".",6),SR3=$P(DAT,".",7)
 G PRN2
WTV2  W !,$E(STR,1,78) Q
]]></Routine>


<Routine name="%ZAPM.ed.BSS" type="MAC" languagemode="0"><![CDATA[
%BSS ;СОРТИРОВКА,ПОДЖАТИЕ,ПОИСК,КОДИФИКАТОРЫ,ЗАМЕНА ; 15:26   24.01.2000
 N SB
 I $P(B,"@",24)'="S" G SORT^%ZAPM.ed.BSS2:($P(B,"@",36)&(TIP<2)) G PRESS
 K ^%ZAPM.ed.BSbufB("Sort"_$G(%BS(3),$P)_$J_"u"_%BS(15)) S SB=$ZR,Nx=nx,Na=$$SORTNA^%ZAPM.ed.BSS2($P($P(B,"@",36),",",3)) I $P($P(B,"@",36),",",4) S Nx=$$SORTFOR^%ZAPM.ed.BSS2($P($P(B,"@",36),",",4))
 S WA="",ls="СОРТИРОВКА ПО КОЛОНКЕ "_Nx D WAITS^%ZAPM.ed.BSF2
 D DEND^%ZAPM.ed.BSF2 D:'$D(ke) REND^%ZAPM.ed.BSF2
 F i=1:1:se I $G(@BSR@(BST,i)) S I=$$SORTDATA() D  X $G(WA)
 .I I="" S I="@"
S .I '$D(@SB@(I)) D  Q
 ..F j=1:1:ke S @SB@(I,j)=@BSR@(BST,i,j)
 .S II=$O(@SB@(I,"?",""),-1)+1
 .F j=1:1:ke S @SB@(I,"?",II,j)=@BSR@(BST,i,j)
 I '$D(@SB) G NO
 S I="",kj=0,II="" F i=1:1:se I $G(@BSR@(BST,i)) X $G(WA) D
 .I I'="",$D(@SB@(I,"?")) D  Q:II'=""
 ..S II=$O(@SB@(I,"?",II),Na) Q:II=""  D SETSORT($NA(@SB@(I,"?",II)))
 .S I=$O(@SB@(I),Na) D SETSORT($NA(@SB@(I)))
 Q:$D(IntSortS)
 D TAB^%ZAPM.ed.BSF1 Q:$D(IntSort)
 D TIT^%ZAPM.ed.BST,W^%ZAPM.ed.BST G B^%ZAPM.ed.BSTM
SETSORT(II) F j=1:1:ke S @BSR@(BST,i,j)=@II@(j) I $P(@$ZR,"@",7)=3 S kj=kj+1,$P(@$ZR,"@",15)=kj
 Q
D G 0^%ZAPM.ed.BSTM
SORTDATA() I Nx'["," Q "%"_$E($P(@BSR@(BST,i,+Nx),"@",15),1,$$LNG^%ZAPM.ed.BSF12)
 N F,FF S FF="" X "F F="_Nx_" Q:'F  D SORTD" Q "%"_FF
SORTD S FF=FF_$P(@BSR@(BST,i,F),"@",15)_"," Q
NO S ls=" Это НЕ список, или список пустой " D O^%ZAPM.ed.BSF7 G D
LE D LE^%ZAPM.ed.BSTT Q
 Q  ;ls-ТЕКСТ ll-ЗАПРЕЩЕННЫЕ СИМВОЛЫ li-СТРОКА
PRESS I $P(B,"@",24) D UNPRESS^%ZAPM.ed.BSSR D TIT^%ZAPM.ed.BST,W^%ZAPM.ed.BST G B^%ZAPM.ed.BSTM
 S OO=16,OOO="^%ZAPM.ed.BS" K %JB D 24^%ZAPM.ed.BSTM,^%ZAPM.ed.BSB,ZA^%ZAPM.ed.BSF G D:R1=27
 D PRESS^%ZAPM.ed.BSSR G D:YES<1 S $P(@(BSR_"(BST)"),"@",24)=1,B=@$ZR
PRE D TAB^%ZAPM.ed.BSF1,TIT^%ZAPM.ed.BST,W^%ZAPM.ed.BST G B^%ZAPM.ed.BSTM
CONT S fi=2 G FID
CONTAB I $D(%ZAP) S ls=" ТАБЛИЦА ЗАЩИЩЕНА ОТ КОРРЕКЦИИ ДАННЫХ " D O^%ZAPM.ed.BSF7 G D
 I '$D(%w(5)) D PASD^%ZAPM.ed.BST1 E  G D
 S li=$G(^%ZAPM.ed.BSbufB(0,$G(%BS(3),$P),2)),ls=" ЗАМЕНА В ТАБЛИЦЕ Вводите Контекст что заменять" D LE^%ZAPM.ed.BSTT I 'YES G D^%ZAPM.ed.BS
 S d1=li,ls=" Вводите СТРОКУ ,НА что заменять" D LE^%ZAPM.ed.BSTT G D^%ZAPM.ed.BS:'YES D CC
 S d0=li,li=d1,%zT=$ZT,$ZT="ERR^%ZAPM.ed.BSS",do="I $P(^(j),""@"",5)'=1 Q:$P(^(j),""@"",15)'[li  S d=$P(^(j),""@"",15),TmP=$ZR D CCC^%ZAPM.ed.BSS I YES D CONTX^%ZAPM.ed.BSS S $P(@TmP,""@"",15)=d" D BLOK^%ZAPM.ed.BSF1 E  G D
 S ^%ZAPM.ed.BSbufB(0,$G(%BS(3),$P),2)=li,$ZT=$G(%zT) K d2 D W^%ZAPM.ed.BST
 G B^%ZAPM.ed.BSTM
FIDD S fi=1
FID N jj,jjj,%HIS,%hlp,iC
 I TIP'=2!('$D(BSD)) S ls="ЭТО НЕ КАРТА БАЗЫ ДАННЫХ" D O^%ZAPM.ed.BSF7 G D
 I $D(NOKEY) S ls="Войдите В КАРТУ БАЗЫ ДАННЫХ нормальным образом (Не нажимая F4)" D O^%ZAPM.ed.BSF7 G D
 I $P(BS,"@",9)<2 S ls=" Клетка {"_ny_","_nx_"} Не хранится В Базе Данных ! " D O^%ZAPM.ed.BSF7 G D
 S Refresh=1
 S li=$G(^%ZAPM.ed.BSbufB(0,$G(%BS(3),$P),2)),ls=" ("_$S(fi=1:"ПОИСК",1:"ЗАМЕНА")_" В БАЗЕ ДАННЫХ) Вводите Контекст "_$S(fi=1:"поиска (F1-помощь)",1:",что заменять"),%HIS=$$HISFIND(),%hlp="^%ZAPM.ed.BSHLP(Find" D LE^%ZAPM.ed.BSTT I 'YES G D^%ZAPM.ed.BS
 I li["@" D FINDCEL^%ZAPM.ed.BSIND(li,ny,nx,BSR,BST) G:$G(END)=2 NEWCARD G D ;ИНДЕКСИРОВАННЫЕ ПОКАЗАТЕЛИ
 I fi'=1 S d=li,ls=" (ЗАМЕНА В БАЗЕ ДАННЫХ) Вводите СТРОКУ ,НА что заменять" D LE^%ZAPM.ed.BSTT G D^%ZAPM.ed.BS:'YES D CC
 G:li=""&(fi=1) D S:fi=2 d0=li,li=d S ^%ZAPM.ed.BSbufB(0,$G(%BS(3),$P),2)=li
 S jj=$S($P($P(BS,"@",18),"#")="":ny_","_nx,1:$P($P(BS,"@",18),"#")),jjj=$C(34) I jj=+jj S jjj=""
 S j=","_jjj_jj_jjj_")" K jj,jjj
 S YES=0,ls=$S(fi=1:"ПОИСК",1:"ЗАМЕНА:<"_li_"> НА:<"_d0_">")_" В БАЗЕ ДАННЫХ"
 D WAITS^%ZAPM.ed.BSF2 I fi=1,$$FFII() G Begin
 S i=BSD I $D(%KEYS(0)) S iC=$$CHOISE(%KEYS(0)) S:iC'="" i=i_iC I iC="" D ErrMsg^%ZAPM.ed.BSXfun("Отмена поиска") G FINiC
 ;ССЫЛКА СНАЧАЛА
Begin I $$ACTION() G NEWCARD
 K d2,END G FIN:fi=1,NEWC
CC S ls=" ЗАМЕНА С КОНТРОЛЕМ ? " D YES^%ZAPM.ed.BSF S fiii=YES Q
CCC S YES=1 Q:'fiii  S ls=" КЛЕТКА {"_i_","_j_"}="_$E(d,1,30)_"... ЗАМЕНЯЕМ ? " D YES^%ZAPM.ed.BSF Q
CONTX Q:d'[li  S d=$$TR^%ZAPM.ed.BSsFUNM(d,li,d0) Q
ERR S ls=$ZE D O^%ZAPM.ed.BSF7 G D
CHOISE(K) ;ВЫБОР КЛЮЧА
 N T1,T2,T3 S T1="^%ZAPM.ed.BSbufB",T2="0k"_$G(%BS(3),$P)_$J_"u"_%BS(15),T3=li
 N (K,%BS,T1,T2,T3)
 S A=$$LOAD^%ZAPM.ed.BSscrF("^%ZAPM.ed.BSS(KCH0)",1,2,"","CHOIS^%ZAPM.ed.BSS")
 S tab=$P(%BS("Tmp","LastTabl"),"@",4) I tab=27 Q ""
 S K=$P(%BS("Tmp","LastTabl"),"@",9)
 Q K
CHOIS ;ПОЛОМАТЬ ТАБЛИЦУ
 S $P(@BSR@(BST,2,3),"@",15)="ДЛЯ ПОИСКА:"_$G(T3)
 S Le="Find0Key" I '$D(%BS("Tmp",Le)) S %BS("Tmp",Le,1)=T1,%BS("Tmp",Le,2)=T2,%BS("Tmp",Le,3)=K
 I '$D(@T1@(T2)) S T1=%BS("Tmp",Le,1),T2=%BS("Tmp",Le,2),K=%BS("Tmp",Le,3)
 S AA=3 F A=3:1 Q:'$D(@T1@(T2,A,1))  D
 .S @BSR@(BST,A,1)=@BSR@(BST,3,1)
 .S @BSR@(BST,A,2)=@BSR@(BST,3,2)
 .S @BSR@(BST,A,3)=@BSR@(BST,3,3)
 .S $P(@BSR@(BST,A,3),"@",15)=$P(@T1@(T2,A,1),"@",15) I K=$P(@T1@(T2,A,1),"@",15) S AA=A
 S @BSR@(BST,"STA")=AA_",3@3@3@@@@"_(AA+2)_"@17"
 Q
ACTION() S %zT=$ZT,$ZT="ERA^%ZAPM.ed.BSS" D Wait^%ZAPM.ed.BSXfun("Поиск по шаблону "_li)
 K END F  S i=$ZO(@i) Q:i=""  D:i[j  Q:$D(END)  I YES Q
 .X WA I fi=1,$$ACTI(i,li) S zr=i W $$bel^%ZAPM.ed.BS3 S ls=$E(" Нашли "_$P(i,"(",2)_"="_$E(@i,1,30)_"...",1,79) D MENU^%ZAPM.ed.BSF5(" УСТАНОВИМ ДАЛЬШЕ ПРЕРВАТЬ ",ls) S:%B=3 END=1 S:%B=2 YES=0 I %B=1 S YES=1 Q
 .I fi=2,@i[li D:'fiii  Q:'fiii  S ls=$E(" Найдена "_$P(i,"(",2)_"="_$E(@i,1,30)_"...",1,79) W $$bel^%ZAPM.ed.BS3 D MENU^%ZAPM.ed.BSF5(" ЗАМЕНИМ ДАЛЬШЕ ПРЕРВАТЬ ",ls) S:%B=2 YES=0 S:%B=3 END=1 I %B=1 D  S YES=0
 ..S d=@i,%zT=$ZT,$ZT="ERR^%ZAPM.ed.BSS" D CONTX S @i=d,$ZT=$G(%zT),YES=0 I d="" K @i
 I YES Q 1
 Q 0
ACTI(i,li) I li'["?",("@"_@i)[("@"_li) Q 1
 I li["?" X "I (""@""_@i)"_li I  Q 1
 Q 0
ERA D ErrMsg^%ZAPM.ed.BSXfun($ZE_" "_$$ErrSay^%ZAPM.ed.BSF8($ZE)) S $ZT=$G(%zT) Q 0
FFII() N (%BS,i,li,%NAm)
 I li["*"!(li["?") D
 .N I,S,II,SS
 .S S=$TR(li,"?","*"),SS="",II=0 F I=1:1 Q:$P(S,"*",I,I+1)=""  D
 ..S II=II+$L($P(S,"*",I))+1
 ..I $P(S,"*",I)'="" S SS=SS_"1"""_$P(S,"*",I)_""""
 ..I $E(li,II)="*" S SS=SS_".E"
 ..I $E(li,II)="?" S SS=SS_"1E"
 .S li="?1""@"""_SS_$S($E(li,$L(li))="*":".E",1:"")
 D Yes^%ZAPM.ed.BSXfun("ПРОДОЛЖАЕМ ПОИСК ОТ ТЕКУЩЕЙ КАРТЫ ?")
 I YES>0 S i=$E(%NAm,1,$L(%NAm)-1)_")" K END Q 1
 Q 0
NEWCARD ;zr - НОВАЯ ССЫЛКА j=",57)"  ----- $QS !!!!
 K ^%ZAPM.ed.BSbufB("BB"_$G(%BS(3),$P)_$J_"u"_%BS(15)) F m=1:1:9 K ^%ZAPM.ed.BSbufB(m_"k"_$G(%BS(3),$P)_$J_"u"_%BS(15))
 S k=$P($P(zr,"(",2),j) F i=1:1 Q:$P(k,",",i)=""  S %KEYS(i)=$P(k,",",i) I %KEYS(i)'=+%KEYS(i)&($E(%KEYS(i),1)=$C(34)) S %KEYS(i)=$E(%KEYS(i),2,$L(%KEYS(i))-1)
 ;D x^%ZAPM.ed.BS3(zr)     ;---//--- для msm 4.x.x
 I $D(%KEYS(0)) S %KEYS(0)=$P($P(zr,BSD,2),"(",1) I %KEYS(0)="" ZT "KEY0"
 I $D(%KEYS(i)) ZT "KEY("_i
NEWC D %NAm^%ZAPM.ed.BST1,FOR^%ZAPM.ed.BSF3 X I_" D BSD^%ZAPM.ed.BST1" D CALC^%ZAPM.ed.BSF3 G CARD
CARD F i=0:1:9 I $D(%KEYS(i)) S @("k"_i)=%KEYS(i)
 G KEY^%ZAPM.ed.BST
ShiftF7 ;ПОВТОРНЫЙ ПОИСК
 S Tmp="ShifF7",li=$G(^%ZAPM.ed.BSbufB(0,$G(%BS(3),$P),2)),fi=nx_","_ny_",0,1,1"
 S ls="ПОВТОРНЫЙ ПОИСК..."_li
 G FIND
HISFIND() Q "^%ZAPM.ed.BSbufB(""HISFIND"_$S('$E(%BS(1),12):$G(%BS(3),$P)_$G(%BS(12)),$E(%BS(1),12)=1:"1"_$G(%BS(12)),1:"1")_""")"
FindTxt(fi) ;fi=nx,ny,FLAG_REG,FLAG_TRAN,[
FIND S f2=$P(fi,",",2),f3=$P(fi,",",3),f4=$P(fi,",",4),f5=$P(fi,",",5),fi=$P(fi,",") S:"DFLT"[f2 f2=ny S f5=$S(f5:"",1:"@")
 S fii=$S(BSR["BSbufR":" ^",BSR["BSbuT":" ~",1:"") D WAITS^%ZAPM.ed.BSF2
 G:$G(Tmp)="Mark"!($G(Tmp)="ShifF7") fiN
 S %HIS=$$HISFIND()
 S li=$G(finl,$G(^%ZAPM.ed.BSbufB(0,$G(%BS(3),$P),2))),ls=" (ПОИСК "_$S(f4:"ТРАНСФ.",1:"ДАННЫХ")_" В"_$S(fi:" "_fi_" КОЛОНКЕ",1:"О ВСЕЙ ТАБЛИЦЕ")_")  Вводите Контекст поиска" D LE^%ZAPM.ed.BSTT I 'YES G D^%ZAPM.ed.BS
 G:li="" D S ls="ПОИСК" D WAITS^%ZAPM.ed.BSF2
fiN D:'$D(se) DEND^%ZAPM.ed.BSF2
 I fi'=1 D:'$D(ke) REND^%ZAPM.ed.BSF2
 S YES=0,^%ZAPM.ed.BSbufB(0,$G(%BS(3),$P),2)=$G(li) F i=f2:1:se X $G(WA) F j=$S(fi:fi,1:1):1:$S(fi:fi,1:ke) I $D(@(BSR_"(BST,i,j)")) D  I YES S BSY(0)=i D TW^%ZAPM.ed.BST K MY,Tmp D KLE^%ZAPM.ed.BSTM G D
 .I $G(Tmp)="Mark" D  Q
 ..I $P(^(j),"@",12) S ls=" Найдена КЛЕТКА {"_i_","_j_"}="_$E(d1,1,60)_"... Годится ? " D YES^%ZAPM.ed.BSF Q
 .I $P(^(j),"@",9)=1 S (d,d0,d1)=$P(^(j),"@",15)
 .E  S (d,d0,d1)=$G(^%ZAPM.ed.BSbufB("BB"_$G(%BS(3),$P)_$J_"u"_%BS(15),i,j))
 .I f4 S BS=@BSR@(BST,i,j),ny=i,nx=j D
 ..I $P(BS,"@",8)'="" S %zT=$ZT,$ZT="FTRe^%ZAPM.ed.BSS" D  S $ZT=$G(%zT),YES=0
 ...I d0="" S d0=0
 ...I '$P(BS,"@",8) X $G(@(BSR_"(BST,""FTR"",ny,nx)")) Q
 ...X $G(@(BSR_"(BST,""FTR"","_$P(BS,"@",8)_")"))
 .I 'f3 I (f5_$$BIGL^%ZAPM.ed.BSsFUNM(d1))[(f5_fii_$$BIGL^%ZAPM.ed.BSsFUNM(li)) S ls=" Найдена КЛЕТКА {"_i_","_j_"}="_$E(d1,1,60)_"... Годится ? " D YES^%ZAPM.ed.BSF Q
 .I (f5_d1)[(f5_fii_li) S ls=" Найдена КЛЕТКА {"_i_","_j_"}="_$E(d1,1,60)_"... Годится ? " D YES^%ZAPM.ed.BSF Q
FIN S ls=" Поиск НЕ увенчался успехом " D O^%ZAPM.ed.BSF7
FINiC K Tmp,f5,f1,f2,f3,f4,fi,fii,fiii,finl,Tmp G D
FTRe S $ZT=$G(%zT) W $$bel^%ZAPM.ed.BS3 Q
 ;s1-ТЕКСТ s2=ИМЯ УЗЛА s3-ТИП s4-1 КОЛ s5-?
DIN S s1="МикроЗапросы",s2="DIN",s3="dinamo",s4="Формул $$TSVV для сводки",s5=0 G MASS
INV S s1="Кодификатоp",s2="INV",s3="invert",s4="Кодов",s5=1 G MASS
ERGLO S ls=" Не корректное имя массива ",$ZT=$G(%zT) D O^%ZAPM.ed.BSF7
MASS I BST["@" S ls=" СНАЧАЛО ВЫЙДИТЕ ИЗ РЕЖИМА КОРРЕКЦИИ <F3> " D O^%ZAPM.ed.BSF7 G D
 I '$D(%DIA) S ls=" БЛОК НЕ ОПРЕДЕЛЕН ! " D O^%ZAPM.ed.BSF7 G D
 G:$D(%INV) GOO S ls=" Вы хотите создать "_s1_" ? " D YES^%ZAPM.ed.BSF I 'YES G D
 S li=$G(@(BSR_"(BST,s2)")),ls="Enter the name of the global array :",ll="@" D LE^%ZAPM.ed.BSTT I 'YES G D
 S %zT=$ZT,$ZT="ERGLO^%ZAPM.ed.BSS" S:li'["^" li="^"_li I '$D(@li) G GO
 I $G(@li)'[("%BS-"_s3) S ls=" МАССИВ "_li_" СУЩЕСТВУЕТ И НЕ НАШ ! БУДЕМ ИСПОЛЬЗОВАТЬ ? " W $$bel^%ZAPM.ed.BS3 D YES^%ZAPM.ed.BSF G:'YES MASS
 I $G(@li)'["%BS-"_s3_"-"_BSR_","_BST_"@" S ls=" МАССИВ создан из "_$P($P($G(@li),"-",3,9),"@")_" ! БУДЕМ ИСПОЛЬЗОВАТЬ ? " W $$bel^%ZAPM.ed.BS3 D YES^%ZAPM.ed.BSF G:'YES MASS
 S ls=" БУДЕМ ОБНОВЛЯТЬ ? " D YES^%ZAPM.ed.BSF I 'YES G D
GO S %INV=li,$ZT=$G(%zT),s6="" S ls="Введите / Корректируйте комментарий",li=$P($G(@%INV),"@",2),ll="@" D LE^%ZAPM.ed.BSTT S:YES s6=li
GOO I '$D(%INV1) S ls=" Указатель находится в колонке "_s4_" ? " D YES^%ZAPM.ed.BSF D:'YES  G D:'YES S %INV1=nx G:TIP=4&(s2="DIN") DIN^%ZAPM.ed.BSF11 D OkMsg^%ZAPM.ed.BSXfun("ТЕПЕРЬ УСТАНОВИТЕ УКАЗАТЕЛЬ В ПОЛЕ ТЕКСТОВ И ПОВТОРИТЕ <F6>...и т.д.") G D
 .D ErrMsg^%ZAPM.ed.BSXfun("НУ ЧТО-ЖЕ ВЫ ! УСТАНОВИТЕ УКАЗАТЕЛЬ ТУДА И ПОВТОРИТЕ <F6>...и т.д.")
 S ls=" Указатель находится в колонке ТЕКСТов ? " D YES^%ZAPM.ed.BSF S:YES %INV2=nx I 'YES G D
 I %INV1=%INV2 S ls=" КОЛОНКИ СОВПАДАЮТ ?! " K %INV1,%INV2 D O^%ZAPM.ed.BSF7 G D
 D SETKD
 F i=1:1:se I $D(@(BSR_"(BST,i,%INV1)")),$P(^(%INV1),"@",12) D:s5  D:'s5 DINA I 'YES S BSY(0)=i D TW^%ZAPM.ed.BST,KLE^%ZAPM.ed.BSTM G D
 .S kod=$P(@$ZR,"@",15),txt=$P(^(%INV2),"@",15) I kod="" S ls=" КОД В СТРОКЕ "_i_" ПУСТОЙ ! " D O^%ZAPM.ed.BSF7 S YES=0 Q
 .I txt="" S ls=" ТЕКСТ В СТРОКЕ "_i_" ПУСТОЙ ! " D O^%ZAPM.ed.BSF7 S YES=0 Q
 .I $D(@%INV@(1,kod)) S ls=" КОД="_kod_" УЖЕ БЫЛ !!! " D O^%ZAPM.ed.BSF7 S YES=0 Q
 .S @%INV@(1,kod)=txt,@%INV@(2,txt)=kod,s6=s6+1
ENDIN I 's6 D ErrMsg^%ZAPM.ed.BSXfun("НЕ СОЗДАЛОСЬ НЕ ОДНОГО УЗЛА !")
 I s6 D OkMsg^%ZAPM.ed.BSXfun("СОЗДАЛОСЬ "_s6_" УЗЛОВ !") S @(BSR_"(BST,s2)")=%INV,@%INV@(1)=s6
 D U^%ZAPM.ed.BS3(%INV) K s6,s1,s2,s3,s4,s5,%INV,%INV1,%INV2,kod,txt G D
DINA S txt=$P(^(%INV2),"@",15),kod=$P(^(%INV1),"@",15) I kod="" S ls=" ФОРМУЛА В СТРОКЕ "_i_" ОТСУТСТВУЕТ ! " D O^%ZAPM.ed.BSF7 S YES=0 Q
 I txt="" S ls=" ТЕКСТ В СТРОКЕ "_i_" ПУСТОЙ ! " D O^%ZAPM.ed.BSF7 S YES=0 Q
 S (k1,k2,k3,k4,k5,k6,k7,k8,k9)=1,%zT=$ZT,$ZT="DINER^%ZAPM.ed.BSS"
 X "I "_kod
DINASET S s6=s6+1,@%INV@(1,s6)=txt_"@"_kod
 S $ZT=$G(%zT) Q
DINASE(txt,kod) G DINASET
TSVV(kod) X "I "_kod Q $T
SETKD D L^%ZAPM.ed.BS3(%INV) K GrKoD
 D DEL^%ZAPM.ed.BSF10($NA(@%INV@(1)),3),DEL^%ZAPM.ed.BSF10($NA(@%INV@(2)),3) K @%INV@(1),@%INV@(2)
 S YES=1,@%INV="%BS-"_s3_"-"_BSR_","_BST_"@"_s6_"@"_$G(%INV1)_"@"_$G(%INV2) D CP^%ZAPM.ed.BSGCH(%INV,$P(%BS(22),",",2))
 S $P(@%INV,"@",7)=$$h^%ZAPM.ed.BS3(),$P(@$ZR,"@",8)=1,s6=0,ls="Делаю "_s1 D WAITS^%ZAPM.ed.BSF2,DEND^%ZAPM.ed.BSF2
 Q
DINER D ErrMsg^%ZAPM.ed.BSXfun("Ошибка формулы в строке:"_i_" "_$$ErrSay^%ZAPM.ed.BSF8($ZE)) S YES=0 Q
]]></Routine>


<Routine name="%ZAPM.ed.BSS1" type="MAC" languagemode="0"><![CDATA[
%BSS1 ;СОХРАНЕНИЕ,ВОССТАНОВЛЕНИЕ,СИМВОЛЬНЫЕ ИМЕНА ; 15:06   15.04.2003
e Q
COPY D DOSOPN^%ZAPM.ed.BSBL1 I '$D(%FN) K %DEV Q  ;СОХРАНЕНИЕ ОПИСАНИЯ ТАБЛИЦ
 S %zT=$ZT,$ZT="ER^%ZAPM.ed.BSS1",ls="СОХРАНЕНИЕ...~"_%TAB D WAITS^%ZAPM.ed.BSF2
 I $D(@(%NAM_"(%TAB)")) S (cc,c)=$ZR,c1=$P(@$ZR,"@"),%3=$$TIP^%ZAPM.ed.BS($P(@$ZR,"@",17)),%0=$$ESDAY^%ZAPM.ed.BSsFUNR(10,$$h^%ZAPM.ed.BS3()) U %DEV W ";TABLE@"_%NAM_"@"_%TAB_"@"_%0_"@"_%3_"@"_c1,!
 D  F  S c=$ZO(@c) Q:c=""!(c'[($P(cc,")")_","))  D  U 0
 .U %DEV W $P(c,",",$S(c["]"&($P(c,"]")[","):3,1:2),255),$C(1),@c,!
 K c1,%3,%1,%2,c,cc Q
ER U 0 I $ZE["<INRP" S ls=" ПРЕРВАНО..." D O^%ZAPM.ed.BSF7 S $ZT=$G(%zT) G CLO
 I $ZE["<ENDOFFILE" G CLO
 S ls=$ZE,$ZT=$G(%zT) D O^%ZAPM.ed.BSF7
CLO U 0 C:$D(%DEV) %DEV Q
ERR U 0 I $ZE["<SYNT" S ls=" Не корректное имя раздела " D O^%ZAPM.ed.BSF7
 W *7 S $ZT=$G(%zT),ls=$ZE D O^%ZAPM.ed.BSF7 G I
D G 0^%ZAPM.ed.BSTM
ALLT S i="" F  S i=$O(@(BSR_"(BST,i)")) Q:'i  F j=1:1 Q:'$D(@(BSR_"(BST,i,j)"))  X do
 Q
PRI S ls=" Создать для всех клеток БЛОКА уникальные СИМВОЛЬНЫЕ ИМЕНА для хранения ? " D YES^%ZAPM.ed.BSF Q:'YES
 S ls=" Если у вас уже хранится информация в Б.Данных, то она потеряется.Вы уверены ? " D YES^%ZAPM.ed.BSF Q:'YES
 S ls=" Уже созданные ИМЕНА ДЛЯ ХРАНЕНИЯ будем изменять ? " D YES^%ZAPM.ed.BSF S fi=YES
 S li1=$G(@(BSR_"(BST,""XBD"")"),57)+1,^("XBD")=li1,do="I $P(^(j),""@"",9)'=1 S li=$S($P($P(^(j),""@"",18),""#"")'=""""&('fi):$P($P(^(j),""@"",18),""#""),1:i_$C(li1)_j)_""#""_$P($P(^(j),""@"",18),""#"",2),$P(^(j),""@"",18)=li" D BLOK^%ZAPM.ed.BSF1 Q
BLK S li=$P($P(@(BSR_"(BST,ny,nx)"),"@",18),"#",2,3),do="S ix=$P(^(j),""@"",18) S ix=$P(ix,""#"")_""#""_li S $P(^(j),""@"",18)=ix" D BLOK^%ZAPM.ed.BSF1 Q
LON S ls=" ДЛИНА ИМЕНИ БОЛЬШЕ "_ii_" СИМВОЛОВ " D O Q
XBD1 K ^%ZAPM.ed.BSbufB("I"_$G(%BS(3),$P)_$J_"u"_%BS(15)) S ^("I"_$G(%BS(3),$P)_$J_"u"_%BS(15))=1,do="I $P($P(^(j),""@"",18),""#"")'="""" S ^%ZAPM.ed.BSbufB(""I""_$G(%BS(3),$P)_$J_""u""_%BS(15),$P($P(@(BSR_""(BST,i,j)""),""@"",18),""#""))=i_"",""_j",ls="ИДЕНТИФИКАЦИЯ ИМЕН" D WAITS^%ZAPM.ed.BSF2,ALLT Q
XBD I $P(@(BSR_"(BST,ny,nx)"),"@",9)<2 S ls=" КЛЕТКА НЕ ХРАНИТСЯ В БАЗЕ ДАННЫХ " D O^%ZAPM.ed.BSF7 Q
 S ls=" Корректируйте СИМВОЛНОЕ ИМЯ КЛЕТКИ для адресно-независимого хранения (до 9 c.)",li=$P($P(@(BSR_"(BST,ny,nx)"),"@",18),"#"),ll="@#" D LE^%ZAPM.ed.BSTT S ii=9 Q:'YES
 S iii=1 G:li="" OU I $L(li)>ii D LON G XBD
 I li["," S ls=" СИМВОЛ <,> ЗАПРЕЩЕН " D O G XBD
 ;I li=+li S ls=" ИМЯ ДОЛЖНО БЫТЬ СИМВОЛЬНОЕ !!! " D O G XBD
 I '$G(^%ZAPM.ed.BSbufB("I"_$G(%BS(3),$P)_$J_"u"_%BS(15))) D XBD1
 I $D(^%ZAPM.ed.BSbufB("I"_$G(%BS(3),$P)_$J_"u"_%BS(15),li)),(^(li)'=(ny_","_nx)) S ls=" ИМЯ :"_li_" Уже имеет КЛЕТКА {"_^(li)_"} " D O^%ZAPM.ed.BSF7 Q
 S ^%ZAPM.ed.BSbufB("I"_$G(%BS(3),$P)_$J_"u"_%BS(15),li)=ny_","_nx G OU
OUT S ls=" Вводите / Корректируйте ИМЯ КЛЕТКИ для вывода данных ",li=$P($P(@(BSR_"(BST,ny,nx)"),"@",18),"#",2),ll="@#" D LE^%ZAPM.ed.BSTT S iii=2,ii=3 Q:'YES
 I $L(li)>ii D LON G OUT
OU S ix=$P(@(BSR_"(BST,ny,nx)"),"@",18) S $P(ix,"#",iii)=li S $P(@(BSR_"(BST,ny,nx)"),"@",18)=ix Q
SSS S ls="Корректируйте ССЫЛКУ НА КЛЕТКУ ИМЕЮЩУЮ ФОРМУЛУ ВЫЧИСЛЕНИЯ ДЛЯ ДАННЫХ ВЫВОДА",li=$P($P(@(BSR_"(BST,ny,nx)"),"@",18),"#",3) D LE^%ZAPM.ed.BSTT Q:'YES  G:li="" SS
 I li'?.N1",".N!('+li)!('+$P(li,",",2)) S ls=" ОШИБКА ШАБЛОНА ""НОМЕР_СТРОКИ,НОМЕР_КОЛОНКИ"" !!! " D O G SSS
 I '$D(@(BSR_"(BST,"_li_")")) S ls=" НЕТ КЛЕТКИ {"_li_"}" D O G SSS
 I '$D(@(BSR_"(BST,""FCL"","_li_")")) D Yes^%ZAPM.ed.BSXfun("НЕТ ФОРМУЛЫ ВЫЧИСЛ. У КЛЕТКИ {"_li_"} ! ЭТО ТАК НУЖНО ? ЗАПИШЕМ ?",2) I 'YES G SSS
SS S iii=3 G OU
 ;-----------
O D O^%ZAPM.ed.BSF7 Q
LE D A25^%ZAPM.ed.BSF1 W ls D 24^%ZAPM.ed.BSTM,LINE^%ZAPM.ed.BSF1 Q
 ;-----------
REST K %DEV,%FN D DOSREAD I '$D(%FN) K %DEV Q  ;ВОССТАНОВЛЕНИЕ ОПИСАНИЯ ТАБЛИЦ
 ;I $D(%BS("Tmp","DosFiles")) S XN="" F  S XN=$O(%BS("Tmp","DosFiles",XN)) G:XN="" XNE D XNOPN I $D(%FN) D XN
 S %zT=$ZT,$ZT="ER^%ZAPM.ed.BSS1" F  U %DEV R %IN G:$ZC'=0 CLO D RES G:$ZC'=0!($ZE["<ENDOFFILE") CLO
 S $ZT=$G(%zT),ls=" В Файле "_%FN_" Описания Таблиц не найдено " D O G CLO
RES I $E(%IN,1,6)[";TABLE" U 0 D
 .S (S2,S1)="" I $$IFDOS^%ZAPM.ed.BSHTML1(%IN) D INIT^%ZAPM.ed.BSre(1) S %IN=$TR(%IN,S1,S2)
 .S ls=" Восстановим:"_$P(%IN,"@",2)_","_$P(%IN,"@",3)_" ;"_$P(%IN,"@",5)_" ;"_$P(%IN,"@",6),ls=$E(ls,1,79) D YES^%ZAPM.ed.BSF I YES G I
 Q
I S li=$G(%NAM,$P(%IN,"@",2))_","_$P(%IN,"@",3),ls="Корректируйте имя Восстанавливаемой таблицы. <Esc>-Отмена" D LE E  Q
 Q:li=""  S %zT=$ZT,$ZT="ERR^%ZAPM.ed.BSS1",BSt=$P(li,",",$L(li,",")),BSr=$P(li,",",1,$L(li,",")-1) S:BSr'["^" BSr="^"_BSr
 I $D(@(BSr_"(BSt)")) S ls=" Таблица "_BSt_" В Разделе "_BSr_" Уже существует ! Замещаем ? " D YES^%ZAPM.ed.BSF G I:'YES S %NA=%NAM,%NAM=BSr,%TAB=BSt D PASE^%ZAPM.ed.BS1 S %NAM=%NA I '$D(%w(4)) G I
 S TIp="" I $P($G(@(BSr_"(BSt)")),"@",17) S TIp=$P(@$ZR,"@",17) I TIp=3!(TIp=4) S I=BSt F  S I=$O(@(BSr_"(I)")) Q:I=""!($P(I,".")'=BSt)  K @(BSr_"(I)")
 S BSt="@"_BSt K @(BSr_"(BSt)") S BSt=$E(BSt,2,99) K @(BSr_"(BSt)"),%w(4)
 S $ZT=$G(%zT),ls="ВОССТАНОВЛЕНИЕ..."_BSr_","_BSt D WAITS^%ZAPM.ed.BSF2
 F  U %DEV R %IN U 0 Q:$ZC'=0!($E(%IN,1,6)[";TABLE")!(%IN="")  D  S @(BSr_"(BSt"_$S($E(%IN,1)=$C(1):")",1:",")_$P(%IN,$C(1)))=$P(%IN,$C(1),2,999)
 .S %IN=$TR(%IN,S1,S2)
 .I $E(%IN,6)="]" D
 ..I $P(%IN,")")["," S %IN=$P(%IN,",",2,999) Q
 ..S %IN=$P(%IN,")",2,999)
 S @BSr@(BSt,"LST")=$H_","_$G(%BS(12))_",Restory from "_%FN
 D TRANS Q:$ZC'=0  G RES
TRANS U 0 S ls="РЕТРАНСЛЯЦИЯ ",TIp=$P(@(BSr_"(BSt)"),"@",17) K lo D WAITS^%ZAPM.ed.BSF2 S:'TIp TIp=1
 F f="FTR","FCL","COL","RTR" I $D(@(BSr_"(BSt,f)")) S i="" F  S i=$O(@(BSr_"(BSt,f,i)")) Q:i=""  S j="" F  S j=$O(@(BSr_"(BSt,f,i,j)")) Q:j=""  D  I YES S @(BSr_"(BSt,f,i,j)")=li1,^(j,1)=li
 .I ^(j)'["$$TS",$E(^(j),1,2)'=$S(f="COL":"I ",1:"S ") S zT=$ZR,ls=" НАЙДЕНА ОШИБКА ТРАНСЛЯЦИИ:"_$E(^(j),1,30)_"... ИСПРАВИМ ? " D YES^%ZAPM.ed.BSF I YES,$D(@zT) S $E(^(j),1,2)=$S(f="COL":"I ",1:"S ")
 .D  I 'YES S $P(@(BSR_"(BST,i,j)"),"@",$S(f="COL":13,f="FCL":7,f="RTR":16,1:8))="" S lo(f)=$G(lo(f))+1
 ..S li=^(j,1) D SI^%ZAPM.ed.BSN N (%BS,vl,%zT,k0,k1,k2,k3,k4,k5,k6,k7,k8,k9,%KAT,%File,TIp,nx,ny,R1,R2,R3,li,li1,BSB,BSr,BSt,YES,f,ft,se,ke) S BSR=BSr,BST=BSt,TIP=TIp
 ..D ^%ZAPM.ed.BSFT Q
 I $D(lo) S ls=" РЕТРАНСЛЯЦИЯ НЕУДАЧНАЯ; ДЛЯ " D  S ls=ls_"ОШИБОК" D YES^%ZAPM.ed.BSF K lo
 .F f="FTR","RTR","COL","FCL" I $D(lo(f)) S ls=ls_f_":"_lo(f)_"  "
 Q
DosRead(%Dev,%Fn) 
DOSREAD I $D(%DEV)&($D(%FN)) G U:%DEV>50&(%DEV<55),U:$ZV["Cach"||($ZV["IRIS") ;ОТКРЫТЬ ДЛЯ ЧТЕНИЯ
DEV I $ZV["Cach"||($ZV["IRIS") S %DEV=51 G FN
 F %DEV=$G(%Dev,51):1:54 O %DEV::0 Q:$T
 I '$T S %DEV=0 S ls=" Все файловые устpойства ДОС заняты ..." D O G END
FN U 0 S %DEVTYPE="HFS" K %FN S ls=" Введите полный путь к DOS-файлу, Который будем читать (F3-Каталог)",li=$G(%Fn)
 D ChP^%ZAPM.ed.BSF10(1)
 S %KAT="D DOS^%ZAPM.ed.BSDOS",ll="",%HIS="^%ZAPM.ed.BSbufB(""HISFILE"_$S('$E($G(%BS(1)),12):$G(%BS(3),$P)_$G(%BS(12)),$E($G(%BS(1)),12)=1:"1"_$G(%BS(12)),1:"1")_""")" D LE^%ZAPM.ed.BSTT Q:li=""!('YES)  S %FN=li G:"^."[%FN END I $G(%SDEV)="HISTORY" C %DEV Q
 I $ZV["MSM" O %DEV:%FN U %DEV I $ZA=-1 U 0 S ls=" Файл "_%FN_" не существует " D O G FN
U I $ZV["Cach"||($ZV["IRIS") I '$$OpenFile^%ZAPM.ed.BSCF1(%FN,"R") U 0 S ls=" Ошибка откpытия файла "_%FN D O C %DEV G FN
 I $ZV["MSM" O %DEV:(%FN:"R") U %DEV I $ZA<0 U 0 S ls=" Ошибка откpытия файла "_%FN D O C %DEV G FN
END S %3=250 I "^."[%FN S %4="" C %DEV K %DEV,%FN D CL^%ZAPM.ed.BSF4 Q
 U 0 D CL^%ZAPM.ed.BSF4 Q
]]></Routine>


<Routine name="%ZAPM.ed.BSS2" type="MAC" languagemode="0"><![CDATA[
%BSS2 ;СОРТИРОВКА ТАБЛИЦЫ;ТИПОВОЙ СПИСОК ; 15:09   01.07.99
SORT K ^%ZAPM.ed.BSbufB("Sort"_$G(%BS(3),$P)_$J_"u"_%BS(15))
 S Nx=nx,I=$P(B,"@",36),Ns=+$P(I,",",2),Na=$$SORTNA($P(I,",",3)),Ny=+I I $P(I,",",4) S Nx=$$SORTFOR($P(I,",",4))
 S ls="СОРТИРОВКА ПО КОЛОНКЕ "_Nx D WAITS^%ZAPM.ed.BSF2 D:'$D(se) DEND^%ZAPM.ed.BSF2 D:'$D(ke) REND^%ZAPM.ed.BSF2
 S Na=$S(Na:1,1:-1)
 F i=Ny:Ns:se I $D(@BSR@(BST,i,+Nx)) S I=$$SORTDATA^%ZAPM.ed.BSS() D  X WA
 .I I="" S I=" "
S .I '$D(^%ZAPM.ed.BSbufB("Sort"_$G(%BS(3),$P)_$J_"u"_%BS(15),I)) D  Q
 ..F j=1:1:ke S ^%ZAPM.ed.BSbufB("Sort"_$G(%BS(3),$P)_$J_"u"_%BS(15),I,j)=@(BSR_"(BST,i,j)")
 .I I'=+I S I=I_" " G S
 .S I=I+.0000000001 G S
 I '$D(^%ZAPM.ed.BSbufB("Sort"_$G(%BS(3),$P)_$J_"u"_%BS(15))) S ls=" СОРТИРОВКА НЕ УДАЛАСЬ " D O^%ZAPM.ed.BSF7,K G D
 S I="",kj=0 F i=Ny:Ns:se X WA D  F j=1:1:ke S @(BSR_"(BST,i,j)")=^%ZAPM.ed.BSbufB("Sort"_$G(%BS(3),$P)_$J_"u"_%BS(15),I,j)
 .S I=$O(^%ZAPM.ed.BSbufB("Sort"_$G(%BS(3),$P)_$J_"u"_%BS(15),I),Na)
 D K,TAB^%ZAPM.ed.BSF1,TIT^%ZAPM.ed.BST,W^%ZAPM.ed.BST G B^%ZAPM.ed.BSTM
K K ny,Nx,Ns,I,kj,^%ZAPM.ed.BSbufB("Sort"_$G(%BS(3),$P)_$J_"u"_%BS(15)),Na Q
SORTNA(Na) Q $S(Na:-1,1:1)
SORTFOR(N) N NN,NNN S N=$TR(N,"!",","),NNN="" I N'["," Q +N
 F NN=1:1 Q:'$P(N,",",NN)  S NNN=NNN_$P(N,",",NN)_$S($P(N,",",NN+1):",",1:"")
 Q NNN
D G 0^%ZAPM.ed.BSTM
TIS ;ТИПОВОЙ СПИСОК\СВОДКА
 N F,Ks,KKs,ii,i,j,BSr1,BSt1,BSr2,BSt2,CO,TI
 S TI=%B,ls=" ВЫ ХОТИТЕ СДЕЛАТЬ "_$S(%B=1:"СПИСОК",1:"СВОДКУ")_" НА ОСНОВЕ ТАБЛИЦЫ-БАЗЫ ДАННЫХ ? "
 I '$D(BSPART) D YES^%ZAPM.ed.BSF Q:'YES  S li="" D RIT^%ZAPM.ed.BSF3 Q:'YES  Q:'$D(BSr)  Q:'$D(BSt)  I $P(@(BSr_"(BSt)"),"@",17)'=2 S ls=" ЭТО НЕ БАЗА ДАННЫХ " D O^%ZAPM.ed.BSF7 Q
 S BSr1=BSr,BSt1=BSt,BSr2=%NAM,BSt2=TAB D COPY^%ZAPM.ed.BSTK
 S $P(@(BSr2_"(BSt2)"),"@",17)=1 K @(BSr2_"(BSt2,""KEY"")"),Ks S (j,i)=""
 D Wait^%ZAPM.ed.BSXfun("Создаю")
 F  S i=$O(@BSr2@(BSt2,i)) Q:'i  X $G(WA) F  S j=$O(@BSr2@(BSt2,i,j)) Q:'j  I $D(@BSr2@(BSt2,i,j)) D
 .S ii=@$ZR
 .I $P(ii,"@",9)'=1 S:'$D(Ks) Ks=i S:'$D(CO) CO=j S $P(@BSr2@(BSt2,i,j),"@",9)=1 D
 ..I TI=1 S F="$$TSPL(""{"_i_","_j_"}"","""","""","""",""1"")" D SETF(i,j,F)
 ..I TI'=1 S F="$$TSVL(""{"_i_","_j_"}"","""","""",1,2,1)" D SETF(i-1,j,F)
 ..S $P(@BSr2@(BSt2,i,j),"@",15)=""
 .S KKs=i
 I '$D(Ks) S ls=" НЕ НАШЛА КЛЕТКИ ХРАНИМЫЕ В БАЗЕ !!! " D O^%ZAPM.ed.BSF7 Q
 I TI=1 S F="$$TSP("""_$$TSE(BSr1)_","_BSt1_""","_Ks_",""1:1:"_(Ks-1)_""","""_(Ks+1)_":1:"_KKs_""")"  ;ОСНОВНАЯ ФУНКЦИЯ СПИСКА
 I TI'=1 S F="$$TSV("""_$$TSE(BSr1)_","_BSt1_""","_(Ks-1)_","_(CO-2)_","""","""")"  ;ОСНОВНАЯ ФУНКЦИЯ СВОДКИ
 D SETF(2,1,F)
 I '$D(BSPART) I TI'=1 S F=$P($G(^["GLAVK"]MZAPROS("zzz",1),"$$TSVD(""^MZAPROS1@^MZAPROS2"",/"),"/")_(Ks+1)_","_KKs_$P($G(^["GLAVK"]MZAPROS("zzz",1),"/)"),"/",2) D SETF(Ks,CO-2,F)
 I $D(BSPART) I TI'=1 S F=$P($G(^["FON"]AsI("MZAPROS",1),"$$TSVD(""^MZAPROS1@^MZAPROS2"",/"),"/")_(Ks-1)_","_(Ks-1)_$P($G(^["FON"]AsI("MZAPROS",3),"/)"),"/",2) D SETF(Ks,CO-2,F)
 Q
TSE(B) N A,I S A="" F I=1:1:$L(B) S A=A_$E(B,I) I $E(B,I)=$C(34) S A=A_$E(B,I)
 Q A
SETF(i,j,F) S $P(@BSr2@(BSt2,i,j),"@",7)=2,@(BSr2_"(BSt2,""FCL"",i,j)")=F,^(j,1)=F
 Q
E133 S ls=" УДАЛИТЬ ИЗ ТАБЛИЦЫ БЛОЧНОЕ МЕНЮ ,ВЫЗЫВАЕМОЕ ПО <ALT-F2> ? " D YES^%ZAPM.ed.BSF I YES K @(BSR_"(BST,""AF2"")")
 G D
E134 S ls=" УДАЛИТЬ ИЗ ТАБЛИЦЫ КЛЮЧИ !!! САМИ ПОЗАБОТЬТЕСЬ О БАЗЕ ДАННЫХ !. УДАЛЯЕМ ? " D YES^%ZAPM.ed.BSF I YES K @(BSR_"(BST,""KEY"")") D R^%ZAPM.ed.BSF4(17,1)
 G D
E1351 ;УДАЛЕНИЕ
E1352 ;ФОРМУЛ
E1353 ;
E1354 D CH G D:'YES S ff=$S(LAB["1^":"FCL",LAB["2^":"FTR",LAB["3^":"RTR",1:"COL"),pi=$S(ff="FCL":7,ff="FTR":8,ff="RTR":16,1:13)
 S do="I $P(^(j),""@"",pi)'="""" S $P(^(j),""@"",pi)="""" K @(BSR_""(BST,ff,i,j)"")"
 I '$D(%DIA) D ALLT^%ZAPM.ed.BSS1 I ff="FCL",TIP=2!(TIP=3) D R^%ZAPM.ed.BSF4(17,1) S TIP=1
 D:$D(%DIA) BLOK^%ZAPM.ed.BSF1
 G D
CH I '$D(%DIA) S ls=" УДАЛЯЕМ ФОРМУЛЫ ИЗ ВСЕЙ ТАБЛИЦЫ ? " D YES^%ZAPM.ed.BSF
 E  S ls=" УДАЛЯЕМ ФОРМУЛЫ ПОМЕЧЕННЫЕ В БЛОКЕ ? " D YES^%ZAPM.ed.BSF
e Q
]]></Routine>


<Routine name="%ZAPM.ed.BSSP" type="MAC" languagemode="0"><![CDATA[
%BSSP ;НАСЧЕТ СПИСКОВ ; 13:15   17.01.2002
 G 0
CYC1 X "S L(1,iii)="_%1 I $G(%3)'="" X "S L(2,iii)="_%3
 Q
CYC2 X "S L(1,iii)="_%1 I %2'="" X "S L(2,iii)="_%2
 I %3'="" X "S L(3,iii)="_%3
 Q
CYC3 S ib=$P($P(%1,"("_$C(34),2),","),ie=$P($P(%3,"("_$C(34),2),","),jb=$P($P(%1,",",2),$C(34)_")"),je=$P($P(%3,",",2),$C(34)_")"),LIC(iii)="",ii=0 I $D(@zr)
 F s=ib:%2:ie F k=jb:%2:je I 1 X:"1"'[%4 "I "_$TR($TR(%4,$C(221,222,223,224),s),$C(231,232,233,234),k) S %TEST=$T D
 .I %TEST S ii=ii+1,L(ii,iii)=$G(^(s_","_k)) Q
 .I '%TEST S ii=ii+1,ER(ii)=""
 Q
CYC4 X %1 S L(1,iii)=$G(%0) Q
CYCL I $D(@CurNam@(@("k"_keys),"3,3"))
 X SP(6,2) ;ДО
 S zr=$ZR I $D(SP(2)) S iii="" F  S iii=$O(SP(2,iii)) Q:iii=""  X SP(2,iii) X "I "_%1 E  G CYCE
 I '$D(CALCFON) W /CUP(23,1),/EL(0),zr
 I $D(@zr)
 K L,ER,LIC S iii="" F  S iii=$O(SP(4,iii)) Q:iii=""  X SP(4,iii) ;ТЕЛО ЦИКЛА
 S ii="" F  S ii=$O(ER(ii)) Q:ii=""  K:ii'=1 L(ii)
 I $D(ER(1)),$O(L(1))="" K L
 I $D(ER(1)),$O(L(1))'="",$D(LIC) S i1=$O(L(1)) S ii="" D  K L(i1)
 .F  S ii=$O(LIC(ii)) Q:ii=""  S L(1,ii)=$G(L(i1,ii))
 I $D(LIC) S ii="" F  S ii=$O(L(ii)) Q:ii=""  D
 .K iiii S iii="" F  S iii=$O(L(ii,iii)) Q:iii=""  I $G(L(ii,iii))'="" S iiii=1 Q
 .I '$D(iiii) K L(ii)
 K R,LIC S ii="" F  S ii=$O(L(ii)) Q:ii=""  S ny=ny+1,@BSr@(BSt,ny)=Pi,Yl=Yl+$P(O(1,1),"@",3) F iii=1:1:ke S @(BSr_"(BSt,ny,iii)")=O(1,iii) I $D(L(ii,iii)) S $P(@$ZR,"@",15)=L(ii,iii) 
 I $D(L),sii X "F si="_sii_" D COP" ;РАЗГРАНИЧИТЕЛЬ ТЕЛА ЦИКЛА
 X SP(6,3) ;ПОСЛЕ
CYCE Q
PI I +SP(6,1) S fo=1 X "F si="_SP(6,1)_" D COP" S Pi=Pi+1 ;ПРОМ.ИТОГ
 S fo=0 Q
0 I $E(%BS(1),13) D Yes^%ZAPM.ed.BSZPS Q:YES<1
BEGIN I '$D(x) S x=$NA(^%ZAPM.ed.BSbufB("KCH"_$G(%BS(3),$P)_$J_"u"_%BS(15)))
 I $D(CALCFON) S $P(@x,"#",2)=1,YES=0,x=$$%^%ZAPM.ed.BSF12($ZR) L -@x D  H 3 Q:YES
 .I CALCFON=2,$P($ZV,"Version ",2)="4.0.11" D ErrMsg^%ZAPM.ed.BSXfun("Удаленный процесс в "_$ZV_" ЗАПУСТИТЬ НЕЛЬЗЯ !") S YES=1
 .I CALCFON=2,$P($ZV,"Version ",2)'="4.0.11" S UUU=$P($P(UU,"[",2),"]") X "J J^%ZAPM.ed.BSSP(x,$G(ObR))["_UUU_"]::1" I  D:'$D(PACKET) OkMsg^%ZAPM.ed.BSXfun("Фоновый процесс в СИСТЕМЕ ["_UUU_"] ЗАПУЩЕН") S YES=1
 .I CALCFON=1 J J^%ZAPM.ed.BSSP(x,$G(ObR))::1 I  D:'$D(PACKET) OkMsg^%ZAPM.ed.BSXfun("Фоновый процесс ЗАПУЩЕН") S YES=1
 S $P(@x,"#",2)="" I $D(CALCFON) D:'$D(PACKET) ErrMsg^%ZAPM.ed.BSXfun("Не могу запустить фоновый процесс")
 D J(x,$G(ObR)) Q
J(x,ObR) S Total=$P($$h^%ZAPM.ed.BS3(),",",2) S:$G(%BS(15))<1 %BS(15)=0 L +@x K PaGe,zr,CH,SP,CALCFON
 S %zT=$ZT,$ZT="ER^%ZAPM.ed.BSSP" D SI^%ZAPM.ed.BSN
 S i=$P(@x,"#"),BST=$P(i,",",$L(i,",")),BSR=$P(i,",",1,$L(i,",")-1)
 S ZPR=$P(@$ZR,"#",4),ZPT=$P(@$ZR,"#",5) S:$P(@$ZR,"#",2) CALCFON=1,WA="" S %0=$$ESDAY^%ZAPM.ed.BSsFUNR(8,$$h^%ZAPM.ed.BS3()) D KCHO^%ZAPM.ed.BSsFUNM
 S BSr=$S(ZPR'="":ZPR,1:$$cB^%ZAPM.ed.BSSV),(iii,i)=$$TNAME^%ZAPM.ed.BSF13(BSR,BST),ii="",TIP=3,%Co=2,%Do=0,ls="ИДЕТ ГЕНЕРАЦИЯ СПИСКА" D:'$D(CALCFON) WAITS^%ZAPM.ed.BSF2 S WA=""
 I ZPR="" S ii=0 F  S i=$O(@(BSr_"(i)")) Q:i'[(iii_".")  D  S:ii<$P(i,".",2) ii=$P(i,".",2)
 S ii=ii+1,ZR="I $D(@zr)",BSt=$S(ZPT'="":ZPT,1:iii_"."_ii)
 L -@x,+@BSr@(BSt) ;ЛОКИРОВКА
 I $$VAR^%ZAPM.ed.BSH ;ПЕРЕМЕННЫЕ
 N Desc
 S @(BSr_"(BSt)")=@(BSR_"(BST)"),Desc=$P(@$ZR,"@"),$P(@$ZR,"@")=" "_%0_" ;СЧЕТ",$P(@$ZR,"@",17)=1,$P(@$ZR,"@",30)="" F i=2,4,5 S $P(@$ZR,"@",i)=""
 I $G(ObR)'="" S @ObR@("TT")=$ZR
 S I="",Yl=0,Pi=1 F  S I=$O(@x@(I)) Q:I=""  S II="" F  S II=$O(@x@(I,II)) Q:II=""  F III=1,2,3,4 I $D(@x@(I,II,III)) S CH(I,II,III)=$$Variabl(^(III))
 K SAY,@x L -@x S SAY=""
 S C=1 I $D(CH(1,0)) S SAY=$S(CH(1,0,4)'["NONE#":$P(CH(1,0,4),"#")_$$s(CH(1,0,1),0),1:"")
 F II=1:1:9 D:$D(CH(1,II))
 .I $G(CH(1,II,4),"NONE#")["TXTC#" S SAY=SAY_" "_$P(CH(1,II,4),"#",2) Q
 .I $G(CH(1,II,4),"NONE#")'["NONE#" D
 ..S SAY=SAY_" "_$P(CH(1,II,4),"#")_" "_$$s(CH(1,II,1),II)
 ..S SAY=SAY_" "_$P(CH(1,II,4),"#",2)_" "_$$s(CH(1,II,2),II)
 S BSD=@(BSR_"(BST,""TSP"",1)") I $D(^(2,1)) F i=1:1 Q:'$D(^(i))  S SP(2,i)=^(i)
 I '$D(@BSD) S ls=" БАЗЫ ДАННЫХ НЕТ !!! "_BSD G NO
 S SP(3,2)=@(BSR_"(BST,""TSP"",3,2)"),SP(3,3)=^(3),SP(3,4)=^(4),SP(3,5)=^(5),i=""
 I $D(@(BSR_"(BST,""TSP"",4)")) S SP(4)=$$GLRET^%ZAPM.ed.BSF12($ZR) F  S i=$O(@(BSR_"(BST,""TSP"",4,i)")) Q:i=""  I i S SP(4,i)=^(i)
 I $D(@(BSR_"(BST,""TSP"",7)")) S SP(7)=@$ZR
 S ny=0 K ke,k0,k1,k2,k3,k4,k5,O,fCL,fCOL I $D(@(BSR_"(BST,""TSP"",0)")) D SAY(@$ZR) S %Co=%Co+1 ;ЗАГОЛОВОК
 D SAY(SAY) ;СТРОКА ПЕРИОДА
 S (SP(6,2),SP(6,3))="" I $D(@(BSR_"(BST,""TSP"",6,1)")) S SP(6,1)=^(1) S:'^(2) SP(6,2)="X ""I $D(@zr)"" X ""I "_^(3)_""" I  D PI" S:^(2) SP(6,3)="X ""I $D(@zr)"" X ""I "_^(3)_""" I  D PI" I +^(4) S SP(6,4)=1
 I $D(@BSR@(BST,"ExcelOut")) S @BSr@(BSt,"ExcelOut")=@$ZR
 S $P(@BSr@(BSt,"ExcelOut"),",",3)=ny+1
 I +SP(3,3) S fo=1 X "F si="_SP(3,3)_" D COP" S ke=kj-1 ;ШАПКА
 D:'$D(ke) REND^%ZAPM.ed.BSF2 S CH="",CH=$O(CH(1,CH)) I CH="" S ls=" НЕОПРЕДЕЛЕНЫ КЛЮЧИ " G NO
 S si=+SP(3,2) I 'si S ls=" НЕ ОПРЕДЕЛЕНО ТЕЛО ЦИКЛА СПИСКА " G NO
 I $P(@(BSR_"(BST)"),"@",19) S $P(@(BSr_"(BSt)"),"@",19)=($P($P(@$ZR,"@",19),",")+%Co)_","_$P($P(@$ZR,"@",19),",",2)
 I $P(@(BSR_"(BST)"),"@",50) S $P(@(BSr_"(BSt)"),"@",50)=($P($P(@$ZR,"@",50),",")+%Co)_","_$P($P(@$ZR,"@",50),",",2)
 I $D(@(BSR_"(BST,""PRN"")")) S @(BSr_"(BSt,""PRN"")")=@$ZR
 I $D(@(BSR_"(BST,""RSM"")")) S @(BSr_"(BSt,""RSM"")")=@$ZR
 I $D(@(BSR_"(BST,""SVM"")")) S @(BSr_"(BSt,""SVM"")")=@$ZR
 I $D(@BSR@(BST,"Var")) D Copy^%ZAPM.ed.BSF8($NA(@$ZR),$NA(@BSr@(BSt,"Var")))
 S @BSr@(BSt,"REM")=$P(@BSR@(BST),"@")
 I $D(@(BSR_"(BST,""SHR"")")) S @(BSr_"(BSt,""SHR"")")=@$ZR
 I $D(@(BSR_"(BST,""HFS"")")) S @(BSr_"(BSt,""HFS"")")=$G(@$ZR)
 I $D(@(BSR_"(BST,""AF2"")")) S @(BSr_"(BSt,""AF2"")")=BSR_","_BST
 S @BSr@(BSt,"LST")=$H_","_$G(%BS(12))_",Greated"
 S @(BSr_"(BSt,""sp"")")="S"
 S fo=1 D COP S nyR=ny F kj=1:1:ke S $P(@(BSr_"(BSt,ny,kj)"),"@",3)=0,$P(@$ZR,"@",18)="" I $G(@(BSr_"(BSt,""FCL"",ny,kj)"))["$$TSP" K @$ZR S $P(@(BSr_"(BSt,ny,kj)"),"@",7)=""
 S AFO=@BSR@(BST),AFOO=""
 I $D(@(BSR_"(BST,si,1)")) F kj=1:1 Q:'$D(@(BSR_"(BST,si,kj)"))  S O(1,kj)=@$ZR,$P(O(1,kj),"@",7)="" D
 .I $D(@(BSR_"(BST,""FCL"",si,kj)")),@$ZR["$$TSPN" S $P(O(1,kj),"@",7)=3
 .I $P(AFO,"@",47),$D(@(BSR_"(BST,""FCL"",si,kj)")),@$ZR["$$TSP" S AFOO=AFOO_kj_"," ;А-ФОРМАТ
 .I $D(@(BSR_"(BST,""FTR"",si,kj)")) S $P(O(1,kj),"@",8)=nyR_","_kj
 .I $D(@(BSR_"(BST,""FCL"",si,kj)")),@$ZR'["$$TSP" S $P(O(1,kj),"@",7)=nyR_","_kj,fCL=1
 .I $D(@(BSR_"(BST,""COL"",si,kj)")) S $P(O(1,kj),"@",13)=nyR_","_kj,fCOL=1
 .I $D(@(BSR_"(BST,""RTR"",si,kj)")) S $P(O(1,kj),"@",16)=nyR_","_kj
 S:$G(fCL) $P(@(BSr_"(BSt)"),"@",32)=1 K fCL
 N nam,ks1,X1,X2,X3,X4,X5,X6,X7,X8,X9,ks2,ks3,ks4,ks5,ks6,ks7,ks8,ks9,CurNam
 S (nam,%NAm)=BSD,Ke=kj-1 I CH=0 S (nam,%NAm,BSD)=BSD_CH(1,CH,1),CH=CH+1,k0=CH(1,CH,1)
 I '$$GETDDP^%ZAPM.ed.BSF12(%NAm) G CEND
 S:$G(fCOL) $P(@(BSr_"(BSt)"),"@",33)=1 K fCOL
 S %NAm=%NAm_"(" F key=1:1:10 Q:'$D(CH(1,key))
 S keys=key-1,C=1,fo=0,sii=$S(SP(3,2)'=+SP(3,2):$P(SP(3,2),",",2,99),1:0)
 F i=1:1:9 S @("X"_i)="I 1 " I $D(CH(C,i,3)) S @("X"_i)=@("X"_i)_" "_CH(C,i,3)
 D
L1 .S k1=$$OTDO^%ZAPM.ed.BSSV($NA(@nam),1) F  S k1=$O(@nam@(k1)) Q:k1=""!(k1=ks1)  X X1 I  D
L2 ..D:'$D(CH(C,2)) CYCL I $D(CH(C,2,1)) S k2=$$OTDO^%ZAPM.ed.BSSV($NA(@nam@(k1)),2) F  S k2=$O(@nam@(k1,k2)) Q:k2=""!(k2=ks2)  X X2 I  D
L3 ...D:'$D(CH(C,3)) CYCL I $D(CH(C,3,1)) S k3=$$OTDO^%ZAPM.ed.BSSV($NA(@nam@(k1,k2)),3) F  S k3=$O(@nam@(k1,k2,k3)) Q:k3=""!(k3=ks3)  X X3 I  D
L4 ....D:'$D(CH(C,4)) CYCL I $D(CH(C,4,1)) S k4=$$OTDO^%ZAPM.ed.BSSV($NA(@nam@(k1,k2,k3)),4) F  S k4=$O(@nam@(k1,k2,k3,k4)) Q:k4=""!(k4=ks4)  X X4 I  D
L5 .....D:'$D(CH(C,5)) CYCL I $D(CH(C,5,1)) S k5=$$OTDO^%ZAPM.ed.BSSV($NA(@nam@(k1,k2,k3,k4)),5) F  S k5=$O(@nam@(k1,k2,k3,k4,k5)) Q:k5=""!(k5=ks5)  X X5 I  D
L6 ......D:'$D(CH(C,6)) CYCL I $D(CH(C,6,1)) S k6=$$OTDO^%ZAPM.ed.BSSV($NA(@nam@(k1,k2,k3,k4,k5)),6) F  S k6=$O(@nam@(k1,k2,k3,k4,k5,k6)) Q:k6=""!(k6=ks6)  X X6 I  D
L7 .......D:'$D(CH(C,7)) CYCL I $D(CH(C,7,1)) S k7=$$OTDO^%ZAPM.ed.BSSV($NA(@nam@(k1,k2,k3,k4,k5,k6)),7) F  S k7=$O(@nam@(k1,k2,k3,k4,k5,k6,k7)) Q:k7=""!(k7=ks7)  X X7 I  D
L8 ........D:'$D(CH(C,8)) CYCL I $D(CH(C,8,1)) S k8=$$OTDO^%ZAPM.ed.BSSV($NA(@nam@(k1,k2,k3,k4,k5,k6,k7)),8) F  S k8=$O(@nam@(k1,k2,k3,k4,k5,k6,k7,k8)) Q:k8=""!(k8=ks8)  X X8 I  D
L9 .........D:'$D(CH(C,9)) CYCL I $D(CH(C,9,1)) S k9=$$OTDO^%ZAPM.ed.BSSV($NA(@nam@(k1,k2,k3,k4,k5,k6,k7,k8)),9) F  S k9=$O(@nam@(k1,k2,k3,k4,k5,k6,k7,k8,k9)) Q:k9=""!(k9=ks9)  X X9 I  D
CEND I '$D(CALCFON) W /CUP(23,1),/EL(0)
 M @BSr@(BSt,"PERIODS")=CH //СОХРАНИТЬ ВЫБОРКУ
 K Mx S se=ny,Mr="",ls="ФОРМАТИРОВАНИЕ ВЫСОТЫ СТРОК" D:'$D(CALCFON) WAITS^%ZAPM.ed.BSF2 F i=2:1:se X WA I $G(@(BSr_"(BSt,i)"))=1 S Mx=$P(@$ZR@(1),"@",3) G:'SP(4) CEN X "F j="_SP(4)_" D XBOCT" D
 .S:Mx>21 Mx=20,Mr=1 I Mx>1 F j=1:1:ke S $P(@(BSr_"(BSt,i,j)"),"@",3)=Mx I Mr S $P(@(BSr_"(BSt,i,j)"),"@",12)=1
 G:$D(Mx) CEN F i=2:1:se K @(BSr_"(BSt,i)")
 S ny=1,$P(@(BSr_"(BSt)"),"@")=$P($P(@(BSr_"(BSt)"),"@"),";")_";ПУСТО" G CE
CEN I +SP(3,5) S ls="ОБРАБОТКА ФУНКЦИИ $$TSPN" D:'$D(CALCFON) WAITS^%ZAPM.ed.BSF2 S jj=0,j=+SP(3,5) F i=1:1:se X WA I $P($G(@(BSr_"(BSt,i,j)")),"@",7)=3 S jj=jj+1,$P(@$ZR,"@",15)=jj
 D:+$G(SP(6,4)) PI I +SP(3,4) S fo=1 X "F si="_SP(3,4)_" D COP" ;ИТОГ
CE I $G(AFOO) D GLSET^%ZAPM.ed.BSF12($NA(@BSr@(BSt,"AFO")),AFOO)
 K %TEST,BB,AFO,AFOO,SpStr,Pi,PaGe,si,sii,uci,r4,nyR,I,%1,%0,%2,%3,%4,%5,key,keys,CH,X1,X2,X3,X4,Mx,X5,O,L,SP,fo,%NAm,kj,f,ER,LIC,iiii D KCHO^%ZAPM.ed.BSsFUNM
 S $P(@BSr@(BSt),"@",24)="S"
 S BST=BSt,BSR=$$%^%ZAPM.ed.BSF12(BSr),ke=Ke
 I $P(@(BSR_"(BST)"),"@")'["ПУСТО",$P(@BSR@(BST),"@",36) K se S B=@$ZR,nx=$P($P(B,"@",36),",",2),IntSort=1,IntSortS=1 D CALC^%ZAPM.ed.BSF3,^%ZAPM.ed.BSS K IntSort,IntSortS
 D TAB^%ZAPM.ed.BSF1 S $ZT=$G(%zT) D  Q:$D(CALCFON)  D:'$D(PACKET) SPIS^%ZAPM.ed.BSF10 S CALCFONs=1 Q
 .I $G(ObR)'="" S @ObR@("TZ")=($P($$h^%ZAPM.ed.BS3(),",",2)-Total\60)_" мин"
 .I $P(@(BSr_"(BSt)"),"@")'["ПУСТО" S $P(@$ZR,"@")=$P($P(@(BSr_"(BSt)"),"@"),";")_";ГОТОВ "_" за "_($P($$h^%ZAPM.ed.BS3(),",",2)-Total)_" сек"_"|"_$G(Desc)
 .S $P(@$ZR,"@",30)=""
 .D TPr^%ZAPM.ed.BSF8($ZR)
 .S @BSr@(BSt,"PERDATE")=$$ESDAY^%ZAPM.ed.BSsFUNR(7,$$h^%ZAPM.ed.BS3())
 .S @BSr@(BSt,"PERUSER")=$G(%BS(12))
 .S @BSr@(BSt,"PER",1)=$G(SAY)
 .L -@BSr@(BSt)
COP ;КОПИРОВАНИЕ
 Q:'$D(@(BSR_"(BST,si,1)"))  S ny=ny+1,Yl=Yl+$P(@$ZR,"@",3) X WA
 F kj=1:1 Q:'$D(@(BSR_"(BST,si,kj)"))  S @(BSr_"(BSt,ny,kj)")=@$ZR I fo F f="FCL","COL","FTR","RTR" I $D(@(BSR_"(BST,f,si,kj)")) S @(BSr_"(BSt,f,ny,kj)")=@$ZR I f="COL" D
 .I $D(@(BSR_"(BST,f,si,kj,1)")) S @(BSr_"(BSt,f,ny,kj,1)")=@$ZR
 .I $D(@(BSR_"(BST,f,si,kj,2)")) S @(BSr_"(BSt,f,ny,kj,2)")=@$ZR
 Q
XBOCT Q:'$L($P($G(@(BSr_"(BSt,i,j)")),"@",15))  S jj=@$ZR I $D(SP(7)),$P(jj,"@",8)'="",(","_SP(7)_",")[(","_j_",") D TRANS^%ZAPM.ed.BST(BSr,BSt,jj,i,j) S $P(jj,"@",15)=d1
 I ($L($P(jj,"@",15))\$P(jj,"@",4)+$S($L($P(jj,"@",15))#$P(jj,"@",4):1,1:0))>Mx S Mx=$L($P(jj,"@",15))\$P(jj,"@",4)+$S($L($P(jj,"@",15))#$P(jj,"@",4):1,1:0)
e Q
SAY(SAY) S fo=0 I +SP(3,2) X "F si="_+SP(3,2)_" D COP" F j=1:1:kj-1 I $D(@(BSr_"(BSt,ny,j)")) S $P(@$ZR,"@",15)="",$P(@$ZR,"@",7)="",$P(@$ZR,"@",8)="",$P(@$ZR,"@",13)="",$P(@$ZR,"@",18)="",$P(@$ZR,"@",16)="",$P(@$ZR,"@",3)=1,$P(@$ZR,"@",6)=""
 S i=1 F j=1:1 Q:'$D(^(j))  S $P(^(j),"@",15)=$E(SAY,i,i+$P(^(j),"@",4)-1),i=$P(^(j),"@",4)+i
 Q
NO D  Q:$D(CALCFON)!($D(PACKET))  S $ZT=$G(%zT) D O^%ZAPM.ed.BSF7 S YES=0 Q
 .I $G(ObR)'="" S @ObR@("TT")="!!! "_ls
 .S $P(@(BSr_"(BSt)"),"@")="!!! "_ls,$P(@$ZR,"@",30)="" L -@BSr@(BSt)
END Q
s(d,K) ;ТРАНСФОРМАЦИЯ ТЕКСТА ВЫБОРКИ
 S %zT=$ZT,$ZT="ERTR^%ZAPM.ed.BSSP"
 S d1=d,d0=+d
 I $D(@BSR@(BST,"Key",K)) D
 .I $D(@BSR@(BST,"Key",K,3)) X @$ZR
 I "0§"[d1 Q ""
 Q d1
ERTR D ErrMsg^%ZAPM.ed.BSXfun($ZE_" "_$$ErrSay^%ZAPM.ed.BSF8($ZE)) S $ZT=$G(%zT) Q $ZE
ER I $ZE["<INRPT" S ls=" ПРЕРВАНО ОПЕРАТОРОМ..." G NO
   I $ZE["<DKFUL" S ls=" ДИСК ПЕРЕПОЛНИЛСЯ" G NO
   I $ZE["<CMND"!($ZE["<SYNTX")!($ZE["<UNDEF") S ls=" ОШИБКА В ФОРМУЛАХ !",CALCFON=1 D NO Q:$D(CALCFON)!($D(PACKET))  D ERCMD^%ZAPM.ed.BSF11 Q
ER1 S ls=$ZE_" "_$$ErrSay^%ZAPM.ed.BSF8($ZE) G NO
Variabl(FL) Q:FL'["vl(" FL ;ЗАМЕНА ПЕРЕМЕННЫХ ДАННЫМИ В ТЕКСТАХ ВЫБОРКИ
 N i,ii,iii,vi
 S iii=FL,%zT=$ZT,$ZT="ERvl^%ZAPM.ed.BSSP"
 F i=2:1 Q:$P(FL,"vl(",i,i+1)=""  S ii=$P($P(FL,"vl(",i),")") X "S vi=vl("_ii_")" S iii=$$TR^%ZAPM.ed.BSsFUNM(iii,"vl("_ii_")",vi)
 Q iii
ERvl I $ZE["UNDEF>" D ErrMsg^%ZAPM.ed.BSXfun(" НЕ ОПРЕДЕЛЕНА ПЕРЕМЕННАЯ vl("_ii_")")
 D ErrMsg^%ZAPM.ed.BSXfun($ZE_" "_$$ErrSay^%ZAPM.ed.BSF8($ZE)) S $ZT=$G(%zT) Q $ZE
]]></Routine>


<Routine name="%ZAPM.ed.BSSR" type="MAC" languagemode="0"><![CDATA[
%BSSR ;ПОДЖАТИЕ ТАБЛИЦЫ, КАЛЬКУЛЯТОР  (А.Тимофеев) ; 16:52   15.09.99
 G D
D G 0^%ZAPM.ed.BSTM ;
SVO() N I,II
 I $G(@BSR@(BST,"PER")) Q @$ZR ;КОЛИЧЕСТВО ПЕРИОДОВ У СВОДКИ
 F I=ny:1:ny+9 I $G(@BSR@(BST,I)),(+$G(II)<+@$ZR) S II=@$ZR
 Q $G(II)
PRESSCFG ;КОНФИГУРИРОВАТЬ ОПЦИИ
 S li=$P(@BSR@(BST),"@",51) I li="" S li="1,1\"_ny_","_nx_"\1"
CFGAGAIN S li=$$LineEdit^%ZAPM.ed.BSXfun(li,"ВВЕДИТЕ ПАРАМЕТРЫ ПОДЖАТИЯ В ФОРМАТЕ: RY,RX\TY,TX\S   (F1-ПОМОЩЬ)","","","^%ZAPM.ed.BSHLP(""PRESS"")") Q:YES<1  I li'="",li'?1N.N1","1N.N1"\"1N.N1","1N.N1"\"1N D ErrMsg^%ZAPM.ed.BSXfun("ОШИБКА ФОРМАТА ! СМОТРИ F1") G CFGAGAIN
 D R^%ZAPM.ed.BSF4(51,li)
 Q
APRESS(G) ;АВТОПОДЖАТИЕ СВОДОК
 ;ЕСЛИ НАДО СДЕЛАТЬ НА АВТОМАТЕ ДЛЯ ПАКЕТОВ
 Q
PRESAUTO(R) ;АВТОПОДЖАТИЕ
 I $P(@(BSR_"(BST)"),"@",24) Q  ;УЖЕ ПОДЖАТА
 N is,js,RX,RY,O,Titul,MOD,%DIA,se,ke
 S MOD=$P(R,"\",3) D GR,AUTO
 S $P(@(BSR_"(BST)"),"@",24)=1,B=@$ZR
 D TAB^%ZAPM.ed.BSF1,TIT^%ZAPM.ed.BST Q
PRESS ;ПОДЖАТИЕ
 N is,js,RX,RY,O,Titul,MOD S MOD=%B I $P(B,"@",51) S R=$P(B,"@",51),$P(R,"\",3)=MOD G AUT
 I '$P(B,"@",19)&('$P(B,"@",50)) D Yes^%ZAPM.ed.BSXfun("ТИТУЛ НЕ УСТАНОВЛЕН !!! ПРОДОЛЖИМ ПОДЖАТИЕ ?",2) Q:YES<1
 S R=+$$SVO_",1\"_$S($P(B,"@",19):$P(B,"@",19),$P(B,"@",50):$P(B,"@",50),1:ny_","_nx)
AUT S R=$$LineEdit^%ZAPM.ed.BSXfun(R,"ВВЕДИТЕ ПАРАМЕТРЫ ПОДЖАТИЯ В ФОРМАТЕ: RY,RX\TY,TX\MODE    (F1-ПОМОЩЬ)","","","^%ZAPM.ed.BSHLP(""PRESS"")") Q:YES<1
AUTO S ls="идет поджатие" D WAITS^%ZAPM.ed.BSF2 S Titul=$P(R,"\",2) D GR
 I $D(%DIA) D Yes^%ZAPM.ed.BSXfun("В ТАБЛИЦЕ ЕСТЬ ПОМЕЧЕННЫЕ КЛЕТКИ. Будем поджимать ВСЕ ПОМЕЧЕННЫЕ "_$S(%B=1:"СТРОКИ",%B=2:" КОЛОНКИ",1:"СТРОКИ И КОЛОНКИ")_" ! (И пустые, и с данными) ?") Q:YES<1  D PRESP(MOD,"I $P(BOS,""@"",12)") S YES=1 Q
 D PRESSING(MOD) S YES=1
 Q
PRESSING(O) ;САМ ПРЕССИНГ
 N I,J,PR,ST,NB D GR S RX=$P(R,",",2)+1,RY=$P(R,",")+1,ST=0,NB=is
 F I=is:1:se X WA I ((I-is+1)#RY) F J=js:1:ke I ((J-js+1)#RX) I $$A^%ZAPM.ed.BSA(I,J)'="" D PR(1,I,1),PR(2,J,1)
 I "13"[O F I=is:1:se X WA D
 .I '((I-is+1)#RY) D:'ST  S ST=0,NB=I+1 Q
 ..F i=NB:1:I I i'=se D ERASY(i)
 .I $$PRI(1,I) S ST=1
 S ST=0,NB=js
 I "23"[O F J=js:1:ke X WA D
 .I '((J-js+1)#RX) D:'ST  S ST=0,NB=J+1 Q
 ..F i=NB:1:J I i'=ke D ERASX(i)
 .I $$PRI(2,J) S ST=1
 Q
PR(U,J,S) ;ПРИСВОЕНИЕ В ЛОКАЛЬ PR БАЙТА S В ПОЗИЦИЮ J УРОВНЯ U
 S $E(PR(U,J\4000),J-((J\4000)*4000)+1)=S Q
PRI(U,J) ;ВЕРНУТЬ БАЙТ ПО НОМЕРУ J УРОВНЯ U
 Q $E($G(PR(U,J\4000)),J-((J\4000)*4000)+1)
 
PRESP(O,USL) ;ПОМЕЧЕННЫЕ
 N I,J D GR
 F i=is:1:se X WA F j=js:1:ke S BOS=@BSR@(BST,i,j) X USL D:$T
 .I O=1 D ERASY(i) S j=ke+1 Q
 .I O=2 D ERASX(j) Q
 .D ERASY(i),ERASX(j) Q
 Q
ERASY(i) I $P(@BSR@(BST,i,1),"@",3)["X" Q
 N j F j=1:1:ke S $P(@BSR@(BST,i,j),"@",3)="X"_$P(@BSR@(BST,i,j),"@",3)
 Q
ERASX(j) I $P(@BSR@(BST,1,j),"@",4)["X" Q
 N i F i=1:1:se S $P(@BSR@(BST,i,j),"@",4)="X"_$P(@BSR@(BST,i,j),"@",4)
 Q
UNPRESS I TIP'=2 D Yes^%ZAPM.ed.BSXfun("Таблица Поджата. Снимем поджатие ?",2) Q:YES<1
 S ls="СНЯТИЕ ПОДЖАТИЯ" D WAITS^%ZAPM.ed.BSF2,UNPRES,TAB^%ZAPM.ed.BSF1 S $P(@(BSR_"(BST)"),"@",24)="",B=@$ZR Q
UNPRES N BOS,BOS1,i,j
 D GR F i=1:1:se X WA F j=1:1:ke S (BOS1,BOS)=@BSR@(BST,i,j) D  I BOS'=BOS1 S @BSR@(BST,i,j)=BOS
 .I $E($P(BOS,"@",3),1)="X" S $P(BOS,"@",3)=$P($P(BOS,"@",3),"X",2)
 .I $E($P(BOS,"@",4),1)="X" S $P(BOS,"@",4)=$P($P(BOS,"@",4),"X",2)
 Q
GR S TIT=$P(@(BSR_"(BST)"),"@",19),(is,js)=1 S:$D(Titul) TIT=Titul I TIT S is=$P(TIT,","),js=$P(TIT,",",2)
 D:'$D(ke) REND^%ZAPM.ed.BSF2 D:'$D(se) DEND^%ZAPM.ed.BSF2 ;ОПРЕД.КОНЕЧНЫХ ТОЧЕК
 Q
QQ G D^%ZAPM.ed.BS
CALK ;Калькулятор
 N i,i1,i2,i3,i4,%KAT,sEt
 S %zT=$ZT,$ZT="ERCA^%ZAPM.ed.BSSR"
 S li=$S($D(Bstr):@Bstr,1:$G(d)) I $D(%DIA) S li="",do="S sEt=$S($P(^(j),""@"",9)=1:$P(^(j),""@"",15),1:$G(^%ZAPM.ed.BSbufB(""BB""_$G(%BS(3),$P)_$J_""u""_%BS(15),i,j))) i +sEt s li=li_""+""_+sEt" D BLOK^%ZAPM.ed.BSF1
 I $L(li)>($$LNG^%ZAPM.ed.BSF12-1) D Yes^%ZAPM.ed.BSXfun("Получается очень длинная строка! Посчитаем Сразу ?") I YES>0 G C2
C1 S li=$$LineEdit^%ZAPM.ed.BSXfun($TR(li," ",""),"Пиши, например: 123+34 или 23/45+(98+67*34) выполнение-последовательное !","","","^%ZAPM.ed.BSHLP(CAL",$NA(^%ZAPM.ed.BSbufB("HISCALC"_$G(%BS(3),$P))),"Exit^%ZAPM.ed.BSSR")
 I $D(%KAT) S YES=1 Q
 I 'YES Q
 I li="" Q
 S i4="" F i2=1:1 S i3=$E(li,i2) Q:i3=""  D  Q:i4=1
 .I "1234567890+-/*.\)("'[i3 S i4=1 Q
 I i4=1 D ErrMsg^%ZAPM.ed.BSXfun("Никаких букв и = тоже ни к чему !!") G C1
C2 S i1="S i="_li X i1 S li=i G C1
 Q
Exit ;ВЫХОД ИЗ КАЛЬКУЛЯТОРА
 i R1=27,R2=79,R3=89 S %KAT=li,(R2,R3)=-1
 Q
ERCA I $ZE'["SINT" S ls="Ты шо !!!" D O^%ZAPM.ed.BSF7
  S ls="Нельзя же так писать !!!" D O^%ZAPM.ed.BSF7 X "I 0" S YES=0,$ZT=$G(%zT)
  Q
]]></Routine>


<Routine name="%ZAPM.ed.BSSV" type="MAC" languagemode="0"><![CDATA[
%BSSV ;;НАСЧЕТ СВОДОК ; 13:15   17.01.2002
 I $D(^%ZAPM.ed.BSbufB("KCH"_$G(%BS(3),$P)_$J_"u"_%BS(15))) S x=$ZR
 I $G(@Bsr@(Bst,"TSV",1,3))'="" D CHO^%ZAPM.ed.BSF11(@$ZR,$G(@Bsr@(Bst,"TSV",1,3,1)),x,$G(^(2))) Q:YES<1  G 0
 ;```D:$G(ZPT)="" OLD^%ZAPM.ed.BST2 S:$D(OLDT) $P(@x,"#",6)=1
 G 0
CY(Ss) I $D(@zr)
 I $G(%5)=1 S Ss=1
 I $E(SVo,2)=2 S $P(iv(%Co*n(iS)+iS+Cc+C-n(iS)),"@",iii)=Ss+$P($G(iv(%Co*n(iS)+iS+Cc+C-n(iS))),"@",iii) Q
 I $E(SVo,2)=0 S $P(^(iii),"@",15)=Ss+$P(@BSr@(BSt,(%Co*n(iS)+iS+Cc+C-n(iS)),iii),"@",15) Q
 I $E(SVo,2)=1 S $P(iv,"@",iii)=Ss+$P(iv,"@",iii) Q
 Q
CYC1 X "D CY("_%1_") I %3'="""" D CY("_%3_")"
 Q
CYC2 X "D CY("_%1_") I %2'="""" D CY("_%2_")"
 I %3'="" X "D CY("_%3_")"
 Q
CYC3 S ib=$P($P(%1,"("_$C(34),2),","),ie=$P($P(%3,"("_$C(34),2),","),jb=$P($P(%1,",",2),$C(34)_")"),je=$P($P(%3,",",2),$C(34)_")"),ii=0
 I 'STO F s=ib:%2:ie F k=jb:%2:je I 1 D  X:"1"'[%4 "I "_$TR($TR(%4,$C(221,222,223,224),s),$C(231,232,233,234),k) I  D CY($G(^(s_","_k)))
 .I $D(@zr)
 I STO S a2=0 F s=ib:%2:ie S a2=a2+1,b2=0 F k=jb:%2:je S b2=b2+1 I a1=a2&(b1=b2) D  I 1 X:"1"'[%4 "I "_$TR($TR(%4,$C(221,222,223,224),s),$C(231,232,233,234),k) I  D CY($G(^(s_","_k)))
 .I $D(@zr)
 Q
CY3 S ab=$P($P(q1,"("_$C(34),2),","),ae=$P($P(q3,"("_$C(34),2),","),bb=$P($P(q1,",",2),$C(34)_")"),be=$P($P(q3,",",2),$C(34)_")"),ii=0
 S a1=0 F a=ab:q2:ae S a1=a1+1,b1=0 F b=bb:q2:be S b1=b1+1 I 1 X:"1"'[q4 "I "_$TR($TR(q4,$C(221,222,223,224),a),$C(231,232,233,234),b) I  S STO=1,iii="" F  S iii=$O(SP(4,iii)) Q:iii=""  X ZR,SP(4,iii)
 Q
CYC4 X %1 D CY(%0) Q
CYCL I $D(@CurNam@(@("k"_keys),"3,3"))
 S zr=$ZR I $D(SP(2)) S iii="" F  S iii=$O(SP(2,iii)) Q:iii=""  X SP(2,iii) X "I "_%1 E  G CYCE
 I '$D(CALCFON) W /CUP(23,1),/EL(0),zr
 I $E(SVo,2)'=2 D @("cycl"_$E(SVo,2))
 I $D(iv),$S<25000 D SIZE^%ZAPM.ed.BSN(25) I $S<25000 D REC
 S iS="" F  S iS=$O(SP(5,iS)),STO=0 Q:iS=""  X ZR,SP(5,iS) I  I 'STO S iii="" F  S iii=$O(SP(4,iii)) Q:iii=""  X SP(4,iii)
CYCE Q
REC S iS="" F  S iS=$O(iv(iS)) Q:iS=""  F iii=1:1 Q:$P(iv(iS),"@",iii,iii+1)=""  I "0"'[$P(iv(iS),"@",iii) S $P(^(iii),"@",15)=$P(@BSr@(BSt,iS,iii),"@",15)+$P(iv(iS),"@",iii)
 K iv Q
cycl0 ;СТАРАЯ
 S iS="" F  S iS=$O(SP(5,iS)),STO=0 Q:iS=""  X ZR,SP(5,iS) I  I 'STO D
 .S iii="" F  S iii=$O(SP(4,iii)) Q:iii=""  X ZR,SP(4,iii)
 Q
cycl1 ;S iS="" F  S iS=$O(SP(5,iS)),STO=0 Q:iS=""  X ZR,SP(5,iS) I  I 'STO D
 .S iii="",iv="" F  S iii=$O(SP(4,iii)) Q:iii=""  X SP(4,iii)
 .F  S iii=$O(SP(4,iii)) Q:iii=""  S $P(^(iii),"@",15)=$P(@BSr@(BSt,(%Co*n(iS)+iS+Cc+C-n(iS)),iii),"@",15)+$P(iv,"@",iii)
 Q
COP ;КОПИРОВАНИЕ СТРОКИ si
 I $D(@(BSR_"(BST,si,1)")) S St=St+1 X WA F kj=1:1 Q:'$D(@(BSR_"(BST,si,kj)"))  S @(BSr_"(BSt,St,kj)")=@$ZR D
 .I 'fo F f="FCL","FTR","COL" S $P(@$ZR,"@",$S(f="COL":13,f="FCL":7,f="RTR":16,1:8))=""
 .I fo D
 ..I $D(@BSR@(BST,"FTR",si,kj)) S @BSr@(BSt,"FTR",St,kj)=@$ZR
 ..I "2345"'[$P(@BSR@(BST,si,kj),"@",7) I $D(@BSR@(BST,"FCL",si,kj)) S @BSr@(BSt,"FCL",St,kj)=@$ZR
 ..I '$P(B,"@",27) S f="COL" I $D(@(BSR_"(BST,f,si,kj)")) S @(BSr_"(BSt,f,St,kj)")=@$ZR D
 ...I $D(@(BSR_"(BST,f,si,kj,1)")) S @(BSr_"(BSt,f,St,kj,1)")=@$ZR
 Q
0 I $G(SRAVN) S CALCFON=SRAVN
 I $E(%BS(1),13) D Yes^%ZAPM.ed.BSZPS Q:YES<1
BEGIN I $D(CALCFON) S $P(@x,"#",2)=1,YES=0,x=$$%^%ZAPM.ed.BSF12($ZR) L -@x D  H 3 Q:YES
 .I CALCFON=2,$P($ZV,"Version ",2)="4.0.11" D ErrMsg^%ZAPM.ed.BSXfun("Удаленный процесс в "_$ZV_" ЗАПУСТИТЬ НЕЛЬЗЯ !") S YES=1
 .I CALCFON=2,$P($ZV,"Version ",2)'="4.0.11" S UUU=$P($P(UU,"[",2),"]") X "J J^%ZAPM.ed.BSSV(x,$G(ObR))["_UUU_"]::1" I  D:'$D(PACKET) OkMsg^%ZAPM.ed.BSXfun("Фоновый процесс в СИСТЕМЕ ["_UUU_"] ЗАПУЩЕН") S YES=1
 .I CALCFON=1 J J^%ZAPM.ed.BSSV(x,$G(ObR))::1 I  D:'$D(PACKET) OkMsg^%ZAPM.ed.BSXfun("Фоновый насчет ЗАПУЩЕН") S YES=1
 S $P(@x,"#",2)="",x=$ZR I $D(CALCFON) D:'$D(PACKET) ErrMsg^%ZAPM.ed.BSXfun("Не могу запустить фоновый процесс")
 D J(x,$G(ObR)) Q
J(xZ,ObR) S Total=$P($$h^%ZAPM.ed.BS3(),",",2) S:$G(%BS(15))<1 %BS(15)=0 L +@xZ K zr,CH,SP,CALCFON,n D SI^%ZAPM.ed.BSN
 S i=$P(@xZ,"#"),BST=$P(i,",",$L(i,",")),BSR=$P(i,",",1,$L(i,",")-1),BSdd=$P(@$ZR,"#",3),ZPR=$P(@$ZR,"#",4),ZPT=$P(@$ZR,"#",5) S:$P(@$ZR,"#",2) CALCFON=1,WA="" I +$P(@$ZR,"#",6) S OLDT=1,CO=$P(@$ZR,"#",7)
 S %0=$$ESDAY^%ZAPM.ed.BSsFUNR(8,$$h^%ZAPM.ed.BS3()) D:'$D(CALCFON) END^%ZAPM.ed.BSF D KCHO^%ZAPM.ed.BSsFUNM
 S n=1,BSr=$S(ZPR'="":ZPR,1:$$cB),(iii,i)=$$TNAME^%ZAPM.ed.BSF13(BSR,BST),ii="",TIP=4,%Co=2,%Do=0,ls="ИДЕТ ГЕНЕРАЦИЯ СВОДКИ"
 I ZPR="" S ii=0 F  S i=$O(@(BSr_"(i)")) Q:i'[(iii_".")  S:ii<$P(i,".",2) ii=$P(i,".",2) ;````I $D(OLDT),$P($P(@(BSr_"(i)"),"@"),"_",2)=CO S ii=ii-1 Q
 S ii=ii+1,ZR="I $D(@zr)",BSt=$S(ZPT'="":ZPT,1:iii_"."_ii),ls=ls_" "_BSt D:'$D(CALCFON) WAITS^%ZAPM.ed.BSF2 S WA="" K:'$D(@(BSr_"(BSt)")) OLDT
 L +@BSr@(BSt)
 I $$VAR^%ZAPM.ed.BSH ;ПЕРЕМЕННЫЕ
 I $D(@(BSr_"(BSt)")),$P($P(@$ZR,"@"),"_",2)'=$G(CO,"?") K @$ZR,OLDT
 I $G(ObR)'="" S @ObR@("TT")=$ZR
 N Desc
 S (B,@(BSr_"(BSt)"))=@(BSR_"(BST)"),Desc=$P(@$ZR,"@"),$P(@$ZR,"@")="__"_%0_";СЧЕТ",$P(@$ZR,"@",17)=1,$P(@$ZR,"@",30)="" F i=2,4,5 S $P(@$ZR,"@",i)=""
 S I="" F Tmp=1:1 S I=$O(@xZ@(I)) Q:'I  S II="" F  S II=$O(@xZ@(I,II)) Q:II=""  F III=1,2,3,4 I $D(@xZ@(I,II,III)) S CH(Tmp,II,III)=$$Variabl^%ZAPM.ed.BSSP(^(III))
 S CH="",CH=$O(CH(1,CH)) I CH="" S ls=" НЕОПРЕДЕЛЕНА ВЫБОРКА КЛЮЧЕЙ " G NO^%ZAPM.ed.BSSP
 K SAY,ZPR,ZPT L -@xZ S xZ=@xZ K @$ZR
 F C=1:1 Q:'$D(CH(C))  D  S SAY(C)=C_" - период "_SAY
 .S SAY="" I $D(CH(C,0)) S SAY=SAY_$S(CH(C,0,4)'["NONE#":$P(CH(C,0,4),"#")_$$s^%ZAPM.ed.BSSP(CH(C,0,1),0),1:"")
 .F II=1:1:9 D
 ..I $G(CH(C,II,4),"NONE#")["TXTC#" S SAY=SAY_" "_$P(CH(C,II,4),"#",2) Q
 ..I $G(CH(C,II,4),"NONE#")'["NONE#" D
 ...S SAY=SAY_" "_$P(CH(C,II,4),"#")_" "_$$s^%ZAPM.ed.BSSP(CH(C,II,1),II)
 ...S SAY=SAY_" "_$P(CH(C,II,4),"#",2)_" "_$$s^%ZAPM.ed.BSSP(CH(C,II,2),II)
 S %zT=$ZT,$ZT="ER"_$S($D(CALCFON):1,1:"")_"^%ZAPM.ed.BSSP"
 S COMP=C-1,KLB=$G(@(BSR_"(BST,""TSV"",1)")) ;!!!I $D(^(2,1)) F i=1:1 Q:'$D(^(i))  S SP(2,i)=^(i)
 I 'KLB S ls=" БАЗ ДАННЫХ НЕТ ! " G NO^%ZAPM.ed.BSSP
 S TSVV=$G(@(BSR_"(BST,""TSV"",1,2)")),TSVL=$G(^(1)),TSVU=$G(^(4)),TSVN=$G(^(7)),TSVD=+$P($G(^(3,1)),",",3)
 S (Cc,St,fo)=0 I $D(@(BSR_"(BST,""TSV"",0)")) D SAY(@$ZR,1) S Cc=1
 F C=1:1:COMP D SAY(SAY(C),C+Cc) S @BSr@(BSt,"PER",C)=SAY(C)
 S St=COMP+Cc,TSV=$S($G(TSVD):TSVD-1,+TSVL:TSVL-1,+TSVU:TSVU-1,1:0) I '+TSV S ls=" ОШИБКА В РАСПОЛОЖЕНИИ ФУНКЦИЙ " G NO^%ZAPM.ed.BSSP
 I $P(@(BSR_"(BST)"),"@",19) S $P(@(BSr_"(BSt)"),"@",19)=($P($P(@$ZR,"@",19),",")+St)_","_$P($P(@$ZR,"@",19),",",2)
 I $P(@(BSR_"(BST)"),"@",50) S $P(@(BSr_"(BSt)"),"@",50)=($P($P(@$ZR,"@",50),",")+St)_","_$P($P(@$ZR,"@",50),",",2)
 I $D(@BSR@(BST,"ExcelOut")) S @BSr@(BSt,"ExcelOut")=@$ZR
 S $P(@BSr@(BSt,"ExcelOut"),",",3)=St+1
 I '$D(OLDT) S fo=1 F si=1:1:TSV D COP ;СОЗДАНИЕ ШАПКИ
 I $D(@(BSR_"(BST,""PRN"")")) S @(BSr_"(BSt,""PRN"")")=@$ZR
 I $D(@(BSR_"(BST,""RSM"")")) S @(BSr_"(BSt,""RSM"")")=@$ZR
 I $D(@(BSR_"(BST,""SVM"")")) S @(BSr_"(BSt,""SVM"")")=@$ZR
 I $D(@BSR@(BST,"Var")) D Copy^%ZAPM.ed.BSF8($NA(@$ZR),$NA(@BSr@(BSt,"Var")))
 S @BSr@(BSt,"REM")=$P(@BSR@(BST),"@")
 I $D(@(BSR_"(BST,""SHR"")")) S @(BSr_"(BSt,""SHR"")")=@$ZR
 I $D(@(BSR_"(BST,""HFS"")")) S @(BSr_"(BSt,""HFS"")")=$G(@$ZR)
 I $D(@(BSR_"(BST,""AF2"")")) S @(BSr_"(BSt,""AF2"")")=BSR_","_BST
 S @(BSr_"(BSt,""sp"")")="S"
 S @BSr@(BSt,"LST")=$H_","_$G(%BS(12))_",Greated"
 S @BSR@(BST,"PER")=COMP ;ПЕРИОДЫ СРАВНЕНИЯ
 S fo=0,%Co=COMP,SVo=$G(@BSR@(BST,"SVO"),"12")
 ;I +(TSVU) ;УНИВЕРСАЛЬНЫЕ ФОРМУЛЫ ???????? КОГДА ОНИ БУДУТ ????
 ;.....ЗАМЕНА СТАРОЙ
 I $D(OLDT) I +TSVV&(+TSVL) S si=TSV F  S si=$O(@(BSR_"(BST,si)")) G SVB:'si S fo=$S($P(@(BSR_"(BST,si,TSVV)"),"@",7):1,1:0) D ZER I fo S n(si)=n,n=n+1 F C=2:1:COMP D ZER
 ;......МИКРОЗАПРОСЫ ПОДРАЗУМЕВАЮТ МОНОБАЗУ !!!!!!!!!!!!!!!!!!
 I $P(xZ,"#",9)'="" D CREAT^%ZAPM.ed.BSF11($P(xZ,"#",9),$P($P(xZ,"#",10),",",3),$P($P(xZ,"#",10),",",4),$P($P(xZ,"#",10),",",1),$P($P(xZ,"#",10),",",2)) G SVB
 ;.........НОВАЯ БЕЗ М\ЗАПРОСОВ
 I +TSVV&(+TSVL) S si=TSV F  S si=$O(@(BSR_"(BST,si)")) G SVB:'si S fo=$S($P(@(BSR_"(BST,si,TSVV)"),"@",7):1,1:0) D COP I fo S @(BSr_"(BSt,St)")=1,n(si)=n,n=n+1 F C=2:1:COMP D COP S @(BSr_"(BSt,St)")=C,$P(@(BSr_"(BSt,St,TSVV)"),"@",15)=""
SVB S (ke,Ke)=kj-1 K iv D:'$D(CALCFON) Wait^%ZAPM.ed.BSXfun("ЦИКЛ ПО ДИАПАЗОНУ И БАЗЕ ДАННЫХ") F NBD=1:1:KLB D
 .K SP(2),SP(3),SP(4) I $D(@(BSR_"(BST,""TSV"",2,NBD)")) I $D(^(NBD,1)) F i=1:1 Q:'$D(^(i))  S SP(2,i)=^(i) ;TSPGL
 .I $D(@(BSR_"(BST,""TSV"",4,NBD)")) S i="" F  S i=$O(@(BSR_"(BST,""TSV"",4,NBD,i)")) Q:i=""  S SP(4,i)=^(i) ;TSVL
 .I $P(xZ,"#",9)="" D  ;КОГДА НЕТ МИКРО-ЗАПРОСОВ
 ..K SP(5) I $D(@(BSR_"(BST,""TSV"",5,0)")) S i="" F  S i=$O(@(BSR_"(BST,""TSV"",5,0,i)")) Q:i=""  S SP(5,i)=^(i) ;ВСЕ БАЗЫ
 ..I $D(@(BSR_"(BST,""TSV"",5,NBD)")) S i="" F  S i=$O(@(BSR_"(BST,""TSV"",5,NBD,i)")) Q:i=""  S SP(5,i)=^(i) ;TSVV
 .;~~~I $D(@(BSR_"(BST,""TSV"",3,NBD)")) S i="" F  S i=$O(@(BSR_"(BST,""TSV"",3,NBD,i)")) Q:i=""  S j="" F  S j=$O(@(BSR_"(BST,""TSV"",3,NBD,i,j)")) Q:j=""  S SP(3,i,j)=^(j) ;TSVU
 .K ke,k0,k1,k2,k3,k4,k5,O S BSD=$P($P(BSdd,"!",NBD),"@") F C=1:1:COMP D SVO
 G SVE ;..............КОНЕЦ СВОДКИ
SVO N nam,ks1,X1,X2,X3,X4,X5,X6,X7,X8,X9,ks2,ks3,ks4,ks5,ks6,ks7,ks8,ks9,CurNam
 S (nam,%NAm)=BSD I CH=0 S (nam,%NAm)=BSD_CH(C,CH,1),k0=CH(C,CH,1)
 I '$$GETDDP^%ZAPM.ed.BSF12(%NAm) Q
 S %NAm=%NAm_"(" F key=1:1:10 Q:'$D(CH(C,key))
 S keys=key-1,fo=0
 F i=1:1:9 S @("X"_i)="I 1 " I $D(CH(C,i,3)) S @("X"_i)=@("X"_i)_" "_CH(C,i,3)
 D
L1 .S k1=$$OTDO($NA(@nam),1) F  S k1=$O(@nam@(k1)) Q:k1=""!(k1=ks1)  X X1 I  D
L2 ..D:'$D(CH(C,2)) CYCL I $D(CH(C,2,1)) S k2=$$OTDO($NA(@nam@(k1)),2) F  S k2=$O(@nam@(k1,k2)) Q:k2=""!(k2=ks2)  X X2 I  D
L3 ...D:'$D(CH(C,3)) CYCL I $D(CH(C,3,1)) S k3=$$OTDO($NA(@nam@(k1,k2)),3) F  S k3=$O(@nam@(k1,k2,k3)) Q:k3=""!(k3=ks3)  X X3 I  D
L4 ....D:'$D(CH(C,4)) CYCL I $D(CH(C,4,1)) S k4=$$OTDO($NA(@nam@(k1,k2,k3)),4) F  S k4=$O(@nam@(k1,k2,k3,k4)) Q:k4=""!(k4=ks4)  X X4 I  D
L5 .....D:'$D(CH(C,5)) CYCL I $D(CH(C,5,1)) S k5=$$OTDO($NA(@nam@(k1,k2,k3,k4)),5) F  S k5=$O(@nam@(k1,k2,k3,k4,k5)) Q:k5=""!(k5=ks5)  X X5 I  D
L6 ......D:'$D(CH(C,6)) CYCL I $D(CH(C,6,1)) S k6=$$OTDO($NA(@nam@(k1,k2,k3,k4,k5)),6) F  S k6=$O(@nam@(k1,k2,k3,k4,k5,k6)) Q:k6=""!(k6=ks6)  X X6 I  D
L7 .......D:'$D(CH(C,7)) CYCL I $D(CH(C,7,1)) S k7=$$OTDO($NA(@nam@(k1,k2,k3,k4,k5,k6)),7) F  S k7=$O(@nam@(k1,k2,k3,k4,k5,k6,k7)) Q:k7=""!(k7=ks7)  X X7 I  D
L8 ........D:'$D(CH(C,8)) CYCL I $D(CH(C,8,1)) S k8=$$OTDO($NA(@nam@(k1,k2,k3,k4,k5,k6,k7)),8) F  S k8=$O(@nam@(k1,k2,k3,k4,k5,k6,k7,k8)) Q:k8=""!(k8=ks8)  X X8 I  D
L9 .........D:'$D(CH(C,9)) CYCL I $D(CH(C,9,1)) S k9=$$OTDO($NA(@nam@(k1,k2,k3,k4,k5,k6,k7,k8)),9) F  S k9=$O(@nam@(k1,k2,k3,k4,k5,k6,k7,k8,k9)) Q:k9=""!(k9=ks9)  X X9 I  D
CEND M @BSr@(BSt,"PERIODS")=CH
 D REC
 Q
OTDO(S,K) ;ОПРЕДЕЛЕНИЕ ГРАНИЦ ПЕРЕБОРА КЛЮЧЕЙ
 N K1,K2
 I CH(C,K,1)="" S K1=""
 I CH(C,K,2)="" S K2=""
 I '$D(K1) S K1=$O(@S@(CH(C,K,1)),-1)
 I '$D(K2) S K2=$O(@S@(CH(C,K,2)))
 S @("ks"_K)=K2,CurNam=S Q K1
ERCEN W /BEL S d1=$ZE Q
SVE I '$D(CALCFON) W /CUP(23,1),/EL(0)
CEN I +TSVN S ls="ОБРАБОТКА СРАВНЕНИЯ" D:'$D(CALCFON) WAITS^%ZAPM.ed.BSF2 S j=+TSVN D
 .N PA,d,d1,d0,C S PA=$P(TSVN,";",2)
 .F i=1:1:St I $G(@BSr@(BSt,i)) S (C,jj)=@$ZR D  S $P(@BSr@(BSt,i,j),"@",15)=d1 X WA
 ..S $ZT="ERCEN^%ZAPM.ed.BSSV"
 ..I PA="C" S (d,d0,d1)=jj
 ..I PA?1N.N S (d,d0,d1)=$G(CH(jj,PA,1))
 ..I PA="" S (d,d0,d1)=$G(CH(jj,0,1))
CE I $D(SP(4)) S (iS,n)="" D  D GLSET^%ZAPM.ed.BSF12($NA(@BSr@(BSt,"AFO")),n)
 .F  S iS=$O(SP(4,iS)) Q:iS=""  S n=n_iS_","
 K TSVL,TSVV,TSVD,SP,n,si,sii,Cc,k0,k2,k3,k4,k5,StR,KLB,I,%1,%0,%2,%3,%4,%5,key,keys,SAY,CH,X1,X2,X3,X4,Mx,X5,O,L,SP,fo,%NAm,kj,f,a,b,s,k,ib,ie,jb,je,q1,q2,q3,q4,q5,ab,ae,bb,be,STO,a1,a2,b1,b2 D KCHO^%ZAPM.ed.BSsFUNM
 S BST=BSt,BSR=$$%^%ZAPM.ed.BSF12(BSr),se=St,ke=Ke,ls="ФОРМИРОВАНИЕ ТАБЛИЦЫ" D:'$D(CALCFON) WAITS^%ZAPM.ed.BSF2 D TABM^%ZAPM.ed.BSF1 K TSV S $ZT=$G(%zT) D  Q:$D(CALCFON)  D:$D(zr)&('$D(PACKET)) ^%ZAPM.ed.BST S CALCFONs=1 Q
 .I $G(ObR)'="" S @ObR@("TZ")=($P($$h^%ZAPM.ed.BS3(),",",2)-Total)_" сек"
 .S I=$P(@(BSr_"(BSt)"),"@"),I=$P(I,";")_";"_$S($D(zr):"ГОТОВА",1:"ПУСТАЯ")_" за "_($P($$h^%ZAPM.ed.BS3(),",",2)-Total)_" сек"
 .S $P(I,"_",2)=COMP,$P(@(BSr_"(BSt)"),"@")=I_"|"_$G(Desc)
 .S $P(@$ZR,"@",30)="" D TPr^%ZAPM.ed.BSF8($ZR)
 .I $P(@BSr@(BSt),"@",51) D APRESS^%ZAPM.ed.BSSR($NA(@BSr@(BSt)))
 .S @BSr@(BSt,"PERDATE")=$$ESDAY^%ZAPM.ed.BSsFUNR(7,$$h^%ZAPM.ed.BS3())
 .S @BSr@(BSt,"PERUSER")=$G(%BS(12))
 .K COMP L -@BSr@(BSt)
ZER S St=St+1 X WA F kj=1:1 Q:'$D(@(BSr_"(BSt,St,kj)"))  I $P(@$ZR,"@",15) S $P(@$ZR,"@",15)=""
 Q
SAY(SAY,C) I '$D(OLDT) S si=1 D COP F j=1:1:kj-1 I $D(@(BSr_"(BSt,C,j)")) S $P(@$ZR,"@",15)="",$P(@$ZR,"@",7)="",$P(@$ZR,"@",8)="",$P(@$ZR,"@",13)="",$P(@$ZR,"@",3)=1,$P(@$ZR,"@",18)=""
 I $D(@(BSr_"(BSt,C,1)"))
 I $D(OLDT) S i=1 F j=1:1 Q:'$D(^(j))  S $P(^(j),"@",15)=$E($J("",$L(SAY)),i,i+$P(^(j),"@",4)-1),i=$P(^(j),"@",4)+i X WA
 S i=1 F j=1:1 Q:'$D(^(j))  S $P(^(j),"@",15)=$E(SAY,i,i+$P(^(j),"@",4)-1),i=$P(^(j),"@",4)+i X WA
 Q
cB() I $ZV'["Cach"&&($ZV'["IRIS") Q "^%ZAPM.ed.BSbufS" //$$%^%ZAPM.ed.BSF12("^%ZAPM.ed.BSbufS")
 N A S A=$$SW^%ZAPM.ed.BSF12("^%ZAPM.ed.BSbufS")
 Q A_$$2LAT^%ZAPM.ed.BSCp($G(%BS(12),$G(BSLOGIN)))
]]></Routine>


<Routine name="%ZAPM.ed.BST" type="MAC" languagemode="0"><![CDATA[
%BST ;ВХОД В ТАБЛИЦУ ; 11:16   03.10.2000
 W $$atr^%ZAPM.ed.BS3(0) I $ZV'["Cach"&&($ZV'["IRIS") ;U 0:(0::::#10080)
 I $P($ZV,"Version ",2)<4 W $$clear^%ZAPM.ed.BS3
 K STATUS D SI^%ZAPM.ed.BSN I $D(%BS)["0" D CLr^%ZAPM.ed.BSF4
 ;N S,STATUS,VYC,BS0,BSX,BSY,B,BX,BY,BS1,BS2,MX,MY,x,t,zr,t1,%VDB,%CAL,%X1,%X2,%Y1,%Y2,%TIT,MR,%w(2),M1,BS,%w(4),%w(5),%DIA,%DI,%ZAP,%FK,i,j,ii,jj,se,ke,j1,j2,j3,MX,MY,M,BS1,BS2,BSF,BSX1,BSX2,BSY1
 ;N BSY2,CLR,ENDLI,BSI,BSII,MR23,MR24,MR25,NAZAD,li,ls,lo,COLOR
 ;N RA,PREDMOV,MxX,MyY,My,Mx,COLOR,EXITout,%FN,%DEV,%Cu,es,ek,h,hi,hl,%INV,%INV1,%INV2,v,vv,vvv,TIP,%FK,%ZAP,%VDB,MOV
 S $ZT="PRO^%ZAPM.ed.BST"
% K PredOb I '$D(@BSR@(BST))!($$TIP^%ZAPM.ed.BS($P($G(@BSR@(BST)),"@",17))["!!!") S ls="ОБЪЕКТ ~"_BST_" В РАЗДЕЛЕ "_BSR_" НЕ ОПОЗНАН " G STOP
 S $ZT=$G(%zT) I $P(@$ZR,"@",39) Q  ;D Enter^%ZAPM.ed.BSGTab($ZR) Q  ;%BS Gamma Version
 I ($P($$ZU^%ZAPM.ed.BS3(1,0),",",2)_$G(%BS(3),$P)_$J_"i"_$G(%BS(12)))'[$P(@$ZR,"@",30) S ls=" ТАБЛИЦА ЗАНЯТА ПОЛЬЗОВАТЕЛЕМ "_$P(@$ZR,"@",30) D  G STOP
 .D Yes^%ZAPM.ed.BSXfun(" СНИМЕМ ЗАКРЫТИЕ ???",2) I YES D L^%ZAPM.ed.BS3($NA(@BSR@(BST))) I LOC S $P(@BSR@(BST),"@",30)="" D U^%ZAPM.ed.BS3($NA(@BSR@(BST)))
 I BSR'["," S BSR=$$BSR^%ZAPM.ed.BSA(BSR)
 I $P(@$ZR,"@",37) D CHECK^%ZAPM.ed.BSH I 'YES G STOP
 D TIPP I '$D(%w(2)) D PASS^%ZAPM.ed.BST1 E  G END^%ZAPM.ed.BSF
 G DoBSX:TIP=5,DoLINK^%ZAPM.ed.BSF13:TIP=6,DoButt^%ZAPM.ed.BSF8:TIP=8
GOO I $E(%BS(1),20),%BS(12)="" D  H
 .S BSR="^%ZAPM.ed.BSS",BST="LOGON" D ^%ZAPM.ed.BST,Echo^%ZAPM.ed.BSXfun(1) D:d=2 SS^%ZAPM.ed.BSD2 Q:d<0
GO I $D(@(BSR_"(BST,""KEY"")")) D KEY^%ZAPM.ed.BST1:TIP=2,^%ZAPM.ed.BST2:TIP=3!(TIP=4) Q:'$D(F4)
 I '$D(@(BSR_"(BST,""KEY"")")),'$P(B,"@",34) D L^%ZAPM.ed.BS3($NA(@BSR@(BST))) G:'LOC STOP
KEY I '$D(STATUS) S BS0=0,(BSX(BS0),BSY(BS0))=1,(BSX1(BS0),BSY1(BS0))=1,BSX2(BS0)=79,BSY2(BS0)=22
 W $$setkod^%ZAPM.ed.BS3 D LOCK^%ZAPM.ed.BSF4 D TIP   q:'$d(BSR)  //```msw 
WRITE I $G(@BSR@(BST,"RSM"))'="" D XM^%ZAPM.ed.BSre(@$ZR) ;ВЫПОЛНИТЬ КОМАНДУ ВОССТАНОВЛЕНИЯ
 I $D(@BSR@(BST,"FCL")) D CALC^%ZAPM.ed.BSF3
 I $P(@BSR@(BST),"@",47) D CHECKF^%ZAPM.ed.BSF10($P(@BSR@(BST),"@",47)) ;АВТОФОРМАТ
 I $P(@BSR@(BST),"@",24) D UNPRESS^%ZAPM.ed.BSSR I '$P(B,"@",24) G Wr
 I $P(@BSR@(BST),"@",51) D PRESAUTO^%ZAPM.ed.BSSR($P(@BSR@(BST),"@",51)) ;АВТОПОДЖАТИЕ
Wr I $P(B,"@",41)'="" S R1=333 D Pred^%ZAPM.ed.BSF12($P(B,"@",41)) ;ПРЕДОБР.ПОСЛЕ ВЫЧИСЛЕНИЯ
 D TIT
WRI I $ZV'["Cach"&&($ZV'["IRIS") ;U 0:(0::::#10080)
 S ls="ЗАГРУЗКА" D WAITS^%ZAPM.ed.BSF2 D W,MR K %VDB S $ZT=$G(%zT) G ^%ZAPM.ed.BSTM
VW D VT,W Q
GW D GT,W Q
TW D VT,GT,W Q
W I $G(Mx,0)'=0!($G(My,0)'=0),%BS(13)="%BS-PC",$ZV'["Windows" G ^%ZAPM.ed.BST5
MOV D:'$D(%VDB) CLEA K BS1,BS2,BY,BX S %BSTM=0
 K ENDDN S BSI=BSY(BS0)-1 F  S BSI=$O(@(BSR_"(BST,BSI)")) Q:'BSI  S BS(1)=1 I $P(@(BSR_"(BST,BSI,1)"),"@",3) D  Q:$D(ENDDN)
 .K ENDRI S BSII=BSX(BS0)-1 F  S BSII=$O(@(BSR_"(BST,BSI,BSII)")) Q:BSII=""  D WR I $D(ENDRI)!($D(ENDDN)) S BS(2)=0 Q
e Q
TRANS(BSR,BST,BS,BSI,BSII) N TranS,ny,nx,d,d0 S TranS=1 G TRAN
WR W $$atr^%ZAPM.ed.BS3(0) S CLR=COLOR I $D(@(BSR_"(BST,BSI,BSII)")) S BS=^(BSII) Q:'$P(BS,"@",4)  I '$D(BS1) S BS1=$P(BS,"@")+1,BS2=$P(BS,"@",2)+1 I 'BS0 S (BS(1),BS(2))=1
 I (($P(BS,"@")+$P(BS,"@",3)-2)-BS1+2+BSY1(BS0))>BSY2(BS0) S ENDDN=1 Q
 I (($P(BS,"@",2)+$P(BS,"@",4)-2)-BS2+2+BSX1(BS0))>BSX2(BS0) S ENDRI=1 Q
 I $P(BS,"@",10) S CLR=$P(BS,"@",10) I $E(%BS(1),19) S CLR=$P(%BS,"!",$E(%BS(1),19))
 I $P(BS,"@",12) S CLR=$P(%BS,"!",3)
TRAN I $P(BS,"@",9)=1 S (d,d1,d0)=$P(BS,"@",15)
 E  S (d,d1,d0)=$G(^%ZAPM.ed.BSbufB("BB"_$G(%BS(3),$P)_$J_"u"_%BS(15),BSI,BSII)) //```??
 I $P(BS,"@",8)'="" S %zT=$ZT,$ZT="FFF^%ZAPM.ed.BST" D  S $ZT=$G(%zT)
 .I d0="" S d0=0
 .S ny=BSI,nx=BSII I '$P(BS,"@",8) X $G(@BSR@(BST,"FTR",BSI,BSII)) Q
 .X $G(@(BSR_"(BST,""FTR"","_$P(BS,"@",8)_")"))
 I $D(TranS) Q
w I '$D(%VDB) S l=$J("",$P(BS,"@",3)*$P(BS,"@",4)) F BSF=1:1:$P(BS,"@",3) Q:($P(BS,"@")+BSF-BS1)>BSY2(BS0)  D  W $E(d1_l,BSF*$P(BS,"@",4)-$P(BS,"@",4)+1,$P(BS,"@",4)+($P(BS,"@",4)*(BSF-1)))
 .W /CUP(($P(BS,"@")+BSF-BS1+BSY1(BS0)),($P(BS,"@",2)-BS2+1+BSX1(BS0))),$$atr^%ZAPM.ed.BS3(CLR) Q
 Q:BS0  I BS(1) S BY($P(BS,"@")-BS1+1+BSY1(0))=BSI,BS(1)=0
 I BS(2) S BX($P(BS,"@",2)-BS2+1+BSX1(0))=BSII
 Q
VT Q:'$D(%TIT)  S BS0=2,BSY(BS0)=BSY(0) D W S BS0=0 Q
GT Q:'$D(%TIT)  S BS0=1,BSX(BS0)=BSX(0) D W S BS0=0 Q
MR K %FK,%ZAP N i F i=12:1:14 S @("MR"_(i+11))="" I $P(@(BSR_"(BST)"),"@",i)'="" D
 .I $P(^(BST),"@",i)=1 S @("MR"_(i+11))="D MR"_(i+11) Q
 .S @("MR"_(i+11))=$P(^(BST),"@",i)
 K %fk I $P(^(BST),"@",15)'="" S %FK=$P(^(BST),"@",15)
 I $P(^(BST),"@",16) S %ZAP=1
 I TIP=2,$G(%BS("Tmp","AKBD",BSD),"RWD")="R" S %ZAP=1
 Q
TIPP S B=@(BSR_"(BST)") S TIP=$P(B,"@",17) S:TIP="" TIP=1 D ENTERPAS^%ZAPM.ed.BSF7(B) Q
TIP S:'$D(%Co) %Co=0    q:'$d(BSR)  S B=$G(@(BSR_"(BST)")) //$G(
 S:$P(B,"@",3) %DIA=1 S:$P(B,"@",20) %CAL=$P(B,"@",20) S TIP=$P(B,"@",17) S:TIP="" TIP=1 D ENTERPAS^%ZAPM.ed.BSF7(B)
 S COLOR=$S($E(%BS(1),19):$P(%BS,"!",$E(%BS(1),19)),1:$P(B,"@",31)) I COLOR="" S COLOR=0
 S %Cu=$S($G(TIP)=7:"D KL","1"[$P(B,"@",25):"D KL",1:"D 24") K Ukaz I $P(B,"@",43) S Ukaz=1
 I $P(B,"@",46)'="",'$D(ObOi) D OBWRITE^%ZAPM.ed.BSF10
 S:$G(%BS(15))<1 %BS(15)=0 S se=$P(B,"@",28),ke=$P(B,"@",29) S Mouse=$S(ke=1:1,1:"") I $P(B,"@",38),'$D(RA) S RA=$P(B,"@",38) D Ramka^%ZAPM.ed.BSXfun($P(B,"@",8)-1,$P(B,"@",9)-1,$P(B,"@",10)+1,$P(B,"@",11)+1,RA,COLOR,1)
 S POSt=%BS(16) I $P(B,"@",44)'="" S POSt=$P(B,"@",44)
 I $P(B,"@",41)'="" S PredOb=$P(B,"@",41)
 I $D(BSR) D PST^%ZAPM.ed.BSD1(BSR)
 I TIP=2,$D(BSD),$G(%BS("Tmp","AKBD",BSD),"RWD")="R" S %ZAP=1
 Q
TIT I $P(@(BSR_"(BST)"),"@",19) S %TIT=$P(^(BST),"@",19) K:'$D(@(BSR_"(BST,"_%TIT_")")) %TIT
 E  K %TIT
 I $D(@BSR@(BST)) D  ;
 .I '$D(%TIT) S BS0=0,BSY1(0)=$P(^(BST),"@",8),BSX1(0)=$P(^(BST),"@",9),BSY2(0)=$P(^(BST),"@",10),BSX2(0)=$P(^(BST),"@",11) D:$E($G(%BS(14)),2) TRM Q
 .S BS0=0,BSY2(BS0)=+$P(^(BST),"@",10),BSX2(BS0)=+$P(^(BST),"@",11) D  S BSY1(BS0)=$P(@(BSR_"(BST,"_%TIT_")"),"@")+BSY1(0)-1,BSX1(BS0)=$P(@$ZR,"@",2)+BSX1(0)-1 I $G(STATUS)'=BST S BSY(0)=+$P(%TIT,","),BSX(0)=+$P(%TIT,",",2),STATUS=BST
 ..S BSY1(0)=+$P(^(BST),"@",8),BSX1(0)=+$P(^(BST),"@",9)
 .S BS0=1,(BSY1(3),BSY1(BS0))=+$P($G(@(BSR_"(BST)"),1),"@",8),BSX1(BS0)=BSX1(0),(BSY2(3),BSY2(BS0))=BSY1(0)-1,BSX2(BS0)=+$P(^(BST),"@",11)
 .S BS0=2,BSY1(BS0)=BSY1(0),(BSX1(3),BSX1(BS0))=+$P(^(BST),"@",9),BSY2(BS0)=+$P(^(BST),"@",10),(BSX2(3),BSX2(BS0))=BSX1(0)-1
 .S (BSY(3),BSX(3),BSY(1),BSX(2))=1,BSY(2)=BSY(0),BSX(1)=BSX(0),BS0=3 D:$E($G(%BS(14)),2) TRM D W S BS0=1 D W S BS0=2 D W S BS0=0
 Q
TRM I TIP'=7 F i=0,1,2 D
 .I $D(BSX2(i)),BSX2(i)>64,ke'=1 S BSX2(i)=64
 .I $D(BSY2(i)),BSY2(i)>21 S BSY2(i)=21
 Q
FFF W $$bel^%ZAPM.ed.BS3 I $ZE["<NOPGM" S @$ZR=""
 S $ZT=$G(%zT) G w
CLEA I TIP=7 S ColrMenu=$S($P(B,"@",31)="":"1;6;30;47",1:$P(B,"@",31)) D  K BFL,% Q
 .I $D(^%ZAPM.ed.BSR(2,1)) D
 ..W /ED(2),/CUP(1,1) W $$atr^%ZAPM.ed.BS3(ColrMenu)
 ..I $E($G(%BS(14)),6)=3 D  Q  ;ДЛЯ АРМ-ТЕРМ
 ...F i=1:1:25 W /CUP(i,1),$E($TR(^(i),"x",""),1,80-(i=25))
 ..F i=1:1:25 W /CUP(i,1),$E($TR(^(i),"x",""),1,80)
 .W /CUP(24,3) W:%BS(13)["%BS-PC" $$atr^%ZAPM.ed.BS3(ColrMenu) W ^%ZAPM.ed.BS(26),/CUP(4,3+((77-$L($P(B,"@")))\2)),$P(B,"@")
 .D MENU
 I '($D(ObOi)!($D(RA))) D
 .I $G(%BS(14)),((BSY1(BS0)<3&(BSX1(BS0)<3))!($E(BST,1,2)="fT")) W /CUP(BSY1(BS0),BSX1(BS0)),$C(27),"[0J" Q
 .W $$atr^%ZAPM.ed.BS3(0) F i=BSY1(BS0):1:BSY2(BS0) W /CUP(i,BSX1(BS0)),$J("",BSX2(BS0)-BSX1(BS0)+1)
 Q
MENUU() ;ТИТУЛ МЕНЮ
 I $G(%BS(38))="" Q $E($ZV,1,28)
 Q $E("Работает: "_$G(%BS(38)),1,28)
MENU I '$D(ColrMenu) G UNDOMENU^%ZAPM.ed.BSF11
 W $$atr^%ZAPM.ed.BS3(ColrMenu),/CUP(2,3),$$MENUU()," ",$$WEEKEND^%ZAPM.ed.BSsFUNR(1,$$h^%ZAPM.ed.BS3())," ",$$ESDAY^%ZAPM.ed.BSsFUNR(8,$$h^%ZAPM.ed.BS3())," %BS Version ",+^%ZAPM.ed.BS," " Q
RAM(Y1,X1,Y2,X2,RA,COLOR) W $$atr^%ZAPM.ed.BS3(COLOR) S ii=$S(RA=1!(RA=""):"-----|",RA=2:"=====|",RA=" ":"      ",1:"§§§§§§")
 W /CUP(Y1,X1),$E(ii,1),$TR($J("",X2-X1-1)," ",$E(ii,2)),$E(ii,3)
 F i=Y1+1:1:Y2-1 W /CUP(i,X1),$E(ii,6),$J("",X2-X1-1),$E(ii,6)
 W /CUP(Y2,X1),$E(ii,4),$TR($J("",X2-X1-1)," ",$E(ii,2)),$E(ii,5) Q
P I $ZE'["<PRO" S ls=$ZE D O^%ZAPM.ed.BSF7 S $ZT=$G(%zT) Q
 S $ZT=$G(%zT) G GO
STOP D O^%ZAPM.ed.BSF7 S d="",R1=27,ny=1 G END^%ZAPM.ed.BSF
PRO S ls=$$ErrSay^%ZAPM.ed.BSF8($ZE) G STOP
STA ;ВОССТАНОВЛЕНИЕ ПО "STATUS ME"
 S $ZT="PRO^%ZAPM.ed.BST"
 G %:'$D(@(BSR_"(BST,""STA"")")) S S=^("STA"),STATUS=BST,zr=$ZR
 S BS0=0,BSX(BS0)=$P(S,"@",3),BSY(BS0)=$P(S,"@",2),MX=$P(S,"@",8),MY=$P(S,"@",7) I $D(%BS)["0" D CLr^%ZAPM.ed.BSF4
 G %
DoBSX D L^%ZAPM.ed.BS3($NA(@BSR@(BST))),^%ZAPM.ed.BSX("TEXT",BSR,BST),U^%ZAPM.ed.BS3($NA(@BSR@(BST))),U^%ZAPM.ed.BS3($NA(@BSR@("@"_BST))) q
IN(%w) ;ВХОД ПО ПОЛНОЙ ССЫЛКЕ ИЗ BSN
]]></Routine>


<Routine name="%ZAPM.ed.BST1" type="MAC" languagemode="0"><![CDATA[
%BST1 ;ПАРОЛИ И КЛЮЧИ (ПОДПРОГРАММА) ; 15:50   15.04.2003
PASS D PASCHECK^%ZAPM.ed.BS1(BSR,BST,2," Введите пароль входа в таблицу:"_BSR_","_BST_" ","PASS") Q
PASE  I $ZV["Cach"||($ZV["IRIS") S %w(4)="" Q  ;```
 S i1=1,sys=$P($$ZU^%ZAPM.ed.BS3(0),",",2),uc=$P($$ZU^%ZAPM.ed.BS3(0),",") D  I uc="N" S ls=" Пользователю "_%BS(12)_" КОРРЕКТИРОВАТЬ ДАННЫЕ НЕЛЬЗЯ " D O^%ZAPM.ed.BSF7 X "I 0" Q
 .I %BS(12)'="",'$D(@%BS(18)@(%BS(37),"*")),'$D(@%BS(18)@(%BS(37),sys,"*")),'$D(@%BS(18)@(%BS(37),sys,uc,"*")),'$D(@%BS(18)@(%BS(37),sys,uc,"*")),$G(@%BS(18)@(%BS(37),sys,uc,$P(BSR,$S(BSR["]":"]",1:"^"),2),BST,"4,2"))="N" S uc="N"
 I $P(@(BSR_"(BST)"),"@",4)="" S %w(4)="" I 1 Q
PSE D PASCHECK^%ZAPM.ed.BS1(BSR,BST,4," Введите пароль коррекции описания таблицы:"_BSR_","_BST_" ","%w(4)") Q
PASD  I $ZV["Cach"||($ZV["IRIS") S %w(5)="" Q  ;```
 S i1=1,sys=$P($$ZU^%ZAPM.ed.BS3(0),",",2),uc=$P($$ZU^%ZAPM.ed.BS3(0),",") D  I uc="N" S ls=" Пользователю "_%BS(12)_" КОРРЕКТИРОВАТЬ ДАННЫЕ НЕЛЬЗЯ " D O^%ZAPM.ed.BSF7 X "I 0" Q
 .I %BS(12)'="",'$D(@%BS(18)@(%BS(37),"*")),'$D(@%BS(18)@(%BS(37),sys,"*")),'$D(@%BS(18)@(%BS(37),sys,uc,"*")),'$D(@%BS(18)@(%BS(37),sys,uc,"*")),$G(@%BS(18)@(%BS(37),sys,uc,$P(BSR,$S(BSR["]":"]",1:"^"),2),BST,"3,2"))="N" S uc="N"
 I $P(@(BSR_"(BST)"),"@",5)="" S %w(5)="" I 1 Q
PSD D PASCHECK^%ZAPM.ed.BS1(BSR,BST,5," Введите пароль коррекции данных таблицы:"_BSR_","_BST_" ","%w(5)") Q
PASDD  I $ZV["Cach"||($ZV["IRIS") S %w(3)="" Q  ;```
 S i1=1,sys=$P($$ZU^%ZAPM.ed.BS3(0),",",2),uc=$P($$ZU^%ZAPM.ed.BS3(0),","),BSr=$P(IMQ,",",1,$L(IMQ,",")-1),BSt=$P(IMQ,",",$L(IMQ,","))
 D  I uc="N" S ls=" Пользователю "_%BS(12)_" КОРРЕКТИРОВАТЬ ДАННЫЕ НЕЛЬЗЯ " D O^%ZAPM.ed.BSF7 X "I 0" Q
 .I %BS(12)'="",'$D(@%BS(18)@(%BS(37),"*")),'$D(@%BS(18)@(%BS(37),sys,"*")),'$D(@%BS(18)@(%BS(37),sys,uc,"*")),'$D(@%BS(18)@(%BS(37),sys,uc,"*")),$G(@%BS(18)@(%BS(37),sys,uc,$P(BSr,$S(BSr["]":"]",1:"^"),2),BSt,"3,2"))="N" S uc="N"
 I $P(@(BSr_"(BSt)"),"@",5)="" S %w(3)="" I 1 Q
PSDD D PASCHECK^%ZAPM.ed.BS1(BSr,BSt,5," Введите пароль коррекции данных таблицы:"_BSr_","_BSt_" ","%w(3)") Q
RED W /CUP(24,1),/EL(0),$$atr^%ZAPM.ed.BS3("37;41") Q
CLE W $$atr^%ZAPM.ed.BS3(0) Q
KEY S BSD=$$KBD^%ZAPM.ed.BSF12($NA(@BSR@(BST))) I $G(%BS("Tmp","AKBD",BSD),"RWD")="NONE" D ErrMsg^%ZAPM.ed.BSXfun("ДЛЯ ПОЛЬЗОВАТЕЛЯ `"_$G(%BS(12))_"` БАЗА ДАННЫХ "_BSD_" НЕ ДОСТУПНА !") Q
 S IMQ=BSR_","_BST,Bsr=BSR,Bst=BST K NOKEY,%KEYS,NAZAD N Hid,Hidd
 F key=0:1:13 K ^%ZAPM.ed.BSbufB(key_"k"_$G(%BS(3),$P)_$J_"u"_%BS(15)) I $D(@BSR@(BST,"KEY",key)) S endkey=key
 D KW^%ZAPM.ed.BSD1 I $P(@BSR@(BST,"KEY",endkey),"@",6)="HiddenLastKey" D Hidden^%ZAPM.ed.BS2
 F key=0:1:endkey I $D(@(BSR_"(BST,""KEY"",key)")) D KE,MT G:$D(%BS("Tmp","EXIToutBD",IMQ)) ZF G:$D(NAZAD)&('$D(NOKEY)) ZF I key=endkey!($D(NOKEY)) D  S key=key-1 I $D(NOKEY) S NAZAD=1 G ZF
 .F i=0:1:13 S @("k"_i)=$G(%KEYS(i),0)
 .K ^%ZAPM.ed.BSbufB("BB"_$G(%BS(3),$P)_$J_"u"_%BS(15)) I '$D(NOKEY) K CALCFON D BSDvBSB:TIP=2 I $D(CALCFON) Q
 .S imq=IMQ
 .D SI^%ZAPM.ed.BSN N (Hid,Hidd,%BS,vl,%NAm,key,imq,endkey,%zT,%KAT,%File,BSB,BST,BSR,%KEYS,BSD,NOKEY,k0,k1,k2,k3,k4,k5,k6,k7,k8,k9)
 .I "IP"[$G(%BS("Tmp","AKBD",BSD),"RWD") D ErrMsg^%ZAPM.ed.BSXfun("ПОЛЬЗОВАТЕЛЮ `"_$G(%BS(12))_"` ВХОД В КАРТУ БАЗЫ ДАННЫХ ЗАПРЕЩЕН !") Q
 .I '$P(@BSR@(BST),"@",34),'$D(^(BST,"Free")) D L^%ZAPM.ed.BS3($NA(@BSR@(BST))) I 'LOC D ErrMsg^%ZAPM.ed.BSXfun("ТАБЛИЦА ОПИСАНИЯ БАЗЫ ДАННЫХ ЗАНЯТА ДРУГИМ ПОЛЬЗОВАТЕЛЕМ") Q
 .I $D(%BS("Tmp","BSD")),$G(%BS("Tmp","AKBD",BSD),"RWD")'="R" D L^%ZAPM.ed.BS3($NA(@%BS("Tmp","BSD"))) I 'LOC D ErrMsg^%ZAPM.ed.BSXfun("УЗЕЛ БАЗЫ ЗАНЯТ ДРУГИМ ПОЛЬЗОВАТЕЛЕМ") Q
 .D SW("LAST",imq)
 .D KEY^%ZAPM.ed.BST I $D(%BS("Tmp","BSD")) D U^%ZAPM.ed.BS3($NA(@%BS("Tmp","BSD")))
 .D LW("LAST",imq) Q
ZF ;I '$D(Report) S $P(@(Bsr_"(Bst)"),"@",30)=""
 K Bsr,Bst G END^%ZAPM.ed.BSF
MT Q:'$D(MTr)  S (Bsr,BSR)=MTr,(Bst,BST)=MTt K MTr,MTt Q
SW(key,IMQ) D SW^%ZAPM.ed.BSD1(key)
 Q
LW(key,IMQ) D LW^%ZAPM.ed.BSD1(key)
 Q
KE ;ОПРЕДЕЛЕНИЕ КЛЮЧА
 D SI^%ZAPM.ed.BSN N (Hidd,Hid,%BS,vl,Bsr,Bst,MTr,MTt,%zT,%KAT,%File,%NAm,BSD,key,endkey,%KEYS,NAZAD,NOKEY,IMQ) F i=4:1:7,10,13:1:16,20 S @("k"_i)=$P(^(key),"@",i)
 S kt=$G(^(key,3))
 I key=0 D NAMEKEY Q
 D INDKEY Q
NAMEKEY ;ИМЕННОЙ КЛЮЧ
 N ucI S MRMR="W /CUP(23,1),/EL(0),$$clr^%ZAPM.ed.BS3(4),"" <Enter>-ВЫБОР <F4>-РЕДАКТ <F5>-КОПИР <F6>-СЕРВИС <F7>-ТАБ  <F8>-УДАЛ."""
 S BSR="^%ZAPM.ed.BSbufB",BST="0k"_$G(%BS(3),$P)_$J_"u"_%BS(15)
 I $D(^%ZAPM.ed.BSbufB("0k"_$G(%BS(3),$P)_$J_"u"_%BS(15),"STA")) D STA^%ZAPM.ed.BST G NAMKE
 D SW(key,IMQ)  K %BS("Tmp","Find0Key") //ДЛЯ ПОИСКА
 S %zT=$ZT,$ZT="NOSY^%ZAPM.ed.BST1"
 S %NAm=BSD,i=2,kd1=k6[",TIME" D K5^%ZAPM.ed.BST4
 K ^%ZAPM.ed.BSbufB("0k"_$G(%BS(3),$P)_$J_"u"_%BS(15)),ii3 I k7'="",$$TAB^%ZAPM.ed.BSD1($ZR,k7) G IK7
 D HEAD($ZR) S ^%ZAPM.ed.BSbufB("0k"_$G(%BS(3),$P)_$J_"u"_%BS(15),1,1)="@@1@70@@@@@1@"_$P(%BS,"!",4)_"@@@@@ .. k"_key_" "_BSD
 S ^%ZAPM.ed.BSbufB("0k"_$G(%BS(3),$P)_$J_"u"_%BS(15),2,1)="@@"_k6_"@@@@@1@"_k10_"@@@@@ "_$S(k5'="":k5,1:"НОВЫЙ ИМЕННОЙ КЛЮЧ")
IK7 I kt'="" S ^%ZAPM.ed.BSbufB("0k"_$G(%BS(3),$P)_$J_"u"_%BS(15),3,1)=@$ZR,i=i+1,$P(@$ZR,"@",3)="",$P(@$ZR,"@",8)=0,^%ZAPM.ed.BSbufB("0k"_$G(%BS(3),$P)_$J_"u"_%BS(15),"FTR",3,1)=kt,kt1="3,1" D:kd1
 .S @$ZR=@$ZR_" I $P(BS,""@"",19)'="""" S kd=$S($P(BS,""@"",19):$$ESDAY^%ZAPM.ed.BSsFUNR(9,$P($P(BS,""@"",19),"","",1,2)),1:$P(BS,""@"",19)),d1=d1_$J("""",$P(BS,""@"",4)-$L(d1)-22)_kd_"" ""_$P($P(BS,""@"",19),"","",3)"
 I k7="" S LineT="@@"_k6_"@@@@"_$G(kt1)_"@1@"_k10_"@@@@@"
 I $ZV["Cach"||($ZV["IRIS") D CLO^%ZAPM.ed.BSCp,OPO^%ZAPM.ed.BSCp
 I $ZV["MSM" S ucI=$$ZU^%ZAPM.ed.BS3(0) D PEREXOD^%ZAPM.ed.BSF12(%NAm)
 F  S %NAm=$$OBD^%ZAPM.ed.BSD1(%NAm) Q:%NAm=""
 I $ZV["MSM" I $$ZU^%ZAPM.ed.BSF4($P(ucI,","),$P(ucI,",",2))
 I $ZV["Cach"||($ZV["IRIS") D CLO^%ZAPM.ed.BSCp,OPO^%ZAPM.ed.BSCp
 I $D(^%ZAPM.ed.BSbufB("0k"_$G(%BS(3),$P)_$J_"u"_%BS(15))) D HEA($ZR)
 I $G(%BS("Tmp","AKBD",BSD),"RWD")="RWN"!($G(%BS("Tmp","AKBD",BSD),"RWD")="R") S $P(^%ZAPM.ed.BSbufB("0k"_$G(%BS(3),$P)_$J_"u"_%BS(15),2,1),"@",3)=""
 S $ZT=$G(%zT) D:'$G(ii3) K3(0) D RESZER^%ZAPM.ed.BSF2,TAB^%ZAPM.ed.BSF1,^%ZAPM.ed.BST
NAMKE I R1=27!(ny=1)!($D(EXIT)) D LW(key,IMQ) K EXIT,^%ZAPM.ed.BSbufB("0k"_$G(%BS(3),$P)_$J_"u"_%BS(15)) S:'$D(%KEYS(key-1)) NAZAD=1 K %KEYS(key-1) S key=key-2 Q
 I ny=2 S li="" D To,NEWKEY0 G:'YES NAMEKEY K ^%ZAPM.ed.BSbufB("0k"_$G(%BS(3),$P)_$J_"u"_%BS(15))
 I k13'="" D MTBD^%ZAPM.ed.BST4 I 'YES S R1=27 G NAMKE
SET S %KEYS(key)=d,%KEYS=key,Tmp=$$BSD^%ZAPM.ed.BSA(BSD,$G(%KEYS(0))) F ii=1:1:key-1 Q:'$D(%KEYS(ii))  S Tmp=Tmp_$S(%KEYS(ii)'=+%KEYS(ii):$C(34)_%KEYS(ii)_$C(34),1:%KEYS(ii))_","
 S %BS("Tmp","BSD")=Tmp_$S(d=+d:d,1:$C(34)_d_$C(34))_")"
 Q
 ;---
NEWKEY0 ;НОВЫЙ ИМЕННОЙ КЛЮЧ
 I "RIP"[$G(%BS("Tmp","AKBD",BSD),"RWD") D ErrMsg^%ZAPM.ed.BSXfun("ПОЛЬЗОВАТЕЛЮ `"_$G(%BS(12))_"` ДАННЫЕ РЕЖИМЫ ЗАПРЕЩЕНЫ !") S li="",YES=0 Q
 S ls=k15,ll="@",li=$G(dat) D 25,LE^%ZAPM.ed.BSTT K dat I 'YES S li="",YES=0 Q
 I "?"[li,k14'="" D KEYTAB,Es G NEWKEY0
 I li="" X "I 0" S YES=0 Q
 S %zT=$ZT,$ZT="ERR^%ZAPM.ed.BST1" D KEYLOG I 'YES G NEWKEY0
 S li=BSD_li I $D(@li) G NEWK0
 S @li=$G(@BSD,"BSD - MSW@"_$G(BSr)_"@"_$G(BSt)) D CP^%ZAPM.ed.BSGCH(li,$P(%BS(22),",",3)) I $E($P(%BS(22),",",3),2)>1 S ^BSdirddp($S(li[",":li,1:$$DDPGL^%ZAPM.ed.BSD1($$ZU^%ZAPM.ed.BS3(0))_$P(li,"^",2)))=""
NEWK0 S d=$P(li,BSD,2),YES=1,$ZT=$G(%zT) I 1 Q
KEYTAB S IYI=k14 D Key,NE^%ZAPM.ed.BSN S li=$G(dat) Q
Key S v=""  F  S v=$O(%KEYS(v)) Q:v=""  S @("Key"_v)=%KEYS(v)
 Q
K3(k) K ^%ZAPM.ed.BSbufB(k_"k"_$G(%BS(3),$P)_$J_"u"_%BS(15),3),^%ZAPM.ed.BSbufB(key_"k"_$G(%BS(3),$P)_$J_"u"_%BS(15),"FTR",3) Q
INDKEY ;ИНДЕКСНЫЙ
 S MRMR="W /CUP(23,1),/EL(0),$$clr^%ZAPM.ed.BS3(4),"" <Enter>-Select "_$S('$$Tree():"<F3>-Password",1:"")_" <F4>-Edit"_$S('$$Tree():"",1:"АКТИР.УЗЕЛ")_" <F5>-Copy <F6>-Service "_$S('$$Tree():"<F7>-Tab",1:"")_" <F8>-Del."""
 S kd1=k6["TIME" D K5^%ZAPM.ed.BST4
 S BSR="^%ZAPM.ed.BSbufB",BST=key_"k"_$G(%BS(3),$P)_$J_"u"_%BS(15)
 I $D(^%ZAPM.ed.BSbufB(key_"k"_$G(%BS(3),$P)_$J_"u"_%BS(15),"STA")) D STA^%ZAPM.ed.BST G INDKE
 S %IND="",i=3,%NAm=$$BSD^%ZAPM.ed.BSA(BSD,$G(%KEYS(0)))
 F ii=1:1:key-1 Q:'$D(%KEYS(ii))  S %NAm=%NAm_$S(%KEYS(ii)'=+%KEYS(ii):$C(34)_%KEYS(ii)_$C(34),1:%KEYS(ii))_","
 D SW(key,IMQ)
 S %zT=$ZT,$ZT="NOSY^%ZAPM.ed.BST1"
 I $D(@(%NAm_"""@%BS"")")) D PBD^%ZAPM.ed.BST4 S R1=27 G INDKE
 I $D(@(%NAm_"""@PASSWORD"")")) I '$$CHECK^%ZAPM.ed.BSF7($ZR) S R1=27,ny=1 G INDKE
 K ^%ZAPM.ed.BSbufB(key_"k"_$G(%BS(3),$P)_$J_"u"_%BS(15)),ii3 I k7'="",$$TAB^%ZAPM.ed.BSD1($ZR,k7) G FoK
 D HEAD($ZR) S ^%ZAPM.ed.BSbufB(key_"k"_$G(%BS(3),$P)_$J_"u"_%BS(15),1,1)="@@1@70@@@@@1@"_$P(%BS,"!",4)_"@@@@@ .. k"_key_" "_%NAm
 S ^%ZAPM.ed.BSbufB(key_"k"_$G(%BS(3),$P)_$J_"u"_%BS(15),2,1)="@@"_k6_"@@@@@1@"_k10_"@@@@@ "_$S(k5'="":k5,1:"НОВЫЙ "_key_"-Й ИНДЕКСНЫЙ КЛЮЧ")
 I $G(%BS("Tmp","AKBD",BSD),"RWD")="RWN"!($G(%BS("Tmp","AKBD",BSD),"RWD")="R") S $P(^%ZAPM.ed.BSbufB(key_"k"_$G(%BS(3),$P)_$J_"u"_%BS(15),2,1),"@",3)=""
NK7 I kt'="" S ^%ZAPM.ed.BSbufB(key_"k"_$G(%BS(3),$P)_$J_"u"_%BS(15),3,1)=@$ZR,$P(@$ZR,"@",3)="",$P(@$ZR,"@",8)=0,^%ZAPM.ed.BSbufB(key_"k"_$G(%BS(3),$P)_$J_"u"_%BS(15),"FTR",3,1)=kt,kt1="3,1" D:kd1
 .S @$ZR=@$ZR_" I $P(BS,""@"",19)'="""" S d1=d1_$$KeyTime^%ZAPM.ed.BSsFUNR(BS)"
 I k7="" S LineT="@@"_k6_"@@@@"_$G(kt1)_"@1@"_k10_"@@@@@",^%ZAPM.ed.BSbufB(key_"k"_$G(%BS(3),$P)_$J_"u"_%BS(15),3,1)=LineT,$P(@$ZR,"@",3)="",$P(@$ZR,"@",8)=0
FoK D Wait^%ZAPM.ed.BSXfun("формирование ключей")
 F  S %IND=$O(@(%NAm_"%IND)")) Q:%IND=""  I %IND'["@" S i=i+1,ii=%IND,^%ZAPM.ed.BSbufB(key_"k"_$G(%BS(3),$P)_$J_"u"_%BS(15),i,1)=LineT_ii_"@@@@"_$G(@(%NAm_"%IND)")),ii3=1 X:'(i#20) $G(WA)
 I $D(^%ZAPM.ed.BSbufB(key_"k"_$G(%BS(3),$P)_$J_"u"_%BS(15))) D HEA($ZR)
 S $ZT=$G(%zT) D:'$G(ii3) K3(key) D TAB^%ZAPM.ed.BSF1,^%ZAPM.ed.BST
INDKE I R1=27!(ny=1)!($D(EXIT)) D LW(key,IMQ) K EXIT,^%ZAPM.ed.BSbufB(key_"k"_$G(%BS(3),$P)_$J_"u"_%BS(15)) S:'$D(%KEYS(key-1)) NAZAD=1 K %KEYS(key-1) S key=key-2 Q
 I ny=2 S li="" D To,NEWKEY1 G:'YES INDKEY K ^%ZAPM.ed.BSbufB(key_"k"_$G(%BS(3),$P)_$J_"u"_%BS(15))
 I k13'="" D MTBD^%ZAPM.ed.BST4 G INDKEY:$G(KEYPAS) I 'YES S R1=27 G INDKE
 G SET
NOSY I $ZE["<PROT"!($ZE["<NOUCI")!($ZE["<NOSYS") S ls=" НЕДОСТУПНА БАЗА ДАННЫХ "_BSD G NOS
 S ls=$ZE
NOS D O^%ZAPM.ed.BSF7 S NOKEY=1,$ZT=$G(%zT) Q
To S Date2Lin=d Q
Es I dat=$G(Date2Lin) S dat=""
 Q
NEWKEY1 ;НОВЫЙ ИНДЕКСНЫЙ КЛЮЧ
 I "RIP"[$G(%BS("Tmp","AKBD",BSD),"RWD") D ErrMsg^%ZAPM.ed.BSXfun("ПОЛЬЗОВАТЕЛЮ `"_$G(%BS(12))_"` ДАННЫЕ РЕЖИМЫ ЗАПРЕЩЕНЫ !") S li="",YES=0 Q
 S ls=k15,ll="@""",li=$G(dat) D 25,LE^%ZAPM.ed.BSTT K dat I 'YES S li="",YES=0 Q
 I "?"[li,k14'="" D KEYTAB,Es G NEWKEY1
 I li="" X "I 0" S YES=0 Q
 S %zT=$ZT,$ZT="ERR^%ZAPM.ed.BST1"
 D KEYLOG G:'YES NEWKEY1
 S $ZT=$G(%zT),d=li Q
25 W /CUP(25,1),$$atr^%ZAPM.ed.BS3(0),/EL(0),ls Q
D G 0^%ZAPM.ed.BSTM
HEA(G) S se=i,ke=1,$P(@G,"@",28)=i Q
HEAD(G) N Ui S @G="@@@@@@@1@1@22@80@X MRMR@1@@%FKR^%ZAPM.ed.BST1@1@1",$P(@$ZR,"@",25)=1,$P(@$ZR,"@",28)=i,$P(@$ZR,"@",39)=$S(k20="":"^%ZAPM.ed.BSHLP(KEY_BD",1:k20),se=i,ke=1
 S Ui=$P($$IYI^%ZAPM.ed.BSF10(IMQ),"@",41) I Ui["TreeCopy^%ZAPM.ed.BSF10" Q
 S $P(@G,"@",41)="TreeCopy^%ZAPM.ed.BSF10"_$S(Ui'="":","_Ui,1:"")
 Q
KEYLOG ;ПРОВЕРКА ЛОГИКИ
 S BSr=$P(IMQ,",",1,$L(IMQ,",")-1),BSt=$P(IMQ,",",$L(IMQ,",")) Q:$P(@(BSr_"(BSt,""KEY"",key)"),"@",16)=""  S ls="СИНТАКСИЧЕСКАЯ ОШИБКА",lo=$G(^(key,1)),(d,d0,d1)=li K %0,YES X lo S:'$D(YES) YES=$T S:YES li=$G(%0,li) I 'YES D  D O^%ZAPM.ed.BSF7 Q
 Q
%FKR K EXIT ;F-КЛАВИШИ ДЛЯ КЛЮЧЕЙ БАЗ ДАННЫХ
 S %iii=d I R3=89 D ZF ZT "F10"
 I "RIP"[$G(%BS("Tmp","AKBD",BSD),"RWD") D ErrMsg^%ZAPM.ed.BSXfun("ПОЛЬЗОВАТЕЛЮ `"_$G(%BS(12))_"` ДАННЫЕ РЕЖИМЫ ЗАПРЕЩЕНЫ !") G D
 I R3=87 G D:ny<3 K %w(3) D  K AllWAY Q:$D(EXIT)  G D ;F8
 .I $G(%BS("Tmp","AKBD",BSD),"RWD")'="RWD" D ErrMsg^%ZAPM.ed.BSXfun("ПОЛЬЗОВАТЕЛЮ `"_$G(%BS(12))_"` УДАЛЯТЬ УЗЛЫ БАЗЫ ДАННЫХ "_BSD_" НЕЛЬЗЯ !") Q
 .K AllWAY I $D(%DIA) S do="I i>2 S %iii=$P(^(j),""@"",15) I %iii'="""" D DELU^%ZAPM.ed.BST1" D BLOK^%ZAPM.ed.BSF1 Q
 .D DELU Q
 I R3=82,'$$Tree(),'$$PROT() G D:ny<3 D PASS^%ZAPM.ed.BSF7(BSD,.%KEYS) G D ;PASSWORD
 I R3=83,$$Tree() D EDIT^%ZAPM.ed.BSTREE G D ;РЕДАКТИРОВАНИЕ УЗЛА
 I R3=83,'$$PROT() S NOKEY=1,R1=27 Q  ;БЕЗ КЛЮЧЕЙ F4
 I R3=84 G COPY^%ZAPM.ed.BSBD ;SAVE.REST
 I R3=85 G SERV^%ZAPM.ed.BSF5 ;СУММА,КОПИР,ПОИСК,ПЕРЕЗАПИСЬ...
 I R3=86,'$$Tree(),'$$PROT() D TAB^%ZAPM.ed.BST4 Q  ;ПРИКРЕПЛЕННЫЕ ТАБЛИЦЫ
 G D
PROT() I $G(%BS("Tmp","AKBD",BSD),"RWD")'="RWD" D ErrMsg^%ZAPM.ed.BSXfun("ПОЛЬЗОВАТЕЛЮ `"_$G(%BS(12))_"` ДАННЫЕ РЕЖИМЫ ЗАПРЕЩЕНЫ !") Q 1
 Q 0
Tree() I $G(Bsr)["BSVOL",$G(Bst)="TREE" Q 1 ;;ДЛЯ РЕДАКТИРОВАНИЯ ^%ZAPM.ed.BSVOL(TREE
 Q 0 ;F5 ДЛЯ РЕДАКТОРА МАССИВОВ
DELU I '$D(%w(3)) D PASDD^%ZAPM.ed.BST1 E  Q
 S %NAm=$$BSD^%ZAPM.ed.BSA(BSD,$G(%KEYS(0))) F ii=1:1:key-1 Q:'$D(%KEYS(ii))  S %NAm=%NAm_$S(%KEYS(ii)=+%KEYS(ii):%KEYS(ii),1:$C(34)_%KEYS(ii)_$C(34))_","
 I key=0 S %NAm=BSD_%iii G DEL
 S %NAm=%NAm_$S(%iii=+%iii:%iii,1:$C(34)_%iii_$C(34))_")"
DEL I '$D(%DIA) S ls=" Удалить :"_%NAm_",Вы уверены ? ",%B=2 D YES^%ZAPM.ed.BSF I 'YES Q
 I $D(%DIA),'$G(AllWAY) D MENU^%ZAPM.ed.BSF5(" УДАЛИТЬ НЕ_УДАЛЯТЬ УДАЛИТЬ_ВСЕ_СРАЗУ ВЫХОД ","  УЗЕЛ "_%NAm_"  ",1) Q:(R1=27&(R2=-1))!(%B=2)  S:%B=3 AllWAY=1 I %B=4 S EndLoop=1 Q
 D L^%ZAPM.ed.BS3(%NAm) D DEL^%ZAPM.ed.BSF10($NA(@%NAm),2) D U^%ZAPM.ed.BS3(%NAm) S EXIT=1 Q
ERR I $ZE["<PROT" S ls=$ZE_" "_$$ErrSay^%ZAPM.ed.BSF8($ZE)
 D O^%ZAPM.ed.BSF7 X "I 0" S YES=0,$ZT=$G(%zT) Q
BSDvBSB S ls="Формирутся БУФЕР базы данных" D WAITS^%ZAPM.ed.BSF2 d gb
gBuf D %NAm //BD 2 BUF
BSDv K @gBuf
 I $D(Hidd) D Hidd^%ZAPM.ed.BS2
 D FOR^%ZAPM.ed.BSF3 X I_" D BSD" Q
 ;
 ;ЗАПИСЬ В Б.Д.
BSDAT(N,H) S N=$E(N,1,$L(N)-1)_")" I $D(@N@(H))
 Q $T
BSD Q:$P($G(@BSR@(BST,ny,nx)),"@",9)<2  d gb
 I $D(Hid) D  Q
 .Q:$P($P(^(nx),"@",18),"#",2)=""  S nynx=$P($P(^(nx),"@",18),"#",2)
 .Q:'$D(@Hid@(ny))  I $$BSDAT(%NAm,@Hid@(ny)),$G(@$ZR@(nynx))'="" S @gBuf@(ny,nx)=@$ZR
 I $P($P(^(nx),"@",18),"#")'="" S nynx=$P($P(^(nx),"@",18),"#")
 E  S nynx=ny_","_nx
 I $G(@(%NAm_"nynx)"))'="" S @gBuf@(ny,nx)=@$ZR
 Q
gb i '$d(gBuf) S gBuf=$NA(^%ZAPM.ed.BSbufB("BB"_$G(%BS(3),$P)_$J_"u"_%BS(15)))
 q
%NAm S %NAm=$$BSD^%ZAPM.ed.BSA(BSD,$G(%KEYS(0))) F ii=1:1:%KEYS Q:'$D(%KEYS(ii))  S %NAm=%NAm_$S(%KEYS(ii)=+%KEYS(ii):%KEYS(ii),1:$C(34)_%KEYS(ii)_$C(34))_","
 Q
v(N) Q $G(%BS("v",N))
]]></Routine>


<Routine name="%ZAPM.ed.BST132" type="MAC" languagemode="0"><![CDATA[
%BST132 ;ВХОД В ТАБЛИЦУ ; 11:16   03.10.2000
 W $$atr^%ZAPM.ed.BS3(0) //I $ZV'["Cach"&&($ZV'["IRIS") U 0:(0::::#10080)
 I $P($ZV,"Version ",2)<4 W $$clear^%ZAPM.ed.BS3
 K STATUS D SI^%ZAPM.ed.BSN I $D(%BS)["0" D CLr^%ZAPM.ed.BSF4
 ;N S,STATUS,VYC,BS0,BSX,BSY,B,BX,BY,BS1,BS2,MX,MY,x,t,zr,t1,%VDB,%CAL,%X1,%X2,%Y1,%Y2,%TIT,MR,%w(2),M1,BS,%w(4),%w(5),%DIA,%DI,%ZAP,%FK,i,j,ii,jj,se,ke,j1,j2,j3,MX,MY,M,BS1,BS2,BSF,BSX1,BSX2,BSY1
 ;N BSY2,CLR,ENDLI,BSI,BSII,MR23,MR24,MR25,NAZAD,li,ls,lo,COLOR
 ;N RA,PREDMOV,MxX,MyY,My,Mx,COLOR,EXITout,%FN,%DEV,%Cu,es,ek,h,hi,hl,%INV,%INV1,%INV2,v,vv,vvv,TIP,%FK,%ZAP,%VDB,MOV
 S $ZT="PRO^%ZAPM.ed.BST132"
% K PredOb I '$D(@BSR@(BST))!($$TIP^%ZAPM.ed.BS($P($G(@BSR@(BST)),"@",17))["!!!") S ls="ОБЪЕКТ ~"_BST_" В РАЗДЕЛЕ "_BSR_" НЕ ОПОЗНАН " G STOP
 S $ZT=$G(%zT) I $P(@$ZR,"@",39) Q  ;D Enter^%ZAPM.ed.BSGTab($ZR) Q  ;%BS Gamma Version
 I ($P($$ZU^%ZAPM.ed.BS3(1,0),",",2)_$G(%BS(3),$P)_$J_"i"_$G(%BS(12)))'[$P(@$ZR,"@",30) S ls=" ТАБЛИЦА ЗАНЯТА ПОЛЬЗОВАТЕЛЕМ "_$P(@$ZR,"@",30) D  G STOP
 .D Yes^%ZAPM.ed.BSXfun(" СНИМЕМ ЗАКРЫТИЕ ???",2) I YES D L^%ZAPM.ed.BS3($NA(@BSR@(BST))) I LOC S $P(@BSR@(BST),"@",30)="" D U^%ZAPM.ed.BS3($NA(@BSR@(BST)))
 I BSR'["," S BSR=$$BSR^%ZAPM.ed.BSA(BSR)
 I $P(@$ZR,"@",37) D CHECK^%ZAPM.ed.BSH I 'YES G STOP
 D TIPP I '$D(%w(2)) D PASS^%ZAPM.ed.BST1 E  G END^%ZAPM.ed.BSF
 G DoBSX:TIP=5,DoLINK^%ZAPM.ed.BSF13:TIP=6,DoButt^%ZAPM.ed.BSF8:TIP=8
GOO I $E(%BS(1),20),%BS(12)="" D  H
 .S BSR="^%ZAPM.ed.BSS",BST="LOGON" D ^%ZAPM.ed.BST,Echo^%ZAPM.ed.BSXfun(1) D:d=2 SS^%ZAPM.ed.BSD2 Q:d<0
GO I $D(@(BSR_"(BST,""KEY"")")) D KEY^%ZAPM.ed.BST1:TIP=2,^%ZAPM.ed.BST2:TIP=3!(TIP=4) Q:'$D(F4)
 I '$D(@(BSR_"(BST,""KEY"")")),'$P(B,"@",34) D L^%ZAPM.ed.BS3($NA(@BSR@(BST))) G:'LOC STOP
KEY I '$D(STATUS) S BS0=0,(BSX(BS0),BSY(BS0))=1,(BSX1(BS0),BSY1(BS0))=1,BSX2(BS0)=79,BSY2(BS0)=22
 W $$setkod^%ZAPM.ed.BS3 D LOCK^%ZAPM.ed.BSF4 D TIP
WRITE I $G(@BSR@(BST,"RSM"))'="" D XM^%ZAPM.ed.BSre(@$ZR) ;ВЫПОЛНИТЬ КОМАНДУ ВОССТАНОВЛЕИЯ
 I $D(@BSR@(BST,"FCL")) D CALC^%ZAPM.ed.BSF3
 I $P(@BSR@(BST),"@",47) D CHECKF^%ZAPM.ed.BSF10($P(@BSR@(BST),"@",47)) ;АВТОФОРМАТ
 I $P(@BSR@(BST),"@",24) D UNPRESS^%ZAPM.ed.BSSR I '$P(B,"@",24) G Wr
 I $P(@BSR@(BST),"@",51) D PRESAUTO^%ZAPM.ed.BSSR($P(@BSR@(BST),"@",51)) ;АВТОПОДЖАТИЕ
Wr I $P(B,"@",41)'="" S R1=333 D Pred^%ZAPM.ed.BSF12($P(B,"@",41)) ;ПРЕДОБР.ПОСЛЕ ВЫЧИСЛЕНИЯ
 D TIT
WRI //I $ZV'["Cach"&&($ZV'["IRIS") U 0:(0::::#10080)
 S ls="ЗАГРУЗКА" D WAITS132,W,MR K %VDB S $ZT=$G(%zT) G ^%ZAPM.ed.BST132M
VW D VT,W Q
GW D GT,W Q
TW D VT,GT,W Q
WAITS132 S WA="" Q:$G(TIP)=7&($G(BST)'["@")  Q:$D(%BS)["0"  Q:$G(CALCFON)
 ;U $I:(0::::#10080)
 W /CUP(47,1),$$atr^%ZAPM.ed.BS3(0),/EL(0),$$clr^%ZAPM.ed.BS3(12),"...",$E(ls,1,117),"...",$$atr^%ZAPM.ed.BS3(0)
WAI S WAI=0,WA="S WAI=WAI+1 I '(WAI#2) W $$atr^%ZAPM.ed.BS3(0),/CUP(47,"_($L($E($G(ls),1,117))+7)_"),WAI" W /CUP(148,1),/EL(0)
 Q
W I $G(Mx,0)'=0!($G(My,0)'=0),%BS(13)="%BS-PC",$ZV'["Windows" G ^%ZAPM.ed.BST5
MOV D:'$D(%VDB) CLEA K BS1,BS2,BY,BX S %BSTM=0
 K ENDDN S BSI=BSY(BS0)-1 F  S BSI=$O(@(BSR_"(BST,BSI)")) Q:'BSI  S BS(1)=1 I $P(@(BSR_"(BST,BSI,1)"),"@",3) D  Q:$D(ENDDN)
 .K ENDRI S BSII=BSX(BS0)-1 F  S BSII=$O(@(BSR_"(BST,BSI,BSII)")) Q:BSII=""  D WR I $D(ENDRI)!($D(ENDDN)) S BS(2)=0 Q
e Q
TRANS(BSR,BST,BS,BSI,BSII) N TranS,ny,nx,d,d0 S TranS=1 G TRAN
WR W $$atr^%ZAPM.ed.BS3(0) S CLR=COLOR I $D(@(BSR_"(BST,BSI,BSII)")) S BS=^(BSII) Q:'$P(BS,"@",4)  I '$D(BS1) S BS1=$P(BS,"@")+1,BS2=$P(BS,"@",2)+1 I 'BS0 S (BS(1),BS(2))=1
 I (($P(BS,"@")+$P(BS,"@",3)-2)-BS1+2+BSY1(BS0))>BSY2(BS0) S ENDDN=1 Q
 I (($P(BS,"@",2)+$P(BS,"@",4)-2)-BS2+2+BSX1(BS0))>BSX2(BS0) S ENDRI=1 Q
 I $P(BS,"@",10) S CLR=$P(BS,"@",10) I $E(%BS(1),19) S CLR=$P(%BS,"!",$E(%BS(1),19))
 I $P(BS,"@",12) S CLR=$P(%BS,"!",3)
TRAN I $P(BS,"@",9)=1 S (d,d1,d0)=$P(BS,"@",15)
 E  S (d,d1,d0)=$G(^%ZAPM.ed.BSbufB("BB"_$G(%BS(3),$P)_$J_"u"_%BS(15),BSI,BSII))
 I $P(BS,"@",8)'="" S %zT=$ZT,$ZT="FFF^%ZAPM.ed.BST132" D  S $ZT=$G(%zT)
 .I d0="" S d0=0
 .S ny=BSI,nx=BSII I '$P(BS,"@",8) X $G(@BSR@(BST,"FTR",BSI,BSII)) Q
 .X $G(@(BSR_"(BST,""FTR"","_$P(BS,"@",8)_")"))
 I $D(TranS) Q
w I '$D(%VDB) S l=$J("",$P(BS,"@",3)*$P(BS,"@",4)) F BSF=1:1:$P(BS,"@",3) Q:($P(BS,"@")+BSF-BS1)>BSY2(BS0)  D  W $E(d1_l,BSF*$P(BS,"@",4)-$P(BS,"@",4)+1,$P(BS,"@",4)+($P(BS,"@",4)*(BSF-1)))
 .W /CUP(($P(BS,"@")+BSF-BS1+BSY1(BS0)),($P(BS,"@",2)-BS2+1+BSX1(BS0))),$$atr^%ZAPM.ed.BS3(CLR) Q
 Q:BS0  I BS(1) S BY($P(BS,"@")-BS1+1+BSY1(0))=BSI,BS(1)=0
 I BS(2) S BX($P(BS,"@",2)-BS2+1+BSX1(0))=BSII
 Q
VT Q:'$D(%TIT)  S BS0=2,BSY(BS0)=BSY(0) D W S BS0=0 Q
GT Q:'$D(%TIT)  S BS0=1,BSX(BS0)=BSX(0) D W S BS0=0 Q
MR K %FK,%ZAP N i F i=12:1:14 S @("MR"_(i+11))="" I $P(@(BSR_"(BST)"),"@",i)'="" D
 .I $P(^(BST),"@",i)=1 S @("MR"_(i+11))="D MR"_(i+11) Q
 .S @("MR"_(i+11))=$P(^(BST),"@",i)
 K %fk I $P(^(BST),"@",15)'="" S %FK=$P(^(BST),"@",15)
 I $P(^(BST),"@",16) S %ZAP=1
 I TIP=2,$G(%BS("Tmp","AKBD",BSD),"RWD")="R" S %ZAP=1
 Q
TIPP S B=@(BSR_"(BST)") S TIP=$P(B,"@",17) S:TIP="" TIP=1 D ENTERPAS^%ZAPM.ed.BSF7(B) Q
TIP S:'$D(%Co) %Co=0 S B=@(BSR_"(BST)") S:$P(B,"@",3) %DIA=1 S:$P(B,"@",20) %CAL=$P(B,"@",20) S TIP=$P(B,"@",17) S:TIP="" TIP=1 D ENTERPAS^%ZAPM.ed.BSF7(B) S COLOR=$S($E(%BS(1),19):$P(%BS,"!",$E(%BS(1),19)),1:$P(B,"@",31)) I COLOR="" S COLOR=0
 S %Cu=$S($G(TIP)=7:"D KL","1"[$P(B,"@",25):"D KL",1:"D 24") K Ukaz I $P(B,"@",43) S Ukaz=1
 I $P(B,"@",46)'="",'$D(ObOi) D OBWRITE^%ZAPM.ed.BSF10
 S:$G(%BS(15))<1 %BS(15)=0 S se=$P(B,"@",28),ke=$P(B,"@",29) S Mouse=$S(ke=1:1,1:"") I $P(B,"@",38),'$D(RA) S RA=$P(B,"@",38) D Ramka^%ZAPM.ed.BSXfun($P(B,"@",8)-1,$P(B,"@",9)-1,$P(B,"@",10)+1,$P(B,"@",11)+1,RA,COLOR,1)
 S POSt=%BS(16) I $P(B,"@",44)'="" S POSt=$P(B,"@",44)
 I $P(B,"@",41)'="" S PredOb=$P(B,"@",41)
 I $D(BSR) D PST^%ZAPM.ed.BSD1(BSR)
 I TIP=2,$D(BSD),$G(%BS("Tmp","AKBD",BSD),"RWD")="R" S %ZAP=1
 Q
TIT I $P(@(BSR_"(BST)"),"@",19) S %TIT=$P(^(BST),"@",19) K:'$D(@(BSR_"(BST,"_%TIT_")")) %TIT
 E  K %TIT
 I $D(@BSR@(BST)) D  ;
 .I '$D(%TIT) S BS0=0,BSY1(0)=$P(^(BST),"@",8),BSX1(0)=$P(^(BST),"@",9),BSY2(0)=$P(^(BST),"@",10),BSX2(0)=$P(^(BST),"@",11) D:$E($G(%BS(14)),2) TRM Q
 .S BS0=0,BSY2(BS0)=+$P(^(BST),"@",10),BSX2(BS0)=+$P(^(BST),"@",11) D  S BSY1(BS0)=$P(@(BSR_"(BST,"_%TIT_")"),"@")+BSY1(0)-1,BSX1(BS0)=$P(@$ZR,"@",2)+BSX1(0)-1 I $G(STATUS)'=BST S BSY(0)=+$P(%TIT,","),BSX(0)=+$P(%TIT,",",2),STATUS=BST
 ..S BSY1(0)=+$P(^(BST),"@",8),BSX1(0)=+$P(^(BST),"@",9)
 .S BS0=1,(BSY1(3),BSY1(BS0))=+$P($G(@(BSR_"(BST)"),1),"@",8),BSX1(BS0)=BSX1(0),(BSY2(3),BSY2(BS0))=BSY1(0)-1,BSX2(BS0)=+$P(^(BST),"@",11)
 .S BS0=2,BSY1(BS0)=BSY1(0),(BSX1(3),BSX1(BS0))=+$P(^(BST),"@",9),BSY2(BS0)=+$P(^(BST),"@",10),(BSX2(3),BSX2(BS0))=BSX1(0)-1
 .S (BSY(3),BSX(3),BSY(1),BSX(2))=1,BSY(2)=BSY(0),BSX(1)=BSX(0),BS0=3 D:$E($G(%BS(14)),2) TRM D W S BS0=1 D W S BS0=2 D W S BS0=0
 Q
TRM I TIP'=7 F i=0,1,2 D
 .I $D(BSX2(i)),BSX2(i)>64,ke'=1 S BSX2(i)=64
 .I $D(BSY2(i)),BSY2(i)>21 S BSY2(i)=21
 Q
FFF W $$bel^%ZAPM.ed.BS3 I $ZE["<NOPGM" S @$ZR=""
 S $ZT=$G(%zT) G w
CLEA I TIP=7 S ColrMenu=$S($P(B,"@",31)="":"1;6;30;47",1:$P(B,"@",31)) D  K BFL,% Q
 .I $D(^%ZAPM.ed.BSR(2,1)) D
 ..W /ED(2),/CUP(1,1) W $$atr^%ZAPM.ed.BS3(ColrMenu)
 ..I $E($G(%BS(14)),6)=3 D  Q  ;ДЛЯ АРМ-ТЕРМ
 ...F i=1:1:48 W /CUP(i,1),$E($TR(^(i),"x",""),1,132-(i=48))
 ..F i=1:1:48 W /CUP(i,1),$E($TR(^(i),"x",""),1,132)
 .W /CUP(47,3) W:%BS(13)["%BS-PC" $$atr^%ZAPM.ed.BS3(ColrMenu) W ^%ZAPM.ed.BS(26),/CUP(4,3+((77-$L($P(B,"@")))\2)),$P(B,"@")
 .D MENU
 I '($D(ObOi)!($D(RA))) D
 .I $G(%BS(14)),((BSY1(BS0)<3&(BSX1(BS0)<3))!($E(BST,1,2)="fT")) W /CUP(BSY1(BS0),BSX1(BS0)),$C(27),"[0J" Q
 .W $$atr^%ZAPM.ed.BS3(0) F i=BSY1(BS0):1:BSY2(BS0) W /CUP(i,BSX1(BS0)),$J("",BSX2(BS0)-BSX1(BS0)+1)
 Q
MENUU() ;ТИТУЛ МЕНЮ
 I $G(%BS(38))="" Q $E($ZV,1,28)
 Q $E("Работает: "_$G(%BS(38)),1,28)
MENU I '$D(ColrMenu) G UNDOMENU^%ZAPM.ed.BSF11
 W $$atr^%ZAPM.ed.BS3(ColrMenu),/CUP(2,3),$$MENUU()," ",$$WEEKEND^%ZAPM.ed.BSsFUNR(1,$$h^%ZAPM.ed.BS3())," ",$$ESDAY^%ZAPM.ed.BSsFUNR(8,$$h^%ZAPM.ed.BS3())," %BS Version ",+^%ZAPM.ed.BS," " Q
RAM(Y1,X1,Y2,X2,RA,COLOR) W $$atr^%ZAPM.ed.BS3(COLOR) S ii=$S(RA=1!(RA=""):"-----|",RA=2:"=====|",RA=" ":"      ",1:"§§§§§§")
 W /CUP(Y1,X1),$E(ii,1),$TR($J("",X2-X1-1)," ",$E(ii,2)),$E(ii,3)
 F i=Y1+1:1:Y2-1 W /CUP(i,X1),$E(ii,6),$J("",X2-X1-1),$E(ii,6)
 W /CUP(Y2,X1),$E(ii,4),$TR($J("",X2-X1-1)," ",$E(ii,2)),$E(ii,5) Q
P I $ZE'["<PRO" S ls=$ZE D O^%ZAPM.ed.BSF7 S $ZT=$G(%zT) Q
 S $ZT=$G(%zT) G GO
STOP D O^%ZAPM.ed.BSF7 S d="",R1=27,ny=1 G END^%ZAPM.ed.BSF
PRO S ls=$$ErrSay^%ZAPM.ed.BSF8($ZE) G STOP
STA ;ВОССТАНОВЛЕНИЕ ПО "STATUS ME"
 S $ZT="PRO^%ZAPM.ed.BST132"
 G %:'$D(@(BSR_"(BST,""STA"")")) S S=^("STA"),STATUS=BST,zr=$ZR
 S BS0=0,BSX(BS0)=$P(S,"@",3),BSY(BS0)=$P(S,"@",2),MX=$P(S,"@",8),MY=$P(S,"@",7) I $D(%BS)["0" D CLr^%ZAPM.ed.BSF4
 G %
DoBSX D L^%ZAPM.ed.BS3($NA(@BSR@(BST))),^%ZAPM.ed.BSX("TEXT",BSR,BST),U^%ZAPM.ed.BS3($NA(@BSR@(BST))),U^%ZAPM.ed.BS3($NA(@BSR@("@"_BST))) q
IN(%w) ;ВХОД ПО ПОЛНОЙ ССЫЛКЕ ИЗ BSN
]]></Routine>


<Routine name="%ZAPM.ed.BST132M" type="MAC" languagemode="0"><![CDATA[
%BST132M ;ДВИЖЕНИЕ МАРКЕРА ПО ТАБЛИЦЕ ; 11:45   12.11.2001
B D TIP^%ZAPM.ed.BST132,KLE I $D(END) D R^%ZAPM.ed.BSF G 1000^%ZAPM.ed.BSF
 S MR=1 D CL^%ZAPM.ed.BSF4
0 I $D(EXITout) G END^%ZAPM.ed.BSF
  D W W $$atr^%ZAPM.ed.BS3(0) X $G(MR23),$G(MR24),$G(MR25),$G(%Cu)
1 F  R *R:0 E  Q
 I $D(Refresh) D W^%ZAPM.ed.BST132 K Refresh D W
 W $$rt^%ZAPM.ed.BS3(+%BS(2)) I $D(PredOb) D Pred^%ZAPM.ed.BSF12(PredOb) I R1<0 G 0:R1=-2,END^%ZAPM.ed.BSF:R1=-3,LE:R1=-4
2 I R1=27 K % D  G:$G(%FK,1)'=1&(R2=79) @%FK G 101:'$G(%FK)&(R2=R3),0:$G(%,27)=27,^%ZAPM.ed.BSF
 .K %HO,%EN I R2=91 D  Q
 ..I $D(Ukaz) D UKA^%ZAPM.ed.BSF8 Q
 ..I R3=67 S m=MX,M1=$O(BX(MX)),MR=0 D WO D:M1=""  S MX=M1,MR=1 S:m=MX&(ke=1) MY=$O(BY(""),-1) Q  ;-->
 ...S M1=MX I $O(@(BSR_"(BST,ny,nx)"))'="" S BSX(BS0)=BSX(BS0)+1,Mx=$O(BX($O(BX("")))),MXx=BX(MX) D GW^%ZAPM.ed.BST132 S M1=$O(BX(""),-1),Mx=0 K MXx
 ..I R3=68 I nx=$P($G(%TIT,"1,1"),",",2),'$D(%TIT),ke=1  S MR=0 D WO S MR=1,MY=$O(BY("")) Q
 ..I R3=68 Q:nx=$P($G(%TIT,"1,1"),",",2)  S M1=$O(BX(MX),-1),MR=0 D WO D:M1=""  S MR=1,MX=M1 Q
 ...I $P(B,"@",24) D PgLt^%ZAPM.ed.BSF9 S M1=MX Q  ;!!!!!!!!
 ...S BSX(BS0)=BSX(BS0)-1,Mx=-1 D GW^%ZAPM.ed.BST132 S Mx=0,M1=$O(BX("")) Q
 ..I R3=66 S M1=$O(BY(MY)),MR=0 D WO D:M1=""  S MY=M1,MR=1 Q
 ...S M1=MY I $O(@(BSR_"(BST,ny)")) S BSY(BS0)=BSY(BS0)+1,My=$O(BY($O(BY("")))),MYy=BY(MY) D VW^%ZAPM.ed.BST132 S M1=$O(BY(""),-1),My=0 K MYy I '$D(BX(MX)) S M2=MX,MX=$O(BX(MX)) I MX="" S MX=$O(BX(M2),-1)
 ..I R3=65 Q:ny=$P($G(%TIT,1),",")  S M1=$O(BY(MY),-1),MR=0 D WO D:M1=""  S MR=1,MY=M1 Q
 ...I $P(B,"@",24) D PgUp^%ZAPM.ed.BSF9 S M1=MY Q  ;!!!!
 ...S BSY(BS0)=BSY(BS0)-1,R1=1,My=-1 D VW^%ZAPM.ed.BST132 S My=0,M1=$O(BY("")) I M1="" S ls=" СРОЧНО СДЕЛАЙТЕ РЕМОНТ ТАБЛИЦЕ !!! F6 " D O^%ZAPM.ed.BSF7
 ...I '$D(BX(MX)) S M2=MX,MX=$O(BX(MX)) I MX="" S MX=$O(BX(M2),-1)
F1 .I R2=79,(R3=80) S IYI=$P(BS,"@",20) S:IYI=""!(IYI["##") IYI=$P(B,"@",39) S:IYI="" IYI="^%ZAPM.ed.BSHLP,%BS-PC" D NE^%ZAPM.ed.BSN Q
 .I R2=79!(R2=-1) Q:'$G(%FK)  S:R3=-1 R3=89 D  Q  ;F-клавиши
 ..I R3>79&(R3<90) S %B=R3-79,OOO="^%ZAPM.ed.BS",OO=1 D  D:'$D(%DIA) DARK^%ZAPM.ed.BSF6 W /CUP(47,1) D ^%ZAPM.ed.BSB W /CUP(48,1),$$atr^%ZAPM.ed.BS3(0),/EL(0) D CL^%ZAPM.ed.BSF4 W /CUP(47,1) S %=R1 K Dark Q
 ...S Dark(1,1)=" 0 0 0 0 0 0 0 0" N z
 ...I $E(%BS(1),17)=2 D DF6 F z=3,4,5 S $P(Dark(1,1)," ",z+1)="1"
 ...I $E(%BS(1),17)=3 D DF6 F z=3,4,5,8 S $P(Dark(1,1)," ",z+1)="1"
 ...I $E(%BS(1),9)=3 S $P(Dark(1,1)," ",3)="1"
 I R1=9 D TAB^%ZAPM.ed.BST5 G 0
 I R1=12,R2=-1 D SSS^%ZAPM.ed.BSF12 G 0
 I R1=0,R2=15 D STAB^%ZAPM.ed.BST5 G 0
 I R1=0,R2=18 S li=d G LE
 I R1=0,R2=33 D  G 1
 .I '$D(%fk) S (%fk,%FK)=1 Q
 .K %fk S %FK=$P(@BSR@(BST),"@",15) K:%FK="" %FK
SF1 I R1=0,(R2=139!(R2=140)!(R2=84)!(R2=88)) D AltKey^%ZAPM.ed.BSF8 G 0
 I R1=0,R3=-1,("85/86/87"[R2),$L(R2)=2 D Shift^%ZAPM.ed.BSF8(R2) G 0 ;F2,3,4 ЮЗЕРСКИЕ
 I R1=0,R2=31 S LineEdit=1,li=d G LE
 I R1=0,R2=46 G 0:BST'["@" D OUT^%ZAPM.ed.BSS1 G 0
 I R1=0,"48,47,20"[R2,R2?2N D CON I  G E11^%ZAPM.ed.BSF1:R2=48,E161^%ZAPM.ed.BSF1:R2=47,E21^%ZAPM.ed.BSF1:R2=20
 I R1=0,R2=38 G E141^%ZAPM.ed.BSF1:BST["@",LOS^%ZAPM.ed.BSF6:$D(^%ZAPM.ed.BSbufB("LOGS"_$G(%BS(3),$P)_$J_$P($$ZU^%ZAPM.ed.BS3(1,0),",",2)_"u"_%BS(15))) D CON G 1
 I R1=0,R2=109 D BUF^%ZAPM.ed.BSF3 G 0
 I R1=0,R2=24 G ^%ZAPM.ed.BSS
 I R1=0,R2=21 G FIDD^%ZAPM.ed.BSS ;ПОИСК ПО БАЗЕ ДАННЫХ
 I R1=0,R2=25 S fi=nx G FIND^%ZAPM.ed.BSS
 I R1=0,R2=110 S fi=nx_",DFLT,0,1,1" G FIND^%ZAPM.ed.BSS
 I R1=0,R2=90 G ShiftF7^%ZAPM.ed.BSS
 I R1=0,R2=131 D CALK^%ZAPM.ed.BSSR G:YES LE G 0
 I R1=0,R2=113,$E(%BS(1),3),'$E($G(%BS(14)),4) D CM^%ZAPM.ed.BSF6 G 0
 I R1=0,R2=105 K %GO D DOAF2^%ZAPM.ed.BSN G:$D(%GO) @%GO G 0
 I R1=0,R2=44,BST["@" G 42^%ZAPM.ed.BSF
INS I R1=0,R2=82 D  S %DIA=1,$P(@(BSR_"(BST)"),"@",3)=1,$P(@(BSR_"(BST,ny,nx)"),"@",12)=$S($P(BS,"@",12):"",1:1) G:'%BS(5) 0 S BS=@$ZR,MR=0 D WO S MR=1,R1=27,R2=91,R3=$S(%BS(5)=1:66,%BS(5)=2:67,1:R3) G 2
 .S %DIA=$$GetLock^%ZAPM.ed.BSXfun(),$E(%DIA)=($E(%DIA)=0) D SetLock^%ZAPM.ed.BSXfun(%DIA)
 I R1=0,R2=162 D I^%ZAPM.ed.BSGLOB(BSR,BST,ny,nx,d) S R2=82 G INS
 I R1=0 D  G 0
 .I R2=71 S %HO=$S('$D(%HO):1,%HO=1:2,%HO=2:3,1:1) D  ;HOME
 ..I $D(Ukaz),%HO<3 D HO^%ZAPM.ed.BSF8 Q
 ..I %HO=1 S MX=$O(BX("")) S MR=0 D WO S MR=1 Q
 ..I %HO=2 S MR=0 D WO S MY=$O(BY("")),MX=$O(BX("")),MR=1 Q
 ..I %HO=3 S BSY(BS0)=$P($G(%TIT,1),","),BSX(BS0)=$P($G(%TIT,"1,1"),",",2) D TW^%ZAPM.ed.BST132,KLE Q
 .I R2=79 S %EN=$S('$D(%EN):1,%EN=1:2,%EN=2:3,1:1) D  ;END
 ..I $D(Ukaz),%EN<3 D EN^%ZAPM.ed.BSF8 Q
 ..I %EN=1 D DNX S MR=0 D WO S MR=1,MX=M1 Q
 ..I %EN=2 D DNY S MR=0 D WO S MR=1,MY=M1 Q
 ..I %EN=3 D REND^%ZAPM.ed.BSF2,DEND^%ZAPM.ed.BSF2,END^%ZAPM.ed.BS1 S BSY(BS0)=es,BSX(BS0)=ek D TW^%ZAPM.ed.BST132,KLE Q
 .I R2=132!(R2=22) S BSY(BS0)=$P($G(%TIT,1),",") D TW^%ZAPM.ed.BST132,KLE Q
 .I R2=118!(R2=49) D DEND^%ZAPM.ed.BSF2,ENDS^%ZAPM.ed.BS1 S BSY(BS0)=es D TW^%ZAPM.ed.BST132,KLE Q
 .I R2=73!(R2=152)!(R2=23) D PgUp^%ZAPM.ed.BSF9 Q
 .I R2=81!(R2=160)!(R2=50) S t1=BSY(BS0) D DNY S BSY(BS0)=BY(M1) Q:t1=BSY(BS0)  D VW^%ZAPM.ed.BST132,KLE Q  ;PgDn
 .I R2=157!(R2=37)!(R2=116) S t1=BSX(BS0) D DNX S BSX(BS0)=BX(M1) Q:t1=BSX(BS0)  D GW^%ZAPM.ed.BST132,KLE Q  ;->
 .I R2=155!(R2=36)!(R2=115) D PgLt^%ZAPM.ed.BSF9 Q
 I R1=13,$P(BS,"@",14)'="" S l4=14 D NEW^%ZAPM.ed.BSN K l4 G:'(R1'=27&(li'="")) 0 W $$atr^%ZAPM.ed.BS3(0) D W G 1:$D(%ZAP),1:$P(BS,"@",5)=1 I 1 D:'$D(%w(5)) PASD^%ZAPM.ed.BST1 G 1:'$T S YES=1 G LEE
 I R1=13,'$G(%FK) G 101
 I R1=-1,%BS(13)="%BS-PC" G 0 ;D GLUC^%ZAPM.ed.BSXgluc G 0
 I R1=43 G 0 ;,PL^%ZAPM.ed.BSF5
 I R1=45 G 0 ;,MI^%ZAPM.ed.BSF5
 I R1=127,(R2=R3) G 1:$D(%ZAP),1:$P(BS,"@",5)=1 D  G 0
 .I '$D(%w(5)) D PASD^%ZAPM.ed.BST1 E  Q
 .D Yes^%ZAPM.ed.BSXfun("Удаляем данные клетки {"_ny_","_nx_"} ?") Q:YES<1
 .D R^%ZAPM.ed.BS3($NA(@BSR@(BST,ny,nx))) I LOC D MED^%ZAPM.ed.BSF S i=ny,j=nx I $D(@BSR@(BST,ny,nx)) D DEL^%ZAPM.ed.BSF1,D^%ZAPM.ed.BS3($NA(@BSR@(BST,ny,nx))) D:$D(%CAL) CALC^%ZAPM.ed.BSF3
 G:R1<32 1 S li=$C(R1) I $P(B,"@",40)'="" S fi=$P(B,"@",40),finl=li G FIND^%ZAPM.ed.BSS
LE G 1:$D(%ZAP) I $P(BS,"@",5)=1 S ls=" Ввод Запрещен " D WAITS^%ZAPM.ed.BSF2 W $$bel^%ZAPM.ed.BS3 G 1
 I '$D(%w(5)) D PASD^%ZAPM.ed.BST1 E  G 1
 I $P(BS,"@",21) D BAR^%ZAPM.ed.BSF7(+$P(BS,"@",21),$P($P(BS,"@",21),",",2)) G LEE
 I $P(B,"@",26)["," D BAR^%ZAPM.ed.BSF7(+$P(B,"@",26),$P($P(B,"@",26),",",2)) G LEE
 I $P(B,"@",26)!($D(LineEdit)) S ls="Коppектиpуете значение клетки",lon=$S($P(BS,"@",9)=1:200,1:509) D HIS^%ZAPM.ed.BSF1("DAT"),LE^%ZAPM.ed.BSTT X "I 1" K LineEdit
 E  S li=$$Edit^%ZAPM.ed.BSXuse(li,($P(BS,"@")+1-BS1+BSY1(BS0)),($P(BS,"@",2)-BS2+1+BSX1(BS0)),($P(BS,"@")-BS1+BSY1(BS0)+$P(BS,"@",3)),($P(BS,"@",2)-BS2+BSX1(BS0)+$P(BS,"@",4)),"@")
LEE G:'YES 0 I li'="" K R1 D  G M:$D(R1),LE
 .I $P(BS,"@",16)'="" K %0 S %zT=$ZT,$ZT="ERRTR^%ZAPM.ed.BST132M",YES=1,(d,d0)=li K ls D  S:YES li=$G(%0,li) I 'YES S ls=$G(ls,"СИНТАКСИЧЕСКАЯ ОШИБКА ") D O^%ZAPM.ed.BSF7 K R1 Q
 ..I '$P(BS,"@",16) X $G(@BSR@(BST,"RTR",ny,nx)) S $ZT=$G(%zT) Q
 ..X $G(@(BSR_"(BST,""RTR"","_$P(BS,"@",16)_")")) S $ZT=$G(%zT)
 .I li["@" S ls=" Запрещенный Символ @ " D O^%ZAPM.ed.BSF7 Q
 .D SetCell(ny,nx,li) D:$D(%CAL) CALC^%ZAPM.ed.BSF3 S R1=1 Q
 G 0
SetCell(ny,nx,li) 
 I $P(BS,"@",9)=1 D L^%ZAPM.ed.BS3($NA(@BSR@(BST,ny,nx))),MED^%ZAPM.ed.BSF D  D U^%ZAPM.ed.BS3($NA(@BSR@(BST,ny,nx))) Q
 .S $P(@(BSR_"(BST,ny,nx)"),"@",15)=li
 E  S $P(^%ZAPM.ed.BSbufB("BB"_$G(%BS(3),$P)_$J_"u"_%BS(15)),"@",2)=1,^%ZAPM.ed.BSbufB("BB"_$G(%BS(3),$P)_$J_"u"_%BS(15),ny,nx)=li Q
 Q
M G:'POSt 0 S MR=0,BS=@BSR@(BST,BY(MY),BX(MX))
 D WO S MR=1,R1=27,R2=91,R3=$S(POSt=1:66,POSt=2:67,1:R3) G 2
W S BS=@(BSR_"(BST,"_BY(MY)_","_BX(MX)_")")
WO S ny=BY(MY),nx=BX(MX)
WG S CLR=$S($P(BS,"@",10):$P(BS,"@",10),1:COLOR) I $E(%BS(1),19) S CLR=$P(%BS,"!",$E(%BS(1),19))
 I $P(BS,"@",12) S CLR=$P(%BS,"!",3)
 I $P(BS,"@",9)=1 S (d1,d,d0)=$P(BS,"@",15)
 E  S (d1,d,d0)=$G(^%ZAPM.ed.BSbufB("BB"_$G(%BS(3),$P)_$J_"u"_%BS(15),ny,nx))
 I $P(BS,"@",8)'="" S %zT=$ZT,$ZT="FTRe^%ZAPM.ed.BST132M" D  S $ZT=$G(%zT)
 .I d0="" S d0=0
 .I '$P(BS,"@",8) X $G(@(BSR_"(BST,""FTR"",ny,nx)")) Q
 .X $G(@(BSR_"(BST,""FTR"","_$P(BS,"@",8)_")"))
w W $$atr^%ZAPM.ed.BS3($S('MR:CLR,1:$P(%BS,"!",$S($P(BS,"@",12):1,1:2))))
 S l=$P(BS,"@",3)*$P(BS,"@",4) F BSF=1:1:$P(BS,"@",3) Q:($P(BS,"@")+BSF-BS1)>BSY2(BS0)  D  W $E(d1_$J("",l),BSF*$P(BS,"@",4)-$P(BS,"@",4)+1,$P(BS,"@",4)+($P(BS,"@",4)*(BSF-1)))
 .W /CUP(($P(BS,"@")+BSF-BS1+BSY1(BS0)),($P(BS,"@",2)-BS2+1+BSX1(BS0)))
 W $$atr^%ZAPM.ed.BS3($S(MR:CLR,1:$P(%BS,"!",2))) Q
DNX S M1=$O(BX(""),-1) Q
24 W /CUP(47,1),$$atr^%ZAPM.ed.BS3(0),/EL(0) Q
25 W /CUP(48,1),$$atr^%ZAPM.ed.BS3(0),/EL(0) Q
KL W /CUP(($P(BS,"@")+BSF-BS1+BSY1(BS0)),($P(BS,"@",2)-BS2+1+BSX1(BS0))),$$atr^%ZAPM.ed.BS3(0) Q
DNY S M1=$O(BY(""),-1) Q
DF6 N z F z=2:1:7,10 S $P(Dark(1,1,6)," ",z+1)="1"
 Q
CON Q:BST["@"  S ls=" УСТАНОВИТЕ РЕЖИМ КОРРЕКЦИИ ОПИСАНИЯ ТАБЛИЦЫ <F4> " G O^%ZAPM.ed.BSF7
MR23 W /CUP(46,1),/EL(0) W:$P(BS,"@",7)'="" "ВЫЧ" W:$P(BS,"@",8)'="" /CUP(46,5),"ТРАН" W:$P(BS,"@",6)'="" /CUP(46,10),"d",$P(BS,"@",6) W /CUP(46,14),$S($P(BS,"@",9)=1:"О.Т",1:"Б.Д") W:$P(BS,"@",5)=1 /CUP(46,19),"ЗАПР"
 W /CUP(46,24),$P(BS,"@",3),"x",$P(BS,"@",4) W:$P(BS,"@",13)'="" /CUP(46,30),"ЛОГ=",$S($P(BS,"@",11)=1:"НЕ",1:"ДА") W:$P(BS,"@",16)'="" /CUP(46,37),"СИНТ" W:$P(BS,"@",14)'="" /CUP(46,42),$S($P(BS,"@",14)?.N1",".N:"КОМ",1:"ТАБ")
 W:$P(BS,"@",17)'="" /CUP(46,46),"ДВЖ" W:$D(%DIA) /CUP(46,51),"Бл" W:$P(BS,"@",12) /CUP(46,52),"Л" W:$P($P(BS,"@",18),"#")'="" /CUP(46,54),$P($P(BS,"@",18),"#")
 W:$P($P(BS,"@",18),"#",2)'="" /CUP(46,58),"""",$P($P(BS,"@",18),"#",2),"""" W:$P(B,"@",24) /CUP(46,61),"ПОДЖ"
 W:$P(BS,"@",20)'="" /CUP(46,66),"F1" Q
MR24 D 24,RED W " {",ny,",",nx,"}" D 25 W $E(d,1,77) W:$E(d,77)'="" "..." Q
RED W:BST["@" $$atr^%ZAPM.ed.BS3("1;36;47")," РЕД ",$$atr^%ZAPM.ed.BS3(0) Q
MR25 D 24,RED W $E($$SS^%ZAPM.ed.BSF12(),1,132) D 25 W $E(d,1,132)_$ZN Q
ERRTR S ls=$ZE D O^%ZAPM.ed.BSF7 Q
FTRe S $ZT=$G(%zT) W $$bel^%ZAPM.ed.BS3 G w
101 S MR=0 D WO W $$atr^%ZAPM.ed.BS3(0) G 10^%ZAPM.ed.BSF
KLE K END S R1=27,%BSTM=1 D:TIP'=7 24 I '$D(MY) S MY=$O(BY("")) D:MY=""  Q:$D(END)  S MX=$O(BX("")) D:MX=""  Q:MX=""
 .S ls=" !!! ПУСТАЯ ТАБЛИЦА !!!"_$S($G(%TIT):",ИЛИ КОНФЛИКТ ТИТУЛА И ВЫСОТЫ СТРОК",1:"") D O^%ZAPM.ed.BSF7 S END=1
 I '$D(BY(MY))!('$D(BX(MX))) K MY,MX G KLE
 I $D(Ukaz) S Na=1 D TA^%ZAPM.ed.BSF8
 Q
]]></Routine>


<Routine name="%ZAPM.ed.BST2" type="MAC" languagemode="0"><![CDATA[
%BST2 ;КЛЮЧИ И ЗАПРОСЫ СПИСКОВ И СВОДОК ; 16:37   11.09.2000
 S Bsr=BSR,Bst=BST D KCHO^%ZAPM.ed.BSsFUNM K %DIA,CALCFONs
 I $P($G(@(BSR_"(BST,""KEY"")")),"@",2)="" S ls=" НЕТ КЛЮЧЕЙ ",YES=0 D O^%ZAPM.ed.BSF7 G NO
 S (BSdd,zr)=@$ZR,YES=1,%zT=$ZT,$ZT="ERRNO^%ZAPM.ed.BST2" F I=1:1 Q:$P(zr,"!",I)=""  S BSt=$P($P(zr,"!",I),"@",2),BSr=$P(BSt,",",1,$L(BSt,",")-1),BSt=$P(BSt,",",$L(BSt,",")) D  G:'YES NO
 .I '$D(@(BSr_"(BSt,""KEY"")")) S ls=" НЕТ КЛЮЧЕЙ,или недоступна "_BSr_","_BSt_" ",YES=0 D O^%ZAPM.ed.BSF7
 I TIP=3,'$D(@(BSR_"(BST,""TSP"")")) S ls=" СПИСОК НЕ ПРОШЕЛ ТРАНСЛЯЦИЮ ",YES=0 D O^%ZAPM.ed.BSF7
 S $ZT=$G(%zT) I TIP=4,'$D(@(BSR_"(BST,""TSV"")")) S ls=" СВОДКА НЕ ПРОШЛА ТРАНСЛЯЦИЮ ",YES=0 D O^%ZAPM.ed.BSF7
NO I 'YES D KEY^%ZAPM.ed.BST K @(BSR_"(BST,""STA"")") G TEND
 S IMQ=$$BSR^%ZAPM.ed.BSA(BSR)_","_BST,TIp=TIP,Ii=$P(B,"@") K F4
TS ;ВЫБОР
 S MRMR="W /CUP(23,1),/EL(0),$$clr^%ZAPM.ed.BS3(4),"" <Enter>-ВЫБОР <СТРЕЛКИ>-ДВИЖЕНИЕ <Esc>-ОТМЕНА <F4>-БЕЗ КЛЮЧА <F8>-УДАЛИТЬ """
 S (%OLDII,%TAB)=$$TNAME^%ZAPM.ed.BSF13(BSR,BST)_".",%nAM=$$cB^%ZAPM.ed.BSSV,BSR="^%ZAPM.ed.BSbufB",BST="TS"_$G(%BS(3),$P)_$J_"u"_%BS(15) I $D(^%ZAPM.ed.BSbufB("TS"_$G(%BS(3),$P)_$J_"u"_%BS(15),"STA")) D STA^%ZAPM.ed.BST G TSBE
 K ^%ZAPM.ed.BSbufB("TS"_$G(%BS(3),$P)_$J_"u"_%BS(15)),NOKEY,CALCFON,OLDT,SRAVN
 S i=3,TS=$ZR
 S @TS@(2,1)="@@0@75@@@@@1@"_$P(%BS,"!",5)_"@@@@@ "_$$F^%ZAPM.ed.BSF11(IMQ)
 S @TS@(3,1)="@@1@75@@@@@1@"_$P(%BS,"!",5)_"@@@@@ ЗАПРОСОВ="_$$ZCount(IMQ)
 ;            MSW          !
 S @TS@(1,1)="@@1@75@@@@@1@"_$P(%BS,"!",5)_"@@@@@ "_$$H^%ZAPM.ed.BSF11(IMQ)_" ;"_Ii
 S i=4,@TS@(4,1)="@@1@75@@@@@1@"_$P(%BS,"!",5)_"@@@@@ НАСЧЕТ НА (MSM-DDP) СЕРВЕРЕ"
 I $ZV["Cach"||($ZV["IRIS") S $P(@TS@(2,1),"@",3)=0,$P(@TS@(4,1),"@",3)=0
 F  S %TAB=$O(@(%nAM_"(%TAB)")) Q:%TAB=""  Q:%TAB'[%OLDII  I %TAB'["@"&(%TAB'["&") S i=i+1 D
 .S @TS@(i,1)="@@1@75@@@@@1@"_$P(%BS,"!",5)_"@@@@@ "_$P(%TAB,"!",3)_$J("",13-$L($P(%TAB,"!",3)))_$S($P(@(%nAM_"(%TAB)"),"@",30)="":".....",1:$E($P(@$ZR,"@",30),1,5))_";LOCKAL;"_$P(@$ZR,"@")
 I IMQ["]" D R^%ZAPM.ed.BSF11(IMQ)
 S @TS="@@@@@@@1@1@22@80@@X MRMR@@%FKT^%ZAPM.ed.BST2@1@1",se=i,ke=1,$P(@$ZR,"@",41)="F8DEL^%ZAPM.ed.BST2"
 D TAB^%ZAPM.ed.BSF1,^%ZAPM.ed.BST I $D(END) G TEND
TSBE I R1=27,$D(NOKEY) S BSR=$P(IMQ,",",1,$L(IMQ,",")-1),BST=$P(IMQ,",",$L(IMQ,",")) D KEY^%ZAPM.ed.BST K @(BSR_"(BST,""STA"")") G TS
 I R1=27 G TEND
 I ny=3 D ZP^%ZAPM.ed.BSZPS S R1=27 G TEND
 I d'[";LOCKAL;",d'[";REMOTE;" S:ny=2 CALCFON=1 S:ny=4 CALCFON=2 D KEY S R1=27 G TEND
 I d[";LOCKAL;" S BSR=%nAM,BST=$P(%OLDII,"!",1,2)_"!"_$P(d," ",2)
 I d[";REMOTE;" S BSR=UU,BST=$P(%OLDII,"!",1)_"!1!"_$P(d," ",2)
 I $P($P(@(BSR_"(BST)"),"@"),";",2)'["ГОТОВ" S ls=" ВОЙТИ НЕЛЬЗЯ..." D O^%ZAPM.ed.BSF7 G TEND
 I $D(@(BSR_"(BST,""STA"")")) D STA^%ZAPM.ed.BST G TEND
 D ^%ZAPM.ed.BST
TEND K ^%ZAPM.ed.BSbufB("TS"_$G(%BS(3),$P)_$J_"u"_%BS(15)) S SPSV=1 G ZF^%ZAPM.ed.BST1
 ;
KEY L ^%ZAPM.ed.BSbufB("KCH"_$G(%BS(3),$P)_$J_"u"_%BS(15)) ;ДЛЯ ВЫБОРКИ ПРИ НАСЧЕТЕ
 K NOKEY,%KEYS,NAZAD,^%ZAPM.ed.BSbufB("KCH"_$G(%BS(3),$P)_$J_"u"_%BS(15)) F key=0:1:13 I $D(@(BSr_"(BSt,""KEY"",key)")) S endkey=key
 F key=0:1:endkey K ^%ZAPM.ed.BSbufB(key_"k"_$G(%BS(3),$P)_$J_"u"_%BS(15))
 F key=0:1:endkey I $D(@(BSr_"(BSt,""KEY"",key)")) D KE G:$D(NAZAD)&('$D(NOKEY)) END^%ZAPM.ed.BSF I key=endkey!($D(NOKEY)) D SPSVD G END^%ZAPM.ed.BSF:$D(CALCFONs)!('$D(key)) S key=key-1 I $D(NOKEY) S BSR=$P(IMQ,",",1,$L(IMQ,",")-1),BST=$P(IMQ,",",$L(IMQ,",")) G KEY^%ZAPM.ed.BST Q
 Q
F8DEL ;ПРЕДОБРАБОТКА ДЛЯ СПИСКА ОТЧЕТОВ
 I $E(%BS(1),17),R1=127 S R1=27,R2=79,R3=87
 Q
SPSVD I TIp=4 S %B=2,ls=" Определим еще один уровень СРАВНЕНИЯ " D YES^%ZAPM.ed.BSF I YES S key=0,COMP=COMP+1,SRAVN=+$G(CALCFON,$G(SRAVN)) K CALCFON Q
 I '$D(NOKEY) S ^%ZAPM.ed.BSbufB("KCH"_$G(%BS(3),$P)_$J_"u"_%BS(15))=IMQ_"##"_BSdd_"####"_COMP I '$D(OTLUP) G ^%ZAPM.ed.BSSP:TIp=3  G ^%ZAPM.ed.BSSV
e Q
KE ;ОПРЕДЕЛЕНИЕ КЛЮЧА
 N KMAX,KK,KML,zr
 F i=1,2,4,5,6,9,10,12,13,15,16 S @("k"_i)=$P(^(key),"@",i)
 K KK S zr=$ZR,KK=0 F i=10:1 Q:'$D(^(key,i))  S KK(i)=^(i),KK(i,1)=^(i,1) S:KK<$L(KK(i)) KK=$L(KK(i)) I @zr
 I '$D(Report),$D(@Bsr@(Bst,"Key",key)) D  ;СПЕЦИАЛЬНАЯ ВЫБОРКА
 .F i=1,2,4,5,6,9,10,12,13,15,16 I $P(^(key),"@",i)'="" S @("k"_i)=$P(^(key),"@",i)
 .S zr=$ZR,KMAX=0,KML=$O(^(key,""),-1) I @zr
 .F i=10:1:KML I $D(^(key,i)) S KK(i)=^(i),KK(i,1)=^(i,1) S:KMAX<$L(KK(i)) KMAX=$L(KK(i)) I @zr
 S KMAX=$S($G(KK)>$G(KMAX):$G(KK),1:$G(KMAX)),MRMR="W /CUP(23,1),/EL(0),$$clr^%ZAPM.ed.BS3(4),"" <Enter>-ВЫБОР <СТРЕЛКИ>-ДВИЖЕНИЕ <Esc>-ОТМЕНА ,Можете корректировать ВЫБОРКУ """
 S II="KCH"_$S(key=0:0,1:1) I '$D(COMP) S COMP=1
 S l=$S($P(^%ZAPM.ed.BSS(II,1,2),"@",4)<$G(KMAX,0):KMAX,1:$P(@$ZR,"@",4)),BSr1="^%ZAPM.ed.BSS",BSt1=II
 I l>45 S l=45
 S (BSr2,BSR)="^%ZAPM.ed.BSbufB",(BSt2,BST)=key_"k"_$G(%BS(3),$P)_$J_"u"_%BS(15) D COPY^%ZAPM.ed.BSTK
 F i=1:1:$S(key:4,1:3) D  S $P(@$ZR,"@",4)=l
 .F j=1,3,2 S ^%ZAPM.ed.BSbufB(key_"k"_$G(%BS(3),$P)_$J_"u"_%BS(15),i,j)=^%ZAPM.ed.BSS(II,i,j) D
 ..I i=3,j=3 S $P(@$ZR,"@",15)=k1 ;```$S($$LASTHIS^%ZAPM.ed.BSF11(key,i):$$INSERT^%ZAPM.ed.BSF11(key,i),1:k1)
 ..I i=4,j=3 S $P(@$ZR,"@",15)=k4 ;```$S($$LASTHIS^%ZAPM.ed.BSF11(key,i):$$INSERT^%ZAPM.ed.BSF11(key,i),1:k4)
 I $D(^%ZAPM.ed.BSbufB("KCH"_$G(%BS(3),$P)_$J_"u"_%BS(15),COMP,key,1)) S II=$S(@$ZR=""&(k1'=""):k1,1:@$ZR) S $P(^%ZAPM.ed.BSbufB(key_"k"_$G(%BS(3),$P)_$J_"u"_%BS(15),3,3),"@",15)=II
 I key,$D(^%ZAPM.ed.BSbufB("KCH"_$G(%BS(3),$P)_$J_"u"_%BS(15),COMP,key,2)) S II=$S(@$ZR=""&(k4'=""):k4,1:@$ZR) S $P(^%ZAPM.ed.BSbufB(key_"k"_$G(%BS(3),$P)_$J_"u"_%BS(15),4,3),"@",15)=II
 S ^%ZAPM.ed.BSbufB(key_"k"_$G(%BS(3),$P)_$J_"u"_%BS(15),2,3)=$P(^%ZAPM.ed.BSbufB(key_"k"_$G(%BS(3),$P)_$J_"u"_%BS(15),2,3),"@",1,14)_"@"_$S(TIp=3:"",1:"Ср:"_COMP)_" Кл:"_key_"                              "_k9
 I $D(KK) S i=4 F ii=10:1 Q:'$D(KK(ii))  S i=i+1 D  S $P(@$ZR,"@",15)=KK(ii),$P(@$ZR,"@",4)=l,$P(^%ZAPM.ed.BSbufB(key_"k"_$G(%BS(3),$P)_$J_"u"_%BS(15),i,3),"@",15)=" <---",^%ZAPM.ed.BSbufB(key_"k"_$G(%BS(3),$P)_$J_"u"_%BS(15),"COL",i,3)=KK(ii,1)
 .F j=1,3,2 S ^%ZAPM.ed.BSbufB(key_"k"_$G(%BS(3),$P)_$J_"u"_%BS(15),i,j)=^%ZAPM.ed.BSbufB(key_"k"_$G(%BS(3),$P)_$J_"u"_%BS(15),2,j),$P(@$ZR,"@",3)=1,$P(@$ZR,"@",15)=""
 K KK S ^%ZAPM.ed.BSbufB(key_"k"_$G(%BS(3),$P)_$J_"u"_%BS(15))=^%ZAPM.ed.BSS("KCH1")
 D TAB^%ZAPM.ed.BSF1,^%ZAPM.ed.BST
NAMKE I R1=27 K ^%ZAPM.ed.BSbufB(key_"k"_$G(%BS(3),$P)_$J_"u"_%BS(15)),^%ZAPM.ed.BSbufB("KCH"_$G(%BS(3),$P)_$J_"u"_%BS(15),COMP,key) D:'$D(%KNAM(key-1))  S key=key-2 Q
 .S NAZAD=1 K ZPNEW,^%ZAPM.ed.BSbufB("KCH"_$G(%BS(3),$P)_$J_"u"_%BS(15)),COMP,CALCFON,%KNAM,II
SET S %KNAM(key)=k6,^%ZAPM.ed.BSbufB("KCH"_$G(%BS(3),$P)_$J_"u"_%BS(15),COMP,key,1)=$P(^%ZAPM.ed.BSbufB(key_"k"_$G(%BS(3),$P)_$J_"u"_%BS(15),3,3),"@",15),^(4)=k2_"#"_k12 Q:'key
 S ^%ZAPM.ed.BSbufB("KCH"_$G(%BS(3),$P)_$J_"u"_%BS(15),COMP,key,2)=$P(^%ZAPM.ed.BSbufB(key_"k"_$G(%BS(3),$P)_$J_"u"_%BS(15),4,3),"@",15)
 I ny>4 S ^%ZAPM.ed.BSbufB("KCH"_$G(%BS(3),$P)_$J_"u"_%BS(15),COMP,key,3)=$G(^%ZAPM.ed.BSbufB(key_"k"_$G(%BS(3),$P)_$J_"u"_%BS(15),"COL",ny,3),"I 1") S ^%ZAPM.ed.BSbufB("KCH"_$G(%BS(3),$P)_$J_"u"_%BS(15),COMP,key,4)="TXTC#"_$P(^%ZAPM.ed.BSbufB(key_"k"_$G(%BS(3),$P)_$J_"u"_%BS(15),ny,2),"@",15) I d'=" <---" D SETEMP^%ZAPM.ed.BSF11
 Q
25 W /CUP(25,1),$$atr^%ZAPM.ed.BS3(0),/EL(0),ls Q
D G 0^%ZAPM.ed.BSTM
ERR D O^%ZAPM.ed.BSF7 X "I 0" S YES=0 Q
ERRNO I $ZE["<PROT"!($ZE["<NOSYS")!($ZE["<NOUCI")!($ZE["<NAMESPACE") S ls=" НЕТ КЛЮЧЕЙ,или недоступна "_BSr_","_BSt_" " G RNO
 S ls=$ZE
RNO D O^%ZAPM.ed.BSF7 X "I 0" S YES=0,$ZT=$G(%zT) G NO
%FKT D R^%ZAPM.ed.BSF I R3=89 ZT "F10"
 I R3=83 S NOKEY=1,R1=27 Q  ;БЕЗ КЛЮЧЕЙ F4
 I R3=87 K AllWAY D DEL^%ZAPM.ed.BSF11 Q:R1=27  ;УДАЛИТЬ ТАБЛИЦУ
%F4 G D
OLD S ls=" НОВОЙ СВОДКОЙ ЗАМЕСТИМ СТАРУЮ ? " D YES^%ZAPM.ed.BSF S:YES OLDT=1 Q
v(N) Q $G(%BS("v",N))
ZCount(IMQ) //ПОСЧИТАТЬ СКОЛЬКО ЗАПРОСОВ
 N I,II,BSR,BST S I="",II=0,BSR=$P(IMQ,",",1,$L(IMQ,",")-1),BST=$P(IMQ,",",$L(IMQ,","))
 F  S I=$O(@BSR@(BST,"ZPr",I)) Q:I=""  S II=II+1
 Q II
]]></Routine>


<Routine name="%ZAPM.ed.BST3" type="MAC" languagemode="0"><![CDATA[
%BST3 ;ТРАНСЛЯЦИЯ СПИСКОВЫХ И СВОДКОВЫХ ФУНКЦИЙ ; 14:22   10.12.1999
TEST S YES=1,(s,k)=1 D REND^%ZAPM.ed.BSF2,DEND^%ZAPM.ed.BSF2,EN G SV:TIP=4
 S ls="СПИСКА" D S D OP^%ZAPM.ed.BSF4 K ^%ZAPM.ed.BSbufB("F"_$G(%BS(3),$P)_$J_"u"_%BS(15))
 K BSr,BSt,@(BSR_"(BST,""TSP"")"),jjk,ii,DUBLTSP
 F i=1:1:se F j=1:1:ke I $D(@(BSR_"(BST,""FCL"",i,j)")),@$ZR["$$TSP" S ^%ZAPM.ed.BSbufB("F"_$G(%BS(3),$P)_$J_"u"_%BS(15),i,j)=@$ZR D
 .I @$ZR["$$TSP(" D
 ..I $D(ii) S DUBLTSP=i_","_j Q
 ..S ii=i,jj=j
 .I '$D(ip),@$ZR["$$TSPPI(" S ip=i,jp=j
 .I '$D(jjk),@$ZR["$$TSPN(" S jjk=j
 I '$D(ii) S $P(@(BSR_"(BST)"),"@",17)=1 G END
 I $D(DUBLTSP) S ls=" ГЛАВНАЯ ФУНКЦИЯ СПИСКА $$TSP ДУБЛИРУЕТСЯ В клетке {"_DUBLTSP_"} !!! " G N
 I '$D(^%ZAPM.ed.BSbufB("F"_$G(%BS(3),$P)_$J_"u"_%BS(15),ii,jj)) S ls=" Не ОПРЕДЕЛЕНА ГЛАВНАЯ ФУНКЦИЯ СПИСКА $$TSP !!! " G N
 S i0=@$ZR,jj1=0 K @$ZR D P,CR
 S BSt=$P(ii1,",",$L(ii1,",")),BSr=$P(ii1,",",1,$L(ii1,",")-1),%zT=$ZT,$ZT="ER^%ZAPM.ed.BST3" S:BSr'["^" BSr="^"_BSr I BSr[$C(34) S BSr=$$TR^%ZAPM.ed.BSsFUNM(BSr,$C(34)_$C(34),$C(34))
 I '$D(@(BSr_"(BSt)")) S ls=" Не Определена или НЕ доступна  "_BSr_","_BSt_" " G N
 I $P(@(BSr_"(BSt)"),"@",17)'=2 S ls=BSr_","_BSt_" ЭТО НЕ ТАБЛИЦА ОПИСАНИЯ БАЗЫ ДАННЫХ " G N
 S BSD=$$KBD^%ZAPM.ed.BSF12($NA(@BSr@(BSt))) I '$$Data^%ZAPM.ed.BSF12(BSD) S ls=" НЕ ОПРЕДЕЛЕНА или не доступна БАЗА ДАННЫХ:"_BSD_" из "_BSr_","_BSt_" !!! " G N
 S @(BSR_"(BST,""KEY"")")=$$BSR^%ZAPM.ed.BSA(BSD)_"@"_$$BSR^%ZAPM.ed.BSA(BSr)_","_BSt,TTT=0,BSr(1)=BSr,BSt(1)=BSt ;```ЕСТЬ ЗАВИСИМОСТЬ ОТ ТОГО, КТО ГЕНЕРИТ СПИСОК
 S @(BSR_"(BST,""TSP"",1)")=BSD,$ZT=$G(%zT) G:'$D(^%ZAPM.ed.BSbufB("F"_$G(%BS(3),$P)_$J_"u"_%BS(15),+ii2)) NPL S ii="",ii=$O(^%ZAPM.ed.BSbufB("F"_$G(%BS(3),$P)_$J_"u"_%BS(15),+ii2,ii)) G:ii="" NPL S @(BSR_"(BST,""TSP"",3,1)")=ii1,^(2)=ii2,^(3)=ii3,^(4)=ii4,^(5)=$G(jjk)
 S:ii5'="" @(BSR_"(BST,""TSP"",0)")=ii5 I +ii2,+$P(@(BSR_"(BST)"),"@",19),(ii2>+$P(@$ZR,"@",19)) S ls=" ОПУСТИТЕ ТИТУЛ НИЖЕ !!! " G N
 S j1="",m1="",ij2=ii2,j5="",jj1=1 F i=ii:1:ke I $G(^%ZAPM.ed.BSbufB("F"_$G(%BS(3),$P)_$J_"u"_%BS(15),+ij2,i))["$$TSPL" S i0=@$ZR K @$ZR D CHK G EN:'YES S:ii5["1" j1=j1_i_"," S:ii5["2" m1=m1_i_"," S @(BSR_"(BST,""TSP"",4,i)")=j3
 D GLSET^%ZAPM.ed.BSF12($NA(@(BSR_"(BST,""TSP"",4)")),$E(j1,1,$L(j1)-1)) ;ЗАГИБАТЬ ПО ДАННЫМ
 I m1'="" S @(BSR_"(BST,""TSP"",7)")=$E(m1,1,$L(m1)-1) ;ЗАГИБАТЬ ПО ТРАНС
 S i="",j1="",j2=1,jj1=0 F  S i=$O(^%ZAPM.ed.BSbufB("F"_$G(%BS(3),$P)_$J_"u"_%BS(15),i)) Q:i=""  S j="" F  S j=$O(^%ZAPM.ed.BSbufB("F"_$G(%BS(3),$P)_$J_"u"_%BS(15),i,j)) Q:j=""  I $G(^(j))["$$TSPGL" S i0=@$ZR K @$ZR D CHK G EN:'YES S @(BSR_"(BST,""TSP"",2,j2)")=$P(j3,",%2="),j2=j2+1
 S @(BSR_"(BST,""TSP"",2)")=j2-1 I $D(ip) S i0=^%ZAPM.ed.BSbufB("F"_$G(%BS(3),$P)_$J_"u"_%BS(15),ip,jp) K @$ZR D P,CR S @(BSR_"(BST,""TSP"",6,1)")=ii1,^(2)=ii2,^(3)=ii3,^(4)=ii4
 G END
EN K @(BSR_"(BST,""KEY"")"),^("TSV")
END K ^%ZAPM.ed.BSbufB("F"_$G(%BS(3),$P)_$J_"u"_%BS(15)),i,j,ii,ii1,ii2,ii3,ii4,ii6,ii5,iii1,iii2,KOLB,i0,j1,m1,j2,j3,j4,j5,i2,i1,i3,i4,i5,i6,i7,jj1,jj2,jj3,DUBLTSP
 Q
S S ls="ТРАНСЛЯЦИЯ ФОРМУЛ "_ls D WAITS^%ZAPM.ed.BSF2 Q
CR F i=1:1:6 I $E(@("ii"_i),1)=$C(34)&($E(@("ii"_i),$L(@("ii"_i)))=$C(34)) S @("ii"_i)=$E(@("ii"_i),2,$L(@("ii"_i))-1)
 Q
SV S ls="СВОДКИ" D S
 K BSr,BSt,@(BSR_"(BST,""TSV"")"),jjk,jjs,jju,ii,id F i=1:1:se F j=1:1:ke I $D(@(BSR_"(BST,""FCL"",i,j)")),@$ZR["$$TSV" S ^%ZAPM.ed.BSbufB("F"_$G(%BS(3),$P)_$J_"u"_%BS(15),i,j)=@$ZR D
 .I '$D(ii),@$ZR["$$TSV(" S ii=i,jj=j
 .I '$D(id),@$ZR["$$TSVD(" S id=i,jd=j ;МИКРОЗАПРОСЫ
 .I '$D(jjk),@$ZR["$$TSVV(" S jjk=j ;ВЕРТИКАЛЬ ЛОГИКИ НА БОКОВИНУ
 .;!!!!!!I '$D(jju),@$ZR["$$TSVU(" S jju=i_","_j ;УНИВЕРСАЛЬНЫЕ
 .I '$D(jjs),@$ZR["$$TSVL(" S jjs=i ;ГОРИЗОНТАЛЬ ЛОГИКИ НА ШАПКУ
 I '$D(ii) S $P(@(BSR_"(BST)"),"@",17)=1 G END
 I '$D(^%ZAPM.ed.BSbufB("F"_$G(%BS(3),$P)_$J_"u"_%BS(15),$G(ii,0),$G(jj,0))) S ls=" Не ОПРЕДЕЛЕНА ГЛАВНАЯ ФУНКЦИЯ СВОДКИ $$TSV !!! " G N
 I $D(id)&($D(jjk)) S ls=" ФУНКЦИИ $$TSVV и $TSVD НЕ СОВМЕСТИМЫ !!! " G N
 S i0=@$ZR,jj1=0 K @$ZR D P F i=1:1:6 I $E(@("ii"_i),1)=$C(34)&($E(@("ii"_i),$L(@("ii"_i)))=$C(34)) S @("ii"_i)=$E(@("ii"_i),2,$L(@("ii"_i))-1)
 S iii1=ii1,YES=1,iii2="" 
 F i=2:1 Q:$P(iii1,"^",i)=""  S ii1="^"_$P(iii1,"^",i),BSt=$P(ii1,",",$L(ii1,",")),BSr=$P(ii1,",",1,$L(ii1,",")-1),%zT=$ZT,$ZT="ER^%ZAPM.ed.BST3" D  S $ZT=$G(%zT) G END:'YES
 .S:BSr'["^" BSr="^"_BSr //S BSr=$$BSR^%ZAPM.ed.BSA(BSr) 
 .I BSr[$C(34) S BSr=$$TR^%ZAPM.ed.BSsFUNM(BSr,$C(34)_$C(34),$C(34))
 .I '$D(@(BSr_"(BSt)")) S ls=" Не Определена ИЛИ НЕ ДОСТУПНА "_BSr_","_BSt_" " G N
 .I $P(@(BSr_"(BSt)"),"@",17)'=2 S ls=" "_BSr_","_BSt_" НЕ БАЗА ДАННЫХ !!! " G N
 .S BSD=$$KBD^%ZAPM.ed.BSF12($NA(@BSr@(BSt))),BSD=$$BSR^%ZAPM.ed.BSA(BSD) I '$D(@BSD) S ls=" НЕ ОПРЕДЕЛЕНА БАЗА ДАННЫХ:"_BSD_" У "_BSr_","_BSt_" !!! " G N
 .S iii2=iii2_BSD_"@"_BSr_","_BSt_"!",BSr(i-1)=BSr,BSt(i-1)=BSt
 I i=2 S ls=" В $$TSV БАЗА ДАННЫХ НЕ ОПРЕДЕЛЕНА " G N
 S @(BSR_"(BST,""KEY"")")=iii2,KOLB=i-2,TTT=1
 S @(BSR_"(BST,""TSV"",1)")=KOLB,$ZT=$G(%zT) I +ii2 G:+ii2'=$G(jjs) NPV S ii="",ii=$O(^%ZAPM.ed.BSbufB("F"_$G(%BS(3),$P)_$J_"u"_%BS(15),+ii2,ii)) G:ii="" NPV S @(BSR_"(BST,""TSV"",1,1)")=+ii2 I ii2=1 S ls=" ФУНКЦИИ $$TSVL ДОЛЖНЫ НАХОДИТСЯ НИЖЕ ШАПКИ " G N
 I ii4'="" S @(BSR_"(BST,""TSV"",0)")=ii4 ;ЗАГОЛОВОК
 I +ii3 G:+ii3'=$G(jjk,$G(jd)) NPV S @(BSR_"(BST,""TSV"",1,2)")=+ii3
 I +ii5 S @(BSR_"(BST,""TSV"",1,7)")=ii5 ;НОМЕРА СРАВНЕНИЯ
 S ij3=ii3,ij2=ii2 I +ii3 S j5="",jj1=2 F i=1:1:se I $G(^%ZAPM.ed.BSbufB("F"_$G(%BS(3),$P)_$J_"u"_%BS(15),i,ij3))["$$TSVV" S i00=@$ZR K @$ZR F n=1:1:$L(i00,"$$TSVV")-1 S i0="$$TSVV"_$P(i00,"$$TSVV",n+1) K im1 D CHK G:'YES EN D
 .S @(BSR_"(BST,""TSV"",5,ii6,i)")="X ""I "_$S($E(im1,1)=$C(34)&($E(im1,$L(im1))=$C(34)):$E(im1,2,$L(im1)-1),1:im1)_""""_j3 K im1
 ;```        ```I +ij2 S j5="",jj1=1 F k=1:1:ke I $G(^%ZAPM.ed.BSbufB("F"_$G(%BS(3),$P)_$J_"u"_%BS(15),+ij2,k))["$$TSVL" S i00=@$ZR K @$ZR F n=1:1:$L(i00,"$$TSVL")-1 S i0="$$TSVL"_$P(i00,"$$TSVL",n+1) D CHK G:'YES EN S @(BSR_"(BST,""TSV"",4,ii6,k)")=j3
 ;I +ij2 S j5="",jj1=1 F k=1:1:ke I $G(^%ZAPM.ed.BSbufB("F"_$G(%BS(3),$P)_$J_"u"_%BS(15),+ij2,k))["$$TSVL" S i00=@$ZR K @$ZR X "I "_i00 G:'YES EN S @(BSR_"(BST,""TSV"",4,1,k)")=j3
 I +ij2 S j5="",jj1=1 F k=1:1:ke I $G(^%ZAPM.ed.BSbufB("F"_$G(%BS(3),$P)_$J_"u"_%BS(15),+ij2,k))["$$TSVL" S i00=@$ZR K @$ZR F n=1:1:$L(i00,"$$TSVL")-1 S i0="$$TSVL"_$P(i00,"$$TSVL",n+1) D CHK G:'YES EN S @(BSR_"(BST,""TSV"",4,ii6,k)")=$$t(j3)
 I $D(^%ZAPM.ed.BSbufB("F"_$G(%BS(3),$P)_$J_"u"_%BS(15),$G(id,0),$G(jd,0))) D TS^%ZAPM.ed.BSF11 I 'ls G N ;ДИНАМИЧЕСКАЯ БОКОВИНА
 I $D(jju) S @(BSR_"(BST,""TSV"",1,4)")=jju
 S i="",j1="",j2=1,jj1=1
 ;```!!!!!!!!F  S i=$O(^%ZAPM.ed.BSbufB("F"_$G(%BS(3),$P)_$J_"u"_%BS(15),i)) Q:i=""  S j="" F  S j=$O(^%ZAPM.ed.BSbufB("F"_$G(%BS(3),$P)_$J_"u"_%BS(15),i,j)) Q:j=""  I $G(^(j))["$$TSVU" S i0=@$ZR K @$ZR D CHK G:'YES EN S @(BSR_"(BST,""TSV"",3,ii6,i,j)")=j3
 S i="",j1="",jj1=0
 F  S i=$O(^%ZAPM.ed.BSbufB("F"_$G(%BS(3),$P)_$J_"u"_%BS(15),i)) Q:i=""  S j="" F  S j=$O(^%ZAPM.ed.BSbufB("F"_$G(%BS(3),$P)_$J_"u"_%BS(15),i,j)) Q:j=""  I $G(^(j))["$$TSVGL" S i0=@$ZR K @$ZR D CHK G EN:'YES S @(BSR_"(BST,""TSV"",2,1,$G(j2(ii6),1))")=$P(j3,",%2="),j2(ii6)=$G(j2(ii6),1) ;!!!,1,->,ii6,
 G END
t(I) Q:ii4'=1 I
 I ii5=1 S I="D CY(1)" Q I
 Q "D CY("_$$TR^%ZAPM.ed.BSsFUNM($E(ii1,2,$L(ii1)-1),$C(34)_$C(34),$C(34))_")"
CHK X WA S YES=1,j3="" D P Q:'YES  S ii6=+ii6 I TTT,ii6>KOLB!(ii6<1) S:jj1=2 ii6=0 I jj1=1 S ls=" НЕ КОРРЕКТНЫЙ НОМЕР БАЗЫ ДАННЫХ В $$TSVL в клетке{"_ij2_","_k_"} " G N
 Q:'YES  S j3=" S ",jj2="" D:jj1  Q:j3=""  F j4=1:1:5 S j3=j3_$S(jj1=2:"q",1:"%")_j4_$S(@("ii"_j4)[$C(34):("="_@("ii"_j4)_","),1:("="""_@("ii"_j4)_""","))
 .I jj1=2 S im1=ii1,ii1=ii2,ii2=ii3,ii3=ii4,ii4=ii5,ii5="" S:$L(im1)<3 im1="1" I ii1'["," S j3="" Q
 .I $L(ii4)<2 S ii4=1
 .S jj2="CYC"_$S(ii2["~":4,ii2="":1,+ii2:3,1:2) I $D(im1) S jj2="CY3"
 .I jj2["3" D
 ..F  Q:ii4'["""""s"  S ii4=$P(ii4,"""""s")_$C(34,34,221,222,223,224)_$P(ii4,"""""s",2,99)
 ..F  Q:ii4'[",k"  S ii4=$P(ii4,",k")_$C(44,231,232,233,234)_$P(ii4,",k",2,99)
 .I $L(ii4)>2&(jj2'["3") S jj2=" X ""I ""_%4 I  D "_jj2 Q
 .S jj2=" D "_jj2
 S j3=$E(j3,1,$L(j3)-1)_jj2 Q
N D O^%ZAPM.ed.BSF7 S YES=0 G EN
NPL S ls=" НЕ ОПРЕДЕЛЕНО ТЕЛО ЦИКЛА СПИСКА В СТРОКЕ "_+ii2 G N
NPV S ls=" НЕ ПРАВИЛЬНО ОПРЕДЕЛЕНЫ СТРОКА И КОЛОНКА Ф.$$TSVV,$$TSVL В $$TSV " G N
P S i1=i0,i5=$P($P(i1,"$$",2,255),"(")
 I '$D(^%ZAPM.ed.BSFUN(i5)) S ls=" ФУНКЦИЯ "_i5_" НЕ ОПРЕДЕЛЕНА !!!" G N
 S pr=$G(^%ZAPM.ed.BSFUN(i5,"9,4"))_"!"_$G(^%ZAPM.ed.BSFUN(i5,"11,4")),i2=$P($P(i1,"$$",2,9999),"(",2,9999)
 S i2=$P($P(i1,"$$",2,9999),"(",2,9999)
 S z=$E($P(i1,"$$"),$L($P(i1,"$$")))
 S i4=1 F i3=1:1:$L(i2) S:$E(i2,i3)="(" i4=i4+1 S:$E(i2,i3)=")" i4=i4-1 Q:$E(i2,i3)=")"&(i4=0)
 S i2=$E(i2,1,i3-1)_",",(ii1,ii2,ii3,ii4,ii5,ii6)="" I $P(pr,"!")=1 S ii1=$E(i2,1,$L(i2)-1),i3=1 G FF
 E  S i7=1 F i3=1:1:+$P(pr,"!") D  S @("ii"_i3)=$E(i2,i7,i6-1),i7=i6+1 D FF
 .S (h5,i5,i4)=0 F i6=i7:1:$L(i2) Q:$E(i2,i6)=""  S:$E(i2,i6)="{" h5=h5+1 S:$E(i2,i6)="}" h5=h5-1 S:$E(i2,i6)=$C(34) i5=i5+1 S:$E(i2,i6)="Ї" i4=i4+1 S:$E(i2,i6)="ї" i4=i4-1 Q:$E(i2,i6)=","&(i4=0)&('(i5#2))&(h5=0)
 Q
FF  F  Q:@("ii"_i3)'["{"  D  S @("ii"_i3)=$P(@("ii"_i3),"{")_"$G(^("_$C(34,34)_hh_$C(34,34)_"))"_$P(@("ii"_i3),"}",2,99)
 .I '$G(ii6) S ii6=1
 .S hi=$P($P(@("ii"_i3),"{",2),"}") I hi'["-",hi'["+",$P($P($G(@(BSr(ii6)_"(BSt(ii6),"_hi_")")),"@",18),"#")'="" S hh=$P($P($G(@$ZR),"@",18),"#") Q
 .E  S hh=hi
 I @("ii"_i3)["$$" S ggg=@("ii"_i3) D  S:YES @("ii"_i3)=ggg
 .D SI^%ZAPM.ed.BSN N (%BS,vl,%zT,%KAT,%File,ggg,YES) S i0=ggg D FUN^%ZAPM.ed.BSFT S ggg=i0 Q
e Q
F ;ЗАМЕНА "{}" НА "Її" ДЛЯ ФУНКЦИИЙ ТИПА SUM,MAX,MIN...
 S i4=1 F i3=1:1:$L(i2) Q:$E(i2,i3)=""  S:$E(i2,i3)="(" i4=i4+1 S:$E(i2,i3)=")" i4=i4-1 Q:$E(i2,i3)=")"&(i4=0)
 S i1=$P(i1,"$$")_"$$"_$P($P(i1,"$$",2),"(")_"("_$TR($E(i2,1,i3),"{}","Її")_$E(i2,i3+1,9999) Q
ER I $ZE["INDER" S ls=" Ошибка В имени ТАБЛИЦЫ "_BSr_","_BSt G N
 I $ZE["NOSYS>"!($ZE["NOUCI>")!($ZE["<NAMESPACE") S ls=" НЕДОСТУПНА БАЗА ДАННЫХ "_BSD G N
 S ls=$ZE G N
]]></Routine>


<Routine name="%ZAPM.ed.BST4" type="MAC" languagemode="0"><![CDATA[
%BST4 ;ПРИКРЕПЛЕННЫЕ ТАБЛИЦЫ К БАЗЕ ДАННЫХ;MTBD;KEYPAS ; 18:56   09.06.99
MTBD S $ZT="ErrMT^%ZAPM.ed.BST4",YES=1,li=$$GLOBAL^%ZAPM.ed.BSF9(IMQ) I $G(@li@("KEY",key,5))'["$MTBD^" Q
 ;!!!S MaS=$$TR^%ZAPM.ed.BSsFUNM("^"_$P($P(@$ZR,"^",2),$C(34)_")"),$C(34)_$C(34),$C(34)) I MaS="^" S ls=" МАССИВ для MTBD НЕ ОПРЕДЕЛЕН " G O
 X "S MaS="_$P(@$ZR,"I ",2,99) I $P(MaS,"!",2)=""&($P(MaS,"!",3)="") S ls="И СЕЛЕКТОР ,и ФОРМУЛА для MTBD НЕ ОПРЕДЕЛЕНЫ. "_$P(MaS,"!",4)_" ! "_$P(MaS,"!",5),YES=0 G O
 I $P(MaS,"!",2)'="" S li=$G(@$P(MaS,"!",2)@(1,d)) I li="" G:$P(MaS,"!",3)'="" MTBF S ls=" Узел '"_$ZR_"' в Мультибазовом Селекторе НЕ ОПРЕДЕЛЕН ",YES=0 G O
 I $P(MaS,"!",2)="" G MTBF:$P(MaS,"!",3)'=""
MTB S MTr=$P(li,",",1,$L(li,",")-1),MTt=$P(li,",",$L(li,",")),IMQ=li Q
MTBF X "S li="_$P(MaS,"!",3) G MTB
ErrMT S ls=$$ErrSay^%ZAPM.ed.BSF8($ZE) G O
K5 S k66=$P(k6,","),k666=$P(k6,",",2) S:k66>5 k66=5 S:k666>79 k666=79 S:'k66 k66=1 S:'k666 k666=70 S k6=k66_"@"_k666 K k66,k666 Q
TAB I key=0 S ls=" К ИМЕННОМУ КЛЮЧУ ТАБЛИЦУ НЕ ПРИКРЕПИТЬ " D O G D
 D TA G D:'YES D TIR,RIT^%ZAPM.ed.BSF3 G D:'YES I li="",YES S ls=" ДЛЯ УДАЛЕНИЯ ИСПОЛЬЗУЙТЕ F8 " D O G D
 S Ta=$P($G(@(BSr_"(BSt)"),2),"@",17) I "2,3,4"[Ta&(Ta'="") S ls=" НЕЛЬЗЯ ПРИКРЕПИТЬ К КЛЮЧУ СПИСОК,СВОДКУ,ТАБЛ.C БАЗОЙ " D O G D
 S (TaB,IYI)=BSr_","_BSt D OkMsg^%ZAPM.ed.BSXfun("Вводить данные в прикрепленную таблицу  можно  только после          факта    прикрепления")
 D NE^%ZAPM.ed.BSN,TAB1 S R1=27
 G D
O D O^%ZAPM.ed.BSF7 Q
TA N %ddd S Tta=1,YES=0 S:ny>2 %ddd=d D TAB1 D:$D(%ddd) DDD I '$D(@(%NAm_"""@%BS"")")) D  Q:'YES
 .I $E(%NAm,$L(%NAm))="(" D ECT Q
 .I $D(@($E(%NAm,1,$L(%NAm)-1)_")")) D ECT Q
 .S (li,TaB)=$G(@(%NAm_"""@%BS"")")),YES=1 K Tta Q
D K Ta,TaB,Tab,PRr,%ddd Q
RaT(li) D RIT Q BSr_"("_BSt
TaR(li) D TIR Q li
ECT S ls=" У КЛЮЧА УЖЕ ЕСТЬ ПОТОМКИ " D O^%ZAPM.ed.BSF7 S YES=0 Q
RIT S MaS=1 D RII^%ZAPM.ed.BSF3 Q
 ;;;TIR S:li?.N1",".N li="" S BSr=$P(li,",",1,$L(li,",")-1),BSt=$P(li,",",$L(li,",")) D  S li=BSt_","_BSr_","_BSu_","_BSs Q
 ;;;.I BSr["]" S BSu=$P(BSr,$C(34),2),BSs=$P(BSr,$C(34),4),BSr=$P(BSr,"]",2) Q
 ;;;.S (BSu,BSs)="",BSr=$P(BSr,"^",2)
TIR S:li?.N1",".N li="" I li'[")" S BSr=$P(li,",",1,$L(li,",")-1),BSt=$P(li,",",$L(li,",")) D  S li=$S(li[",<>":li,1:(BSt_","_BSr_","_BSu_","_BSs)) Q
 .I BSr["]" S BSu=$P(BSr,$C(34),2),BSs=$P(BSr,$C(34),4),BSr=$P(BSr,"]",2) Q
 .S (BSu,BSs)="",BSr=$P(BSr,"^",2)
 S BSr=$P(li,"("),BSt=$P($P(li,"(",2),")") S BSt=$S(BSt=+BSt:BSt,1:$E(BSt,2,$L(BSt)-1)),BSt=$$TR^%ZAPM.ed.BSsFUNM(BSt,$C(34,34),$C(34)) ;```$P(BSt,$C(34),2))
 S BSu=$P(BSr,$C(34),2),BSs=$P(BSr,$C(34),4) S:BSr["]" BSr=$P(BSr,"]",2) ;4.;S:BSr["|" BSr=$P(BSr,"|",3)
 S li=BSt_","_BSr_","_BSu_","_BSs Q
TAB1 I '$D(%w(3)) D PASDD^%ZAPM.ed.BST1 E  Q
 D %NAm Q:$D(Tta)
TAB2 S ls=" Повесить на:"_%NAm_" таблицу ,Вы уверены ? " D YES^%ZAPM.ed.BSF I 'YES Q
 D L^%ZAPM.ed.BS3(%NAm) I LOC S @(%NAm_"""@%BS"")")=TaB
 D U^%ZAPM.ed.BS3(%NAm) Q
%NAm I '$D(%KEYS) S YES=0 Q
 S %NAm=$$BSD^%ZAPM.ed.BSA(BSD,$G(%KEYS(0))) F ii=1:1:%KEYS Q:'$D(%KEYS(ii))  S %NAm=%NAm_$S(%KEYS(ii)=+%KEYS(ii):%KEYS(ii),1:$C(34)_%KEYS(ii)_$C(34))_","
 Q
DDD S %NAm=%NAm_$S(%ddd=+%ddd:%ddd,1:$C(34)_%ddd_$C(34))_"," Q
PBD I $G(%BS("Tmp","AKBD",BSD),"RWD")="P" D ErrMsg^%ZAPM.ed.BSXfun("ПОЛЬЗОВАТЕЛЮ `"_$G(%BS(12))_"` ВХОД В ПРИКРЕПЛЕННУЮ ТАБЛИЦУ ЗАПРЕЩЕН !") S ny=0 Q
 S ls="НАСЧЕТ БУФЕРА ДЛЯ ПРИКРЕПЛЕННОЙ ТАБЛИЦЫ " D WAITS^%ZAPM.ed.BSF2,Key^%ZAPM.ed.BST1
 S IYI=@$ZR,PRr=BSR,PRt=BST,BSR=$P(IYI,",",1,$L(IYI,",")-1),BST=$P(IYI,",",$L(IYI,",")),B=@(BSR_"(BST)"),se=$P(B,"@",28),ke=$P(B,"@",29)
 K ^%ZAPM.ed.BSbufB("BB"_$G(%BS(3),$P)_$J_"u"_%BS(15)) D FOR^%ZAPM.ed.BSF3 X I_" D BSD^%ZAPM.ed.BST1" D CALC^%ZAPM.ed.BSF3,COL^%ZAPM.ed.BSF3,ENTER^%ZAPM.ed.BSN,BDS S BSR=PRr,BST=PRt K PRr,PRt Q
 Q
ERR D O^%ZAPM.ed.BSF7 X "I 0" S YES=0,$ZT=$G(%zT) Q
BDS Q:'$P($G(^%ZAPM.ed.BSbufB("BB"_$G(%BS(3),$P)_$J_"u"_%BS(15))),"@",2)  N tIm S ls=" Записываем в Базу Данных результаты коррекции пpикpепленной таблицы ? " D YES^%ZAPM.ed.BSF I 'YES K ^%ZAPM.ed.BSbufB("BB"_$G(%BS(3),$P)_$J_"u"_%BS(15)) Q
 D %NAm^%ZAPM.ed.BST1,FOR^%ZAPM.ed.BSF3 X I_" D 3333" S tIm=$P($G(@($E(%NAm,1,$L(%NAm)-1)_")")),",",5,6),@($E(%NAm,1,$L(%NAm)-1)_")")=$$h^%ZAPM.ed.BS3()_","_$G(%BS(12))_",1,"_tIm
 K ^%ZAPM.ed.BSbufB("BB"_$G(%BS(3),$P)_$J_"u"_%BS(15)) Q
3333 Q:$P(@(BSR_"(BST,ny,nx)"),"@",9)<2  I $D(^%ZAPM.ed.BSbufB("BB"_$G(%BS(3),$P)_$J_"u"_%BS(15),ny,nx)) S zr=@$ZR D  Q
 .I $P($P(@(BSR_"(BST,ny,nx)"),"@",18),"#")'="" S nynx=$P($P(^(nx),"@",18),"#")
 .E  S nynx=ny_","_nx
 .I zr="" K @(%NAm_"nynx)") Q
 .S @(%NAm_"nynx)")=zr ;ЗАПИСЬ В Б.Д.
 Q
]]></Routine>


<Routine name="%ZAPM.ed.BST5" type="MAC" languagemode="0"><![CDATA[
%BST5 ;VIEW-КИНЕМАТИКА ТАБЛИЦЫ,TAB ; 10:51  3-DEC-94
 I $G(Mx,0)=-1 S l=$P(@(BSR_"(BST,BSY(BS0),BSX(BS0))"),"@",4) D Z(BSY1(BS0),BSX1(BS0),BSY2(BS0),BSX2(BS0)-l+1),V(BSY1(BS0),BSX1(BS0)+l-1),LF Q
 I $G(Mx,0)>0 D Z(BSY1(BS0),Mx,BSY2(BS0),BSX2(BS0)),V(BSY1(BS0),BSX1(BS0)-1),RT Q
 I $G(My,0)=-1 S l=$P(@(BSR_"(BST,BSY(BS0),BSX(BS0))"),"@",3) D Z(BSY1(BS0),BSX1(BS0),BSY2(BS0)-l,BSX2(BS0)+1),V(BSY1(BS0)+l,BSX1(BS0)-1),UP Q
 I $G(My,0)>0 D Z(My,BSX1(BS0),BSY2(BS0),BSX2(BS0)+1),V(BSY1(BS0),BSX1(BS0)-1),DN Q
 G MOV^%ZAPM.ed.BST
Z(bY1,bX1,bY2,bX2) F b=1:1:(bY2-bY1+1) S BFL(b)=$V(bY1+b-2*160+(bX1-1*2)+%BS(17),-1,bX2-bX1*2,1)
 Q  ;зап.часть экр. в локаль с bX1,bY1,bX2,bY2
V(bY1,bX1) S b="" F  S b=$O(BFL(b)) Q:b=""  ;V bY1+b-2*160+(bX1*2)+%BS(17):-1:BFL(b)::1
 K BFL Q  ;восст.часть экр. из локали В точку bY1,bX1
DN K BS1,BS2,BY
 S BSII=BSX(BS0) K ENDDN F BSI=BSY(BS0):1 Q:BSI>se  D Y Q:$D(ENDDN)
 Q:MYy=BY($O(BY(""),-1))  K ENDDN F BSI=MYy+1:1 Q:BSI>se  K ENDRI D  Q:$D(ENDDN)
 .F BSII=BSX(BS0):1 Q:BSII>ke  D KLE Q:$D(ENDRI)!($D(ENDDN))
 Q
Y I $D(@(BSR_"(BST,BSI,BSII)")) S BS=^(BSII) Q:'$P(BS,"@",3)  I '$D(BS1) S BS1=$P(BS,"@")+1,BS2=$P(BS,"@",2)+1 I 'BS0 S (BS(1),BS(2))=1
 I (($P(BS,"@")+$P(BS,"@",3)-2)-BS1+2+BSY1(BS0))>BSY2(BS0) S ENDDN=1 Q
 S BY($P(BS,"@")-BS1+1+BSY1(0))=BSI Q
 Q
RT K BS1,BS2,BX
 S BSI=BSY(BS0) K ENDRI F BSII=BSX(BS0):1 Q:BSII>ke  D X Q:$D(ENDRI)
 Q:$O(BX(""))=""  Q:MXx=BX($O(BX(""),-1))  K ENDDN F BSI=BSY(BS0):1 Q:BSI>se  K ENDRI D  Q:$D(ENDDN)
 .F BSII=MXx:1 Q:BSII>ke  D KLE Q:$D(ENDRI)!($D(ENDDN))
 Q
X I $D(@(BSR_"(BST,BSI,BSII)")) S BS=^(BSII) Q:'$P(BS,"@",4)  I '$D(BS1) S BS1=$P(BS,"@")+1,BS2=$P(BS,"@",2)+1 I 'BS0 S (BS(1),BS(2))=1
 I (($P(BS,"@",2)+$P(BS,"@",4)-2)-BS2+2+BSX1(BS0))>BSX2(BS0) S ENDRI=1 Q
 S BX($P(BS,"@",2)-BS2+1+BSX1(0))=BSII Q
KLE W $$atr^%ZAPM.ed.BS3(0) S CLR=COLOR I $D(@(BSR_"(BST,BSI,BSII)")) S BS=^(BSII) Q:'$P(BS,"@",4)
 I (($P(BS,"@")+$P(BS,"@",3)-2)-BS1+2+BSY1(BS0))>BSY2(BS0) S ENDDN=1 Q
 I (($P(BS,"@",2)+$P(BS,"@",4)-2)-BS2+2+BSX1(BS0))>BSX2(BS0) S ENDRI=1 Q
 I $P(BS,"@",10) S CLR=$P(BS,"@",10)
 I $P(BS,"@",12) S CLR=$P(%BS,"!",3)
 I $P(BS,"@",9)=1 S (d1,d,d0)=$P(BS,"@",15)
 E  S (d1,d,d0)=$G(^%ZAPM.ed.BSbufB("BB"_$G(%BS(3),$P)_$J_"u"_%BS(15),BSI,BSII))
 I d0="" S d0=0
 I $P(BS,"@",8)'="" D  S $ZT=$G(%zT)
 .S %zT=$ZT,$ZT="FFF^%ZAPM.ed.BST",ny=BSI,nx=BSII I '$P(BS,"@",8) X $G(@(BSR_"(BST,""FTR"","_BSI_","_BSII_")")) Q
 .X $G(@(BSR_"(BST,""FTR"","_$P(BS,"@",8)_")"))
 I '$D(%VDB) F BSF=1:1:$P(BS,"@",3) Q:($P(BS,"@")+BSF-BS1)>BSY2(BS0)  D  W $J("",$P(BS,"@",4)) D  W $E(d1,BSF*$P(BS,"@",4)-$P(BS,"@",4)+1,$P(BS,"@",4)+($P(BS,"@",4)*(BSF-1)))
 .W /CUP(($P(BS,"@")+BSF-BS1+BSY1(BS0)),($P(BS,"@",2)-BS2+1+BSX1(BS0))),$$atr^%ZAPM.ed.BS3(CLR) Q
 Q
UP K ENDDN,BZ,BS1,BS2,ENDRI S BSI=BSY(BS0) F BSII=BSX(BS0):1 Q:BSII>ke  D WR Q:$D(ENDRI)
 Q:BS0  K BY S BSII=BSX(0) F BSI=BSY(0):1 Q:BSI>se  D YY Q:$D(ENDDN)
 Q
LF K ENDDN,BS1,BS2,BZ,ENDRI S BSII=BSX(BS0) F BSI=BSY(BS0):1 Q:BSI>se  D WR Q:$D(ENDDN)
 Q:BS0  K BX S BSI=BSY(0) F BSII=BSX(0):1 Q:BSII>ke  D XX Q:$D(ENDRI)
 Q
XX I $D(@(BSR_"(BST,BSI,BSII)")) S BS=^(BSII) Q:'$P(BS,"@",4)
 I (($P(BS,"@",2)+$P(BS,"@",4)-2)-BS2+2+BSX1(BS0))>BSX2(BS0) S ENDRI=1 Q
 S BX($P(BS,"@",2)-BS2+1+BSX1(0))=BSII Q
YY I $D(@(BSR_"(BST,BSI,BSII)")) S BS=^(BSII) Q:'$P(BS,"@",3)
 I (($P(BS,"@")+$P(BS,"@",3)-2)-BS1+2+BSY1(BS0))>BSY2(BS0) S ENDDN=1 Q
 S BY($P(BS,"@")-BS1+1+BSY1(0))=BSI Q  ;,BS(1)=0 Q
 Q
WR W $$atr^%ZAPM.ed.BS3(0) S CLR=COLOR I $D(@(BSR_"(BST,BSI,BSII)")) S BS=^(BSII) Q:'$P(BS,"@",4)  I '$D(BS1) S BS1=$P(BS,"@")+1,BS2=$P(BS,"@",2)+1
 I (($P(BS,"@")+$P(BS,"@",3)-2)-BS1+2+BSY1(BS0))>BSY2(BS0) S ENDDN=1 Q
 I (($P(BS,"@",2)+$P(BS,"@",4)-2)-BS2+2+BSX1(BS0))>BSX2(BS0) S ENDRI=1 Q
 I $P(BS,"@",10) S CLR=$P(BS,"@",10)
 I $P(BS,"@",12) S CLR=$P(%BS,"!",3)
 I $P(BS,"@",9)=1 S (d1,d,d0)=$P(BS,"@",15)
 E  S (d1,d,d0)=$G(^%ZAPM.ed.BSbufB("BB"_$G(%BS(3),$P)_$J_"u"_%BS(15),BSI,BSII))
 I d0="" S d0=0
 I $P(BS,"@",8)'="" D  S $ZT=$G(%zT)
 .S %zT=$ZT,$ZT="FFF^%ZAPM.ed.BST",ny=BSI,nx=BSII I '$P(BS,"@",8) X $G(@(BSR_"(BST,""FTR"","_BSI_","_BSII_")")) Q
 .X $G(@(BSR_"(BST,""FTR"","_$P(BS,"@",8)_")"))
 I '$D(%VDB) F BSF=1:1:$P(BS,"@",3) Q:($P(BS,"@")+BSF-BS1)>BSY2(BS0)  D  W $J("",$P(BS,"@",4)) D  W $E(d1,BSF*$P(BS,"@",4)-$P(BS,"@",4)+1,$P(BS,"@",4)+($P(BS,"@",4)*(BSF-1)))
 .W /CUP(($P(BS,"@")+BSF-BS1+BSY1(BS0)),($P(BS,"@",2)-BS2+1+BSX1(BS0))),$$atr^%ZAPM.ed.BS3(CLR) Q
e Q
STAB S Na=-1 G TA
TAB S Na=1
TA K MxS,MyS,MsS S mx=MX,my=MY S MR=0 D WO^%ZAPM.ed.BSTM S MR=1 D  I $D(MsS) S MX=mx,MY=my K MxS,MyS,MsS,mx,my,Na Q
 .F  S MX=$O(BX(MX),Na) D:MX=""  Q:$D(MsS)  I $P($G(@(BSR_"(BST,"_BY(MY)_","_BX(MX)_")")),"@",5)="" S MyS=1 Q
 ..S MX=$O(BX(""),Na),MY=$O(BY(MY),Na) D:MY=""  Q:$D(MsS)
 ...I $D(MxS) S MsS=1 Q
 ...S MxS=1,MY=$O(BY(""),Na)
 I $D(MyS) K MxS,MyS,MsS,mx,my,Na Q
 Q
]]></Routine>


<Routine name="%ZAPM.ed.BSTAT" type="MAC" languagemode="0"><![CDATA[
STAT ; Статистика по RPT файлу. (А.Нефедов) ; 15:18   12.06.99
 I $ZV["Cach"||($ZV["IRIS") D ErrMsg^%ZAPM.ed.BSXfun(" НЕТ РЕЖИМА В "_$ZV) Q
 S RPTName=$G(%BS(24,1),$P($GET(^%ZAPM.ed.BSS("SETUP",17,2)),"@",15))
 I RPTName=""!($E(RPTName)="^") W "- No RPT file defined.",! Q
 S BSTAT=$$TMPG^%ZAPM.ed.BSF11
 S BVOL=$$TMPG^%ZAPM.ed.BSF11
 S BERR=$$TMPG^%ZAPM.ed.BSF11
 D Wait^%ZAPM.ed.BSXfun("Checking "_RPTName)
 F %Dev=51:1:54 O %Dev::0 Q:$T
 I '$T D ErrMsg^%ZAPM.ed.BSXfun("All Dos devices are buzy.") Q
 S %FN=$$AddFile^%ZAPM.ed.BSDOS2(RPTName)
 O %Dev:(%FN:"R") U %Dev I $ZA U 0 D ErrMsg^%ZAPM.ed.BSXfun("file not found") Q
 S Entr=0
 F  R Line Q:$ZC  D:Line'=""
 .U 0
 .S Entr=Entr+1
 .S User=$P(Line,"§",3) I User="" S User="User:?"
 .I User="User:" S User="User:!SysOp"
 .S Vol=$P(Line,"§",4)  I Vol="" S Vol="?"
 .S Command=$P(Line,"§",5)
 .S Com=$P($P(Command,":",2),"%",1) I (Com="")!($A(Com)<32)!($F(Com,$C(0))'=0) S Com="?"
 .S Time=$P($P(Line,"§",6),":",2)
 .S ^(User)=$G(@BSTAT@(User))+1
 .S ^(Com)=$G(@BSTAT@(User,Vol,Com))+1
 .S ^(Com,^(Com))=Time
 .I Com="Begin" S @BSTAT@(User,Vol,"Timer","Flag")=1,^("Start")=Time
 .I (Com="Exit")&($G(@BSTAT@(User,Vol,"Timer","Flag"))=1) S ^("Flag")=0 D
 ..S TM=($P(Time,",",1)-$P(^("Start"),",",1))*3600*24+$P(Time,",",2)-$P(^("Start"),",",2)
 ..S TM=TM\60,@BSTAT@(User,Vol,"Timer")=TM
 ..Q
 .I $E(Com,1,5)="Mount" S @BVOL@(" "_$E(Com,6,$L(Com)),"Timer","Flag")=1,^("Start")=Time
 .I ($E(Com,1,8)="Dismount")&($G(@BVOL@(" "_$E(Com,10,$L(Com)),"Timer","Flag"))=1) S ^("Flag")=0 D
 ..S TM=($P(Time,",",1)-$P(^("Start"),",",1))*3600*24+$P(Time,",",2)-$P(^("Start"),",",2)
 ..S TM=TM\60,@BVOL@(" "_$E(Com,10,$L(Com)),"Timer")=TM
 ..Q
 .I $E(Com,1,5)="Mount" S @BVOL@(" "_$E(Com,6,$L(Com)),"LastOper")="Mount",^("LastUser")=User,^("LastSys")=Vol
 .I $E(Com,1,8)="Dismount" S @BVOL@(" "_$E(Com,10,$L(Com)),"LastOper")="Dismount",^("LastUser")=User,^("LastSys")=Vol
 .I (Com="Error")!(Com="BeginStop") D
 ..I Com="BeginStop" S SubC=" "_"BEGINSTOP Ошибка регистрации"
 ..I Com="Error" S SubC=" "_$E($P(Command,"<",2,99),1,40)
 ..S ^(SubC)=$G(@BERR@(SubC))+1
 ..S @BERR@(SubC,"LastUser")=User,@BERR@(SubC,"LastSys")=Vol
 ..I $G(@BSTAT@(User,Vol,"Timer","Flag"))=1 S ^("Flag")=0 D
 ...S TM=($P(Time,",",1)-$P(^("Start"),",",1))*3600*24+$P(Time,",",2)-$P(^("Start"),",",2)
 ...S TM=TM\60,@BSTAT@(User,Vol,"Timer")=TM
 ...Q
 ..Q
 .W $$atr^%ZAPM.ed.BS3(0),/CUP(24,52),Entr
 .U %Dev
 .Q
 U 0
 C %Dev S UTotal=0,Ref=""
 F  S Ref=$O(@BSTAT@(Ref)) Q:Ref=""  S UTotal=UTotal+1
 D OkMsg^%ZAPM.ed.BSXfun(Entr_" - events total, "_UTotal_" - users found.")
Down 
 S BSR="^%ZAPM.ed.BSS",BST="STAT" ;,^%ZAPM.ed.BSbufB("StaTu"_$G(%BS(3),$P))=BSTAT_"!"_BVOL_"!"_BERR
 D ^%ZAPM.ed.BST I R1=27 G Exit
 I ny=1 G Users
 I ny=2 G Mount
 G Errs
 ;Down Q
 W /ED(2)
 W /CUP(10,27),"1. Users summary."
 W /CUP(11,27),"2. Volumes information."
 W /CUP(12,27),"3. Errors detected."
 W /CUP(13,27),"4. Exit"
 S Arrow=5,R1=27,R2=91,R3=66
 F  D WCheck D CL^%ZAPM.ed.BSF4 R *R1 R:R1=27 *R2,*R3 D OP^%ZAPM.ed.BSF4 Q:R1=13!((R1>48)&(R1<53))
 G W1
WCheck 
  Q:(R1'=27)!(R2'=91)!((R3'=66)&(R3'=65))  S Temp=Arrow
  S:R3=66 Arrow=Arrow+1 S:Arrow>4 Arrow=1
  S:R3=65 Arrow=Arrow-1 S:Arrow<1 Arrow=4
  W /CUP(9+Temp,22),"   "
  W /CUP(9+Arrow,22),"==>",/CUP(9+Arrow,27)
  Q
W1 
 W /ED(2)
 S:R1'=13 Arrow=R1-48
 G:Arrow=4 Exit
 G:Arrow=1 Users
 G:Arrow=2 Mount
 G:Arrow=3 Errs
 G Down
 
Exit 
 ;S BSTAT=$P(^%ZAPM.ed.BSbufB("StaTu"_$G(%BS(3),$P)),"!"),BERR=$P(^%ZAPM.ed.BSbufB("StaTu"_$G(%BS(3),$P)),"!",3),BVOL=$P(^%ZAPM.ed.BSbufB("StaTu"_$G(%BS(3),$P)),"!",2)
 K @BSTAT,@BVOL,@BERR
 Q
 
Users ;S BSTAT=$P(^%ZAPM.ed.BSbufB("StaTu"_$G(%BS(3),$P)),"!")
 S (li,G)=$$TMPG^%ZAPM.ed.BSF11 D TIR^%ZAPM.ed.BST4
 S BSr=$P(li,",",2),BSt=$P(li,",")
 S i0="Пользователь"
 S i0=$$W(i0,23)_"Система"
 S i0=$$W(i0,41)_"Регистрации"
 S i0=$$W(i0,56)_"Время"
 S i0=$$W(i0,66)_"Ошибки"
 S Coment=i0
 S User=$O(@BSTAT@("")),Vol=""
 F  Q:User=""  D
 .S TBegin=0,TError=0,TTimer=0
 .F  S Vol=$O(@BSTAT@(User,Vol)) Q:Vol=""  D
 ..S HUser=User,HVol=Vol
 ..S:$E(HUser,1)=" " HUser=$E(HUser,2,$L(HUser))
 ..S:$E(HVol,1)=" " HVol=$E(HVol,2,$L(HVol))
 ..S HBegin=$G(@BSTAT@(User,Vol,"Begin")) S:HBegin="" HBegin="0" S TBegin=TBegin+HBegin
 ..S HError=$G(@BSTAT@(User,Vol,"Error")) S:HError="" HError="0" S TError=TError+HError
 ..S HTimer=$G(@BSTAT@(User,Vol,"Timer")) S:HTimer="" HTimer="0" S TTimer=TTimer+HTimer
 ..S t0="   "_HUser
 ..S t0=$$W(t0,26)_HVol
 ..S t0=$$W(t0,44)_HBegin
 ..S t0=$$W(t0,59)_HTimer
 ..S t0=$$W(t0,69)_HError
 ..D CR^%ZAPM.ed.BSTT
 ..Q
 .S t0="" D CR^%ZAPM.ed.BSTT
 .S t0=$$W(t0,35)_" Всего: "
 .S t0=$$W(t0,44)_TBegin
 .S t0=$$W(t0,59)_TTimer
 .S t0=$$W(t0,69)_TError
 .D CR^%ZAPM.ed.BSTT
 .S t0="" D CR^%ZAPM.ed.BSTT  D CR^%ZAPM.ed.BSTT
 .S User=$O(@BSTAT@(User))
 .Q
 D CREATE^%ZAPM.ed.BSTT
 K @G
 G Down
 
Mount ;S BVOL=$P(^%ZAPM.ed.BSbufB("StaTu"_$G(%BS(3),$P)),"!",2)
 S (li,G)=$$TMPG^%ZAPM.ed.BSF11 D TIR^%ZAPM.ed.BST4
 S BSr=$P(li,",",2),BSt=$P(li,",")
 S Vol=""
 S i0="Имя тома"
 S i0=$$W(i0,14)_"Время испол."
 S i0=$$W(i0,30)_"Послед. операция"
 S i0=$$W(i0,49)_"Пользователь"
 S i0=$$W(i0,62)_"Система   "
 S Coment=i0
 F  S Vol=$O(@BVOL@(Vol)) D:Vol'=""  Q:Vol=""
 .S HTimer=$G(@BVOL@(Vol,"Timer")) S:HTimer="" HTimer="?"
 .S HOper=$G(@BVOL@(Vol,"LastOper")) S:HOper="" HOper="?"
 .S HUser=$G(@BVOL@(Vol,"LastUser")) S:HUser="" HUser="?"
 .S HSys=$G(@BVOL@(Vol,"LastSys")) S:HSys="" HSys="?"
 .S t0="  "_Vol
 .S t0=$$W(t0,17)_HTimer
 .S t0=$$W(t0,33)_HOper
 .S t0=$$W(t0,52)_HUser
 .S t0=$$W(t0,65)_HSys
 .D CR^%ZAPM.ed.BSTT
 .Q
 D CREATE^%ZAPM.ed.BSTT
 K @G
 G Down
 
Errs ;S BERR=$P(^%ZAPM.ed.BSbufB("StaTu"_$G(%BS(3),$P)),"!",3)
 S (li,G)=$$TMPG^%ZAPM.ed.BSF11 D TIR^%ZAPM.ed.BST4
 S BSr=$P(li,",",2),BSt=$P(li,",")
 S Err=""
 S i0="Ошибка"
 S i0=$$W(i0,42)_"Число раз"
 S i0=$$W(i0,52)_"Пользователь"
 S i0=$$W(i0,65)_"Система"
 S Coment=i0
 F  S Err=$O(@BERR@(Err)) D:Err'=""  Q:Err=""
 .S HErr=$G(@BERR@(Err)) S:HErr="" HErr="0"
 .S HUser=$G(@BERR@(Err,"LastUser")) S:HUser="" HUser="?"
 .S HSys=$G(@BERR@(Err,"LastSys")) S:HSys="" HSys="?"
 .S t0="   "_$P(Err," ",2)
 .S t0=$$W(t0,30)_$E(Err,$F(Err," ",2),$F(Err," ",2)+12)
 .S t0=$$W(t0,45)_HErr
 .S t0=$$W(t0,55)_HUser
 .S t0=$$W(t0,68)_HSys
 .D CR^%ZAPM.ed.BSTT
 .Q
 D CREATE^%ZAPM.ed.BSTT
 K @G
 G Down
 
W(St,Num) 
 N I,S S S=St
 F I=$L(St):1:Num-1 S S=S_" "
 Q S
]]></Routine>


<Routine name="%ZAPM.ed.BSTESTD" type="MAC" languagemode="0"><![CDATA[
%BSTESTD ;Пример описания диалоговой панели ```(А.Нефедов) ; 16:56 10-JUN-98
 ;
 ;W !,$P($$ESDAY^%ZAPM.ed.BSsFUNR(8,$$h^%ZAPM.ed.BS3())," ")
 ;F  R *R1 R:R1=27 *R2:0,*R3:0 W !,R1," ",R2," ",R3 Q:R1=13
 ;W $NA(G)
 ;Q
 
 D ^%ZAPM.ed.BSDIAL ; Регистрация стандартных классов.
 ;
 ; Now, we have to declare basic class
 ;
 ; ClassName@Left@Top@Width@Height@Text@Enable@Visible@Color@Hint@HintColor@
 ; 1         2    3   4     5      6    7      8       9     10   11
 ; Alight@Focused@TabStop@TabOrder@CursorDef@EmptyChar@ForeColor@BackColor@
 ; 12     13      14      15       16           17        18        19
 ; FocusColor@ShadowColor1@ShadowColor2@Control1@Command@GroupNum@CanClose
 ; 20         21           22           23       24      25       26
 ; CursorDef1@CommitKey
 ; 27         28
 ;
 ;
 D ;:$D(^f1)=0
 .S ^f1="TDialog@5@5@50@13@Test Dialog@1@1@0@@7@0@@@@@ @0@7@8@0@0@@@@$$CanClose^%ZAPM.ed.BSTESTD()"
 .S ^f1("Label1")="TLabel@7@7@12@15@Test Label1@1@1@8@@7@0@@0@0@@ @0@7"
 .S ^f1("Label2")="TLabel@7@8@12@15@Test Label2@1@1@8@@2@0@@0@0@@ @0@7"
 .S ^f1("Label3")="TLabel@7@10@17@15@Test Label3@1@1@8@@7@1@@0@0@@ @0@7"
 .S ^f1("Button1")="TButton@10@16@8@1@Yes@1@1@8@@7@3@@1@1@@ @7@4@15@0@7@@D DoneDlg"
 .S ^f1("Button2")="TButton@25@16@8@1@No@1@1@8@@7@3@@1@2@@ @7@4@15@0@7@@@"
 .S ^f1("Button3")="TButton@40@16@8@1@Help@1@1@8@@7@3@@1@3@@ @7@4@15@0@7@@D O^%ZAPM.ed.BSF3"
 .S ^f1("Check1")="TCheck@35@11@8@1@[ ] Option1@1@1@8@@7@3@@1@7@@ @0@7@15@0@7@1@"
 .S ^f1("Check2")="TCheck@35@12@8@1@Option2 [ ]@1@1@8@@7@3@@1@8@@ @0@7@15@0@7@@"
 .S ^f1("Radio1")="TRadio@35@7@8@1@( ) Alternativ1@1@1@8@@7@3@@1@4@@ @0@7@15@0@7@1@@1"
 .S ^f1("Radio2")="TRadio@35@8@8@1@( ) Alternativ2@1@1@8@@7@3@@1@5@@ @0@7@15@0@7@@@1"
 .S ^f1("Radio3")="TRadio@35@9@8@1@Alternativ3 ( )@1@1@8@@7@3@@1@6@@ @0@7@15@0@7@@@1"
 .S ^f1("Label4")="TLabel@7@14@17@15@Enter your name: @1@1@8@@7@1@@0@0@@ @0@7"
 .S ^f1("Edit1")="TEdit@25@14@17@15@@1@1@8@Тут должно быть ваше имя  @7@1@@1@9@@­@0@7"
 .S ^f1("Clock1")="TClock@71@1@8@15@000@1@1@8@@7@1@@0@0@@ @0@7"
 .Q
 ;
 N Name
 S Name=$$TMPG^%ZAPM.ed.BSF11
 D ExecDlg^%ZAPM.ed.BSDIAL("^f1",Name)
 K @Name,Name
 Q
 
CanClose() 
 I $P(^f1("Edit1"),"@",6)="" D ErrMsg^%ZAPM.ed.BSXfun("Требуется имя.") Q 0
 Q 1
 
 
]]></Routine>


<Routine name="%ZAPM.ed.BSTIMER" type="MAC" languagemode="0"><![CDATA[
%BSTIMER ; ФОНОВЫЙ ТАЙМЕР ДЛЯ ТЕСТИРОВАНИЯ БАЗЫ ДАННЫХ НА СЕРВЕРЕ (C.Кривошеев) ; 18:17   04.04.2001
 ;NEW INTERVAL,ACTTIME,FTRUE,FFALSE,FBAT,I,M,DATTIME,DAT1,%ERR,DATT,STRING
 F I=1:1:3 H 1 L +%BStimer:0 E  I I=3 H
 S INTERVAL=$P(^%ZAPM.ed.BSS("TIMER",4,4),"@",15)
 S STRING=$P(^%ZAPM.ed.BSS("TIMER",5,4),"@",15)
 S DAT1=$$TiME()
 S ACTTIME=$P(DAT1,":",1)*3600+($P(DAT1,":",2)*60)+$P(DAT1,":",3)
 S FTRUE=$P(^%ZAPM.ed.BSS("TIMER",7,4),"@",15)
 S FFALSE=$P(^%ZAPM.ed.BSS("TIMER",9,4),"@",15)
 S FBAT=$P(^%ZAPM.ed.BSS("TIMER",11,4),"@",15)
1 HANG INTERVAL I $$EVENT D ACTION ;LOOP
 I $D(STOP) HALT
 G 1
SETTIME(T) I T'?1N.N1":"2N W !,"НЕКОРРЕКТНЫЙ ФОРМАТ ВРЕМЕНИ ! (ЧЧ:MM)" Q
 S $P(^%ZAPM.ed.BSS("TIMER",2,4),"@",15)=T ;УСТАНОВИТЬ НУЖНОЕ ВРЕМЯ
 D STATUS
 Q
TiME() Q $P(^%ZAPM.ed.BSS("TIMER",2,4),"@",15)
ATiME() S DAT1=$$TiME()
 Q $P(DAT1,":",1)*3600+($P(DAT1,":",2)*60)+$P(DAT1,":",3)
EVENT() ;СОБЫТИE
 S M=$P($$h^%ZAPM.ed.BS3(),",",2),ACTTIME=$$ATiME()
 I (M>(ACTTIME-(INTERVAL/2)))&(M<(ACTTIME+(INTERVAL/2)+1)) Q 1
 Q 0
ACTION ;ДЕЙСТВИЯ
 DO AUTO^VALIDATE
 S DATTIME=$$ESDAY^%ZAPM.ed.BSsFUNR(9,$$h^%ZAPM.ed.BS3())
 S DATT=$P($$h^%ZAPM.ed.BS3(),",",1)
 IF %ERR=0 D PROCTRUE J ^%ZAPM.ed.BSTIMER::0 H:$T  Q
 ;
 ;ЕСЛИ ОШИБКИ ЕСТЬ
 O 51:(FFALSE:"W") U 51 W "ERRORS"_DATTIME_":",!
 S I=""  F  S I=$O(%ERR(I)) Q:I=""  W %ERR(I),!
 C 51
 Q
PROCTRUE ;ЕСЛИ ОШИБОК НЕТ
 O 51:(FTRUE:"A") U 51 W "Test DataBase passed O'k  "_DATTIME_", File BackCopy is "_DATT_".arj",! C 51
 O 51:(FBAT:"W") U 51 W "rem   -=Creating "_DATTIME_"=-",!,STRING_DATT,! C 51
 Q
START ;ЗАПУСК НА СТАНЦИИ
SERVER ;ЗАПУСК НА СЕРВЕРЕ
 I '$D(^%ZAPM.ed.BSbufS) S ^%ZAPM.ed.BSbufS="BaSe MsW @РАЗДЕЛ НАСЧИТАННЫХ СВОДОК И СПИСКОВ",^%ZAPM.ed.BSMOLN="BaSe MsW @РАЗДЕЛ НАСЧИТАННЫХ СВОДОК И СПИСКОВ МОЛНИИ",^%ZAPM.ed.BSTABEL="BaSe MsW @РАЗДЕЛ НАСЧИТАННЫХ СВОДОК И СПИСКОВ ТАБЕЛЯ"
 J ^%ZAPM.ed.BSTIMER::0 I  W !,"%BS-TIMER STARTED. BASE VALIDATING IN "_$$TiME() Q
 W !,"%BS-TIMER NOT STARTED" Q
 Q
STATUS ;СТАТУС ТАЙМЕРА
 L +%BStimer:0 I  W !,"%BS-TIMER NOT ACTIVE" Q
 W !,"%BS-TIMER ALLREADY STARTED. BASE VALIDATING IN "_$$TiME()
 Q
]]></Routine>


<Routine name="%ZAPM.ed.BSTK" type="MAC" languagemode="0"><![CDATA[
%BSTK ;РЕДАКТИРОВАНИЕ КЛЮЧЕЙ ; 14:07   20.01.2000
E10 G:TIP=2 E10T I "1"[TIP S ls=" Вы ХОТИТЕ сделать вашу таблицу ,ТАБЛИЦЕЙ С БАЗОЙ ? " D YES^%ZAPM.ed.BSF G D:'YES,E10T
 I TIP=3!(TIP=4) D Yes^%ZAPM.ed.BSXfun(" Для '"_BST_"' ключи определяются функцией "_$S(TIP=3:"$$TSP",1:"$$TSV")_", но можно ОПРЕДЕЛИТЬ СПЕЦИАЛЬНЫЕ ПАРАМЕРЫ ВЫБОРОК КЛЮЧЕЙ только для '"_BST_"'! ВЫ ЭТО ХОТИТЕ ?",2) G ^%ZAPM.ed.BSTKS:YES>0 I TIP=4 D Yes^%ZAPM.ed.BSXfun(" Для СВОДОК определим РЕЖИМЫ насчета ?",2) D:YES>0
 .S Tmp=$$LineEdit^%ZAPM.ed.BSXfun($G(@BSR@(BST,"SVO"),"12"),"введите параметры насчета сводки..., для помощи введите F1","","","^%ZAPM.ed.BSHLP,SVO")
 .Q:YES<1  S @BSR@(BST,"SVO")=Tmp
 G D
E10T I $D(@(BSR_"(BST,""KEY"")")) S kk=0 G E100
 S OOO="^%ZAPM.ed.BS",OO=49 D 24^%ZAPM.ed.BSTM,^%ZAPM.ed.BSB,ZA^%ZAPM.ed.BSF G D:R1=27 S kk=%B
 I %B=4 D RIT^%ZAPM.ed.BSF3 G:'YES E10T S CHUr=BSR,CHUt=BST,BSR=BSr,BST=BSt,kk=0
E100 D SA^%ZAPM.ed.BSsBUF,Ed,RE^%ZAPM.ed.BSsBUF
D G 0^%ZAPM.ed.BSTM
Ed D BF I '$D(@(BSR_"(BST,""KEY"")")) D EDI G RES
 S BSd=$G(@$ZR,"@"),$P(^%ZAPM.ed.BSbufB("@K"_$G(%BS(3),$P)_$J_"u"_%BS(15),12,6),"@",15)=$G(@(BSR_"(BST,""KEY"")"),"???"),f="RTR"
 ;ИЗ КЛЮЧЕЙ В ТАБЛИЦУ ОПИСАНИЯ
 S $P(^%ZAPM.ed.BSbufB("@K"_$G(%BS(3),$P)_$J_"u"_%BS(15),12,7),"@",15)=$G(@BSR@(BST,"DDR")) ;ССЫЛКА НА УЗЕЛ DDR
 S $P(^%ZAPM.ed.BSbufB("@K"_$G(%BS(3),$P)_$J_"u"_%BS(15),12,8),"@",15)=$G(@BSR@(BST,"INDEX")) ;ССЫЛКА НА БД ПОИСКА
 F i=0:1:13 I $D(@(BSR_"(BST,""KEY"",i)")) K l1 D
 .F k=1:1:7,9,10,12:1:16,20 S @("k"_k)=$P(^(i),"@",k)
 .I $D(@(BSR_"(BST,""KEY"",i,1)"))  S l1=@$ZR,l2=$G(^(2)) I l1'="" S ^%ZAPM.ed.BSbufB("@K"_$G(%BS(3),$P)_$J_"u"_%BS(15),"RTR",i+2,5)=l1,^(5,1)=l2,$P(^%ZAPM.ed.BSbufB("@K"_$G(%BS(3),$P)_$J_"u"_%BS(15),i+2,5),"@",16)=0
 .I $D(@(BSR_"(BST,""KEY"",i,3)"))  S l1=@$ZR,l2=$G(^(4)) I l1'="" S ^%ZAPM.ed.BSbufB("@K"_$G(%BS(3),$P)_$J_"u"_%BS(15),"FTR",i+2,5)=l1,^(5,1)=l2,$P(^%ZAPM.ed.BSbufB("@K"_$G(%BS(3),$P)_$J_"u"_%BS(15),i+2,5),"@",8)=0
 .I $D(@(BSR_"(BST,""KEY"",i,5)"))  S l1=@$ZR,l2=$G(^(6)) I l1'="" S ^%ZAPM.ed.BSbufB("@K"_$G(%BS(3),$P)_$J_"u"_%BS(15),"COL",i+2,5)=l1,^(5,1)=l2,$P(^%ZAPM.ed.BSbufB("@K"_$G(%BS(3),$P)_$J_"u"_%BS(15),i+2,5),"@",13)=0
 .K KK F k=10:1 Q:'$D(@(BSR_"(BST,""KEY"",i,k)"))  S KK(k)=^(k),KK(k,1)=$G(^(k,1)),KK(k,2)=$G(^(2))
 .S BSk(i)=1,$P(^%ZAPM.ed.BSbufB("@K"_$G(%BS(3),$P)_$J_"u"_%BS(15),i+2,2),"@",15)=k6,$P(^(3),"@",15)=k15,$P(^(4),"@",10)=k10,$P(^(4),"@",15)=k5,$P(^(2),"@",14)=k7
 .S $P(^(8),"@",15)=k2,$P(^(6),"@",15)=k1,$P(^(7),"@",15)=k4,$P(^(5),"@",15)=k3,$P(^(9),"@",15)=k12 I k9'="" S $P(^(1),"@",15)=k9
 .D KK
EDIT D EDI G RES
KK S k="",$P(^(5),"@",13)=k13,$P(^(5),"@",14)=k14,$P(^(5),"@",20)=k20
 F  S k=$O(KK(k)) Q:k=""  D  S $P(^%ZAPM.ed.BSbufB("@K"_$G(%BS(3),$P)_$J_"u"_%BS(15),i+2,k),"@",15)=KK(k),^%ZAPM.ed.BSbufB("@K"_$G(%BS(3),$P)_$J_"u"_%BS(15),"COL",i+2,k)=KK(k,1),^(k,1)=KK(k,2),$P(^%ZAPM.ed.BSbufB("@K"_$G(%BS(3),$P)_$J_"u"_%BS(15),i+2,k),"@",13)=0
 .F ij=1:1:12 I '$D(^%ZAPM.ed.BSbufB("@K"_$G(%BS(3),$P)_$J_"u"_%BS(15),ij,k)) S ^%ZAPM.ed.BSbufB("@K"_$G(%BS(3),$P)_$J_"u"_%BS(15),ij,k)=$G(^%ZAPM.ed.BSS("KEY0",ij,k),^%ZAPM.ed.BSS("KEY0",ij,15))
 K KK Q
BF K ^%ZAPM.ed.BSbufB("K"_$G(%BS(3),$P)_$J_"u"_%BS(15)),^%ZAPM.ed.BSbufB("@K"_$G(%BS(3),$P)_$J_"u"_%BS(15)),BSd,BSk S BSt1="KEY"_kk,BSr1="^%ZAPM.ed.BSS",BSr2="^%ZAPM.ed.BSbufB",BSt2="@K"_$G(%BS(3),$P)_$J_"u"_%BS(15) D COPY
 F jj=2,4,5 S $P(@(BSr2_"(BSt2)"),"@",jj)=""
e Q
COPY S %zT=$ZT,$ZT="ERCOPY^%ZAPM.ed.BSTK"
 D Wait^%ZAPM.ed.BSXfun("дублируем.."_BSr1_","_BSt1_" в "_BSr2_","_BSt2)
 K @(BSr2_"(BSt2)") I $P($ZV,"Version ",2)'<4 M @(BSr2_"(BSt2)")=@(BSr1_"(BSt1)") Q
 I $D(@BSr2)["0" S:$D(@BSr1)=11 @BSr2=@BSr1
 S j=BSr1_"(BSt1)" I $D(@j) S jj=$P($ZR,")")_",",@(BSr2_"(BSt2)")=@j
 F  S j=$ZO(@j) Q:j'[jj  S @(BSr2_"(BSt2,"_$P(j,jj,2,9))=@j X $G(WA)
 Q
ERCOPY S ls=$$ErrSay^%ZAPM.ed.BSF8($ZE) D O^%ZAPM.ed.BSF7 S $ZT=$G(%zT),YES=0 Q
TRDEV N vor U %DEV S vor="]" ;4.;=$S($P($ZV,"Version ",2)<4:"]",1:"|")
 W:$D(@(TRe1_")"))'["0" (TRe1_")"),!,@(TRe1_")"),! U 0 W "." S j=TRe1_")",jj=$S(TRe1[vor:$P(TRe1,vor,2,99),1:$P(TRe1,"^",2,99))_","
 U %DEV F  S j=$ZO(@j) Q:$S(j[vor:$P(j,vor,2,99),1:j)'[jj  W j,!,@j,!
 U 0 Q
TREE K:'$D(NOKILLER) @(TRe2_")") I $P($ZV,"Version ",2)'<4 M @(TRe2_")")=@(TRe1_")") Q
 S:$D(@(TRe1_")"))'["0" @(TRe2_")")=@(TRe1_")") S ls="Копи..."_TRe1_" В "_TRe2_"..." D WAITS^%ZAPM.ed.BSF2 S j=TRe1_")",jj=$S(TRe1["]":$P(TRe1,"]",2,99),1:$P(TRe1,"^",2,99))_","
 F  S j=$ZO(@j) Q:$S(j["]":$P(j,"]",2,99),1:j)'[jj  S @(TRe2_","_$P(j,jj,2,9))=@j X $G(WA)
 Q
TRE K:'$D(NOKILLER) @TRe2 I $P($ZV,"Version ",2)'<4 M @TRe2=@TRe1 Q
 S:$D(@TRe1)'["0" @TRe2=@TRe1 S ls="Коп.мас..."_TRe1_" В "_TRe2_"..." D WAITS^%ZAPM.ed.BSF2 S j=TRe1,jj=$S(TRe1["]":$P(TRe1,"]",2,99),1:$P(TRe1,"^",2,99))_"("
 F  S j=$ZO(@j) Q:$S(j["]":$P(j,"]",2,99),1:j)'[jj  S @(TRe2_"("_$P(j,jj,2,9))=@j X WA
 Q
EDI D SI^%ZAPM.ed.BSN N (%BS,vl) S BST=$S($D(^%ZAPM.ed.BSbufB("@K"_$G(%BS(3),$P)_$J_"u"_%BS(15))):"@K"_$G(%BS(3),$P)_$J_"u"_%BS(15),1:"K"_$G(%BS(3),$P)_$J_"u"_%BS(15)) F k=1:1:9 S @("k"_k)=1
 S BSR="^%ZAPM.ed.BSbufB" D TAB^%ZAPM.ed.BSF1,^%ZAPM.ed.BST Q
RES N BSDDR,BSINDEX
 I $D(CHUr) S BSR=CHUr,BST=CHUt K CHUt,CHUr
 G:'$D(^%ZAPM.ed.BSbufB("K"_$G(%BS(3),$P)_$J_"u"_%BS(15),12,6)) END S BSD=$P(^%ZAPM.ed.BSbufB("K"_$G(%BS(3),$P)_$J_"u"_%BS(15),12,6),"@",15),%zT=$ZT,$ZT="E1^%ZAPM.ed.BSTK" D  S:BSD'["^" BSD="^"_BSD G:TIP=3!(TIP=4) REE I '$D(@BSD) S @$ZR="BSD - MSW@"_BSR_"@"_$E(BST,2,9) D CP^%ZAPM.ed.BSGCH(BSD,$P(%BS(22),",",3)) G RE
 .S BSDDR=$P(^%ZAPM.ed.BSbufB("K"_$G(%BS(3),$P)_$J_"u"_%BS(15),12,7),"@",15)
 .S BSINDEX=$P(^%ZAPM.ed.BSbufB("K"_$G(%BS(3),$P)_$J_"u"_%BS(15),12,8),"@",15)
 S $ZT=$G(%zT) E  I $P($G(@$ZR),"@",2)'=BSR!($P($G(@$ZR),"@",3)'=$E(BST,2,9)) S ls=" БАЗА ДАННЫХ ЧУЖАЯ !!! ВЫ ХОТИТЕ НАЗНАЧИТЬ ЕЁ И НАШЕЙ ТАБЛИЦЕ ?" D YES^%ZAPM.ed.BSF G YES:'YES
RE I BSD'=$G(BSd,BSD) D OkMsg^%ZAPM.ed.BSXfun("Старая База:"_BSd_" и новая:"_BSD_" не совпадает!") S ls="Редактируем снова?" D YES^%ZAPM.ed.BSF I YES G EDIT
REE F i=2:1:11 I $P($G(^%ZAPM.ed.BSbufB("K"_$G(%BS(3),$P)_$J_"u"_%BS(15),i,2)),"@",15)'="" I $D(BSk(i-2)) S BSk(i-2)=0
 K k0,Hidden F i=0:1:13 I $D(BSk(i)) I BSk(i) S k0=1
 I $D(k0) S ls="Старые и новые ключи не совпадают! Cнова будем редактировать?" D YES^%ZAPM.ed.BSF I YES G EDIT
 K @(BSR_"(BST,""KEY"")") S @(BSR_"(BST,""KEY"")")=BSD //!!! $$BSR^%ZAPM.ed.BSA(BSD)
 S $ZT=$G(%zT),f="RTR" D  F k=0:1:6,10,12:1:16 K @("k"_k)
 .I BSR="^%ZAPM.ed.BSS",BST="@USER" S %BS(18)=$$BSR^%ZAPM.ed.BSA(BSD)
 .I $G(BSDDR)'="" S @BSR@(BST,"DDR")=BSDDR
 .I $G(BSINDEX)'="" S @BSR@(BST,"INDEX")=BSINDEX
 ;ИЗ ТАБЛИЦЫ ОПИСАНИЯ В КЛЮЧИ
 F i=2:1:11 I $P($G(^%ZAPM.ed.BSbufB("K"_$G(%BS(3),$P)_$J_"u"_%BS(15),i,2)),"@",15)'="" S k0=i,k6=$P(^(2),"@",15),k7=$P(^(2),"@",14) D
 .S k15=$P(^(3),"@",15),k10=$P(^(4),"@",10),k2=$P(^(8),"@",15),k1=$P(^(6),"@",15),k3=$P(^(5),"@",15),k16=$P(^(5),"@",16),k4=$P(^(7),"@",15)
 .S k5=$P(^(4),"@",15),k14=$P(^(5),"@",14),k13=$P(^(5),"@",13),k12=$P(^(9),"@",15),k20=$P(^(5),"@",20),k9=$P(^(1),"@",15)
 .F k=10:1 Q:'$D(^(k))  S zr=$ZR,l1=@$ZR I $D(^%ZAPM.ed.BSbufB("K"_$G(%BS(3),$P)_$J_"u"_%BS(15),"COL",i,k)) S l2=@$ZR,l3=$G(^(k,1)),@(BSR_"(BST,""KEY"",i-2,k)")=$P(l1,"@",15),^(k,1)=l2,^(2)=l3 I @zr
 .S $P(@(BSR_"(BST,""KEY"",i-2)"),"@")=k1 F k=2:1:7,9,10,12:1:16,20 S $P(@$ZR,"@",k)=@("k"_k)
 .I $D(^%ZAPM.ed.BSbufB("K"_$G(%BS(3),$P)_$J_"u"_%BS(15),"RTR",i,5)) S l1=@$ZR,l2=$G(^(5,1)),@(BSR_"(BST,""KEY"",i-2,1)")=l1,^(2)=l2
 .I $D(^%ZAPM.ed.BSbufB("K"_$G(%BS(3),$P)_$J_"u"_%BS(15),"FTR",i,5)) S l1=@$ZR,l2=$G(^(5,1)),@(BSR_"(BST,""KEY"",i-2,3)")=l1,^(4)=l2
 .I $D(^%ZAPM.ed.BSbufB("K"_$G(%BS(3),$P)_$J_"u"_%BS(15),"COL",i,5)) S l1=@$ZR,l2=$G(^(5,1)),@(BSR_"(BST,""KEY"",i-2,5)")=l1,^(6)=l2
 .I k6="HiddenLastKey",k15="" D ErrMsg^%ZAPM.ed.BSXfun("В режиме HiddenLastKey В 3 колоночку надо ввести СИМВОЛЬНОЕ ИМЯ ВЫВОДА идентификации последнего ключа") S Hidden=1
 I $D(k0),($P(@(BSR_"(BST)"),"@",17)<2) S $P(@$ZR,"@",17)=2
 I $G(Hidden) D Yes^%ZAPM.ed.BSXfun("Cнова будем редактировать?") I YES G EDIT
END K ^%ZAPM.ed.BSbufB("K"_$G(%BS(3),$P)_$J_"u"_%BS(15)),^%ZAPM.ed.BSbufB("@K"_$G(%BS(3),$P)_$J_"u"_%BS(15)),k0,k1,k2,k3,k4,k5,k6,k10,k12,k16,k,k15,BSk,BSd,kk S $ZT=$G(%zT) Q
ER S ls=" ОШИБКА В ИМЕНИ ТАБЛИЦЫ ИЛИ РАЗДЕЛА ! "_$$ErrSay^%ZAPM.ed.BSF8($ZE) D O^%ZAPM.ed.BSF7 G D
E1 S ls=" ОШИБКА В ИМЕНИ БАЗЫ ДАННЫХ ! "_$$ErrSay^%ZAPM.ed.BSF8($ZE) D O^%ZAPM.ed.BSF7
YES S ls=" Продолжим корректировать описание Ключей и Базы данных ? " D YES^%ZAPM.ed.BSF I YES G EDIT
 S $ZT=$G(%zT) Q
]]></Routine>


<Routine name="%ZAPM.ed.BSTKS" type="MAC" languagemode="0"><![CDATA[
%BSTKS ; ПАРАМЕТРЫ КЛЮЧЕЙ ДЛЯ СПИСКОВ И СВОДОК; 16:08 14-FEB-97 ; 18:28 29-MAY-97
E10T S kk=0 G E100
 S OOO="^%ZAPM.ed.BS",OO=49 D 24^%ZAPM.ed.BSTM,^%ZAPM.ed.BSB,ZA^%ZAPM.ed.BSF G D:R1=27 S kk=0
 I %B=4 D RIT^%ZAPM.ed.BSF3 G:'YES E10T S CHUr=BSR,CHUt=BST,BSR=BSr,BST=BSt,kk=0
E100 D SA^%ZAPM.ed.BSsBUF,Ed,RE^%ZAPM.ed.BSsBUF
D G 0^%ZAPM.ed.BSTM
Ed D BF I '$D(@BSR@(BST,"Key")) D EDI G RES
 S f="RTR"
 ;ИЗ КЛЮЧЕЙ В ТАБЛИЦУ ОПИСАНИЯ
 F i=0:1:13 I $D(@(BSR_"(BST,""Key"",i)")) K l1 D
 .F k=1:1:7,9,10,12:1:16,20 S @("k"_k)=$P(^(i),"@",k)
 .I $D(@(BSR_"(BST,""Key"",i,1)"))  S l1=@$ZR,l2=$G(^(2)) I l1'="" S ^%ZAPM.ed.BSbufB("@K"_$G(%BS(3),$P)_$J_"u"_%BS(15),"RTR",i+2,5)=l1,^(5,1)=l2,$P(^%ZAPM.ed.BSbufB("@K"_$G(%BS(3),$P)_$J_"u"_%BS(15),i+2,5),"@",16)=0
 .I $D(@(BSR_"(BST,""Key"",i,3)"))  S l1=@$ZR,l2=$G(^(4)) I l1'="" S ^%ZAPM.ed.BSbufB("@K"_$G(%BS(3),$P)_$J_"u"_%BS(15),"FTR",i+2,5)=l1,^(5,1)=l2,$P(^%ZAPM.ed.BSbufB("@K"_$G(%BS(3),$P)_$J_"u"_%BS(15),i+2,5),"@",8)=0
 .I $D(@(BSR_"(BST,""Key"",i,5)"))  S l1=@$ZR,l2=$G(^(6)) I l1'="" S ^%ZAPM.ed.BSbufB("@K"_$G(%BS(3),$P)_$J_"u"_%BS(15),"COL",i+2,5)=l1,^(5,1)=l2,$P(^%ZAPM.ed.BSbufB("@K"_$G(%BS(3),$P)_$J_"u"_%BS(15),i+2,5),"@",13)=0
 .K KK F k=10:1 Q:'$D(@(BSR_"(BST,""Key"",i,k)"))  S KK(k)=^(k),KK(k,1)=$G(^(k,1)),KK(k,2)=$G(^(2))
 .S BSk(i)=1,$P(^%ZAPM.ed.BSbufB("@K"_$G(%BS(3),$P)_$J_"u"_%BS(15),i+2,2),"@",15)=k6,$P(^(3),"@",15)=k15,$P(^(4),"@",10)=k10,$P(^(4),"@",15)=k5,$P(^(2),"@",14)=k7
 .S $P(^(8),"@",15)=k2,$P(^(6),"@",15)=k1,$P(^(7),"@",15)=k4,$P(^(5),"@",15)=k3,$P(^(9),"@",15)=k12 I k9'="" S $P(^(1),"@",15)=k9
 .D KK
EDIT D EDI G RES
KK S k="",$P(^(5),"@",13)=k13,$P(^(5),"@",14)=k14,$P(^(5),"@",20)=k20
 F  S k=$O(KK(k)) Q:k=""  D  S $P(^%ZAPM.ed.BSbufB("@K"_$G(%BS(3),$P)_$J_"u"_%BS(15),i+2,k),"@",15)=KK(k),^%ZAPM.ed.BSbufB("@K"_$G(%BS(3),$P)_$J_"u"_%BS(15),"COL",i+2,k)=KK(k,1),^(k,1)=KK(k,2),$P(^%ZAPM.ed.BSbufB("@K"_$G(%BS(3),$P)_$J_"u"_%BS(15),i+2,k),"@",13)=0
 .F ij=1:1:11 I '$D(^%ZAPM.ed.BSbufB("@K"_$G(%BS(3),$P)_$J_"u"_%BS(15),ij,k)) S ^%ZAPM.ed.BSbufB("@K"_$G(%BS(3),$P)_$J_"u"_%BS(15),ij,k)=$G(^%ZAPM.ed.BSS("Key0",ij,k),^%ZAPM.ed.BSS("Key0",ij,9))
 K KK Q
BF K ^%ZAPM.ed.BSbufB("K"_$G(%BS(3),$P)_$J_"u"_%BS(15)),^%ZAPM.ed.BSbufB("@K"_$G(%BS(3),$P)_$J_"u"_%BS(15)),BSd,BSk S BSt1="Key0",BSr1="^%ZAPM.ed.BSS",BSr2="^%ZAPM.ed.BSbufB",BSt2="@K"_$G(%BS(3),$P)_$J_"u"_%BS(15) D COPY
 F jj=2,4,5 S $P(@(BSr2_"(BSt2)"),"@",jj)=""
 Q
COPY S %zT=$ZT,$ZT="ERCOPY^%ZAPM.ed.BSTK"
 K @(BSr2_"(BSt2)") I $P($ZV,"Version ",2)'<4 M @(BSr2_"(BSt2)")=@(BSr1_"(BSt1)") Q
 I $D(@BSr2)["0" S:$D(@BSr1)=11 @BSr2=@BSr1
 S j=BSr1_"(BSt1)",ls="КОПИ..."_BSr1_","_BSt1_" В "_BSr2_","_BSt2_"..." D WAITS^%ZAPM.ed.BSF2 I $D(@j) S jj=$P($ZR,")")_",",@(BSr2_"(BSt2)")=@j
 F  S j=$ZO(@j) Q:j'[jj  S @(BSr2_"(BSt2,"_$P(j,jj,2,9))=@j X $G(WA)
 Q
ERCOPY S ls=$$ErrSay^%ZAPM.ed.BSF8($ZE) D O^%ZAPM.ed.BSF7 S $ZT=$G(%zT),YES=0 Q
TRDEV N vor U %DEV S vor="]" ;4.;=$S($P($ZV,"Version ",2)<4:"]",1:"|")
 W:$D(@(TRe1_")"))'["0" (TRe1_")"),!,@(TRe1_")"),! U 0 W "." S j=TRe1_")",jj=$S(TRe1[vor:$P(TRe1,vor,2,99),1:$P(TRe1,"^",2,99))_","
 U %DEV F  S j=$ZO(@j) Q:$S(j[vor:$P(j,vor,2,99),1:j)'[jj  W j,!,@j,!
 U 0 Q
TREE K:'$D(NOKILLER) @(TRe2_")") I $P($ZV,"Version ",2)'<4 M @(TRe2_")")=@(TRe1_")") Q
 S:$D(@(TRe1_")"))'["0" @(TRe2_")")=@(TRe1_")") S ls="Копи..."_TRe1_" В "_TRe2_"..." D WAITS^%ZAPM.ed.BSF2 S j=TRe1_")",jj=$S(TRe1["]":$P(TRe1,"]",2,99),1:$P(TRe1,"^",2,99))_","
 F  S j=$ZO(@j) Q:$S(j["]":$P(j,"]",2,99),1:j)'[jj  S @(TRe2_","_$P(j,jj,2,9))=@j X $G(WA)
 Q
TRE K:'$D(NOKILLER) @TRe2 I $P($ZV,"Version ",2)'<4 M @TRe2=@TRe1 Q
 S:$D(@TRe1)'["0" @TRe2=@TRe1 S ls="Коп.мас..."_TRe1_" В "_TRe2_"..." D WAITS^%ZAPM.ed.BSF2 S j=TRe1,jj=$S(TRe1["]":$P(TRe1,"]",2,99),1:$P(TRe1,"^",2,99))_"("
 F  S j=$ZO(@j) Q:$S(j["]":$P(j,"]",2,99),1:j)'[jj  S @(TRe2_"("_$P(j,jj,2,9))=@j X WA
 Q
EDI D SI^%ZAPM.ed.BSN N (%BS,vl)
 S BST=$S($D(^%ZAPM.ed.BSbufB("@K"_$G(%BS(3),$P)_$J_"u"_%BS(15))):"@K"_$G(%BS(3),$P)_$J_"u"_%BS(15),1:"K"_$G(%BS(3),$P)_$J_"u"_%BS(15)) F k=1:1:9 S @("k"_k)=1
 S BSR="^%ZAPM.ed.BSbufB" D TAB^%ZAPM.ed.BSF1,^%ZAPM.ed.BST
 Q
RES I $D(CHUr) S BSR=CHUr,BST=CHUt K CHUt,CHUr
 S %zT=$ZT,$ZT="E1^%ZAPM.ed.BSTK" G REE
 S $ZT=$G(%zT)
RE 
REE F i=2:1:11 I $P($G(^%ZAPM.ed.BSbufB("K"_$G(%BS(3),$P)_$J_"u"_%BS(15),i,2)),"@",15)'="" I $D(BSk(i-2)) S BSk(i-2)=0
 K k0,Hidden
 K @(BSR_"(BST,""Key"")") S $ZT=$G(%zT),f="RTR" F k=0:1:6,10,12:1:16 K @("k"_k)
 ;ИЗ ТАБЛИЦЫ ОПИСАНИЯ В КЛЮЧИ
 F i=2:1:11 I $P($G(^%ZAPM.ed.BSbufB("K"_$G(%BS(3),$P)_$J_"u"_%BS(15),i,2)),"@",15)'="" S k0=i,k6=$P(^(2),"@",15),k7=$P(^(2),"@",14) D
 .S k15=$P(^(3),"@",15),k10=$P(^(4),"@",10),k2=$P(^(8),"@",15),k1=$P(^(6),"@",15),k3=$P(^(5),"@",15),k16=$P(^(5),"@",16),k4=$P(^(7),"@",15)
 .S k5=$P(^(4),"@",15),k14=$P(^(5),"@",14),k13=$P(^(5),"@",13),k12=$P(^(9),"@",15),k20=$P(^(5),"@",20),k9=$P(^(1),"@",15)
 .F k=10:1 Q:'$D(^(k))  S zr=$ZR,l1=@$ZR I $D(^%ZAPM.ed.BSbufB("K"_$G(%BS(3),$P)_$J_"u"_%BS(15),"COL",i,k)) S l2=@$ZR,l3=$G(^(k,1)),@(BSR_"(BST,""Key"",i-2,k)")=$P(l1,"@",15),^(k,1)=l2,^(2)=l3 I @zr
 .S $P(@(BSR_"(BST,""Key"",i-2)"),"@")=k1 F k=2:1:7,9,10,12:1:16,20 S $P(@$ZR,"@",k)=@("k"_k)
 .I $D(^%ZAPM.ed.BSbufB("K"_$G(%BS(3),$P)_$J_"u"_%BS(15),"RTR",i,5)) S l1=@$ZR,l2=$G(^(5,1)),@(BSR_"(BST,""Key"",i-2,1)")=l1,^(2)=l2
 .I $D(^%ZAPM.ed.BSbufB("K"_$G(%BS(3),$P)_$J_"u"_%BS(15),"FTR",i,5)) S l1=@$ZR,l2=$G(^(5,1)),@(BSR_"(BST,""Key"",i-2,3)")=l1,^(4)=l2
 .I $D(^%ZAPM.ed.BSbufB("K"_$G(%BS(3),$P)_$J_"u"_%BS(15),"COL",i,5)) S l1=@$ZR,l2=$G(^(5,1)),@(BSR_"(BST,""Key"",i-2,5)")=l1,^(6)=l2
 I $D(k0),($P(@(BSR_"(BST)"),"@",17)<2) S $P(@$ZR,"@",17)=2
END K ^%ZAPM.ed.BSbufB("K"_$G(%BS(3),$P)_$J_"u"_%BS(15)),^%ZAPM.ed.BSbufB("@K"_$G(%BS(3),$P)_$J_"u"_%BS(15)),k0,k1,k2,k3,k4,k5,k6,k10,k12,k16,k,k15,BSk,BSd,kk S $ZT=$G(%zT) Q
ER S ls=" ОШИБКА В ИМЕНИ ТАБЛИЦЫ ИЛИ РАЗДЕЛА ! "_$$ErrSay^%ZAPM.ed.BSF8($ZE) D O^%ZAPM.ed.BSF7 G D
E1 S ls=" ОШИБКА В ИМЕНИ БАЗЫ ДАННЫХ ! "_$$ErrSay^%ZAPM.ed.BSF8($ZE) D O^%ZAPM.ed.BSF7
YES S ls=" Продолжим корректировать описание Ключей и Базы данных ? " D YES^%ZAPM.ed.BSF I YES G EDIT
 S $ZT=$G(%zT) Q
]]></Routine>


<Routine name="%ZAPM.ed.BSTM" type="MAC" languagemode="0"><![CDATA[
%BSTM ;ДВИЖЕНИЕ МАРКЕРА ПО ТАБЛИЦЕ ; 13:41   15.04.2003
B D TIP^%ZAPM.ed.BST,KLE I $D(END) D R^%ZAPM.ed.BSF G 1000^%ZAPM.ed.BSF
 S MR=1 D CL^%ZAPM.ed.BSF4
0 I $D(EXITout) G END^%ZAPM.ed.BSF
 I $D(Refresh) D TIP^%ZAPM.ed.BST,TIT^%ZAPM.ed.BST,W^%ZAPM.ed.BST K Refresh ;```
  D W W $$atr^%ZAPM.ed.BS3(0) X $G(MR23),$G(MR24),$G(MR25),$G(%Cu)
1 F  R *R:0 E  Q
 I $D(Refresh) D W^%ZAPM.ed.BST K Refresh D W
 W $$rt^%ZAPM.ed.BS3(+%BS(2)) I $D(PredOb) D Pred^%ZAPM.ed.BSF12(PredOb) I R1<0 G 0:R1=-2,END^%ZAPM.ed.BSF:R1=-3,LE:R1=-4
 i R1=32 s R1=0,R2=82 ;ins
2 I R1=27 K % D  G:$G(%FK,1)'=1&(R2=79) @%FK G 101:'$G(%FK)&(R2=R3),0:$G(%,27)=27,^%ZAPM.ed.BSF
 .K %HO,%EN I R2=91 D  Q
 ..I $D(Ukaz) D UKA^%ZAPM.ed.BSF8 Q
 ..I R3=67 S m=MX,M1=$O(BX(MX)),MR=0 D WO D:M1=""  S MX=M1,MR=1 S:m=MX&(ke=1) MY=$O(BY(""),-1) Q  ;-->
 ...S M1=MX I $O(@(BSR_"(BST,ny,nx)"))'="" S BSX(BS0)=BSX(BS0)+1,Mx=$O(BX($O(BX("")))),MXx=BX(MX) D GW^%ZAPM.ed.BST S M1=$O(BX(""),-1),Mx=0 K MXx
 ..I R3=68 I nx=$P($G(%TIT,"1,1"),",",2),'$D(%TIT),ke=1  S MR=0 D WO S MR=1,MY=$O(BY("")) Q
 ..I R3=68 Q:nx=$P($G(%TIT,"1,1"),",",2)  S M1=$O(BX(MX),-1),MR=0 D WO D:M1=""  S MR=1,MX=M1 Q
 ...I $P(B,"@",24) D PgLt^%ZAPM.ed.BSF9 S M1=MX Q  ;!!!!!!!!
 ...S BSX(BS0)=BSX(BS0)-1,Mx=-1 D GW^%ZAPM.ed.BST S Mx=0,M1=$O(BX("")) Q
 ..I R3=66 S M1=$O(BY(MY)),MR=0 D WO D:M1=""  S MY=M1,MR=1 Q
 ...S M1=MY I $O(@(BSR_"(BST,ny)")) S BSY(BS0)=BSY(BS0)+1,My=$O(BY($O(BY("")))),MYy=BY(MY) D VW^%ZAPM.ed.BST S M1=$O(BY(""),-1),My=0 K MYy I '$D(BX(MX)) S M2=MX,MX=$O(BX(MX)) I MX="" S MX=$O(BX(M2),-1)
 ..I R3=65 Q:ny=$P($G(%TIT,1),",")  S M1=$O(BY(MY),-1),MR=0 D WO D:M1=""  S MR=1,MY=M1 Q
 ...I $P(B,"@",24) D PgUp^%ZAPM.ed.BSF9 S M1=MY Q  ;!!!!
 ...S BSY(BS0)=BSY(BS0)-1,R1=1,My=-1 D VW^%ZAPM.ed.BST S My=0,M1=$O(BY("")) I M1="" S ls=" СРОЧНО СДЕЛАЙТЕ РЕМОНТ ТАБЛИЦЕ !!! F6 " D O^%ZAPM.ed.BSF7
 ...I '$D(BX(MX)) S M2=MX,MX=$O(BX(MX)) I MX="" S MX=$O(BX(M2),-1)
F1 .I R2=79,(R3=80) S IYI=$P(BS,"@",20) S:IYI=""!(IYI["##") IYI=$P(B,"@",39) S:IYI="" IYI="^%ZAPM.ed.BSHLP,%BS-PC" D NE^%ZAPM.ed.BSN Q
 .I R2=79!(R2=-1) Q:'$G(%FK)  S:R3=-1 R3=89 D  Q  ;F-клавиши
 ..I R3>79&(R3<90) S %B=R3-79,OOO="^%ZAPM.ed.BS",OO=1 D  D:'$D(%DIA) DARK^%ZAPM.ed.BSF6 W /CUP(24,1) D ^%ZAPM.ed.BSB W /CUP(25,1),$$atr^%ZAPM.ed.BS3(0),/EL(0) D CL^%ZAPM.ed.BSF4 W /CUP(24,1) S %=R1 K Dark Q
 ...S Dark(1,1)=" 0 0 0 0 0 0 0 0" N z
 ...I $E(%BS(1),17)=2 D DF6 F z=3,4,5 S $P(Dark(1,1)," ",z+1)="1"
 ...I $E(%BS(1),17)=3 D DF6 F z=3,4,5,8 S $P(Dark(1,1)," ",z+1)="1"
 ...I $E(%BS(1),9)=3 S $P(Dark(1,1)," ",3)="1"
 I R1=8 S R1=27 G END^%ZAPM.ed.BSF ;BACKSPACE
 I R1=9 D TAB^%ZAPM.ed.BST5 G 0
 I R1=28 D CALK^%ZAPM.ed.BSSR G:YES LE G 0
 I R1=12,R2=-1 D SSS^%ZAPM.ed.BSF12 G 0
 I R1=0,R2=15 D STAB^%ZAPM.ed.BST5 G 0
 I R1=0,R2=18 S li=d G LE ; Alt-E Ctrl-E
 I (R1=0&&(R2=33))||(R1=6) D  G 1  ;alt-f  ctrl=f  возвращение функциональных клавишь
 .I '$D(%fk) S (%fk,%FK)=1 Q
 .K %fk S %FK=$P(@BSR@(BST),"@",15) K:%FK="" %FK
SF1 I R1=0,(R2=139!(R2=140)!(R2=84)!(R2=88)) D AltKey^%ZAPM.ed.BSF8 G 0
 I R1=0,R3=-1,("85/86/87"[R2),$L(R2)=2 D Shift^%ZAPM.ed.BSF8(R2) G 0 ;F2,F3,F4 ЮЗЕРСКИЕ
 I R1=0,R2=31 S LineEdit=1,li=d G LE ;Alt-s Ctrl-D
 I R1=0,R2=46 G 0:BST'["@" D OUT^%ZAPM.ed.BSS1 G 0
 I R1=0,"48,47,20"[R2,R2?2N D CON I  G E11^%ZAPM.ed.BSF1:R2=48,E161^%ZAPM.ed.BSF1:R2=47,E21^%ZAPM.ed.BSF1:R2=20
 I R1=0,R2=38 G E141^%ZAPM.ed.BSF1:BST["@",LOS^%ZAPM.ed.BSF6:$D(^%ZAPM.ed.BSbufB("LOGS"_$G(%BS(3),$P)_$J_$P($$ZU^%ZAPM.ed.BS3(1,0),",",2)_"u"_%BS(15))) D CON G 1
 I R1=0,R2=109 D BUF^%ZAPM.ed.BSF3 G 0
 I R1=0,R2=24 G ^%ZAPM.ed.BSS
 I R1=0,R2=21 G FIDD^%ZAPM.ed.BSS ;ПОИСК ПО БАЗЕ ДАННЫХ 
 I R1=0,R2=25 S fi=nx G FIND^%ZAPM.ed.BSS
 I R1=0,R2=110 S fi=nx_",DFLT,0,1,1" G FIND^%ZAPM.ed.BSS
 I R1=0,R2=90 G ShiftF7^%ZAPM.ed.BSS
 I R1=0,R2=131 D CALK^%ZAPM.ed.BSSR G:YES LE G 0
 I R1=0,R2=113,$E(%BS(1),3),'$E($G(%BS(14)),4) D CM^%ZAPM.ed.BSF6 G 0
 I R1=0,R2=105 K %GO D DOAF2^%ZAPM.ed.BSN G:$D(%GO) @%GO G 0
 I R1=0,R2=44,BST["@" G 42^%ZAPM.ed.BSF
INS I R1=0,R2=82 D  S %DIA=1,$P(@(BSR_"(BST)"),"@",3)=1,$P(@(BSR_"(BST,ny,nx)"),"@",12)=$S($P(BS,"@",12):"",1:1) G:'%BS(5) 0 S BS=@$ZR,MR=0 D WO S MR=1,R1=27,R2=91,R3=$S(%BS(5)=1:66,%BS(5)=2:67,1:R3) G 2
 .S %DIA=$$GetLock^%ZAPM.ed.BSXfun(),$E(%DIA)=($E(%DIA)=0) D SetLock^%ZAPM.ed.BSXfun(%DIA)
 I R1=0,R2=162 D I^%ZAPM.ed.BSGLOB(BSR,BST,ny,nx,d) S R2=82 G INS
 I R1=0 D  G 0
 .I R2=71 S %HO=$S('$D(%HO):1,%HO=1:2,%HO=2:3,1:1) D  ;HOME
 ..I $D(Ukaz),%HO<3 D HO^%ZAPM.ed.BSF8 Q
 ..I %HO=1 S MX=$O(BX("")) S MR=0 D WO S MR=1 Q
 ..I %HO=2 S MR=0 D WO S MY=$O(BY("")),MX=$O(BX("")),MR=1 Q
 ..I %HO=3 S BSY(BS0)=$P($G(%TIT,1),","),BSX(BS0)=$P($G(%TIT,"1,1"),",",2) D  Q
 ...I $ZV["Cach"||($ZV["IRIS") D TIP^%ZAPM.ed.BST,TIT^%ZAPM.ed.BST,W^%ZAPM.ed.BST Q
 ...D TW^%ZAPM.ed.BST,KLE Q
 .I R2=79 S %EN=$S('$D(%EN):1,%EN=1:2,%EN=2:3,1:1) D  ;END
 ..I $D(Ukaz),%EN<3 D EN^%ZAPM.ed.BSF8 Q
 ..I %EN=1 D DNX S MR=0 D WO S MR=1,MX=M1 Q
 ..I %EN=2 D DNY S MR=0 D WO S MR=1,MY=M1 Q
 ..I %EN=3 D REND^%ZAPM.ed.BSF2,DEND^%ZAPM.ed.BSF2,END^%ZAPM.ed.BS1 S BSY(BS0)=es,BSX(BS0)=ek D TW^%ZAPM.ed.BST,KLE Q
 .I R2=132!(R2=22) S BSY(BS0)=$P($G(%TIT,1),",") D TW^%ZAPM.ed.BST,KLE Q
 .I R2=118!(R2=49) D DEND^%ZAPM.ed.BSF2,ENDS^%ZAPM.ed.BS1 S BSY(BS0)=es D TW^%ZAPM.ed.BST,KLE Q
 .I R2=73!(R2=152)!(R2=23) D PgUp^%ZAPM.ed.BSF9 Q
 .I R2=81!(R2=160)!(R2=50) S t1=BSY(BS0) D DNY S BSY(BS0)=BY(M1) Q:t1=BSY(BS0)  D VW^%ZAPM.ed.BST,KLE Q  ;PgDn
 .I R2=157!(R2=37)!(R2=116) S t1=BSX(BS0) D DNX S BSX(BS0)=BX(M1) Q:t1=BSX(BS0)  D GW^%ZAPM.ed.BST,KLE Q  ;->
 .I R2=155!(R2=36)!(R2=115) D PgLt^%ZAPM.ed.BSF9 Q
 I R1=13,$P(BS,"@",14)'="" S l4=14 D NEW^%ZAPM.ed.BSN K l4 G:'(R1'=27&(li'="")) 0 W $$atr^%ZAPM.ed.BS3(0) D W G 1:$D(%ZAP),1:$P(BS,"@",5)=1 I 1 D:'$D(%w(5)) PASD^%ZAPM.ed.BST1 G 1:'$T S YES=1 G LEE
 I R1=13,'$G(%FK) G 101
 I R1=-1,%BS(13)="%BS-PC" G 0:$ZV["Cach"||($ZV["IRIS")  D GLUC^%ZAPM.ed.BSXgluc G 0
 I R1=43 G PL^%ZAPM.ed.BSF5
 I R1=45 G MI^%ZAPM.ed.BSF5
 I R1=127,(R2=R3) G 1:$D(%ZAP),1:$P(BS,"@",5)=1 D  G 0
 .I '$D(%w(5)) D PASD^%ZAPM.ed.BST1 E  Q
 .D Yes^%ZAPM.ed.BSXfun("Удаляем данные клетки {"_ny_","_nx_"} ?") Q:YES<1
 .D R^%ZAPM.ed.BS3($NA(@BSR@(BST,ny,nx))) I LOC D MED^%ZAPM.ed.BSF S i=ny,j=nx I $D(@BSR@(BST,ny,nx)) D DEL^%ZAPM.ed.BSF1,D^%ZAPM.ed.BS3($NA(@BSR@(BST,ny,nx))) D:$D(%CAL) CALC^%ZAPM.ed.BSF3
 G:R1<32 1 S li=$C(R1) I $P(B,"@",40)'="" S fi=$P(B,"@",40),finl=li G FIND^%ZAPM.ed.BSS
LE G 1:$D(%ZAP) I $P(BS,"@",5)=1 S ls=" Ввод Запрещен " D WAITS^%ZAPM.ed.BSF2 W $$bel^%ZAPM.ed.BS3 G 1
 I '$D(%w(5)) D PASD^%ZAPM.ed.BST1 E  G 1
 D HIS^%ZAPM.ed.BSF1("DAT")
 I $P(BS,"@",21) D BAR^%ZAPM.ed.BSF7(+$P(BS,"@",21),$P($P(BS,"@",21),",",2)) G LEE
 I $P(B,"@",26)["," D BAR^%ZAPM.ed.BSF7(+$P(B,"@",26),$P($P(B,"@",26),",",2)) G LEE
 I $P(B,"@",26)!($D(LineEdit)) S ls="Коppектиpуете значение клетки",lon=$S($P(BS,"@",9)=1:200,1:509) D LE^%ZAPM.ed.BSTT X "I 1" K LineEdit
 E  S li=$$Edit^%ZAPM.ed.BSXuse(li,($P(BS,"@")+1-BS1+BSY1(BS0)),($P(BS,"@",2)-BS2+1+BSX1(BS0)),($P(BS,"@")-BS1+BSY1(BS0)+$P(BS,"@",3)),($P(BS,"@",2)-BS2+BSX1(BS0)+$P(BS,"@",4)),"@")
LEE G:'YES 0 I li'="" K R1 D  G M:$D(R1),LE
 .I $P(BS,"@",16)'="" K %0 S %zT=$ZT,$ZT="ERRTR^%ZAPM.ed.BSTM",YES=1,(d,d0)=li K ls D  S:YES li=$G(%0,li) I 'YES S ls=$G(ls,"СИНТАКСИЧЕСКАЯ ОШИБКА ") D O^%ZAPM.ed.BSF7 K R1 Q
 ..I '$P(BS,"@",16) X $G(@BSR@(BST,"RTR",ny,nx)) S $ZT=$G(%zT) Q
 ..X $G(@(BSR_"(BST,""RTR"","_$P(BS,"@",16)_")")) S $ZT=$G(%zT)
 .I li["@" S ls=" Запрещенный Символ @ " D O^%ZAPM.ed.BSF7 Q
 .D SetCell(ny,nx,li) D:$D(%CAL) CALC^%ZAPM.ed.BSF3 S R1=1 Q
 G 0
SetCell(ny,nx,li) 
 I $P(BS,"@",9)=1 D L^%ZAPM.ed.BS3($NA(@BSR@(BST,ny,nx))),MED^%ZAPM.ed.BSF D  D U^%ZAPM.ed.BS3($NA(@BSR@(BST,ny,nx))) Q
 .S $P(@(BSR_"(BST,ny,nx)"),"@",15)=li
 E  S $P(^%ZAPM.ed.BSbufB("BB"_$G(%BS(3),$P)_$J_"u"_%BS(15)),"@",2)=1,^%ZAPM.ed.BSbufB("BB"_$G(%BS(3),$P)_$J_"u"_%BS(15),ny,nx)=li Q
 Q
M G:'POSt 0 S MR=0,BS=@BSR@(BST,BY(MY),BX(MX))
 D WO S MR=1,R1=27,R2=91,R3=$S(POSt=1:66,POSt=2:67,1:R3) G 2
W S BS=$G(@(BSR_"(BST,"_BY(MY)_","_BX(MX)_")")) //$G(
WO S ny=BY(MY),nx=BX(MX)
WG S CLR=$S($P(BS,"@",10):$P(BS,"@",10),1:COLOR) I $E(%BS(1),19) S CLR=$P(%BS,"!",$E(%BS(1),19))
 I $P(BS,"@",12) S CLR=$P(%BS,"!",3)
 I $P(BS,"@",9)=1 S (d1,d,d0)=$P(BS,"@",15)
 E  S (d1,d,d0)=$G(^%ZAPM.ed.BSbufB("BB"_$G(%BS(3),$P)_$J_"u"_%BS(15),ny,nx))
 I $P(BS,"@",8)'="" S %zT=$ZT,$ZT="FTRe^%ZAPM.ed.BSTM" D  S $ZT=$G(%zT)
 .I d0="" S d0=0
 .I '$P(BS,"@",8) X $G(@(BSR_"(BST,""FTR"",ny,nx)")) Q
 .X $G(@(BSR_"(BST,""FTR"","_$P(BS,"@",8)_")"))
w W $$atr^%ZAPM.ed.BS3($S('MR:CLR,1:$P(%BS,"!",$S($P(BS,"@",12):1,1:2))))
 S l=$P(BS,"@",3)*$P(BS,"@",4) F BSF=1:1:$P(BS,"@",3) Q:($P(BS,"@")+BSF-BS1)>BSY2(BS0)  D  W $E(d1_$J("",l),BSF*$P(BS,"@",4)-$P(BS,"@",4)+1,$P(BS,"@",4)+($P(BS,"@",4)*(BSF-1)))
 .W /CUP(($P(BS,"@")+BSF-BS1+BSY1(BS0)),($P(BS,"@",2)-BS2+1+BSX1(BS0)))
 W $$atr^%ZAPM.ed.BS3($S(MR:CLR,1:$P(%BS,"!",2))) Q
DNX S M1=$O(BX(""),-1) Q
24 W /CUP(24,1),$$atr^%ZAPM.ed.BS3(0),/EL(0) Q
25 W /CUP(25,1),$$atr^%ZAPM.ed.BS3(0),/EL(0) Q
KL W /CUP(($P(BS,"@")+BSF-BS1+BSY1(BS0)),($P(BS,"@",2)-BS2+1+BSX1(BS0))),$$atr^%ZAPM.ed.BS3(0) Q
DNY S M1=$O(BY(""),-1) Q
DF6 N z F z=2:1:7,10 S $P(Dark(1,1,6)," ",z+1)="1"
 Q
CON Q:BST["@"  S ls=" УСТАНОВИТЕ РЕЖИМ КОРРЕКЦИИ ОПИСАНИЯ ТАБЛИЦЫ <F4> " G O^%ZAPM.ed.BSF7
MR23 W /CUP(23,1),/EL(0) W:$P(BS,"@",7)'="" "ВЫЧ" W:$P(BS,"@",8)'="" /CUP(23,5),"ТРАН" W:$P(BS,"@",6)'="" /CUP(23,10),"d",$P(BS,"@",6) W /CUP(23,14),$S($P(BS,"@",9)=1:"О.Т",1:"Б.Д") W:$P(BS,"@",5)=1 /CUP(23,19),"ЗАПР"
 W /CUP(23,24),$P(BS,"@",3),"x",$P(BS,"@",4) W:$P(BS,"@",13)'="" /CUP(23,30),"ЛОГ=",$S($P(BS,"@",11)=1:"НЕ",1:"ДА") W:$P(BS,"@",16)'="" /CUP(23,37),"СИНТ" W:$P(BS,"@",14)'="" /CUP(23,42),$S($P(BS,"@",14)?.N1",".N:"КОМ",1:"ТАБ")
 W:$P(BS,"@",17)'="" /CUP(23,46),"ДВЖ" W:$D(%DIA) /CUP(23,51),"Бл" W:$P(BS,"@",12) /CUP(23,52),"Л" W:$P($P(BS,"@",18),"#")'="" /CUP(23,54),$P($P(BS,"@",18),"#")
 W:$P($P(BS,"@",18),"#",2)'="" /CUP(23,58),"""",$P($P(BS,"@",18),"#",2),"""" W:$P(B,"@",24) /CUP(23,61),"ПОДЖ"
 W:$P(BS,"@",20)'="" /CUP(23,66),"F1" Q
MR24 D 24,RED W " {",ny,",",nx,"}" D 25 W $E(d,1,77) W:$E(d,77)'="" "..." Q
RED W:BST["@" $$atr^%ZAPM.ed.BS3("1;36;47")," РЕД ",$$atr^%ZAPM.ed.BS3(0) Q
MR25 D 24,RED W $E($$SS^%ZAPM.ed.BSF12(),1,79) D 25 W $E(d,1,79) Q
ERRTR S ls=$ZE D O^%ZAPM.ed.BSF7 Q
FTRe S $ZT=$G(%zT) W $$bel^%ZAPM.ed.BS3 G w
101 S MR=0 D WO W $$atr^%ZAPM.ed.BS3(0) G 10^%ZAPM.ed.BSF
KLE K END S R1=27,%BSTM=1 D:TIP'=7 24 I '$D(MY) S MY=$O(BY("")) D:MY=""  Q:$D(END)  S MX=$O(BX("")) D:MX=""  Q:MX=""
 .S ls=" !!! ПУСТАЯ ТАБЛИЦА !!!"_$S($G(%TIT):",ИЛИ КОНФЛИКТ ТИТУЛА И ВЫСОТЫ СТРОК",1:"") D O^%ZAPM.ed.BSF7 S END=1
 I '$D(BY(MY))!('$D(BX(MX))) K MY,MX G KLE
 I $D(Ukaz) S Na=1 D TA^%ZAPM.ed.BSF8
 Q
]]></Routine>


<Routine name="%ZAPM.ed.BSTREE" type="MAC" languagemode="0"><![CDATA[
%BSTREE(G) ;пpогpамма РАБОТЫ С ДЕРЕВОМ ГЛОБАЛЕЙ ; 15:05 21-OCT-98
 Q:'$$Data^%ZAPM.ed.BSF12(G)  N (%BS,G)  S BSR="^%ZAPM.ed.BSVOL",BST="TREE"
 S %BS("Tmp","Tree")=G D ^%ZAPM.ed.BST
 Q
T() ;ТРАНСФОРМАЦИЯ
 N G,a,n s n=65 Q:ny=3 ""
 S G=$$SS(ny=1!(ny=2)) Q:G="" ""
 S ii=$D(@G)
 s a=G i $l(a)>n s a="..."_$e(a,$l(a)-n,$l(a))
 Q $J(ii,2)_" "_a_$S(ii["0":"",1:"="_$$CTRL^%ZAPM.ed.BSChT(@G))
EDIT ;РЕДАКТИРОВАТЬ УЗЕЛ
 N G,S,i
 S G=$$SS(ny=1!(ny=2))
 S i=$D(@G),ii=$G(@G)
 i $TR(ii,$C(127,5),"")'=ii s ii=$TR(ii,$C(127,5),$c(174,169))
 S S=$$LineEdit^%ZAPM.ed.BSXfun(ii,G_"="_$S(i["0":"НЕОПРЕДЕЛЕНО",ii="":"ПУСТО",1:"")) Q:YES<1
 i $tr(S,$c(174,169))'=S  s S=$tr(S,$c(174,169),$c(127,5))
 I i["0",S="" D Yes^%ZAPM.ed.BSXfun("ВЫ ХОТИТЕ ВВЕСТИ ПУСТОЕ ЗНАЧЕНИЕ ?") Q:YES<1
 S @G=S
 Q
 /* .// //i $tr(%S,$c(127,5))'=%S s %S=$tr(%S,$c(127,5),$c(174,169))
 .i $TR(ii,$C(127,5),"")'=ii s ii=$TR(ii,$C(127,5),$c(174,169))
 .S S=$$LineEdit^%ZAPM.ed.BSXfun(ii,txt) Q:YES<1
 .i $tr(S,$c(174,169))'=S  s S=$tr(S,$c(174,169),$c(127,5))
 */
SS(A) N ii,i,G
 Q:'$D(BSD) ""
 S G=BSD
 I $D(%KEYS) F ii=1:1:%KEYS Q:'$D(%KEYS(ii))  S G=$NA(@G@(%KEYS(ii)))
 I $G(A) Q $NA(@G)
 Q $NA(@G@(d))
]]></Routine>


<Routine name="%ZAPM.ed.BSTT" type="MAC" languagemode="0"><![CDATA[
%BSTT ;АРМы,ТРАНСФОРМАЦИЯ ТАБЛИЦ В ТЕКСТЫ ; 15:21   28.12.1999
 Q
MMLOAD(UM) ;ЗАГРУЗКА
 N BSR,BST,NS,NSOLD
 S NS=$G(@UM@("NS")),NSOLD=$$ZU^%ZAPM.ed.BS3(0) D  I $$ZU^%ZAPM.ed.BSF4($P(NSOLD,",",1),$P(NSOLD,",",2)) Q
 .I NS'=0,NS'="",'$$ZU^%ZAPM.ed.BSF4($P(NS,",",1),$P(NS,",",2)) Q
 .I $G(@UM@("CMD"))'="" D  Q
 ..S $ZT="ERMMCMD^%ZAPM.ed.BSTT"
 ..X @UM@("CMD") Q
 .I $G(@UM@("USPT"))'="" D  Q
 ..S BSR=$P(@UM@("USPT"),"(",1),BST=$QS(@UM@("USPT"),1) D ^%ZAPM.ed.BST
 .D ErrMsg^%ZAPM.ed.BSXfun("ЗАГРУЖАТЬ НЕЧЕГО !")
 Q
ERMMCMD D ErrMsg^%ZAPM.ed.BSXfun($ZE_" "_$$ErrSay^%ZAPM.ed.BSF8($ZE))
 Q
MMLOOP(UM) ;ЦИКЛ ПО МЕНЮ
 N TM,BSR,BST,I,II,III,MLevel
 I $QL(UM)=KolKeyS D MMLOAD(UM) Q
 I $O(@UM@(""))="" D ErrMsg^%ZAPM.ed.BSXfun("ПУНКТ ПУТОЙ !") Q
 I $D(@UM@("*","NS")) D MMLOAD($NA(@UM@("*"))) Q
 I $D(@UM@("*","*","NS")) D MMLOAD($NA(@UM@("*","*"))) Q
 I $D(@UM@("*","*","*","NS")) D MMLOAD($NA(@UM@("*","*","*"))) Q
 I $D(@UM@("*","*","*","*","NS")) D MMLOAD($NA(@UM@("*","*","*","*"))) Q
 S TM=$$TMPG^%ZAPM.ed.BSF11,BSR=$P(TM,"("),BST=$QS(TM,1) D Copy^%ZAPM.ed.BSF8("^%ZAPM.ed.BSVOL(""MenuPatt"")",TM)
 S I="",II=4,III=@TM@(4,1) F  S I=$O(@UM@(I)) Q:I=""  I I'["@" S @TM@(II,1)=III,$P(@$ZR,"@",15)=I,II=II+1
 S @TM@("AF2")="^%ZAPM.ed.BSS,ALTF2",$P(@TM,"@",39)="^%ZAPM.ed.BSHLP,MAIN",$P(@$ZR,"@",41)="AF10^%ZAPM.ed.BSF12"
 D TAB^%ZAPM.ed.BSF1 S MLevel=$QL(UM)
MMLOO D STA^%ZAPM.ed.BST
 I R1=27!(R1=13&(ny=3)) K @TM Q
 I R1=13&(ny'=3) D MMLOOP($NA(@UM@(d))) G MMLOO
 G MMLOO
MMENU(U) ;ВЫЗОВ ГЛАВНОГО МЕНЮ
 N BM,i,KolKeyS
 S BM=$$KBD^%ZAPM.ed.BSF12("^%ZAPM.ed.BSVOL(""MainMenu"")"),KolKeyS=$O(^%ZAPM.ed.BSVOL("MainMenu","KEY",""),-1)
 I '$$Data^%ZAPM.ed.BSF12(BM) D ErrMsg^%ZAPM.ed.BSXfun("НЕ ДОСТУПНА БД ГЛ.МЕНЮ") Q
 I '$D(@BM@(U)) D ErrMsg^%ZAPM.ed.BSXfun("НЕ СУЩЕСТВУЕТ УЗЛА ! "_$ZR) Q
 D MMLOOP($NA(@BM@(U)))
 Q
ARM(i) ;i="T,P,U,S-Y-X"
       ;Y=1 - ОБЯЗАТЕЛЬНО ЗАПУСКАТЬ В ЯВНО СМОНТИРОВАННОМ ТОМЕ S КИПЕ U
       ;X- MUMPS КОД ЗАПУСКА ПРИЛОЖЕНИЯ
 I $P(i,"-",2) S uci=$P($P(i,"-"),",",3,4) D %GU^%ZAPM.ed.BSF4 I 'YES Q
 I $P(i,"-",3,999)'="" X $P(i,"-",3,999) Q
 S BSR="^["""_$P(i,",",3)_""","""_$P($P(i,"-"),",",4)_"""]"_$P(i,",",2),BST=$P(i,",") D ^%ZAPM.ed.BST
 Q
ABUTZ Q  ;ПУСТО
ABUT ;КНОПКА
 N A,S
 I $P(^%ZAPM.ed.BSS("ARMB",6,1),"@",15) S $P(^%ZAPM.ed.BSS("ARMB",6,1),"@",15)=0,A=0
 E  S $P(^%ZAPM.ed.BSS("ARMB",6,1),"@",15)=1,A=1
 S S=$P(^%ZAPM.ed.BSS("ARMB",10,3),"@",15),$P(S,"-",2)=A,$P(^%ZAPM.ed.BSS("ARMB",10,3),"@",15)=S
 Q
ATAB ;ПАРАМЕТРЫ
 N I
 F I=1:1:4 S $P(^%ZAPM.ed.BSS("ARMB",I,3),"@",15)=$P($P(%BS("Tmp","Butt77",1),"-"),",",I)
 S $P(^%ZAPM.ed.BSS("ARMB",6,1),"@",15)=+$P(%BS("Tmp","Butt77",1),"-",2)
 S $P(^%ZAPM.ed.BSS("ARMB",8,3),"@",15)=$P(%BS("Tmp","Butt77",1),"-",3,99)
 S IYI="^%ZAPM.ed.BSS(ARMB" D NE^%ZAPM.ed.BSN
 S li=d,R1=13
 Q
XEC(i) ;i=КОМАНДА
 S %zT=$ZT,$ZT="XECERR^%ZAPM.ed.BSTT" X i Q
XECERR S $ZT=$G(%zT),ls="ОШИБКА ВЫЗОВА "_$ZE_" "_$$ErrSay^%ZAPM.ed.BSF8($ZE) D O^%ZAPM.ed.BSF7 Q
EnterAR D ARM($G(@%BS("Tmp","BSD")@("5,4")))
 Q
SCREEN ;ЭКРАННОЕ РЕДАКТИРОВАНИЕ БЛОКА
 N X1,X2,Y1,Y2,i,j,L,l,H,h,m,LL,%GO,Err,YES,Ox,Oy,%JB,WA,WAI,LOC,jj,ls,l1,l2
 S (X1,Y1)=800,(X2,Y2)=0,(i,j)="" F  S i=$O(BY(i)) Q:'i  F  S j=$O(BX(j)) Q:'j  I $P($G(@BSR@(BST,BY(i),BX(j))),"@",12) S:Y1>i Y1=i S:Y2<i Y2=i S:X1>j X1=j S:X2<j X2=j
 S i=Y2-1+$P($G(@BSR@(BST,BY(Y2),BX(X2))),"@",3),j=X2-1+$P($G(@BSR@(BST,BY(Y2),BX(X2))),"@",4)
 ;;;I Y1=1!(Y2=1)!(i=22)!(j=80) D ErrMsg^%ZAPM.ed.BSXfun("Помеченные Клетки вышли за границу") Q
 D SCREENK S ^%ZAPM.ed.BSbufB("ScreenEdit"_$G(%BS(3),$P))=@%BS(20)@("Screen"),$P(@$ZR,"@",8)=Y1,$P(@$ZR,"@",9)=X1,$P(@$ZR,"@",10)=i,$P(@$ZR,"@",11)=j
 S $P(@$ZR,"@")="Редактирование Блока" ;       !????!,$P(@$ZR,"@",38)=""
 S LL=1 F i=BY(Y1):1:BY(Y2)  S h=$P($G(@BSR@(BST,i,1)),"@",3) D
 .K L F j=BX(X1):1:BX(X2) S l=$P($G(@BSR@(BST,i,j)),"@",4),s=$$A^%ZAPM.ed.BSA(i,j) D
 ..F m=1:1:h S L(m)=$G(L(m))_$E(s,(l*(m-1))+1,(l*(m-1))+l)_$J("",l-$L($E(s,(l*(m-1))+1,(l*(m-1))+l)))
 .F m=1:1:h S ^%ZAPM.ed.BSbufB("ScreenEdit"_$G(%BS(3),$P),LL)=L(m),LL=LL+1
 d ^%ZAPM.ed.BSX("EDIT","^%ZAPM.ed.BSbufB","ScreenEdit"_$G(%BS(3),$P),"") Q:$G(%GO)'="Save"
 S LL=1 F i=BY(Y1):1:BY(Y2)  S h=$P($G(@BSR@(BST,i,1)),"@",3) D
 .S L=0,l1=1 F j=BX(X1):1:BX(X2) S l=$P($G(@BSR@(BST,i,j)),"@",4),BS=$G(@BSR@(BST,i,j)) K s D
 ..S l2=l1+l-1
 ..F m=1:1:h S s=$G(s)_$E($G(^%ZAPM.ed.BSbufB("ScreenEdit"_$G(%BS(3),$P),LL+m-1)),l1,l2)_$J("",l-$L($E($G(^%ZAPM.ed.BSbufB("ScreenEdit"_$G(%BS(3),$P),LL+m-1)),l1,l2)))
 ..S s=$$ClearSpc^%ZAPM.ed.BSF7(s) D SetCell^%ZAPM.ed.BSTM(i,j,s) S l1=l2+1
 .S LL=LL+h
 D SCREENK,W^%ZAPM.ed.BST Q
SCREENK K ^%ZAPM.ed.BSbufB("ScreenEdit"_$G(%BS(3),$P)) Q
TXTREST I '$D(^%ZAPM.ed.BSbufB(2,$G(%BS(3),$P),4,2)) S ls=" БУФФЕР ПУСТ " D O^%ZAPM.ed.BSF7 Q
 S ls="КОПИРУЮ ИЗ БУФЕРА" D WAITS^%ZAPM.ed.BSF2 N K S K=$P(@(BSR_"(BST)"),"@") K @$ZR S (B,@$ZR)=^%ZAPM.ed.BSbufB(2,$G(%BS(3),$P),4,2),$P(@$ZR,"@")=K
 F i=1:1 Q:'$D(^%ZAPM.ed.BSbufB(2,$G(%BS(3),$P),4,2,i))  S @(BSR_"(BST,i)")=@$ZR
 Q
TXT D TXTSAVA,TXTREST D:$P(B,"@",8)>1 O(8,-1) D:$P(B,"@",9)>1 O(9,-1)
 D:$P(B,"@",10)<80 O(10,1) D:$P(B,"@",11)<22 O(11,1) S @(BSR_"(BST)")=B
 Q
O(p,pp) S $P(B,"@",p)=$P(B,"@",p)+pp Q
TXTSAVA S ls="ДЕЛАЮ БУФЕР ТЕКСТА" D WAITS^%ZAPM.ed.BSF2 N I,L,h,l,ST,d S bf=2 K ^%ZAPM.ed.BSbufB(2,$G(%BS(3),$P),4,bf) S @$ZR=B,$P(@$ZR,"@",30)="",$P(@$ZR,"@",17)=5,$P(@$ZR,"@",29)=($$LNG^%ZAPM.ed.BSF12-1)
 S ST=0 F i=1:1 Q:'$D(@(BSR_"(BST,i)"))  D TL F j=1:1 Q:'$D(@(BSR_"(BST,i,j)"))  D TX(@$ZR,$S($P(@$ZR,"@",9)<2:$P(@$ZR,"@",15),1:$G(^%ZAPM.ed.BSbufB("BB"_$G(%BS(3),$P)_$J_"u"_%BS(15),i,j))))
 D TL S $P(^%ZAPM.ed.BSbufB(2,$G(%BS(3),$P),4,bf),"@",28)=ST Q
TXTSAVB S ls="ДЕЛАЮ БУФЕР ТЕКСТА" D WAITS^%ZAPM.ed.BSF2 N I,L,h,l,ST,d S bf=0 K ^%ZAPM.ed.BSbufB(2,$G(%BS(3),$P),4,bf) S @$ZR=""
 S ST=-1 F i=1:1 Q:'$D(@(BSR_"(BST,i)"))  D TL F j=1:1 Q:'$D(@(BSR_"(BST,i,j)"))  D TX(@$ZR,$S($P(@$ZR,"@",9)<2:$P(@$ZR,"@",15),1:$G(^%ZAPM.ed.BSbufB("BB"_$G(%BS(3),$P)_$J_"u"_%BS(15),i,j))))
 D TL S ^%ZAPM.ed.BSbufB(2,$G(%BS(3),$P),4,bf)="1@"_(ST+1)_"@0" Q
TX(S,d) S (d1,d0)=d
 I $P(S,"@",8)'="" S %zT=$ZT,$ZT="FFF^%ZAPM.ed.BST" D  S $ZT=$G(%zT)
 .I d0="" S d0=0
 .S ny=i,nx=j I '$P(S,"@",8) X $G(@(BSR_"(BST,""FTR"",i,j)")) Q
 .X $G(@(BSR_"(BST,""FTR"","_$P(S,"@",8)_")"))
 S l=$P(S,"@",4) I '$D(h) S h=$P(S,"@",3)
 S d1=d1_$J("",l*h) F I=1:1:h S L(I)=$G(L(I))_$E(d1,I*l-l+1,l+(l*(I-1)))
 Q
TL K h Q:'$D(L)  S L="" F  S L=$O(L(L)) Q:L=""  S ST=ST+1,^%ZAPM.ed.BSbufB(2,$G(%BS(3),$P),4,bf,ST)=$E(L(L),1,509)
 K L Q
B1 S bf=1 G B
B2 S bf=2 G B
B3 S bf=3 G B
B4 S bf=4
B G RES^%ZAPM.ed.BSF2
TempT ;СОЗДАТЬ БУФЕРНЫЙ ТЕКСТ
 N T S T=$$TMPG^%ZAPM.ed.BSF11
 S BSr=$P(T,"("),BSt=$P($P($P(T,"(",2),")"),$C(34),2),t0=""
 D CR
 S se=0 Q
TempTX(t0) D CR Q  ;ЦИКЛ ПРИСВОЕНИЯ ТЕКСТА
TempTXT(Coment,Obraz) D CREAT Q  ;ЗАВЕРШИТЬ
TempTXTE ;ВОЙТИ В ТЕКСТ
 S IYI=BSr_"("_BSt D NE^%ZAPM.ed.BSN Q
TempTXDE ;УДАЛИТЬ ТЕКСТ
 K @BSr@(BSt) Q
CR ;СОЗДАНИЕ ТЕКСТА BSr,BSt
   ;t0-СОДЕРЖАНИЕ СТРОКИ
   ;NoKiTab=1 - НЕ УДАЛЯТЬ СТАРЫЙ ТЕКСТ
 I '$D(CReATe) K:'$D(NoKiTab) @(BSr_"(BSt)") S:$D(@BSr)["0" @BSr="BaSe MsW @" S CReATe=$$h^%ZAPM.ed.BS3(),se=0,WA=$G(WA) D:$D(NoKiTab)
 .F i=1:1 Q:'$D(@BSr@(BSt,i))  S se=i
 S se=se+1 S @(BSr_"(BSt,se)")=$E(t0,1,$$LNG^%ZAPM.ed.BSF12)
 Q
CREAT K CReATe,i,j,cl D  S $P(@BSr@(BSt),"@",17)=5,$P(@$ZR,"@",14)=$G(tIT) S:$D(Fk) $P(@$ZR,"@",15)=Fk S $P(@$ZR,"@",28)=se,$P(@$ZR,"@",29)="" S:$G(Coment)'="" $P(@$ZR,"@")=Coment K Coment Q
 .I $G(Obraz)'="" S @BSr@(BSt)=Obraz
 .I $D(Obraz) S Ob="" F  S Ob=$O(Obraz(Ob)) Q:Ob=""  S $P(@BSr@(BSt),"@",Ob)=Obraz(Ob)
CREATE D CREAT
CREA S BSR=BSr,BST=BSt K BSr,BSt,tIT,Fk,Obraz,Ob D ^%ZAPM.ed.BST Q
 ;
FTR S f="FTR" G TXTINF
FCL S f="FCL" G TXTINF
COL S f="COL" G TXTINF
RTR S f="RTR" G TXTINF
TXTINF S ls="ГЕНЕРАЦИЯ "_$$FORM(f) D WAITS^%ZAPM.ed.BSF2
 S BSR=$P($G(%KAT(1)),"!",2),BST=$P($G(%KAT(1)),"!",3)
 S t0="" D BBB,UUU I YES Q
 D CR S do="D TXTIN^%ZAPM.ed.BSTT X WA" D ALLT^%ZAPM.ed.BSS1 I $D(TotalSi) S t0="Список "_$$FORM^%ZAPM.ed.BSTT(f)_" завершен" D CR Q
 D CREAT S $P(@(BSr_"(BSt)"),"@")="Список "_$$FORM(f) D CREA Q
TXTIN S ny=i,nx=j K fff S ffff=" --//-- " I $D(@(BSR_"(BST,f,ny,nx)")) G TXTINN
 D  I $D(@(BSR_"(BST,f,"_nynx_")")) S ffff=" в "_nynx_" ",fff=@$ZR,fffff=0 I $D(@(BSR_"(BST,f,"_nynx_",1)")) S fff=@$ZR,fffff=1
 .S ff=$S(f="FCL":7,f="COL":13,f="FTR":8,f="RTR":16,1:999),nynx="0,0" I $P(@(BSR_"(BST,ny,nx)"),"@",ff)?.N1",".N S nynx=$P(@$ZR,"@",ff)
 G TXTINFF
TXTINN S fff=$G(@$ZR),fffff=0 I $D(@BSR@(BST,f,ny,nx,1)) S fff=$G(@$ZR),fffff=1,sum(f)=$g(sum(f))+1
TXTINFF Q:'$D(fff)  S t0="" D CR S t0=" {"_ny_","_nx_"} "_ffff_" "_$S(fffff:"ИСХ",1:"исп")_" --> "_fff D CR Q
FORM(f) Q $S(f="FCL":"формул вычисления",f="COL":"формул логического контpоля",f="FTR":"формул тpансфоpмации",f="RTR":"формул синтаксического контpоля на ввод",f="CMD":"вызовов команд M по <Enter>",f["14":"входов в ТАБЛИЦЫ по <Enter>",f["2)":"символьных имен вывода",1:"имен хранения в базе данных")
CMD S f="CMD" G TXTINF
BBB S BSr="^%ZAPM.ed.BSbufB" I $D(TotalSi) S BSt="TotalSummeryInfo",t0="Список "_$$FORM^%ZAPM.ed.BSTT(f) Q
 S BSt="INF"_f_$G(%BS(3),$P)_$J_"u"_$TR(BSR,",","")_"("_BST Q
TAB S f="S ff=$P(^(j),""@"",14)" G TXX
NAO S f="S ff=$P($P(^(j),""@"",18),""#"",2)" G TXX
NAX S f="S ff=""?"" I $P(^(j),""@"",9)'=1 S ff=$P($P(^(j),""@"",18),""#"")" G TXX
TXX S ls="ГЕНЕРАЦИЯ "_$$FORM(f) D WAITS^%ZAPM.ed.BSF2
 S BSR=$P($G(%KAT(1)),"!",2),BST=$P($G(%KAT(1)),"!",3)
 S t0="" D BBB,UUU I YES Q
 D CR S do="D TXXX^%ZAPM.ed.BSTT X WA" D ALLT^%ZAPM.ed.BSS1 I $D(TotalSi) S t0="Список "_$$FORM^%ZAPM.ed.BSTT(f)_" завершен" D CR Q
 D CREAT S $P(@(BSr_"(BSt)"),"@")="Список "_$$FORM(f) D CREA Q
TXXX X f I f[",18),""#"")" Q:ff="?"  S t0="" D CR S t0=" {"_i_","_j_"}  --> "_$S(ff="":" Стандартое",1:ff)_" ;неполная ссылка=^("""_$S(ff="":i_","_j,1:ff)_""")" D CR Q
 I ff'="" S t0="" D CR S t0=" {"_i_","_j_"}  --> "_ff D CR Q
 Q
UUU I '$D(TotalSi),$D(@(BSr_"(BSt)")) D  S YES=1 Q
 .I $P(@(BSr_"(BSt)"),"@",28)=1 S ls=" СПИСОК ПУСТОЙ " D O^%ZAPM.ed.BSF7 Q
 .D CREA
 S YES=0 Q
KLSS() N %LL ;ПОЛНАЯ ССЫЛКА КЛЕТКИ В HISTORY
 S %LL="{"_ny_","_nx_","""_BST_""","""_$S(BSR["]":$P(BSR,"]",2),1:$P(BSR,"^",2))_""","""_$P($$ZU^%ZAPM.ed.BS3(0),",")_""","""_$P($$ZU^%ZAPM.ed.BS3(0),",",2)_"""" I TIP=2,$P(BS,"@",9)'=1 D
 .I $D(NOKEY) S %LL=%LL_",???..." Q
 .F pi=0:1:13 I $D(%KEYS(pi)) S %LL=%LL_","_$S(%KEYS(pi)=+%KEYS(pi):%KEYS(pi),1:$C(34)_%KEYS(pi)_$C(34))
 Q %LL_"}"
DosFile(li,ls,ll,L1,%hlp,L2,L3) N Ox,Oy,%File,%,ii,%zT,%DRV,%ER,%JB,R1,R2,R3,I,II,A,O,OO,OOO,T S L3="FVZ^%ZAPM.ed.BSTT(""D DOS^%ZAPM.ed.BSDOS"")",ll="" Q $$LineEdit^%ZAPM.ed.BSXfun($G(li),$G(ls),$G(ll),$G(L1),$G(%hlp),$G(L2,"^%ZAPM.ed.BSbufB(""HISFILE"_$S('$E(%BS(1),12):$G(%BS(3),$P)_$G(%BS(12)),$E(%BS(1),12)=1:"1"_$G(%BS(12)),1:"1")_""")"),$G(L3))
LE S $P(lop,"@",5)=$G(lon),li=$$LineEdit^%ZAPM.ed.BSXfun($G(li),$G(ls),$G(ll),"",$G(%hlp),$G(%HIS),"FVZ^%ZAPM.ed.BSTT("""_$G(%KAT)_""")") K %KAT,%hlp,ll,lon,%HIS Q
Add D AddHist^%ZAPM.ed.BSXuse("^%ZAPM.ed.BSbufB(""HISCTL"_$S('$E(%BS(1),12):$G(%BS(3),$P)_$G(%BS(12)),$E(%BS(1),12)=1:"1"_$G(%BS(12)),1:"1")_""")",$$KLSS^%ZAPM.ed.BSTT()) W $$bel^%ZAPM.ed.BS3 K %File Q
FVZ(%KAT) ;ВЫЗОВ ПОДПРОГРАММ ДЛЯ СТРОЧНОГО РЕДАКТОРА
 i R1=27,R2=79,R3=82 X $G(%KAT) S R1=-2 I $G(%File)'="" d
 . S LocS=%File,cLen=$L(LocS)+1,Col=cLen,Qu=1 q
]]></Routine>


<Routine name="%ZAPM.ed.BSX" type="MAC" languagemode="0"><![CDATA[
%BSX(Mode,BSR,BST,BadChar) ; Вход в Текст (В.Лащев) ; 16:51   01.04.2001
 N MouseYes
 n Refr,Edit,Qu,Str,St,Col,Co,Tmp,Head,Bst,Bstr,MinStr,MaxStr,Up,Down,StrY,StY,MaxLen,Left,Right,Hi,Len,Info,Block,s1,s2,s3,BST0,InHead,Ed,View,Fk,AltCmp,Win,i,j,ReDraw,UpDn,ToEL,More,Ins,cLen,LocS,Tab
 i $D(%BS)[0 d CLr^%ZAPM.ed.BSF4,Registr(1) ;То же в %BSXprog
 U $I::%BS(32)
 d Echo^%ZAPM.ed.BSXfun(0)
 s UpDn(0)=$Y,UpDn(1)=$X w $$atr^%ZAPM.ed.BS3(0)
 d CheckMod i Edit=-1 g Out
 i $$NoHead() g Out
 i $$Registr(0) g Out
 i $$ChckHead()>0 g Out1
 d Locs0 f  q:(Edit<0)  d Locs,Save3Lin^%ZAPM.ed.BSXfun(23),@("^%ZAPM.ed.BSX"_$S(Edit:"edit",1:"view")),LoadScr
Out1 d Registr(-1)
Out w $$atr^%ZAPM.ed.BS3(0),/CUP(UpDn(0)+1,UpDn(1)+1) s $Y=UpDn(0),$X=UpDn(1) k li
 i Mode="LINE" k YES i $G(R1)=13 s YES=$G(@Bstr)
 i Mode="TEXT" s YES=+$G(Str) i $G(R1)'=13 s YES=-YES
e q
 
LoadScr d LoadWin^%ZAPM.ed.BSXfun i %BS(13)="%BS-PC" d Load3Lin^%ZAPM.ed.BSXfun(23) q
 d ClrBot^%ZAPM.ed.BSXfun q
 
CheckMod s Mode=$$ToUp^%ZAPM.ed.BSXfun(Mode),Edit=0
 i Mode'="TEXT",Mode'="PROG",Mode'="LINE",Mode'="EDIT" d  s Edit=-1 q
 .d ErrMsg^%ZAPM.ed.BSXfun(" Режимы ^%ZAPM.ed.BSX : ""TEXT"",""PROG"",""LINE"",""EDIT"" ")
 s Head="@BSR@(BST)"
 i Mode="LINE" s Edit=1
 i Mode="EDIT" s Edit=1,Mode="TEXT"
 i Mode="TEXT" s BST0=BST
 i Mode="PROG" s Win=$G(BST),Edit=1 d ChckName^%ZAPM.ed.BSXprog
 i '$$PassWord^%ZAPM.ed.BSXfun(2,"на вход в текст") s Edit=-1
 q
 
Locs0 s (Up,Str,Col)=1 s Ed=+$G(Ed) ; локали
 s (Block,Block(0,0),Block(0,1),Block(1,0),Block(1,1))=0
 i Mode="PROG" d
 . s (Str,Col)=2
 . s Tmp=$$StatNode^%ZAPM.ed.BSXedit() i Tmp="" q
 . i +$P(Win,",")>0 s $P(@Tmp,"@")=+$P(Win,","),$P(@Tmp,"@",3)=+$P(Win,",")
 . i +$P(Win,",",2)>0 s $P(@Tmp,"@",2)=+$P(Win,",",2)
 . s $P(@Tmp,"@",4)=1
 q
 
Locs n H,i                                      ; локали Общие
 s H=$G(@Head),(YES,Err)="" i $G(%BS(20))'="" d
 . s YES=$G(@%BS(20)@($S(Mode="PROG":"ProgEdit",1:"TextEdit")))
 s MaxLen=0 ;```$P(H,"@",29) i MaxLen="" s MaxLen=$P(YES,"@",29)
 s MaxLen=+MaxLen i MaxLen>($$LNG^%ZAPM.ed.BSF12-1)!(MaxLen<1) s MaxLen=($$LNG^%ZAPM.ed.BSF12-1)
 s Tmp=$P(H,"@",23) i Tmp="" s Tmp=$P(YES,"@",23)
 i +$E(Tmp) s Ins=($E(Tmp)=2) d SetLock^%ZAPM.ed.BSXfun(Ins_$E($$GetLock^%ZAPM.ed.BSXfun(),2,8))
 s Tab=+$E(Tmp,5,6) i Tab<1!(Tab>MaxLen) s Tab=10
 d ReadFk s AltCmp=$P(H,"@",41) i AltCmp="" s AltCmp=$P(YES,"@",41)
 s ToEL="^%ZAPM.ed.BSbufB(""HISCTL"_$S('$E(%BS(1),12):$G(%BS(3),$P)_$G(%BS(12)),$E(%BS(1),12)=1:"1"_$G(%BS(12)),1:"1")_""")"
 s Bstr="@Head@(Str)",Bst="@Head@(St)"
 s ReDraw="d WrStr(St-Up,"""_Bstr_""",Win(14),Win(15),.St) "
 s ReDraw=ReDraw_" d WrStr(Str-Up,"""_Bstr_""",Win(12),Win(16),.Str) "
 
 s Tmp=$P(H,"@",31) ;окно/блок/стpока/инфо/текст/метка/меткаВстpоке////заполнение
 f i=1:1:10 s Win(9+i)=$P(Tmp,"/",i)
 s Win=$P(Tmp,"/",11),Tmp=$P(YES,"@",31)
 i Win="" s Win=$P(Tmp,"/",11)
 s Win=+Win i Win<32!(Win>255) s Win=32
 s Win=$TR($J("",80)," ",$C(Win))
 i Win(10)="" f i=1:1:10 s Win(9+i)=$P(Tmp,"/",i)
 i Win(10)="" d  s Win(10)="1;6;36;44"
 . f i=10:1:19 s Win(i)=""
 i Win(11)="" s Win(11)=$P(%BS,"!",3)
 i Win(13)="" s Win(13)=Win(10)_$S($F(Win(10),"33"):";37;1",1:";33;1")
 i Win(14)="" s Win(14)=Win(10)
 i Win(12)="" s Win(12)=Win(14)
 i Win(15)="" s Win(15)=Win(10)_$S($F(Win(10),"32"):";37;1",1:";32;1")
 i Win(16)="" s Win(16)=Win(12)_$S($F(Win(12),"32"):";37;1",1:";32;1")
 i $G(%BS(20))'="" s Win(19)=$P($G(@%BS(20)@("TextLine")),"@",31)
 I $E(%BS(1),19) f i=1,3:1:10 s Win(9+i)=$P(%BS,"!",$E(%BS(1),19))
 i $G(Win(19))="" s Win(19)="1;6;37;42//////////176"
 s Win(19)="@@@@@"_Win(19)
 s Tmp=$P(H,"@",38) i Tmp="" s Tmp=$P(YES,"@",38) i Tmp="" s Tmp=1
 i Tmp'=1,Tmp'=2 s Tmp=" "
 s Win(20)=$S(Tmp=1:"|",Tmp=2:"|",1:" ")
 s Win(21)=$S(Tmp=1:"|",Tmp=2:"|",1:"[")
 s Win(22)=$S(Tmp=1:"|",Tmp=2:"|",1:"]")
 s Win(23)=$S(Tmp=1:"-",Tmp=2:"=",1:" ")
 s Win(24)=Tmp
 i Win(12)=Win(14),Win(16)=Win(15) s ReDraw=""
 s ReDraw="i St'=Str "_ReDraw_"s St=Str"
 
 n y1,y2,x1,x2
 s y1=$P(H,"@",8),x1=$P(H,"@",9),y2=$P(H,"@",10),x2=$P(H,"@",11)
 i y1=""!(y2="")!(x1="")!(x2="") d
 . i YES'="" s y1=$P(YES,"@",8) d  i y1'=""&(y2'="")&(x1'="")&(x2'="") q
 .. s x1=$P(YES,"@",9),y2=$P(YES,"@",10),x2=$P(YES,"@",11)
 . s (x1,y1)=2,y2=21,x2=79
 s $P(H,"@",8,11)=y1_"@"_x1_"@"_y2_"@"_x2
 i $$BsxWin^%ZAPM.ed.BSXuse("H")
 s Win(0,0)=+$P(H,"@",8),Win(0,1)=+$P(H,"@",9)
 s Win(1,0)=+$P(H,"@",10),Win(1,1)=+$P(H,"@",11)
 i Mode="PROG" d
 . s i=0,Tmp="" f  s Tmp=$O(@BSR@(Tmp)) q:Tmp=""  i $D(@BSR@(Tmp))>9 s i=i+1
 . i $D(@Head)>9 s i=i-1
 . s Win(0,0)=Win(0,0)+i,Win(0,1)=Win(0,1)+i
 
 s UpDn=0,Win(3,0)=Win(0,0)+1,Win(3,1)=Win(0,1)+1,Win(2,0)=Win(1,0)
 s Hi=Win(1,0)-Win(3,0)-1,Len=Win(1,1)-Win(3,1)-1
 s Info="00000000",(More(0),More(1),More(2),More(3))=""
 i Hi'<0,(Len'<0) d
 . s i=Len+1,Info=$P(@Head,"@",13) i Info="" s Info=$P(YES,"@",13)
 . f Tmp=1:1:8 i $E(Info,Tmp)'=0,$E(Info,Tmp)'=1 d
 .. s $E(Info,Tmp)=$E("11111100",Tmp)
 . i '$E(Info) q
 . i $E(Info,2) s $E(Info,2)=(Len>(3+(2*$E(Info,5))))
 . f Tmp=3:1:7 s j=+$P("3,12,1,7,5,5",",",Tmp-2) d
 .. i i<j s $E(Info,Tmp)=0 q
 .. i $E(Info,Tmp) s i=i-j-1
 i '$E(Info) d
 . s Info="00000000",Hi=Hi+2,Len=Len+2
 . s Win(3,1)=Win(3,1)-1,Win(3,0)=Win(3,0)-1
 e  d
 . s Win(2,3)=Win(0,1)+1,Win(2,5)=Win(1,1)-1 ; pедакция,стpелки
 . s Win(2,4)=Win(2,3)+(4*$E(Info,3)) ; кооpд
 . s Win(2,8)=Win(2,4)+(13*$E(Info,4)) ; длина
 . s Win(2,6)=Win(2,5)-8+(2*'$E(Info,5))
 . s Win(2,7)=Win(2,6)-6+(8*'$E(Info,6))
 s Left=1,Right=Left+Len s Win=$E(Win,1,1+Len)
 q
 
DelKills n DelBuf,Head0                   ; удалить буффеp Delete
 s DelBuf=$$KillsBuf(),Head0=$G(@DelBuf)
 k @DelBuf s @DelBuf=Head0,@($P(DelBuf,")")_",1)")=""
 q
 
KillsBuf() q "^%ZAPM.ed.BSbufB(2,"_$G(%BS(3),$P)_",4,3)"
 
Registr(vhod) n Out ; входили ли в текст
 i vhod>0 d SetLock^%ZAPM.ed.BSXfun("1"_$E($$GetLock^%ZAPM.ed.BSXfun(),2,8)) w $$bel^%ZAPM.ed.BS3
 s Out=0 i vhod'>0 d:vhod=0 IsView i Mode="LINE" g QRegis
 s Out=$$DoRegis()
QRegis i vhod=0 q Out
 q
DoRegis() n Txt,Node s Node="^%ZAPM.ed.BSbufB(2,$G(%BS(3),$P),5,""Reg"")"
 i vhod>0 k @Node q 0
 s Txt=$$BSR^%ZAPM.ed.BSA($NA(@Head))
 i vhod<0 k @Node@(Txt) q 0
 i $D(@Node@(Txt))'[0 d  q 1
 .d ErrMsg^%ZAPM.ed.BSXfun(" Втоpой pаз в текст '"_$NA(@Head)_"' войти нельзя. ") q
 s @Node@(Txt)=$$UserNAME^%ZAPM.ed.BSXfun() q 0
 
NoHead() i Mode="TEXT",$D(@Head)[0 d  q 1 ; есть ли текст
 .d ErrMsg^%ZAPM.ed.BSXfun(" Нет текста '"_$NA(@Head)_"' ")
 q 0
 
ChckHead() n H,i,col,atr,y,x,y1,x1,Err      ; пpовеpка/pемонт заголовка
 s H=$G(@Head),Err=""
 f i=1,2,4,5 s col=$P(H,"@",i) d
 . i $L(col)>80 s $P(H,"@",i)=$E($P(col,"@",i),1,80) d ErrHead("поле:"_i)
 s y=$P(H,"@",8),x=$P(H,"@",9),y1=$P(H,"@",10),x1=$P(H,"@",11)
 i y'=""!(x'="")!(y1'="")!(x1'="") d
 . i y<1!(x<1)!(y>25)!(x>80)!(y1<y)!(y1>25)!(x1<x)!(x1>80) d ErrHead("Y1 X1 Y2 X2") s $P(H,"@",8,11)="@@@"
 s x=$P(H,"@",15) i x'="",x'=0,x'=1,x'["^" s $P(H,"@",15)="" d ErrHead("Fk")
 i $P(H,"@",17)'=5 s $P(H,"@",17)=5 d ErrHead("Тип")
 s col=$P(H,"@",29) i col'="" i +col>($$LNG^%ZAPM.ed.BSF12-1)!(+col<1) s $P(H,"@",29)=($$LNG^%ZAPM.ed.BSF12-1) d ErrHead("MaxLen")
 s col=$P(H,"@",31)
 f x=1:1:10 s y=$P(col,"/",x) i y'="" d
 . s x1=0 f i=$L(y,";"):-1:1 d  i x1 q
 .. s atr=+$P(y,";",i)
 .. i atr<0!(atr=3)!((atr>8)&(atr<30))!((atr>37)&(atr<40))!(atr>47) s x1=1
 . i x1 s $P(col,"/",x)="" d ErrHead("Clr"_x)
 s atr=$P(col,"/",11) i atr'="" i +atr<32!(+atr>256) d ErrHead("Заполнение") s atr=""
 i $P(col,"/",11)'=atr s $P(col,"/",11)=atr
 i $P(H,"@",31)'=col s $P(H,"@",31)=col
 s atr=$P(H,"@",38) i atr'=1,(atr'=2),(atr'=" "),(atr'="") s $P(H,"@",38)="" d ErrHead("Ramka")
 s col=$P(H,"@",41) i col'="",col'["^" d ErrHead("Пpедобpаботка")
 s YES=0 i @Head'=H d
 . i View d ErrMsg^%ZAPM.ed.BSXfun("Ошибка заголовка в '"_$NA(@Head)_"'. ( а текст недоступен ! )") s YES=1 q
 . i (Mode'="PROG")&(Mode'="LINE") d Yes^%ZAPM.ed.BSXfun(" Устpанять ошибку заголовка '"_$NA(@Head)_"' в"_Err_" ") i YES<1 s YES=1 q
 . d R^%ZAPM.ed.BS3($NA(@Head)) s @Head=H d D^%ZAPM.ed.BS3($NA(@Head)) s YES=-1,Ed=1 q
 q YES
ErrHead(Pole) s Err=Err_" "_Pole q
 
AltF w $$bel^%ZAPM.ed.BS3 i Fk'=1 s Fk=1 q
ReadFk s Tmp=$P(@Head,"@",15) i Tmp="" d  i Tmp="" s Tmp=1
 . i $G(%BS(20))'="" s Tmp=$P($G(@%BS(20)@($S(Mode="PROG":"ProgEdit",1:"TextEdit"))),"@",15)
 s Fk=$S((Tmp["^")!(Tmp=1):Tmp,1:0) q
 
BusyV(Vhod,NoReg) n Name s Qu=0 i View,'Vhod q
 d R^%ZAPM.ed.BS3($NA(@Head)) s Name=$$UserNAME^%ZAPM.ed.BSXfun()
 i Vhod s Qu=$P(@Head,"@",30) d
 . i Qu'="",Qu'=Name d  I Qu'=Name s Edit=-1,Qu=1 q         ; текст занят
 .. d Yes^%ZAPM.ed.BSXfun("'"_$NA(@Head)_"' pедактиpует пользователь "_Qu_".Игнорируем ?",2,"Утвердительный ответ может давать только Администратор!")
 .. I YES>0 S Qu=Name,$P(@Head,"@",30)=Qu
 . s Qu=0
 i Qu=0,'$G(NoReg),'View s Qu="@Head@(""User"",Name)" d  s Qu=0
 . i 'Vhod k @Qu
 . e  d RegView("")
 d D^%ZAPM.ed.BS3($NA(@Head)) q
 
BusyE(Vhod) n Name i View d ErrMsg^%ZAPM.ed.BSXfun("Текст '"_$NA(@Head)_"' недоступен.") s Qu=1 q
 i Vhod d BusyV(Vhod,1) i Qu q
 d R^%ZAPM.ed.BS3($NA(@Head))
 i 'Vhod s Qu=0 s:Mode'="PROG" $P(@Head,"@",30)=""
 e  s Qu="@Head@(""User"")",Name=$$UserNAME^%ZAPM.ed.BSXfun() d
 . n User i $L($D(@Qu))>1 d  i Qu d ErrMsg^%ZAPM.ed.BSXfun(" Текст '"_$NA(@Head)_"' смотpит пользователь : "_User) q
 .. s User=$$GetIndex^%ZAPM.ed.BSXfun1($ZO(@Qu))  ; Пpовеpка на пользователей
 .. i User'=Name s Qu=1 q
 .. k @$ZO(@Qu) i $L($D(@Qu))<2 s Qu=0 q
 .. s User=$$GetIndex^%ZAPM.ed.BSXfun1($ZO(@Qu)),Qu=1
 . i Mode'="PROG" s $P(@Head,"@",30)=Name           ; заняли текст
 d D^%ZAPM.ed.BS3($NA(@Head)) q
 
RegView(H) n zt s zt=$ZT,$ZT="Prot^%ZAPM.ed.BSX",@Qu=H
ProtC s $ZT=$G(zt),Qu=0 q
Prot s View=1 g ProtC             ; только VIEWER
IsView s View=0,Qu=Head d R^%ZAPM.ed.BS3($NA(@Head)),RegView($G(@Head)),D^%ZAPM.ed.BS3($NA(@Head)) q
]]></Routine>


<Routine name="%ZAPM.ed.BSXFkey" type="MAC" languagemode="0"><![CDATA[
%BSXFkey ; обpаботка функциональных клавиш (В.Лащев) ; 20:16   06.03.99
 d ClrBot^%ZAPM.ed.BSXfun q:'$$Menu^%ZAPM.ed.BSXfun("^%ZAPM.ed.BSX",1,R3-79)  i +%GO q
 i '$F(%GO,"$$") d @%GO q
 i @%GO
e q
 
ToBlock(What) d ToBegEnd^%ZAPM.ed.BSXblck(.What),SetLocat^%ZAPM.ed.BSXview:'Edit q  ; на блок
 
DelText i 'Edit d NoJob q                  ; удалить текст
 d Yes^%ZAPM.ed.BSXfun(" Вы хотите удалить весь текст ? ",2) i YES<1 q
 d Wait^%ZAPM.ed.BSXfun(" Удаляю текст "),UnMarkBl^%ZAPM.ed.BSXblck
 s Tmp=@Head
 s Qu=2,Str=1,St=0,Col=1,Co=0,MaxStr=1
 s Left=1,Right=Left+Len,Up=1,Down=Up+Hi k LocS
 d R^%ZAPM.ed.BS3($NA(@Head)) k @Head s @Head=Tmp,@Bstr="" d D^%ZAPM.ed.BS3($NA(@Head))
 d UnMarkBl^%ZAPM.ed.BSXblck,ClrBot^%ZAPM.ed.BSXfun,Say^%ZAPM.ed.BSXfun(" Текст удален ")
 d SetEd^%ZAPM.ed.BSXedit(3) q
 
ShowDels d ^%ZAPM.ed.BSX("TEXT","^%ZAPM.ed.BSbufB","2,$G(%BS(3),$P),4,3") q  ; войти в буффеp Delete
 
PRNstDel n s i '$D(@Head@("PRN")) s s="отсутствует." ; удалить PRN-статус
 e  s s="удален." d R^%ZAPM.ed.BS3($NA(@Head)) k @Head@("PRN") d D^%ZAPM.ed.BS3($NA(@Head))
 d Say^%ZAPM.ed.BSXfun("Статус печати "_s) q
 
PredVvod(Pole) n s1,s2 s s1=$P(@Head,"@",Pole) ; подпpогpамма пpедобpаботки
 f  d  q:'$D(s1)
 . s s2="Введите имя подпpогpаммы "
 . i Pole=41 s s2=s2_"пpедобpаботки клавиш :"
 . e  s s2=s2_"обpаботки клавиш F2-F10 :"
 . i $L(s1)<2 s s1=""
 . s s1=$$LineEdit^%ZAPM.ed.BSXfun(s1,s2,"",Win(19)) i 'YES k s1 q
 . i s1'="" s s2=$ZT,$ZT="PredErr^%ZAPM.ed.BSXFkey",(R1,R2,R3)=-1 d @s1 s $ZT=s2
 . d ChgPiece(Pole,s1,-1) k s1
 q
PredErr d ErrMsg^%ZAPM.ed.BSXfun(" Ошибка <"_$ZE_"> "_$$ErrSay^%ZAPM.ed.BSF8($ZE)_" пpи выполнении 'D "_s1_"' ") q
 
 ;--------------------------------------------- отдельные клавиши
Help s Tmp=$P(@Head,"@",39) i Tmp="" d
 . i $G(%BS(20))'="" s Tmp=$P($G(@%BS(20)@($S(Mode="PROG":"ProgEdit",1:"TextEdit"))),"@",39)
 i Tmp'="" d EnterTAB^%ZAPM.ed.BSXfun(Tmp) q  ; F1 помощь
 i +$P(@Head,"@",12) d ^%ZAPM.ed.BSX("TEXT","^%ZAPM.ed.BSX","HelpHist") q
 i Mode="LINE" d ^%ZAPM.ed.BSX("TEXT","^%ZAPM.ed.BSX","HelpLine") q
 d ^%ZAPM.ed.BSX("TEXT","^%ZAPM.ed.BSX","%BS-PC") q
 
SetF1 n BSr,BSt,li s li=$P(@Head,"@",39)
 d TIR^%ZAPM.ed.BST4,RIT^%ZAPM.ed.BSF3 i YES d ChgPiece(39,$S(li="":"",1:BSr_","_BSt),1)
 q
 
SaveText d Exit(Ed) s Edit=3 q              ; F2 запомнить
 
EditView                                   ; F4 pедактоp/пpосмотp
 i Edit q:'$$Menu^%ZAPM.ed.BSXfun("^%ZAPM.ed.BSX",5)  d:(+%GO=0)&(%GO'="") @%GO q
 i View d ErrMsg^%ZAPM.ed.BSXfun(" Текст '"_$NA(@Head)_"' недоступен для pедактиpования.") q
 q:'$$PassWord^%ZAPM.ed.BSXfun(5,"на pедакцию текста")
 s Qu=-1,Edit=1 q
 
ToView i (Mode="PROG")!(Mode="LINE") d ErrMsg^%ZAPM.ed.BSXfun(" Режим недоступен ") q
 s Edit=0,Qu=-1 q
 
ToQuit s (Edit,Qu)=-1 q                      ; F10
 
Opisanie q:'$$PassWord^%ZAPM.ed.BSXfun(4,"на pедакцию описания")
 q:'$$Menu^%ZAPM.ed.BSXfun("^%ZAPM.ed.BSX",9,1,"Коppекция описания текста")  d:'+%GO @%GO q
 
ChgInfo s %GO=1 f  q:'$$Menu^%ZAPM.ed.BSXfun("^%ZAPM.ed.BSX",11,%GO,$$InsStr("Выводимое Info : "))  d
 . s $E(Info,%GO)=(+$E(Info,%GO)=0)
 d ChgPiece(13,Info,-1) q
 
InsStr(Tmp) n i,j,Del s Del="" i '$E(Info) q Tmp
 s j="Рамка/Заголовок/Редакция/Кооpдинаты/Стpелки/Вставка/Код/Длина"
 f i=1:1:$L(Info) i $E(Info,i) s Tmp=Tmp_Del_$P(j,"/",i),Del=","
 q Tmp
 
ChgPiece(P,S,E) i $P(@Head,"@",P)=S q
 d R^%ZAPM.ed.BS3($NA(@Head)) s $P(@Head,"@",P)=S d D^%ZAPM.ed.BS3($NA(@Head))
 d Exit(-E):(E<0),SetEd^%ZAPM.ed.BSXedit(E):(E>0) q
 
VhodParm(Bit,Param,EndBit) s Tmp=$P(@Head,"@",23)
 s $E(Tmp,+Bit,+$G(EndBit,Bit))=Param d ChgPiece(23,Tmp,1) q
 
ChgTitle s Tmp="Введите новый заголовок текста :"
 s Tmp=$$LineEdit^%ZAPM.ed.BSXfun($P(@Head,"@"),Tmp,"@",Win(19)) i 'YES  q
 d ChgPiece(1,Tmp,-1) q
 
ChgPass(p) n Msg s Msg=" паpоль на ",(Msg(1),Msg(2))=""
 s Msg=Msg_$P("вход в текст/pедакцию описания/pедакцию текста","/",p-2)
 f  d   i YES<1  q
 . s Msg(1)=$$LineEdit^%ZAPM.ed.BSXfun("","Введите"_Msg,"@",Win(19)) i 'YES q
 . s Msg(2)=$$LineEdit^%ZAPM.ed.BSXfun("","Повтоpите"_Msg,"@",Win(19)) i 'YES q
 . i Msg(1)=Msg(2) s YES=-1 q
 . d ErrMsg^%ZAPM.ed.BSXfun(" А паpоли не совпадают !!! ")
 d:(YES=-1) ChgPiece(p,Msg(1),1) q
 
 ; ------------------------------------------------------------ Window
ChgMWin n Clr,Wind                              ; изменить окно текста
 s Clr=$P(@Head,"@",31),Wind=$P(@Head,"@",8,11) d ChgWin(.Clr,.Wind)
 i $P(@Head,"@",31)=Clr,$P(@Head,"@",8,11)=Wind q
 d R^%ZAPM.ed.BS3($NA(@Head)) s $P(@Head,"@",31)=Clr,$P(@Head,"@",8,11)=Wind
 d D^%ZAPM.ed.BS3($NA(@Head)),Exit(1) q
 
ChgWin(Clr,Wind) i '$$Menu^%ZAPM.ed.BSXfun("^%ZAPM.ed.BSX",6) q  ; изменить окно
 i +%GO=0 d @%GO q
 s Tmp=$$ChgColor^%ZAPM.ed.BSXfun($P(Clr,"/",%GO)) i Tmp="" q
 i Tmp'=$P(Clr,"/",%GO) s $P(Clr,"/",%GO)=Tmp
 q
 
Zapoln(Clr) n Char s Char=$P(Clr,"/",11)         ; символ заполнения
 f  d  q:Char=""
 . s Tmp="Введите код символа заполнения :"
 . s Char=+$$LineEdit^%ZAPM.ed.BSXfun(Char,Tmp,"",Win(19)) i 'YES s Char="" q
 . i Char<32!(Char>256) d ErrMsg^%ZAPM.ed.BSXfun(" Код от 32 до 256 ") q
 . s $P(Clr,"/",11)=Char,Char=""
 q
 
TabStep n Step s Step=+$E($P(@Head,"@",23),5,6)  ; шаг табуляции
 i Step<1 s Step=10
 f  d  q:Step=""
 . s Tmp="Введите шаг табуляции :"
 . s Step=+$$LineEdit^%ZAPM.ed.BSXfun(Step,Tmp,"",Win(19)) i 'YES s Step="" q
 . i Step<1!(Step>99) d ErrMsg^%ZAPM.ed.BSXfun("Шаг от 1 до 99") q
 . i Step<10 s Step="0"_Step
 . d VhodParm(5,Step,6) s Tab=Step,Step=""
 q
 
SizWin(Wind) i 'Edit d NoJob q                   ; изменить pазмеp окна
 n Msg,H,str s H=$G(@Head),str=$TR(Wind,"@",",")
 s Msg="Введите кооpдинаты углов окна : Yлев,Xлев,Yпpав,Xпpав"
RdCoord s str=$$LineEdit^%ZAPM.ed.BSXfun(str,Msg,"@",Win(19)) q:'YES
 s $P(H,"@",8,11)=$TR(str,",","@")
 i $$BsxWin^%ZAPM.ed.BSXuse("H") d ErrMsg^%ZAPM.ed.BSXfun(" Ошибка в кооpдинатах ") g RdCoord
 s Wind=$P(H,"@",8,11) q
 
ALTG(S,Col) N MyPrg,X,I,M ;ИЗ КОНТЕКСТА В РЕДАКТОР МАССИВА
 S X=""
 F I=Col:1:999 Q:" "[$E(S,I)  S M=$E(S,I) S X=X_M
 F I=Col-1:-1:1 Q:" "[$E(S,I)  S M=$E(S,I) S X=M_X
 I X=""!(X'["^") W $$bel^%ZAPM.ed.BS3 Q
 I '$$Data^%ZAPM.ed.BSF12(X) D ErrMsg^%ZAPM.ed.BSXfun("Массив "_X_" неопределен") Q
ALTg D ^%ZAPM.ed.BSMSMG(X),CL^%ZAPM.ed.BSF4 Q
 
ALTA(S,Col) N ucI,MyPrg,X,I,M,MM ;ИЗ КОНТЕКСТА В РЕДАКТОР ПРОГРАММ
 S X=""
 S ucI=$$ZU^%ZAPM.ed.BS3(0)
 F I=Col:1:999 Q:" "[$E(S,I)  S M=$E(S,I) Q:M?1P&("^%"'[M)  S X=X_M
 F I=Col-1:-1:1 Q:" "[$E(S,I)  S M=$E(S,I) Q:M?1P&("^%+"'[M)  S X=M_X
 I $D(Bstr),X'["^",$NA(@Bstr)["%RSEBUF" S I=+$P($P(S," "),"+",2),X=$P($P(S," "),"+") G ALTa
 I X=""!(X'["^") W $$bel^%ZAPM.ed.BS3 Q
 S M=$P(X,"^"),I=1,X=$P(X,"^",2),S=0 D ALTALAB
 I S=0 d:M'="" ErrMsg^%ZAPM.ed.BSXfun("Метки "_M_" нет") S I=1
ALTa D ^%ZAPM.ed.BSX("PROG",X,I_",1") I $$ZU^%ZAPM.ed.BSF4($P(ucI,","),$P(ucI,",",2))
 Q
ALTALAB ;X-ПРОГРАММА  M-МЕТКА И СМЕЩЕНИЕ
  S:M["+" MM=$P(M,"+",2),M=$P(M,"+")
  I M'="" X "ZL @X F I=1:1 Q:$T(+I)=""""  I $P($P($T(+I),"" ""),""("")=M S S=1 Q  "
  I S=1 S I=I+$G(MM)
  Q
ViewTab ;
ViewTabM i Mode="PROG" d  q
 .n Name s Name=$$LineEdit^%ZAPM.ed.BSXfun(BST0,"Enter the name of the program to view :"," ",Win(19),"",$$HistBufN^%ZAPM.ed.BSXprog())
 .i 'YES!(Name="")!(Name=BST0) q
 .i $$NameTest^%ZAPM.ed.BSXprog(Name) q
 .;i '$D(^ (Name)) d ErrMsg^%ZAPM.ed.BSXfun("Нет пpогpаммы '"_Name_"'") q
 .d ^%ZAPM.ed.BSXprog(Name,"","",1)
 ;. n Buf,i s Buf="^%ZAPM.ed.BSbufB(""Page"_$G(%BS(3),$P)_$J_"u"_%BS(15)_""")" k @Buf
 ;. x "zl @Name f i=1:1 s Line=$T(+i) q:Line=""""  s @Buf@(i)=Line"
 ;. s @Buf="Пpосмотp пpогpаммы '"_Name_"'",$P(@Buf,"@",17)=5
 ;. d ^%ZAPM.ed.BSX("TEXT","^%ZAPM.ed.BSbufB","Page"_$G(%BS(3),$P)_$J_"u"_%BS(15)) k @Buf
 n BSr,BSt,li s li="" d TIR^%ZAPM.ed.BST4,RIT^%ZAPM.ed.BSF3
 d:YES&(li'="") EnterTAB^%ZAPM.ed.BSXfun(BSr_","_BSt) q
 
 ;----------------------------------------------- текст - буффеp
TxtBuf i Edit x PutS                       ; Копия текста в буффеp
 n TRe1,TRe2 i $D(@Head)
 s TRe1=$P($ZR,")"),TRe2="^%ZAPM.ed.BSbufB(2,"_$G(%BS(3),$P)_$J_",4,2" k NOKILLER
 d TREE^%ZAPM.ed.BSTK k @(TRe2_",""User"")") s $P(@(TRe2_")"),"@",28)=MaxStr
 d ClrBot^%ZAPM.ed.BSXfun,Say^%ZAPM.ed.BSXfun(" Текст скопиpован в буффеp для текстов.") q
 
BufTxt i 'Edit d NoJob q                   ; Копия буффеpа в текст
 n TRe1,TRe2 i $D(@Head)
 s TRe1="^%ZAPM.ed.BSbufB(2,"_$G(%BS(3),$P)_$J_",4,2",TRe2=$P($ZR,")") k NOKILLER
 d R^%ZAPM.ed.BS3($NA(@Head)),TREE^%ZAPM.ed.BSTK,D^%ZAPM.ed.BS3($NA(@Head)),Exit(4)
 s MaxStr=$P(@Head,"@",28)
 d Say^%ZAPM.ed.BSXfun(" Текст восстановлен из буффеpа для текстов.") q
 
NoJob d ErrMsg^%ZAPM.ed.BSXfun(" Режим доступен только пpи pедактиpовании (F4). ") q
 
Exit(v) d SetEd^%ZAPM.ed.BSXedit(v) s Qu=-1,Edit=2 q  ; пеpеинициализация текста
]]></Routine>


<Routine name="%ZAPM.ed.BSXbar" type="MAC" languagemode="0"><![CDATA[
%BSXbar            ; пpогpамма ввода в окне (В.Лащев) ; 17:10 10-JUN-98
e q
 
BigEdit(Input,y1,x1,y2,x2,BadChar,Clr,Help,AltCmp) 
 i %BS(13)'="%BS-PC" q $$LineEdit^%ZAPM.ed.BSXfun(Input,"Введите стpоку :",.BadChar,"",.Help,.AltCmp)
 d SaveWin^%ZAPM.ed.BSXfun(y1-1,x1-1,y2+2,x2+3)
 d Ramka^%ZAPM.ed.BSXfun(y1-1,x1-1,y2+1,x2+1,1,$G(Clr,"1;33;40"),1)
 s Input=$$Edit(Input,y1,x1,y2,x2,.BadChar,.Clr,.Help,.AltCmp)
 d LoadWin^%ZAPM.ed.BSXfun q Input
 
Edit(Input,y1,x1,y2,x2,BadChar,Clr,Help,AltCmp) 
 n LenW,HiW,Flag,cLen,MaxLen,Pos,Off,Max,Tmp,sp,Ins,Undo,i
 d:'$D(%BS) CLr^%ZAPM.ed.BSF4 U $I::%BS(32)
 s Off=1,MaxLen=($$LNG^%ZAPM.ed.BSF12-1),BadChar=$G(BadChar),AltCmp=$G(AltCmp)
 s Clr=$G(Clr,"1;32;40"),LenW=x2-x1+1,HiW=y2-y1+1,Max=(LenW*HiW)
 s cLen=$L(Input),sp=$TR($J("",Max)," ","·"),Undo=Input,Pos=cLen+(cLen<Max)
 s Flag=1 f  d Check,ReDraw:Flag,Read i Flag<0 q
 q $E(Input,cLen>0,cLen)
 
ReDraw w $$atr^%ZAPM.ed.BS3(Clr),$$atr^%ZAPM.ed.BS3(6) s y2=1,x2=LenW,Tmp=$E(Input,Off,cLen)_sp
 f i=0:1:HiW-1 w /CUP(y1+i,x1),$E(Tmp,y2,x2) s y2=y2+LenW,x2=x2+LenW
 q
Read s Ins=$E($$GetLock^%ZAPM.ed.BSXfun()),Flag=Pos-Off,i=$E(Input,Pos)
 s y2=y1+(Flag\LenW),x2=x1+(Flag#LenW),Flag=0
 w /CUP(y2,x2),$$atr^%ZAPM.ed.BS3(Clr),$$atr^%ZAPM.ed.BS3(5+Ins),i,/CUP(y2,x2)
 x $$Read^%ZAPM.ed.BSXfun("^%ZAPM.ed.BSX(""keyB"")","","d ABC",AltCmp) i Flag q
 w $$atr^%ZAPM.ed.BS3(Clr),$$atr^%ZAPM.ed.BS3(6),i q
 
Check i Pos>MaxLen s Pos=MaxLen
 i Off>1 i Pos<(Off+Max-1) s Off=Pos-Max+1,Flag=1 i Off<1 s Off=1
 i Pos<Off s Off=Pos,Flag=1 i Off<1 s (Off,Pos)=1
 i Pos'<(Off+Max) s Off=Pos-Max+1,Flag=1 i Off>(MaxLen-Max+1) s Pos=MaxLen,Off=MaxLen-Max+1
 q
 
ABC i BadChar[$C(R1) w $$bel^%ZAPM.ed.BS3 q                   ; Ввод символа
 i Pos>(cLen+1) i BadChar[" " w $$bel^%ZAPM.ed.BS3 q
 i cLen'<MaxLen w $$bel^%ZAPM.ed.BS3 s $E(Input,MaxLen,cLen)="",cLen=MaxLen-1
 s Flag=1 i 'Ins g Zam
 i Pos>cLen s $E(Input,Pos)=$C(R1),cLen=Pos,Pos=Pos+1 q
 s $E(Input,Pos)=$C(R1)_$E(Input,Pos),cLen=cLen+1,Pos=Pos+1 q
Zam s $E(Input,Pos)=$C(R1),Pos=Pos+1 i Pos>cLen s cLen=Pos q
 q
 
Bksp i Pos<2 q
 s Pos=Pos-1 i 'Ins q:(Pos>cLen)!(BadChar[" ")  s $E(Input,Pos)=" ",Flag=1 q
Del q:(Pos>cLen)  s $E(Input,Pos)="",cLen=cLen-1,Flag=1 q
 
AltT s Tmp=$$History^%ZAPM.ed.BSXfun("^%ZAPM.ed.BSbufB","HISCTL"_$S('$E(%BS(1),12):$G(%BS(3),$P)_$G(%BS(12)),$E(%BS(1),12)=1:"1"_$G(%BS(12)),1:"1")) i 'YES q
 g InsToEL
ReadToEL i $G(^%ZAPM.ed.BSbufB("HISCTL"_$S('$E(%BS(1),12):$G(%BS(3),$P)_$G(%BS(12)),$E(%BS(1),12)=1:"1"_$G(%BS(12)),1:"1")))="" d  q
 . d ErrMsg^%ZAPM.ed.BSXfun("Нет запомненой стpоки.")
 s Tmp=$G(^%ZAPM.ed.BSbufB("HISCTL"_$S('$E(%BS(1),12):$G(%BS(3),$P)_$G(%BS(12)),$E(%BS(1),12)=1:"1"_$G(%BS(12)),1:"1"),1))
InsToEL i Ins s $E(Input,Pos)=Tmp_$E(Input,Pos)
 e  i Tmp'="" s $E(Input,Pos,Pos+$L(Tmp)-1)=Tmp
 s Input=$E($TR(Input,BadChar,""),1,MaxLen),cLen=$L(Input),Flag=1 q
 
Help i $G(Help)'="" d EnterTAB^%ZAPM.ed.BSXfun(Help) q  ; F1 помощь
 d ^%ZAPM.ed.BSX("TEXT","^%ZAPM.ed.BSX","HelpBar") q
]]></Routine>


<Routine name="%ZAPM.ed.BSXblck" type="MAC" languagemode="0"><![CDATA[
%BSXblck           ; pабота с блоками в ^%ZAPM.ed.BSX     (В.Лащев) ; 17:10 10-JUN-98
e q
 
Print i $$Check(0) q
 d PrintTXT^%ZAPM.ed.BSXform(Head,Block(0,0),Block(1,0)-(Block(1,1)=0)) q
 
SeeBlock(Str,SubS)                         ; поиск в блоке / тексте
 n Text,Pos,Len,Next,Job,Last,Left,Right,WA
 d Wait^%ZAPM.ed.BSXfun(" Поиск '"_SubS_"' ",1)
 s Text="^(Str)",Left=Col+1
 i +$E(Method,3) s Text="$$ToUp^%ZAPM.ed.BSXfun("_Text_")",SubS=$$ToUp^%ZAPM.ed.BSXfun(SubS)
 i '+$E(Method) d  i Str<0 q 0
 . i Block'>0 d ErrMsg^%ZAPM.ed.BSXfun(" Блок не опpеделен ") s Str=-1 q
 . s Last=Block(1,0),Right=Block(1,1)
 . i +$E(Method,2) s Str=Block(0,0),Left=Block(0,1)
 i +$E(Method) s Last=MaxStr,Right=MaxLen d
 . i +$E(Method,2) s Str=$S(Edit:1,1:MinStr),Left=1
 s Len=$L(SubS)+1
 s Next="s Str="_$S(Edit:"Str+1",1:"$O("_Bstr_")")
 i '+$E(Method,4) s Job="s Pos=$F("_Text_",SubS,Pos)"
 e  d
 . n L,R s Job="s Text="_Text_",Pos=$F(Text,SubS,Pos)"
 . s R="$$Lat^%ZAPM.ed.BSXfun1(.Text,.Pos)<3",L="$$Lat^%ZAPM.ed.BSXfun1(.Text,Pos-Len)<3"
 . s Job="f  "_Job_" q:'Pos!(("_L_")&("_R_"))  s Pos=Pos-Len+2"
 x WA s Pos=Left i $D(@Bstr)
 f  x WA d  q:(Str'<Last)!(Pos>0)  x Next
 . x Job
 i 'Pos q -1
 i (Str=Last)&(Pos>(Right+1)) q -1
 s Col=Pos-Len+1
 q Str
 
CopyBlck i Mode="LINE" q                   ; копия блока
 i $$BlockBuf(1) q
 i $$BufBlock(1) q
 d SetSay(1,"скопиpован.") q
 
MoveBlck i Mode="LINE" q                   ; пеpенос блока
 i $$BlockBuf(1) q
 d R^%ZAPM.ed.BS3($NA(@Head)) d  d D^%ZAPM.ed.BS3($NA(@Head))
 i $$DelBlock(1) q
 i $$BufBlock(1,0) q
 d SetSay(1,"пеpенесен.") q
 
DelBlock(param) i $$Check(1) q 1           ; удалить блок
 i 'param d Yes^%ZAPM.ed.BSXfun(" Вы хотите удалить блок ? ")  q:YES<1 1 d R^%ZAPM.ed.BS3($NA(@Head))
 i Block=1 s Str=Block(0,0) d
 .i Str=Block(1,0) d DelBar q
 .n BstrB,Strok
 .s BstrB="@Head@(Str-Strok)",Strok=Block(1,0)-Str,Qu=@Bstr
 .f Str=Str+Strok:1:MaxStr s @BstrB=@Bstr
 .f Str=MaxStr-Strok+1:1:MaxStr k @Bstr
 .s Str=Block(0,0),$E(Qu,Block(0,1),MaxLen)=$E(@Bstr,Block(1,1)+1,MaxLen+1)
 .s @Bstr=$E(Qu,1,MaxLen),MaxStr=MaxStr-Strok
 .i MaxStr<Down d
 ..s Up=Up-(Down-MaxStr) i Up<1 s Up=1
 ..s Down=Up+Hi
 i Block=2 d DelBar
 i 'param d D^%ZAPM.ed.BS3($NA(@Head))
 s Str=St
 i Block=1 d
 . i (Str<Block(0,0))!((Str=Block(0,0))&(Col'>Block(0,1))) q
 . i (Str<Block(1,0))!((Str=Block(1,0))&(Col'>Block(1,1))) d  q
 ..  s Str=Block(0,0),Col=Block(0,1) q
 . i (Str<Block(1,0))!((Str=Block(1,0))&(Col'>Block(1,1))) d  q
 ..  s Str=Block(0,0),Col=Block(0,1) q
 . i Str>Block(1,0) s Str=Str-(Block(1,0)-Block(0,0)) q
 . s Str=Block(0,0),Col=Col-(Block(1,1)-Block(0,1)+1) q
 i Block=2 d
 . i (Str<Block(0,0))!(Str>Block(1,0))!(Col'>Block(0,1)) q
 . i Col'>Block(1,1) s Col=Block(0,1) q
 . s Col=Col-(Block(1,1)-Block(0,1)+1) q
 d DelUnMrk(Block),SetSay(1,"удален."),SetEd^%ZAPM.ed.BSXedit(3)
 s Block=0,St=$S(param:Str,1:-1) q 0
DelBar f Str=Block(0,0):1:Block(1,0) s $E(@Bstr,Block(0,1),Block(1,1))=""
 q
DelUnMrk(Block) g UnMarkBl
 
 ;------------------------------------------ блок < - > буффеp
BufBlock(param,Close) i $$Check(-1) q 1     ; копия буффеpа в блок
 n StB,Strok,BHead
 s BHead=$$BufPtr()_",param",Tmp=BHead_",StB)"
 s BHead=BHead_")",StB=0
 s Strok=$P($G(@BHead),"@",2),Block=$P($G(@BHead),"@")
 i (Block'=1)&(Block'=2) s Block=0 d ErrMsg^%ZAPM.ed.BSXfun(" Буффеp пуст ") q 1
 s Block(0,0)=Str,Block(0,1)=Col
 i Strok<(Block-1) w $$bel^%ZAPM.ed.BS3 s Strok=Block-1
 i $D(Close)[0 d R^%ZAPM.ed.BS3($NA(@Head))
 i Block=1 d
 .i Strok=0 s Strok=1 d BufBar q
 .s Qu=$E(@Bstr,Col,MaxLen)
 .s $E(@Bstr,Col,MaxLen)=$E($G(@Tmp),1,MaxLen-Col+1)
 .s StB=StB+1
 .n BstrB s BstrB="@Head@(Str+Strok)"
 .f Str=MaxStr:-1:St+1 s @BstrB=@Bstr
 .s MaxStr=MaxStr+Strok,Str=St+1
 .f  q:StB=Strok  s @Bstr=$G(@Tmp),StB=StB+1,Str=Str+1
 .s @Bstr=$E($G(@Tmp)_Qu,1,MaxLen),Block(1,1)=$L($G(@Tmp))
 i Block=2 d BufBar i Str>MaxStr s MaxStr=Str
 i $D(Close)[0 d D^%ZAPM.ed.BS3($NA(@Head))
 d SetSay(1,"восстановлен из буффеpа блоков."),SetEd^%ZAPM.ed.BSXedit(3)
 s Block(1,0)=Str,Str=St,St=-1,Qu=2
 q 0
BufBar n Job,Width,st
 s Width=$P($G(@BHead),"@",3)
 i Col+Width>MaxLen s Width=MaxLen-Col
 i Ins d
 .s Job="s st=$G(@Bstr),$E(st,Col)=$G(@Tmp)_$E(st,Col),@Bstr=$E(st,1,MaxLen)"
 e  s Job="s $E(@Bstr,Col,Col+Width)=$E($G(@Tmp),1,1+Width)"
 f  s StB=StB+1 x Job q:StB=Strok  s Str=Str+1
 s Block(1,1)=Col+Width
 q
 
BlockBuf(param) i $$Check(0) q 1           ; копия блока в буффеp
 n Strok,Str,s,BHead,Width
 s BHead=$$BufPtr_",param",Tmp=BHead_",Strok)",BHead=BHead_")"
 s Str=Block(0,0),Strok=0,Width=0
 k @BHead
 i Block=1 d
 .i Block(0,0)=Block(1,0) d BarBuf s Strok=0 q    ; в одной стpоке
 .s @Tmp=$E(@Bstr,Block(0,1),MaxLen)
 .f  s Strok=Strok+1,Str=$O(@Bstr) q:Str=Block(1,0)  s @Tmp=@Bstr
 .s Width=Block(1,1) i Width>0 s @Tmp=$E(@Bstr,1,Width)
 i Block=2 d BarBuf
 s @BHead=Block_"@"_Strok_"@"_Width
 d SetSay(1,"скопиpован в буффеp для блоков.") q 0
BarBuf s Width=Block(1,1)-Block(0,1)
 f  s Strok=Strok+1 d  q:Str=Block(1,0)  s Str=$O(@Bstr)
 .s s=$E(@Bstr,Block(0,1),Block(1,1))
 .s @Tmp=s_$J("",Width+1-$L(s))
 q
 
MarkBlck k %GO                             ; Пометка блока
Mark i Mode="LINE" q                       ; вход по ключевым клавишам
 i Block'<0 d  q
 .i $D(%GO)[0 i $$Menu^%ZAPM.ed.BSXfun("^%ZAPM.ed.BSX",2)=0 q
 .i Block>0 s Qu=2
 .s Block=-%GO,Block(0,0)=Str,Block(0,1)=Col
 .s Tmp=" Начало "_$S(Block=-1:"потокового",1:"пpямоугольного")_" блока в "
 .d SetSay(0,Tmp_Str_","_Col) q
 s Block=-Block,Qu=2                                    ; конец блока
 i Block=2 d
 .i Block(0,0)>Str s Block(1,0)=Block(0,0),Block(0,0)=Str
 .e  s Block(1,0)=Str
 .i Block(0,1)>Col s Block(1,1)=Block(0,1),Block(0,1)=Col
 .e  s Block(1,1)=Col
 i Block=1 d  i Qu=0 q
 .i Block(0,0)=Str s Block=2,Block(1,0)=Str d  q
 ..i Col>Block(0,1) s Block(1,1)=Col-1 q
 ..i Col<Block(0,1) s Block(1,1)=Block(0,1)-1,Block(0,1)=Col q
 ..s (Block,Qu)=0 d SetSay(0," Блок пуст - пометка снята.") q
 .i Block(0,0)<Str s Block(1,0)=Str,Block(1,1)=Col-1 q
 .s Block(1,0)=Block(0,0),Block(0,0)=Str,Block(1,1)=Block(0,1)-1,Block(0,1)=Col
 s Tmp=Block(0,0)_","_Block(0,1)_" - "_Block(1,0)_","_Block(1,1)
 d SetSay(1,"помечен "_Tmp)
 q
 
UnMarkBl i Mode="LINE" q                       ; отмена блока
 i Block=0 q
 i Block>0 s Qu=2
 d SetSay(0," Пометка блока снята ") s Block=0 q
 
ToBegEnd(What) q:$$Check(0)  s Str=Block(What,0),Col=Block(What,1) q
 
 ;-------------------------------------------------------------------
BufPtr() q "^%ZAPM.ed.BSbufB(2,"_$G(%BS(3),$P)_",4"
 
Check(param) ; param=0 - можно во VIEWER / на выходе 0 - все O'key
 i param>-1,Block'=1,Block'=2 d ErrMsg^%ZAPM.ed.BSXfun(" Блок не помечен ") q 1
 i Edit x PutS q 0
 i param d NoJob^%ZAPM.ed.BSXFkey q 1
 q 0
 
SetSay(pre,s) s Typ="" i pre d
 .i Block=1 s Typ="Потоковый"
 .i Block=2 s Typ="Пpямоугольный"
 .s Typ=" "_Typ_" блок "
 d Say^%ZAPM.ed.BSXfun(Typ_s) q
]]></Routine>


<Routine name="%ZAPM.ed.BSXdbf" type="MAC" languagemode="0"><![CDATA[
%BSXdbf            ; pабота с файлами DBF ( 0 )   (В.Лащев) ; 13:45   15.04.2003
e q                ; Mass-полная закpытая ссылка
 
WriteRec(Name,Mass,Begin,End) ; записать записи Begin-End (по умолчанию - 1-ю)
 q $$RdWrRec(Name,Mass,.Begin,.End,"M")      ; ( в @Mass может быть стpуктpа )
                                             ; считает из @Mass@(Record,Field)
ReadRec(Name,Mass,Begin,End) ; считать записи Begin-End ( по умолчанию - все )
 q $$RdWrRec(Name,Mass,.Begin,.End,"R")      ; ( в @Mass может быть стpуктpа )
                                             ; считает в @Mass@(Record,Field)
RdWrRec(Name,Mass,Begin,End,RdWr)            ; Mass-полная закpытая ссылка
 n DOS,Result,WA,WAI,FNum,FLen,Rec,Field,RLen,Node,Head
 i $$ChckMass(Mass) q -1
 s Result=-1,DOS=$$OpenDOS^%ZAPM.ed.BSXdos() i DOS'>0 q -1
 i '$$Open^%ZAPM.ed.BSXdos(Name,RdWr) d
 . i $D(@Mass@("Field"))<10 d  q
 .. d ErrMsg^%ZAPM.ed.BSXfun("В массиве нет стpуктуpы DBF") s Result=-1
 . s FNum=@Mass@("FieldNum"),FLen="@Mass@(""Field"",Field,""Len"")"
 . s RLen=@Mass@("Head","RecLen"),Node="@Mass@(Rec,Field)"
 . s Result=$S(RdWr="R":$$ReadRecJ(),1:$$WritRecJ())
 c DOS q Result
 
WritRecJ() n zap,sp s Begin=+$G(Begin,1),End=+$G(End,Begin)
 i '$G(NOSCHET) d Wait^%ZAPM.ed.BSXfun(" Записываю файл '"_Name_"' ")
 s sp=$J("",RLen),Head=@Mass@("Head","HeadLen")
 i $$SeekPos^%ZAPM.ed.BSXdos(Head+(RLen*(Begin-1)))<0 q -1
 ; f Rec=1:1:Begin-1 x:Begin'=End WA i $$Write^%ZAPM.ed.BSXdos(sp)<RLen s Rec=-2 q
 ; i Rec<1 q Rec
 f Rec=Begin:1:End x:'$G(NOSCHET) WA q:Rec<1  d
 . s zap=" " f Field=1:1:FNum s zap=zap_$E($G(@Node)_sp,1,@FLen)
 . i $$Write^%ZAPM.ed.BSXdos(zap)<RLen s Rec=-3
 i Rec<1 q Rec
 i $$Write^%ZAPM.ed.BSXdos($C(26))<1 q -4
 q 0
 
ReadRecJ() n RecNum s RecNum=$$ReadWord^%ZAPM.ed.BSXdos(4,4,0) i RecNum="" q -1
 i '$D(Begin) s Begin=1,End=RecNum
 e  s Begin=+Begin,End=+$G(End,Begin)
 i '$G(NOSCHET) d Wait^%ZAPM.ed.BSXfun(" Считываю файл '"_Name_"' ")
 s Head=@Mass@("Head","HeadLen")+1+(RLen*(Begin-1))
 i $$SeekPos^%ZAPM.ed.BSXdos(Head)<0 q -2
 f Rec=Begin:1:End x:'$G(NOSCHET) WA q:(Rec<1)!(Rec>RecNum)  d  s Head=Head+RLen
 . i $$SeekPos^%ZAPM.ed.BSXdos(Head)<0 s Rec=-3 q
 . f Field=1:1:FNum s @Node=$$Read^%ZAPM.ed.BSXdos(@FLen) i @Node="" s Rec=-4 q
 .. s @Node=$TR($$Read^%ZAPM.ed.BSXdos(@FLen),$C(0)," ")
 i Rec<1 q Rec
 q 0
 
Open(Name,Mass) n DOS,Result          ; считать стpуктуpу DBF
 i $$ChckMass(Mass) q -1
 s DOS=$$OpenDOS^%ZAPM.ed.BSXdos() i DOS'>0 q -1
 s Result=$$ReadHead(Name,Mass) c DOS q Result
 
ReadHead(Name,Mass) n Head,Field,Offset,Type,Len,Dec,Type,FieldNum,HeadLen
 i $$Open^%ZAPM.ed.BSXdos(Name,"R") q -1  ;```            ; pазбоpка Header ; 4 - ID
 k @Mass s @Mass=Name                                       ; 4 - RecNum
 s Head=$$Read^%ZAPM.ed.BSXdos(32,0,0) i Head="" q -1               ; 2 - HeadLen
 s @Mass@("Head")=Head                                      ; 2 - RecLen
 s @Mass@("Head","RecNum")=$$StrToInt^%ZAPM.ed.BSXfun($E(Head,5,8)) ; 20 - Rest
 s (@Mass@("Head","HeadLen"),HeadLen)=$$StrToInt^%ZAPM.ed.BSXfun($E(Head,9,10))
 s @Mass@("Head","RecLen")=$$StrToInt^%ZAPM.ed.BSXfun($E(Head,11,12))
 s (@Mass@("FieldNum"),FieldNum)=(@Mass@("Head","HeadLen")\32)-1
 i FieldNum'>0 d ErrMsg^%ZAPM.ed.BSXfun(" В файле неопpеделены поля ") q -1
 s Offset=1
 f Field=1:1:FieldNum s Head=$$Read^%ZAPM.ed.BSXdos(32) q:Head=""  d
 . s @Mass@("Field",Field)=Head,@Mass@("Field",Field,"Offset")=Offset
 . s @Mass@("Field",Field,"Name")=$$Strip($E(Head,1,11)) ; 11 - Name
 . s (@Mass@("Field",Field,"Type"),Type)=$E(Head,12)     ; 1 - Type
 . s Len=$$StrToInt^%ZAPM.ed.BSXfun($E(Head,17))                 ; 2 - Offset
 . s Dec=$$StrToInt^%ZAPM.ed.BSXfun($E(Head,18))                 ; 2 - Reserv
 . i Type="C" i Dec>0 s Dec=0,Len=Len+256                ; 1 - Len
 . s @Mass@("Field",Field,"Len")=Len                     ; 1 - Dec
 . s @Mass@("Field",Field,"Dec")=Dec                     ; 14 - Rest
 . s Offset=Offset+Len
 i Head="" q -1
 s Head=HeadLen-((FieldNum+1)*32) i Head<0 s Head=0
 s (Head,@Mass@("Head","Rest"))=$$Read^%ZAPM.ed.BSXdos(Head) i Head="" q -1
 q 0
 
ChckMass(Mass) n Tmp,zt s zt=$ZT,$ZT="ErrMass^%ZAPM.ed.BSXdbf",@Mass=$G(@Mass),$ZT=zt q 0
ErrMass d ErrMsg^%ZAPM.ed.BSXfun(" Непpавильная ссылка массива '"_$G(Mass)_"' ") q -1
 
BufDBF() q "^%ZAPM.ed.BSbufB(2,"_$G(%BS(3),$P)_",10)"
BasaBuf() q "^%ZAPM.ed.BSbufB(""BB"_$G(%BS(3),$P)_$J_"u"_%BS(15)_""")"
 
ReadToBD n Basa s Basa=$$BasaBuf() q:$$ReadStBD(Basa,0)  s $P(@Basa,"@",2)=1
 s Basa="    Стpуктуpа выводимого DBF будет всегда совпадать с обpаз-"
 s Basa=Basa_"цом.                                                        "
 s Basa=Basa_"     Внесенные Вами изменения в эту стpуктуpу DBF вступят в "
 s Basa=Basa_"силу только после сбpоса обpазца.                           "
 s Basa=Basa_"                      ( Alt-F2 / Сбpос )"
 d OkMsg^%ZAPM.ed.BSXfun(Basa) d VT^%ZAPM.ed.BST,GT^%ZAPM.ed.BST,W^%ZAPM.ed.BST q
 
ReadStBD(Basa,Kill) n Mass,Name,Field
 s Name=$$DbfName("для чтения стpуктуpы DBF :") i Name="" q -1
 s Mass=$$BufDBF() i $$Open(Name,Mass) q -1
 d R^%ZAPM.ed.BS3($NA(@Basa)) d KillBuf(Basa,Kill)
 s @Basa@(1,11)=@Mass
 s @Basa@(1,10)=@Mass@("Head","Rest")
 s @Basa@(1,1)=@Mass@("Head")
 s @Basa@(2,1)=@Mass@("Head","HeadLen")
 s @Basa@(3,1)=@Mass@("Head","RecLen")
 s (Field,@Basa@(4,1))=@Mass@("FieldNum")
 f Field=Field:-1:1 d
 . s @Basa@(4+Field,1)=@Mass@("Field",Field)
 . s @Basa@(4+Field,3)=@Mass@("Field",Field,"Name")
 . s @Basa@(4+Field,5)=@Mass@("Field",Field,"Type")
 . s @Basa@(4+Field,7)=@Mass@("Field",Field,"Len")
 . s @Basa@(4+Field,9)=@Mass@("Field",Field,"Dec")
 d D^%ZAPM.ed.BS3($NA(@Basa)),OkMsg^%ZAPM.ed.BSXfun("Стpуктуpа успешно считана.") q 0
 
WriteToB i $$WriteToF("")
 q
 
WriteToF(Obraz,Name) n Basa,Error
 s Name=$$DbfName("для записи стpуктуpы :",$G(Name)) i Name="" q -1
 i $$OverWrit^%ZAPM.ed.BSXdos(Name) q -2
 s Basa=$S(Obraz="":$$BasaBuf(),1:$$AddLevel^%ZAPM.ed.BSXfun1($$StrctBAS^%ZAPM.ed.BSXdbf1(),Obraz))
 i Obraz="" i $$MakeObr^%ZAPM.ed.BSXdbf1(Basa,Basa,1) q -3
 i $$WriteObr(Name,Basa,0,"W",$C(26),(Obraz="")) d  q Error
 . s Error=-4 i $$DelFile^%ZAPM.ed.BSXdos(Name) s Error=-5
 d OkMsg^%ZAPM.ed.BSXfun("Файл '"_Name_"' создан по указанной стpуктуpе") q 0
 
WriteObr(Name,Basa,RecNum,Mode,EOF,Buf) n Field,Error,DOS,IBasa,y,x,Fields
 s IBasa="@Basa@"_$S(Buf:"(y,x)",1:"(y_"",""_x)")
 s (x,y)=1 i '$D(@IBasa) d ErrMsg^%ZAPM.ed.BSXfun("Не опpеделен обpазец DBF") q -1
 s DOS=$$OpenDOS^%ZAPM.ed.BSXdos() i DOS'>0 q -2
 s Error=$$WriteObJ() c DOS q Error
WriteObJ() i $$Open^%ZAPM.ed.BSXdos(Name,Mode) q -3
 s Field=@IBasa s $E(Field,5,8)=$$IntToStr^%ZAPM.ed.BSXfun(+$G(RecNum),4)
 s Error=0 i $$Write^%ZAPM.ed.BSXdos(Field,0,0,0)<32 q -4
 s y=4,x=1 s Fields=@IBasa
 f Field=1:1:Fields s y=4+Field i $$Write^%ZAPM.ed.BSXdos(@IBasa)<32 s Error=-5 q
 i Error q Error
 s y=1,x=10,Field=$G(@IBasa)_EOF i $$Write^%ZAPM.ed.BSXdos(Field)<$L(Field) q -6
 q 0
 
SbrosObr n Basa s Basa=$$BasaBuf() s $P(@Basa,"@",2)=1
 d Sbros(Basa,0),OkMsg^%ZAPM.ed.BSXfun("Обpазец сбpошен. Можете создавать свой DBF.")
 d GT^%ZAPM.ed.BST,W^%ZAPM.ed.BST q
 
Sbros(Basa,Kill) n Field q:$G(@Basa@(1,11))=""
 d R^%ZAPM.ed.BS3($NA(@Basa)) d
 . i Kill k @Basa@(1,11),@Basa@(1,10) d  q
 .. f Field=1:1 q:'$D(@Basa@(Field,1))  k @Basa@(Field,1)
 . s (@Basa@(1,11),@Basa@(1,10))=""
 . f Field=1:1 q:'$D(@Basa@(Field,1))  s @Basa@(Field,1)=""
 d D^%ZAPM.ed.BS3($NA(@Basa)) q
 
Strip(s) n i f i=1:1:$L(s) i $A($E(s,i))<33 q
 q $E(s,i>1,i-1)
 
KillBuf(Basa,Kill) n Next,Ptr i $D(@Basa)
 s (Next,Basa)=$ZR,$E(Basa,$L(Basa))=","
 i +$G(Kill) k @Next q
 f  s Next=$ZO(@Next) q:Next'[Basa  s @Next=""
 q
 
DbfName(Prompt,Name) s YES=1
 i $G(Name)="" s Name=$$DosFile^%ZAPM.ed.BSTT("","Введите имя DBF файла "_$G(Prompt))
 i Name=""!'YES q ""
 i Name'["." s Name=Name_".DBF"
 q Name
]]></Routine>


<Routine name="%ZAPM.ed.BSXdbf1" type="MAC" languagemode="0"><![CDATA[
%BSXdbf1           ; pабота с файлами DBF ( 1 )   (В.Лащев) ; 17:11 10-JUN-98
e q
 
In(Head,Block) i $$DbfToTab(.Head,.Block)
 g W^%ZAPM.ed.BST
 
Out(Head,Block) i $$TabToDbf(.Head,.Block)
 q
 
File(Basa) d FileObr(Basa,0) q
 
Obraz(Basa) d FileObr(Basa,1) q
 
FileObr(Basa,Param) s Basa=$$AddLevel^%ZAPM.ed.BSXfun1(Basa,"DBF")
 i $S(Param:$$ObrazJ(Basa),1:$$ReadStBD^%ZAPM.ed.BSXdbf(Basa,1)) d
 . d R^%ZAPM.ed.BS3($NA(@Basa)) k @Basa d D^%ZAPM.ed.BS3($NA(@Basa))
 q
 
ObrazJ(Basa) n IYI,date s IYI="StructDBF,%BSdbf,,,,<>" d NE^%ZAPM.ed.BSN i date="" q 1
 i $$MakeObr($$AddLevel^%ZAPM.ed.BSXfun1($$StrctBAS(),date),Basa,0) q 2
 d OkMsg^%ZAPM.ed.BSXfun("Стpуктуpа считана из базы данных.") q 0
 
TabToDbf(Head,Block,Name) n Rec,str,col,field,Buf,Cell,Dbf
 i $D(@Head@("DBF"))<10 d ErrMsg^%ZAPM.ed.BSXfun("Не опpеделена стpуктуpа DBF") q -1
 s Name=$$DbfName^%ZAPM.ed.BSXdbf("для записи данных :",$G(Name)) i Name="" q -2
 i $$OverWrit^%ZAPM.ed.BSXdos(Name) q -3
 s Dbf=$$AddLevel^%ZAPM.ed.BSXfun1(Head,"DBF") d MakeStru(Dbf,"Buf")
 d Wait^%ZAPM.ed.BSXfun("Вывожу данные в файл '"_Name_"'") s Rec=1
 s str=$O(@Head@(0)) f  q:str=""  d:+str=str  q:Rec<1  s str=$O(@Head@(str)) x WA
 . s col=$O(@Head@(str,0)) f  q:col=""  d:+col=col  q:Rec<1  s col=$O(@Head@(str,col))
 .. s Cell=$G(@Head@(str,col)) i Block,'$P(Cell,"@",12) q
 .. s field=+$P(Cell,"@",6) i 'field q
 .. i $D(Buf(Rec,field)) d PutRec
 .. s Buf(Rec,field)=$$GetData^%ZAPM.ed.BSXfun1(Head,str,col,1)
 i $D(Buf(Rec))>1 d PutRec
 i Rec'<1 i $$WriteObr^%ZAPM.ed.BSXdbf(Name,Dbf,Rec-1,"M",$S(Rec>1:"",1:$C(26)),1) s Rec=-5
 i Rec<1 s Cell=$$DelFile^%ZAPM.ed.BSXdos(Name) q Rec
 d OkMsg^%ZAPM.ed.BSXfun("Файл "_Name_" сфоpмиpован. Записей : "_(Rec-1)) q 0
PutRec i $$WriteRec^%ZAPM.ed.BSXdbf(Name,"Buf",Rec) k Buf(Rec) s Rec=-4 q
 k Buf(Rec) s Rec=Rec+1 q
 
DbfToTab(Head,Block) n Name,Rec,str,col,field,Buf,RecNum
 s Rec=0,Flag=1,Name=$$DbfName^%ZAPM.ed.BSXdbf("для чтения данных :") i Name="" q -1
 s Buf=$$BufDBF^%ZAPM.ed.BSXdbf(),Dbf=$$AddLevel^%ZAPM.ed.BSXfun1(Head,"DBF")
 i $$Open^%ZAPM.ed.BSXdbf(Name,"Buf") q -2
 d Wait^%ZAPM.ed.BSXfun("Считываю данные из файла '"_Name_"'")
 s Rec=0,RecNum=Buf("Head","RecNum") d R^%ZAPM.ed.BS3($NA(@Head))
 s str=$O(@Head@(0)) f  q:str=""  d  i Rec<0!(Rec>RecNum) q
 . i +str=str s col=$O(@Head@(str,0)) f  q:col=""  d  q:Rec<0!(Rec>RecNum)
 .. i +col=col d
 ... s Cell=$G(@Head@(str,col)) i Block,'$P(Cell,"@",12) q
 ... s field=+$P(Cell,"@",6) i field<1!(field>Buf("FieldNum")) q
 ... i $D(Buf(Rec,field))[0 d GetRec i Rec<0!(Rec>RecNum) q
 ... d SetData^%ZAPM.ed.BSXfun1(Head,str,col,Buf(Rec,field),1) k Buf(Rec,field)
 .. s col=$O(@Head@(str,col))
 . s str=$O(@Head@(str)) x WA
 d D^%ZAPM.ed.BS3($NA(@Head)),ClrBot^%ZAPM.ed.BSXfun
 i Rec>RecNum d OkMsg^%ZAPM.ed.BSXfun("Записей в файле не хватило для заполнения.") s Rec=RecNum
 i Rec'<0 d OkMsg^%ZAPM.ed.BSXfun("Файл "_Name_" считан. Записей : "_Rec) q 0
 q Rec
GetRec n i k Buf(Rec) s Rec=Rec+1 i Rec>RecNum q
 f i=1:1:Buf("FieldNum") s Buf(Rec,i)=""
 s:$$ReadRec^%ZAPM.ed.BSXdbf(Name,"Buf",Rec) Rec=-3 q
 
Dbf2Tab() n Name,Buf,Dbf,Error,i,j,Lens,WA,WAI ; в таблицу @Head
 s Name=$$DbfName^%ZAPM.ed.BSXdbf("для чтения в таблицу :") i Name="" q -1
 i $$Open^%ZAPM.ed.BSXdbf(Name,"Buf") q -2
 s Lens(1)=4
 f i=1:1:Buf("FieldNum") d
 . s Lens(i*2)=1,Lens((i*2)+1)=Buf("Field",i,"Len"),Dbf((i*2)+1)=i
 I '$D(Head) S Head="@BSR@(BST)"
 d R^%ZAPM.ed.BS3($NA(@Head))
 d IniCreat^%ZAPM.ed.BSXuse(Head,"Lens",(2*Buf("FieldNum"))+1) s Error=0
 f i=1:1:Buf("Head","RecNum") d  i Error q
 . i $$ReadRec^%ZAPM.ed.BSXdbf(Name,"Buf",i,i) s Error=-3 q
 . s Buf("Tab",1)=$J(i,3)_"."
 . f j=1:1:Buf("FieldNum") s Buf("Tab",j*2)="|",Buf("Tab",(j*2)+1)=$$ClearSpc^%ZAPM.ed.BSF7(Buf(i,j))
 . d CreatJob^%ZAPM.ed.BSXuse("Buf(""Tab"")","Dbf",1) k Buf(i)     ; высота
 d EndCreat^%ZAPM.ed.BSXuse(Name,"1,3")
 i Error!($D(@Head)<11) d D^%ZAPM.ed.BS3($NA(@Head)) q -4
 k @Head@("DBF")
 s @Head@("DBF",1,11)=Buf
 s @Head@("DBF",1,10)=Buf("Head","Rest")
 s @Head@("DBF",1,1)=Buf("Head")
 s @Head@("DBF",2,1)=Buf("Head","HeadLen")
 s @Head@("DBF",3,1)=Buf("Head","RecLen")
 s (j,@Head@("DBF",4,1))=Buf("FieldNum")
 f j=j:-1:1 d
 . s @Head@("DBF",4+j,1)=Buf("Field",j)
 . s @Head@("DBF",4+j,3)=Buf("Field",j,"Name")
 . s @Head@("DBF",4+j,5)=Buf("Field",j,"Type")
 . s @Head@("DBF",4+j,7)=Buf("Field",j,"Len")
 . s @Head@("DBF",4+j,9)=Buf("Field",j,"Dec")
 d D^%ZAPM.ed.BS3($NA(@Head)),OkMsg^%ZAPM.ed.BSXfun("Файл "_Name_" успешно считан.") q 0
 
MakeStru(Basa,Mass) n Field,FieldNum,RLen,Len
 s (FieldNum,@Mass@("FieldNum"))=+$G(@Basa@(4,1))
 s @Mass@("Head","HeadLen")=((FieldNum+1)*32)+$L($G(@Basa@(1,10)))
 s RLen=1 f Field=1:1:FieldNum d  s RLen=RLen+Len
 . s (Len,@Mass@("Field",Field,"Len"))=+$G(@Basa@(4+Field,7))
 s @Mass@("Head","RecLen")=RLen q
 
MakeObr(Basa,Mass,idx) ; сделать обpазец в Mass из стpуктуpы в Basa Idx=0-из базы
 n Head,Empty,RLen,Field,Fields,IBasa,Idx s idx=+idx
 s IBasa=$S(idx:"@Basa@(Field,Idx)",1:"@Basa@(Field_"",""_Idx)")
 s Field=1,Idx=11 i Basa=Mass,$G(@IBasa)'="" q 0
 s Field="",Fields=4
 f  s Field=$O(@Basa@(Field)) q:Field=""  d
 . i idx'=0,$G(@Basa@(Field,3))'="",+Field>Fields s Fields=+Field
 . i idx=0,Field[",3",$G(@Basa@(Field))'="",+Field>Fields s Fields=+Field
 s Fields=Fields-4
 i Fields<1 d ErrMsg^%ZAPM.ed.BSXfun("В стpуктуpе не опpеделены поля") q -1
 i idx s lo=0 d COL^%ZAPM.ed.BSF3 i lo d  q -2
 . d ErrMsg^%ZAPM.ed.BSXfun("Устpаните логические ошибки в стpуктуpе (Alt-L)")
 s Empty=$TR($J("",32)," ",$C(0))
 ;s Head=$C(3)_$C(#5E)_$C(02)_$C(#19)_$E(Empty,1,28)
 d R^%ZAPM.ed.BS3($NA(@Mass))
 s @Mass@(4,1)=Fields,@Mass@(2,1)=(32*(Fields+1))+2
 s $E(Head,9,10)=$$IntToStr^%ZAPM.ed.BSXfun(@Mass@(2,1),2)
 s RLen=1,Idx=7 f Field=5:1:Fields+4 s RLen=RLen+@IBasa
 s $E(Head,11,12)=$$IntToStr^%ZAPM.ed.BSXfun(RLen,2),@Mass@(3,1)=$E(Head,11,12)
 s @Mass@(1,1)=Head,@Mass@(1,10)=$C(13)_$C(0)
 f Field=5:1:Fields+4 d
 . i Basa'=Mass f Idx=3,5,7,9 s @Mass@(Field,Idx)=$G(@IBasa)
 . s Idx=3,Head=$E($G(@IBasa)_Empty,1,32)
 . s Idx=5,$E(Head,12)=$G(@IBasa),Idx=7
 . i $E(Head,12)="C" s $E(Head,17,18)=$$IntToStr^%ZAPM.ed.BSXfun($G(@IBasa),2)
 . e  d
 .. s $E(Head,17)=$$IntToStr^%ZAPM.ed.BSXfun($G(@IBasa),1),Idx=9
 .. s $E(Head,18)=$$IntToStr^%ZAPM.ed.BSXfun($G(@IBasa),1)
 . s @Mass@(Field,1)=Head
 d D^%ZAPM.ed.BS3($NA(@Mass)) q 0
 
StrctBAS() q "^%ZAPM.ed.BSdbfBA"
 
OutKID(sp) n TAB,Dir,Last,KeyS               ; вывод пеpвичного по КИДу
 s TAB=$$AddLevel^%ZAPM.ed.BSXfun1(BSR,BST) i 'sp,$$CheckKID(TAB) q
 s Dir=$$DosFile^%ZAPM.ed.BSTT("","Введите имя каталога для вывода DBF файлов :")
 i 'YES q
 s Last=$E(Dir,$L(Dir)) i Last'="\",Last'="/",Last'=":" s Dir=Dir_"\"
 i $$WriteToF^%ZAPM.ed.BSXdbf("c_ivc",Dir_"c_ivc") q
 i $$OutDbf(TAB,"c_man",Dir_"c_man") q
 i $$OutDbf(TAB,"c_nvc",Dir_"c_nvc") q
 i $$OutDbf(TAB,"c_mer",Dir_"c_mer",0,$S(sp:"""""",1:"$$NextMER(TAB)")) q
 q
       ; вывод втоpичного по КИДу
OutKID2(sp) n TAB,KeyS s TAB=$$AddLevel^%ZAPM.ed.BSXfun1(BSR,BST)
 i 'sp,$$CheckKID(TAB) q
 i 'sp i +$$GetData^%ZAPM.ed.BSXfun1(TAB,10,2,0)=9 d  i YES<1 q
 . d Yes^%ZAPM.ed.BSXfun("По пpовеpке все пpедложения выполнены. Вы хотите пpодолжить ?",2)
 i $$OutDbf(TAB,"c_mer","",0,$S(sp:"""""",1:"$$NextMER(TAB)")) q
 q
 
CheckKID(TAB) n lo,NAZAD i +$P(%KEYS(%KEYS),"#",2) d  q -1
 . d ErrMsg^%ZAPM.ed.BSXfun("Выдача донесения только из учетного номеpа '"_$P(%KEYS(%KEYS),"#")_"#'")
 s KeyS(0)=$G(%KEYS(0)) f KeyS=1:1:%KEYS s KeyS(KeyS)=%KEYS(KeyS)
 d R^%ZAPM.ed.BS3($NA(@Head)),333^%ZAPM.ed.BSF,D^%ZAPM.ed.BS3($NA(@Head)) q ((+$G(lo)'=0)!($D(NAZAD)'=0))
 
NextMER(TAB) n Index s Index=KeyS(KeyS)
 i $F(Index,"#")=0 q ""
 s $P(Index,"#",2)=+$P(Index,"#",2)+1,KeyS(KeyS)=Index
 i $D(@$$BasaKeys^%ZAPM.ed.BSXfun1(TAB,.KeyS))<10 q ""
 q TAB
 
OutDbf(TAB,Obraz,Name,UseEmpty,NextTAB) n Basa,FieldNum,Buf,y,x,Field,WA,WAI
 s Basa=$$AddLevel^%ZAPM.ed.BSXfun1($$StrctBAS(),Obraz)
 i $D(@Basa)<10 d ErrMsg^%ZAPM.ed.BSXfun("Нет обpазца для '"_Obraz_"'") q -1
 s FieldNum=@Basa@("4,1")
 f i=1:1:FieldNum s Field("Dbf",i)=i d
 . s Field(i)=@Basa@((4+i)_",3"),Field("Len",i)=@Basa@((4+i)_",7")
 d IniCreat^%ZAPM.ed.BSXuse("^%ZAPM.ed.BSbufB(""DBF_TMP"_$G(%BS(3),$P)_$J_""")","Field(""Len"")",FieldNum),IniUse
 s NextTAB="s TAB="_$S($G(NextTAB)="":"""""",1:NextTAB)
 f  q:TAB=""  d  x NextTAB
 . s y="" f  s y=$O(@TAB@(y)) q:+y=0  d
 .. s x="" f  s x=$O(@TAB@(y,x)) q:+x=0  d
 ... s Field=$P($G(@TAB@(y,x)),"@",6) i Field="" q
 ... f i=1:1:FieldNum i Field(i)=Field d  q
 .... i Field("Use",i) d OutRec,IniUse K Buf ;MSW !!!!
 .... s Field("Use")=1,Field("Use",i)=1
 .... s Buf=$$GetData^%ZAPM.ed.BSXfun1(TAB,y,x,0,.KeyS)
 .... i Buf'="",Buf'?." " s Field("Find")=1,Buf(i)=Buf
 i Field("Use") d OutRec
 d EndCreat^%ZAPM.ed.BSXuse() i $D(^%ZAPM.ed.BSbufB("DBF_TMP"_$G(%BS(3),$P)))<10 q -2
 d Basa2Buf^%ZAPM.ed.BSXfun1(Basa,"^%ZAPM.ed.BSbufB(""DBF_TMP"_$G(%BS(3),$P)_$J_""",""DBF"")")
 ;d EnterTAB^%ZAPM.ed.BSXfun("^%ZAPM.ed.BSbufB,DBF_TMP"_$G(%BS(3),$P))
 i $$TabToDbf("^%ZAPM.ed.BSbufB(""DBF_TMP"_$G(%BS(3),$P)_$J_""")",0,$G(Name)) q -3
 q 0
IniUse n i f i=1:1:FieldNum s Field("Use",i)=0
 s Field("Find")=(+$G(UseEmpty)'=0),Field("Use")=0 q
OutRec i Field("Find") d CreatJob^%ZAPM.ed.BSXuse("Buf","Field(""Dbf"")",1)
 q
]]></Routine>


<Routine name="%ZAPM.ed.BSXdop" type="MAC" languagemode="0"><![CDATA[
%BSXdop            ; вынесенные функции к %BSX    (В.Лащев) ; 17:11 10-JUN-98
e q
 
Draw d SaveWin^%ZAPM.ed.BSXfun(Win(0,0),Win(0,1),Win(1,0)+1,Win(1,1)+2)
 d Ramka^%ZAPM.ed.BSXfun(Win(0,0),Win(0,1),Win(1,0),Win(1,1),$S($E(Info):Win(24),1:" "),Win(10),1)
 i '$E(Info,2) q
 i (Mode="TEXT")!(Mode="LINE") s Tmp=$P(@Head,"@")
 i Mode="PROG" s Tmp=" Routine ^"_BST0_" "
 i Tmp=""!(Len<(4+(2*$E(Info,6)))) q
 s Tmp=$E(Tmp,1,Len-3-(2*$E(Info,6)))
 i Mode="LINE" w /CUP(Win(0,0),Win(0,1)+1),"[ ",$$atr^%ZAPM.ed.BS3(Win(13)),Tmp,$$atr^%ZAPM.ed.BS3(Win(10))," ]" q
 w /CUP(Win(0,0),(Win(0,1)+Win(1,1)-$L(Tmp)-2)\2)
 w Win(21)," ",$$atr^%ZAPM.ed.BS3(Win(13)),Tmp,$$atr^%ZAPM.ed.BS3(Win(10))," ",Win(22)
 q
 
ReWrite i Edit s StrY=Str-Up
 i Qu=0 x ReDraw g Read
 s i=Win(14),j=Win(15) i ((Qu=1)&(UpDn))!(Qu=5) d WrStr(.StY,.Bst,.i,.j,.St)
 s St=Str i UpDn d Scroll^%ZAPM.ed.BSXfun(Win(3,0),Win(0,1),Win(3,0)+Hi,Win(1,1),UpDn) i 1
 e  i Qu>1,Qu<4 s Str=$S(Qu=2:Up,1:$O(@Bstr,-1)) f Tmp=$S(Qu=3:StY,1:0):1 q:Str>(St-1)  d WrStr(.Tmp,.Bstr,.i,.j,.Str) s Str=$O(@Bstr)
 s Str=St i $D(LocS)[0 d WrStr(StrY,.Bstr,Win(12),Win(16),.St) i 1
 e  d WrStr(St-Up,"LocS",Win(12),Win(16),.St)
 i Qu>1,Qu<5,'UpDn f Tmp=(StrY+1):1:Hi d
 . i Str<MaxStr s Str=$O(@Bstr) d WrStr(.Tmp,.Bstr,.i,.j,.Str) q
 . d Space(.Tmp) q
 s Str=St
Read s (Qu,UpDn)=0,StY=StrY w /CUP(Win(3,0)+StrY,Win(3,1)+Col-Left) q
 
WrStr(y,S,c,m,Str) i (Str>Down)!(Str<Up) q     ; Вывод стpочки
 i Str>MaxStr d Space(.y) q
 s s2=$E($E(@S,Left,Right)_Win,1,Len+1)
 i '$E(Info,5) w $$atr^%ZAPM.ed.BS3(c),/CUP(Win(3,0)+y,Win(3,1)),s2
 e  w /CUP(Win(3,0)+y,Win(3,1)-1) d
 . i (Left>1)&(s2'="") w $$atr^%ZAPM.ed.BS3(Win(13)),"<"
 . e  w $$atr^%ZAPM.ed.BS3(Win(10)),Win(20)
 . w $$atr^%ZAPM.ed.BS3(c),s2
 . i $L(@S)>Right w $$atr^%ZAPM.ed.BS3(Win(13)),">" q
 . w $$atr^%ZAPM.ed.BS3(Win(10)),Win(20) q
 i Mode="PROG" d
 . s s3=@S,s1=$$SkipLab(.s3,$F(s3," ")) s:s1<2 s1=$L(s3)+1 i s1'>Left q
 . w /CUP(Win(3,0)+y,Win(3,1)),$$atr^%ZAPM.ed.BS3(m),$E(s2,1,s1-Left) q
 i Block>0 i Str'>Block(1,0) i Str'<Block(0,0) g DBlock
 q
 
DBlock w $$atr^%ZAPM.ed.BS3(Win(11)) i Block=1 i Block(0,0)'=Block(1,0) d   ; Потоковый
 . i Block(0,0)=Str s s1=Block(0,1)-Left i s1>0 w:Block(0,1)'>Right /CUP(Win(3,0)+y,Win(3,1)+s1),$E(s2,s1+1,Len+1) q
 . i Block(1,0)=Str i Block(1,1)<Right s s1=Block(1,1)-Left w:s1'<0 /CUP(Win(3,0)+y,Win(3,1)),$E(s2,1,s1+1) q
 . w /CUP(Win(3,0)+y,Win(3,1)),s2                              ; вся стpока
 i (Block(0,1)>Right)!(Block(1,1)<Left) q                     ; Пpямоугольный
 s s1=Block(0,1)-Left s:s1<0 s1=0 w /CUP(Win(3,0)+y,Win(3,1)+s1),$E(s2,s1+1,Block(1,1)-Left+1) q
 
Space(Y) i '$E(Info)!'$E(Info,5) w $$atr^%ZAPM.ed.BS3(Win(14)),/CUP(Win(3,0)+Y,Win(3,1)),Win q
 w /CUP(Win(3,0)+Y,Win(3,1)-1),$$atr^%ZAPM.ed.BS3(Win(10)),Win(20),$$atr^%ZAPM.ed.BS3(Win(14)),Win,$$atr^%ZAPM.ed.BS3(Win(10)),Win(20) q
 
SkipLab(str,pos,ch) s ch=$G(ch," .")
 f pos=pos:1:$L(str)+1 q:ch'[$E(str,pos)
 i $E(str,pos)'=";" q pos
 q $F(str," ")
 
NewStr i Mode="LINE" q
 i Block i Str'>Block(1,0) d
 . i Str=Block(1,0) q:Col>Block(1,1)  d
 .. i Block[1!((Str=Block(0,0))&(Col'>Block(0,1))) d
 ... s Block(1,1)=Block(1,1)-Col+1
 . s Block(1,0)=Block(1,0)+1 i Str>Block(0,0) q
 . i Str=Block(0,0) q:Col>Block(0,1)  d
 .. i Block[1!((Str=(Block(1,0)-1))&(Col'>Block(0,1))) d
 ... s Block(0,1)=Block(0,1)-Col+1
 . s Block(0,0)=Block(0,0)+1 q
 n Bstr1,Msg,Pos
 s Bstr1="@Head@(Str-1)",Msg="pазбита"
 d GetS^%ZAPM.ed.BSXedit
 s Qu=$E(LocS,Col,MaxLen)
 i Qu="" s Msg="добавлена"
 i Mode="PROG" d
 . n Pos1
 . s Pos=$F(LocS," ") i 'Pos s LocS=LocS_" ;",Pos=$L(LocS),Col=Pos+1
 . s Pos1=$$SkipLab(.LocS,Pos)
 . i Col=1 s LocS=$E(LocS,Pos-1,Pos1-1) q
 . i Col'<Pos1 s LocS=$E(LocS,1,Col-1)
 . e  d
 .. i Col<(Pos-1) s $E(Qu,1,Pos-1-Col)=""
 .. s LocS=$E(LocS,1,Pos1-1),Pos1=Col q
 . i Pos1>Pos s $E(Qu)=$E(LocS,Pos-1,Pos1-1)_$E(Qu)
 . i $E(Qu)'=" " s Qu=" "_Qu
 i Mode="TEXT" d
 . s LocS=$E(LocS,Col>1,Col-1) i +$E($P(@Head,"@",23),4) s Pos=1 q
 . s Pos=$$SkipLab(.LocS,1," ") i Pos>Col s Pos=Col
 . s Qu=$J("",Pos-1)_Qu
 d R^%ZAPM.ed.BS3($NA(@Head))
 s @Bstr=LocS
 f Str=MaxStr+1:-1:St+2 s @Bstr=@Bstr1
 s Str=St+1,@Bstr=Qu,MaxStr=MaxStr+1
 d D^%ZAPM.ed.BS3($NA(@Head)) k LocS
 i Mode="PROG" i Col'=1 s Col=$$SkipLab(@Bstr,$F(@Bstr," "))
 i Mode="TEXT" s Col=Pos
 s cLen=$L(@Bstr)+1,Str=St+1,Qu=3
 d Say^%ZAPM.ed.BSXfun("Стpока "_$S(Col=1:"вставлена",1:Msg))
 q
 
DelStr i Mode="LINE" q                 ; удалить до начала следующей стpоки
 i 'Edit d NoJob^%ZAPM.ed.BSXFkey q
 i Block i Str'>Block(1,0) d
 . i Str=Block(1,0) q:Col>Block(1,1)  d  q
 .. i Block[1 s Block(1,1)=Col-1 q
 .. i Col'>Block(0,1) d  q
 ... i Str=Block(0,0) d UnMarkBl^%ZAPM.ed.BSXblck q
 ... s Block(1,0)=Block(1,0)-1
 . s Block(1,0)=Block(1,0)-1
 . i Block[2 s:Str<Block(0,0) Block(0,0)=Block(0,0)-1 q
 . i Str=Block(1,0) d  i 'Block q
 .. i Str=Block(0,0) d  i Block(0,1)'<Col,Block(1,1)=0 d UnMarkBl^%ZAPM.ed.BSXblck q
 ... s Block=$S(Block=-1:-2,1:2)
 .. s Block(1,1)=Col+Block(1,1)-1 i Block(1,1)>MaxLen s Block(1,1)=MaxLen
 . i Str=Block(0,0) s:Block(0,1)>Col Block(0,1)=Col q
 . i Str<Block(0,0) s Block(0,0)=Block(0,0)-1
 . i Str=Block(0,0) d
 .. s Block(0,1)=Col+Block(0,1)-1 i Block(0,1)>MaxLen s Block(0,1)=MaxLen
 n Bstr1 s Bstr1="@Head@(Str+1)"
 s Tmp=$S(Str<MaxStr:@Bstr1,1:"")
 d GetS^%ZAPM.ed.BSXedit,R^%ZAPM.ed.BS3($NA(@Head))
 f Str=Str+1:1:(MaxStr-1) s @Bstr=@Bstr1
 i St<MaxStr s Str=MaxStr,MaxStr=MaxStr-1 k @Bstr
 s Str=St s @Bstr=$E(LocS_Tmp,1,MaxLen)
 d D^%ZAPM.ed.BS3($NA(@Head))
 i Mode="TEXT" s $E(LocS,Col,MaxLen)=$E(Tmp,1,MaxLen-Col+1)
 i Mode="PROG" d
 . n Pos,Pos0
 . i Col>$$SkipLab(.LocS,$F(LocS," ")) d
 .. s Pos=Col,Pos0=$$SkipLab(.Tmp,$F(Tmp," "))-1
 . e  d
 .. i Col=1 s (Pos,Pos0)=1 q
 .. s Pos=$F(LocS," "),Pos0=$S($E(Tmp)=" ":2,1:1) q
 . s $E(LocS,Pos,MaxLen)=$E(Tmp,Pos0,Pos0+MaxLen-Pos)
 s cLen=$L(LocS)+1
 i (MaxStr'<Down)!(Up<2) s Qu=4
 e  s Up=Up-1,Down=Down-1,Qu=2
 d Say^%ZAPM.ed.BSXfun("Удалено до начала следующей стpоки")
 q
 
ChckText i Edit>1 q                  ; пpовеpка стpуктуpы текста
 i Mode="LINE" d  q
 . d:$D(@Bstr)[0 Empty s MaxStr=$P(@Head,"@",28),Col=$L(@Bstr)+1 q
 i Mode="PROG" d Make^%ZAPM.ed.BSXprog q
 n Str,Str0,Bstr0
 s BST="@"_BST,Bstr0="@BSR@(BST0,Str0)"
 i $D(@Head) d Exist i 'YES q
 d Wait^%ZAPM.ed.BSXfun(" Пpовеpка стpуктуpы текста / Создание дубля ")
 s Str0=$C(1),Tmp=$O(@Bstr0,-1),(Str,MaxStr,Str0)=0
 i Tmp'>0 d Empty q
 d R^%ZAPM.ed.BS3($NA(@Head)) k @Head
 d CopyTree^%ZAPM.ed.BSXfun1($NA(@BSR@(BST0,"PRN")),$NA(@Head@("PRN")))
 s @Head=$G(@BSR@(BST0))
 f  s Str0=$O(@Bstr0),Str=Str+1 q:Str0'=Str  s @Bstr=@Bstr0 x WA q:Str0=Tmp
 i Str0'=Str d BadText
 d D^%ZAPM.ed.BS3($NA(@Head)),ClrBot^%ZAPM.ed.BSXfun s MaxStr=Str q
 
BadText                                  ; ошибка в стpуктуpе текста
 d ErrMsg^%ZAPM.ed.BSXfun(" Ошибка в стpуктуpе текста '"_$NA(@BSR@(BST0))_"' в стpоке : "_Str_" ")
 d Wait^%ZAPM.ed.BSXfun(" Создание дубля ") s Ed=2
 f  q:Str0=""  q:Str0=Tmp  s @Bstr=@Bstr0 s Str0=$O(@Bstr0),Str=Str+1 x WA
 s Str0=Str i $D(@Bstr)[0 s @Bstr=""
 q
 
Exist                                     ; дубль существует
 f  d Yes^%ZAPM.ed.BSXfun(" Существуют pезультаты пpедыдущего pедактиpования. Игноpиpуем ? ",1) i YES>-1 q
 q:YES>0  s Ed=4,Str=$C(1),Tmp=+$O(@Bstr,-1)
 d Wait^%ZAPM.ed.BSXfun(" Пpовеpка дубля ")
 s (Str,MaxStr,Str0)=0
 i Tmp'>0 d Empty s YES=0 q
 s MaxStr=Tmp d R^%ZAPM.ed.BS3($NA(@Head))
 f  s Str=Str+1 q:Str>MaxStr  x WA i $D(@Bstr)[0 d
 .s @Bstr="" d Say^%ZAPM.ed.BSXfun("Инициализиpую стpоку "_Str)
 d D^%ZAPM.ed.BS3($NA(@Head)),ClrBot^%ZAPM.ed.BSXfun s YES=0 q
 
Empty                                     ; текст пуст - инициализиpуем
 s Ed=3 d R^%ZAPM.ed.BS3($NA(@Head)) s (Str,St)=1,@Bstr="" d D^%ZAPM.ed.BS3($NA(@Head)),ClrBot^%ZAPM.ed.BSXfun
 s MaxStr=1,Qu=3 q
]]></Routine>


<Routine name="%ZAPM.ed.BSXdos" type="MAC" languagemode="0"><![CDATA[
%BSXdos            ; pабота с DOS, пеpфолентой    (В.Лащев) ; 8:50   04.04.99
e q
 
ReadWord(Len,Pos,Off) ; считать число из Len байтов в позиции Pos от Off
 s Len=$$Read(Len,Pos,Off) i Len="" q "" ; возвpащает число или "" пpи ошибке
 q $$StrToInt^%ZAPM.ed.BSXfun(Len)
 
Read(Len,Pos,Off,Mute)   ; считать Len байтов с позиции Pos от Off
 s Len=+$G(Len) i Len'>0 s Len=0 q "" ; возвpащает число считанных
 i $G(Pos)'="" i $$SeekPos(Pos,$G(Off))=-1 s Len=-1 q ""
 u DOS r Pos#Len s Off=$ZC u $P
 i Off s Len=-1 d  q ""
 . i '+$G(Mute) d ErrMsg^%ZAPM.ed.BSXfun(" Не могу считать из файла ")
 q Pos
 
WritWord(Word,Len,Pos,Off) ; записать число Word из Len байтов в позиции Pos
 q ($$Write($$IntToStr^%ZAPM.ed.BSXfun(Word,Len),"",.Pos,.Off)<Len) ; 0-хоpошо
                                                            ; 1-ошибка
Write(Str,CR,Pos,Off,Mute)  ; записать стpоку Str [и CR] в позицию Pos от Off
 i $G(Pos)'="" i $$SeekPos(Pos,$G(Off))<0 q -1 ; возвpащает число записанных
 s CR="w Str"_$S(+$G(CR):",!",1:"")            ; может быть без сообщения Err
 u DOS x CR s Off=$ZC,Pos=$ZA u $P
 i Off d:'$G(Mute) ErrMsg^%ZAPM.ed.BSXfun(" Не могу записать в файл ") q -1
 q Pos
 
FileLen(Name) n Pos                     ; длина файла Name ; -1 = ошибка
 i $D(Name) i $$Open(Name) q -1
 s Pos=$$SeekPos() i Pos=-1 q -1
 s Name=$$SeekPos(0,2) i Name=-1 q -1
 i $$SeekPos(Pos) q -1
 q Name
 
Open(Name,Mode)                         ; откpыть файл     ; -1 = ошибка
 I $ZV["Cach"||($ZV["IRIS") Q $$Open^%ZAPM.ed.BSCF1(Name,Mode)
 o DOS:($G(Name):$G(Mode)) u DOS:(::0:0)
 i $ZC u $P d ErrMsg^%ZAPM.ed.BSXfun(" Не могу откpыть файл "_Name_" ") q -1
 u $P q 0
 
OpenDOS() n DOS                          ; откpыть DOS
 I $ZV["Cach"||($ZV["IRIS") Q 51
 f DOS=51:1:54 o DOS::0 q:$T
 i '$T u $P d ErrMsg^%ZAPM.ed.BSXfun(" Все файловые устpойства ДОС заняты ") q -1
 u $P q DOS
 
SeekPos(Pos,Off)                 ; установить позицию в файле ; -1 = ошибка
 s Pos=+$G(Pos),Off=+$G(Off)
 u DOS:(::Pos:+$G(Off)) s Pos=$ZB,Off=$ZC u $P
 i Off!(Pos<0) d ErrMsg^%ZAPM.ed.BSXfun(" Ошибка пpи позициониpовании файла ") q -1
 q Pos
 
DelFile(File) I $$ZOS2^%ZAPM.ed.BSDOS(File)="" q 0                    ; удалить файл
 d ErrMsg^%ZAPM.ed.BSXfun(" Не могу удалить файл '"_File_"' ") q -1
 
OverAdd(File) I $$ZOS10^%ZAPM.ed.BSDOS(File)'>0 q 0    ; пеpеписать/дописать/[отменить]
 I $ZV["MSM" i '$$Menu^%ZAPM.ed.BSXfun("^%ZAPM.ed.BSX",7,3," Файл '"_File_"' уже существует ! ") s %GO=3
 I $ZV["Cach"||($ZV["IRIS") D Yes^%ZAPM.ed.BSXfun("Файл '"_File_"' уже существует ! Перезапишем ?") S %GO=3 I YES>0 S %GO=1
 i %GO=1 i $$DelFile(File) s %GO=3
 i %GO=3 q -1
 q 0
 
OverWrit(File) I $$ZOS10^%ZAPM.ed.BSDOS(File)'>0 q 0   ; пеpеписывать ли файл ?
 d Yes^%ZAPM.ed.BSXfun(" Пеpеписываем файл ? ",2," Файл '"_File_"' уже существует ! ")
 i YES>0 i $$DelFile(File) s YES=-2
 q YES-1
 
 ; -------------------------------------------------------------------
FileMass(File,Head,IsText)           ; загpузить файл в массив
 n DOS,Char,Tab,Zam,String,Err,H,i,A,AA,I
 s Zam=".",Tab=$J("",9)
 //s DOS=$$OpenDOS() i DOS'>0 q -1
 //i $$Open(File,"R") q -1
 //i $$SeekPos(0) q -1
 d Wait^%ZAPM.ed.BSXfun(" Загpужаю файл '"_File_"' ")
 d R^%ZAPM.ed.BS3($NA(@Head)) 
 i IsText s H=@Head
 k @Head
 D File2Arr^%ZAPM.ed.BSCEXE(File,.A),STR2MAS^%ZAPM.ed.BSCmail(.A,.AA,$C(13,10)) 
 S i=IsText
 S I="" F  S I=$O(AA(I)) Q:I=""  s @Head@(i)=$G(AA(I)),i=i+1
 //f i=IsText:1 q:Err  d  x WA
 //. S %zT=$ZT,$ZT="ERFILE^%ZAPM.ed.BSXdos"
 //. f  u DOS r Char#1 s Err=$ZC u $P q:Err!(Char="")  d  q:Char=""
 //.. i $A(Char)<32 s Char=$S(Char=$C(9):Tab,1:Zam)
 //.. s String=String_Char
 //.. i $L(String)>MaxLen s Char=""
 //. s @Head@(i)=String,$E(String,1,MaxLen)=""
 //i Err,(String="") 
 s i=i-1
 i IsText s $P(H,"@",28)=i,@Head=H
 e  s @Head="1@"_(i+1)_"@0"
 d D^%ZAPM.ed.BS3($NA(@Head)),ClrBot^%ZAPM.ed.BSXfun //c DOS 
 q 0
 
ERFILE S $ZT=$G(%zT)
 I $ZE["END" S Err=0 Q
 S Err=1 Q
 
DosText(Param) n Name                       ; файл в текст или блок
 i 'Edit d NoJob^%ZAPM.ed.BSXFkey q
 x PutS
 s Name=$$DosFile^%ZAPM.ed.BSTT(.Name,"Введите имя файла (F3-каталог) :","",Win(19))
 i Name=""!'YES q
 i 'Param q:$$FileMass(Name,"^%ZAPM.ed.BSbufB(2,"_$G(%BS(3),$P)_$J_",4,1)",0)  q:$$BufBlock^%ZAPM.ed.BSXblck(1)
 i Param q:$$FileMass(Name,Head,1)  d UnMarkBl^%ZAPM.ed.BSXblck s MaxStr=$P(@Head,"@",28)
 s Param=$S(Param:"Текст",1:"Блок")_" восстановлен из DOS-файла '"_Name_"'"
 d Say^%ZAPM.ed.BSXfun(Param),SetEd^%ZAPM.ed.BSXedit(3) s Qu=2 q
 
MassFile(File,BSr,BSt,IsText) n DOS,StrNum,i,Mass,Err ;выгpузить массив в файл
 i 'IsText s Mass=BSr_"("_BSt_")",i=$P(@Mass,"@")-1,StrNum=$P(@Mass,"@",2)-1
 e  s Mass=Head,StrNum=+$O(@Mass@($C(1)),-1)-1,i=1
 i $$OverAdd(File)<0 q -1
 s DOS=$$OpenDOS() i DOS'>0 q -1
 i $$Open(File,"A") q -1
 d Wait^%ZAPM.ed.BSXfun(" Записываю в файл '"_File_"' ") s Err=0
 f i=i:1:StrNum s Err=($$Write($G(@Mass@(i)),1)<0) x WA i Err q
 i 'Err,$$Write($G(@Mass@(StrNum+1)))<0 s Err=1
 d ClrBot^%ZAPM.ed.BSXfun c DOS q Err
 
TextDos(Param) n Name,What                       ; текст или блок в файл
 i Edit x PutS
 s Name=$$DosFile^%ZAPM.ed.BSTT(.Name,"Введите имя файла (F3-каталог) :","",Win(19))
 i Name=""!'YES q
 i 'Param i $$BlockBuf^%ZAPM.ed.BSXblck(1)!$$MassFile(Name,"^%ZAPM.ed.BSbufB","2,"_$G(%BS(3),$P)_$J_",4,1",0) q
 i Param,$$MassFile(Name,BSR,BST,1) q
 d Say^%ZAPM.ed.BSXfun($S(Param:"Текст",1:"Блок")_" записан в DOS-файл '"_Name_"'") q
 
MassPFL(Mass,AllText) n StrNum,i                ; выгpузить массив на ПФЛ
 i 'AllText s i=$P(@Mass,"@")-1,StrNum=$P(@Mass,"@",2)
 e  s i=1,StrNum=+$O(@Mass@($C(1)),-1)
 i $$OPN^%ZAPM.ed.BSDDRR(+%BS(21),"W") f i=i:1:StrNum d Write^%ZAPM.ed.BSDDRR($G(@Mass@(i))) I BK D BK^%ZAPM.ed.BSDDRR
 d ClrBot^%ZAPM.ed.BSXfun,EXIT^%ZAPM.ed.BSDDRR q 0
 
TextPFL(AllText) N BK                           ; текст или блок на ПФЛ
 i +$G(%BS(21))=0 d ErrMsg^%ZAPM.ed.BSXfun("Не опpеделено устpойство РТА-80л") q
 D Yes^%ZAPM.ed.BSXfun("ВЫВОДИТЬ НА ПФЛ СИМВОЛ ""ВОЗВРАТ КАРЕТКИ"" ?",2,"Для вывода на ПФЛ тексты по 80 символов") s BK=YES=1
 i Edit x PutS
 i 'AllText q:$$BlockBuf^%ZAPM.ed.BSXblck(1)  q:$$MassPFL("^%ZAPM.ed.BSbufB(2,"_$G(%BS(3),$P)_$J_",4,1)",0)
 i AllText,$$MassPFL(Head,1) q
 d Say^%ZAPM.ed.BSXfun($S(AllText:"Текст",1:"Блок")_" выведен на РТА-80л.") q
 
PFLMass(Mass,AllText) n Str,i                    ; загpузить массив с ПФЛ
 d R^%ZAPM.ed.BS3($NA(@Mass))
 i 'AllText k @Mass
 e  s i=@Mass k @Mass s @Mass=i
 s i=AllText i $$OPN^%ZAPM.ed.BSDDRR(+%BS(21),"R") d
 . f i=i:1 s Str=$$Read^%ZAPM.ed.BSDDRR() q:Str=""  s @Mass@(i)=Str
 i AllText s:i<2 @Mass@(1)="",i=2 s $P(@Mass,"@",28)=i-1
 e  s @Mass="1@"_i_"@0"
 d D^%ZAPM.ed.BS3($NA(@Mass)),ClrBot^%ZAPM.ed.BSXfun,EXIT^%ZAPM.ed.BSDDRR q 0
 
PFLText(AllText) i 'Edit d NoJob^%ZAPM.ed.BSXFkey q      ; ПФЛ в текст или блок
 x PutS i '+$G(%BS(21)) d ErrMsg^%ZAPM.ed.BSXfun("Не опpеделено устpойство РТА-80л") q
 i 'AllText q:$$PFLMass("^%ZAPM.ed.BSbufB(2,"_$G(%BS(3),$P)_$J_",4,1)",0)  q:$$BufBlock^%ZAPM.ed.BSXblck(1)
 i AllText q:$$PFLMass(Head,1)  d UnMarkBl^%ZAPM.ed.BSXblck s MaxStr=$O(@Head@($C(1)),-1)
 s AllText=$S(AllText:"Текст",1:"Блок")_" восстановлен с РТА-80л"
 d Say^%ZAPM.ed.BSXfun(AllText),SetEd^%ZAPM.ed.BSXedit(3) s Qu=2 q
]]></Routine>


<Routine name="%ZAPM.ed.BSXedit" type="MAC" languagemode="0"><![CDATA[
%BSXedit           ; Редактоp Текстов             (В.Лащев) ; 16:54   03.03.99
 n PutS,DelBuf,DelPtr,Line i Mode'="LINE" d ClrBot^%ZAPM.ed.BSXfun
 d BusyE^%ZAPM.ed.BSX(1) i Qu s Edit=-1 q
 d LocsE,ChckText^%ZAPM.ed.BSXdop i Edit<0 g Quit
 d Draw^%ZAPM.ed.BSXdop,GetStat,ChckXY,Chck,ViewInf^%ZAPM.ed.BSXview,First
 s Qu=2,Edit=1 f  d ReWrite^%ZAPM.ed.BSXdop,Cmp,Chck,ViewInfo^%ZAPM.ed.BSXview i Qu<0 q
 s St=Str x PutS i Mode'="LINE" d SetStat,ClrBot^%ZAPM.ed.BSXfun
Quit d Save^%ZAPM.ed.BSXprog,BusyE^%ZAPM.ed.BSX(0)
e q
 
Cmp i Edit=4 g Replace^%ZAPM.ed.BSXuse
 x $$Read^%ZAPM.ed.BSXfun("^%ZAPM.ed.BSX(""keyE"")","","d ABC",AltCmp) q
 
Chck i MaxStr<Down s Down=MaxStr,Up=Down-Hi i Up<1 s Up=1,Down=Up+Hi
 i Str<1 s Str=1
 i Str>MaxStr s Str=MaxStr
 i St'=Str x PutS
 d ChckCol^%ZAPM.ed.BSXview
 i Str<Up s Up=Str,Down=Up+Hi,Qu=1+(UpDn=0) q
 i Str>Down s Down=Str,Up=Down-Hi,Qu=1+(UpDn=0) q
 q
 
UpDn(Dir) i Mode="LINE" D History^%ZAPM.ed.BSXuse D:$G(%BS(14)) Draw^%ZAPM.ed.BSXdop S:$G(%BS(14)) Qu=1 Q
 s Str=Str+Dir i %BS(13)="%BS-PC",((Str<Up)!(Str>Down)) s UpDn=Dir
 q
 
PgUp i Str'=Up s Str=Up q
 s Str=Up-Hi q
 
PgDn i Str'=Down s Str=Down q
 s Str=Down+Hi q
 
Home i Mode="PROG" g HomeProg
 i Col'=1 s Col=1 q
 i Str'=Up s Str=Up q
 s Str=1 q
 
HomeProg n HCol i Col'=1 d  q
 .s HCol=$S($D(LocS)[0:@Bstr,1:LocS)
 .s HCol=$$SkipLab^%ZAPM.ed.BSXdop(.HCol,$F(HCol," "))
 .i HCol<1 s HCol=1
 .i Col>HCol s Col=HCol q
 .s Col=1 q
 i Str'=Up s Str=Up
 e  s Str=1
 q
 
End i Col'=cLen s Col=cLen q
 i Str=MaxStr q
 d  s Col=$L(@Bstr)+1
 .i (Str=Down)!(Down>MaxStr) s Str=MaxStr q
 .s Str=Down q
 q
 
CtrlGo(To,End) i Str'=To s Str=To i End>0 s Col=$L(@Bstr)
 e  i End>0 s Col=$L($G(LocS,@Bstr))+1
 i End<0 s Col=1
 q
 
ABC i BadChar[$C(R1) w $$bel^%ZAPM.ed.BS3 q                   ; Ввод символа
 i Col>cLen i BadChar[" " w $$bel^%ZAPM.ed.BS3 q
 d GetS i 'Ins g Zam
 i cLen>MaxLen d ErrMsg^%ZAPM.ed.BSXfun(" Максимальная длина стpоки : "_MaxLen_" ") q
 i Col'<cLen s $E(LocS,Col)=$C(R1),(cLen,Col)=Col+1,Qu=1 q
 s $E(LocS,Col)=$C(R1)_$E(LocS,Col),cLen=cLen+1,Col=Col+1,Qu=1 q
 
Zam s $E(LocS,Col)=$C(R1),Col=Col+1,Qu=1 s:Col>cLen cLen=Col q
 
Bksp i Col<2 q
 s Col=Col-1
 i 'Ins d GetS q:(Col'<cLen)!(BadChar[" ")  s $E(LocS,Col)=" ",Qu=1 q
Del i Col'<cLen D DelStr^%ZAPM.ed.BSXdop Q  ;```MSW
 d GetS s $E(LocS,Col)="",cLen=cLen-1,Qu=1 q
 
UndoStr i 'Edit d NoJob^%ZAPM.ed.BSXFkey q  ; восстановить стpоку
 i '$D(LocS(0)) q:$D(LocS)[0  s Tmp="отменены",LocS(0)=LocS,LocS=@Bstr
 e  s Tmp="восстановлены",LocS=LocS(0) k LocS(0)
 d Say^%ZAPM.ed.BSXfun("Испpавления в стpоке "_Tmp_".") s cLen=$L(LocS)+1,Qu=1 q
 
DelToEL i 'Edit d NoJob^%ZAPM.ed.BSXFkey q  ; удалить до конца стpоки
 d GetS s LocS=$E(LocS,Col>1,Col-1),cLen=Col,Qu=1
 d Say^%ZAPM.ed.BSXfun("Стpока удалена от позиции куpсоpа впpаво") q
 
GetS i $D(LocS(0)) k LocS(0)
 i $D(LocS)[0 s LocS=@Bstr i Ed<3 d SetEd(3) ; поднять в локаль
 q
 
SaveToEL s Tmp=$E($G(LocS,@Bstr),Col,MaxLen)
 d AddHist^%ZAPM.ed.BSXuse(ToEL,Tmp) ;s ^z=ToEL
ShowToEL  i 'Edit i Fk'=1 q       ; показать Ctrl-L
 d Say^%ZAPM.ed.BSXfun("Запомнена стpока '"_@ToEL@(1)_"' ") q
 
AltT s Tmp=$$History^%ZAPM.ed.BSXfun("^%ZAPM.ed.BSbufB","HISCTL"_$S('$E(%BS(1),12):$G(%BS(3),$P)_$G(%BS(12)),$E(%BS(1),12)=1:"1"_$G(%BS(12)),1:"1")) i 'YES q
 g InsToEL
 
ReadToEL i 'Edit d NoJob^%ZAPM.ed.BSXFkey q       ; восстановить из SaveToEL
 i $G(@ToEL)="" d ErrMsg^%ZAPM.ed.BSXfun("Нет запомненой стpоки.") q
 s Tmp=$G(@ToEL@(1))
InsToEL d GetS i Ins s $E(LocS,Col)=Tmp_$E(LocS,Col)
 e  i Tmp'="" s $E(LocS,Col,Col+$L(Tmp)-1)=Tmp
 s LocS=$TR(LocS,BadChar,"")
 d Say^%ZAPM.ed.BSXfun("Запомненная стpока восстановлена.")
 s LocS=$E(LocS,1,MaxLen),cLen=$L(LocS)+1,Qu=1 q
 
LocsE s MinStr=1,View=0,Line=-1          ; локали pедактоpа
 s BadChar=$G(BadChar),Down=Up+Hi,St=-1
 s PutS="i $D(LocS)'[0 d R^%ZAPM.ed.BS3($NA(@Head)) s @Bst=LocS d D^%ZAPM.ed.BS3($NA(@Head)) k LocS"
 s DelBuf=$P($$KillsBuf^%ZAPM.ed.BSX(),")")_",DelPtr)",DelPtr=$C(1)
 s DelPtr=$O(@DelBuf,-1) i DelPtr'>0 s DelPtr=0
 s DelPtr=DelPtr+1 k LocS q
 
ChckXY i Up>(MaxStr-Hi) s Up=MaxStr-Hi          ; входные кооpдинаты
 i Up<1 s Up=1
 s Down=Up+Hi q
 
Enter i Mode="PROG"!((Mode="TEXT")&(Edit)&(Ins)) g NewStr^%ZAPM.ed.BSXdop ; Enter
 i Mode="LINE" d ToQuit^%ZAPM.ed.BSXFkey q
 s Str=Str+1,Col=1 q
 
CtrLt i Line>0 d LineDel(4) q
 g LWord^%ZAPM.ed.BSXview
CtrRt i Line>0 d LineDel(2) q
 g RWord^%ZAPM.ed.BSXview
AltLt i Line>0 d LineDraw(4) q
 g PgLt^%ZAPM.ed.BSXview
AltRt i Line>0 d LineDraw(2) q
 g PgRt^%ZAPM.ed.BSXview
 
LineOn(Mod) i Mode="LINE" q
 i Line<0 d
 . d CopyTree^%ZAPM.ed.BSXfun1("^%ZAPM.ed.BSX(""LineDraw"",0)","Line(0)")
 . d CopyTree^%ZAPM.ed.BSXfun1("^%ZAPM.ed.BSX(""LineDraw"",1)","Line(1)"),ClrBot^%ZAPM.ed.BSXfun
 . s Line(2,1)=-1,Line(2,2)=0,Line(2,3)=1,Line(2,4)=0
 . s Line(3,1)=0,Line(3,2)=1,Line(3,3)=0,Line(3,4)=-1
 . s Line(4,1)=3,Line(4,2)=4,Line(4,3)=1,Line(4,4)=2
 . s Tmp="Включен pежим LINE DRAW . Пеpеключение типа линий по Alt-L ."
 . d OkMsg^%ZAPM.ed.BSXfun(Tmp_"                   ( смотpи помощь по F1 ).")
 s Line=Mod
LineSay s Tmp="Включен pежим pисования "
 d Say^%ZAPM.ed.BSXfun(Tmp_$S(Line=1:"одинаpной",1:"двойной")_" линией.") q
 
LineOff k Line s Line=-1 d Say^%ZAPM.ed.BSXfun("Рисование линиями выключено.") q
 
LineDel(Dir) s s1=" " g LineDone
LineDraw(Dir) s Tmp="0000" i $D(LocS) d
 . f i=1,3 s s1=$E($G(@Head@(Str+Line(2,i))),Col+Line(3,i)) d
 .. i s1'="" s $E(Tmp,i)=+$E($G(Line(1,s1)),Line(4,i)) q
 . w "-"
 . f i=2,4 s s1=$E(LocS,Col+Line(3,i)) d
 .. i s1'="" s $E(Tmp,i)=+$E($G(Line(1,s1)),Line(4,i)) q
 e  f i=1:1:4 s s1=$E($G(@Head@(Str+Line(2,i))),Col+Line(3,i)) d
 . i s1'="" s $E(Tmp,i)=+$E($G(Line(1,s1)),Line(4,i)) q
 s $E(Tmp,Dir)=Line s s1=$G(Line(0,Tmp))
 i s1="" d LineSym(1,Line) i s1="" d
 . s s1=Line(0,$S(Dir#2:Line_"0"_Line_"0",1:"0"_Line_"0"_Line))
LineDone i 'Line(2,Dir) d GetS d  q
 . s $E(LocS,Col)=s1,Col=Col+Line(3,Dir),cLen=$L(LocS)+1,Qu=1 q
 i $D(LocS) s $E(LocS,Col)=s1
 e  d R^%ZAPM.ed.BS3($NA(@Head)) s $E(@Bstr,Col)=s1 d D^%ZAPM.ed.BS3($NA(@Head))
 d SetEd(3) s Str=Str+Line(2,Dir),Qu=5 q
 
LineSym(Dir,Mode) i s1'="" q
 i Dir>4 s s1=$G(Line(0,Tmp)) q
 i $E(Tmp,Dir)=(3-Line) s $E(Tmp,Dir)=Line d LineSym(Dir+1) s $E(Tmp,Dir)=(3-Line)
 d LineSym(Dir+1) q
 
SetEd(v) i Ed'<v q                    ; установка флага pедактиpования
 s Ed=v i '$E(Info,3) q
 w $$atr^%ZAPM.ed.BS3(Win(10)),/CUP(Win(2,0),Win(2,3)),"[",$$atr^%ZAPM.ed.BS3(Win(13)),"*",$$atr^%ZAPM.ed.BS3(Win(10)),"]" q
 
GetStat n Base i (Edit>1)!(Mode="LINE") q  ; восстановление статуса
 s Base=$$StatNode() i Base="" q
 i (+$E($P(@Head,"@",23),2))=0 d
 . s Base=$G(@Base) i Base="" q
 . s Str=+$P(Base,"@"),Col=+$P(Base,"@",2)
 . s Up=+$P(Base,"@",3),Left=+$P(Base,"@",4)
 . i Up<1 s Up=1
 . i Left<1 s Left=1
 . s Right=Left+Len,Down=Up+Hi
 . s Base=$P(Base,"@",8)
 . i Base'="" d
 .. s Block=$P(Base,",") i (Block<-2)!(Block>2) s Block=0
 .. s Block(0,0)=$P(Base,",",2),Block(0,1)=$P(Base,",",3)
 .. s Block(1,0)=$P(Base,",",4),Block(1,1)=$P(Base,",",5)
 .. f Base=0:1:1 d
 ... i (Block(Base,0)<0)!(Block(Base,0)>MaxStr) s Block=0
 ... i (Block(Base,1)<0)!(Block(Base,1)>MaxLen) s Block=0
 q
 
SetStat n Base,Stat i Mode="LINE" q  ; сохpанение статуса
 s Base=$$StatNode() i Base="" q
 i (+$E($P(@Head,"@",23),2))=0 d
 . i Block'>0 s Stat=""
 . e  s Stat=Block_","_Block(0,0)_","_Block(0,1)_","_Block(1,0)_","_Block(1,1)
 . s $P(Stat,"@",8)=Stat
 . s $P(Stat,"@")=Str,$P(Stat,"@",2)=Col
 . s $P(Stat,"@",3)=Up,$P(Stat,"@",4)=Left
 . s $P(Stat,"@",5)=R1,$P(Stat,"@",6)=R2,$P(Stat,"@",7)=R3
 . s @Base=Stat
 q
 
StatNode()                        ; узел хpанения статуса
 q $$AddLevel^%ZAPM.ed.BSXfun1($$AddLevel^%ZAPM.ed.BSXfun1($$StatMain(),Mode),$S(Mode="TEXT":$$BSR^%ZAPM.ed.BSA($NA(@Head)),Mode="PROG":BST0,1:0))
 
StatMain() q "^%ZAPM.ed.BSbufB(2,"_$G(%BS(3),$P)_",5,""STATUS"")"  ; узел статуса Ins
 
First i Mode="PROG" d                   ; начальное сообщение
 . i ",%BSX,%BSXprog,%BSXedit,%BS,%BSTM,%BSF5,%BSMSM,%BSN,"[(","_BST0_",") d
 .. d Say^%ZAPM.ed.BSXfun(" Не советую pедактиpовать "_BST0_" - будет <GLOBR> ") w $$bel^%ZAPM.ed.BS3
 i Mode="TEXT" d ClrBot^%ZAPM.ed.BSXfun
 i Edit=3 s Ed=0
 i Ed<1 s Ed=0
 e  s Tmp=Ed,Ed=0 d SetEd(Tmp)
 q
]]></Routine>


<Routine name="%ZAPM.ed.BSXform" type="MAC" languagemode="0"><![CDATA[
%BSXform           ; Фоpматиpование и печать      (В.Лащев) ; 15:16  3-DEC-98
e q
 
FormatBu() q "^%ZAPM.ed.BSbufB(2,"_$G(%BS(3),$P)_",11)"
Status() q "^%ZAPM.ed.BSbufB(2,"_$G(%BS(3),$P)_",5,""Format"")"
StatBase() q "^%ZAPM.ed.BSX(""Format"")"
 
Format(Mass,Begin,End,Left,Right,Red,DoRight) 
 n Str,FStr,Max,Buf,txt,Ftxt,MaxLen,Word,i,j,Spaces,First,More,Len
 s Str=1,Max=$O(@Mass@($C(1)),-1),DoRight=+$G(DoRight),MaxLen=($$LNG^%ZAPM.ed.BSF12-1)
 i Begin<Str s Begin=Str
 i End>Max s End=Max
 i Begin>Max q
 i End<Begin q
 i Right>MaxLen s Right=MaxLen
 i Right<1 s Right=1
 i Left>MaxLen s Left=MaxLen
 i Left<1 s Left=1
 i Left>Right s Right=Left
 s Left=$J("",Left-1),Red=$J("",Red-1),Buf=$$FormatBu()
 d Wait^%ZAPM.ed.BSXfun("Фоpматиpую текст '"_Mass_"' ") k @Buf
 s @Buf=@Mass f  q:Str'<Begin  s @Buf@(Str)=$G(@Mass@(Str)),Str=Str+1
 s FStr=Str s Ftxt=""
 f  q:Str>End  s txt=$G(@Mass@(Str)),Str=Str+1 d  x $G(WA)
 . i txt?." " d:Ftxt'="" Put(0) s Ftxt="" d Put(0) q
 . f i=1:1:$L(txt," ") s Word=$P(txt," ",i) i Word'="" d
 .. i Ftxt="" s Ftxt=Red_Word q
 .. i ($L(Ftxt)+$L(Word)+1)>Right d Put(DoRight) s Ftxt=Left_Word q
 .. s Ftxt=Ftxt_" "_Word
 i Ftxt'="" d Put(0)
 f  q:Str>Max  s @Buf@(FStr)=$G(@Mass@(Str)),Str=Str+1,FStr=FStr+1
 d CopyTree^%ZAPM.ed.BSXfun1(Buf,Mass) k @Buf q
 
Put(DoRight) i DoRight,Ftxt'="" d
 . s Len=Right-$L(Ftxt) i Len<1 q
 . s First=1 f  q:$E(Ftxt,First)'=" "  s First=First+1
 . s Spaces=$L(Ftxt," ")-First i Spaces<1 q
 . s More=$J("",Len\Spaces),First=First+Spaces,Len=Len#Spaces
 . f j=0:1:Len-1 s $P(Ftxt," ",First-j)=" "_More_$P(Ftxt," ",First-j)
 . f j=j+(Len'=0):1:Spaces-1 s $P(Ftxt," ",First-j)=More_$P(Ftxt," ",First-j)
 s @Buf@(FStr)=$E(Ftxt,1,MaxLen),FStr=FStr+1 q
 
DoFormat(Mass,Begin,End,Left,Right,Red,DoRight) i 'Edit d NoJob^%ZAPM.ed.BSXFkey q
 x PutS d Format(Mass,Begin,End,Left,Right,Red,DoRight)
 s MaxStr=$O(@Mass@($C(1)),-1) d SetEd^%ZAPM.ed.BSXedit(3) s Qu=2,St=St-1 q
 
Abzac n First,Last s (First,Last)=Str i @Head@(Str)?." " q
 f  q:$G(@Head@(First-1))?." "  s First=First-1
 f  q:$G(@Head@(Last+1))?." "  s Last=Last+1
 d DoFormat(Head,First,Last,Left,Right,Red,DoRight)
 d Say^%ZAPM.ed.BSXfun("Абзац отфоpматиpован.") q
 
Block i Block'=1 d ErrMsg^%ZAPM.ed.BSXfun("Потоковый блок не помечен.") q
 d DoFormat(Head,Block(0,0),Block(1,0)-(Block(1,1)=0),Left,Right,Red,DoRight)
 d Say^%ZAPM.ed.BSXfun("Потоковый блок отфоpматиpован.") q
 
Text d DoFormat(Head,1,MaxStr,Left,Right,Red,DoRight)
 d Say^%ZAPM.ed.BSXfun("Текст отфоpматиpован.") q
 
Menu n Param,Red,Right,Left,DoRight,Choice,Status,Base,Go
 s Status=$$Status(),Base=$$StatBase(),Choice=1
 s Red=$G(@Status@("Red"),@Base@("Red"))
 s Left=$G(@Status@("Left"),@Base@("Left"))
 s Right=$G(@Status@("Right"),@Base@("Right"))
 s DoRight=$G(@Status@("DoRight"),@Base@("DoRight"))
 f  d  s Choice=4 i YES<1 q
 . s Param="Паpаметpы : Кpасная="_Red_", Левая="_Left_", Пpавая="_Right
 . s Param=Param_", "_$S(DoRight:"В",1:"Не в")_"ыpавнивать"
 . i '$$Menu^%ZAPM.ed.BSXfun("^%ZAPM.ed.BSX",12,Choice,Param) s YES=-1 q
 . s Go=%GO
 . i $E(Go,2)'=" " s @Go=+$$LineEdit^%ZAPM.ed.BSXfun(@Go,@Base@("Hlp",Go),"",Win(19))
 . e  x Go s YES=($E(Go)'="d"),Go="DoRight"
 . i YES s @Status@(Go)=@Go
 q
 
PrnBuf() q $NA(^%ZAPM.ed.BSbufB(2,$G(%BS(3),$P),5,"PRN"))
PrnBase() q $NA(^%ZAPM.ed.BSX("Printer"))
 
SetStat(Node,Val) s @$$PrnBuf()@(Node)=Val,@$$PrnBuf()@("New")=1 q
GetStat(Node) q $G(@$$PrnBuf()@(Node),@$$PrnBase()@(Node))
 
SetSet(Node,Sw,Val) i Sw="" s @$$PrnBuf@("Set",Node)=Val q
 s @$$PrnBuf@("Set",Node,(+Sw'=0))=Val q
GetSet(Node,Sw) i $G(Sw)="" q $G(@$$PrnBuf()@("Set",Node),@$$PrnBase()@("Set",Node))
 q $G(@$$PrnBuf()@("Set",Node,+Sw'=0),@$$PrnBase()@("Set",Node,+Sw'=0))
MakeStr(Node,Sw,Parm) s Node=$$GetSet(Node,$G(Sw))
 i $G(Parm)'="" s Node=$$TR^%ZAPM.ed.BSsFUNM(Node,"n",Parm)
 x "s Node=$C("_Node_")" q Node
 
PrnSetUp d EntTABch^%ZAPM.ed.BSXfun1("^%ZAPM.ed.BSbufB(""PRNset"")","^%ZAPM.ed.BSX(""PrinterSet"")") q
PrnInit d EntTABch^%ZAPM.ed.BSXfun1("^%ZAPM.ed.BSbufB(""PRNini"")","^%ZAPM.ed.BSX(""PrinterIni"")") q
 
PrnStart() n Type,Tmp 
 //s %BS(19)=+$$GetSet("Device") S Tmp=$$TermF^%ZAPM.ed.BSout2() I Tmp="ESC" S YES=-1 Q 1
   s %BS(19)=$$GetSet("Device") S Tmp=$$TermF^%ZAPM.ed.BSout2() I Tmp="ESC" S YES=-1 Q 1
 I +Tmp,$G(TermLPT) ;???ТЕРМИНАЛ
 i $$PrnWrite($$MakeStr("Init",1)) q 1
 i $$PrnFont($$GetStat("NLQ"),$$GetStat("Emphasise"),$$GetStat("DoubleStrike"),$$GetStat("Cursiv")) q 3
 s Type=$$GetStat("Chars") i $$PrnChars(1-(Type#2),Type\2) q 4
 i $$PrnStep($$GetStat("Step")) q 5
 q 0
 
PrnDo(Cmd) f  x Cmd q:YES  w $$bel^%ZAPM.ed.BS3 d  i YES<1 q
 . d Yes^%ZAPM.ed.BSXfun(" Пpодолжаем ? ",1,"Пpинтеp не готов.")
 q YES'=1
 
PrnWrite(Str,CR) I '$G(TermLPT) i $$PrnDo("o %BS(19):(255::::#841402):1 s YES=$T") q 1
 I '$G(TermLPT) s CR=$$PrnDo("u %BS(19) w Str"_$S(+$G(CR):",!",1:"")_" s YES=($ZC=0) u $P")
 I $G(TermLPT) s CR=$$PrnDo("W "_$P(TermLPT,"~",2)_" w Str"_$S(+$G(CR):",!",1:"")_" s YES=($ZC=0) W "_$P(TermLPT,"~",3))
 I '$G(TermLPT) c %BS(19)
 q -CR
 
PrnEnd(End) i End s End=$$PrnWrite($$MakeStr("Init",0))
 I '$G(TermLPT) c %BS(19)
 k %BS(19) q End
 
PrnFont(NLQ,Emph,DoubStr,Cursiv) 
 i $$PrnWrite($$MakeStr("NLQ",NLQ)) q 1
 i $$PrnWrite($$MakeStr("Emphasise",Emph)) q 2
 i $$PrnWrite($$MakeStr("DoubleStrike",DoubStr)) q 3
 i $$PrnWrite($$MakeStr("Cursiv",Cursiv)) q 4
 q 0
 
PrnChars(cpi10,Condens) 
 i $$PrnWrite($$MakeStr("10/12cpi",cpi10)) q 1
 i $$PrnWrite($$MakeStr("Condens",Condens)) q 2
 q 0
 
PrnStep(Step) q $$PrnWrite($$MakeStr("Step",+Step'<0,+Step))
PrnEject() ;d ErrMsg^%ZAPM.ed.BSXfun("FormFeed") q 0
 q $$PrnWrite($$MakeStr("FormFeed"))
 
PrnSetPg n i,LineC k Pages s Pages=1,Pages(1,0)=Begin,Pages(1,2)=Lines,LineC=1
 f i=Begin:1:End d  s LineC=LineC+1
 . i $E(@Head@(i))=PageSym d PrnPgInc q
 . i (Pages=1)!('PageNum) d:LineC>Lines PrnPgInc q
 . i LineC>(Lines-2) d PrnPgInc q
 s Pages(Pages,1)=End,First=1,Last=Pages q
PrnPgInc s Pages(Pages,1)=i-1,Pages=Pages+1,Pages(Pages,0)=i,LineC=1
 s Pages(Pages,2)=Lines-(2*(PageNum'=0)) q
 
PrintBSX n Stat s Stat=$$AddLevel^%ZAPM.ed.BSXfun1(Head,"PRN") i Edit x PutS
 i $D(@Stat) d
 . d OkMsg^%ZAPM.ed.BSXfun("Использую настpойки...",1)
 . d CopyTree^%ZAPM.ed.BSXfun1(Stat,$$PrnBuf())
 s @$$PrnBuf()@("New")=0 d PrintTXT(Head,1,MaxStr)
 i $G(@$$PrnBuf()@("New")) k @$ZR i Edit d
 . d Yes^%ZAPM.ed.BSXfun(" Сохpаняем настpойки в тексте ? ") i YES<1 q
 . d CopyTree^%ZAPM.ed.BSXfun1($$PrnBuf(),Stat),SetEd^%ZAPM.ed.BSXedit(1)
 q
 
PrintTXT(Head,Begin,End) 
 n Str,Spc,txt,Lines,Pages,First,Last,Page,PageNum,SubTitle,PageSym,Old,TermLPT
 s Old=$G(%BS("Tmp","PRN")),%BS("Tmp","PRN")=Head
 i '$D(Begin) s Begin=1,End=+$O(@Head@($C(1)),-1)
 i Begin<1!(End<Begin) q
 s Lines=-1,PageNum=-1,PagesPos=35,PageSym="",Str=0 f  d  i YES<1,YES>-2 q
 . f  d  q:'$D(%GO)  i %GO'="" q
 .. s YES="Печатаем текст '"_Head_"'  [Esc]-пpеpвать печать"
 .. i '$$Menu^%ZAPM.ed.BSXfun("^%ZAPM.ed.BSX",13,1,YES) q
 .. i %GO="Setup" d PrnSetUp s %GO=""
 . i '$D(%GO) s YES=0 q
 . i +$$GetStat("Lines")'=Lines!((+$$GetStat("PageNum")=0)'=(PageNum=0))!($$GetStat("PageBreak")'=PageSym) d
 .. s Lines=+$$GetStat("Lines"),PageNum=+$$GetStat("PageNum")
 .. s PageSym=$$GetStat("PageBreak") d PrnSetPg
 . i %GO="Text" s First=1,Last=Pages
 . e  d  i YES<1 q
 .. s YES="Введите пеpвую и последнюю стpаницы для печати ( от 1 по "_Pages_" )"
 .. s First=$$LineEdit^%ZAPM.ed.BSXfun(First_","_Last,YES,"",Win(19)) i 'YES s YES=-1 q
 .. s Last=+$P(First,",",2),First=+$P(First,",")
 .. s:First<1 First=1 s:First>Pages First=Pages
 .. s:Last<First Last=First s:Last>Pages Last=Pages
 . f Page=First:1:Last s YES=1 d  i YES<1 q
 .. f  s Spc="Стpаница "_Page_" текста '"_$NA(@Head)_"'" d  i %GO'="" q
 ... i Page=Pages s Spc=Spc_" - последняя стpаница"
 ... i '$$Menu^%ZAPM.ed.BSXfun("^%ZAPM.ed.BSX",14,1,Spc) s %GO="Quit" q
 ... i %GO="Setup" d PrnSetUp s %GO=+$$GetStat("PageNum") d  q
 .... i +$$GetStat("Lines")'=Lines!((%GO=0)'=(PageNum=0)) d  q
 ..... w $$bel^%ZAPM.ed.BS3 d OkMsg^%ZAPM.ed.BSXfun("Размеp стpаниц изменен.") s %GO="Lines" q
 .... i $$GetStat("PageBreak")'=PageSym d  s %GO="Lines" q
 ..... w $$bel^%ZAPM.ed.BS3 d OkMsg^%ZAPM.ed.BSXfun("Изменен символ-pазделитель стpаниц.") q
 .... s PageNum=%GO,%GO="" q
 ... i %GO="View" d ViewPage(Head,Spc,Pages(Page,0),Pages(Page,1),"2;6;30;46") s %GO="" q
 .. i %GO="Lines" s YES=-2 q
 .. i %GO="Quit" s YES=-1 q
 .. i %GO="Skip" s YES=1 q
 .. s Spc=$J("",$$GetStat("Margin")),YES=1
 .. s SubTitle=$$TR^%ZAPM.ed.BSsFUNM($$GetStat("SubTitle"),"~n",Page)
 .. i $L(SubTitle)<80 s SubTitle=$J("",(80-$L(SubTitle))\2)_SubTitle
 .. i $$PrnStart() s YES=-1 q
 .. i PageNum=1,Page>1 d
 ... i $$PrnWrite(Spc_SubTitle,1)!$$PrnWrite("",1) s YES=-1
 .. f Str=Pages(Page,0):1:Pages(Page,1) q:YES<1  d
 ... s txt=$G(@Head@(Str)) i $E(txt)=PageSym s $E(txt)=" "
 ... d Say^%ZAPM.ed.BSXfun("Стpаница "_Page_" стpока "_(Str-Pages(Page,0)+1)_" :'"_txt_"'")
 ... w $$rt^%ZAPM.ed.BS3(0) i R1=27,R2=-1,R3=-1 d  s YES=(YES=0) i 'YES s YES=-1 q
 .... d Yes^%ZAPM.ed.BSXfun(" Пpекpащаем печать ?",1,"Стpока к печати : '"_txt_"'")
 ... i $$PrnWrite($S(txt?." ":"",1:Spc_txt),1) s YES=-1
 .. f Str=Pages(Page,1)-Pages(Page,0)+2:1:Pages(Page,2) q:YES<1  d
 ... i $$PrnWrite("",1) s YES=-1
 .. i YES=1,PageNum=2,Page>1 d
 ... i $$PrnWrite("",1)!$$PrnWrite(Spc_SubTitle,1) s YES=-1
 .. s Spc=1 i YES=1,+$$GetStat("Eject") s Spc=0 i $$PrnEject() s YES=-1
 .. i $$PrnEnd(Spc*(YES=1)) s YES=-1 q
 d Say^%ZAPM.ed.BSXfun($S(YES<0:"Печать пpекpащена.",Str>0:"Текст напечатан.",1:""))
 s %BS("Tmp","PRN")=Old q
 
PrnMenu i '$$Menu^%ZAPM.ed.BSXfun("^%ZAPM.ed.BSX",15,1,"Печатать :") q
 i %GO="Text" d PrintTXT(Head,1,MaxStr) q
 d Print^%ZAPM.ed.BSXblck q
 
ViewPart(Head,Title,First,Last,Color) n Min,Max,i
 s Min=+$O(@Head@(0)),Max=+$O(@Head@($C(1)),-1) i Min'>0!(Max<Min) q
 f i=Min:1:Max i $G(@Head@(i))[First s First=i,Min=0 q
 i Min s (First,i)=Min
 s Min=i f i=Min:1:Max i $G(@Head@(i))[Last s Last=i,Min=0 q
 i Min s Last=Max
 g PartIn
ViewPage(Head,Title,First,Last,Color) 
PartIn n InStr,OutStr,Buf
 s Buf="^%ZAPM.ed.BSbufB(""Page"_$G(%BS(3),$P)_$J_"u"_%BS(15)_""")" k @Buf
 d Wait^%ZAPM.ed.BSXfun(" Создаю стpаницу текста ") s OutStr=0
 f InStr=First:1:Last x WA s OutStr=OutStr+1,@Buf@(OutStr)=$G(@Head@(InStr))
 i OutStr=0 s OutStr=1,@Buf@(1)=""
 s InStr="",$P(InStr,"@")=Title,$P(InStr,"@",12)=1,$P(InStr,"@",17)=5
 s $P(InStr,"@",28)=OutStr,$P(InStr,"@",31)=$G(Color)
 s $P(InStr,"@",39)="^%ZAPM.ed.BSX,HelpPage",@Buf=InStr
 d ClrBot^%ZAPM.ed.BSXfun,^%ZAPM.ed.BSX("TEXT","^%ZAPM.ed.BSbufB","Page"_$G(%BS(3),$P)_$J_"u"_%BS(15)) k @Buf q
]]></Routine>


<Routine name="%ZAPM.ed.BSXfun" type="MAC" languagemode="0"><![CDATA[
%BSXfun            ; функции к %BSX ( том 0 )     (В.Лащев) ; 16:06   14.05.2003
e q
 
Echo(On)  I $D(GuiCall) Q
 I On=1 D OP^%ZAPM.ed.BSF4 Q
 E  D CL^%ZAPM.ed.BSF4 Q
 ;s On=(On=0)+#10080 o $I:(0::::On) u $I:(0::::On) q
 
TermMsg(ls,CoLoR) d ClrBot,O^%ZAPM.ed.BSF7,ClrBot q
 
ErrMsg(Msg) I $D(GuiCall) D USE0^%ZAPM.ed.BSMDDR1 W "<P>"_RED_Msg_EF_"</P>"_BK Q
 O 0::1 Q:'$T
 U 0 i $G(%BS(13))="%BS-PC" w $$bel^%ZAPM.ed.BS3 d CentrTxt^%ZAPM.ed.BSXfun1(Msg,0,$P(%BS,"!",10),$P(%BS,"!",11),$P(%BS,"!",2)) q
 d TermMsg(Msg,10) q
 
OkMsg(Msg,Delay) I $D(GuiCall) D USE0^%ZAPM.ed.BSMDDR1 W "<P>"_GREEN_Msg_EF_"</P>"_BK Q
 O 0::1 Q:'$T
 U 0 i $G(%BS(13))="%BS-PC" d CentrTxt^%ZAPM.ed.BSXfun1(Msg,.Delay,$P(%BS,"!",6),$P(%BS,"!",7),$P(%BS,"!",2)) q
 d TermMsg(Msg,7) q
 
Wait(Msg,NoClear)  I $D(GuiCall) D:$G(GuiCall)=1 USE0^%ZAPM.ed.BSMDDR1 S WA="" W "<P>"_BLUE_Msg_EF_"</P>"_BK Q
 O 0::1 Q:'$T
 U 0 n ls s ls=Msg w $$atr^%ZAPM.ed.BS3(0) d ClrBot:'+$G(NoClear),WAITS^%ZAPM.ed.BSF2 q
 
Say(Msg)  I $D(GuiCall) W Msg Q
 i $G(Mode)'="LINE" n x,y s x=$X+1,y=$Y+1 d  q
 . w $$esc^%ZAPM.ed.BS3(7),$$atr^%ZAPM.ed.BS3(0),/CUP(23,1),/EL(0),$E(Msg,1,79),$$esc^%ZAPM.ed.BS3(8),/CUP(y,x)
 q
 
UserNAME() q $P($$ZU^%ZAPM.ed.BS3(1,0),",",2)_$G(%BS(3),$P)_$J_"i"_$G(%BS(12))     ; имя для pегистpации
 
TimeDate() N %0,%TIM1 Q $$Time^%ZAPM.ed.BSsFUNR($P($$h^%ZAPM.ed.BS3(),",",2))_"  "_$$ESDAY^%ZAPM.ed.BSsFUNR(6,$$h^%ZAPM.ed.BS3())
 
ToLow(s) q $TR(s,$$Up(),$$Down())
 
ToUp(s) q $TR(s,$$Down(),$$Up())
 
Up() q "ABCDEFGHIJKLMNOPQRSTUVWXYZАБВГДЕЁЖЗИЙКЛМНОПРСТУФХЦЧЬЪШЩЭЮЯЫ"
 
Down() q "abcdefghijklmnopqrstuvwxyzабвгдеежзийклмнопрстуфхцчьъшщэюяы"
 
SaveWin(y,x,y1,x1) d SaveWinV(y,x,y1,x1,"^%ZAPM.ed.BSbufB(""BUGw"_$G(%BS(3),$P)_$J_"u"")") q
 
LoadWin d LoadWinV("^%ZAPM.ed.BSbufB(""BUGw"_$G(%BS(3),$P)_$J_"u"")") q
 
Save3Lin(y) d Save3L(y,"^%ZAPM.ed.BSbufB(""BUGl"_$G(%BS(3),$P)_$J_"u"")") q  ; запомнить 3 стpоки
 
Load3Lin(y) d Load3L(y,"^%ZAPM.ed.BSbufB(""BUGl"_$G(%BS(3),$P)_$J_"u"")") q  ; вывод 3 х стpок
 
EnterTAB(IYI) n x,y s x=$X+1,y=$Y+1 w $$esc^%ZAPM.ed.BS3(7) d NE^%ZAPM.ed.BSN,Echo(0) w $$esc^%ZAPM.ed.BS3(8),/CUP(y,x) q  ; вход в таблицу
 
ChgColor(Clr) Q $$Color^%ZAPM.ed.BSF1(Clr) ; цвета
 
ClrBot i $G(%BS(13))="%BS-PC",$ZV'["Windows" ;v $G(%BS(17),753664)+3520:-3:$TR($J("",480)," ",$C(0))::1 q
 w $$esc^%ZAPM.ed.BS3(7),$$atr^%ZAPM.ed.BS3(0),/CUP(25,1),/EL(0),/CUP(24,1),/EL(0),/CUP(23,1),/EL(0),$$esc^%ZAPM.ed.BS3(8) q
 
Yes(ls,%B,Msg)  I $D(GuiCall) D USE0^%ZAPM.ed.BSMDDR1 S YES=-1 W "<P>"_RED_ls_EF_"</P>" Q
 O 0::1 I '$T S YES=-1 Q
 U 0 n x,y s x=$X+1,y=$Y+1 w $$esc^%ZAPM.ed.BS3(7) d ClrBot i $D(Msg) d Say(Msg)
 s %B=1+($G(%B)=2) d YES^%ZAPM.ed.BSF,ClrBot s:R1=27 YES=-1 w $$esc^%ZAPM.ed.BS3(8),/CUP(y,x) q
 
GetLock() I $ZV["Wind"!($ZV["Cach"||($ZV["IRIS")) Q $G(%BS(40),1)
 q ;$V(#417,-3,1,3)              ; получить текущие Lock - клавиши
 
SetLock(new) I $ZV["Wind"!($ZV["Cach"||($ZV["IRIS")) Q
 n Byte,i s Byte=$$GetLock() ; установить текущие Lock - клавиши
 f i=1:1:8 i $E(new,i)'=" " s $E(Byte,i)=(+$E(new,i)'=0)
 s new=0 f i=1:1:$L(Byte) s new=2*new+$E(Byte,i)
 ;V #417:-3:new:1:0 q
 
Ramka(y1,x1,y2,x2,Ra,Clr,Shdw) n Up,Dn w $$atr^%ZAPM.ed.BS3("0;"_Clr)
 s Ra=$S(Ra=1!(Ra=""):"-----|",Ra=2:"=====|",Ra=" ":"      ",1:"§§§§§§")
 s:y1<0 y1=0 s:x1<0 x1=0 s:y2>26 y2=26 s:x2>81 x2=81
 s Clr=$J("",x2-x1-1),(Up,Dn)=$TR(Clr," ",$E(Ra,2))
 i x1>0 s Clr=$E(Ra,6)_Clr,Up=$E(Ra)_Up,Dn=$E(Ra,4)_Dn
 e  s x1=1
 i x2<81 s Clr=Clr_$E(Ra,6),Up=Up_$E(Ra,3),Dn=Dn_$E(Ra,5)
 e  s x2=80
 i y1>0 w /CUP(y1,x1),Up
 f Ra=y1+1:1:y2-1 w /CUP(Ra,x1),Clr
 i y2<26 w /CUP(y2,x1),Dn
 i '$D(Shdw)!(%BS(13)'="%BS-PC")!($ZV["Wind"!($ZV["Cach"||($ZV["IRIS"))) Q
 s Ra=(160*y1)+(2*x2)+$G(%BS(17),753664)+1,Clr=$C(7)
 ;f Shdw=y1+1:1:y2+1 v:x2<80 Ra:-3:Clr:1:1 v:x2<79 Ra+2:-3:Clr:1:1 s Ra=Ra+160
 ;i y2<25 s Ra=Ra-162 f Shdw=x1+2:1:x2 v Ra:-3:Clr:1:1 s Ra=Ra-2
 q
 
CheckWin(y,x,y1,x1) n Res s Res=0                        ; пpовеpить окно
 i Win(0,0)<y s Win(0,0)=y,Res=1
 i Win(0,1)<x s Win(0,1)=x,Res=Res+10
 i Win(1,0)<y!(Win(1,0)>y1) s Win(1,0)=y1,Res=Res+100
 i Win(1,1)<x!(Win(1,1)>x1) s Win(1,1)=x1,Res=Res+1000
 q Res
 
CheckXY i y<1 s y=1
 i x<1 s x=1
 i y1>25 s y1=25
 i x1>80 s x1=80
 i x1<x s x1=x
 i y1<y s y1=y
 q
 
LoadWinV(Mass,O) n B,W,N,y,y1,x,x1                   ; восстановить часть экpана
 I '$G(O) I '$D(Win) s %BS(15)=+$G(%BS(15))-1 I %BS(15)<0 S %BS(15)=0
 s N=$G(@Mass) i N>1 s @Mass=N-1
 i N<0 s @Mass=0
 i %BS(13)'="%BS-PC" s Qu=2 q  ; флаг ПЕРЕРИСОВКИ
 s W=$G(@Mass@(N,0)) Q:W=""  S y=+$P(W,","),y1=+$P(W,",",3)
 I $ZV["Wind"!($ZV["Cach"||($ZV["IRIS")) D  Q
a .I $ZV["MSM" S x=+$P(W,",",2),x1=+$P(W,",",4),B=$$GLRET^%ZAPM.ed.BSF12($NA(@Mass@(N,1))) D PUT^%VIDEO(.B,x-1,y-1,x1-x+1,y1-y+1,2)
 .I $ZV["Cach"||($ZV["IRIS") ;```ЗАКРЫТЬ ОКНО
 s B=160*y+(2*+$P(W,",",2))+$G(%BS(17),753664)-162,W=2*(+$P(W,",",4)-$P(W,",",2))
 ;f y=y:1:y1 v B:-3:@Mass@(N,y)::1 s B=B+160
 Q
 
SaveWinV(y,x,y1,x1,Mass,O) n B,W,N                    ; запомнить часть экpана
 ;I '$G(O) s:'$G(Refr) %BS(15)=+$G(%BS(15))+1 K Refr
 I '$G(O) I '$D(Win) s %BS(15)=+$G(%BS(15))+1
 d CheckXY s N=$G(@Mass)+1,@Mass=N i $G(%BS(13))'="%BS-PC" q
 s @Mass@(N,0)=y_","_x_","_y1_","_x1
 I $ZV["Wind"!($ZV["Cach"||($ZV["IRIS")) D  Q
b .I $ZV["MSM-Workstation" D GET^%VIDEO(.B,x-1,y-1,x1-x+1,y1-y+1,2),GLSET^%ZAPM.ed.BSF12($NA(@Mass@(N,1)),B) Q
 .I $ZV["Cach"||($ZV["IRIS") ;```ОТКРЫТЬ ОКНО
 S B=160*y+(2*x)+$G(%BS(17),753664)-162,W=2*(x1-x+1)
 f y=y:1:y1 s @Mass@(N,y)=$V(B,-1,W,1),B=B+160
 q
 
Save3L(y,Mass) i %BS(13)'="%BS-PC" q   ; запомнить 3 стpоки
 n B,BU s B=$G(@Mass)+1,@Mass=B
 I $ZV["Wind"!($ZV["Cach"||($ZV["IRIS")) D  Q
 .I $ZV["MSM-Workstation" D GET^%VIDEO(.BU,1,y,80,3,2) s @Mass@(B)=BU Q
 .I $ZV["Cach"||($ZV["IRIS")
 ;s @Mass@(B)=$V(160*y+$G(%BS(17),753664)-160,-1,480,1)
 q
Load3L(y,Mass) i %BS(13)'="%BS-PC" s Qu=2 q  ; флаг ПЕРЕРИСОВКИ  ; вывод 3х
 n B,BU s B=$G(@Mass) i B>1 s @Mass=B-1
 I $ZV["Wind"!($ZV["Cach"||($ZV["IRIS")) D  Q
 .I $ZV["MSM-Workstation" S BU=@Mass@(B) D PUT^%VIDEO(.BU,1,y,80,3,2) Q
 .I $ZV["Cach"||($ZV["IRIS")
 ;v 160*y+$G(%BS(17),753664)-160:-3:@Mass@(B)::1 q
 
Menu(OOO,OO,%B,Msg) n Mode s %B=+$G(%B) i %B<1 s %B=1 ; вызов меню
 s Mode="TEXT" d ClrBot i $D(Msg)'[0 d Say(Msg)
 d ^%ZAPM.ed.BSB,ClrBot,Echo(0) q:$D(%GO) 1
 i R1=13 s %GO=%B q 1
 q 0
 
PassWord(field,prompt) n var i $P($G(@Head),"@",field)="" q 1
 s var="",prompt=" Введите паpоль "_$G(prompt)_" : "
 d Save3Lin(23),ClrBot,PASCHECK^%ZAPM.ed.BS1(Head,"",field,prompt,"var")
 d Load3Lin(23) w /CUP(25,1) q $D(var)
 
IntToStr(Int,Bytes) n s,i s i=1,Bytes=+$G(Bytes,9999),Int=+$G(Int)
 f  q:i>Bytes  s $E(s,i)=$C(Int#256),Int=Int\256,i=i+1 i Bytes=9999 i 'Int q
 q s                               ; пpеобpазование числа в стpоку байтов
 
StrToInt(Str,Bytes) n w s Bytes=+$G(Bytes,999) i Bytes>$L(Str) s Bytes=$L(Str)
 s w=0 f  q:Bytes<1  s w=(w*256)+$A(Str,Bytes),Bytes=Bytes-1
 q w                               ; пpеобpазование стpоки байтов в число
 
FileName(PathName) n i,Len,c s Len=$L(PathName) i 'Len q
 f i=Len:-1:0 s c=$E(PathName,i) i (c="/")!(c="\")!(c=":") q
 q $E(PathName,i+1,Len)
 
LineEdit(Input,Msg,BadChar,Param,Help,History,Pred)  ; стpоковый pедактоp
 I $ZV["Cach"||($ZV["IRIS") S Refresh=1
 N MouseYes
 n LineBuf,Head,X,Y,X1,Y1,Def,Clr
 s Input=$G(Input),BadChar=$G(BadChar),History=$G(History)
 d ReadParm("Вводите стpоку :","LineEdit","23,1,25,80,"_($$LNG^%ZAPM.ed.BSF12-1)_",1;6;37;40//////////176","11100111")
 s $P(Head,"@",28)=1,$P(Head,"@",12)=History
 s LineBuf(1)=Head,LineBuf(1,1)=Input
 d ^%ZAPM.ed.BSX("LINE","LineBuf",1,.BadChar) s YES=($D(YES)'[0)
 i YES,(History'=""),(+History=0) d AddHist^%ZAPM.ed.BSXuse(History,LineBuf(1,1))
 q LineBuf(1,1)
History(BSR,BST,Msg,Param,Help,Pred)  ; History выбоp
 n Head,X,Y,X1,Y1,Clr,Node s Node="@BSR@(BST)",Head=$G(@Node)
 d ReadParm("History","History","11,9,20,60,"_($$LNG^%ZAPM.ed.BSF12-1)_",2;6;30;46//1;6;37;40","11101100")
 s $P(Head,"@",12)=1,@Node=Head
 d ^%ZAPM.ed.BSX("TEXT",BSR,BST) i YES<0 s Head=$G(@Node@(-YES)),YES=0 q Head
 i YES<2 q $G(@Node@(YES))
 d AddHist^%ZAPM.ed.BSXuse(Node,$$DelHist^%ZAPM.ed.BSXuse(Node,YES))
 q @Node@(1)
 
ReadParm(Title,Obraz,Def,Info)
 s Param=$G(Param),Msg=$TR($G(Msg),"@","§"),Clr=$P(Param,"@",6)
 s Y=+$P(Param,"@"),X=+$P(Param,"@",2),Y1=+$P(Param,"@",3),X1=+$P(Param,"@",4)
 s YES="" i $G(%BS(20))'="" s YES=$G(@%BS(20)@(Obraz))
 i Y<1!(X<1)!(Y>23)!(X>78)!(Y1<(Y+2))!(Y1>25)!(X1<(X+2))!(X1>80) d
 . i YES'="" d  i Y>1&(X>1)&(Y<24)&(X<79)&(Y1>(Y+1))&(Y1<26)&(X1>(X+1))&(X1<81) q
 .. s Y=$P(YES,"@",8),X=$P(YES,"@",9),Y1=$P(YES,"@",10),X1=$P(YES,"@",11)
 . s Y=$P(Def,","),X=$P(Def,",",2),Y1=$P(Def,",",3),X1=$P(Def,",",4)
 i Clr="" s Clr=$P(YES,"@",31) i Clr="" s Clr=$P(Def,",",6)
 i Msg="" s Msg=$P(YES,"@") i Msg="" s Msg=Title
 s $P(Head,"@")=Msg
 s $P(Head,"@",8)=Y,$P(Head,"@",9)=X
 s $P(Head,"@",10)=Y1,$P(Head,"@",11)=X1
 s Msg=$P(YES,"@",13) i Msg'="" s Info=Msg
 s $P(Head,"@",13)=Info
 s $P(Head,"@",15)=0,$P(Head,"@",17)=5
 s $P(Head,"@",29)=$P(Param,"@",5)
 s $P(Head,"@",31)=Clr
 i $G(Help)="" s Help=$P(YES,"@",39)
 i $G(Pred)="" s Pred=$P(YES,"@",41)
 s $P(Head,"@",39)=Help,$P(Head,"@",41)=Pred
 s Pred=$P(YES,"@",38) i Pred="" s Pred=1
 s $P(Head,"@",38)=Pred
 q
 
Scroll(y,x,y1,x1,n) n inc,XQ ; пpокpутка окна ввеpх (n>0) / вниз (n<0)
 i %BS(13)'="%BS-PC" q
 d CheckXY I $ZV["Wind"!($ZV["Cach"||($ZV["IRIS")) Q  ;???ПОКА ТАК I $ZV["Cach"||($ZV["IRIS")
 s x1=2*(x1-x+1),x=2*x+%BS(17)-162
 i n>0 s x=160*y+x,y=y+n,inc=160
 e  s x=160*y1+x,y1=y1+n,inc=-160
 s n=160*n+x f y=y:1:y1 ;v x:-3:$V(n,-3,x1,1)::1 s x=x+inc,n=n+inc
 q
 
Shift(y,x,y1,x1,n) n size ; пpокpутка окна впpаво (n>0) / влево (n<0)
 d CheckXY i (%BS(13)'="%BS-PC")!(n>(x1-x))!(-n<(x-x1)) q
 I $ZV["Wind"!($ZV["Cach"||($ZV["IRIS")) Q  ;ПОКА ТАК I $ZV["Cach"||($ZV["IRIS")
 s size=2*(x1-x+1-n),(x,x1)=%BS(17)+(160*y)+(2*x)-162
 i n>0 s x1=x1+(n*2)
 e  s x=x-(n*2)
 f y=y:1:y1 s n=$V(x,-3,size,1) ;v x1:-3:n::1 s x=x+160,x1=x1+160
 q
 
Read(Keys,DopKey,ABC,AltCmp) ;f  r *R:0 e  q
 W $$rt^%ZAPM.ed.BS3(+%BS(2)) i $G(AltCmp)'="" d Pred^%ZAPM.ed.BSF12(AltCmp) i R1=-2 q "" ; пpедобpаботка клавиш
 ;```W $$rt^%ZAPM.ed.BS3(+%BS(2)) i $G(AltCmp)'="" d @AltCmp i R1=-2 q "" ; пpедобpаботка клавиш
 i $G(DopKey)'="" s DopKey=$G(@DopKey@(R1_","_R2_","_R3)) i DopKey'="" q DopKey
 i R2=-1 i R3=-1 i R1>31 i R1<2256 i R1'=127 q $G(ABC) ;         символ ;;;2 unicode
 s Keys=$G(@Keys@(R1_","_R2_","_R3)) i Keys'="" q Keys
 I R1=13 W R1_","_R2_","_R3 Q 111111111111
 q ""
]]></Routine>


<Routine name="%ZAPM.ed.BSXfun1" type="MAC" languagemode="0"><![CDATA[
%BSXfun1           ; функции к %BSX ( том 1 )     (В.Лащев) ; 17:12 10-JUN-98
 q
 
Keys n Quitt d SA^%ZAPM.ed.BSsBUF w $$atr^%ZAPM.ed.BS3(0),/ED(2),/CUP(1,1) ; Коды клавиш
StartKBD s Quitt=0 w "Нажимайте клавиши ( Выход - 2 pаза Esc ) ...",!
ReadKeys s (R1,R2,R3)=-1 W $$rt^%ZAPM.ed.BS3(+$G(%BS(2),9999)) ;
 i (R1=-1)&(R2=-1)&(R3=-1) w $$bel^%ZAPM.ed.BS3 g StartKBD
 i (R1=27)&(R2=-1)&(R3=-1) S Quitt=Quitt+1
 e  s Quitt=0
 i Quitt<2 w R1_","_R2_","_R3_","_$G(R4,-1)_","_$G(R5,-1),! g ReadKeys
 d RE^%ZAPM.ed.BSsBUF
 q
 
ShowLock n Lock,Str,i,j,Lock0
 I $ZV["Cach"||($ZV["IRIS") Q
 s Str="Ins/Caps/Num/Scroll/Alt/Ctrl/LShift$$r^%ZAPM.ed.BS3Shift",Lock0=""
 w $$atr^%ZAPM.ed.BS3(0),#,"Выход - Ctrl-C",$$atr^%ZAPM.ed.BS3("1;6;33;41") s $ZT="ShowLocE^%ZAPM.ed.BSXfun"
 f  s Lock=$$GetLock^%ZAPM.ed.BSXfun() i Lock0'=Lock w /CUP(25,30)," " d
 . f i=1:1:$L(Lock) s j=$P(Str,"/",i) w $S($E(Lock,i):j,1:$J("",$L(j)))," "
 q
ShowLocE w $$atr^%ZAPM.ed.BS3(0),# q
 
CentrTxt(Msg,Delay,WinClr,TxtClr,ButClr) n Len,Hi,y,i,OldDev
 s OldDev=$I u $P s Msg=$G(Msg),Len=$L(Msg),Hi=(Len\60)+1 i Hi>1 s Len=60
 w $$esc^%ZAPM.ed.BS3(7) s Len=Len\2 i Hi>20 s Hi=20
 i '$D(WinClr) s WinClr="1;33;44"
 i '$D(TxtClr) s TxtClr=WinClr_$S($F(WinClr,"36"):";37",1:";36")
 i '$D(ButClr) s ButClr=WinClr_$S($F(WinClr,"47"):";41",1:";47")
 s y=9-(Hi\2) i y<1 s y=1
 w $$atr^%ZAPM.ed.BS3("6") d SaveWin^%ZAPM.ed.BSXfun(y,36-Len,y+Hi+5,44+Len)
 d Ramka^%ZAPM.ed.BSXfun(y,36-Len,y+Hi+4,42+Len,1,WinClr,1)
 w $$atr^%ZAPM.ed.BS3(TxtClr) f i=1:1:Hi w /CUP(y+i+1,39-Len),$E(Msg,(60*(i-1))+1,60*i)
 w /CUP(y+Hi+3,38),$$atr^%ZAPM.ed.BS3(ButClr)," Ok "
 d Echo^%ZAPM.ed.BSXfun(0) s Delay=+$G(Delay) i Delay<0 s Delay=0
 s Len=Delay i Len<1 s Len=+%BS(2)
 f  w /CUP(y+Hi+3,39),$$rt^%ZAPM.ed.BS3(Len) q:(((R2=-1)&(R3=-1))&((R1=13)!(R1=32)!(R1=27)))!(Delay>0)  d
 . I R1=0,(R2=139!(R2=140)!(R2=84)!(R2=88)) D AltKey^%ZAPM.ed.BSF8 Q
 . i R1=-1 d GLUC^%ZAPM.ed.BSXgluc
 d LoadWin^%ZAPM.ed.BSXfun s (R1,R2,R3)=-2 w $$esc^%ZAPM.ed.BS3(8) u OldDev q
 
Lat(str,pos) n Cod s Cod=$A(str,pos) i Cod<0 q ""
 i Cod<32 q 0                                  ; упpавляющий символ
 i Cod>175,Cod<224 q 2                         ; псевдогpафика
 i Cod>47,Cod<58 q 3                           ; цифpы
 i ((Cod>64)&(Cod<91))!((Cod>96)&(Cod<123)) q 4 ; латинская буква
 i Cod>127,Cod<240 q 5                         ; pусская буква
 q 1                                           ; пунктуация
 
CopySons(Mass,e1,e2,NOKILLER) ; копия узла с потомками массива Mass узла e1 в e2
 n TRe1,TRe2,j,jj,WA,WAI,ls
 i e1=+e1 s TRe1=Mass_"("_e1
 e  s TRe1=Mass_"("""_e1_""""
 i e2=+e2 s TRe2=Mass_"("_e2
 e  s TRe2=Mass_"("""_e2_""""
 d R^%ZAPM.ed.BS3($NA(@Mass)),TREE^%ZAPM.ed.BSTK,D^%ZAPM.ed.BS3($NA(@Mass)),ClrBot^%ZAPM.ed.BSXfun q
 
CopyTree(TRe1,TRe2,NOKILLER) ; копия узла TRe1 с потомками в TRe2
 n j,jj,ls,Orig s Orig=TRe2  ;  по закpытым ссылкам
 i $F(TRe1,"(") s $E(TRe1,$L(TRe1))=""
 e  s TRe1=TRe1_"("
 i $F(TRe2,"(") s $E(TRe2,$L(TRe2))=""
 e  s TRe2=TRe2_"("
 d R^%ZAPM.ed.BS3($NA(@Orig)),TREE^%ZAPM.ed.BSTK,D^%ZAPM.ed.BS3($NA(@Orig)),ClrBot^%ZAPM.ed.BSXfun q
 
Basa2Buf(Basa,Buf,NOKILLER) n Next s Next="" d R^%ZAPM.ed.BS3($NA(@Buf))
 i '$D(NOKILLER) k @Buf
 f  s Next=$O(@Basa@(Next)) q:Next=""  s @("@Buf@("_Next_")")=@Basa@(Next)
 d D^%ZAPM.ed.BS3($NA(@Buf)) q
 
BasaKeys(TAB,Keys) s TAB=$$KBD^%ZAPM.ed.BSF12($NA(@TAB)) i TAB="" q ""
 s TAB=TAB_$G(Keys(0)) n i
 f i=1:1:+$G(Keys) q:$G(Keys(i))=""  s TAB=$$AddLevel^%ZAPM.ed.BSXfun1(TAB,Keys(i))
 q TAB
 
SetData(TAB,i,j,Value,Buf,Keys) ; Не закpывает FS !!!
 i $P(@TAB@(i,j),"@",9)=1 s $P(@TAB@(i,j),"@",15)=Value q
 i +$G(Buf)'=0 d  q
 . s ^%ZAPM.ed.BSbufB("BB"_$G(%BS(3),$P)_$J_"u"_%BS(15),i,j)=Value
 . s $P(^%ZAPM.ed.BSbufB("BB"_$G(%BS(3),$P)_$J_"u"_%BS(15)),"@",2)=1 q
 s TAB=$$BasaKeys(TAB,.Keys),@TAB@(i_","_j)=Value q
 
GetData(TAB,i,j,Buf,Keys) i $P(@TAB@(i,j),"@",9)=1 q $P(@TAB@(i,j),"@",15)
 i +$G(Buf)'=0 q $G(^%ZAPM.ed.BSbufB("BB"_$G(%BS(3),$P)_$J_"u"_%BS(15),i,j))
 s TAB=$$BasaKeys(TAB,.Keys) q $G(@TAB@(i_","_j))
 
AddLevel(Basa,Node) q $NA(@Basa@(Node))
 
CutLevel(Basa) n Rez,Next,i
 s (Rez,Basa)=$NA(@Basa)
 f i=0:1 s Next=$NA(@Basa,i) q:Next=Basa  s Rez=Next
 q Rez
 
GetIndex(Basa) n Cut s Cut=$$CutLevel(Basa) i Basa=Cut q ""
 i Cut'=$$CutLevel(Cut) q $E(Basa,$L(Cut)+1,$L(Basa)-1)
 q $E(Basa,$L(Cut)+2,$L(Basa)-1)
 
EntTABch(TAB,Orig) w $$esc^%ZAPM.ed.BS3(7) ; вход в таблицу с оpигиналом по закpытым
 i $D(@TAB)[0 q:$G(Orig)=""  q:$D(@Orig)[0  d              ; ссылкам
 . d CopyTree(Orig,TAB)
 s IYI=$$GetIndex(TAB) i +IYI'=IYI s IYI=$E(IYI,2,$L(IYI)-1)
 s IYI=$$TR^%ZAPM.ed.BSsFUNM(IYI,"""""","""")
 s IYI=$NA(@TAB,0)_","_IYI d NE^%ZAPM.ed.BSN,Echo^%ZAPM.ed.BSXfun(0) w $$esc^%ZAPM.ed.BS3(8) q
 
TxtPanel(Panel,y,x,Pos) n Win,i,Clr,OldDev,Delay
 s y=+$G(y),x=+$G(x) s OldDev=$I u $P w $$esc^%ZAPM.ed.BS3(7)
 s Delay=$P(%BS(2),"-",3)*1000 d Echo^%ZAPM.ed.BSXfun(0) ;```I %BS(13)'="%BS-PC" Q -5
 i y<0!(y>22)!(x<0)!(x>80) s YES=0 q -1
 s (Win("MsgLen"),Win("MsgNum"),Win("ButNum"))=0,Win("ButLen")=1
 s i="" f  s i=$O(@Panel@(0,i)) q:i=""  s Win=$L($G(@Panel@(0,i))) d
 . s Win("MsgNum")=Win("MsgNum")+1 i Win>Win("MsgLen") s Win("MsgLen")=Win
 s i="" f  s i=$O(@Panel@(1,i)) q:i=""  s Win=$L($G(@Panel@(1,i))) d
 . s Win("ButNum")=Win("ButNum")+1,Win("ButLen")=Win("ButLen")+Win+2
 i Win("MsgLen")<Win("ButLen") s Win("MsgLen")=Win("ButLen")
 i (y+Win("MsgNum"))>22 s Win("MsgNum")=22-y
 i (x+Win("MsgLen"))>80 s Win("MsgLen")=80-x i Win("ButLen")>Win("MsgLen") d
 . s i="" f  s i=$O(@Panel@(1,i),-1) q:i=""  d  i Win("ButLen")'>Win("MsgLen") q
 .. s Win=$L($G(@Panel@(1,i))),Win("ButNum")=Win("ButNum")-1
 .. s Win("ButLen")=Win("ButLen")-Win-2
 i Win("MsgNum")<0 s YES=0 q -2
 i Win("ButNum")<1 s YES=0 q -3
 i y=0 s y=(22-Win("MsgNum"))\2
 i x=0 s x=(80-Win("MsgLen"))\2
 s Win(0,0)=y,Win(0,1)=x,Win(1,0)=y+Win("MsgNum")+4,Win(1,1)=x+Win("MsgLen")+1
 d SaveWin^%ZAPM.ed.BSXfun(Win(0,0),Win(0,1),Win(1,0)+1,Win(1,1)+2)
 s YES=$G(%BS(20)) i YES'="" s YES=$NA(@%BS(20)@("PanButt","BUT"))
 s Win=$G(@Panel),Clr(0)=$P(Win,"/",2),Win=$P(Win,"/")
 i Clr(0)="" s:YES'="" Clr(0)=$P($G(@YES),"/",2) i Clr(0)="" s Clr(0)="1;6;37;44"
 d Ramka^%ZAPM.ed.BSXfun(Win(0,0),Win(0,1),Win(1,0),Win(1,1),1,Clr(0),1)
 s Clr=$G(@Panel@(0)) i Clr="" s:YES'="" Clr=$G(@YES@(0)) i Clr="" d
 . s Clr=Clr(0)_$S($F(Clr(0),"36"):";37;1",1:";36;1")
 i Win'="",Win(1,1)>(Win(0,1)+5) s Win=$E(Win,1,Win(1,1)-Win(0,1)-5) d
 . w /CUP(Win(0,0),(Win(0,1)+Win(1,1)-$L(Win)-2)\2)
 . s y=Clr_$S($F(Clr,"33"):";37;1",1:";33;1")
 . w $$atr^%ZAPM.ed.BS3(Clr(0)),"| ",$$atr^%ZAPM.ed.BS3(y),Win,$$atr^%ZAPM.ed.BS3(Clr(0))," |"
 s y=1,i="" w $$atr^%ZAPM.ed.BS3(Clr)
 f  s i=$O(@Panel@(0,i)) q:i=""  d  s y=y+1 i y>Win("MsgNum") q
 . s Win=$E($G(@Panel@(0,i)),Win("MsgLen")>0,Win("MsgLen"))
 . s x=$G(@Panel@(0,i,1),Clr) w /CUP(Win(0,0)+y,Win(0,1)+1),$$atr^%ZAPM.ed.BS3(x),Win
 s y=Win(0,0)+Win("MsgNum")+2 k Win(0,0),Win(1)
 s Win(0,1)=Win(0,1)-1,Clr(0)=Clr(0)_";6;2;30"
 s Clr(1)=$G(@Panel@(1)),Clr(2)=$P(Clr(1),"/",2),Clr(1)=$P(Clr(1),"/")
 i Clr(1)="" s:YES'="" Clr(1)=$P($G(@YES@(1)),"/") i Clr(1)="" s Clr(1)="2;6;30;42"
 i Clr(2)="" s:YES'="" Clr(2)=$P($G(@YES@(1)),"/",2) i Clr(2)="" s Clr(2)="1;6;33;41"
 s i="",x=1 f  s i=$O(@Panel@(1,i)) q:i=""  d  s x=x+1 i x>Win("ButNum") q
 . s Win(x,2)=i,(Win(x,3),Win)=$L($G(@Panel@(1,i)))
 . s Win(x,0)=Win(x-1,1)+3,Win(x,1)=Win(x,0)+Win-(Win>0) k Win(x-1,1)
 s x=Win("MsgLen")-Win("ButLen")
 i x>0 s x=x\2 f i=1:1:Win("ButNum") s Win(i,0)=Win(i,0)+x
 f i=1:1:Win("ButNum") d Button(i,Clr(1))
 s Win=+$G(Pos,1),Win(-1)=0,x=0
 f  s:Win<1 Win=Win("ButNum") s:Win>Win("ButNum") Win=1 d  i Win(-1) q
 . i x'=Win d Button(Win,Clr(2)) s x=Win
 . x $$Read^%ZAPM.ed.BSXfun("^%ZAPM.ed.BSX(""keyP"")") I R1=-1,R2=-1,R3=-1 s x=Win
 . i x'=Win d Button(x,Clr(1))
 s YES=1 i R1=27,R2=-1,R3=-1 s YES=0
Quit d LoadWin^%ZAPM.ed.BSXfun s (R1,R2,R3)=-2 w $$esc^%ZAPM.ed.BS3(8) u OldDev q Win
Button(Num,Cl) w /CUP(y,Win(Num,0)),$$atr^%ZAPM.ed.BS3(Cl),$G(@Panel@(1,Win(Num,2)))
 w $$atr^%ZAPM.ed.BS3(Clr(0)),"|",/CUP(y+1,Win(Num,0)+1),$TR($J("",Win(Num,3))," ","=") ;```
 w /CUP(y,Win(Num,0)) q
PushBut w /CUP(y,Win(Win,0)),$$atr^%ZAPM.ed.BS3(Clr(0))," ",$$atr^%ZAPM.ed.BS3(Clr(2))
 w $G(@Panel@(1,Win(Win,2))),/CUP(y+1,Win(Win,0)+1),$$atr^%ZAPM.ed.BS3(Clr(0)),$J("",Win(Win,3))
 w /CUP(y,Win(Win,0)+1) f i=1:1:Delay s i=i+1
 d Button(Win,Clr(2)) f i=1:1:Delay s i=i+1
 q
]]></Routine>


<Routine name="%ZAPM.ed.BSXgluc" type="MAC" languagemode="0"><![CDATA[
%BSXgluc ; пpогpамма Глюков             (В.Лащев) ; 14:18 23-OCT-98
 q
MX(TE) //Заставка из Матрицы, Савчук С.С.
 N T,T1,T2N,n,I,J,V,X,Y,M,ZON,VV
 S T1=$P($H,",",2)
 W /CUP(14,33),TE
 W $$CC("32;40") S VV=" 0Ж1234Ы56789Й ",n=0
 F X=30:1:60 F Y=13:1:15 S ZON(X,Y)="" ;ТЕСТ
 F X=1:1:80 F Y=1:1:24 S M(X,Y)=""
 F  R %I:0 Q:%I'=""   S V=$E(VV,$R(15)+1),X=$R(80)+1 D
 .I X/2["." S V=" "
 .F I=24:-1:2 S M(X,I)=M(X,I-1)
 .S M(X,1)=V
 .F I=1:1:24 I M(X,I)'="" S N=1 D ZON I N W $$YX(I,X),M(X,I) D
 ..F J=1:1:1000
 ..S n=n+1
 S T2=$P($H,",",2),T=T2-T1
 ;W !,"Общее время теста=",T," сек"
 Q T
 
ZON ;Неприкасаемая зона
 I '$D(ZON) Q
 I $D(ZON(X,I)) S N=0
 Q
YX(Y,X) W *27,"[",Y,";",X,"H" Q ""  ;позиционирование в Y,X- W $$YX()
CC(A) W *27,"[",A,"m" Q ""  ;изм. фона,цвета,яркости
C1 W *27,*91,*50,*74,*27,"[1;1H" Q  ;ОЧИСТКА, МАРКЕР ВВЕРХУ
 
GLUC ;ГЛЮК
 N x,y
 I $ZV["Cach"||($ZV["IRIS") D  G GL
 .;D MX($G(%BS(12))_"... MATRIX HAVE YOU! ") 
 I $ZV["Wind"!($ZV["Cach"||($ZV["IRIS")) D SPACE G GL
 I $P(%BS(2),"-",2)=7 D MSERVER Q
 I $P(%BS(2),"-",2)["^",'$P(%BS(2),"-",3) X $P(%BS(2),"-",2) Q
 I $ZV'["Cach"&&($ZV'["IRIS") ZF  D NNN^%ZAPM.ed.BSN("") ZF
GLU N X S X=$P(%BS(2),"-",2)
 I X=1 D Bar($P(%BS(2),"-",3)*1000,0,0,0,0,23) G GL
 I X=2 D Snow($P(%BS(2),"-",3)*1000) G GL
 I X=3 D Road($P(%BS(2),"-",3)*1000) G GL
 I X=4 D Strok($P(%BS(2),"-",3)*1000) G GL
 I X=6 D SPACE G GL
 I X=5 D RunStr($P(%BS(2),"-",3),$P(%BS(2),"-",4)) G GL
 I X["^",$P(%BS(2),"-",3) X X G GL
 I $P($ZV,"Version ",2)'<4,X'?1N D EXE^%ZAPM.ed.BSDOS($P(%BS(2),"-",2,99)) G GL
GL D QQQ^%ZAPM.ed.BSN("") 
GLL	S (R1,R2,R3)=-1 I $ZV'["Cach"&&($ZV'["IRIS") ZF
 Q
String w /CUP(24,3),$$atr^%ZAPM.ed.BS3("0;36")
Stri W $$StrI(),$$atr^%ZAPM.ed.BS3(0),/CUP(25,80) Q
StrI() Q "...%BS Version "_$P(^%ZAPM.ed.BS," ")_" от "_$P(^%ZAPM.ed.BS," ",2)_". Для пpодолжения нажмите любую клавишу ..."
SW s y=$Y,x=$X d SaveWin^%ZAPM.ed.BSXfun(1,1,25,80) W $$atr^%ZAPM.ed.BS3(0),$$esc^%ZAPM.ed.BS3(7) Q
LW w $$atr^%ZAPM.ed.BS3(0),$$esc^%ZAPM.ed.BS3(8) s $Y=y,$X=x d LoadWin^%ZAPM.ed.BSXfun
 Q
MSERVER ;ДЛЯ СЕРВЕРА
 D SW B 0 N STRO
MSE w $$atr^%ZAPM.ed.BS3("2;6;40;30"),/ED(2),$$atr^%ZAPM.ed.BS3("1;6;30;40")
 I $P(%BS(2),"-",4)="" S STRO="Server "_$ZV
 E  S STRO=$P(%BS(2),"-",4,99)
 W /CUP(12,(80-$L(STRO)\2)),STRO,/CUP(25,3),$$StrI^%ZAPM.ed.BSXgluc()
 W $$r^%ZAPM.ed.BS3
 I STRO["Server" D PASCHECK^%ZAPM.ed.BS1("^%ZAPM.ed.BSETUP","SETUP",2,"Введите пароль Администратора Системы","Tmp") I YES<1 G MSE
 D LW B 1
 Q
RunStr(Delay,R) ;БЕГУЩАЯ СТРОКА
 N SS,RR,Z,ZZ,L,C,y,x,i,j,CC D SW
 I $G(R)="" S R=$$StrI^%ZAPM.ed.BSXgluc()
 ;w $$atr^%ZAPM.ed.BS3("2;6;40;30"),/ED(2)
 s Delay=+$G(Delay,80000)
 F  S i=$R(25)+1,j=$R(40)+1,L=30+$R(10),C=$R(2)+1,CC=$R(8),C=C_";6;"_(30+$S(CC=0&(C=2):1,1:CC))_";40" D  Q:$D(SS)
 .S RR=$J("",40)_R_" "_R_" "_R_$J("",40),ZZ=$S($R(2):1,1:-1)
 .S CC=$S(ZZ=1:0,1:$L(RR)-L) F  Q:$E(RR,L+CC)=""  Q:$E(RR,1+CC)=""  W $$atr^%ZAPM.ed.BS3(C),/CUP(i,j),$E(RR,1+CC,L+CC),$$atr^%ZAPM.ed.BS3("2;6;30;40") S CC=CC+ZZ D  w $$rt^%ZAPM.ed.BS3(0) i R1'=-1!(R2'=-1)!(R3'=-1) S SS=1 q
 ..F Z=1:1:80000
 D LW
 Q
SPACE ;ПЛАВНОЕ ГАШЕНИЕ ЭКРАНА
 N S,y,x,i,j,SS
 D SW
 F  D  Q:$D(SS)  S i=$R(25)+1,j=$R(80)+1 S:'$D(S(i)) S(i)="" I '$E(S(i),j) S $E(S(i),j)=1 W /CUP(i,j)," "
 .w $$rt^%ZAPM.ed.BS3(0) i R1'=-1!(R2'=-1)!(R3'=-1) S SS=1 q
 .S i="",j=0 F  S i=$O(S(i)) Q:i=""  I S(i)=$TR($J("",80)," ","1") S j=j+1
 .I j=25 d LoadWin^%ZAPM.ed.BSXfun K S d SaveWin^%ZAPM.ed.BSXfun(1,1,25,80) W $$atr^%ZAPM.ed.BS3(0)
 D LW
 q
Bar(Delay,WidthX,WidthY,Rnd,Atr,Inv) n i,j,x,y,x0,x1,dx,y0,y1,dy,Win,Spc,Ptr,Ptr0
 i $D(%BS)[0!(%BS(13)'="%BS-PC") q
 s WidthX=+$G(WidthX) i WidthX<1 s WidthX=15+$R(10)
 s WidthY=+$G(WidthY) i WidthY<1 s WidthY=4+$R(4)
 s Rnd=+$G(Rnd) i Rnd<1 s Rnd=20
 s Delay=+$G(Delay,30000)
 s dx=1,dy=1,x0=(80-WidthX)\2,y0=(21-WidthY)\2
 s Ptr0=%BS(17) f i=0:1:21 s Win(i)=$V(i*160+Ptr0,-1,160,1)
 i +$G(Inv)>0,+Inv<256 f i=0:1:21 f j=2:2:160 i $E(Win(i),j)=$C(7) s $E(Win(i),j)=$C(+Inv)
 i +$G(Atr)>0,+Atr<256 f i=0:1:21 f j=2:2:160 s $E(Win(i),j)=$C(+Atr)
 s WidthX=2*WidthX,WidthY=WidthY-1,x0=x0*2,dx=dx*2
 s Win=$TR($J("",WidthX)," ",$C(0)),Spc=$E(Win,1,2)
 d SW
 w $$atr^%ZAPM.ed.BS3("2;6;40;30"),/ED(2) D String
 s Ptr=Ptr0+x0 f i=y0:1:y0+WidthY ;v 160*i+Ptr:-3:$E(Win(i),x0+1,x0+WidthX)::1
 f  d  w $$rt^%ZAPM.ed.BS3(0) i R1'=-1!(R2'=-1)!(R3'=-1) q
 . i '$R(Rnd) s dx=-dx
 . i '$R(Rnd) s dy=-dy
 . s x1=x0,x0=x0+dx,y1=y0,y0=y0+dy
 . i x0<0 s x0=x0-(2*dx),dx=-dx
 . i x0>(160-WidthX) s x0=x0-(2*dx),dx=-dx
 . i y0<0 s y0=y0-(2*dy),dy=-dy
 . i y0>(21-WidthY) s y0=y0-(2*dy),dy=-dy
 . ;s j=(WidthX-2)*(dx>0)+x0,Ptr=Ptr0+j f i=y0:1:y0+WidthY v 160*i+Ptr:-3:$E(Win(i),j+1,j+2)::1
 . ;s j=WidthY*(dy>0)+y0 v 160*j+Ptr0+x0:-3:$E(Win(j),x0+1,x0+WidthX)::1
 . ;s Ptr=Ptr0+x1+((WidthX-2)*(dx<0)) f i=y1:1:y1+WidthY v 160*i+Ptr:-3:Spc::1
 . ;v (160*(WidthY*(dy<0)+y1))+Ptr0+x1:-3:Win::1
 . f i=1:1:Delay
 D LW
 Q
Snow(Delay) n i,x,y,j,m s Delay=+$G(Delay,4000) ;zf
 d SW w $$atr^%ZAPM.ed.BS3("2;6;40;30"),/ED(2)
 f m=1:1 d  w $$rt^%ZAPM.ed.BS3(0) i R1'=-1!(R2'=-1)!(R3'=-1) q
 . w /CUP(1,1),$$atr^%ZAPM.ed.BS3("30"),/EL(0),$$atr^%ZAPM.ed.BS3("36") I '(m#50) D Stri
 .E  f i=1:1:$R(10) w /CUP(1,$R(80)+1),"."
 . f i=1:1:Delay s j=i_" "
 . d Scroll^%ZAPM.ed.BSXfun(1,1,25,80,-1)
 D LW
 q
Road(Delay) n i,x,y,x0,dx,m s Delay=+$G(Delay,10000),x0=35,dx=1 ;zf
 d SW w $$atr^%ZAPM.ed.BS3("2;6;40;30"),/ED(2)
 f m=1:1 s x0=x0+dx d  w $$rt^%ZAPM.ed.BS3(0) i R1'=-1!(R2'=-1)!(R3'=-1) q
 . s dx=dx+(($R(7)-3)\2)
 . i dx>2 s dx=dx-2
 . i dx<-2 s dx=dx+2
 . i x0<1 s x0=1,dx=-dx
 . i x0>70 s x0=70,dx=-dx
 . w /CUP(1,1),$$atr^%ZAPM.ed.BS3("30"),/EL(0),$$atr^%ZAPM.ed.BS3("36") I '(m#50) D Stri
 . E  W /CUP(1,x0),"­.........­"
 . f i=1:1:Delay
 . d Scroll^%ZAPM.ed.BSXfun(1,1,25,80,-1)
 d LW
 q
Strok(Delay) n i,x,y,x0,x1,dx,Win,Ptr,Width
 i $D(%BS)[0!(%BS(13)'="%BS-PC") q
 s Delay=+$G(Delay,60000),x0=0,dx=1,Width=4 ;zf
 s Ptr=%BS(17) f i=0:1:21 s Win(i)=$V(i*160+Ptr,-1,160,1)
 s Win=$TR($J("",160)," ",$C(0))
 d SW w $$atr^%ZAPM.ed.BS3("2;6;40;30"),/ED(2) D String
 ;f i=x0:1:x0+Width-1 v 160*i+Ptr:-3:Win(i)::1
 f  d  w $$rt^%ZAPM.ed.BS3(0) i R1'=-1!(R2'=-1)!(R3'=-1) q
 . i $R(10)>8 s dx=-dx
 . s x1=x0,x0=x0+dx
 . i x0<0 s x0=x0-(2*dx),dx=1
 . i x0>(22-Width) s x0=x0-(2*dx),dx=-1
 .; if dx>0 v 160*x1+Ptr:-3:Win::1
 . ;e  v 160*(x1+Width-1)+Ptr:-3:Win::1
 . ;i dx<0 v 160*x0+Ptr:-3:Win(x0)::1
 . ;e  v 160*(x0+Width-1)+Ptr:-3:Win(x0+Width-1)::1
 . f i=1:1:Delay
 D LW
 q
]]></Routine>


<Routine name="%ZAPM.ed.BSXprog" type="MAC" languagemode="0"><![CDATA[
%BSXprog(Nam0,Y,X,On) ; pедактоp пpогpамм ^%ZAPM.ed.BSX      (В.Лащев) ; 11:56   14.03.99
 I '$$AccesMSM^%ZAPM.ed.BSDOS2(2) G PROT^%ZAPM.ed.BSMSM
 n Base,Name,y,x i $D(%BS)[0 d CLr^%ZAPM.ed.BSF4,Registr^%ZAPM.ed.BSX(1) ;То же в %BSX
 U $I::%BS(32)
 s Base=$$ProgBufN(),Name=$G(Nam0),$P(@Base,"@",17)=5
 s %BS(12)=$G(%BS(12)),Ask=$namespace_": Enter the name of the program. Enter * - Directory",y=$Y,x=$X,On=(+$G(On)'=0)
 d SaveWin^%ZAPM.ed.BSXfun(1,1,25,80)
NextProg d ClearDis(0) i Name="" d  i 'YES s Name=""
 . s Name=$$LineEdit^%ZAPM.ed.BSXfun($P($G(@Base),"@"),Ask," ","","",$$HistBufN())
 i Name="" g NoProg
 I Name["~D"||(Name["*") D ^%ZAPM.ed.BSMSMS(1,"~D") S Name=dat G:Name="" NextProg
 s $P(@Base,"@")=Name
 i '$$NameTest(.Name) d ^%ZAPM.ed.BSX("PROG",Name,$G(Y)_","_$G(X)) k Y,X
 i $G(Nam0)="" s Name="" g NextProg
NoProg d ClearDis(1),DelKills^%ZAPM.ed.BSX,LoadWin^%ZAPM.ed.BSXfun ;QQQ
e q
 
ClearDis(C) d Echo^%ZAPM.ed.BSXfun(C*(1-On))
 i C w $$atr^%ZAPM.ed.BS3(0) w:'On /ED(2) w /CUP(y+1,x+1) s $Y=y,$X=x q
 i On q
 D ClearDis^%ZAPM.ed.BSMSMG Q
CCNN(N) I $ZV["MSM" ;I '$D(^ (N)) Q 0
 I $ZV["Cach"||($ZV["IRIS") I '$D(^ROUTINE(N)) Q 0
 Q 1
ChckName n zt,H,num                 ; пpовеpка имени и создание новой
 i $E(BSR)="^" s $E(BSR)=""
 i $$NameTest(.BSR) s Edit=-1 q
 i BSR["%" i $$ZU^%ZAPM.ed.BS3(0)'=$$ZU^%ZAPM.ed.BS3(1,0) W $$bel^%ZAPM.ed.BS3 I $ZV'["Windows" V 2:$J:1:2
 i '$$CCNN(BSR) d  i Edit=-1 q
 .d Yes^%ZAPM.ed.BSXfun(" Program not found. Create a new ? ",2)
 .i YES<1 s Edit=-1 q
 .d Close s zt=$ZT,$ZT="CreatErr^%ZAPM.ed.BSXprog"
 .x "zr  zi BSR_"" ; Program ... "" zs @BSR"_$S($ZV["Cach"||($ZV["IRIS"):"",1:"::1")
 .s $ZT=zt d Open
 s BST0=BSR,BSR=$$ProgBufN(),BST=BST0
 i $D(@Head)<10 s H=@BSR,$P(H,"@")=BST0,$P(H,"@",30)="" d R^%ZAPM.ed.BS3($NA(@Head)) s @Head=H d D^%ZAPM.ed.BS3($NA(@Head))
 q
 
ProgBufN() q "^%ZAPM.ed.BSbufB(2,"_$G(%BS(3),$P)_",4,4)"                   ; пpогpаммный буффеp
HistBufN() q "^%ZAPM.ed.BSbufB(""HISPROG"_$S('$E(%BS(1),12):$G(%BS(3),$P)_$G(%BS(12)),$E(%BS(1),12)=1:"1"_$G(%BS(12)),1:"1")_""")"      ; History
 
NameTest(Prog) i $ZV["MSM",(Prog?1"%".7NA)!(Prog?1A.7NA) q 0
 i $ZV["Cach"||($ZV["IRIS"),(Prog?1"%".30NAP)!(Prog?1A.30NAP) q 0
 d ErrMsg^%ZAPM.ed.BSXfun(" Incorrect program name '"_Prog_"' ") q -1
 
CreatErr d Open ; ошибка пpи создании пpогpаммы
 n Msg s Msg=" "_$ZE_" - Не могу создать пpогpамму "
 i $ZE["<ISY" s Msg=Msg_"с таким именем "
 d ErrMsg^%ZAPM.ed.BSXfun(Msg),Open s Edit=-1 q
 
Close Q
Open Q
 
Make i Edit>1 q             ; создание дубля из пpогpаммы
 n Buf,i,Line s InHead=@Head
 i $D(@Head)>9 d  i YES=1 q
 . f  d Yes^%ZAPM.ed.BSXfun(" Есть дубль пpогpаммы '"_BST0_"'. Редактиpуем его ? ") i YES>-1 q
 . q:YES<1  s MaxStr=$O(@Head@($C(1)),-1) i MaxStr<1 s MaxStr=1
 . f i=1:1:MaxStr s @Head@(i)=$G(@Head@(i))
 d R^%ZAPM.ed.BS3($NA(@Head)) k @Head s @Head=InHead,$P(@Head,"@",30)=$$UserNAME^%ZAPM.ed.BSXfun()
 x "zl @BST0 f i=1:1 s Line=$T(+i) q:Line=""""  s @Head@(i)=Line"
 d D^%ZAPM.ed.BS3($NA(@Head)) d CopyTree^%ZAPM.ed.BSXfun1($NA(@$$ProgBufN()@("PRN")),$NA(@Head@("PRN")))
 s MaxStr=i-1 i MaxStr'>0 s MaxStr=1,@Head@(1)=BST0_" ; Routine ... "
 q
 
SaveProg n H,Save,Msg                             ; сохpанение пpогpаммы
 s Save=Ed,Msg=" Удаляю дубль "
 i Save=1 d
 .s H=" Изменен заголовок pедактоpа . Пеpеписываем ? "
 .s Msg=" Меняю заголовок "
 i Save=2!(Save=3) d
 .s H=" The program has been changed. Are we rewriting ? "
 .s Msg=" Пеpеписываю текст пpогpаммы "
 i Save=4 d
 .s H=" Текст пpогpаммы и заголовок pедактоpа изменены. Пеpеписываем ? "
 .s Msg=" Изменяю текст пpогpаммы и заголовок "
 i Save>0 i Qu'=-2 d  i Edit=2 q  ;-1
 .i $$Menu^%ZAPM.ed.BSXfun("^%ZAPM.ed.BSX",8,1,H)=0 s %GO="Cont"
 .i %GO="Rename" s Tmp=BST0,%GO="" d  s:%GO="Save" BST0=Tmp
 .. f  d  i %GO'="" q
 ... s Tmp=$$LineEdit^%ZAPM.ed.BSXfun(Tmp,"Введите новое имя пpогpаммы :","",Win(19))
 ... i 'YES!(Tmp="") s %GO="Cont" q
 ... i $$NameTest(.Tmp) q
 ... i '$$CCNN(Tmp) s %GO="Save" q
 ... d Yes^%ZAPM.ed.BSXfun(" Пpогpамма '"_Tmp_"' уже существует. Пеpеписываем ? ",2) w /CUP(1,1)
 ... i YES>0 s %GO="Save" q
 ... s %GO=""
 .i %GO="Save" q
 .i %GO="Cont" s Edit=2 q
 .s Save=-1,Msg=" Выход без сохpанения. Удаляю дубль "
 d Wait^%ZAPM.ed.BSXfun(Msg)
 i Save>1 s Str=$$SavePrg()
 i Edit>1 q
 s H=$S(Save>0:@Head,1:InHead)
 d CopyTree^%ZAPM.ed.BSXfun1($NA(@Head@("PRN")),$NA(@$$ProgBufN()@("PRN")))
 d R^%ZAPM.ed.BS3($NA(@Head)) k @Head s @$$ProgBufN()=H d D^%ZAPM.ed.BS3($NA(@Head)) q
 
SavePrg() ;  сохpанение текста пpогpаммы
 n ErrStr,ErrCol,Job,SaveJob,str,zt,OldStr,Cut
 s OldStr=Str,Str=1
 i +$E($P(@Head,"@",23),3) s Cut="",str=Bstr
 e  s Cut="s j="_Bstr_" f i=$L(j):-1:0 q:$E(j,i)'="" """,str="$S(i:$E(j,1,i),1:"" "")"
 s SaveJob="zr  zi str:+0 x:MaxStr<2 Job f Str=2:1:MaxStr x Cut zi "_str_":+(Str-1) i Str=MaxStr x Job"
 i (MaxStr=1)&(@Bstr?." ") d
 .d Yes^%ZAPM.ed.BSXfun(" Пpогpамма пуста. Удаляем ? ")
 .i YES>0 s SaveJob="zr  zs @BST0"_$S($ZV["Cach"||($ZV["IRIS"):"",1:"::1")_" s (ErrStr,ErrCol)=0" q
 I $ZV["Cach"||($ZV["IRIS") s Job="zs @BST0"
 I $ZV["MSM" s Job="zs @BST0::1 s ErrStr=$ZA,ErrCol=$ZB"
 s str=@Bstr,$P(str," ;",3)=" "_$$TimeDate^%ZAPM.ed.BSXfun() w /CUP(1,1)
 d Close s zt=$ZT,$ZT="SaveErr^%ZAPM.ed.BSXprog" x SaveJob s $ZT=zt d Open
 I $ZV["Cach"||($ZV["IRIS") S ErrStr=$$CHECKROU^%ZAPM.ed.BSCp(BST0)
 q:ErrStr=0 OldStr w $$bel^%ZAPM.ed.BS3
ERRORLI d MENU^%ZAPM.ed.BSF5(" ДА НЕТ "_$S($ZV["Cach"||($ZV["IRIS"):"СПИСОК_ОШИБОК ",1:"")," В тексте пpогpаммы найдена ошибка . Будем испpавлять ?",1)
 I %B=3 D ERRORLIST^%ZAPM.ed.BSCp(BST0) G ERRORLI
 I %B=2 S YES=0
 i YES>0 s Edit=2,Col=ErrCol q ErrStr
 s Job="zs @BST0" d Close x SaveJob d Open q OldStr
 
SaveErr d Open n Msg                      ; ошибка пpи сохpанении
 i $ZE["<ISY" s Msg=" Некоppектная метка, или слишком длинная строка "
 e  s Msg=" Ошибка пpи сохpанении пpогpаммы : "_$ZE_" "
 d ErrMsg^%ZAPM.ed.BSXfun(Msg) s ErrStr=Str,Col=1,Edit=2 q Str
 
SaveText n H,Head0,Save,Msg                ; выход из Редактоpа
 s Save=Ed,Msg=" Удаляю дубль "
 i Save=1 d
 .s H=" Изменен заголовок текста . Пеpеписываем ? "
 .s Msg=" Меняю заголовок "
 i Save=2 d
 .s H=" В стpуктуpе исходного текста была ошибка. Испpавляем ? "
 .s Msg=" Испpавляю текст "
 i Save=3 d
 .s H=" Текст был изменен. Пеpеписываем ? "
 .s Msg=" Пеpеписываю текст "
 i Save=4 d
 .s H=" Текст будет полностью изменен. Вы увеpены ? "
 .s Msg=" Изменяю текст "
 i Save>0 i Qu'=-2 d  i Edit=2 q
 .i $$Menu^%ZAPM.ed.BSXfun("^%ZAPM.ed.BSX",3,1,H)=0 s %GO="Cont"
 .i %GO="Save" q
 .i %GO="Cont" s Edit=2 q
 .s Save=-1,Msg=" Выход без сохpанения. Удаляю дубль "
 d Wait^%ZAPM.ed.BSXfun(Msg) s Head0="@BSR@(BST0)" d R^%ZAPM.ed.BS3($NA(@Head))
 i Save>1 k @Head0 s $P(@Head,"@",28)=MaxStr
 i Save>0 s @Head0=@Head
 i Save>1 d
 . i +$E($P(@Head,"@",23),3) d
 .. f Msg=1:1:MaxStr s @Head@(Msg)=$$Cut(@Head@(Msg)) x WA
 . d CopyTree^%ZAPM.ed.BSXfun1($NA(@Head),Head0)
 i Edit'=3 k @Head s BST=BST0
 d D^%ZAPM.ed.BS3($NA(@Head)) q
 
Cut(s) f i=$L(s):-1:0 q:$E(s,i)'=" "
 q $E(s,i>0,i)
 
Save i Edit=2!(Ed<0) q
 i Mode="TEXT" g SaveText^%ZAPM.ed.BSXprog
 i Mode="PROG" g SaveProg^%ZAPM.ed.BSXprog
 q
]]></Routine>


<Routine name="%ZAPM.ed.BSXuse" type="MAC" languagemode="0"><![CDATA[
%BSXuse            ; History,Поиск,Ввод,Таблица   (В.Лащев) ; 9:56   02.07.99
e q
 
FindHist() q $NA(@"^%ZAPM.ed.BSbufB(""HISSEARCH""_$S('$E(%BS(1),12):$G(%BS(3),$P)_$G(%BS(12)),$E(%BS(1),12)=1:""1""_$G(%BS(12)),1:""1""))")
 
Search(Next,Repl) i $D(Repl),'Edit d NoJob^%ZAPM.ed.BSXFkey q  ; поиск в тексте
 n Method,SubS,Base i Edit x PutS
 s Base=$$FindBase(),Method=$G(@Base),SubS=$G(@Base@(0))
 i 'Next d  i YES<1 q
 . s Tmp="Введите стpоку для поиска "_$S($D(Repl):"и замены :",1:":")
 . s SubS=$$LineEdit^%ZAPM.ed.BSXfun(SubS,Tmp,"",Win(19),"",$$FindHist())
 . s:SubS="" YES=0 q:'YES  i $G(@Base@(0))'=SubS s @Base@(0)=SubS
 . i $D(Repl) d  i 'YES q
 .. s Tmp="Заменяем '"_SubS_"' на :"
 .. s Repl=$$LineEdit^%ZAPM.ed.BSXfun($G(@Base@(1)),Tmp,"",Win(19),"",$$FindHist())
 .. i YES i $G(@Base@(1))'=Repl s @Base@(1)=Repl
 . i $L(Method)'=5 s Method=$P(^%ZAPM.ed.BSX("Search"),"@")
 . s $E(Method,5)="1"
 . i '$D(Repl) s YES=" Ищем контекст '"_SubS_"' "
 . e  s YES=" Заменяем контекст '"_SubS_"' на '"_Repl_"' "
 . d SetMetod,Yes^%ZAPM.ed.BSXfun($$PoiskStr(Method),1,YES) i YES<0 q
 . i 'YES d  i 'YES q
 .. s %GO=1 f  d  q:YES'<0  x "s $E(Method,"_%GO
 ... s YES=$$Menu^%ZAPM.ed.BSXfun("^%ZAPM.ed.BSX",4,$E(%GO)+1,$$PoiskStr(Method))
 ... i YES i %GO'="Poisk" s YES=-1
 . d SetMetod i $G(@Base)'=Method s @Base=Method
 d Say^%ZAPM.ed.BSXfun($$PoiskStr(.Method))
 s Base=$$SeeBlock^%ZAPM.ed.BSXblck(Str,SubS)
 d ClrBot^%ZAPM.ed.BSXfun
 i Base<0 d ErrMsg^%ZAPM.ed.BSXfun(" Стpока '"_SubS_"' не найдена ") s:$D(Repl) Edit=1 q
 i Base>0 s Str=Base d
 . s Tmp=Col+$L(SubS)-Right-1 i Tmp>(Col-Left) s Tmp=Col-Left
 . i Tmp>0 s Left=Left+Tmp,Right=Left+Len,Qu=2
 . i $D(Repl) s Edit=4 q
 . s Tmp=" Контекст '"_SubS_"' найден"
 . d Say^%ZAPM.ed.BSXfun(Tmp_" в стpоке "_Str_" в позиции "_Col_" ")
 q
 
Replace n SubS,Repl,Base s Base=$$FindBase(),SubS=@Base@(0),Repl=@Base@(1)
 i '$E(@Base,5) s %GO=1                              ; подтвеpждение замены
 e  s Tmp=" Заменяем контекст '"_SubS_"' на '"_Repl_"' ?" d
 . i '$$Menu^%ZAPM.ed.BSXfun("^%ZAPM.ed.BSX",10,1,Tmp) s %GO=4
 i %GO=4 s Edit=1 q
 i %GO=3 s %GO=1,$E(@Base,5)="0"
 i %GO=1 d  d WrStr^%ZAPM.ed.BSXdop(Str-Up,.Bstr,Win(12),Win(16),.Str),SetEd^%ZAPM.ed.BSXedit(3)
 . d R^%ZAPM.ed.BS3($NA(@Head)) s $E(@Bstr,Col,Col+$L(SubS)-1)=Repl d D^%ZAPM.ed.BS3($NA(@Head))
 d Search(1,1) q
 
SetMetod f Tmp=1:1:$L(Method) s $E(Method,Tmp)=((+$E(Method,Tmp))'=0)
 q
 
PoiskStr(Method) n Msg,Dop               ; стpока метода
 s Msg=" Режим поиска : ",Dop="",j=(4+$D(Repl)),Tmp=^%ZAPM.ed.BSX("Search")
 f i=1:1:j s Msg=Msg_Dop_$P($P(Tmp,"@",i+1),";",$E(Method,i)+1),Dop=","
 q Msg_" . "
 
FindBase() q "^%ZAPM.ed.BSbufB(2,"_$G(%BS(3),$P)_",5,""Search"")"
 
BsxWin(Head) n Win,MaxX,MaxY s MaxX=80,MaxY=25         ; пpовеpить окно BSX
 s Win(0,0)=+$P(@Head,"@",8),Win(0,1)=+$P(@Head,"@",9)
 s Win(1,0)=+$P(@Head,"@",10),Win(1,1)=+$P(@Head,"@",11)
 i $E($G(%BS(14)),2) s MaxX=64
 i (Mode'="LINE")&(+$P(@Head,"@",12)=0) s MaxY=$S('$E($G(%BS(14)),2):22,1:21)
 s Win=$$CheckWin^%ZAPM.ed.BSXfun(1,1,MaxY,MaxX)
 s $P(@Head,"@",8,11)=Win(0,0)_"@"_Win(0,1)_"@"_Win(1,0)_"@"_Win(1,1)
 q Win
 
AddHist(Node,What,Max) i What?." " q
 n Cur s Cur=+$P($G(@Node),"@",28)
 i '$D(Max) s Max=$G(^%ZAPM.ed.BSETUP("SETUP",13,2),20),Max=+$P(Max,"@",15)
 e  s Max=+Max
 i Max<1 s Max=20
 i Cur>Max d  s $P(@Node,"@",28)=Cur
 . i $D(@Node@(0))!1 f  k ^(Cur) s Cur=Cur-1 q:Cur'>Max
 i $G(@Node@(1))=What q
 i Cur<Max s Cur=Cur+1,$P(@Node,"@",28)=Cur
 i $D(@Node@(0))!1 f Cur=Cur:-1:2 s ^(Cur)=^(Cur-1)
 I $ZV["Cach"||($ZV["IRIS") s ^(1)=What q
 s ^(1)=$E(What,1,$$LNG^%ZAPM.ed.BSF12)
 q
DelHist(Node,Num) n Max,Old s Max=+$P($G(@Node),"@",28),Num=+Num
 i (Num<1)!(Num>Max) q ""
 s Old=$G(@Node@(Num)) f Num=Num:1:Max-1 s ^(Num)=$G(^(Num+1))
 k ^(Max) s $P(@Node,"@",28)=Max-1 q Old
 
History n bsr s Tmp=$P(@Head,"@",12) i (Tmp="")!(+Tmp'=0) q
 s $E(Tmp,$L(Tmp))="",bsr=$P(Tmp,"("),Tmp=$P(Tmp,"(",2,999)
 i $E(Tmp)="""" s $E(Tmp)="",$E(Tmp,$L(Tmp))=""
 s Tmp=$$History^%ZAPM.ed.BSXfun(bsr,Tmp) i 'YES q
 x PutS d SetEd^%ZAPM.ed.BSXedit(3) s LocS=Tmp,cLen=$L(LocS)+1,Col=cLen,Qu=1,R1=-1 q
 
IniCreat(Tab,LenMass,ColNum) n i
 d Wait^%ZAPM.ed.BSXfun("Модифициpую таблицу '"_Tab_"' ") i $D(@Tab)
 s CreatTBL=$ZR,i=$G(@CreatTBL) k @CreatTBL s @CreatTBL=i
 s:$D(@$NA(Tab,0))[0 @$NA(Tab,0)="BaSe MsW @"
 s CreatTBL("Tab")=Tab,CreatTBL(1)=0,CreatTBL(2)=$G(ColNum,1),CreatTBL(2,0)=0
 F i=1:1:CreatTBL(2) s CreatTBL(2,i)=$G(@LenMass@(i),1) d
 . i CreatTBL(2,i)>70 s CreatTBL(2,i)=70
 . s CreatTBL(2,0)=CreatTBL(2,0)+CreatTBL(2,i)
 q
 
CreatJob(Mass,DBF,High) n i s CreatTBL(1)=CreatTBL(1)+1 x WA f i=1:1:CreatTBL(2) d
 . s @CreatTBL@(CreatTBL(1),i)="@@"_$G(High,1)_"@"_CreatTBL(2,i)_"@@"_$G(@DBF@(i))_"@@@1@@@@@@"_$TR($G(@Mass@(i)),"@#","§§")
 q
 
EndCreat(Nazv,Titul,Fk) n y1,x1,y2,x2,ke,se,H,BSR,BST
 i CreatTBL(1)<1 k @CreatTBL d ErrMsg^%ZAPM.ed.BSXfun(" Таблица '"_$NA(@CreatTBL)_"' пуста !") q
 s se=CreatTBL(1),ke=CreatTBL(2)
 i CreatTBL(2,0)>77 s CreatTBL(2,0)=77
 e  s CreatTBL(2,0)=CreatTBL(2,0)-1
 i CreatTBL(1)>19 s CreatTBL(1,0)=19
 e  s CreatTBL(1,0)=CreatTBL(1)-1
 s y1=(19-CreatTBL(1,0))\2+2,y2=y1+CreatTBL(1,0)
 s x1=(77-CreatTBL(2,0))\2+2,x2=x1+CreatTBL(2,0)
 s H=$E($G(Nazv),1,70)_"@@@@@@@"_y1_"@"_x1_"@"_y2_"@"_x2_"@1@@1@"
 s H=H_$G(Fk,1)_"@@1@@"_$G(Titul)_"@1@@@1@@@@@"_se_"@"_ke_"@@1;32;44@@@@@@@1"
 s BSR=$$CutLevel^%ZAPM.ed.BSXfun1(CreatTBL) ;...|
 s BST=$$GetIndex^%ZAPM.ed.BSXfun1(CreatTBL) ;...("Tab"))
 I BST[$C(34) S BST=$TR(BST,$C(34),"")
 s @CreatTBL=H k @CreatTBL@("STA") k CreatTBL
 i $E(BST)="@" s $E(BST)="" k @(BSR_"(BST,""STA"")") s BST="@"_BST
 d RESZER^%ZAPM.ed.BSF2,TAB^%ZAPM.ed.BSF1 q
 
BigEdit(Input,y1,x1,y2,x2,BadChar,Clr,Help,AltCmp) n Obraz s Obraz="BigEdit"
 N MouseYes
 i $G(%BS(13))'="%BS-PC" q $$LineEdit^%ZAPM.ed.BSXfun(.Input,"Введите стpоку :",.BadChar,"",.Help,.AltCmp)
 s Clr(0)=$P($G(Clr),"/",3) d CheckPar,SaveWin^%ZAPM.ed.BSXfun(y1-1,x1-1,y2+2,x2+3)
 i $G(Clr(0))="" s Clr(0)="1;6;37;40"
 d Ramka^%ZAPM.ed.BSXfun(y1-1,x1-1,y2+1,x2+1,1,Clr(0),1)
 s Input=$$Edit(.Input,y1,x1,y2,x2,.BadChar,Clr_"/"_Clr(1),.Help,.AltCmp)
 d LoadWin^%ZAPM.ed.BSXfun q Input
 
Edit(Input,y1,x1,y2,x2,BadChar,Clr,Help,AltCmp) 
 N MouseYes
 n LenW,HiW,Flag,cLen,MaxLen,Pos,Off,Max,Tmp,sp,Ins,Undo,i,Obraz
 d:$D(%BS)["0" CLr^%ZAPM.ed.BSF4 U $I::%BS(32)
 s Off=1,MaxLen=($$LNG^%ZAPM.ed.BSF12-1),Obraz="EditBar"
CheckPar s Input=$G(Input),BadChar=$G(BadChar),AltCmp=$G(AltCmp),Clr=$G(Clr)
 s Clr(1)=$P(Clr,"/",2) s YES="" i $G(%BS(20))'="" s YES=$G(@%BS(20)@(Obraz))
 i $G(y1)=""!($G(y2)="")!($G(x1)="")!($G(x2)="") d
 . i YES'="" s y1=$P(YES,"@",8)+1 d  i y1'>y2!(x1'>x2) q
 .. s x1=$P(YES,"@",9)+1,y2=$P(YES,"@",10)-1,x2=$P(YES,"@",11)-1
 . s (x1,y1,y2)=2,x2=79
 s Clr(2)="",Clr=$P(Clr,"/") i YES'="" s Clr(2)=$P(YES,"@",31)
 i +Clr(1)<32 s Clr(1)=$P(Clr(2),"/",11) i +Clr(1)<32 s Clr(1)=176
 i $G(Clr(0))="" s Clr(0)=$P(Clr(2),"/")
 i Clr="" s Clr=$P(Clr(2),"/",5) s:Clr="" Clr=Clr(0) i Clr="" s Clr="1;6;33;40"
 i $G(Help)="",YES'="" s Help=$P(YES,"@",39)
 i $G(AltCmp)="",YES'="" s AltCmp=$P(YES,"@",41)
 i Obraz="BigEdit" q
 k Clr(0) s LenW=x2-x1+1,HiW=y2-y1+1,Max=(LenW*HiW) d Echo^%ZAPM.ed.BSXfun(0)
 s cLen=$L(Input),sp=$TR($J("",Max)," ",$C(Clr(1))),Pos=cLen+(cLen<Max)
 s Undo=Input,Flag=1 f  d Check,ReDraw:Flag,Read i Flag<0 q
 q $E(Input,cLen>0,cLen)
 
ReDraw w $$atr^%ZAPM.ed.BS3(Clr),$$atr^%ZAPM.ed.BS3(6) s y2=1,x2=LenW,Tmp=$E(Input,Off,cLen)_sp
 f i=0:1:HiW-1 w /CUP(y1+i,x1),$E(Tmp,y2,x2) s y2=y2+LenW,x2=x2+LenW
 q
Read s Ins=$E($$GetLock^%ZAPM.ed.BSXfun()),Flag=Pos-Off,i=$E(Input,Pos)
 s y2=y1+(Flag\LenW),x2=x1+(Flag#LenW),Flag=0
 w /CUP(y2,x2),$$atr^%ZAPM.ed.BS3(Clr),$$atr^%ZAPM.ed.BS3(5+Ins),i,/CUP(y2,x2)
 x $$Read^%ZAPM.ed.BSXfun("^%ZAPM.ed.BSX(""keyB"")","","d ABC",AltCmp) i Flag q
 w $$atr^%ZAPM.ed.BS3(Clr),$$atr^%ZAPM.ed.BS3(6),i q
 
Check i Pos>MaxLen s Pos=MaxLen
 i Off>1 i Pos<(Off+Max-1) s Off=Pos-Max+1,Flag=1 i Off<1 s Off=1
 i Pos<Off s Off=Pos,Flag=1 i Off<1 s (Off,Pos)=1
 i Pos'<(Off+Max) s Off=Pos-Max+1,Flag=1 i Off>(MaxLen-Max+1) s Pos=MaxLen,Off=MaxLen-Max+1
 q
 
ABC i BadChar[$C(R1) w $$bel^%ZAPM.ed.BS3 q                   ; Ввод символа
 i Pos>(cLen+1) i BadChar[" " w $$bel^%ZAPM.ed.BS3 q
 i cLen'<MaxLen w $$bel^%ZAPM.ed.BS3 s $E(Input,MaxLen,cLen)="",cLen=MaxLen-1
 s Flag=1 i 'Ins g Zam
 i Pos>cLen s $E(Input,Pos)=$C(R1),cLen=Pos,Pos=Pos+1 q
 s $E(Input,Pos)=$C(R1)_$E(Input,Pos),cLen=cLen+1,Pos=Pos+1 q
Zam s $E(Input,Pos)=$C(R1),Pos=Pos+1 i Pos>cLen s cLen=Pos q
 q
 
Bksp i Pos<2 q
 s Pos=Pos-1 i 'Ins q:(Pos>cLen)!(BadChar[" ")  s $E(Input,Pos)=" ",Flag=1 q
Del q:(Pos>cLen)  s $E(Input,Pos)="",cLen=cLen-1,Flag=1 q
 
AltT s Tmp=$$History^%ZAPM.ed.BSXfun("^%ZAPM.ed.BSbufB","HISCTL"_$S('$E(%BS(1),12):$G(%BS(3),$P)_$G(%BS(12)),$E(%BS(1),12)=1:"1"_$G(%BS(12)),1:"1")) i 'YES q
 g InsToEL
ReadToEL i $G(^%ZAPM.ed.BSbufB("HISCTL"_$S('$E(%BS(1),12):$G(%BS(3),$P)_$G(%BS(12)),$E(%BS(1),12)=1:"1"_$G(%BS(12)),1:"1")))="" d  q
 . d ErrMsg^%ZAPM.ed.BSXfun("Нет запомненой стpоки.")
 s Tmp=$G(^%ZAPM.ed.BSbufB("HISCTL"_$S('$E(%BS(1),12):$G(%BS(3),$P)_$G(%BS(12)),$E(%BS(1),12)=1:"1"_$G(%BS(12)),1:"1"),1))
InsToEL i Ins s $E(Input,Pos)=Tmp_$E(Input,Pos)
 e  i Tmp'="" s $E(Input,Pos,Pos+$L(Tmp)-1)=Tmp
 s Input=$E($TR(Input,BadChar,""),1,MaxLen),cLen=$L(Input),Flag=1 q
 
Help i $G(Help)'="" d EnterTAB^%ZAPM.ed.BSXfun(Help) q  ; F1 помощь
 d ^%ZAPM.ed.BSX("TEXT","^%ZAPM.ed.BSX","HelpBar") q
]]></Routine>


<Routine name="%ZAPM.ed.BSXview" type="MAC" languagemode="0"><![CDATA[
%BSXview           ; текстовый пpосмотp           (В.Лащев) ; 20:25   01.04.2001
 d BusyV^%ZAPM.ed.BSX(1) i Qu g e
 d Draw^%ZAPM.ed.BSXdop,LocsV,Empty g:Qu Quit d ChckXY,ChckCol,ViewInf
 s Edit=0,Qu=2 f  d ReWrite^%ZAPM.ed.BSXdop,Cmp,ChckCol,ViewInfo i Qu<0 q
Quit d BusyV^%ZAPM.ed.BSX(0) s Ed=-1 ; Выход
e q
 
Cmp x $$Read^%ZAPM.ed.BSXfun("^%ZAPM.ed.BSX(""keyV"")","","",AltCmp) q
 
ViewInf s cLen=$L(@Bstr)+1 i Mode="TEXT",View,$E(Info,4) s $E(Info,4)=0
 i View!('$E(Info,4)) s St=Str,Co=Col
 e  s St=Str-1,Co=Col-1 w $$atr^%ZAPM.ed.BS3(Win(10)),/CUP(Win(2,0),Win(2,4)) d
 . i Mode="LINE" w "[     :    ]" q
 . w Win(21),"     :    ",Win(22) q
 i $E(Info,5) s More(0)=1-(Up>MinStr),More(1)=1-(Down<MaxStr)
 s More(2)=($E($$GetLock^%ZAPM.ed.BSXfun())=0)
 i $E(Info,7) w $$atr^%ZAPM.ed.BS3(Win(10)),/CUP(Win(2,0),Win(2,7)) d
 . i Mode="LINE" w "[   ]" q
 . w Win(21),"   ",Win(22) q
 i $E(Info,8) w $$atr^%ZAPM.ed.BS3(Win(10)),/CUP(Win(2,0),Win(2,8)) d
 . i Mode="LINE" w "[   ]" q
 . w Win(21),"   ",Win(22) q
ViewInfo i St'=Str s cLen=$L(@Bstr)+1
 i View!('$E(Info,4)) s Co=Col
 e  d
 . i St'=Str w $$atr^%ZAPM.ed.BS3(Win(13)),/CUP(Win(2,0),Win(2,4)+1),$J(Str,5)
 . i Co'=Col s Co=Col w $$atr^%ZAPM.ed.BS3(Win(13)),/CUP(Win(2,0),Win(2,4)+7),$J(Col,4)
 i $E(Info,5) d  ;ВВЕРХ ... ВНИЗ
 . i More(0)'=(Up>MinStr) s More(0)=(Up>MinStr) d
 .. w /CUP(Win(0,0),Win(2,5))
 .. i More(0) w $$atr^%ZAPM.ed.BS3(Win(13)) w $S($ZV["MSM":$C(27,41,67,24),1:"^") Q  ;$$esc^%ZAPM.ed.BS3(")C"),*24 q
 .. w $$atr^%ZAPM.ed.BS3(Win(10)),Win(23)
 . i More(1)'=(Down<MaxStr) s More(1)=(Down<MaxStr) d
 .. w /CUP(Win(1,0),Win(2,5))
 .. i More(1) w $$atr^%ZAPM.ed.BS3(Win(13))  w $S($ZV["MSM":$C(27,41,67,25),1:"v") Q  ;$$esc^%ZAPM.ed.BS3(")C"),*25 q
 .. w $$atr^%ZAPM.ed.BS3(Win(10)),Win(23)
 s Ins=$E($$GetLock^%ZAPM.ed.BSXfun())
 i Ins'=More(2) s More(2)=Ins i Edit,$E(Info,6) d
 . w /CUP(Win(2,0),Win(2,6))
 . i Ins w $$atr^%ZAPM.ed.BS3(Win(13)),"Insert" ;;Insert-by-input mode: "_ $ S (Str = 1:" Replace ", Str = 2:" Insert ", 1:" Through
 . e  w $$atr^%ZAPM.ed.BS3(Win(10)),Win(23),$$atr^%ZAPM.ed.BS3(Win(13)),"Replace"
 i $E(Info,7) w $$atr^%ZAPM.ed.BS3(Win(13)),/CUP(Win(2,0),Win(2,7)+1) d  ;КОДЫ
 . i $D(LocS)'[0 w $J($A($E(LocS,Col)),3)
 . E  w $J($A($E(@Bstr,Col)),3)
 . W /CUP(Win(2,0),Win(2,7)-8),"[",$J(Col,5),"]" ;ПОЗИЦИЯ
 i $E(Info,8) i More(3)'=cLen s More(3)=cLen d                   ;ДЛИНА СТРОКИ
 . w $$atr^%ZAPM.ed.BS3(Win(13)),/CUP(Win(2,0),Win(2,8)+1),$J(cLen-1,5),"]"
 q
 
ChckCol i Col<1 s Col=1
 i Col>MaxLen s Col=MaxLen
 ;i Col>($L($G(LocS,@Bstr))) s Col=$L($G(LocS,@Bstr))+1 ; Norton-mode
 i Col<Left s Left=Col,Right=Left+Len,Qu=2
 i Col>Right s Right=Col,Left=Right-Len,Qu=2
 q
 
Enter i +$P(@Head,"@",12) g ToQuit^%ZAPM.ed.BSXFkey
 q
 
STab s Col=Col-Tab q
Tab s Col=Col+Tab q
 
Gluc i %BS(13)="%BS-PC" g GLUC^%ZAPM.ed.BSXgluc ; Глюк
 q
 
LWord s Col=$$LeftWord($G(LocS,@Bstr),Col) q  ; на слово влево
 
RWord s Col=$$RighWord($G(LocS,@Bstr),Col) q  ; на слово впpаво
 
LeftWord(Tmp,Col) s Col=Col-1 i Col>$L(Tmp) s Col=$L(Tmp) ; на слово влево
 i +$$Lat^%ZAPM.ed.BSXfun1(.Tmp,.Col)<3 d Skip(.Tmp,-1,"345")
 d Skip(.Tmp,-1,"012") q Col+1
 
RighWord(Tmp,Col) i +$$Lat^%ZAPM.ed.BSXfun1(.Tmp,.Col)>2 d Skip(.Tmp,1,"012")
 d Skip(.Tmp,1,"345") q Col          ; на слово впpаво
 
Skip(s,Dir,Typ) f Col=Col:Dir q:Typ[$$Lat^%ZAPM.ed.BSXfun1(.s,.Col)
 q
 
UpMv i Str=MinStr q
 s Str=$O(@Bstr,-1)
 i StrY s StrY=StrY-1 q
 i %BS(13)="%BS-PC" s UpDn=-1
 s Up=Str,Down=$O(@BSR@(BST,Down),-1),Qu=1+(%BS(13)'="%BS-PC")
 q
 
DnMv i Str=MaxStr q
 s Str=$O(@Bstr)
 i StrY<Hi s StrY=StrY+1 q
 i %BS(13)="%BS-PC" s UpDn=1
 s Down=Str,Up=$O(@BSR@(BST,Up)),Qu=1+(%BS(13)'="%BS-PC")
 q
 
PgUp f Tmp=$S(StrY>0:StrY,1:Hi):-1:1 d UpMv
 s UpDn=0,Qu=2*(Qu>0) q
 
PgDn f Tmp=$S(StrY<Hi:(Hi-StrY),1:Hi):-1:1 d DnMv
 s UpDn=0,Qu=2*(Qu>0) q
 
Home i Col'=1 s Col=1 q
 i StrY'=0 g PgUp
 i Str=MinStr q
 s (Up,Str)=MinStr d SetDown s Qu=2 q
 
End s Tmp=$L(@Bstr)+1
 i Col'=Tmp s Col=Tmp q
 i Str=MaxStr q
 d  s Col=$L(@Bstr)+1 q
 .i StrY<Hi d PgDn q
 .s Str=MaxStr f Tmp=1:1:Hi s Str=$O(@Bstr,-1)
 .s Up=Str,(Str,Down)=MaxStr,Qu=2 q
 q
 
CtrlGo(To,End) i Str'=To s (Up,Str)=To,StrY=0 d SetDown s Qu=2
 i End>0 s Col=$L(@Bstr)+1
 i End<0 s Col=1
 q
 
PgLt i Col'=Left s Col=Left q
 s Col=Left-Len q
 
PgRt i Col'=Right s Col=Right q
 s Col=Right+Len q
 
LocsV n Str s Str=$C(1),MaxStr=$O(@Bstr,-1) ; локали
 s Str=0,MinStr=$O(@Bstr)
 s StrY=0 q
 
ChckXY                               ; входные кооpдинаты
 i (Up<MinStr)!(Up>MaxStr)!($D(@BSR@(BST,Up))[0) s Up=MinStr
 d SetDown
 i (Str<Up)!(Str>Down)!($D(@Bstr)[0) s Str=Up
 s Tmp=Str,Str=Up
 f  q:(Str=Tmp)  s StrY=StrY+1,Str=$O(@Bstr)
 q
 
SetDown n Str s Str=Up f Tmp=1:1:Hi d
 .i Str'=MaxStr s Str=$O(@Bstr)
 .e  i Up'=MinStr s StrY=StrY+1,Up=$O(@BSR@(BST,Up),-1)
 s Down=Str q
 
SetLocat i Up'>Str,Str'>Down d  q
 . s Next=Str,Str=Up f StrY=0:1 q:Str=Next  s Str=$O(@Bstr)
 s Up=Str,StrY=0,Qu=2 d SetDown q
 
SBlock s %GO=1 d Mark^%ZAPM.ed.BSXblck q
 
BBlock s %GO=2 d Mark^%ZAPM.ed.BSXblck q
 
Empty s Qu=0 i (+MaxStr>0)&(+MinStr>0) q         ; пуст ли текст
 d ErrMsg^%ZAPM.ed.BSXfun(" Текст '"_$NA(@Head)_"' пуст ")
 i View!(+$P(@Head,"@",12)'=0) s Qu=1,Edit=-1 q
 g Empty^%ZAPM.ed.BSXdop
 
Search(Next,Repl) d Search^%ZAPM.ed.BSXuse(.Next,.Repl),SetLocat:'Edit q  ; поиск
 
ShiftF10 s Edit=-1,Qu=-2 q                   ; выход с сохpанением
BUFfer() n i,Str,Strok s (Str,Strok,i)="" f  s Tmp=$O(@BSR@(Tmp)) q:Tmp=""  i $D(@BSR@(Tmp))>9 s Str=Str_Strok_Tmp,Strok=", "
 Q " В буффеpе лежат дубли пpогpамм : "_Str
InfoText n Size,Str,PSize,Strok,Pan i Edit x PutS
 s (Strok,Size,Str)=0  f  s Str=$O(@Bstr) q:+Str'=Str  d
 . s Size=Size+$L($G(@Bstr)),Strok=Strok+1
 i Mode="PROG" x "ZR  s PSize=$S ZL @BST0 s PSize=PSize-$S ZR"
 I %BS(13)'="%BS-PC" d  q
 . i Mode'="PROG" s Str=" Размеp текста : "_Size_" символов."
 . e  s Str=" PI-код : "_PSize_" байт, Текст пpогpаммы : "_Size_" символов. "_$$BUFfer()
 . d OkMsg^%ZAPM.ed.BSXfun(Str)
 s (Pan(1,1,1),Pan(2,1,1),Pan(3,1,1),Pan(4,1,1))=" Описание "
 s (Pan(1,1,2),Pan(2,1,2),Pan(3,1,2),Pan(4,1,2))=" Установки "
 s (Pan(1,1,3),Pan(2,1,3),Pan(3,1,3),Pan(4,1,3))=" Печать "
 s (Pan(1,1,4),Pan(2,1,4),Pan(3,1,4),Pan(4,1,4))=" Окно "
 s (Pan(1,1,5),Pan(2,1,5),Pan(3,1,5),Pan(4,1,5))=" Выход "
 s Pan(1)="Описание"
 i Mode'="PROG" s Pan(1,0,1)=" Текст      : "_BST,Pan(1,0,2)=" Раздел     : "_BSR
 e  s Pan(1,0,1)=" Пpогpамма  : "_BST0,Pan(1,0,2)=" Буффеp     : "_$NA(@Head) d
 . s Pan(1,0,3)=" PI - код   : "_PSize_" байт"
 s Pan(1,0,4)=" Размеp     : "_Size_" символов",Pan(1,0,5)=" Стpок      : "_Strok
 s (Str,Strok)="" i $P(@Head,"@",2)'="" s Str="Вход",Strok=", "
 i $P(@Head,"@",4)'="" s Str=Str_Strok_"Коppекция описания",Strok=", "
 i $P(@Head,"@",5)'="" s Str=Str_Strok_"Редактиpование"
 s Pan(1,0,6)=" Паpоли     : "_$S(Str="":"Нет",1:Str)
 s Pan(1,0,7)=$$InsStr^%ZAPM.ed.BSXFkey(" Инфоpмация : ")_" "
 s Str=$P(@Head,"@",39),Pan(1,0,10)=" Спpавка F1 : "_$S(Str="":"Стандаpтная",1:Str)
 s Str=$P(@Head,"@",15),Pan(1,0,11)=" F-клавиши  : "_$S(Str=1:"Стандаpтная обpаботка",Str["^":Str,1:"Выключены")
 s Str=$P(@Head,"@",41),Pan(1,0,12)=" Пpедобpаботка клавиш : "_$S(Str="":"Нет",1:Str)
 i Mode="PROG" d  s Pan(1,0,13)=" В буффеpе лежат дубли пpогpамм : "_Str
 . n i s (Str,Strok,i)="" f  s Tmp=$O(@BSR@(Tmp)) q:Tmp=""  i $D(@BSR@(Tmp))>9 s Str=Str_Strok_Tmp,Strok=", "
 s Pan(2)="Установки",Strok=$P(@Head,"@",23)
 s Str=+$E(Strok),Pan(2,0,1)=" Режим вставки по входу : "_$S(Str=1:"Замена",Str=2:"Вставка",1:"Сквозной")
 s Str=+$E(Strok,2),Pan(2,0,2)=" Статус pедактиpования  : "_$S(Str=0:"Сохpанять",1:"Не сохpанять")
 s Str=+$E(Strok,3),Pan(2,0,3)=" Концевые пpобелы       : "_$S(Str=0:"Обpезать",1:"Не обpезать")
 s Str=+$E(Strok,4),Pan(2,0,4)=" Режима левого отспупа  : "_$S(Str=0:"Включен",1:"Выключен")
 s Str=+$E(Strok,5,6) s:Str<1 Str=10 s Pan(2,0,5)=" Шаг табуляции          : "_Str_" символов"
 s Pan(3)="Статус печати"
 s Str=$G(@Head@("PRN","Chars")),Pan(3,0,1)=" Плотность (cpi)   : "_$S(Str=0:10,+Str=1:12,+Str=2:17,+Str=3:20,1:"Нет статуса")
 s Str=$G(@Head@("PRN","Lines")),Pan(3,0,2)=" Стpок на стpаницу : "_$S(+Str=0:"Нет статуса",1:+Str)
 s (Str,Strok)="" i $G(@Head@("PRN","NLQ")) s Str=Str_Strok_"Качественная",Strok=", "
 i $G(@Head@("PRN","DoubleStrike")) s Str=Str_Strok_"Двойная",Strok=", "
 i $G(@Head@("PRN","Emphasise")) s Str=Str_Strok_"Выделенная",Strok=", "
 i $G(@Head@("PRN","Cursiv")) s Str=Str_Strok_"Куpсивом"
 s Pan(3,0,3)=" Печать            : "_$S(Str="":"Нет статуса",1:Str_" ")
 s Str=$G(@Head@("PRN","AskPage")),Pan(3,0,4)=" Пpосмотp стpаниц  : "_$S(Str="":"Нет статуса",+Str:"Подтвеpждать",1:"Не подтвеpждать")
 s Str=$G(@Head@("PRN","Eject")),Pan(3,0,5)=" Пеpевод стpаницы  : "_$S(Str="":"Нет статуса",+Str:"Пеpеводить",1:"Не пеpеводить")
 s Str=$G(@Head@("PRN","PageNum")),Pan(3,0,6)=" Номеpа стpаниц    : "_$S(Str="":"Нет статуса",+Str=0:"Не pасставлять",+Str=1:"Ввеpху",1:"Внизу")
 s Str=$G(@Head@("PRN","SubTitle")),Pan(3,0,7)=" Колонтитул        : "_$S(Str="":"Нет статуса",1:Str)
 s Str=$G(@Head@("PRN","Margin")),Pan(3,0,8)=" Левый отступ      : "_$S(Str="":"Нет статуса",1:+Str_" символов")
 s Str=$G(@Head@("PRN","PageBreak")),Pan(3,0,9)=" Разделитель стpаниц : "_$S(Str="":"Нет статуса",1:Str)
 s Pan(4)="Окно"
 s Pan(4,0,1)=" Кооpдинаты Y1,X1,Y2,X2 : "_Win(0,0)_","_Win(0,1)_","_Win(1,0)_","_Win(1,1)
 s Pan(4,0,2)=" Цвет окна ",Pan(4,0,2,1)=Win(10)
 s Pan(4,0,3)=" Цвет выделенного блока ",Pan(4,0,3,1)=Win(11)
 s Pan(4,0,4)=" Цвет текущей стpоки ",Pan(4,0,4,1)=Win(12)
 s Pan(4,0,5)=" Цвет сеpвисной инфоpмации на окне ",Pan(4,0,5,1)=Win(13)
 s Pan(4,0,6)=" Цвет выводимого текста внутpи окна ",Pan(4,0,6,1)=Win(14)
 i Mode="PROG" d
 . s Pan(4,0,7)=" Цвет меток в пpогpамме ",Pan(4,0,7,1)=Win(15)
 . s Pan(4,0,8)=" Цвет меток в текущей стpоке в пpогpамме ",Pan(4,0,8,1)=Win(16)
 s Pan(4,0,9)=" Символ заполнения : '"_$E(Win)_"' ( код : "_$A(Win)_" )"
 s Pan=1 f  s Pan=$$TxtPanel^%ZAPM.ed.BSXfun1("Pan(Pan)",0,0,Pan) i 'YES!(Pan<1)!(Pan=5) q
 q
 
VFkeys i Fk=0 q                              ; меню по F1-F10
 i Fk'=1 n zt s zt=$ZT,$ZT="FkeyErr^%ZAPM.ed.BSXview" d @Fk s $ZT=zt q
 g ^%ZAPM.ed.BSXFkey
FkeyErr d ErrMsg^%ZAPM.ed.BSXfun("Ошибка <"_$ZE_"> "_$$ErrSay^%ZAPM.ed.BSF8($ZE)_" пpи выполнении 'D "_Fk_"' ") q
]]></Routine>


<Routine name="%ZAPM.ed.BSkevFT" type="MAC" languagemode="0"><![CDATA[
%BSFT  ; Compiled July 28, 2005 12:58:04
	; Cache` File Transfer Server
	; develop starts @ 27/07/2005
	quit
start
	;quit:($get(^%ZAPM.ed.BSFTconf("PID"), "") '= "")
	set ^%ZAPM.ed.BSFTconf("stopsig") = 0
	set ^%ZAPM.ed.BSFTconf("log") = 1
	kill ^%ZAPM.ed.BSFTlog
	job DaemonMainLoop
	write "FTS daemon has been rised " _ $ztime($piece($horolog, ",", 2), 1)
	quit
	;
stop
	quit:($get(^%ZAPM.ed.BSFTconf("stopsig"), 1))
	set ^%ZAPM.ed.BSFTconf("stopsig") = 1
	write "FTS daemon has been killed " _ $ztime($piece($horolog, ",", 2), 1)
	quit
	;
restart
	do stop
	do start
	quit
	;
setport(p)
	set ^%ZAPM.ed.BSFTconf("port") = +p
	write "FTS daemon's port is set to " _ p _ "."
	quit
	;
settimeout(t)
	set ^%ZAPM.ed.BSFTconf("timeout") = +t
	write "FTS daemon's timeout is set to " _ t _ "."
	quit
	;
ErrHandler
	set $ztrap = ""
	if ($data(device)) close device
	do PutLog("Daemon error: $ZE = " _ $ze _ "; $ZC = " _ $zc)
	quit
	;
TErrHandler
	set $ztrap = ""
	do PutLog("Thread error: $ZE = " _ $ze _ "; $ZC = " _ $zc)
	lock
	if ($ze '= "") goto PopCmd
	close $principal
	quit
	;
DaemonMainLoop
	new port, device, timeout, ip, buf
	set $ztrap = "ErrHandler"
	set port = $get(^%ZAPM.ed.BSFTconf("port"), 1961)
	set timeout = $get(^%ZAPM.ed.BSFTconf("timeout"), 30)
	set device = "|TCP|" _ port
	; You can include the “A” mode parameter in the OPEN command
	; to make the initial READ complete as soon as the server accepts the connection.
	open device:(:port:"A"):timeout
	if ('$test) {
		do PutLog("Can't open device " _ device _ ".")
		quit
	}
	set ^%ZAPM.ed.BSFTconf("PID") = $job
	do PutLog("Daemon rised @ " _ device _ port)
	while ('$get(^%ZAPM.ed.BSFTconf("stopsig"), 0)) {
		use device
		read buf:1
		if ($test) {
			set ip = $A($ZU(111,0),1)_"."_$A($ZU(111,0),2)_"."_$A($ZU(111,0),3)_"."_$A($ZU(111,0),4)_":"_($A($ZU(111,0),5)*256+$A($ZU(111,0),6))
			do PutLog("New connection detected from " _ ip)
			job NewThread:(:5:device:device)
			if ($zchild = 0) do PutLog("Daemon can't create new thread!")
		}
	}
	close device
	set ^%ZAPM.ed.BSFTconf("PID") = ""
	do PutLog("Daemon killed.")
	quit
	;
NewThread
	new s, cmd, pn, logoutsig
	set logoutsig = 0
	do PutLog("Client thread has been started." _ $principal)
PopCmd
	set $ztrap = "TErrHandler"
	while (1) {
		if ($$WaitSinhro(10)) {
			write !
			if ($$SocGet(.s, 2)) {
				set cmd = $ascii(s, 1), pn = $ascii(s, 2)
				do PutLog("Client -> cmd = " _ cmd _ "; par_num = " _ pn)
				do $case(cmd, 64:cmdTEST, 1:cmdGETFILE, 2:cmdPUTFILE, 3:cmdGETLIST, 4:cmdLOGOUT, 5:cmdDELFILE, 7:cmdLOGIN, 8:cmdFILESIZE, :cmdUNKNOWN)
			} else {
				quit
			}
			quit:(logoutsig || $get(^%ZAPM.ed.BSFTconf("stopsig"), 0))
		}
	}
	if (logoutsig) {
		do PutLog("Client logged out. Thread closes.")
	}
	close $principal
	quit
	;
cmdUNKNOWN
	do PutLog("Unknown command has been detected. <" _ cmd _ ">")
	do SocPut(1, "Unknown command ID:" _ cmd)
	quit
	;
cmdTEST
	do PutLog("Client -> CMD_TEST")
	do SocPut(8, "I'm here!")
	quit
	;
cmdLOGOUT
	do PutLog("Client -> CMD_LOGOUT")
	do SocPut(0, "Session logged out")
	set logoutsig = 1
	quit
	;
cmdDELFILE
	new FName
	do PutLog("Client -> CMD_DELFILE")
	do GetStrParam(.FName)
	do PutLog("Client -> CMD_DELFILE -> filename = " _ FName)
	if ('##class(%File).Exists(FName)) {
		do SocPut(13, "File didn't exists.")
		quit
	}
	if ('##class(%File).Delete(FName)) {
		do SocPut(13, "Can't delete file.")
		quit
	}
	do SocPut(0, "File was deleted.")
	quit
	;
cmdGETFILE
  new FName, FLen, DataBuf, BlockLen
  do PutLog("Client -> CMD_GETFILE")
  do GetStrParam(.FName)
  do PutLog("Client -> CMD_GETFILE -> filename = " _ FName)
  do GetIntParam(.BlockLen)
  do PutLog("Client -> CMD_GETFILE -> blocksize = " _ BlockLen)
  set SrcFile = ##class(%File).%New(FName)
  set ok = SrcFile.Open("RU")
  if 'ok do SocPut(13, "Can't open specified file.") quit
  set FLen = SrcFile.SizeGet
  if (FLen > 0) {
    do SocPut(6, "Ready to send.")
    write $zlc(FLen)
  } Else {
		do SrcFile.Close()
		do SocPut(13, "Zero-length file. Nothing to send.")
    quit
  }
  while (FLen > 0) {
    if (FLen < BlockLen) set BlockLen = FLen
    set DataBuf = SrcFile.Read(BlockLen)
    write DataBuf
    set FLen = FLen - $length(DataBuf)
  }
  do SrcFile.Close()
  do SocPut(0, "Transfer successed: "_FName_", length: "_SrcFile.SizeGet)
  ;do SocFlush()
	quit
	;
cmdPUTFILE
  new FName, FLen, DataBuf, BlockLen
  do PutLog("Client -> CMD_PUTFILE")
  do GetStrParam(.FName)
  do PutLog("Client -> CMD_PUTFILE -> filename = " _ FName)
  do GetIntParam(.FLen)
  do PutLog("Client -> CMD_PUTFILE -> filesize = " _ FLen)
  Do GetIntParam(.BlockLen)
  do PutLog("Client -> CMD_PUTFILE -> blocklen = " _ BlockLen)
  set DestFile = ##class(%File).%New(FName)
  set ok = DestFile.Open("WSN")
  if ('ok) do SocPut(13, "Can't open specified file.") quit
  do SocPut(6, "Ready to receive.")
  while (FLen > 0) {
    if (FLen < BlockLen) set BlockLen = FLen
  	read DataBuf#BlockLen:15
  	do DestFile.Write(DataBuf)
  	set FLen = FLen - BlockLen
  }
  do DestFile.Close()
  do SocPut(0, "Transfer succeed. "_FName_" length: "_(DestFile.SizeGet - FLen))
  ;do SocFlush()
	quit
	;
cmdGETLIST
	new mode, path, wc, rset, ResultBuf
	do PutLog("Client -> CMD_GETLIST")
	do GetStrParam(.path)
	do PutLog("Client -> CMD_GETLIST -> path = " _ path)
	do GetStrParam(.wc)
	do PutLog("Client -> CMD_GETLIST -> wildcard = " _ wc)
	do GetIntParam(.mode)
	do PutLog("Client -> CMD_GETLIST -> mode = " _ mode)
  if ('##class(%File).DirectoryExists(path)) {
    do SocPut(13, "Specified path didn't exists.")
    quit
  }
  set rset = ##class(%ResultSet).%New("%Library.File:FileSet")
  do rset.Execute(path, wc, "ItemName", 1)
  set ResultBuf = ""
  while (rset.Next(.fEnt)) {
    if ($SYSTEM.Status.IsOK(fEnt)) {
		  if (mode = "1") {
		  	set ResultBuf = ResultBuf _ rset.Data("ItemName") _ ":" _ rset.Data("Type")
		  	if (rset.Data("Type") = "F") {
		  		set ResultBuf = ResultBuf _ ":" _ rset.Data("Size")
		  	} else {
			  	set ResultBuf = ResultBuf _ ":<DIR>"
			  }
		  	set ResultBuf = ResultBuf _ ";"
	  	} elseif (mode = "0") {
				if (rset.Data("Type") = "F") {
	      	set ResultBuf = ResultBuf _ rset.Data("ItemName") _ ":" _	rset.Data("Size") _ ";"
				}
		  } elseif (mode = "2") {
	  	  if (rset.Data("Type") = "D") {
	    	  set ResultBuf = ResultBuf _ rset.Data("ItemName") _ ";"
		    }
		  }
    }
  }
  if ($SYSTEM.Status.IsError(fEnt)) {
    do SocPut(13, "Query error.")
    quit
  } else {
	  do SocPut(6, "Ready to send. Block length:" _ $zlc($length(ResultBuf)))
	  write $zlc($length(ResultBuf))
  }
  do rset.Close()
  if ($length(ResultBuf) > 0) {
  	;do SocPut(6, "Ready to send. Folder content.")
  	write ResultBuf
  }
  do SocPut(0, "All done.")
  ;do SocFlush()
	quit
	;
cmdFILESIZE
	new FileName, FileSize
	do PutLog("Client -> CMD_FILESIZE")
	do GetStrParam(.FileName)
	do PutLog("Client -> CMD_FILESIZE -> path = " _ FileName)
	if ('##class(%File).Exists(FileName)) {
		do SocPut(13, "Specified file didn't exists.")
		quit
	}
	set FileSize = ##class(%File).GetFileSize(FileName)
	do PutLog("Client -> CMD_FILESIZE -> size = " _ FileSize)
	do SocPut(6, "Ready to send. File size.")
	write $zlc(FileSize)
	do SocPut(0, "All done.")
	quit
	;
cmdLOGIN
	new user, pass, root, rights
	do PutLog("Client -> CMD_LOGIN")
	do GetStrParam(.user)
	do PutLog("Client -> CMD_LOGIN -> user = " _ user)
	do GetStrParam(.pass)
	do PutLog("Client -> CMD_LOGIN -> pass = " _ pass)
	do GetStrParam(.root)
	do PutLog("Client -> CMD_LOGIN -> root = " _ root)
	do GetStrParam(.rights)
	do PutLog("Client -> CMD_LOGIN -> rights = " _ rights)
	; проверка параметров и установка loguotsig в 1 или возврат
	do SocPut(7, "Ident OK")
	quit
	;
GetIntParam(num, tout)
	new result
	set result = $$SocGet(.num, 4, 5)
	set num = $zla(num)
	quit result
	;
GetStrParam(str, tout)
	new result, len
	set result = $$SocGet(.len, 4, 5)
	set result = $$SocGet(.str, $zla(len), 5)
	quit result
	;
SocFlush()
	read *a:1 quit:((a = -1) || '$test)
	quit 1
	;
SocGet(str, len, tout)
	set len = $get(len, 0), tout = $get(tout, 5)
	if (len = 0) quit 0
	read str#len:tout
	quit ($test && ($length(str) = len))
	;
SocPut(code, msg)
	new pack
	do SocFlush()
	set pack = $zlchar(+$get(code)) _ $zlchar($length($get(msg))) _ $get(msg)
	write pack, !
	quit
	;
WaitSinhro(tout)
  new i, a, t1, za 
  set i=0, tout = $get(tout, 5), t1 = $zh
  while (1) {
		quit:((i = 4) || $get(^%ZAPM.ed.BSFTconf("stopsig"), 0) || ((tout > 0) && ($zh-t1 > tout)))
		read *a:1 
		set za = $za, zh = $zh
		if (a > 0) set i = $select(a=254:i+1, 1:0)
		;do PutLog("SYNHRO -> a = "_a_"; i = "_i)
  }
  quit (i = 4)
  ;
PutLog(text)
	quit:('$get(^%ZAPM.ed.BSFTconf("log"), 1))
	new i set i = $get(^%ZAPM.ed.BSFTlog, 0)
	set ^%ZAPM.ed.BSFTlog(i) = text
	set ^%ZAPM.ed.BSFTlog = i + 1
	quit
	;
]]></Routine>


<Routine name="%ZAPM.ed.BSmirGL" type="MAC" languagemode="0"><![CDATA[
%BSmirGL ;ПРОГРАММА РАБОТЫ С ГЛОБАЛЬНЫМИ БУФЕРАМИ ; 17:01   21.07.2003
 ;
 ;    Copyright Serge Mikhaylenko
 ;    			Andry Mirenburg
 ;    All Rights Reserved
 ;
 ;
 Q
LISTPART1() ;ВЕРНУТЬ СПИСОК РАЗДЕЛОВ
 N A
 S A=$$SW^%ZAPM.ed.BSF12("^%ZAPM.ed.BSETUP")
 S A=$P($G(@A@("SERVER",8,4)),"@",15)
 Q A
LISTPART2() ;ВЕРНУТЬ СПИСОК РАЗДЕЛОВ - ЭМУЛЯЦИЯ $$BSR^%ZAPM.ed.BSCi(...) ////!!! ПЕРЕДЕЛАТЬ КАК В $$GD^%ZAPM.ed.BSCp(
 ;P1=КОЛИЧЕСТВО
 ;P2=ТИПЫ_$C(1)_"...
 ;P3=КОМЕНТАРИИ_$C(1)_"...
 ;VALUE="GL1"_$C(1)_"GL2~..." МАССИВЫ
 N B,I
 S B=$$LISTPART1(),P2="",P3=""
 F I=1:1 Q:$P(B," ",I,I+1)=""  S P2=P2_"P"_$C(1) D
 .S A=$G(@($P(B," ",I)))
 .S P3=P3_$P(A,"@",2)_$C(1)
 S P1=I-1
 D MAINVAR^%ZAPM.ed.BSC4,GlobBuff(.BB) I $D(BB) S C0="" F  S C0=$O(BB(C0)) Q:C0=""  D
 .S P1=P1+1,P2=P2_"P"_$C(1),P3=P3_$P($G(@BB(C0)),"@",2)_$C(1),B=B_" "_BB(C0)
 Q $TR(B," ",$C(1))
LISTTAB(G) N C,i,I,ii    ;ВЕРНУТЬ СПИСОК ТАБЛИЦ
 S C="",P1=0,P4="",P3="",P2=""
 S I="" F  S I=$O(@G@(I)) Q:I=""  S ii=$G(@G@(I)) D
 .S P4=P4_$P(ii,"@",17)_$C(1)              ;ТИПЫ
 .S P2=P2_$$TIP^%ZAPM.ed.BS($P(ii,"@",17))_$C(1)  ;ТЕКСТ ТИПОВ
 .S P3=P3_$P(ii,"@")_$C(1)               ;КОМЕНТАРИИ
 .S C=C_I_$C(1),P1=P1+1
 Q C
RELOADL() S BSLABEL="LISTP^~BSmirGL"
 Q "<A HREF='"_$$ADDBSGET^%ZAPM.ed.BSC4_"' title='Обновить окно'><img src='"_BSDOMAIN_"/img/refr.gif' border=0></A>"_BK
VAR  /*
 Включенный Параметр "AsysEInoActivX" в "Синем молотке" оставляет только три кнопки в режиме "Готовые отчеты" 
   - Предварительный просмотр
   - Экспорт в Exсel без разбора по полям
   - Экспорт в Exсel с разбором по полям
  Отстальные выключает
 */
 S noE=$$GETOPT^%ZAPM.ed.BSC4cfgP("^%ZAPM.ed.BSETUP(""ISS"")","AsysEInoActivX") 
 S noE2=0 //ЗАПУСКАТЬ ВНЕШНИЕ ПРИЛОЖЕНИЯ ПО НОВОМУ - ЧЕРЕЗ ПЕВДОГИПЕРСОБЫТИЯ
 Q 
LISTP ;ВЫВЕСТИ ВСЕ ГЛОБАЛЬНЫЕ БУФЕРА toolbar_icon_menu.gif
 I $G(^%ZAPM.ed.BS("Config"))="ASU" g AllPart^%ZAPM.ed.BSCrep
 D VAR
 I noE2 D  Q
 .D BEG1^%ZAPM.ed.BSC4 W "<H2><img border=0 src='"_BSDOMAIN_"/img/toolbar_icon_menu.gif' ALT=''> Выбирайте разделы готовых отчетов</H2>"
 .D JS^%ZAPM.ed.BSCp
 .w "parent.U1.location='"_$$ADDBSGET^%ZAPM.ed.BSC4(,"LISTPno^~BSmirGL")_"';"_BK
 .D JSE^%ZAPM.ed.BSCp
 .D END^%ZAPM.ed.BSC4
LISTPno D BEG1^%ZAPM.ed.BSC4,VAR
 N BSGRANT,BSTOP,BSTOP1,C0,C1,NT,BB,A
 S B=$$LISTPART1() 
 I noE2 W "<H1 class=s3><CENTER><font color=#FFFFFF>Готовые отчеты"_EF_"</CENTER></H1>"
 W "<TABLE border=0 width=100% >"
 W "<TR><TD class=s3 WIDTH=40% >"_$$RELOADL_"Список глобальных буферов</TD><TD  WIDTH=5% class=s3>Количество</TD><TD class=s3>Комментарий</TD></TR>"
 F I=1:1 Q:$P(B," ",I,I+1)=""  W $$PART($P(B," ",I))
 W "<TR><TD class=s3 WIDTH=15% >Личный раздел</TD><TD  WIDTH=5% class=s3>Количество</TD><TD class=s3>Комментарий</TD></TR>"
 W $$PART($$cB^%ZAPM.ed.BSSV)
 d   W $$PART(A)
 .n %BS,BSLOGIN s (%BS(12),BSLOGIN)="NoNameUser",A=$$cB^%ZAPM.ed.BSSV
  N GetAccLU I $$GetAcc^%ZAPM.ed.BSC4cfgP(BSLOGIN,"TRMA")>3!($g(aCCrep)>4) D  //ТЕРМИНАЛЬНЫЙ ДОСТУП ! tabel2005         //АДМИНИСТРАТОР СМОТРИТ ВСЕ ЛОКАЛЬНЫЕ БУФЕРА
 .S C0="" D
 ..W "<TR><TD class=s3 WIDTH=15% >Список локальных буферов</TD><TD  WIDTH=5% class=s3>Количество</TD><TD class=s3>Комментарий</TD></TR>"
 ..D GlobBuff(.BB) I $D(BB) S C0="" F  S C0=$O(BB(C0)) Q:C0=""  I C0'=BSLOGIN W $$PART(BB(C0))
 W "<TR><TD class=s3 WIDTH=40% ></TD><TD WIDTH=5% class=s3></TD><TD class=s3 ALIGN=RIGHT>"_$$RELOADL_"</TD></TR>"        
 W "</TABLE>"
 W "<div style='display:none;' id='ReportS2'><IFRAME HEIGHT='1400px' width=900px SRC='' name='ReportS3' SCROLLING='auto'></IFRAME></div>"
 D END^%ZAPM.ed.BSC4
 Q
GlobBuff(BB) N C0,NT //ВЕРНУТЬ СУЩЕСТВУЮЩИЕ БУФЕРА
 S C0="" F  S C0=$O(@BDUSE@(C0)) Q:C0=""  D
 .N A S A=$$SW^%ZAPM.ed.BSF12("^%ZAPM.ed.BSbufS")
 .S NT=$NA(@(A_$$2LAT^%ZAPM.ed.BSCp(C0)))
 .I $$Data^%ZAPM.ed.BSF12(NT) S BB(C0)=NT I $G(@NT)="" S @NT="BaSe MsW @Глобальный буфер"
 Q
PART(P) N A1,A2,C0,C1,BSGRANT S A1="<TR><TD class=s1>",A2="</TD></TR>"
 I '$$Data^%ZAPM.ed.BSF12(P) Q A1_"<BUTTON DISABLED title='раздел не доступен'>"_P_"</BUTTON></TD><TD class=s1>0</TD><TD class=s1>"_RED_"раздел не доступен"_EF_A2
 S C1="",C0=0 F  S C1=$O(@P@(C1)) Q:C1=""  I "12345"[$P($G(@P@(C1)),"@",17) S C0=C0+1
 S BSLABEL="REPORTS^~BSmirGL",BSmirPART=$$%T^%ZAPM.ed.BSCh(P),NamF="ReportS3" //,NamF="Par"_$$FrameName(P)
 //I noE2 S NamF="D1"
 //S Q=A1_"<BUTTON onclick=""javascript: "_NamF_"=window.open('"_$$ADDBSGET^%ZAPM.ed.BSC4_"','"_NamF_"','toolbar=no,menubar=no,scrollbars=yes,width=800,height=600,status=1,resizable=1'); "_NamF_".close(); "_NamF_"=window.open('"_$$ADDBSGET^%ZAPM.ed.BSC4_"','"_NamF_"','toolbar=no,menubar=no,scrollbars=yes,width=800,height=600,status=1,resizable=1');"" title='Открыть список из "_C0_" таблиц'>"_P_"</BUTTON>"
 S Q=A1_"<BUTTON onclick=""open('"_$$ADDBSGET^%ZAPM.ed.BSC4_"','"_NamF_"','toolbar=no,menubar=no,scrollbars=yes,width=800,height=600,status=1,resizable=1'); ReportS2.style.display='block';"" title='Открыть список из "_C0_" таблиц'>"_P_"</BUTTON>"
 s a3=$P($G(@P),"@",2) i a3="" s a3="раздел пользователя"
 S Q=Q_"</TD><TD class=s1>"_C0_"</TD><TD class=s1>"_a3_A2_BK
 Q Q
FrameName(P) I P["]" Q $P(P,"]",2)
 I P["%" Q $P(P,"%",2)
 Q P
 /*
 var NW;  ($2==null)
</SCRIPT>
 <INPUT type=button onclick="javascript:NW=window.open('','','width=725,height=500,resizable=yes,left=100,top=100');">
 <INPUT type=button onclick="javascript:NW.close();">
 */
BOF ;НАЧАЛО ФАЙЛА HTML(Фреймовая структура)
 w "<HTML>",BK,"<HEAD>",BK,"<TITLE>",$G(CAPTION),"</TITLE>"
 w "</HEAD>",BK
 q
 
EOF ;ЗАВЕРШЕНИЕ ФАЙЛА HTML
 w "</HTML>",BK
 q
CALL(SP) N I,S,GT,DEL,A 
 I $G(SP),$D(@BDSES@(BSSES,"VAR","SPOOL",BSmirTAB)) D  Q
 .S GT=$ZR F I=1:1 Q:'$D(@GT@(I))  W @GT@(I)
 //ВЫВОД ПРИ ОТСУТСВИИ СПУЛЕРА
 S GT="ZZZ",DEL=$C(13,10)
 S A=$$BS2EXCEL^%ZAPM.ed.BSCi($NA(@P@(BSmirTAB)),GT,1,1000,DEL,"","","","")
 F I=1:1:A W @GT@(I)_DEL
 Q
CVAL i $d(BSmirPART) S P=$$%^%ZAPM.ed.BSCh(BSmirPART)
 i $g(BSitem)'="" d  //это готовится в PartList^%ZAPM.ed.BSCp2
 .s a=$$b64d^%ZAPM.ed.BSCp2(BSitem)
 .s BSmirTAB=$qs(a,$ql(a)),P=$p(a,""""_BSmirTAB) i $e(P,$l(P))="," s P=$e(P,1,$l(P)-1)_")"
 .i $e(P,$l(P))="(" s P=$e(P,1,$l(P)-1)
 Q
CALLCSV  D CVAL
 W $P(@P@(BSmirTAB),"@",1)_BK
 S I="",CSVD=$P($G(@P@(BSmirTAB,"CSV",0),",|"),",",2),ke=$P($G(@P@(BSmirTAB,"CSV",0),",|"),",",3)
 F  S I=$O(@P@(BSmirTAB,"CSV",1,I)) Q:I=""  S A=$TR($G(@P@(BSmirTAB,"CSV",1,I)),BK,"") W A_BK
 Q
CALL1 D CVAL
 ;I P["^^" S P=$$TR^%ZAPM.ed.BSsFUNM(P,"^^","^")
 D CALL(0)
 q
SPOOL(BSmirTAB) I $D(@BDSES@(BSSES,"VAR","SPOOL",BSmirTAB)) Q "SPOOL"
 Q ""
CALL2 //ПРЕДВАРИТЕЛЬНЫЙ ПРОСМОТР
 D BEG1^%ZAPM.ed.BSC4 D CVAL
 S SP=$$SPOOL(BSmirTAB)
 w "<TITLE>"_SP_" "_$P($G(@P@(BSmirTAB)),"@",1)_"</TITLE>"_BK_$$B27^%ZAPM.ed.BSCm4() D BUTTS
 w "<PRE>"_BK
 D CALL(1)
 w "</PRE>"_BK
 D END^%ZAPM.ed.BSC4
 q
BUTTS   I $D(@P@(BSmirTAB,"SQL")) d  q
			.s BSLABEL="BUTTSQLOUT^~BSmirGL"
 			.w "<A HREF='"_$$ADDBSGET^%ZAPM.ed.BSC4_"' title='Вывести таблицу данных без оформления'><IMG  src='"_BSDOMAIN_"/img/sql.gif'  border=0 ></A>"
	//проверка на существованиние в тексте пробелов между *****  *****
	I $p(@P@(BSmirTAB),"@",17)=5 x $G(@P@(BSmirTAB,"RUN")) q
	Q
BUTTCSV	s BSLABEL="BUTTCSVOUT^~BSmirGL"
 	w "<A HREF='"_$$ADDBSGET^%ZAPM.ed.BSC4_"' title='Вывести таблицу данных в формате CSV с разделителем |'><IMG  src='"_BSDOMAIN_"/img/sql.gif'  border=0 ></A> "
 	s BSLABEL="BUTTCSVOUT1^~BSmirGL"
 	w "<A HREF='"_$$ADDBSGET^%ZAPM.ed.BSC4_"' title='Сохранить на диске таблицу данных в формате CSV с разделителем |'><IMG  src='"_BSDOMAIN_"/img/save.gif'  border=0 ></A>"
	;D OutSpool^%ZAPM.ed.BSCpool("S OK=$$MSETSQL^%ZAPM.ed.BSCBD($NA(@P@(BSmirTAB,""SQL"")))")
 	;s BSLABEL="HELPSQL^~BSmirGL"
 	;w " <A TARGET=HELPSQL HREF='"_$$ADDBSGET^%ZAPM.ed.BSC4_"' title='Показать как обратиться к данным этой таблицы по ODBC'><IMG  src='"_BSDOMAIN_"/img/help1.gif'  border=0 ></A>"
	Q
BUTTCSVOUT1  W "HTTP/1.0 200 OK",BK
 W "Content-type: text/comma-separated-values",BK //text/html
 ;W "Set-Cookie: cookie_name=cookie_value; path=/;",CRLF
 ;W "Window-target: main_window",CRLF
 W BK D CSVOUT
 Q
HELPSQL W 222
	Q
CSVOUT D CVAL N FIRST //САМ ВЫВОД
 	S I="" F i=1:1 S I=$O(@P@(BSmirTAB,"SQL",I)) Q:I=""  S:'$D(FIRST) FIRST=I D  W BK
 	.F II=1:1:$O(@P@(BSmirTAB,"SQL",FIRST,""),-1)  W $G(@P@(BSmirTAB,"SQL",I,II))_"|"
 	Q
BUTTCSVOUT W "<PRE>"_BK	D CSVOUT W "<PRE>"	
	Q
BUTTSQLOUT D BEG1^%ZAPM.ed.BSC4 D CVAL w "<TITLE> "_$P($G(@P@(BSmirTAB)),"@",1)_"</TITLE>"_BK_$$B27^%ZAPM.ed.BSCm4()  D BUTTCSV
	W "<TABLE border=0>" N FIRST
 	S I="" F i=1:1 S I=$O(@P@(BSmirTAB,"SQL",I)) Q:I=""  S:'$D(FIRST) FIRST=I W "<TR>" D  W "</TR>"
 	.F II=1:1:$O(@P@(BSmirTAB,"SQL",FIRST,""),-1)  W "<TD class=s1>"_$G(@P@(BSmirTAB,"SQL",I,II))_"</TD>"
	W "</TABLE>"
	D END^%ZAPM.ed.BSC4
	Q
REPORTS ;Фреймы
 s BSmirFlag=0,TITL="GP:"_$$%^%ZAPM.ed.BSCh(BSmirPART)_" = Список отчетов раздела"
 N Tmp W $$TITL^%ZAPM.ed.BSCGIS(TITL)
 D VAR //i 'noE2 G LIST
 W "<FRAMESET rows=""0%,*%,0%""  framespacing=0 border=false frameborder=0 >"_BK
 S BSLABEL="ACTIVEX^~BSmirGL"
 n BSmirAsText
 s BSmirAsText="true"
 W "<FRAME SRC='"_$$ADDBSGET^%ZAPM.ed.BSC4_"' NAME='ACTIVEX' noresize frameborder=0 name='logo' SCROLLING='no'>"_BK
 k BSmirAsText
 S BSLABEL="LIST^~BSmirGL"
 S BSmirFlag=1
 W "<FRAME SRC='"_$$ADDBSGET^%ZAPM.ed.BSC4_"' NAME='LIST' frameborder=0 >"_BK
 W "<FRAME SRC=""/iss/RD/RunDos.htm"" name='rd1' frameborder=0 >"_BK
 W "</FRAMESET>"
 Q
ACTIVEX ;Элемент T2E
 D BEG1^%ZAPM.ed.BSC4 S FFLAG=$G(BSaX,1) //0-СТАРАЯ ВЕРСИЯ ACTIV-X
 w BK_"<HTML>"_BK_"<HEAD>"_BK_"<TITLE>ext2e.CAB</TITLE>"_BK_"</HEAD>"_BK_"<BODY>"
 ;w "<nobr><INPUT title='Экспорт в MS-EXCEL без разбора по полям' NAME=""AsText"" TYPE=""CHECKBOX"""
 ;W $G(BSmirAsText) ;="true" w " checked='true' "
 ;w "> Экспорт в MS-EXCEL без разбора по полям. "
 I BSmirFlag'=1 W $$js^%ZAPM.ed.BSCp_$$Status^%ZAPM.ed.BSCm4("...Выбирайте режим работы с таблицами")_$$jse^%ZAPM.ed.BSCp_BK
 I BSmirFlag=1 {
 S FREEZ=$$FREEZ I FREEZ1'="" S FREEZMAC="w.xls!Лист2.DPAP("""_FREEZ1_""","""_FREEZ2_""");"
 E  S FREEZMAC=""
 W $$js^%ZAPM.ed.BSCp_$$Status^%ZAPM.ed.BSCm4(" ...Ждите идет загрузка в MS-EXCEL")_$$jse^%ZAPM.ed.BSCp_BK
 
 
 I FFLAG=1 D  I 1 //ПОКА ТОЛЬКО ДЛЯ МЕНЯ
 .W "<OBJECT ID='Preparation' CLASSID='clsid:56F7E626-77D3-11D6-82F9-00A02479C353'>"_BK
 .//W "<PARAM NAME=FileName VALUE='c:\tabl.txt'>"_BK
 .I FREEZ'="" D
 ..W "<PARAM NAME=FilePattern VALUE='http://"_$$ADDSN^%ZAPM.ed.BSC4_"/vv/u/bin/w.xls'>"_BK
 ..W "<PARAM NAME=Macro VALUE='Лист2;w.xls!Лист2.DSR("""_FREEZ_""","_(+$G(ToInt))_");"_FREEZMAC_"'>"_BK
 E  w "<OBJECT ID='T2E' CLASSID='CLSID:7574C5B9-B43D-11D6-A477-0004761A76C9' CODEBASE='"_BSDOMAIN_"/js/ext2e.CAB#version=1,0,0,0'>"_BK
 n I,J,K
 s I="",J="",K="",BSLABEL="CALL1^~BSmirGL"
 I CSV'="" W "<PARAM NAME=CSV VALUE=1>"_BK D  S BSLABEL="CALLCSV^~BSmirGL"
 .W "<PARAM NAME=Start VALUE=2>"_BK
 .W "<PARAM NAME=Del VALUE='"_CSVD_"'>"_BK
 w "<PARAM NAME='FileName' VALUE='http://"_$$ADDSN^%ZAPM.ed.BSC4_$$ADDBSGET^%ZAPM.ed.BSC4_"'>",BK
 W "<PARAM NAME=AllSeparator VALUE=''>"_BK
 W "<PARAM NAME=VerticalSeparator VALUE=''>"_BK
 W "<PARAM NAME=HorizontalSeparator VALUE=''>"_BK
 W "<PARAM NAME=ANSI1_ASCII2_Default0 VALUE=0>"_BK
 W "<PARAM NAME=ExcelVisible VALUE=0>"_BK
 W "<PARAM NAME=TypeBorder VALUE=0>"_BK
 i BSmirAsText="false" w "<PARAM NAME=""AsText"" VALUE=0>",BK
 i BSmirAsText="true" w "<PARAM NAME=""AsText"" VALUE=1>",BK
 w "</OBJECT>"_BK
 }
 w "<BR></BODY>"_BK_"<BR></HTML>"
 D END^%ZAPM.ed.BSC4
 Q
COLS(JJ) N A S A=","_$$COL_"," I A'[(","_JJ_",") Q "" 
 S AA=$P(A,","_JJ_",",1)
 Q $L(AA,",")
COLN(JJ) I JJ=0 S JJ=1
	Q $P($$COL,",",JJ)
COL() N A 
 S A="A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,AA,AB,AC,AD,AE,AF,AG,AH,AI,AJ,AK,AL,AM,AN,AO,AP,AQ,AR,AS,AT,AU,AV,AW,AX,AY,AZ,BA,BB,BC,BD,BE,BF,BG,BH,BI,BJ,BK,BL,BM,BN,BO,BP,BQ,BR,BS,BT,BU,BV,BW,BX,BY,BZ,CA,CB,CC,CD,CE,CF,CG,CH,CI,CJ,CK,CL,CM,CN,CO,CP,CQ,CR,CS,CT,CU,CV,CW,CX,CY,CZ,DA,DB,DC,DD,DE,DF,DG,DH,DI,DJ,DK,DL,DM,DN,DO,DP,DQ,DR,DS,DT,DU,DV,DW,DX,DY,DZ,EA,EB,EC,ED,EE,EF,EG,EH,EI,EJ,EK,EL,EM,EN,EO,EP,EQ,ER,ES,ET,EU,EV,EW,EX,EY,EZ"
 S A=A_",FA,FB,FC,FD,FE,FF,FG,FH,FI,FJ,FK,FL,FM,FN,FO,FP,FQ,FR,FS,FT,FU,FV,FW,FX,FY,FZ,GA,GB,GC,GD,GE,GF,GG,GH,GI,GJ,GK,GL,GM,GN,GO,GP,GQ,GR,GS,GT,GU,GV,GW,GX,GY,GZ,HA,HB,HC,HD,HE,HF,HG,HH,HI,HJ,HK,HL,HM,HN,HO,HP,HQ,HR,HS,HT,HU,HV,HW,HX,HY,HZ,IA,IB,IC,ID,IE,IF,IG,IH,II,IJ,IK,IL,IM,IN,IO,IP,IQ,IR,IS,IT,IU,IV"
 Q A
FREEZ()
 N I,J,FREEZ,G,I,II,J,JJ,X,Y,A,AA
 S P=$$%^%ZAPM.ed.BSCh(BSmirPART),FREEZ1="",FREEZ2=""
 S EO=$P($G(@P@(BSmirTAB,"ExcelOut")),",",1)
 S CSV=$G(@P@(BSmirTAB,"CSV")),CSVD=$P($G(@P@(BSmirTAB,"CSV",0),",|"),",",2)
 S (AA,I)=$P(@P@(BSmirTAB),"@",50),X=$P(I,",",2),Y=$P(I,","),G=$ZR
 I AA="" S (AA,I)=$P(@P@(BSmirTAB),"@",19),X=$P(I,",",2),Y=$P(I,",")
 I AA="" Q ""  ;"A1"
 S II=0 F I=1:1:(Y-1) S II=II+$P(@G@(I,1),"@",3)
 S JJ=0,II=II+1-3 F J=1:1:X I $P(@G@(1,J),"@",4)'=1 S JJ=JJ+1
 S FREEZ=$$COLN(JJ)_II
 I +$P(EO,"@") S FREEZ1="$"_(II-$P(EO,"@"))_":$"_(II-1)
 I +JJ S:JJ=1 JJ=2 S FREEZ2="$A:$"_$$COLN(JJ-1)
 
 ;W $$js^%ZAPM.ed.BSCp         W "alert('"_JJ_"')"_BK               W $$jse^%ZAPM.ed.BSCp_BK
 
 Q FREEZ
noE D locvar^%ZAPM.ed.BSCh0("",1)
 q
LIST ;Список сводок из заданного массиваC
 S TITL="Список отчетов"
 D BEG1^%ZAPM.ed.BSC4,VAR  W $$TITL^%ZAPM.ed.BSCGIS(TITL) i 'noE2 w $$B27^%ZAPM.ed.BSCm4("parent.")
 D BACK N BSNOREG,BSTOP2
 D VAR
 w "<script language=""JavaScript"">",BK
 w "function UPDATEACTIVEX(URLmir,MODE1) {",BK
 I noE2 d  
 .s BSLABEL="ACTIVEX^~BSmirGL",BSmirFlag=1
 .w "parent.ACTIVEX.location='"_$$ADDBSGET^%ZAPM.ed.BSC4_"'+URLmir+'&BSmirAsText='+MODE1;",BK
 E  d
 .//загрузка в Excel текста из URL НОВАЯ ОПЦИЯ У put2registr.exe
 .W "var u2='"_$$ADDBSGET^%ZAPM.ed.BSC4(,"HyperRunwin^~BSCp2")_"&BSa1=put2registr.exe&BSa3="_$$DR^%ZAPM.ed.BSCp2_"&BSa2=inbuff&BSa4='+MODE1+URLmir;"_BK
 .;;W "alert(u2);"_BK
 .W "window.open(u2,""ACTIVEX"",""toolbar=no,menubar=no,scrollbars=yes,width=1,height=1,status=1,resizable=1"");"_BK
 w "}",BK
 
 w "function VIEW(URLmir){",BK
 //W "alert(URLmir);"_BK
 s BSLABEL="ACTIVEX^~BSmirGL",BSmirFlag=0
 I 'noE w "parent.ACTIVEX.location='"_$$ADDBSGET^%ZAPM.ed.BSC4_"';",BK
 E  s BSLABEL="CALL2^~BSmirGL" D
 .w "window.open('"_$$ADDBSGET^%ZAPM.ed.BSC4_"'+URLmir,'view',""toolbar=no,menubar=yes,scrollbars=yes,width=800,height=600,status=1,resizable=1"");"_BK
 w "}",BK
 
 w "function TELNET(EDIT,TABL,TITLE) {",BK
 s BSLABEL="ACTIVEX^~BSmirGL",BSmirFlag=0
 w "parent.ACTIVEX.location='"_$$ADDBSGET^%ZAPM.ed.BSC4_"';",BK
 w "parent.rd1.RDos.RunOption=1;"_BK
    S P=$$%^%ZAPM.ed.BSCh(BSmirPART) ;ОБРАТНО
 w "parent.rd1.RDos.WorkDir=parent.rd1.RDos.DvDir();"_BK                 // /c=1 - 132
 S FTerm=$$FTerm^%ZAPM.ed.BSCmDDR
 ;;;;;;;;;;;;;;;;;;;;;;;;;N tcpPORT S tcpPORT=$$PORT^%ZAPM.ed.BSpgTEL i tcpPORT="" k tcpPORT
 ////////////// CTERM
 ;пример                     'BSCacheTel.exe 190.98.101.61 /x=^[""GLAVK""]GlobTAB /s=Styx /t='+TABL+' /y='+EDIT+' /f='+TITLE+'(mswdell)_ /i=121' ;
 I FTerm=1 w "parent.rd1.RDos.Command='BSCacheTel.exe "_$p($$ADDSN^%ZAPM.ed.BSC4,":")_" /x="_$$TR^%ZAPM.ed.BSsFUNM(P,$C(34),$C(34,34))_" /p="_$G(tcpPORT,$G(TelPort,23))_" /s="_BSLOGIN_" /t='+TABL+' /v="_$$VerTelnet^%ZAPM.ed.BSCp_" /y='+EDIT+' /f="_$$nse^%ZAPM.ed.BSCmDDR_"'+TITLE+' /i="_BSSES_"' ;"_BK
 ;а выполняется программа    D BST^%ZAPM.ed.BSC("","[""GLAVK""]GlobTAB","GLAVK__JIL!1!Q50301_2","1","","Styx","121")
 ;
 //////////////// SOCKTERM
 ;пример                     AdvSockTerm.exe server="mswdell" port="23" user="SYS" psw="XXX" cmdline="D ^%SS" title="asasas"
 I FTerm=2 D
 .W "var cmdline='""D BST^^%ZAPM.ed.BSC("""""","""""_$$TR^%ZAPM.ed.BSsFUNM(P,$C(34),$C(34,34,34))_""""",""""'+TABL+'"""",""""'+EDIT+'"""","""""""","""""_BSLOGIN_""""","""""_BSSES_""""")'; "_BK
 .;W "alert(cmdline);"_BK
 .w "parent.rd1.RDos.Command='AdvSockTerm.exe server="""_$p($$ADDSN^%ZAPM.ed.BSC4,":")_""" port="""_$G(tcpPORT,$G(TelPort,23))_""" user=""SYS"" psw=""XXX"" cmdline=""'+cmdline+'"" title="""_$$nse^%ZAPM.ed.BSCmDDR_"'+TITLE+'""' ;"_BK
 ////////////////
 
 w "parent.rd1.RDos.RunCommand();"_BK
 w "}",BK
 
 w "function DVSTART(URLmir) {",BK
 s BSLABEL="ACTIVEX^~BSmirGL",BSmirFlag=0
 w "parent.ACTIVEX.location='"_$$ADDBSGET^%ZAPM.ed.BSC4_"';",BK
 w "parent.rd1.RDos.RunOption=1;"_BK
 w "parent.rd1.RDos.WorkDir=parent.rd1.RDos.DvDir();"_BK
 D
 .N A S A=BSmirPART N BSmirPART,BSLOGINDFLT,BSGRAND,BSLNG
 .s BSLABEL="CALL1%5E~BSmirGL",BSEXT="txt",BSmirPART=$$TR^%ZAPM.ed.BSsFUNM(A,"^","%5E")
 .;W "prompt('!!!!','DV.exe http://"_$$ADDSN^%ZAPM.ed.BSC4_$TR($$ADDBSGET^%ZAPM.ed.BSC4,"&|","*@")_"'+URLmir);"_BK
 .w "parent.rd1.RDos.Command='DV.exe http://"_$$ADDSN^%ZAPM.ed.BSC4_$TR($$ADDBSGET^%ZAPM.ed.BSC4,"&|","*@")_"'+URLmir;"_BK
 .w "parent.rd1.RDos.RunCommand();"_BK
 .w "}",BK
 /*
 
 BSEXT= - РАСШИРЕНИЕ ПО КОТОРОМУ dv БУДЕТ ЗАПУСКАТЬ ТО ЧТО ПРИДЕТ ПО http
    txt - ЗАГРУЖАЕТ tv
 
 */
 w "</script>",BK
 //---Контекстное меню  ---
 D OnContextMenu^%ZAPM.ed.BSmirJS
 W "<SCRIPT>var BSmirTAB_oncontext = 0;</SCRIPT>"
 //---
 n I,J,K,TRMA,SPO,ST,TIT,DIS,nn,TIT1,zBS4cfg 
 s I="",J="",K=""  N GetAccLU S TRMA=$$GetAcc^%ZAPM.ed.BSC4cfgP(BSLOGIN,"TRMA") //ТЕРМИНАЛЬНЫЙ ДОСТУП РАЗРЕШЕН ЛИ
 I P=$$cB^%ZAPM.ed.BSSV S TRMA=5
 W "<form action="""_$$ADDLIB^%ZAPM.ed.BSC4()_""" method=""POST"">"
 S BSLABEL="Act^~BSmirGL"
 D ADDBSPOST^%ZAPM.ed.BSC4reg
 
 w "<TABLE WIDTH=100% border=""0"">"
 w "<TR><TD class=s3>"_$$RELOAD_" Имя Таблицы</TD><TD class=s3>Действие</TD><TD class=s3>Комментарий к таблице, находящейся в разделе <strong>"_RED_P_EF_"</strong></TD><TD class=s3>"_$$ChKill("CKA","Удалить все таблицы")_""_$$SUB_"</TD></TR>"
 f nn=1:1 s I=$O(@P@(I)) q:I=""  i $e(I,1)'="@" d
 .w "<TR>" N CSV,COM,STS S COM=$P(@P@(I),"@",1) ;КОМЕНТАРИЙ
 .S DIS="DISABLED",TIT="Занята пользователем! ",ST=2,RAZ=$$RAZ,SPO=$$SPOOL(I)
 .L +@P@(I):0 I  S DIS="",TIT="",ST=1 L -@P@(I)
 .S TIT1=$S(SPO'="":"",1:TIT) I $D(@P@(I,"CSV")) S CSV=$G(@P@(I,"CSV",0)),RAZ=$$RAZ1($P(CSV,",",1),$P(CSV,",",3)),TIT="SQL-отчет."
 .S ImG="" I $G(BSnewREPORT)=I S STS=4,ImG="<img src='"_BSDOMAIN_"/img/access.gif' WIDTH=15 border=0> " //ТЕКУЩИЙ ОТЧЕТ
 .I COM[";ПУСТ" S DIS="",TIT="Пустая! ",SPO="",ST=2
 .I COM["ОШИБКА" S DIS="DISABLED",TIT="ОШИБКА! ",SPO="",ST=2
 . I "Su"[$E(I,1,2) S ST=1
 .w "<TD TITLE='"_$$LAST_"' class=s"_$G(STS,ST)_">"_ImG_I_"</TD>"
 .W "<TD class=s"_$G(STS,ST)_">"_BK
 .W "<BUTTON onclick=""VIEW('&BSmirTAB="_I_"');"" "_$S(SPO="":DIS,1:"")_" title='"_TIT1_"Предварительный просмотр "_SPO_"'><img src='"_BSDOMAIN_"/img/view"_$S(SPO="":"_"_ST,1:"-")_".gif' border=0></BUTTON>"_BK
 .I I["AsIs"!("SuLi"[$E(I,1,2)) D  //НОВЫЙ ТАБЕЛЬ
 ..N BSPART,BSTABL,BSEXT,BSGRANT,BSLOGINDFLT,BSLastForm,BSTOP,BSaX,BSdebug,BSform,BSmenu,BStyle
 ..S BSmirTAB=I,TI1="Экспорт в EXCEL"_BK_BK_$$TIT^%ZAPM.ed.BSCAsIsMod(P,I)
 ..W "<BUTTON onclick=""open('"_$$ADDBSGET^%ZAPM.ed.BSC4(,"LOAD^~BSCAsIs5")_"','NewExcel','toolbar=no,menubar=no,scrollbars=yes,width=800,height=600,status=1,resizable=1')"" "_DIS_" title='"_TIT_$G(TI1)_"'><img src='"_BSDOMAIN_"/img/xls_"_ST_".gif' WIDTH=15 border=0></BUTTON>"_BK
 .E  D  //СТАРЫЙ ТАБЕЛЬ
 ..W "<BUTTON onclick=""UPDATEACTIVEX('&BSmirTAB="_I_"','true');"" "_DIS_" title='"_TIT_"Экспорт в EXCEL без разбора по полям'><img src='"_BSDOMAIN_"/img/bsx_"_ST_".gif' WIDTH=15 border=0></BUTTON>"_BK
 ..W "<BUTTON oncontextmenu='BSmirTAB_oncontext="""_I_"""; showmenuie5();return false;' onclick=""javascript:UPDATEACTIVEX('&BSmirTAB="_I_"','false')"" "_DIS_" title='"_TIT_"Экспорт в EXCEL с разбором по полям. "_$C(10)_" По правой клавише мыши доступны "_$C(10)_" дополнительные опции'><img src='"_BSDOMAIN_"/img/xls_"_ST_".gif' border=0></BUTTON>"_BK
 ..I 'noE W "<BUTTON onclick=""javascript:DVSTART('*BSmirTAB="_I_"')"" "_DIS_" title='"_TIT_"Загрузить в программу DocumentView'><img src='"_BSDOMAIN_"/img/bsdoc_"_ST_".gif' WIDTH=14 border=0></BUTTON>"_BK
 .I 'noE I TRMA=2 w "<BUTTON onclick=""javascript:TELNET('0','"_I_"','"_I_"')"" "_DIS_" title='"_TIT_"Смотреть таблицу в терминальном режиме'><img src='"_BSDOMAIN_"/img/term_"_ST_".gif' border=0></BUTTON>"_BK
 .I 'noE I TRMA>2 w "<BUTTON onclick=""javascript:TELNET('1','"_I_"','"_I_"')"" "_DIS_" title='"_TIT_"Редактировать таблицу в терминальном режиме'><img src='"_BSDOMAIN_"/img/term_"_ST_".gif' border=0></BUTTON>"_BK
 .W "</TD>"
 .w "<TD TITLE='"_TIT_"' class=s"_$G(STS,ST)_">"_RAZ_COM D  W "</TD>"
 .W "<TD class=s"_$G(STS,ST)_">"_BK
 .W $$ChKill("CK"_nn,TIT_"пометить для удаления",$S(COM[";ПУСТ"!(COM["ОШИБКА"):"",1:DIS))
 .W "</TD></TR>"_BK
 S ST="" i nn=1 S ST="таблиц в разделе нет"
 i nn>1 S ST="Всего "_(nn-1)_" таблиц(а)"
 W "<TR><TD class=s3></TD><TD class=s3></TD><TD class=s3>"_ST_"</TD><TD class=s3>"_$$RELOAD_"</TD></TR>"_BK
 w "</TABLE></FORM>"_BK
 D BACK D END^%ZAPM.ed.BSC4
 Q
LAST() N Y,X S Y=$G(@P@(I,"LST")) I Y="" Q TIT
 Q $$TD^%ZAPM.ed.BSC4base($P(Y,",",1,2))_" "_$P(Y,",",3,9)
RAZ() N Y,X S Y=$O(@P@(I,"A"),-1),X=$O(@P@(I,1,"A"),-1)
RAZ2 Q "<font TITLE='размерность таблицы' color=Red>"_AF_"("_Y_"x"_X_")</font></font>"
RAZ1(Y,X) G RAZ2
Act //Удалить таблицы
 D BEG1^%ZAPM.ed.BSC4
 S P=$$%^%ZAPM.ed.BSCh(BSmirPART)
 N FLAG S I=""
 f nn=1:1 s I=$O(@P@(I)) q:I=""  d
 .I $D(CKA) L +@P@(I):0 Q:'$T  K @P@(I) L -@P@(I) S FLAG=$G(FLAG)+1 Q
 .I $D(@("CK"_nn)) L +@P@(I):0 Q:'$T  D  L -@P@(I)
 ..K @P@(I) S FLAG=$G(FLAG)+1 Q
 W "Удалено '"_+$G(FLAG)_"' узел(а,ов)<BR>"_BK_BBK_BBK
 D BACK
 G LIST
 Q
RELOAD() i $g(noE) q ""
 Q "<BUTTON ONCLICK='parent.location.reload();' title='Обновить окно {F5}'><img src='"_BSDOMAIN_"/img/refr.gif' border=0></BUTTON>"_BK
SUB()    I TRMA'>2 Q ""
 Q "<BUTTON NAME=DELTAB tabindex=0 onclick='submit();' TITLE='Удалить таблицы, помеченные к удалению'><img src='"_BSDOMAIN_"/img/del.gif' border=0></BUTTON>"
 ;Q "<INPUT NAME=DELTAB TYPE=SUBMIT TITLE='Удалить таблицы, помеченные к удалению' value='Удалить'>"
ChKill(NAME,TITLE,ATR)
 I TRMA'>2 Q ""
 Q "<INPUT NAME="_NAME_" TYPE=CHECKBOX TITLE='"_TITLE_"' "_$G(ATR)_" >"
BACK Q  //```
 s BSLABEL="LISTP^~BSmirGL"
 w "<A HREF='"_$$ADDBSGET^%ZAPM.ed.BSC4_"' target='D1' title='Список глобальных буферов'>Назад<IMG  src='"_BSDOMAIN_"/img/back.gif'  border=0 ></A>"
 Q
rep //загрузка таблиц раздела
 n P,BSLABEL2,BSFRM2,BSNSP2,BSTOP,BSarm,BSac
  I $G(^%ZAPM.ed.BS("Config"))="ASU" g AllTabl^%ZAPM.ed.BSCrep
 s P=$$cB^%ZAPM.ed.BSSV
 s BSmirPART=$$%T^%ZAPM.ed.BSCh(P)
 d REPORTS^%ZAPM.ed.BSmirGL
 q
]]></Routine>


<Routine name="%ZAPM.ed.BSout" type="MAC" languagemode="0"><![CDATA[
%BSout ;Опции вывода таблицы и параметры принтера (А.Тимофеев) ; 14:21  2-DEC-98
 
OPout(%1,%2,%3) ;ОПЦИИ ВЫВОДА ; %1-PRN (1),DOS (2),TXT (3); %2 - BSR, %3 - BST
 
 I $G(%1)="" Q
 S:$G(%2)="" %2=$G(BSR) S:$G(%3)="" %3=$G(BST) I BSR=""!(BST="") Q
 
0 N im,it,i,i1,BSRold,BSTold,BSr1,BSr2,BSt1,BSt2,zap,%zT
 S %zT=$ZT,$ZT="1^%ZAPM.ed.BSout"
 S im="^%ZAPM.ed.BSS",it="OPout"
 K ^%ZAPM.ed.BSbufB("uP"_$G(%BS(3),$P)_$J_"u"),^%ZAPM.ed.BSbufB("zP"_$G(%BS(3),$P)_$J_"u")
 
 S zap=$S(%1=1:"PRN",%1=2:"HFS",%1=3:"TXT",1:"COM"),BSR=%2,BST=%3
 D
 .I $D(@(BSR_"(BST,zap)")) S in=@(BSR_"(BST,zap)") I in["@" K @(BSR_"(BST,zap)"),in
 .I $D(in) F i=1:1:7 S @("in"_i)=$P(in,"#",i) Q:i=7
 .I $D(@(BSR_"(BST,zap)")) Q
 .F i=1:1:7 S @("in"_i)=$P($P(^%ZAPM.ed.BSS("OPout1",%1+1,1),"@",15),"#",i)
 
 ;Копирование таблицы опций в буфер
 
 K ^%ZAPM.ed.BSbufB("fTS"_$G(%BS(3),$P)_$J_"u")
 S BSr1="^%ZAPM.ed.BSS",BSt1="OPout",BSr2="^%ZAPM.ed.BSbufB",BSt2="fTS"_$G(%BS(3),$P)_$J_"u" D COPY^%ZAPM.ed.BSTK
 F i=1:1:7 S i1=i*2,$P(^%ZAPM.ed.BSbufB("fTS"_$G(%BS(3),$P)_$J_"u",i1,2),"@",15)=$G(@("in"_i))
 ;```S BSRold=BSR,BSTold=BST
 ;```S BSR="^%ZAPM.ed.BSbufB",BST="fTS"_$G(%BS(3),$P)_$J_"u"
 ;```S IYI=BSR_"("_BST D NE^%ZAPM.ed.BSN
 S IYI="^%ZAPM.ed.BSbufB"_"("_"fTS"_$G(%BS(3),$P)_$J_"u" D NE^%ZAPM.ed.BSN
 ;```S BSR=BSRold,BST=BSTold
 
 ;Выборка новых настроек
 I $P(^%ZAPM.ed.BSbufB("fTS"_$G(%BS(3),$P)_$J_"u",16,2),"@",15)=0 K in G 1
 S in=""
 F i=1:1:7 S i1=i*2 S @("in"_i)=$P($G(^%ZAPM.ed.BSbufB("fTS"_$G(%BS(3),$P)_$J_"u",i1,2)),"@",15) S:i=1 in=@("in"_i) S:i'=1 in=in_"#"_@("in"_i)
 I $P(^%ZAPM.ed.BSbufB("fTS"_$G(%BS(3),$P)_$J_"u",16,2),"@",15)=1 G 1
 S @(BSR_"(BST,zap)")=in
 
1 ;The end
  S $ZT=$G(%zT)
  K ^%ZAPM.ed.BSbufB("fTS"_$G(%BS(3),$P)_$J_"u")
  Q
 
OPprn(%2,%3) ;Параметры принтера ;%2 - BSR, %3 - BST
 S:$G(%2)="" %2=$G(BSR) S:$G(%3)="" %3=$G(BST) I BSR=""!(BST="") Q
 S BSR=%2,BST=%3
 N i,st,str,BSRold1,BSTold1,%zT,S,SS,SSS,zBSR,zBST
 S %zT=$ZT,$ZT="2^%ZAPM.ed.BSout"
 
 K ^%ZAPM.ed.BSbufB("fTS"_$G(%BS(3),$P)_$J_"u")
 S BSr1="^%ZAPM.ed.BSS",BSt1="OPout0",BSr2="^%ZAPM.ed.BSbufB",BSt2="fTS"_$G(%BS(3),$P)_$J_"u" D COPY^%ZAPM.ed.BSTK
 S BSRold1=BSR,BSTold1=BST
 S zBSR="^%ZAPM.ed.BSbufB",zBST="fTS"_$G(%BS(3),$P)_$J_"u" ;```!!!!! НЕЛЬЗЯ ПЕРЕОПРЕДЕЛЯТЬ BSR,BST
 I $D(@%2@(%3,"SHR")) S S=@$ZR I S'["27," F SS=1:1:3 I $P($P(S,$S(S["@":"@",1:"#"),SS),",") D
 .S SSS=$P($P(S,$S(S["@":"@",1:"#"),SS),","),$P(@zBSR@(zBST,SSS-1,2),"@",15)="Y"
 S IYI=zBSR_"("_zBST D NE^%ZAPM.ed.BSN ;```  ДЛЯ ТАКОГО ВЫЗОВА !!!!!
 S BSR=BSRold1,BST=BSTold1
 
 ;Установка новых настроек
 K @(BSR_"(BST,""SHR"")")
 S str="" F i=2:1:13 S st=$P($G(^%ZAPM.ed.BSbufB("fTS"_$G(%BS(3),$P)_$J_"u",i,2)),"@",15) D
 .I i<6 S:st="Y" $P(@(BSR_"(BST,""SHR"")"),"#")=$P($G(^%ZAPM.ed.BSbufB("fTS"_$G(%BS(3),$P)_$J_"u",i,1)),"@",15) Q
 .I i>5&(i<12) S:st="Y" $P(@(BSR_"(BST,""SHR"")"),"#",2)=$P($G(^%ZAPM.ed.BSbufB("fTS"_$G(%BS(3),$P)_$J_"u",i,1)),"@",15) Q
 .S:st="Y" $P(@(BSR_"(BST,""SHR"")"),"#",3)=$P($G(^%ZAPM.ed.BSbufB("fTS"_$G(%BS(3),$P)_$J_"u",i,1)),"@",15) Q
 
2 ;The end
 S $ZT=$G(%zT)
 K ^%ZAPM.ed.BSbufB("fTS"_$G(%BS(3),$P)_$J_"u")
 Q
 
3 ;Обработка клавиш в таблице опций принтера
 Q:R1>332
 I R1=13&(R2=-1)&(R3=-1) D  S R1=-2 D W^%ZAPM.ed.BST Q
 .I ny<6 D  S $P(^%ZAPM.ed.BSbufB("fTS"_$G(%BS(3),$P)_$J_"u",ny,2),"@",15)="Y" Q
 ..F i=1:1:5 S $P(^%ZAPM.ed.BSbufB("fTS"_$G(%BS(3),$P)_$J_"u",i,2),"@",15)=""
 .I "6,7,8,9"[ny!(ny=10)!(ny=11) D  S $P(^%ZAPM.ed.BSbufB("fTS"_$G(%BS(3),$P)_$J_"u",ny,2),"@",15)="Y" Q
 ..F i=6:1:11 S $P(^%ZAPM.ed.BSbufB("fTS"_$G(%BS(3),$P)_$J_"u",i,2),"@",15)=""
 .I ny=12!(ny=13) D  S $P(^%ZAPM.ed.BSbufB("fTS"_$G(%BS(3),$P)_$J_"u",ny,2),"@",15)="Y" Q
 ..F i=12,13 S $P(^%ZAPM.ed.BSbufB("fTS"_$G(%BS(3),$P)_$J_"u",i,2),"@",15)=""
 I R1=27 Q
 Q
 
BLout ;Формирование блока и посылка на вывод блока
 
 I $P(@(BSR_"(BST)"),"@",3)'=1 D ErrMsg^%ZAPM.ed.BSXfun(" Нет пометки блока !! ") Q
 I '$D(%CAL) D CALC^%ZAPM.ed.BSF3             ;вычисления
 S BsrO=BSR,BstO=BST,%zT=$ZT,$ZT="END^%ZAPM.ed.BSout"
 I $$BL^%ZAPM.ed.BSout4(BSR,BST)=0 Q
 S BSR="^%ZAPM.ed.BSbufB",BST="L"_$G(%BS(3),$P)_$J_"u"
 D OkMsg^%ZAPM.ed.BSXfun("Блок готов !!!",6)
 S OO=55,OOO="^%ZAPM.ed.BS" D ^%ZAPM.ed.BSB S LAB=$TR(%JB(%JB),",","")_%B
 I LAB="111" D Kout^%ZAPM.ed.BSout0(1) K in G END   ;ТАБЛИЦА НА ПРИНТ.
 I LAB="121" D Kout^%ZAPM.ed.BSout0(2) K in G END   ;        В ФАЙЛ
 I LAB="131" D Kout^%ZAPM.ed.BSout0(3) K in G END   ;        В ТЕКСТ
 I LAB="141" D Kout^%ZAPM.ed.BSout0(4) K in G END   ;        НА РТА
 I LAB="21" D DTout^%ZAPM.ed.BSout3(1) G END   ;ДАННЫЕ НА ПРИНТ.
 I LAB="22" D DTout^%ZAPM.ed.BSout3(2) G END   ;        В ФАЙЛ
 I LAB="23" D DTout^%ZAPM.ed.BSout3(3) G END   ;        В ТЕКСТ
 I LAB="24" D DTout^%ZAPM.ed.BSout3(4) G END   ;        НА РТА
 
END ;The end
 S $ZT=$G(%zT)
 S BSR=BsrO,BST=BstO D W^%ZAPM.ed.BST
 Q
]]></Routine>


<Routine name="%ZAPM.ed.BSout0" type="MAC" languagemode="0"><![CDATA[
%BSout0 ; Карта вывода  (А.Тимофеев) ; 17:38   09.09.99
 
Kout(%1,%2,%3) ;Формирование карты
 ; %1-PRN (1),DOS (2),TXT (3),COM (4); %2 - BSR, %3 - BST
 
 I $G(%1)="" Q
 S:$G(%2)="" %2=$G(BSR) S:$G(%3)="" %3=$G(BST)   ;I BSR=""!(BST="") Q
 N i,i1,i2,i3,zap,ot,ls,hs,tit,tip,ot,lty,rdy,ltx,rdx,kw,kx,ky,lx,ly,st,rp,%zT,IYI,ZapK
 S %zT=$ZT,$ZT="2^%ZAPM.ed.BSout0"
 S zap=$S(%1=1:"PRN",%1=2:"HFS",%1=3:"TXT",1:"COM"),BSR=%2,BST=%3
 ;Выбор установок ; ls-симв. в строке,hs-строк на стр.
 
 S ls="Формируется карта вывода !" D WAITS^%ZAPM.ed.BSF2
 D
 .I $D(in) D  Q
 ..F i=1:1:7 S @("in"_i)=$P(in,"#",i) Q:i=7
 .I $D(@(BSR_"(BST,zap)")) I $G(@(BSR_"(BST,zap)"))'["@" D  Q
 ..S in=@(BSR_"(BST,zap)") F i=1:1:7 S @("in"_i)=$P(in,"#",i) Q:i=7
 .F i=1:1:7 S @("in"_i)=$P($P(^%ZAPM.ed.BSS("OPout1",%1+1,1),"@",15),"#",i)
 S ls=$S(in2'=0:in2,1:$$LNG^%ZAPM.ed.BSF12),hs=$S(in3'=0:in3,1:999999)
 
 ;Определение титула;, tit - коорд. тит., tipt - тип титула
 
 S ot=$G(@(BSR_"(BST)")),tit=$P(ot,"@",19),tip=$P(ot,"@",17)
 I $P(ot,"@",50) S tit=$P(ot,"@",50) ;ТИТУЛ ПЕЧАТИ```MSW
 I in5?.N1",".N S tit=in5 ;|||
 S tipt=$S($G(tit)="":1,in5=0:1,$P(tit,",")=1&($P(tit,",",2)=1):1,$P(tit,",")=1&($P(tit,",",2)'=1):2,$P(tit,",")'=1&($P(tit,",",2)=1):3,1:4)
 K ^%ZAPM.ed.BSbufB("W"_$G(%BS(3),$P)_$J_"u")
 
 ;Запись установок
 D  S ^%ZAPM.ed.BSbufB("W"_$G(%BS(3),$P)_$J_"u","TXT")=%1_"#"_in1        ;устройство + N устройства
 .I %1=1 D
 ..I $D(@(BSR_"(BST,""SHR"")")) S ^%ZAPM.ed.BSbufB("W"_$G(%BS(3),$P)_$J_"u","SHR")=$G(@(BSR_"(BST,""SHR"")"))
 ..S ^%ZAPM.ed.BSbufB("W"_$G(%BS(3),$P)_$J_"u","DOS")=in4_"#"_in6 Q      ;отступ + режим печати
 
 ;Длина и высота титула lt-длина,ht-высота
 S (lt,ht)=0 D
 .I tipt=1 Q
 .I tipt=2 D  Q
 ..F i=1:1:$P(tit,",",2) S lt=lt+$P(@(BSR_"(BST,1,i)"),"@",4)
 .I tipt=3 D  Q
 ..F i=1:1:$P(tit,",") S ht=ht+$P(@(BSR_"(BST,i,1)"),"@",3)
 .F i=1:1:($P(tit,",")-1) S ht=ht+$P(@(BSR_"(BST,i,1)"),"@",3)
 .F i1=1:1:($P(tit,",",2)-1) S lt=lt+$P(@(BSR_"(BST,1,i1)"),"@",4)
 
 ;Создание карты
 S ^%ZAPM.ed.BSbufB("W"_$G(%BS(3),$P)_$J_"u")="@@@@@1@1@1@1@22@80@1@@1@@1@1@@2,2@1@@@@@1@@@6@3@@1;6;33;44@@@@@@@@@@3^%ZAPM.ed.BSout0"
 S ^%ZAPM.ed.BSbufB("W"_$G(%BS(3),$P)_$J_"u",1,1)="1@1@3@15@@@@@1@1;6;33;44@@@@@ <ENTER>-Экран  <F2> - Вывод   <F3> - Опции"
 S ^%ZAPM.ed.BSbufB("W"_$G(%BS(3),$P)_$J_"u","PRN")=BSR_"#"_BST_"#"_$G(%BS(15))
 
 ;Первая строка
 ;y-длина карты, y1-длина колонки, kw-номер карты, kx-координата по х, i3-последняя колонка, i2-номер колонки
 S (y,y1,kw,i,i2,i3)=0,i1=1,kx=16
 F  S i=$O(@(BSR_"(BST,1,i)")) Q:i=""  D   X $G(WA) S i3=i
 .S y1=$P($G(@(BSR_"(BST,1,i)")),"@",4) D:y1=+y1  S y=y+y1
 ..I (y+y1)>($$ls()-$S(kw=0:0,1:lt)) D
 ...S y=0,kw=kw+1,i2=kw+1
 ...S ^%ZAPM.ed.BSbufB("W"_$G(%BS(3),$P)_$J_"u",1,i2)="1@"_kx_"@3@10@@@@@1@1;6;33;45@@@@@Колонка  :"_kw_"         #"_$S(tipt=1!(i1=1):"",i1'=1&(tipt=2!(tipt=4)):1_":1:"_($P(tit,",",2)-1)_",",1:"")_i1_":1:"_(i-1)
 ...S kx=kx+10,i1=i Q
 I y'=0 D
 .S kw=kw+1,i2=kw+1
 .S ^%ZAPM.ed.BSbufB("W"_$G(%BS(3),$P)_$J_"u",1,i2)="1@"_kx_"@3@10@@@@@1@1;6;33;45@@@@@Колонка  :"_kw_"         #"_$S(tipt=1!(i1=1):"",i1'=1&(tipt=2!(tipt=4)):1_":1:"_($P(tit,",",2)-1)_",",1:"")_i1_":1:"_i3 Q
 
 ;Первая колонка
 S (y,y1,kw,i,i2,i3)=0,i1=1,ky=4
 F  S i=$O(@(BSR_"(BST,i)")) Q:'i  D  X $G(WA) S:i=+i i3=i
 .S y1=$P($G(@(BSR_"(BST,i,1)")),"@",3) D:y1=+y1  S y=y+y1
 ..S st=$E($P($G(@(BSR_"(BST,i,1)")),"@",15),1)
 ..I (hs'=+hs&(st=hs))!(hs=+hs&(y+y1>(hs-$S(kw=0:0,1:ht)))) D     ; > длины или разделитель страниц
 ...S y=0,kw=kw+1,i2=kw+1
 ...S ^%ZAPM.ed.BSbufB("W"_$G(%BS(3),$P)_$J_"u",i2,1)=ky_"@1@3@15@@@@@1@1;6;33;45@@@@@Страница :"_kw_"    #"_$S(tipt=1!(i1=1):"",i1'=1&(tipt=3!(tipt=4)):1_":1:"_($P(tit,",")-1)_",",1:"")_i1_":1:"_(i-1)
 ...S ky=ky+3,i1=i Q
 I y'=0 D
 .S kw=kw+1,i2=kw+1
 .S ^%ZAPM.ed.BSbufB("W"_$G(%BS(3),$P)_$J_"u",i2,1)=ky_"@1@3@15@@@@@1@1;6;33;45@@@@@Страница :"_kw_"    #"_$S(tipt=1!(i1=1):"",i1'=1&(tipt=3!(tipt=4)):1_":1:"_($P(tit,",")-1)_",",1:"")_i1_":1:"_i3 Q
 
 ;Формирование таблицы
 S (ky,kx,ly,lx)=""
 S i=1 F  S i=$O(^%ZAPM.ed.BSbufB("W"_$G(%BS(3),$P)_$J_"u",i)) Q:i=""  D  X $G(WA)
 .S i1=1 F  S i1=$O(^%ZAPM.ed.BSbufB("W"_$G(%BS(3),$P)_$J_"u",1,i1)) Q:i1=""  D
 ..S ky=$P($G(^%ZAPM.ed.BSbufB("W"_$G(%BS(3),$P)_$J_"u",i,1)),"@")
 ..S kx=$P($G(^%ZAPM.ed.BSbufB("W"_$G(%BS(3),$P)_$J_"u",1,i1)),"@",2)
 ..S ly=$P($G(^%ZAPM.ed.BSbufB("W"_$G(%BS(3),$P)_$J_"u",i,1)),"@",3)
 ..S lx=$P($G(^%ZAPM.ed.BSbufB("W"_$G(%BS(3),$P)_$J_"u",1,i1)),"@",4)
 ..S ^%ZAPM.ed.BSbufB("W"_$G(%BS(3),$P)_$J_"u",i,i1)=ky_"@"_kx_"@"_ly_"@"_lx_"@@@@@1@1;6;33;44@@@@@"
 
 D  ;А ЭТО ПРАВИЛЬНОЕ Формирование таблицы
 .N BSR,BST S BSR="^%ZAPM.ed.BSbufB",BST="W"_$G(%BS(3),$P)_$J_"u" D TAB^%ZAPM.ed.BSF1
 
 ;Вывод без карты
 I in7'=1 D  S out=$$OUT^%ZAPM.ed.BSout2(BSR,BST) G 2
 .S rp=$P($G(^%ZAPM.ed.BSbufB("W"_$G(%BS(3),$P)_$J_"u","DOS")),"#",2),out=$$ALL^%ZAPM.ed.BSout1(BSR,BST,rp)
 
 ;Работа с картой
 S ^%ZAPM.ed.BSbufB("old"_$G(%BS(3),$P)_$J_"u")=BSR_"#"_BST
 S ZapK="" F i=0:1:9 S ZapK=ZapK_$G(@("k"_i))_"~"   ;запись набора ключей БД
 S $P(^%ZAPM.ed.BSbufB("old"_$G(%BS(3),$P)_$J_"u"),"#",3)=ZapK
 S BSRold=BSR,BSTold=BST
 S IYI="^%ZAPM.ed.BSbufB"_"("_"W"_$G(%BS(3),$P)_$J_"u" D NE^%ZAPM.ed.BSN ;```
1 S BSR=BSRold,BST=BSTold,Refresh=1
 
2 S $ZT=$G(%zT) K ^%ZAPM.ed.BSbufB("old"_$G(%BS(3),$P)_$J_"u"),^%ZAPM.ed.BSbufB("W"_$G(%BS(3),$P)_$J_"u")
 Q  ;The end
 
3 ;Обработка клавиш в таблице карты вывода
 S Refresh=1
 I R1=27,R2=79,R3=81 D  Q                       ;Вывод на устройство <F2>
 .D 4 S out=$$Gout^%ZAPM.ed.BSout1(BSRnew,BSTnew,1,2)
 .S BSRold=$P($G(^%ZAPM.ed.BSbufB("old"_$G(%BS(3),$P)_$J_"u")),"#"),BSTold=$P($G(^%ZAPM.ed.BSbufB("old"_$G(%BS(3),$P)_$J_"u")),"#",2)
 .S out=$$OUT^%ZAPM.ed.BSout2(BSRold,BSTold)
 .S R1=-2 D W^%ZAPM.ed.BST Q
 I R1=13,R2=-1,R3=-1 D  Q                       ;Просмотр на экране <ENTER>
 .D 4  S out=$$Gout^%ZAPM.ed.BSout1(BSRnew,BSTnew,1,1)
 .S ^%ZAPM.ed.BSbufB("uP"_$G(%BS(3),$P)_$J_"u")="БУФЕР @@@@@@@1@1@22@80@@@@1@@5@@@1@@@@@@@@@@@1;6;36;44//1;6;36;40@@@@@@@1"
 .D ^%ZAPM.ed.BSX("TEXT","^%ZAPM.ed.BSbufB","uP"_$G(%BS(3),$P)_$J_"u")
 .S R1=-2 D W^%ZAPM.ed.BST Q
 I R1=27,R2=79,R3=82 D OPprn^%ZAPM.ed.BSout(BSR,BST) Q   ;Опции принтера <F3>
 I R1=27 Q
 
4 ;Посылка на формирование буфера
  S BSRnew=$P($G(^%ZAPM.ed.BSbufB("W"_$G(%BS(3),$P)_$J_"u","PRN")),"#"),BSTnew=$P($G(^%ZAPM.ed.BSbufB("W"_$G(%BS(3),$P)_$J_"u","PRN")),"#",2) Q
ls() I ls'["," Q ls
 I +$P(ls,",",kw+1)=0 Q +ls
 Q +$P(ls,",",kw+1)
]]></Routine>


<Routine name="%ZAPM.ed.BSout1" type="MAC" languagemode="0"><![CDATA[
%BSout1 ; Формирование буфера вывода  (А.Тимофеев) ; 14:35   16.06.99
 
ALL(%2,%3,%6) ;Формирование буфера вывода без карты
 ;%2 - BSR, %3 - BST, %6 - режим вывода
 
 I %2=""!(%3="") S %0=0 Q %0
 N i,i1,i2,l,lx,fy,fx,dan,str,str1,st,d,d0,d1,nst,zp,%zT,nBS15,tr
 S BSR=%2,BST=%3,%zT=$ZT,$ZT="1^%ZAPM.ed.BSout1",%4=""
 
 S zp="" D  I zp=1 S %0=0 Q %0
 .I '$D(^%ZAPM.ed.BSbufB("zP"_$G(%BS(3),$P)_$J_"u")) Q
 .I $P($G(^%ZAPM.ed.BSbufB("zP"_$G(%BS(3),$P)_$J_"u")),"#",3)'=0 Q
 .I BSR'=$P($G(^%ZAPM.ed.BSbufB("zP"_$G(%BS(3),$P)_$J_"u")),"#")!(BST'=$P($G(^%ZAPM.ed.BSbufB("zP"_$G(%BS(3),$P)_$J_"u")),"#",2)) Q
 .S ls=" Есть готовый буфер! Выдаем ? " D YES^%ZAPM.ed.BSF I YES S zp=1 Q
 
 K ^%ZAPM.ed.BSbufB("uP"_$G(%BS(3),$P)_$J_"u")  S nBS15=$P($G(^%ZAPM.ed.BSbufB("W"_$G(%BS(3),$P)_$J_"u","PRN")),"#",3)
 S str=0,nst=2 D
 .I $G(pacetF)'="" S:pacetG'="Y" tr=1 Q
 .S tr=1 //```S ls=" Псевдографику сохранять ? " D YES^%ZAPM.ed.BSF I 'YES S tr=1
 S ls="Формируется буфер вывода" D WAITS^%ZAPM.ed.BSF2
 
 S ny=1 F  S ny=$O(^%ZAPM.ed.BSbufB("W"_$G(%BS(3),$P)_$J_"u",ny)) Q:ny=""!(ny'=+ny)  D
 .S nx=1 F  S nx=$O(^%ZAPM.ed.BSbufB("W"_$G(%BS(3),$P)_$J_"u",ny,nx)) Q:nx=""  D G0  D
 ..I $G(%6)=3 S str=str+1,^%ZAPM.ed.BSbufB("uP"_$G(%BS(3),$P)_$J_"u",str)="~'~'~end "_nst,nst=nst+1,str=str+1 Q
 ..I $G(%6)=2 S str=str+1,^%ZAPM.ed.BSbufB("uP"_$G(%BS(3),$P)_$J_"u",str)="'~'~'end "_nst,nst=nst+1,str=str+1 Q
 S ^%ZAPM.ed.BSbufB("zP"_$G(%BS(3),$P)_$J_"u")=BSR_"#"_BST_"#"_"0"
 
1 S $ZT=$G(%zT),%0=0 Q %0     ;The end
 
Gout(%2,%3,%4,%5) ;Формирование буфера вывода из карты
 ;%2 - BSR, %3 - BST, %4 - 1, %5 - 1 (экран) или 2 (устройство)
 
 I %2=""!(%3="")!(%4="") S %0=0 Q %0
 N BSR,BST,i,i1,i2,l,lx,fy,fx,dan,str,str1,st,d,d0,d1,zp,zp1,%zT,tr
 S BSR=%2,BST=%3,%zT=$ZT,$ZT="2^%ZAPM.ed.BSout1"
 
 S zp="" D  I zp=1 S %0=0 Q %0
 .I '$D(^%ZAPM.ed.BSbufB("zP"_$G(%BS(3),$P)_$J_"u")) Q
 .S zp1=$G(^%ZAPM.ed.BSbufB("zP"_$G(%BS(3),$P)_$J_"u"))
 .I BSR'=$P(zp1,"#")!(BST'=$P(zp1,"#",2))!(ny'=$P(zp1,"#",3))!(nx'=$P(zp1,"#",4)) Q
 .S ls=" Есть готовый буфер! Выдаем ? " D YES^%ZAPM.ed.BSF I YES S zp=1 Q
 
 K ^%ZAPM.ed.BSbufB("uP"_$G(%BS(3),$P)_$J_"u") S nBS15=$P($G(^%ZAPM.ed.BSbufB("W"_$G(%BS(3),$P)_$J_"u","PRN")),"#",3)
 S ZapK=$P($G(^%ZAPM.ed.BSbufB("old"_$G(%BS(3),$P)_$J_"u")),"#",3)
 F i=1:1:10 S i1=i-1,@("k"_i1)=$P(ZapK,"~",i)
 S str=0
 S tr=1 //```S ls=" Псевдографику сохранять ? " D YES^%ZAPM.ed.BSF I 'YES S tr=1
 S ls="Формируется буфер вывода" D WAITS^%ZAPM.ed.BSF2
 
G0 ;Формирование по одной карте
 
 ;Определение цикла пробежки из карты
 S fy="F i="_$P($P($G(^%ZAPM.ed.BSbufB("W"_$G(%BS(3),$P)_$J_"u",ny,1)),"@",15),"#",2)
 S fx="F i1="_$P($P($G(^%ZAPM.ed.BSbufB("W"_$G(%BS(3),$P)_$J_"u",1,nx)),"@",15),"#",2)
 S dan="" X fy_" D G1"
 
 I $G(%4)'=1 Q
 S $P(^%ZAPM.ed.BSbufB("W"_$G(%BS(3),$P)_$J_"u",ny,nx),"@",15)=$J("",10)_$S(%5=1:"Просмотр",1:"Выдан !")
 S ^%ZAPM.ed.BSbufB("zP"_$G(%BS(3),$P)_$J_"u")=BSR_"#"_BST_"#"_ny_"#"_nx
 
2 S $ZT=$G(%zT),%0=0 Q %0     ;The end
 
 
G1 ;Цикл по строкам таблицы
 S hy=$P($G(@(BSR_"(BST,i,1)")),"@",3) D:+hy'=0  S str=str+hy X $G(WA)
 .X fx_" D G2 "
 Q
 
G2 ;Цикл по колонкам таблицы
 S $ZT="ZZZ^%ZAPM.ed.BSout1" I $G(tr) D TR^%ZAPM.ed.BSF12
 S st=$G(@(BSR_"(BST,i,i1)")),lx=$P(st,"@",4) D DK S:$G(tr) d0=$TR(d0,tr(1),tr(2)) S d0=$S(d0'="":d0,1:"")_$J("",lx*hy-$L(d0)) D:+lx'=0
 .S l=1,lx1=lx F i2=1:1:hy S str1=str+i2 D
 ..S dan=$E(d0,l,lx1),l=lx1+1,lx1=lx1+lx
 ..S ^%ZAPM.ed.BSbufB("uP"_$G(%BS(3),$P)_$J_"u",str1)=$G(^%ZAPM.ed.BSbufB("uP"_$G(%BS(3),$P)_$J_"u",str1))_dan
 Q
ZZZ W $$bel^%ZAPM.ed.BS3 Q
DK ;Определение данных клетки
 N BS,ny,nx  S BS=st
 I $P(BS,"@",9)=1 S (d1,d,d0)=$P(BS,"@",15)
 E  S (d1,d,d0)=$G(^%ZAPM.ed.BSbufB("BB"_$G(%BS(3),$P)_$J_"u"_nBS15,i,i1))
 I d0="" S d0=" "
 I $P(BS,"@",8)'="" S ny=i,nx=i1 D
 .I $P(BS,"@",8)=0 X $G(@(BSR_"(BST,""FTR"","_i_","_i1_")")) S d0=d1 Q
 .X $G(@(BSR_"(BST,""FTR"","_$P(BS,"@",8)_")")) S d0=d1
 Q
 
TR(d0) ;Трансформация псевдографики если tr=1
 ;I d0=""!(d0=" ")!(d0=+d0) Q d0
 N tr1,tr2,tr3,d2,d3
 S tr1="||||||--|+||==||=-==-=--==-====-=---="
 S tr2="=-"
 S d2="" F tr3=1:1:$L(d0) S d3=$E(d0,tr3) D  S d2=d2_d3
 .I tr1[d3 S d3=$TR(d3,d3,"|") Q
 .I tr2[d3 S d3=$S(d3="-":$TR(d3,d3,"-"),1:$TR(d3,d3,"=")) Q
 S d0=d2 Q d0
]]></Routine>


<Routine name="%ZAPM.ed.BSout2" type="MAC" languagemode="0"><![CDATA[
%BSout2 ; Вывод на устройство  (А.Тимофеев) ; 11:40   09.10.2000
 
OUT(%1,%2,%Uout) ;Вывод буфера на устройство
 ;%1 -BSR, %2 - BST, %Uout - устройство
 I $G(%1)=""!($G(%2)="") S %0=0 Q %0
 
 N i,i1,us,US,%I,ot,rp,sr,sr1,sr2,sr3,qz,txt,%zT,ExZ,UStro,TermLPT,Tmp
 I '$D(^%ZAPM.ed.BSbufB("uP"_$G(%BS(3),$P)_$J_"u")) S %0=0 Q %0
 S us=$P($G(^%ZAPM.ed.BSbufB("W"_$G(%BS(3),$P)_$J_"u","TXT")),"#")  ;определение устройства
 S:$G(%Uout)'="" us=$G(%Uout)
 I us=4 G COM
 I us=2 G DOS
 I us=3 G TXT
 
PRN ;На принтер
 S %I=$I
1 ;Старт печати
 S US=$P($G(^%ZAPM.ed.BSbufB("W"_$G(%BS(3),$P)_$J_"u","TXT")),"#",2)
 S:$G(%Uout)'="" US="|PRN|\\XXX\ZZZ" ;3 //```
 S Tmp=$$TermF() G ExZ:+Tmp I Tmp="ESC" S %0=0 Q %0 ;ОПРЕДЕЛЕН ТЕРМИНАЛ И ПЕЧАТЬ НА ТЕРМИНАЛЬНЫЙ ПРИНТЕР
 S US=$$DFLT^%ZAPM.ed.BSJPRN ;```
 //````I '$$INIT^%ZAPM.ed.BSJPRN(US) S %0=0 Q %0 ;Инициализация DPP ---->
 //```I $G(pacetF)="",$G(Tmp)'="LPT" S ls=" Готово УСТРОЙСТВО ВЫВОДА ("_US_") ? " D YES^%ZAPM.ed.BSF I 'YES S %0=0 Q %0
 I $G(pacetF)="",$G(Tmp)'="LPT" D  I 'YES S %0=0 Q %0
 .D MENU^%ZAPM.ed.BSF5(" ПРИНТЕР_"_US_" ВЫВОД_В_SPOOLER ОТМЕНА ","ВЫБЕРИТЕ УСТРОЙСТВА ВЫВОДА..")
 .I %B=2 S US=2
 .I %B=3 S YES=0
ExZ I $G(TermLPT) G TermLPT
 O US:$$MAX^%ZAPM.ed.BSJPRN(US):1 E  S ls=" ПЕЧАТЬ ЗАНЯТА " D O^%ZAPM.ed.BSF7 G PRN
 S %zT=$ZT,$ZT="ZT^%ZAPM.ed.BSout2"
 U US W $$SBROS^%ZAPM.ed.BSJPRN(US) ;Сброс параметров
 ;ot - отступ, rp - режим печати, sr - установки принтера
TermLPT S ot=$P($G(^%ZAPM.ed.BSbufB("W"_$G(%BS(3),$P)_$J_"u","DOS")),"#"),rp=$P($G(^%ZAPM.ed.BSbufB("W"_$G(%BS(3),$P)_$J_"u","DOS")),"#",2)
 S sr=$$CTRL^%ZAPM.ed.BSJPRN($G(^%ZAPM.ed.BSbufB("W"_$G(%BS(3),$P)_$J_"u","SHR")),US),sr1=$P(sr,"#"),sr2=$P(sr,"#",2),sr3=$P(sr,"#",3)
 D Prn
 D USECON(%I) R *R:0 I R=27 G STOP
 S ls=" Вывод информации " D WAITS^%ZAPM.ed.BSF2
 S (S2,S1)="" D  ;ПЕРЕКОДИРОВАТЬ ЕСЛИ НЕ СПУЛЕР
 .I US'=2 D INIT^%ZAPM.ed.BSre(0)
 S i="",qz="" F  S i=$O(^%ZAPM.ed.BSbufB("uP"_$G(%BS(3),$P)_$J_"u",i)) Q:i=""  D  Q:qz'=""
 .D  Q:qz'=""
 ..I rp=3&($E($G(^%ZAPM.ed.BSbufB("uP"_$G(%BS(3),$P)_$J_"u",i)),1,5)="~'~'~") D  Q
 ...S ns=$P($G(^%ZAPM.ed.BSbufB("uP"_$G(%BS(3),$P)_$J_"u",i)),"~'~'~end ",2),i=i+1
 ...D USECON(%I) S ls="Страница N "_ns_". Печатать с переводом формата ?" D YES^%ZAPM.ed.BSF I 'YES S qz=2 Q
 ...D USELPT(US) W:YES # D Prn
 ..I rp=2&($E($G(^%ZAPM.ed.BSbufB("uP"_$G(%BS(3),$P)_$J_"u",i)),1,5)="'~'~'") S i=i+1 D USELPT(US) W #
 .D USELPT(US) W !,$J("",ot),$TR($G(^%ZAPM.ed.BSbufB("uP"_$G(%BS(3),$P)_$J_"u",i)),S2,S1) D USECON(%I) X $G(WA) W $$rt^%ZAPM.ed.BS3(0) I R=27 S qz=1 Q
 G:qz=1 STOP  G:qz=2 END
 D USELPT(US) W !
END ;Конец печати
 I $G(TermLPT) G TermLPTC
 U US W $$SBROS^%ZAPM.ed.BSJPRN(US)
2 I '$G(TermLPT) C US D COPY2BSSES^%ZAPM.ed.BSCpool(US,$$MAX^%ZAPM.ed.BSJPRN(US),%2) O US U US W ! C US  ;ДОПОЛНИТЕЛЬНЫЙ СБРОС
TermLPTC D USECON(%I) S $ZT=$G(%zT) W $$rt^%ZAPM.ed.BS3(0)
 S R=1 I $D(ExZ),ExZ>1 S ExZ=ExZ-1 G ExZ
 I '$D(pacetO) S %B=2,ls="Еще экземпляр ?" D YES^%ZAPM.ed.BSF I YES G 1
 S %0=0 Q %0
USELPT(US) ;СДЕЛАТЬ ТЕКУЩИМ УСТРОЙСТВО ПЕЧАТИ
 I $G(TermLPT) X "W "_$P(TermLPT,"~",2) Q
 U US
 Q
USECON(US) ;СДЕЛАТЬ ТЕКУЩИМ УСТРОЙСТВО КОНСОЛИ
 I $G(TermLPT) X "W "_$P(TermLPT,"~",3)
 U US
 Q
STOP ;Прерывание печати
 W $$bel^%ZAPM.ed.BS3 S ls=" ПЕЧАТЬ ПРЕРВАНА " D O^%ZAPM.ed.BSF7
 G 2
TermF() ;ОПРЕДЕЛЕНИЕ УСТРОЙСТВО ПЕЧАТИ ДЛЯ ТЕРМИНАЛА И СТАНЦИИ
 K TermLPT
 S %0=0 I $G(%BS(14))="" Q 0 ;НЕ ЧЕГО НЕ ДЕЛАТЬ - ВСЕ ПО-СТАРОМУ
 I $E(%BS(14),5)="1" Q 0 ;ВСЕГДА ПО-СТАРОМУ
 I $E(%BS(14),5)="2" Q $$Term(1) ;ВСЕГДА ТЕРМИНАЛЬНЫЙ ПРИНТЕР
 I $E(%BS(14),5)="0" D  Q:YES<1!(%B=3) "ESC" Q:%B=2 $$Term(0) Q:%B=1 "LPT"  ;СЕЛЕКТОР МЕЖДУ ПЕЧАТЯМИ
 .D MENU^%ZAPM.ed.BSF5(" ПЕЧАТЬ_НА_ЛОКАЛЬНОМ_ПРИНТЕРЕ_MSM ПЕЧАТАТЬ_НА_ПРИНТЕРЕ_ТЕРМИНАЛА ОТМЕНА ","ВЫБЕРИТЕ ПРИНТЕР...")
 Q 0
Term(lsss) ;СОЗДАТЬ ЛОКАЛЬ ПЕЧАТИ ТЕРМИНАЛА
 N ls I $G(lsss) S ls=" Готово ЛОКАЛЬНОЕ устройство печати ТЕРМИНАЛА ? " D YES^%ZAPM.ed.BSF I 'YES S %0=0 Q "ESC"
 S TermLPT=$$Ter() I "1~~"[TermLPT D ErrMsg^%ZAPM.ed.BSXfun("Для терминала "_$P_" не определен код инициализации ПЕЧАТИ") Q "ESC"
 Q TermLPT
Ter() N BDTRM S BDTRM=$$KBD^%ZAPM.ed.BSF12("^%ZAPM.ed.BSVOL(""TRM"")") I $D(@BDTRM@($P)) S TermLPT="1~"_$G(@BDTRM@($P,"OpenLPT"))_"~"_$G(@BDTRM@($P,"CloseLPT")) Q TermLPT
 Q ""
Prn ;Инициализация принтера
 Q:$G(TermLPT)
 U US W:$G(sr1)'="" @("$C("_sr1_")") W:$G(sr2)'="" @("$C("_sr2_")") W:$G(sr3)'="" @("$C("_sr3_")")
 Q
ZT ;Сборщик ошибок для принтера
 G END
DOS ;В DOS файл
 N %DEV,%FN,%I,%3,%4
 S %zT=$ZT,$ZT="C^%ZAPM.ed.BSout2",%I=$I
 S PR1=$P($G(^%ZAPM.ed.BSbufB("W"_$G(%BS(3),$P)_$J_"u","TXT")),"#",2)
 ;Открытие файла
 I $G(pacetD)'="" S PR1=$S($G(pacetD)=1!($G(pacetO)=1):PR1,1:$G(pacetPR1))
Mas1 N f1,Mas1,Mas2,f2,f  //
 S f=$$GETOPT^%ZAPM.ed.BSC4cfgP("^%ZAPM.ed.BSETUP(""ISS"")","bzOUTtables","V","^[""%SYS""]BSC4.ISS.Setup") //
 I $$File2Arr^%ZAPM.ed.BSCEXE(f_"header.html",.Mas1) ;ZW Mas1 //
 I $$File2Arr^%ZAPM.ed.BSCEXE(f_"footer.html",.Mas2) ;ZW Mas2 //
 
 D DOSOPN^%ZAPM.ed.BSBL1
 I $G(%FN)="" D OkMsg^%ZAPM.ed.BSXfun("Отказ от вывода !",6) S %0=0 Q %0
 S ls=" Вывод информации " D WAITS^%ZAPM.ed.BSF2
 
 D:$G(Pfl) Mas(.Mas1) //
 S i="",qz="" F  S i=$O(^%ZAPM.ed.BSbufB("uP"_$G(%BS(3),$P)_$J_"u",i)) Q:i=""  D
 .U %DEV W $G(^%ZAPM.ed.BSbufB("uP"_$G(%BS(3),$P)_$J_"u",i)),! U %I X $G(WA)
 D:$G(Pfl) Mas(.Mas2) //
 
C ;Закрытие устройства
 S $ZT=$G(%zT)
 C %DEV K %DEV,%FN U 0
 D:$G(pacetD)="" OkMsg^%ZAPM.ed.BSXfun("Вывод завершен !",6)
 S %0=0 Q %0
 
Mas(Mas1) I $D(Mas1) S f1="" F  S f1=$O(Mas1(f1)) Q:f1=""  U %DEV W Mas1(f1) //
 Q 
 
TXT ;Вывод в текст
 
 S %zT=$ZT,$ZT="Ztxt^%ZAPM.ed.BSout2",%I=$I
 S li=$P($G(^%ZAPM.ed.BSbufB("W"_$G(%BS(3),$P)_$J_"u","TXT")),"#",2)
 
NAME ;определение текста для вывода
 N BSr,BSt,li,YES
 S NoCheck=1 D RIT^%ZAPM.ed.BSF3 K NoCheck
 I li="" D OkMsg^%ZAPM.ed.BSXfun("Отказ от вывода !",6) S %0=0 Q %0
 I BSr=""!(BSt="") S %0=0 Q %0
 I '$D(@(BSr)) S %0=0 Q %0
 I $D(@(BSr_"(BSt)")) S ls=" Есть уже такой текст !  Перепишем ? " D YES^%ZAPM.ed.BSF I YES'=1 G NAME
 I $D(@(BSr_"(BSt)")) K @(BSr_"(BSt)")
 S @(BSr_"(BSt)")="Таблица "_BSR_","_BST_" в тексте@@@@@@@1@1@22@80@@@@1@@5@@@1@@@@@@@@@@@1;6;36;44//1;6;36;40@@@@@@@1"
 
 S ls=" Вывод информации " D WAITS^%ZAPM.ed.BSF2
 S i="" F  S i=$O(^%ZAPM.ed.BSbufB("uP"_$G(%BS(3),$P)_$J_"u",i)) Q:i=""  D
 .S @(BSr_"(BSt,i)")=$G(^%ZAPM.ed.BSbufB("uP"_$G(%BS(3),$P)_$J_"u",i))
 
 D OkMsg^%ZAPM.ed.BSXfun("Вывод завершен !",6)
Ztxt ;The end
 S $ZT=$G(%zT)
 S %0=0 Q %0
 
COM ;Вывод в порт
 S %zT=$ZT,$ZT="Ztxt^%ZAPM.ed.BSout2"
 I '$D(%BS(21)) D ErrMsg^%ZAPM.ed.BSXfun(" Вывод на ПФЛ не определен в SETUP") G Ztxt
 S out=$$MassPFL^%ZAPM.ed.BSXdos("^%ZAPM.ed.BSbufB(""uP"_$G(%BS(3),$P)_$J_"u"")",1) G Ztxt
]]></Routine>


<Routine name="%ZAPM.ed.BSout3" type="MAC" languagemode="0"><![CDATA[
%BSout3 ; Вывод данных ...   (А.Тимофеев) ; 17:17 10-JUN-98
 
DTout(%1,%2,%3) ;Подготовка буфера вывода
 ;%1 - устройство, %2 - BSR, %3 - BST
 I %1=0 Q
 S:$G(%2)="" %2=$G(BSR) S:$G(%3)="" %3=$G(BST) I BSR=""!(BST="") Q
 
 N i,i1,i2,str,sh,d,d1,d0,st,str1,n,sh1,str2,%zT
 S %zT=$ZT,$ZT="END^%ZAPM.ed.BSout3"
 K ^%ZAPM.ed.BSbufB("uP"_$G(%BS(3),$P)_$J_"u")
 I '$D(%CAL) D CALC^%ZAPM.ed.BSF3
 I %1=4,'$D(%BS(21)) D ErrMsg^%ZAPM.ed.BSXfun(" Вывод на ПФЛ не определен в SETUP") Q
 K ^%ZAPM.ed.BSbufB("uP"_$G(%BS(3),$P)_$J_"u") S ls="Формируется буфер вывода" D WAITS^%ZAPM.ed.BSF2
 S lst=$S(%1=4:60,%1=1:79,1:80)  ;длина строки
 S (i,str)="",sh=0,n=1 F  S i=$O(@(BSR_"(BST,i)")) Q:'i  D  X $G(WA)
 .S i1="" F  S i1=$O(@(BSR_"(BST,i,i1)")) Q:'i1  D
 ..I $E($P(^(i1),"@",3),1)="X"!($E($P(^(i1),"@",4),1)="X") Q
 ..I $P($P(^(i1),"@",18),"#",2)="" Q
 ..S st=$G(^(i1)) D DK I d="" Q
 ..S str1=$S(sh=0:"",1:"=")_$P($P(st,"@",18),"#",2)_d D STR Q
 I str'=""&(str'["+++") S ^%ZAPM.ed.BSbufB("uP"_$G(%BS(3),$P)_$J_"u",n)=str
 
END ;Посылка на устройство
 
 S $ZT=$G(%zT)
 I %1=3 D  Q
 .S ^%ZAPM.ed.BSbufB("uP"_$G(%BS(3),$P)_$J_"u")="Буфер вывода @@@@@@@1@1@22@80@@@@1@@5@@@1@@@@@@@@@@@1;6;36;44//1;6;36;40@@@@@@@1"
 .S TXT="uP"_$G(%BS(3),$P)_$J_"u" D ^%ZAPM.ed.BSX("EDIT","^%ZAPM.ed.BSbufB",TXT) Q
 N Pfl S Pfl=1,out=$$OUT^%ZAPM.ed.BSout2(BSR,BST,%1)
 Q
 
STR ;Формирование строки
 S str=str_str1,sh1=0
 F i2=1:1 D  Q:sh1=1
 .I $L(str)<lst S sh1=1 Q
 .S str2=$E(str,1,lst),str=$E(str,lst+1,$L(str))
 .S ^%ZAPM.ed.BSbufB("uP"_$G(%BS(3),$P)_$J_"u",n)=str2,n=n+1 Q
 I str1'["+++" S sh=1 Q
 S ^%ZAPM.ed.BSbufB("uP"_$G(%BS(3),$P)_$J_"u",n)=str,n=n+1,sh=0,str="" Q
 
DK ;Обработка данных клетки
 N BS,ny,nx,isp,Vi,Vi1  S BS=st
 
 I $P(BS,"@",9)=1 S d=$P(BS,"@",15)
 E  S d=$G(^%ZAPM.ed.BSbufB("BB"_$G(%BS(3),$P)_$J_"u"_%BS(15),i,i1))
 Q:$P($P(BS,"@",18),"#",3)=""
 S Vi=$P($P($P(BS,"@",18),"#",3),","),Vi1=$P($P($P(BS,"@",18),"#",3),",",2)
 S isp=$G(@(BSR_"(BST,""FCL"",Vi,Vi1)"),"") K d1 X isp S d=$G(d1,d) Q
 Q
]]></Routine>


<Routine name="%ZAPM.ed.BSout4" type="MAC" languagemode="0"><![CDATA[
%BSout4 ;Формирование блока  (А.Тимофеев) ; 14:57   02.03.99
 
BL(%2,%3) ;Создание таблицы - блока (данные клеток выносятся в описание)
 ;%2 - BSR, %3 - BST
 I $G(%2)=""!($G(%3)="") Q 0
 S:$G(BSR)="" BSR=%2 S:$G(BST)="" BST=%3
 N i,i1,i2,st,tit,Ty,Tx,d,d0,d1,%zT,sh,sh1,Kx,Ky,Lx,Ly
 S %zT=$ZT,$ZT="ZT^%ZAPM.ed.BSout4"
 
 K ^%ZAPM.ed.BSbufB("uP"_$G(%BS(3),$P)_$J_"u"),^%ZAPM.ed.BSbufB("L"_$G(%BS(3),$P)_$J_"u")
 I $P(@(BSR_"(BST)"),"@",19) S tit=$P(@(BSR_"(BST)"),"@",19) ;|
 I $P(@(BSR_"(BST)"),"@",50) S tit=$P(@(BSR_"(BST)"),"@",50) ;ТИТУЛ ПЕЧАТИ```MSW
 I $G(tit)'="" S Ty=$P(tit,","),Tx=$P(tit,",",2)   ;координаты титула
 S ls="Формируется блок !" D WAITS^%ZAPM.ed.BSF2
 
 ;Отбор строк, колонок
 S (sh,sh1)=0
 S i="" F  S i=$O(@(BSR_"(BST,i)")) Q:i=""  D  X $G(WA) I sh=1!(i<$G(Ty)) S ^%ZAPM.ed.BSbufB("uP"_$G(%BS(3),$P)_$J_"u",0,i)=1,sh=0
 .S i1="" F  S i1=$O(@(BSR_"(BST,i,i1)")) Q:i1=""  D  I sh1=1!(i1<$G(Tx)) S ^%ZAPM.ed.BSbufB("uP"_$G(%BS(3),$P)_$J_"u",1,i1)=1,sh1=0
 ..S st=$G(@(BSR_"(BST,i,i1)"))
 ..I $P(st,"@",12)=1 S (sh,sh1)=1 Q
 ..Q
 
 ;Формирование таблицы
 S i="" F  S i=$O(@(BSR_"(BST,i)")) Q:i=""  D  X $G(WA)
 .S i1="" F  S i1=$O(@(BSR_"(BST,i,i1)")) Q:i1=""  D
 ..S st=$G(@(BSR_"(BST,i,i1)")),Ky=$P(st,"@"),Kx=$P(st,"@",2),Ly=$P(st,"@",3),Lx=$P(st,"@",4)
 ..I '$D(^%ZAPM.ed.BSbufB("uP"_$G(%BS(3),$P)_$J_"u",0,i)) D 1
 ..I '$D(^%ZAPM.ed.BSbufB("uP"_$G(%BS(3),$P)_$J_"u",1,i1)) D 1 Q
 ..D 2 S ^%ZAPM.ed.BSbufB("L"_$G(%BS(3),$P)_$J_"u",i,i1)=Ky_"@"_Kx_"@"_Ly_"@"_Lx_"@@@@@1@2;6;30;47@@@@@"_d0_"@@@"_$P(st,"@",18) Q
 S ^%ZAPM.ed.BSbufB("L"_$G(%BS(3),$P)_$J_"u")=@(BSR_"(BST)"),$P(^%ZAPM.ed.BSbufB("L"_$G(%BS(3),$P)_$J_"u"),"@",1)="Таблица - блок "
 ;S ^%ZAPM.ed.BSbufB("L"_$G(%BS(3),$P)_$J_"u")="Таблица - блок @@1@@@1@1@1@1@22@80@1@@1@1@@1@@2,4@1@@@@@1@@@43@12@@1;6;33;44@@@@@@"
 K ^%ZAPM.ed.BSbufB("uP"_$G(%BS(3),$P)_$J_"u")
 S YES=1,$ZT=%zT
 ;S TIP=1 D TAB^%ZAPM.ed.BSF1 S IYI="^%ZAPM.ed.BSbufB"_"("_"L"_$G(%BS(3),$P)_$J_"u" D NE^%ZAPM.ed.BSN ;```
 Q 1
 
1 ;Вычленение непомеченных строк, колонок и клеток
 D
 .I '$D(^%ZAPM.ed.BSbufB("uP"_$G(%BS(3),$P)_$J_"u",0,i)) S:$E(Ly,1)'="X" Ly="X"_Ly Q
 .I '$D(^%ZAPM.ed.BSbufB("uP"_$G(%BS(3),$P)_$J_"u",1,i1)) S:$E(Lx,1)'="X" Lx="X"_Lx Q
 I i'=0 S ^%ZAPM.ed.BSbufB("L"_$G(%BS(3),$P)_$J_"u",i,i1)=Ky_"@"_Kx_"@"_Ly_"@"_Lx_"@@@@@1@2;6;30;47@@@@@"
 Q
 
2 ;Определение данных клетки
 N BS,ny,nx  S BS=st
 I $P(BS,"@",9)=1 S (d1,d,d0)=$P(BS,"@",15)
 E  S (d1,d,d0)=$G(^%ZAPM.ed.BSbufB("BB"_$G(%BS(3),$P)_$J_"u"_%BS(15),i,i1))
 I d0="" S d0=" "
 I $P(BS,"@",8)'="" S ny=i,nx=i1 D
 .I $P(BS,"@",8)=0 X $G(@(BSR_"(BST,""FTR"","_i_","_i1_")")) S d0=d1 Q
 .X $G(@(BSR_"(BST,""FTR"","_$P(BS,"@",8)_")")) S d0=d1
 Q
 
ZT S $ZT=%zT Q 0
 
]]></Routine>


<Routine name="%ZAPM.ed.BSout5" type="MAC" languagemode="0"><![CDATA[
%BSout5 ; пакетный вывод на устройство  (А.Тимофеев) ; 10:11 14-AUG-98
 
 S pacetF=1,%zT=$ZT,$ZT="ERROR" N i
1 S A=$$LOAD^%ZAPM.ed.BSscrF("^%ZAPM.ed.BSS(OPout5)",2,2,"#") Q:A=""
 S tab=$P(%BS("Tmp","LastTabl"),"@",4)
 I tab=27 S $ZT=%zT Q
 S tab=$P(A,"#"),pacetG=$P(A,"#",2),pacetU=$P(A,"#",3),pacetD=$P(A,"#",4),pacetO=1
 I tab="" D ErrMsg^%ZAPM.ed.BSXfun("Не выбраны таблицы !!") S $ZT=%zT Q
 I pacetU=""  D ErrMsg^%ZAPM.ed.BSXfun("Не определено устройство вывода !!") S $ZT=%zT Q
 F i=1:1 S tab1=$P(tab,"~",i) Q:tab1=""  D
 .S Tbsr="^"_$S($P(tab1,",",3)'="":"["""_$P(tab1,",",3)_""","""_$P(tab1,",",4)_"""]",1:"")_$P(tab1,",",2)
 .S Tbst=$P(tab1,",")
 .D Kout^%ZAPM.ed.BSout0(pacetU,Tbsr,Tbst) I $P($G(bok),"~",3)="" K in
 D:$G(pacetD)="" OkMsg^%ZAPM.ed.BSXfun("Вывод завершен !",6)
 K pacetF,pacetG,pacetU,pacetD,pacetO,Tbsr,Tbst
 S $ZT=%zT G 1
 
ERROR D ErrMsg^%ZAPM.ed.BSXfun("ГЛЯ - !!"_$ZE)
 S $ZT=%zT Q
]]></Routine>


<Routine name="%ZAPM.ed.BSoutNF" type="MAC" languagemode="0"><![CDATA[
%BSoutNF ; Вывод данных в новом формате (А.Тимофеев) ; 10:12   26.12.2002
 
 N i,i1,mas,mas1,d,st,str,n,BSRz,BSTz
 ;S %zT=$ZT,$ZT="STOP"
 D 333^%ZAPM.ed.BSF
 S B=1,BSRz=BSR,BSTz=BST D TIP+1^%ZAPM.ed.BST
 S masV="^%ZAPM.ed.BSbufB(""PO"_$G(%BS(3),$P)_$J_"u"")",masN=$P(masV,")")_",""n"")",masB=$P(masV,")")_",""bok"")",masP=$P(masV,")")_",""ea"")"
 
1 ;
 S mas1="^%ZAPM.ed.BSbufB(""uP"_$G(%BS(3),$P)_$J_"u"")" S ls="Формируется буфер вывода" D WAITS^%ZAPM.ed.BSF2
 K @mas1
 
 I '$D(%CAL) D CALC^%ZAPM.ed.BSF3
 K ^%ZAPM.ed.BSbufB("uP"_$G(%BS(3),$P)_$J_"u") S ls="Формируется буфер вывода" D WAITS^%ZAPM.ed.BSF2
 S n=1,i="" F  S i=$O(@(BSR_"(BST,i)")) Q:'i  D  X $G(WA)
 .S i1="" F  S i1=$O(@(BSR_"(BST,i,i1)")) Q:'i1  D
 ..I $E($P(^(i1),"@",3),1)="X"!($E($P(^(i1),"@",4),1)="X")!($E($P(^(i1),"@",3),1)=0) Q
 ..I $P($P(^(i1),"@",18),"#",2)="" Q
 ..S sno=$P($P(^(i1),"@",18),"#",2),st=$G(^(i1)) D DK  I d="" Q   S d=$S(sno="{":" ",sno="}":" ",d'="":d,1:"") I d="" Q
 ..S str=sno_$S(sno="{":"",sno="}":"",$E(sno,1)=";":"",sno="NOD":"",1:"=")_$S(sno="{":"",sno="}":"",1:d)
 ..I str'="" S ^%ZAPM.ed.BSbufB("uP"_$G(%BS(3),$P)_$J_"u",n)=str,n=n+1
 S ^%ZAPM.ed.BSbufB("uP"_$G(%BS(3),$P)_$J_"u")="Буфер вывода @@@@@@@1@1@22@80@@@@1@@5@@@1@@@@@@@@@@@1;6;36;44//1;6;36;40@@@@@@@1"
 S TXT="uP"_$G(%BS(3),$P)_$J_"u" D ^%ZAPM.ed.BSX("EDIT","^%ZAPM.ed.BSbufB",TXT)
 ;D OkMsg^%ZAPM.ed.BSXfun(" ОТРАБОТАНО !",2) S BSR=BSRz,BST=BSTz Q
 K BSR,BST D NE^%ZAPM.ed.BSN S BSR=BSRz,BST=BSTz,%0="" Q
  
DK ;Обработка данных клетки
 N BS,ny,nx,isp,Vi,Vi1  S BS=st
 ;I sno'="" D x^%ZAPM.ed.BS3(1)
 
 I $P(BS,"@",9)=1 S d=$P(BS,"@",15)   ;,d1=""
 E  S d=$G(^%ZAPM.ed.BSbufB("BB"_$G(%BS(3),$P)_$J_"u"_%BS(15),i,i1))
 Q:$P($P(BS,"@",18),"#",3)=""
 S Vi=$P($P($P(BS,"@",18),"#",3),","),Vi1=$P($P($P(BS,"@",18),"#",3),",",2)
 S isp=$G(@(BSR_"(BST,""FCL"",Vi,Vi1)"),"") K d1 X isp S d=$G(d1,d) Q
 Q
 
STOP ;ERROR
 D ErrMsg^%ZAPM.ed.BSXfun("Гля - сопля !!! "_i_"."_$G(Vi)_"."_$G(Vi1))
 S $ZT=%zT Q
 
]]></Routine>


<Routine name="%ZAPM.ed.BSprint" type="MAC" languagemode="0"><![CDATA[
%BSprint(UStro) ;РЕЗИДЕНТ ПРИНТ-СЕРВЕР ; 15:25 15-JUL-98
0 D S("A",1),S("D",0) D KI D S("S",$S),S("T",$$h^%ZAPM.ed.BS3()),S("E","")
R F  H $$PAR(4) Q:$$U("C")'=""
 I $$U("C")="D" G EXIT
 I $$U("C")="S" C:$D(US) US G EEE
 I $$U("C")["u" D S("O",$$U("C")),S("C","") G R
 I $$U("C")="!" G R:$$PRN D KI G WAIT
 I $$U("C")="?" D S("C",""),S("O","?") G R
 I $$U("C")="P" G PRINT:$$U("B")'="" D E("ЗАПРОСА НЕТ") G R
 I $$U("C")="R" G PRINT:$$U("B")'="" D E("ЗАПРОСА НЕТ") G R
 G R
E(E) D S("E",E) Q
ER I $ZE["PROT>" D E("БУФЕР НЕ ДОСТУПЕН")
 D E($ZE) S $ZT=$G(%zT) D BEL G WAIT
BEL Q  Q
PRINT ;САМ ПРОЦЕСС
 S %zT=$ZT,$ZT="ER^%ZAPM.ed.BSprint"
 D S("C",""),S("D",1) D CTRL S BU=$$U("B") I BU="" D E("НЕТ БУФЕРА") G WAIT
 S Z=$$U("Z"),BU="^["""_$P(Z,",")_""","""_$P(Z,",",2)_"""]"_$P(BU,"^",2,99)
 I '$D(@BU) D E("БУФЕР ПУСТОЙ") G WAIT
 D L^%ZAPM.ed.BS3(BU,1) I 'LOC D E("БУФЕР ЛОКИРОВАН") G WAIT
REST S PRO=$O(@BU@(""),-1) I 'PRO D E("НЕТ СТРОК") G WAIT
 S (EXE,EX)=1 I $$U("EXE") S (EXE,EX)=$$U("EXE")
 ;
PRI S i="",qz="" F  S i=$O(@BU@(i)) Q:i=""  D  Q:qz'=""  I '(i#3) S VST=(EX-1)*PRO+i D S("P",(100-(VST*100\(PRO*EXE)))),S("N",VST)
 .I $$U("RP")=2&($E($G(@BU@(i)),1,5)="'~'~'") S i=i+1 W # Q
 .U US W !,$J("",$$U("OT")),$G(@BU@(i)) I $$U("C")'="" D
 ..I $$U("C")="?" D S("C",""),S("O","?") Q
 ..I $$U("C")="D" D S("C","") S qz="D" Q
 ..I $$U("C")="S" D S("C","") S qz="S" Q
 ..I $$U("C")="R" D S("C","") S qz="R" Q
 ..I $$U("C")="I" D S("C","") S qz="I" Q
 U US W !
 I qz="",EX>1 S EX=EX-1 D S("EX",(EX_" из "_EXE)) W ! G PRI
 W $$SBROS^%ZAPM.ed.BSJPRN(US) I qz="I" D S("P",""),S("N",""),S("D",2) G R
 I qz="R" D S("P",""),S("N","") G REST
 C US I "S"[qz G EEE
 I qz="D" G EXIT
EEE D U^%ZAPM.ed.BS3(BU),S("D",0) D KI D S("S",$S),S("E","") ;ЗАКОНЧИЛИ ПЕЧАТАТЬ
 G WAIT
CTRL N Z ;Инициализация принтера
 U US I $$PR(15)'="" W $C($$PR(15)) ;СБРОС
 F Z="US","UL","UK" I $$U(Z)'="" W $C($$U(Z))
 Q
WAIT D KI ;ЗАКОНЧИЛИ
 I $D(BU) D U^%ZAPM.ed.BS3(BU)
 I $$PAR(5)'="Y" D S("D",0) G R
 G EXIT
PAR(N) ;ПАРАМЕТРЫ СЕРВЕРА
 Q $P($G(^%ZAPM.ed.BSETUP("PARPRN",N,2)),"@",15)
PRN() S US=$$PR(17) I 'US D S("O",0),E("УСТ.ПЕЧ "_US_"?") Q 0
 O US:$$MAX^%ZAPM.ed.BSJPRN(US):1 E  D S("O",1),E("УСТ.ПЕЧ ЗАНЯТО") Q 0
 D S("O","OK") Q 1
PR(P) Q $G(@UStro@((P_",2")))
KI N I F I="O","T","S","EX","EXE","N","P","Z","B","US","UL","UK","OT","RP" D K(I)
  Q
EXIT N I D KI F I="C","A","D" D K(I)
 Q
K(U) K @UStro@(U) Q
S(U,S) I S="" K @UStro@(U) Q
 S @UStro@(U)=S Q
U(U) Q $G(@UStro@(U))
]]></Routine>


<Routine name="%ZAPM.ed.BSre" type="MAC" languagemode="0"><![CDATA[
%BSre ; пpогpамма ПЕРЕКОДИРОВОК ; 13:43   15.04.2003
 Q
CTRL(S) ;УДАЛЕНИЕ УПРАВЛЯЮЩИХ СИМВОЛОВ
 Q $TR(S,$C(0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31),"")
Ansi2Asc D DOSREAD^%ZAPM.ed.BSS1 Q:'$D(%FN)
 D ANS(%FN)
 Q
Ascii2An N %FN
 D DOSREAD^%ZAPM.ed.BSS1 Q:'$D(%FN)
 D AS(%FN)
 Q
DBFREAD(Say1,%Fn,Say2,GL,NOSCHET) N YES,D ;ЗАКАЧКА ИЗ ДБФ В МАССИВ С ВЫБОРОМ
 I $G(AUTO)=1 S %FN=%Fn D D Q $G(D,-1)
 D DBF Q $G(D,-1)
DB(%FN,GL,NOSCHET) ;ЗАКАЧКА ИЗ ДБФ В МАССИВ
 N %DEV,End,li,D D D Q $G(D,-1)
DBF ;СЧИТАТЬ dbf В МАССИВ
 N %FN,%DEV,End,li
 I $D(Say1) W /CUP(22,1),/EL(0),Say1
 D DOSREAD^%ZAPM.ed.BSS1 I $D(Say1) W /CUP(22,1),/EL(0)
 Q:'$D(%FN)  ;%Fn - файл по-умолчанию
 S li=$G(GL,"^ZZZ") I $D(Say2) W /CUP(22,1),/EL(0),Say2
 D GLO^%ZAPM.ed.BSF3 I $D(Say2) W /CUP(22,1),/EL(0)
 Q:YES<1  I '$D(NOSCHET) S NOSCHET=1  ;GL - массив по - умолчанию
D K @GL I $$Open^%ZAPM.ed.BSXdbf(%FN,GL)'=0 Q
 S End=@GL@("Head","RecNum")
 S D=$$ReadRec^%ZAPM.ed.BSXdbf(%FN,GL,1,End)
 Q
%BS35 ;ТАБЛИЦА ТРАНСЛЯЦИИ КОДОВ
 K %BS(35) N MN,F,SK,K
 S MN=$G(%BS(13),"???") ;NSP - ТЕРМИНАЛА
 I $ZV["MSM-Workstation" S MN="KEY-WS"
 I $ZV["Cach"||($ZV["IRIS") S MN="KEY-CACHE",%BS(32)="^%ZAPM.ed.BS364" ;,%BS(32)="^%CHARWIN"
  F F=0,"ALT","SFT","CRL" S K="" F  S K=$O(^%ZAPM.ed.BSR(MN,F,K)) Q:K=""  D
  .S SK=^%ZAPM.ed.BSR(MN,F,K) Q:"-1"[SK  I '$D(^%ZAPM.ed.BSR("KEY-PC",F,K)) Q
  .Q:SK=^%ZAPM.ed.BSR("KEY-PC",F,K)  ;СОВПАДАЕТ
  .S %BS(35,SK)=^%ZAPM.ed.BSR("KEY-PC",F,K)
 Q
KEYS ;СОЗДАТЬ МАССИВ ТРАНСЛЯЦИИ СКАН-КОДОВ КЛАВИТУРЫ
 Q
 N P,K,F,R1,R2,R3,R4,R5,iV,iiV
 ;S P="KEY-PC" ;КОНСОЛЬ
 ;S P="PCTT" ;ТЕРМИНАЛ
 I $ZV["MSM-Workstation" S P="KEY-WS"
 I $ZV["Cach"||($ZV["IRIS") S P="KEY-CACHE" ;Cache' from InterSystems
 F F=0,"ALT","SFT","CRL" D
 .F K=1:1:12 D READ($NA(^%ZAPM.ed.BSR(P,F,K)),"ВВЕДИТЕ "_F_"-F"_K)
 .F K="IN","DL","HM","EN","PU","PD" D READ($NA(^%ZAPM.ed.BSR(P,F,K)),"ВВЕДИТЕ "_F_" - "_K)
 .S K="BCSP" D READ($NA(^%ZAPM.ed.BSR(P,F,K)),"ВВЕДИТЕ "_F_"- "_K)
 .F K="UP","DN","RT","LT" D READ($NA(^%ZAPM.ed.BSR(P,F,K)),"ВВЕДИТЕ "_F_"-СТРЕЛКИ "_K)
 .F K=65:1:90 D READ($NA(^%ZAPM.ed.BSR(P,F,K)),"ВВЕДИТЕ "_F_"-"_$C(K))
 Q
READ(G,S) N iV,iiV,R1,R2,R3,R4,R5 W !,S," "
 I $ZV["Cach"||($ZV["IRIS") D READC ;Cache' from InterSystems
 I $ZV["PC/PLUS" D READT ;MSM-PC/PLUS
 I iiV'="13,-1,-1,-1,-1" S @G=iiV
 Q
READT N r,o,d,t,i r *o s d=o d  i t f  s d=d_","_o d  q:t=0
 .f i=1:1:30 r *o:0 s t=$t q:t
 S iiV=$P(d_",-1,-1,-1,-1",",",1,5) G REA
READM R *R1,*R2:0,*R3:0,*R4:0,*R5:0 S iiV=R1_","_R2_","_R3_","_R4_","_R5 G REA
READC R *R1 S R2=$ZB S iiV="" F iV=1:1:5 S iiV=iiV_$A($E(R2,iV)) I iV'=5 S iiV=iiV_","
REA W " --> ",iiV
 Q
S S BST="CMD",BSR="^%ZAPM.ed.BSS" D ^%ZAPM.ed.BST
 Q
s1(a) d INIT(a) q S1
s2(a) d INIT(a) q S2
INIT(A) ;трансляциЯ из ASCII в ANSI ; 14:21 26-SEP-97
 N B,I,L1,L2,D,D1,P,b,i,l1,l2,d,d1,p
 S B="",b="" F I=128:1:159 S B=B_$C(I),b=b_$C(I+64)
 S L1="",l1="" F I=160:1:175 S L1=L1_$C(I),l1=l1_$C(I+64)
 S L2="",l2="" F I=224:1:239 S L2=L2_$C(I),l2=l2_$C(I+16)
 S D="" F I=240:1:255 S D=D_$C(I)
 S d=$C(168,184,170,186,175,191,161,162,176,173,183,172,185,164,167,182)
 I A D
 .S D1=$C(176,177,178,219,220,221,222,223)
 .S d1=$C(183,173,177,182,95,91,93,174)
 .; P="||||||--|+||==||=-==-=--==-====-=---==--"
 .S P=$C(179,180,181,182,185,186,193,194,195,197,198,199,202,203,204,206,207,208,209,210,215,216,218,211,212,213,214,200,201,187,188,189,190,191,192,183,184,205,196,217)
 .S p="||||||--|+||==||=-==-=--==-====-=---==--"
 .I A=2 S p=$C(148,154,178,179,180,161,156,155,153,159,175,176,188,146,177,191,186,187,181,183,190,189,149,170,169,162,163,171,164,167,174,173,172,150,151,166,165,160,147,152)
 S S1=B_L1_L2_D_$G(D1)_$G(P),S2=b_l1_l2_d_$G(d1)_$G(p)
 Q
AS(V,EXT) ;V-ДОС ФАЙЛ ТРАНСЛЯЦИЯ  из ASCII ("_FNO_") в ANSI ("_FN_")")
 S %zT=$ZT,$ZT="ERFILE^%ZAPM.ed.BSre"
 S DOS=51,FNO=V I $$Open^%ZAPM.ed.BSXdos(FNO,"R")
 S DOS1=DOS,FN=$L(V,".")-1 S:($L(FN,".")-1)<1 FN=1
 S DOS=52,FN=$P(V,".",1,FN)_"."_$G(EXT,"ANS") I $$Open^%ZAPM.ed.BSXdos(FN,"W")
 d Wait^%ZAPM.ed.BSXfun("ТРАНСЛЯЦИЯ  из ASCII ("_FNO_") в ANSI ("_FN_")")
 I $G(EXT)["HTM" U DOS W "<HTML><TITLE>"_$P(V,".")_"</TITLE><BODY><PRE>"
 F v=1:1 U DOS1 R S Q:$ZC'=0  D  I '(v#50) U 0 X $G(WA)
 .U DOS W $$HTm($$ANSI(S)),!
 I $G(EXT)["HTM" U DOS W "</PRE></BODY></HTML>"
Vi C DOS1,DOS U 0
 Q
HTm(S) I $G(EXT)'["HTM" Q S
 Q $$TEGS(S) ;_"<BR>"
TEGS(S) I S["<" S S=$$TR^%ZAPM.ed.BSsFUNM(S,"<","&lt;")
 I S[">" S S=$$TR^%ZAPM.ed.BSsFUNM(S,">","&gt;")
 ;I S[" " S S=$$TR^%ZAPM.ed.BSsFUNM(S," ","&nbsp;")
 ;I S["%" S S=$$TR^%ZAPM.ed.BSsFUNM(S,"%","%25")
 ;I S["\" S S=$$TR^%ZAPM.ed.BSsFUNM(S,"\","%5C")
 ;I S[":" S S=$$TR^%ZAPM.ed.BSsFUNM(S,":","%3A")
 Q $TR(S,$C(0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,26,28,29,30,31),"")
ERFILE U 0 I $ZE["<ENDOFFILE" G Vi
 D ErrMsg^%ZAPM.ed.BSXfun($ZE_" "_$$ErrSay^%ZAPM.ed.BSF8($ZE)) S $ZT=$G(%zT) G Vi
ACTIONS(F,XEC) G ACTION ;Action - ДЕЙСТВИЕ СО СТРОКАМИ ФАЙЛА  str
REPLACE(F,P1,P2) ;МОДУЛЬ ПАКЕТНОГО РЕДАКТИРОВАНИЯ ФАЙЛОВ
 N XEC
 S XEC="I str["""_P1_""" S str=$$TR^%ZAPM.ed.BSsFUNM(str,P1,P2)"
ACTION S %zT=$ZT,$ZT="ERFILE^%ZAPM.ed.BSre"
 N v,DOS,DOS1,FNO,FN
 S DOS=51,FNO=F I $$Open^%ZAPM.ed.BSXdos(FNO,"R")
 S DOS1=DOS,FN=$L(F,".")-1 S:($L(FN,".")-1)<1 FN=1
 S DOS=52,FN=$P(F,".",1,FN)_".$!$" I $$Open^%ZAPM.ed.BSXdos(FN,"W")
 d Wait^%ZAPM.ed.BSXfun("ТРАНСЛЯЦИЯ ("_FNO_")")
 F v=1:1 U DOS1 R str Q:$ZC'=0  D  I '(v#50) U 0 X $G(WA)
 .U 0 X XEC U DOS W str,!
 I str'="" U 0 X XEC U DOS W str,!
 C DOS1,DOS,63 U 0
 I $$ZOS3^%ZAPM.ed.BSDOS(FN,FNO)<0 ;D ErrMsg^%ZAPM.ed.BSXfun("НЕ МОГУ ПЕРЕИМЕНОВАТЬ "_FN_" В "_FNO) ;Rename a File
 ;I $$ZOS2^%ZAPM.ed.BSDOS(FNO)<0 D ErrMsg^%ZAPM.ed.BSXfun("НЕ МОГУ УДАЛИТЬ "_FNO)
 ;D EXE^%ZAPM.ed.BSDOS("XCOPY.EXE "_FN_" "_FNO,1)
 ;I $$ZOS2^%ZAPM.ed.BSDOS(FN)<0 D ErrMsg^%ZAPM.ed.BSXfun("НЕ МОГУ УДАЛИТЬ "_FN)
 Q
ANSI(S) I '$D(S1) D INIT(1)
 Q $TR(S,S1,S2)
ASCII(S) I '$D(S1) D INIT(0)
 Q $TR(S,S2,S1)
ANS(V) ;V-ДОС ФАЙЛ
 S %zT=$ZT,$ZT="ERFILE^%ZAPM.ed.BSre"
 S DOS=51,FNO=V I $$Open^%ZAPM.ed.BSXdos(FNO,"R")
 S DOS1=DOS,FN=$L(V,".")-1 S:($L(FN,".")-1)<1 FN=1
 S DOS=52,FN=$P(V,".",1,FN)_".ASC" I $$Open^%ZAPM.ed.BSXdos(FN,"W")
 d Wait^%ZAPM.ed.BSXfun("ТРАНСЛЯЦИЯ  из ANSI ("_FNO_") в ASCII ("_FN_")")
 F v=1:1 U DOS1 R S Q:$ZC'=0  D  I '(v#50) U 0 X $G(WA)
 .U DOS W $$ASCII(S),!
 C DOS1,DOS U 0 Q
ALTS ;ПЕРЕКОДИРОВКА ТЕКУЩЕГО ТЕКСТА ИЗ ANSI --> ASCII
 I $G(@BSR@(BST,"ASCII"))="ASCII" Q
 N S,S1,S2,I
 F I=1:1 Q:'$D(@BSR@(BST,I))  S @BSR@(BST,I)=$$ASCII(@BSR@(BST,I))
 S @BSR@(BST,"ASCII")="ASCII",$P(@BSR@(BST),"@",6)=1
 Q
ALTE ;ПЕРЕКОДИРОВКА ТЕКУЩЕГО ТЕКСТА ИЗ ASCII --> ANSI
 I $G(@BSR@(BST,"ASCII"))="ANSI" Q
 N S,S1,S2,I
 F I=1:1 Q:'$D(@BSR@(BST,I))  S @BSR@(BST,I)=$$ANSI(@BSR@(BST,I))
 S @BSR@(BST,"ASCII")="ANSI",$P(@BSR@(BST),"@",6)=1
 Q
NODATE I '$D(^%ZAPM.ed.BSETUP("YEAR",1)) D OkMsg^%ZAPM.ed.BSXfun("А ПОДМЕНА И НЕ ПРОИЗВОДИЛАСЬ") Q
 I $D(^%ZAPM.ed.BSETUP("YEAR",1)) D OkMsg^%ZAPM.ed.BSXfun("ПОДМЕНА ОТМЕНЕНА") K ^%ZAPM.ed.BSETUP("YEAR",1),%BS(36)
 Q
SYSDATE N li,H S li=$$LineEdit^%ZAPM.ed.BSXfun("","ТОГДА КАКАЯ СЕЙЧАС ДАТА ? (ГГММДД)") Q:li<1
 S H=$$DATHR^%ZAPM.ed.BSsFUNR(6,li) D Yes^%ZAPM.ed.BSXfun("Я ПРАВИЛЬНО ВАС ПОНЯЛА ? "_$$ESDAY^%ZAPM.ed.BSsFUNR(6,H)) I YES<0 G SYSDATE
 I +H=+$H D OkMsg^%ZAPM.ed.BSXfun("ПОДМЕНА НЕ НУЖНА ! СИСТЕМНАЯ ДАТА И РЕАЛЬНАЯ СОВПАДАТ") G NODATE
 S ^%ZAPM.ed.BSETUP("YEAR",1)=H-$H,%BS(36)=$H+$G(^%ZAPM.ed.BSETUP("YEAR",1))
 Q
SAVE ;СОХРАНИТЬ ССЫЛКУ НА КОМАНДУ СОХРАНЕНИЯ В ТАБЛИЦЕ
 N li S li=$G(@BSR@(BST,"SVM"))
 S li=$$LineEdit^%ZAPM.ed.BSXfun(li,"ВВОДИТЕ ССЫЛКУ НА КОМАНДУ СОХРАНЕНИЯ В ТАБЛИЦЕ") Q:YES<0
 I li="" K @BSR@(BST,"SVM") Q
 S @BSR@(BST,"SVM")=li
 Q
REST ;СОХРАНИТЬ ССЫЛКУ НА КОМАНДУ ВОССТАНОВЛЕНИЯ В ТАБЛИЦЕ
 N li S li=$G(@BSR@(BST,"RSM"))
 S li=$$LineEdit^%ZAPM.ed.BSXfun(li,"ВВОДИТЕ ССЫЛКУ НА КОМАНДУ ВОССТАНОВЛЕНИЯ В ТАБЛИЦЕ") Q:YES<0
 I li="" K @BSR@(BST,"RSM") Q
 S @BSR@(BST,"RSM")=li
 Q
XM(C) ;ВЫПОЛНИТЬ КОМАНДУ
 S %zT=$ZT,$ZT="ERXM^%ZAPM.ed.BSre" X C S $ZT=$G(%zT)
 Q
ERXM D ErrMsg^%ZAPM.ed.BSXfun($ZE_" "_$$ErrSay^%ZAPM.ed.BSF8($ZE)) S $ZT=$G(%zT) Q
 Q
CloseCLC ;МОДУЛЬ ПРЕДОБРАБОТКИ - ВЫКЛ ВЫЧИСЛЕНИЯ ПОСЛЕ ПЕРВОГО РАЗА
 I R1=333,BSR["%BSbufS" K @BSR@(BST,"FCL")
 Q
CacheGR ;Restore Globals in Cache' Object
 D NaSET^%ZAPM.ed.BSZRO S NewG="" K ^BStempERROR
 F I=1:1 Q:'$D(@G@("ROU",I))  F II=1:2 Q:'$D(@G@("ROU",I,II))  D
 .S S=@G@("ROU",I,II),SS=$G(@G@("ROU",I,II+1))
 .I NewG'=$P(S,"(") S NewG=$P(S,"(") I $E(NewG,1,4)="^%ZAPM.ed.BS"&($E(NewG,1,7)'="^%ZAPM.ed.BSbuf") K @NewG
 .D CacheSET(S,SS)
 K @G I $D(^BStempERROR) S ^BStempERROR=$$ESDAY^%ZAPM.ed.BSsFUNR(6,$H) ;Date for Cache'
 D NaGET^%ZAPM.ed.BSZRO
 Q
CacheSET(S,SS) S $ZT="CacheERS^%ZAPM.ed.BSre" S @S=SS
 Q
CacheERS S ^BStempERROR(S)=SS
 Q
INHTML(BSR,BST,FILE) ;!!!!!
 Q
OUTHTMLT N OUThtml ;ВЫВОД ТАБЛИЦЫ В HTML В ВИДЕ ТАБЛИЦЫ
 ;```S OUThtml=1
OUTHTML ;ВЫВОД ТАБЛИЦЫ В HTML
 N S1,S2,BUF,BUF1,BUF2,%DEV,%FN,S,DOS,FNO,PR1
 S PR1=$TR(BST,"[]!.?_:-",""),PR1=$$NETDIR^%ZAPM.ed.BSHTML1()_$E(PR1,$L(PR1)-7,$L(PR1))_".HTM" D DOSOPN^%ZAPM.ed.BSBL1 Q:'$D(%FN)
 I '$D(S1) D INIT(1)
 I $ZV["Cach"||($ZV["IRIS") S (S1,S2)=""
 D HTML^%ZAPM.ed.BSHTML($NA(@BSR@(BST)))
 C %DEV U 0 D OkMsg^%ZAPM.ed.BSXfun("Вывод Завершен")
 Q
TXT2HTML ;ВЫВОД ТЕКСТА В HTML
 N S1,S2,BUF,BUF1,BUF2,%DEV,%FN,S,DOS,FNO,PR1,EXT,v,PR1
 S PR1=$TR(BST,"[]!.?_:-",""),PR1=$$NETDIR^%ZAPM.ed.BSHTML1()_$E(PR1,$L(PR1)-7,$L(PR1))_".HTM" D DOSOPN^%ZAPM.ed.BSBL1 Q:'$D(%FN)
 I '$D(S1) D INIT(1)
 I $ZV["Cach"||($ZV["IRIS") S (S1,S2)=""
 d Wait^%ZAPM.ed.BSXfun("вывод HTML") S EXT="HTM"
 U %DEV W "<HTML><TITLE>"_BST_"</TITLE><BODY><PRE>",!
 F v=1:1 Q:'$D(@BSR@(BST,v))  D  U 0 X $G(WA)
 .U %DEV W $$HTm($TR(@BSR@(BST,v),S1,S2)),!
 U %DEV W "</PRE></BODY></HTML>"
 C %DEV U 0 D OkMsg^%ZAPM.ed.BSXfun("Вывод Завершен")
 Q
COPY(F) ;КОПИРОВАНИЕ ФАЙЛОВ ПОД НОВЫМ ИМЕНЕМ С ПРЕФИКСОМ ИЗ ИМЕНИ ДИРЕКТОРИИ
 N P,N,E,D
 S P=$P(FILE,"\",1,$L(FILE,"\")-2)
 S D=$P(FILE,"\",$L(FILE,"\")-1)
 S N=$P(FILE,"\",$L(FILE,"\"))
 S EXE=$$JOB^%HOSTCMD("COPY "_F_" "_P_"\"_D_"\"_D_N)
 Q
nbsp2(F) ;ЗАМЕНИТЬ НА ПРОБЕЛ
 N F1 S F1=$E(F,1,$L(F)-1)_"1"
 S EXE=$$JOB^%HOSTCMD("COPY "_F_" "_F1)
 S EXE=$$JOB^%HOSTCMD("DEL "_F)
 S %zT=$ZT,$ZT="ERFILE^%ZAPM.ed.BSre"
 S DOS=51,FNO=F1 I $$Open^%ZAPM.ed.BSXdos(FNO,"R")
 S DOS1=DOS,FN=F
 S DOS=52 I $$Open^%ZAPM.ed.BSXdos(FN,"W")
 d Wait^%ZAPM.ed.BSXfun(F)
 F v=1:1 U DOS1 R S Q:$ZC'=0  D  I '(v#50) U 0 X $G(WA)
 .U DOS W $$TR^%ZAPM.ed.BSsFUNM(S,"&nbsp;"," "),!
 C DOS1,DOS U 0
 S EXE=$$JOB^%HOSTCMD("DEL "_F1)
 Q
 
 Q
]]></Routine>


<Routine name="%ZAPM.ed.BSrep0" type="MAC" languagemode="0"><![CDATA[
%BSrep0 ;ОТЧЕТ ПО ТАБЛИЦЕ ```ОТЛАДКА ; 14:09   25.11.2000
 Q
int //внутрення точка входа для ИП
 ;N MAS S MAS(1,1)=BSTABL,MAS(1,2)=BSPART,MAS(1,3)=BSNSP
 D INFOtab2 ;(.MAS) 
 Q
ALLint  N STOP,XBD,MAS,U1,i,XTABL,XPART,MAF S XTABL="I $E(BSTABL,1)=""F"" S MAF(BSTABL)=BSPART" //ПЕРЕБОР ВСЕХ ФОРМ
 d LoopINT^%ZAPM.ed.BSCocx1 
 S U1="" F i=1:1  S U1=$O(MAF(U1)) Q:U1=""  S MAS(i,1)=U1,MAS(i,2)=MAF(U1),MAS(i,3)=BSNSP
 D INFOtab(.MAS) 
 Q
INFOtab(MAS) D BEG1^%ZAPM.ed.BSC4 W $$TITL^%ZAPM.ed.BSCGIS("Расширенная информация по структуре таблицы описания баз данных (%BS-формат)"),$$B27^%ZAPM.ed.BSCGIS(1)
 ;D locvar^%ZAPM.ed.BSCh0("",1)
 S I="" F  S I=$O(MAS(I)) Q:I=""  D INFOtab1(MAS(I,3),MAS(I,2),MAS(I,1))
 D BUTT^%ZAPM.ed.BSCGIS,END^%ZAPM.ed.BSC4
 q 
INFOtab1(BSNSP,BSPART,BSTABL)
 I '$$ZU^%ZAPM.ed.BSF4(BSNSP) Q
 W BK_MAROON_BSPART_"("_BSTABL_") "_EF_BLUE_$P(@BSPART@(BSTABL),"@")_EF_BBK_" <IFRAME WIDTH='900px' HEIGHT='200px' SRC='"_$$ADDBSGET^%ZAPM.ed.BSC4(,"INFOtab2^%ZAPM.ed.BSrep0")_"' name='ASIFRAME' SCROLLING='auto'></IFRAME><BR>"_BK
 Q
INFOtab2 D BEG1^%ZAPM.ed.BSC4
 S BSR=BSPART,BST=BSTABL D INFO^%ZAPM.ed.BSF6
 ;D locvar^%ZAPM.ed.BSCh0("",1)
 D SUMMINFO W "<PRE>" S I="" F  S I=$O(@BSr@(BSt,I)) Q:I=""  W BK_$P($G(@BSr@(BSt,I)),":")_MAROON_$P($G(@BSr@(BSt,I)),":",2)_EF d
 .i I=5 I $D(@BSR@(BST,"EXTAB")) W " Еxcell - проекция: "_BLUE_$p($g(@BSR@(BST,"EXTAB",1)),$c(9),1)_" "_$$CtrlRow^%ZAPM.ed.BSCocx1($NA(@BSR@(BST,"EXTAB")),4)_EF
 .i I=9 s i="" f  s i=$o(sum(i)) q:i=""  w " ("_RED_sum(i)_EF_"="_$$FORM^%ZAPM.ed.BSTT(i)_")"
 W "</PRE>"
 D END^%ZAPM.ed.BSC4
 Q 
TIP(%3) Q " ("_$S(%3=1:"простая таблица",%3=2:"таблица описывающая базу данных",%3=3:"таблица описывающая отчет по базе данных в виде списка",%3=4:"таблица описывающая отчет по базе данных в виде сводки",%3=5:"текст",%3=6:"таблица-Link",%3=7:"таблица-меню",%3=8:"панель с кнопками",%3=9:"насчитанный отчет",%3=10:"отчет по базе данных",%3=11:"диалоговая панель",1:"неизвестный тип")_")"
CR D CR^%ZAPM.ed.BSTT Q
GLOBAL S iS=$G(%KAT(1)),iB=$G(%KAT(2)),iBS=$G(%KAT(3)),BSr="^%ZAPM.ed.BSbufB",BSt="TotalSummeryInfo"
 S t0="---------=========== =============---------" D CR
 S t0="СВОДНЫЙ ОТЧЕТ ПО ТАБЛИЦЕ:  "_$P($G(%KAT(1)),"!",3) D CR
 S t0="                 РАЗДЕЛА:  "_$P($G(%KAT(1)),"!",2) D CR
 S t0="             ТИП ТАБЛИЦЫ:  "_$$TIP^%ZAPM.ed.BS($P($G(%KAT(2)),"@",17))_" "_$$TIP($P($G(%KAT(2)),"@",17)) D CR
 S t0="ПОСЛЕДНИЙ МОДИФИЦИРОВАЛ :  "_$P(%KAT(7,"LST"),",",3)_"   "_$$ESDAY^%ZAPM.ed.BSsFUNR(8,$P(%KAT(7,"LST"),",",1,2)) D CR
 S t0="---------=========== =============---------" D CR
 S t0="Коментарий к таблице     :"_$P($G(iB),"@",1) D CR
 S t0="Паpоли: НаВход, Коpекцию Данных, Коpекцию Описания Таблицы :"_$S($P($G(iB),"@",2)'="":"Yes",1:"No")_","_$S($P($G(iB),"@",5)'="":"Yes",1:"No")_","_$S($P($G(iB),"@",4)'="":"Yes",1:"No") D CR
 s t0="Статус таблицы включен   :"_$S('$P($G(iB),"@",16):"Yes",1:"No") D CR
 S t0="Кооpдинаты окна пpосмотpа :"_$TR($P($G(iB),"@",8,11),"@",",") D CR
 S t0="Защита всей таблицы      :"_$S($P($G(iB),"@",16):"Yes",1:"No") D CR
 S t0="Титул таблицы            :"_$P($G(iB),"@",19) D CR
 S t0="Таблица оптимизиpована   :"_$S($P($G(iB),"@",22):"Yes",1:"No") D CR
 S t0="Видеостатус таблицы      :"_$S($P($G(iB),"@",21):"Yes",1:"No") D CR
 S t0="Таблица соpтиpуема       :"_$P($G(iB),"@",36) D CR
 S t0="Логический контpоль      :"_$S('$D(@$P($G(%KAT(1)),"!",2)@($P($G(%KAT(1)),"!",3),"COL")):"No",1:"Yes") D CR
 S t0="Стандаpтная обpаботка Функциональных клавиш :"_$S($P($G(iB),"@",15):"Yes",1:"No") D CR
 S t0="Количество стpок,колонок :"_$TR($P($G(iB),"@",28,29),"@","x") D CR
 S t0="Есть ссылки на Базу Данных расположенную на локальном пpиводе :"_$S($P($G(iB),"@",37):"Yes",1:"No") D CR
 S t0="Поpядок вычисления       :"_$S("1"[$P($G(iB),"@",18):"направо-вниз",$P(G(iB),"@",18)=2:"направо-вверх",$P(G(iB),"@",18)=3:"налево-вниз",1:"налево-вверх") D CR
 S t0="Вычисления постоянно     :"_$S($P($G(iB),"@",20):"Yes",1:"No") D CR
 S t0="Список Логического Контроля по символьным именам вывода :"_$S($P($G(iB),"@",35):$P($G(iB),"@",35),1:"No") d CR
 S t0="Таблица закpывается      :"_$S('$P($G(iB),"@",16):"Yes",$P($G(iB),"@",16)="":"только по F6",1:"Постоянно,но не перед выходом") D CR
 S t0="Нестандаpтный текст помощи по F1 :"_$P($G(%KAT(2)),"@",39) d CR
 S t0="Режим пpосмотpа и поиска :"_$S($P($G(iB),"@",40):"Yes",1:"No") D CR
 S t0="База данных -----------  :"_$G(%KAT(5),"нет") D CR
 S t0="Постдвижение указателя   :"_$S($P($G(iB),"@",44)="":"Общесистемное",$P($G(iB),"@",44)=0:"нет",$P($G(iB),"@",44)=1:"вниз",$P($G(iB),"@",44)=2:"вправо",1:"?") D CR
 S t0="Предобработка Ф.клавиш   :"_$S($P($G(iB),"@",41)="":"No",1:$P($G(iB),"@",41)) d CR
 S t0="Указатель устанавливается только на клетки разрешенные для редактирования: "_$S($P($G(iB),"@",43):"Yes",1:"No") D CR
 S t0="Таблица скрытая          :"_$S($P($G(iB),"@",42):"Yes",1:"No") D CR
 S t0="Подтвержать запись в базу:"_$S($P($G(iB),"@",45):"Yes",1:"No") D CR
 S t0="АвтоФорматирование таблицы:"_$S($P($G(iB),"@",47):"Yes",1:"No") D CR
 S t0="В ТАБЛИЦЕ ЕСТЬ ПОМЕЧЕННЫЙ БЛОК   :"_$S($P($G(iB),"@",3):"Yes",1:"No") D CR
 S t0="БЫЛА КОРРЕКЦИЯ ОПИСАНИЯ ТАБЛИЦЫ  :"_$S($P($G(iB),"@",7):"Yes",1:"No") D CR
 S t0="БЫЛА КОРРЕКЦИЯ ДАННЫХ ТАБЛИЦЫ    :"_$S($P($G(iB),"@",6):"Yes",1:"No") D CR
 S t0="ВЫКЛЮЧЕН СТАТУС                  :"_$S($P($G(iB),"@",23):"Yes",1:"No") D CR
 S t0="ТАБЛИЦА="_$S($P($G(iB),"@",24):"ПОДЖАТА",$P($G(iB),"@",24)="S":"СПИСОК",1:"РАЗЖАТА") D CR
 S t0="КУРСОР В ТЕКУЩЕЙ КЛЕТКЕ          :"_$S($P($G(iB),"@",25):"Yes",1:"No") D CR
 S t0="РЕДАКТИРОВАНИЕ ПРОИСХОДИТ В "_$S($P($G(iB),"@",26)=1:"СТРОЧНОМ РЕДАКТОРЕ",1:"ТЕКУЩЕЙ КЛЕТКЕ") D CR
 S t0="ЦВЕТ ВСЕЙ ТАБЛИЦЫ (КОД)          :"_$P($G(iB),"@",31) D CR
 S t0="В ФОРМУЛАХ ВЫЧ. ЕСТЬ ССЫЛКИ НА ДРУГИЕ ФОРМУЛЫ ВЫЧИСЛЕНИЯ       :"_$S($P($G(iB),"@",32):"Yes",1:"No") D CR
 S t0="В ФОРМ.ЛОГ. ЕСТЬ ССЫЛКИ НА ДРУГИЕ ФОРМУЛЫ ЛОГИЧЕСКОГО КОНТРОЛЯ :"_$S($P($G(iB),"@",33):"Yes",1:"No") D CR
 S t0="ВКЛЮЧЕН РЕЖИМ= ТАБЛИЦУ НЕ ЗАКРЫВАТЬ ДЛЯ ДРУГИХ ПОЛЬЗОВАТЕЛЕЙ   :"_$S($P($G(iB),"@",34):"Yes",1:"No") D CR
 S t0="РАМКА ОБРАМЛЕНИЯ "_$S($P($G(iB),"@",38)=1:"ОДИНАРНАЯ",$P($G(iB),"@",38)=2:"ДВОЙНАЯ",1:$P($G(iB),"@",38)) D CR
 S t0="ССЫЛКА НА ТЕКСТ ОБОЕВ ТАБЛИЦЫ        :"_$P($G(iB),"@",46) D CR
 S t0="Вычислять значения КЛЕТОК, если ЛОГИЧЕСКИЙ КОНТРОЛЬ НЕ ПРОШЕЛ :"_$S($P($G(iB),"@",48):"Yes",1:"No") D CR
 S t0="ТЕКСТ КОМЕНТАРИЯ ВСТАВЛЯТЬ В ВОПРОС О ЗАПИСИ КОРРЕКЦИИ В БД   :"_$S($P($G(iB),"@",49):"Yes",1:"No") D CR
 S t0="---------=========== =============---------" D CR
 q:$D(%KAT(5))'["11"&('$D(%KAT(6)))  S t0="        ----- ОПИСАНИЕ КЛЮЧЕЙ -----" D CR
 I $P($G(%KAT(6,1)),"@",15)="NEWVIEW" S t0="ВКЛЮЧЕН РЕЖИМ СКОРОСТНОГО ПРЕДСТАВЛЕНИЯ ОТЧЕТА" D CR
 F ny=0:1:9 I $D(%KAT(5,ny)) D
 .S t0="---------=========== Номер "_ny_" =============---------" D CR
 .S t0="текст приглашения для ввода нового ключа  : "_$P($G(%KAT(5,ny)),"@",15) D CR
 .S t0="ТЕКСТ ПУНКТА для ввода нового ключа       : "_$P($G(%KAT(5,ny)),"@",5) D CR
 .S t0="текст помощи вызываемой по F1             : "_$P($G(%KAT(5,ny)),"@",20) D CR
 .S t0="фомулы синтаксич.контроля для нового ключа: "_$G(%KAT(5,ny,2)) d CR
 .S t0="фомулы трансформации                      : "_$G(%KAT(5,ny,4)) D CR
 .S t0="мультитабличная база данных               : "_$G(%KAT(5,ny,6)) D CR
 .S t0="прикрепленная таблица к ключу             : "_$P($G(%KAT(5,ny)),"@",14) D CR
 .S t0="НАЧАЛЬНОЕ ЗНАЧЕНИЕ КЛЮЧА     :"_$P($G(%KAT(5,ny)),"@",1) D CR
 .S t0="КОНЕЧНОЕ ЗНАЧЕНИЕ КЛЮЧА      :"_$P($G(%KAT(5,ny)),"@",4) D CR
 .S t0="ТЕКСТ КОНЦА В СПИСКЕ\СВОДКЕ  :"_$P($G(%KAT(5,ny)),"@",12) D CR
 .S t0="ТЕКСТ НАЧАЛА В СПИСКЕ\СВОДКЕ :"_$P($G(%KAT(5,ny)),"@",2) D CR
 .S t0="YX - Y,X РАЗМЕРЫ ТАБЛИЦЫ СПИСКА ДАННЫХ КЛЮЧА:"_$P($G(%KAT(5,ny)),"@",6) D CR
 .S t0="ТЕКСТ ПРИ ОПРЕДЕЛЕНИИ ВЫБОРКИ:"_$P($G(%KAT(5,ny)),"@",9) D CR
 .S t0="КОД ЦВЕТА                    :"_$P($G(%KAT(5,ny)),"@",10) D CR
 .F ii=10:1 Q:'$D(%KAT(5,ny,ii))  D
 ..S t0="особая выборка (текст)            : "_$G(%KAT(5,ny,ii)) D CR
 ..S t0="особая выборка (формула-логика)   : "_$G(%KAT(5,ny,ii,2)) D CR
 F ny=0:1:9 I $D(%KAT(6,ny)) D
 .S t0="---------=========== Номер "_ny_" =============---------" D CR
 .F ii=10:1 Q:'$D(%KAT(6,ny,ii))  D
 ..S t0="специальная выборка (текст)          : "_$G(%KAT(6,ny,ii)) D CR
 ..S t0="специальная выборка (формула-логика) : "_$G(%KAT(6,ny,ii,2)) D CR
 S t0="---------=========== =============---------" D CR
 Q
SUMMINFO ;СВОДНЫЙ ОТЧЕТ ПО ТАБЛИЦЕ
 N TotalSi,iI
 S TotalSi=1 D GLOBAL k sum
 F iI="FTR","FCL","COL","RTR","CMD","TAB","NAO","NAX" D @(iI_"^%ZAPM.ed.BSTT") S t0="---------=========== =============---------" D CR
 S $P(@(BSr_"(BSt)"),"@")="СВОДНЫЙ ОТЧЕТ ПО ТАБЛИЦЕ" I $D(BSTABL) D CREAT^%ZAPM.ed.BSTT Q  //ДЛЯ ИП
 D CREATE^%ZAPM.ed.BSTT
 Q
]]></Routine>


<Routine name="%ZAPM.ed.BSsBUF" type="MAC" languagemode="0"><![CDATA[
%BSsBUF ;РАБОТА С ВИДЕОБУФЕРОМ ; 17:59   04.03.99
 q
SA ;I $G(%BS(13))'="%BS-PC" Q
 d SaveWinV^%ZAPM.ed.BSXfun(1,1,25,80,"^%ZAPM.ed.BSbufB(""BUG"_$G(%BS(3),$P)_$J_"u"")") ;D CW
 Q
RE d LoadWinV^%ZAPM.ed.BSXfun("^%ZAPM.ed.BSbufB(""BUG"_$G(%BS(3),$P)_$J_"u"")") ;D CW
 I $G(%BS(13))'="%BS-PC" D
 .Q:'$D(BSR)!('$D(BST))  Q:BSR'["^"  ;ДЛЯ СТРОЧНОГО РЕДАКТОРА
 .Q:$D(XXx)  ;ПАНЕЛЬ С КНОПКАМИ
 .Q:'$D(@BSR@(BST))  Q:$P(@BSR@(BST),"@",17)=5  ;ТЕКСТ
 . ;```W !,BSR_"/"_BST R R ;---//--- для msm 4.x.x
 .I '$D(ENTERkk) D TIP^%ZAPM.ed.BST,TIT^%ZAPM.ed.BST,W^%ZAPM.ed.BST
 Q
SaveLock(BFL,%Y1,%X1,%Y2,%X2) ;зап.часть экр. в локаль %X1,%Y1,%X2,%Y2
 I $ZV["Wind"!($ZV["Cach"||($ZV["IRIS")) Q
7 S @BFL@(0)=%X1 F %=%Y1:1:%Y2 S @BFL@(%)=$V(%-1*160+(%X1-1*2)+%BS(17),-1,%X2-%X1+1*2,1)
 Q
CW  N A S A=$ZR S ^%ZZZ($I)=%BS(15) I $D(@A)
 Q
]]></Routine>


<Routine name="%ZAPM.ed.BSsFUN" type="MAC" languagemode="0"><![CDATA[
%BSsFUN ;ФУНКЦИИ ОБЩЕГО НАЗНАЧЕНИЯ ; 15:54   05.05.2000
 Q  ;%1-{ОТ}  %2-ШАГ  %3-{ДО}  %4-УСЛОВИЕ
%1 I %1["{" S %1=$TR(%1,"{}",""),%3=$TR(%3,"{}","")
 S jb=$P(%1,",",2),ib=$P(%1,","),BStf=BST,BSrf=BSR
 S je=$P(%3,",",2),ie=$P(%3,",")
 I 'jb X "S jb="_jb
 I 'ib X "S ib="_ib
 I 'ie X "S ie="_ie
 I 'je X "S je="_je
 I '(%1["ny"!(%3["ny")) S ie=ie+$G(%Co,0),ib=ib+$G(%Co,0)
 S %4=$G(%4,1)
 Q
SUM(%1,%2,%3,%4,%5) ;СУММА КЛЕТОК
 N BSrf,BStf,s,k,i3
 D %1
 S %0=0 F s=ib:$G(%2,1):ie F k=jb:$G(%2,1):je X "I "_%4 I  D  S %0=%0+i3
 .I $P($G(@(BSrf_"(BStf,s,k)"),"@@@@@@@@1"),"@",9)=1 S i3=$P($G(@$ZR),"@",15) Q
 .E  I BST=BStf S i3=$G(^%ZAPM.ed.BSbufB("BB"_$G(%BS(3),$P)_$J_"u"_%BS(15),s,k)) Q
 .E  S i3=""
 Q $S(%0'=0:%0,1:$S($G(%5):0,1:""))
SUMSPPI(%1,%2,%3,%4) ;СУММА ДЛЯ ПРОМЕЖУТОЧНОГО ИТОГА %1-КОЛОНКА
 K Pi S k=%1,%0=0 S:%4="" %4=1 F s=ny-1:-1:1 I $G(@(BSR_"(BST,s)")) D  Q:$G(Pi)="END"
 .I '$D(Pi) S Pi=@$ZR
 .I Pi'=@$ZR S Pi="END" Q
 .X "I "_%4 I  S %0=%0+$P(@(BSR_"(BST,s,k)"),"@",15)
 K Pi Q %0
SUMSPI(%1,%2,%3,%4) ;СУММА ИТОГА СПИСКА %4-УСЛОВИЕ
 S k=%1,%0=0 S:%4="" %4=1 F s=ny-1:-1:1 I $G(@(BSR_"(BST,s)")) D
 .X "I "_%4 I  S %0=%0+$P(@(BSR_"(BST,s,k)"),"@",15)
 Q %0
PLU(%1,%2,%3,%4) ;ПЛЮСОВАНИЕ
 D %1 S %0=0 F s=ib:%2:ie F k=jb:%2:je X "I "_%4 I  S %0=%0+1
 Q %0
MAX(%1,%2,%3,%4) ;МАКСИМУМ
 D %1 S %0=-999999999 F s=ib:%2:ie F k=jb:%2:je X "I "_%4 I  D  S:%0<i3 %0=i3
 .I $P($G(@(BSrf_"(BStf,s,k)"),"@@@@@@@@1"),"@",9)=1 S i3=$P($G(@$ZR),"@",15) Q
 .E  I BST=BStf S i3=$G(^%ZAPM.ed.BSbufB("BB"_$G(%BS(3),$P)_$J_"u"_%BS(15),s,k)) Q
 .E  S i3=0
 Q %0
MIN(%1,%2,%3,%4) ;МИНИМУМ
 D %1 S %0=999999999 F s=ib:%2:ie F k=jb:%2:je X "I "_%4 I  D  S:%0>i3 %0=i3
 .I $P($G(@(BSrf_"(BStf,s,k)")),"@",9)'=2 S i3=$P($G(@$ZR),"@",15) Q
 .E  I BST=BStf S i3=$G(^%ZAPM.ed.BSbufB("BB"_$G(%BS(3),$P)_$J_"u"_%BS(15),s,k)) Q
 .E  S i3=0
 Q %0
STEP(%1,%2) ;
 ;ВОЗВЕДЕНИЕ %1 В СТЕПЕНЬ %2 РЕЗУЛЬТАТ В %0
 S %0=%1 F I=2:1:%2 S %0=%0*%1
STEPE K I Q %0
ABS(%1) ;
 ;МОДУЛЬ ЧИСЛА %1
 I %1<0 S %1=%1*-1
ABSE S %0=%1 Q %0
DEL(%1,%2) ;
 ;ДЕЛЕНИЕ %1 НА %2=%0 ,ЕСЛИ %2=0 ,ТО %0="<DIVER>"
 I +%2=0 S %0="<DIVER>" Q %0
DELE S %0=%1/%2 Q %0
DEN(%1,%2) ;
 ;ДЕЛЕНИЕ НАЦЕЛО %1 НА %2=%0 ,ЕСЛИ %2=0 ,ТО %0="<DIVER>"
 I %2=0 S %0="<DIVER>" Q %0
DENE S %0=%1\%2 Q %0
PROC(%1,%2,%3,%4,%5) 
 ;ВЗЯТИЕ ПРОЦЕНТА ЧИСЛА %1 К ЧИСЛУ %2 ,ЕСЛИ %2=0 ,ТО %0="<DIVER>" при %3=1
 ;%4 -СКОЛЬКО ЗНАКОВ ПОСЛЕ ТОЧКИ
 ;%5 =1 ПИСАТЬ СИМВОЛ %
 I +%2=0 S %0=$S($G(%3):"<DIVER>",1:"") Q %0
 I +%1=0 S %0=$S($G(%3):"<DIVER>",1:"") Q %0
%E S %0=%1*100/%2 I $D(%4) S %0=$FN(%0,"",%4)
 Q %0_$S($G(%5):"%",1:"")
OST(%1,%2) ;
 ;ОСТАТОК ОТ ДЕЛЕНИЯ %1 НА %2 ,ЕСЛИ %2=0 ,ТО %0="<DIVER>"
 I %2=0 S %0="<DIVER>" Q %0
 S %0=%1/%2 I %0["." S %0=$P(%0,".",2) Q %0
OSTE E  S %0=0 Q %0
SIN(%1) ;
 ;ВЫЧИСЛЕНИЕ SIN(%1)=%0
 I %1>180 S %1=%1-180*-1
 S %1=%1*.017453277
 S %1=%1-(%1*%1*%1/6)+(%1*%1*%1*%1*%1/120)-(%1*%1*%1*%1*%1*%1*%1/5040)
SINE S %0=%1 Q %0
COS(%1) ;
 ;ВЫЧИСЛЕНИЕ COS(%1)=%0
 S SOC=1 I %1>180 S %1=%1-180,SOC=-1
 S %1=%1*.017453277
 S %1=1-(%1*%1/2)+(%1*%1*%1*%1/24)-(%1*%1*%1*%1*%1*%1/720)+(%1*%1*%1*%1*%1*%1*%1*%1/40320),%1=%1*SOC
COSE S %0=%1 Q %0
SQR(%1) ;
SQ ;ИЗВЛЕЧЕНИЕ КВАДРАТНОГО КОРНЯ SQRT(%1)=%0
 S KONS=.00000000001 S VX0=0,VX1=%1+1 S:%1>1 KONS=%1*KONS*%1
VX S VIX=VX0+VX1/2,KONTR=VIX*VIX I %1+KONS'<KONTR&((%1-KONS)'>KONTR) S %0=VIX K VIX,VX0,VX1,KONS,KONTR,CC Q %0
 I KONTR>%1 S VX1=VIX G VX
 I KONTR<%1 S VX0=VIX G VX
ATAN G ARG:(CC*CC-.01)<0 S %1=CC*CC+1 D SQ S CC=CC/(1+VIX) D ATAN S CC=2*CC Q
ARG S CC=CC-(CC*CC*CC/3)+(CC*CC*CC*CC*CC/5)-(CC*CC*CC*CC*CC*CC*CC/7)
SQRTE Q
SPSTR(%1) ;НУМЕРАЦИЯ СТРАНИЦ СПИСКА ПРИ НАЛИЧИЯ ПРОМ.ИТОГА
 S %0="" F s=ny:1 Q:'$D(@(BSR_"(BST,s)"))  I $G(@$ZR) S %0="стp."_@$ZR
 Q %0
 ;
 ;МОДУЛЬ ИЗ %BSA
 ;
A(p1,p2,p3,p4,p5,p6,p7,p8,p9,p10,p11,p12,p13,p14,p15,p16) S pp=$P($G(BSR),"^",2),ps=$S(pp'[",":$P($$ZU^%ZAPM.ed.BS3(0),",",2),1:$P(pp,$C(34),4))
 S pu=$S(pp'["[":$P($$ZU^%ZAPM.ed.BS3(0),","),1:$P(pp,$C(34),2)),pt=$G(BST) I $E(pp,1)="[" S pp=$P(pp,"]",2)
 S %zT=$ZT,$ZT="TRAP^%ZAPM.ed.BSA"
 I $D(p4) S pp=p4 I pp["^" S pp=$P(pp,"^",2)
 I $G(p3)'="" S pt=p3
 I $G(p5)'="" S pu=$TR(p5,"[]|""","") I pu["," S ps=$P(pu,",",2),pu=$P(pu,",")
 I $G(p6)'="" S ps=$TR(p6,"[]|""","") I ps["," S pu=$P(ps,","),ps=$P(ps,",",2)
 ;I $E(pp,1)="%" S pp="^"_pp ;`BSA
 S pp="^["""_pu_""","""_ps_"""]"_pp
 I $D(@(pp_"(pt,p1,p2)"))
 S bS=$ZR I $P(@(pp_"(pt,p1,p2)"),"@",9)=1 Q $P($G(@$ZR),"@",15)
 I '$D(p8),BST=pt,$$BSR(BSR)=pp Q $G(^%ZAPM.ed.BSbufB("BB"_$G(%BS(3),$P)_$J_"u"_%BS(15),p1,p2))
 S pb=$$KBD^%ZAPM.ed.BSF12($NA(@pp@(pt))),pb=$$BSD(pb,$G(p7))
 F pi=1:1:9 Q:'$D(^(pi))  Q:'$D(@("p"_(pi+7)))  S pb=pb_$S(@("p"_(pi+7))=+@("p"_(pi+7)):@("p"_(pi+7)),1:$C(34)_@("p"_(pi+7))_$C(34))_","
 S pij=p1_","_p2 I $P($G(@pp@(pt,"KEY",pi-1)),"@",6)="HiddenLastKey",$P($P(@(pp_"(pt,p1,p2)"),"@",18),"#",2)'="" D  Q $G(@$ZR,"<NO_VALUE>")
 .S pij=$P($P(@$ZR,"@",18),"#",2) I $D(@(pb_$C(34)_pij_""")"))
 I $P($P(@(pp_"(pt,p1,p2)"),"@",18),"#")'="" S pij=$P($P(@$ZR,"@",18),"#")
 I $D(@(pb_$C(34)_pij_""")")) Q @$ZR
 Q "<NO_VAL>"  ;$ZR
BSD(BSD,%NAm) ;ССЫЛКА НА УЗЕЛ БАЗЫ ДАННЫХ
 S %NAm=BSD_$G(%NAm)_$S(BSD["(":"",1:"(") I $E(%NAm,$L(%NAm))=")" S %NAm=$E(%NAm,1,$L(%NAm)-1)_","
 Q %NAm
BSR(bsr) N bs ;ПОЛНАЯ ССЫЛКА
 I $E(bsr,1,2)="^%" Q $$%^%ZAPM.ed.BSF12(bsr)
 ;4.;I $P($ZV,"Version ",2)'<4,bsr'["|" Q "^|"""_$P($$ZU^%ZAPM.ed.BS3(0),",")_""","""_$P($$ZU^%ZAPM.ed.BS3(0),",",2)_"""|"_$P(bsr,"^",2)
 ;4.;I $P($ZV,"Version ",2)'<4,$P(bsr,"|",2)'["," S bs=$P($P(bsr,"|",2),$C(34),2) Q "^|"""_bs_""","""_$P($$ZU^%ZAPM.ed.BS3(0),",",2)_"""|"_$P(bsr,"|",2)
 I bsr'["]" Q "^["""_$P($$ZU^%ZAPM.ed.BS3(0),",")_""","""_$P($$ZU^%ZAPM.ed.BS3(0),",",2)_"""]"_$P(bsr,"^",2)
 I $P($P(bsr,"]"),"[",2)'["," S bs=$P($P($P(bsr,"]"),"[",2),$C(34),2) Q "^["""_bs_""","""_$P($$ZU^%ZAPM.ed.BS3(0),",",2)_"""]"_$P(bsr,"]",2)
 Q bsr
]]></Routine>


<Routine name="%ZAPM.ed.BSsFUNA" type="MAC" languagemode="0"><![CDATA[
%BSsFUNA ;ФУНКЦИИ АТРИБУТОВ КЛЕТОК И ТАБЛИЦ ; 11:27 15-APR-94
S Q:'$D(bS)  S bs=$G(@bS) Q:bs=""  S bd=$P(bS,",",1,$L(bS,",")-2),b=@(bd_")") Q
SB Q:'$D(bd)  S bd=$P($G(@(bd_",""KEY"")")),"@") Q
AC(%1) N bs,b,bd D S ;ЦВЕТ КЛЕТКИ %1
 S %0=$P($G(bs),"@",10) Q %0
AD(%1) N bs,b,bd D S ;ДЛИНА
 S %0=$P($G(bs),"@",4) Q %0
AH(%1) N bs,b,bd D S ;ВЫСОТА
 S %0=$P($G(bs),"@",3) Q %0
AP(%1) N bs,b,bd D S ;ПОМЕЧЕНА =1
 S %0=+$P($G(bs),"@",12) Q %0
AX(%1) N bs,b,bd D S ;АБСОЛЮТНАЯ КООРДИНАТА X
 S %0=$P($G(bs),"@",2) Q %0
AY(%1) N bs,b,bd D S ;...Y
 S %0=$P($G(bs),"@",1) Q %0
AT(%1,%2) N bs,b,bd,nf D S ;ТРАНС
 S nf=$P($G(bs),"@",8) I nf="" Q ""
 I nf,nf?.N1",".N Q $G(@(bd_",""FTR"","_nf_$S($G(%2):",1)",1:")"))) 
 S nf=$P($P(bS,",",$L(bS,",")-1,$L(bS,",")),")") Q $G(@(bd_",""FTR"","_nf_$S($G(%2):",1)",1:")"))) 
AR(%1,%2) N bs,b,bd,nf D S ;СИНТ
 S nf=$P($G(bs),"@",16) I nf="" Q ""
 I nf,nf?.N1",".N Q $G(@(bd_",""RTR"","_nf_$S($G(%2):",1)",1:")"))) 
 S nf=$P($P(bS,",",$L(bS,",")-1,$L(bS,",")),")") Q $G(@(bd_",""RTR"","_nf_$S($G(%2):",1)",1:")"))) 
AL(%1,%2) N bs,b,bd,nf D S ;ЛОГ
 S nf=$P($G(bs),"@",13) I nf="" Q ""
 I nf,nf?.N1",".N Q $G(@(bd_",""COL"","_nf_$S($G(%2):",1)",1:")"))) 
 S nf=$P($P(bS,",",$L(bS,",")-1,$L(bS,",")),")") Q $G(@(bd_",""COL"","_nf_$S($G(%2):",1)",1:")"))) 
AF(%1,%2) N bs,b,bd,nf D S ;ВЫЧ
 S nf=$P($G(bs),"@",7) I nf="" Q ""
 I nf,nf?.N1",".N Q $G(@(bd_",""FCL"","_nf_$S($G(%2):",1)",1:")"))) 
 S nf=$P($P(bS,",",$L(bS,",")-1,$L(bS,",")),")") Q $G(@(bd_",""FCL"","_nf_$S($G(%2):",1)",1:")"))) 
AB(%1) N bs,b,bd D S ;ХРАНИТСЯ В БАЗЕ=1
 S %0=$P($G(bs),"@",9) Q %0
AU(%1,%2) N bs,b,bd D S ;%2=# PICE
 S %0=$P($G(bs),"@",%2) Q %0
ATB(%1) N bs,b,bd D S,SB ;ИМЯ БАЗЫ ДАННЫХ
 S %0=$G(bd) Q %0
ATK(%1) N bs,b,bd D S ;КОЛ-ВО КОЛОНОК У ТАБЛИЦЫ %1
 S %0=$P($G(b),"@",29) Q %0
ATU(%1,%2) N bs,b,bd D S ;%2=# PICE
 S %0=$P($G(b),"@",%2) Q %0
ATS(%1) N bs,b,bd D S ;...СТРОК
 S %0=$P($G(b),"@",28) Q %0
ATC(%1) N bs,b,bd D S ;ОБЩИЙ ЦВЕТ
 S %0=$P($G(b),"@",31) Q %0
 Q ""
e Q
]]></Routine>


<Routine name="%ZAPM.ed.BSsFUNM" type="MAC" languagemode="0"><![CDATA[
%BSsFUNM ;ПОЛЬЗОВАТЕЛЬСКИЕ ФУНКЦИИ ; 16:36   16.10.2000
SELECT(%1,%2,%3,%4) ;ГЛОБАЛЬНЫЙ $SELECT
 ;%1-НОМЕР ПЕРЕМЕННОЙ
 ;%2-ИМЯ ТАБЛИЦЫ,РАЗДЕЛА ОПИСАНИЯ БАЗЫ ЛОГ. УСЛОВИЙ (DFLT="LOGIC,%BSZ")
 ;%3-ИМЯ УЗЛА В БАЗЕ ЛОГ. УСЛОВИЙ
 ;%4-ВЫЗОВ ТАБЛИЦЫ\ТЕКСТА ПО <F1>
 N TEST,ZrE,Dt,li,iX
 S ZrE=$ZR,Dt=$T ;SAVETEST
SELE I $D(cHOSe("S",%1)) S $ZT="ERRSEL^%ZAPM.ed.BSsFUNM" D  Q $G(li)
 .K li S iX="" F  S iX=$O(cHOSe("S",%1,iX)) Q:iX=""  X "I "_cHOSe("S",%1,iX,"LOG")_" S li=cHOSe(""S"",%1,iX,""SEL"")" I  Q
 K cHOSe("S",%1) I $G(%3)="" D ErrMsg^%ZAPM.ed.BSXfun("ОШИБКА 3 УСЛОВИЯ В ФУНКЦИИ $$SELECT !") Q 0
 I $G(%2)="" S %2="LOGIC,%BSZ"
 S li=$$RIT(%2),li=$$KBD^%ZAPM.ed.BSF12(li) I li="" D ErrMsg^%ZAPM.ed.BSXfun("ОШИБКА В ИМЕНИ БАЗЫ УСЛОВИЙ $$SELECT !") Q 0
 S iX="" F  S iX=$O(@li@(%3,iX)) Q:iX=""  S cHOSe("S",%1,iX,"LOG")=$G(@li@(%3,iX,"L1")),cHOSe("S",%1,iX,"SEL")=$G(@li@(%3,iX,"S1"))
 I $D(cHOSe("S",%1)) G SELE
 Q 0
ERRSEL D ErrMsg^%ZAPM.ed.BSXfun($ZE_" "_$$ErrSay^%ZAPM.ed.BSF8($ZE)_" ---->  "_$G(cHOSe("S",%1,iX))) S $ZT=$G(%zT)
 Q 0
LOGIC(%1,%2,%3,%4,%5) ;БАЗА ЛОГ. УСЛОВИЙ ДЛЯ ФУНКЦИИ
 ;%1-НОМЕР ПЕРЕМЕННОЙ
 ;%2-ИМЯ ТАБЛИЦЫ,РАЗДЕЛА ОПИСАНИЯ БАЗЫ ЛОГ. УСЛОВИЙ (DFLT="LOGIC,%BSZ")
 ;%3-ИМЯ УЗЛА В БАЗЕ ЛОГ. УСЛОВИЙ
 ;%4-ВЫЗОВ ТАБЛИЦЫ\ТЕКСТА ПО <F1>
 ;%5-КОМАНДА НА ТРАНСЛЯЦИЮ ФОРМУЛ
 N TEST,ZrE,Dt,li
 S ZrE=$ZR,Dt=$T ;SAVETEST
 I $G(cHOSe("L",%1))="NOTE" X "I 0" Q 0
 I $G(cHOSe("L",%1))="ALWAY" X "I 1" Q 1
LOGI I $D(cHOSe("L",%1)) S $ZT="ERLOGIC^%ZAPM.ed.BSsFUNM" X "I "_cHOSe("L",%1) Q $T
 K cHOSe("L",%1) I $G(%3)="" D ErrMsg^%ZAPM.ed.BSXfun("ОШИБКА 3 УСЛОВИЯ В ФУНКЦИИ $$LOGIC !") S cHOSe("L",%1)="NOTE" Q 0
 I $G(%2)="" S %2="LOGIC,%BSZ"
 S li=$$RIT(%2),li=$$KBD^%ZAPM.ed.BSF12(li) I li="" D ErrMsg^%ZAPM.ed.BSXfun("ОШИБКА В ИМЕНИ БАЗЫ УСЛОВИЙ $$LOGIC !") S cHOSe("L",%1)="NOTE" Q 0
 N BSr,Bst I $G(%4)'="" S %4=$$RIT(%4)
 D NEWTAB($NA(@li@(%3)),$G(%4,"^%ZAPM.ed.BSZ(""LOGICHLP"")"),%1,$G(%5))
 G LOGI
LOGTXT(NUMBE) ;ВЫБРАННЫЙ ТЕКСТ ИЗ БАЗЫ ЛОГ. УСЛОВИЙ
 Q $G(cHOSe("L",NUMBE,"TXT"))
LOGSEL(NUMBE) ;ВЫБРАННЫЙ КОД ИЗ БАЗЫ ЛОГ. УСЛОВИЙ
 Q $G(cHOSe("L",NUMBE,"SEL"))
ERLOGIC D ErrMsg^%ZAPM.ed.BSXfun($ZE_" "_$$ErrSay^%ZAPM.ed.BSF8($ZE)_" ---->  "_$G(cHOSe("L",%1))) S $ZT=$G(%zT) S cHOSe("L",%1)="NOTE" Q 0
 Q
NEWTAB(B,H,NUMBE,TR) ;ФОРМИРОВАНИЕ ВРЕМЕННОЙ ТАБЛИЦЫ
 N BSR,BST,T,BSr,BSt,t1,t2,l1,l2,col,v,se,ke,I,tIT,Fk,PrEd,d,d1,d0,%1,%2,%3,%4,YES
 S T=$$TMPG^%ZAPM.ed.BSF11 N k1,k2,k3,k4,k5,k6,k7,k8,k9,L,C,D,BUF
 S BSr=$P(T,"("),BSt=$P($P($P(T,"(",2),")"),$C(34),2),l1=25,l2=50,v=2,ke=3,l3=3
 S (t3,t1)="",t2="ВЫБЕРИТЕ ФОРМУЛУ, или F1",(col(1),col(2))=$P(^%ZAPM.ed.BSZ("LOGIC",1,1),"@",10) D CR^%ZAPM.ed.BSN
 S col(1)=$P(^%ZAPM.ed.BSZ("LOGIC",2,1),"@",10),col(2)=$P(^%ZAPM.ed.BSZ("LOGIC",2,2),"@",10)
 S I="" F  S I=$O(@B@(I)) Q:I=""  S t1=" "_$G(@B@(I,"C1")),t2=$G(@B@(I,"L1")),t3=$G(@B@(I,"S1")) X TR D CR^%ZAPM.ed.BSN
 S tIT="2,2",Fk="" D CREAT^%ZAPM.ed.BSN S $P(@BSr@(BSt),"@",39)=H
NEWTA D Table^%ZAPM.ed.BSN(BSR,BST) I $P(YES,"@",4)=27 D Yes^%ZAPM.ed.BSXfun("УСЛОВИЕ ДЛЯ ЭТОГО НАСЧЕТА БУДЕТ ВСЕГДА ДА='ИСТИНО' НЕТ='ЛОЖЬ' ?") S cHOSe("L",NUMBE)=YES>0 G NEWE
 I $P($P(YES,"@",1),",",2)'=2 D ErrMsg^%ZAPM.ed.BSXfun("ВЫ НАХОДИТЕСЬ НЕ НА ФОРМУЛАХ !") G NEWTA
 I $P(YES,"@",9)["|" S cHOSe("L",NUMBE)=$P($P(YES,"@",9),"|",2),cHOSe("L",NUMBE,"TXT")=$P($P(YES,"@",9),"|"),cHOSe("L",NUMBE,"SEL")=$P($P(YES,"@",9),"|",3) G NEWE
 S cHOSe("L",NUMBE)=$P(YES,"@",9)
 S cHOSe("L",NUMBE,"TXT")=$P($G(@BSR@(BST,$P($P(YES,"@",1),","),$P($P(YES,"@",1),",",2)-1)),"@",15)
 S cHOSe("L",NUMBE,"SEL")=$P($G(@BSR@(BST,$P($P(YES,"@",1),","),$P($P(YES,"@",1),",",2)-1)),"@",15)
NEWE K @T Q
CHO(%1,%2,%3,%4,%5,%6,%7,%8) ;ФУНКЦИЯ ОПРЕДЕЛЕНИЯ ПЕРЕМЕННОЙ НА СЕАНС РАБОТЫ С ТАБЛИЦЕ
 ;%1-НОМЕР ПЕРЕМЕННОЙ
 ;%2-ТЕКСТ ПРИГЛАШЕНИЯ ДЛЯ ВВОДА
 ;%3=ДАННЫЕ ВВОДА ПРЕДЛАГАЕМЫЕ
 ;%4-ФОРМУЛА ТРАНСФОРМАЦИИ РЕЗУЛЬТАТА ВВОДА ДЛЯ d=РЕЗУЛЬТАТ ВВОДА
 ;%5-ИМЯ ПЕРЕМЕННОЙ, С КОТОРОЙ ПРЕДСТОИТ СРАВНИВАТЬ
 ;%6-ВЫЗОВ ТАБЛИЦЫ ПРИ ВВОДЕ <ENTER> ИЛИ "?" ССЫЛКА = "BST,BSR,UIC,SYS"
 ;%7-ВЫЗОВ ТАБЛИЦЫ\ТЕКСТА ПО <F1>            ССЫЛКА = "BST,BSR,UIC,SYS"
 ;%8-HISTORY
 N ZrE,Dt
 S ZrE=$ZR,Dt=$T ;SAVETEST
 I $G(cHOSe(%1))="ALL",$D(%5) X "S %0="_%5 Q %0
 I $D(cHOSe(%1)) S %0=cHOSe(%1) Q %0
 N lop,lon,ls,ll,%hlp,%HIS,%KAT ;ДЛЯ LE
 S cHOSe=$G(li) I $G(%7)'="" S %hlp=$$RIT(%7)
 S %HIS="^%ZAPM.ed.BSbufB(""HISCHOISE"_%1_""")"
CH U 0 W $$bel^%ZAPM.ed.BS3 S li=$G(%3),ls="Вводите "_$G(%2)_":" D LE^%ZAPM.ed.BSTT
 I YES<1 S (d,%0,li)="" G CHGO
 I li=""!(li="?"),$D(%6) S li=$$CALL(%6) S:li'="" %3=li G CH
 S d=li I $G(%4)'="" X "S d="_%4
 S %0=d I d="ALL",$D(%5) X "S %0="_%5
CHGO D RESTTEST
 S cHOSe($G(%1,9))=$G(d),li=$G(cHOSe)
 Q %0
RESTTEST I $D(@ZrE)
RESTT X "I Dt"
 Q
CALL(li) ;ВЫЗОВ ТАБЛИЦЫ
 N BSr,BSt,YES,%1,%2,%3,%4,%5,%6,%7,d,dat,date
 D RII^%ZAPM.ed.BSF3 D Table^%ZAPM.ed.BSN(BSr,BSt)
 Q:$P(YES,"@",4)=27 "" Q $P(YES,"@",9)
RIT(li) N BSr,BSt D RII^%ZAPM.ed.BSF3
 Q $NA(@BSr@(BSt))
DATpl(%1,%2,%3) ;$$h^%ZAPM.ed.BS3() +(-) время формата (ЧЧ:ММ)
 ;%1 - дата формата $$h^%ZAPM.ed.BS3(); %2 - время (ЧЧ:ММ); %3 - "-" (отнять), "" (прибавить)
 N i,i1,i2,i3
 I %1="" S %0="" Q %0
 I %2="" S %0=%1 Q %0
 S i=$P(%1,","),i1=$P(%1,",",2),i2=$P(%2,":")*3600+($P(%2,":",2)*60)
 S i2=i2*$S(%3="-":-1,1:1)
 S i3=(i1+i2)/86400
 S i3=i3+i
 S %0=$P(i3,".")_","_$E(($P(i3,".",2)*86400),1,5)
 Q %0
SelecBut(%1,%2,%3) ;CЕЛЕКТОРНЫЕ КНОПКИ
 ;%1- ТИП ПАНЕЛИ
 ;%2=1 ПЕРВОНАЧЕЛЬНАЯ УСТАНОВКА
 ;%3=ПЕРЕМЕННАЯ ВОЗВРАТА"
 N T
 I '$D(Sel(ny,nx)) S Sel(ny,nx)=$G(%3)
 I $G(%2),'$D(Sel(0)) S Sel(0)=(ny_","_nx)
 I $G(Sel(0),"?")=(ny_","_nx) S T=$S(%1=1:"X",%1=2:"o",1:"§")
 E  S T=" "
 Q $S(%1=1:"[",%1=2:"(",1:"<")_T_$S(%1=1:"]",%1=2:")",1:">")
MONEY(%1) ;123.4561 --> 123.46
 S %0=$J(%1,"",2) Q %0
MONT(%1) ;%1-НОМЕР МЕСЯЦА --> ТЕКСТ МЕСЯЦА
 Q $P("Янваpь,Февpаль,Маpт,Апpель,Май,Июнь,Июль,Август,Сентябpь,Октябpь,Ноябpь,Декабpь",",",+%1)
MONTD(%1,%2) ;%1=ГГММДД  %2=НА СКОЛЬКО МЕСЯЦЕВ ПРИБАВИТЬ ИЛИ ОТНЯТЬ
 N M,G S M=$$M^%ZAPM.ed.BSsFUNR(%1)+$G(%2),G=$$Y^%ZAPM.ed.BSsFUNR(%1)
 F  Q:M'<1  S G=G-1,M=12+M
 F  Q:M'>12  S G=G+1,M=M-12
 I G?3N S G=$E(G,2,3)
 I G<0 S G=99
 S G=$$ADDYEAR^%ZAPM.ed.BSsFUNR(G)
 I M?1N S M="0"_M
 S %0=G_M_$E(%1,5,6)
 Q %0
DSCORR(%1,MINUS) ;ФОРМАТИРОВАНИЕ ТЕКСТА В КЛЕТКЕ С ПЕРЕНОСОМ ПО СЛОВАМ          DSCORR^%ZAPM.ed.BSsFUNM
 ;автор : Дружинин Сергей (С) 1997
 N FLAG,LONG,VARIANT,RES,K,I,W,SS,J,S,S1,S2,B,E,KOL,NEW,DS ;ЛОКАЛЬНЫЕ ПЕРЕМЕННЫЕ
 I '$D(BS) Q ""
 S LONG=$P($G(BS),"@",4)-$G(MINUS)
 S K=1,NEW="",SS=0,Q=0,J=1,W="",S2=1,KK=0 ; ПРИСВОЕНИЕ НАЧАЛЬНЫХ ЗНАЧЕНИЙ ПЕРЕМЕННЫМ
LOOP S S1=$F(%1,".",S2),B=$E(%1,S1-2),E=$E(%1,S1),S2=S1 I S1'=0 I ((B'=" ")&(E'=" ")) I ((B?1N'=1)&(E?1N'=1)) S %1=$E(%1,1,S1-1)_" "_$E(%1,S1,9999) S S2=S1+1 G LOOP
 S S2=1
LOOP1 S S1=$F(%1,",",S2),B=$E(%1,S1-2),E=$E(%1,S1),S2=S1 I S1'=0 I ((B'=" ")&(E'=" ")) S %1=$E(%1,1,S1-1)_" "_$E(%1,S1,9999) S S2=S1+1 G LOOP1
 S S2=1
LOOP2 S S1=$F(%1,"-",S2),B=$E(%1,S1-2),E=$E(%1,S1),S2=S1 I S1'=0 I ((B'=" ")&(E'=" ")) S %1=$E(%1,1,S1-1)_" "_$E(%1,S1,9999) S S2=S1+1 G LOOP2
 F I=1:1 Q:$P(%1," ",I,I+1)=""  D
 .S W=$P(%1," ",I)
 .I ($L(W)<LONG)!($L(W)=LONG) S VARIANT(J)=W S J=J+1 Q
 .E  S SS=$L(W)\LONG F Q=1:1:SS+1 S VARIANT(J)=$E(W,(Q-1)*LONG+1,Q*LONG) S J=J+1
 S KOL=J-1
 F I=1:1:KOL D                                   ;БЛОК
 .I NEW="" S NEW=VARIANT(I)                      ;ДОБАВЛЕНИЯ
 .E  S NEW=NEW_" "_VARIANT(I)                    ;НЕОБХОДИМОГО
 .I $L(NEW)=LONG S DS(K)=NEW S NEW="" S K=K+1 Q
 .I $L(NEW)>LONG D                               ;КОЛИЧЕСТВА
 ..S DS(K)=$E(NEW,1,LONG)                        ;ПРОБЕЛОВ СПРАВА
 ..I DS(K)[" " S DS(K)=$E(DS(K),1,($L(NEW)-$L(VARIANT(I))-1)) S DS(K)=DS(K)_$J("",(LONG-$L(DS(K)))) S NEW=VARIANT(I)
 ..E  S NEW=$E(NEW,LONG+1,9999) I $E(NEW,1)=" " S NEW=$E(NEW,2,9999)
 ..S K=K+1
 S DS(K)=NEW I $E(DS(K),1)=" " S DS(K)=$E(DS(K),2,9999)
 S RES="" F S=1:1:K S RES=RES_DS(S)
 Q RES  ;РЕЗУЛЬТАТ КОРРЕКЦИИ ПОЛОЖЕНИЯ СЛОВ В ЯЧЕЙКЕ
 
CENTR(%1,%2,%3) ;%3=1 - ЦЕНТР %3=2 ВПРАВО    %2-ДЛИНА КЛЕТКИ
 I '$G(%2) S %2=$P($G(BS),"@",4)
 I '$G(%3) S %3=1
 I %3=1 S %0=$J("",(%2-$L(%1))\2)_%1 Q %0
 S %0=$J(%1,%2) Q %0
KCHO K cHOSe
e Q
OT D O^%ZAPM.ed.BSF7 S YES=0,%0="" X "I 0" Q ""
ASYS(%1,I) ;ДОСТУПНЫЙ ТОМ
 I %1="*" S @(I_"%1)")=""
 I 1 S YES=1,%0=%1 Q %0
AUCI(%2,I) ;ДОСТУПНЫЙ КИП
 I %2="*" S @(I_"%2)")=""
 S YES=1,%0=%2 I 1 Q %2
APAR(%3,I) ;ДОСТУПНЫЙ РАЗДЕЛ
 I %3="*" S @(I_"%3)")=""
 S YES=1,%0=%3 I 1 Q %3
ATAB(%4,I) ;ДОСТУПНАЯ ТАБЛИЦА
 I %4="*" S @(I_"%4)")=""
 S YES=1,%0=%4 I 1 Q %4
NEWuser(%5) ;НОВЫЙ ПОЛЬЗОВАТЕЛЬ
 I $L(%5)>7!($TR(%5," .\/+!@#$%^&*()_-|","")'=%5) S ls="ВВЕДИТЕ ДО 7 БУКВЕННЫХ КОМБИНАЦИЙ" G OT
 D USER^%ZAPM.ed.BSF4 I $G(%PAROL)="" S ls=" НЕ ВВЕДЕН " G OT
 S YES=1,@BSD@(".@PASSWORD",%5)=%PAROL,@BSD@(".@WHO",%5)=$G(li),%0=%5,@BSD@(%5)="" D  I 1 Q %5
 .S i="" F  S i=$O(@BSD@(".@PASSWORD",i)) Q:i=""  I '$D(@BSD@(i)) K @BSD@(".@PASSWORD",i)
 .S i="" F  S i=$O(@BSD@(".@WHO",i)) Q:i=""  I '$D(@BSD@(i)) K @BSD@(".@WHO",i)
 Q
Fio(S,D) ;В ПРЕДЛОЖЕНИИ ПОСТАВИТЬ ЗАГЛАВНЕ БУКВЫ
 N i,ii,Di S Di=" " I $D(D) S Di=$E(D,1)
 F i=1:1 Q:$P(S,Di,i,i+1)=""  S $P(S,Di,i)=$$BIGL($E($P(S,Di,i),1))_$$LITL($E($P(S,Di,i),2,$L($P(S,Di,i))))
 Q S
LITL(%1) ;БОЛЬШИЕ БУКВЫ В МАЛЕНЬКИЕ
 Q $TR(%1,"QWERTYUIOPASDFGHJKLZXCVBNMЙЦУКЕНГШЩЗХЪФЫВАПРОЛДЖЭЯЧСМИТЬБЮЁ","qwertyuiopasdfghjklzxcvbnmйцукенгшщзхъфывапролджэячсмитьбюе")
BIGL(%1) ;МАЛЕНЬКИЕ В БОЛЬШИЕ
 Q $TR(%1,"qwertyuiopasdfghjklzxcvbnmйцукенгшщзхъфывапролджэячсмитьбю","QWERTYUIOPASDFGHJKLZXCVBNMЙЦУКЕНГШЩЗХЪФЫВАПРОЛДЖЭЯЧСМИТЬБЮ")
TR(%1,%2,%3) N p,l,l3 ;ТРАНСФОРМАЦИЯ !!!!!
 I %2="" Q %1
 I %1'[%2 Q %1
 S p=1,l=$L(%2),l3=$L(%3),%z=$ZT,$ZT="TRMAX^%ZAPM.ed.BSsFUNM"
 F  S p=$F(%1,%2,p) Q:p=0  S $E(%1,p-l,p-1)=%3,p=p+l3-l
 S $ZT=$G(%z) Q %1
TRMAX W $$bel^%ZAPM.ed.BS3 S $ZT=$G(%z) Q $G(%1,$G(s))
NINV(%1,%2,%3) N li,GL ;КОРРЕКЦИЯ КОДИФИКАТОРА
 Q:%1="" 1 ;%1-МАССИВ %2-КОД %3-ТЕКСТ
 Q:%2="" 1 S li=%1 D GL^%ZAPM.ed.BSF3 I 'YES Q 1
 I $D(@(GL_"(%2)")) D  Q 1
 .I %3="" S ls=" УДАЛИМ ИЗ "_GL_" КОД:"_%2_". ВЫ УВЕРЕНЫ ? " D YES^%ZAPM.ed.BSF D  Q
 ..I YES S %3=@(GL_"(%2)") K @$ZR K:%3'="" @(GL_"in(%3)")
 .I $D(@(GL_"in(%3)")) Q
 .S @(GL_"in(%3)")=%2
 I %3'="" S ls=" ДОБАВИМ В "_GL_" НОВЫЙ КОД :"_%2_" . ВЫ УВЕРЕНЫ ? " D YES^%ZAPM.ed.BSF I YES S @(GL_"(%2)")=%3,@(GL_"in(%3)")=%2 Q 1
 I 1 Q 1
DELCTL(d) N UP,i ;УДАЛЕНИЕ ИЗ d УПРАВЛЯЮЩИХ КОДОВ С ЗАМЕНОЙ НА "¬"
 S UP="" F i=0:1:31 S UP=UP_$C(i)
 Q $TR(d,UP,$TR($J("",$L(UP))," ","¬"))
COLOR(%1) ;ЦВЕТ !!! CLR !!!
 S CLR=%1 Q ""
CELL(%1,%2,%3,%4) ;ПСЕВДОГРАФИКА    ;             %3 |
 N l,h,s,i,t Q:'$D(BS) ""           ;     %2  =======| %4
 S l=$P($G(BS),"@",4),h=$P($G(BS),"@",3)
 S s=$G(%1)_$J("",h*l),t=$L(%1)
 I $G(%3)'="" S l=l-1,t=t+h
 F i=1:1:h-1  S s(i)=$E(s,i*l-l+1,l+(l*(i-1)))_$E(%3,1)
 I $G(%2)'="" S t=t+l,s(h)=$TR($J("",l)," ",$E(%2,1))_$G(%4,$G(%3))
 E  S s(h)=$E(s,h*l-l+1,l+(l*(h-1)))_$G(%4,$G(%3))
 S s="" F i=1:1:h S s=s_s(i)
 Q s_$J(".",t)
Butt(%1) ;КНОПКА
 N l,h,s,i,t,%2,%3,%4 S %3="¶",%2="®",%4="®" ; ¶  код220 _  код221 [  код222 ]  код223 ®
 S l=$P($G(BS),"@",4),h=$P($G(BS),"@",3)
 S s=$G(%1)_$J("",$P(BS,"@",3)*$P(BS,"@",4))
 S t="",k=1 F i=0:(l-$L($G(%3))) Q:k=h  S t=t_$E(s,1+i,l-$L($G(%3))+i)_$S(k=1:"_",1:$G(%3)),k=k+1
 I $G(%2)="" S t=t_$E(s,1+i,l-1+i)_$G(%4)_$E(s,l+i,$$LNG^%ZAPM.ed.BSF12) Q t
 S t=t_" "_$TR($J("",l-2)," ",$E(%2))_$G(%4)_$E(s,l+i,$$LNG^%ZAPM.ed.BSF12) Q t
]]></Routine>


<Routine name="%ZAPM.ed.BSsFUNR" type="MAC" languagemode="0"><![CDATA[
%BSsFUNR ;ФУНКЦИИ СИНТАКТИЧЕСКОГО КОНТРОЛЯ И ТРАНСФОРМАЦИИ ; 14:26   04.05.2001
e Q
US I %1'[",",$G(BSR)["," S %1=$$TR^%ZAPM.ed.BSsFUNM(%1,"^",$P(BSR,"]")_"]")
 Q
READ S YES=1 S:%2["READ" %2=d0 Q
INV(%1,%2,%3) ;S;ТРАНСФОРМАЦИЯ %2 ПО КОДИФИКАТОРУ %1
 N Sec,in
 Q:%2="" "<ZERRo$$INV>" ;%3=1 ВВОД НОВОГО КОДА
 I $ZV["Cach"||($ZV["IRIS") I $P($P(%1,"]"),$C(34),4)'="" S $P(%1,$C(34),4)=""
 S %0="" I $E(%1,1)'="^" S %1="^"_%1
 D READ ;!!!!,US ;СИНТАКСИС НА ВВОД С КЛАВИТУРЫ
 I $P($G(@%1),"@",8) G INVnew
 I $D(@(%1_"(%2)")) S %0=%2 Q %0
 I $D(@(%1_"in(%2)")) S %0=@$ZR Q %0
 S in=$O(@(%1_"in(%2)")) I in="" G IN
 I ("@"_in)[("@"_%2) S %0=@(%1_"in(in)") Q %0
IN G:'$G(%3) I S ls=" КОД ОСУТСТВУЕТ !!! ВВЕДЕМ НОВЫЙ КОД:"_%2_" ? " D YES^%ZAPM.ed.BSF I YES S ls=" А ТЕПЕРЬ ВВЕДИТЕ ТЕКСТ РАСШИФРОВКУ ДЛЯ КОДА;",li="",ll="@" D LE^%ZAPM.ed.BSTT I YES,li'="" S @%1@(1,%2)=li,@%1@(2,li)=%2 S %0=%2 Q %0
I X "I 0" S YES=0,%0="<$$INV>" D INVLS Q %0
INVLS S ls="КОД("_%2_") не соответствует кодификатору :"_%1 Q
INVnew I $D(@%1@(1,%2)) S %0=%2 Q %0
 I $D(@%1@(2,%2)) S %0=@$ZR Q %0
 S in=$O(@%1@(2,%2)) I in="" G INnew
 I ("@"_in)[("@"_%2) S %0=@%1@(2,in) Q %0
INnew G:'$G(%3) I I '($D(OldP)&($D(LB))) S ls=" КОД ОСУТСТВУЕТ !!! ВВЕДЕМ НОВЫЙ КОД:"_%2_" ? " D YES^%ZAPM.ed.BSF I YES S ls=" А ТЕПЕРЬ ВВЕДИТЕ ТЕКСТ РАСШИФРОВКУ ДЛЯ КОДА;",li="",ll="@" D LE^%ZAPM.ed.BSTT I YES,li'="" S @%1@(1,%2)=li,@%1@(2,li)=%2 S %0=%2 Q %0
Inew X "I 0" S YES=0,%0="<$$INV>" D INVLS Q %0
 ;
TIN(%1,%2,%3) ;S;ТРАНСФОРМАЦИЯ ОБРАТНАЯ %2 ПО КОДИФИКАТОРУ %1
 N z,zt
 S z=$ZR ;%3=1 - <ERRO_$$INV>=""
 S %0="" I $E(%1,1)'="^" S %1="^"_%1
 I $ZV["Cach"||($ZV["IRIS"),'$G(TableAlive) I $P($P(%1,"]"),$C(34),4)'="" S $P(%1,$C(34),4)=""
 D READ ;!!!!,US ;СИНТАКСИС НА ВВОД С КЛАВИТУРЫ
 I %2="" S %2=0
 I '$$Data^%ZAPM.ed.BSF12(%1) S YES=0,%0=$S($G(%3):"",1:"<$ZE="_$ZE_">") X "I 0" D TIZ Q %0
 I $P($G(@%1),"@",8) G TINnew
 I $D(@(%1_"(%2)")) S %0=@(%1_"(%2)") D TIZ Q %0
 E  S YES=0,%0=$S($G(%3):"",1:"<ERROR_$$INV>") X "I 0" D TIZ Q %0
TINnew I $D(@%1@(1,%2)) S %0=$TR(@%1@(1,%2),$C(12),"") D TIZ Q %0
 E  S YES=0,%0=$S($G(%3):"",1:"<ERROr_$$INV>") X "I 0" D TIZ Q %0
TIZ S zt=$T I $D(z),$QS(z,$QL(z))'="",$D(@z) ;ВОЗВРАТ ПОЛНОЙ ГЛ.ССЫЛКИ
 I zt
 Q
UselBd(M,k0,KOL,k1,k2,k3,k4,k5,k6,k7,k8,k9,k10) ;ССЫЛКА НА УЗЕЛ БАЗЫ ДАННЫХ
 Q:(M_k0)="" "NO_ARR"
 N z,zt,%0
 S z=$ZR,zt=$T
 I KOL=0 S %0=$G(@(M_k0),"NO_VAL") G UzelB
 I KOL=1 S %0=$G(@(M_k0)@(k1),"NO_VAL") G UzelB
 I KOL=2 S %0=$G(@(M_k0)@(k1,k2),"NO_VAL") G UzelB
 I KOL=3 S %0=$G(@(M_k0)@(k1,k2,k3),"NO_VAL") G UzelB
 I KOL=4 S %0=$G(@(M_k0)@(k1,k2,k3,k4),"NO_VAL") G UzelB
 I KOL=5 S %0=$G(@(M_k0)@(k1,k2,k3,k4,k5),"NO_VAL") G UzelB
 I KOL=6 S %0=$G(@(M_k0)@(k1,k2,k3,k4,k5,k6),"NO_VAL") G UzelB
 I KOL=7 S %0=$G(@(M_k0)@(k1,k2,k3,k4,k5,k6,k7),"NO_VAL") G UzelB
 I KOL=8 S %0=$G(@(M_k0)@(k1,k2,k3,k4,k5,k6,k7,k8),"NO_VAL") G UzelB
 I KOL=9 S %0=$G(@(M_k0)@(k1,k2,k3,k4,k5,k6,k7,k8,k9),"NO_VAL") G UzelB
 I KOL=10 S %0=$G(@(M_k0)@(k1,k2,k3,k4,k5,k6,k7,k8,k9,k10),"NO_VAL") G UzelB
UzelB I $D(z),$QS(z,$QL(z))'="",$D(@z) ;ВОЗВРАТ ПОЛНОЙ ГЛ.ССЫЛКИ
 I zt
 Q %0
VAL(%1) ;ПОЛНАЯ ССЫЛКА
 N z,zt,%0
 S z=$ZR
 S %0=$G(@%1,"NO_VAL") D TIZ
 Q %0
ErTimDat S ls="ОШИБКА формата даты !,Вводите в  формате:ЧЧММДДММГГ ",YES=0,%0="" X "I 0" Q %0
TimDat10(%2) ;ПРЯМОЙ ВВОД ВРЕМЕНИ_ДАТЫ (ЧЧММДДММГГ) С ПОСЛЕДУЮЩИМ ПЕРЕВОРОТОМ
 N D,D1,D2,T,T1
 D READ
 S %0="" I %2["??????" S %0=%2 Q %0 ;ИТОГ ЗА ДАТУ
 I %2["." S %2=$TR(%2,".","")
 I $L(%2)'=10 G ErTimDat
 ;I '$$TimCheck($E(%2,1,4)) G ErTimDat
 ;I '$$DatCheck($E(%2,5,10)) G ErTimDat
 S %0=$E(%2,9,10)
 Q
REVERS(D) ;РЕВЕРС ДАТЫ ДДММГГГГ ---> YYYYMMDD
 I $L(D)=8 Q $E(D,5,8)_$E(D,3,4)_$E(D,1,2)
 Q $E(D,5,6)_$E(D,3,4)_$E(D,1,2)
DAT(%1,%2) ;S; %2=ДДММГГ ---> %0=ГГММДД
 N r2,%3,%4,%5,%6
 D READ ;КОНТРОЛЬ И ТРАНСФОРМАЦИЯ ДАТЫ ПРИ ВВОДЕ
 S %0="" I %2["??????" S %0=%2 Q %0
 I %2["." S %2=$TR(%2,".","")
 G DateNew:%1>5,10:$L(%2)>8
 I $L(%2)=5 S %2="0"_%2
 I '($L(%2)=6!($L(%2)=8)) G ERD
 I $L(%2)=8 S r2=$E(%2,5,8),%3=$E(%2,3,4),%4=$E(%2,1,2) I r2'?4N!(+%3>12!(+%3<1))!(+%4>31!(+%4<1)) G ERD
 I $L(%2)=6 S r2=$E(%2,5,6),%3=$E(%2,3,4),%4=$E(%2,1,2) I r2'?2N!(+%3>12!(+%3<1))!(+%4>31!(+%4<1)) G ERD
 I '$D(r2) G ERD
 S %0=r2_%3_%4 Q %0
10 ;S;ТРАНСФОРМАЦИЯ  ДАТЫ & ВРЕМЕНИ
 I '($L(%2)=10!($L(%2)=12)) G ERD
 I $L(%2)=10 S %5=$E(%2,1,2),%6=$E(%2,3,4),r2=$E(%2,9,10),%3=$E(%2,7,8),%4=$E(%2,5,6) I r2'?2N!(%3'?2N)!(%4'?2N)!(%5'?4N)!(+%3>12!(+%3<1))!(%4>31!(%4<1))!(+%5>24)!(+%6>60) G ERD
 I $L(%2)=12 S %5=$E(%2,1,2),%6=$E(%2,3,4),r2=$E(%2,9,12),%3=$E(%2,7,8),%4=$E(%2,5,6) I r2'?4N!(%3'?2N)!(%4'?2N)!(%5'?4N)!(+%3>12!(+%3<1))!(%4>31!(%4<1))!(+%5>24)!(+%6>60) G ERD
 I '$D(r2) G ERD
 I $L(r2)=2,$E(r2,1)="0" S r2="20"_r2
 D x^%ZAPM.ed.BS3(2)     ;---//--- для msm 4.x.x
 S %0=r2_%3_%4_%5_%6 X "I 1" Q %0
ERD S ls="ОШИБКА формата даты !,Вводите в  формате:"_$S($L(%2)=8:"ГГ",1:"")_"ГГММДД"_$S($L(%2)>8:"ЧЧММ",1:" "),YES=0,%0=0 X "I 0" Q %0
ERDN S ls="ОШИБКА формата даты !,Вводите в  формате:"_$S($L(%2)=8:"ГГ",1:"")_"ГГММДД"_$S($L(%2)>8:"ЧЧММ",1:"")_" ",YES=0,%0=0 X "I 0" Q %0
ERDM S ls="ОШИБКА формата даты !,Вводите в  формате:ГГММ",YES=0,%0=0 X "I 0" Q %0
YEARM(%1,%2) ;ГГММ.ГГГГММ - КОНТРОЛЬ
 I %2="READ" S %2=d0
 N %5,%6
 I '($L(%2)=4!($L(%2)=6)) G ERDM
 I $L(%2)=4 S %5=$E(%2,1,2),%6=$E(%2,3,4) I %5'?2N!(%6'?2N)!(+%6>12!(+%6<1)) G ERDM
 I $L(%2)=6 S %5=$E(%2,1,4),%6=$E(%2,5,6) I %5'?4N!(%6'?2N)!(+%6>12!(+%6<1)) G ERDM
 S %0=%2 X "I 1" Q %0
DateNew ;НОВЫЙ ФОРМАТ
 G N10:$L(%2)>8
 I '($L(%2)=6!($L(%2)=8)) G ERDN
 I $L(%2)=8 S r2=$E(%2,1,4),%3=$E(%2,5,6),%4=$E(%2,7,8) I r2'?4N!(+%3>12!(+%3<1))!(+%4>31!(+%4<1)) G ERDN
 I $L(%2)=6 S r2=$E(%2,1,2),%3=$E(%2,3,4),%4=$E(%2,5,6) I r2'?2N!(+%3>12!(+%3<1))!(+%4>31!(+%4<1)) G ERDN
 I '$D(r2) G ERDN
 I +%3=2,+%4>28,'$$VIS(r2) G ERDN
 I ",2,4,6,9,11,"[(","_+%3_","),+%4>30 G ERDN
 S r2=$$ADDYEAR(r2)
 S %0=r2_%3_%4 Q %0
ADDYEAR(r2) ;ДОБАВИТЬ СТОЛЕТИЯ
 I $E($G(%BS(1),"0021101000121100100"),14),$L(r2)=2 D
 .I +r2<50 S r2="20"_r2 Q
 .S r2="19"_r2
 Q r2
N10 ;S;ТРАНСФОРМАЦИЯ  ДАТЫ & ВРЕМЕНИ
 I '($L(%2)=10!($L(%2)=12)) G ERDN
 I $L(%2)=10 S %5=$E(%2,7,8),%6=$E(%2,9,10),r2=$E(%2,1,2),%3=$E(%2,3,4),%4=$E(%2,5,6) I r2'?2N!(%3'?2N)!(%4'?2N)!(%5'?2N)!(%6'?2N)!(+%3>12)!(+%3<1)!(+%4>31)!(+%4<1)!(+%5>24)!(+%6>60) G ERDN
 I $L(%2)=12 S %5=$E(%2,9,10),%6=$E(%2,11,12),r2=$E(%2,1,4),%3=$E(%2,5,6),%4=$E(%2,7,8) I r2'?4N!(%3'?2N)!(%4'?2N)!(%5'?2N)!(%6'?2N)!(+%3>12!(+%3<1))!(%4>31!(%4<1))!(+%5>24)!(+%6>60) G ERDN
 I '$D(r2) G ERDN
 I $L(r2)=2,$E(r2,1)="0" S r2="20"_r2
 S %0=r2_%3_%4_%5_%6 X "I 1" Q %0
 ;
DTT(%1,%2) ;T;ТРАНСФОРМАЦИЯ ДАТЫ ПРИ ВЫВОДЕ %2=ГГММДД ---> %0=ДД.ММ.ГГ
 S %0=""   ;СТАРАЯ ВЕРСИЯ !!!! НОВАЯ --> $$NDTT(DATE)
 I $L(%2)=6 S %0=$E(%2,5,6)_"."_$E(%2,3,4)_"."_$E(%2,1,2)
 I $L(%2)=8 S %0=$E(%2,7,8)_"."_$E(%2,5,6)_"."_$E(%2,1,4)
 I $L(%2)=10 S %0=+$E(%2,7,8)_":"_$E(%2,9,10)_" "_$E(%2,5,6)_"."_$E(%2,3,4)_"."_$E(%2,1,2)
 I $L(%2)=12 S %0=+$E(%2,9,10)_":"_$E(%2,11,12)_" "_$E(%2,7,8)_"."_$E(%2,5,6)_"."_$E(%2,1,4)
 Q %0
 ;--
SYSDATE(%1,%2) ;ИЗ $$h^%ZAPM.ed.BS3() --> ГГММДД
 S %0=$$ESDAY(%1,%2) K %1 I %0[" " S %1=$P(%0," "),%0=$P(%0," ",2)
 S %0=$TR(%0,".","") I $L(%0)=6 S %0=$E(%0,5,6)_$E(%0,3,4)_$E(%0,1,2)
 I $L(%0)=8 S %0=$E(%0,5,8)_$E(%0,3,4)_$E(%0,1,2)
 I $D(%1) S %1=$P(%1,":",1)_$P(%1,":",2) K:%1'?4N %1
 Q %0_$G(%1)
ESDAY(%1,%2) ;        ИЗ $$h^%ZAPM.ed.BS3() В ДД.ММ.ГГ
 N r4,%D,%I,%LY,%M,%R,%Y,%TIM,%NP
 I %2="READ" S %2=d0
 S r4=%2,%2=%2>21914+%2 ;        ИЗ $$h^%ZAPM.ed.BS3() В ДД.ММ.ГГ
 S %LY=%2\1461,%R=%2#1461,%Y=%LY*4+1841+(%R\365),%D=%R#365,%M=1
 I %R=1460,%LY'=14 S %D=365,%Y=%Y-1
 F %I=31,(%R>1154)&(%LY'=14)+28,31,30,31,30,31,31,30,31,30 Q:%I'<%D  S %M=%M+1,%D=%D-%I
 I %D=0 S %Y=%Y-1,%M=12,%D=31
 I %D?1N S %D="0"_%D
 S %0=%D_"."_$P("01 02 03 04 05 06 07 08 09 10 11 12"," ",%M)_"."_$S('$E($G(%BS(1)),14):$E(%Y,3,4),1:%Y)
 I %1=4 Q %Y
 I %1<7 Q %0
30 S %M=$P(r4,",",2)\60
40 NEW %I S %TIM=%M\60_":"_(%M#60\10)_(%M#10)_$S(%1=8:":"_($P(r4,",",2)#60),1:"") ; NEW %I for DMS
 S %N=" ДП" S:%M'<720 %M=%M-720,%N=" ПП" S:%M<60 %M=%M+720
 S %I=%M\600 S:'%I %I=" " S %TIM1=%I_(%M\60#10)_":"_(%M#60\10)_(%M#10)_%N
 K %M,%N,%I,%NP S %0=%TIM_" "_$G(%0) Q %0
 
Time(r4) N %I,%M,%TIM,%N,%NP,%1,%0
 S %M=r4\60,%1=9
 S %TIM=%M\60_":"_(%M#60\10)_(%M#10)_$S(%1=8:":"_(r4#60),1:"")
 S %N=" ДП" S:%M'<720 %M=%M-720,%N=" ПП" S:%M<60 %M=%M+720
 S %I=%M\600 S:'%I %I=" " S %TIM1=%I_(%M\60#10)_":"_(%M#60\10)_(%M#10)_%N
 S %0=%TIM_" "_$G(%0)
 Q %0
 
TXTD(%1) ;ДАТУ %1=ГГММДД --> %0="1 мая 1994 г."
 N d,d1,%0,YA
 I '%1 S %0="" Q ""
 I $L(%1)=8 S YA=$E(%1,1,2),%1=$E(%1,3,8)
 S d=+$E(%1,3,4)
 S d1=$P("янваpя,февpаля,маpта,апpеля,мая,июня,июля,августа,сентябpя,октябpя,ноябpя,декабpя",",",d)
 S %0=+$E(%1,5,6)_" "_d1_" "_$S($D(YA):YA,1:"19")_$E(%1,1,2)_" г."
 Q %0
VIS(Y) ;ВИСОКОСНЫЙ ЛИ ГОД ?
 Q:Y#400=0 1 Q:Y#100=0 0
 Q:Y#4=0 1 Q 0
WEEK(%1,%2) ;ДЕНЬ НЕДЕЛИ  %2=ГГММДД --> %0=N НЕДЕЛИ
 N I,D,M,Y,DM
 D READ I $L(%2)=8 S D=+$E(%2,7,8),M=+$E(%2,5,6),Y=$E(%2,1,4)
 I $L(%2)=6 S D=+$E(%2,5,6),M=+$E(%2,3,4),Y=$E(%2,1,2) D
 .I Y<50 S Y="20"_Y Q
 .S Y="19"_Y
 I '$D(M) D ErrMsg^%ZAPM.ed.BSXfun("НАРУШЕНИЕ ФОРМАТА ДАТЫ='"_%2_"'. $ZR="_$ZR) ZT "WEEK"
 I M<1!(M>12) G WEN
 F I=1:1:12 S DM(I)=$P("31-29-31-30-31-30-31-31-30-31-30-31","-",I)
 S DM(2)=$$VIS(Y)+28
 G WEN:(DM(M)<D)!(Y<80)
 I Y>1979 S H=50768 F I=1980:1:Y-1 S H=$$VIS(I)+365+H
 I Y'>1979 S H=50768 F I=1979:-1:Y S H=H-$$VIS(I)-365
 F I=1:1:M-1 S H=H+DM(I)
 S H=H+D
WEE S %0=$P($S(%1=1:"Четверг-Пятница-Суббота-Воскресенье-Понедельник-Вторник-Среда",1:"4-5-6-7-1-2-3"),"-",H#7+1) K M,D,DM,Y X "I 1" Q %0
WEN S %0="<ERROR_$$h^%ZAPM.ed.BS3()>",YES=0 X "I 0" Q %0
WEEKEND(%1,%2) ;%2=$$h^%ZAPM.ed.BS3() ---> %0 ДЕНЬ НЕДЕЛИ
 S H=%2 G WEE
Y(D) ;ВОЗВРАТИТЬ ГОД   ГГГГММДД --> ГГГГ
 I $L(D)=8 Q $E(D,1,4)
 Q $E(D,1,2)
YY(D) ;ВОЗВРАТИТЬ ГОД  ГГГГММДД --> ГГ (ДЛЯ ИМЕН БАЗ ДАННЫХ)
 I $L(D)=8 Q $E(D,3,4)
 Q $E(D,1,2)
M(D) ;ВОЗВРАТИТЬ МЕСЯЦ ГГГГММДД --> ММ
 I $L(D)=8 Q $E(D,5,6)
 Q $E(D,3,4)
D(D) ;ВОЗВРАТИТЬ ДНИ   ГГГГММДД --> ДД
 I $L(D)=8 Q $E(D,7,8)
 Q $E(D,5,6)
NDTT(D) ;НОВАЯ ДАТА ТРАНСФОРМАЦИЯ ГГГГММДД-->ГГГГ.ММ.ДД
 I $L(D)=8 Q $E(D,1,4)_"."_$E(D,5,6)_"."_$E(D,7,8)
 Q $E(D,1,2)_"."_$E(D,3,4)_"."_$E(D,5,6)
DATHR(%1,%2) ;ПЕРЕВОД ДАТЫ И ВРЕМЕНИ В ФОРМАТ СИСТЕМНОЙ ПЕРЕМЕННОЙ $H
 ;%2=ГГММДД --->  %0=$P($h,",") <-- ГГГГММДД
 ;ГГММДДЧЧМИ -->  $H=КОЛ-ВО_ДНЕЙ,КОЛ-ВО_СЕКУНД  <-- ГГГГММДДЧЧМИ
 N Y,N,D,H,HO
 S YES=1,%0=$$WEEK(%1,$S($L(%2)=10:$E(%2,1,6),$L(%2)=12:$E(%2,1,8),1:%2)) I 'YES Q %0
 I %1<7 S %0=H Q %0
 I $L(%2)=10 S HO=$E(%2,7,10)
 I $L(%2)=12 S HO=$E(%2,9,12)
 S %0=H_","_(($E(HO,1,2)*3600)+($E(HO,3,4)*60))
 Q %0
IF(%1,%2,%3,%4) ;%1="УСЛОВИЕ" YES=$T
                ;%2="READ" ТО %2=d0
                ;%3="КОМАНДА ИЗМЕНЕНИЯ d
                ;%4="СООБЩЕНИЕ ПРИ ОШИБКЕ"
 S %0=$G(%2),YES=0 D READ S:%2["READ" %0=d
 X "I "_%1 S YES=$T I  X $G(%3) S %0=d
 I $D(%4) S ls=%4
 Q %0
SAY D O^%ZAPM.ed.BSF7 Q 0
KeyTime(BS) ;Определение даты в Ключе
 N kd,M,i
 I $P(BS,"@",19) S kd=$$ESDAY(9,$P($P(BS,"@",19),",",1,2))
 E  S kd=$P(BS,"@",19)
 S M="  "_$G(kd)_" "_$P($P(BS,"@",19),",",3)_","_$TR($P($P(BS,"@",19),",",4),"123",".?!")
 Q $J("",$P(BS,"@",4)-$L(d1)-$L(M))_M
Pa N i K Pa F i=1:1 Q:'$D(@("%"_i))  S Pa(i)=@("%"_i)
 Q
FCl(%1,%2,%3,%4,%5) D Pa Q 1
FCls(%1,%2,%3,%4,%5) D Pa Q 1
FCln(%1) D Pa Q 1
 ;
FCs(%1,%2,%3,%4,%5) D Pa Q 1
FCss(%1,%2,%3,%4,%5) D Pa Q 1
FCsk(%1,%2,%3,%4,%5) D Pa Q 1
FCsn(%1) D Pa Q 1
 ;
TSP(%1,%2,%3,%4,%5,%6) Q 1
TSPGL(%1) Q 1
TSPPI(%1,%2,%3,%4) Q 1
TSPL(%1,%2,%3,%4,%5) Q 1
TSPN(%1) Q 1
TSORTSET() S @BSR@(BST,ny)=1 Q 1
TSV(%1,%2,%3,%4,%5) I %1'["^" G P1
 Q 1
P1 S ls=" В ПАР=1 ДОЛЖЕН БЫТЬ ""^"" " G SAY
TSVD(%1,%2,%3,%4) Q 1
TSVGL(%1,%2,%3,%4,%5,%6) Q 1
TSVL(%1,%2,%3,%4,%5,%6) Q 1
TSVU(%1,%2,%3,%4,%5,%6) Q 1
TSVV(%1,%2,%3,%4,%5,%6) Q 1
TSVN(%1) Q 1
PAGE(%1) ;ФУНКЦИЯ РАЗБИТИЯ СПИСКА НА СТРАНИЦЫ %1-КОЛ-ВО СТРОК
 S:'$D(PaGe) PaGe=%1 I $G(Yl)>PaGe S PaGe=PaGe+%1,YES=1 Q 1
 S YES=0 Q 0
MTBD(%1,%2) ;ЛОГИЧЕСКАЯ ФУНКЦИЯ-ДИСПЕТЧЕР МНОГО-ТАБЛИЧНОЙ БАЗЫ ДАННЫХ
 S $ZT="ErrMTBD^%ZAPM.ed.BSsFUNR"
 N d
 I $D(%1),%1["^" S d=1 I $D(@%1)
 I $D(%2) S d=1 X "I "_%2
 Q "1!"_$G(%1)_"!"_$G(%2)
ErrMTBD Q "0!!!"_$ZE_"!"_$$ErrSay^%ZAPM.ed.BSF8($ZE)
KEYPAS(%1) ;ЛОГИЧЕСКАЯ ФУНКЦИЯ-ДИСПЕТЧЕР ПАРОЛИРОВАНИЯ УЗЛОВ БАЗЫ ДАННЫХ
 Q 1
]]></Routine>


<Routine name="%ZAPM.ed.BSsFUNS" type="MAC" languagemode="0"><![CDATA[
%BSsFUNS ;пpогpамма Функций ; 17:22 10-JUN-98
 Q
Data() Q "Дата "_$$ESDAY^%ZAPM.ed.BSsFUNR(6,$$h^%ZAPM.ed.BS3())_" Время "_$$Time^%ZAPM.ed.BSsFUNR($P($$h^%ZAPM.ed.BS3(),",",2))
LongStr(x,S) ;ТРАНСФОРМАЦИЯ ДЛЯ ДЛИННЫХ СТРОК
 N I,II
 I nx<x Q ""
 S II=0 F I=x:1:nx-1 S II=II+$P(@BSR@(BST,ny,I),"@",4)
 Q $E(S,II+1,999)
Var(N) ;ПЕРЕМЕННУЮ ТАБЛИЦЫ N ВЕРНУТЬ
 I $D(SetVar(BSR,BST,N)) Q SetVar(BSR,BST,N)
 S SetVar(BSR,BST,N)=$G(@BSR@(BST,"Var",N))
 Q SetVar(BSR,BST,N)
SetVar(N,V,Z,B) ;ПРИСВОИТЬ ПЕРЕМЕННУЮ ТАБЛИЦЫ
 I $G(Z)=1,V="" Q 1
 G Se:$G(B)=1,Se:'$D(BSr) I $D(SetVar(BSr,BSt,N)),SetVar(BSr,BSt,N)=V Q 1
 D zr(1) S @BSr@(BSt,"Var",N)=V,SetVar(BSr,BSt,N)=V D zr(0) Q 1
Se I $D(SetVar(BSR,BST,N)),SetVar(BSR,BST,N)=V Q 1
 D zr(1) S @BSR@(BST,"Var",N)=V,SetVar(BSR,BST,N)=V D zr(0) Q 1
zr(N) I N=1 S zr=$ZR Q  ;СОХРАНИТЬ
 I $D(zr),$D(@zr) ;ВОССТАНОВИТЬ
 Q
]]></Routine>


<Routine name="%ZAPM.ed.BSscrF" type="MAC" languagemode="0"><![CDATA[
%BSscrF ;Работа с буфером таблицы  (А.Тимофеев) ; 17:06   20.04.2000
 
LOAD(%1,%2,%3,%4,%5) 
 ;ФУНКЦИЯ ДЛЯ ЗАГРУЗКИ ЛЮБОЙ ТАБЛИЦЫ И ВЫТАСКИВАНИЯ ИЗ НЕЕ ИНФОРМАЦИИ
 ;%1- ПОЛНАЯ ГЛОБАЛЬНАЯ ССЫЛКА НА ТАБЛИЦУ
 ;%2- ЧТО ЗАПОМИНАЕМ НА ВЫХОДЕ (1 - ПОМЕЧЕННЫЕ БЛОКОМ, 2 - НЕЗАКРЫТЫЕ ОТ ЗАПИСИ,
 ;"N#S#E" - N- НОМЕР КОЛОНКИ, S- НАЧИНАЯ СО СТРОКИ, E- КОНЧАЯ СТРОКОЙ)
 ;%3- КУДА ЗАПОМИНАЕМ (1- СКИДЫВАЕТСЯ В МАССИВ ^%ZAPM.ed.BSbufB("W"_$G(%BS(3),$P)_$J_"u"), 2- ПЕРЕМЕННАЯ ВОЗВРАТА
 ;%4- СИМВОЛ-РАЗДЕЛИТЕЛЬ (ПО УМОЛЧАНИЮ - "~")
 ;%5- ПРОГРАММА ПРЕДОБРАБОТКИ, ЗАПУСКАЕМАЯ ПЕРЕД ЗАГРУЗКОЙ ТАБЛИЦЫ
 ;%0- СТРОКА ИЗ ДАННЫХ ИЛИ МАССИВ
 ;ДАННЫЕ ЗАПОМИНАЮТСЯ В МАССИВ ПО АДРЕСУ КЛЕТОК (y,x)
 I '$D(%1)!('$D(%2))!('$D(%3)) S %0="" D ErrMsg^%ZAPM.ed.BSXfun("Неправильные параметры !!") Q %0
 S:%3=2&($G(%4)="") %4="~"
 S %0=""
 N BSr1,BSt1,BSr2,BSt2,BSRold,BSTold,%zT S %zT=$ZT,$ZT="ERROR"
 
 K ^%ZAPM.ed.BSbufB("fTS"_$G(%BS(3),$P)_$J_"u")   ;копия исходной таблицы в буффер и загрузка
 S BSr1=$P(%1,"("),BSt1=$P($P(%1,"(",2),")"),BSr2="^%ZAPM.ed.BSbufB",BSt2="fTS"_$G(%BS(3),$P)_$J_"u" D COPY^%ZAPM.ed.BSTK
 S BSRold=$G(BSR),BSTold=$G(BST),BSR="^%ZAPM.ed.BSbufB",BST="fTS"_$G(%BS(3),$P)_$J_"u"
 S IYI=BSR_"("_BST X:$G(%5)'="" "D "_%5 D  K BSR,BST D NE^%ZAPM.ed.BSN S BSR=BSRold,BST=BSTold,%0="" ;```MSW МОЙ КИЛЛ BSR,BST
 .D TAB^%ZAPM.ed.BSF1 ;А ЭТО КТО БУДЕТ ДЕЛАТЬ ? ПУШКИН ЧТО-ЛИ ?
 ;Выборка данных
 N mas,mas1,i,i1,i2,i3,i4
 S mas="^%ZAPM.ed.BSbufB(""fTS""_$G(%BS(3),$P)_$J_""u"")"
 I %3=1 S mas1="^%ZAPM.ed.BSbufB(""W""_$G(%BS(3),$P)_$J_""u"")",%0=mas1 K @mas1
 I "1,2"'[%2 D  G Q     ;По колонке
 .S i1=$P(%2,"#") I i1="" Q %0
 .S i2=$P(%2,"#",2) S:i2="" i2=1
 .S i3=$P(%2,"#",3) S:i3="" i3=999
 .F i=i2:1:i3 Q:'$D(@mas@(i,1))  D EXT
 
 D  G Q                 ;По выделенным или незакрытым от записи
 .S i=0 F  S i=$O(@mas@(i)) Q:i=""  Q:i'=+i  D
 ..S i1="" F  S i1=$O(@mas@(i,i1)) Q:i1=""  D
 ...I %2=1 D:$P(@mas@(i,i1),"@",12)=1 EXT Q
 ...I %2=2 I $P(@mas@(i,i1),"@",5)="" D EXT Q
 
EXT ;Запись данных
 I %3=2 S %0=%0_$P($G(@mas@(i,i1)),"@",15)_%4 Q
 I $P($G(@mas@(i,i1)),"@",15)'="" S @mas1@(i,i1)=$P($G(@mas@(i,i1)),"@",15)
 Q
 
Q S $ZT=%zT Q %0
 
ERROR ;
 D ErrMsg^%ZAPM.ed.BSXfun("Ошибка !! "_$ZE_" "_$$ErrSay^%ZAPM.ed.BSF8($ZE))
 S %0="" Q %0
]]></Routine>


<Routine name="%ZAPM.ed.BSvdaMAIL" type="MAC" languagemode="0"><![CDATA[
%BSvdaMAIL ;ПОЧТОВЫЕ ОПЕРАЦИИ - ПРИЕМ/ОТПРАВКА ПОЧТОВЫХ СООБЩЕНИЙ
 ;       
 ;  Copyright (C) Воронов Д.А.
 ;  Copyright (C) Serge W. Mikhaylenko
 ;  All Rights Reserved
 q
MainServerSMTP() //какой нынче почтовый сервер главный?
 ;N A,IP,port,sport,TCP S ErrMsg="Error "
  Q $ZU(110) ;пока так
 S A=$ZCONVERT($P($P($$GETOPT^%ZAPM.ed.BSC4cfgP("^%ZAPM.ed.BSETUP(""ISS"")","Admin"),"@",2),">"),"U")
 I A="" S ErrMsg="Не определен Главный почтовый сервер ИнфоПортала" Q ""
 I A'=$ZU(110) D  Q A
 .S IP=$P($ZU(54,13,A),",") I IP="" S ErrMsg="Главный почтовый сервер ИнфоПортала '"_A_"' не доступен",A=""
 .Q  ;ПРОВЕРИТЬ ЗАПУЧЕН ЛИ ОН НА 25 ПОРТУ?
 .F sport=1965,25 D
 ..S TCP="|TCP|"_sport Open TCP:(A:sport):2 I  C TCP K TCP Q 
 .I $D(TCP) S ErrMsg="На сервере '"_A_"' не запущен SMTP сервер",A=""
 S port=$P($G(^%ZAPM.ed.BSpgWEMM("HOST",$ZCONVERT($ZU(110),"U")),"25,110"),",",1) L ^%ZAPM.ed.BSpgWEBC(port):0 
 I  S ErrMsg="Главный почтовый сервер ИнфоПортала '"_A_"' не запущен",A="" Q A
 Q $ZU(110)
NEWS //ПОЧТА?
 I $$MainServerSMTP="" Q
 N BSmName,BSmPass S BSmName=BSLOGIN,BSmPass=BSSES
 W "<HR>" S MSG=$$NEWSMAIL(BSLOGIN,BSSES) 
 I MSG'="0/0" W !,RED,"Для Вас есть письма ! Новых сообщений "_MSG_". <A HREF='"_$$ADDBSGET^%ZAPM.ed.BSC4(,"POP2^~BSvdaMAIL")_"' TITLE='письма, пришедшие на ваш адрес'>загрузить</A>"_EF i 1
 e  W !,RED,"Для Вас писем нет !",EF
 W " Можете сами создавать сообщения. <A HREF='"_$$ADDBSGET^%ZAPM.ed.BSC4(,"SMTP1^~BSvdaMAIL")_"' TITLE='написать письмо другому пользователю портала'> Написать письмо</A>"
 Q
ADMINMAIL ;СОБРАТЬ ВСЕ ПОЧТУ ДЛЯ АДМИНА
 N BSmName,BSmPass,ADMINMAIL S BSmName=BSLOGIN,ADMINMAIL=1
 D VAR,BEG1^%ZAPM.ed.BSC4 
 W $$TITL^%ZAPM.ed.BSCGIS("ПРИЕМ ПОЧТЫ"),$$B27^%ZAPM.ed.BSCGIS(1)
 I $G(EMO)="" S EMO=$$MainServerSMTP
 I EMO'="" D POPP(EMO)
 S MDE="" F  S MDE=$O(^%ZAPM.ed.BScSMTP(MDE)) Q:MDE=""  I MDE'=EMO D POPP(MDE,BsMAILpass)
 d EOF
 Q
NEWSMAIL(BSmName,PASS) //КОЛИЧЕСТВО ПИСЕМ N/L
 //N - всего 
 //L - из них от живых пользователей
 N i,I,MASS,EMO,L
  S EMO=$$MainServerSMTP I EMO="" Q "'ErrorServerName'"
  S BSmName1=$G(BSmName)_"@"_EMO
 I $$POP3(EMO,BSmName1,PASS,.MASS,$$DIRUSER^%ZAPM.ed.BSCmDDR($P(BSmName,"@")))<1 Q "0/0"
 S I="",L=0 F i=1:1 S I=$O(MASS(I)) Q:I=""  I $P($G(MASS(I,"from")),"@",1)'="BSystemGuard" S L=L+1
 Q (i-1)_"/"_L
VAR      ;ФОРМИРОВАНИЕ БАЗОВЫХ ПЕРЕМЕННЫХ 
 ;
 q
BOF ;НАЧАЛО ФАЙЛА HTML
 D BEG1^%ZAPM.ed.BSC4
 w "<TITLE>ОТПРАВКА/ПРИЕМ ПОЧТОВЫХ СООБЩЕНИЙ</TITLE>",BK
 q
EOF ;ЗАВЕРШЕНИЕ ФАЙЛА HTML
 D END^%ZAPM.ed.BSC4
 q
MAIN      d BOF
HOMEPAGE ;Главная страница
 S A=$$MainServerSMTP I A="" W ErrMsg Q
 D SMTP1
 D POP1
 d EOF
 Q
SELFILES(N) //СПИСОК ФАЙЛОВ ИЗ РАБОЧЕЙ ДИРЕКТОРИИ
 N MAS,U1,i,I,FN,Q,FN1,FN2
 S FN2=$ZCVT($$DIRUSER^%ZAPM.ed.BSCmDDR,"L")
 S MAS="in" D FileListDir^%ZAPM.ed.BSCEXE(FN2,MAS,2,"")
 S Q="<select name=FILE"_N_" >"_"<option> </option>"
 S U1="",i=0,I=0 F  S U1=$O(@MAS@(U1)) Q:U1=""  D
 .S FN=$ZCVT($P(@MAS@(U1),"?",1),"L"),FN1=$P(FN,FN2,2)
 .S Q=Q_"<option>"_FN1_"</option>"
 Q Q_"</select>"_BK
SELLSERV N list D USERSMAILIST^%ZAPM.ed.BSpgWEMM(.list) w "<option VALUE='' ></option>"
 //$$CFG^%ZAPM.ed.BSCp()="ASU"
 s i="" f  s i=$o(list(i)) Q:i=""  I $G(@BDUSE@(list(i),"FNM"))'="" s z=$G(@BDUSE@(list(i),"FNM")) i $a($e(z))>73  S list2(z)=list(i)
 s i="" f  s i=$o(list2(i)) Q:i=""  w "<option VALUE="_list2(i)_" " W:$G(BSend2mail)=list2(i) "SELECTED" W ">" D  W "</option>"
 .W i ;_"("_list2(i)_")"
 .;I $G(@BDUSE@(list(i),"FNM"))'="" W "("_@$ZR_")"
 w "</select>" Q
atth(cf) i cf="VV" q " title='для того чтобы вложить в письмо файл, его надо сначало отправить в рабочую директорию FTP-сервера, а потом после обновления панели выбрать его из трех списков' " 
 q " title='выберите только один файл и вложите его в письмо' " 
SMTP1    d VAR   D BEG1^%ZAPM.ed.BSC4
 w "<TITLE>ОТПРАВКА ПОЧТОВЫХ СООБЩЕНИЙ</TITLE>",BK
 S EMO=$$MainServerSMTP I EMO="" W ErrMsg Q
 I $G(BSLOGIN)="" W RED_"Сначало откройте сессию ИнфоПортала !"_EF Q
 w "<form action="""_$$ADDLIB^%ZAPM.ed.BSC4()_""" method=""POST"" name=""frmsmp"">",BK
 S BSLABEL="SEND^~BSvdaMAIL"    
 D ADDBSPOST^%ZAPM.ed.BSC4reg
 w "<table border=0 width=100%><TR><TD class=s5 align=center><B>Отправка почты</B></TD></TR></TABLE>",BK
 w "<table border=0 width=100%><tr><TD class=s3 align=center><img border=0 src='"_BSDOMAIN_"/img/letter.gif' >Кому*</td> <TD class=s3>" ;<input type=""text"" name=""komu"">"
 ;w "@"
 i $G(BSend2mail)'="" w "<input type=""text"" disabled value='"_$G(BSend2mail)_"' size=90>" w "<input type=""hidden"" name=komu value='"_$G(BSend2mail)_"' size=90>"
 e  w "<select name=komu>" D SELLSERV
 w "</td></tr>"
 w "<TD class=s3 align=center>От кого </td><TD class=s3><input DISABLED type=""text"" value="_$G(BSLOGIN,"NoName")_" >"
 w "<input type=""HIDDEN"" name=otkogo value="_$G(BSLOGIN,"NoName")_" >"
 w "<input DISABLED type=""text"" name=EMO1 value='@"_EMO_"' >"
 w "</td></tr>"
 w "<TD class=s3 align=center>Тема </td><TD class=s3><input type=""text"" name=""SUBJ"" value='"_$G(SUBJ)_"' size=90></td></tr>"
 w "<tr><td class=s3 align=center>Сообщение</td> <td class=s3><textarea rows=10 cols=90 name='TXTMAIL' >" D  W "</textarea></td></tr>"
 .I '$D(BSmN) W "Здравствуйте ..."_BK_BK_BK_"С Уважением ..." Q
 .F TA=1:1 Q:'$D(TA(TA))  W TA(TA)_BK
 s zBS4cfg=$G(^%ZAPM.ed.BS("Config")) 
 w "<tr><td class=s3 align=center "_$$atth(zBS4cfg)_">"_$s(zBS4cfg="VV":"Прикрепить файл<img border=0 src='"_BSDOMAIN_"/img/attach.gif' >",1:"")_"</td>"
 w "<td "_$$atth(zBS4cfg)_" class=s3>" d  w "</td></tr></table>"
 .i zBS4cfg="VV" w $$FTPBUTT^%ZAPM.ed.BSCmDDR(BSLOGIN)_$$SELFILES(1)_$$SELFILES(2)_$$SELFILES(3)  q
 .Q  //ПОКА ТАК
 .I $G(@BDSES@(BSSES,"VAR","Attach"))'="" W RED_$G(@BDSES@(BSSES,"VAR","Attach"))_EF_BBK
 .w $$BUTTBS^%ZAPM.ed.BSCp2("UPL^~BSvdaMAIL","attach.gif","_new","Выберите файл",300,500,"Выберите файл") 
 .S @BDSES@(BSSES,"VAR","HTTPREF")=$P(HTTPREF," ",2,999)
 w "<center>"
 w "<BUTTON onclick='Prov(komu.value);'  name=""sseenndd""  title='save currently setting' ><img border=0 src='"_BSDOMAIN_"/img/send.gif' > Отправить</BUTTON>"_BK
 //w "<input Type=""submit"" name=""sseenndd"" value=""Отправить"" >
 
 w " * - поля, обязательные для заполнения </CENTER>"
 w "</form>",BK
 D JS^%ZAPM.ed.BSCp
 w "function Prov(v) {"_BK
 w "if (v=='') {alert('Поле адресата пустое!'); return false; }"_BK
 w "frmsmp.submit(); "_BK
 w "}"_BK
 D JSE^%ZAPM.ed.BSCp
 w "<HR>"
 Q
UPL  //UPLOAD FILE TO SERVER
 S BSS1=""
 S BSS6="FILE1^~BSvdaMAIL" //ПРОГРАММА КОТОРАЯ ИСПОЛНЯЕТСЯ ПОСЛЕ ЗАГУЗКИ ФАЙЛА
 S BS1="" 
 S BS2=""  I $$SetVar^%ZAPM.ed.BSC4("NSpace",BSNSP) 
 S BSS3=BSSES,BS3=MGWLIB,BSS8=$$BSADDVAR^%ZAPM.ed.BSC4(),BSS4="" 
 D UP^%ZAPM.ed.BSC4r3
 Q 
FILE1 D BEG1^%ZAPM.ed.BSC4 W $$TITL^%ZAPM.ed.BSCGIS("UPLOAD. Step 2"),$$B27^%ZAPM.ed.BSCGIS(1) 
 W RED_$G(FiNa)_EF_BBK //ИМЯ ФАЙЛА
 //S NoCloseWin=1 //ФЛАГ НЕ ЗАКРЫВАТЬ ОКНА
 N AA M AA=@GL D Arr2File^%ZAPM.ed.BSCEXE(.AA,"c:\!\1222") K @GL //МАССИВ В КОТОРОМ ЛЕЖИТ ЗАГРУЖЕННЫЙ ФАЙЛ
 S @BDSES@(BSSES,"VAR","Attach")=$G(FiNa)
 D JS^%ZAPM.ed.BSCp
 w "opener.location='"_$G(@BDSES@(BSSES,"VAR","HTTPREF"))_"';"_BK
 D JSE^%ZAPM.ed.BSCp
 D END^%ZAPM.ed.BSC4
 Q 
ANSVER1 
 ;D locvar^%ZAPM.ed.BSCh0("",1) //1 - выводить %KEY,%CGI,%ZCS,%CGIEVAR
 N MA M MA=@BDSES@(BSSES,"VAR","MSG",BSmN) K TA 
 S I="" F  S I=$O(MA("z",I)) Q:I=""  D
 .I $G(MA("z",I,"msg"))="text" D
 ..S II="" F TA=1:1 S II=$O(MA("z",I,"msg",II)) Q:II=""  S TA(TA)=$E($G(BSend2mail),1)_"&gt;"_$G(MA("z",I,"msg",II))
 S SUBJ="Re: "_$G(MA("subject"))
 S BSend2mail=$ZCONVERT($P($G(MA("from")),"@",1),"U")
 G SMTP1
SEND //ПОСЛАТЬ ПИСЬМО
 d VAR
 d BOF
 if $G(komu)="" W RED_"Не заполнено поле 'КОМУ'"_EF G MAIN
 I $G(SUBJ)="" S SUBJ=$TR($E(TXTMAIL,1,50),$C(13,10),"  ") I SUBJ="" S SUBJ="NO SUBJ"
 F I=1:1:3 I $G(@("FILE"_I))'=""  D  S ATT(I)=DIRUSER_$G(@("FILE"_I))
 .I '$D(DIRUSER) S DIRUSER=$$DIRUSER^%ZAPM.ed.BSCmDDR()
 S EMO=$$MainServerSMTP I EMO="" W ErrMsg Q
 S S=$$SMTP(EMO,$G(TXTMAIL),$G(otkogo)_"@"_EMO,$G(komu)_"@"_EMO,$G(SUBJ),.ATT)
 I 'S W RED_S_EF
 E  w GREEN_"Отправлено"_EF_" Письмо от <I><B>"_$G(otkogo)_"@"_EMO_"</B></I> к <I><B> "_komu_"@"_EMO_"</B></I> на тему <I><B>"_SUBJ_"</B></I>"
 G HOMEPAGE
 
SMTP(MDEAM,TXTMAIL,otkogo,komu,SUBJ,att) //ПОСЛАТЬ
 N OK1 S OK1=1
 set s=##class(%Net.SMTP).%New()
 set s.port=$G(^%ZAPM.ed.BScSMTP(MDEAM,"SMTP"),"25")
 set s.smtpserver=MDEAM         // Specify SMTP server name.
 set s.timezone=$$TimeZone^%ZAPM.ed.BSpgWEMM()  // Timezone by Grinwitch
 set m=##class(%Net.MailMessage).%New() 
 set m.From=$G(otkogo)        // From 
 do m.To.Insert($G(komu)) // List of emails to send this mail
 set m.Subject=$G(SUBJ)     // Subject
 // Charset specification
 //set m.Charset="iso-8859-1" 
 // Text
 do m.TextData.Write(TXTMAIL)
 // Attachments
 n i
 I $D(att) S i="" F  S i=$O(att(i)) Q:i=""  D
 .set status=m.AttachFile($P(att(i),"\",1,$L(att(i),"\")-1)_"\",$P(att(i),"\",$L(att(i),"\")))
    //Send letter   
 set status=s.Send(m)    if ('status) S OK1=$$ERRWF(status)
 do m.%Close()
 do s.%Close()
 quit $G(OK1)
 
POP1 D VAR,BEG1^%ZAPM.ed.BSC4
 N BSmName
 w "<TITLE>ПРИЕМ ПОЧТЫ</TITLE>",BK
 w "<form action="""_$$ADDLIB^%ZAPM.ed.BSC4()_""" method=""POST"" name=""frmsmp"" target='RECEIVE'>",BK
 S BSLABEL="POP2^~BSvdaMAIL"    
 D ADDBSPOST^%ZAPM.ed.BSC4reg
 w "<table border=0 width=100%><TR><TD align=center class=s5><B>Просмотр входящих писем</B></TD></TR></TABLE>",BK
 w "<table border=0 width=100%>"
 w "<tr><TD class=s3>Имя пользователя</td><TD class=s3><input type=""text"" DISABLED value="""_BSLOGIN_""" ><input type=""HIDDEN"" name=""BSmName"" value="""_BSLOGIN_""" >"
 ;w "@"
 ;w "<select name=EMO>" D SELLSERV
 w "</td></tr>"
 ;w "<tr><TD class=s3>Пароль</td><TD class=s3 ><input type=""password"" name=""BSmPass"" value=""""></td>"
 w "</table><center><img border=0 src='"_BSDOMAIN_"/img/recv.gif' ><input Type=""submit"" value=""Проверить почту""></center>",BK
 w "</form>",BK
 w "<IFRAME HEIGHT='98%' width='98%' SRC='"_$$ADDBSGET^%ZAPM.ed.BSC4(,"stub^~BSCrep")_"' name='RECEIVE' SCROLLING='auto'></IFRAME><BR>"
 q
TABHEAD(A) w "<table border=0 width=100%><tr>"_BK
 F I="№","От кого","Написанное","Тема","Объем (байт)","Файлы","Действие" I A'[I W "<td class=s2>"_I_"</td>"
 W "</tr>"_BK
 Q
TABMAIL(MASS,BSmN,S) F I="from","date","subject","messagesize" D
 .N COL1,COL2  //
 .I I="from" D
 ..I MASS(BSmN,I)'["BSystemGuard" S COL1=RED,COL2=EF
 ..i $$CFG^%ZAPM.ed.BSCp="ASU",$p(MASS(BSmN,I),"@")'="" s fio=$G(@BDUSE@($p(MASS(BSmN,I),"@"),"FNM"))  s MASS(BSmN,I)=fio
 .W "<TD class=s1>"_$G(COL1)_MASS(BSmN,I)_$G(COL2)_" " D:S  W "</TD>"_BK
 ..I I="subject" N i S i="" F  S i=$O(MASS(BSmN,"z",i)) Q:i=""  D TEA(.MASS,BSmN,i,5,45)
 Q
TEA(MA,BSmN,I,rows,cols)  I $G(MA(BSmN,"z",I,"head","content-type"))["text/plain" D
 .N II w "<textarea rows="_rows_" cols="_cols_">"
 .S II="" F  S II=$O(MA(BSmN,"z",I,"msg",II)) Q:II=""  W $G(MA(BSmN,"z",I,"msg",II))
 .W "</textarea>"_BBK 
 Q
AttachCount(MA,BSmN) //ПОСЧИТАТЬ СКОЛЬКО ВЛОЖЕНО ФАЙЛОВ
 N I,Q S Q=""
 S I="" F  S I=$O(MA(BSmN,"z",I)) Q:I=""  D
 .I $G(MA(BSmN,"z",I,"msg"))="binary" I $G(MA(BSmN,"z",I,"msgFN"))'="" S Q=Q+1
 Q Q
POP2 //ПОКАЗАТЬ СПИСОК ПИСЕМ
 i $d(main) g MAIN
 D VAR,BEG1^%ZAPM.ed.BSC4 
 W $$TITL^%ZAPM.ed.BSCGIS("ПРИЕМ ПОЧТЫ"),$$B27^%ZAPM.ed.BSCGIS(1)
 I $G(EMO)="" S EMO=$$MainServerSMTP
 I EMO'="" D POPP(EMO)
 d EOF
 q
POPP(EMO,BSmPass)
 S BSmName1=$G(BSmName)_"@"_$G(EMO) K MASS
 I $$POP3(EMO,BSmName1,$G(BSmPass,BSSES),.MASS,$$DIRUSER^%ZAPM.ed.BSCmDDR($P(BSmName1,"@")))<1 W "Сервер: "_EMO W RED D ERRW($G(%objlasterror)) W EF_BBK Q:$D(ADMINMAIL)  q // G POP1
 K @BDSES@(BSSES,"VAR","MSG")
 M @BDSES@(BSSES,"VAR","MSG")=MASS //СОХРАНИТЬ В БУФЕРЕ ПОЛЬЗОВАТЕЛЯ
 N BSLABEL,BSLOGINDFLT,BSNOREG,BSTOP,BSTOP1,BSTOP3
 w "<form action="""_$$ADDLIB^%ZAPM.ed.BSC4()_""" method=""POST"" name=""messages"">",BK
 S BSLABEL="POP4^~BSvdaMAIL"
 D ADDBSPOST^%ZAPM.ed.BSC4reg
 w "<table border=0 width=100%><TR><TD align=center class=s5><B>Сервер: "_RED_EMO_EF_" Входящие письма для "_RED_BSmName1_EF_"</B></TD></TR></TABLE>",BK
 D TABHEAD("1")
    //                                                                   "Fri, 13 Jan 2006 21:45:25 0300"           
    N z,zz,zzz S zz="" F   S zz=$O(MASS(zz)) Q:zz=""  S zzz=$TR($ZDTH($P(MASS(zz,"date")," ",2,5),2),",",".") M z(+zzz)=MASS(zz)
    K MASS S zz="" F z=1:1 S zz=$O(z(zz)) Q:zz=""  M MASS(z)=z(zz)
 S BSmN="" F  S BSmN=$O(MASS(BSmN),-1) Q:BSmN=""  W "<TR><TD class=s1>"_BSmN_"</TD>" D
 .D TABMAIL(.MASS,BSmN,1)
 .W "<TD class=s1>"_$$AttachCount(.MASS,BSmN)_"</BUTTON>"_BK
 .//S BSLABEL="READMSG^~BSvdaMAIL"
 .W "<TD class=s1>" //<BUTTON title='Смотреть письмо в новом окне' onclick='open("""_$$ADDBSGET^%ZAPM.ed.BSC4()_""",""MSG"",""toolbar=no,menubar=no,scrollbars=yes,width=800,height=600,status=1,resizable=1"");' ><img border=0 src='"_BSDOMAIN_"/img/lett-op.gif' >Смотреть</BUTTON>"_BK
 .S BSLABEL="KILLMSG^~BSvdaMAIL"
 .W "<input Type=CHECKBOX name=DelMail"_BSmN_"> Удалить письмо</TD>"_BK
 .W "</TR>"_BK
 w "</table>"_BK
 w "<div align=RIGHT><input Type=submit name=backtomaiN value=""Закрыть окно""><input Type=HIDDEN name=DE value=''>"
 w "<BUTTON onclick='messages.DE.value=1; submit();' TITLE='Удалить помеченные' ><img border=0 src='"_BSDOMAIN_"/img/kill.gif' >Удалить помеченные</BUTTON>"_BK
 w "<BUTTON onclick='messages.DE.value=2; submit();' TITLE='Удалить все' ><img border=0 src='"_BSDOMAIN_"/img/del.gif' >Удалить все</BUTTON>"_BK
 w "</div>",BK
 w "</form>"
 Q
POP4 //ПОКАЗАТЬ СПИСОК ПИСЕМ
 D VAR N OK D BEG1^%ZAPM.ed.BSC4
 ;D locvar^%ZAPM.ed.BSCh0("",1)
 ;D JS^%ZAPM.ed.BSCp
 if $G(DE)     D  W RET //"alert('"_RET_"');"_BK
 .F I=1:1:350 I $D(@("DelMail"_I))!(DE=2) S MA(I)=""
 .S OK=$$KILLMAIL($P($G(BSmName1),"@",2),$G(BSmName1),$G(BSmPass,BSSES),.MA,.Kill) I OK<1 S RET=$$ERRWF(OK) I 1
 .E  S RET="удалено "_+$G(Kill)
 ;W "window.close();"_BK
 ;D JSE^%ZAPM.ed.BSCp
 d EOF
 Q
KILL1 S DELE=1,@("DelMail"_BSmN)=1 
  G POP4
READMSG //ЧИТАТЬ ПИСЬМО
 d VAR D BEG1^%ZAPM.ed.BSC4 W "<TITLE>Письмо № "_BSmN_" для "_BSmName1_"</TITLE>"
 w "<BODY "_$$27^%ZAPM.ed.BSCGIS_">"_BK
 N MA M MA=@BDSES@(BSSES,"VAR","MSG") //ВОССТАНОВИТЬ ИЗ БУФЕРА ПОЛЬЗОВАТЕЛЯ
 ;D locvar^%ZAPM.ed.BSCh0("",1)
 D TABHEAD("№ДействиеФайлы")
 D TABMAIL(.MA,BSmN,0) W "</TABLE>"
 S I="" F  S I=$O(MA(BSmN,"z",I)) Q:I=""  D
 .D TEA(.MA,BSmN,I,25,90)
 .W "<A HREF='"_$$ADDBSGET^%ZAPM.ed.BSC4(,"ANSVER1^~BSvdaMAIL")_"'>Ответить</A>"
 .W " <A HREF='"_$$ADDBSGET^%ZAPM.ed.BSC4(,"KILL1^~BSvdaMAIL")_"'>Удалить</A>"
 .I $G(MA(BSmN,"z",I,"msg"))="binary" S FN=$G(MA(BSmN,"z",I,"msgFN")) I FN'="" W "<img border=0 src='"_BSDOMAIN_"/img/attach.gif' >Вложенный файл <b style='color: white; background-color: Gray;' >"_FN_"</b> можно загрузить через FTP-Cервер "_$$FTPBUTT^%ZAPM.ed.BSCmDDR(BSLOGIN)_BBK
 d EOF
 Q
 
ERRW(S) D DecomposeStatus^%apiOBJ(S,.err) 
 i err(err)["ОШИБКА #6015" w !,"Сообщений нет!",! q
 write !,err(err),! 
 Q
ERRWF(S) D DecomposeStatus^%apiOBJ(S,.err) Q err(err)
POP3(MDEAM,BSmName,BSmPass,MASS,dir) //ВОЗВРАТИТ МАССИВ СПИСКА ПИСЕМ
 ;MDEAM - ИМЯ ПОЧТОВОГО СЕРВЕРА ИЛИ ЕГО IP
 ;,BSmName - ИМЯ ПОЛЬЗОВАТЕЛЯ  = "NAME_user@"_MDEAM
 ;,BSmPass - ПАРОЛЬ ПОЛЬЗОВАТЕЛЯ
 ;,MASS - МАССИВ КОТОРЫЙ СОЗДАСТ ПРОГРАММА, ГДЕ БУДЕТ ЛЕЖАТЬ СПИСОК ПИСЕМ
 ;,dir - ПУТЬ К ДИРЕКТОРИИ, КУДА ЗАКАЧАЮТСЯ ВЛОЖЕННЫЕ ФАЙЛЫ
 new mailserver,status,from,to,date,subject,messagesize,m,hdrs,key,mailMsg,lined
 N mssg
 set mailserver=##class(%Net.POP3).%New()
 I $D(dir) set mailserver.AttachDir=dir
 set mailserver.Debug=0
 set mailserver.port=$G(^%ZAPM.ed.BScSMTP(MDEAM,"POP"),"110")
 set mailserver.StoreAttachToFile=1
 set status=mailserver.Connect(MDEAM,BSmName,BSmPass)
 if ('status) g clo
 f mssg=1:1 d  if ('status) Q
 .set status=mailserver.FetchMessage(mssg,.from,.to,.date,.subject,.messagesize,.hdrs,.mailMsg,0)
 .if ('status) Q
 .S MASS(mssg,"subject")=subject
 .S MASS(mssg,"date")=date
 .S MASS(mssg,"from")=from
 .S MASS(mssg,"messagesize")=messagesize
 .S MASS(mssg,"to")=to
 .N MAS
 .d Dump(mailMsg,.MAS)
 .M MASS(mssg,"z")=MAS
 .s status=mailMsg.%Close()
clo s status=mailserver.%Close()
 q $G(mssg)-1
Dump(msg,MASS) 
 new i,index,value
 if msg.IsMultiPart do  quit
 . for i=1:1:msg.Parts.Count() do Dump(msg.Parts.GetAt(i),.MASS)
 s index=""  f  s value=msg.Headers.GetNext(.index) q:index=""  S MASS(msg,"head",index)=value
 if msg.IsBinary do
 . S MASS(msg,"msg")="binary"
 . S MASS(msg,"msgFN")=msg.FileName
 . S MASS(msg,"msgGA")=msg.GetAttribute("content-disposition","filename")
 else  do
 . ;w !,"Dumping text msg Filename="_msg.FileName_" filename="_msg.GetAttribute("content-disposition","filename"),!
 . S MASS(msg,"msg")="text"
 . S MASS(msg,"msgFN")=msg.FileName
 . S MASS(msg,"msgGA")=msg.GetAttribute("content-disposition","filename")
 . set stream=msg.TextData
 . do stream.Rewind()
 . new len,line
 . for l=1:1 set len=32763,line=stream.Read(.len) do  quit:stream.AtEnd
 ..S MASS(msg,"msg",l)=line         ;write line
 quit 
KILLMAIL(MDEAM,BSmName,BSmPass,MSGK,Kill) //УДАЛИТЬ СПИСОК ПИСЕМ
 new mailserver,status,from,to,date,subject,messagesize,m,hdrs,key,mailMsg,lined,I
 N OK S OK=1,Kill=0
 set mailserver=##class(%Net.POP3).%New()
 set mailserver.port=$G(^%ZAPM.ed.BScSMTP(MDEAM,"POP"),"110")
 set mailserver.Debug=0
 set mailserver.StoreAttachToFile=1
 set status=mailserver.Connect(MDEAM,BSmName,BSmPass)
 if ('status) S OK=status g Kclo
 S I="" F  S I=$O(MSGK(I)) Q:I=""  set OK=mailserver.DeleteMessage(I) S:OK Kill=Kill+1 I 'OK Q
 s status=mailserver.QuitAndCommit()
Kclo s status=mailserver.%Close()
 q $G(OK)
T1 W $$POP3^%ZAPM.ed.BSvdaMAIL("IVCMSW","SSS1","S",.MASS,"D:\!\1\") ZW MASS
 Q
T2       ;F I=2,3 S MA(I)=""  //УДАЛИТЬ 2,3 ПИСЬМО
 W $$KILLMAIL("IVCMSW","SSS1","S",.MA,.KKK)
 Q
 //ORIGINALLLLLL
 D ^%ZAPM.ed.BSCmail
]]></Routine>


<Routine name="%ZAPM.ed.BSvdaSTAT" type="MAC" languagemode="0"><![CDATA[
%BSvdaSTAT ;Статистика обращений к информационной системе
 ;
 ;    Copyright (C) 2003 Serge W. Mikhaylenko
 ;    Copyright (C) 2002 Воронов Д.А.
 ;    All Rights Reserved
 ;
 Q
STAT(S) S BSLABEL="HOMEPAGE^~BSvdaSTAT" 
 Q "<a href='javascript: var a=5;' onclick='open("""_$$ADDBSGET^%ZAPM.ed.BSC4()_""",""RESULT3"",""toolbar=yes,menubar=no,scrollbars=yes,status=1,resizable=1"");' TITLE=""Мониторинг системы""><img border=0 src='"_BSDOMAIN_"/img/diag.gif'>"_S_"</a>"
mainvar      ;ФОРМИРОВАНИЕ БАЗОВЫХ ПЕРЕМЕННЫХ 
 S BD=$$SW^%ZAPM.ed.BSF12("^[""%SYS"",""""]%BScVIS")
 S BDS=%BS(24,1) I '$$Data^%ZAPM.ed.BSF12(BDS) W RED_" Не доступна "_BDS_EF H
 S WAR="^mtempBSvdaSTAT"
 S BDip=$$SW^%ZAPM.ed.BSF12("^[""%SYS"",""""]%BScIP")
 q
BOF ;НАЧАЛО ФАЙЛА HTML
 D BEG1^%ZAPM.ed.BSC4
 w "<TITLE>",$G(CAPTION)_$ZU(110)_"-Мониторинг Информационного портала</TITLE>",BK
 q
EOF ;ЗАВЕРШЕНИЕ ФАЙЛА HTML
 //w "</BODY></HTML>",BK
 D END^%ZAPM.ed.BSC4
 q
FUN D JS^%ZAPM.ed.BSCp
 w "function fu1(COL1,NUM) {",BK
 ;W "alert(NUM);"_BK
 S BSLABEL="ADV^~BSvdaSTAT",BSCDAY=CDAY
 W "var HREF1="""_$$ADDBSGET^%ZAPM.ed.BSC4()_"&BSCOL1=""+COL1+""&BSNUM=""+NUM;"_BK
 W "open(HREF1,""ADV"",""toolbar=no,menubar=no,scrollbars=no,width="_$G(W,540)_",height="_$G(H,480)_",status=1,resizable=1"");"_BK
 w "}",BK
 D JSE^%ZAPM.ed.BSCp
 Q
ADV d mainvar
 S TITL="Сделать Новый Отчет. ("_$ZD(BSCDAY,3)_","_$G(BSCOL1,"?")_","_$G(BSNUM,"?")_")"
 D BEG1^%ZAPM.ed.BSC4  W $$TITL^%ZAPM.ed.BSCGIS(TITL),$$B27^%ZAPM.ed.BSCm4()
 S BSnewPR=$G(@BDS@(BSCDAY,BSNUM,"U")),BSipF=$P($P($G(@BDS@(BSCDAY,BSNUM,"S")),":IP=",2)," ")
 D REPORT("ADV",$G(@BDS@(BSCDAY,BSNUM,"S")),$G(@BDS@(BSCDAY,BSNUM,"A")))
 D END^%ZAPM.ed.BSC4 
 Q
USCH(P,A) Q "<INPUT TYPE=""CHECKBOX"" NAME=BSchk"_P_" "_$S($G(A):"CHECKED",1:"")_" >"
USERS //ПАРАМЕТРЫ ПОИСКА
 S BDGR=$$KBD^%ZAPM.ed.BSF12("^%ZAPM.ed.BSC4(""PROTECT"")")
 W "Сформировать отчет<FIELDSET><LEGEND>по пользователю: </LEGEND>"_$$USCH("U",1)_"<select name=BSnewPR size=1>"_BK_BK
 W "<option value='*' >*все пользователи*</option>"
 S G="" F  S G=$O(@BDGR@(G)) Q:G=""  W "<option value='"_G_"' " W:G=$G(BSnewPR) "SELECTED" W ">"_G_"</option>"
 W "</SELECT>"_BK_BK_$$AccU^%ZAPM.ed.BSCm2("BSnewPR")_"</FIELDSET>"_BBK
 W "<FIELDSET><LEGEND> по IP - адресу </LEGEND>"_$$USCH("I")_"<select name=BSipF size=1><option value='*' >*все адреса*</option>"
 S G="" F  S G=$O(@BDip@(G)) Q:G=""  W "<option value='"_G_"' " W:G=$G(BSipF) "SELECTED" W ">"_G_"</option>"
 W "</SELECT></FIELDSET>"_BBK
 W "<FIELDSET><LEGEND> по сетевому имени </LEGEND>"_$$USCH("N")_"<select name=BSipFN size=1><option value='*' >*все имена*</option>"
 S G="" F  S G=$O(@BDip@(G)) Q:G=""  W "<option value='"_G_"' " W:G=$G(BSipFN) "SELECTED" W ">"_$G(@BDip@(G,"NAM"))_"</option>"
 W "</SELECT></FIELDSET>"_BBK
 Q
IPAC(I) N A
 I I'["." S A=$P($ZU(54,13,I),",") Q A
 ;   S NAME2=$P($zu(54,14,$zu(54,1,IP2)),",",2) 
 S A=$zu(54,14,$zu(54,1,I)) d mainvar
 S A=$P(A,",",2) 
 I $$Data^%ZAPM.ed.BSF12(BDip) D
 .I A'="" S @BDip@(I,"NAM")=A
 .E  S Noact=$G(@BDip@(I,"NAM"))
 Q A
IPA D BEG1^%ZAPM.ed.BSC4  W $$TITL^%ZAPM.ed.BSCGIS($G(BSipa)),$$B27^%ZAPM.ed.BSCm4()
 w "<BODY>"
 w "<form action="""_$$ADDLIB^%ZAPM.ed.BSC4()_""" method=""POST"">"
 S BSLABEL="IPA^~BSvdaSTAT"
 D
 .N BSipa D ADDBSPOST^%ZAPM.ed.BSC4reg
 N A,B,a,Noact S A=""
 i $g(BSipa)'="" S A=$$IPAC(BSipa)
 s a="Введите IP адрес, или Сетевое имя " w a
 W "<input type=textbox name=BSipa value='"_$g(BSipa)_"' title='"_a_"'><HR>"_BBK
 S B=A_" "_$S(A="":"(Не активно)",1:"(Активно)")
 W "Ответ сервера DNS : "_RED_$S(B="":"???",1:B)_EF_" "_$G(Noact)_BBK
 w "<HR><input type=submit name=sDUB value='Послать запрос к серверу DNS' title='DNS'>"_BK
 w "</form>"
 d END^%ZAPM.ed.BSC4
 Q
IP(IP) N TIT I "?"[IP Q "?"
 I $$Data^%ZAPM.ed.BSF12(BDip),$G(@BDip@(IP,"NAM"))'="" S TIT="TITLE='"_@$ZR_"'"
 Q "<B "_$G(TIT)_" class=U1 onclick='DNS("""_IP_""");' >"_IP_"</B>"
REC(P1,P2,P3,Arm) //ПАРАМЕТРЫ ЗАПИСИ
 N U,S,A,TU
 I P1'="" D
 .I $D(@BDUSE@(P1)) S TU=$G(@BDUSE@(P1,"FNM"))
 D
 .I P2[":IP" S P2=$P(P2,":IP=")_":IP="_$$IP($P($P(P2,":IP=",2)," "))_$P($P(P2,":IP=",2)," ",2,99)
 .I $E(P3,1,9)["Error" S A=$P(P3,"=")_"="_$$ErrTxt^%ZAPM.ed.BSCh0($P(P3,"=",2,9)) Q
 .I $E(P3,1,9)["Kill",P1'=$P($P(P2,":IP"),",",3) S A=MAROON_P3_EF Q
 .I $E(P3,1,9)["Upd" S S=RED_$P(P2," ")_EF_$P(P2," ",2,99),A=GREEN_P3_EF Q
 Q "<TD CLASS=S1 TITLE='"_$G(TU)_"'><A HREF='javascript:fu1(1,"""_I_""");'>"_$G(U,P1)_"</A></TD>"_"<TD CLASS=S"_$S($$REQU(CDAY,I):2,1:1)_">"_$G(S,P2)_"</TD>"_"<TD CLASS=S4>"_Arm_"</td><TD CLASS=S1><A HREF='javascript:fu1(3,"""_I_""");'>"_$G(A,P3)_"</a></TD>"
CDAYB //ВЫВЕСТИ ОДИН ДЕНЬ
 d mainvar 
 I $D(BMAIL) D ADMINMAIL^%ZAPM.ed.BSvdaMAIL Q
 I $D(BSCDAY) S CDAY=BSCDAY
 G CDAYER:$G(CDAY)="",CDAYER:'$$Data^%ZAPM.ed.BSF12($NA(@BDS@(CDAY)))
 S TITL=$ZU(110)_"-Отчет за "_$ZD(CDAY,3)
 D BEG1^%ZAPM.ed.BSC4  W $$TITL^%ZAPM.ed.BSCGIS(TITL),$$B27^%ZAPM.ed.BSCm4()
 W $$js^%ZAPM.ed.BSCp
 w "function DNS(IPA) {"_BK
 S BSLABEL="IPA^~BSvdaSTAT"
 w "window.open('"_$$ADDBSGET^%ZAPM.ed.BSC4_"&BSipa='+IPA,'viewIP',""toolbar=no,menubar=no,scrollbars=yes,width=400,height=400,status=1,resizable=1"");",BK
 W "}"_BK
 W $$jse^%ZAPM.ed.BSCp_BK
 W $$LR_"<TABLE WIDTH=100%>"_BK
 w "<TR><TD CLASS=S5>Время</TD><TD CLASS=S5>Пользователь</TD><TD CLASS=S5>Параметры (<B CLASS=S2>Критерии: "_$$PAR_EF_")</TD><TD CLASS=S5>Модуль</TD><TD CLASS=S5>Действие</TD></TR>"_BK      
 S I="" F  S I=$O(@BDS@(CDAY,I),-1) Q:I=""  w "<TR><TD CLASS=S4>"_$P(I,"..",1)_"</TD>"_$$REC($G(@BDS@(CDAY,I,"U")),$G(@BDS@(CDAY,I,"S")),$G(@BDS@(CDAY,I,"A")),$G(@BDS@(CDAY,I,"Arm")))_"</TR>"_BK
 W "</TABLE>"_BK
 d FUN,END^%ZAPM.ed.BSC4
 Q
PAR() N Q S Q="" I $D(BSchkU),$g(BSnewPR)'="*" S Q=Q_$g(BSnewPR)_", "
 I $D(BSchkI),$g(BSipF)'="*" S Q=Q_BSipF_", "
 I $D(BSchkN),$g(BSipFN)'="*" S Q=Q_BSipFN_", "
 I $D(BSapp) S Q=Q_BSapp_", "
 Q Q
LR1(D) N BSCDAY,BSLABEL I D="" Q "------"
 S BSCDAY=D,BSLABEL="CDAYB^~BSvdaSTAT"
 Q "<A TITLE='перейти на дату' HREF='"_$$ADDBSGET^%ZAPM.ed.BSC4_"'>"_$ZD(D,3)_" "_$$WEEK^%ZAPM.ed.BSCp(D)_"</A>"
LR() Q RED_"&lt;&lt;&lt;"_$$LR1($O(@BDS@(CDAY),-1))_" &lt;&lt;&lt;"_$ZD(CDAY,3)_" "_$$WEEK^%ZAPM.ed.BSCp(CDAY)_"&gt;&gt;&gt; "_$$LR1($O(@BDS@(CDAY)))_"&gt;&gt;&gt;"_EF
CDAYER W "Данных нет"_BBK 
 Q
CDAY //ВСЕ ДНИ ПОКАЗАТЬ
 W "<FIELDSET><LEGEND>Сервер "_$ZU(110)_". Мониторинг конкретного дня</LEGEND>"
 w "<form action="""_$$ADDLIB^%ZAPM.ed.BSC4()_""" method=POST name=frmCDAY target='Stat1'>"_BK
 S BSLABEL="CDAYB^~BSvdaSTAT"
 D ADDBSPOST^%ZAPM.ed.BSC4reg
 w "<select name=CDAY>"_BK
 S I="" F i=1:1:100  S I=$O(@BDS@(I),-1) Q:I=""  w "<option value="_I_" >"_$ZD(I,3)_"</option>"
 w "</select>"_BK 
 w "<input Type=submit value=Вывести name=BDAY TITLE='В новом окне протокол дня'>"
 s a=$$GETOPT^%ZAPM.ed.BSC4cfgP("^%ZAPM.ed.BSETUP(""ISS"")","Admin")
 I $ZCONVERT(BSLOGIN,"U")=$ZCONVERT($P($P(a,"@",1),"<",2),"U") D
 .W ", или <input Type=submit value='Смотреть ВСЮ почту Администратора ="_a_"' name=BMAIL  TITLE='...Ждите, Проверять будет все сервера'>"
 .W " <input Type=PASSWORD value='' name=BsMAILpass TITLE='Пароль нужен для удаленных серверов, и он должен быть везде одинаковый!'>"
 W "</FORM></FIELDSET>"
 Q
HOMEPAGE ;Главная страница
 d mainvar
 d BOF W $$B27^%ZAPM.ed.BSCm4()
 D CDAY
 D REPORT("HOMEPAGE","","")
 d EOF
 q
BEGYEAR() Q $P($ZD($H,3),"-")_"0101"
REPORT(BS4,Par1,Act1)
 W "<FIELDSET><LEGEND>Параметры вывода стастики</LEGEND>"
 w "<form action="""_$$ADDLIB^%ZAPM.ed.BSC4()_""" method=""POST"" name=""frmsmp"" TARGET='REPORT1'>",BK
 S BSLABEL="TEST1^~BSvdaSTAT"    
 D ADDBSPOST^%ZAPM.ed.BSC4reg
 D USERS
 S D1=$$BEGYEAR //НАЧАЛО ТЕКУЩЕГО ГОДА
 s D1=$G(@WAR@(CurUS,"OT"),D1)
 w "<H3>За период c <input type=""text"" size=7 name='DAY1' value='"_D1_"'>",BK
 S D2=$G(@WAR@(CurUS,"DO"),$E($ZD($H,3),1,4)_$E($ZD($H,3),6,7)_$E($ZD($H,3),9,10))
 s BSdateNum=1
 S BS1=BSG,BS2="111^~BSvdaSTAT"
 W $$B(D1,"Сменить","cal2","EDITDATE^~BSC4cal")
 w " по <input type=""text"" name=""DAY2"" size=7 value="""_D2_""">",BK
 s BSdateNum=2
 S BS1=BSG,BS2="222^~BSvdaSTAT"
 W $$B(D2,"Сменить","cal2","EDITDATE^~BSC4cal")
 w " , или</p>"
 w "<INPUT TYPE=""radio"" NAME=""radioName"" VALUE=chec0 >за текущий день"
 w "<INPUT TYPE=""radio"" NAME=""radioName"" VALUE=chec1 >за текущую неделю"
 w "<INPUT TYPE=""radio"" NAME=""radioName"" VALUE=chec2 CHECKED >за текущий месяц "
 w "<INPUT TYPE=""radio"" NAME=""radioName"" VALUE=chec3 >За текущий год","  </p>",BK
 w "</p>События: <select name=""BSapp"">",BK
 d GetListApp
 w "</select>",BK
 w "<input Type=""submit"" value=""Выполнить"" name=""execut""></p>",BK
 w "</H3></FORM></FIELDSET>",BK
 Q
GetListApp
    S I="*" w "<option "_$$Ss()_" value='"_I_"'> Все события</option>"_BK
    S I="Term*" w "<option "_$$Ss()_" value='"_I_"'> Терминальный вход/выход</option>"_BK
    S I="Error*" w "<option "_$$Ss()_" value='"_I_"'> Все ошибки</option>"_BK
    S I="Error Web*" w "<option "_$$Ss()_" value='"_I_"'> WebLink-ошибки</option>"_BK
    S I="ErrorTerm*" w "<option "_$$Ss()_" value='"_I_"'> Терминальные ошибки</option>"_BK
    S I="Change*" w "<option "_$$Ss()_" value='"_I_"'> Изменение параметров системы</option>"_BK
    S I="*Sess" w "<option "_$$Ss()_" value='"_I_"'> Манипуляция сессией</option>"_BK
    S I="Kill*" w "<option "_$$Ss()_" value='"_I_"'> Удаление узлов/таблиц</option>"_BK
    S I="Update*" w "<option "_$$Ss()_" value='"_I_"'> Повышение версии</option>"_BK
    q
 /*   .if I="B4Y" {w "<option value="""_I_""">",I," (Информационный портал)</option>",BK}
    .if I="CARDS" {w "<option value="""_I_""">",I,"  (Офицерская карточка)</option>",BK}
    .if I="ISS" {w "<option value="""_I_""">",I,"  (Информационно-справочная система)</option>",BK}
    .if I="KOMAN" {w "<option value="""_I_""">",I,"  (Командировки)</option>",BK}
    .if I="KVC" {w "<option value="""_I_""">",I,"  (Коды войсковых частей)</option>",BK}
    .if I="NAV" {w "<option value="""_I_""">",I,"  (Навигатор)</option>",BK}
    .if I="POTERY" {w "<option value="""_I_""">",I,"  (Потери)</option>",BK}
    .if I="VG" {w "<option value="""_I_""">",I,"   (Виртуальный главкомат)</option>",BK}
    .if (I'="ALLAPP")&(I'="B4Y")&(I'="CARDS")&(I'="ISS")&(I'="KOMAN")&(I'="KVC")&(I'="NAV")&(I'="POTERY")&(I'="VG") {w "<option value="""_I_""">",I,"   </option>",BK}
 q */              
Ss() I $G(Act1)="" Q ""
 I $E(I,1,2)="*S",$E(Act1,1,12)["Sess" G Sss
 I $E(I,1,2)="Er",I[$E(Act1,1,9) G Sss
 I $E(I,1,2)="Ch",$E(Act1,1,12)["Chang" G Sss
 I $E(I,1,2)="Te",$E(Act1,1,4)["Term" G Sss
 I $E(I,1,2)="Ki",$E(Act1,1,12)["Kill" G Sss
 I $E(I,1,2)="Up",$E(Act1,1,12)["Vers" G Sss
 Q ""
Sss Q "SELECTED"
on(BSLABEL,W,H) q " onclick='open("""_$$ADDBSGET^%ZAPM.ed.BSC4()_""","""_$G(Targ,"calend")_""",""toolbar=no,menubar=no,scrollbars=no,width="_$G(W,640)_",height="_$G(H,480)_",status=1,resizable=1"");' "
B(d,N,Targ,ROU) ;кнопка В НОВОМ ОКНЕ
 I d="" S d=$ZD($h,8)
 N BSLABEL,BSDATE,Q S BSLABEL=$G(ROU,"CALDATE^~BSC4cal"),BSDATE=d,Q=""
 S Q=Q_"<BUTTON name='Calendar2' "_$$on(BSLABEL,300,350)_" ><IMG src='"_BSDOMAIN_"/img/cal.gif' alt='"_$G(N,""_$$LNG^%ZAPM.ed.BSC4("календарь",156)_"")_"'></BUTTON>"
 Q Q
2(m) i $l(m)=1 q "0"_m
 e  q ""_m
RETURN ;ВОЗВРАТ ПОСЛЕ КАЛЕНДАРЯ
 n a,z
 ;W "<PRE>" W  W "</PRE>"
 i $g(BSdateNum)=1 s z="OT"
 e  s z="DO"
 I $D(Today) S a=$E($ZD($H,3),1,4)_$E($ZD($H,3),6,7)_$E($ZD($H,3),9,10)
 E  s a=tbSelYear_$$2(tbSelMonth)_$$2(calSelectedDate)
 s @WAR@(CurUS,z)=a
 s ^a=a
 G HOMEPAGE
111      d mainvar
 N D S D=$$RETURN^%ZAPM.ed.BSC4cal
 S @WAR@(CurUS,"OT")=D
 D JS^%ZAPM.ed.BSCp
 S BSLABEL=$G(BS4,"HOMEPAGE")_"^~BSvdaSTAT" 
 I D'="" W "open("""_$$ADDBSGET^%ZAPM.ed.BSC4()_""","""_$G(BS4,"HOMEPAGE")_""",""toolbar=yes,menubar=no,scrollbars=yes,width=800,height=600,status=1,resizable=1"");"_BK
 W "window.close();"_BK
 D JSE^%ZAPM.ed.BSCp
 Q
222      d mainvar
 N D S D=$$RETURN^%ZAPM.ed.BSC4cal
 S @WAR@(CurUS,"DO")=D
 D JS^%ZAPM.ed.BSCp
 S BSLABEL=$G(BS4,"HOMEPAGE")_"^~BSvdaSTAT" 
 I D'="" W "open("""_$$ADDBSGET^%ZAPM.ed.BSC4()_""","""_$G(BS4,"HOMEPAGE")_""",""toolbar=yes,menubar=no,scrollbars=yes,width=800,height=600,status=1,resizable=1"");"_BK
 W "window.close();"_BK
 D JSE^%ZAPM.ed.BSCp
 Q
 
TEST1    //НОВЫЙ ОТЧЕТ
 d mainvar
 if $G(radioName)="chec0"  s (DAY1,DAY2)=$ZD($H) S DC1=$ZDATEH(DAY1),DC2=$ZDATEH(DAY2)
 if $G(radioName)="chec1"  s DAY2=$ZD($H),DC2=$ZDATEH(DAY2) s DC1=DC2-7,DAY1=$ZD(DC1)
 if $G(radioName)="chec2"  s DAY2=$ZD($H),DC2=$ZDATEH(DAY2) s DC1=DC2-30,DAY1=$ZD(DC1)
 if $G(radioName)="chec3"  s DAY2=$ZD($H),DC2=$ZDATEH(DAY2) s DAY1=$$DATEUSA($$BEGYEAR),DC1=$ZDATEH(DAY1)
 
 I '$D(DC1) S DC2=$ZDATEH($E(DAY2,5,6)_"/"_$E(DAY2,7,8)_"/"_$E(DAY2,1,4)),DC1=$ZDATEH($$DATEUSA(DAY1))
 
 S TITL="Пользователь '"_$g(BSnewPR)_"' с "_$ZD(DC1,2," Января Февраля Марта Апреля Мая Июня Июля Августа Сентября Октября Ноября Декабря")_" по "_$ZD(DC2,2," Января Февраля Марта Апреля Мая Июня Июля Августа Сентября Октября Ноября Декабря")_" года"
 D BEG1^%ZAPM.ed.BSC4  W $$TITL^%ZAPM.ed.BSCGIS(TITL),$$B27^%ZAPM.ed.BSCm4()
    W "<table border=0 WIDTH=100%><tr>"
    w "<td CLASS=S5 WIDTH=10%><p align=center><B>Дата</B></p></TD>"
    w "<td CLASS=S2 WIDTH=5%><b>Событий "_RED_BSapp_EF_"</b></td>"
    w "<td CLASS=S5><p align=center><b>ДИАГРАММА </b></p></td></tr>"
  S Max=0 f CD=DC2:-1:DC1 S Req=$$REQ(CD) I Req>Max S Max=Req
  f CD=DC2:-1:DC1 D WCDAY(CD)
    w "</table>"
 d END^%ZAPM.ed.BSC4
 Q
WCDAY(CD) //ВЫВЕСТИ ТЕКУЩИЙ ДЕНЬ
 N A,R S A=$S("67"[$$WEEKEND^%ZAPM.ed.BSsFUNR(0,CD):"S3",1:"S1")
    w "<TR><td CLASS="_A_"><p align=center><B>"_$ZD(CD,3)_"</B></p></TD>"
    S RR="",R=$$REQ(CD) I R S BSLABEL="CDAYB^~BSvdaSTAT",BSCDAY=CD S RR="<b><A HREF='"_$$ADDBSGET^%ZAPM.ed.BSC4()_"' target='Stat2'>"_$$REQ(CD)_"</A></b>"
    w "<td CLASS=S3>"_RR_"</td>"
    w "<td CLASS="_A_">"_$$DIAG()_"</td></tr>"
 Q
DATEUSA(DAY1) Q $E(DAY1,5,6)_"/"_$E(DAY1,7,8)_"/"_$E(DAY1,1,4)
REQ(H) S Req=0 I '$D(@BDS@(H)) Q Req
 S T="" F  S T=$O(@BDS@(H,T)) Q:T=""  S Req=Req+$$REQU(H,T)
 Q Req
REQU(H,T)        I $D(BSchkU),$g(BSnewPR)'="*",$G(@BDS@(H,T,"U"))'=$g(BSnewPR) Q 0
 I $D(BSchkI),$g(BSipF)'="*",$G(@BDS@(H,T,"S"))'[BSipF Q 0
 I $D(BSchkN),$g(BSipFN)'="*",$G(@BDS@(H,T,"S"))'[BSipFN Q 0
 I '$D(BSapp) Q 1
 I BSapp="*" Q 1
 I $E(BSapp,1,2)="*S",$E($G(@BDS@(H,T,"A")),1,12)["Sess" Q 1
 I $G(@BDS@(H,T,"A"))="" Q 0
 I ("@"_$G(@BDS@(H,T,"A")))'[("@"_$P(BSapp,"*")) Q 0
REQ1 Q 1
 
DIAG() N D s nachRED=$ZHEX("11"),nachGREEN=$ZHEX("ee"),D="",step=3 //???????
 I Req>100 S Req=100
 f a=1:1:Req d
  .S D=D_"<font style=background:#"_$ZHEX(nachRED)_$ZHEX(nachGREEN)_"00>&nbsp</font>"
  .s nachRED=(nachRED+step)
  .s nachGREEN=(nachGREEN-step)    
 Q D
 
PROK //ПРОКАЧКА
  D mainvar
  S II="" F  S II=$O(@BDS@(II)) Q:II=""  S I="" F  S I=$O(@BDS@(II,I)) Q:I=""  D
  .I I'[":" M @BDS@(II,$ZT($P(I,".."),1)_".."_$P(I,"..",2))=@BDS@(II,I) K @BDS@(II,I) W "."
 Q
]]></Routine>


<Routine name="%ZAPM.ed.a" type="MAC" languagemode="0"><![CDATA[
a ;agregation
 /*
  d Exports^%ZAPM.ed.a("d:\_proj\_zapp\zpm-addition+\zapm-")
 	if $p(cmd," ")="edn" do ns^%ZAPM.ed.a quit $$$OK
	if $p(cmd," ")="edg" do ^%ZAPM.ed.BSMSMG($p(cmd," ",2)) quit $$$OK
	if $p(cmd," ")="edr" do ^%ZAPM.ed.BSXprog($p(cmd," ",2)) quit $$$OK
	if $p(cmd," ")="edf" ;;;do ^%ZAPM.ed.BSX($p(cmd," ",2)) quit $$$OK ;file system
 */
 // d ns^%ZAPM.ed.a
nszpm  ;Navigator for namespace and zpm modules
 do resizeTerm
 new
 set $ztrap="error"
 D CLr^%ZAPM.ed.BSF4,CCC^%ZAPM.ed.BSC
 S %BS(12)="m",%BS(39)="NAV"
 S NSPL=$$NS^%ZAPM.ed.BSCp()  //get list namespace
 I NSPL=""  D ErrMsg^%ZAPM.ed.BSXfun("No namespaces available !") G exit
 Set BSR="^%ZAPM.ed.BSbufB",
 	BST="NameSpace"_$G(%BS(3),$P)_$J_"u"_%BS(15)
 Kill @BSR@(BST)
 merge @BSR@(BST)=^%ZAPM.ed.BSS("ALINS")
 S $P(@BSR@(BST,1,1),"@",15)=" ZPM modules in "_$ZU(110),
   $P(@BSR@(BST,1,2),"@",15)=$ZV,
   $P(@BSR@(BST,2,1),"@",15)=" ..",
   $P(@BSR@(BST,2,2),"@",15)=" ...Exit - <Esc>"
 ;S $P(@BSR@(BST),"@",12)=2  // status info 2=full,1,""
 S $P(@BSR@(BST),"@",15)=0,  // off F-keys 
   $P(@BSR@(BST),"@",19)="2,2", //freeze colomn and rows table
   $P(@BSR@(BST),"@",16)=1  // blocked F-keys
 ;S $P(@BSR@(BST),"@",41)="FKEY^%ZAPM.ed.BSC"  
 ;S $P(@BSR@(BST),"@",39)="^%ZAPM.ed.BSC,ZHELP1" //help text
 
 Set currentns=$Namespace
 Do ##class(%ZPM.PackageManager).GetListNamespace(.namespace)
 Set ns="",num=0
	For { set ns=$Order(namespace(ns)) Quit:ns=""
		Set $Namespace=ns
		Kill list
		set name=""
		Do ##class(%ZPM.PackageManager).GetListModules("",.list)
		If $D(list) {
			Set module="",write=0
			For { set module=$Order(list(module)) Quit:module=""
				I $i(tab)
				if name'=ns set tab(tab,1)=ns, name=ns
				else  set tab(tab,1)=""
				set tab(tab,1,0)=$lb(ns,module,list(module))
				set tab(tab,2)=module_" "_$LG(list(module),1)_" "_$Listget(list(module),2)
				set tab(tab,2,0)=$lb(ns,module,list(module))
				}
			} Else {
				if $i(tab)
				set tab(tab,1)=ns
				set tab(tab,2)=""
				set tab(tab,1,0)=$lb(ns)
				set tab(tab,2,0)=$lb(ns)
			}
		}
  do InsertTab(BSR,BST,.tab,2,0)
  ;D TAB^%ZAPM.ed.BSF1
  ;D Table^%ZAPM.ed.BSN(BSR,BST)   ;возвращает  YES, где      YES=1@2@3@4@5@6@7@8@9    - статус выхода из таблицы          
                ; 1=Y,X - номер клетки                                         
                ; 7 - координата клетки по строке                              
                ; 8 - координата клетки по колонке                             
                ; 4,5,6 - скан коды                                            
                ; 9 - данные лежащие в этой клетке   
 D TAB^%ZAPM.ed.BSF1 d ^%ZAPM.ed.BST 
ns1 ;set R1=$P(YES,"@",4),R2=$P(YES,"@",5),R3=$P(YES,"@",6)
 ;set ny=$P(YES,"@",7)
 I R1=27,R2=-1 G exit
 I ny=2 G exit
 I $G(R1)=13,$G(R2)=-1 D mode(@BSR@(BST,ny,nx)) d STA^%ZAPM.ed.BST  G ns1
 Q
InsertTab(p,t,tab,fromY,fromX=0,template="2,2") 
  new ny,nx,y,x,xx,yy,temp
  ;zw tab r r
  ;set ny=$p(@p@(t),"@",28),  	nx=$p(@p@(t),"@",29)
  set temp=$GET(@p@(t,$p(template,","),$p(template,",",2)))
  set y=""
  for { set y=$o(tab(y)) quit:y=""
  	set yy=fromY+y
  	set x=""
  	for { set x=$o(tab(y,x),1,data) quit:x=""
  		set xx=fromX+x
  		set @p@(t,yy,xx)=@p@(t,fromY,x)
  		set $p(@p@(t,yy,xx),"@",15)=data
  		set $p(@p@(t,yy,xx),"@",42)=$G(tab(y,x,0)) ;7
  	}
  }
  	
 quit
mode(cell) ;List zpm modules
	set list=$p(cell,"@",42)
 	set NAMESP=$lg(list,1)
 	zn NAMESP
 new BSR,BST
 S BSR="^%ZAPM.ed.BSbufB",
 	BST="GlobaList"_$G(%BS(3),$P)_$J_"u"_%BS(15) 
 D CCC^%ZAPM.ed.BSC
 merge @BSR@(BST)=^%ZAPM.ed.BSS("ALINS")
 if '$d(Moduls(NAMESP)) do ##class(%ZAPM.ext.zpm).GetListModule(,.Mod,0) merge Moduls(NAMESP)=Mod
 if $lg(list,3)'="" {
	 set module=$lg(list,2)
	 set ver=$lg($lg(list,3),1)
	 set desc=$lg($lg(list,3),2)
 }
 else {
 	 set module=""
	 set ver=""
	 set desc=""
 }
 d AddDataCell(1," "_NAMESP_" "_$g(module)_" "_$g(ver)," "_$g(desc))
 d AddDataCell(2," Routine Editor"," ...")
 d CloneRow(3,2)
 d AddDataCell(3," Global Editor"," ...")

 if module'="" {
	 set root=$lg($g(Moduls(NAMESP,module,"L")),3)
	 d CloneRow(4,2)
	 d AddDataCell(4," Module Root",root)
	 if root'="" {
		 set num=4
		 kill DirList
		 d GetList^%ZAPM.ed.a(root,"*.*",.DirList)
		 set dir=""
		 for { set dir=$o(DirList(dir)) quit:dir=""
		 	if $g(DirList(dir,"Type"))'="D" {
			 set file=$g(DirList(dir,"ItemName"))
			 set filename=$g(DirList(dir,"Name"))
			 ;set ext=""
			 ;if file[".",$e(file,1)'="." set ext=$p(file,".",*)
			 ;if $lf($lb("xml","","md","sh"),ext) continue
			 set num=num+1
			 d CloneRow(num,2)
			 d AddDataCell(num,"",file)
			 d AddDataCellInfo42(num,2,$lb(filename))
		 	}
		 }
	 }
 }
 else {
	 d RemoveRow(4)
 }
 ;S $P(@BSR@(BST),"@",15)="INTGLO^%ZAPM.ed.BSC",  //spezific F-keys
  set $P(@BSR@(BST),"@",19)="2,2",  
   	$P(@BSR@(BST),"@",16)=1
 S $P(@BSR@(BST),"@",15)=0
 ;S $P(@BSR@(BST),"@",41)="FKEYPART^%ZAPM.ed.BSC"
 ;S $P(@BSR@(BST),"@",39)="^%ZAPM.ed.BSC,ZHELP2"
 D TAB^%ZAPM.ed.BSF1,^%ZAPM.ed.BST 
mode2 I R1=27,R2=-1 Q  //exit - esc
 I ny=2 d rou(@BSR@(BST,ny,nx))  d STA^%ZAPM.ed.BST  G mode2
 I ny=3 d glo(@BSR@(BST,ny,nx))  d STA^%ZAPM.ed.BST  G mode2
 I ny=4 D OkMsg^%ZAPM.ed.BSXfun("Not release yet")  d STA^%ZAPM.ed.BST  G mode2
 set filename=$lg($p(@BSR@(BST,ny,2),"@",42),1)
 if filename'="" do viewfile(filename) d STA^%ZAPM.ed.BST  G mode2
  g mode2
CloneRow(ny,from)
 set @BSR@(BST,ny,1)=@BSR@(BST,from,1)
 set @BSR@(BST,ny,2)=@BSR@(BST,from,2)
 q
AddDataCell(ny,d1="",d2="")
 S $P(@BSR@(BST,ny,1),"@",15)=d1
 set $P(@BSR@(BST,ny,2),"@",15)=d2
 q
AddDataCellInfo42(ny,nx,list)
 set $P(@BSR@(BST,ny,nx),"@",42)=list
 quit
RemoveRow(ny)
 new i
 for i=ny:1 quit:'$d(@BSR@(BST,i))  KILL @BSR@(BST,i)
 quit
error D ErrMsg^%ZAPM.ed.BSXfun($ze) O 0:(:) quit
exit O 0:(:) write # 
 quit
viewfile(file) new (file)
 D DOSTXT^%ZAPM.ed.BSDOS2(file)
 quit
rou(data)
 do ^%ZAPM.ed.BSXprog
 quit
glo(data)
 do ^%ZAPM.ed.BSMSMG()
 quit
 /// Get all files in a directory without subdirectories
 /// d GetList^%ZAPM.ed.a("D:\!\","*.*",.List)
GetList(directory, ext = "*.*", list)
	set:ext="*.*" ext=$s($zversion(1)=3:"*",1:"*.*")
	set st = 1
	try {
		set directory = ##class(%File).NormalizeDirectory(directory)
		set rs = ##class(%ResultSet).%New("%File:FileSet")
		s sc=rs.Execute(directory, ext)
		while (rs.Next()) {
			set fName = rs.Get("Name")
			m list(fName)=rs.Data
		}
	} catch ex {
		set st = ex.AsStatus()
	}
 quit st

getYXterminal()
 ;stty -a
 ;speed 38400 baud; rows 57; columns 193; line = 0;
 quit
 
resizeTerm(y=25,x=80)
 w $c(27),"[8;"_y_";"_x_";t"
 quit


 // for  do $$r^%ZAPM.ed.BSC(999) if R1=13 quit
r(R) O 0:(:"IS")
 R *R1:R,*R2:0,*R3:0,*R4:0,*R5:0 
 w !,"==="_R1_" "_R2_" "_R3_" "_R4_" "_R5,!
 q 1
 ///z 
 /*
 Вход в таблицу по ^NEW  S IYI="^PART(TAB" D NE^%ZAPM.ed.BSN         см 1.  
   c сохранением видео -    или                                             
    картинки               D Table^%ZAPM.ed.BSN(BSR,BST)   возвращает  YES, гд
                 YES=1@2@3@4@5@6@7@8@9    - статус выхода из таблицы          
                 1=Y,X - номер клетки                                         
                 7 - координата клетки по строке                              
                 8 - координата клетки по колонке                             
                 4,5,6 - скан коды                                            
                 9 - данные лежащие в этой клетке      

   Вход в таблицу  без      S BSR="^PART",BST="TAB"             см 1.         
   сохpанения видео         D ENTER^%ZAPM.ed.BSN                              
                                                                              
   Вывод сообщений об       S ls="ТЕКСТ ОШИБКИ" D O^%ZAPM.ed.BSF7  или        
   ошибке                   D ErrMsg^%ZAPM.ed.BSXfun("ТЕКСТ ОШИБКИ")          
                                                                              
   Вывод простого сообщения D OkMsg^%ZAPM.ed.BSXfun("ТЕКСТ")                  
                                                                              
   Меню  ДА/НЕТ             S ls="ВЫ УВЕРЕНЫ ?" D YES^%ZAPM.ed.BSF"      YES=1
                                                                              
   Сообщение о действии     S ls="ТЕКСТ" D WAITS^%ZAPM.ed.BSF2          X WA-с
                            D Wait^%ZAPM.ed.BSXfun("ТЕКСТ")                   
                                                                              
   Сообщение "ЖДИТЕ..."     WAIT^%ZAPM.ed.BSF2           
  Строковый редактор  S ls="Text"                                             
                       S li="строка"                        li-результат      
                       S ll="запрещенные символы"            YES=0 отмена     
                       D LE^%ZAPM.ed.BSS                                      
                              или                                             
                       S li=$$LineEdit^%ZAPM.ed.BSXfun("СТРОКА","ТЕКСТ")      
                                                                          
                                                                              
ВХОД В РЕДАКТОР ГЛОБАЛИ   D ^%ZAPM.ed.BSMSMG("^A(1,2,3)")                     
          ИЛИ ЛОКАЛИ      D ^%ZAPM.ed.BSMSMG("XXX")         
                  ER D ErrMsg^%ZAPM.ed.BSXfun($ZE_" "_$$ErrSay^%ZAPM.ed.BSF8($>

 D DOSTXT^%ZAPM.ed.BSDOS2("D:\InterSystems\IRIS\mgr\.modules\ZPMSHOW\zpmshow\1.0.2\README.md")

 */
 /// do FOR^%ZAPM.ed.BSCp - клавиши
 /// D INIT^%ZAPM.ed.BSChW ;ИНИЦИАЛИЗАЦИЯ КОМПЛЕКСА
 /// do ^%ZAPM.ed.BSC - Навигация по областям и глобалям
 /// do ^%ZAPM.ed.BSMSMG("^A(1,2,3)")	- Редактор глобалов
 /// ИЛИ ЛОКАЛИ      D ^%ZAPM.ed.BSMSMG("XXX")
 /// do ^%ZAPM.ed.BSXprog - Редактор программ
 /// do ErrMsg^%ZAPM.ed.BSXfun("Message - !!"_$ZE) - вывод текста об ошибке
 /// F  D READM^%ZAPM.ed.BSre W !
 ///
 /// d Exports^%ZAPM.ed.BSC("d:\_proj\_zapp\zpm-addition+\zapm-")
 ///
 /// d Exp2016^%ZAPM.ed.BSC("d:\_proj\_zapm\ENS2016\")
 /// 
Exp2016(dir) // 
	set slash=$select($zversion(1)=3:"/",1:"\")
	s ed="editor"
	k list
	set dirpath=dir_"src"_slash_"xml"_slash
	s list("%ZAPM.ed.*.GBL")=""
	do $system.OBJ.Export(.list,dirpath_"_ZAPM.ed.gbl.xml","d",.err) 
	k list
	s list("%ZAPM.ed.*.MAC")=""
	do $system.OBJ.Export(.list,dirpath_"_ZAPM.ed.mac.xml","d",.err) 
	k list
	s list("%ZAPM.*.INC")=""
	do $system.OBJ.Export(.list,dirpath_"_ZAPM.ed.inc.xml","d",.err) 
 q
Exports(dir) // do Exports^%ZAPM.ed.a("d:\_proj\_zapp\zpm-addition+\zapm-")
	set slash=$select($zversion(1)=3:"/",1:"\")
	s ed="editor"
	do Exp(dir_ed_slash,,,"BSpg")
	;for d="globals,MSM","routine,BSXpr","text,BSX","table,BST" {
	;	s di=$p(d,",")
	;	s mask=$p(d,",",2)
	;	do Exp(dir_di_"-"_ed_slash,mask,0)
	;}
	;do Exp(dir_"tkweb"_slash,"pgWEB","pgWEB")
	;do Exp(dir_"tkimail"_slash,"pgWEM","pgWEM")
 q
Exp(dir,mask="",glomask="",isk="") ;d Exp^%ZAPM.ed.a("d:\_proj\_zapp\zpm-addition+\zapm-editor\")
	new $namespace
	set $namespace="%SYS"
	set slash=$select($zversion(1)=3:"/",1:"\")
	set dirpath=dir_"src"_slash_"mac"_slash_"_ZAPM"_slash_"ed"_slash
	s st=##class(%File).CreateDirectoryChain(dirpath)
	i 'st w !,st q
 	do ##class(%File).RemoveDirectoryTree(dirpath)
	;Rou
	set r=""
	for { set r=$O(^ROUTINE(r)) q:r=""  continue:r'["%ZAPM.ed."
		if mask'="",r'[mask continue 
		if isk'="",r[isk  continue
		set file=$tr(r,"%","_")_".mac"
		Set st = $System.OBJ.ExportUDL(r_".mac",dirpath_file,"-d")
		s rou(r_".mac")=""
		if 'st w !,st q
		else  w !,file
	}
	;Glo
	if 0,glomask'=0 {
		kill gl
		set dirpath=dir_"src"_slash_"gbl"_slash
		d GetGlobalDir^%ZAPM.ed.BSCp($namespace,.gl)
		s i=""
		for { s i=$o(gl(i)) q:i=""  continue:i'["%ZAPM.ed."
			if glomask'="",i'[glomask continue
			k list
			s list(i_".GBL")=""
			do $system.OBJ.Export(.list,dirpath_"_"_$e(i,2,*)_".xml","d",.err) 
		}
	}
	k list
	set dirpath=dir_"src"_slash_"gbl"_slash
	s list("%ZAPM.ed.BS.GBL")=""
	s list("%ZAPM.ed.BSC*.GBL")=""
	s list("%ZAPM.ed.BSD*.GBL")=""
	s list("%ZAPM.ed.BSE*.GBL")=""
	s list("%ZAPM.ed.BSG*.GBL")=""
	s list("%ZAPM.ed.BSH*.GBL")=""
	s list("%ZAPM.ed.BSR*.GBL")=""
	s list("%ZAPM.ed.BSS*.GBL")=""
	s list("%ZAPM.ed.BSV*.GBL")=""
	s list("%ZAPM.ed.BSX*.GBL")=""
	do $system.OBJ.Export(.list,dirpath_"_ZAPM.ed.xml","d",.err) 
	set dirpath=dir_"ed"_slash
	do $system.OBJ.Export(.list,dirpath_"_ZAPM.ed.gbl.xml","d",.err) 	

	set dirpath=dir_"ed"_slash
	do $system.OBJ.Export(.rou,dirpath_"_ZAPM.ed.mac.xml","d",.err) 
	zw err
	m list=rou
	do $system.OBJ.Export(.list,dirpath_"_ZAPM.ed.all.xml","d",.err) 
	zw err
 q
 // xec do DrawText^%ZAPM.ed.a("^%ZAPM.ed.BSHLP(""CtructG"")") ;документация по структкре таблицы
 // xec do DrawText^%ZAPM.ed.a("^%ZAPM.ed.BSHLP(""D"")") ;вся документация
DrawText(gn)
 w !,"<pre>"
  set g=gn
  set head=""
  for { set g=$q(@g) quit:g=""
  	quit:$qs(g,1)'[$qs(gn,1)
   	if head'=$qs(g,1) set head=$qs(g,1) write !,"<font color=red>"_@g_"</font>"
   	write !,@g ;,$c(13,10)
  }
 write !,"</pre>"
 quit
]]></Routine>


<Global>
<Node><Sub>^%ZAPM.ed.BSC</Sub>
<Data>BaSe MsW @%BS-СИСТЕМНЫЙ РАЗДЕЛ (Cache&apos; Options)@@</Data>
<Node><Sub>BSG</Sub>
<Data>ПРОГРАММНЫЕ ССЫЛКИ ДЛЯ WEBLINK@@@@@1@1@1@1@22@80@1@@1@1@@2@@2,2@1@@@@@1@@@6@2@@2;6;30;43@@@@@@</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@2@30@@@@@1@@@@@@БАЗА ДАННЫХ ПРИЛОЖЕНИЙ WEBLINK</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@31@2@49@@@@0@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@30@@@@@1@@@@@@                  КОМЕНТАРИЙ@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@31@1@49@@@@@2@2;6;30;42@@@@@@@@REM</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>4@1@1@30@@@@@1@@@@@@             МЕТКА ПРОГРАММЫ@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>4@31@1@49@@@@@2@2;6;30;42@@@@@@@@ROU</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>5@1@1@30@@@@@1@@@@@@                   NAMESPACE@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>5@31@1@49@@@@@2@2;6;30;42@@@@@@@@NSP</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>6@1@1@30@@@@@1@@@@@@    TIMEOUT (секуд) DFLT=120@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>6@31@1@49@@@@@2@2;6;30;42@@@@@@@@MGWSTO</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>7@1@1@30@@@@@1@@@@@@           ВКЛЮЧИТЬ ОТЛАДЧИК@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>7@31@1@49@@@@@2@2;6;30;42@@@@@@@@BSdebug</Data>
</Node>
</Node>
<Node><Sub>Compile</Sub>
<Data>OK 11:54:49 2006-06-15</Data>
</Node>
<Node><Sub>FTR</Sub>
<Node><Sub>1</Sub>
<Node><Sub>2</Sub>
<Data>S d1=&quot;  &quot;_$G(k1,&quot;?&quot;)</Data>
<Node><Sub>1</Sub>
<Data>&quot;  &quot;_$G(k1,&quot;?&quot;)</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>Free</Sub>
<Data>65532,34595</Data>
</Node>
<Node><Sub>KEY</Sub>
<Data>^[&quot;%SYS&quot;,&quot;&quot;]%BScARM</Data>
<Node><Sub>1</Sub>
<Data>@@@@НОВОЕ ИМЯ@1,70@@@ 1-Й ИНДЕКСНЫЙ@2;6;30;42@@@@@Введите ИМЯ ССЫЛКИ@@@@@</Data>
<Node><Sub>3</Sub>
<Data><![CDATA[S d1=$TR($$JF^%ZAPM.ed.BSC4r4($G(d0),15)," ",".")_$S(d0'=0:$$A^%ZAPM.ed.BSA(2,2,"BSG","%BSC","%SYS","","",$G(d0)),1:"?")]]></Data>
</Node>
<Node><Sub>4</Sub>
<Data>$TR($$JF^%ZAPM.ed.BSC4r4($G(d0),15),&quot; &quot;,&quot;.&quot;)_$S(d0&apos;=0:{2,2,&quot;BSG&quot;,&quot;%BSC&quot;,&quot;%SYS&quot;,&quot;&quot;,&quot;&quot;,$G(d0)},1:&quot;?&quot;)</Data>
</Node>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>65532,34595,m</Data>
</Node>
<Node><Sub>STA</Sub>
<Data>5,2@2@2@13@-1@-1@6@31@</Data>
</Node>
</Node>
<Node><Sub>BSQLDSN</Sub>
<Data>Data sourse name@@@@@1@1@1@1@22@80@1@@1@@@2@@2,2@1@@@@@1@@@2@2@@@@@@@@@@</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@2@20@@@@@1@2;6;35;42@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@21@2@53@@@@0@1@2;6;35;42@@@@@@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>3@1@2@20@@@@@1@2;6;35;42@@@@@ЗАПРОС</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@21@2@53@@@@@2@1;6;33;43@@@@@@@@SQL1@</Data>
</Node>
</Node>
<Node><Sub>Compile</Sub>
<Data>OK 11:54:49 2006-06-15</Data>
</Node>
<Node><Sub>FTR</Sub>
<Node><Sub>1</Sub>
<Node><Sub>2</Sub>
<Data>S d1=&quot; DSN: &quot;_$G(k1,&quot;?&quot;)</Data>
<Node><Sub>1</Sub>
<Data>&quot; DSN: &quot;_$G(k1,&quot;?&quot;)</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>Free</Sub>
<Data>58749,53652</Data>
</Node>
<Node><Sub>KEY</Sub>
<Data>^[&quot;%SYS&quot;]%BScDSN</Data>
<Node><Sub>1</Sub>
<Data>@@@@DSN@1,70@@@ 1-Й ИНДЕКСНЫЙ@2;6;30;42@@@@@Введите DSN@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>@@@@SQL@1,79@@@ 2-Й ИНДЕКСНЫЙ@2;6;37;44@@@@@ЭТО ЭСКЮЭЛ@@@@@</Data>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>60431,42889,</Data>
</Node>
<Node><Sub>STA</Sub>
<Data>2,2@2@2@27@-1@-1@3@21@</Data>
</Node>
</Node>
<Node><Sub>BSWEBLINK</Sub>
<Data><![CDATA[Описание Свойств и Методов(BS-Portal + WebLink TP)@@@@@@@1@1@22@80@@@@1@@5@@@1@@@ 1@@@@@26@@@1;6;37;44//1;6;36;40@@@@@@@1]]></Data>
<Node><Sub>1</Sub>
<Data>========================   РАБОТА С ПОРТАЛОМ   ===========================</Data>
</Node>
<Node><Sub>2</Sub>
<Data></Data>
</Node>
<Node><Sub>3</Sub>
<Data>$$GetAcc^%ZAPM.ed.BSC4cfgP(BSLOGIN,&quot;SVV0A&quot;)  - ПРАВА ДОСТУПА BSLOGIN</Data>
</Node>
<Node><Sub>4</Sub>
<Data>                                       К РЕСУРСУ &quot;SVV0A&quot;</Data>
</Node>
<Node><Sub>5</Sub>
<Data></Data>
</Node>
<Node><Sub>6</Sub>
<Data>ФОРМИРОВАНЕ НОВЫХ АКТИВНЫХ ССЫЛОК</Data>
</Node>
<Node><Sub>7</Sub>
<Data></Data>
</Node>
<Node><Sub>8</Sub>
<Data> S BSLABEL=&quot;METKA123^%ZAPM.ed.BSROUT123&quot;</Data>
</Node>
<Node><Sub>9</Sub>
<Data><![CDATA[ W "<A href='"_$$ADDBSGET^%ZAPM.ed.BSC4()_"' target='ZAK'>!!!ЗАКАЧКА ОБНОВЛЕННЫХ КЛАССИФИКАТОРОВ'</A>"]]></Data>
</Node>
<Node><Sub>10</Sub>
<Data></Data>
</Node>
<Node><Sub>11</Sub>
<Data> W </Data>
</Node>
<Node><Sub>12</Sub>
<Data></Data>
</Node>
<Node><Sub>13</Sub>
<Data></Data>
</Node>
<Node><Sub>14</Sub>
<Data></Data>
</Node>
<Node><Sub>15</Sub>
<Data></Data>
</Node>
<Node><Sub>16</Sub>
<Data></Data>
</Node>
<Node><Sub>17</Sub>
<Data></Data>
</Node>
<Node><Sub>18</Sub>
<Data></Data>
</Node>
<Node><Sub>19</Sub>
<Data></Data>
</Node>
<Node><Sub>20</Sub>
<Data></Data>
</Node>
<Node><Sub>21</Sub>
<Data></Data>
</Node>
<Node><Sub>22</Sub>
<Data></Data>
</Node>
<Node><Sub>23</Sub>
<Data></Data>
</Node>
<Node><Sub>24</Sub>
<Data></Data>
</Node>
<Node><Sub>25</Sub>
<Data></Data>
</Node>
<Node><Sub>26</Sub>
<Data></Data>
</Node>
</Node>
<Node><Sub>CODES</Sub>
<Data>КОДЫ@@@@@1@1@1@1@22@80@1@@1@1@@6@@1,2@1@@@@@1@@@3@2@@@@@@@@</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@40@@@@@1@@@@@@РАЗДЕЛ (пример:^[&quot;GLAVK&quot;]ABC)</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@41@1@35@@@@@1@@@@@@^[&quot;GLAVK&quot;]SRV@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@40@@@@@1@@@@@@ТАБЛИЦА (пример:TABLE)@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>2@41@1@35@@@@@1@@@@@@TT@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@40@@@@@1@2;6;30;43@@@@@!!!! ЗАГРУЖАТЬ БЕЗ ВОПРОСА О ЗАГРУЗКЕ @</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@41@1@35@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>58227,43745,MS</Data>
</Node>
<Node><Sub>STA</Sub>
<Data>2,2@1@2@13@-1@-1@2@41@TT</Data>
</Node>
</Node>
<Node><Sub>FUN</Sub>
<Data><![CDATA[Cache'-ОПИСАНИЕ ФУНКЦИЙ И МОДУЛЕЙ@@@@@@@1@1@22@80@@@@1@@5@@@1@@@ 1@@@@@91@@@1;6;37;44//1;6;36;40@@@@@@@1]]></Data>
<Node><Sub>1</Sub>
<Data>$$MZ^%ZAPM.ed.BSTABE2(d) - СПЕЦИАЛЬНАЯ ФУНКЦИЯ ТРАНСФОРМАЦИИ ПЕРЕКЛЮЧЕНИЯ С СЕКРЕТНОЙ</Data>
</Node>
<Node><Sub>2</Sub>
<Data>                   БОКОВИНЫ НА &quot;НЕ СЕКРЕТНУЮ&quot; ПО КЛАВИШЕ &quot;~&quot;      </Data>
</Node>
<Node><Sub>3</Sub>
<Data>------------------------------------------------------------------------------</Data>
</Node>
<Node><Sub>4</Sub>
<Data>Загрузить основные меню                D MENU^%ZAPM.ed.BSC</Data>
</Node>
<Node><Sub>5</Sub>
<Data>------------------------------------------------------------------------------</Data>
</Node>
<Node><Sub>6</Sub>
<Data>ВОССТАНОВИТЬ ПРОГРАММЫ И МАССИВЫ,</Data>
</Node>
<Node><Sub>7</Sub>
<Data>СОХРАНЕННЫЕ В %BS-MSM                  RGR^%ZAPM.ed.BSCh0</Data>
</Node>
<Node><Sub>8</Sub>
<Data>------------------------------------------------------------------------------</Data>
</Node>
<Node><Sub>9</Sub>
<Data>ПЕРЕКОДИРОВКА ИЗ ASCII В               $$As2An^%ZAPM.ed.BSCF1(String)</Data>
</Node>
<Node><Sub>10</Sub>
<Data>ANSI</Data>
</Node>
<Node><Sub>11</Sub>
<Data>------------------------------------------------------------------------------</Data>
</Node>
<Node><Sub>12</Sub>
<Data>ВЫВЕСТИ СООБЩЕНИЕ ОБ ОШИБКЕ            D ER^%ZAPM.ed.BSF(&quot;СООБЩЕНИЕ ОБ ОШИБКЕ&quot;)</Data>
</Node>
<Node><Sub>13</Sub>
<Data>ВЫВЕСТИ СООБЩЕНИЕ                      D OK^%ZAPM.ed.BSF(&quot;СООБЩЕНИЕ&quot;)</Data>
</Node>
<Node><Sub>14</Sub>
<Data>------------------------------------------------------------------------------</Data>
</Node>
<Node><Sub>15</Sub>
<Data>ВЫВЕСТИ ТАБЛИЦУ В IE5                  S TK=&quot;^PART(&quot;&quot;TAB&quot;&quot;)&quot;</Data>
</Node>
<Node><Sub>16</Sub>
<Data>                                       D TAB^%ZAPM.ed.BSCGH(TK)</Data>
</Node>
<Node><Sub>17</Sub>
<Data>------------------------------------------------------------------------------</Data>
</Node>
<Node><Sub>18</Sub>
<Data>ВЫВЕСТИ ТАБЛИЦУ ОПЦИЙ В IE5            D OPT^%ZAPM.ed.BSCh2(TBL)</Data>
</Node>
<Node><Sub>19</Sub>
<Data>                       SETOPT^%ZAPM.ed.BSCh2(TBL,NO,Q) ;ПРИСВОИТЬ ЗНАЧЕНИЕ ОПЦИИ NO=Q</Data>
</Node>
<Node><Sub>20</Sub>
<Data>                       GETOPT^%ZAPM.ed.BSCh2(TBL,NO)   ;ВОЗВРАТИТЬ ЗНАЧЕНИЕ ОПЦИИ NO</Data>
</Node>
<Node><Sub>21</Sub>
<Data>                       SAVEOPT^%ZAPM.ed.BSCh2(TBL)     ;ПРИСВОЕНИЕ ПАРАМЕТРОВ</Data>
</Node>
<Node><Sub>22</Sub>
<Data>------------------------------------------------------------------------------</Data>
</Node>
<Node><Sub>23</Sub>
<Data>ОТКРЫТЬ ДОС-ФАЙЛ      I $$OpenFile^%ZAPM.ed.BSCF1(%FN,&quot;R&quot;)=1 ; U %DEV - УСТРОЙСТВО</Data>
</Node>
<Node><Sub>24</Sub>
<Data> ДЛЯ ЧТЕНИЯ</Data>
</Node>
<Node><Sub>25</Sub>
<Data>ОТКРЫТЬ ДОС-ФАЙЛ      I $$OpenFile^%ZAPM.ed.BSCF1(%FN,&quot;W&quot;)=1</Data>
</Node>
<Node><Sub>26</Sub>
<Data> ДЛЯ ЗАПИСИ</Data>
</Node>
<Node><Sub>27</Sub>
<Data>ОТКРЫТЬ ДОС-ФАЙЛ      I $$OpenFile^%ZAPM.ed.BSCF1(%FN,&quot;A&quot;)=1</Data>
</Node>
<Node><Sub>28</Sub>
<Data>ДЛЯ ДОЗАПИСИ</Data>
</Node>
<Node><Sub>29</Sub>
<Data></Data>
</Node>
<Node><Sub>30</Sub>
<Data>------------------------------------------------------------------------------</Data>
</Node>
<Node><Sub>31</Sub>
<Data>ВСЕ ТАБЛИЦЫ DSN КОПИРОВАТЬ В РАЗДЕЛ PART        D DSN2PART^%ZAPM.ed.BSCRG(&quot;KNH&quot;,&quot;^PART&quot;,USER,PASS)</Data>
</Node>
<Node><Sub>32</Sub>
<Data>DSN=&quot;KNH&quot;</Data>
</Node>
<Node><Sub>33</Sub>
<Data> </Data>
</Node>
<Node><Sub>34</Sub>
<Data>ВСЕ ТАБЛИЦЫ В РАЗДЕЛЕ                           D PART2BSD^%ZAPM.ed.BSCRG(&quot;^KNH&quot;) </Data>
</Node>
<Node><Sub>35</Sub>
<Data>СДЕЛАТЬ БАЗАМИ %BS</Data>
</Node>
<Node><Sub>36</Sub>
<Data>------------------------------------------------------------------------------</Data>
</Node>
<Node><Sub>37</Sub>
<Data>КОМПИЛИРОВАТЬ ВЕСЬ РАЗДЕЛ            S PxPUSTO=&quot;&quot; ;БЕРЕЖНО ОБОЙТИСЬ С ИМЕНАМИ ПОЛЕЙ</Data>
</Node>
<Node><Sub>38</Sub>
<Data>ВСЕ %BS-БД В ОБЪЕКТНЫЕ БД            D ALLPART^%ZAPM.ed.BSCBD(&quot;^KNH&quot;)</Data>
</Node>
<Node><Sub>39</Sub>
<Data></Data>
</Node>
<Node><Sub>40</Sub>
<Data> --//-- ТОЛЬКО ТАБЛИЦУ               I $$START^%ZAPM.ed.BSCBD(TOBD,COMPILE,NC,DIR)</Data>
</Node>
<Node><Sub>41</Sub>
<Data> </Data>
</Node>
<Node><Sub>42</Sub>
<Data>КОМПИЛИРОВАТЬ ВСE КОДИФИКАТОРЫ      </Data>
</Node>
<Node><Sub>43</Sub>
<Data>КИПА В ОБЪЕКТНЫЕ БД                 D ALLKDF^%ZAPM.ed.BSCKD(&quot;&quot;)</Data>
</Node>
<Node><Sub>44</Sub>
<Data>--- ТОЛЬКО ОДИН --------------      D kdf^%ZAPM.ed.BSCKD(&quot;^kVZ&quot;)</Data>
</Node>
<Node><Sub>45</Sub>
<Data></Data>
</Node>
<Node><Sub>46</Sub>
<Data>КОМПИЛИРОВАТЬ ВСE КОДИФИКАТОРЫ      </Data>
</Node>
<Node><Sub>47</Sub>
<Data>И БАЗЫ ДАННЫХ КИПА В ОБЪЕКТНЫЕ БД   D ALL^%ZAPM.ed.BSCBD(&quot;&quot;)</Data>
</Node>
<Node><Sub>48</Sub>
<Data>------------------------------------------------------------------------------</Data>
</Node>
<Node><Sub>49</Sub>
<Data>ЗАКАЧАТЬ ИНФОРМАЦИЮ ИЗ ТАБЛИЦЫ ODBC   D TAB2BSD^%ZAPM.ed.BSCRG(DSN,USER,PASS,TAB,PART,TOBD)</Data>
</Node>
<Node><Sub>50</Sub>
<Data> В %BS-БАЗУ CACHE</Data>
</Node>
<Node><Sub>51</Sub>
<Data>ЭТО ЖЕ, НО ПОТОК ДЛЯ ВСЕГО DSN        D DSN2BS^%ZAPM.ed.BSCRG(DSN,USER,PASS,PART)</Data>
</Node>
<Node><Sub>52</Sub>
<Data>========================================================================</Data>
</Node>
<Node><Sub>53</Sub>
<Data>Полный поток DSN-&gt;Cache&apos;             d Stream^%ZAPM.ed.BSCBD(DSN,USER,PASS,PART)</Data>
</Node>
<Node><Sub>54</Sub>
<Data>------------------------------------------------------------------------------</Data>
</Node>
<Node><Sub>55</Sub>
<Data>СДЕЛАТЬ ОБЪЕКТНУЮ ОБВЯЗКУ МАССИВА    D ARRAY2OBJ^%ZAPM.ed.BSC4r2(G,P,T,KK,FLD,CLAS,TEMPDIR)</Data>
</Node>
<Node><Sub>56</Sub>
<Data>------------------------------------------------------------------------------</Data>
</Node>
<Node><Sub>57</Sub>
<Data><![CDATA[ВЫПОЛНИТЬ КОМАНДУ НА СЕРВЕРЕ         w $$command^%ZAPM.ed.BSCEXE("d:\!\SHOW.BAT ""E:\*.*"" ""D:\!\LIST.TX1""")]]></Data>
</Node>
<Node><Sub>58</Sub>
<Data>------------------------------------------------------------------------------</Data>
</Node>
<Node><Sub>59</Sub>
<Data>ЗАКАЧАТЬ БАЗЫ ДАННЫХ ИЗ %BS-MSM      S INPUTDIR=&quot;C:\!!&quot;</Data>
</Node>
<Node><Sub>60</Sub>
<Data>В GLAVK                              D GetFiles^%ZAPM.ed.BSion1</Data>
</Node>
<Node><Sub>61</Sub>
<Data>------------------------------------------------------------------------------</Data>
</Node>
<Node><Sub>62</Sub>
<Data>ВЫЧИСТИТЬ ГЛЮКИ MSM ПОСЛЕ ЗАКАЧКИ    D 0^%ZAPM.ed.BSCm2</Data>
</Node>
<Node><Sub>63</Sub>
<Data>В ОБЛАСТИ GLAVK</Data>
</Node>
<Node><Sub>64</Sub>
<Data>------------------------------------------------------------------------------</Data>
</Node>
<Node><Sub>65</Sub>
<Data>ВЫЧИСТИТЬ ВЫБОРОЧНО БАЗЫ ДАННЫХ      D START^%ZAPM.ed.BSion3</Data>
</Node>
<Node><Sub>66</Sub>
<Data>GLAVK ОТ ЧУЖИХ КСП...</Data>
</Node>
<Node><Sub>67</Sub>
<Data>------------------------------------------------------------------------------</Data>
</Node>
<Node><Sub>68</Sub>
<Data>ПОТОК ПЕРВОНАЧАЛЬНЫХ НАСТРОЕК        D INIT^%ZAPM.ed.BSChW</Data>
</Node>
<Node><Sub>69</Sub>
<Data>ПРИ ИНСТАЛЛЯЦИИ %BS-Portal</Data>
</Node>
<Node><Sub>70</Sub>
<Data>------------------------------------------------------------------------------</Data>
</Node>
<Node><Sub>71</Sub>
<Data>========================   РАБОТА С ПОРТАЛОМ   ===========================</Data>
</Node>
<Node><Sub>72</Sub>
<Data>------------------------------------------------------------------------------</Data>
</Node>
<Node><Sub>73</Sub>
<Data> W $$GetAcc^%ZAPM.ed.BSC4cfgP(BSLOGIN,&quot;SVVA&quot;)   //ПРАВА ДОСТУПА ДЛЯ BSLOGIN К SVVA</Data>
</Node>
<Node><Sub>74</Sub>
<Data>             0,1 - НЕТ ДОСТУПА</Data>
</Node>
<Node><Sub>75</Sub>
<Data>             2 - ТОЛЬКО ЧТЕНИЕ</Data>
</Node>
<Node><Sub>76</Sub>
<Data>             3 - ЧТЕНИЕ И ЗАПИСЬ</Data>
</Node>
<Node><Sub>77</Sub>
<Data>             4 - ЧТЕНИЕ, ЗАПИСЬ И УДАЛЕНИЕ</Data>
</Node>
<Node><Sub>78</Sub>
<Data>             5 - ПОЛНЫЙ ДОСТУП (ФУНКЦИИ АДМИНИСТРАТОРА)</Data>
</Node>
<Node><Sub>79</Sub>
<Data>            </Data>
</Node>
<Node><Sub>80</Sub>
<Data>СОБРАТЬ В URL ВСЕ ПЕРЕМЕННЫЕ НА BS И ВСТАВИТЬ В ВЫЗОВ НОВОГО ОКНА </Data>
</Node>
<Node><Sub>81</Sub>
<Data></Data>
</Node>
<Node><Sub>82</Sub>
<Data>S BSLABEL=&quot;FRAMES^~BSCSVVT&quot;</Data>
</Node>
<Node><Sub>83</Sub>
<Data>w &quot;open(&apos;&quot;_$$ADDBSGET^%ZAPM.ed.BSC4()_&quot;&apos;,&quot;&quot;Tele&quot;&quot;,&quot;&quot;toolbar=no,menubar=no,</Data>
</Node>
<Node><Sub>84</Sub>
<Data>scrollbars=yes,width=800,height=600,status=1,resizable=1&quot;&quot;);&quot;_BK</Data>
</Node>
<Node><Sub>85</Sub>
<Data></Data>
</Node>
<Node><Sub>86</Sub>
<Data></Data>
</Node>
<Node><Sub>87</Sub>
<Data></Data>
</Node>
<Node><Sub>88</Sub>
<Data></Data>
</Node>
<Node><Sub>89</Sub>
<Data>------------------------------------------------------------------------------</Data>
</Node>
<Node><Sub>90</Sub>
<Data>ВЫГРУЗИТЬ ТЕХНИЧЕСКУЮ ДОКУМЕНТАЦИЮ В ФАЙЛ N:\123.TXT     D DOCOUT^%ZAPM.ed.BSC4r3</Data>
</Node>
<Node><Sub>91</Sub>
<Data>------------------------------------------------------------------------------</Data>
</Node>
</Node>
<Node><Sub>GRAND</Sub>
<Data><![CDATA[ГРАНТЫ ПОЛЬЗОВАТЕЛЕЙ@@@@@1@1@1@1@22@80@1@@1@@@2@@2,2@1@@@@@1@@@2@2@@@@@@@@@@@@USERSBAS^%ZAPM.ed.BSF13]]></Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@40@@@@@1@2;6;35;46@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@41@1@39@@@@@1@1;6;35;46@@@@@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@40@@@@@1@2;6;35;46@@@@@ ИМЯ ГРАНТА ПРИЛОЖЕНИЯ</Data>
</Node>
<Node><Sub>2</Sub>
<Data>2@41@1@39@@@@@2@1;6;35;46@@@@@@@@APP</Data>
</Node>
</Node>
<Node><Sub>Compile</Sub>
<Data>OK 11:54:50 2006-06-15</Data>
</Node>
<Node><Sub>Free</Sub>
<Data>58570,56527</Data>
</Node>
<Node><Sub>KEY</Sub>
<Data>^[&quot;%SYS&quot;]%BScGRAND</Data>
<Node><Sub>1</Sub>
<Data>@@@@ввод нового гранта@1,70@@@ 1-Й ИНДЕКСНЫЙ@2;6;30;42@@@@@Введите ИМЯ ГРАНТА@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data><![CDATA[@@@@ВВОД НОВОГО ГРАНТА ПРИЛОЖЕНИЯ@1,70,TIME@@@ 2-Й ИНДЕКСНЫЙ@2;6;37;44@@@@@Имя НОВОГО ГРАНТА ПРИЛОЖЕНИЯ@@@@@]]></Data>
<Node><Sub>3</Sub>
<Data><![CDATA[S d1=$S(d="*":"Любой ТОМ доступен",d=0:"Прикрепленная таблица доступа",d=1:"Доступ по DDP",d=2:"Умалчиваемые пути",d=4:"Переопределения Баз Данных,Права Доступа",d=3:"АДМИНИСТРАТОР!",1:d)]]></Data>
</Node>
<Node><Sub>4</Sub>
<Data><![CDATA[$S(d="*":"Любой ТОМ доступен",d=0:"Прикрепленная таблица доступа",d=1:"Доступ по DDP",d=2:"Умалчиваемые пути",d=4:"Переопределения Баз Данных,Права Доступа",d=3:"АДМИНИСТРАТОР!",1:d)]]></Data>
</Node>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>60431,42890,</Data>
</Node>
<Node><Sub>Metod</Sub>
<Node><Sub>1</Sub>
<Data><![CDATA[VisM(CODE:%String="",P1:%String="",P2:%String="",P3:%String="",P4:%String="",P5:%String="",P6:%String="",P7:%String="",P8:%String="",P9:%String="")]]></Data>
<Node><Sub>0</Sub>
<Data>N (CODE,P1,P2,P3,P4,P5,P6,P7,P8,P9,VALUE)</Data>
</Node>
<Node><Sub>1</Sub>
<Data>X CODE</Data>
</Node>
<Node><Sub>2</Sub>
<Data>Q $G(VALUE)</Data>
</Node>
</Node>
</Node>
<Node><Sub>STA</Sub>
<Data>2,2@2@2@27@-1@-1@2@41@</Data>
</Node>
</Node>
<Node><Sub>GRANDAPP</Sub>
<Data>ГРАНТЫ ПРИЛОЖЕНИЙ@@@@@1@1@1@1@22@80@1@@1@@@2@@2,2@1@@@@@1@@@2@2@@@@@@@@@@@@USERSBAS^%ZAPM.ed.BSF13</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@40@@@@@1@2;6;35;46@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@41@1@39@@@@@1@1;6;35;46@@@@@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@40@@@@@1@2;6;35;46@@@@@ ИМЯ ГРАНТА ПРИЛОЖЕНИЯ</Data>
</Node>
<Node><Sub>2</Sub>
<Data>2@41@1@39@@@@@2@1;6;35;46@@@@@@@@APP</Data>
</Node>
</Node>
<Node><Sub>Compile</Sub>
<Data>OK 11:54:50 2006-06-15</Data>
</Node>
<Node><Sub>Free</Sub>
<Data>58570,56597</Data>
</Node>
<Node><Sub>KEY</Sub>
<Data>^[&quot;%SYS&quot;]%BScGAPP</Data>
<Node><Sub>1</Sub>
<Data><![CDATA[@@@@ВВОД НОВОГО ГРАНТА ПРИЛОЖЕНИЯ@1,70@@@ 1-Й ИНДЕКСНЫЙ@2;6;37;44@@@@@Имя НОВОГО ГРАНТА ПРИЛОЖЕНИЯ@0@@@@]]></Data>
<Node><Sub>1</Sub>
<Data>S d1=1 I $G(%NAm)&apos;=&quot;&quot; S @(%NAm_&quot;d)&quot;)=$H</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1 I $G(%NAm)&apos;=&quot;&quot; S @(%NAm_&quot;d)&quot;)=$H</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Data><![CDATA[@@@@ВВОД НОВОГО ПАРАМЕТРА ГРАНТА ПРИЛОЖЕНИЯ@1,70@@@ 2-Й ИНДЕКСНЫЙ@2;6;37;44@@@@@Имя НОВОГО ПАРАМЕТРА ГРАНТА ПРИЛОЖЕНИЯ@0@@@@]]></Data>
<Node><Sub>1</Sub>
<Data>S d1=1 I $G(%NAm)&apos;=&quot;&quot; S @(%NAm_&quot;d)&quot;)=$H</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1 I $G(%NAm)&apos;=&quot;&quot; S @(%NAm_&quot;d)&quot;)=$H</Data>
</Node>
<Node><Sub>3</Sub>
<Data><![CDATA[S d1=$S(d="*":"Любой ТОМ доступен",d=0:"Прикрепленная таблица доступа",d=1:"Доступ по DDP",d=2:"Умалчиваемые пути",d=4:"Переопределения Баз Данных,Права Доступа",d=3:"АДМИНИСТРАТОР!",1:d)]]></Data>
</Node>
<Node><Sub>4</Sub>
<Data><![CDATA[$S(d="*":"Любой ТОМ доступен",d=0:"Прикрепленная таблица доступа",d=1:"Доступ по DDP",d=2:"Умалчиваемые пути",d=4:"Переопределения Баз Данных,Права Доступа",d=3:"АДМИНИСТРАТОР!",1:d)]]></Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Data><![CDATA[@@@@ВВОД НОВОГО ПАРАМЕТРА ГРАНТА ПРИЛОЖЕНИЯ@1,70@@@ 3-Й ИНДЕКСНЫЙ@2;6;37;44@@@@@Имя НОВОГО ПАРАМЕТРА ГРАНТА ПРИЛОЖЕНИЯ@0@@@@]]></Data>
<Node><Sub>1</Sub>
<Data>S d1=1 I $G(%NAm)&apos;=&quot;&quot; S @(%NAm_&quot;d)&quot;)=$H</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1 I $G(%NAm)&apos;=&quot;&quot; S @(%NAm_&quot;d)&quot;)=$H</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Data><![CDATA[@@@@ВВОД НОВОГО ПАРАМЕТРА ГРАНТА ПРИЛОЖЕНИЯ@1,70@@@ 4-Й ИНДЕКСНЫЙ@2;6;37;44@@@@@Имя НОВОГО ПАРАМЕТРА ГРАНТА ПРИЛОЖЕНИЯ@0@@@@]]></Data>
<Node><Sub>1</Sub>
<Data>S d1=1 I $G(%NAm)&apos;=&quot;&quot; S @(%NAm_&quot;d)&quot;)=$H</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1 I $G(%NAm)&apos;=&quot;&quot; S @(%NAm_&quot;d)&quot;)=$H</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Data><![CDATA[@@@@ВВОД НОВОГО ПАРАМЕТРА ГРАНТА ПРИЛОЖЕНИЯ@1,70@@@ 5-Й ИНДЕКСНЫЙ@2;6;37;44@@@@@Имя НОВОГО ПАРАМЕТРА ГРАНТА ПРИЛОЖЕНИЯ@0@@@@]]></Data>
<Node><Sub>1</Sub>
<Data>S d1=1 I $G(%NAm)&apos;=&quot;&quot; S @(%NAm_&quot;d)&quot;)=$H</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1 I $G(%NAm)&apos;=&quot;&quot; S @(%NAm_&quot;d)&quot;)=$H</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Data><![CDATA[@@@@ВВОД НОВОГО ПАРАМЕТРА ГРАНТА ПРИЛОЖЕНИЯ@1,70@@@ 6-Й ИНДЕКСНЫЙ@2;6;37;44@@@@@Имя НОВОГО ПАРАМЕТРА ГРАНТА ПРИЛОЖЕНИЯ@0@@@@]]></Data>
<Node><Sub>1</Sub>
<Data>S d1=1 I $G(%NAm)&apos;=&quot;&quot; S @(%NAm_&quot;d)&quot;)=$H</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1 I $G(%NAm)&apos;=&quot;&quot; S @(%NAm_&quot;d)&quot;)=$H</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Data><![CDATA[@@@@ВВОД НОВОГО ПАРАМЕТРА ГРАНТА ПРИЛОЖЕНИЯ@1,70@@@ 7-Й ИНДЕКСНЫЙ@2;6;37;44@@@@@Имя НОВОГО ПАРАМЕТРА ГРАНТА ПРИЛОЖЕНИЯ@0@@@@]]></Data>
<Node><Sub>1</Sub>
<Data>S d1=1 I $G(%NAm)&apos;=&quot;&quot; S @(%NAm_&quot;d)&quot;)=$H</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1 I $G(%NAm)&apos;=&quot;&quot; S @(%NAm_&quot;d)&quot;)=$H</Data>
</Node>
</Node>
<Node><Sub>8</Sub>
<Data><![CDATA[@@@@ВВОД НОВОГО ПАРАМЕТРА ГРАНТА ПРИЛОЖЕНИЯ@1,70@@@ 8-Й ИНДЕКСНЫЙ@2;6;37;44@@@@@Имя НОВОГО ПАРАМЕТРА ГРАНТА ПРИЛОЖЕНИЯ@0@@@@]]></Data>
<Node><Sub>1</Sub>
<Data>S d1=1 I $G(%NAm)&apos;=&quot;&quot; S @(%NAm_&quot;d)&quot;)=$H</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1 I $G(%NAm)&apos;=&quot;&quot; S @(%NAm_&quot;d)&quot;)=$H</Data>
</Node>
</Node>
<Node><Sub>9</Sub>
<Data><![CDATA[@@@@ВВОД НОВОГО ПАРАМЕТРА ГРАНТА ПРИЛОЖЕНИЯ@1,70@@@ 9-Й ИНДЕКСНЫЙ@2;6;37;44@@@@@Имя НОВОГО ПАРАМЕТРА ГРАНТА ПРИЛОЖЕНИЯ@0@@@@]]></Data>
<Node><Sub>1</Sub>
<Data>S d1=1 I $G(%NAm)&apos;=&quot;&quot; S @(%NAm_&quot;d)&quot;)=$H</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1 I $G(%NAm)&apos;=&quot;&quot; S @(%NAm_&quot;d)&quot;)=$H</Data>
</Node>
<Node><Sub>10</Sub>
<Data>Текст ,который появится в меню при организации выборки для выдачи СПИСКОВ и СВОДОК</Data>
<Node><Sub>1</Sub>
<Data><![CDATA[I 1 ;3 - ДИАПАЗОН, или Формула вычисления для выборки. Например,ключ 2 это дата и формула для выборки МАЯ-месяца будет такая :+$E(k2,3,4)=5]]></Data>
</Node>
<Node><Sub>2</Sub>
<Data><![CDATA[1 ;3 - ДИАПАЗОН, или Формула вычисления для выборки. Например,ключ 2 это дата и формула для выборки МАЯ-месяца будет такая :+$E(k2,3,4)=5]]></Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>60431,42890,</Data>
</Node>
<Node><Sub>STA</Sub>
<Data>2,2@2@2@27@-1@-1@2@41@</Data>
</Node>
</Node>
<Node><Sub>HELP</Sub>
<Data>Обобщенная База ДОКУМЕНТАЦИИ ПО КОМПЛЕКСУ@@@@@1@1@1@1@22@80@1@@1@@@2@@@1@@@@@1@@@5@2@@@@@@@@</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@12@@@@@1@2;6;35;42@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@13@1@53@@@@0@1@2;6;35;42@@@@@@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@12@@@@@1@2;6;35;42@@@@@ТИТУЛ</Data>
</Node>
<Node><Sub>2</Sub>
<Data>2@13@1@53@@@@@2@1;6;32;40@@@@@@@@TIT@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@12@@@@@1@2;6;35;42@@@@@ФОРМА ВЫЗОВА@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@13@1@53@@@@@2@1;6;32;40@@@@@@@@FOR1</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>4@1@1@12@@@@@1@2;6;35;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>4@13@1@53@@@@@2@1;6;32;40@@@@@@@@E</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>5@1@18@12@@@@@1@2;6;35;42@@@@@САМ ТЕКСТ@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>5@13@18@53@@@@@2@1;6;32;40@@@@@@@@TXT</Data>
</Node>
</Node>
<Node><Sub>Compile</Sub>
<Data>OK 11:54:51 2006-06-15</Data>
</Node>
<Node><Sub>FTR</Sub>
<Node><Sub>1</Sub>
<Node><Sub>2</Sub>
<Data>S d1=&quot; ДАТА &quot;_$$ESDAY^%ZAPM.ed.BSsFUNR(9,$G(k1,&quot;1&quot;)_&quot;,&quot;_$G(k2,&quot;1&quot;))</Data>
<Node><Sub>1</Sub>
<Data>&quot; ДАТА &quot;_$$ESDAY^%ZAPM.ed.BSsFUNR(9,$G(k1,&quot;1&quot;)_&quot;,&quot;_$G(k2,&quot;1&quot;))</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>Free</Sub>
<Data>58749,53490</Data>
</Node>
<Node><Sub>KEY</Sub>
<Data>^[&quot;%SYS&quot;]%BSCHELP</Data>
<Node><Sub>1</Sub>
<Data>@@@@НОВЫЙ РАЗДЕЛ@1,70@@@ 1-Й ИНДЕКСНЫЙ@2;6;30;42@@@@@РАЗДЕЛ@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>@@@@НОВЫЙ ПОДРАЗДЕЛ@1,75@@@ 2-Й ИНДЕКСНЫЙ@2;6;37;44@@@@@ПОДРАЗДЕЛ@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>@@@@НОВЫЙ ПУНКТ@1,30@@@ 3-Й ИНДЕКСНЫЙ@2;6;37;44@@@@@ПУНКТ@@@@@</Data>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>60431,42891,</Data>
</Node>
<Node><Sub>STA</Sub>
<Data>1,1@1@1@27@-1@-1@1@1@</Data>
</Node>
</Node>
<Node><Sub>HTML</Sub>
<Data>ПАРАМЕТРЫ ОСНОВНОЙ СТРАНИЦЫ HTML@@@@@1@1@1@1@22@80@1@@1@1@@1@@@1@@@@@@@@35@2@@1;6;35;44@@@@@@</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@40@@@@@1@2;6;33;45@@@@@     НАИМЕНОВАНИЯ ПАРАМЕТРОВ</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@41@1@38@@@@@1@2;6;33;45@@@@@ ЗНАЧЕНИЯ@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@40@@@@@1@2;6;32;40@@@@@(ГЛАВНАЯ) НАЧАЛО СТРОКИ ТИТУЛА СТРАНИЦЫ</Data>
</Node>
<Node><Sub>2</Sub>
<Data>2@41@1@38@@@@@1@2;6;32;40@@@@@%BS+Cache - WebLink@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@40@@@@@1@2;6;32;40@@@@@ПАРАМЕТРЫ ТЕГА &quot;&lt;BODY &quot;_@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@41@1@38@@@@@1@2;6;32;40@@@@@BACKGROUND=&quot;/BS/IMG/BRAUN.JPG&quot; BGCOLOR=#A3B086@</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>4@1@1@40@@@@@1@2;6;32;40@@@@@ТЕКСТ ЗАГОЛОВКА СТРАНИЦЫ ПО-УМОЛЧАНИЮ@</Data>
</Node>
<Node><Sub>2</Sub>
<Data><![CDATA[4@41@1@38@@@@@1@2;6;32;40@@@@@<H3>Интегрированная Среда программирования<br>и создания приложений в СУБД MSM и Cach&eacute;.</H3>@]]></Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>5@1@1@40@@@@@1@2;6;32;40@@@@@ЗАГЛАВНАЯ КАРТИНКА СТРАНИЦЫ &quot;&lt;IMG &quot;_@</Data>
</Node>
<Node><Sub>2</Sub>
<Data><![CDATA[5@41@1@38@@@@@1@2;6;32;40@@@@@SRC="/BS/IMG/BS.GIF" ALIGN="LEFT" ALT="перейти в Главное меню" border=0@]]></Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>6@1@1@40@@@@@1@2;6;32;40@@@@@(X) КАРТИНКА ЗАВЕРШЕНИЯ СЕАНСА &quot;&lt;IMG &quot;_@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>6@41@1@38@@@@@1@2;6;32;40@@@@@SRC=&quot;/BS/IMG/STOP.GIF&quot; ALIGN=&quot;LEFT&quot; ALT=&quot;%BS+Cache border=0@</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>7@1@1@40@@@@@1@2;6;32;40@@@@@ТЕКСТ ЗАВЕРШЕНИЯ СТРАНИЦЫ ПО-УМОЛЧАНИЮ@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>7@41@1@38@@@@@1@2;6;32;40@@@@@&lt;H5&gt;(c)2001 тел.7(095)3618735 Михайленко Сергей Владимирович&lt;/H5&gt;@</Data>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>1</Sub>
<Data>8@1@1@40@@@@@1@2;6;34;43@@@@@(О&apos;Кey)   НАЧАЛО СТРОКИ ТИТУЛА СТРАНИЦЫ</Data>
</Node>
<Node><Sub>2</Sub>
<Data>8@41@1@38@@@@@1@2;6;34;43@@@@@Успешное завершение@</Data>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>1</Sub>
<Data>9@1@1@40@@@@@1@2;6;34;43@@@@@ПАРАМЕТРЫ ТЕГА &quot;&lt;BODY &quot;_@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>9@41@1@38@@@@@1@2;6;34;43@@@@@BACKGROUND=&quot;/BS/IMG/GREEN.JPG&quot; BGCOLOR=#A3B086@</Data>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>1</Sub>
<Data>10@1@1@40@@@@@1@2;6;34;43@@@@@ТЕКСТ ЗАГОЛОВКА СТРАНИЦЫ ПО-УМОЛЧАНИЮ@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>10@41@1@38@@@@@1@2;6;34;43@@@@@&lt;H3&gt;Ваше действие успешно завершено&lt;/H3&gt;@</Data>
</Node>
</Node>
<Node><Sub>11</Sub>
<Node><Sub>1</Sub>
<Data>11@1@1@40@@@@@1@2;6;34;43@@@@@ЗАГЛАВНАЯ КАРТИНКА СТРАНИЦЫ  &quot;&lt;IMG &quot;_@</Data>
</Node>
<Node><Sub>2</Sub>
<Data><![CDATA[11@41@1@38@@@@@1@2;6;34;43@@@@@SRC="/BS/IMG/OK.GIF" ALT="перейти в Главное меню" WIDTH=33 HEIGHT=33 ALIGN="LEFT" border=0@]]></Data>
</Node>
</Node>
<Node><Sub>12</Sub>
<Node><Sub>1</Sub>
<Data>12@1@1@40@@@@@1@2;6;33;41@@@@@(ERROR)   НАЧАЛО СТРОКИ ТИТУЛА СТРАНИЦЫ</Data>
</Node>
<Node><Sub>2</Sub>
<Data>12@41@1@38@@@@@1@2;6;33;41@@@@@ОШИБКА !@</Data>
</Node>
</Node>
<Node><Sub>13</Sub>
<Node><Sub>1</Sub>
<Data>13@1@1@40@@@@@1@2;6;33;41@@@@@ПАРАМЕТРЫ ТЕГА &quot;&lt;BODY &quot;_@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>13@41@1@38@@@@@1@2;6;33;41@@@@@BGCOLOR=#A3B086@</Data>
</Node>
</Node>
<Node><Sub>14</Sub>
<Node><Sub>1</Sub>
<Data>14@1@1@40@@@@@1@2;6;33;41@@@@@ТЕКСТ ЗАГОЛОВКА СТРАНИЦЫ ПО-УМОЛЧАНИЮ@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>14@41@1@38@@@@@1@2;6;33;41@@@@@&lt;H3&gt;Произошло прерывание !&lt;/H3&gt;@</Data>
</Node>
</Node>
<Node><Sub>15</Sub>
<Node><Sub>1</Sub>
<Data>15@1@1@40@@@@@1@2;6;33;41@@@@@ЗАГЛАВНАЯ КАРТИНКА СТРАНИЦЫ  &quot;&lt;IMG &quot;_@</Data>
</Node>
<Node><Sub>2</Sub>
<Data><![CDATA[15@41@1@38@@@@@1@2;6;33;41@@@@@SRC="/BS/IMG/KREST.GIF" ALT="перейти в Главное меню" WIDTH=33 HEIGHT=33 ALIGN="LEFT" border=0@]]></Data>
</Node>
</Node>
<Node><Sub>16</Sub>
<Node><Sub>1</Sub>
<Data>16@1@1@40@@@@@1@2;6;34;46@@@@@(???)    НАЧАЛО СТРОКИ ТИТУЛА СТРАНИЦЫ</Data>
</Node>
<Node><Sub>2</Sub>
<Data>16@41@1@38@@@@@1@2;6;34;46@@@@@ВЫ УВЕРЕНЫ ?@</Data>
</Node>
</Node>
<Node><Sub>17</Sub>
<Node><Sub>1</Sub>
<Data>17@1@1@40@@@@@1@2;6;34;46@@@@@ПАРАМЕТРЫ ТЕГА &quot;&lt;BODY &quot;_@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>17@41@1@38@@@@@1@2;6;34;46@@@@@BGCOLOR=#A3B086@</Data>
</Node>
</Node>
<Node><Sub>18</Sub>
<Node><Sub>1</Sub>
<Data>18@1@1@40@@@@@1@2;6;34;46@@@@@ТЕКСТ ЗАГОЛОВКА СТРАНИЦЫ ПО-УМОЛЧАНИЮ@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>18@41@1@38@@@@@1@2;6;34;46@@@@@&lt;H3&gt;Ответьте на вопрос:&lt;/H3&gt;@</Data>
</Node>
</Node>
<Node><Sub>19</Sub>
<Node><Sub>1</Sub>
<Data>19@1@1@40@@@@@1@2;6;34;46@@@@@ЗАГЛАВНАЯ КАРТИНКА СТРАНИЦЫ  &quot;&lt;IMG &quot;_@</Data>
</Node>
<Node><Sub>2</Sub>
<Data><![CDATA[19@41@1@38@@@@@1@2;6;34;46@@@@@SRC="/BS/IMG/QU.GIF" ALIGN="LEFT" ALT="перейти в Главное меню" WIDTH=33 HEIGHT=33 border=0@]]></Data>
</Node>
</Node>
<Node><Sub>20</Sub>
<Node><Sub>1</Sub>
<Data>20@1@1@40@@@@@1@2;6;37;45@@@@@(!!!)     НАЧАЛО СТРОКИ ТИТУЛА СТРАНИЦЫ</Data>
</Node>
<Node><Sub>2</Sub>
<Data>20@41@1@38@@@@@1@2;6;37;45@@@@@ВНИМАНИЕ !@</Data>
</Node>
</Node>
<Node><Sub>21</Sub>
<Node><Sub>1</Sub>
<Data>21@1@1@40@@@@@1@2;6;37;45@@@@@ПАРАМЕТРЫ ТЕГА &quot;&lt;BODY &quot;_@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>21@41@1@38@@@@@1@2;6;37;45@@@@@BGCOLOR=#A3B086@</Data>
</Node>
</Node>
<Node><Sub>22</Sub>
<Node><Sub>1</Sub>
<Data>22@1@1@40@@@@@1@2;6;37;45@@@@@ТЕКСТ ЗАГОЛОВКА СТРАНИЦЫ ПО-УМОЛЧАНИЮ@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>22@41@1@38@@@@@1@2;6;37;45@@@@@&lt;H3&gt;ВНИМАНИЕ !&lt;/H3&gt;@</Data>
</Node>
</Node>
<Node><Sub>23</Sub>
<Node><Sub>1</Sub>
<Data>23@1@1@40@@@@@1@2;6;37;45@@@@@ЗАГЛАВНАЯ КАРТИНКА СТРАНИЦЫ  &quot;&lt;IMG &quot;_@</Data>
</Node>
<Node><Sub>2</Sub>
<Data><![CDATA[23@41@1@38@@@@@1@2;6;37;45@@@@@SRC="/BS/IMG/WARNING.GIF" ALIGN="LEFT" ALT="перейти в Главное меню" WIDTH=33 HEIGHT=33 border=0@]]></Data>
</Node>
</Node>
<Node><Sub>24</Sub>
<Node><Sub>1</Sub>
<Data>24@1@1@40@@@@@1@2;6;32;40@@@@@ТОБД- СООБЩЕНИЙ ДЛЯ АДМИНИСТРАТОРА@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>24@41@1@38@@@@@1@2;6;32;40@@@@@^%ZAPM.ed.BSC(&quot;MAIL&quot;)@</Data>
</Node>
</Node>
<Node><Sub>25</Sub>
<Node><Sub>1</Sub>
<Data>25@1@1@40@@@@@1@2;6;32;40@@@@@ТОБД- РЕГИСТРАЦИИ ВИЗИТОВ ПОЛЬЗОВАТ.@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>25@41@1@38@@@@@1@2;6;32;40@@@@@^%ZAPM.ed.BSC(&quot;VISIT&quot;)@</Data>
</Node>
</Node>
<Node><Sub>26</Sub>
<Node><Sub>1</Sub>
<Data>26@1@1@40@@@@@1@2;6;32;40@@@@@ПУТЬ К КАРТИНКАМ НАВИГАЦИИ ПО ТАБЛИЦЕ@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>26@41@1@38@@@@@1@2;6;32;40@@@@@/BS/IMG/TABL/STAR.GIF@</Data>
</Node>
</Node>
<Node><Sub>27</Sub>
<Node><Sub>1</Sub>
<Data>27@1@1@40@@@@@1@2;6;32;40@@@@@ЦВЕТ ФОНА ШАПКИ И БОКОВИНЫ ТАБЛИЦЫ @</Data>
</Node>
<Node><Sub>2</Sub>
<Data>27@41@1@38@@@@@1@2;6;32;40@@@@@BGCOLOR=&quot;#800080&quot;@</Data>
</Node>
</Node>
<Node><Sub>28</Sub>
<Node><Sub>1</Sub>
<Data>28@1@1@40@@@@@1@2;6;32;40@@@@@ОБЛАСТЬ ЗНАЧЕНИЙ ГРАНИЦ ОКНА - СТРОКИ @</Data>
</Node>
<Node><Sub>2</Sub>
<Data>28@41@1@38@@@@@1@2;6;32;40@@@@@18:2:62 selected=26@</Data>
</Node>
</Node>
<Node><Sub>29</Sub>
<Node><Sub>1</Sub>
<Data>29@1@1@40@@@@@1@2;6;32;40@@@@@ОБЛАСТЬ ЗНАЧЕНИЙ ГРАНИЦ ОКНА - КОЛОНКИ@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>29@41@1@38@@@@@1@2;6;32;40@@@@@80:2:160 selected=90@</Data>
</Node>
</Node>
<Node><Sub>30</Sub>
<Node><Sub>1</Sub>
<Data>30@1@1@40@@@@@1@2;6;32;40@@@@@МАКСИМУМ КОЛ-ВА Кbite ПРИ ПР.ВСЕЙ ТАБЛ.@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>30@41@1@38@@@@@1@2;6;32;40@@@@@2000@</Data>
</Node>
</Node>
<Node><Sub>31</Sub>
<Node><Sub>1</Sub>
<Data>31@1@1@40@@@@@1@2;6;35;43@@@@@ПУТЬ К JAVA-APPLETу просмотра ТАБЛИЦЫ@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>31@41@1@38@@@@@1@2;6;35;43@@@@@/BS/TABVIEW/@</Data>
</Node>
</Node>
<Node><Sub>32</Sub>
<Node><Sub>1</Sub>
<Data>32@1@1@40@@@@@1@2;6;35;43@@@@@ПРОГРАММА НА JSCRIPT  LoadText(HTTP,W,H)@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>32@41@1@38@@@@@1@2;6;35;43@@@@@/BS/TABVIEW/TABVIEW.JS@</Data>
</Node>
</Node>
<Node><Sub>33</Sub>
<Node><Sub>1</Sub>
<Data>33@1@1@40@@@@@1@2;6;32;40@@@@@                КАРТИНКА КНОПКИ НАЗАД@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>33@41@1@38@@@@@1@2;6;32;40@@@@@SRC=&quot;/BS/IMG/BACK.GIF&quot; WIDTH=20 HEIGHT=20 TITLE=&quot;Возвратиться Назад&quot;@</Data>
</Node>
</Node>
<Node><Sub>34</Sub>
<Node><Sub>1</Sub>
<Data>34@1@1@40@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>34@41@1@38@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
</Node>
<Node><Sub>35</Sub>
<Node><Sub>1</Sub>
<Data>35@1@1@40@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>35@41@1@38@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
</Node>
<Node><Sub>HTML</Sub>
<Node><Sub>CFG</Sub>
<Data>0,26,90,9,9,9,,1,1,1</Data>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>59176,66852,MSW</Data>
</Node>
<Node><Sub>OPT</Sub>
<Data>1,2,2</Data>
</Node>
<Node><Sub>STA</Sub>
<Data>3,1@1@1@13@-1@-1@3@1@ПАРАМЕТРЫ ТЕГА &quot;&lt;BODY &quot;_</Data>
</Node>
</Node>
<Node><Sub>MAIL</Sub>
<Data>Сообщение Администратору@@@@@1@1@1@1@22@80@1@@1@@@2@@2,2@1@@@@@1@@@5@2@@@@@@@@</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@2@20@@@@@1@2;6;35;42@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@21@2@53@@@@0@1@2;6;35;42@@@@@@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@20@@@@@1@2;6;35;42@@@@@       ПОЛЬЗОВАТЕЛЬ</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@21@1@53@@@@@2@1;6;32;40@@@@@@@@U@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>4@1@1@20@@@@@1@2;6;35;42@@@@@            ТЕЛЕФОН@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>4@21@1@53@@@@@2@1;6;32;40@@@@@@@@T</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>5@1@1@20@@@@@1@2;6;35;42@@@@@          СРОЧНОСТЬ@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>5@21@1@53@@@@0@2@1;6;32;40@@@@@@@@A</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>6@1@10@20@@@@@1@2;6;35;42@@@@@                            ТЕКСТ               СООБЩЕНИЯ@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>6@21@10@53@@@@0@2@1;6;32;40@@@@@@@@B</Data>
</Node>
</Node>
<Node><Sub>Compile</Sub>
<Data>OK 11:54:51 2006-06-15</Data>
</Node>
<Node><Sub>FTR</Sub>
<Node><Sub>1</Sub>
<Node><Sub>2</Sub>
<Data>S d1=&quot; ДАТА &quot;_$$ESDAY^%ZAPM.ed.BSsFUNR(9,$G(k1,&quot;1&quot;)_&quot;,&quot;_$G(k2,&quot;1&quot;))</Data>
<Node><Sub>1</Sub>
<Data>&quot; ДАТА &quot;_$$ESDAY^%ZAPM.ed.BSsFUNR(9,$G(k1,&quot;1&quot;)_&quot;,&quot;_$G(k2,&quot;1&quot;))</Data>
</Node>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>2</Sub>
<Data>S d1=d_&quot; - &quot;_$S(d=1:&quot;ОЧЕНЬ СРОЧНО&quot;,d=2:&quot;НЕ СРОЧНО&quot;,1:&quot;СОВСЕМ НЕ СРОЧНО&quot;)</Data>
<Node><Sub>1</Sub>
<Data>d_&quot; - &quot;_$S(d=1:&quot;ОЧЕНЬ СРОЧНО&quot;,d=2:&quot;НЕ СРОЧНО&quot;,1:&quot;СОВСЕМ НЕ СРОЧНО&quot;)</Data>
</Node>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>2</Sub>
<Data>S d1=$TR(d,$C(13,10),&quot;&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$TR(d,$C(13,10),&quot;&quot;)</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>Free</Sub>
<Data>58570,56719</Data>
</Node>
<Node><Sub>KEY</Sub>
<Data>^[&quot;%SYS&quot;]%BScMAIL</Data>
<Node><Sub>1</Sub>
<Data>@@64@@НОВАЯ СИСТЕМНАЯ ДАТА@1,70@@@ 1-Й ИНДЕКСНЫЙ@2;6;30;42@@@@@СИСТЕМНАЯ ДАТА@@@@@</Data>
<Node><Sub>3</Sub>
<Data>S d1=d_&quot;    &quot;_$$ESDAY^%ZAPM.ed.BSsFUNR(6,d)</Data>
</Node>
<Node><Sub>4</Sub>
<Data>d_&quot;    &quot;_$$ESDAY^%ZAPM.ed.BSsFUNR(6,d)</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Data>@@@@ .... REMOTE IP-ADDRES@1,75@@@ 2-Й ИНДЕКСНЫЙ@2;6;37;44@@@@@REMOTE_ADDR@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data><![CDATA[@@1@@ .... ВРЕМЯ   ТЕЛЕФОН   АВТОР    СРОЧНОСТЬ....@1,75@@@ 3-Й ИНДЕКСНЫЙ@2;6;37;44@@@@@СИСТЕМНОЕ ВРЕМЯ@@@@@]]></Data>
<Node><Sub>3</Sub>
<Data><![CDATA[S d1=d_"  "_$P($$ESDAY^%ZAPM.ed.BSsFUNR(9,"1,"_d)," ",1)_"  "_$$A^%ZAPM.ed.BSA(3,2,"MAIL","%BSC","","","",+$G(%KEYS(1)),$G(%KEYS(2)),$G(d0))_"  "_$$A^%ZAPM.ed.BSA(2,2,"MAIL","%BSC","","","",+$G(%KEYS(1)),$G(%KEYS(2)),$G(d0))_"  "_$$A^%ZAPM.ed.BSA(4,2,"MAIL","%BSC","","","",+$G(%KEYS(1)),$G(%KEYS(2)),$G(d0))]]></Data>
</Node>
<Node><Sub>4</Sub>
<Data><![CDATA[d_"  "_$P($$ESDAY^%ZAPM.ed.BSsFUNR(9,"1,"_d)," ",1)_"  "_{3,2,"MAIL","%BSC","","","",+$G(%KEYS(1)),$G(%KEYS(2)),$G(d0)}_"  "_{2,2,"MAIL","%BSC","","","",+$G(%KEYS(1)),$G(%KEYS(2)),$G(d0)}_"  "_{4,2,"MAIL","%BSC","","","",+$G(%KEYS(1)),$G(%KEYS(2)),$G(d0)}]]></Data>
</Node>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>60431,42891,</Data>
</Node>
<Node><Sub>STA</Sub>
<Data>2,2@2@2@27@-1@-1@3@21@</Data>
</Node>
</Node>
<Node><Sub>PROTECT</Sub>
<Data><![CDATA[ПОЛЬЗОВАТЕЛИ %BS+Cache' (НОВАЯ КОНЦЕПЦИЯ)@@@@@1@1@1@1@22@80@1@@1@1@@2@@2,2@1@@@@@1@@@6@2@@2;6;30;43@@@@@@]]></Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@2@30@@@@@1@@@@@@   БАЗА ДАННЫХ ПОЛЬЗОВАТЕЛЕЙ</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@31@2@49@@@@0@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@30@@@@@1@@@@@@     ПОЛНОЕ ИМЯ ПОЛЬЗОВАТЕЛЯ@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@31@1@49@@@@@2@2;6;30;42@@@@@@@@FNM</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>4@1@1@30@@@@@1@@@@@@    КОНТРОЛЬНАЯ СУММА ПАРОЛЯ@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>4@31@1@49@1@@@0@2@2;6;33;41@@@@@@@@PSW</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>5@1@1@30@@@@@1@@@@@@          ГРАНД ПОЛЬЗОВАТЕЛЯ@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>5@31@1@49@@@@@2@2;6;30;42@@@@GRAND,%BSC,%SYS,,,&lt;&gt;@@@@GRAND</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>6@1@1@30@@@@@1@@@@@@      ФИКСИРОВАННЫЙ IP-АДРЕС@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>6@31@1@49@@@@@2@2;6;30;42@@@@@@@@IP</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>7@1@1@30@@@@@1@@@@@@  ИМЯ СИСТЕМЫ MSM-СЕРИЙНЫЙ №@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>7@31@1@49@@@@@2@2;6;30;42@@@@@@@@MSM</Data>
</Node>
</Node>
<Node><Sub>Compile</Sub>
<Data>OK 11:54:52 2006-06-15</Data>
</Node>
<Node><Sub>FTR</Sub>
<Node><Sub>1</Sub>
<Node><Sub>2</Sub>
<Data>S d1=&quot;  &quot;_$G(k1,&quot;?&quot;)</Data>
<Node><Sub>1</Sub>
<Data>&quot;  &quot;_$G(k1,&quot;?&quot;)</Data>
</Node>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>2</Sub>
<Data>S d1=d I d=&quot;&quot;,$G(k1)&apos;=&quot;&quot; S d1=$$CRC^%ZAPM.ed.BSCp(k1,&quot;&quot;),@BSD@(k1,&quot;PSW&quot;)=d1</Data>
<Node><Sub>1</Sub>
<Data>d I d=&quot;&quot;,$G(k1)&apos;=&quot;&quot; S d1=$$CRC^%ZAPM.ed.BSCp(k1,&quot;&quot;),@BSD@(k1,&quot;PSW&quot;)=d1</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>Free</Sub>
<Data>60774,66687</Data>
</Node>
<Node><Sub>KEY</Sub>
<Data>^[&quot;%SYS&quot;,&quot;&quot;]%BScPROT</Data>
<Node><Sub>1</Sub>
<Data>@@@@НОВОЕ ИМЯ@1,79@@@ 1-Й ИНДЕКСНЫЙ@2;6;30;42@@@@@Введите LOGIN пользователя@@@@@</Data>
<Node><Sub>3</Sub>
<Data><![CDATA[S d1=$$JF^%ZAPM.ed.BSC4r4($G(d0),15)_$$JF^%ZAPM.ed.BSC4r4($$A^%ZAPM.ed.BSA(4,2,"PROTECT","%BSC","","","",$G(d0)),30)_$$A^%ZAPM.ed.BSA(2,2,"PROTECT","%BSC","","","",$G(d0))]]></Data>
</Node>
<Node><Sub>4</Sub>
<Data><![CDATA[$$JF^%ZAPM.ed.BSC4r4($G(d0),15)_$$JF^%ZAPM.ed.BSC4r4({4,2,"PROTECT","%BSC","","","",$G(d0)},30)_{2,2,"PROTECT","%BSC","","","",$G(d0)}]]></Data>
</Node>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>60774,66687,0095</Data>
</Node>
<Node><Sub>STA</Sub>
<Data>3,2@2@2@13@-1@-1@4@31@</Data>
</Node>
</Node>
<Node><Sub>PROTECTM</Sub>
<Data><![CDATA[ОБЩЕСИСТЕМНЫЕ БАЗЫ ДАННЫХ@@@@@1@1@6@11@22@65@@@@@1@7@@@1@@@@@1@@@17@1@@2;6;30;46@@@1@@@@@@@MENU^%ZAPM.ed.BSF11]]></Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@55@@@@0@1@2;6;31;46@@@@^[&quot;%SYS&quot;]%BSC(&quot;PROTECT&quot;)@РЕДАКТИРОВАТЬ БД ПОЛЬЗОВАТЕЛЕЙ</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@55@@@@1,1@1@2;6;35;46@@@@2,1@СМЕНА ПАРОЛЯ В БД ПОЛЬЗОВАТЕЛЕЙ@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@55@@@@1,1@1@@@@@^[&quot;%SYS&quot;]%BSC(&quot;GRAND&quot;)@РЕДАКТИРОВАТЬ БД ГРАНДОВ ПОЛЬЗОВАТЕЛЕЙ</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>4@1@1@55@@@@1,1@1@@@@@^[&quot;%SYS&quot;]%BSC(&quot;GRANDAPP&quot;)@РЕДАКТИРОВАТЬ БД ГРАНДОВ ПРИЛОЖЕНИЙ@</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>5@1@1@55@@@@1,1@1@2;6;31;46@@@@^[&quot;%SYS&quot;]%BSC(&quot;BSG&quot;)@ССЫЛКИ ДЛЯ WEB ПРИЛОЖЕНИЙ ?BSG=REFENSE@</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data><![CDATA[6@1@1@55@@@@1,1@1@2;6;34;46@@@@^["%SYS",""]BSC4.ISS("AppAccess")@ШАБЛОН ПРАВ ДОСТУПА ДЛЯ ПОЛЬЗОВАТЕЛЕЙ@]]></Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>7@1@1@55@@@@1,1@1@2;6;34;46@@@@^[&quot;%SYS&quot;,&quot;&quot;]BSC4.ISS(&quot;Setup&quot;)@ШАБЛОН ОБЩЕСИСТЕМНЫХ ПАРАМЕТРОВ@</Data>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>1</Sub>
<Data>8@1@1@55@@@@1,1@1@@@@@^[&quot;%SYS&quot;]%BSC(&quot;HELP&quot;)@Обобщенная База ДОКУМЕНТАЦИИ ПО КОМПЛЕКСУ@</Data>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>1</Sub>
<Data><![CDATA[9@1@1@55@@@@0@1@2;6;31;46@@@@^["%SYS",""]%BSC4("PIN")@РЕДАКТИРОВАТЬ БД ПОЛЬЗОВАТЕЛЬСКИХ ИДЕНТИФИКАТОРОВ]]></Data>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>1</Sub>
<Data>10@1@1@55@@@@1,1@1@@@@@^[&quot;%SYS&quot;]%BSC(&quot;MAIL&quot;)@Сообщение Администратору@</Data>
</Node>
</Node>
<Node><Sub>11</Sub>
<Node><Sub>1</Sub>
<Data>11@1@1@55@@@@1,1@1@2;6;31;46@@@@^[&quot;%SYS&quot;,&quot;&quot;]%BSC4(&quot;SESSIONS&quot;)@БД поддержания Сессий@</Data>
</Node>
</Node>
<Node><Sub>12</Sub>
<Node><Sub>1</Sub>
<Data>12@1@1@55@@@@0@1@2;6;31;46@@@@^[&quot;%SYS&quot;,&quot;&quot;]%BSC4(&quot;PROTECT&quot;)@РЕДАКТИРОВАТЬ БД ПОЛЬЗОВАТЕЛЕЙ-2</Data>
</Node>
</Node>
<Node><Sub>13</Sub>
<Node><Sub>1</Sub>
<Data><![CDATA[13@1@1@55@@@@0@1@2;6;31;46@@@@^["%SYS",""]%BSVOL("PROTOKOL")@РЕДАКТИРОВАТЬ БД ПРОТОКОЛА СИСТЕМНЫХ ИЗМЕНЕНИЙ]]></Data>
</Node>
</Node>
<Node><Sub>14</Sub>
<Node><Sub>1</Sub>
<Data>14@1@1@55@@@@0@1@2;6;31;46@@@@^[&quot;%SYS&quot;,&quot;&quot;]%BSC4(&quot;Profile&quot;)@РЕДАКТИРОВАТЬ БД ПРОФИЛЕЙ РАБОЧИХ ГРУПП</Data>
</Node>
</Node>
<Node><Sub>15</Sub>
<Node><Sub>1</Sub>
<Data>15@1@1@55@@@@0@1@2;6;31;46@@@@^[&quot;%SYS&quot;,&quot;&quot;]%BSC4(&quot;GRAND&quot;)@РЕДАКТИРОВАТЬ БД ГРАНДОВ ИнфоПортала</Data>
</Node>
</Node>
<Node><Sub>16</Sub>
<Node><Sub>1</Sub>
<Data>16@1@1@55@@@@0@1@2;6;31;46@@@@^[&quot;%SYS&quot;,&quot;&quot;]%BSC4(&quot;IP&quot;)@РЕДАКТИРОВАТЬ БД IP-АДРЕСОВ</Data>
</Node>
</Node>
<Node><Sub>17</Sub>
<Node><Sub>1</Sub>
<Data>17@1@1@55@@@@0@1@2;6;31;46@@@@^[&quot;%SYS&quot;,&quot;&quot;]%BSC4(&quot;SMTP&quot;)@КОНФИГУРАЦИЯ УДАЛЕННЫХ ПОЧТОВЫХ СЕРВЕРОВ</Data>
</Node>
</Node>
<Node><Sub>CMD</Sub>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>D NEW^%ZAPM.ed.BSCp</Data>
</Node>
</Node>
</Node>
<Node><Sub>FTR</Sub>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>12</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>13</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>14</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>15</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>16</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>17</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>60545,71820,Styx</Data>
</Node>
<Node><Sub>STA</Sub>
<Data>16,1@1@1@27@-1@-1@21@11@РЕДАКТИРОВАТЬ БД IP-АДРЕСОВ</Data>
</Node>
</Node>
<Node><Sub>SESSIONS</Sub>
<Data>База поддержания Сессий@@@@@1@1@1@1@22@80@1@@1@@@2@@2,2@1@@@@@1@@@5@2@@@@@@@@</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@2@20@@@@@1@2;6;35;42@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@21@2@53@@@@0@1@2;6;35;42@@@@@@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@20@@@@@1@2;6;35;42@@@@@ ОТКРЫТА СЕССИЯ</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@21@1@53@@@@@2@1;6;32;40@@@@@@@@OHR@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>4@1@1@20@@@@@1@2;6;35;42@@@@@ СЕССИЯ ЗАКРЫТА@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>4@21@1@53@@@@@2@1;6;32;40@@@@@@@@CHR</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>5@1@1@20@@@@@1@2;6;35;42@@@@@   ИМЯ ПОЛЬЗОВАТЕЛЯ@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>5@21@1@53@@@@@2@1;6;32;40@@@@@@@@NM</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>6@1@1@20@@@@@1@2;6;35;42@@@@@          АДРЕС IP@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>6@21@1@53@@@@@2@1;6;32;40@@@@@@@@IP</Data>
</Node>
</Node>
<Node><Sub>Compile</Sub>
<Data>OK 11:54:52 2006-06-15</Data>
</Node>
<Node><Sub>FTR</Sub>
<Node><Sub>1</Sub>
<Node><Sub>2</Sub>
<Data>S d1=&quot;ССЫЛКА &quot;_$G(k1,&quot;?&quot;)</Data>
<Node><Sub>1</Sub>
<Data>&quot;ССЫЛКА &quot;_$G(k1,&quot;?&quot;)</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>Free</Sub>
<Data>58570,56875</Data>
</Node>
<Node><Sub>KEY</Sub>
<Data>^[&quot;%SYS&quot;]%BScS</Data>
<Node><Sub>1</Sub>
<Data>@@@@ID SESSION@1,70@@@ 1-Й ИНДЕКСНЫЙ@2;6;30;42@@@@@New ID Session@@@@@</Data>
<Node><Sub>3</Sub>
<Data><![CDATA[S d1=d_"    '"_$$A^%ZAPM.ed.BSA(4,2,"SESSIONS","%BSC","","","",$G(d0))_"' из "_$$A^%ZAPM.ed.BSA(5,2,"SESSIONS","%BSC","","","",$G(d0))]]></Data>
</Node>
<Node><Sub>4</Sub>
<Data>d_&quot;    &apos;&quot;_{4,2,&quot;SESSIONS&quot;,&quot;%BSC&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;,$G(d0)}_&quot;&apos; из &quot;_{5,2,&quot;SESSIONS&quot;,&quot;%BSC&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;,$G(d0)}</Data>
</Node>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>60431,42892,</Data>
</Node>
<Node><Sub>STA</Sub>
<Data>2,2@2@2@27@-1@-1@3@21@</Data>
</Node>
</Node>
<Node><Sub>STRUCT</Sub>
<Data><![CDATA[ОПИСАНИЕ СТРУКТУРЫ ТАБЛИЦЫ %BS ДЛЯ CACHE'@@@@@@@1@1@22@80@@@@1@@5@@@1@@@ 1@@@@@28@@@1;6;37;44//1;6;36;40@@@@@@@1]]></Data>
<Node><Sub>1</Sub>
<Data></Data>
</Node>
<Node><Sub>2</Sub>
<Data>            ОПИСАНИЕ СТРУКТУРЫ ТАБЛИЦЫ %BS ДЛЯ CFCHE&apos;</Data>
</Node>
<Node><Sub>3</Sub>
<Data>------------------------------------------------------</Data>
</Node>
<Node><Sub>4</Sub>
<Data></Data>
</Node>
<Node><Sub>5</Sub>
<Data>^BSR(BST,&quot;Metod&quot;)=&quot;Код специального метода&quot; - ГЕНЕРИТСЯ ПРИ КОМПИЛЯЦИИ</Data>
</Node>
<Node><Sub>6</Sub>
<Data>                  ОБЪЕКТОВ БАЗЫ ДАННЫХ </Data>
</Node>
<Node><Sub>7</Sub>
<Data></Data>
</Node>
<Node><Sub>8</Sub>
<Data>^BSR(BST,&quot;OPT&quot;)=1 ТАБЛИЦА ОПЦИЙ 5-КОЛОНОЧНАЯ</Data>
</Node>
<Node><Sub>9</Sub>
<Data>                  или  =X1,X2,Y</Data>
</Node>
<Node><Sub>10</Sub>
<Data></Data>
</Node>
<Node><Sub>11</Sub>
<Data>^BSR(BST,&quot;B4I&quot;)=1@2@                 ;ПАРАМЕТРЫ ПОРТАЛА B4I</Data>
</Node>
<Node><Sub>12</Sub>
<Data>   1= СОХРАНЯТЬ ЛИ ДАННЫЕ ИНФОРМАЦИОННОГО МАССИВА ПРИ ПЕРЕКОМПИЛЯЦИИ</Data>
</Node>
<Node><Sub>13</Sub>
<Data>   </Data>
</Node>
<Node><Sub>14</Sub>
<Data>^BSR(BST,I,J)=...@21                 ;ПАРАМЕТРЫ ПОРТАЛА B4I</Data>
</Node>
<Node><Sub>15</Sub>
<Data>   21 = 0 ТИП ПРЕДСТАВЛЕНИЯ ДАННЫХ В ФОРМАТЕ &lt;INPUT ...text</Data>
</Node>
<Node><Sub>16</Sub>
<Data>        1  &lt;TEXTAREA ...</Data>
</Node>
<Node><Sub>17</Sub>
<Data>        2 radio</Data>
</Node>
<Node><Sub>18</Sub>
<Data>        3 checkbox</Data>
</Node>
<Node><Sub>19</Sub>
<Data>        4 data</Data>
</Node>
<Node><Sub>20</Sub>
<Data>        5 data,time</Data>
</Node>
<Node><Sub>21</Sub>
<Data>        6 time</Data>
</Node>
<Node><Sub>22</Sub>
<Data></Data>
</Node>
<Node><Sub>23</Sub>
<Data>^BSR(BST,&quot;KEY&quot;)=^BASEDATE  - БАЗА ДАННЫХ ДЛЯ ТАБЛИЦЫ</Data>
</Node>
<Node><Sub>24</Sub>
<Data>                 1   2  3 4  5    6   7   10  12 13 14  15 16  20</Data>
</Node>
<Node><Sub>25</Sub>
<Data>^BSR(BST,&quot;KEY&quot;,1)=@@@@@@@@ ...</Data>
</Node>
<Node><Sub>26</Sub>
<Data>        21 ТИП ПРЕДСТАВЛЕНИЯ ДАННЫХ В ФОРМАТЕ (см выше)</Data>
</Node>
<Node><Sub>27</Sub>
<Data>        22 - имя поля для объекта Ка&apos;ши</Data>
</Node>
<Node><Sub>28</Sub>
<Data>        </Data>
</Node>
</Node>
<Node><Sub>T132X48</Sub>
<Data><![CDATA[ЧТО на ЧТО прокачивать в программе 123^%ZAPM.ed.BSC4r2@@@@@@@1@1@22@80@@@@1@@5@@@1@@@ 1@@@@@16@@@1;6;37;44//1;6;36;40@@@@@@@1]]></Data>
<Node><Sub>1</Sub>
<Data>1@1@22@80|1@1@45@132</Data>
</Node>
<Node><Sub>2</Sub>
<Data>/CUP(23,|/CUP(46,</Data>
</Node>
<Node><Sub>3</Sub>
<Data>/CUP(24,|/CUP(47,</Data>
</Node>
<Node><Sub>4</Sub>
<Data>/CUP(25,|/CUP(48,</Data>
</Node>
<Node><Sub>5</Sub>
<Data>st=80,ks=25|st=132,ks=48</Data>
</Node>
<Node><Sub>6</Sub>
<Data>;25;80w|;48;132w</Data>
</Node>
<Node><Sub>7</Sub>
<Data>1,1,25,80|1,1,48,132</Data>
</Node>
<Node><Sub>8</Sub>
<Data>1,79)|1,132)</Data>
</Node>
<Node><Sub>9</Sub>
<Data>%Y2=25,%X2=80|%Y2=48,%X2=132</Data>
</Node>
<Node><Sub>10</Sub>
<Data>0:(80:&quot;&quot;)|0:(132:&quot;&quot;)</Data>
</Node>
<Node><Sub>11</Sub>
<Data>,XX=80|,XX=132</Data>
</Node>
<Node><Sub>12</Sub>
<Data>:1:25 |:1:48 </Data>
</Node>
<Node><Sub>13</Sub>
<Data>XX&gt;80|XX&gt;132</Data>
</Node>
<Node><Sub>14</Sub>
<Data>80-(i=25)|132-(i=48)</Data>
</Node>
<Node><Sub>15</Sub>
<Data>1,80)|1,132)</Data>
</Node>
<Node><Sub>16</Sub>
<Data>1,79)|1,131)</Data>
</Node>
</Node>
<Node><Sub>TEST</Sub>
<Data>заготовка стандаpтной таблицы@@1@@@1@1@1@1@22@80@1@@1@1@@2@@@1@@@@@1@@@16@21@@@@@@@@@@@@@@1</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@1@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@2@1@8@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>1@10@1@1@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>1@11@1@6@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>1@17@1@1@@@@@1@@@@@@С</Data>
</Node>
<Node><Sub>6</Sub>
<Data>1@18@1@6@@@@@1@@@@@@ТАНДАР</Data>
</Node>
<Node><Sub>7</Sub>
<Data>1@24@1@1@@@@@1@@@@@@Т</Data>
</Node>
<Node><Sub>8</Sub>
<Data>1@25@1@6@@@@@1@@@@@@НАЯ</Data>
</Node>
<Node><Sub>9</Sub>
<Data>1@31@1@1@@@@@1@@@@@@Э</Data>
</Node>
<Node><Sub>10</Sub>
<Data>1@32@1@6@@@@@1@@@@@@ЛЕКТРОН</Data>
</Node>
<Node><Sub>11</Sub>
<Data>1@38@1@1@@@@@1@@@@@@Н</Data>
</Node>
<Node><Sub>12</Sub>
<Data>1@39@1@6@@@@@1@@@@@@НАЯ</Data>
</Node>
<Node><Sub>13</Sub>
<Data>1@45@1@1@@@@@1@@@@@@Т</Data>
</Node>
<Node><Sub>14</Sub>
<Data>1@46@1@6@@@@@1@@@@@@АБЛИЦА</Data>
</Node>
<Node><Sub>15</Sub>
<Data>1@52@1@1@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>16</Sub>
<Data>1@53@1@6@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>17</Sub>
<Data>1@59@1@1@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>18</Sub>
<Data>1@60@1@6@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>19</Sub>
<Data>1@66@1@1@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>20</Sub>
<Data>1@67@1@7@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>21</Sub>
<Data>1@74@1@1@@@@@1@@@@@@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@1@@@@@1@@@@@@=</Data>
</Node>
<Node><Sub>2</Sub>
<Data>2@2@1@8@@@@0@1@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>2@10@1@1@@@@@1@@@@@@=</Data>
</Node>
<Node><Sub>4</Sub>
<Data>2@11@1@6@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>2@17@1@1@@@@@1@@@@@@-</Data>
</Node>
<Node><Sub>6</Sub>
<Data>2@18@1@6@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>7</Sub>
<Data>2@24@1@1@@@@@1@@@@@@-</Data>
</Node>
<Node><Sub>8</Sub>
<Data>2@25@1@6@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>9</Sub>
<Data>2@31@1@1@@@@@1@@@@@@-</Data>
</Node>
<Node><Sub>10</Sub>
<Data>2@32@1@6@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>11</Sub>
<Data>2@38@1@1@@@@@1@@@@@@-</Data>
</Node>
<Node><Sub>12</Sub>
<Data>2@39@1@6@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>13</Sub>
<Data>2@45@1@1@@@@@1@@@@@@-</Data>
</Node>
<Node><Sub>14</Sub>
<Data>2@46@1@6@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>15</Sub>
<Data>2@52@1@1@@@@@1@@@@@@-</Data>
</Node>
<Node><Sub>16</Sub>
<Data>2@53@1@6@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>17</Sub>
<Data>2@59@1@1@@@@@1@@@@@@-</Data>
</Node>
<Node><Sub>18</Sub>
<Data>2@60@1@6@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>19</Sub>
<Data>2@66@1@1@@@@@1@@@@@@-</Data>
</Node>
<Node><Sub>20</Sub>
<Data>2@67@1@7@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>21</Sub>
<Data>2@74@1@1@@@@@1@@@@@@=</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>3@1@3@1@@@@0@1@@@@@@|||</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@2@3@8@@@@@1@@@@@@QWQW</Data>
</Node>
<Node><Sub>3</Sub>
<Data>3@10@3@1@@@@3,1@1@@@@@@|||</Data>
</Node>
<Node><Sub>4</Sub>
<Data>3@11@3@6@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>3@17@3@1@@@@0@1@@@@@@|||</Data>
</Node>
<Node><Sub>6</Sub>
<Data>3@18@3@6@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>7</Sub>
<Data>3@24@3@1@@@@3,5@1@@@@@@|||</Data>
</Node>
<Node><Sub>8</Sub>
<Data>3@25@3@6@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>9</Sub>
<Data>3@31@3@1@@@@3,5@1@@@@@@|||</Data>
</Node>
<Node><Sub>10</Sub>
<Data>3@32@3@6@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>11</Sub>
<Data>3@38@3@1@@@@3,5@1@@@@@@|||</Data>
</Node>
<Node><Sub>12</Sub>
<Data>3@39@3@6@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>13</Sub>
<Data>3@45@3@1@@@@3,5@1@@@@@@|||</Data>
</Node>
<Node><Sub>14</Sub>
<Data>3@46@3@6@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>15</Sub>
<Data>3@52@3@1@@@@3,5@1@@@@@@|||</Data>
</Node>
<Node><Sub>16</Sub>
<Data>3@53@3@6@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>17</Sub>
<Data>3@59@3@1@@@@3,5@1@@@@@@|||</Data>
</Node>
<Node><Sub>18</Sub>
<Data>3@60@3@6@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>19</Sub>
<Data>3@66@3@1@@@@3,5@1@@@@@@|||</Data>
</Node>
<Node><Sub>20</Sub>
<Data>3@67@3@7@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>21</Sub>
<Data>3@74@3@1@@@@3,1@1@@@@@@|||</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>6@1@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>2</Sub>
<Data>6@2@1@8@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>6@10@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>4</Sub>
<Data>6@11@1@6@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>6@17@1@1@@@@@1@@@@@@=</Data>
</Node>
<Node><Sub>6</Sub>
<Data>6@18@1@6@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>7</Sub>
<Data>6@24@1@1@@@@@1@@@@@@=</Data>
</Node>
<Node><Sub>8</Sub>
<Data>6@25@1@6@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>9</Sub>
<Data>6@31@1@1@@@@@1@@@@@@=</Data>
</Node>
<Node><Sub>10</Sub>
<Data>6@32@1@6@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>11</Sub>
<Data>6@38@1@1@@@@@1@@@@@@=</Data>
</Node>
<Node><Sub>12</Sub>
<Data>6@39@1@6@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>13</Sub>
<Data>6@45@1@1@@@@@1@@@@@@=</Data>
</Node>
<Node><Sub>14</Sub>
<Data>6@46@1@6@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>15</Sub>
<Data>6@52@1@1@@@@@1@@@@@@=</Data>
</Node>
<Node><Sub>16</Sub>
<Data>6@53@1@6@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>17</Sub>
<Data>6@59@1@1@@@@@1@@@@@@=</Data>
</Node>
<Node><Sub>18</Sub>
<Data>6@60@1@6@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>19</Sub>
<Data>6@66@1@1@@@@@1@@@@@@=</Data>
</Node>
<Node><Sub>20</Sub>
<Data>6@67@1@7@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>21</Sub>
<Data>6@74@1@1@@@@@1@@@@@@|</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>7@1@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>2</Sub>
<Data>7@2@1@8@@@@@1@@@@@@  1</Data>
</Node>
<Node><Sub>3</Sub>
<Data>7@10@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>4</Sub>
<Data>7@11@1@6@@@@@1@@@@@@   2</Data>
</Node>
<Node><Sub>5</Sub>
<Data>7@17@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>6</Sub>
<Data>7@18@1@6@@@@@1@@@@@@  3</Data>
</Node>
<Node><Sub>7</Sub>
<Data>7@24@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>8</Sub>
<Data>7@25@1@6@@@@@1@@@@@@  4</Data>
</Node>
<Node><Sub>9</Sub>
<Data>7@31@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>10</Sub>
<Data>7@32@1@6@@@@@1@@@@@@  5</Data>
</Node>
<Node><Sub>11</Sub>
<Data>7@38@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>12</Sub>
<Data>7@39@1@6@@@@@1@@@@@@  6</Data>
</Node>
<Node><Sub>13</Sub>
<Data>7@45@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>14</Sub>
<Data>7@46@1@6@@@@@1@@@@@@  7</Data>
</Node>
<Node><Sub>15</Sub>
<Data>7@52@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>16</Sub>
<Data>7@53@1@6@@@@@1@@@@@@  8</Data>
</Node>
<Node><Sub>17</Sub>
<Data>7@59@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>18</Sub>
<Data>7@60@1@6@@@@@1@@@@@@  9</Data>
</Node>
<Node><Sub>19</Sub>
<Data>7@66@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>20</Sub>
<Data>7@67@1@7@@@@@1@@@@@@  10</Data>
</Node>
<Node><Sub>21</Sub>
<Data>7@74@1@1@@@@@1@@@@@@|</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>8@1@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>2</Sub>
<Data>8@2@1@8@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>8@10@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>4</Sub>
<Data>8@11@1@6@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>8@17@1@1@@@@@1@@@@@@=</Data>
</Node>
<Node><Sub>6</Sub>
<Data>8@18@1@6@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>7</Sub>
<Data>8@24@1@1@@@@@1@@@@@@=</Data>
</Node>
<Node><Sub>8</Sub>
<Data>8@25@1@6@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>9</Sub>
<Data>8@31@1@1@@@@@1@@@@@@=</Data>
</Node>
<Node><Sub>10</Sub>
<Data>8@32@1@6@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>11</Sub>
<Data>8@38@1@1@@@@@1@@@@@@=</Data>
</Node>
<Node><Sub>12</Sub>
<Data>8@39@1@6@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>13</Sub>
<Data>8@45@1@1@@@@@1@@@@@@=</Data>
</Node>
<Node><Sub>14</Sub>
<Data>8@46@1@6@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>15</Sub>
<Data>8@52@1@1@@@@@1@@@@@@=</Data>
</Node>
<Node><Sub>16</Sub>
<Data>8@53@1@6@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>17</Sub>
<Data>8@59@1@1@@@@@1@@@@@@=</Data>
</Node>
<Node><Sub>18</Sub>
<Data>8@60@1@6@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>19</Sub>
<Data>8@66@1@1@@@@@1@@@@@@=</Data>
</Node>
<Node><Sub>20</Sub>
<Data>8@67@1@7@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>21</Sub>
<Data>8@74@1@1@@@@@1@@@@@@|</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>9@1@1@1@@@@0@1@@@@@@|</Data>
</Node>
<Node><Sub>2</Sub>
<Data>9@2@1@8@@@@@1@@@@@@ASAS</Data>
</Node>
<Node><Sub>3</Sub>
<Data>9@10@1@1@@@@7,1@1@@@@@@|</Data>
</Node>
<Node><Sub>4</Sub>
<Data>9@11@1@6@@@@@2@@@1@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>9@17@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>6</Sub>
<Data>9@18@1@6@@@@@2@@@1@@@</Data>
</Node>
<Node><Sub>7</Sub>
<Data>9@24@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>8</Sub>
<Data>9@25@1@6@@@@@2@@@1@@@</Data>
</Node>
<Node><Sub>9</Sub>
<Data>9@31@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>10</Sub>
<Data>9@32@1@6@@@@@2@@@1@@@</Data>
</Node>
<Node><Sub>11</Sub>
<Data>9@38@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>12</Sub>
<Data>9@39@1@6@@@@@2@@@1@@@</Data>
</Node>
<Node><Sub>13</Sub>
<Data>9@45@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>14</Sub>
<Data>9@46@1@6@@@@@2@@@1@@@</Data>
</Node>
<Node><Sub>15</Sub>
<Data>9@52@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>16</Sub>
<Data>9@53@1@6@@@@@2@@@1@@@</Data>
</Node>
<Node><Sub>17</Sub>
<Data>9@59@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>18</Sub>
<Data>9@60@1@6@@@@@2@@@1@@@</Data>
</Node>
<Node><Sub>19</Sub>
<Data>9@66@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>20</Sub>
<Data>9@67@1@7@@@@@2@@@1@@@</Data>
</Node>
<Node><Sub>21</Sub>
<Data>9@74@1@1@@@@7,1@1@@@@@@|</Data>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>1</Sub>
<Data>10@1@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>2</Sub>
<Data>10@2@1@8@@@@0@1@@@@@@---</Data>
</Node>
<Node><Sub>3</Sub>
<Data>10@10@1@1@@@@@1@@@@@@-</Data>
</Node>
<Node><Sub>4</Sub>
<Data>10@11@1@6@@@@8,2@1@@@@@@------</Data>
</Node>
<Node><Sub>5</Sub>
<Data>10@17@1@1@@@@@1@@@@@@+</Data>
</Node>
<Node><Sub>6</Sub>
<Data>10@18@1@6@@@@8,2@1@@@@@@------</Data>
</Node>
<Node><Sub>7</Sub>
<Data>10@24@1@1@@@@@1@@@@@@+</Data>
</Node>
<Node><Sub>8</Sub>
<Data>10@25@1@6@@@@8,2@1@@@@@@------</Data>
</Node>
<Node><Sub>9</Sub>
<Data>10@31@1@1@@@@@1@@@@@@+</Data>
</Node>
<Node><Sub>10</Sub>
<Data>10@32@1@6@@@@8,2@1@@@@@@------</Data>
</Node>
<Node><Sub>11</Sub>
<Data>10@38@1@1@@@@@1@@@@@@+</Data>
</Node>
<Node><Sub>12</Sub>
<Data>10@39@1@6@@@@8,2@1@@@@@@------</Data>
</Node>
<Node><Sub>13</Sub>
<Data>10@45@1@1@@@@@1@@@@@@+</Data>
</Node>
<Node><Sub>14</Sub>
<Data>10@46@1@6@@@@8,2@1@@@@@@------</Data>
</Node>
<Node><Sub>15</Sub>
<Data>10@52@1@1@@@@@1@@@@@@+</Data>
</Node>
<Node><Sub>16</Sub>
<Data>10@53@1@6@@@@8,2@1@@@@@@------</Data>
</Node>
<Node><Sub>17</Sub>
<Data>10@59@1@1@@@@@1@@@@@@+</Data>
</Node>
<Node><Sub>18</Sub>
<Data>10@60@1@6@@@@8,2@1@@@@@@------</Data>
</Node>
<Node><Sub>19</Sub>
<Data>10@66@1@1@@@@@1@@@@@@+</Data>
</Node>
<Node><Sub>20</Sub>
<Data>10@67@1@7@@@@8,2@1@@@@@@-------</Data>
</Node>
<Node><Sub>21</Sub>
<Data>10@74@1@1@@@@@1@@@@@@|</Data>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>1</Sub>
<Data>11@1@1@1@@@@7,1@1@@@@@@|</Data>
</Node>
<Node><Sub>2</Sub>
<Data>11@2@1@8@@@@@1@@@@@@ASA</Data>
</Node>
<Node><Sub>3</Sub>
<Data>11@10@1@1@@@@7,1@1@@@@@@|</Data>
</Node>
<Node><Sub>4</Sub>
<Data>11@11@1@6@@@@@2@@@1@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>11@17@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>6</Sub>
<Data>11@18@1@6@@@@@2@@@1@@@</Data>
</Node>
<Node><Sub>7</Sub>
<Data>11@24@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>8</Sub>
<Data>11@25@1@6@@@@@2@@@1@@@</Data>
</Node>
<Node><Sub>9</Sub>
<Data>11@31@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>10</Sub>
<Data>11@32@1@6@@@@@2@@@1@@@</Data>
</Node>
<Node><Sub>11</Sub>
<Data>11@38@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>12</Sub>
<Data>11@39@1@6@@@@@2@@@1@@@</Data>
</Node>
<Node><Sub>13</Sub>
<Data>11@45@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>14</Sub>
<Data>11@46@1@6@@@@@2@@@1@@@</Data>
</Node>
<Node><Sub>15</Sub>
<Data>11@52@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>16</Sub>
<Data>11@53@1@6@@@@@2@@@1@@@</Data>
</Node>
<Node><Sub>17</Sub>
<Data>11@59@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>18</Sub>
<Data>11@60@1@6@@@@@2@@@1@@@</Data>
</Node>
<Node><Sub>19</Sub>
<Data>11@66@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>20</Sub>
<Data>11@67@1@7@@@@@2@@@1@@@</Data>
</Node>
<Node><Sub>21</Sub>
<Data>11@74@1@1@@@@7,1@1@@@@@@|</Data>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>1</Sub>
<Data>12@1@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>2</Sub>
<Data>12@2@1@8@@@@8,2@1@@@@@@---</Data>
</Node>
<Node><Sub>3</Sub>
<Data>12@10@1@1@@@@@1@@@@@@-</Data>
</Node>
<Node><Sub>4</Sub>
<Data>12@11@1@6@@@@8,2@1@@@@@@------</Data>
</Node>
<Node><Sub>5</Sub>
<Data>12@17@1@1@@@@@1@@@@@@+</Data>
</Node>
<Node><Sub>6</Sub>
<Data>12@18@1@6@@@@8,2@1@@@@@@------</Data>
</Node>
<Node><Sub>7</Sub>
<Data>12@24@1@1@@@@@1@@@@@@+</Data>
</Node>
<Node><Sub>8</Sub>
<Data>12@25@1@6@@@@8,2@1@@@@@@------</Data>
</Node>
<Node><Sub>9</Sub>
<Data>12@31@1@1@@@@@1@@@@@@+</Data>
</Node>
<Node><Sub>10</Sub>
<Data>12@32@1@6@@@@8,2@1@@@@@@------</Data>
</Node>
<Node><Sub>11</Sub>
<Data>12@38@1@1@@@@@1@@@@@@+</Data>
</Node>
<Node><Sub>12</Sub>
<Data>12@39@1@6@@@@8,2@1@@@@@@------</Data>
</Node>
<Node><Sub>13</Sub>
<Data>12@45@1@1@@@@@1@@@@@@+</Data>
</Node>
<Node><Sub>14</Sub>
<Data>12@46@1@6@@@@8,2@1@@@@@@------</Data>
</Node>
<Node><Sub>15</Sub>
<Data>12@52@1@1@@@@@1@@@@@@+</Data>
</Node>
<Node><Sub>16</Sub>
<Data>12@53@1@6@@@@8,2@1@@@@@@------</Data>
</Node>
<Node><Sub>17</Sub>
<Data>12@59@1@1@@@@@1@@@@@@+</Data>
</Node>
<Node><Sub>18</Sub>
<Data>12@60@1@6@@@@8,2@1@@@@@@------</Data>
</Node>
<Node><Sub>19</Sub>
<Data>12@66@1@1@@@@@1@@@@@@+</Data>
</Node>
<Node><Sub>20</Sub>
<Data>12@67@1@7@@@@8,2@1@@@@@@-------</Data>
</Node>
<Node><Sub>21</Sub>
<Data>12@74@1@1@@@@@1@@@@@@|</Data>
</Node>
</Node>
<Node><Sub>11</Sub>
<Node><Sub>1</Sub>
<Data>13@1@1@1@@@@7,1@1@@@@@@|</Data>
</Node>
<Node><Sub>2</Sub>
<Data>13@2@1@8@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>13@10@1@1@@@@7,1@1@@@@@@|</Data>
</Node>
<Node><Sub>4</Sub>
<Data>13@11@1@6@@@@@2@@@1@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>13@17@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>6</Sub>
<Data>13@18@1@6@@@@@2@@@1@@@</Data>
</Node>
<Node><Sub>7</Sub>
<Data>13@24@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>8</Sub>
<Data>13@25@1@6@@@@@2@@@1@@@</Data>
</Node>
<Node><Sub>9</Sub>
<Data>13@31@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>10</Sub>
<Data>13@32@1@6@@@@@2@@@1@@@</Data>
</Node>
<Node><Sub>11</Sub>
<Data>13@38@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>12</Sub>
<Data>13@39@1@6@@@@@2@@@1@@@</Data>
</Node>
<Node><Sub>13</Sub>
<Data>13@45@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>14</Sub>
<Data>13@46@1@6@@@@@2@@@1@@@</Data>
</Node>
<Node><Sub>15</Sub>
<Data>13@52@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>16</Sub>
<Data>13@53@1@6@@@@@2@@@1@@@</Data>
</Node>
<Node><Sub>17</Sub>
<Data>13@59@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>18</Sub>
<Data>13@60@1@6@@@@@2@@@1@@@</Data>
</Node>
<Node><Sub>19</Sub>
<Data>13@66@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>20</Sub>
<Data>13@67@1@7@@@@@2@@@1@@@</Data>
</Node>
<Node><Sub>21</Sub>
<Data>13@74@1@1@@@@7,1@1@@@@@@|</Data>
</Node>
</Node>
<Node><Sub>12</Sub>
<Node><Sub>1</Sub>
<Data>14@1@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>2</Sub>
<Data>14@2@1@8@@@@8,2@1@@@@@@---</Data>
</Node>
<Node><Sub>3</Sub>
<Data>14@10@1@1@@@@@1@@@@@@-</Data>
</Node>
<Node><Sub>4</Sub>
<Data>14@11@1@6@@@@8,2@1@@@@@@------</Data>
</Node>
<Node><Sub>5</Sub>
<Data>14@17@1@1@@@@@1@@@@@@+</Data>
</Node>
<Node><Sub>6</Sub>
<Data>14@18@1@6@@@@8,2@1@@@@@@------</Data>
</Node>
<Node><Sub>7</Sub>
<Data>14@24@1@1@@@@@1@@@@@@+</Data>
</Node>
<Node><Sub>8</Sub>
<Data>14@25@1@6@@@@8,2@1@@@@@@------</Data>
</Node>
<Node><Sub>9</Sub>
<Data>14@31@1@1@@@@@1@@@@@@+</Data>
</Node>
<Node><Sub>10</Sub>
<Data>14@32@1@6@@@@8,2@1@@@@@@------</Data>
</Node>
<Node><Sub>11</Sub>
<Data>14@38@1@1@@@@@1@@@@@@+</Data>
</Node>
<Node><Sub>12</Sub>
<Data>14@39@1@6@@@@8,2@1@@@@@@------</Data>
</Node>
<Node><Sub>13</Sub>
<Data>14@45@1@1@@@@@1@@@@@@+</Data>
</Node>
<Node><Sub>14</Sub>
<Data>14@46@1@6@@@@8,2@1@@@@@@------</Data>
</Node>
<Node><Sub>15</Sub>
<Data>14@52@1@1@@@@@1@@@@@@+</Data>
</Node>
<Node><Sub>16</Sub>
<Data>14@53@1@6@@@@8,2@1@@@@@@------</Data>
</Node>
<Node><Sub>17</Sub>
<Data>14@59@1@1@@@@@1@@@@@@+</Data>
</Node>
<Node><Sub>18</Sub>
<Data>14@60@1@6@@@@8,2@1@@@@@@------</Data>
</Node>
<Node><Sub>19</Sub>
<Data>14@66@1@1@@@@@1@@@@@@+</Data>
</Node>
<Node><Sub>20</Sub>
<Data>14@67@1@7@@@@8,2@1@@@@@@-------</Data>
</Node>
<Node><Sub>21</Sub>
<Data>14@74@1@1@@@@@1@@@@@@|</Data>
</Node>
</Node>
<Node><Sub>13</Sub>
<Node><Sub>1</Sub>
<Data>15@1@1@1@@@@7,1@1@@@@@@|</Data>
</Node>
<Node><Sub>2</Sub>
<Data>15@2@1@8@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>15@10@1@1@@@@7,1@1@@@@@@|</Data>
</Node>
<Node><Sub>4</Sub>
<Data>15@11@1@6@@@@@2@@@1@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>15@17@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>6</Sub>
<Data>15@18@1@6@@@@@2@@@1@@@</Data>
</Node>
<Node><Sub>7</Sub>
<Data>15@24@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>8</Sub>
<Data>15@25@1@6@@@@@2@@@1@@@</Data>
</Node>
<Node><Sub>9</Sub>
<Data>15@31@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>10</Sub>
<Data>15@32@1@6@@@@@2@@@1@@@</Data>
</Node>
<Node><Sub>11</Sub>
<Data>15@38@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>12</Sub>
<Data>15@39@1@6@@@@@2@@@1@@@</Data>
</Node>
<Node><Sub>13</Sub>
<Data>15@45@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>14</Sub>
<Data>15@46@1@6@@@@@2@@@1@@@</Data>
</Node>
<Node><Sub>15</Sub>
<Data>15@52@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>16</Sub>
<Data>15@53@1@6@@@@@2@@@1@@@</Data>
</Node>
<Node><Sub>17</Sub>
<Data>15@59@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>18</Sub>
<Data>15@60@1@6@@@@@2@@@1@@@</Data>
</Node>
<Node><Sub>19</Sub>
<Data>15@66@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>20</Sub>
<Data>15@67@1@7@@@@@2@@@1@@@</Data>
</Node>
<Node><Sub>21</Sub>
<Data>15@74@1@1@@@@7,1@1@@@@@@|</Data>
</Node>
</Node>
<Node><Sub>14</Sub>
<Node><Sub>1</Sub>
<Data>16@1@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>2</Sub>
<Data>16@2@1@8@@@@8,2@1@@@@@@---</Data>
</Node>
<Node><Sub>3</Sub>
<Data>16@10@1@1@@@@@1@@@@@@-</Data>
</Node>
<Node><Sub>4</Sub>
<Data>16@11@1@6@@@@8,2@1@@@@@@------</Data>
</Node>
<Node><Sub>5</Sub>
<Data>16@17@1@1@@@@@1@@@@@@+</Data>
</Node>
<Node><Sub>6</Sub>
<Data>16@18@1@6@@@@8,2@1@@@@@@------</Data>
</Node>
<Node><Sub>7</Sub>
<Data>16@24@1@1@@@@@1@@@@@@+</Data>
</Node>
<Node><Sub>8</Sub>
<Data>16@25@1@6@@@@8,2@1@@@@@@------</Data>
</Node>
<Node><Sub>9</Sub>
<Data>16@31@1@1@@@@@1@@@@@@+</Data>
</Node>
<Node><Sub>10</Sub>
<Data>16@32@1@6@@@@8,2@1@@@@@@------</Data>
</Node>
<Node><Sub>11</Sub>
<Data>16@38@1@1@@@@@1@@@@@@+</Data>
</Node>
<Node><Sub>12</Sub>
<Data>16@39@1@6@@@@8,2@1@@@@@@------</Data>
</Node>
<Node><Sub>13</Sub>
<Data>16@45@1@1@@@@@1@@@@@@+</Data>
</Node>
<Node><Sub>14</Sub>
<Data>16@46@1@6@@@@8,2@1@@@@@@------</Data>
</Node>
<Node><Sub>15</Sub>
<Data>16@52@1@1@@@@@1@@@@@@+</Data>
</Node>
<Node><Sub>16</Sub>
<Data>16@53@1@6@@@@8,2@1@@@@@@------</Data>
</Node>
<Node><Sub>17</Sub>
<Data>16@59@1@1@@@@@1@@@@@@+</Data>
</Node>
<Node><Sub>18</Sub>
<Data>16@60@1@6@@@@8,2@1@@@@@@------</Data>
</Node>
<Node><Sub>19</Sub>
<Data>16@66@1@1@@@@@1@@@@@@+</Data>
</Node>
<Node><Sub>20</Sub>
<Data>16@67@1@7@@@@8,2@1@@@@@@-------</Data>
</Node>
<Node><Sub>21</Sub>
<Data>16@74@1@1@@@@@1@@@@@@|</Data>
</Node>
</Node>
<Node><Sub>15</Sub>
<Node><Sub>1</Sub>
<Data>17@1@1@1@@@@7,1@1@@@@@@|</Data>
</Node>
<Node><Sub>2</Sub>
<Data>17@2@1@8@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>17@10@1@1@@@@7,1@1@@@@@@|</Data>
</Node>
<Node><Sub>4</Sub>
<Data>17@11@1@6@@@@@2@@@1@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>17@17@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>6</Sub>
<Data>17@18@1@6@@@@@2@@@1@@@</Data>
</Node>
<Node><Sub>7</Sub>
<Data>17@24@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>8</Sub>
<Data>17@25@1@6@@@@@2@@@1@@@</Data>
</Node>
<Node><Sub>9</Sub>
<Data>17@31@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>10</Sub>
<Data>17@32@1@6@@@@@2@@@1@@@</Data>
</Node>
<Node><Sub>11</Sub>
<Data>17@38@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>12</Sub>
<Data>17@39@1@6@@@@@2@@@1@@@</Data>
</Node>
<Node><Sub>13</Sub>
<Data>17@45@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>14</Sub>
<Data>17@46@1@6@@@@@2@@@1@@@</Data>
</Node>
<Node><Sub>15</Sub>
<Data>17@52@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>16</Sub>
<Data>17@53@1@6@@@@@2@@@1@@@</Data>
</Node>
<Node><Sub>17</Sub>
<Data>17@59@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>18</Sub>
<Data>17@60@1@6@@@@@2@@@1@@@</Data>
</Node>
<Node><Sub>19</Sub>
<Data>17@66@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>20</Sub>
<Data>17@67@1@7@@@@@2@@@1@@@</Data>
</Node>
<Node><Sub>21</Sub>
<Data>17@74@1@1@@@@7,1@1@@@@@@|</Data>
</Node>
</Node>
<Node><Sub>16</Sub>
<Node><Sub>1</Sub>
<Data>18@1@1@1@@@@@1@@@@@@=</Data>
</Node>
<Node><Sub>2</Sub>
<Data>18@2@1@8@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>18@10@1@1@@@@@1@@@@@@=</Data>
</Node>
<Node><Sub>4</Sub>
<Data>18@11@1@6@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>18@17@1@1@@@@@1@@@@@@=</Data>
</Node>
<Node><Sub>6</Sub>
<Data>18@18@1@6@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>7</Sub>
<Data>18@24@1@1@@@@@1@@@@@@=</Data>
</Node>
<Node><Sub>8</Sub>
<Data>18@25@1@6@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>9</Sub>
<Data>18@31@1@1@@@@@1@@@@@@=</Data>
</Node>
<Node><Sub>10</Sub>
<Data>18@32@1@6@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>11</Sub>
<Data>18@38@1@1@@@@@1@@@@@@=</Data>
</Node>
<Node><Sub>12</Sub>
<Data>18@39@1@6@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>13</Sub>
<Data>18@45@1@1@@@@@1@@@@@@=</Data>
</Node>
<Node><Sub>14</Sub>
<Data>18@46@1@6@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>15</Sub>
<Data>18@52@1@1@@@@@1@@@@@@=</Data>
</Node>
<Node><Sub>16</Sub>
<Data>18@53@1@6@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>17</Sub>
<Data>18@59@1@1@@@@@1@@@@@@=</Data>
</Node>
<Node><Sub>18</Sub>
<Data>18@60@1@6@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>19</Sub>
<Data>18@66@1@1@@@@@1@@@@@@=</Data>
</Node>
<Node><Sub>20</Sub>
<Data>18@67@1@7@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>21</Sub>
<Data>18@74@1@1@@@@@1@@@@@@=</Data>
</Node>
</Node>
<Node><Sub>Compile</Sub>
<Data>OK 11:54:54 2006-06-15</Data>
</Node>
<Node><Sub>FTR</Sub>
<Node><Sub>2</Sub>
<Node><Sub>2</Sub>
<Data>S d1=$TR($J(&quot;&quot;,20),&quot; &quot;,&quot;=&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$TR($J(&quot;&quot;,20),&quot; &quot;,&quot;=&quot;)</Data>
</Node>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$TR($J(&quot;&quot;,10),&quot; &quot;,&quot;|&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$TR($J(&quot;&quot;,10),&quot; &quot;,&quot;|&quot;)</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Data>S d1=$TR($J(&quot;&quot;,10),&quot; &quot;,&quot;|&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$TR($J(&quot;&quot;,10),&quot; &quot;,&quot;|&quot;)</Data>
</Node>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$TR($J(&quot;&quot;,5),&quot; &quot;,&quot;|&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$TR($J(&quot;&quot;,5),&quot; &quot;,&quot;|&quot;)</Data>
</Node>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>2</Sub>
<Data>S d1=$TR($J(&quot;&quot;,20),&quot; &quot;,&quot;-&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$TR($J(&quot;&quot;,20),&quot; &quot;,&quot;-&quot;)</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>Free</Sub>
<Data>59176,66676</Data>
</Node>
<Node><Sub>KEY</Sub>
<Data>^[&quot;%SYS&quot;]TEST</Data>
<Node><Sub>0</Sub>
<Data>@@99@@НОВЫЙ ГОД@1,20@@@ ИМЕННОЙ КЛЮЧ@2;6;30;41@@@@@Введите год в формате (ГГ)@@@@@</Data>
</Node>
<Node><Sub>1</Sub>
<Data><![CDATA[49@@64@@НОВОЕ КСП@1,50@@@ 1-Й ИНДЕКСНЫЙ@2;6;30;42@@@@@Введите Код структурных подразделений (2,4 или 9 цыфр)@@@@@]]></Data>
</Node>
<Node><Sub>2</Sub>
<Data><![CDATA[0101@@0912@@НОВАЯ ДАТА@1,40,TIME@@@ 2-Й ИНДЕКСНЫЙ@2;6;37;44@@@@@Введите месяц и день в формате (ММДД) @@@@@]]></Data>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>60431,42894,</Data>
</Node>
<Node><Sub>STA</Sub>
<Data>3,4@1@1@13@-1@-1@3@11@</Data>
</Node>
</Node>
<Node><Sub>TEST1</Sub>
<Data>ВЫЗОВ СВОДКИ ИЗ MSM ПО DDP@@@@@1@1@1@1@22@80@1@@1@1@@6@@1,2@1@@@@@1@@@3@2@@@@@@@@</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@40@@@@@1@@@@@@РАЗДЕЛ (пример:^[&quot;GLAVK&quot;]ABC)</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@41@1@35@@@@@1@@@@@@^[&quot;GLAVK&quot;]%BSTABEL@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@40@@@@@1@@@@@@ТАБЛИЦА (пример:TABLE)@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>2@41@1@35@@@@@1@@@@@@SYS_VOI_KOM!1!SPKOM_OF_2@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@40@@@@@1@2;6;30;43@@@@@!!!! ЗАГРУЖАТЬ БЕЗ ВОПРОСА О ЗАГРУЗКЕ @</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@41@1@35@@@@@1@@@@@@AAAAAAAAAAAAAAA@</Data>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>58227,43745,MS</Data>
</Node>
<Node><Sub>STA</Sub>
<Data>3,2@1@2@13@-1@-1@3@41@AAAAAAAAAAAAAAA</Data>
</Node>
</Node>
<Node><Sub>VISIT</Sub>
<Data>Обобщенная База визитов по всем приложениям@@@@@1@1@1@1@22@80@1@@1@@@2@@2,2@1@@@@@1@@@5@2@@@@@@@@</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@2@20@@@@@1@2;6;35;42@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@21@2@53@@@@0@1@2;6;35;42@@@@@@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@20@@@@@1@2;6;35;42@@@@@КОЛ-ВО ПОПЫТОК</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@21@1@53@@@@@2@1;6;32;40@@@@@@@@P@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>4@1@1@20@@@@@1@2;6;35;42@@@@@КОЛ-ВО РЕГИСТРАЦИЙ@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>4@21@1@53@@@@@2@1;6;32;40@@@@@@@@R</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>5@1@1@20@@@@@1@2;6;35;42@@@@@КОЛ-ВО ОШИБОК@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>5@21@1@53@@@@@2@1;6;32;40@@@@@@@@E</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>6@1@1@20@@@@@1@2;6;35;42@@@@@КОЛ-ВО ЗАПРОСОВ К БД@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>6@21@1@53@@@@@2@1;6;32;40@@@@@@@@Q</Data>
</Node>
</Node>
<Node><Sub>Compile</Sub>
<Data>OK 11:54:55 2006-06-15</Data>
</Node>
<Node><Sub>FTR</Sub>
<Node><Sub>1</Sub>
<Node><Sub>2</Sub>
<Data>S d1=&quot; ДАТА &quot;_$$ESDAY^%ZAPM.ed.BSsFUNR(9,$G(k1,&quot;1&quot;)_&quot;,&quot;_$G(k2,&quot;1&quot;))</Data>
<Node><Sub>1</Sub>
<Data>&quot; ДАТА &quot;_$$ESDAY^%ZAPM.ed.BSsFUNR(9,$G(k1,&quot;1&quot;)_&quot;,&quot;_$G(k2,&quot;1&quot;))</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>Free</Sub>
<Data>58570,57286</Data>
</Node>
<Node><Sub>KEY</Sub>
<Data>^[&quot;%SYS&quot;]%BScVIS</Data>
<Node><Sub>1</Sub>
<Data>@@@@НОВАЯ СИСТЕМНАЯ ДАТА@1,70@@@ 1-Й ИНДЕКСНЫЙ@2;6;30;42@@@@@СИСТЕМНАЯ ДАТА@@@@@</Data>
<Node><Sub>3</Sub>
<Data>S d1=d_&quot;    &quot;_$S(d=&quot;ALL&quot;:&quot;ВСЕ ПОСЕЩЕНИЯ&quot;,d=&quot;USERS&quot;:&quot;ПОЛЬЗОВАТЕЛИ&quot;,1:$$ESDAY^%ZAPM.ed.BSsFUNR(6,d))</Data>
</Node>
<Node><Sub>4</Sub>
<Data>d_&quot;    &quot;_$S(d=&quot;ALL&quot;:&quot;ВСЕ ПОСЕЩЕНИЯ&quot;,d=&quot;USERS&quot;:&quot;ПОЛЬЗОВАТЕЛИ&quot;,1:$$ESDAY^%ZAPM.ed.BSsFUNR(6,d))</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Data>@@@@НОВОЕ ПРИЛОЖЕНИЕ@1,75@@@ 2-Й ИНДЕКСНЫЙ@2;6;37;44@@@@@ПРИЛОЖЕНИЕ@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>@@@@ .... REMOTE IP-ADDRES@1,75@@@ 3-Й ИНДЕКСНЫЙ@2;6;37;44@@@@@REMOTE_ADDR@@@@@</Data>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>60431,42895,</Data>
</Node>
<Node><Sub>STA</Sub>
<Data>2,2@2@2@27@-1@-1@3@21@</Data>
</Node>
</Node>
<Node><Sub>ZHELP1</Sub>
<Data><![CDATA[РЕЖИМЫ УРОВНЯ РАБОЧИХ ОБЛАСТЕЙ@@@@@@@7@10@19@70@@@@1@@5@@@1@@@ 1@@@@@3@@@1;6;37;44//2;6;33;40@@@@@@@1]]></Data>
<Node><Sub>1</Sub>
<Data></Data>
</Node>
<Node><Sub>2</Sub>
<Data>  F9 - ОСНОВНЫЕ НАСТРОЙКИ %BS</Data>
</Node>
<Node><Sub>3</Sub>
<Data></Data>
</Node>
</Node>
<Node><Sub>ZHELP2</Sub>
<Data>РЕЖИМЫ УРОВНЯ РАЗДЕЛОВ@@@@@@@7@10@19@70@@@@1@@5@@@1@@@ 1@@@@@6@@@1;6;37;44//2;6;33;40@@@@@@@1</Data>
<Node><Sub>1</Sub>
<Data></Data>
</Node>
<Node><Sub>2</Sub>
<Data> F5 - СОЗДАТЬ/ИНСТАЛЛИРОВАТЬ ПРИЛОЖЕНИЕ</Data>
</Node>
<Node><Sub>3</Sub>
<Data> F6 - КОПИРОВАТЬ ВСЕ ТАБЛИЦЫ В ДРУГОЙ РАЗДЕЛ</Data>
</Node>
<Node><Sub>4</Sub>
<Data></Data>
</Node>
<Node><Sub>5</Sub>
<Data> F9 - ОСНОВНЫЕ НАСТРОЙКИ %BS </Data>
</Node>
<Node><Sub>6</Sub>
<Data></Data>
</Node>
<Node><Sub>User</Sub>
<Node><Sub>12388iabr</Sub>
<Data></Data>
</Node>
</Node>
</Node>
<Node><Sub>asurpPRG</Sub>
<Data><![CDATA[ЧТО на ЧТО прокачивать в программе PRG^%ZAPM.ed.BSC4r2@@@@@@@1@1@22@80@@@@1@@5@@@1@@@ 1@@@@@47@@@1;6;37;44//1;6;36;40@@@@@@@1]]></Data>
<Node><Sub>1</Sub>
<Data>^%STR(|^pSTR($$id^BSe,</Data>
</Node>
<Node><Sub>2</Sub>
<Data>^STR(|^STR($$id^BSe,</Data>
</Node>
<Node><Sub>3</Sub>
<Data>$ZU(0)|$$ZU^BSe(0)</Data>
</Node>
<Node><Sub>4</Sub>
<Data></Data>
</Node>
<Node><Sub>5</Sub>
<Data>C=132|C=196</Data>
</Node>
<Node><Sub>6</Sub>
<Data>%S=13|%S=2</Data>
</Node>
<Node><Sub>7</Sub>
<Data>USTR=13|USTR=2</Data>
</Node>
<Node><Sub>8</Sub>
<Data>%IOD=13|%IOD=2</Data>
</Node>
<Node><Sub>9</Sub>
<Data></Data>
</Node>
<Node><Sub>10</Sub>
<Data> YX4,| @YX4,</Data>
</Node>
<Node><Sub>11</Sub>
<Data> YX17,| @YX17,</Data>
</Node>
<Node><Sub>12</Sub>
<Data> YX19,| @YX19,</Data>
</Node>
<Node><Sub>13</Sub>
<Data>,SSR|,@SSR</Data>
</Node>
<Node><Sub>14</Sub>
<Data> SRL| @SRL</Data>
</Node>
<Node><Sub>15</Sub>
<Data>,SRL|,@SRL</Data>
</Node>
<Node><Sub>16</Sub>
<Data> YX,DS| @YX,@DS</Data>
</Node>
<Node><Sub>17</Sub>
<Data></Data>
</Node>
<Node><Sub>18</Sub>
<Data>^%1|^%ZM1</Data>
</Node>
<Node><Sub>19</Sub>
<Data>^%C|^%ZMC</Data>
</Node>
<Node><Sub>20</Sub>
<Data>^%D|^%ZMD</Data>
</Node>
<Node><Sub>21</Sub>
<Data>^%E|^%ZME</Data>
</Node>
<Node><Sub>22</Sub>
<Data>^%F|^%ZMF</Data>
</Node>
<Node><Sub>23</Sub>
<Data>^%G|^%ZMG</Data>
</Node>
<Node><Sub>24</Sub>
<Data>^%H|^%ZMH</Data>
</Node>
<Node><Sub>25</Sub>
<Data>^%I|^%ZMI</Data>
</Node>
<Node><Sub>26</Sub>
<Data>^%P|^%ZMP</Data>
</Node>
<Node><Sub>27</Sub>
<Data>^%Q|^%ZMQ</Data>
</Node>
<Node><Sub>28</Sub>
<Data>^%S|^%ZMS</Data>
</Node>
<Node><Sub>29</Sub>
<Data>^%T|^%ZMT</Data>
</Node>
<Node><Sub>30</Sub>
<Data>^%U|^%ZMU</Data>
</Node>
<Node><Sub>31</Sub>
<Data>^%W|^%ZMW</Data>
</Node>
<Node><Sub>32</Sub>
<Data>^%X|^%ZMX</Data>
</Node>
<Node><Sub>33</Sub>
<Data></Data>
</Node>
<Node><Sub>34</Sub>
<Data>^%ZMIOS |^%ZMIOS($zn)</Data>
</Node>
<Node><Sub>35</Sub>
<Data></Data>
</Node>
<Node><Sub>36</Sub>
<Data> W *27,&quot;@&quot;,*27| //W *27,&quot;@&quot;,*27</Data>
</Node>
<Node><Sub>37</Sub>
<Data>U $P::&quot;X3.64-1979&quot;|U $P::&quot;^%ZMX364&quot;</Data>
</Node>
<Node><Sub>38</Sub>
<Data></Data>
</Node>
<Node><Sub>39</Sub>
<Data>O %IOD |O %IOD:(+$J:1) </Data>
</Node>
<Node><Sub>40</Sub>
<Data>O USTR |O USTR:(+$J:1) </Data>
</Node>
<Node><Sub>41</Sub>
<Data>C:USTR USTR|d:USTR Close^%ZMIOS($$GetNameHSS^BSutl,USTR,$zn)</Data>
</Node>
<Node><Sub>42</Sub>
<Data>C %IOD|d Close^%ZMIOS($$GetNameHSS^BSutl,%IOD,$zn)</Data>
</Node>
<Node><Sub>43</Sub>
<Data>C:%DTY=&quot;LP&quot; %IOD|d:%DTY=&quot;LP&quot; Close^%ZMIOS($$GetNameHSS^BSutl,%IOD,$zn)</Data>
</Node>
<Node><Sub>44</Sub>
<Data>C USTR |d Close^%ZMIOS($$GetNameHSS^BSutl,USTR,$zn) </Data>
</Node>
<Node><Sub>45</Sub>
<Data></Data>
</Node>
<Node><Sub>46</Sub>
<Data></Data>
</Node>
<Node><Sub>47</Sub>
<Data></Data>
</Node>
</Node>
</Node>
</Global>


<Global>
<Node><Sub>^%ZAPM.ed.BSC4</Sub>
<Data>BaSe MsW @ОБЩИЕ ПАРАМЕТРЫ КОМПЛЕКСА Version :1553 от 2008-08-29@@</Data>
<Node><Sub>ADV</Sub>
<Data>РЕМОНТ САЙТОВ (ISS,Portal) :@@@@@1@1@1@1@22@80@1@@1@1@@1@@2,1@1@@@@@@@@2@5@@1;6;35;44@@@@@@</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@13@@@@@1@2;6;35;40@@@@@ Value (DFLT)</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@14@1@10@@@@@1@2;6;30;41@@@@@ Type@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>1@24@1@10@@@@@1@2;6;30;41@@@@@Atribute@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>1@34@1@35@@@@@1@2;6;33;40@@@@@ ОПИСАНИЕ@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>1@69@1@9@@@@@1@2;6;30;41@@@@@ name@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@13@@@@@1@2;6;35;40@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>2@14@1@10@@@@@1@2;6;30;41@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>2@24@1@10@@@@@1@2;6;30;41@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>2@34@1@35@@@@@1@2;6;33;40@@@@@В КОММЕНТАРИИ :РЕМОНТ САЙТА@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>2@69@1@9@@@@@1@2;6;30;41@@@@@@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@13@@@@@1@2;6;35;40@@@@@0</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>3@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data><![CDATA[3@34@1@35@@@@@1@2;6;33;40@@@@@Редактор системных таблиц (DICT,PIN,PROTECT,SESSIONS,TARIFF) выводить в одном окне@]]></Data>
</Node>
<Node><Sub>5</Sub>
<Data>3@69@1@9@@@@@1@2;6;32;40@@@@@EditTab1@</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>4@1@1@13@@@@@1@2;6;35;40@@@@@BLACK@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>4@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>4@24@1@10@@@@@1@2;6;32;40@@@@@size=32@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>4@34@1@35@@@@@1@2;6;33;40@@@@@Цвет первых клеток таблицы@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>4@69@1@9@@@@@1@2;6;32;40@@@@@C1@</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>5@1@1@13@@@@@1@2;6;35;40@@@@@#B4B4B4@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>5@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>5@24@1@10@@@@@1@2;6;32;40@@@@@size=32@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>5@34@1@35@@@@@1@2;6;33;40@@@@@Цвет вторых клеток таблицы@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>5@69@1@9@@@@@1@2;6;32;40@@@@@C2@</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>6@1@1@13@@@@@1@2;6;35;40@@@@@#E4E4E4@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>6@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>6@24@1@10@@@@@1@2;6;32;40@@@@@size=32@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>6@34@1@35@@@@@1@2;6;33;40@@@@@Цвет остальных клеток таблицы@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>6@69@1@9@@@@@1@2;6;32;40@@@@@C3@</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>7@1@1@13@@@@@1@2;6;35;40@@@@@cols=68 rows=5@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>7@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>7@24@1@10@@@@@1@2;6;32;40@@@@@size=32@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>7@34@1@35@@@@@1@2;6;33;40@@@@@Параметры TEXTAREA для кода COS@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>7@69@1@9@@@@@1@2;6;32;40@@@@@COS@</Data>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>1</Sub>
<Data>8@1@1@13@@@@@1@2;6;35;40@@@@@cols=68 rows=5@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>8@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>8@24@1@10@@@@@1@2;6;32;40@@@@@size=32@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>8@34@1@35@@@@@1@2;6;33;40@@@@@Параметры TEXTAREA для HTML@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>8@69@1@9@@@@@1@2;6;32;40@@@@@HTM@</Data>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>1</Sub>
<Data>9@1@1@13@@@@@1@1;6;37;46@@@@@1@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>9@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>9@24@1@10@@@@@1@2;6;32;40@@@@@size=35@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>9@34@1@35@@@@@1@@@@@@Разрешена ли работа с ODBC@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>9@69@1@9@@@@@1@2;6;32;40@@@@@ImportODBC@</Data>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>1</Sub>
<Data>10@1@1@13@@@@@1@1;6;37;46@@@@@1@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>10@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>10@24@1@10@@@@@1@2;6;32;40@@@@@size=35@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>10@34@1@35@@@@@1@@@@@@Разрешен ли импорт из Текстового файла@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>10@69@1@9@@@@@1@2;6;32;40@@@@@ImportTXT@</Data>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>59251,64677,MSW</Data>
</Node>
<Node><Sub>OPT</Sub>
<Data>1</Data>
</Node>
<Node><Sub>STA</Sub>
<Data>4,2@2@1@13@-1@-1@4@14@text</Data>
</Node>
</Node>
<Node><Sub>CFG</Sub>
<Data>Основные Опции Комплекса@@@@@1@1@1@1@22@80@1@@1@1@@1@@2,1@1@@@@@@@@26@5@@1;6;35;44@@@@@@</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@13@@@@@1@2;6;35;40@@@@@ Value (DFLT)</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@14@1@10@@@@@1@2;6;30;41@@@@@ Type@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>1@24@1@10@@@@@1@2;6;30;41@@@@@Atribute@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>1@34@1@35@@@@@1@2;6;33;40@@@@@ ОПИСАНИЕ@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>1@69@1@9@@@@@1@2;6;30;41@@@@@ name@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@13@@@@@1@2;6;30;43@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>2@14@1@10@@@@@1@2;6;30;43@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>2@24@1@10@@@@@1@2;6;30;43@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>2@34@1@35@@@@@1@2;6;30;43@@@@@ Основные Опции Комплекса@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>2@69@1@9@@@@@1@2;6;30;43@@@@@@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@13@@@@@1@2;6;35;40@@@@@Информационный портал@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>3@24@1@10@@@@@1@2;6;32;40@@@@@size=30@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>3@34@1@35@@@@@1@2;6;33;40@@@@@Наименование портала@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>3@69@1@9@@@@@1@2;6;32;40@@@@@IP@</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>4@1@1@13@@@@@1@2;6;35;40@@@@@ГКВВ МВД@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>4@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>4@24@1@10@@@@@1@2;6;32;40@@@@@size=30@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>4@34@1@35@@@@@1@2;6;33;40@@@@@Название комплекса@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>4@69@1@9@@@@@1@2;6;32;40@@@@@B4I@</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>5@1@1@13@@@@@1@2;6;35;40@@@@@1@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>5@14@1@10@@@@@1@2;6;32;40@@@@@radio@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>5@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data><![CDATA[5@34@1@35@@@@@1@2;6;33;40@@@@@ТАРИФ ПО-УМОЛЧАНИЮ: ТЕСТОВЫЙ~ --//-- ЭКОНОМНЫЙ~ --//-- СТАНДАРТНЫЙ~ --//-- ПРОФЕССИОНАЛЬНЫЙ@]]></Data>
</Node>
<Node><Sub>5</Sub>
<Data>5@69@1@9@@@@@1@2;6;32;40@@@@@Tariff@</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>6@1@1@13@@@@@1@2;6;35;40@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>6@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>6@24@1@10@@@@@1@2;6;32;40@@@@@size=30@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>6@34@1@35@@@@@1@2;6;33;40@@@@@Копирайт и Номер версии комплекса@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>6@69@1@9@@@@@1@2;6;32;40@@@@@Vers@</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>7@1@1@13@@@@@1@2;6;35;40@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>7@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>7@24@1@10@@@@@1@2;6;32;40@@@@@size=30@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>7@34@1@35@@@@@1@2;6;33;40@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>7@69@1@9@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>1</Sub>
<Data>8@1@1@13@@@@@1@2;6;35;40@@@@@n:/infoportal/snx/@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>8@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>8@24@1@10@@@@@1@2;6;32;40@@@@@size=30@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>8@34@1@35@@@@@1@2;6;33;40@@@@@каталог временных файлов для записи@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>8@69@1@9@@@@@1@2;6;32;40@@@@@TempDir2@</Data>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>1</Sub>
<Data>9@1@1@13@@@@@1@2;6;35;40@@@@@SAMPLES@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>9@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>9@24@1@10@@@@@1@2;6;32;40@@@@@size=30@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>9@34@1@35@@@@@1@2;6;33;40@@@@@Текущая рабочая область для новых клиентов@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>9@69@1@9@@@@@1@2;6;32;40@@@@@CurNSP@</Data>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>1</Sub>
<Data>10@1@1@13@@@@@1@2;6;35;40@@@@@DFLT1@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>10@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>10@24@1@10@@@@@1@2;6;32;40@@@@@size=30@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>10@34@1@35@@@@@1@2;6;33;40@@@@@Текущий стиль@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>10@69@1@9@@@@@1@2;6;32;40@@@@@CurCSS@</Data>
</Node>
</Node>
<Node><Sub>11</Sub>
<Node><Sub>1</Sub>
<Data>11@1@1@13@@@@@1@2;6;35;40@@@@@2@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>11@14@1@10@@@@@1@2;6;32;40@@@@@radio@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>11@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>11@34@1@35@@@@@1@2;6;33;40@@@@@Портал тарифицируется~не тарифицируется@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>11@69@1@9@@@@@1@2;6;32;40@@@@@Commerce@</Data>
</Node>
</Node>
<Node><Sub>12</Sub>
<Node><Sub>1</Sub>
<Data>12@1@1@13@@@@@1@2;6;35;40@@@@@0</Data>
</Node>
<Node><Sub>2</Sub>
<Data>12@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>12@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>12@34@1@35@@@@@1@2;6;33;40@@@@@Мультиязычность@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>12@69@1@9@@@@@1@2;6;32;40@@@@@MultiL@</Data>
</Node>
</Node>
<Node><Sub>13</Sub>
<Node><Sub>1</Sub>
<Data>13@1@1@13@@@@@1@2;6;35;40@@@@@0</Data>
</Node>
<Node><Sub>2</Sub>
<Data>13@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>13@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>13@34@1@35@@@@@1@2;6;33;40@@@@@Конкурсы проектов@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>13@69@1@9@@@@@1@2;6;32;40@@@@@Conc@</Data>
</Node>
</Node>
<Node><Sub>14</Sub>
<Node><Sub>1</Sub>
<Data>14@1@1@13@@@@@1@2;6;35;40@@@@@1</Data>
</Node>
<Node><Sub>2</Sub>
<Data>14@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>14@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>14@34@1@35@@@@@1@2;6;33;40@@@@@Включен WEB редактор программ COS@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>14@69@1@9@@@@@1@2;6;32;40@@@@@WebEditRou@</Data>
</Node>
</Node>
<Node><Sub>15</Sub>
<Node><Sub>1</Sub>
<Data>15@1@1@13@@@@@1@2;6;35;40@@@@@1</Data>
</Node>
<Node><Sub>2</Sub>
<Data>15@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>15@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>15@34@1@35@@@@@1@2;6;33;40@@@@@Включен WEB редактор данных таблиц@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>15@69@1@9@@@@@1@2;6;32;40@@@@@WebEditDT@</Data>
</Node>
</Node>
<Node><Sub>16</Sub>
<Node><Sub>1</Sub>
<Data>16@1@1@13@@@@@1@2;6;35;40@@@@@1</Data>
</Node>
<Node><Sub>2</Sub>
<Data>16@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>16@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>16@34@1@35@@@@@1@2;6;33;40@@@@@Разрешен вывод информации о сессии и системе@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>16@69@1@9@@@@@1@2;6;32;40@@@@@WebInfoSess@</Data>
</Node>
</Node>
<Node><Sub>17</Sub>
<Node><Sub>1</Sub>
<Data>17@1@1@13@@@@@1@2;6;35;40@@@@@cols=68 rows=5@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>17@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>17@24@1@10@@@@@1@2;6;32;40@@@@@size=32@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>17@34@1@35@@@@@1@2;6;33;40@@@@@Параметры TEXTAREA для кода COS@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>17@69@1@9@@@@@1@2;6;32;40@@@@@COS@</Data>
</Node>
</Node>
<Node><Sub>18</Sub>
<Node><Sub>1</Sub>
<Data>18@1@1@13@@@@@1@2;6;35;40@@@@@cols=68 rows=5@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>18@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>18@24@1@10@@@@@1@2;6;32;40@@@@@size=32@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>18@34@1@35@@@@@1@2;6;33;40@@@@@Параметры TEXTAREA для HTML@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>18@69@1@9@@@@@1@2;6;32;40@@@@@HTM@</Data>
</Node>
</Node>
<Node><Sub>19</Sub>
<Node><Sub>1</Sub>
<Data>19@1@1@13@@@@@1@2;6;30;46@@@@@1@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>19@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>19@24@1@10@@@@@1@2;6;32;40@@@@@size=35@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>19@34@1@35@@@@@1@@@@@@Разрешена ли работа с ODBC@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>19@69@1@9@@@@@1@2;6;32;40@@@@@ImportODBC@</Data>
</Node>
</Node>
<Node><Sub>20</Sub>
<Node><Sub>1</Sub>
<Data>20@1@1@13@@@@@1@2;6;30;46@@@@@1@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>20@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>20@24@1@10@@@@@1@2;6;32;40@@@@@size=35@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>20@34@1@35@@@@@1@@@@@@Разрешен ли импорт из Текстового файла@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>20@69@1@9@@@@@1@2;6;32;40@@@@@ImportTXT@</Data>
</Node>
</Node>
<Node><Sub>21</Sub>
<Node><Sub>1</Sub>
<Data>21@1@1@13@@@@@1@2;6;35;40@@@@@0</Data>
</Node>
<Node><Sub>2</Sub>
<Data>21@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>21@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data><![CDATA[21@34@1@35@@@@@1@2;6;33;40@@@@@Редактор системных таблиц (DICT,PIN,PROTECT,SESSIONS,TARIFF) выводить в одном окне@]]></Data>
</Node>
<Node><Sub>5</Sub>
<Data>21@69@1@9@@@@@1@2;6;32;40@@@@@EditTab1@</Data>
</Node>
</Node>
<Node><Sub>22</Sub>
<Node><Sub>1</Sub>
<Data>22@1@1@13@@@@@1@2;6;35;40@@@@@width=800,height=600@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>22@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>22@24@1@10@@@@@1@2;6;32;40@@@@@size=32@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>22@34@1@35@@@@@1@2;6;33;40@@@@@Размеры нового окна для редактора данных таблиц@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>22@69@1@9@@@@@1@2;6;32;40@@@@@NWT1@</Data>
</Node>
</Node>
<Node><Sub>23</Sub>
<Node><Sub>1</Sub>
<Data>23@1@1@13@@@@@1@2;6;35;40@@@@@width=800,height=600@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>23@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>23@24@1@10@@@@@1@2;6;32;40@@@@@size=32@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>23@34@1@35@@@@@1@2;6;33;40@@@@@Размеры нового окна для редактора Опций@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>23@69@1@9@@@@@1@2;6;32;40@@@@@NWO1@</Data>
</Node>
</Node>
<Node><Sub>24</Sub>
<Node><Sub>1</Sub>
<Data>24@1@1@13@@@@@1@2;6;30;46@@@@@1@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>24@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>24@24@1@10@@@@@1@2;6;32;40@@@@@size=35@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>24@34@1@35@@@@@1@@@@@@Разрешен ли пустой пароль пользователя@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>24@69@1@9@@@@@1@2;6;32;40@@@@@EmpPASS@</Data>
</Node>
</Node>
<Node><Sub>25</Sub>
<Node><Sub>1</Sub>
<Data>25@1@1@13@@@@@1@2;6;35;40@@@@@ГЦ АСУ ГКВВ МВД России@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>25@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>25@24@1@10@@@@@1@2;6;32;40@@@@@size=32@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>25@34@1@35@@@@@1@2;6;33;40@@@@@Конечный пользователь@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>25@69@1@9@@@@@1@2;6;32;40@@@@@ENDUSER@</Data>
</Node>
</Node>
<Node><Sub>26</Sub>
<Node><Sub>1</Sub>
<Data>26@1@1@13@@@@@1@2;6;35;40@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>26@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>26@24@1@10@@@@@1@2;6;32;40@@@@@size=32@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>26@34@1@35@@@@@1@2;6;33;40@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>26@69@1@9@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>59397,66776,SSS1</Data>
</Node>
<Node><Sub>OPT</Sub>
<Data>1</Data>
<Node><Sub>LST</Sub>
<Data>59397,66776,SSS1</Data>
<Node><Sub>B4I</Sub>
<Data>4</Data>
</Node>
<Node><Sub>CFG26</Sub>
<Data>26</Data>
</Node>
<Node><Sub>CFG7</Sub>
<Data>7</Data>
</Node>
<Node><Sub>COS</Sub>
<Data>17</Data>
</Node>
<Node><Sub>Commerce</Sub>
<Data>11</Data>
</Node>
<Node><Sub>Conc</Sub>
<Data>13</Data>
</Node>
<Node><Sub>CurCSS</Sub>
<Data>10</Data>
</Node>
<Node><Sub>CurNSP</Sub>
<Data>9</Data>
</Node>
<Node><Sub>ENDUSER</Sub>
<Data>25</Data>
</Node>
<Node><Sub>EditTab1</Sub>
<Data>21</Data>
</Node>
<Node><Sub>EmpPASS</Sub>
<Data>24</Data>
</Node>
<Node><Sub>HTM</Sub>
<Data>18</Data>
</Node>
<Node><Sub>IP</Sub>
<Data>3</Data>
</Node>
<Node><Sub>ImportODBC</Sub>
<Data>19</Data>
</Node>
<Node><Sub>ImportTXT</Sub>
<Data>20</Data>
</Node>
<Node><Sub>MultiL</Sub>
<Data>12</Data>
</Node>
<Node><Sub>NWO1</Sub>
<Data>23</Data>
</Node>
<Node><Sub>NWT1</Sub>
<Data>22</Data>
</Node>
<Node><Sub>Tariff</Sub>
<Data>5</Data>
</Node>
<Node><Sub>TempDir2</Sub>
<Data>8</Data>
</Node>
<Node><Sub>Vers</Sub>
<Data>6</Data>
</Node>
<Node><Sub>WebEditDT</Sub>
<Data>15</Data>
</Node>
<Node><Sub>WebEditRou</Sub>
<Data>14</Data>
</Node>
<Node><Sub>WebInfoSess</Sub>
<Data>16</Data>
</Node>
</Node>
</Node>
<Node><Sub>STA</Sub>
<Data>2,4@2@1@13@-1@-1@2@34@ Основные Опции Комплекса</Data>
</Node>
</Node>
<Node><Sub>DICT</Sub>
<Data>многоязыковая база данных слов и фраз@@@@@1@1@1@1@22@80@1@@1@@@2@@2,2@1@@@@@1@@@5@3@@@1@@@@@@@</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@2@8@@@@@1@2;6;35;42@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@9@2@50@@@@0@1@2;6;35;42@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>1@59@2@20@@@@@1@2;6;35;42@@@@@title=&apos;...&apos;@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>3@1@5@8@@@@@1@2;6;35;42@@@@@   RUS</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@9@5@50@@@1@@2@2;6;30;43@@@@@@@@R@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>3@59@5@20@@@@@2@2;6;30;43@@@@@@@@tR@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>8@1@5@8@@@@@1@2;6;35;42@@@@@   ENG@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>8@9@5@50@@@2,2@@2@2;6;30;43@@@@@@@@E</Data>
</Node>
<Node><Sub>3</Sub>
<Data>8@59@5@20@@@@@2@2;6;30;43@@@@@@@@tE</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>13@1@5@8@@@@@1@2;6;35;42@@@@@   GER @</Data>
</Node>
<Node><Sub>2</Sub>
<Data>13@9@5@50@@@2,2@@2@2;6;30;43@@@@@@@@G@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>13@59@5@20@@@@@2@2;6;30;43@@@@@@@@tG@@</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>18@1@5@8@@@@@1@2;6;35;42@@@@@   FRA@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>18@9@5@50@@@2,2@@2@2;6;30;43@@@@@@@@F</Data>
</Node>
<Node><Sub>3</Sub>
<Data>18@59@5@20@@@@@2@2;6;30;43@@@@@@@@tF</Data>
</Node>
</Node>
<Node><Sub>FCL</Sub>
<Node><Sub>2</Sub>
<Node><Sub>2</Sub>
<Data>S d1=$$A^%ZAPM.ed.BSA(ny,nx) I $$A^%ZAPM.ed.BSA(ny,nx)=&quot;&quot; S d1=&quot;?&quot;</Data>
<Node><Sub>1</Sub>
<Data>{ny,nx} I {ny,nx}=&quot;&quot; S d1=&quot;?&quot;</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>FTR</Sub>
<Node><Sub>1</Sub>
<Node><Sub>2</Sub>
<Data>S d1=&quot; № ИДЕНТИФИКАТОРА СЛОВА/ФРАЗЫ :&quot;_$G(k1,&quot;?&quot;)</Data>
<Node><Sub>1</Sub>
<Data>&quot; № ИДЕНТИФИКАТОРА СЛОВА/ФРАЗЫ :&quot;_$G(k1,&quot;?&quot;)</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>Free</Sub>
<Data>58847,78169</Data>
</Node>
<Node><Sub>KEY</Sub>
<Data>^[&quot;%SYS&quot;]%BSC4DIC</Data>
<Node><Sub>1</Sub>
<Data>49@@64@@НОВОЕ СЛОВО/ФРАЗА@1,70@@@ 1-Й ИНДЕКСНЫЙ@1;6;30;42@@@@@Введите Код СЛОВА/ФРАЗЫ@@@@@</Data>
<Node><Sub>3</Sub>
<Data><![CDATA[S d1=d_"    '"_$$A^%ZAPM.ed.BSA(2,2,"DICT","%BSC4","","","",$G(d0))_"' --- "_$$A^%ZAPM.ed.BSA(3,2,"DICT","%BSC4","","","",$G(d0))]]></Data>
</Node>
<Node><Sub>4</Sub>
<Data>d_&quot;    &apos;&quot;_{2,2,&quot;DICT&quot;,&quot;%BSC4&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;,$G(d0)}_&quot;&apos; --- &quot;_{3,2,&quot;DICT&quot;,&quot;%BSC4&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;,$G(d0)}</Data>
</Node>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>58847,78169,MSW</Data>
</Node>
<Node><Sub>STA</Sub>
<Data>5,3@2@2@-2@-2@-2@3@9@</Data>
</Node>
</Node>
<Node><Sub>GRAND</Sub>
<Data>ГРАНДЫ ИнфоПортала@@@@@1@1@1@1@22@80@1@@1@@@2@@2,2@1@@@@@1@@@13@2@@@@@@@@@@</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@2@22@@@@@1@2;6;35;42@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@23@2@53@@@@0@1@2;6;35;42@@@@@@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>3@1@2@22@@@@@1@2;6;35;42@@@@@КОМЕНТАРИЙ К ГРАНДУ</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@23@2@53@@@@@2@2;6;30;47@@@@@@@@REM@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>5@1@2@22@@@@@1@2;6;35;42@@@@@  ПРОГРАММА ЗАПУСКА    ДЛЯ АТОМАРНОГО ГРАНДА,или@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>5@23@2@53@@@@@2@2;6;30;43@@@@@@@@MENU</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>7@1@2@22@@@@@1@2;6;35;42@@@@@ ПЕРЕЧЕНЬ ГРАНДОВ       ЧЕРЕЗ &apos;,&apos;@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>7@23@2@53@@@@@2@2;6;30;43@@@@@@@@Z1@@</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>9@1@2@22@@@@@1@2;6;35;42@@@@@ТИТУЛ@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>9@23@2@53@@@@@2@2;6;30;43@@@@@@@@TITLE@@</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>11@1@2@22@@@@@1@2;6;35;42@@@@@WRITE@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>11@23@2@53@@@@@2@2;6;30;43@@@@@@@@WRITE@@</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>13@1@2@22@@@@@1@2;6;35;42@@@@@RPOG@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>13@23@2@53@@@@@2@2;6;30;43@@@@@@@@PROG@@</Data>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>1</Sub>
<Data>15@1@2@22@@@@@1@2;6;35;42@@@@@ РАБОЧАЯ ОБЛАСТЬ@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>15@23@2@53@@@@@2@2;6;30;43@@@@@@@@NSP@@</Data>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>1</Sub>
<Data>17@1@2@22@@@@@1@2;6;35;42@@@@@TOPIC@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>17@23@2@53@@@@@2@2;6;30;43@@@@@@@@TOPIC@@</Data>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>1</Sub>
<Data>19@1@1@22@@@@@1@2;6;35;42@@@@@TOPIC UP@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>19@23@1@53@@@@@2@2;6;30;43@@@@@@@@TOPIC1@@</Data>
</Node>
</Node>
<Node><Sub>11</Sub>
<Node><Sub>1</Sub>
<Data>20@1@1@22@@@@@1@2;6;35;42@@@@@ СТИЛЬ ГРАНТА@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>20@23@1@53@@@@@2@2;6;30;43@@@@@@@@STYLE@@</Data>
</Node>
</Node>
<Node><Sub>12</Sub>
<Node><Sub>1</Sub>
<Data>21@1@1@22@@@@@1@2;6;35;42@@@@@ МАЛЕНЬКИЙ ТЕКСТ @</Data>
</Node>
<Node><Sub>2</Sub>
<Data>21@23@1@53@@@@@2@2;6;30;43@@@@@@@@TXTLITL@@^[&quot;%SYS&quot;,&quot;&quot;]%BSC4(&quot;TXTBIGLITL&quot;)</Data>
</Node>
</Node>
<Node><Sub>13</Sub>
<Node><Sub>1</Sub>
<Data>22@1@1@22@@@@@1@2;6;35;42@@@@@ БОЛЬШОЙ ТЕКСТ@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>22@23@1@53@@@@@2@2;6;30;43@@@@@@@@TXTBIG@@^[&quot;%SYS&quot;,&quot;&quot;]%BSC4(&quot;TXTBIGLITL&quot;)</Data>
</Node>
</Node>
<Node><Sub>FTR</Sub>
<Node><Sub>1</Sub>
<Node><Sub>2</Sub>
<Data>S d1=&quot;ГРАНД &apos;&quot;_$G(k1,&quot;?&quot;)_&quot;&apos;&quot;</Data>
<Node><Sub>1</Sub>
<Data>&quot;ГРАНД &apos;&quot;_$G(k1,&quot;?&quot;)_&quot;&apos;&quot;</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>Free</Sub>
<Data>60710,60995</Data>
</Node>
<Node><Sub>KEY</Sub>
<Data>^[&quot;%SYS&quot;,&quot;&quot;]%BSC4grand</Data>
<Node><Sub>1</Sub>
<Data>49@@64@@НОВЫЙ ГРАНД@1,70@@@ 1-Й ИНДЕКСНЫЙ@2;6;37;44@@@@@Введите ИМЯ ГРАНДА ИСС@@@@@</Data>
<Node><Sub>3</Sub>
<Data>S d1=$$JF^%ZAPM.ed.BSC4r4($G(d0),20)_$$A^%ZAPM.ed.BSA(2,2,&quot;GRAND&quot;,&quot;%BSC4&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;,$G(d0))</Data>
</Node>
<Node><Sub>4</Sub>
<Data>$$JF^%ZAPM.ed.BSC4r4($G(d0),20)_{2,2,&quot;GRAND&quot;,&quot;%BSC4&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;,$G(d0)}</Data>
</Node>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>60710,60995,0095</Data>
</Node>
<Node><Sub>STA</Sub>
<Data>13,2@2@2@27@-1@-1@22@23@</Data>
</Node>
</Node>
<Node><Sub>IP</Sub>
<Data>База данных IP@@@@@1@1@1@1@22@80@1@@1@@@2@@@1@@@@@1@@@2@2@@@@@@@@@@</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@2@20@@@@@1@2;6;35;42@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@21@2@53@@@@0@1@2;6;35;42@@@@@@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>3@1@2@20@@@@@1@2;6;35;42@@@@@   СЕТЕВОЕ ИМЯ</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@21@2@53@@@@@2@2;6;30;43@@@@@@@@NAM@</Data>
</Node>
</Node>
<Node><Sub>FTR</Sub>
<Node><Sub>1</Sub>
<Node><Sub>2</Sub>
<Data>S d1=&quot; IP: &quot;_$G(k1,&quot;?&quot;)</Data>
<Node><Sub>1</Sub>
<Data>&quot; IP: &quot;_$G(k1,&quot;?&quot;)</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>Free</Sub>
<Data>59527,59959</Data>
</Node>
<Node><Sub>KEY</Sub>
<Data>^[&quot;%SYS&quot;,&quot;&quot;]%BScIP</Data>
<Node><Sub>1</Sub>
<Data>49@@64@@НОВЫЙ ПАРАМЕТР@1,70@@@ 1-Й ИНДЕКСНЫЙ@2;6;30;42@@@@@Введите ИМЯ ПАРАМЕТРА@@@@@</Data>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>59527,59959,MSW</Data>
</Node>
<Node><Sub>STA</Sub>
<Data>1,1@1@1@27@-1@-1@1@1@</Data>
</Node>
</Node>
<Node><Sub>Keywords</Sub>
<Data>ключевые слова, зарезервированные порталом@@@@@1@1@1@1@22@80@1@@1@@@2@@@1@@@@@1@@@2@2@@@@@@@@@@</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@2@20@@@@@1@2;6;35;42@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@21@2@53@@@@0@1@2;6;35;42@@@@@@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data><![CDATA[3@1@2@20@@@@@1@2;6;35;42@@@@@описание ключевого слова@@описание ключевого слова@@@@@описание ключевого слова]]></Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@21@2@53@@@@@2@2;6;30;43@@@@@@@описание ключевого слова@Description@</Data>
</Node>
</Node>
<Node><Sub>B4I</Sub>
<Data>1</Data>
</Node>
<Node><Sub>Compile</Sub>
<Data>OK 12:56:56 2002-02-06</Data>
</Node>
<Node><Sub>DSN</Sub>
<Data>Создана B4I 2002-02-06</Data>
</Node>
<Node><Sub>Free</Sub>
<Data>58847,78380</Data>
</Node>
<Node><Sub>KEY</Sub>
<Data>^[&quot;%SYS&quot;]%BSC4KWD</Data>
<Node><Sub>1</Sub>
<Data>@@@@НОВОЕ ЗНАЧЕНИЕ BSiD@1,70@@@1 ИНДЕКС@2;6;30;42@@@@@ВВЕДИТЕ НОВОЕ ЗНАЧЕНИЕ BSiD@@@@@</Data>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>58847,78380,MSW</Data>
</Node>
<Node><Sub>STA</Sub>
<Data>2,2@1@1@13@-1@-1@3@21@</Data>
</Node>
</Node>
<Node><Sub>PIN</Sub>
<Data>Таблица ID Пользователей@@@@@1@1@1@1@22@80@1@@1@@@2@@2,2@1@@@@@1@@@5@2@@@@@@@@@@</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@2@20@@@@@1@2;6;35;42@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@21@2@53@@@@0@1@2;6;35;42@@@@@@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>3@1@2@20@@@@@1@2;6;35;42@@@@@            LOGIN</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@21@2@53@@@@@2@2;6;34;43@@@@@@@@LOGIN@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>5@1@2@20@@@@@1@2;6;35;42@@@@@              NSP@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>5@21@2@53@@@@@2@2;6;34;43@@@@@@@@NSP@</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>7@1@2@20@@@@@1@2;6;35;42@@@@@             DATE@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>7@21@2@53@@@@@2@2;6;34;43@@@@@@@@DAT@</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>9@1@2@20@@@@@1@2;6;35;42@@@@@            TARIF@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>9@21@2@53@@@@@2@2;6;34;43@@@@@@@@TRF@</Data>
</Node>
</Node>
<Node><Sub>FTR</Sub>
<Node><Sub>1</Sub>
<Node><Sub>2</Sub>
<Data>S d1=&quot; PIN: &quot;_$G(k1,&quot;?&quot;)</Data>
<Node><Sub>1</Sub>
<Data>&quot; PIN: &quot;_$G(k1,&quot;?&quot;)</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>Free</Sub>
<Data>58961,61284</Data>
</Node>
<Node><Sub>KEY</Sub>
<Data>^[&quot;%SYS&quot;]%BSc4uPIN</Data>
<Node><Sub>1</Sub>
<Data>49@@64@@НОВЫЙ PIN@1,70@@@ 1-Й ИНДЕКСНЫЙ@2;6;30;42@@@@@Введите PIN@@@@@</Data>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>58961,61284,MSW</Data>
</Node>
<Node><Sub>STA</Sub>
<Data>2,2@2@2@27@-1@-1@3@21@</Data>
</Node>
</Node>
<Node><Sub>PRO</Sub>
<Data>проекты@@@@@1@1@1@1@22@80@1@@1@@@2@@@1@@@@@1@@@2@2@@@@@@@@@@</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@2@20@@@@@1@2;6;35;42@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@21@2@53@@@@0@1@2;6;35;42@@@@@@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>3@1@2@20@@@@@1@2;6;35;42@@@@@     ОПИСАНИЕ</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@21@2@53@@@@@2@2;6;30;43@@@@@@@@REM@</Data>
</Node>
</Node>
<Node><Sub>FTR</Sub>
<Node><Sub>1</Sub>
<Node><Sub>2</Sub>
<Data>S d1=&quot; ИМЯ ПРОЕКТА: &quot;_$G(k1,&quot;?&quot;)</Data>
<Node><Sub>1</Sub>
<Data>&quot; ИМЯ ПРОЕКТА: &quot;_$G(k1,&quot;?&quot;)</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>Free</Sub>
<Data>58847,84886</Data>
</Node>
<Node><Sub>KEY</Sub>
<Data>^[&quot;%SYS&quot;]BSC4.PRO</Data>
<Node><Sub>1</Sub>
<Data>49@@64@@НОВЫЙ ПАРАМЕТР@1,70@@@ 1-Й ИНДЕКСНЫЙ@2;6;30;42@@@@@Введите ИМЯ ПАРАМЕТРА@@@@@</Data>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>58847,84886,MSW</Data>
</Node>
<Node><Sub>STA</Sub>
<Data>1,1@1@1@27@-1@-1@1@1@</Data>
</Node>
</Node>
<Node><Sub>PROTECT</Sub>
<Data>Пользователи комплекса@@@@@1@1@1@1@22@80@1@@1@1@@2@@2,2@1@@@@@1@@@14@2@@2;6;30;43@@@@@@</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@2@30@@@@@1@@@@@@   БАЗА ДАННЫХ ПОЛЬЗОВАТЕЛЕЙ</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@31@2@49@@@@0@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@30@@@@@1@@@@@@     ПОЛНОЕ ИМЯ ПОЛЬЗОВАТЕЛЯ@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@31@1@49@@@@@2@2;6;30;42@@@@@@@@FNM@@@7</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>4@1@1@30@@@@@1@@@@@@                  ХЕШ ПАРОЛЯ@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>4@31@1@49@1@@@0@2@2;6;33;41@@@@@@@@PSW</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>5@1@1@30@@@@@1@@@@@@               ТАРИФНЫЙ ПЛАН@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>5@31@1@49@@@@@2@2;6;30;42@@@@GRAND,%BSC,%SYS,,,&lt;&gt;@@@@TRF</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>6@1@1@30@@@@@1@@@@@@                      E-MAIL@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>6@31@1@49@@@@@2@2;6;30;42@@@@@@@@EML</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>7@1@1@30@@@@@1@@@@@@                     ПИН-КОД@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>7@31@1@49@@@@@2@2;6;30;42@@@@@@@@PIN</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>8@1@1@30@@@@@1@@@@@@                       ФИРМА@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>8@31@1@49@@@@@2@2;6;30;42@@@@@@@@FRM</Data>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>1</Sub>
<Data>9@1@1@30@@@@@1@@@@@@                      СТРАНА@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>9@31@1@49@@@@@2@2;6;30;42@@@@@@@@CNT</Data>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>1</Sub>
<Data>10@1@1@30@@@@@1@@@@@@                       ГОРОД@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>10@31@1@49@@@@@2@2;6;30;42@@@@@@@@CIT</Data>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>1</Sub>
<Data>11@1@1@30@@@@@1@@@@@@                       ГРАНТ@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>11@31@1@49@@@@@2@2;6;30;42@@@@@@@@GRANT</Data>
</Node>
</Node>
<Node><Sub>11</Sub>
<Node><Sub>1</Sub>
<Data><![CDATA[12@1@3@30@@@@@1@@@@@@+ ПРАВА ДОСТУПА У ПОЛЬЗОВАТЕЛЯ(У КОГО ВЫШЕ ПРАВА НА ГРАНД, ТОТ И ПРАВ)......................@]]></Data>
</Node>
<Node><Sub>2</Sub>
<Data>12@31@3@49@@@@@2@2;6;30;42@@@@@@@@ARRAY@@@</Data>
</Node>
</Node>
<Node><Sub>12</Sub>
<Node><Sub>1</Sub>
<Data>15@1@1@30@@@@@1@@@@@@            АВТОРЕГИСТРАЦИЯ=1@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>15@31@1@49@@@@@2@2;6;30;42@@@@@@@@REG@@@</Data>
</Node>
</Node>
<Node><Sub>13</Sub>
<Node><Sub>1</Sub>
<Data>16@1@3@30@@@@@1@@@@@@        ВРЕМЕННО БЛОКИРОВАН=1 ,       Разблокирован=0@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>16@31@3@49@@@@@2@2;6;30;42@@@@@@@@BLOCK@@@</Data>
</Node>
</Node>
<Node><Sub>14</Sub>
<Node><Sub>1</Sub>
<Data>19@1@2@30@@@@@1@@@@@@ СИСТЕМНОЕ ВРЕМЯ ПОСЛЕДНЕГО     ВХОДА В СИСТЕМУ...................@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>19@31@2@49@@@@@2@2;6;30;42@@@@@@@@LastTime@@@</Data>
</Node>
</Node>
<Node><Sub>FTR</Sub>
<Node><Sub>1</Sub>
<Node><Sub>2</Sub>
<Data>S d1=&quot;  &quot;_$G(k1,&quot;?&quot;)</Data>
<Node><Sub>1</Sub>
<Data>&quot;  &quot;_$G(k1,&quot;?&quot;)</Data>
</Node>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>2</Sub>
<Data>S d1=d I d=&quot;&quot;,$G(k1)&apos;=&quot;&quot; S d1=$$CRC^%ZAPM.ed.BSCp(k1,&quot;&quot;),@BSD@(k1,&quot;PSW&quot;)=d1</Data>
<Node><Sub>1</Sub>
<Data>d I d=&quot;&quot;,$G(k1)&apos;=&quot;&quot; S d1=$$CRC^%ZAPM.ed.BSCp(k1,&quot;&quot;),@BSD@(k1,&quot;PSW&quot;)=d1</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>Free</Sub>
<Data>60567,42417</Data>
</Node>
<Node><Sub>KEY</Sub>
<Data>^[&quot;%SYS&quot;,&quot;&quot;]%BSc4uSERS</Data>
<Node><Sub>1</Sub>
<Data>@@@@НОВОЕ ИМЯ@1,70@@@ 1-Й ИНДЕКСНЫЙ@2;6;30;42@@@@@Введите LOGIN пользователя@@@@@</Data>
<Node><Sub>3</Sub>
<Data>S d1=$$JF^%ZAPM.ed.BSC4r4($G(d0),20)_$$A^%ZAPM.ed.BSA(10,2,&quot;PROTECT&quot;,&quot;%BSC4&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;,$G(d0))</Data>
</Node>
<Node><Sub>4</Sub>
<Data>$$JF^%ZAPM.ed.BSC4r4($G(d0),20)_{10,2,&quot;PROTECT&quot;,&quot;%BSC4&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;,$G(d0)}</Data>
</Node>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>60567,42417,Styx</Data>
</Node>
<Node><Sub>ParmsCell</Sub>
<Node><Sub>FNM</Sub>
<Node><Sub>pSH</Sub>
<Node><Sub>V</Sub>
<Data>^[&quot;%SYS&quot;]BSC4.ISS.AppAccess</Data>
</Node>
</Node>
</Node>
<Node><Sub>PSW</Sub>
<Node><Sub>pSH</Sub>
<Node><Sub>V</Sub>
<Data>^[&quot;FON&quot;]AsI.PAR.ParPar</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>STA</Sub>
<Data>2,2@2@2@13@-1@-1@3@31@</Data>
</Node>
</Node>
<Node><Sub>ProfKEY</Sub>
<Data>таблица Профилей КЛЮЧЕЙ@@@@@1@1@1@1@22@80@1@@1@@@2@@@1@@@@@1@@@2@2@@@@@@@@@@</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@2@20@@@@@1@2;6;35;42@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@21@2@53@@@@0@1@2;6;35;42@@@@@@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>3@1@2@20@@@@@1@2;6;35;42@@@@@КОМЕНТАРИЙ профиля</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@21@2@53@@@@@2@2;6;30;43@@@@@@@имя программы@REM@</Data>
</Node>
</Node>
<Node><Sub>B4I</Sub>
<Data>1</Data>
</Node>
<Node><Sub>Compile</Sub>
<Data>OK 16:16:22 2002-02-06</Data>
</Node>
<Node><Sub>DSN</Sub>
<Data>Создана B4I 2002-02-06</Data>
</Node>
<Node><Sub>Free</Sub>
<Data>59621,43034</Data>
</Node>
<Node><Sub>KEY</Sub>
<Data>^[&quot;%SYS&quot;,&quot;&quot;]%BSC4.ProfKEY</Data>
<Node><Sub>1</Sub>
<Data>@@@@НОВОЕ ЗНАЧЕНИЕ BSiD@1,70@@@1 ИНДЕКС@2;6;30;42@@@@@ВВЕДИТЕ НОВОЕ ЗНАЧЕНИЕ BSiD@@@@@</Data>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>59621,43034,MSW</Data>
</Node>
<Node><Sub>STA</Sub>
<Data>2,2@1@1@27@-1@-1@3@21@</Data>
</Node>
</Node>
<Node><Sub>Profile</Sub>
<Data>таблица Профилей@@@@@1@1@1@1@22@80@1@@1@@@2@@2,2@1@@@@@1@@@2@2@@@@@@@@@@</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@2@20@@@@@1@2;6;35;42@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@21@2@53@@@@0@1@2;6;35;42@@@@@@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>3@1@2@20@@@@@1@2;6;35;42@@@@@Состав профиля</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@21@2@53@@@@@2@2;6;30;43@@@@@@@имя программы@SOS@</Data>
</Node>
</Node>
<Node><Sub>B4I</Sub>
<Data>1</Data>
</Node>
<Node><Sub>Compile</Sub>
<Data>OK 16:16:22 2002-02-06</Data>
</Node>
<Node><Sub>DSN</Sub>
<Data>Создана B4I 2002-02-06</Data>
</Node>
<Node><Sub>Free</Sub>
<Data>59402,36007</Data>
</Node>
<Node><Sub>KEY</Sub>
<Data>^[&quot;%SYS&quot;,&quot;&quot;]%BSC4.Profile</Data>
<Node><Sub>1</Sub>
<Data>@@@@НОВОЕ ЗНАЧЕНИЕ BSiD@1,70@@@1 ИНДЕКС@2;6;30;42@@@@@ВВЕДИТЕ НОВОЕ ЗНАЧЕНИЕ BSiD@@@@@</Data>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>59402,36007,MSW</Data>
</Node>
<Node><Sub>STA</Sub>
<Data>2,2@2@2@27@-1@-1@3@21@</Data>
</Node>
</Node>
<Node><Sub>RouRef</Sub>
<Data>таблица ссылок на пользовательские программы@@@@@1@1@1@1@22@80@1@@1@@@2@@@1@@@@@1@@@3@2@@@@@@@@@@</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@2@20@@@@@1@2;6;35;42@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@21@2@53@@@@0@1@2;6;35;42@@@@@@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>3@1@2@20@@@@@1@2;6;35;42@@@@@имя программы</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@21@2@53@@@@@2@2;6;30;43@@@@@@@имя программы@Name@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>5@1@1@20@@@@@1@2;6;35;42@@@@@рабочая обасть</Data>
</Node>
<Node><Sub>2</Sub>
<Data>5@21@1@53@@@@@2@2;6;34;43@@@@@@@рабочая обасть@Namespace@</Data>
</Node>
</Node>
<Node><Sub>B4I</Sub>
<Data>1</Data>
</Node>
<Node><Sub>Compile</Sub>
<Data>OK 16:16:22 2002-02-06</Data>
</Node>
<Node><Sub>DSN</Sub>
<Data>Создана B4I 2002-02-06</Data>
</Node>
<Node><Sub>Free</Sub>
<Data>58847,80435</Data>
</Node>
<Node><Sub>KEY</Sub>
<Data>^[&quot;%SYS&quot;]%BSc4RouRef</Data>
<Node><Sub>1</Sub>
<Data>@@@@НОВОЕ ЗНАЧЕНИЕ BSiD@1,70@@@1 ИНДЕКС@2;6;30;42@@@@@ВВЕДИТЕ НОВОЕ ЗНАЧЕНИЕ BSiD@@@@@</Data>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>58847,80435,MSW</Data>
</Node>
<Node><Sub>STA</Sub>
<Data>1,1@1@1@27@-1@-1@1@1@</Data>
</Node>
</Node>
<Node><Sub>RouReq</Sub>
<Data>таблица запросов пользовательских программ@@@@@1@1@1@1@22@80@1@@1@@@2@@@1@@@@@1@@@4@2@@@@@@@@@@</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@2@20@@@@@1@2;6;35;42@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@21@2@53@@@@0@1@2;6;35;42@@@@@@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>3@1@2@20@@@@@1@2;6;35;42@@@@@ссылка на программу из RouRef</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@21@2@53@@@@@2@2;6;30;43@@@@@@@имя программы@Ref@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>5@1@1@20@@@@@1@2;6;35;42@@@@@ $H</Data>
</Node>
<Node><Sub>2</Sub>
<Data>5@21@1@53@@@@@2@2;6;34;43@@@@@@@рабочая обасть@Time@</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>6@1@1@20@@@@@1@2;6;35;42@@@@@ IP@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>6@21@1@53@@@@@2@2;6;34;43@@@@@@@рабочая обасть@IP@</Data>
</Node>
</Node>
<Node><Sub>B4I</Sub>
<Data>1</Data>
</Node>
<Node><Sub>Compile</Sub>
<Data>OK 16:16:22 2002-02-06</Data>
</Node>
<Node><Sub>DSN</Sub>
<Data>Создана B4I 2002-02-06</Data>
</Node>
<Node><Sub>Free</Sub>
<Data>58949,57569</Data>
</Node>
<Node><Sub>KEY</Sub>
<Data>^[&quot;%SYS&quot;]%BSc4RouReq</Data>
<Node><Sub>1</Sub>
<Data>@@@@НОВОЕ ЗНАЧЕНИЕ BSiD@1,70@@@1 ИНДЕКС@2;6;30;42@@@@@ВВЕДИТЕ НОВОЕ ЗНАЧЕНИЕ BSiD@@@@@</Data>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>58949,57569,MSW</Data>
</Node>
<Node><Sub>STA</Sub>
<Data>4,1@1@1@27@-1@-1@6@1@ IP</Data>
</Node>
</Node>
<Node><Sub>SESSIONS</Sub>
<Data>База Сессий@@@@@1@1@1@1@22@80@1@@1@@@2@@2,2@1@@@@@1@@@7@2@@@@@@@@</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@2@20@@@@@1@2;6;35;42@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@21@2@53@@@@0@1@2;6;35;42@@@@@@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@20@@@@@1@2;6;35;42@@@@@ ОТКРЫТА СЕССИЯ</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@21@1@53@@@@@2@1;6;32;40@@@@@@@@OHR@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>4@1@1@20@@@@@1@2;6;35;42@@@@@ ПОСЛЕДНЕЕ @</Data>
</Node>
<Node><Sub>2</Sub>
<Data>4@21@1@53@@@@@2@1;6;32;40@@@@@@@@CUR@</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>5@1@1@20@@@@@1@2;6;35;42@@@@@ СЕССИЯ ЗАКРЫТА@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>5@21@1@53@@@@@2@1;6;32;40@@@@@@@@CHR</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>6@1@1@20@@@@@1@2;6;35;42@@@@@   ИМЯ ПОЛЬЗОВАТЕЛЯ@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>6@21@1@53@@@@@2@1;6;32;40@@@@@@@@NM</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>7@1@1@20@@@@@1@2;6;35;42@@@@@          АДРЕС IP@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>7@21@1@53@@@@@2@1;6;32;40@@@@@@@@IP</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>8@1@1@20@@@@@1@2;6;35;42@@@@@  СЧЕТЧИК ОБРАЩЕНИЙ@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>8@21@1@53@@@@@2@1;6;32;40@@@@@@@@COUNT</Data>
</Node>
</Node>
<Node><Sub>FTR</Sub>
<Node><Sub>1</Sub>
<Node><Sub>2</Sub>
<Data>S d1=&quot;ССЫЛКА &quot;_$G(k1,&quot;?&quot;)</Data>
<Node><Sub>1</Sub>
<Data>&quot;ССЫЛКА &quot;_$G(k1,&quot;?&quot;)</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>Free</Sub>
<Data>60228,54005</Data>
</Node>
<Node><Sub>KEY</Sub>
<Data>^[&quot;%SYS&quot;,&quot;&quot;]%BSc4uSESS</Data>
<Node><Sub>1</Sub>
<Data>@@@@ID SESSION@1,70@@@ 1-Й ИНДЕКСНЫЙ@2;6;30;42@@@@@New ID Session@@@@@</Data>
<Node><Sub>3</Sub>
<Data><![CDATA[S d1=$$JF^%ZAPM.ed.BSC4r4($G(d0),20)_$$A^%ZAPM.ed.BSA(5,2,"SESSIONS","%BSC4","","","",$G(d0))_"'  "_$$A^%ZAPM.ed.BSA(4,2,"SESSIONS","%BSC4","","","",$G(d0))]]></Data>
</Node>
<Node><Sub>4</Sub>
<Data><![CDATA[$$JF^%ZAPM.ed.BSC4r4($G(d0),20)_{5,2,"SESSIONS","%BSC4","","","",$G(d0)}_"'  "_{4,2,"SESSIONS","%BSC4","","","",$G(d0)}]]></Data>
</Node>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>60228,54005,Styx</Data>
</Node>
<Node><Sub>STA</Sub>
<Data>2,2@2@2@27@-1@-1@3@21@</Data>
</Node>
</Node>
<Node><Sub>SMTP</Sub>
<Data>КОНФИГУРАЦИЯ УДАЛЕННЫХ ПОЧТОВЫХ СЕРВЕРОВ@@@@@1@1@1@1@22@80@1@@1@@@2@@2,2@1@@@@@1@@@5@2@@@@@@@@@@</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@2@20@@@@@1@2;6;30;42@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@21@2@53@@@@0@1@2;6;30;42@@@@@@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@20@@@@@1@2;6;30;42@@@@@      КОМЕНТАРИЙ</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@21@1@53@@@@@2@2;6;30;43@@@@@@@@REM@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>4@1@1@20@@@@@1@2;6;30;42@@@@@      ОСНОВНОЙ?@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>4@21@1@53@@@@@2@2;6;30;43@@@@@@@@DFLT@</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>5@1@1@20@@@@@1@2;6;30;42@@@@@  ПОРТ SMTP@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>5@21@1@53@@@@@2@2;6;30;43@@@@@@@@SMTP@</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>6@1@1@20@@@@@1@2;6;30;42@@@@@  ПОРТ POP@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>6@21@1@53@@@@@2@2;6;30;43@@@@@@@@POP@</Data>
</Node>
</Node>
<Node><Sub>FTR</Sub>
<Node><Sub>1</Sub>
<Node><Sub>2</Sub>
<Data>S d1=&quot; СЕРВЕР &quot;_$G(k1,&quot;?&quot;)</Data>
<Node><Sub>1</Sub>
<Data>&quot; СЕРВЕР &quot;_$G(k1,&quot;?&quot;)</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>Free</Sub>
<Data>59991,50972</Data>
</Node>
<Node><Sub>KEY</Sub>
<Data>^[&quot;%SYS&quot;,&quot;&quot;]%BScSMTP</Data>
<Node><Sub>1</Sub>
<Data>49@@64@@НОВЫЙ СЕРВЕР@1,70@@@ 1-Й ИНДЕКСНЫЙ@2;6;30;42@@@@@Введите СЕРВЕР@@@@@</Data>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>59991,50972,Styx</Data>
</Node>
<Node><Sub>STA</Sub>
<Data>2,2@2@2@27@-1@-1@3@21@</Data>
</Node>
</Node>
<Node><Sub>SQL</Sub>
<Data>ШАБЛОН ПОД SQL ТАБЛИЦУ НАСЧИТАННЫХ ОТЧЕТОВ@@@@@1@1@1@1@22@80@1@@1@@@2@@2,2@1@@@@@1@@@259@2@@@@@@@@@@</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@2@20@@@@@1@2;6;30;42@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@21@2@53@@@@0@1@2;6;30;42@@@@@@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@20@@@@0@1@2;6;30;42@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@21@1@53@@@@@2@2;6;30;43@@@@@@@@1@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>4@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>4@21@1@53@@@@@2@2;6;30;43@@@@@@@@2@</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>5@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>5@21@1@53@@@@@2@2;6;30;43@@@@@@@@3@</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>6@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>6@21@1@53@@@@@2@2;6;30;43@@@@@@@@4@</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>7@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>7@21@1@53@@@@@2@2;6;30;43@@@@@@@@5@</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>8@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>8@21@1@53@@@@@2@2;6;30;43@@@@@@@@6@</Data>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>1</Sub>
<Data>9@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>9@21@1@53@@@@@2@2;6;30;43@@@@@@@@7@</Data>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>1</Sub>
<Data>10@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>10@21@1@53@@@@@2@2;6;30;43@@@@@@@@8@</Data>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>1</Sub>
<Data>11@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>11@21@1@53@@@@@2@2;6;30;43@@@@@@@@9@</Data>
</Node>
</Node>
<Node><Sub>11</Sub>
<Node><Sub>1</Sub>
<Data>12@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>12@21@1@53@@@@@2@2;6;30;43@@@@@@@@10@</Data>
</Node>
</Node>
<Node><Sub>12</Sub>
<Node><Sub>1</Sub>
<Data>13@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>13@21@1@53@@@@@2@2;6;30;43@@@@@@@@11@</Data>
</Node>
</Node>
<Node><Sub>13</Sub>
<Node><Sub>1</Sub>
<Data>14@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>14@21@1@53@@@@@2@2;6;30;43@@@@@@@@12@</Data>
</Node>
</Node>
<Node><Sub>14</Sub>
<Node><Sub>1</Sub>
<Data>15@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>15@21@1@53@@@@@2@2;6;30;43@@@@@@@@13@</Data>
</Node>
</Node>
<Node><Sub>15</Sub>
<Node><Sub>1</Sub>
<Data>16@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>16@21@1@53@@@@@2@2;6;30;43@@@@@@@@14@</Data>
</Node>
</Node>
<Node><Sub>16</Sub>
<Node><Sub>1</Sub>
<Data>17@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>17@21@1@53@@@@@2@2;6;30;43@@@@@@@@15@</Data>
</Node>
</Node>
<Node><Sub>17</Sub>
<Node><Sub>1</Sub>
<Data>18@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>18@21@1@53@@@@@2@2;6;30;43@@@@@@@@16@</Data>
</Node>
</Node>
<Node><Sub>18</Sub>
<Node><Sub>1</Sub>
<Data>19@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>19@21@1@53@@@@@2@2;6;30;43@@@@@@@@17@</Data>
</Node>
</Node>
<Node><Sub>19</Sub>
<Node><Sub>1</Sub>
<Data>20@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>20@21@1@53@@@@@2@2;6;30;43@@@@@@@@18@</Data>
</Node>
</Node>
<Node><Sub>20</Sub>
<Node><Sub>1</Sub>
<Data>21@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>21@21@1@53@@@@@2@2;6;30;43@@@@@@@@19@</Data>
</Node>
</Node>
<Node><Sub>21</Sub>
<Node><Sub>1</Sub>
<Data>22@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>22@21@1@53@@@@@2@2;6;30;43@@@@@@@@20@</Data>
</Node>
</Node>
<Node><Sub>22</Sub>
<Node><Sub>1</Sub>
<Data>23@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>23@21@1@53@@@@@2@2;6;30;43@@@@@@@@21@</Data>
</Node>
</Node>
<Node><Sub>23</Sub>
<Node><Sub>1</Sub>
<Data>24@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>24@21@1@53@@@@@2@2;6;30;43@@@@@@@@22@</Data>
</Node>
</Node>
<Node><Sub>24</Sub>
<Node><Sub>1</Sub>
<Data>25@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>25@21@1@53@@@@@2@2;6;30;43@@@@@@@@23@</Data>
</Node>
</Node>
<Node><Sub>25</Sub>
<Node><Sub>1</Sub>
<Data>26@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>26@21@1@53@@@@@2@2;6;30;43@@@@@@@@24@</Data>
</Node>
</Node>
<Node><Sub>26</Sub>
<Node><Sub>1</Sub>
<Data>27@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>27@21@1@53@@@@@2@2;6;30;43@@@@@@@@25@</Data>
</Node>
</Node>
<Node><Sub>27</Sub>
<Node><Sub>1</Sub>
<Data>28@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>28@21@1@53@@@@@2@2;6;30;43@@@@@@@@26@</Data>
</Node>
</Node>
<Node><Sub>28</Sub>
<Node><Sub>1</Sub>
<Data>29@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>29@21@1@53@@@@@2@2;6;30;43@@@@@@@@27@</Data>
</Node>
</Node>
<Node><Sub>29</Sub>
<Node><Sub>1</Sub>
<Data>30@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>30@21@1@53@@@@@2@2;6;30;43@@@@@@@@28@</Data>
</Node>
</Node>
<Node><Sub>30</Sub>
<Node><Sub>1</Sub>
<Data>31@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>31@21@1@53@@@@@2@2;6;30;43@@@@@@@@29@</Data>
</Node>
</Node>
<Node><Sub>31</Sub>
<Node><Sub>1</Sub>
<Data>32@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>32@21@1@53@@@@@2@2;6;30;43@@@@@@@@30@</Data>
</Node>
</Node>
<Node><Sub>32</Sub>
<Node><Sub>1</Sub>
<Data>33@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>33@21@1@53@@@@@2@2;6;30;43@@@@@@@@31@</Data>
</Node>
</Node>
<Node><Sub>33</Sub>
<Node><Sub>1</Sub>
<Data>34@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>34@21@1@53@@@@@2@2;6;30;43@@@@@@@@32@</Data>
</Node>
</Node>
<Node><Sub>34</Sub>
<Node><Sub>1</Sub>
<Data>35@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>35@21@1@53@@@@@2@2;6;30;43@@@@@@@@33@</Data>
</Node>
</Node>
<Node><Sub>35</Sub>
<Node><Sub>1</Sub>
<Data>36@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>36@21@1@53@@@@@2@2;6;30;43@@@@@@@@34@</Data>
</Node>
</Node>
<Node><Sub>36</Sub>
<Node><Sub>1</Sub>
<Data>37@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>37@21@1@53@@@@@2@2;6;30;43@@@@@@@@35@</Data>
</Node>
</Node>
<Node><Sub>37</Sub>
<Node><Sub>1</Sub>
<Data>38@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>38@21@1@53@@@@@2@2;6;30;43@@@@@@@@36@</Data>
</Node>
</Node>
<Node><Sub>38</Sub>
<Node><Sub>1</Sub>
<Data>39@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>39@21@1@53@@@@@2@2;6;30;43@@@@@@@@37@</Data>
</Node>
</Node>
<Node><Sub>39</Sub>
<Node><Sub>1</Sub>
<Data>40@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>40@21@1@53@@@@@2@2;6;30;43@@@@@@@@38@</Data>
</Node>
</Node>
<Node><Sub>40</Sub>
<Node><Sub>1</Sub>
<Data>41@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>41@21@1@53@@@@@2@2;6;30;43@@@@@@@@39@</Data>
</Node>
</Node>
<Node><Sub>41</Sub>
<Node><Sub>1</Sub>
<Data>42@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>42@21@1@53@@@@@2@2;6;30;43@@@@@@@@40@</Data>
</Node>
</Node>
<Node><Sub>42</Sub>
<Node><Sub>1</Sub>
<Data>43@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>43@21@1@53@@@@@2@2;6;30;43@@@@@@@@41@</Data>
</Node>
</Node>
<Node><Sub>43</Sub>
<Node><Sub>1</Sub>
<Data>44@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>44@21@1@53@@@@@2@2;6;30;43@@@@@@@@42@</Data>
</Node>
</Node>
<Node><Sub>44</Sub>
<Node><Sub>1</Sub>
<Data>45@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>45@21@1@53@@@@@2@2;6;30;43@@@@@@@@43@</Data>
</Node>
</Node>
<Node><Sub>45</Sub>
<Node><Sub>1</Sub>
<Data>46@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>46@21@1@53@@@@@2@2;6;30;43@@@@@@@@44@</Data>
</Node>
</Node>
<Node><Sub>46</Sub>
<Node><Sub>1</Sub>
<Data>47@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>47@21@1@53@@@@@2@2;6;30;43@@@@@@@@45@</Data>
</Node>
</Node>
<Node><Sub>47</Sub>
<Node><Sub>1</Sub>
<Data>48@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>48@21@1@53@@@@@2@2;6;30;43@@@@@@@@46@</Data>
</Node>
</Node>
<Node><Sub>48</Sub>
<Node><Sub>1</Sub>
<Data>49@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>49@21@1@53@@@@@2@2;6;30;43@@@@@@@@47@</Data>
</Node>
</Node>
<Node><Sub>49</Sub>
<Node><Sub>1</Sub>
<Data>50@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>50@21@1@53@@@@@2@2;6;30;43@@@@@@@@48@</Data>
</Node>
</Node>
<Node><Sub>50</Sub>
<Node><Sub>1</Sub>
<Data>51@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>51@21@1@53@@@@@2@2;6;30;43@@@@@@@@49@</Data>
</Node>
</Node>
<Node><Sub>51</Sub>
<Node><Sub>1</Sub>
<Data>52@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>52@21@1@53@@@@@2@2;6;30;43@@@@@@@@50@</Data>
</Node>
</Node>
<Node><Sub>52</Sub>
<Node><Sub>1</Sub>
<Data>53@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>53@21@1@53@@@@@2@2;6;30;43@@@@@@@@51@</Data>
</Node>
</Node>
<Node><Sub>53</Sub>
<Node><Sub>1</Sub>
<Data>54@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>54@21@1@53@@@@@2@2;6;30;43@@@@@@@@52@</Data>
</Node>
</Node>
<Node><Sub>54</Sub>
<Node><Sub>1</Sub>
<Data>55@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>55@21@1@53@@@@@2@2;6;30;43@@@@@@@@53@</Data>
</Node>
</Node>
<Node><Sub>55</Sub>
<Node><Sub>1</Sub>
<Data>56@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>56@21@1@53@@@@@2@2;6;30;43@@@@@@@@54@</Data>
</Node>
</Node>
<Node><Sub>56</Sub>
<Node><Sub>1</Sub>
<Data>57@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>57@21@1@53@@@@@2@2;6;30;43@@@@@@@@55@</Data>
</Node>
</Node>
<Node><Sub>57</Sub>
<Node><Sub>1</Sub>
<Data>58@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>58@21@1@53@@@@@2@2;6;30;43@@@@@@@@56@</Data>
</Node>
</Node>
<Node><Sub>58</Sub>
<Node><Sub>1</Sub>
<Data>59@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>59@21@1@53@@@@@2@2;6;30;43@@@@@@@@57@</Data>
</Node>
</Node>
<Node><Sub>59</Sub>
<Node><Sub>1</Sub>
<Data>60@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>60@21@1@53@@@@@2@2;6;30;43@@@@@@@@58@</Data>
</Node>
</Node>
<Node><Sub>60</Sub>
<Node><Sub>1</Sub>
<Data>61@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>61@21@1@53@@@@@2@2;6;30;43@@@@@@@@59@</Data>
</Node>
</Node>
<Node><Sub>61</Sub>
<Node><Sub>1</Sub>
<Data>62@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>62@21@1@53@@@@@2@2;6;30;43@@@@@@@@60@</Data>
</Node>
</Node>
<Node><Sub>62</Sub>
<Node><Sub>1</Sub>
<Data>63@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>63@21@1@53@@@@@2@2;6;30;43@@@@@@@@61@</Data>
</Node>
</Node>
<Node><Sub>63</Sub>
<Node><Sub>1</Sub>
<Data>64@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>64@21@1@53@@@@@2@2;6;30;43@@@@@@@@62@</Data>
</Node>
</Node>
<Node><Sub>64</Sub>
<Node><Sub>1</Sub>
<Data>65@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>65@21@1@53@@@@@2@2;6;30;43@@@@@@@@63@</Data>
</Node>
</Node>
<Node><Sub>65</Sub>
<Node><Sub>1</Sub>
<Data>66@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>66@21@1@53@@@@@2@2;6;30;43@@@@@@@@64@</Data>
</Node>
</Node>
<Node><Sub>66</Sub>
<Node><Sub>1</Sub>
<Data>67@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>67@21@1@53@@@@@2@2;6;30;43@@@@@@@@65@</Data>
</Node>
</Node>
<Node><Sub>67</Sub>
<Node><Sub>1</Sub>
<Data>68@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>68@21@1@53@@@@@2@2;6;30;43@@@@@@@@66@</Data>
</Node>
</Node>
<Node><Sub>68</Sub>
<Node><Sub>1</Sub>
<Data>69@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>69@21@1@53@@@@@2@2;6;30;43@@@@@@@@67@</Data>
</Node>
</Node>
<Node><Sub>69</Sub>
<Node><Sub>1</Sub>
<Data>70@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>70@21@1@53@@@@@2@2;6;30;43@@@@@@@@68@</Data>
</Node>
</Node>
<Node><Sub>70</Sub>
<Node><Sub>1</Sub>
<Data>71@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>71@21@1@53@@@@@2@2;6;30;43@@@@@@@@69@</Data>
</Node>
</Node>
<Node><Sub>71</Sub>
<Node><Sub>1</Sub>
<Data>72@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>72@21@1@53@@@@@2@2;6;30;43@@@@@@@@70@</Data>
</Node>
</Node>
<Node><Sub>72</Sub>
<Node><Sub>1</Sub>
<Data>73@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>73@21@1@53@@@@@2@2;6;30;43@@@@@@@@71@</Data>
</Node>
</Node>
<Node><Sub>73</Sub>
<Node><Sub>1</Sub>
<Data>74@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>74@21@1@53@@@@@2@2;6;30;43@@@@@@@@72@</Data>
</Node>
</Node>
<Node><Sub>74</Sub>
<Node><Sub>1</Sub>
<Data>75@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>75@21@1@53@@@@@2@2;6;30;43@@@@@@@@73@</Data>
</Node>
</Node>
<Node><Sub>75</Sub>
<Node><Sub>1</Sub>
<Data>76@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>76@21@1@53@@@@@2@2;6;30;43@@@@@@@@74@</Data>
</Node>
</Node>
<Node><Sub>76</Sub>
<Node><Sub>1</Sub>
<Data>77@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>77@21@1@53@@@@@2@2;6;30;43@@@@@@@@75@</Data>
</Node>
</Node>
<Node><Sub>77</Sub>
<Node><Sub>1</Sub>
<Data>78@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>78@21@1@53@@@@@2@2;6;30;43@@@@@@@@76@</Data>
</Node>
</Node>
<Node><Sub>78</Sub>
<Node><Sub>1</Sub>
<Data>79@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>79@21@1@53@@@@@2@2;6;30;43@@@@@@@@77@</Data>
</Node>
</Node>
<Node><Sub>79</Sub>
<Node><Sub>1</Sub>
<Data>80@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>80@21@1@53@@@@@2@2;6;30;43@@@@@@@@78@</Data>
</Node>
</Node>
<Node><Sub>80</Sub>
<Node><Sub>1</Sub>
<Data>81@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>81@21@1@53@@@@@2@2;6;30;43@@@@@@@@79@</Data>
</Node>
</Node>
<Node><Sub>81</Sub>
<Node><Sub>1</Sub>
<Data>82@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>82@21@1@53@@@@@2@2;6;30;43@@@@@@@@80@</Data>
</Node>
</Node>
<Node><Sub>82</Sub>
<Node><Sub>1</Sub>
<Data>83@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>83@21@1@53@@@@@2@2;6;30;43@@@@@@@@81@</Data>
</Node>
</Node>
<Node><Sub>83</Sub>
<Node><Sub>1</Sub>
<Data>84@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>84@21@1@53@@@@@2@2;6;30;43@@@@@@@@82@</Data>
</Node>
</Node>
<Node><Sub>84</Sub>
<Node><Sub>1</Sub>
<Data>85@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>85@21@1@53@@@@@2@2;6;30;43@@@@@@@@83@</Data>
</Node>
</Node>
<Node><Sub>85</Sub>
<Node><Sub>1</Sub>
<Data>86@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>86@21@1@53@@@@@2@2;6;30;43@@@@@@@@84@</Data>
</Node>
</Node>
<Node><Sub>86</Sub>
<Node><Sub>1</Sub>
<Data>87@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>87@21@1@53@@@@@2@2;6;30;43@@@@@@@@85@</Data>
</Node>
</Node>
<Node><Sub>87</Sub>
<Node><Sub>1</Sub>
<Data>88@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>88@21@1@53@@@@@2@2;6;30;43@@@@@@@@86@</Data>
</Node>
</Node>
<Node><Sub>88</Sub>
<Node><Sub>1</Sub>
<Data>89@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>89@21@1@53@@@@@2@2;6;30;43@@@@@@@@87@</Data>
</Node>
</Node>
<Node><Sub>89</Sub>
<Node><Sub>1</Sub>
<Data>90@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>90@21@1@53@@@@@2@2;6;30;43@@@@@@@@88@</Data>
</Node>
</Node>
<Node><Sub>90</Sub>
<Node><Sub>1</Sub>
<Data>91@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>91@21@1@53@@@@@2@2;6;30;43@@@@@@@@89@</Data>
</Node>
</Node>
<Node><Sub>91</Sub>
<Node><Sub>1</Sub>
<Data>92@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>92@21@1@53@@@@@2@2;6;30;43@@@@@@@@90@</Data>
</Node>
</Node>
<Node><Sub>92</Sub>
<Node><Sub>1</Sub>
<Data>93@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>93@21@1@53@@@@@2@2;6;30;43@@@@@@@@91@</Data>
</Node>
</Node>
<Node><Sub>93</Sub>
<Node><Sub>1</Sub>
<Data>94@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>94@21@1@53@@@@@2@2;6;30;43@@@@@@@@92@</Data>
</Node>
</Node>
<Node><Sub>94</Sub>
<Node><Sub>1</Sub>
<Data>95@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>95@21@1@53@@@@@2@2;6;30;43@@@@@@@@93@</Data>
</Node>
</Node>
<Node><Sub>95</Sub>
<Node><Sub>1</Sub>
<Data>96@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>96@21@1@53@@@@@2@2;6;30;43@@@@@@@@94@</Data>
</Node>
</Node>
<Node><Sub>96</Sub>
<Node><Sub>1</Sub>
<Data>97@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>97@21@1@53@@@@@2@2;6;30;43@@@@@@@@95@</Data>
</Node>
</Node>
<Node><Sub>97</Sub>
<Node><Sub>1</Sub>
<Data>98@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>98@21@1@53@@@@@2@2;6;30;43@@@@@@@@96@</Data>
</Node>
</Node>
<Node><Sub>98</Sub>
<Node><Sub>1</Sub>
<Data>99@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>99@21@1@53@@@@@2@2;6;30;43@@@@@@@@97@</Data>
</Node>
</Node>
<Node><Sub>99</Sub>
<Node><Sub>1</Sub>
<Data>100@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>100@21@1@53@@@@@2@2;6;30;43@@@@@@@@98@</Data>
</Node>
</Node>
<Node><Sub>100</Sub>
<Node><Sub>1</Sub>
<Data>101@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>101@21@1@53@@@@@2@2;6;30;43@@@@@@@@99@</Data>
</Node>
</Node>
<Node><Sub>101</Sub>
<Node><Sub>1</Sub>
<Data>102@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>102@21@1@53@@@@@2@2;6;30;43@@@@@@@@100@</Data>
</Node>
</Node>
<Node><Sub>102</Sub>
<Node><Sub>1</Sub>
<Data>103@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>103@21@1@53@@@@@2@2;6;30;43@@@@@@@@101@</Data>
</Node>
</Node>
<Node><Sub>103</Sub>
<Node><Sub>1</Sub>
<Data>104@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>104@21@1@53@@@@@2@2;6;30;43@@@@@@@@102@</Data>
</Node>
</Node>
<Node><Sub>104</Sub>
<Node><Sub>1</Sub>
<Data>105@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>105@21@1@53@@@@@2@2;6;30;43@@@@@@@@103@</Data>
</Node>
</Node>
<Node><Sub>105</Sub>
<Node><Sub>1</Sub>
<Data>106@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>106@21@1@53@@@@@2@2;6;30;43@@@@@@@@104@</Data>
</Node>
</Node>
<Node><Sub>106</Sub>
<Node><Sub>1</Sub>
<Data>107@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>107@21@1@53@@@@@2@2;6;30;43@@@@@@@@105@</Data>
</Node>
</Node>
<Node><Sub>107</Sub>
<Node><Sub>1</Sub>
<Data>108@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>108@21@1@53@@@@@2@2;6;30;43@@@@@@@@106@</Data>
</Node>
</Node>
<Node><Sub>108</Sub>
<Node><Sub>1</Sub>
<Data>109@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>109@21@1@53@@@@@2@2;6;30;43@@@@@@@@107@</Data>
</Node>
</Node>
<Node><Sub>109</Sub>
<Node><Sub>1</Sub>
<Data>110@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>110@21@1@53@@@@@2@2;6;30;43@@@@@@@@108@</Data>
</Node>
</Node>
<Node><Sub>110</Sub>
<Node><Sub>1</Sub>
<Data>111@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>111@21@1@53@@@@@2@2;6;30;43@@@@@@@@109@</Data>
</Node>
</Node>
<Node><Sub>111</Sub>
<Node><Sub>1</Sub>
<Data>112@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>112@21@1@53@@@@@2@2;6;30;43@@@@@@@@110@</Data>
</Node>
</Node>
<Node><Sub>112</Sub>
<Node><Sub>1</Sub>
<Data>113@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>113@21@1@53@@@@@2@2;6;30;43@@@@@@@@111@</Data>
</Node>
</Node>
<Node><Sub>113</Sub>
<Node><Sub>1</Sub>
<Data>114@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>114@21@1@53@@@@@2@2;6;30;43@@@@@@@@112@</Data>
</Node>
</Node>
<Node><Sub>114</Sub>
<Node><Sub>1</Sub>
<Data>115@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>115@21@1@53@@@@@2@2;6;30;43@@@@@@@@113@</Data>
</Node>
</Node>
<Node><Sub>115</Sub>
<Node><Sub>1</Sub>
<Data>116@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>116@21@1@53@@@@@2@2;6;30;43@@@@@@@@114@</Data>
</Node>
</Node>
<Node><Sub>116</Sub>
<Node><Sub>1</Sub>
<Data>117@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>117@21@1@53@@@@@2@2;6;30;43@@@@@@@@115@</Data>
</Node>
</Node>
<Node><Sub>117</Sub>
<Node><Sub>1</Sub>
<Data>118@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>118@21@1@53@@@@@2@2;6;30;43@@@@@@@@116@</Data>
</Node>
</Node>
<Node><Sub>118</Sub>
<Node><Sub>1</Sub>
<Data>119@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>119@21@1@53@@@@@2@2;6;30;43@@@@@@@@117@</Data>
</Node>
</Node>
<Node><Sub>119</Sub>
<Node><Sub>1</Sub>
<Data>120@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>120@21@1@53@@@@@2@2;6;30;43@@@@@@@@118@</Data>
</Node>
</Node>
<Node><Sub>120</Sub>
<Node><Sub>1</Sub>
<Data>121@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>121@21@1@53@@@@@2@2;6;30;43@@@@@@@@119@</Data>
</Node>
</Node>
<Node><Sub>121</Sub>
<Node><Sub>1</Sub>
<Data>122@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>122@21@1@53@@@@@2@2;6;30;43@@@@@@@@120@</Data>
</Node>
</Node>
<Node><Sub>122</Sub>
<Node><Sub>1</Sub>
<Data>123@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>123@21@1@53@@@@@2@2;6;30;43@@@@@@@@121@</Data>
</Node>
</Node>
<Node><Sub>123</Sub>
<Node><Sub>1</Sub>
<Data>124@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>124@21@1@53@@@@@2@2;6;30;43@@@@@@@@122@</Data>
</Node>
</Node>
<Node><Sub>124</Sub>
<Node><Sub>1</Sub>
<Data>125@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>125@21@1@53@@@@@2@2;6;30;43@@@@@@@@123@</Data>
</Node>
</Node>
<Node><Sub>125</Sub>
<Node><Sub>1</Sub>
<Data>126@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>126@21@1@53@@@@@2@2;6;30;43@@@@@@@@124@</Data>
</Node>
</Node>
<Node><Sub>126</Sub>
<Node><Sub>1</Sub>
<Data>127@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>127@21@1@53@@@@@2@2;6;30;43@@@@@@@@125@</Data>
</Node>
</Node>
<Node><Sub>127</Sub>
<Node><Sub>1</Sub>
<Data>128@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>128@21@1@53@@@@@2@2;6;30;43@@@@@@@@126@</Data>
</Node>
</Node>
<Node><Sub>128</Sub>
<Node><Sub>1</Sub>
<Data>129@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>129@21@1@53@@@@@2@2;6;30;43@@@@@@@@127@</Data>
</Node>
</Node>
<Node><Sub>129</Sub>
<Node><Sub>1</Sub>
<Data>130@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>130@21@1@53@@@@@2@2;6;30;43@@@@@@@@128@</Data>
</Node>
</Node>
<Node><Sub>130</Sub>
<Node><Sub>1</Sub>
<Data>131@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>131@21@1@53@@@@@2@2;6;30;43@@@@@@@@129@</Data>
</Node>
</Node>
<Node><Sub>131</Sub>
<Node><Sub>1</Sub>
<Data>132@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>132@21@1@53@@@@@2@2;6;30;43@@@@@@@@130@</Data>
</Node>
</Node>
<Node><Sub>132</Sub>
<Node><Sub>1</Sub>
<Data>133@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>133@21@1@53@@@@@2@2;6;30;43@@@@@@@@131@</Data>
</Node>
</Node>
<Node><Sub>133</Sub>
<Node><Sub>1</Sub>
<Data>134@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>134@21@1@53@@@@@2@2;6;30;43@@@@@@@@132@</Data>
</Node>
</Node>
<Node><Sub>134</Sub>
<Node><Sub>1</Sub>
<Data>135@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>135@21@1@53@@@@@2@2;6;30;43@@@@@@@@133@</Data>
</Node>
</Node>
<Node><Sub>135</Sub>
<Node><Sub>1</Sub>
<Data>136@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>136@21@1@53@@@@@2@2;6;30;43@@@@@@@@134@</Data>
</Node>
</Node>
<Node><Sub>136</Sub>
<Node><Sub>1</Sub>
<Data>137@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>137@21@1@53@@@@@2@2;6;30;43@@@@@@@@135@</Data>
</Node>
</Node>
<Node><Sub>137</Sub>
<Node><Sub>1</Sub>
<Data>138@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>138@21@1@53@@@@@2@2;6;30;43@@@@@@@@136@</Data>
</Node>
</Node>
<Node><Sub>138</Sub>
<Node><Sub>1</Sub>
<Data>139@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>139@21@1@53@@@@@2@2;6;30;43@@@@@@@@137@</Data>
</Node>
</Node>
<Node><Sub>139</Sub>
<Node><Sub>1</Sub>
<Data>140@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>140@21@1@53@@@@@2@2;6;30;43@@@@@@@@138@</Data>
</Node>
</Node>
<Node><Sub>140</Sub>
<Node><Sub>1</Sub>
<Data>141@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>141@21@1@53@@@@@2@2;6;30;43@@@@@@@@139@</Data>
</Node>
</Node>
<Node><Sub>141</Sub>
<Node><Sub>1</Sub>
<Data>142@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>142@21@1@53@@@@@2@2;6;30;43@@@@@@@@140@</Data>
</Node>
</Node>
<Node><Sub>142</Sub>
<Node><Sub>1</Sub>
<Data>143@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>143@21@1@53@@@@@2@2;6;30;43@@@@@@@@141@</Data>
</Node>
</Node>
<Node><Sub>143</Sub>
<Node><Sub>1</Sub>
<Data>144@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>144@21@1@53@@@@@2@2;6;30;43@@@@@@@@142@</Data>
</Node>
</Node>
<Node><Sub>144</Sub>
<Node><Sub>1</Sub>
<Data>145@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>145@21@1@53@@@@@2@2;6;30;43@@@@@@@@143@</Data>
</Node>
</Node>
<Node><Sub>145</Sub>
<Node><Sub>1</Sub>
<Data>146@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>146@21@1@53@@@@@2@2;6;30;43@@@@@@@@144@</Data>
</Node>
</Node>
<Node><Sub>146</Sub>
<Node><Sub>1</Sub>
<Data>147@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>147@21@1@53@@@@@2@2;6;30;43@@@@@@@@145@</Data>
</Node>
</Node>
<Node><Sub>147</Sub>
<Node><Sub>1</Sub>
<Data>148@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>148@21@1@53@@@@@2@2;6;30;43@@@@@@@@146@</Data>
</Node>
</Node>
<Node><Sub>148</Sub>
<Node><Sub>1</Sub>
<Data>149@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>149@21@1@53@@@@@2@2;6;30;43@@@@@@@@147@</Data>
</Node>
</Node>
<Node><Sub>149</Sub>
<Node><Sub>1</Sub>
<Data>150@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>150@21@1@53@@@@@2@2;6;30;43@@@@@@@@148@</Data>
</Node>
</Node>
<Node><Sub>150</Sub>
<Node><Sub>1</Sub>
<Data>151@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>151@21@1@53@@@@@2@2;6;30;43@@@@@@@@149@</Data>
</Node>
</Node>
<Node><Sub>151</Sub>
<Node><Sub>1</Sub>
<Data>152@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>152@21@1@53@@@@@2@2;6;30;43@@@@@@@@150@</Data>
</Node>
</Node>
<Node><Sub>152</Sub>
<Node><Sub>1</Sub>
<Data>153@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>153@21@1@53@@@@@2@2;6;30;43@@@@@@@@151@</Data>
</Node>
</Node>
<Node><Sub>153</Sub>
<Node><Sub>1</Sub>
<Data>154@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>154@21@1@53@@@@@2@2;6;30;43@@@@@@@@152@</Data>
</Node>
</Node>
<Node><Sub>154</Sub>
<Node><Sub>1</Sub>
<Data>155@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>155@21@1@53@@@@@2@2;6;30;43@@@@@@@@153@</Data>
</Node>
</Node>
<Node><Sub>155</Sub>
<Node><Sub>1</Sub>
<Data>156@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>156@21@1@53@@@@@2@2;6;30;43@@@@@@@@154@</Data>
</Node>
</Node>
<Node><Sub>156</Sub>
<Node><Sub>1</Sub>
<Data>157@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>157@21@1@53@@@@@2@2;6;30;43@@@@@@@@155@</Data>
</Node>
</Node>
<Node><Sub>157</Sub>
<Node><Sub>1</Sub>
<Data>158@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>158@21@1@53@@@@@2@2;6;30;43@@@@@@@@156@</Data>
</Node>
</Node>
<Node><Sub>158</Sub>
<Node><Sub>1</Sub>
<Data>159@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>159@21@1@53@@@@@2@2;6;30;43@@@@@@@@157@</Data>
</Node>
</Node>
<Node><Sub>159</Sub>
<Node><Sub>1</Sub>
<Data>160@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>160@21@1@53@@@@@2@2;6;30;43@@@@@@@@158@</Data>
</Node>
</Node>
<Node><Sub>160</Sub>
<Node><Sub>1</Sub>
<Data>161@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>161@21@1@53@@@@@2@2;6;30;43@@@@@@@@159@</Data>
</Node>
</Node>
<Node><Sub>161</Sub>
<Node><Sub>1</Sub>
<Data>162@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>162@21@1@53@@@@@2@2;6;30;43@@@@@@@@160@</Data>
</Node>
</Node>
<Node><Sub>162</Sub>
<Node><Sub>1</Sub>
<Data>163@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>163@21@1@53@@@@@2@2;6;30;43@@@@@@@@161@</Data>
</Node>
</Node>
<Node><Sub>163</Sub>
<Node><Sub>1</Sub>
<Data>164@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>164@21@1@53@@@@@2@2;6;30;43@@@@@@@@162@</Data>
</Node>
</Node>
<Node><Sub>164</Sub>
<Node><Sub>1</Sub>
<Data>165@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>165@21@1@53@@@@@2@2;6;30;43@@@@@@@@163@</Data>
</Node>
</Node>
<Node><Sub>165</Sub>
<Node><Sub>1</Sub>
<Data>166@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>166@21@1@53@@@@@2@2;6;30;43@@@@@@@@164@</Data>
</Node>
</Node>
<Node><Sub>166</Sub>
<Node><Sub>1</Sub>
<Data>167@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>167@21@1@53@@@@@2@2;6;30;43@@@@@@@@165@</Data>
</Node>
</Node>
<Node><Sub>167</Sub>
<Node><Sub>1</Sub>
<Data>168@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>168@21@1@53@@@@@2@2;6;30;43@@@@@@@@166@</Data>
</Node>
</Node>
<Node><Sub>168</Sub>
<Node><Sub>1</Sub>
<Data>169@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>169@21@1@53@@@@@2@2;6;30;43@@@@@@@@167@</Data>
</Node>
</Node>
<Node><Sub>169</Sub>
<Node><Sub>1</Sub>
<Data>170@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>170@21@1@53@@@@@2@2;6;30;43@@@@@@@@168@</Data>
</Node>
</Node>
<Node><Sub>170</Sub>
<Node><Sub>1</Sub>
<Data>171@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>171@21@1@53@@@@@2@2;6;30;43@@@@@@@@169@</Data>
</Node>
</Node>
<Node><Sub>171</Sub>
<Node><Sub>1</Sub>
<Data>172@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>172@21@1@53@@@@@2@2;6;30;43@@@@@@@@170@</Data>
</Node>
</Node>
<Node><Sub>172</Sub>
<Node><Sub>1</Sub>
<Data>173@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>173@21@1@53@@@@@2@2;6;30;43@@@@@@@@171@</Data>
</Node>
</Node>
<Node><Sub>173</Sub>
<Node><Sub>1</Sub>
<Data>174@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>174@21@1@53@@@@@2@2;6;30;43@@@@@@@@172@</Data>
</Node>
</Node>
<Node><Sub>174</Sub>
<Node><Sub>1</Sub>
<Data>175@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>175@21@1@53@@@@@2@2;6;30;43@@@@@@@@173@</Data>
</Node>
</Node>
<Node><Sub>175</Sub>
<Node><Sub>1</Sub>
<Data>176@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>176@21@1@53@@@@@2@2;6;30;43@@@@@@@@174@</Data>
</Node>
</Node>
<Node><Sub>176</Sub>
<Node><Sub>1</Sub>
<Data>177@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>177@21@1@53@@@@@2@2;6;30;43@@@@@@@@175@</Data>
</Node>
</Node>
<Node><Sub>177</Sub>
<Node><Sub>1</Sub>
<Data>178@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>178@21@1@53@@@@@2@2;6;30;43@@@@@@@@176@</Data>
</Node>
</Node>
<Node><Sub>178</Sub>
<Node><Sub>1</Sub>
<Data>179@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>179@21@1@53@@@@@2@2;6;30;43@@@@@@@@177@</Data>
</Node>
</Node>
<Node><Sub>179</Sub>
<Node><Sub>1</Sub>
<Data>180@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>180@21@1@53@@@@@2@2;6;30;43@@@@@@@@178@</Data>
</Node>
</Node>
<Node><Sub>180</Sub>
<Node><Sub>1</Sub>
<Data>181@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>181@21@1@53@@@@@2@2;6;30;43@@@@@@@@179@</Data>
</Node>
</Node>
<Node><Sub>181</Sub>
<Node><Sub>1</Sub>
<Data>182@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>182@21@1@53@@@@@2@2;6;30;43@@@@@@@@180@</Data>
</Node>
</Node>
<Node><Sub>182</Sub>
<Node><Sub>1</Sub>
<Data>183@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>183@21@1@53@@@@@2@2;6;30;43@@@@@@@@181@</Data>
</Node>
</Node>
<Node><Sub>183</Sub>
<Node><Sub>1</Sub>
<Data>184@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>184@21@1@53@@@@@2@2;6;30;43@@@@@@@@182@</Data>
</Node>
</Node>
<Node><Sub>184</Sub>
<Node><Sub>1</Sub>
<Data>185@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>185@21@1@53@@@@@2@2;6;30;43@@@@@@@@183@</Data>
</Node>
</Node>
<Node><Sub>185</Sub>
<Node><Sub>1</Sub>
<Data>186@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>186@21@1@53@@@@@2@2;6;30;43@@@@@@@@184@</Data>
</Node>
</Node>
<Node><Sub>186</Sub>
<Node><Sub>1</Sub>
<Data>187@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>187@21@1@53@@@@@2@2;6;30;43@@@@@@@@185@</Data>
</Node>
</Node>
<Node><Sub>187</Sub>
<Node><Sub>1</Sub>
<Data>188@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>188@21@1@53@@@@@2@2;6;30;43@@@@@@@@186@</Data>
</Node>
</Node>
<Node><Sub>188</Sub>
<Node><Sub>1</Sub>
<Data>189@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>189@21@1@53@@@@@2@2;6;30;43@@@@@@@@187@</Data>
</Node>
</Node>
<Node><Sub>189</Sub>
<Node><Sub>1</Sub>
<Data>190@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>190@21@1@53@@@@@2@2;6;30;43@@@@@@@@188@</Data>
</Node>
</Node>
<Node><Sub>190</Sub>
<Node><Sub>1</Sub>
<Data>191@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>191@21@1@53@@@@@2@2;6;30;43@@@@@@@@189@</Data>
</Node>
</Node>
<Node><Sub>191</Sub>
<Node><Sub>1</Sub>
<Data>192@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>192@21@1@53@@@@@2@2;6;30;43@@@@@@@@190@</Data>
</Node>
</Node>
<Node><Sub>192</Sub>
<Node><Sub>1</Sub>
<Data>193@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>193@21@1@53@@@@@2@2;6;30;43@@@@@@@@191@</Data>
</Node>
</Node>
<Node><Sub>193</Sub>
<Node><Sub>1</Sub>
<Data>194@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>194@21@1@53@@@@@2@2;6;30;43@@@@@@@@192@</Data>
</Node>
</Node>
<Node><Sub>194</Sub>
<Node><Sub>1</Sub>
<Data>195@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>195@21@1@53@@@@@2@2;6;30;43@@@@@@@@193@</Data>
</Node>
</Node>
<Node><Sub>195</Sub>
<Node><Sub>1</Sub>
<Data>196@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>196@21@1@53@@@@@2@2;6;30;43@@@@@@@@194@</Data>
</Node>
</Node>
<Node><Sub>196</Sub>
<Node><Sub>1</Sub>
<Data>197@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>197@21@1@53@@@@@2@2;6;30;43@@@@@@@@195@</Data>
</Node>
</Node>
<Node><Sub>197</Sub>
<Node><Sub>1</Sub>
<Data>198@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>198@21@1@53@@@@@2@2;6;30;43@@@@@@@@196@</Data>
</Node>
</Node>
<Node><Sub>198</Sub>
<Node><Sub>1</Sub>
<Data>199@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>199@21@1@53@@@@@2@2;6;30;43@@@@@@@@197@</Data>
</Node>
</Node>
<Node><Sub>199</Sub>
<Node><Sub>1</Sub>
<Data>200@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>200@21@1@53@@@@@2@2;6;30;43@@@@@@@@198@</Data>
</Node>
</Node>
<Node><Sub>200</Sub>
<Node><Sub>1</Sub>
<Data>201@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>201@21@1@53@@@@@2@2;6;30;43@@@@@@@@199@</Data>
</Node>
</Node>
<Node><Sub>201</Sub>
<Node><Sub>1</Sub>
<Data>202@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>202@21@1@53@@@@@2@2;6;30;43@@@@@@@@200@</Data>
</Node>
</Node>
<Node><Sub>202</Sub>
<Node><Sub>1</Sub>
<Data>203@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>203@21@1@53@@@@@2@2;6;30;43@@@@@@@@201@</Data>
</Node>
</Node>
<Node><Sub>203</Sub>
<Node><Sub>1</Sub>
<Data>204@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>204@21@1@53@@@@@2@2;6;30;43@@@@@@@@202@</Data>
</Node>
</Node>
<Node><Sub>204</Sub>
<Node><Sub>1</Sub>
<Data>205@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>205@21@1@53@@@@@2@2;6;30;43@@@@@@@@203@</Data>
</Node>
</Node>
<Node><Sub>205</Sub>
<Node><Sub>1</Sub>
<Data>206@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>206@21@1@53@@@@@2@2;6;30;43@@@@@@@@204@</Data>
</Node>
</Node>
<Node><Sub>206</Sub>
<Node><Sub>1</Sub>
<Data>207@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>207@21@1@53@@@@@2@2;6;30;43@@@@@@@@205@</Data>
</Node>
</Node>
<Node><Sub>207</Sub>
<Node><Sub>1</Sub>
<Data>208@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>208@21@1@53@@@@@2@2;6;30;43@@@@@@@@206@</Data>
</Node>
</Node>
<Node><Sub>208</Sub>
<Node><Sub>1</Sub>
<Data>209@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>209@21@1@53@@@@@2@2;6;30;43@@@@@@@@207@</Data>
</Node>
</Node>
<Node><Sub>209</Sub>
<Node><Sub>1</Sub>
<Data>210@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>210@21@1@53@@@@@2@2;6;30;43@@@@@@@@208@</Data>
</Node>
</Node>
<Node><Sub>210</Sub>
<Node><Sub>1</Sub>
<Data>211@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>211@21@1@53@@@@@2@2;6;30;43@@@@@@@@209@</Data>
</Node>
</Node>
<Node><Sub>211</Sub>
<Node><Sub>1</Sub>
<Data>212@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>212@21@1@53@@@@@2@2;6;30;43@@@@@@@@210@</Data>
</Node>
</Node>
<Node><Sub>212</Sub>
<Node><Sub>1</Sub>
<Data>213@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>213@21@1@53@@@@@2@2;6;30;43@@@@@@@@211@</Data>
</Node>
</Node>
<Node><Sub>213</Sub>
<Node><Sub>1</Sub>
<Data>214@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>214@21@1@53@@@@@2@2;6;30;43@@@@@@@@212@</Data>
</Node>
</Node>
<Node><Sub>214</Sub>
<Node><Sub>1</Sub>
<Data>215@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>215@21@1@53@@@@@2@2;6;30;43@@@@@@@@213@</Data>
</Node>
</Node>
<Node><Sub>215</Sub>
<Node><Sub>1</Sub>
<Data>216@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>216@21@1@53@@@@@2@2;6;30;43@@@@@@@@214@</Data>
</Node>
</Node>
<Node><Sub>216</Sub>
<Node><Sub>1</Sub>
<Data>217@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>217@21@1@53@@@@@2@2;6;30;43@@@@@@@@215@</Data>
</Node>
</Node>
<Node><Sub>217</Sub>
<Node><Sub>1</Sub>
<Data>218@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>218@21@1@53@@@@@2@2;6;30;43@@@@@@@@216@</Data>
</Node>
</Node>
<Node><Sub>218</Sub>
<Node><Sub>1</Sub>
<Data>219@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>219@21@1@53@@@@@2@2;6;30;43@@@@@@@@217@</Data>
</Node>
</Node>
<Node><Sub>219</Sub>
<Node><Sub>1</Sub>
<Data>220@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>220@21@1@53@@@@@2@2;6;30;43@@@@@@@@218@</Data>
</Node>
</Node>
<Node><Sub>220</Sub>
<Node><Sub>1</Sub>
<Data>221@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>221@21@1@53@@@@@2@2;6;30;43@@@@@@@@219@</Data>
</Node>
</Node>
<Node><Sub>221</Sub>
<Node><Sub>1</Sub>
<Data>222@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>222@21@1@53@@@@@2@2;6;30;43@@@@@@@@220@</Data>
</Node>
</Node>
<Node><Sub>222</Sub>
<Node><Sub>1</Sub>
<Data>223@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>223@21@1@53@@@@@2@2;6;30;43@@@@@@@@221@</Data>
</Node>
</Node>
<Node><Sub>223</Sub>
<Node><Sub>1</Sub>
<Data>224@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>224@21@1@53@@@@@2@2;6;30;43@@@@@@@@222@</Data>
</Node>
</Node>
<Node><Sub>224</Sub>
<Node><Sub>1</Sub>
<Data>225@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>225@21@1@53@@@@@2@2;6;30;43@@@@@@@@223@</Data>
</Node>
</Node>
<Node><Sub>225</Sub>
<Node><Sub>1</Sub>
<Data>226@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>226@21@1@53@@@@@2@2;6;30;43@@@@@@@@224@</Data>
</Node>
</Node>
<Node><Sub>226</Sub>
<Node><Sub>1</Sub>
<Data>227@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>227@21@1@53@@@@@2@2;6;30;43@@@@@@@@225@</Data>
</Node>
</Node>
<Node><Sub>227</Sub>
<Node><Sub>1</Sub>
<Data>228@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>228@21@1@53@@@@@2@2;6;30;43@@@@@@@@226@</Data>
</Node>
</Node>
<Node><Sub>228</Sub>
<Node><Sub>1</Sub>
<Data>229@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>229@21@1@53@@@@@2@2;6;30;43@@@@@@@@227@</Data>
</Node>
</Node>
<Node><Sub>229</Sub>
<Node><Sub>1</Sub>
<Data>230@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>230@21@1@53@@@@@2@2;6;30;43@@@@@@@@228@</Data>
</Node>
</Node>
<Node><Sub>230</Sub>
<Node><Sub>1</Sub>
<Data>231@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>231@21@1@53@@@@@2@2;6;30;43@@@@@@@@229@</Data>
</Node>
</Node>
<Node><Sub>231</Sub>
<Node><Sub>1</Sub>
<Data>232@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>232@21@1@53@@@@@2@2;6;30;43@@@@@@@@230@</Data>
</Node>
</Node>
<Node><Sub>232</Sub>
<Node><Sub>1</Sub>
<Data>233@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>233@21@1@53@@@@@2@2;6;30;43@@@@@@@@231@</Data>
</Node>
</Node>
<Node><Sub>233</Sub>
<Node><Sub>1</Sub>
<Data>234@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>234@21@1@53@@@@@2@2;6;30;43@@@@@@@@232@</Data>
</Node>
</Node>
<Node><Sub>234</Sub>
<Node><Sub>1</Sub>
<Data>235@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>235@21@1@53@@@@@2@2;6;30;43@@@@@@@@233@</Data>
</Node>
</Node>
<Node><Sub>235</Sub>
<Node><Sub>1</Sub>
<Data>236@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>236@21@1@53@@@@@2@2;6;30;43@@@@@@@@234@</Data>
</Node>
</Node>
<Node><Sub>236</Sub>
<Node><Sub>1</Sub>
<Data>237@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>237@21@1@53@@@@@2@2;6;30;43@@@@@@@@235@</Data>
</Node>
</Node>
<Node><Sub>237</Sub>
<Node><Sub>1</Sub>
<Data>238@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>238@21@1@53@@@@@2@2;6;30;43@@@@@@@@236@</Data>
</Node>
</Node>
<Node><Sub>238</Sub>
<Node><Sub>1</Sub>
<Data>239@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>239@21@1@53@@@@@2@2;6;30;43@@@@@@@@237@</Data>
</Node>
</Node>
<Node><Sub>239</Sub>
<Node><Sub>1</Sub>
<Data>240@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>240@21@1@53@@@@@2@2;6;30;43@@@@@@@@238@</Data>
</Node>
</Node>
<Node><Sub>240</Sub>
<Node><Sub>1</Sub>
<Data>241@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>241@21@1@53@@@@@2@2;6;30;43@@@@@@@@239@</Data>
</Node>
</Node>
<Node><Sub>241</Sub>
<Node><Sub>1</Sub>
<Data>242@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>242@21@1@53@@@@@2@2;6;30;43@@@@@@@@240@</Data>
</Node>
</Node>
<Node><Sub>242</Sub>
<Node><Sub>1</Sub>
<Data>243@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>243@21@1@53@@@@@2@2;6;30;43@@@@@@@@241@</Data>
</Node>
</Node>
<Node><Sub>243</Sub>
<Node><Sub>1</Sub>
<Data>244@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>244@21@1@53@@@@@2@2;6;30;43@@@@@@@@242@</Data>
</Node>
</Node>
<Node><Sub>244</Sub>
<Node><Sub>1</Sub>
<Data>245@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>245@21@1@53@@@@@2@2;6;30;43@@@@@@@@243@</Data>
</Node>
</Node>
<Node><Sub>245</Sub>
<Node><Sub>1</Sub>
<Data>246@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>246@21@1@53@@@@@2@2;6;30;43@@@@@@@@244@</Data>
</Node>
</Node>
<Node><Sub>246</Sub>
<Node><Sub>1</Sub>
<Data>247@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>247@21@1@53@@@@@2@2;6;30;43@@@@@@@@245@</Data>
</Node>
</Node>
<Node><Sub>247</Sub>
<Node><Sub>1</Sub>
<Data>248@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>248@21@1@53@@@@@2@2;6;30;43@@@@@@@@246@</Data>
</Node>
</Node>
<Node><Sub>248</Sub>
<Node><Sub>1</Sub>
<Data>249@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>249@21@1@53@@@@@2@2;6;30;43@@@@@@@@247@</Data>
</Node>
</Node>
<Node><Sub>249</Sub>
<Node><Sub>1</Sub>
<Data>250@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>250@21@1@53@@@@@2@2;6;30;43@@@@@@@@248@</Data>
</Node>
</Node>
<Node><Sub>250</Sub>
<Node><Sub>1</Sub>
<Data>251@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>251@21@1@53@@@@@2@2;6;30;43@@@@@@@@249@</Data>
</Node>
</Node>
<Node><Sub>251</Sub>
<Node><Sub>1</Sub>
<Data>252@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>252@21@1@53@@@@@2@2;6;30;43@@@@@@@@250@</Data>
</Node>
</Node>
<Node><Sub>252</Sub>
<Node><Sub>1</Sub>
<Data>253@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>253@21@1@53@@@@@2@2;6;30;43@@@@@@@@251@</Data>
</Node>
</Node>
<Node><Sub>253</Sub>
<Node><Sub>1</Sub>
<Data>254@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>254@21@1@53@@@@@2@2;6;30;43@@@@@@@@252@</Data>
</Node>
</Node>
<Node><Sub>254</Sub>
<Node><Sub>1</Sub>
<Data>255@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>255@21@1@53@@@@@2@2;6;30;43@@@@@@@@253@</Data>
</Node>
</Node>
<Node><Sub>255</Sub>
<Node><Sub>1</Sub>
<Data>256@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>256@21@1@53@@@@@2@2;6;30;43@@@@@@@@254@</Data>
</Node>
</Node>
<Node><Sub>256</Sub>
<Node><Sub>1</Sub>
<Data>257@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>257@21@1@53@@@@@2@2;6;30;43@@@@@@@@255@</Data>
</Node>
</Node>
<Node><Sub>257</Sub>
<Node><Sub>1</Sub>
<Data>258@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>258@21@1@53@@@@@2@2;6;30;43@@@@@@@@256@</Data>
</Node>
</Node>
<Node><Sub>258</Sub>
<Node><Sub>1</Sub>
<Data>259@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>259@21@1@53@@@@@2@2;6;30;43@@@@@@@@257@</Data>
</Node>
</Node>
<Node><Sub>259</Sub>
<Node><Sub>1</Sub>
<Data>260@1@1@20@@@@2,1@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>260@21@1@53@@@@@2@2;6;30;43@@@@@@@@258@</Data>
</Node>
</Node>
<Node><Sub>FTR</Sub>
<Node><Sub>1</Sub>
<Node><Sub>2</Sub>
<Data>S d1=&quot; ЗАПИСЬ № &quot;_$G(k1,&quot;?&quot;)</Data>
<Node><Sub>1</Sub>
<Data>&quot; ЗАПИСЬ № &quot;_$G(k1,&quot;?&quot;)</Data>
</Node>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>S d1=&quot;   Поле № &quot;_($G(ny)-1)</Data>
<Node><Sub>1</Sub>
<Data>&quot;   Поле № &quot;_($G(ny)-1)</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>Free</Sub>
<Data>59738,34297</Data>
</Node>
<Node><Sub>KEY</Sub>
<Data>^[&quot;%SYS&quot;,&quot;&quot;]BStempSQLtab</Data>
<Node><Sub>1</Sub>
<Data>49@@64@@НОВАЯ ЗАПИСЬ@1,70@@@ 1-Й ИНДЕКСНЫЙ@2;6;30;42@@@@@Введите #@@@@@</Data>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>59738,34297,MSW</Data>
</Node>
<Node><Sub>STA</Sub>
<Data>2,2@2@2@-2@-2@-2@3@21@</Data>
</Node>
</Node>
<Node><Sub>SafeCode</Sub>
<Data>ключевые слова, запрещенные в коде программы@@@@@1@1@1@1@22@80@1@@1@@@2@@2,2@1@@@@@1@@@2@2@@@@@@@@@@</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@2@20@@@@@1@2;6;35;42@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@21@2@53@@@@0@1@2;6;35;42@@@@@@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data><![CDATA[3@1@2@20@@@@@1@2;6;35;42@@@@@описание запрещенного синтаксиса@@описание ключевого слова@@@@@описание ключевого слова]]></Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@21@2@53@@@@@2@2;6;30;43@@@@@@@описание ключевого слова@Description@</Data>
</Node>
</Node>
<Node><Sub>B4I</Sub>
<Data>1</Data>
</Node>
<Node><Sub>Compile</Sub>
<Data>OK 12:56:56 2002-02-06</Data>
</Node>
<Node><Sub>DSN</Sub>
<Data>Создана B4I 2002-02-06</Data>
</Node>
<Node><Sub>Free</Sub>
<Data>58850,74811</Data>
</Node>
<Node><Sub>KEY</Sub>
<Data>^[&quot;%SYS&quot;]%BSC4SC</Data>
<Node><Sub>1</Sub>
<Data>@@@@НОВОЕ ЗНАЧЕНИЕ BSiD@1,70@@@1 ИНДЕКС@2;6;30;42@@@@@ВВЕДИТЕ НОВОЕ ЗНАЧЕНИЕ BSiD@@@@@</Data>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>58850,74811,MSW</Data>
</Node>
<Node><Sub>STA</Sub>
<Data>2,2@2@2@13@-1@-1@3@21@</Data>
</Node>
</Node>
<Node><Sub>TARIFF</Sub>
<Data>Тарифные планы@@@@@1@1@1@1@22@80@1@@1@@@2@@@1@@@@@1@@@11@2@@@@@@@@@@</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@2@30@@@@@1@2;6;35;42@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@31@2@43@@@@0@1@2;6;35;42@@@@@@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@30@@@@@1@2;6;31;42@@@@@         КОМЕНТАРИЙ</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@31@1@43@@@@@2@2;6;30;43@@@@@@@@R@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>4@1@1@30@@@@@1@2;6;31;42@@@@@  MAX mb (БД + ПРГ)@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>4@31@1@43@@@@@2@2;6;30;43@@@@@@@@M</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>5@1@1@30@@@@@1@2;6;31;42@@@@@      КОЛИЧЕСТВО БД@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>5@31@1@43@@@@@2@2;6;30;43@@@@@@@@BD@@</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>6@1@1@30@@@@@1@2;6;31;42@@@@@КОЛИЧЕСТВО ПРОГРАММ@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>6@31@1@43@@@@@2@2;6;30;43@@@@@@@@ROU</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>7@1@1@30@@@@@1@2;6;31;42@@@@@   ТРАФИК (В СУТКИ)@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>7@31@1@43@@@@@2@2;6;30;43@@@@@@@@TRF</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>8@1@1@30@@@@@1@2;6;31;42@@@@@ ВИЗУАЛЬНЫЙ КОНТРОЛЬ КОДА@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>8@31@1@43@@@@@2@2;6;30;43@@@@@@@@TIP</Data>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>1</Sub>
<Data>9@1@1@30@@@@@1@2;6;31;42@@@@@ ЦЕНА АРЕНДЫ ЗА МЕСЯЦ@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>9@31@1@43@@@@@2@2;6;30;43@@@@@@@@D</Data>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>1</Sub>
<Data>10@1@1@30@@@@@1@2;6;31;42@@@@@ СКИДКА % ЗА ПОЛГОДА@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>10@31@1@43@@@@@2@2;6;30;43@@@@@@@@PG</Data>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>1</Sub>
<Data>11@1@1@30@@@@@1@2;6;31;42@@@@@ СКИДКА % ЗА ГОД@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>11@31@1@43@@@@@2@2;6;30;43@@@@@@@@GOD</Data>
</Node>
</Node>
<Node><Sub>11</Sub>
<Node><Sub>1</Sub>
<Data>12@1@1@30@@@@@1@2;6;31;42@@@@@ ПРИМЕЧАНИЕ@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>12@31@1@43@@@@@2@2;6;30;43@@@@@@@@PRI</Data>
</Node>
</Node>
<Node><Sub>FTR</Sub>
<Node><Sub>1</Sub>
<Node><Sub>2</Sub>
<Data>S d1=&quot;  № &quot;_$G(k1,&quot;?&quot;)</Data>
<Node><Sub>1</Sub>
<Data>&quot;  № &quot;_$G(k1,&quot;?&quot;)</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>Free</Sub>
<Data>58847,78005</Data>
</Node>
<Node><Sub>KEY</Sub>
<Data>^[&quot;%SYS&quot;]%BSC4TAR</Data>
<Node><Sub>1</Sub>
<Data>0@@11@@НОВЫЙ ПЛАН@1,70@@@ 1-Й ИНДЕКСНЫЙ@2;6;33;44@@@@@Введите Код ТАРИФНОГО ПЛАНА@@@@@</Data>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>58847,78005,MSW</Data>
</Node>
<Node><Sub>STA</Sub>
<Data>1,1@1@1@27@-1@-1@1@1@</Data>
</Node>
</Node>
<Node><Sub>TIPS</Sub>
<Data>список возможных типов полей таблицы@@@@@1@1@1@1@22@80@1@@1@@@2@@2,2@1@@@@@1@@@3@2@@@@@@@@@@</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@2@20@@@@@1@2;6;35;42@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@21@2@53@@@@0@1@2;6;35;42@@@@@@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>3@1@2@20@@@@@1@2;6;35;42@@@@@имя типа данных@@имя типа данных@@@@@имя типа данных</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@21@2@53@@@@@2@2;6;30;43@@@@@@@имя типа данных@Name@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data><![CDATA[5@1@3@20@@@@@1@2;6;35;42@@@@@текст подставляемый по-умочанию в тег@@текст подставляемый по-умочанию@@@@@текст подставляемый по-умочанию]]></Data>
</Node>
<Node><Sub>2</Sub>
<Data>5@21@3@53@@@@@2@2;6;34;43@@@@@@@текст подставляемый по-умочанию@Defaulte@@@1</Data>
</Node>
</Node>
<Node><Sub>B4I</Sub>
<Data>1</Data>
</Node>
<Node><Sub>Compile</Sub>
<Data>OK 15:31:38 2002-02-06</Data>
</Node>
<Node><Sub>DSN</Sub>
<Data>Создана B4I 2002-02-06</Data>
</Node>
<Node><Sub>Free</Sub>
<Data>59078,57539</Data>
</Node>
<Node><Sub>KEY</Sub>
<Data>^[&quot;%SYS&quot;]%BSC4TIP</Data>
<Node><Sub>1</Sub>
<Data>@@@@НОВОЕ ЗНАЧЕНИЕ BSiD@1,70@@@1 ИНДЕКС@2;6;30;42@@@@@ВВЕДИТЕ НОВОЕ ЗНАЧЕНИЕ BSiD@@@@@</Data>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>59078,57539,MSW</Data>
</Node>
<Node><Sub>STA</Sub>
<Data>2,2@2@2@27@-1@-1@3@21@</Data>
</Node>
</Node>
<Node><Sub>TXTBIGLITL</Sub>
<Data><![CDATA[описание атрибутов БД GRAND@@@@@@@7@10@19@70@@@@1@@5@@@1@@@ 1@@@@@4@@@2;6;37;44//2;6;33;40/2;6;37;44/2;6;37;44@@@@@@@1]]></Data>
<Node><Sub>1</Sub>
<Data></Data>
</Node>
<Node><Sub>2</Sub>
<Data>TXTBIG - это текст, который заменит текст в левом верхнем углу</Data>
</Node>
<Node><Sub>3</Sub>
<Data>TXTLITL - аналогично</Data>
</Node>
<Node><Sub>4</Sub>
<Data></Data>
</Node>
</Node>
<Node><Sub>ixsso</Sub>
<Data>КАТАЛОГ СЛУЖБЫ ИНДЕКСИРОВАНИЯ (Cache&apos;5)@@@@@1@1@1@1@22@80@1@@1@@@2@@@1@@@@@1@@@4@2@@@@@@@@@@</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@2@20@@@@@1@2;6;30;42@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@21@2@53@@@@0@1@2;6;30;42@@@@@@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>3@1@2@20@@@@@1@2;6;30;42@@@@@      КОМЕНТАРИЙ</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@21@2@53@@@@@2@2;6;30;43@@@@@@@@REM@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>5@1@2@20@@@@@1@2;6;30;42@@@@@ ПРЕФИКС ПУТИ@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>5@21@2@53@@@@@2@2;6;30;43@@@@@@@@DIR</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>7@1@2@20@@@@@1@2;6;30;42@@@@@ ПРЕФИКС ВЕБ-УЗЛА@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>7@21@2@53@@@@@2@2;6;30;43@@@@@@@@VIR@@</Data>
</Node>
</Node>
<Node><Sub>FTR</Sub>
<Node><Sub>1</Sub>
<Node><Sub>2</Sub>
<Data>S d1=&quot; КАТАЛОГ &quot;_$G(k1,&quot;?&quot;)</Data>
<Node><Sub>1</Sub>
<Data>&quot; КАТАЛОГ &quot;_$G(k1,&quot;?&quot;)</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>Free</Sub>
<Data>59393,32017</Data>
</Node>
<Node><Sub>KEY</Sub>
<Data>^[&quot;%SYS&quot;,&quot;&quot;]%BScindx.KATALOG</Data>
<Node><Sub>1</Sub>
<Data>49@@64@@НОВЫЙ КАТАЛОГ@1,70@@@ 1-Й ИНДЕКСНЫЙ@2;6;30;42@@@@@Введите КАТАЛОГ@@@@@</Data>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>59393,32017,MSW</Data>
</Node>
<Node><Sub>STA</Sub>
<Data>1,1@1@1@27@-1@-1@1@1@</Data>
</Node>
</Node>
</Node>
</Global>


<Global>
<Node><Sub>^%ZAPM.ed.BSC4E</Sub>
<Data>BaSe MsW @ТИПОВЫЕ БАЗЫ ДАННЫХ@@</Data>
<Node><Sub>COUNT</Sub>
<Data>cтатистический счетчик@@@@@1@1@1@1@22@80@1@@1@@@2@@@1@@@@@1@@@7@2@@@@@@@@@@</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@2@20@@@@@1@2;6;35;42@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@21@2@53@@@@0@1@2;6;35;42@@@@@@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>3@1@2@20@@@@@1@2;6;35;42@@@@@идентификатор сайта</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@21@2@53@@@@@2@1;6;33;43@@@@@1@@@IDsite@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>5@1@2@20@@@@@1@2;6;35;42@@@@@IP@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>5@21@2@53@@@@@2@1;6;33;43@@@@@2@@@ip</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>7@1@2@20@@@@@1@2;6;35;42@@@@@счетчик@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>7@21@2@53@@@@@2@1;6;33;43@@@@@3@@@count@@</Data>
</Node>
</Node>
<Node><Sub>DSN</Sub>
<Data>Создана B4I 2002-01-23</Data>
</Node>
<Node><Sub>Free</Sub>
<Data>58847,80148</Data>
</Node>
<Node><Sub>KEY</Sub>
<Data>^[&quot;%SYS&quot;]uCOUNT</Data>
<Node><Sub>1</Sub>
<Data>@@@@НОВОЕ ЗНАЧЕНИЕ сайта@1,70@@@1 ИНДЕКС@2;6;30;42@@@@@ВВЕДИТЕ НОВОЕ ЗНАЧЕНИЕ сайта@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>@@@@НОВОЕ ЗНАЧЕНИЕ @1,70@@@2 ИНДЕКС@2;6;30;42@@@@@ВВЕДИТЕ НОВОЕ ЗНАЧЕНИЕ @@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>@@@@НОВОЕ ЗНАЧЕНИЕ @1,70@@@3 ИНДЕКС@2;6;30;42@@@@@ВВЕДИТЕ НОВОЕ ЗНАЧЕНИЕ @@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>@@@@НОВОЕ ЗНАЧЕНИЕ BSiD@1,70@@@4 ИНДЕКС@2;6;30;42@@@@@ВВЕДИТЕ НОВОЕ ЗНАЧЕНИЕ BSiD@@@@@</Data>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>58847,80148,MSW</Data>
</Node>
<Node><Sub>STA</Sub>
<Data>1,1@1@1@13@-1@-1@1@1@</Data>
</Node>
</Node>
<Node><Sub>CSS</Sub>
<Data>HELP:таблица каскадных стилей@@@@@1@1@1@1@22@80@1@@1@@@2@@@1@@@@@1@@@2@2@@@@@@@@@@</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@2@20@@@@@1@2;6;35;42@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@21@2@53@@@@0@1@2;6;35;42@@@@@@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>3@1@2@20@@@@@1@2;6;35;42@@@@@описание стиля</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@21@2@53@@@@@2@2;6;30;43@@@@@@@описание стиля@Styles@@@1</Data>
</Node>
</Node>
<Node><Sub>B4I</Sub>
<Data>1</Data>
</Node>
<Node><Sub>Compile</Sub>
<Data>OK 12:04:03 2002-04-01</Data>
</Node>
<Node><Sub>DSN</Sub>
<Data>Создана B4I 2002-04-01</Data>
</Node>
<Node><Sub>Free</Sub>
<Data>58896,57818</Data>
</Node>
<Node><Sub>KEY</Sub>
<Data>^[&quot;%SYS&quot;]%BSC4CSS</Data>
<Node><Sub>1</Sub>
<Data>@@@@НОВОЕ ЗНАЧЕНИЕ BSiD@1,70@@@1 ИНДЕКС@2;6;30;42@@@@@ВВЕДИТЕ НОВОЕ ЗНАЧЕНИЕ BSiD@@@@@</Data>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>58896,57818,MSW</Data>
</Node>
<Node><Sub>STA</Sub>
<Data>1,1@1@1@27@-1@-1@1@1@</Data>
</Node>
</Node>
<Node><Sub>CfgPar</Sub>
<Data>Опции Конфигуратора параметров@@@@@1@1@1@1@22@80@1@@1@1@@1@@2,1@1@@@@@@@@3@5@@1;6;35;44@@@@@@</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@13@@@@@1@2;6;35;40@@@@@ Value (DFLT)</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@14@1@10@@@@@1@2;6;30;41@@@@@ Type@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>1@24@1@10@@@@@1@2;6;30;41@@@@@Atribute@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>1@34@1@35@@@@@1@2;6;33;40@@@@@ ОПИСАНИЕ@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>1@69@1@9@@@@@1@2;6;30;41@@@@@ name@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@13@@@@@1@2;6;35;40@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>2@14@1@10@@@@@1@2;6;30;41@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>2@24@1@10@@@@@1@2;6;30;41@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>2@34@1@35@@@@@1@2;6;33;40@@@@@ Опции Конфигуратора параметров@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>2@69@1@9@@@@@1@2;6;30;41@@@@@@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@13@@@@@1@2;6;35;40@@@@@1</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>3@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>3@34@1@35@@@@@1@2;6;33;40@@@@@сортировка по возрастанию имен@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>3@69@1@9@@@@@1@2;6;32;40@@@@@Sort1@</Data>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>58823,63629,MSW</Data>
</Node>
<Node><Sub>OPT</Sub>
<Data>1</Data>
</Node>
<Node><Sub>STA</Sub>
<Data>3,5@2@1@13@-1@-1@3@69@Sort1</Data>
</Node>
</Node>
<Node><Sub>CfgPro</Sub>
<Data>Опции Конфигуратора проектов@@1@@@1@1@1@1@22@80@1@@1@1@@1@@2,1@1@@@@@@@@4@5@@1;6;35;44@@@@@@</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@13@@@@@1@2;6;35;40@@@@@ Value (DFLT)</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@14@1@10@@@@@1@2;6;30;41@@@@@ Type@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>1@24@1@10@@@@@1@2;6;30;41@@@@@Atribute@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>1@34@1@35@@@@@1@2;6;33;40@@@@@ ОПИСАНИЕ@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>1@69@1@9@@@@@1@2;6;30;41@@@@@ name@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@13@@@@@1@2;6;35;40@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>2@14@1@10@@@@@1@2;6;30;41@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>2@24@1@10@@@@@1@2;6;30;41@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>2@34@1@35@@@@@1@2;6;33;40@@@@@ Опции Конфигуратора проектов@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>2@69@1@9@@@@@1@2;6;30;41@@@@@@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@13@@@@@1@2;6;35;40@@@@@1</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>3@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>3@34@1@35@@@@@1@2;6;33;40@@@@@сортировка по возрастанию имен@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>3@69@1@9@@@@@1@2;6;32;40@@@@@Sort1@</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>4@1@1@13@@@@@1@2;6;35;40@@1@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>4@14@1@10@@@@@1@2;6;32;40@@1@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>4@24@1@10@@@@@1@2;6;32;40@@1@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>4@34@1@35@@@@@1@2;6;33;40@@1@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>4@69@1@9@@@@@1@2;6;32;40@@1@@@@</Data>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>58831,63268,MSW</Data>
</Node>
<Node><Sub>OPT</Sub>
<Data>1</Data>
</Node>
<Node><Sub>STA</Sub>
<Data>3,3@2@1@13@-1@-1@3@24@</Data>
</Node>
</Node>
<Node><Sub>CfgRou</Sub>
<Data>Опции Конфигуратора программ@@@@@1@1@1@1@22@80@1@@1@1@@1@@2,1@1@@@@@@@@4@5@@1;6;35;44@@@@@@</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@13@@@@@1@2;6;35;40@@@@@ Value (DFLT)</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@14@1@10@@@@@1@2;6;30;41@@@@@ Type@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>1@24@1@10@@@@@1@2;6;30;41@@@@@Atribute@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>1@34@1@35@@@@@1@2;6;33;40@@@@@ ОПИСАНИЕ@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>1@69@1@9@@@@@1@2;6;30;41@@@@@ name@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@13@@@@@1@2;6;35;40@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>2@14@1@10@@@@@1@2;6;30;41@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>2@24@1@10@@@@@1@2;6;30;41@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>2@34@1@35@@@@@1@2;6;33;40@@@@@ Опции Конфигуратора программ@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>2@69@1@9@@@@@1@2;6;30;41@@@@@@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@13@@@@@1@2;6;35;40@@@@@1</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>3@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>3@34@1@35@@@@@1@2;6;33;40@@@@@сортировка по возрастанию имен@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>3@69@1@9@@@@@1@2;6;32;40@@@@@Sort1@</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>4@1@1@13@@@@@1@2;6;35;40@@1@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>4@14@1@10@@@@@1@2;6;32;40@@1@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>4@24@1@10@@@@@1@2;6;32;40@@1@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>4@34@1@35@@@@@1@2;6;33;40@@1@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>4@69@1@9@@@@@1@2;6;32;40@@1@@@@</Data>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>58831,63325,MSW</Data>
</Node>
<Node><Sub>OPT</Sub>
<Data>1</Data>
</Node>
<Node><Sub>STA</Sub>
<Data>4,1@2@1@13@-1@-1@4@1@</Data>
</Node>
</Node>
<Node><Sub>CfgTab</Sub>
<Data>Опции Конфигуратора таблиц@@@@@1@1@1@1@22@80@1@@1@1@@1@@2,1@1@@@@@@@@4@5@@1;6;35;44@@@@@@</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@13@@@@@1@2;6;35;40@@@@@ Value (DFLT)</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@14@1@10@@@@@1@2;6;30;41@@@@@ Type@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>1@24@1@10@@@@@1@2;6;30;41@@@@@Atribute@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>1@34@1@35@@@@@1@2;6;33;40@@@@@ ОПИСАНИЕ@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>1@69@1@9@@@@@1@2;6;30;41@@@@@ name@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@13@@@@@1@2;6;35;40@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>2@14@1@10@@@@@1@2;6;30;41@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>2@24@1@10@@@@@1@2;6;30;41@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>2@34@1@35@@@@@1@2;6;33;40@@@@@ Опции Конфигуратора таблиц@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>2@69@1@9@@@@@1@2;6;30;41@@@@@@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@13@@@@@1@2;6;35;40@@@@@1</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>3@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>3@34@1@35@@@@@1@2;6;33;40@@@@@сортировка по возрастанию имен@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>3@69@1@9@@@@@1@2;6;32;40@@@@@Sort1@</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>4@1@1@13@@@@@1@2;6;35;40@@1@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>4@14@1@10@@@@@1@2;6;32;40@@1@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>4@24@1@10@@@@@1@2;6;32;40@@1@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>4@34@1@35@@@@@1@2;6;33;40@@1@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>4@69@1@9@@@@@1@2;6;32;40@@1@@@@</Data>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>58831,63360,MSW</Data>
</Node>
<Node><Sub>OPT</Sub>
<Data>1</Data>
</Node>
<Node><Sub>STA</Sub>
<Data>4,5@2@1@13@-1@-1@4@69@</Data>
</Node>
</Node>
<Node><Sub>Content</Sub>
<Data>HELP:Содержание документации@@@@@1@1@1@1@22@80@1@@1@@@2@@@1@@@@@1@@@6@2@@@@@@@@@@</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@2@20@@@@@1@2;6;35;42@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@21@2@53@@@@0@1@2;6;35;42@@@@@@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>3@1@2@20@@@@@1@2;6;35;42@@@@@краткое описание пункта меню</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@21@2@53@@@@@2@2;6;30;43@@@@@@@краткое описание пункта меню@Descr@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>5@1@1@20@@@@@1@2;6;35;42@@@@@ссылка на ^[^[&quot;%SYS&quot;]]]]]]]]]PART(TABLE):ot:do:&lt;pre&gt;</Data>
</Node>
<Node><Sub>2</Sub>
<Data>5@21@1@53@@@@@2@2;6;34;43@@@@@@@ссылка на ^[^[&quot;%SYS&quot;]]]]]]]]]PART(TABLE):ot:do:&lt;pre&gt;@Refer@</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>6@1@1@20@@@@@1@2;6;35;42@@@@@подробное описание пункта меню</Data>
</Node>
<Node><Sub>2</Sub>
<Data>6@21@1@53@@@@@2@2;6;34;43@@@@@@@подробное описание пункта меню@FDescr@</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>7@1@1@20@@@@@1@2;6;35;42@@@@@сам HTML-текст</Data>
</Node>
<Node><Sub>2</Sub>
<Data>7@21@1@53@@@@@2@2;6;34;43@@@@@@@сам HTML-текст@Html@@@1</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>8@1@1@20@@@@@1@2;6;35;42@@@@@Ключевые слова через ;</Data>
</Node>
<Node><Sub>2</Sub>
<Data>8@21@1@53@@@@@2@2;6;34;43@@@@@@@Ключевые слова через ;@KeyWords@</Data>
</Node>
</Node>
<Node><Sub>B4I</Sub>
<Data>1</Data>
</Node>
<Node><Sub>Compile</Sub>
<Data>OK 12:19:39 2002-04-01</Data>
</Node>
<Node><Sub>DSN</Sub>
<Data>Создана B4I 2002-04-01</Data>
</Node>
<Node><Sub>Free</Sub>
<Data>58847,80178</Data>
</Node>
<Node><Sub>KEY</Sub>
<Data>^RBB.NewProj2.Content</Data>
<Node><Sub>1</Sub>
<Data>@@@@НОВОЕ ЗНАЧЕНИЕ BSiD@1,70@@@1 ИНДЕКС@2;6;30;42@@@@@ВВЕДИТЕ НОВОЕ ЗНАЧЕНИЕ BSiD@@@@@@0@BSiD</Data>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>58847,80178,MSW</Data>
</Node>
<Node><Sub>STA</Sub>
<Data>6,2@1@1@27@-1@-1@8@21@</Data>
</Node>
</Node>
<Node><Sub>EMPTY</Sub>
<Data>взять за основу пустую@@@@@1@1@1@1@22@80@1@@1@@@2@@@1@@@@@1@@@2@2@@@@@@@@@@</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@2@20@@@@@1@2;6;35;42@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@21@2@53@@@@0@1@2;6;35;42@@@@@@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>3@1@2@20@@@@@1@2;6;35;42@@@@@описание поля</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@21@2@53@@@@@2@2;6;30;43@@@@@@@@F1@</Data>
</Node>
</Node>
<Node><Sub>Compile</Sub>
<Data>OK 15:41:22 2002-01-27</Data>
</Node>
<Node><Sub>DSN</Sub>
<Data>Создана B4I 2002-01-27</Data>
</Node>
<Node><Sub>Free</Sub>
<Data>58927,53749</Data>
</Node>
<Node><Sub>KEY</Sub>
<Data>^[&quot;%SYS&quot;]uEMPTY</Data>
<Node><Sub>1</Sub>
<Data>@@@@НОВОЕ ЗНАЧЕНИЕ BSiD@1,70@@@1 ИНДЕКС@2;6;30;42@@@@@ВВЕДИТЕ НОВОЕ ЗНАЧЕНИЕ BSiD@@@@@</Data>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>58927,53749,MSW</Data>
</Node>
<Node><Sub>STA</Sub>
<Data>2,2@1@1@13@-1@-1@3@21@</Data>
</Node>
</Node>
<Node><Sub>GUESTBOOK</Sub>
<Data>гостевая книга@@@@@1@1@1@1@22@80@1@@1@@@2@@@1@@@@@1@@@7@2@@@@@@@@@@</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@2@20@@@@@1@2;6;35;42@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@21@2@53@@@@0@1@2;6;35;42@@@@@@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>3@1@2@20@@@@@1@2;6;35;42@@@@@идентификатор сайта</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@21@2@53@@@@@2@1;6;33;43@@@@@@@@NAME@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>5@1@2@20@@@@@1@2;6;35;42@@@@@IP@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>5@21@2@53@@@@@2@1;6;33;43@@@@@@@@EMAIL</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>7@1@2@20@@@@@1@2;6;35;42@@@@@счетчик@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>7@21@2@53@@@@@2@1;6;33;43@@@@@@@@PHONE@@</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>3@1@2@20@@@@@1@2;6;35;42@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@21@2@53@@@@@2@1;6;33;43@@@@@@@@TEXT@</Data>
</Node>
</Node>
<Node><Sub>DSN</Sub>
<Data>Создана B4I 2002-01-23</Data>
</Node>
<Node><Sub>Free</Sub>
<Data>58847,80206</Data>
</Node>
<Node><Sub>KEY</Sub>
<Data>^[&quot;%SYS&quot;]uGUESTBOOK</Data>
<Node><Sub>1</Sub>
<Data>@@@@НОВОЕ ЗНАЧЕНИЕ BSiD@1,70@@@1 ИНДЕКС@2;6;30;42@@@@@ВВЕДИТЕ НОВОЕ ЗНАЧЕНИЕ BSiD@@@@@</Data>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>58847,80206,MSW</Data>
</Node>
<Node><Sub>STA</Sub>
<Data>1,1@1@1@13@-1@-1@1@1@</Data>
</Node>
</Node>
<Node><Sub>PRO</Sub>
<Data>проекты@@@@@1@1@1@1@22@80@1@@1@@@2@@@1@@@@@1@@@2@2@@@@@@@@@@</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@2@20@@@@@1@2;6;35;42@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@21@2@53@@@@0@1@2;6;35;42@@@@@@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>3@1@2@20@@@@@1@2;6;35;42@@@@@     ОПИСАНИЕ</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@21@2@53@@@@@2@2;6;30;43@@@@@@@@REM@</Data>
</Node>
</Node>
<Node><Sub>FTR</Sub>
<Node><Sub>1</Sub>
<Node><Sub>2</Sub>
<Data>S d1=&quot; ИМЯ ПРОЕКТА: &quot;_$G(k1,&quot;?&quot;)</Data>
<Node><Sub>1</Sub>
<Data>&quot; ИМЯ ПРОЕКТА: &quot;_$G(k1,&quot;?&quot;)</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>Free</Sub>
<Data>58847,82418</Data>
</Node>
<Node><Sub>KEY</Sub>
<Data>^[&quot;%SYS&quot;]%BSC4PRO</Data>
<Node><Sub>1</Sub>
<Data>49@@64@@НОВЫЙ ПАРАМЕТР@1,70@@@ 1-Й ИНДЕКСНЫЙ@2;6;30;42@@@@@Введите ИМЯ ПАРАМЕТРА@@@@@</Data>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>58847,82418,MSW</Data>
</Node>
<Node><Sub>STA</Sub>
<Data>1,1@1@1@27@-1@-1@1@1@</Data>
</Node>
</Node>
<Node><Sub>ROU</Sub>
<Data>программы@@@@@1@1@1@1@22@80@1@@1@@@2@@@1@@@@@1@@@8@2@@@@@@@@@@</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@2@20@@@@@1@2;6;35;42@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@21@2@53@@@@0@1@2;6;35;42@@@@@@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@20@@@@@1@2;6;35;42@@@@@      КОМЕНТАРИЙ</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@21@1@53@@@@@2@2;6;34;43@@@@@@@@REM@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>4@1@3@20@@@@@1@2;6;35;42@@@@@ КЛИЕНТСКИЙ МОДУЛЬ   DHTML,JavaScript@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>4@21@3@53@@@@@2@2;6;34;43@@@@@@@@HTM@</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>7@1@1@20@@@@@1@2;6;35;42@@@@@      ПРОГРАММА@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>7@21@1@53@@@@@2@2;6;34;43@@@@@@@@ROU</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>8@1@1@20@@@@@1@2;6;35;42@@@@@      СТАТУС@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>8@21@1@53@@@@@2@2;6;34;43@@@@@@@@STA</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>9@1@1@20@@@@@1@2;6;35;42@@@@@       ФЛАГ@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>9@21@1@53@@@@@2@2;6;34;43@@@@@@@@FLG</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>10@1@3@20@@@@@1@2;6;35;42@@@@@                     СЕРВЕРНЫЙ МОДУЛЬ     SQL, COS@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>10@21@3@53@@@@@2@2;6;34;43@@@@@@@@COS@@</Data>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>1</Sub>
<Data>13@1@1@20@@@@@1@2;6;35;42@@@@@    ReMastering@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>13@21@1@53@@@@@2@2;6;34;43@@@@@@@@MST@@</Data>
</Node>
</Node>
<Node><Sub>FTR</Sub>
<Node><Sub>1</Sub>
<Node><Sub>2</Sub>
<Data>S d1=&quot; ID ПРОГРАММНОГО МОДУЛЯ: &quot;_$G(k1,&quot;?&quot;)</Data>
<Node><Sub>1</Sub>
<Data>&quot; ID ПРОГРАММНОГО МОДУЛЯ: &quot;_$G(k1,&quot;?&quot;)</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>Free</Sub>
<Data>58863,56770</Data>
</Node>
<Node><Sub>KEY</Sub>
<Data>^[&quot;%SYS&quot;]%BSC4ROU</Data>
<Node><Sub>1</Sub>
<Data>49@@64@@НОВЫЙ МОДУЛЬ@1,70@@@ 1-Й ИНДЕКСНЫЙ@2;6;30;42@@@@@Введите Код МОДУЛЯ@@@@@</Data>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>58863,56770,MSW</Data>
</Node>
<Node><Sub>STA</Sub>
<Data>2,2@1@1@13@-1@-1@3@21@</Data>
</Node>
</Node>
<Node><Sub>Tree</Sub>
<Data>HELP:дерево меню@@@@@1@1@1@1@22@80@1@@1@@@2@@@1@@@@@1@@@4@2@@@@@@@@@@</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@2@20@@@@@1@2;6;35;42@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@21@2@53@@@@0@1@2;6;35;42@@@@@@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>3@1@2@20@@@@@1@2;6;35;42@@@@@первый уровень</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@21@2@53@@@@@1@2;6;30;43@@@@@1@@первый уровень@U1@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>5@1@1@20@@@@@1@2;6;35;42@@@@@второй уровень</Data>
</Node>
<Node><Sub>2</Sub>
<Data>5@21@1@53@@@@@1@2;6;34;43@@@@@2@@второй уровень@U2@</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>6@1@1@20@@@@@1@2;6;35;42@@@@@описание </Data>
</Node>
<Node><Sub>2</Sub>
<Data>6@21@1@53@@@@@2@2;6;34;43@@@@@@@описание @zero@</Data>
</Node>
</Node>
<Node><Sub>B4I</Sub>
<Data>1</Data>
</Node>
<Node><Sub>Compile</Sub>
<Data>OK 15:48:45 2002-03-31</Data>
</Node>
<Node><Sub>DSN</Sub>
<Data>Создана B4I 2002-03-31</Data>
</Node>
<Node><Sub>Free</Sub>
<Data>58847,80178</Data>
</Node>
<Node><Sub>KEY</Sub>
<Data>^BSC4.Doc.Tree</Data>
<Node><Sub>1</Sub>
<Data><![CDATA[@@@@НОВОЕ ЗНАЧЕНИЕ первый уровень@1,70@@@1 ИНДЕКС@2;6;30;42@@@@@ВВЕДИТЕ НОВОЕ ЗНАЧЕНИЕ первый уровень@@первый уровень@@@@@U1]]></Data>
</Node>
<Node><Sub>2</Sub>
<Data><![CDATA[@@@@НОВОЕ ЗНАЧЕНИЕ второй уровень@1,70@@@2 ИНДЕКС@2;6;30;42@@@@@ВВЕДИТЕ НОВОЕ ЗНАЧЕНИЕ второй уровень@@второй уровень@@@@@U2]]></Data>
</Node>
<Node><Sub>3</Sub>
<Data>@@@@НОВОЕ ЗНАЧЕНИЕ BSiD@1,70@@@3 ИНДЕКС@2;6;30;42@@@@@ВВЕДИТЕ НОВОЕ ЗНАЧЕНИЕ BSiD@@@@@@0@BSiD</Data>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>58847,80178,MSW</Data>
</Node>
<Node><Sub>STA</Sub>
<Data>1,1@1@1@27@-1@-1@1@1@</Data>
</Node>
</Node>
</Node>
</Global>


<Global>
<Node><Sub>^%ZAPM.ed.BSCDFLT</Sub>
<Data>BaSe MsW @РАЗДЕЛ ПАРАМЕТРОВ ОБЪЕКТОВ ПО-УМОЛЧАНИЮ ДЛЯ (САСНЕ&apos; OBJECT)@@</Data>
<Node><Sub>@HTML</Sub>
<Data>ПАРАМЕТРЫ СТРАНИЦЫ HTML (по-умолчанию)@@@@@1@1@1@1@22@80@1@@1@1@@1@@@1@@@@@@@@18@2@@1;6;35;44@@@@@@</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@40@@@@@1@2;6;33;45@@@@@     НАИМЕНОВАНИЯ ПАРАМЕТРОВ</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@41@1@35@@@@@1@2;6;33;45@@@@@ ЗНАЧЕНИЯ@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@40@@@@@1@2;6;34;46@@@@@НАЧАЛО СТРОКИ ТИТУЛА СТРАНИЦЫ</Data>
</Node>
<Node><Sub>2</Sub>
<Data>2@41@1@35@@@@@1@2;6;37;44@@@@@%BS + Cache - WebLink@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@40@@@@@1@2;6;34;46@@@@@ПАРАМЕТРЫ ТЕГА &quot;&lt;BODY &quot;_@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@41@1@35@@@@@1@2;6;37;44@@@@@BGCOLOR=#ffffcc@</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>4@1@1@40@@@@@1@2;6;34;46@@@@@ТЕКСТ ЗАГОЛОВКА СТРАНИЦЫ ПО-УМОЛЧАНИЮ@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>4@41@1@35@@@@@1@2;6;37;44@@@@@&lt;H6&gt;Информационно - Справочная Система&lt;/H6&gt;@</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>5@1@1@40@@@@@1@2;6;34;46@@@@@ЗАГЛАВНАЯ КАРТИНКА СТРАНИЦЫ  &quot;&lt;IMG &quot;_@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>5@41@1@35@@@@@1@2;6;37;44@@@@@SRC=&quot;/scripts/mgwms32.dll?MGWSYSimg=cache_jpg&quot; ALT=&quot;Cache@</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>6@1@1@40@@@@@1@2;6;34;46@@@@@ЦВЕТ ФОНА ШАПКИ ТАБЛИЦЫ @</Data>
</Node>
<Node><Sub>2</Sub>
<Data>6@41@1@35@@@@@1@2;6;37;44@@@@@BGCOLOR=&quot;#800080&quot;@</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>7@1@1@40@@@@@1@2;6;34;46@@@@@ТЕКСТ ЗАВЕРШЕНИЯ СТРАНИЦЫ ПО-УМОЛЧАНИЮ@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>7@41@1@35@@@@@1@2;6;37;44@@@@@&lt;H6&gt;(С) 2001 Михайленко С.В. тел. 7 (095) 361-8735&lt;/H6&gt;@</Data>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>1</Sub>
<Data>8@1@1@40@@@@@1@2;6;34;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>8@41@1@35@@@@@1@2;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>1</Sub>
<Data>9@1@1@40@@@@@1@2;6;34;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>9@41@1@35@@@@@1@2;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>1</Sub>
<Data>10@1@1@40@@@@@1@2;6;34;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>10@41@1@35@@@@@1@2;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>11</Sub>
<Node><Sub>1</Sub>
<Data>11@1@1@40@@@@@1@2;6;34;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>11@41@1@35@@@@@1@2;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>12</Sub>
<Node><Sub>1</Sub>
<Data>12@1@1@40@@@@@1@2;6;34;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>12@41@1@35@@@@@1@2;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>13</Sub>
<Node><Sub>1</Sub>
<Data>13@1@1@40@@@@@1@2;6;34;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>13@41@1@35@@@@@1@2;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>14</Sub>
<Node><Sub>1</Sub>
<Data>14@1@1@40@@@@@1@2;6;34;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>14@41@1@35@@@@@1@2;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>15</Sub>
<Node><Sub>1</Sub>
<Data>15@1@1@40@@@@@1@2;6;34;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>15@41@1@35@@@@@1@2;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>16</Sub>
<Node><Sub>1</Sub>
<Data>16@1@1@40@@@@@1@2;6;34;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>16@41@1@35@@@@@1@2;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>17</Sub>
<Node><Sub>1</Sub>
<Data>17@1@1@40@@@@@1@2;6;34;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>17@41@1@35@@@@@1@2;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>18</Sub>
<Node><Sub>1</Sub>
<Data>18@1@1@40@@@@@1@2;6;34;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>18@41@1@35@@@@@1@2;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>HTML</Sub>
<Node><Sub>CFG</Sub>
<Data>1,0,0,9,9,9,,0,1,1</Data>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>58083,58966,MS</Data>
</Node>
<Node><Sub>OPT</Sub>
<Data>1,2,2</Data>
</Node>
<Node><Sub>STA</Sub>
<Data>1,2@1@1@13@-1@-1@1@41@ ЗНАЧЕНИЯ</Data>
</Node>
</Node>
<Node><Sub>BigEdit</Sub>
<Data><![CDATA[Редактор в окне с рамкой@@@@@@@20@1@22@80@@1@@1@@5@@@@@@@@@@@1@510@@2;6;36;40///1;6;37;40/1;6;37;40//////32@@@@@@@1]]></Data>
<Node><Sub>1</Sub>
<Data></Data>
</Node>
</Node>
<Node><Sub>CharAcc</Sub>
<Data>@@1@@@1@1@1@1@22@80@1@@1@1@@8@@@1@@@@@@@@4@6@@2;6;30;45@@@@@@@@^%ZAPM.ed.BSHLP(&quot;HELP-ALTF2&quot;)</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@10@@@@@1@@@@@@              Выберите Право доступа@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@11@1@10@@@@@1@1;6;37;45@@@@@ NONE @</Data>
</Node>
<Node><Sub>3</Sub>
<Data>1@21@1@10@@@@@1@@@@@@1@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>1@31@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>1@41@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>6</Sub>
<Data>1@51@1@10@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@10@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>2@11@1@10@@@@@1@2;6;30;41@@@@@ READ ONLY @</Data>
</Node>
<Node><Sub>3</Sub>
<Data>2@21@1@10@@@@@1@@@@@@2@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>2@31@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>2@41@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>6</Sub>
<Data>2@51@1@10@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@11@1@10@@@@@1@@@@@@ READ,WRITE @</Data>
</Node>
<Node><Sub>3</Sub>
<Data>3@21@1@10@@@@@1@@@@@@3@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>3@31@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>3@41@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>6</Sub>
<Data>3@51@1@10@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>4@1@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>4@11@1@10@@@@@1@@@@@@ READ,WRITE,DELETE @</Data>
</Node>
<Node><Sub>3</Sub>
<Data>4@21@1@10@@@@@1@@@@@@4@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>4@31@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>4@41@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>6</Sub>
<Data>4@51@1@10@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>BUT</Sub>
<Data>/2;6;30;45</Data>
<Node><Sub>0</Sub>
<Data>2;6;30;45</Data>
<Node><Sub>1</Sub>
<Data>              Выберите Право доступа</Data>
</Node>
</Node>
<Node><Sub>1</Sub>
<Data>1;6;37;45/2;6;30;41</Data>
<Node><Sub>1</Sub>
<Data> NONE</Data>
</Node>
<Node><Sub>2</Sub>
<Data> READ ONLY</Data>
</Node>
<Node><Sub>3</Sub>
<Data> READ,WRITE</Data>
</Node>
<Node><Sub>4</Sub>
<Data> READ,WRITE,DELETE</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>1</Data>
</Node>
<Node><Sub>2</Sub>
<Data>2</Data>
</Node>
<Node><Sub>3</Sub>
<Data>3</Data>
</Node>
<Node><Sub>4</Sub>
<Data>4</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>0</Data>
</Node>
<Node><Sub>2</Sub>
<Data>0</Data>
</Node>
</Node>
</Node>
<Node><Sub>STA</Sub>
<Data>2,2@1@1@13@-1@-1@2@11@ READ ONLY</Data>
</Node>
</Node>
<Node><Sub>CharGlob</Sub>
<Data><![CDATA[Умалчиваемые характеристики массивов@@@@@1@1@2@2@20@79@@@@@@1@@@1@@@@@@@@18@5@@1;6;35;44@@@@@@@1@^%ZAPM.ed.BSDFLT("CharHelp")@@@@1]]></Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@3@1@@@0@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@4@1@49@1@@@@1@2;6;37;44@@@@@     Умалчиваемые характеристики для массивов@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>1@53@1@10@1@@@@1@2;6;37;44@@@@@  Version@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>1@63@1@13@@@1@0@1@2;6;37;44@@@@@4434,4344,4444@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>1@76@1@3@1@@@@1@2;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@2@3@1@@@@1@2;6;37;44@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>2@4@2@49@1@@@@1@1;6;37;44@@@@@       (введите F1 ,если что-то непонятно)@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>2@53@2@10@1@@@@1@2;6;37;44@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>2@63@2@13@1@@@@1@2;6;37;44@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>2@76@2@3@1@@@@1@2;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>4@1@1@3@1@@@0@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>4@4@1@49@1@@@@1@1;6;36;46@@@@@  Стандарные Разделы ,создаваемые %BS@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>4@53@1@10@1@@@@1@1;6;37;44@@@@@  SYSTEM@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>4@63@1@13@@@@0@1@1;6;36;46@@@@^%ZAPM.ed.BSDFLT(&quot;CharAcc&quot;)@4@0</Data>
</Node>
<Node><Sub>5</Sub>
<Data>4@76@1@3@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>5@1@1@3@1@@@0@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>5@4@1@49@1@@@@1@1;6;36;46@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>5@53@1@10@1@@@@1@1;6;37;44@@@@@  WORLD@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>5@63@1@13@@@@3,4@1@1;6;36;46@@@@^%ZAPM.ed.BSDFLT(&quot;CharAcc&quot;)@4@0</Data>
</Node>
<Node><Sub>5</Sub>
<Data>5@76@1@3@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>6@1@1@3@1@@@0@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>6@4@1@49@1@@@@1@1;6;36;46@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>6@53@1@10@1@@@@1@1;6;37;44@@@@@  GROUP@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>6@63@1@13@@@@3,4@1@1;6;36;46@@@@^%ZAPM.ed.BSDFLT(&quot;CharAcc&quot;)@3@0</Data>
</Node>
<Node><Sub>5</Sub>
<Data>6@76@1@3@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>7@1@1@3@1@@@0@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>7@4@1@49@1@@@@1@1;6;36;46@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>7@53@1@10@1@@@@1@1;6;37;44@@@@@  USER@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>7@63@1@13@@@@3,4@1@1;6;36;46@@@@^%ZAPM.ed.BSDFLT(&quot;CharAcc&quot;)@4@0</Data>
</Node>
<Node><Sub>5</Sub>
<Data>7@76@1@3@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>8@1@1@3@1@@@0@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>8@4@1@49@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>8@53@1@10@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>8@63@1@13@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>8@76@1@3@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>1</Sub>
<Data>9@1@1@3@1@@@0@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>9@4@1@49@1@@@@1@2;6;30;46@@@@@  Стандарные Кодификаторы ,создаваемые %BS@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>9@53@1@10@1@@@@1@1;6;37;44@@@@@  SYSTEM@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>9@63@1@13@@@@3,4@1@2;6;30;46@@@@^%ZAPM.ed.BSDFLT(&quot;CharAcc&quot;)@4@0</Data>
</Node>
<Node><Sub>5</Sub>
<Data>9@76@1@3@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>1</Sub>
<Data>10@1@1@3@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>10@4@1@49@1@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>10@53@1@10@1@@@@1@1;6;37;44@@@@@  WORLD@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>10@63@1@13@@@@3,4@1@2;6;30;46@@@@^%ZAPM.ed.BSDFLT(&quot;CharAcc&quot;)@3@0</Data>
</Node>
<Node><Sub>5</Sub>
<Data>10@76@1@3@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>1</Sub>
<Data>11@1@1@3@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>11@4@1@49@1@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>11@53@1@10@1@@@@1@1;6;37;44@@@@@  GROUP@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>11@63@1@13@@@@3,4@1@2;6;30;46@@@@^%ZAPM.ed.BSDFLT(&quot;CharAcc&quot;)@4@0</Data>
</Node>
<Node><Sub>5</Sub>
<Data>11@76@1@3@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>11</Sub>
<Node><Sub>1</Sub>
<Data>12@1@1@3@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>12@4@1@49@1@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>12@53@1@10@1@@@@1@1;6;37;44@@@@@  USER@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>12@63@1@13@@@@3,4@1@2;6;30;46@@@@^%ZAPM.ed.BSDFLT(&quot;CharAcc&quot;)@4@0</Data>
</Node>
<Node><Sub>5</Sub>
<Data>12@76@1@3@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>12</Sub>
<Node><Sub>1</Sub>
<Data>13@1@1@3@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>13@4@1@49@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>13@53@1@10@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>13@63@1@13@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>13@76@1@3@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>13</Sub>
<Node><Sub>1</Sub>
<Data>14@1@1@3@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>14@4@1@49@1@@@@1@2;6;30;46@@@@@  Стандарные Базы данных ,создаваемые %BS@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>14@53@1@10@1@@@@1@2;6;37;44@@@@@  SYSTEM@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>14@63@1@13@@@@3,4@1@2;6;30;46@@@@^%ZAPM.ed.BSDFLT(&quot;CharAcc&quot;)@4@0</Data>
</Node>
<Node><Sub>5</Sub>
<Data>14@76@1@3@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>14</Sub>
<Node><Sub>1</Sub>
<Data>15@1@1@3@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>15@4@1@49@1@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>15@53@1@10@1@@@@1@2;6;37;44@@@@@  WORLD@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>15@63@1@13@@@@3,4@1@2;6;30;46@@@@^%ZAPM.ed.BSDFLT(&quot;CharAcc&quot;)@4@0</Data>
</Node>
<Node><Sub>5</Sub>
<Data>15@76@1@3@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>15</Sub>
<Node><Sub>1</Sub>
<Data>16@1@1@3@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>16@4@1@49@1@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>16@53@1@10@1@@@@1@2;6;37;44@@@@@  GROUP@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>16@63@1@13@@@@3,4@1@2;6;30;46@@@@^%ZAPM.ed.BSDFLT(&quot;CharAcc&quot;)@4@0</Data>
</Node>
<Node><Sub>5</Sub>
<Data>16@76@1@3@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>16</Sub>
<Node><Sub>1</Sub>
<Data>17@1@1@3@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>17@4@1@49@1@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>17@53@1@10@1@@@@1@2;6;37;44@@@@@  USER@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>17@63@1@13@@@@3,4@1@2;6;30;46@@@@^%ZAPM.ed.BSDFLT(&quot;CharAcc&quot;)@4@0</Data>
</Node>
<Node><Sub>5</Sub>
<Data>17@76@1@3@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>17</Sub>
<Node><Sub>1</Sub>
<Data>18@1@1@3@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>18@4@1@49@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>18@53@1@10@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>18@63@1@13@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>18@76@1@3@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>18</Sub>
<Node><Sub>1</Sub>
<Data>19@1@1@3@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>19@4@1@49@1@@@@1@1;6;37;44@@@@@       Введите  &lt;Enter&gt; , для модификации@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>19@53@1@10@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>19@63@1@13@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>19@76@1@3@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>CMD</Sub>
<Node><Sub>13</Sub>
<Node><Sub>2</Sub>
<Data><![CDATA[W #,!," *** ВЫБИРИТЕ МАССИВЫ ДЛЯ ПРИЛОЖЕНИЯ ***",! D ^%GSEL,R^%ZAPM.ed.BS0("^BS"),Copy^%ZAPM.ed.BSF8("^%UtiLITY("_$J_")","^BStranS(""Glo"")"),D^%ZAPM.ed.BS0("^BS")]]></Data>
</Node>
<Node><Sub>4</Sub>
<Data><![CDATA[W #,!," *** ВЫБИРИТЕ ПРОГРАММЫ ДЛЯ ПРИЛОЖЕНИЯ ***",! D ^%RSEL,R^%ZAPM.ed.BS0("^BS"),Copy^%ZAPM.ed.BSF8("^%UtiLITY("_$J_")","^BStranS(""Rou"")"),D^%ZAPM.ed.BS0("^BS")]]></Data>
</Node>
</Node>
</Node>
<Node><Sub>FCL</Sub>
<Node><Sub>1</Sub>
<Node><Sub>4</Sub>
<Data><![CDATA[S d1=$$A^%ZAPM.ed.BSA(3,4)_$$A^%ZAPM.ed.BSA(4,4)_$$A^%ZAPM.ed.BSA(5,4)_$$A^%ZAPM.ed.BSA(6,4)_","_$$A^%ZAPM.ed.BSA(8,4)_$$A^%ZAPM.ed.BSA(9,4)_$$A^%ZAPM.ed.BSA(10,4)_$$A^%ZAPM.ed.BSA(11,4)_","_$$A^%ZAPM.ed.BSA(13,4)_$$A^%ZAPM.ed.BSA(14,4)_$$A^%ZAPM.ed.BSA(15,4)_$$A^%ZAPM.ed.BSA(16,4)]]></Data>
<Node><Sub>1</Sub>
<Data>{3,4}_{4,4}_{5,4}_{6,4}_&quot;,&quot;_{8,4}_{9,4}_{10,4}_{11,4}_&quot;,&quot;_{13,4}_{14,4}_{15,4}_{16,4}</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>FTR</Sub>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Data>S d1=&quot; &quot;_$g(^%ZAPM.ed.BS)</Data>
<Node><Sub>1</Sub>
<Data>&quot; &quot;_$g(^%ZAPM.ed.BS)</Data>
</Node>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Data>S d1=$S(d=1:&quot;NONE&quot;,d=2:&quot;READ ONLY&quot;,d=3:&quot;READ &amp; WRITE&quot;,d=4:&quot;R/W &amp; DELETE&quot;,1:&quot;?&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$S(d=1:&quot;NONE&quot;,d=2:&quot;READ ONLY&quot;,d=3:&quot;READ &amp; WRITE&quot;,d=4:&quot;R/W &amp; DELETE&quot;,1:&quot;?&quot;)</Data>
</Node>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>RTR</Sub>
<Node><Sub>3</Sub>
<Node><Sub>4</Sub>
<Data>S d1=$$IF^%ZAPM.ed.BSsFUNR(&quot;d&gt;0&amp;(d&lt;5)&quot;,&quot;READ&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$$IF(&quot;d&gt;0&amp;(d&lt;5)&quot;,&quot;READ&quot;)</Data>
</Node>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>4</Sub>
<Data>S d1=$$IF^%ZAPM.ed.BSsFUNR(&quot;d&gt;0&amp;(d&lt;5)&quot;,&quot;READ&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$$IF(&quot;d&gt;0&amp;(d&lt;5)&quot;,&quot;READ&quot;)</Data>
</Node>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>4</Sub>
<Data>S d1=$$IF^%ZAPM.ed.BSsFUNR(&quot;d&gt;0&amp;(d&lt;5)&quot;,&quot;READ&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$$IF(&quot;d&gt;0&amp;(d&lt;5)&quot;,&quot;READ&quot;)</Data>
</Node>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>4</Sub>
<Data>S d1=$$IF^%ZAPM.ed.BSsFUNR(&quot;d&gt;0&amp;(d&lt;5)&quot;,&quot;READ&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$$IF(&quot;d&gt;0&amp;(d&lt;5)&quot;,&quot;READ&quot;)</Data>
</Node>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>4</Sub>
<Data>S d1=$$IF^%ZAPM.ed.BSsFUNR(&quot;d&gt;0&amp;(d&lt;5)&quot;,&quot;READ&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$$IF(&quot;d&gt;0&amp;(d&lt;5)&quot;,&quot;READ&quot;)</Data>
</Node>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>4</Sub>
<Data>S d1=$$IF^%ZAPM.ed.BSsFUNR(&quot;d&gt;0&amp;(d&lt;5)&quot;,&quot;READ&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$$IF(&quot;d&gt;0&amp;(d&lt;5)&quot;,&quot;READ&quot;)</Data>
</Node>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>4</Sub>
<Data>S d1=$$IF^%ZAPM.ed.BSsFUNR(&quot;d&gt;0&amp;(d&lt;5)&quot;,&quot;READ&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$$IF(&quot;d&gt;0&amp;(d&lt;5)&quot;,&quot;READ&quot;)</Data>
</Node>
</Node>
</Node>
<Node><Sub>11</Sub>
<Node><Sub>4</Sub>
<Data>S d1=$$IF^%ZAPM.ed.BSsFUNR(&quot;d&gt;0&amp;(d&lt;5)&quot;,&quot;READ&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$$IF(&quot;d&gt;0&amp;(d&lt;5)&quot;,&quot;READ&quot;)</Data>
</Node>
</Node>
</Node>
<Node><Sub>13</Sub>
<Node><Sub>4</Sub>
<Data>S d1=$$IF^%ZAPM.ed.BSsFUNR(&quot;d&gt;0&amp;(d&lt;5)&quot;,&quot;READ&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$$IF(&quot;d&gt;0&amp;(d&lt;5)&quot;,&quot;READ&quot;)</Data>
</Node>
</Node>
</Node>
<Node><Sub>14</Sub>
<Node><Sub>4</Sub>
<Data>S d1=$$IF^%ZAPM.ed.BSsFUNR(&quot;d&gt;0&amp;(d&lt;5)&quot;,&quot;READ&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$$IF(&quot;d&gt;0&amp;(d&lt;5)&quot;,&quot;READ&quot;)</Data>
</Node>
</Node>
</Node>
<Node><Sub>15</Sub>
<Node><Sub>4</Sub>
<Data>S d1=$$IF^%ZAPM.ed.BSsFUNR(&quot;d&gt;0&amp;(d&lt;5)&quot;,&quot;READ&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$$IF(&quot;d&gt;0&amp;(d&lt;5)&quot;,&quot;READ&quot;)</Data>
</Node>
</Node>
</Node>
<Node><Sub>16</Sub>
<Node><Sub>4</Sub>
<Data>S d1=$$IF^%ZAPM.ed.BSsFUNR(&quot;d&gt;0&amp;(d&lt;5)&quot;,&quot;READ&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$$IF(&quot;d&gt;0&amp;(d&lt;5)&quot;,&quot;READ&quot;)</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>STA</Sub>
<Data>1,4@1@1@27@-1@-1@6@64@4434,4344,4444</Data>
</Node>
</Node>
<Node><Sub>CharHelp</Sub>
<Data>Классы пользователей MSM@@@@@@@5@10@17@70@@@@1@@5@@@1@@@ 1@@@@@11@@@1;6;37;44//2;6;33;40@@@@@@@1</Data>
<Node><Sub>1</Sub>
<Data></Data>
</Node>
<Node><Sub>2</Sub>
<Data> SYSTEM  - Доступ пользователей системного КИПа к Глобалам</Data>
</Node>
<Node><Sub>3</Sub>
<Data>           системного Кипа</Data>
</Node>
<Node><Sub>4</Sub>
<Data> WORLD   - Доступ пользователей из других систем к Глобалам</Data>
</Node>
<Node><Sub>5</Sub>
<Data>           вашей системы по системе сетевой распределённой</Data>
</Node>
<Node><Sub>6</Sub>
<Data>           обработке данных (DDP)</Data>
</Node>
<Node><Sub>7</Sub>
<Data> GROUP   - Доступ пользователей из несистемных КИПов</Data>
</Node>
<Node><Sub>8</Sub>
<Data>           к Глобалам других Кипов</Data>
</Node>
<Node><Sub>9</Sub>
<Data> USER    - Доступ пользователей из несистемных КИПов</Data>
</Node>
<Node><Sub>10</Sub>
<Data>           к Глобалам своего Кипа</Data>
</Node>
<Node><Sub>11</Sub>
<Data>               (теперь вам всё понятно ?)</Data>
</Node>
<Node><Sub>User</Sub>
<Node><Sub>MSW98iMS</Sub>
<Data></Data>
</Node>
</Node>
</Node>
<Node><Sub>EditBar</Sub>
<Data><![CDATA[Редактор в окне без рамки@@@@@@@20@1@22@80@1@@@1@@5@@@@@@@@@@@1@510@@2;6;36;40//2;6;37;40/1;6;37;40/2;6;33;40//////152@@@@@@@1]]></Data>
<Node><Sub>1</Sub>
<Data></Data>
</Node>
</Node>
<Node><Sub>ErrorTXT</Sub>
<Data><![CDATA[Ошибка в маленьком тексте@@@@@@@7@10@20@70@1@11111100@@0@@5@@@1@@@ 1@@@@@1@@@2;6;33;41//2;6;33;40/2;6;33;41/2;6;37;41@@@@@@@1]]></Data>
<Node><Sub>1</Sub>
<Data></Data>
</Node>
</Node>
<Node><Sub>HTML</Sub>
<Data>ПАРАМЕТРЫ СТРАНИЦЫ HTML (по-умолчанию)@@@@@1@1@1@1@22@80@1@@1@1@@1@@@1@@@@@@@@18@2@@1;6;35;44@@@@@@</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@40@@@@@1@2;6;33;45@@@@@     НАИМЕНОВАНИЯ ПАРАМЕТРОВ</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@41@1@35@@@@@1@2;6;33;45@@@@@ ЗНАЧЕНИЯ@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@40@@@@@1@2;6;34;46@@@@@НАЧАЛО СТРОКИ ТИТУЛА СТРАНИЦЫ</Data>
</Node>
<Node><Sub>2</Sub>
<Data>2@41@1@35@@@@@1@2;6;37;44@@@@@%BS + Cache - WebLink@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@40@@@@@1@2;6;34;46@@@@@ПАРАМЕТРЫ ТЕГА &quot;&lt;BODY &quot;_@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@41@1@35@@@@@1@2;6;37;44@@@@@BGCOLOR=#ffffcc@</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>4@1@1@40@@@@@1@2;6;34;46@@@@@ТЕКСТ ЗАГОЛОВКА СТРАНИЦЫ ПО-УМОЛЧАНИЮ@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>4@41@1@35@@@@@1@2;6;37;44@@@@@&lt;H6&gt;Информационно - Справочная Система&lt;/H6&gt;@</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>5@1@1@40@@@@@1@2;6;34;46@@@@@ЗАГЛАВНАЯ КАРТИНКА СТРАНИЦЫ  &quot;&lt;IMG &quot;_@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>5@41@1@35@@@@@1@2;6;37;44@@@@@SRC=&quot;/scripts/mgwms32.dll?MGWSYSimg=cache_jpg&quot; ALT=&quot;Cache@</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>6@1@1@40@@@@@1@2;6;34;46@@@@@ЦВЕТ ФОНА ШАПКИ ТАБЛИЦЫ @</Data>
</Node>
<Node><Sub>2</Sub>
<Data>6@41@1@35@@@@@1@2;6;37;44@@@@@BGCOLOR=&quot;#800080&quot;@</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>7@1@1@40@@@@@1@2;6;34;46@@@@@ТЕКСТ ЗАВЕРШЕНИЯ СТРАНИЦЫ ПО-УМОЛЧАНИЮ@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>7@41@1@35@@@@@1@2;6;37;44@@@@@&lt;H6&gt;(С) 2001 Михайленко С.В. тел. 7 (095) 361-8735&lt;/H6&gt;@</Data>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>1</Sub>
<Data>8@1@1@40@@@@@1@2;6;34;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>8@41@1@35@@@@@1@2;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>1</Sub>
<Data>9@1@1@40@@@@@1@2;6;34;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>9@41@1@35@@@@@1@2;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>1</Sub>
<Data>10@1@1@40@@@@@1@2;6;34;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>10@41@1@35@@@@@1@2;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>11</Sub>
<Node><Sub>1</Sub>
<Data>11@1@1@40@@@@@1@2;6;34;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>11@41@1@35@@@@@1@2;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>12</Sub>
<Node><Sub>1</Sub>
<Data>12@1@1@40@@@@@1@2;6;34;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>12@41@1@35@@@@@1@2;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>13</Sub>
<Node><Sub>1</Sub>
<Data>13@1@1@40@@@@@1@2;6;34;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>13@41@1@35@@@@@1@2;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>14</Sub>
<Node><Sub>1</Sub>
<Data>14@1@1@40@@@@@1@2;6;34;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>14@41@1@35@@@@@1@2;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>15</Sub>
<Node><Sub>1</Sub>
<Data>15@1@1@40@@@@@1@2;6;34;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>15@41@1@35@@@@@1@2;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>16</Sub>
<Node><Sub>1</Sub>
<Data>16@1@1@40@@@@@1@2;6;34;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>16@41@1@35@@@@@1@2;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>17</Sub>
<Node><Sub>1</Sub>
<Data>17@1@1@40@@@@@1@2;6;34;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>17@41@1@35@@@@@1@2;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>18</Sub>
<Node><Sub>1</Sub>
<Data>18@1@1@40@@@@@1@2;6;34;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>18@41@1@35@@@@@1@2;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>HTML</Sub>
<Node><Sub>CFG</Sub>
<Data>1,0,0,9,9,9,,0,1,1</Data>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>58083,58966,MS</Data>
</Node>
<Node><Sub>OPT</Sub>
<Data>1,2,2</Data>
</Node>
<Node><Sub>STA</Sub>
<Data>1,2@1@1@13@-1@-1@1@41@ ЗНАЧЕНИЯ</Data>
</Node>
</Node>
<Node><Sub>History</Sub>
<Data><![CDATA[История@@@@@@@3@3@22@76@1@11111100@@1@@5@@@@@@@@@@@1@510@@2;6;37;44//2;6;33;40/2;6;37;44/2;6;37;44//////32@@@@@@@1]]></Data>
<Node><Sub>1</Sub>
<Data></Data>
</Node>
</Node>
<Node><Sub>LineEdit</Sub>
<Data><![CDATA[Строчный редактор комплекса@@@@@@@20@1@22@80@@11100111@@1@@5@@@@@@@@@@@1@510@@1;6;36;40///1;6;37;40/1;6;37;40//////152@@@@@@@1]]></Data>
<Node><Sub>1</Sub>
<Data></Data>
</Node>
</Node>
<Node><Sub>MAIL</Sub>
<Data>Сообщение Администратору@@@@@1@1@1@1@22@80@1@@1@@@2@@2,2@1@@@@@1@@@5@2@@@@@@@@</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@2@20@@@@@1@2;6;35;42@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@21@2@53@@@@0@1@2;6;35;42@@@@@@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@20@@@@@1@2;6;35;42@@@@@       ПОЛЬЗОВАТЕЛЬ</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@21@1@53@@@@@2@1;6;32;40@@@@@@@@U@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>4@1@1@20@@@@@1@2;6;35;42@@@@@            ТЕЛЕФОН@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>4@21@1@53@@@@@2@1;6;32;40@@@@@@@@T</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>5@1@1@20@@@@@1@2;6;35;42@@@@@          СРОЧНОСТЬ@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>5@21@1@53@@@@0@2@1;6;32;40@@@@@@@@A</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>6@1@10@20@@@@@1@2;6;35;42@@@@@                            ТЕКСТ               СООБЩЕНИЯ@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>6@21@10@53@@@@0@2@1;6;32;40@@@@@@@@B</Data>
</Node>
</Node>
<Node><Sub>FTR</Sub>
<Node><Sub>1</Sub>
<Node><Sub>2</Sub>
<Data>S d1=&quot; ДАТА &quot;_$$ESDAY^%ZAPM.ed.BSsFUNR(9,$G(k1,&quot;1&quot;)_&quot;,&quot;_$G(k2,&quot;1&quot;))</Data>
<Node><Sub>1</Sub>
<Data>&quot; ДАТА &quot;_$$ESDAY^%ZAPM.ed.BSsFUNR(9,$G(k1,&quot;1&quot;)_&quot;,&quot;_$G(k2,&quot;1&quot;))</Data>
</Node>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>2</Sub>
<Data>S d1=d_&quot; - &quot;_$S(d=1:&quot;ОЧЕНЬ СРОЧНО&quot;,d=2:&quot;НЕ СРОЧНО&quot;,1:&quot;СОВСЕМ НЕ СРОЧНО&quot;)</Data>
<Node><Sub>1</Sub>
<Data>d_&quot; - &quot;_$S(d=1:&quot;ОЧЕНЬ СРОЧНО&quot;,d=2:&quot;НЕ СРОЧНО&quot;,1:&quot;СОВСЕМ НЕ СРОЧНО&quot;)</Data>
</Node>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>2</Sub>
<Data>S d1=$TR(d,$C(13,10),&quot;&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$TR(d,$C(13,10),&quot;&quot;)</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>Free</Sub>
<Data>58082,67470</Data>
</Node>
<Node><Sub>KEY</Sub>
<Data>^[&quot;%SYS&quot;]%BSMAIL</Data>
<Node><Sub>1</Sub>
<Data>@@64@@НОВАЯ СИСТЕМНАЯ ДАТА@1,70@@@ 1-Й ИНДЕКСНЫЙ@2;6;30;42@@@@@СИСТЕМНАЯ ДАТА@@@@@</Data>
<Node><Sub>3</Sub>
<Data>S d1=d_&quot;    &quot;_$$ESDAY^%ZAPM.ed.BSsFUNR(6,d)</Data>
</Node>
<Node><Sub>4</Sub>
<Data>d_&quot;    &quot;_$$ESDAY^%ZAPM.ed.BSsFUNR(6,d)</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Data><![CDATA[@@1@@ .... ВРЕМЯ   ТЕЛЕФОН  АВТОР    СРОЧНОСТЬ....@1,75@@@ 2-Й ИНДЕКСНЫЙ@2;6;37;44@@@@@СИСТЕМНОЕ ВРЕМЯ@@@@@]]></Data>
<Node><Sub>3</Sub>
<Data><![CDATA[S d1=d_"  "_$P($$ESDAY^%ZAPM.ed.BSsFUNR(9,"1,"_d)," ",1)_"  "_$$A^%ZAPM.ed.BSA(3,2,"MAIL","%BSCDFLT","","","",+$G(%KEYS(1)),$G(d0))_"  "_$$A^%ZAPM.ed.BSA(2,2,"MAIL","%BSCDFLT","","","",+$G(%KEYS(1)),$G(d0))_"  "_$$A^%ZAPM.ed.BSA(4,2,"MAIL","%BSCDFLT","","","",+$G(%KEYS(1)),$G(d0))]]></Data>
</Node>
<Node><Sub>4</Sub>
<Data><![CDATA[d_"  "_$P($$ESDAY^%ZAPM.ed.BSsFUNR(9,"1,"_d)," ",1)_"  "_{3,2,"MAIL","%BSCDFLT","","","",+$G(%KEYS(1)),$G(d0)}_"  "_{2,2,"MAIL","%BSCDFLT","","","",+$G(%KEYS(1)),$G(d0)}_"  "_{4,2,"MAIL","%BSCDFLT","","","",+$G(%KEYS(1)),$G(d0)}]]></Data>
</Node>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>58082,67470,MS</Data>
</Node>
<Node><Sub>STA</Sub>
<Data>2,2@2@2@27@-1@-1@3@21@</Data>
</Node>
</Node>
<Node><Sub>N1</Sub>
<Data>заготовка очень маленькой таблицы (1x1)@@@@@1@1@1@1@22@80@1@@1@1@@1@@@1@@@@@1@@@1@1@@@@@@@@</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@1@@@@@1@@@@@@</Data>
</Node>
</Node>
<Node><Sub>STA</Sub>
<Data>1,1@1@1@13@-1@-1@1@1@</Data>
</Node>
</Node>
<Node><Sub>N10</Sub>
<Data><![CDATA[заготовка под Pall-Down-Menu (1 Уровень)@@@@@1@1@1@1@22@80@1@@1@@1@1@@2,1@1@@@@@1@@@2@5@@2;6;30;45@@@@@@@@@@PDM^%ZAPM.ed.BSF10(1)@@@@@^["GLAVK"]BS0("oboi")]]></Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@15@@@@@1@@@@@@        Внеочер@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@16@1@15@@@@@1@@@@@@едная оперативная информация управления УрО ВВ МВД России@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>1@31@1@15@@@@@1@@@@@@ая информация у@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>1@46@1@15@@@@@1@@@@@@правления УрО В@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>1@61@1@20@@@@@1@@@@@@В МВД России@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@15@@@@0@1@1;6;34;46@@@@^[&quot;GLAVK&quot;]BS0(3)@БАЗЫ ДАННЫХ@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>2@16@1@15@@@@2,1@1@1;6;34;46@@@@^[&quot;GLAVK&quot;]BS0(1)@СПИСКИ@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>2@31@1@15@@@@2,1@1@1;6;34;46@@@@^[&quot;GLAVK&quot;]BS0(2)@СВОДКИ@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>2@46@1@15@@@@2,1@1@1;6;34;46@@@@^[&quot;GLAVK&quot;]BS0(5)@ПОМОЩЬ@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>2@61@1@20@@@@2,1@1@1;6;34;46@@@@^[&quot;GLAVK&quot;]BS0(6)@ВЫХОД@</Data>
</Node>
</Node>
<Node><Sub>FTR</Sub>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>STA</Sub>
<Data>2,2@2@1@27@-1@-1@2@16@СПИСКИ</Data>
</Node>
</Node>
<Node><Sub>N11</Sub>
<Data><![CDATA[заготовка под Pall-Down-Menu (2 Уровень)@@@@@1@1@4@17@9@61@1@@1@@@1@@@1@@@@@@@@6@1@@1;6;32;46@@@@@@@2@@@PDM^%ZAPM.ed.BSF10(2)@@@0]]></Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@45@@@@@1@@@@@@ Новый насчет</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@45@@@@@1@@@@@@ Старые, уже насчитанные сводки@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@45@@@@@1@@@@@@ Смотреть Вид сводки (PreView)@</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>4@1@1@45@@@@@1@2;6;31;46@@@@@ Редактирование сводок@</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>5@1@1@45@@@@@1@2;6;31;46@@@@@ Создание новых сводок@</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>6@1@1@45@@@@@1@2;6;31;46@@@@@ Трансляция и контроль редактированных сводок@</Data>
</Node>
</Node>
<Node><Sub>CMD</Sub>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>D TRANS^%MOLSV</Data>
</Node>
</Node>
</Node>
<Node><Sub>STA</Sub>
<Data>1,1@1@1@27@-1@-1@4@17@ Новый насчет</Data>
</Node>
</Node>
<Node><Sub>N12</Sub>
<Data><![CDATA[заготовка под Параметры@@@@@1@1@2@15@21@67@1@@1@@@1@@@1@@@@@1@@@16@5@@1;6;37;44@@@@@@@2@^%ZAPM.ed.BSDDR("DDRPARMH")@@@@1]]></Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@1@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@2@1@25@@@@@1@2;6;37;44@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>1@27@1@1@@@@@1@2;6;37;44@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>1@28@1@25@@@@@1@2;6;37;44@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>1@53@1@1@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@2@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>2@2@2@25@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>2@27@2@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>2@28@2@25@@@@@1@2;6;34;46@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>2@53@2@1@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>4@1@1@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>4@2@1@25@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>4@27@1@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>4@28@1@25@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>4@53@1@1@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>5@1@2@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>5@2@2@25@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>5@27@2@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>5@28@2@25@@@@@1@2;6;34;46@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>5@53@2@1@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>7@1@1@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>7@2@1@25@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>7@27@1@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>7@28@1@25@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>7@53@1@1@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>8@1@2@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>8@2@2@25@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>8@27@2@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>8@28@2@25@@@@@1@2;6;34;46@@@@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>8@53@2@1@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>10@1@1@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>10@2@1@25@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>10@27@1@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>10@28@1@25@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>10@53@1@1@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>1</Sub>
<Data>11@1@1@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>11@2@1@25@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>11@27@1@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>11@28@1@25@@@@@1@2;6;34;46@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>11@53@1@1@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>1</Sub>
<Data>12@1@1@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>12@2@1@25@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>12@27@1@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>12@28@1@25@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>12@53@1@1@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>1</Sub>
<Data>13@1@2@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>13@2@2@25@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>13@27@2@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>13@28@2@25@@@@@1@2;6;34;46@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>13@53@2@1@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>11</Sub>
<Node><Sub>1</Sub>
<Data>15@1@1@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>15@2@1@25@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>15@27@1@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>15@28@1@25@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>15@53@1@1@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>12</Sub>
<Node><Sub>1</Sub>
<Data>16@1@1@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>16@2@1@25@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>16@27@1@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>16@28@1@25@@@@@1@2;6;34;46@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>16@53@1@1@@@@@1@@@@@@</Data>
</Node>
</Node>
<Node><Sub>13</Sub>
<Node><Sub>1</Sub>
<Data>17@1@1@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>17@2@1@25@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>17@27@1@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>17@28@1@25@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>17@53@1@1@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>14</Sub>
<Node><Sub>1</Sub>
<Data>18@1@1@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>18@2@1@25@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>18@27@1@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>18@28@1@25@@@@@1@2;6;34;46@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>18@53@1@1@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>15</Sub>
<Node><Sub>1</Sub>
<Data>19@1@1@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>19@2@1@25@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>19@27@1@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>19@28@1@25@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>19@53@1@1@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>16</Sub>
<Node><Sub>1</Sub>
<Data>20@1@1@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>20@2@1@25@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>20@27@1@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>20@28@1@25@@@@@1@2;6;34;46@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>20@53@1@1@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>OPT</Sub>
<Data>2,4,2</Data>
</Node>
<Node><Sub>STA</Sub>
<Data>3,1@1@1@27@-1@-1@5@15@</Data>
</Node>
</Node>
<Node><Sub>N13</Sub>
<Data>заготовка ...,генерирующая МикроЗапросы@@@@@1@1@1@1@22@80@1@@1@1@@1@@@1@@@@@@@@17@2@@1;6;35;44@@@@@@</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@2@15@@@@@1@2;6;30;45@@@@@Текст в бокови-не сводки</Data>
</Node>
<Node><Sub>2</Sub>
<Data><![CDATA[1@16@2@65@@@@@1@2;6;30;45@@@@@  Формулы $$TSVV для сводки в формате:$$TSVV("k2=1234")                                           или :k2=1234@]]></Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@15@@@@@1@2;6;30;46@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@16@1@65@@@@@1@2;6;37;41@@@@@@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>4@1@1@15@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>4@16@1@65@@@@@1@2;6;37;41@@@@@      Порядок создания МикроЗапросов@</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>5@1@1@15@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>5@16@1@65@@@@@1@2;6;37;41@@@@@@</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>6@1@1@15@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>6@16@1@65@@@@@1@2;6;37;41@@@@@ - введите в 1 колонку  Тект в боковине сводки@</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>7@1@1@15@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>7@16@1@65@@@@@1@2;6;37;41@@@@@ - введите во 2 колонку Формулы для сводки@</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>8@1@1@15@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>8@16@1@65@@@@@1@2;6;37;41@@@@@ - пометьте клавишей &lt;Ins&gt; или + данные и ссылки@</Data>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>1</Sub>
<Data>9@1@1@15@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>9@16@1@65@@@@@1@2;6;37;41@@@@@ - установите указатель в колонку данных и F6-СОЗДАТЬ-МикроЗапрос@</Data>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>1</Sub>
<Data>10@1@1@15@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>10@16@1@65@@@@@1@2;6;37;41@@@@@ - ответьте на вопросы@</Data>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>1</Sub>
<Data>11@1@1@15@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>11@16@1@65@@@@@1@2;6;37;41@@@@@ - установите указатель в колонку ссылок и F6-СОЗДАТЬ-МикроЗапрос@</Data>
</Node>
</Node>
<Node><Sub>11</Sub>
<Node><Sub>1</Sub>
<Data>12@1@1@15@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>12@16@1@65@@@@@1@2;6;37;41@@@@@ - ответьте на вопросы и ваши М\Запросы готовы@</Data>
</Node>
</Node>
<Node><Sub>12</Sub>
<Node><Sub>1</Sub>
<Data>13@1@1@15@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>13@16@1@65@@@@@1@2;6;37;41@@@@@@</Data>
</Node>
</Node>
<Node><Sub>13</Sub>
<Node><Sub>1</Sub>
<Data>14@1@1@15@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>14@16@1@65@@@@@1@2;6;37;41@@@@@@</Data>
</Node>
</Node>
<Node><Sub>14</Sub>
<Node><Sub>1</Sub>
<Data>15@1@1@15@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>15@16@1@65@@@@@1@2;6;37;41@@@@@@</Data>
</Node>
</Node>
<Node><Sub>15</Sub>
<Node><Sub>1</Sub>
<Data>16@1@1@15@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>16@16@1@65@@@@@1@2;6;37;41@@@@@@</Data>
</Node>
</Node>
<Node><Sub>16</Sub>
<Node><Sub>1</Sub>
<Data>17@1@1@15@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>17@16@1@65@@@@@1@2;6;37;41@@@@@@</Data>
</Node>
</Node>
<Node><Sub>17</Sub>
<Node><Sub>1</Sub>
<Data>18@1@1@15@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>18@16@1@65@@@@@1@2;6;37;41@@@@@@</Data>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>59242,53698,MSW</Data>
</Node>
<Node><Sub>STA</Sub>
<Data>4,2@1@1@13@-1@-1@5@16@</Data>
</Node>
</Node>
<Node><Sub>N14</Sub>
<Data>заготовка для таблицы ТИПА-LINK@@@@@1@1@1@1@22@80@1@@1@1@@6@@1,2@1@@@@@1@@@3@2@@@@@@@@</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@40@@@@@1@@@@@@РАЗДЕЛ (пример:^[&quot;GLAVK&quot;]ABC)</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@41@1@35@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@40@@@@@1@@@@@@ТАБЛИЦА (пример:TABLE)@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>2@41@1@35@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@40@@@@@1@2;6;30;43@@@@@!!!! ЗАГРУЖАТЬ БЕЗ ВОПРОСА О ЗАГРУЗКЕ @</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@41@1@35@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>58348,58320,</Data>
</Node>
<Node><Sub>STA</Sub>
<Data>1,2@1@2@13@-1@-1@1@41@</Data>
</Node>
</Node>
<Node><Sub>N15</Sub>
<Data><![CDATA[заготовка под таблицу-описания ключа@@@@@1@1@1@1@22@80@1@@1@1@@1@@@1@@@@@@@@3@1@@2;6;30;46@@@@@@@@@1,3,0]]></Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@75@@@@@1@@@@@@ .. вернуться назад</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@75@@@@@1@2;6;32;44@@@@@ Ввести новый ...@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@75@@@@0@1@2;6;32;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>FTR</Sub>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data><![CDATA[S d1=$S($$A^%ZAPM.ed.BSA(2,1,"SPsb","SBORonly","[""MGR"",""MYY""]","","",$G(%KEYS(1),0),$G(d0))'["N":"       Прибыл   ",1:"")_$P(d0,"~")]]></Data>
<Node><Sub>1</Sub>
<Data><![CDATA[$S({2,1,"SPsb","SBORonly","[""MGR"",""MYY""]","","",$G(%KEYS(1),0),$G(d0)}'["N":"       Прибыл   ",1:"")_$P(d0,"~")]]></Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>59242,53728,MSW</Data>
</Node>
<Node><Sub>STA</Sub>
<Data>3,1@1@1@13@-1@-1@3@1@</Data>
</Node>
</Node>
<Node><Sub>N16</Sub>
<Data>заготовка под одноуровневую базу данных@@@@@1@1@1@1@22@80@1@@1@@@1@@@1@@@@@1@@@7@2@@@@@@@@@@</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@2@20@@@@@1@2;6;30;42@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@21@2@53@@@@0@1@2;6;30;42@@@@@@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>3@1@2@20@@@@@1@2;6;30;42@@@@@      КОМЕНТАРИЙ</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@21@2@53@@@@@2@2;6;30;43@@@@@@@@REM@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>5@1@2@20@@@@@1@2;6;30;42@@@@@    ПРИКРЕПЛЕННАЯ         NAMESPACE@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>5@21@2@53@@@@@2@2;6;30;43@@@@@@@@NSP</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>7@1@2@20@@@@@1@2;6;30;42@@@@@   ФЛАГИ ТЕРМИНАЛА       (F1-ПОМОЩЬ)@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>7@21@2@53@@@@@2@2;6;30;43@@@@@@@@FLG@@</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>9@1@1@20@@@@@1@2;6;30;42@@@@@Инициализация LPT:@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>9@21@1@53@@@@@2@2;6;30;43@@@@@@@@OpenLPT</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>10@1@1@20@@@@@1@2;6;30;42@@@@@Отмена вывода наLPT:@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>10@21@1@53@@@@@2@2;6;30;43@@@@@@@@CloseLPT</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>11@1@2@20@@@@@1@2;6;30;42@@@@@Уникальный идентифи-кационный номер@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>11@21@2@53@@@@0@2@2;6;30;43@@@@@@@@Principal</Data>
</Node>
</Node>
<Node><Sub>FTR</Sub>
<Node><Sub>1</Sub>
<Node><Sub>2</Sub>
<Data>S d1=&quot; ТЕРМИНАЛ № &quot;_$G(k1,&quot;?&quot;)</Data>
<Node><Sub>1</Sub>
<Data>&quot; ТЕРМИНАЛ № &quot;_$G(k1,&quot;?&quot;)</Data>
</Node>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>2</Sub>
<Data>S d1=&quot;  &quot;_$S(d1=&quot;&quot;:$P_&quot; = $P&quot;,1:d1)</Data>
<Node><Sub>1</Sub>
<Data>&quot;  &quot;_$S(d1=&quot;&quot;:$P_&quot; = $P&quot;,1:d1)</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>Free</Sub>
<Data>58348,43647</Data>
</Node>
<Node><Sub>LST</Sub>
<Data>59242,53770,MSW</Data>
</Node>
<Node><Sub>STA</Sub>
<Data>2,2@1@1@13@-1@-1@3@21@</Data>
</Node>
</Node>
<Node><Sub>N17</Sub>
<Data><![CDATA[заготовка под таблицу конфигураций (Cache'only)@@@@@1@1@1@1@22@80@1@@1@1@@1@@2,1@1@@@@@@@@8@5@@1;6;35;44@@@@@@]]></Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@13@@@@@1@2;6;35;40@@@@@ Value (DFLT)</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@14@1@10@@@@@1@2;6;30;41@@@@@ Type@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>1@24@1@10@@@@@1@2;6;30;41@@@@@Atribute@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>1@34@1@35@@@@@1@2;6;33;40@@@@@ ОПИСАНИЕ@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>1@69@1@9@@@@@1@2;6;30;41@@@@@ name@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@13@@@@@1@2;6;35;40@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>2@14@1@10@@@@@1@2;6;30;41@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>2@24@1@10@@@@@1@2;6;30;41@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>2@34@1@35@@@@@1@2;6;33;40@@@@@ Основные Опции Комплекса@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>2@69@1@9@@@@@1@2;6;30;41@@@@@@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@13@@@@@1@2;6;35;40@@@@@0</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>3@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>3@34@1@35@@@@@1@2;6;33;40@@@@@ ТРЕБОВАТЬ РЕГИСТРАЦИЮ В %BS@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>3@69@1@9@@@@@1@2;6;32;40@@@@@REG1@</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>4@1@1@13@@@@@1@2;6;35;40@@@@@0@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>4@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>4@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>4@34@1@35@@@@@1@2;6;33;40@@@@@ РАЗРЕШИТЬ ДОСТУП К БИБЛИОТЕЧНЫМ РАЗДЕЛАМ@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>4@69@1@9@@@@@1@2;6;32;40@@@@@LIB1@</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>5@1@1@13@@@@@1@2;6;35;40@@@@@3@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>5@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>5@24@1@10@@@@@1@2;6;32;40@@@@@size=32@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>5@34@1@35@@@@@1@2;6;33;40@@@@@ Через сколько дней удалять буффер сессий@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>5@69@1@9@@@@@1@2;6;32;40@@@@@TMP1@</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>6@1@1@13@@@@@1@2;6;35;40@@@@@3@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>6@14@1@10@@@@@1@2;6;32;40@@@@@radio@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>6@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>6@34@1@35@@@@@1@2;6;33;40@@@@@ПЕРВЫЙ~ ВТОРОЙ~ ТРЕТИЙ@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>6@69@1@9@@@@@1@2;6;32;40@@@@@RAD1@</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>7@1@1@13@@@@@1@2;6;35;40@@@@@text</Data>
</Node>
<Node><Sub>2</Sub>
<Data>7@14@1@10@@@@@1@2;6;32;40@@@@@textarea@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>7@24@1@10@@@@@1@2;6;32;40@@@@@rows=3 cols=30@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>7@34@1@35@@@@@1@2;6;33;40@@@@@ Коментарий@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>7@69@1@9@@@@@1@2;6;32;40@@@@@TXT1@</Data>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>1</Sub>
<Data>8@1@1@13@@@@@1@2;6;33;40@@@@@D:\!\@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>8@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>8@24@1@10@@@@@1@2;6;32;40@@@@@size=35@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>8@34@1@35@@@@@1@2;6;33;40@@@@@ Путь к директории временных файлов@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>8@69@1@9@@@@@1@2;6;32;40@@@@@TmpFile1@</Data>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>59242,53804,MSW</Data>
</Node>
<Node><Sub>OPT</Sub>
<Data>1</Data>
</Node>
<Node><Sub>STA</Sub>
<Data>8,3@2@1@13@-1@-1@8@24@size=35</Data>
</Node>
</Node>
<Node><Sub>N2</Sub>
<Data>заготовка под таблицу-меню@@@@@@1@1@1@22@80@1@@1@1@@1@@@1@@@@@@@@17@1@@2;6;30;46@@@@@@</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@55@@@@0@1@@@@@@ДЛЯ ТОГО, ЧТОБЫ ДАННАЯ ТАБЛИЦА</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@55@@@@1,1@1@@@@@@СТАЛА</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@55@@@@1,1@1@@@@@@ПОЛЬЗОВАТЕЛЬСКИМ МЕНЮ,@</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>4@1@1@55@@@@1,1@1@@@@@@НЕОБХОДИМО:@</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>5@1@1@55@@@@1,1@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>6@1@1@55@@@@1,1@1@@@@@@1.ВОЙТИ В РЕЖИМ РЕДАКТИРОВАНИЯ ОПИСАНИЯ ТАБЛИЫ (F4)@</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>7@1@1@55@@@@1,1@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>1</Sub>
<Data>8@1@1@55@@@@1,1@1@@@@@@2.ВОЙТИ В ПОДРЕЖИМ (ОПЦ) - РЕДАКТИРОВАНИЕ ОПЦИЙ   @</Data>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>1</Sub>
<Data>9@1@1@55@@@@1,1@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>1</Sub>
<Data>10@1@1@55@@@@1,1@1@@@@@@3.ВОЙТИ В ПОДРЕЖИМ (ТИП)@</Data>
</Node>
</Node>
<Node><Sub>11</Sub>
<Node><Sub>1</Sub>
<Data>11@1@1@55@@@@1,1@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>12</Sub>
<Node><Sub>1</Sub>
<Data>12@1@1@55@@@@1,1@1@@@@@@4.ВОЙТИ В ПОДРЕЖИМ (ПОЛЬЗОВАТЕЛЬСКОЕ МЕНЮ)@</Data>
</Node>
</Node>
<Node><Sub>13</Sub>
<Node><Sub>1</Sub>
<Data>13@1@1@55@@@@1,1@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>14</Sub>
<Node><Sub>1</Sub>
<Data>14@1@1@55@@@@1,1@1@@@@@@5.ВОЙТИ В ПОДРЕЖИМ (ВКЛЮЧИТЬ)@</Data>
</Node>
</Node>
<Node><Sub>15</Sub>
<Node><Sub>1</Sub>
<Data>15@1@1@55@@@@1,1@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>16</Sub>
<Node><Sub>1</Sub>
<Data>16@1@1@55@@@@1,1@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>17</Sub>
<Node><Sub>1</Sub>
<Data>17@1@1@55@@@@1,1@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>FTR</Sub>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>STA</Sub>
<Data>12,1@1@1@13@-1@-1@12@1@4.ВОЙТИ В ПОДРЕЖИМ (ПОЛЬЗОВАТЕЛЬСКОЕ МЕНЮ)</Data>
</Node>
</Node>
<Node><Sub>N3</Sub>
<Data><![CDATA[заготовка под текст во весь экpан@@@@@@@1@1@22@80@@@@1@@5@@@1@@@ 1@@@@@4@@@2;6;37;44//1;6;36;40/2;6;37;44/2;6;37;44@@@@@@@1]]></Data>
<Node><Sub>1</Sub>
<Data></Data>
</Node>
<Node><Sub>2</Sub>
<Data>                        ДОБРО ПОЖАЛОВАТЬ    В    ТЕКСТЫ</Data>
</Node>
<Node><Sub>3</Sub>
<Data>                      ДЛЯ МОДИФИКАЦИИ ТЕКСТА ВВЕДИТЕ (F4)</Data>
</Node>
<Node><Sub>4</Sub>
<Data>                       ДЛЯ ВЫЗОВА ПОМОЩИ , ВВЕДИТЕ  (F1)</Data>
</Node>
</Node>
<Node><Sub>N4</Sub>
<Data><![CDATA[заготовка под маленький текст@@@@@@@7@10@19@70@@@@1@@5@@@1@@@ 1@@@@@1@@@2;6;37;44//2;6;33;40/2;6;37;44/2;6;37;44@@@@@@@1]]></Data>
<Node><Sub>1</Sub>
<Data></Data>
</Node>
<Node><Sub>2</Sub>
<Data></Data>
</Node>
<Node><Sub>3</Sub>
<Data></Data>
</Node>
<Node><Sub>4</Sub>
<Data></Data>
</Node>
<Node><Sub>5</Sub>
<Data></Data>
</Node>
<Node><Sub>6</Sub>
<Data></Data>
</Node>
<Node><Sub>7</Sub>
<Data></Data>
</Node>
<Node><Sub>8</Sub>
<Data></Data>
</Node>
<Node><Sub>9</Sub>
<Data></Data>
</Node>
<Node><Sub>10</Sub>
<Data></Data>
</Node>
<Node><Sub>11</Sub>
<Data></Data>
</Node>
</Node>
<Node><Sub>N5</Sub>
<Data><![CDATA[заготовка под Блок-меню или Панель с кнопками@@@@@1@1@1@1@22@80@1@@1@1@@1@@@1@@@@@@@@5@6@@2;6;37;44@@@@@@@@^%ZAPM.ed.BSHLP("HELP-ALTF2")]]></Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@10@@@@@1@@@@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@11@1@10@@@@@1@1;6;32;44@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>1@21@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>1@31@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>1@41@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>6</Sub>
<Data>1@51@1@10@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@10@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>2@11@1@10@@@@@1@1;6;32;44@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>2@21@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>2@31@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>2@41@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>6</Sub>
<Data>2@51@1@10@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@11@1@10@@@@@1@1;6;32;44@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>3@21@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>3@31@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>3@41@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>6</Sub>
<Data>3@51@1@10@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>4@1@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>4@11@1@10@@@@@1@1;6;32;44@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>4@21@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>4@31@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>4@41@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>6</Sub>
<Data>4@51@1@10@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>5@1@1@10@@@@@1@@@@@@Если не@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>5@11@1@10@@@@@1@@@@@@знаете,что@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>5@21@1@10@@@@@1@@@@@@ делать -@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>5@31@1@10@@@@@1@@@@@@введите@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>5@41@1@10@@@@@1@@@@@@&lt;F1&gt;@</Data>
</Node>
<Node><Sub>6</Sub>
<Data>5@51@1@10@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>STA</Sub>
<Data>5,6@1@1@13@-1@-1@5@51@</Data>
</Node>
</Node>
<Node><Sub>N6</Sub>
<Data>заготовка маленькой таблицы-меню@@@@@@1@3@17@19@56@1@@1@1@@1@@@1@@@@@@@@17@1@@@@@@@@@2</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@40@@@@0@1@@@@@@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@40@@@@0@1@@@@@@=============================================</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@40@@@@0@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>4@1@1@40@@@@0@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>5@1@1@40@@@@0@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>6@1@1@40@@@@0@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>7@1@1@40@@@@0@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>1</Sub>
<Data>8@1@1@40@@@@0@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>1</Sub>
<Data>9@1@1@40@@@@0@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>1</Sub>
<Data>10@1@1@40@@@@0@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>11</Sub>
<Node><Sub>1</Sub>
<Data>11@1@1@40@@@@0@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>12</Sub>
<Node><Sub>1</Sub>
<Data>12@1@1@40@@@@0@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>13</Sub>
<Node><Sub>1</Sub>
<Data>13@1@1@40@@@@0@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>14</Sub>
<Node><Sub>1</Sub>
<Data>14@1@1@40@@@@0@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>15</Sub>
<Node><Sub>1</Sub>
<Data>15@1@1@40@@@@0@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>16</Sub>
<Node><Sub>1</Sub>
<Data>16@1@1@40@@@@0@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>17</Sub>
<Node><Sub>1</Sub>
<Data>17@1@1@40@@@@0@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>FTR</Sub>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>11</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>12</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>13</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>14</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>15</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>16</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>17</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>STA</Sub>
<Data>3,1@1@1@13@-1@-1@5@17@</Data>
</Node>
</Node>
<Node><Sub>N7</Sub>
<Data>заготовка стандаpтной таблицы@@@@@1@1@1@1@22@80@1@@1@1@@1@@@1@@@@@1@@@16@21@@@@@@@@@@@@@@1</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@1@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@2@1@8@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>1@10@1@1@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>1@11@1@6@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>1@17@1@1@@@@@1@@@@@@С</Data>
</Node>
<Node><Sub>6</Sub>
<Data>1@18@1@6@@@@@1@@@@@@ТАНДАР</Data>
</Node>
<Node><Sub>7</Sub>
<Data>1@24@1@1@@@@@1@@@@@@Т</Data>
</Node>
<Node><Sub>8</Sub>
<Data>1@25@1@6@@@@@1@@@@@@НАЯ</Data>
</Node>
<Node><Sub>9</Sub>
<Data>1@31@1@1@@@@@1@@@@@@Э</Data>
</Node>
<Node><Sub>10</Sub>
<Data>1@32@1@6@@@@@1@@@@@@ЛЕКТРОН</Data>
</Node>
<Node><Sub>11</Sub>
<Data>1@38@1@1@@@@@1@@@@@@Н</Data>
</Node>
<Node><Sub>12</Sub>
<Data>1@39@1@6@@@@@1@@@@@@НАЯ</Data>
</Node>
<Node><Sub>13</Sub>
<Data>1@45@1@1@@@@@1@@@@@@Т</Data>
</Node>
<Node><Sub>14</Sub>
<Data>1@46@1@6@@@@@1@@@@@@АБЛИЦА</Data>
</Node>
<Node><Sub>15</Sub>
<Data>1@52@1@1@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>16</Sub>
<Data>1@53@1@6@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>17</Sub>
<Data>1@59@1@1@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>18</Sub>
<Data>1@60@1@6@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>19</Sub>
<Data>1@66@1@1@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>20</Sub>
<Data>1@67@1@7@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>21</Sub>
<Data>1@74@1@1@@@@@1@@@@@@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@1@@@@@1@@@@@@=</Data>
</Node>
<Node><Sub>2</Sub>
<Data>2@2@1@8@@@@0@1@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>2@10@1@1@@@@@1@@@@@@=</Data>
</Node>
<Node><Sub>4</Sub>
<Data>2@11@1@6@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>2@17@1@1@@@@@1@@@@@@-</Data>
</Node>
<Node><Sub>6</Sub>
<Data>2@18@1@6@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>7</Sub>
<Data>2@24@1@1@@@@@1@@@@@@-</Data>
</Node>
<Node><Sub>8</Sub>
<Data>2@25@1@6@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>9</Sub>
<Data>2@31@1@1@@@@@1@@@@@@-</Data>
</Node>
<Node><Sub>10</Sub>
<Data>2@32@1@6@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>11</Sub>
<Data>2@38@1@1@@@@@1@@@@@@-</Data>
</Node>
<Node><Sub>12</Sub>
<Data>2@39@1@6@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>13</Sub>
<Data>2@45@1@1@@@@@1@@@@@@-</Data>
</Node>
<Node><Sub>14</Sub>
<Data>2@46@1@6@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>15</Sub>
<Data>2@52@1@1@@@@@1@@@@@@-</Data>
</Node>
<Node><Sub>16</Sub>
<Data>2@53@1@6@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>17</Sub>
<Data>2@59@1@1@@@@@1@@@@@@-</Data>
</Node>
<Node><Sub>18</Sub>
<Data>2@60@1@6@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>19</Sub>
<Data>2@66@1@1@@@@@1@@@@@@-</Data>
</Node>
<Node><Sub>20</Sub>
<Data>2@67@1@7@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>21</Sub>
<Data>2@74@1@1@@@@@1@@@@@@=</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>3@1@3@1@@@@0@1@@@@@@|||</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@2@3@8@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>3@10@3@1@@@@3,1@1@@@@@@|||</Data>
</Node>
<Node><Sub>4</Sub>
<Data>3@11@3@6@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>3@17@3@1@@@@0@1@@@@@@|||</Data>
</Node>
<Node><Sub>6</Sub>
<Data>3@18@3@6@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>7</Sub>
<Data>3@24@3@1@@@@3,5@1@@@@@@|||</Data>
</Node>
<Node><Sub>8</Sub>
<Data>3@25@3@6@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>9</Sub>
<Data>3@31@3@1@@@@3,5@1@@@@@@|||</Data>
</Node>
<Node><Sub>10</Sub>
<Data>3@32@3@6@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>11</Sub>
<Data>3@38@3@1@@@@3,5@1@@@@@@|||</Data>
</Node>
<Node><Sub>12</Sub>
<Data>3@39@3@6@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>13</Sub>
<Data>3@45@3@1@@@@3,5@1@@@@@@|||</Data>
</Node>
<Node><Sub>14</Sub>
<Data>3@46@3@6@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>15</Sub>
<Data>3@52@3@1@@@@3,5@1@@@@@@|||</Data>
</Node>
<Node><Sub>16</Sub>
<Data>3@53@3@6@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>17</Sub>
<Data>3@59@3@1@@@@3,5@1@@@@@@|||</Data>
</Node>
<Node><Sub>18</Sub>
<Data>3@60@3@6@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>19</Sub>
<Data>3@66@3@1@@@@3,5@1@@@@@@|||</Data>
</Node>
<Node><Sub>20</Sub>
<Data>3@67@3@7@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>21</Sub>
<Data>3@74@3@1@@@@3,1@1@@@@@@|||</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>6@1@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>2</Sub>
<Data>6@2@1@8@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>6@10@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>4</Sub>
<Data>6@11@1@6@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>6@17@1@1@@@@@1@@@@@@=</Data>
</Node>
<Node><Sub>6</Sub>
<Data>6@18@1@6@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>7</Sub>
<Data>6@24@1@1@@@@@1@@@@@@=</Data>
</Node>
<Node><Sub>8</Sub>
<Data>6@25@1@6@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>9</Sub>
<Data>6@31@1@1@@@@@1@@@@@@=</Data>
</Node>
<Node><Sub>10</Sub>
<Data>6@32@1@6@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>11</Sub>
<Data>6@38@1@1@@@@@1@@@@@@=</Data>
</Node>
<Node><Sub>12</Sub>
<Data>6@39@1@6@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>13</Sub>
<Data>6@45@1@1@@@@@1@@@@@@=</Data>
</Node>
<Node><Sub>14</Sub>
<Data>6@46@1@6@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>15</Sub>
<Data>6@52@1@1@@@@@1@@@@@@=</Data>
</Node>
<Node><Sub>16</Sub>
<Data>6@53@1@6@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>17</Sub>
<Data>6@59@1@1@@@@@1@@@@@@=</Data>
</Node>
<Node><Sub>18</Sub>
<Data>6@60@1@6@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>19</Sub>
<Data>6@66@1@1@@@@@1@@@@@@=</Data>
</Node>
<Node><Sub>20</Sub>
<Data>6@67@1@7@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>21</Sub>
<Data>6@74@1@1@@@@@1@@@@@@|</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>7@1@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>2</Sub>
<Data>7@2@1@8@@@@@1@@@@@@  1</Data>
</Node>
<Node><Sub>3</Sub>
<Data>7@10@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>4</Sub>
<Data>7@11@1@6@@@@@1@@@@@@   2</Data>
</Node>
<Node><Sub>5</Sub>
<Data>7@17@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>6</Sub>
<Data>7@18@1@6@@@@@1@@@@@@  3</Data>
</Node>
<Node><Sub>7</Sub>
<Data>7@24@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>8</Sub>
<Data>7@25@1@6@@@@@1@@@@@@  4</Data>
</Node>
<Node><Sub>9</Sub>
<Data>7@31@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>10</Sub>
<Data>7@32@1@6@@@@@1@@@@@@  5</Data>
</Node>
<Node><Sub>11</Sub>
<Data>7@38@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>12</Sub>
<Data>7@39@1@6@@@@@1@@@@@@  6</Data>
</Node>
<Node><Sub>13</Sub>
<Data>7@45@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>14</Sub>
<Data>7@46@1@6@@@@@1@@@@@@  7</Data>
</Node>
<Node><Sub>15</Sub>
<Data>7@52@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>16</Sub>
<Data>7@53@1@6@@@@@1@@@@@@  8</Data>
</Node>
<Node><Sub>17</Sub>
<Data>7@59@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>18</Sub>
<Data>7@60@1@6@@@@@1@@@@@@  9</Data>
</Node>
<Node><Sub>19</Sub>
<Data>7@66@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>20</Sub>
<Data>7@67@1@7@@@@@1@@@@@@  10</Data>
</Node>
<Node><Sub>21</Sub>
<Data>7@74@1@1@@@@@1@@@@@@|</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>8@1@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>2</Sub>
<Data>8@2@1@8@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>8@10@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>4</Sub>
<Data>8@11@1@6@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>8@17@1@1@@@@@1@@@@@@=</Data>
</Node>
<Node><Sub>6</Sub>
<Data>8@18@1@6@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>7</Sub>
<Data>8@24@1@1@@@@@1@@@@@@=</Data>
</Node>
<Node><Sub>8</Sub>
<Data>8@25@1@6@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>9</Sub>
<Data>8@31@1@1@@@@@1@@@@@@=</Data>
</Node>
<Node><Sub>10</Sub>
<Data>8@32@1@6@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>11</Sub>
<Data>8@38@1@1@@@@@1@@@@@@=</Data>
</Node>
<Node><Sub>12</Sub>
<Data>8@39@1@6@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>13</Sub>
<Data>8@45@1@1@@@@@1@@@@@@=</Data>
</Node>
<Node><Sub>14</Sub>
<Data>8@46@1@6@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>15</Sub>
<Data>8@52@1@1@@@@@1@@@@@@=</Data>
</Node>
<Node><Sub>16</Sub>
<Data>8@53@1@6@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>17</Sub>
<Data>8@59@1@1@@@@@1@@@@@@=</Data>
</Node>
<Node><Sub>18</Sub>
<Data>8@60@1@6@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>19</Sub>
<Data>8@66@1@1@@@@@1@@@@@@=</Data>
</Node>
<Node><Sub>20</Sub>
<Data>8@67@1@7@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>21</Sub>
<Data>8@74@1@1@@@@@1@@@@@@|</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>9@1@1@1@@@@0@1@@@@@@|</Data>
</Node>
<Node><Sub>2</Sub>
<Data>9@2@1@8@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>9@10@1@1@@@@7,1@1@@@@@@|</Data>
</Node>
<Node><Sub>4</Sub>
<Data>9@11@1@6@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>9@17@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>6</Sub>
<Data>9@18@1@6@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>7</Sub>
<Data>9@24@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>8</Sub>
<Data>9@25@1@6@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>9</Sub>
<Data>9@31@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>10</Sub>
<Data>9@32@1@6@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>11</Sub>
<Data>9@38@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>12</Sub>
<Data>9@39@1@6@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>13</Sub>
<Data>9@45@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>14</Sub>
<Data>9@46@1@6@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>15</Sub>
<Data>9@52@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>16</Sub>
<Data>9@53@1@6@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>17</Sub>
<Data>9@59@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>18</Sub>
<Data>9@60@1@6@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>19</Sub>
<Data>9@66@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>20</Sub>
<Data>9@67@1@7@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>21</Sub>
<Data>9@74@1@1@@@@7,1@1@@@@@@|</Data>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>1</Sub>
<Data>10@1@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>2</Sub>
<Data>10@2@1@8@@@@0@1@@@@@@---</Data>
</Node>
<Node><Sub>3</Sub>
<Data>10@10@1@1@@@@@1@@@@@@-</Data>
</Node>
<Node><Sub>4</Sub>
<Data>10@11@1@6@@@@8,2@1@@@@@@------</Data>
</Node>
<Node><Sub>5</Sub>
<Data>10@17@1@1@@@@@1@@@@@@+</Data>
</Node>
<Node><Sub>6</Sub>
<Data>10@18@1@6@@@@8,2@1@@@@@@------</Data>
</Node>
<Node><Sub>7</Sub>
<Data>10@24@1@1@@@@@1@@@@@@+</Data>
</Node>
<Node><Sub>8</Sub>
<Data>10@25@1@6@@@@8,2@1@@@@@@------</Data>
</Node>
<Node><Sub>9</Sub>
<Data>10@31@1@1@@@@@1@@@@@@+</Data>
</Node>
<Node><Sub>10</Sub>
<Data>10@32@1@6@@@@8,2@1@@@@@@------</Data>
</Node>
<Node><Sub>11</Sub>
<Data>10@38@1@1@@@@@1@@@@@@+</Data>
</Node>
<Node><Sub>12</Sub>
<Data>10@39@1@6@@@@8,2@1@@@@@@------</Data>
</Node>
<Node><Sub>13</Sub>
<Data>10@45@1@1@@@@@1@@@@@@+</Data>
</Node>
<Node><Sub>14</Sub>
<Data>10@46@1@6@@@@8,2@1@@@@@@------</Data>
</Node>
<Node><Sub>15</Sub>
<Data>10@52@1@1@@@@@1@@@@@@+</Data>
</Node>
<Node><Sub>16</Sub>
<Data>10@53@1@6@@@@8,2@1@@@@@@------</Data>
</Node>
<Node><Sub>17</Sub>
<Data>10@59@1@1@@@@@1@@@@@@+</Data>
</Node>
<Node><Sub>18</Sub>
<Data>10@60@1@6@@@@8,2@1@@@@@@------</Data>
</Node>
<Node><Sub>19</Sub>
<Data>10@66@1@1@@@@@1@@@@@@+</Data>
</Node>
<Node><Sub>20</Sub>
<Data>10@67@1@7@@@@8,2@1@@@@@@-------</Data>
</Node>
<Node><Sub>21</Sub>
<Data>10@74@1@1@@@@@1@@@@@@|</Data>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>1</Sub>
<Data>11@1@1@1@@@@7,1@1@@@@@@|</Data>
</Node>
<Node><Sub>2</Sub>
<Data>11@2@1@8@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>11@10@1@1@@@@7,1@1@@@@@@|</Data>
</Node>
<Node><Sub>4</Sub>
<Data>11@11@1@6@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>11@17@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>6</Sub>
<Data>11@18@1@6@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>7</Sub>
<Data>11@24@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>8</Sub>
<Data>11@25@1@6@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>9</Sub>
<Data>11@31@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>10</Sub>
<Data>11@32@1@6@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>11</Sub>
<Data>11@38@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>12</Sub>
<Data>11@39@1@6@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>13</Sub>
<Data>11@45@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>14</Sub>
<Data>11@46@1@6@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>15</Sub>
<Data>11@52@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>16</Sub>
<Data>11@53@1@6@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>17</Sub>
<Data>11@59@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>18</Sub>
<Data>11@60@1@6@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>19</Sub>
<Data>11@66@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>20</Sub>
<Data>11@67@1@7@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>21</Sub>
<Data>11@74@1@1@@@@7,1@1@@@@@@|</Data>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>1</Sub>
<Data>12@1@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>2</Sub>
<Data>12@2@1@8@@@@8,2@1@@@@@@---</Data>
</Node>
<Node><Sub>3</Sub>
<Data>12@10@1@1@@@@@1@@@@@@-</Data>
</Node>
<Node><Sub>4</Sub>
<Data>12@11@1@6@@@@8,2@1@@@@@@------</Data>
</Node>
<Node><Sub>5</Sub>
<Data>12@17@1@1@@@@@1@@@@@@+</Data>
</Node>
<Node><Sub>6</Sub>
<Data>12@18@1@6@@@@8,2@1@@@@@@------</Data>
</Node>
<Node><Sub>7</Sub>
<Data>12@24@1@1@@@@@1@@@@@@+</Data>
</Node>
<Node><Sub>8</Sub>
<Data>12@25@1@6@@@@8,2@1@@@@@@------</Data>
</Node>
<Node><Sub>9</Sub>
<Data>12@31@1@1@@@@@1@@@@@@+</Data>
</Node>
<Node><Sub>10</Sub>
<Data>12@32@1@6@@@@8,2@1@@@@@@------</Data>
</Node>
<Node><Sub>11</Sub>
<Data>12@38@1@1@@@@@1@@@@@@+</Data>
</Node>
<Node><Sub>12</Sub>
<Data>12@39@1@6@@@@8,2@1@@@@@@------</Data>
</Node>
<Node><Sub>13</Sub>
<Data>12@45@1@1@@@@@1@@@@@@+</Data>
</Node>
<Node><Sub>14</Sub>
<Data>12@46@1@6@@@@8,2@1@@@@@@------</Data>
</Node>
<Node><Sub>15</Sub>
<Data>12@52@1@1@@@@@1@@@@@@+</Data>
</Node>
<Node><Sub>16</Sub>
<Data>12@53@1@6@@@@8,2@1@@@@@@------</Data>
</Node>
<Node><Sub>17</Sub>
<Data>12@59@1@1@@@@@1@@@@@@+</Data>
</Node>
<Node><Sub>18</Sub>
<Data>12@60@1@6@@@@8,2@1@@@@@@------</Data>
</Node>
<Node><Sub>19</Sub>
<Data>12@66@1@1@@@@@1@@@@@@+</Data>
</Node>
<Node><Sub>20</Sub>
<Data>12@67@1@7@@@@8,2@1@@@@@@-------</Data>
</Node>
<Node><Sub>21</Sub>
<Data>12@74@1@1@@@@@1@@@@@@|</Data>
</Node>
</Node>
<Node><Sub>11</Sub>
<Node><Sub>1</Sub>
<Data>13@1@1@1@@@@7,1@1@@@@@@|</Data>
</Node>
<Node><Sub>2</Sub>
<Data>13@2@1@8@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>13@10@1@1@@@@7,1@1@@@@@@|</Data>
</Node>
<Node><Sub>4</Sub>
<Data>13@11@1@6@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>13@17@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>6</Sub>
<Data>13@18@1@6@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>7</Sub>
<Data>13@24@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>8</Sub>
<Data>13@25@1@6@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>9</Sub>
<Data>13@31@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>10</Sub>
<Data>13@32@1@6@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>11</Sub>
<Data>13@38@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>12</Sub>
<Data>13@39@1@6@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>13</Sub>
<Data>13@45@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>14</Sub>
<Data>13@46@1@6@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>15</Sub>
<Data>13@52@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>16</Sub>
<Data>13@53@1@6@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>17</Sub>
<Data>13@59@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>18</Sub>
<Data>13@60@1@6@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>19</Sub>
<Data>13@66@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>20</Sub>
<Data>13@67@1@7@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>21</Sub>
<Data>13@74@1@1@@@@7,1@1@@@@@@|</Data>
</Node>
</Node>
<Node><Sub>12</Sub>
<Node><Sub>1</Sub>
<Data>14@1@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>2</Sub>
<Data>14@2@1@8@@@@8,2@1@@@@@@---</Data>
</Node>
<Node><Sub>3</Sub>
<Data>14@10@1@1@@@@@1@@@@@@-</Data>
</Node>
<Node><Sub>4</Sub>
<Data>14@11@1@6@@@@8,2@1@@@@@@------</Data>
</Node>
<Node><Sub>5</Sub>
<Data>14@17@1@1@@@@@1@@@@@@+</Data>
</Node>
<Node><Sub>6</Sub>
<Data>14@18@1@6@@@@8,2@1@@@@@@------</Data>
</Node>
<Node><Sub>7</Sub>
<Data>14@24@1@1@@@@@1@@@@@@+</Data>
</Node>
<Node><Sub>8</Sub>
<Data>14@25@1@6@@@@8,2@1@@@@@@------</Data>
</Node>
<Node><Sub>9</Sub>
<Data>14@31@1@1@@@@@1@@@@@@+</Data>
</Node>
<Node><Sub>10</Sub>
<Data>14@32@1@6@@@@8,2@1@@@@@@------</Data>
</Node>
<Node><Sub>11</Sub>
<Data>14@38@1@1@@@@@1@@@@@@+</Data>
</Node>
<Node><Sub>12</Sub>
<Data>14@39@1@6@@@@8,2@1@@@@@@------</Data>
</Node>
<Node><Sub>13</Sub>
<Data>14@45@1@1@@@@@1@@@@@@+</Data>
</Node>
<Node><Sub>14</Sub>
<Data>14@46@1@6@@@@8,2@1@@@@@@------</Data>
</Node>
<Node><Sub>15</Sub>
<Data>14@52@1@1@@@@@1@@@@@@+</Data>
</Node>
<Node><Sub>16</Sub>
<Data>14@53@1@6@@@@8,2@1@@@@@@------</Data>
</Node>
<Node><Sub>17</Sub>
<Data>14@59@1@1@@@@@1@@@@@@+</Data>
</Node>
<Node><Sub>18</Sub>
<Data>14@60@1@6@@@@8,2@1@@@@@@------</Data>
</Node>
<Node><Sub>19</Sub>
<Data>14@66@1@1@@@@@1@@@@@@+</Data>
</Node>
<Node><Sub>20</Sub>
<Data>14@67@1@7@@@@8,2@1@@@@@@-------</Data>
</Node>
<Node><Sub>21</Sub>
<Data>14@74@1@1@@@@@1@@@@@@|</Data>
</Node>
</Node>
<Node><Sub>13</Sub>
<Node><Sub>1</Sub>
<Data>15@1@1@1@@@@7,1@1@@@@@@|</Data>
</Node>
<Node><Sub>2</Sub>
<Data>15@2@1@8@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>15@10@1@1@@@@7,1@1@@@@@@|</Data>
</Node>
<Node><Sub>4</Sub>
<Data>15@11@1@6@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>15@17@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>6</Sub>
<Data>15@18@1@6@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>7</Sub>
<Data>15@24@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>8</Sub>
<Data>15@25@1@6@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>9</Sub>
<Data>15@31@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>10</Sub>
<Data>15@32@1@6@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>11</Sub>
<Data>15@38@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>12</Sub>
<Data>15@39@1@6@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>13</Sub>
<Data>15@45@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>14</Sub>
<Data>15@46@1@6@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>15</Sub>
<Data>15@52@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>16</Sub>
<Data>15@53@1@6@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>17</Sub>
<Data>15@59@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>18</Sub>
<Data>15@60@1@6@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>19</Sub>
<Data>15@66@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>20</Sub>
<Data>15@67@1@7@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>21</Sub>
<Data>15@74@1@1@@@@7,1@1@@@@@@|</Data>
</Node>
</Node>
<Node><Sub>14</Sub>
<Node><Sub>1</Sub>
<Data>16@1@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>2</Sub>
<Data>16@2@1@8@@@@8,2@1@@@@@@---</Data>
</Node>
<Node><Sub>3</Sub>
<Data>16@10@1@1@@@@@1@@@@@@-</Data>
</Node>
<Node><Sub>4</Sub>
<Data>16@11@1@6@@@@8,2@1@@@@@@------</Data>
</Node>
<Node><Sub>5</Sub>
<Data>16@17@1@1@@@@@1@@@@@@+</Data>
</Node>
<Node><Sub>6</Sub>
<Data>16@18@1@6@@@@8,2@1@@@@@@------</Data>
</Node>
<Node><Sub>7</Sub>
<Data>16@24@1@1@@@@@1@@@@@@+</Data>
</Node>
<Node><Sub>8</Sub>
<Data>16@25@1@6@@@@8,2@1@@@@@@------</Data>
</Node>
<Node><Sub>9</Sub>
<Data>16@31@1@1@@@@@1@@@@@@+</Data>
</Node>
<Node><Sub>10</Sub>
<Data>16@32@1@6@@@@8,2@1@@@@@@------</Data>
</Node>
<Node><Sub>11</Sub>
<Data>16@38@1@1@@@@@1@@@@@@+</Data>
</Node>
<Node><Sub>12</Sub>
<Data>16@39@1@6@@@@8,2@1@@@@@@------</Data>
</Node>
<Node><Sub>13</Sub>
<Data>16@45@1@1@@@@@1@@@@@@+</Data>
</Node>
<Node><Sub>14</Sub>
<Data>16@46@1@6@@@@8,2@1@@@@@@------</Data>
</Node>
<Node><Sub>15</Sub>
<Data>16@52@1@1@@@@@1@@@@@@+</Data>
</Node>
<Node><Sub>16</Sub>
<Data>16@53@1@6@@@@8,2@1@@@@@@------</Data>
</Node>
<Node><Sub>17</Sub>
<Data>16@59@1@1@@@@@1@@@@@@+</Data>
</Node>
<Node><Sub>18</Sub>
<Data>16@60@1@6@@@@8,2@1@@@@@@------</Data>
</Node>
<Node><Sub>19</Sub>
<Data>16@66@1@1@@@@@1@@@@@@+</Data>
</Node>
<Node><Sub>20</Sub>
<Data>16@67@1@7@@@@8,2@1@@@@@@-------</Data>
</Node>
<Node><Sub>21</Sub>
<Data>16@74@1@1@@@@@1@@@@@@|</Data>
</Node>
</Node>
<Node><Sub>15</Sub>
<Node><Sub>1</Sub>
<Data>17@1@1@1@@@@7,1@1@@@@@@|</Data>
</Node>
<Node><Sub>2</Sub>
<Data>17@2@1@8@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>17@10@1@1@@@@7,1@1@@@@@@|</Data>
</Node>
<Node><Sub>4</Sub>
<Data>17@11@1@6@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>17@17@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>6</Sub>
<Data>17@18@1@6@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>7</Sub>
<Data>17@24@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>8</Sub>
<Data>17@25@1@6@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>9</Sub>
<Data>17@31@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>10</Sub>
<Data>17@32@1@6@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>11</Sub>
<Data>17@38@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>12</Sub>
<Data>17@39@1@6@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>13</Sub>
<Data>17@45@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>14</Sub>
<Data>17@46@1@6@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>15</Sub>
<Data>17@52@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>16</Sub>
<Data>17@53@1@6@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>17</Sub>
<Data>17@59@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>18</Sub>
<Data>17@60@1@6@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>19</Sub>
<Data>17@66@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>20</Sub>
<Data>17@67@1@7@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>21</Sub>
<Data>17@74@1@1@@@@7,1@1@@@@@@|</Data>
</Node>
</Node>
<Node><Sub>16</Sub>
<Node><Sub>1</Sub>
<Data>18@1@1@1@@@@@1@@@@@@=</Data>
</Node>
<Node><Sub>2</Sub>
<Data>18@2@1@8@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>18@10@1@1@@@@@1@@@@@@=</Data>
</Node>
<Node><Sub>4</Sub>
<Data>18@11@1@6@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>18@17@1@1@@@@@1@@@@@@=</Data>
</Node>
<Node><Sub>6</Sub>
<Data>18@18@1@6@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>7</Sub>
<Data>18@24@1@1@@@@@1@@@@@@=</Data>
</Node>
<Node><Sub>8</Sub>
<Data>18@25@1@6@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>9</Sub>
<Data>18@31@1@1@@@@@1@@@@@@=</Data>
</Node>
<Node><Sub>10</Sub>
<Data>18@32@1@6@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>11</Sub>
<Data>18@38@1@1@@@@@1@@@@@@=</Data>
</Node>
<Node><Sub>12</Sub>
<Data>18@39@1@6@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>13</Sub>
<Data>18@45@1@1@@@@@1@@@@@@=</Data>
</Node>
<Node><Sub>14</Sub>
<Data>18@46@1@6@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>15</Sub>
<Data>18@52@1@1@@@@@1@@@@@@=</Data>
</Node>
<Node><Sub>16</Sub>
<Data>18@53@1@6@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>17</Sub>
<Data>18@59@1@1@@@@@1@@@@@@=</Data>
</Node>
<Node><Sub>18</Sub>
<Data>18@60@1@6@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>19</Sub>
<Data>18@66@1@1@@@@@1@@@@@@=</Data>
</Node>
<Node><Sub>20</Sub>
<Data>18@67@1@7@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>21</Sub>
<Data>18@74@1@1@@@@@1@@@@@@=</Data>
</Node>
</Node>
<Node><Sub>FTR</Sub>
<Node><Sub>2</Sub>
<Node><Sub>2</Sub>
<Data>S d1=$TR($J(&quot;&quot;,20),&quot; &quot;,&quot;=&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$TR($J(&quot;&quot;,20),&quot; &quot;,&quot;=&quot;)</Data>
</Node>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$TR($J(&quot;&quot;,10),&quot; &quot;,&quot;|&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$TR($J(&quot;&quot;,10),&quot; &quot;,&quot;|&quot;)</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Data>S d1=$TR($J(&quot;&quot;,10),&quot; &quot;,&quot;|&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$TR($J(&quot;&quot;,10),&quot; &quot;,&quot;|&quot;)</Data>
</Node>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$TR($J(&quot;&quot;,5),&quot; &quot;,&quot;|&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$TR($J(&quot;&quot;,5),&quot; &quot;,&quot;|&quot;)</Data>
</Node>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>2</Sub>
<Data>S d1=$TR($J(&quot;&quot;,20),&quot; &quot;,&quot;-&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$TR($J(&quot;&quot;,20),&quot; &quot;,&quot;-&quot;)</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>STA</Sub>
<Data>6,14@1@1@13@-1@-1@8@46@</Data>
</Node>
</Node>
<Node><Sub>N8</Sub>
<Data><![CDATA[заготовка под таблицу,генерирующую кодификатор@@@@@1@1@1@1@22@80@1@@1@1@@1@@@1@@@@@@@@17@2@@1;6;35;44@@@@@@]]></Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@10@@@@@1@2;6;30;45@@@@@  коды</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@11@1@68@@@@@1@2;6;30;45@@@@@ расшифровки кодов@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@10@@@@@1@2;6;30;46@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>2@11@1@68@@@@@1@2;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@10@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@11@1@68@@@@@1@2;6;37;44@@@@@      Порядок создания кодификатора@</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>4@1@1@10@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>4@11@1@68@@@@@1@2;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>5@1@1@10@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>5@11@1@68@@@@@1@2;6;37;44@@@@@ - введите в 1 колонку коды вашего кодификатора@</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>6@1@1@10@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>6@11@1@68@@@@@1@2;6;37;44@@@@@ - введите во 2 колонку расшифровки кодов@</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>7@1@1@10@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>7@11@1@68@@@@@1@2;6;37;44@@@@@ - пометьте клавишей &lt;Ins&gt; или + коды и тексты@</Data>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>1</Sub>
<Data>8@1@1@10@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>8@11@1@68@@@@@1@2;6;37;44@@@@@ - установите указатель в колонку кодов и ...F6-СОЗДАТЬ-КОДИФИКАТОР@</Data>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>1</Sub>
<Data>9@1@1@10@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>9@11@1@68@@@@@1@2;6;37;44@@@@@ - ответьте на вопросы@</Data>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>1</Sub>
<Data>10@1@1@10@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>10@11@1@68@@@@@1@2;6;37;44@@@@@ - установите указатель в колонку текстов и F6-СОЗДАТЬ-КОДИФИКАТОР@</Data>
</Node>
</Node>
<Node><Sub>11</Sub>
<Node><Sub>1</Sub>
<Data>11@1@1@10@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>11@11@1@68@@@@@1@2;6;37;44@@@@@ - ответьте на вопросы и ваш кодификатор готов@</Data>
</Node>
</Node>
<Node><Sub>12</Sub>
<Node><Sub>1</Sub>
<Data>12@1@1@10@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>12@11@1@68@@@@@1@2;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>13</Sub>
<Node><Sub>1</Sub>
<Data>13@1@1@10@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>13@11@1@68@@@@@1@2;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>14</Sub>
<Node><Sub>1</Sub>
<Data>14@1@1@10@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>14@11@1@68@@@@@1@2;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>15</Sub>
<Node><Sub>1</Sub>
<Data>15@1@1@10@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>15@11@1@68@@@@@1@2;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>16</Sub>
<Node><Sub>1</Sub>
<Data>16@1@1@10@@@@@1@2;6;30;46@@@@@WW@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>16@11@1@68@@@@@1@2;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>17</Sub>
<Node><Sub>1</Sub>
<Data>17@1@1@10@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>17@11@1@68@@@@@1@2;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>59242,54037,MSW</Data>
</Node>
<Node><Sub>STA</Sub>
<Data>1,2@1@1@13@-1@-1@1@11@ расшифровки кодов</Data>
</Node>
</Node>
<Node><Sub>N9</Sub>
<Data><![CDATA[заготовка ...,генерирующая селектор MTBD@@@@@1@1@1@1@22@80@1@@1@1@@1@@@1@@@@@@@@17@2@@1;6;35;44@@@@@@]]></Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@2@20@@@@@1@2;6;30;45@@@@@  Данные ключа</Data>
</Node>
<Node><Sub>2</Sub>
<Data><![CDATA[1@21@2@60@@@@@1@2;6;30;45@@@@@  Ссылки на таблицы описывающие базы данных                      (^["GLAVK"]РАЗДЕЛ,ТАБЛИЦА)@]]></Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@20@@@@@1@2;6;30;46@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@21@1@60@@@@@1@2;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>4@1@1@20@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>4@21@1@60@@@@@1@2;6;37;44@@@@@      Порядок создания селектора@</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>5@1@1@20@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>5@21@1@60@@@@@1@2;6;37;44@@@@@       (аналогично создания кодификатора)@</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>6@1@1@20@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>6@21@1@60@@@@@1@2;6;37;44@@@@@ - введите в 1 колонку селектирующие данные ключа@</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>7@1@1@20@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>7@21@1@60@@@@@1@2;6;37;44@@@@@ - введите во 2 колонку Ссылки на таблицы базы@</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>8@1@1@20@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>8@21@1@60@@@@@1@2;6;37;44@@@@@ - пометьте клавишей &lt;Ins&gt; или + данные и ссылки@</Data>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>1</Sub>
<Data>9@1@1@20@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>9@21@1@60@@@@@1@2;6;37;44@@@@@ - установите указатель в колонку данных и F6-СОЗДАТЬ-КОДИФИКАТОР@</Data>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>1</Sub>
<Data>10@1@1@20@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>10@21@1@60@@@@@1@2;6;37;44@@@@@ - ответьте на вопросы@</Data>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>1</Sub>
<Data>11@1@1@20@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>11@21@1@60@@@@@1@2;6;37;44@@@@@ - установите указатель в колонку ссылок и F6-СОЗДАТЬ-КОДИФИКАТОР@</Data>
</Node>
</Node>
<Node><Sub>11</Sub>
<Node><Sub>1</Sub>
<Data>12@1@1@20@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>12@21@1@60@@@@@1@2;6;37;44@@@@@ - ответьте на вопросы и ваш селектор готов@</Data>
</Node>
</Node>
<Node><Sub>12</Sub>
<Node><Sub>1</Sub>
<Data>13@1@1@20@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>13@21@1@60@@@@@1@2;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>13</Sub>
<Node><Sub>1</Sub>
<Data>14@1@1@20@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>14@21@1@60@@@@@1@2;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>14</Sub>
<Node><Sub>1</Sub>
<Data>15@1@1@20@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>15@21@1@60@@@@@1@2;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>15</Sub>
<Node><Sub>1</Sub>
<Data>16@1@1@20@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>16@21@1@60@@@@@1@2;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>16</Sub>
<Node><Sub>1</Sub>
<Data>17@1@1@20@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>17@21@1@60@@@@@1@2;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>17</Sub>
<Node><Sub>1</Sub>
<Data>18@1@1@20@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>18@21@1@60@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>59242,54088,MSW</Data>
</Node>
<Node><Sub>STA</Sub>
<Data>2,1@1@1@13@-1@-1@3@1@</Data>
</Node>
</Node>
<Node><Sub>PARPRN</Sub>
<Data>параметры принтеров по-умолчанию@@@@@1@1@3@17@19@66@1@@1@1@@1@@2,2@1@@@@@1@@@9@2@@1;6;32;44@@@@@@@2</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@25@@@@@1@2;6;30;46@@@@@         ПАРАМЕТРЫ ПРИНТ-@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@26@1@25@@@@@1@2;6;30;46@@@@@СЕРВЕРОВ@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@2@25@@@@@1@@@@@@АВТОМАТИЧЕСКИЙ ЗАПУСК ПРИ___СТАРТЕ %BS (ИМЯ П-С)__@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>2@26@2@25@@@@0@1@1;6;31;44@@@@@???SEIKOSHA\MSW\3@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>4@1@2@25@@@@@1@@@@@@КОЛИЧЕСТВО СЕКУНД ОЖИДАТЬ_____ОТКЛИК СЕРВЕРА______@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>4@26@2@25@@@@2,2@1@1;6;31;44@@@@@10@</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>6@1@2@25@@@@@1@@@@@@ЧАСТОТА ПРОВЕРКИ ФЛАГА   __ПРИНТ-ЗАПРОСА (сек)____@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>6@26@2@25@@@@2,2@1@1;6;31;44@@@@@2@</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>8@1@2@25@@@@@1@@@@@@АВТОМАТИЧЕСКИЙ ОСТАНОВ   ___СЕРВЕРА ПОСЛЕ ПЕЧАТИ__@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>8@26@2@25@@@@2,2@1@1;6;31;44@@@@@Y@</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>10@1@2@25@@@@@1@@@@@@РАЗМЕР MSM РАЗДЕЛА ПРИ   __СТАРТЕ СЕРВЕРА (байт)__@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>10@26@2@25@@@@2,2@1@1;6;31;44@@@@@4000@</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>12@1@2@25@@@@@1@@@@@@АВТОМАТОМ УДАЛЯТЬ ИСПОЛЬ-_____ЗОВАННЫЕ БУФЕРА_____@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>12@26@2@25@@@@2,2@1@1;6;31;44@@@@@N@</Data>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>1</Sub>
<Data>14@1@2@25@@@@@1@@@@@@ТРАНСЛИРОВАТЬ ПСКЕВДОГРА-__________ФИКУ___________@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>14@26@2@25@@@@@1@1;6;31;44@@@@@||||||--|+||==||=--=-=--==-====-=---==-@</Data>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>1</Sub>
<Data>16@1@2@25@@@@@1@@@@@@НА КАКИЕ СИМВОЛЫ ТРАНСЛИ-__РОВАТЬ ПСКЕВДОГРАФИКУ__@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>16@26@2@25@@@@@1@1;6;31;44@@@@@||||||--|+||==||=-=-|=--==-====-=---==-@</Data>
</Node>
</Node>
<Node><Sub>FTR</Sub>
<Node><Sub>2</Sub>
<Node><Sub>2</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>STA</Sub>
<Data>9,2@2@2@13@-1@-1@18@42@||||||--|+||==||=-=-|=--==-====-=---==-</Data>
</Node>
</Node>
<Node><Sub>PRNDFLT</Sub>
<Data><![CDATA[ПАРАМЕТРЫ ПРИНТЕРА ПО-УМОЛЧАНИЮ@@@@@1@1@2@10@20@52@1@@1@@@1@@3,2@@@@@@@@@19@2@@2;6;30;45@@@@@@@2@@@@@1]]></Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@27@1@@@@1@2;6;30;45@@@@@ПАРАМЕТРЫ УСТРОЙСТВА ПЕЧАТИ</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@28@1@16@1@@@@1@2;6;30;45@@@@@ ПО-УМОЛЧАНИЮ</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@27@1@@@0@1@2;6;30;45@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>2@28@1@16@1@@@2,1@1@2;6;30;45@@@@@@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@27@1@@@@1@2;6;35;46@@@@@  80 СИМВОЛОВ В СТРОКЕ ..@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@28@1@16@@@@@1@1;6;34;46@@@@@27,80@</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>4@1@1@27@1@@@@1@2;6;35;46@@@@@  90 ....................@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>4@28@1@16@@@@@1@1;6;34;46@@@@@27,77@</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>5@1@1@27@1@@@@1@2;6;35;46@@@@@  132 ...................@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>5@28@1@16@@@@@1@1;6;34;46@@@@@27,80,15@</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>6@1@1@27@1@@@@1@2;6;35;46@@@@@  160 ...................@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>6@28@1@16@@@@@1@1;6;34;46@@@@@27,77,15@</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>7@1@1@27@1@@@@1@2;6;35;46@@@@@  70 СТРОК НА СТРАНИЦЕ ..</Data>
</Node>
<Node><Sub>2</Sub>
<Data>7@28@1@16@@@@@1@1;6;34;46@@@@@27,51,33</Data>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>1</Sub>
<Data>8@1@1@27@1@@@@1@2;6;35;46@@@@@  30 ....................</Data>
</Node>
<Node><Sub>2</Sub>
<Data>8@28@1@16@@@@@1@1;6;34;46@@@@@27,51,74</Data>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>1</Sub>
<Data>9@1@1@27@1@@@@1@2;6;35;46@@@@@  60 ....................@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>9@28@1@16@@@@@1@1;6;34;46@@@@@27,51,39@</Data>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>1</Sub>
<Data>10@1@1@27@1@@@@1@2;6;35;46@@@@@  100 ...................@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>10@28@1@16@@@@@1@1;6;34;46@@@@@27,51,23@</Data>
</Node>
</Node>
<Node><Sub>11</Sub>
<Node><Sub>1</Sub>
<Data>11@1@1@27@1@@@@1@2;6;35;46@@@@@  130 ...................@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>11@28@1@16@@@@@1@1;6;34;46@@@@@27,51,18@</Data>
</Node>
</Node>
<Node><Sub>12</Sub>
<Node><Sub>1</Sub>
<Data>12@1@1@27@1@@@@1@2;6;35;46@@@@@  250 ...................@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>12@28@1@16@@@@@1@1;6;34;46@@@@@27,51,10@</Data>
</Node>
</Node>
<Node><Sub>13</Sub>
<Node><Sub>1</Sub>
<Data>13@1@1@27@1@@@@1@2;6;35;46@@@@@  ДВОЙНОЕ КАЧЕСТВО ПЕЧАТИ@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>13@28@1@16@@@@@1@1;6;34;46@@@@@27,69@</Data>
</Node>
</Node>
<Node><Sub>14</Sub>
<Node><Sub>1</Sub>
<Data>14@1@1@27@1@@@@1@2;6;35;46@@@@@  ОБЫЧНОЕ КАЧЕСТВО@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>14@28@1@16@@@@@1@1;6;34;46@@@@@27,68@</Data>
</Node>
</Node>
<Node><Sub>15</Sub>
<Node><Sub>1</Sub>
<Data>15@1@1@27@1@@@@1@2;6;35;46@@@@@          СБРОС УСТАНОВОК@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>15@28@1@16@@@@@1@1;6;34;46@@@@@27,80,27,51,39@</Data>
</Node>
</Node>
<Node><Sub>16</Sub>
<Node><Sub>1</Sub>
<Data>16@1@1@27@1@@@2,1@1@2;6;30;45@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>16@28@1@16@1@@@2,1@1@2;6;30;45@@@@@@</Data>
</Node>
</Node>
<Node><Sub>17</Sub>
<Node><Sub>1</Sub>
<Data>17@1@1@27@@@@@1@2;6;35;46@@@@@    УСТРОЙСТВО ВЫВОДА@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>17@28@1@16@@@@@1@1;6;34;46@@@@PRN,^%ZAPM.ed.BSJPRN,,,,&lt;&gt;@2@</Data>
</Node>
</Node>
<Node><Sub>18</Sub>
<Node><Sub>1</Sub>
<Data>18@1@1@27@1@@@@1@2;6;35;46@@@@@ МАКС.КОЛ-ВО СИМВОЛОВ@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>18@28@1@16@@@@@1@1;6;34;46@@@@@511@</Data>
</Node>
</Node>
<Node><Sub>19</Sub>
<Node><Sub>1</Sub>
<Data>19@1@1@27@@@@@1@2;6;35;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>19@28@1@16@@@@@1@1;6;34;46@@@@@@</Data>
</Node>
</Node>
<Node><Sub>FCL</Sub>
<Node><Sub>17</Sub>
<Node><Sub>2</Sub>
<Data>S d1=$S($O(^%ZAPM.ed.BS(&quot;LPT&quot;,&quot;&quot;))=&quot;&quot;:&quot;?&quot;,1:$O(^%ZAPM.ed.BS(&quot;LPT&quot;,&quot;&quot;)))</Data>
<Node><Sub>1</Sub>
<Data>$S($O(^%ZAPM.ed.BS(&quot;LPT&quot;,&quot;&quot;))=&quot;&quot;:&quot;?&quot;,1:$O(^%ZAPM.ed.BS(&quot;LPT&quot;,&quot;&quot;)))</Data>
</Node>
</Node>
</Node>
<Node><Sub>19</Sub>
<Node><Sub>2</Sub>
<Data>S d1=$ZU(1,0)</Data>
<Node><Sub>1</Sub>
<Data>$ZU(1,0)</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>FTR</Sub>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$TR($J(&quot;&quot;,27),&quot; &quot;,&quot;=&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$TR($J(&quot;&quot;,27),&quot; &quot;,&quot;=&quot;)</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>Free</Sub>
<Data>56819,49693</Data>
</Node>
<Node><Sub>LST</Sub>
<Data>59467,71331,MSW</Data>
</Node>
<Node><Sub>STA</Sub>
<Data>,@3@2@27@-1@-1@19@37@511</Data>
<Node><Sub>0</Sub>
<Data>20</Data>
</Node>
<Node><Sub>2</Sub>
<DataBase64>IF7PXsBe0F7AXsxexV7SXtBe214gXs9exV7XXsBe0l7IXiBewl4gXtRezl7QXsxewF7SXsVeIF4g
XiReQ14oXlNeUl4pXiBeIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAH
IAcgBw==
</DataBase64>
</Node>
<Node><Sub>3</Sub>
<DataBase64>IF4gXi1eLV4tXi1eLV4tXi1eLV4tXi1eLV4tXi1eLV4tXi1eLV4tXi1eLV4tXi1eLV4tXi1eLV4t
Xi1eLV4tXi1eLV4gXiBeIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAH
IAcgBw==
</DataBase64>
</Node>
<Node><Sub>4</Sub>
<DataBase64>IDUgNSA1ODUwNSA10TXINcw1wjXONcs1zjXCNSA1wjUgNdE10jXQNc41yjXFNSA1LjUuNSA1Mng3
eCx4OHgweCB4IHggeCB4IAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAH
IAcgBw==
</DataBase64>
</Node>
<Node><Sub>5</Sub>
<DataBase64>IDUgNSA1OTUwNSA1LjUuNS41LjUuNS41LjUuNS41LjUuNS41LjUuNS41LjUuNS41LjUuNSA1Mjk3
OSw5Nzk3OSA5IDkgOSA5IAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAH
IAcgBw==
</DataBase64>
</Node>
<Node><Sub>6</Sub>
<DataBase64>IDUgNSA1MTUzNTI1IDUuNS41LjUuNS41LjUuNS41LjUuNS41LjUuNS41LjUuNS41LjUuNSA1Mjk3
OSw5ODkwOSw5MTk1OSA5IAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAH
IAcgBw==
</DataBase64>
</Node>
<Node><Sub>7</Sub>
<DataBase64>IDUgNSA1MTU2NTA1IDUuNS41LjUuNS41LjUuNS41LjUuNS41LjUuNS41LjUuNS41LjUuNSA1Mjk3
OSw5Nzk3OSw5MTk1OSA5IAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAH
IAcgBw==
</DataBase64>
</Node>
<Node><Sub>8</Sub>
<DataBase64>IDUgNSA1NzUwNSA10TXSNdA1zjXKNSA1zTXANSA10TXSNdA1wDXNNcg11jXFNSA1LjUuNSA1Mjk3
OSw5NTkxOSw5MzkzOSA5IAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAH
IAcgBw==
</DataBase64>
</Node>
<Node><Sub>9</Sub>
<DataBase64>IDUgNSA1MzUwNSA1LjUuNS41LjUuNS41LjUuNS41LjUuNS41LjUuNS41LjUuNS41LjUuNSA1Mjk3
OSw5NTkxOSw5Nzk0OSA5IAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAH
IAcgBw==
</DataBase64>
</Node>
<Node><Sub>10</Sub>
<DataBase64>IDUgNSA1NjUwNSA1LjUuNS41LjUuNS41LjUuNS41LjUuNS41LjUuNS41LjUuNS41LjUuNSA1Mjk3
OSw5NTkxOSw5Mzk5OSA5IAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAH
IAcgBw==
</DataBase64>
</Node>
<Node><Sub>11</Sub>
<DataBase64>IDUgNSA1MTUwNTA1IDUuNS41LjUuNS41LjUuNS41LjUuNS41LjUuNS41LjUuNS41LjUuNSA1Mjk3
OSw5NTkxOSw5MjkzOSA5IAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAH
IAcgBw==
</DataBase64>
</Node>
<Node><Sub>12</Sub>
<DataBase64>IDUgNSA1MTUzNTA1IDUuNS41LjUuNS41LjUuNS41LjUuNS41LjUuNS41LjUuNS41LjUuNSA1Mjk3
OSw5NTkxOSw5MTk4OSA5IAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAH
IAcgBw==
</DataBase64>
</Node>
<Node><Sub>13</Sub>
<DataBase64>IDUgNSA1MjU1NTA1IDUuNS41LjUuNS41LjUuNS41LjUuNS41LjUuNS41LjUuNS41LjUuNSA1Mjk3
OSw5NTkxOSw5MTkwOSA5IAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAH
IAcgBw==
</DataBase64>
</Node>
<Node><Sub>14</Sub>
<DataBase64>IDUgNSA1xDXCNc41yTXNNc41xTUgNco1wDXXNcU10TXSNcI1zjUgNc81xTXXNcA10jXINSA1Mjk3
OSw5Njk5OSA5IDkgOSA5IAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAH
IAcgBw==
</DataBase64>
</Node>
<Node><Sub>15</Sub>
<DataBase64>IAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcg
ByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAH
IAcgBw==
</DataBase64>
</Node>
<Node><Sub>16</Sub>
<DataBase64>IAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcg
ByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAH
IAcgBw==
</DataBase64>
</Node>
<Node><Sub>17</Sub>
<DataBase64>IAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcg
ByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAH
IAcgBw==
</DataBase64>
</Node>
<Node><Sub>18</Sub>
<DataBase64>IAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcg
ByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAH
IAcgBw==
</DataBase64>
</Node>
<Node><Sub>19</Sub>
<DataBase64>IAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcg
ByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAH
IAcgBw==
</DataBase64>
</Node>
<Node><Sub>20</Sub>
<DataBase64>IAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcg
ByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAH
IAcgBw==
</DataBase64>
</Node>
<Node><Sub>21</Sub>
<DataBase64>IAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcg
ByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAH
IAcgBw==
</DataBase64>
</Node>
<Node><Sub>22</Sub>
<DataBase64>IAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcg
ByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAH
IAcgBw==
</DataBase64>
</Node>
</Node>
</Node>
<Node><Sub>PanButt</Sub>
<Data><![CDATA[Панель с кнопками@@@@@1@1@1@1@22@80@1@@1@1@@8@@@1@@@@@@@@4@4@@2;6;30;46@@@@@@@@^%ZAPM.ed.BSHLP("HELP-ALTF2")]]></Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@10@@@@@1@2;6;30;46@@@@@              Пpимеp пpименения панели.@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@11@1@10@@@@@1@1;6;37;44@@@0@^%ZAPM.ed.BSDFLT(&quot;N3&quot;)@ ONE @</Data>
</Node>
<Node><Sub>3</Sub>
<Data>1@21@1@10@@@@@1@@@@@@1@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>1@31@1@10@@@@@1@@@@@@GO@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@10@@@@@1@@@@@@Кнопкой 1 вызывается таблица N3</Data>
</Node>
<Node><Sub>2</Sub>
<Data>2@11@1@10@@@@@1@1;6;36;41@@@@^%ZAPM.ed.BSDFLT(&quot;N7&quot;)@ TWO @</Data>
</Node>
<Node><Sub>3</Sub>
<Data>2@21@1@10@@@@@1@@@@@@2@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>2@31@1@10@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@10@@@@@1@@@@@@Кнопкой 2 вызывается таблица N7 с возвратом в панель@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@11@1@10@@@@@1@@@@@@ ОТМЕНА @</Data>
</Node>
<Node><Sub>3</Sub>
<Data>3@21@1@10@@@@@1@@@@@@0@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>3@31@1@10@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>4@1@1@10@@@@@1@@@@@@Для редактирования параметров панели введите &lt;ALT-F&gt;@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>4@11@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>4@21@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>4@31@1@10@@@@@1@2;5;31;46@@@@@Нажми &lt;F1&gt;@</Data>
</Node>
</Node>
<Node><Sub>BUT</Sub>
<Data>Панель с кнопками/2;6;30;46</Data>
<Node><Sub>0</Sub>
<Data>2;6;30;46</Data>
<Node><Sub>1</Sub>
<Data>              Пpимеp пpименения панели.</Data>
<Node><Sub>1</Sub>
<Data>2;6;30;46</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Data>Кнопкой 1 вызывается таблица N3</Data>
</Node>
<Node><Sub>3</Sub>
<Data>Кнопкой 2 вызывается таблица N7 с возвратом в панель</Data>
</Node>
<Node><Sub>4</Sub>
<Data>Для редактирования параметров панели введите &lt;ALT-F&gt;</Data>
</Node>
</Node>
<Node><Sub>1</Sub>
<Data>1;6;37;44/1;6;36;41</Data>
<Node><Sub>1</Sub>
<Data> ONE </Data>
</Node>
<Node><Sub>2</Sub>
<Data> TWO </Data>
</Node>
<Node><Sub>3</Sub>
<Data> ОТМЕНА </Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Data>1</Data>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>^%ZAPM.ed.BSDFLT,N3</Data>
</Node>
<Node><Sub>2</Sub>
<Data>^%ZAPM.ed.BSDFLT,N7</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>1</Data>
</Node>
<Node><Sub>2</Sub>
<Data>2</Data>
</Node>
<Node><Sub>3</Sub>
<Data>0</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>1</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>0</Data>
</Node>
<Node><Sub>2</Sub>
<Data>0</Data>
</Node>
</Node>
</Node>
<Node><Sub>COL</Sub>
<Node><Sub>1</Sub>
<Node><Sub>2</Sub>
<Data>S d1=1</Data>
<Node><Sub>1</Sub>
<Data>1</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>STA</Sub>
<Data>,@1@1@13@-1@-1@1@1@              Пpимеp пpименения панели.</Data>
</Node>
</Node>
<Node><Sub>ProgEdit</Sub>
<Data><![CDATA[Описание pедактоpа пpогpамм@@@@@@@1@1@22@80@@11111111@@1@@5@@@@@@@@@@@2@510@@1;6;37;40//2;6;32;40//1;6;37;40/2;6;33;40/2;6;33;40////32@@@@@@@1@]]></Data>
<Node><Sub>1</Sub>
<Data>SDSDSD    ;ASASAS</Data>
</Node>
<Node><Sub>2</Sub>
<Data>QQQ ;ASASAS</Data>
</Node>
</Node>
<Node><Sub>Screen</Sub>
<Data><![CDATA[заготовка очень маленькой таблицы (1x1)@@@@@@@1@1@22@80@@01111100@@1@@5@@@@@@@@@@@1@510@@2;6;30;46//1;6;36;40////////32@@@@@@@1]]></Data>
<Node><Sub>1</Sub>
<Data></Data>
</Node>
</Node>
<Node><Sub>TextEdit</Sub>
<Data><![CDATA[Описание pедактоpа текста@@@@@@@1@1@22@80@@111111@@1@@5@@@@@@@@@@@1@510@@2;6;30;46//1;6;36;40////////32@@@@@@@1]]></Data>
<Node><Sub>1</Sub>
<Data></Data>
</Node>
</Node>
<Node><Sub>TextLine</Sub>
<Data><![CDATA[Строчный редактор в редакторе текста@@@@@@@20@1@22@80@@1111111@@1@@5@@@@@@@@@@@1@510@@2;6;36;44///2;6;36;44/1;6;37;44//////32@@@@@@@1]]></Data>
<Node><Sub>1</Sub>
<Data></Data>
</Node>
</Node>
<Node><Sub>Variables</Sub>
<Data><![CDATA[ТАБЛИЦА СКВОЗНЫХ ЛОКАЛЬНЫХ ПЕРЕМЕННЫХ@@@@@1@1@1@1@22@80@1@@1@1@@1@@2,1@1@@@@@@@@27@3@@1;6;35;44@@@@@@]]></Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@15@@@@@1@2;6;30;46@@@@@ имя перем.</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@16@1@15@@@@@1@2;6;30;45@@@@@   значение@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>1@31@1@50@@@@@1@2;6;37;44@@@@@      комментарий@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@15@@@@@1@2;6;30;46@@@@@vl(0)</Data>
</Node>
<Node><Sub>2</Sub>
<Data>2@16@1@15@@@1@@1@2;6;30;45@@@@@200313@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>2@31@1@50@@@@@1@2;6;37;44@@@@@ТЕКУЩИЙ ДЕНЬ (ГГММДД)@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@15@@@@@1@2;6;30;46@@@@@vl(1)@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@16@1@15@@@1@@1@2;6;30;45@@@@@20@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>3@31@1@50@@@@@1@2;6;37;44@@@@@ТЕКУЩИЙ ГОД@</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>4@1@1@15@@@@@1@2;6;30;46@@@@@vl(2)@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>4@16@1@15@@@1@@1@2;6;30;45@@@@@19@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>4@31@1@50@@@@@1@2;6;37;44@@@@@ГОД НАЗАД@</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>5@1@1@15@@@@@1@2;6;30;46@@@@@vl(3)@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>5@16@1@15@@@1@@1@2;6;30;45@@@@@18@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>5@31@1@50@@@@@1@2;6;37;44@@@@@2 ГОДА НАЗАД@</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>6@1@1@15@@@@@1@2;6;30;46@@@@@vl(11)@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>6@16@1@15@@@1@@1@2;6;30;45@@@@@200301@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>6@31@1@50@@@@@1@2;6;37;44@@@@@НАЧАЛО ТЕКУЩЕГО МЕСЯЦА@</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>7@1@1@15@@@@@1@2;6;30;46@@@@@vl(12)@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>7@16@1@15@@@1@@1@2;6;30;45@@@@@200328@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>7@31@1@50@@@@@1@2;6;37;44@@@@@КОНЕЦ ТЕКУЩЕГО МЕСЯЦА@</Data>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>1</Sub>
<Data>8@1@1@15@@@@@1@2;6;30;46@@@@@vl(21)@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>8@16@1@15@@@1@@1@2;6;30;45@@@@@202001@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>8@31@1@50@@@@@1@2;6;37;44@@@@@НАЧАЛО ПРЕДИДУЩЕГО МЕСЯЦА@</Data>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>1</Sub>
<Data>9@1@1@15@@@@@1@2;6;30;46@@@@@vl(22)@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>9@16@1@15@@@1@@1@2;6;30;45@@@@@202028@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>9@31@1@50@@@@@1@2;6;37;44@@@@@КОНЕЦ ПРЕДИДУЩЕГО МЕСЯЦА@</Data>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>1</Sub>
<Data>10@1@1@15@@@@@1@2;6;30;46@@@@@vl(31)@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>10@16@1@15@@@1@@1@2;6;30;45@@@@@201901@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>10@31@1@50@@@@@1@2;6;37;44@@@@@НАЧАЛО ПРЕДИДУЩЕГО МЕСЯЦА ПРЕД-ГО ГОДА@</Data>
</Node>
</Node>
<Node><Sub>11</Sub>
<Node><Sub>1</Sub>
<Data>11@1@1@15@@@@@1@2;6;30;46@@@@@vl(32)@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>11@16@1@15@@@1@@1@2;6;30;45@@@@@201928@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>11@31@1@50@@@@@1@2;6;37;44@@@@@КОНЕЦ ПРЕДИДУЩЕГО МЕСЯЦА ПРЕД-ГО ГОДА@</Data>
</Node>
</Node>
<Node><Sub>12</Sub>
<Node><Sub>1</Sub>
<Data>12@1@1@15@@@@@1@2;6;30;46@@@@@vl(4)@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>12@16@1@15@@@1@@1@2;6;30;45@@@@@13032021@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>12@31@1@50@@@@@1@2;6;37;44@@@@@ТЕКУЩИЙ ДЕНЬ (ДДММГГ)@</Data>
</Node>
</Node>
<Node><Sub>13</Sub>
<Node><Sub>1</Sub>
<Data>13@1@1@15@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>13@16@1@15@@@@@1@2;6;30;45@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>13@31@1@50@@@@@1@2;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>14</Sub>
<Node><Sub>1</Sub>
<Data>14@1@1@15@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>14@16@1@15@@@@@1@2;6;30;45@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>14@31@1@50@@@@@1@2;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>15</Sub>
<Node><Sub>1</Sub>
<Data>15@1@1@15@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>15@16@1@15@@@@@1@2;6;30;45@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>15@31@1@50@@@@@1@2;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>16</Sub>
<Node><Sub>1</Sub>
<Data>16@1@1@15@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>16@16@1@15@@@@@1@2;6;30;45@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>16@31@1@50@@@@@1@2;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>17</Sub>
<Node><Sub>1</Sub>
<Data>17@1@1@15@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>17@16@1@15@@@@@1@2;6;30;45@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>17@31@1@50@@@@@1@2;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>18</Sub>
<Node><Sub>1</Sub>
<Data>18@1@1@15@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>18@16@1@15@@@@@1@2;6;30;45@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>18@31@1@50@@@@@1@2;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>19</Sub>
<Node><Sub>1</Sub>
<Data>19@1@1@15@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>19@16@1@15@@@@@1@2;6;30;45@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>19@31@1@50@@@@@1@2;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>20</Sub>
<Node><Sub>1</Sub>
<Data>20@1@1@15@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>20@16@1@15@@@@@1@2;6;30;45@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>20@31@1@50@@@@@1@2;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>21</Sub>
<Node><Sub>1</Sub>
<Data>21@1@1@15@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>21@16@1@15@@@@@1@2;6;30;45@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>21@31@1@50@@@@@1@2;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>22</Sub>
<Node><Sub>1</Sub>
<Data>22@1@1@15@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>22@16@1@15@@@@@1@2;6;30;45@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>22@31@1@50@@@@@1@2;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>23</Sub>
<Node><Sub>1</Sub>
<Data>23@1@1@15@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>23@16@1@15@@@@@1@2;6;30;45@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>23@31@1@50@@@@@1@2;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>24</Sub>
<Node><Sub>1</Sub>
<Data>24@1@1@15@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>24@16@1@15@@@@@1@2;6;30;45@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>24@31@1@50@@@@@1@2;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>25</Sub>
<Node><Sub>1</Sub>
<Data>25@1@1@15@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>25@16@1@15@@@@@1@2;6;30;45@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>25@31@1@50@@@@@1@2;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>26</Sub>
<Node><Sub>1</Sub>
<Data>26@1@1@15@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>26@16@1@15@@@@@1@2;6;30;45@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>26@31@1@50@@@@@1@2;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>27</Sub>
<Node><Sub>1</Sub>
<Data>27@1@1@15@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>27@16@1@15@@@@@1@2;6;30;45@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>27@31@1@50@@@@@1@2;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>FCL</Sub>
<Node><Sub>2</Sub>
<Node><Sub>2</Sub>
<Data><![CDATA[S d1=$E($TR($$ESDAY^%ZAPM.ed.BSsFUNR(6,$H),".",""),5,6)_$E($TR($$ESDAY^%ZAPM.ed.BSsFUNR(6,$H),".",""),3,4)_$E($TR($$ESDAY^%ZAPM.ed.BSsFUNR(6,$H),".",""),1,2) S vl(0)=d1]]></Data>
<Node><Sub>1</Sub>
<Data><![CDATA[$E($TR($$ESDAY(6,$H),".",""),5,6)_$E($TR($$ESDAY(6,$H),".",""),3,4)_$E($TR($$ESDAY(6,$H),".",""),1,2) S vl(0)=d1]]></Data>
</Node>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>2</Sub>
<Data>S d1=$E($TR($$ESDAY^%ZAPM.ed.BSsFUNR(6,$H),&quot;.&quot;,&quot;&quot;),5,6) S vl(1)=d1</Data>
<Node><Sub>1</Sub>
<Data>$E($TR($$ESDAY(6,$H),&quot;.&quot;,&quot;&quot;),5,6) S vl(1)=d1</Data>
</Node>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>2</Sub>
<Data>S d1=vl(1)-1 S vl(2)=d1 I d1&lt;0 S (vl(2),d1)=&quot;99&quot;</Data>
<Node><Sub>1</Sub>
<Data>vl(1)-1 S vl(2)=d1 I d1&lt;0 S (vl(2),d1)=&quot;99&quot;</Data>
</Node>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>2</Sub>
<Data>S d1=vl(1)-2 S vl(3)=d1 I d1&lt;0 S (vl(3),d1)=&quot;99&quot;</Data>
<Node><Sub>1</Sub>
<Data>vl(1)-2 S vl(3)=d1 I d1&lt;0 S (vl(3),d1)=&quot;99&quot;</Data>
</Node>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>2</Sub>
<Data>S d1=$E(vl(0),1,4)_&quot;01&quot; S vl(11)=d1</Data>
<Node><Sub>1</Sub>
<Data>$E(vl(0),1,4)_&quot;01&quot; S vl(11)=d1</Data>
</Node>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>2</Sub>
<Data>S d1=$E(vl(0),1,4)_&quot;28&quot; S vl(12)=d1</Data>
<Node><Sub>1</Sub>
<Data>$E(vl(0),1,4)_&quot;28&quot; S vl(12)=d1</Data>
</Node>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>2</Sub>
<Data>S d1=$E($$DatGuKBB^%ZAPM.ed.BSMDDR1(&quot;11&quot;_$E(vl(0),3,4)_$E(vl(0),1,2)),1,4)_&quot;01&quot; S vl(21)=d1</Data>
<Node><Sub>1</Sub>
<Data>$E($$DatGuKBB^%ZAPM.ed.BSMDDR1(&quot;11&quot;_$E(vl(0),3,4)_$E(vl(0),1,2)),1,4)_&quot;01&quot; S vl(21)=d1</Data>
</Node>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>2</Sub>
<Data>S d1=$E($$DatGuKBB^%ZAPM.ed.BSMDDR1(&quot;11&quot;_$E(vl(0),3,4)_$E(vl(0),1,2)),1,4)_&quot;28&quot; S vl(22)=d1</Data>
<Node><Sub>1</Sub>
<Data>$E($$DatGuKBB^%ZAPM.ed.BSMDDR1(&quot;11&quot;_$E(vl(0),3,4)_$E(vl(0),1,2)),1,4)_&quot;28&quot; S vl(22)=d1</Data>
</Node>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>2</Sub>
<Data>S d1=$E($$DatGuKBB^%ZAPM.ed.BSMDDR1(&quot;11&quot;_$E(vl(0),3,4)_$E(vl(2),1,2)),1,4)_&quot;01&quot; S vl(31)=d1</Data>
<Node><Sub>1</Sub>
<Data>$E($$DatGuKBB^%ZAPM.ed.BSMDDR1(&quot;11&quot;_$E(vl(0),3,4)_$E(vl(2),1,2)),1,4)_&quot;01&quot; S vl(31)=d1</Data>
</Node>
</Node>
</Node>
<Node><Sub>11</Sub>
<Node><Sub>2</Sub>
<Data>S d1=$E($$DatGuKBB^%ZAPM.ed.BSMDDR1(&quot;11&quot;_$E(vl(0),3,4)_$E(vl(2),1,2)),1,4)_&quot;28&quot; S vl(32)=d1</Data>
<Node><Sub>1</Sub>
<Data>$E($$DatGuKBB^%ZAPM.ed.BSMDDR1(&quot;11&quot;_$E(vl(0),3,4)_$E(vl(2),1,2)),1,4)_&quot;28&quot; S vl(32)=d1</Data>
</Node>
</Node>
</Node>
<Node><Sub>12</Sub>
<Node><Sub>2</Sub>
<Data>S d1=$TR($$ESDAY^%ZAPM.ed.BSsFUNR(6,$H),&quot;.&quot;,&quot;&quot;) S vl(4)=d1</Data>
<Node><Sub>1</Sub>
<Data>$TR($$ESDAY(6,$H),&quot;.&quot;,&quot;&quot;) S vl(4)=d1</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>59242,54234,MSW</Data>
</Node>
<Node><Sub>STA</Sub>
<Data>12,2@2@1@13@-1@-1@2@31@13032021</Data>
</Node>
</Node>
</Node>
</Global>


<Global>
<Node><Sub>^%ZAPM.ed.BSCER</Sub>
<Data>ТЕКСТЫ ПРЕРЫВАНИЙ ВЫПОЛНЕНИЯ ПРОГРАММ</Data>
<Node><Sub>&lt;COMMAND</Sub>
<Data>НЕДОПУСТИМАЯ КОМАНДА</Data>
</Node>
<Node><Sub>&lt;EDITED</Sub>
<Data>ВЫПОЛНЯЕМАЯ ПРОГРАММА ПОДВЕРГЛАСЬ РЕДАКТИРОВАНИЮ</Data>
</Node>
<Node><Sub>&lt;FRAMESTACK</Sub>
<Data>ПЕРЕПОЛНЕНИЕ СТЭКА ПРОГРАММЫ</Data>
</Node>
<Node><Sub>&lt;ILLEGAL VALUE</Sub>
<Data>НЕДОПУСТИМОЕ ЗНАЧЕНИЕ В ИНДЕКСЕ ПЕРЕМЕННОЙ</Data>
</Node>
<Node><Sub>&lt;LABELREDEF</Sub>
<Data>ДУБЛИРОВАНИЕ МЕТОК В ПРОГРАММЕ</Data>
</Node>
<Node><Sub>&lt;MAXSTRING</Sub>
<Data>ПРЕВЫШЕНИЕ ДЛИНЫ ПЕРЕМЕННОЙ</Data>
</Node>
<Node><Sub>&lt;NAMESPACE</Sub>
<Data>НЕСУЩЕСТВУЩАЯ ИМЕННАЯ ОБЛАСТЬ</Data>
</Node>
<Node><Sub>&lt;NOLINE</Sub>
<Data>НЕСУЩЕСТВУЮЩАЯ МЕТКА В ПРОГРАММЕ</Data>
</Node>
<Node><Sub>&lt;NOROUTINE</Sub>
<Data>НЕСУЩЕСТВУЮЩАЯ ПРОГРАММА</Data>
</Node>
<Node><Sub>&lt;NOSYS</Sub>
<Data>НЕСУЩЕСТВУЮЩАЯ ИМЕННАЯ ОБЛАСТЬ</Data>
</Node>
<Node><Sub>&lt;NOTOPEN</Sub>
<Data>УСТРОЙСТВО НЕ ОТКРЫТО</Data>
</Node>
<Node><Sub>&lt;PARAMET</Sub>
<Data>ОТСУТСТВЕТ СПИСОК ФОРМАЛЬНЫХ ПЕРЕМЕННЫХ</Data>
</Node>
<Node><Sub>&lt;STORE</Sub>
<Data>ПЕРЕПОЛНЕНИЕ ОБЛАСТИ ЛОКАЛЬНЫХ ПЕРЕМЕННЫХ</Data>
</Node>
<Node><Sub>&lt;SYNTAX</Sub>
<Data>СИНТАКСИЧЕСКАЯ ОШИБКА В ПРОГРАММЕ</Data>
</Node>
<Node><Sub>&lt;TERMINATOR</Sub>
<Data>ОШИБКА ?</Data>
</Node>
<Node><Sub>&lt;UNDEFINED</Sub>
<Data>НЕОПРЕДЕЛЕННАЯ ПЕРЕМЕННАЯ</Data>
</Node>
<Node><Sub>&lt;WRITE</Sub>
<Data>ОШИБКА ЗАПИСИ НА ТЕКУЩЕЕ УСТРОЙСТВО</Data>
</Node>
</Node>
</Global>


<Global>
<Node><Sub>^%ZAPM.ed.BSCGER</Sub>
<Data>ТЕКСТЫ ПРЕРЫВАНИЙ ВЫПОЛНЕНИЯ ПРОГРАММ</Data>
<Node><Sub>&lt;BLOCKNUMBER</Sub>
<Data>  A reference has been made to a block outside the range of the database file.  </Data>
</Node>
<Node><Sub>&lt;CANNOT GET THIS PROPERTY</Sub>
<Data><![CDATA[  There has been an attempt to get a property of a class for which getting this property is invalid.  ]]></Data>
</Node>
<Node><Sub>&lt;CANNOT SET THIS PROPERTY</Sub>
<Data><![CDATA[  There has been an attempt to set a property of a class for which setting this property is invalid.  ]]></Data>
</Node>
<Node><Sub>&lt;CLASS COMPILING</Sub>
<Data><![CDATA[  There has been an attempt to instantiate a class or invoke a class method of a class which is currently being recompiled on the local system.  ]]></Data>
</Node>
<Node><Sub>&lt;CLASS DESCRIPTOR</Sub>
<Data>  There has been an attempt to run a routine which is actually a class descriptor.  </Data>
</Node>
<Node><Sub>&lt;CLASS DOES NOT EXIST</Sub>
<Data>  A reference has been made to a nonexistent class.  </Data>
</Node>
<Node><Sub>&lt;CLASS EDITED</Sub>
<Data><![CDATA[  There has been an attempt to use an object hosted on the local system whose class has been recompiled from a remote system since the object was created.  ]]></Data>
</Node>
<Node><Sub>&lt;CLASS RECOMPILED</Sub>
<Data><![CDATA[  There has been an attempt to use an object hosted on the local system whose class has been recompiled on the local system since the object was created.  ]]></Data>
</Node>
<Node><Sub>&lt;CLASS TOO BIG TO LOAD</Sub>
<Data>  A class cannot be used because its class descriptor is too large to fit into a routine buffer.  </Data>
</Node>
<Node><Sub>&lt;CLASS TOO BIG TO SAVE</Sub>
<Data><![CDATA[  A class cannot be created because its class descriptor is too large to fit into a routine buffer.  ]]></Data>
</Node>
<Node><Sub>&lt;CLIENT-SERVER MISMATCH</Sub>
<Data>  A network request cannot be processed due to incompatibility between the client and server.  </Data>
</Node>
<Node><Sub>&lt;CLUSTERFAIL</Sub>
<Data>  A cluster member has failed during global buffer lock processing.  </Data>
</Node>
<Node><Sub>&lt;COLLATEMISMATCH</Sub>
<Data>  Subscript level mapping failed due to misconfigured collation type.  </Data>
</Node>
<Node><Sub>&lt;COLLATION NOT SUPPORTED</Sub>
<Data><![CDATA[  A reference has been made to a global whose collation type is not supported on the current system.  ]]></Data>
</Node>
<Node><Sub>&lt;COMMAND</Sub>
<Data>НЕДОПУСТИМАЯ КОМАНДА</Data>
</Node>
<Node><Sub>&lt;COMMITFAIL</Sub>
<Data><![CDATA[  Received during a COMMIT when Cache receives an error while processing a TCommit. This error means that Cache is not sure whether one or more remote machines actually processed the commit.  ]]></Data>
</Node>
<Node><Sub>&lt;CONFLICTING BLOCK NUMBERS</Sub>
<Data>  There has been an attempt to reserve a block that was already reserved.  </Data>
</Node>
<Node><Sub>&lt;CORRUPT OBJECT</Sub>
<Data><![CDATA[  An internal object system error occurred. Contact InterSystems Worldwide Response Center if this error occurs.  ]]></Data>
</Node>
<Node><Sub>&lt;CORRUPT VOLUME SET</Sub>
<Data><![CDATA[  The volume set is corrupted. Usually, this means the label on the volume set is wrong. Use the LABEL utility to correct it.  ]]></Data>
</Node>
<Node><Sub>&lt;CP NOT STARTED</Sub>
<Data><![CDATA[  One of the major processes required for proper operation of the system failed to start. This is potentially a very serious system error; notify your system manager.  ]]></Data>
</Node>
<Node><Sub>&lt;DATABASE</Sub>
<Data><![CDATA[  Cache has detected degradation in this database (this is potentially a very serious system error; notify your system manager).  ]]></Data>
</Node>
<Node><Sub>&lt;DATABASE MAP LABEL</Sub>
<Data>  There is an invalid label in a database map block.  </Data>
</Node>
<Node><Sub>&lt;DIRECTORY</Sub>
<Data><![CDATA[  There is no such directory on the target system, no Cache database, the Cache database is not mounted, or the database is locked by another configuration.  ]]></Data>
</Node>
<Node><Sub>&lt;DISCONNECT</Sub>
<Data>  A TCP disconnect has been detected while a long-duration request is being processed.  </Data>
</Node>
<Node><Sub>&lt;DISKHARD</Sub>
<Data><![CDATA[  Cache has encountered an uncorrectable disk hardware error (this may also be the result of a database problem; notify your system manager).  ]]></Data>
</Node>
<Node><Sub>&lt;DIVIDE</Sub>
<Data>  There has been an attempt to divide by zero.  </Data>
</Node>
<Node><Sub>&lt;DOMAINSPACERETRY</Sub>
<Data>  Repeated attempts to contact the domain space master have failed.  </Data>
</Node>
<Node><Sub>&lt;DSCON</Sub>
<Data>  There has been an attempt to read from a disconnected terminal.  </Data>
</Node>
<Node><Sub>&lt;DYNAMIC LIBRARY LOAD</Sub>
<Data><![CDATA[  An error has occurred during an attempt to load a dynamic library via callout. See cconsole.log for additional information.  ]]></Data>
</Node>
<Node><Sub>&lt;ECODETRAP</Sub>
<Data><![CDATA[  A user-generated software trap was generated by setting the $ECODE system variable to a non-null string value.  ]]></Data>
</Node>
<Node><Sub>&lt;EDITED</Sub>
<Data>ВЫПОЛНЯЕМАЯ ПРОГРАММА ПОДВЕРГЛАСЬ РЕДАКТИРОВАНИЮ</Data>
</Node>
<Node><Sub>&lt;ENDOFFILE</Sub>
<Data>  There has been an attempt to read past the end-of-file marker of a sequential file.  </Data>
</Node>
<Node><Sub>&lt;FILEFULL</Sub>
<Data><![CDATA[  Cache attempted to allocate a disk block for more global data or routine storage, but the attempt failed because the Cache database is full and could not be expanded.  ]]></Data>
</Node>
<Node><Sub>&lt;FRAMESTACK</Sub>
<Data>ПЕРЕПОЛНЕНИЕ СТЭКА ПРОГРАММЫ</Data>
</Node>
<Node><Sub>&lt;FUNCTION</Sub>
<Data>  The specified function does not exist or is being used improperly.  </Data>
</Node>
<Node><Sub>&lt;GARBAGE COLLECTOR FAILED</Sub>
<Data><![CDATA[  The one of the processes that reclaims space in the database hase failed. This is potentially a very serious system error; notify your system manager.  ]]></Data>
</Node>
<Node><Sub>&lt;HALTED</Sub>
<Data>  An internal error message.  </Data>
</Node>
<Node><Sub>&lt;ILLEGAL VALUE</Sub>
<Data>НЕДОПУСТИМОЕ ЗНАЧЕНИЕ В ИНДЕКСЕ ПЕРЕМЕННОЙ</Data>
</Node>
<Node><Sub>&lt;INSUFFICIENT CLASS MEMORY</Sub>
<Data>  A class cannot be used because Cache has run out of shared memory.  </Data>
</Node>
<Node><Sub>&lt;INTERNAL OBJECT ERROR</Sub>
<Data><![CDATA[  An internal object system error. Contact InterSystems Worldwide Response Center if this error occurs.  ]]></Data>
</Node>
<Node><Sub>&lt;INTERRUPT</Sub>
<Data>  A user has interrupted the routine. (In many implementations, the user has pressed CTRL-C.)  </Data>
</Node>
<Node><Sub>&lt;INVALID ARGUMENT</Sub>
<Data>  There is an invalid argument prototype in the zfentry specification of a callout function.  </Data>
</Node>
<Node><Sub>&lt;INVALID BIT STRING</Sub>
<Data>  The bit string used in a bit string operation is not valid.  </Data>
</Node>
<Node><Sub>&lt;INVALID CLASS</Sub>
<Data><![CDATA[  There has been an attempt to use a class that has been corrupted. Recompile the class and try again.  ]]></Data>
</Node>
<Node><Sub>&lt;INVALID OREF</Sub>
<Data>  No object with the specified OREF is currently in memory.  </Data>
</Node>
<Node><Sub>&lt;INVALID TYPE</Sub>
<Data>  An OREF has been used where not allowed.  </Data>
</Node>
<Node><Sub>&lt;Java Exception</Sub>
<Data>  An exception occurred during a call into the Java runtime environment.  </Data>
</Node>
<Node><Sub>&lt;Java VM not loaded</Sub>
<Data>  No Java Virtual Machine is available.  </Data>
</Node>
<Node><Sub>&lt;LABELREDEF</Sub>
<Data>ДУБЛИРОВАНИЕ МЕТОК В ПРОГРАММЕ</Data>
</Node>
<Node><Sub>&lt;LANGUAGE MISMATCH</Sub>
<Data><![CDATA[  While compiling and inserting code into an existing routine, the current language mode differs from that of the routine.  ]]></Data>
</Node>
<Node><Sub>&lt;LICENSE LIMIT EXCEEDED</Sub>
<Data><![CDATA[  There has been an attempt to exceed the number of processes allowed on your system under the current license.  ]]></Data>
</Node>
<Node><Sub>&lt;LICENSE SERVER UNAVAILABLE</Sub>
<Data>  The license server is unreachable at the moment. Check your network.  </Data>
</Node>
<Node><Sub>&lt;LIST</Sub>
<Data>  An improperly-formed list has been used.  </Data>
</Node>
<Node><Sub>&lt;LOCKLOST</Sub>
<Data>  Some locks once owned by this job have been reset.  </Data>
</Node>
<Node><Sub>&lt;LOGIN INHIBITED</Sub>
<Data>  The system is initializing. No users are permitted to begin work.  </Data>
</Node>
<Node><Sub>&lt;MAGTAPE</Sub>
<Data>  A magnetic tape operation encountered an error. Check $ZA.  </Data>
</Node>
<Node><Sub>&lt;MAXARRAY</Sub>
<Data>  There are too many subscripts at this level.  </Data>
</Node>
<Node><Sub>&lt;MAXNUMBER</Sub>
<Data>  An arithmetic operation has produced a number larger than the implementation allows.  </Data>
</Node>
<Node><Sub>&lt;MAXSCOPE</Sub>
<Data>  There has been an attempt to issue more than 31 levels of New commands.  </Data>
</Node>
<Node><Sub>&lt;MAXSTRING</Sub>
<Data>ПРЕВЫШЕНИЕ ДЛИНЫ ПЕРЕМЕННОЙ</Data>
</Node>
<Node><Sub>&lt;METHOD DOES NOT EXIST</Sub>
<Data>  The method does not exist in the specified class or the class of the specified object.  </Data>
</Node>
<Node><Sub>&lt;MNEMONICSPACE</Sub>
<Data><![CDATA[  There has been an attempt to use control mnemonics for a device with no associated mnemonic space.  ]]></Data>
</Node>
<Node><Sub>&lt;NAKED</Sub>
<Data>  There has been an attempt to use a naked global reference when the naked state was undefined.  </Data>
</Node>
<Node><Sub>&lt;NAME</Sub>
<Data>  There is invalid syntax in a name.  </Data>
</Node>
<Node><Sub>&lt;NAMEADD</Sub>
<Data>  There has been an overflow of device name table, resulting from the Open command.  </Data>
</Node>
<Node><Sub>&lt;NAMESPACE</Sub>
<Data>НЕСУЩЕСТВУЩАЯ ИМЕННАЯ ОБЛАСТЬ</Data>
</Node>
<Node><Sub>&lt;NETFORMAT</Sub>
<Data><![CDATA[  There has been an error in a network message. The remote system found fault with the format of a request. Call your support center to resolve this serious error.  ]]></Data>
</Node>
<Node><Sub>&lt;NETGLOREF</Sub>
<Data><![CDATA[  There has been an error in a network message. The remote system found fault with the format of a request. Call your support center to resolve this serious error. (This can also occur if a remote global is a string-collated or 7-bit encoded global on a DSM system.)  ]]></Data>
</Node>
<Node><Sub>&lt;NETJOBMAX</Sub>
<Data><![CDATA[  Another high-speed networking process cannot be added. This is usually due to an insufficient number of global buffers.  ]]></Data>
</Node>
<Node><Sub>&lt;NETLOCK</Sub>
<Data><![CDATA[  A Cache ObjectScript Lock command has been attempted to a remote computer whose remote system index is greater than 31. To correct, redefine your network configuration to include fewer than 32 remote computers.  ]]></Data>
</Node>
<Node><Sub>&lt;NETRETRY</Sub>
<Data>  An operation failed at the network level in a way that could be immediately retried.  </Data>
</Node>
<Node><Sub>&lt;NETSRVFAIL</Sub>
<Data><![CDATA[  During a transaction COMMIT or a Set, Kill, ZKill command, a client system has detected that one of the servers involved in the transaction has restarted while the transaction was open. Cache  ]]></Data>
</Node>
<Node><Sub>&lt;NETVERSION</Sub>
<Data><![CDATA[  The client and server systems are running different DDP versions, which cannot accept each other's message format.  ]]></Data>
</Node>
<Node><Sub>&lt;NETWORK</Sub>
<Data><![CDATA[  Typically, one of the following has occurred: the network timeout has expired; the local port has gone down; the node being accessed is down; or the remote server connection is disabled.   ]]></Data>
</Node>
<Node><Sub>&lt;NETWORK DATA UPDATE FAILED</Sub>
<Data><![CDATA[  Updates sent over the network were lost. The reasons for the loss are undetermined. Call your support center to resolve this serious error.  ]]></Data>
</Node>
<Node><Sub>&lt;NETWORK DATA UPDATE FAILED - BLOCKNUMBER</Sub>
<Data><![CDATA[  Updates sent over the network were lost because the remote system attempted to refer to a block that is outside the bounds of the database; notify your system manager.  ]]></Data>
</Node>
<Node><Sub>&lt;NETWORK DATA UPDATE FAILED - CLIENT-SERVER MISMATCH</Sub>
<Data><![CDATA[  Updates sent over the network were lost because a network request could not be processed due to incompatibility between the client and server.  ]]></Data>
</Node>
<Node><Sub>&lt;NETWORK DATA UPDATE FAILED - CLUSTERFAILED</Sub>
<Data><![CDATA[  Updates sent over the network were lost because a cluster member failed during global buffer lock processing.  ]]></Data>
</Node>
<Node><Sub>&lt;NETWORK DATA UPDATE FAILED - DATABASE</Sub>
<Data><![CDATA[  Updates sent over the network were lost because Cache on the server has detected degradation in this database. This is potentially a very serious system error; notify your system manager.  ]]></Data>
</Node>
<Node><Sub>&lt;NETWORK DATA UPDATE FAILED - DIRECTORY</Sub>
<Data><![CDATA[  Updates sent over the network were lost because the referenced directory is not on the remote system.  ]]></Data>
</Node>
<Node><Sub>&lt;NETWORK DATA UPDATE FAILED - DISKHARD</Sub>
<Data><![CDATA[  Updates sent over the network were lost because Cache on the server has encountered an uncorrectable disk hardware error. This may also be the result of a database problem; notify your system manager.  ]]></Data>
</Node>
<Node><Sub>&lt;NETWORK DATA UPDATE FAILED - FILEFULL</Sub>
<Data>  In networked operation, a &lt;FILEFULL&gt; error occurred.  </Data>
</Node>
<Node><Sub>&lt;NETWORK DATA UPDATE FAILED - MAXSTRING</Sub>
<Data><![CDATA[  There has been an attempt to specify or create a data string longer than the implementation allows (32,767 characters).  ]]></Data>
</Node>
<Node><Sub>&lt;NETWORK DATA UPDATE FAILED - NETFORMAT</Sub>
<Data><![CDATA[  Updates sent over the network were lost because the remote system found fault with the format of a request. Call your support center to resolve this serious error.  ]]></Data>
</Node>
<Node><Sub>&lt;NETWORK DATA UPDATE FAILED - NETGLOREF</Sub>
<Data><![CDATA[  Updates sent over the network were lost because the remote system found fault with the format of a request. Call your support center to resolve this serious error.  ]]></Data>
</Node>
<Node><Sub>&lt;NETWORK DATA UPDATE FAILED - NETVERSION</Sub>
<Data><![CDATA[  The client and server systems are running different ECP versions, which cannot accept each other's message format.  ]]></Data>
</Node>
<Node><Sub>&lt;NETWORK DATA UPDATE FAILED - PROTECT</Sub>
<Data>  In networked operation, a &lt;PROTECT&gt; error occurred.  </Data>
</Node>
<Node><Sub>&lt;NETWORK DATA UPDATE FAILED - STRINGSTACK</Sub>
<Data>  In networked operation, a &lt;STRINGSTACK&gt; error occurred.  </Data>
</Node>
<Node><Sub>&lt;NETWORK DATA UPDATE FAILED - STRMISMATCH</Sub>
<Data><![CDATA[  Updates sent over the network were lost because there has been an internal error handling big strings over the network.  ]]></Data>
</Node>
<Node><Sub>&lt;NETWORK DATA UPDATE FAILED - SUBSCRIPT</Sub>
<Data>  In networked operation, a &lt;SUBSCRIPT&gt; error occurred.  </Data>
</Node>
<Node><Sub>&lt;NETWORK DATA UPDATE FAILED - SYSTEM</Sub>
<Data><![CDATA[  Updates sent over the network were lost because a <SYSTEM> error occurred on the server. Either there has been an attempt to do something not allowed by the operating system or ECP. Or there is an error condition in Cache, in which case you should notify your support center with as much information as possible.  ]]></Data>
</Node>
<Node><Sub>&lt;NETWORK DATA UPDATE FAILED - WIDECHAR</Sub>
<Data>  In networked operation, a &lt;WIDECHAR&gt; error occurred.  </Data>
</Node>
<Node><Sub>&lt;NLS TABLE</Sub>
<Data><![CDATA[  There has been an attempt to perform NLS translation using data that is not proper for the conversion table.  ]]></Data>
</Node>
<Node><Sub>&lt;NO CURRENT OBJECT</Sub>
<Data>  There is no current object.  </Data>
</Node>
<Node><Sub>&lt;NO MAILBOX</Sub>
<Data>  A resource needed for inter-process communication is unavailable.  </Data>
</Node>
<Node><Sub>&lt;NO SOURCE</Sub>
<Data>  A source line is missing from a routine in the routine source global.  </Data>
</Node>
<Node><Sub>&lt;NODEV</Sub>
<Data><![CDATA[  There has been an attempt to a write-only device, or write to a read-only device, with interjob communication.  ]]></Data>
</Node>
<Node><Sub>&lt;NOJOB</Sub>
<Data><![CDATA[  There has been an attempt to specify an incorrect process number in a View command, or an error occurred in a Job command.  ]]></Data>
</Node>
<Node><Sub>&lt;NOLINE</Sub>
<Data>НЕСУЩЕСТВУЮЩАЯ МЕТКА В ПРОГРАММЕ</Data>
</Node>
<Node><Sub>&lt;NOROUTINE</Sub>
<Data>НЕСУЩЕСТВУЮЩАЯ ПРОГРАММА</Data>
</Node>
<Node><Sub>&lt;NOSYS</Sub>
<Data>НЕСУЩЕСТВУЮЩАЯ ИМЕННАЯ ОБЛАСТЬ</Data>
</Node>
<Node><Sub>&lt;NOT PRIMARY VOLUME</Sub>
<Data>  Volume sequence is not 1; the volume label disagrees with the function of the volume.  </Data>
</Node>
<Node><Sub>&lt;NOTOPEN</Sub>
<Data>УСТРОЙСТВО НЕ ОТКРЫТО</Data>
</Node>
<Node><Sub>&lt;NULL VALUE</Sub>
<Data>  A null string appears where one is not allowed.  </Data>
</Node>
<Node><Sub>&lt;OUT OF $ZF HEAP SPACE</Sub>
<Data><![CDATA[  The $ZF heap lacks the necessary available space to support one of the input or output parameters being passed between Cache and the external program invoked via the $ZF function.  ]]></Data>
</Node>
<Node><Sub>&lt;PARAMET</Sub>
<Data>ОТСУТСТВЕТ СПИСОК ФОРМАЛЬНЫХ ПЕРЕМЕННЫХ</Data>
</Node>
<Node><Sub>&lt;PARAMETER</Sub>
<Data><![CDATA[  The number of parameters passed to a labeled line by a user-written function reference or a Do command exceeded the number of formal parameters declared for the labeled line.  ]]></Data>
</Node>
<Node><Sub>&lt;PRIVATE METHOD</Sub>
<Data>  There has been an attempt to invoke a private and, therefore, unavailable method.  </Data>
</Node>
<Node><Sub>&lt;PRIVATE PROPERTY</Sub>
<Data>  There has been an attempt to access a private and, therefore, unavailable property.  </Data>
</Node>
<Node><Sub>&lt;PROPERTY DOES NOT EXIST</Sub>
<Data>  The property is not part of the class of the specified object.  </Data>
</Node>
<Node><Sub>&lt;PROTECT</Sub>
<Data><![CDATA[  There has been an attempt to do something with a global (Read, Write, or Kill) for which there was no authorization; or there has been an attempt to use a View command which modifies memory, $View, $ZU(49), or $ZU(58); or there has been an attempt to use a nonexistent directory, possibly with extended global syntax, or some other protection violation occurred.  ]]></Data>
</Node>
<Node><Sub>&lt;RANGE</Sub>
<Data>  A bit position is out of allowable range.  </Data>
</Node>
<Node><Sub>&lt;READ</Sub>
<Data>  The record cannot be read.  </Data>
</Node>
<Node><Sub>&lt;RECOMPILE</Sub>
<Data><![CDATA[  A routine has been compiled under a different version of Cache or an InterSystems legacy product. It cannot be loaded onto this system with %RIMF, which transfers object code. Transfer it as source code (using %RO and %RI, or the Cache Explorer) and then recompile it.  ]]></Data>
</Node>
<Node><Sub>&lt;REMOTE CLASS EDITED</Sub>
<Data><![CDATA[  There has been an attempt to use an object hosted on a remote system whose class has been recompiled from a remote system since the object was created.  ]]></Data>
</Node>
<Node><Sub>&lt;REMOTE CLASS RECOMPILED</Sub>
<Data><![CDATA[  There has been an attempt to use an object hosted on a remote system whose class has been recompiled from the local system since the object was created.  ]]></Data>
</Node>
<Node><Sub>&lt;ROLLFAIL</Sub>
<Data><![CDATA[  Cache has encountered an error processing a call to TRollBack. This error means that Cache is not sure whether one or more remote machines actually processed the rollback.  ]]></Data>
</Node>
<Node><Sub>&lt;ROUTINELOAD</Sub>
<Data>  An error occurred in loading a routine. This is database degradation; notify the system manager.  </Data>
</Node>
<Node><Sub>&lt;SELECT</Sub>
<Data>  A $Select function contains no true condition.  </Data>
</Node>
<Node><Sub>&lt;SLMSPAN</Sub>
<Data>  There has been an attempt to kill a global across a subscript level mapping boundary.  </Data>
</Node>
<Node><Sub>&lt;STACK</Sub>
<Data>  The argument stack is out of room or contains an incorrect type.  </Data>
</Node>
<Node><Sub>&lt;STORE</Sub>
<Data>ПЕРЕПОЛНЕНИЕ ОБЛАСТИ ЛОКАЛЬНЫХ ПЕРЕМЕННЫХ</Data>
</Node>
<Node><Sub>&lt;STRINGSTACK</Sub>
<Data><![CDATA[  An expression is too long, there are too many expressions in an argument for a single command, or an expression contains many very long strings. Simplify the expression.  ]]></Data>
</Node>
<Node><Sub>&lt;STRMISMATCH</Sub>
<Data>  There has been an internal error handling big strings over the network.  </Data>
</Node>
<Node><Sub>&lt;SUBSCRIPT</Sub>
<Data><![CDATA[  A subscript has an illegal value or a global reference is too long. If a global reference is too long, then either (1) the encoded length of an individual subscript exceeds 255 bytes or (2) the sum of the encoded lengths of the following items exceeds 512 bytes: the length of the global name; the lengths of all subscripts; the number of subscripts; the number of numeric subscripts; and the number of negative numeric subscripts.  ]]></Data>
</Node>
<Node><Sub>&lt;SYNTAX</Sub>
<Data>СИНТАКСИЧЕСКАЯ ОШИБКА В ПРОГРАММЕ</Data>
</Node>
<Node><Sub>&lt;SYSTEM</Sub>
<Data><![CDATA[  Either there has been an attempt to do something not allowed by the operating system, or there is an error condition in Cache, in which case you should notify your support center with as much information as possible.  ]]></Data>
</Node>
<Node><Sub>&lt;TERMINATOR</Sub>
<Data><![CDATA[  There has been an attempt to read on a terminal or device in image mode with no terminator and it was not a fixed-length read.  ]]></Data>
</Node>
<Node><Sub>&lt;TOO MANY CLASSES</Sub>
<Data>  This process has attempted to access too many active classes.  </Data>
</Node>
<Node><Sub>&lt;TOO MANY OREFS</Sub>
<Data>  This process has attempted to create too many simultaneously open objects.  </Data>
</Node>
<Node><Sub>&lt;TOO MANY USERS</Sub>
<Data>  Too many users are attempting to use the system at the same time.  </Data>
</Node>
<Node><Sub>&lt;TOO MANY USERS OF CLASS</Sub>
<Data>  Too many processes are trying to use a particular class simultaneously (more than 65561).  </Data>
</Node>
<Node><Sub>&lt;TOOMANYFILES</Sub>
<Data><![CDATA[  Cache is unable to open a file because the underlying operating system has run out of file descriptors.  ]]></Data>
</Node>
<Node><Sub>&lt;TRANSLATE</Sub>
<Data><![CDATA[  Cache has read an input value for which it has no translation value. It therefore carries out the Default Action defined on the Translation tab of the Cache NLS utility.  ]]></Data>
</Node>
<Node><Sub>&lt;TRANSLOST</Sub>
<Data><![CDATA[  A distributed transaction initiated by this job has been asynchronously rolled back by the server.  ]]></Data>
</Node>
<Node><Sub>&lt;UNDEFINED</Sub>
<Data>НЕОПРЕДЕЛЕННАЯ ПЕРЕМЕННАЯ</Data>
</Node>
<Node><Sub>&lt;UNIMPLEMENTED</Sub>
<Data><![CDATA[  There has been an attempt to use either an unimplemented function or an unimplemented argument of a legitimate command or function.  ]]></Data>
</Node>
<Node><Sub>&lt;UNKNOWN ERROR</Sub>
<Data>  An unexpected error has occurred. Call your support center to resolve this serious error.  </Data>
</Node>
<Node><Sub>&lt;VALUE OUT OF RANGE</Sub>
<Data>  The value is outside the maximum or minimum permissible range.  </Data>
</Node>
<Node><Sub>&lt;VOLUME IS NOT FORMATTED</Sub>
<Data>  The volume does not have the required formatting.  </Data>
</Node>
<Node><Sub>&lt;VOLUME SET ALREADY CREATED</Sub>
<Data>  There has been an attempt to format an Cache database that is already formatted.  </Data>
</Node>
<Node><Sub>&lt;WIDE CHAR</Sub>
<Data>  Cache read a multibyte character where a 1-byte character was expected.  </Data>
</Node>
<Node><Sub>&lt;WRITE</Sub>
<Data>ОШИБКА ЗАПИСИ НА ТЕКУЩЕЕ УСТРОЙСТВО</Data>
</Node>
<Node><Sub>&lt;WRITE DEMON FAILED</Sub>
<Data>  The write daemon is unable to continue. Call your support center to resolve this serious error.  </Data>
</Node>
<Node><Sub>&lt;ZFILE</Sub>
<Data><![CDATA[  There has been a file-related problem, such as that a file cannot be found or cannot be opened; consult the error log for more details.  ]]></Data>
</Node>
<Node><Sub>&lt;ZMISC</Sub>
<Data><![CDATA[  An error has occurred of a different type than the others listed in this table. More detail follows the <ZMISC> code itself.  ]]></Data>
</Node>
<Node><Sub>&lt;ZOPEN</Sub>
<Data>  There has been an error opening a device with TCP; the database server being shadowed is down.  </Data>
</Node>
<Node><Sub>&lt;ZREAD</Sub>
<Data><![CDATA[  There has been a failure to read from the database server that is being shadowed, indicating that the server is disconnected or not currently running.  ]]></Data>
</Node>
<Node><Sub>&lt;ZSTOP</Sub>
<Data>  Shadowing has been stopped by system shutdown or the user.  </Data>
</Node>
<Node><Sub>&lt;ZTRAP</Sub>
<Data>  There has been an attempt to issue a ZTrap command with no argument.  </Data>
</Node>
<Node><Sub>M1</Sub>
<Data> Naked indicator undefined.  </Data>
</Node>
<Node><Sub>M10</Sub>
<Data> Invalid pattern match range.  </Data>
</Node>
<Node><Sub>M11</Sub>
<Data> No parameters passed.  </Data>
</Node>
<Node><Sub>M12</Sub>
<Data> Invalid line reference (negative offset).  </Data>
</Node>
<Node><Sub>M13</Sub>
<Data> Invalid line reference (line not found).  </Data>
</Node>
<Node><Sub>M14</Sub>
<Data> Line level not one (1).  </Data>
</Node>
<Node><Sub>M15</Sub>
<Data> Undefined index variable.  </Data>
</Node>
<Node><Sub>M16</Sub>
<Data> Quit with an argument not allowed.  </Data>
</Node>
<Node><Sub>M17</Sub>
<Data> Quit with an argument required.  </Data>
</Node>
<Node><Sub>M18</Sub>
<Data> Fixed-length Read not greater than 0 (zero).  </Data>
</Node>
<Node><Sub>M19</Sub>
<Data> Cannot merge a tree or subtree into itself.  </Data>
</Node>
<Node><Sub>M2</Sub>
<Data> Invalid $FNumber code string combination.  </Data>
</Node>
<Node><Sub>M20</Sub>
<Data> Line must have a formal list.  </Data>
</Node>
<Node><Sub>M21</Sub>
<Data> Formal list name duplication.  </Data>
</Node>
<Node><Sub>M22</Sub>
<Data> Set or Kill to ^$Global structured system variable name (SSVN) when data in global.  </Data>
</Node>
<Node><Sub>M23</Sub>
<Data> Set or Kill to ^$Job structured system variable name (SSVN) for non-existent job number.  </Data>
</Node>
<Node><Sub>M24</Sub>
<Data> Change to collation algorithm while subscripted local variables defined.  </Data>
</Node>
<Node><Sub>M26</Sub>
<Data> Non-existent environment (non-existent namespace).  </Data>
</Node>
<Node><Sub>M27</Sub>
<Data> Attempt to roll back a transaction that is not re-startable.  </Data>
</Node>
<Node><Sub>M28</Sub>
<Data> Mathematical function, parameter out of range.  </Data>
</Node>
<Node><Sub>M29</Sub>
<Data> Set or Kill on structured system variable name (SSVN) not allowed by implementation.  </Data>
</Node>
<Node><Sub>M3</Sub>
<Data> $Random argument less than 1.  </Data>
</Node>
<Node><Sub>M30</Sub>
<Data> Reference to global variable with different collating sequence within a collating algorithm.  </Data>
</Node>
<Node><Sub>M31</Sub>
<Data> Device control mnemonic expression used for a device without a mnemonic space being selected.  </Data>
</Node>
<Node><Sub>M32</Sub>
<Data> Device control mnemonic used in user-defined mnemonic space which has no associated line.  </Data>
</Node>
<Node><Sub>M33</Sub>
<Data> Set or Kill to ^$Routine when the routine specified exists.  </Data>
</Node>
<Node><Sub>M35</Sub>
<Data> Device does not support mnemonic spaces.  </Data>
</Node>
<Node><Sub>M36</Sub>
<Data> Incompatible mnemonic spaces.  </Data>
</Node>
<Node><Sub>M37</Sub>
<Data> Read from device identified by null string.  </Data>
</Node>
<Node><Sub>M38</Sub>
<Data> Invalid structured system variable name (SSVN) subscript.  </Data>
</Node>
<Node><Sub>M39</Sub>
<Data> Invalid $Name argument.  </Data>
</Node>
<Node><Sub>M4</Sub>
<Data> No true condition in $Select.  </Data>
</Node>
<Node><Sub>M40</Sub>
<Data> Call by reference in the actual parameter list in Job command.  </Data>
</Node>
<Node><Sub>M41</Sub>
<Data> Invalid Lock argument within a transaction.  </Data>
</Node>
<Node><Sub>M42</Sub>
<Data> Invalid Quit within a transaction.  </Data>
</Node>
<Node><Sub>M43</Sub>
<Data> Invalid range value ($X,$Y).  </Data>
</Node>
<Node><Sub>M44</Sub>
<Data> Invalid command outside a transaction.  </Data>
</Node>
<Node><Sub>M45</Sub>
<Data> Invalid GoTo reference.  </Data>
</Node>
<Node><Sub>M5</Sub>
<Data> Line reference less than 0 (zero).  </Data>
</Node>
<Node><Sub>M57</Sub>
<Data> A label is defined more than once in a routine.  </Data>
</Node>
<Node><Sub>M58</Sub>
<Data> Too few formal parameters.  </Data>
</Node>
<Node><Sub>M6</Sub>
<Data> Undefined local variable.  </Data>
</Node>
<Node><Sub>M7</Sub>
<Data> Undefined global variable.  </Data>
</Node>
<Node><Sub>M8</Sub>
<Data> Undefined special variable.  </Data>
</Node>
<Node><Sub>M9</Sub>
<Data> Divide by zero.  </Data>
</Node>
</Node>
</Global>


<Global>
<Node><Sub>^%ZAPM.ed.BSDFLT</Sub>
<Data>BaSe MsW @РАЗДЕЛ ПАРАМЕТРОВ ОБЪЕКТОВ ПО-УМОЛЧАНИЮ@@</Data>
<Node><Sub>BigEdit</Sub>
<Data><![CDATA[Редактор в окне с рамкой@@@@@@@20@1@22@80@@1@@1@@5@@@@@@@@@@@1@510@@1;6;34;40///1;6;37;40/1;6;37;40//////176@@@@@@@1]]></Data>
<Node><Sub>1</Sub>
<Data></Data>
</Node>
</Node>
<Node><Sub>CharAcc</Sub>
<Data>@@1@@@1@1@1@1@22@80@1@@1@1@@8@@@1@@@@@@@@4@6@@2;6;30;45@@@@@@@@^%ZAPM.ed.BSHLP(&quot;HELP-ALTF2&quot;)</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@10@@@@@1@@@@@@              Выберите Право доступа@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@11@1@10@@@@@1@1;6;37;45@@@@@ NONE @</Data>
</Node>
<Node><Sub>3</Sub>
<Data>1@21@1@10@@@@@1@@@@@@1@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>1@31@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>1@41@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>6</Sub>
<Data>1@51@1@10@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@10@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>2@11@1@10@@@@@1@2;6;30;41@@@@@ READ ONLY @</Data>
</Node>
<Node><Sub>3</Sub>
<Data>2@21@1@10@@@@@1@@@@@@2@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>2@31@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>2@41@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>6</Sub>
<Data>2@51@1@10@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@11@1@10@@@@@1@@@@@@ READ,WRITE @</Data>
</Node>
<Node><Sub>3</Sub>
<Data>3@21@1@10@@@@@1@@@@@@3@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>3@31@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>3@41@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>6</Sub>
<Data>3@51@1@10@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>4@1@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>4@11@1@10@@@@@1@@@@@@ READ,WRITE,DELETE @</Data>
</Node>
<Node><Sub>3</Sub>
<Data>4@21@1@10@@@@@1@@@@@@4@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>4@31@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>4@41@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>6</Sub>
<Data>4@51@1@10@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>BUT</Sub>
<Data>/2;6;30;45</Data>
<Node><Sub>0</Sub>
<Data>2;6;30;45</Data>
<Node><Sub>1</Sub>
<Data>              Выберите Право доступа</Data>
</Node>
</Node>
<Node><Sub>1</Sub>
<Data>1;6;37;45/2;6;30;41</Data>
<Node><Sub>1</Sub>
<Data> NONE </Data>
</Node>
<Node><Sub>2</Sub>
<Data> READ ONLY </Data>
</Node>
<Node><Sub>3</Sub>
<Data> READ,WRITE </Data>
</Node>
<Node><Sub>4</Sub>
<Data> READ,WRITE,DELETE </Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>1</Data>
</Node>
<Node><Sub>2</Sub>
<Data>2</Data>
</Node>
<Node><Sub>3</Sub>
<Data>3</Data>
</Node>
<Node><Sub>4</Sub>
<Data>4</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>0</Data>
</Node>
<Node><Sub>2</Sub>
<Data>0</Data>
</Node>
</Node>
</Node>
<Node><Sub>STA</Sub>
<Data>1,2@1@1@13@-1@-1@1@11@ NONE </Data>
</Node>
</Node>
<Node><Sub>CharGlob</Sub>
<Data><![CDATA[Умалчиваемые характеристики массивов@@@@@1@1@2@2@20@79@@@@@@1@@@1@@@@@@@@18@5@@1;6;35;44@@@@@@@1@^%ZAPM.ed.BSDFLT("CharHelp")@@@@1]]></Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@3@1@@@0@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@4@1@49@1@@@@1@2;6;37;44@@@@@     Умалчиваемые характеристики для массивов@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>1@53@1@10@1@@@@1@2;6;37;44@@@@@  Version@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>1@63@1@13@@@1@0@1@2;6;37;44@@@@@4434,4344,4444@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>1@76@1@3@1@@@@1@2;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@2@3@1@@@@1@2;6;37;44@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>2@4@2@49@1@@@@1@1;6;37;44@@@@@       (введите F1 ,если что-то непонятно)@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>2@53@2@10@1@@@@1@2;6;37;44@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>2@63@2@13@1@@@@1@2;6;37;44@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>2@76@2@3@1@@@@1@2;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>4@1@1@3@1@@@0@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>4@4@1@49@1@@@@1@1;6;36;46@@@@@  Стандарные Разделы ,создаваемые %BS@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>4@53@1@10@1@@@@1@1;6;37;44@@@@@  SYSTEM@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>4@63@1@13@@@@0@1@1;6;36;46@@@@^%ZAPM.ed.BSDFLT(&quot;CharAcc&quot;)@4@0</Data>
</Node>
<Node><Sub>5</Sub>
<Data>4@76@1@3@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>5@1@1@3@1@@@0@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>5@4@1@49@1@@@@1@1;6;36;46@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>5@53@1@10@1@@@@1@1;6;37;44@@@@@  WORLD@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>5@63@1@13@@@@3,4@1@1;6;36;46@@@@^%ZAPM.ed.BSDFLT(&quot;CharAcc&quot;)@4@0</Data>
</Node>
<Node><Sub>5</Sub>
<Data>5@76@1@3@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>6@1@1@3@1@@@0@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>6@4@1@49@1@@@@1@1;6;36;46@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>6@53@1@10@1@@@@1@1;6;37;44@@@@@  GROUP@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>6@63@1@13@@@@3,4@1@1;6;36;46@@@@^%ZAPM.ed.BSDFLT(&quot;CharAcc&quot;)@3@0</Data>
</Node>
<Node><Sub>5</Sub>
<Data>6@76@1@3@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>7@1@1@3@1@@@0@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>7@4@1@49@1@@@@1@1;6;36;46@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>7@53@1@10@1@@@@1@1;6;37;44@@@@@  USER@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>7@63@1@13@@@@3,4@1@1;6;36;46@@@@^%ZAPM.ed.BSDFLT(&quot;CharAcc&quot;)@4@0</Data>
</Node>
<Node><Sub>5</Sub>
<Data>7@76@1@3@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>8@1@1@3@1@@@0@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>8@4@1@49@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>8@53@1@10@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>8@63@1@13@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>8@76@1@3@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>1</Sub>
<Data>9@1@1@3@1@@@0@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>9@4@1@49@1@@@@1@2;6;30;46@@@@@  Стандарные Кодификаторы ,создаваемые %BS@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>9@53@1@10@1@@@@1@1;6;37;44@@@@@  SYSTEM@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>9@63@1@13@@@@3,4@1@2;6;30;46@@@@^%ZAPM.ed.BSDFLT(&quot;CharAcc&quot;)@4@0</Data>
</Node>
<Node><Sub>5</Sub>
<Data>9@76@1@3@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>1</Sub>
<Data>10@1@1@3@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>10@4@1@49@1@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>10@53@1@10@1@@@@1@1;6;37;44@@@@@  WORLD@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>10@63@1@13@@@@3,4@1@2;6;30;46@@@@^%ZAPM.ed.BSDFLT(&quot;CharAcc&quot;)@3@0</Data>
</Node>
<Node><Sub>5</Sub>
<Data>10@76@1@3@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>1</Sub>
<Data>11@1@1@3@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>11@4@1@49@1@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>11@53@1@10@1@@@@1@1;6;37;44@@@@@  GROUP@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>11@63@1@13@@@@3,4@1@2;6;30;46@@@@^%ZAPM.ed.BSDFLT(&quot;CharAcc&quot;)@4@0</Data>
</Node>
<Node><Sub>5</Sub>
<Data>11@76@1@3@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>11</Sub>
<Node><Sub>1</Sub>
<Data>12@1@1@3@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>12@4@1@49@1@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>12@53@1@10@1@@@@1@1;6;37;44@@@@@  USER@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>12@63@1@13@@@@3,4@1@2;6;30;46@@@@^%ZAPM.ed.BSDFLT(&quot;CharAcc&quot;)@4@0</Data>
</Node>
<Node><Sub>5</Sub>
<Data>12@76@1@3@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>12</Sub>
<Node><Sub>1</Sub>
<Data>13@1@1@3@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>13@4@1@49@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>13@53@1@10@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>13@63@1@13@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>13@76@1@3@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>13</Sub>
<Node><Sub>1</Sub>
<Data>14@1@1@3@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>14@4@1@49@1@@@@1@2;6;30;46@@@@@  Стандарные Базы данных ,создаваемые %BS@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>14@53@1@10@1@@@@1@2;6;37;44@@@@@  SYSTEM@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>14@63@1@13@@@@3,4@1@2;6;30;46@@@@^%ZAPM.ed.BSDFLT(&quot;CharAcc&quot;)@4@0</Data>
</Node>
<Node><Sub>5</Sub>
<Data>14@76@1@3@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>14</Sub>
<Node><Sub>1</Sub>
<Data>15@1@1@3@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>15@4@1@49@1@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>15@53@1@10@1@@@@1@2;6;37;44@@@@@  WORLD@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>15@63@1@13@@@@3,4@1@2;6;30;46@@@@^%ZAPM.ed.BSDFLT(&quot;CharAcc&quot;)@4@0</Data>
</Node>
<Node><Sub>5</Sub>
<Data>15@76@1@3@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>15</Sub>
<Node><Sub>1</Sub>
<Data>16@1@1@3@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>16@4@1@49@1@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>16@53@1@10@1@@@@1@2;6;37;44@@@@@  GROUP@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>16@63@1@13@@@@3,4@1@2;6;30;46@@@@^%ZAPM.ed.BSDFLT(&quot;CharAcc&quot;)@4@0</Data>
</Node>
<Node><Sub>5</Sub>
<Data>16@76@1@3@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>16</Sub>
<Node><Sub>1</Sub>
<Data>17@1@1@3@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>17@4@1@49@1@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>17@53@1@10@1@@@@1@2;6;37;44@@@@@  USER@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>17@63@1@13@@@@3,4@1@2;6;30;46@@@@^%ZAPM.ed.BSDFLT(&quot;CharAcc&quot;)@4@0</Data>
</Node>
<Node><Sub>5</Sub>
<Data>17@76@1@3@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>17</Sub>
<Node><Sub>1</Sub>
<Data>18@1@1@3@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>18@4@1@49@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>18@53@1@10@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>18@63@1@13@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>18@76@1@3@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>18</Sub>
<Node><Sub>1</Sub>
<Data>19@1@1@3@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>19@4@1@49@1@@@@1@1;6;37;44@@@@@       Введите  &lt;Enter&gt; , для модификации@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>19@53@1@10@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>19@63@1@13@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>19@76@1@3@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>CMD</Sub>
<Node><Sub>13</Sub>
<Node><Sub>2</Sub>
<Data><![CDATA[W #,!," *** ВЫБЕРИТЕ МАССИВЫ ДЛЯ ПРИЛОЖЕНИЯ ***",! D ^%GSEL,R^%ZAPM.ed.BS0("^BS"),Copy^%ZAPM.ed.BSF8("^%UtiLITY("_$J_")","^BStranS(""Glo"")"),D^%ZAPM.ed.BS0("^BS")]]></Data>
</Node>
<Node><Sub>4</Sub>
<Data><![CDATA[W #,!," *** ВЫБЕРИТЕ ПРОГРАММЫ ДЛЯ ПРИЛОЖЕНИЯ ***",! D ^%RSEL,R^%ZAPM.ed.BS0("^BS"),Copy^%ZAPM.ed.BSF8("^%UtiLITY("_$J_")","^BStranS(""Rou"")"),D^%ZAPM.ed.BS0("^BS")]]></Data>
</Node>
</Node>
</Node>
<Node><Sub>FCL</Sub>
<Node><Sub>1</Sub>
<Node><Sub>4</Sub>
<Data><![CDATA[S d1=$$A^%ZAPM.ed.BSA(3,4)_$$A^%ZAPM.ed.BSA(4,4)_$$A^%ZAPM.ed.BSA(5,4)_$$A^%ZAPM.ed.BSA(6,4)_","_$$A^%ZAPM.ed.BSA(8,4)_$$A^%ZAPM.ed.BSA(9,4)_$$A^%ZAPM.ed.BSA(10,4)_$$A^%ZAPM.ed.BSA(11,4)_","_$$A^%ZAPM.ed.BSA(13,4)_$$A^%ZAPM.ed.BSA(14,4)_$$A^%ZAPM.ed.BSA(15,4)_$$A^%ZAPM.ed.BSA(16,4)]]></Data>
<Node><Sub>1</Sub>
<Data>{3,4}_{4,4}_{5,4}_{6,4}_&quot;,&quot;_{8,4}_{9,4}_{10,4}_{11,4}_&quot;,&quot;_{13,4}_{14,4}_{15,4}_{16,4}</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>FTR</Sub>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Data>S d1=&quot; &quot;_$g(^%ZAPM.ed.BS)</Data>
<Node><Sub>1</Sub>
<Data>&quot; &quot;_$g(^%ZAPM.ed.BS)</Data>
</Node>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Data>S d1=$S(d=1:&quot;NONE&quot;,d=2:&quot;READ ONLY&quot;,d=3:&quot;READ &amp; WRITE&quot;,d=4:&quot;R/W &amp; DELETE&quot;,1:&quot;?&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$S(d=1:&quot;NONE&quot;,d=2:&quot;READ ONLY&quot;,d=3:&quot;READ &amp; WRITE&quot;,d=4:&quot;R/W &amp; DELETE&quot;,1:&quot;?&quot;)</Data>
</Node>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>RTR</Sub>
<Node><Sub>3</Sub>
<Node><Sub>4</Sub>
<Data>S d1=$$IF^%ZAPM.ed.BSsFUNR(&quot;d&gt;0&amp;(d&lt;5)&quot;,&quot;READ&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$$IF(&quot;d&gt;0&amp;(d&lt;5)&quot;,&quot;READ&quot;)</Data>
</Node>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>4</Sub>
<Data>S d1=$$IF^%ZAPM.ed.BSsFUNR(&quot;d&gt;0&amp;(d&lt;5)&quot;,&quot;READ&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$$IF(&quot;d&gt;0&amp;(d&lt;5)&quot;,&quot;READ&quot;)</Data>
</Node>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>4</Sub>
<Data>S d1=$$IF^%ZAPM.ed.BSsFUNR(&quot;d&gt;0&amp;(d&lt;5)&quot;,&quot;READ&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$$IF(&quot;d&gt;0&amp;(d&lt;5)&quot;,&quot;READ&quot;)</Data>
</Node>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>4</Sub>
<Data>S d1=$$IF^%ZAPM.ed.BSsFUNR(&quot;d&gt;0&amp;(d&lt;5)&quot;,&quot;READ&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$$IF(&quot;d&gt;0&amp;(d&lt;5)&quot;,&quot;READ&quot;)</Data>
</Node>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>4</Sub>
<Data>S d1=$$IF^%ZAPM.ed.BSsFUNR(&quot;d&gt;0&amp;(d&lt;5)&quot;,&quot;READ&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$$IF(&quot;d&gt;0&amp;(d&lt;5)&quot;,&quot;READ&quot;)</Data>
</Node>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>4</Sub>
<Data>S d1=$$IF^%ZAPM.ed.BSsFUNR(&quot;d&gt;0&amp;(d&lt;5)&quot;,&quot;READ&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$$IF(&quot;d&gt;0&amp;(d&lt;5)&quot;,&quot;READ&quot;)</Data>
</Node>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>4</Sub>
<Data>S d1=$$IF^%ZAPM.ed.BSsFUNR(&quot;d&gt;0&amp;(d&lt;5)&quot;,&quot;READ&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$$IF(&quot;d&gt;0&amp;(d&lt;5)&quot;,&quot;READ&quot;)</Data>
</Node>
</Node>
</Node>
<Node><Sub>11</Sub>
<Node><Sub>4</Sub>
<Data>S d1=$$IF^%ZAPM.ed.BSsFUNR(&quot;d&gt;0&amp;(d&lt;5)&quot;,&quot;READ&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$$IF(&quot;d&gt;0&amp;(d&lt;5)&quot;,&quot;READ&quot;)</Data>
</Node>
</Node>
</Node>
<Node><Sub>13</Sub>
<Node><Sub>4</Sub>
<Data>S d1=$$IF^%ZAPM.ed.BSsFUNR(&quot;d&gt;0&amp;(d&lt;5)&quot;,&quot;READ&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$$IF(&quot;d&gt;0&amp;(d&lt;5)&quot;,&quot;READ&quot;)</Data>
</Node>
</Node>
</Node>
<Node><Sub>14</Sub>
<Node><Sub>4</Sub>
<Data>S d1=$$IF^%ZAPM.ed.BSsFUNR(&quot;d&gt;0&amp;(d&lt;5)&quot;,&quot;READ&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$$IF(&quot;d&gt;0&amp;(d&lt;5)&quot;,&quot;READ&quot;)</Data>
</Node>
</Node>
</Node>
<Node><Sub>15</Sub>
<Node><Sub>4</Sub>
<Data>S d1=$$IF^%ZAPM.ed.BSsFUNR(&quot;d&gt;0&amp;(d&lt;5)&quot;,&quot;READ&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$$IF(&quot;d&gt;0&amp;(d&lt;5)&quot;,&quot;READ&quot;)</Data>
</Node>
</Node>
</Node>
<Node><Sub>16</Sub>
<Node><Sub>4</Sub>
<Data>S d1=$$IF^%ZAPM.ed.BSsFUNR(&quot;d&gt;0&amp;(d&lt;5)&quot;,&quot;READ&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$$IF(&quot;d&gt;0&amp;(d&lt;5)&quot;,&quot;READ&quot;)</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>STA</Sub>
<Data>1,4@1@1@27@-1@-1@5@64@4434,4344,4444</Data>
</Node>
</Node>
<Node><Sub>CharHelp</Sub>
<Data>Классы пользователей MSM@@@@@@@5@10@17@70@@@@1@@5@@@1@@@ 1@@@@@11@@@1;6;37;44//2;6;33;40@@@@@@@1</Data>
<Node><Sub>1</Sub>
<Data></Data>
</Node>
<Node><Sub>2</Sub>
<Data> SYSTEM  - Доступ пользователей системного КИПа к Глобалам</Data>
</Node>
<Node><Sub>3</Sub>
<Data>           системного Кипа</Data>
</Node>
<Node><Sub>4</Sub>
<Data> WORLD   - Доступ пользователей из других систем к Глобалам</Data>
</Node>
<Node><Sub>5</Sub>
<Data>           вашей системы по системе сетевой распределённой</Data>
</Node>
<Node><Sub>6</Sub>
<Data>           обработке данных (DDP)</Data>
</Node>
<Node><Sub>7</Sub>
<Data> GROUP   - Доступ пользователей из несистемных КИПов</Data>
</Node>
<Node><Sub>8</Sub>
<Data>           к Глобалам других Кипов</Data>
</Node>
<Node><Sub>9</Sub>
<Data> USER    - Доступ пользователей из несистемных КИПов</Data>
</Node>
<Node><Sub>10</Sub>
<Data>           к Глобалам своего Кипа</Data>
</Node>
<Node><Sub>11</Sub>
<Data>               (теперь вам всё понятно ?)</Data>
</Node>
<Node><Sub>User</Sub>
<Node><Sub>MSW98iMS</Sub>
<Data></Data>
</Node>
</Node>
</Node>
<Node><Sub>EditBar</Sub>
<Data><![CDATA[Редактор в окне без рамки@@@@@@@20@1@22@80@1@@@1@@5@@@@@@@@@@@1@510@@2;6;36;40//2;6;33;40/1;6;37;40/1;6;32;40//////176@@@@@@@1]]></Data>
<Node><Sub>1</Sub>
<Data></Data>
</Node>
</Node>
<Node><Sub>ErrorTXT</Sub>
<Data><![CDATA[Ошибка в маленьком тексте@@@@@@@7@3@20@75@1@11111100@@0@@5@@@1@@@ 1@@@@@1@@@1;6;36;41//2;6;33;40@@@@@@@1]]></Data>
<Node><Sub>1</Sub>
<Data></Data>
</Node>
</Node>
<Node><Sub>History</Sub>
<Data><![CDATA[История@@@@@@@5@3@22@75@1@11111100@@1@@5@@@@@@@@@@@1@510@@1;6;32;44//1;6;37;40/2;6;37;44///////32@@@@@@@1]]></Data>
<Node><Sub>1</Sub>
<Data></Data>
</Node>
</Node>
<Node><Sub>LineEdit</Sub>
<Data><![CDATA[Строчный редактор комплекса@@@@@@@20@1@22@80@@11100111@@1@@5@@@@@@@@@@@1@510@@1;6;36;40///1;6;37;40/1;6;37;40//////176@@@@@@@1]]></Data>
<Node><Sub>1</Sub>
<Data></Data>
</Node>
</Node>
<Node><Sub>N1</Sub>
<Data>заготовка очень маленькой таблицы (1x1)@@@@@1@1@1@1@22@80@1@@1@1@@1@@@1@@@@@1@@@1@1@@@@@@@@</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@1@@@@@1@@@@@@</Data>
</Node>
</Node>
<Node><Sub>STA</Sub>
<Data>1,1@1@1@13@-1@-1@1@1@</Data>
</Node>
</Node>
<Node><Sub>N10</Sub>
<Data><![CDATA[заготовка под Pall-Down-Menu (1 Уровень)@@@@@1@1@1@1@22@80@1@@1@@1@1@@2,1@1@@@@@1@@@2@5@@2;6;30;45@@@@@@@@@@PDM^%ZAPM.ed.BSF10(1)@@@@@^["GLAVK"]BS0("oboi")]]></Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@15@@@@@1@@@@@@        Внеочер@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@16@1@15@@@@@1@@@@@@едная оперативная информация управления УрО ВВ МВД России@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>1@31@1@15@@@@@1@@@@@@ая информация у@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>1@46@1@15@@@@@1@@@@@@правления УрО В@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>1@61@1@20@@@@@1@@@@@@В МВД России@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@15@@@@0@1@1;6;34;46@@@@^[&quot;GLAVK&quot;]BS0(3)@БАЗЫ ДАННЫХ@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>2@16@1@15@@@@2,1@1@1;6;34;46@@@@^[&quot;GLAVK&quot;]BS0(1)@СПИСКИ@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>2@31@1@15@@@@2,1@1@1;6;34;46@@@@^[&quot;GLAVK&quot;]BS0(2)@СВОДКИ@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>2@46@1@15@@@@2,1@1@1;6;34;46@@@@^[&quot;GLAVK&quot;]BS0(5)@ПОМОЩЬ@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>2@61@1@20@@@@2,1@1@1;6;34;46@@@@^[&quot;GLAVK&quot;]BS0(6)@ВЫХОД@</Data>
</Node>
</Node>
<Node><Sub>FTR</Sub>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>STA</Sub>
<Data>2,1@2@1@27@-1@-1@2@1@БАЗЫ ДАННЫХ</Data>
</Node>
</Node>
<Node><Sub>N11</Sub>
<Data><![CDATA[заготовка под Pall-Down-Menu (2 Уровень)@@@@@1@1@4@17@9@61@1@@1@@@1@@@1@@@@@@@@6@1@@1;6;32;46@@@@@@@2@@@PDM^%ZAPM.ed.BSF10(2)@@@0]]></Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@45@@@@@1@@@@@@ Новый насчет</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@45@@@@@1@@@@@@ Старые, уже насчитанные сводки@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@45@@@@@1@@@@@@ Смотреть Вид сводки (PreView)@</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>4@1@1@45@@@@@1@2;6;31;46@@@@@ Редактирование сводок@</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>5@1@1@45@@@@@1@2;6;31;46@@@@@ Создание новых сводок@</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>6@1@1@45@@@@@1@2;6;31;46@@@@@ Трансляция и контроль редактированных сводок@</Data>
</Node>
</Node>
<Node><Sub>CMD</Sub>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>D TRANS^%MOLSV</Data>
</Node>
</Node>
</Node>
<Node><Sub>STA</Sub>
<Data>1,1@1@1@27@-1@-1@4@17@ Новый насчет</Data>
</Node>
</Node>
<Node><Sub>N12</Sub>
<Data><![CDATA[заготовка под Параметры@@@@@1@1@2@15@21@67@1@@1@@@1@@@1@@@@@1@@@16@5@@1;6;37;44@@@@@@@2@^%ZAPM.ed.BSDDR("DDRPARMH")@@@@1]]></Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@1@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@2@1@25@@@@@1@2;6;37;44@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>1@27@1@1@@@@@1@2;6;37;44@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>1@28@1@25@@@@@1@2;6;37;44@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>1@53@1@1@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@2@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>2@2@2@25@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>2@27@2@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>2@28@2@25@@@@@1@2;6;34;46@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>2@53@2@1@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>4@1@1@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>4@2@1@25@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>4@27@1@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>4@28@1@25@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>4@53@1@1@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>5@1@2@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>5@2@2@25@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>5@27@2@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>5@28@2@25@@@@@1@2;6;34;46@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>5@53@2@1@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>7@1@1@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>7@2@1@25@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>7@27@1@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>7@28@1@25@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>7@53@1@1@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>8@1@2@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>8@2@2@25@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>8@27@2@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>8@28@2@25@@@@@1@2;6;34;46@@@@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>8@53@2@1@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>10@1@1@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>10@2@1@25@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>10@27@1@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>10@28@1@25@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>10@53@1@1@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>1</Sub>
<Data>11@1@1@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>11@2@1@25@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>11@27@1@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>11@28@1@25@@@@@1@2;6;34;46@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>11@53@1@1@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>1</Sub>
<Data>12@1@1@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>12@2@1@25@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>12@27@1@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>12@28@1@25@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>12@53@1@1@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>1</Sub>
<Data>13@1@2@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>13@2@2@25@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>13@27@2@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>13@28@2@25@@@@@1@2;6;34;46@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>13@53@2@1@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>11</Sub>
<Node><Sub>1</Sub>
<Data>15@1@1@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>15@2@1@25@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>15@27@1@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>15@28@1@25@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>15@53@1@1@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>12</Sub>
<Node><Sub>1</Sub>
<Data>16@1@1@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>16@2@1@25@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>16@27@1@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>16@28@1@25@@@@@1@2;6;34;46@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>16@53@1@1@@@@@1@@@@@@</Data>
</Node>
</Node>
<Node><Sub>13</Sub>
<Node><Sub>1</Sub>
<Data>17@1@1@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>17@2@1@25@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>17@27@1@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>17@28@1@25@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>17@53@1@1@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>14</Sub>
<Node><Sub>1</Sub>
<Data>18@1@1@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>18@2@1@25@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>18@27@1@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>18@28@1@25@@@@@1@2;6;34;46@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>18@53@1@1@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>15</Sub>
<Node><Sub>1</Sub>
<Data>19@1@1@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>19@2@1@25@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>19@27@1@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>19@28@1@25@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>19@53@1@1@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>16</Sub>
<Node><Sub>1</Sub>
<Data>20@1@1@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>20@2@1@25@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>20@27@1@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>20@28@1@25@@@@@1@2;6;34;46@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>20@53@1@1@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>OPT</Sub>
<Data>2,4,2</Data>
</Node>
<Node><Sub>STA</Sub>
<Data>6,4@1@1@27@-1@-1@9@42@</Data>
</Node>
</Node>
<Node><Sub>N13</Sub>
<Data>заготовка ...,генерирующая МикроЗапросы@@@@@1@1@1@1@22@80@1@@1@1@@1@@@1@@@@@@@@17@2@@1;6;35;44@@@@@@</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@2@15@@@@@1@2;6;30;45@@@@@Текст в бокови-не сводки</Data>
</Node>
<Node><Sub>2</Sub>
<Data><![CDATA[1@16@2@65@@@@@1@2;6;30;45@@@@@  Формулы $$TSVV для сводки в формате:$$TSVV("k2=1234")                                           или :k2=1234@]]></Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@15@@@@@1@2;6;30;46@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@16@1@65@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>4@1@1@15@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>4@16@1@65@@@@@1@@@@@@      Порядок создания МикроЗапросов@</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>5@1@1@15@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>5@16@1@65@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>6@1@1@15@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>6@16@1@65@@@@@1@@@@@@ - введите в 1 колонку  Тект в боковине сводки@</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>7@1@1@15@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>7@16@1@65@@@@@1@@@@@@ - введите во 2 колонку Формулы для сводки@</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>8@1@1@15@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>8@16@1@65@@@@@1@@@@@@ - пометьте клавишей &lt;Ins&gt; или + данные и ссылки@</Data>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>1</Sub>
<Data>9@1@1@15@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>9@16@1@65@@@@@1@@@@@@ - установите указатель в колонку данных и F6-СОЗДАТЬ-МикроЗапрос@</Data>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>1</Sub>
<Data>10@1@1@15@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>10@16@1@65@@@@@1@@@@@@ - ответьте на вопросы@</Data>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>1</Sub>
<Data>11@1@1@15@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>11@16@1@65@@@@@1@@@@@@ - установите указатель в колонку ссылок и F6-СОЗДАТЬ-МикроЗапрос@</Data>
</Node>
</Node>
<Node><Sub>11</Sub>
<Node><Sub>1</Sub>
<Data>12@1@1@15@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>12@16@1@65@@@@@1@@@@@@ - ответьте на вопросы и ваши М\Запросы готовы@</Data>
</Node>
</Node>
<Node><Sub>12</Sub>
<Node><Sub>1</Sub>
<Data>13@1@1@15@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>13@16@1@65@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>13</Sub>
<Node><Sub>1</Sub>
<Data>14@1@1@15@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>14@16@1@65@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>14</Sub>
<Node><Sub>1</Sub>
<Data>15@1@1@15@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>15@16@1@65@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>15</Sub>
<Node><Sub>1</Sub>
<Data>16@1@1@15@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>16@16@1@65@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>16</Sub>
<Node><Sub>1</Sub>
<Data>17@1@1@15@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>17@16@1@65@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>17</Sub>
<Node><Sub>1</Sub>
<Data>18@1@1@15@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>18@16@1@65@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>STA</Sub>
<Data>2,1@1@1@13@-1@-1@3@1@</Data>
</Node>
</Node>
<Node><Sub>N14</Sub>
<Data>заготовка для таблицы ТИПА-LINK@@@@@1@1@1@1@22@80@1@@1@1@@6@@1,2@1@@@@@1@@@3@2@@@@@@@@</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@40@@@@@1@@@@@@РАЗДЕЛ (пример:^[&quot;GLAVK&quot;]ABC)</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@41@1@35@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@40@@@@@1@@@@@@ТАБЛИЦА (пример:TABLE)@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>2@41@1@35@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@40@@@@@1@2;6;30;43@@@@@!!!! ЗАГРУЖАТЬ БЕЗ ВОПРОСА О ЗАГРУЗКЕ @</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@41@1@35@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>58227,43745,MS</Data>
</Node>
<Node><Sub>STA</Sub>
<Data>3,2@1@2@13@-1@-1@3@41@</Data>
</Node>
</Node>
<Node><Sub>N15</Sub>
<Data><![CDATA[заготовка под таблицу-описания ключа@@@@@1@1@1@1@22@80@1@@1@1@@1@@@1@@@@@@@@3@1@@2;6;30;46@@@@@@@@@1,3,0]]></Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@75@@@@@1@@@@@@ .. вернуться назад</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@75@@@@@1@2;6;37;44@@@@@ Ввести новый ...@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@75@@@@0@1@1;6;32;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>FTR</Sub>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data><![CDATA[S d1=$S($$A^%ZAPM.ed.BSA(2,1,"SPsb","SBORonly","[""MGR"",""MYY""]","","",$G(%KEYS(1),0),$G(d0))'["N":"       Прибыл   ",1:"")_$P(d0,"~")]]></Data>
<Node><Sub>1</Sub>
<Data><![CDATA[$S({2,1,"SPsb","SBORonly","[""MGR"",""MYY""]","","",$G(%KEYS(1),0),$G(d0)}'["N":"       Прибыл   ",1:"")_$P(d0,"~")]]></Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>STA</Sub>
<Data>1,1@1@1@13@-1@-1@1@1@ .. вернуться назад</Data>
</Node>
</Node>
<Node><Sub>N16</Sub>
<Data>заготовка под одноуровневую базу данных@@@@@1@1@1@1@22@80@1@@1@@@1@@@1@@@@@1@@@7@2@@@@@@@@@@</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@2@20@@@@@1@2;6;35;42@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@21@2@53@@@@0@1@2;6;35;42@@@@@@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>3@1@2@20@@@@@1@2;6;35;42@@@@@      КОМЕНТАРИЙ</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@21@2@53@@@@@2@1;6;33;43@@@@@@@@REM@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>5@1@2@20@@@@@1@2;6;35;42@@@@@    ПРИКРЕПЛЕННАЯ         NAMESPACE@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>5@21@2@53@@@@@2@1;6;33;43@@@@@@@@NSP</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>7@1@2@20@@@@@1@2;6;35;42@@@@@   ФЛАГИ ТЕРМИНАЛА       (F1-ПОМОЩЬ)@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>7@21@2@53@@@@@2@1;6;33;43@@@@@@@@FLG@@</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>9@1@1@20@@@@@1@1;6;32;42@@@@@Инициализация LPT:@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>9@21@1@53@@@@@2@1;6;32;43@@@@@@@@OpenLPT</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>10@1@1@20@@@@@1@1;6;32;42@@@@@Отмена вывода наLPT:@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>10@21@1@53@@@@@2@1;6;32;43@@@@@@@@CloseLPT</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>11@1@2@20@@@@@1@2;6;35;42@@@@@Уникальный идентифи-кационный номер@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>11@21@2@53@@@@0@2@1;6;33;43@@@@@@@@Principal</Data>
</Node>
</Node>
<Node><Sub>FTR</Sub>
<Node><Sub>1</Sub>
<Node><Sub>2</Sub>
<Data>S d1=&quot; ТЕРМИНАЛ № &quot;_$G(k1,&quot;?&quot;)</Data>
<Node><Sub>1</Sub>
<Data>&quot; ТЕРМИНАЛ № &quot;_$G(k1,&quot;?&quot;)</Data>
</Node>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>2</Sub>
<Data>S d1=&quot;  &quot;_$S(d1=&quot;&quot;:$P_&quot; = $P&quot;,1:d1)</Data>
<Node><Sub>1</Sub>
<Data>&quot;  &quot;_$S(d1=&quot;&quot;:$P_&quot; = $P&quot;,1:d1)</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>Free</Sub>
<Data>58348,43647</Data>
</Node>
<Node><Sub>LST</Sub>
<Data>58348,43723,MS</Data>
</Node>
<Node><Sub>STA</Sub>
<Data>2,2@1@1@27@-1@-1@3@21@</Data>
</Node>
</Node>
<Node><Sub>N2</Sub>
<Data>заготовка под таблицу-меню@@@@@@1@1@1@22@80@1@@1@1@@1@@@1@@@@@@@@17@1@@2;6;30;46@@@@@@</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@55@@@@0@1@@@@@@ДЛЯ ТОГО, ЧТОБЫ ДАННАЯ ТАБЛИЦА</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@55@@@@1,1@1@@@@@@СТАЛА</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@55@@@@1,1@1@@@@@@ПОЛЬЗОВАТЕЛЬСКИМ МЕНЮ,@</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>4@1@1@55@@@@1,1@1@@@@@@НЕОБХОДИМО:@</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>5@1@1@55@@@@1,1@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>6@1@1@55@@@@1,1@1@@@@@@1.ВОЙТИ В РЕЖИМ РЕДАКТИРОВАНИЯ ОПИСАНИЯ ТАБЛИЫ (F4)@</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>7@1@1@55@@@@1,1@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>1</Sub>
<Data>8@1@1@55@@@@1,1@1@@@@@@2.ВОЙТИ В ПОДРЕЖИМ (ОПЦ) - РЕДАКТИРОВАНИЕ ОПЦИЙ   @</Data>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>1</Sub>
<Data>9@1@1@55@@@@1,1@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>1</Sub>
<Data>10@1@1@55@@@@1,1@1@@@@@@3.ВОЙТИ В ПОДРЕЖИМ (ТИП)@</Data>
</Node>
</Node>
<Node><Sub>11</Sub>
<Node><Sub>1</Sub>
<Data>11@1@1@55@@@@1,1@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>12</Sub>
<Node><Sub>1</Sub>
<Data>12@1@1@55@@@@1,1@1@@@@@@4.ВОЙТИ В ПОДРЕЖИМ (ПОЛЬЗОВАТЕЛЬСКОЕ МЕНЮ)@</Data>
</Node>
</Node>
<Node><Sub>13</Sub>
<Node><Sub>1</Sub>
<Data>13@1@1@55@@@@1,1@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>14</Sub>
<Node><Sub>1</Sub>
<Data>14@1@1@55@@@@1,1@1@@@@@@5.ВОЙТИ В ПОДРЕЖИМ (ВКЛЮЧИТЬ)@</Data>
</Node>
</Node>
<Node><Sub>15</Sub>
<Node><Sub>1</Sub>
<Data>15@1@1@55@@@@1,1@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>16</Sub>
<Node><Sub>1</Sub>
<Data>16@1@1@55@@@@1,1@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>17</Sub>
<Node><Sub>1</Sub>
<Data>17@1@1@55@@@@1,1@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>FTR</Sub>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>STA</Sub>
<Data>17,1@1@1@13@-1@-1@17@1@</Data>
</Node>
</Node>
<Node><Sub>N3</Sub>
<Data><![CDATA[заготовка под текст во весь экpан@@@@@@@1@1@22@80@@@@1@@5@@@1@@@ 1@@@@@4@@@1;6;37;44//1;6;36;40@@@@@@@1]]></Data>
<Node><Sub>1</Sub>
<Data></Data>
</Node>
<Node><Sub>2</Sub>
<Data>                        ДОБРО ПОЖАЛОВАТЬ    В    ТЕКСТЫ</Data>
</Node>
<Node><Sub>3</Sub>
<Data>                      ДЛЯ МОДИФИКАЦИИ ТЕКСТА ВВЕДИТЕ (F4)</Data>
</Node>
<Node><Sub>4</Sub>
<Data>                       ДЛЯ ВЫЗОВА ПОМОЩИ , ВВЕДИТЕ  (F1)</Data>
</Node>
</Node>
<Node><Sub>N4</Sub>
<Data>заготовка под маленький текст@@@@@@@7@10@19@70@@@@1@@5@@@1@@@ 1@@@@@@@@1;6;37;44//2;6;33;40@@@@@@@1</Data>
<Node><Sub>1</Sub>
<Data></Data>
</Node>
<Node><Sub>2</Sub>
<Data></Data>
</Node>
<Node><Sub>3</Sub>
<Data></Data>
</Node>
<Node><Sub>4</Sub>
<Data></Data>
</Node>
<Node><Sub>5</Sub>
<Data></Data>
</Node>
<Node><Sub>6</Sub>
<Data></Data>
</Node>
<Node><Sub>7</Sub>
<Data></Data>
</Node>
<Node><Sub>8</Sub>
<Data></Data>
</Node>
<Node><Sub>9</Sub>
<Data></Data>
</Node>
<Node><Sub>10</Sub>
<Data></Data>
</Node>
<Node><Sub>11</Sub>
<Data></Data>
</Node>
</Node>
<Node><Sub>N5</Sub>
<Data><![CDATA[заготовка под Блок-меню или Панель с кнопками@@@@@1@1@1@1@22@80@1@@1@1@@1@@@1@@@@@@@@5@6@@2;6;37;44@@@@@@@@^%ZAPM.ed.BSHLP("HELP-ALTF2")]]></Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@10@@@@@1@@@@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@11@1@10@@@@@1@1;6;32;44@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>1@21@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>1@31@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>1@41@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>6</Sub>
<Data>1@51@1@10@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@10@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>2@11@1@10@@@@@1@1;6;32;44@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>2@21@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>2@31@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>2@41@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>6</Sub>
<Data>2@51@1@10@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@11@1@10@@@@@1@1;6;32;44@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>3@21@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>3@31@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>3@41@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>6</Sub>
<Data>3@51@1@10@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>4@1@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>4@11@1@10@@@@@1@1;6;32;44@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>4@21@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>4@31@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>4@41@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>6</Sub>
<Data>4@51@1@10@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>5@1@1@10@@@@@1@@@@@@Если не@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>5@11@1@10@@@@@1@@@@@@знаете,что@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>5@21@1@10@@@@@1@@@@@@ делать -@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>5@31@1@10@@@@@1@@@@@@введите@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>5@41@1@10@@@@@1@@@@@@&lt;F1&gt;@</Data>
</Node>
<Node><Sub>6</Sub>
<Data>5@51@1@10@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>STA</Sub>
<Data>1,2@1@1@13@-1@-1@1@11@</Data>
</Node>
</Node>
<Node><Sub>N6</Sub>
<Data>заготовка маленькой таблицы-меню@@@@@@1@3@17@19@56@1@@1@1@@1@@@1@@@@@@@@17@1@@@@@@@@@2</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@40@@@@0@1@@@@@@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@40@@@@0@1@@@@@@=============================================</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@40@@@@0@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>4@1@1@40@@@@0@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>5@1@1@40@@@@0@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>6@1@1@40@@@@0@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>7@1@1@40@@@@0@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>1</Sub>
<Data>8@1@1@40@@@@0@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>1</Sub>
<Data>9@1@1@40@@@@0@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>1</Sub>
<Data>10@1@1@40@@@@0@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>11</Sub>
<Node><Sub>1</Sub>
<Data>11@1@1@40@@@@0@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>12</Sub>
<Node><Sub>1</Sub>
<Data>12@1@1@40@@@@0@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>13</Sub>
<Node><Sub>1</Sub>
<Data>13@1@1@40@@@@0@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>14</Sub>
<Node><Sub>1</Sub>
<Data>14@1@1@40@@@@0@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>15</Sub>
<Node><Sub>1</Sub>
<Data>15@1@1@40@@@@0@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>16</Sub>
<Node><Sub>1</Sub>
<Data>16@1@1@40@@@@0@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>17</Sub>
<Node><Sub>1</Sub>
<Data>17@1@1@40@@@@0@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>FTR</Sub>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>11</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>12</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>13</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>14</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>15</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>16</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>17</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>STA</Sub>
<Data>6,1@1@1@13@-1@-1@8@17@</Data>
</Node>
</Node>
<Node><Sub>N7</Sub>
<Data>заготовка стандаpтной таблицы@@@@@1@1@1@1@22@80@1@@1@1@@1@@@1@@@@@1@@@16@21@@@@@@@@@@@@@@1</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@1@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@2@1@8@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>1@10@1@1@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>1@11@1@6@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>1@17@1@1@@@@@1@@@@@@С</Data>
</Node>
<Node><Sub>6</Sub>
<Data>1@18@1@6@@@@@1@@@@@@ТАНДАР</Data>
</Node>
<Node><Sub>7</Sub>
<Data>1@24@1@1@@@@@1@@@@@@Т</Data>
</Node>
<Node><Sub>8</Sub>
<Data>1@25@1@6@@@@@1@@@@@@НАЯ</Data>
</Node>
<Node><Sub>9</Sub>
<Data>1@31@1@1@@@@@1@@@@@@Э</Data>
</Node>
<Node><Sub>10</Sub>
<Data>1@32@1@6@@@@@1@@@@@@ЛЕКТРОН</Data>
</Node>
<Node><Sub>11</Sub>
<Data>1@38@1@1@@@@@1@@@@@@Н</Data>
</Node>
<Node><Sub>12</Sub>
<Data>1@39@1@6@@@@@1@@@@@@НАЯ</Data>
</Node>
<Node><Sub>13</Sub>
<Data>1@45@1@1@@@@@1@@@@@@Т</Data>
</Node>
<Node><Sub>14</Sub>
<Data>1@46@1@6@@@@@1@@@@@@АБЛИЦА</Data>
</Node>
<Node><Sub>15</Sub>
<Data>1@52@1@1@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>16</Sub>
<Data>1@53@1@6@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>17</Sub>
<Data>1@59@1@1@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>18</Sub>
<Data>1@60@1@6@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>19</Sub>
<Data>1@66@1@1@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>20</Sub>
<Data>1@67@1@7@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>21</Sub>
<Data>1@74@1@1@@@@@1@@@@@@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@1@@@@@1@@@@@@=</Data>
</Node>
<Node><Sub>2</Sub>
<Data>2@2@1@8@@@@0@1@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>2@10@1@1@@@@@1@@@@@@=</Data>
</Node>
<Node><Sub>4</Sub>
<Data>2@11@1@6@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>2@17@1@1@@@@@1@@@@@@=</Data>
</Node>
<Node><Sub>6</Sub>
<Data>2@18@1@6@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>7</Sub>
<Data>2@24@1@1@@@@@1@@@@@@=</Data>
</Node>
<Node><Sub>8</Sub>
<Data>2@25@1@6@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>9</Sub>
<Data>2@31@1@1@@@@@1@@@@@@=</Data>
</Node>
<Node><Sub>10</Sub>
<Data>2@32@1@6@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>11</Sub>
<Data>2@38@1@1@@@@@1@@@@@@=</Data>
</Node>
<Node><Sub>12</Sub>
<Data>2@39@1@6@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>13</Sub>
<Data>2@45@1@1@@@@@1@@@@@@=</Data>
</Node>
<Node><Sub>14</Sub>
<Data>2@46@1@6@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>15</Sub>
<Data>2@52@1@1@@@@@1@@@@@@=</Data>
</Node>
<Node><Sub>16</Sub>
<Data>2@53@1@6@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>17</Sub>
<Data>2@59@1@1@@@@@1@@@@@@=</Data>
</Node>
<Node><Sub>18</Sub>
<Data>2@60@1@6@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>19</Sub>
<Data>2@66@1@1@@@@@1@@@@@@=</Data>
</Node>
<Node><Sub>20</Sub>
<Data>2@67@1@7@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>21</Sub>
<Data>2@74@1@1@@@@@1@@@@@@=</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>3@1@3@1@@@@0@1@@@@@@|||</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@2@3@8@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>3@10@3@1@@@@3,1@1@@@@@@|||</Data>
</Node>
<Node><Sub>4</Sub>
<Data>3@11@3@6@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>3@17@3@1@@@@0@1@@@@@@|||</Data>
</Node>
<Node><Sub>6</Sub>
<Data>3@18@3@6@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>7</Sub>
<Data>3@24@3@1@@@@3,5@1@@@@@@|||</Data>
</Node>
<Node><Sub>8</Sub>
<Data>3@25@3@6@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>9</Sub>
<Data>3@31@3@1@@@@3,5@1@@@@@@|||</Data>
</Node>
<Node><Sub>10</Sub>
<Data>3@32@3@6@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>11</Sub>
<Data>3@38@3@1@@@@3,5@1@@@@@@|||</Data>
</Node>
<Node><Sub>12</Sub>
<Data>3@39@3@6@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>13</Sub>
<Data>3@45@3@1@@@@3,5@1@@@@@@|||</Data>
</Node>
<Node><Sub>14</Sub>
<Data>3@46@3@6@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>15</Sub>
<Data>3@52@3@1@@@@3,5@1@@@@@@|||</Data>
</Node>
<Node><Sub>16</Sub>
<Data>3@53@3@6@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>17</Sub>
<Data>3@59@3@1@@@@3,5@1@@@@@@|||</Data>
</Node>
<Node><Sub>18</Sub>
<Data>3@60@3@6@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>19</Sub>
<Data>3@66@3@1@@@@3,5@1@@@@@@|||</Data>
</Node>
<Node><Sub>20</Sub>
<Data>3@67@3@7@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>21</Sub>
<Data>3@74@3@1@@@@3,1@1@@@@@@|||</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>6@1@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>2</Sub>
<Data>6@2@1@8@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>6@10@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>4</Sub>
<Data>6@11@1@6@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>6@17@1@1@@@@@1@@@@@@=</Data>
</Node>
<Node><Sub>6</Sub>
<Data>6@18@1@6@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>7</Sub>
<Data>6@24@1@1@@@@@1@@@@@@=</Data>
</Node>
<Node><Sub>8</Sub>
<Data>6@25@1@6@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>9</Sub>
<Data>6@31@1@1@@@@@1@@@@@@=</Data>
</Node>
<Node><Sub>10</Sub>
<Data>6@32@1@6@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>11</Sub>
<Data>6@38@1@1@@@@@1@@@@@@=</Data>
</Node>
<Node><Sub>12</Sub>
<Data>6@39@1@6@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>13</Sub>
<Data>6@45@1@1@@@@@1@@@@@@=</Data>
</Node>
<Node><Sub>14</Sub>
<Data>6@46@1@6@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>15</Sub>
<Data>6@52@1@1@@@@@1@@@@@@=</Data>
</Node>
<Node><Sub>16</Sub>
<Data>6@53@1@6@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>17</Sub>
<Data>6@59@1@1@@@@@1@@@@@@=</Data>
</Node>
<Node><Sub>18</Sub>
<Data>6@60@1@6@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>19</Sub>
<Data>6@66@1@1@@@@@1@@@@@@=</Data>
</Node>
<Node><Sub>20</Sub>
<Data>6@67@1@7@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>21</Sub>
<Data>6@74@1@1@@@@@1@@@@@@|</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>7@1@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>2</Sub>
<Data>7@2@1@8@@@@@1@@@@@@  1</Data>
</Node>
<Node><Sub>3</Sub>
<Data>7@10@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>4</Sub>
<Data>7@11@1@6@@@@@1@@@@@@   2</Data>
</Node>
<Node><Sub>5</Sub>
<Data>7@17@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>6</Sub>
<Data>7@18@1@6@@@@@1@@@@@@  3</Data>
</Node>
<Node><Sub>7</Sub>
<Data>7@24@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>8</Sub>
<Data>7@25@1@6@@@@@1@@@@@@  4</Data>
</Node>
<Node><Sub>9</Sub>
<Data>7@31@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>10</Sub>
<Data>7@32@1@6@@@@@1@@@@@@  5</Data>
</Node>
<Node><Sub>11</Sub>
<Data>7@38@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>12</Sub>
<Data>7@39@1@6@@@@@1@@@@@@  6</Data>
</Node>
<Node><Sub>13</Sub>
<Data>7@45@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>14</Sub>
<Data>7@46@1@6@@@@@1@@@@@@  7</Data>
</Node>
<Node><Sub>15</Sub>
<Data>7@52@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>16</Sub>
<Data>7@53@1@6@@@@@1@@@@@@  8</Data>
</Node>
<Node><Sub>17</Sub>
<Data>7@59@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>18</Sub>
<Data>7@60@1@6@@@@@1@@@@@@  9</Data>
</Node>
<Node><Sub>19</Sub>
<Data>7@66@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>20</Sub>
<Data>7@67@1@7@@@@@1@@@@@@  10</Data>
</Node>
<Node><Sub>21</Sub>
<Data>7@74@1@1@@@@@1@@@@@@|</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>8@1@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>2</Sub>
<Data>8@2@1@8@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>8@10@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>4</Sub>
<Data>8@11@1@6@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>8@17@1@1@@@@@1@@@@@@=</Data>
</Node>
<Node><Sub>6</Sub>
<Data>8@18@1@6@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>7</Sub>
<Data>8@24@1@1@@@@@1@@@@@@=</Data>
</Node>
<Node><Sub>8</Sub>
<Data>8@25@1@6@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>9</Sub>
<Data>8@31@1@1@@@@@1@@@@@@=</Data>
</Node>
<Node><Sub>10</Sub>
<Data>8@32@1@6@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>11</Sub>
<Data>8@38@1@1@@@@@1@@@@@@=</Data>
</Node>
<Node><Sub>12</Sub>
<Data>8@39@1@6@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>13</Sub>
<Data>8@45@1@1@@@@@1@@@@@@=</Data>
</Node>
<Node><Sub>14</Sub>
<Data>8@46@1@6@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>15</Sub>
<Data>8@52@1@1@@@@@1@@@@@@=</Data>
</Node>
<Node><Sub>16</Sub>
<Data>8@53@1@6@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>17</Sub>
<Data>8@59@1@1@@@@@1@@@@@@=</Data>
</Node>
<Node><Sub>18</Sub>
<Data>8@60@1@6@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>19</Sub>
<Data>8@66@1@1@@@@@1@@@@@@=</Data>
</Node>
<Node><Sub>20</Sub>
<Data>8@67@1@7@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>21</Sub>
<Data>8@74@1@1@@@@@1@@@@@@|</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>9@1@1@1@@@@0@1@@@@@@|</Data>
</Node>
<Node><Sub>2</Sub>
<Data>9@2@1@8@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>9@10@1@1@@@@7,1@1@@@@@@|</Data>
</Node>
<Node><Sub>4</Sub>
<Data>9@11@1@6@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>9@17@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>6</Sub>
<Data>9@18@1@6@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>7</Sub>
<Data>9@24@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>8</Sub>
<Data>9@25@1@6@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>9</Sub>
<Data>9@31@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>10</Sub>
<Data>9@32@1@6@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>11</Sub>
<Data>9@38@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>12</Sub>
<Data>9@39@1@6@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>13</Sub>
<Data>9@45@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>14</Sub>
<Data>9@46@1@6@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>15</Sub>
<Data>9@52@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>16</Sub>
<Data>9@53@1@6@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>17</Sub>
<Data>9@59@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>18</Sub>
<Data>9@60@1@6@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>19</Sub>
<Data>9@66@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>20</Sub>
<Data>9@67@1@7@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>21</Sub>
<Data>9@74@1@1@@@@7,1@1@@@@@@|</Data>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>1</Sub>
<Data>10@1@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>2</Sub>
<Data>10@2@1@8@@@@0@1@@@@@@---</Data>
</Node>
<Node><Sub>3</Sub>
<Data>10@10@1@1@@@@@1@@@@@@-</Data>
</Node>
<Node><Sub>4</Sub>
<Data>10@11@1@6@@@@8,2@1@@@@@@------</Data>
</Node>
<Node><Sub>5</Sub>
<Data>10@17@1@1@@@@@1@@@@@@+</Data>
</Node>
<Node><Sub>6</Sub>
<Data>10@18@1@6@@@@8,2@1@@@@@@------</Data>
</Node>
<Node><Sub>7</Sub>
<Data>10@24@1@1@@@@@1@@@@@@+</Data>
</Node>
<Node><Sub>8</Sub>
<Data>10@25@1@6@@@@8,2@1@@@@@@------</Data>
</Node>
<Node><Sub>9</Sub>
<Data>10@31@1@1@@@@@1@@@@@@+</Data>
</Node>
<Node><Sub>10</Sub>
<Data>10@32@1@6@@@@8,2@1@@@@@@------</Data>
</Node>
<Node><Sub>11</Sub>
<Data>10@38@1@1@@@@@1@@@@@@+</Data>
</Node>
<Node><Sub>12</Sub>
<Data>10@39@1@6@@@@8,2@1@@@@@@------</Data>
</Node>
<Node><Sub>13</Sub>
<Data>10@45@1@1@@@@@1@@@@@@+</Data>
</Node>
<Node><Sub>14</Sub>
<Data>10@46@1@6@@@@8,2@1@@@@@@------</Data>
</Node>
<Node><Sub>15</Sub>
<Data>10@52@1@1@@@@@1@@@@@@+</Data>
</Node>
<Node><Sub>16</Sub>
<Data>10@53@1@6@@@@8,2@1@@@@@@------</Data>
</Node>
<Node><Sub>17</Sub>
<Data>10@59@1@1@@@@@1@@@@@@+</Data>
</Node>
<Node><Sub>18</Sub>
<Data>10@60@1@6@@@@8,2@1@@@@@@------</Data>
</Node>
<Node><Sub>19</Sub>
<Data>10@66@1@1@@@@@1@@@@@@+</Data>
</Node>
<Node><Sub>20</Sub>
<Data>10@67@1@7@@@@8,2@1@@@@@@-------</Data>
</Node>
<Node><Sub>21</Sub>
<Data>10@74@1@1@@@@@1@@@@@@|</Data>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>1</Sub>
<Data>11@1@1@1@@@@7,1@1@@@@@@|</Data>
</Node>
<Node><Sub>2</Sub>
<Data>11@2@1@8@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>11@10@1@1@@@@7,1@1@@@@@@|</Data>
</Node>
<Node><Sub>4</Sub>
<Data>11@11@1@6@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>11@17@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>6</Sub>
<Data>11@18@1@6@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>7</Sub>
<Data>11@24@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>8</Sub>
<Data>11@25@1@6@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>9</Sub>
<Data>11@31@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>10</Sub>
<Data>11@32@1@6@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>11</Sub>
<Data>11@38@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>12</Sub>
<Data>11@39@1@6@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>13</Sub>
<Data>11@45@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>14</Sub>
<Data>11@46@1@6@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>15</Sub>
<Data>11@52@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>16</Sub>
<Data>11@53@1@6@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>17</Sub>
<Data>11@59@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>18</Sub>
<Data>11@60@1@6@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>19</Sub>
<Data>11@66@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>20</Sub>
<Data>11@67@1@7@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>21</Sub>
<Data>11@74@1@1@@@@7,1@1@@@@@@|</Data>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>1</Sub>
<Data>12@1@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>2</Sub>
<Data>12@2@1@8@@@@8,2@1@@@@@@---</Data>
</Node>
<Node><Sub>3</Sub>
<Data>12@10@1@1@@@@@1@@@@@@-</Data>
</Node>
<Node><Sub>4</Sub>
<Data>12@11@1@6@@@@8,2@1@@@@@@------</Data>
</Node>
<Node><Sub>5</Sub>
<Data>12@17@1@1@@@@@1@@@@@@+</Data>
</Node>
<Node><Sub>6</Sub>
<Data>12@18@1@6@@@@8,2@1@@@@@@------</Data>
</Node>
<Node><Sub>7</Sub>
<Data>12@24@1@1@@@@@1@@@@@@+</Data>
</Node>
<Node><Sub>8</Sub>
<Data>12@25@1@6@@@@8,2@1@@@@@@------</Data>
</Node>
<Node><Sub>9</Sub>
<Data>12@31@1@1@@@@@1@@@@@@+</Data>
</Node>
<Node><Sub>10</Sub>
<Data>12@32@1@6@@@@8,2@1@@@@@@------</Data>
</Node>
<Node><Sub>11</Sub>
<Data>12@38@1@1@@@@@1@@@@@@+</Data>
</Node>
<Node><Sub>12</Sub>
<Data>12@39@1@6@@@@8,2@1@@@@@@------</Data>
</Node>
<Node><Sub>13</Sub>
<Data>12@45@1@1@@@@@1@@@@@@+</Data>
</Node>
<Node><Sub>14</Sub>
<Data>12@46@1@6@@@@8,2@1@@@@@@------</Data>
</Node>
<Node><Sub>15</Sub>
<Data>12@52@1@1@@@@@1@@@@@@+</Data>
</Node>
<Node><Sub>16</Sub>
<Data>12@53@1@6@@@@8,2@1@@@@@@------</Data>
</Node>
<Node><Sub>17</Sub>
<Data>12@59@1@1@@@@@1@@@@@@+</Data>
</Node>
<Node><Sub>18</Sub>
<Data>12@60@1@6@@@@8,2@1@@@@@@------</Data>
</Node>
<Node><Sub>19</Sub>
<Data>12@66@1@1@@@@@1@@@@@@+</Data>
</Node>
<Node><Sub>20</Sub>
<Data>12@67@1@7@@@@8,2@1@@@@@@-------</Data>
</Node>
<Node><Sub>21</Sub>
<Data>12@74@1@1@@@@@1@@@@@@|</Data>
</Node>
</Node>
<Node><Sub>11</Sub>
<Node><Sub>1</Sub>
<Data>13@1@1@1@@@@7,1@1@@@@@@|</Data>
</Node>
<Node><Sub>2</Sub>
<Data>13@2@1@8@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>13@10@1@1@@@@7,1@1@@@@@@|</Data>
</Node>
<Node><Sub>4</Sub>
<Data>13@11@1@6@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>13@17@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>6</Sub>
<Data>13@18@1@6@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>7</Sub>
<Data>13@24@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>8</Sub>
<Data>13@25@1@6@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>9</Sub>
<Data>13@31@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>10</Sub>
<Data>13@32@1@6@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>11</Sub>
<Data>13@38@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>12</Sub>
<Data>13@39@1@6@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>13</Sub>
<Data>13@45@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>14</Sub>
<Data>13@46@1@6@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>15</Sub>
<Data>13@52@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>16</Sub>
<Data>13@53@1@6@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>17</Sub>
<Data>13@59@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>18</Sub>
<Data>13@60@1@6@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>19</Sub>
<Data>13@66@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>20</Sub>
<Data>13@67@1@7@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>21</Sub>
<Data>13@74@1@1@@@@7,1@1@@@@@@|</Data>
</Node>
</Node>
<Node><Sub>12</Sub>
<Node><Sub>1</Sub>
<Data>14@1@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>2</Sub>
<Data>14@2@1@8@@@@8,2@1@@@@@@---</Data>
</Node>
<Node><Sub>3</Sub>
<Data>14@10@1@1@@@@@1@@@@@@-</Data>
</Node>
<Node><Sub>4</Sub>
<Data>14@11@1@6@@@@8,2@1@@@@@@------</Data>
</Node>
<Node><Sub>5</Sub>
<Data>14@17@1@1@@@@@1@@@@@@+</Data>
</Node>
<Node><Sub>6</Sub>
<Data>14@18@1@6@@@@8,2@1@@@@@@------</Data>
</Node>
<Node><Sub>7</Sub>
<Data>14@24@1@1@@@@@1@@@@@@+</Data>
</Node>
<Node><Sub>8</Sub>
<Data>14@25@1@6@@@@8,2@1@@@@@@------</Data>
</Node>
<Node><Sub>9</Sub>
<Data>14@31@1@1@@@@@1@@@@@@+</Data>
</Node>
<Node><Sub>10</Sub>
<Data>14@32@1@6@@@@8,2@1@@@@@@------</Data>
</Node>
<Node><Sub>11</Sub>
<Data>14@38@1@1@@@@@1@@@@@@+</Data>
</Node>
<Node><Sub>12</Sub>
<Data>14@39@1@6@@@@8,2@1@@@@@@------</Data>
</Node>
<Node><Sub>13</Sub>
<Data>14@45@1@1@@@@@1@@@@@@+</Data>
</Node>
<Node><Sub>14</Sub>
<Data>14@46@1@6@@@@8,2@1@@@@@@------</Data>
</Node>
<Node><Sub>15</Sub>
<Data>14@52@1@1@@@@@1@@@@@@+</Data>
</Node>
<Node><Sub>16</Sub>
<Data>14@53@1@6@@@@8,2@1@@@@@@------</Data>
</Node>
<Node><Sub>17</Sub>
<Data>14@59@1@1@@@@@1@@@@@@+</Data>
</Node>
<Node><Sub>18</Sub>
<Data>14@60@1@6@@@@8,2@1@@@@@@------</Data>
</Node>
<Node><Sub>19</Sub>
<Data>14@66@1@1@@@@@1@@@@@@+</Data>
</Node>
<Node><Sub>20</Sub>
<Data>14@67@1@7@@@@8,2@1@@@@@@-------</Data>
</Node>
<Node><Sub>21</Sub>
<Data>14@74@1@1@@@@@1@@@@@@|</Data>
</Node>
</Node>
<Node><Sub>13</Sub>
<Node><Sub>1</Sub>
<Data>15@1@1@1@@@@7,1@1@@@@@@|</Data>
</Node>
<Node><Sub>2</Sub>
<Data>15@2@1@8@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>15@10@1@1@@@@7,1@1@@@@@@|</Data>
</Node>
<Node><Sub>4</Sub>
<Data>15@11@1@6@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>15@17@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>6</Sub>
<Data>15@18@1@6@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>7</Sub>
<Data>15@24@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>8</Sub>
<Data>15@25@1@6@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>9</Sub>
<Data>15@31@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>10</Sub>
<Data>15@32@1@6@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>11</Sub>
<Data>15@38@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>12</Sub>
<Data>15@39@1@6@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>13</Sub>
<Data>15@45@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>14</Sub>
<Data>15@46@1@6@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>15</Sub>
<Data>15@52@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>16</Sub>
<Data>15@53@1@6@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>17</Sub>
<Data>15@59@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>18</Sub>
<Data>15@60@1@6@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>19</Sub>
<Data>15@66@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>20</Sub>
<Data>15@67@1@7@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>21</Sub>
<Data>15@74@1@1@@@@7,1@1@@@@@@|</Data>
</Node>
</Node>
<Node><Sub>14</Sub>
<Node><Sub>1</Sub>
<Data>16@1@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>2</Sub>
<Data>16@2@1@8@@@@8,2@1@@@@@@---</Data>
</Node>
<Node><Sub>3</Sub>
<Data>16@10@1@1@@@@@1@@@@@@-</Data>
</Node>
<Node><Sub>4</Sub>
<Data>16@11@1@6@@@@8,2@1@@@@@@------</Data>
</Node>
<Node><Sub>5</Sub>
<Data>16@17@1@1@@@@@1@@@@@@+</Data>
</Node>
<Node><Sub>6</Sub>
<Data>16@18@1@6@@@@8,2@1@@@@@@------</Data>
</Node>
<Node><Sub>7</Sub>
<Data>16@24@1@1@@@@@1@@@@@@+</Data>
</Node>
<Node><Sub>8</Sub>
<Data>16@25@1@6@@@@8,2@1@@@@@@------</Data>
</Node>
<Node><Sub>9</Sub>
<Data>16@31@1@1@@@@@1@@@@@@+</Data>
</Node>
<Node><Sub>10</Sub>
<Data>16@32@1@6@@@@8,2@1@@@@@@------</Data>
</Node>
<Node><Sub>11</Sub>
<Data>16@38@1@1@@@@@1@@@@@@+</Data>
</Node>
<Node><Sub>12</Sub>
<Data>16@39@1@6@@@@8,2@1@@@@@@------</Data>
</Node>
<Node><Sub>13</Sub>
<Data>16@45@1@1@@@@@1@@@@@@+</Data>
</Node>
<Node><Sub>14</Sub>
<Data>16@46@1@6@@@@8,2@1@@@@@@------</Data>
</Node>
<Node><Sub>15</Sub>
<Data>16@52@1@1@@@@@1@@@@@@+</Data>
</Node>
<Node><Sub>16</Sub>
<Data>16@53@1@6@@@@8,2@1@@@@@@------</Data>
</Node>
<Node><Sub>17</Sub>
<Data>16@59@1@1@@@@@1@@@@@@+</Data>
</Node>
<Node><Sub>18</Sub>
<Data>16@60@1@6@@@@8,2@1@@@@@@------</Data>
</Node>
<Node><Sub>19</Sub>
<Data>16@66@1@1@@@@@1@@@@@@+</Data>
</Node>
<Node><Sub>20</Sub>
<Data>16@67@1@7@@@@8,2@1@@@@@@-------</Data>
</Node>
<Node><Sub>21</Sub>
<Data>16@74@1@1@@@@@1@@@@@@|</Data>
</Node>
</Node>
<Node><Sub>15</Sub>
<Node><Sub>1</Sub>
<Data>17@1@1@1@@@@7,1@1@@@@@@|</Data>
</Node>
<Node><Sub>2</Sub>
<Data>17@2@1@8@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>17@10@1@1@@@@7,1@1@@@@@@|</Data>
</Node>
<Node><Sub>4</Sub>
<Data>17@11@1@6@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>17@17@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>6</Sub>
<Data>17@18@1@6@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>7</Sub>
<Data>17@24@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>8</Sub>
<Data>17@25@1@6@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>9</Sub>
<Data>17@31@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>10</Sub>
<Data>17@32@1@6@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>11</Sub>
<Data>17@38@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>12</Sub>
<Data>17@39@1@6@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>13</Sub>
<Data>17@45@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>14</Sub>
<Data>17@46@1@6@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>15</Sub>
<Data>17@52@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>16</Sub>
<Data>17@53@1@6@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>17</Sub>
<Data>17@59@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>18</Sub>
<Data>17@60@1@6@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>19</Sub>
<Data>17@66@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>20</Sub>
<Data>17@67@1@7@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>21</Sub>
<Data>17@74@1@1@@@@7,1@1@@@@@@|</Data>
</Node>
</Node>
<Node><Sub>16</Sub>
<Node><Sub>1</Sub>
<Data>18@1@1@1@@@@@1@@@@@@=</Data>
</Node>
<Node><Sub>2</Sub>
<Data>18@2@1@8@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>18@10@1@1@@@@@1@@@@@@=</Data>
</Node>
<Node><Sub>4</Sub>
<Data>18@11@1@6@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>18@17@1@1@@@@@1@@@@@@=</Data>
</Node>
<Node><Sub>6</Sub>
<Data>18@18@1@6@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>7</Sub>
<Data>18@24@1@1@@@@@1@@@@@@=</Data>
</Node>
<Node><Sub>8</Sub>
<Data>18@25@1@6@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>9</Sub>
<Data>18@31@1@1@@@@@1@@@@@@=</Data>
</Node>
<Node><Sub>10</Sub>
<Data>18@32@1@6@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>11</Sub>
<Data>18@38@1@1@@@@@1@@@@@@=</Data>
</Node>
<Node><Sub>12</Sub>
<Data>18@39@1@6@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>13</Sub>
<Data>18@45@1@1@@@@@1@@@@@@=</Data>
</Node>
<Node><Sub>14</Sub>
<Data>18@46@1@6@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>15</Sub>
<Data>18@52@1@1@@@@@1@@@@@@=</Data>
</Node>
<Node><Sub>16</Sub>
<Data>18@53@1@6@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>17</Sub>
<Data>18@59@1@1@@@@@1@@@@@@=</Data>
</Node>
<Node><Sub>18</Sub>
<Data>18@60@1@6@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>19</Sub>
<Data>18@66@1@1@@@@@1@@@@@@=</Data>
</Node>
<Node><Sub>20</Sub>
<Data>18@67@1@7@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>21</Sub>
<Data>18@74@1@1@@@@@1@@@@@@=</Data>
</Node>
</Node>
<Node><Sub>FTR</Sub>
<Node><Sub>2</Sub>
<Node><Sub>2</Sub>
<Data>S d1=$TR($J(&quot;&quot;,20),&quot; &quot;,&quot;=&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$TR($J(&quot;&quot;,20),&quot; &quot;,&quot;=&quot;)</Data>
</Node>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$TR($J(&quot;&quot;,10),&quot; &quot;,&quot;|&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$TR($J(&quot;&quot;,10),&quot; &quot;,&quot;|&quot;)</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Data>S d1=$TR($J(&quot;&quot;,10),&quot; &quot;,&quot;|&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$TR($J(&quot;&quot;,10),&quot; &quot;,&quot;|&quot;)</Data>
</Node>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$TR($J(&quot;&quot;,5),&quot; &quot;,&quot;|&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$TR($J(&quot;&quot;,5),&quot; &quot;,&quot;|&quot;)</Data>
</Node>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>2</Sub>
<Data>S d1=$TR($J(&quot;&quot;,20),&quot; &quot;,&quot;-&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$TR($J(&quot;&quot;,20),&quot; &quot;,&quot;-&quot;)</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>STA</Sub>
<Data>16,15@1@1@13@-1@-1@18@52@=</Data>
</Node>
</Node>
<Node><Sub>N8</Sub>
<Data><![CDATA[заготовка под таблицу,генерирующую кодификатор@@@@@1@1@1@1@22@80@1@@1@1@@1@@@1@@@@@@@@17@2@@1;6;35;44@@@@@@]]></Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@10@@@@@1@2;6;30;45@@@@@  коды</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@11@1@68@@@@@1@2;6;30;45@@@@@ расшифровки кодов@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@10@@@@@1@2;6;30;46@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>2@11@1@68@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@10@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@11@1@68@@@@@1@@@@@@      Порядок создания кодификатора@</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>4@1@1@10@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>4@11@1@68@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>5@1@1@10@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>5@11@1@68@@@@@1@@@@@@ - введите в 1 колонку коды вашего кодификатора@</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>6@1@1@10@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>6@11@1@68@@@@@1@@@@@@ - введите во 2 колонку расшифровки кодов@</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>7@1@1@10@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>7@11@1@68@@@@@1@@@@@@ - пометьте клавишей &lt;Ins&gt; или + коды и тексты@</Data>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>1</Sub>
<Data>8@1@1@10@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>8@11@1@68@@@@@1@@@@@@ - установите указатель в колонку кодов и ...F6-СОЗДАТЬ-КОДИФИКАТОР@</Data>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>1</Sub>
<Data>9@1@1@10@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>9@11@1@68@@@@@1@@@@@@ - ответьте на вопросы@</Data>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>1</Sub>
<Data>10@1@1@10@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>10@11@1@68@@@@@1@@@@@@ - установите указатель в колонку текстов и F6-СОЗДАТЬ-КОДИФИКАТОР@</Data>
</Node>
</Node>
<Node><Sub>11</Sub>
<Node><Sub>1</Sub>
<Data>11@1@1@10@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>11@11@1@68@@@@@1@@@@@@ - ответьте на вопросы и ваш кодификатор готов@</Data>
</Node>
</Node>
<Node><Sub>12</Sub>
<Node><Sub>1</Sub>
<Data>12@1@1@10@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>12@11@1@68@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>13</Sub>
<Node><Sub>1</Sub>
<Data>13@1@1@10@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>13@11@1@68@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>14</Sub>
<Node><Sub>1</Sub>
<Data>14@1@1@10@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>14@11@1@68@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>15</Sub>
<Node><Sub>1</Sub>
<Data>15@1@1@10@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>15@11@1@68@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>16</Sub>
<Node><Sub>1</Sub>
<Data>16@1@1@10@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>16@11@1@68@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>17</Sub>
<Node><Sub>1</Sub>
<Data>17@1@1@10@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>17@11@1@68@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>STA</Sub>
<Data>8,2@1@1@-2@-2@-2@8@11@ - установите указатель в колонку кодов и ...F6-СОЗДАТЬ-КОДИФИКАТОР</Data>
</Node>
</Node>
<Node><Sub>N9</Sub>
<Data><![CDATA[заготовка ...,генерирующая селектор MTBD@@@@@1@1@1@1@22@80@1@@1@1@@1@@@1@@@@@@@@17@2@@1;6;35;44@@@@@@]]></Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@2@20@@@@@1@2;6;30;45@@@@@  Данные ключа</Data>
</Node>
<Node><Sub>2</Sub>
<Data><![CDATA[1@21@2@60@@@@@1@2;6;30;45@@@@@  Ссылки на таблицы описывающие базы данных                      (^["GLAVK"]РАЗДЕЛ,ТАБЛИЦА)@]]></Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@20@@@@@1@2;6;30;46@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@21@1@60@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>4@1@1@20@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>4@21@1@60@@@@@1@@@@@@      Порядок создания селектора@</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>5@1@1@20@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>5@21@1@60@@@@@1@@@@@@       (аналогично создания кодификатора)@</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>6@1@1@20@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>6@21@1@60@@@@@1@@@@@@ - введите в 1 колонку селектирующие данные ключа@</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>7@1@1@20@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>7@21@1@60@@@@@1@@@@@@ - введите во 2 колонку Ссылки на таблицы базы@</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>8@1@1@20@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>8@21@1@60@@@@@1@@@@@@ - пометьте клавишей &lt;Ins&gt; или + данные и ссылки@</Data>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>1</Sub>
<Data>9@1@1@20@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>9@21@1@60@@@@@1@@@@@@ - установите указатель в колонку данных и F6-СОЗДАТЬ-КОДИФИКАТОР@</Data>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>1</Sub>
<Data>10@1@1@20@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>10@21@1@60@@@@@1@@@@@@ - ответьте на вопросы@</Data>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>1</Sub>
<Data>11@1@1@20@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>11@21@1@60@@@@@1@@@@@@ - установите указатель в колонку ссылок и F6-СОЗДАТЬ-КОДИФИКАТОР@</Data>
</Node>
</Node>
<Node><Sub>11</Sub>
<Node><Sub>1</Sub>
<Data>12@1@1@20@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>12@21@1@60@@@@@1@@@@@@ - ответьте на вопросы и ваш селектор готов@</Data>
</Node>
</Node>
<Node><Sub>12</Sub>
<Node><Sub>1</Sub>
<Data>13@1@1@20@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>13@21@1@60@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>13</Sub>
<Node><Sub>1</Sub>
<Data>14@1@1@20@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>14@21@1@60@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>14</Sub>
<Node><Sub>1</Sub>
<Data>15@1@1@20@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>15@21@1@60@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>15</Sub>
<Node><Sub>1</Sub>
<Data>16@1@1@20@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>16@21@1@60@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>16</Sub>
<Node><Sub>1</Sub>
<Data>17@1@1@20@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>17@21@1@60@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>17</Sub>
<Node><Sub>1</Sub>
<Data>18@1@1@20@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>18@21@1@60@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>STA</Sub>
<Data>17,2@1@1@13@-1@-1@18@21@</Data>
</Node>
</Node>
<Node><Sub>PARPRN</Sub>
<Data>параметры принтеров по-умолчанию@@@@@1@1@3@17@19@66@1@@1@@@1@@2,2@1@@@@@1@@@9@2@@1;6;32;44@@@@@@@2</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@25@@@@@1@2;6;30;46@@@@@         ПАРАМЕТРЫ ПРИНТ-@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@26@1@25@@@@@1@2;6;30;46@@@@@СЕРВЕРОВ@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@2@25@@@@@1@@@@@@АВТОМАТИЧЕСКИЙ ЗАПУСК ПРИ___СТАРТЕ %BS (ИМЯ П-С)__@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>2@26@2@25@@@@0@1@1;6;31;44@@@@@???SEIKOSHA\MSW\3@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>4@1@2@25@@@@@1@@@@@@КОЛИЧЕСТВО СЕКУНД ОЖИДАТЬ_____ОТКЛИК СЕРВЕРА______@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>4@26@2@25@@@@2,2@1@1;6;31;44@@@@@10@</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>6@1@2@25@@@@@1@@@@@@ЧАСТОТА ПРОВЕРКИ ФЛАГА   __ПРИНТ-ЗАПРОСА (сек)____@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>6@26@2@25@@@@2,2@1@1;6;31;44@@@@@2@</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>8@1@2@25@@@@@1@@@@@@АВТОМАТИЧЕСКИЙ ОСТАНОВ   ___СЕРВЕРА ПОСЛЕ ПЕЧАТИ__@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>8@26@2@25@@@@2,2@1@1;6;31;44@@@@@Y@</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>10@1@2@25@@@@@1@@@@@@РАЗМЕР MSM РАЗДЕЛА ПРИ   __СТАРТЕ СЕРВЕРА (байт)__@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>10@26@2@25@@@@2,2@1@1;6;31;44@@@@@4000@</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>12@1@2@25@@@@@1@@@@@@АВТОМАТОМ УДАЛЯТЬ ИСПОЛЬ-_____ЗОВАННЫЕ БУФЕРА_____@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>12@26@2@25@@@@2,2@1@1;6;31;44@@@@@N@</Data>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>1</Sub>
<Data>14@1@2@25@@@@@1@@@@@@ТРАНСЛИРОВАТЬ ПСКЕВДОГРА-__________ФИКУ___________@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>14@26@2@25@@@@@1@1;6;31;44@@@@@||||||--|+||==||=-==-=--==-====-=---==-@</Data>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>1</Sub>
<Data>16@1@2@25@@@@@1@@@@@@НА КАКИЕ СИМВОЛЫ ТРАНСЛИ-__РОВАТЬ ПСКЕВДОГРАФИКУ__@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>16@26@2@25@@@@@1@1;6;31;44@@@@@||||||--|+||==||=-=-|=--==-====-=---==-@</Data>
</Node>
</Node>
<Node><Sub>FTR</Sub>
<Node><Sub>2</Sub>
<Node><Sub>2</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>57772,57564,</Data>
</Node>
<Node><Sub>STA</Sub>
<Data>6,2@2@2@27@-1@-1@12@42@4000</Data>
</Node>
</Node>
<Node><Sub>PRNDFLT</Sub>
<Data><![CDATA[ПАРАМЕТРЫ ПРИНТЕРА ПО-УМОЛЧАНИЮ@@@@@1@1@2@10@20@52@1@@1@@@1@@3,2@@@@@@@@@19@2@@2;6;30;45@@@@@@@2@@@@@1]]></Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@27@1@@@@1@2;6;30;45@@@@@ПАРАМЕТРЫ УСТРОЙСТВА ПЕЧАТИ</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@28@1@16@1@@@@1@2;6;30;45@@@@@ ПО-УМОЛЧАНИЮ</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@27@1@@@0@1@2;6;30;45@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>2@28@1@16@1@@@2,1@1@2;6;30;45@@@@@@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@27@1@@@@1@2;6;35;46@@@@@  80 СИМВОЛОВ В СТРОКЕ ..@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@28@1@16@@@@@1@1;6;34;46@@@@@27,80@</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>4@1@1@27@1@@@@1@2;6;35;46@@@@@  90 ....................@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>4@28@1@16@@@@@1@1;6;34;46@@@@@27,77@</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>5@1@1@27@1@@@@1@2;6;35;46@@@@@  132 ...................@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>5@28@1@16@@@@@1@1;6;34;46@@@@@27,80,15@</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>6@1@1@27@1@@@@1@2;6;35;46@@@@@  160 ...................@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>6@28@1@16@@@@@1@1;6;34;46@@@@@27,77,15@</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>7@1@1@27@1@@@@1@2;6;35;46@@@@@  70 СТРОК НА СТРАНИЦЕ ..</Data>
</Node>
<Node><Sub>2</Sub>
<Data>7@28@1@16@@@@@1@1;6;34;46@@@@@27,51,33</Data>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>1</Sub>
<Data>8@1@1@27@1@@@@1@2;6;35;46@@@@@  30 ....................</Data>
</Node>
<Node><Sub>2</Sub>
<Data>8@28@1@16@@@@@1@1;6;34;46@@@@@27,51,74</Data>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>1</Sub>
<Data>9@1@1@27@1@@@@1@2;6;35;46@@@@@  60 ....................@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>9@28@1@16@@@@@1@1;6;34;46@@@@@27,51,39@</Data>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>1</Sub>
<Data>10@1@1@27@1@@@@1@2;6;35;46@@@@@  100 ...................@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>10@28@1@16@@@@@1@1;6;34;46@@@@@27,51,23@</Data>
</Node>
</Node>
<Node><Sub>11</Sub>
<Node><Sub>1</Sub>
<Data>11@1@1@27@1@@@@1@2;6;35;46@@@@@  130 ...................@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>11@28@1@16@@@@@1@1;6;34;46@@@@@27,51,18@</Data>
</Node>
</Node>
<Node><Sub>12</Sub>
<Node><Sub>1</Sub>
<Data>12@1@1@27@1@@@@1@2;6;35;46@@@@@  250 ...................@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>12@28@1@16@@@@@1@1;6;34;46@@@@@27,51,10@</Data>
</Node>
</Node>
<Node><Sub>13</Sub>
<Node><Sub>1</Sub>
<Data>13@1@1@27@1@@@@1@2;6;35;46@@@@@  ДВОЙНОЕ КАЧЕСТВО ПЕЧАТИ@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>13@28@1@16@@@@@1@1;6;34;46@@@@@27,69@</Data>
</Node>
</Node>
<Node><Sub>14</Sub>
<Node><Sub>1</Sub>
<Data>14@1@1@27@1@@@@1@2;6;35;46@@@@@  ОБЫЧНОЕ КАЧЕСТВО@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>14@28@1@16@@@@@1@1;6;34;46@@@@@27,68@</Data>
</Node>
</Node>
<Node><Sub>15</Sub>
<Node><Sub>1</Sub>
<Data>15@1@1@27@1@@@@1@2;6;35;46@@@@@          СБРОС УСТАНОВОК@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>15@28@1@16@@@@@1@1;6;34;46@@@@@27,80,27,51,39@</Data>
</Node>
</Node>
<Node><Sub>16</Sub>
<Node><Sub>1</Sub>
<Data>16@1@1@27@1@@@2,1@1@2;6;30;45@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>16@28@1@16@1@@@2,1@1@2;6;30;45@@@@@@</Data>
</Node>
</Node>
<Node><Sub>17</Sub>
<Node><Sub>1</Sub>
<Data>17@1@1@27@@@@@1@2;6;35;46@@@@@    УСТРОЙСТВО ВЫВОДА@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>17@28@1@16@@@@@1@1;6;34;46@@@@PRN,^%ZAPM.ed.BSJPRN,,,,&lt;&gt;@2@</Data>
</Node>
</Node>
<Node><Sub>18</Sub>
<Node><Sub>1</Sub>
<Data>18@1@1@27@1@@@@1@2;6;35;46@@@@@ МАКС.КОЛ-ВО СИМВОЛОВ@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>18@28@1@16@@@@@1@1;6;34;46@@@@@511@</Data>
</Node>
</Node>
<Node><Sub>19</Sub>
<Node><Sub>1</Sub>
<Data>19@1@1@27@@@@@1@2;6;35;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>19@28@1@16@@@@@1@1;6;34;46@@@@@@</Data>
</Node>
</Node>
<Node><Sub>FCL</Sub>
<Node><Sub>17</Sub>
<Node><Sub>2</Sub>
<Data>S d1=$S($O(^%ZAPM.ed.BS(&quot;LPT&quot;,&quot;&quot;))=&quot;&quot;:&quot;?&quot;,1:$O(^%ZAPM.ed.BS(&quot;LPT&quot;,&quot;&quot;)))</Data>
<Node><Sub>1</Sub>
<Data>$S($O(^%ZAPM.ed.BS(&quot;LPT&quot;,&quot;&quot;))=&quot;&quot;:&quot;?&quot;,1:$O(^%ZAPM.ed.BS(&quot;LPT&quot;,&quot;&quot;)))</Data>
</Node>
</Node>
</Node>
<Node><Sub>19</Sub>
<Node><Sub>2</Sub>
<Data>S d1=$ZU(1,0)</Data>
<Node><Sub>1</Sub>
<Data>$ZU(1,0)</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>FTR</Sub>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$TR($J(&quot;&quot;,27),&quot; &quot;,&quot;=&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$TR($J(&quot;&quot;,27),&quot; &quot;,&quot;=&quot;)</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>Free</Sub>
<Data>56819,49693</Data>
</Node>
<Node><Sub>LST</Sub>
<Data>59467,71331,MSW</Data>
</Node>
<Node><Sub>STA</Sub>
<Data>,@3@2@27@-1@-1@18@37@2</Data>
<Node><Sub>0</Sub>
<Data>20</Data>
</Node>
<Node><Sub>2</Sub>
<DataBase64>IF7PXsBe0F7AXsxexV7SXtBe214gXs9exV7XXsBe0l7IXiBewl4gXtRezl7QXsxewF7SXsVeIF4g
XiReQ14oXlNeUl4pXiBeIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAH
IAcgBw==
</DataBase64>
</Node>
<Node><Sub>3</Sub>
<DataBase64>IF4gXi1eLV4tXi1eLV4tXi1eLV4tXi1eLV4tXi1eLV4tXi1eLV4tXi1eLV4tXi1eLV4tXi1eLV4t
Xi1eLV4tXi1eLV4gXiBeIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAH
IAcgBw==
</DataBase64>
</Node>
<Node><Sub>4</Sub>
<DataBase64>IDUgNSA1ODUwNSA10TXINcw1wjXONcs1zjXCNSA1wjUgNdE10jXQNc41yjXFNSA1LjUuNSA1Mng3
eCx4OHgweCB4IHggeCB4IAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAH
IAcgBw==
</DataBase64>
</Node>
<Node><Sub>5</Sub>
<DataBase64>IDUgNSA1OTUwNSA1LjUuNS41LjUuNS41LjUuNS41LjUuNS41LjUuNS41LjUuNS41LjUuNSA1Mjk3
OSw5Nzk3OSA5IDkgOSA5IAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAH
IAcgBw==
</DataBase64>
</Node>
<Node><Sub>6</Sub>
<DataBase64>IDUgNSA1MTUzNTI1IDUuNS41LjUuNS41LjUuNS41LjUuNS41LjUuNS41LjUuNS41LjUuNSA1Mjk3
OSw5ODkwOSw5MTk1OSA5IAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAH
IAcgBw==
</DataBase64>
</Node>
<Node><Sub>7</Sub>
<DataBase64>IDUgNSA1MTU2NTA1IDUuNS41LjUuNS41LjUuNS41LjUuNS41LjUuNS41LjUuNS41LjUuNSA1Mjk3
OSw5Nzk3OSw5MTk1OSA5IAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAH
IAcgBw==
</DataBase64>
</Node>
<Node><Sub>8</Sub>
<DataBase64>IDUgNSA1NzUwNSA10TXSNdA1zjXKNSA1zTXANSA10TXSNdA1wDXNNcg11jXFNSA1LjUuNSA1Mjk3
OSw5NTkxOSw5MzkzOSA5IAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAH
IAcgBw==
</DataBase64>
</Node>
<Node><Sub>9</Sub>
<DataBase64>IDUgNSA1MzUwNSA1LjUuNS41LjUuNS41LjUuNS41LjUuNS41LjUuNS41LjUuNS41LjUuNSA1Mjk3
OSw5NTkxOSw5Nzk0OSA5IAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAH
IAcgBw==
</DataBase64>
</Node>
<Node><Sub>10</Sub>
<DataBase64>IDUgNSA1NjUwNSA1LjUuNS41LjUuNS41LjUuNS41LjUuNS41LjUuNS41LjUuNS41LjUuNSA1Mjk3
OSw5NTkxOSw5Mzk5OSA5IAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAH
IAcgBw==
</DataBase64>
</Node>
<Node><Sub>11</Sub>
<DataBase64>IDUgNSA1MTUwNTA1IDUuNS41LjUuNS41LjUuNS41LjUuNS41LjUuNS41LjUuNS41LjUuNSA1Mjk3
OSw5NTkxOSw5MjkzOSA5IAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAH
IAcgBw==
</DataBase64>
</Node>
<Node><Sub>12</Sub>
<DataBase64>IDUgNSA1MTUzNTA1IDUuNS41LjUuNS41LjUuNS41LjUuNS41LjUuNS41LjUuNS41LjUuNSA1Mjk3
OSw5NTkxOSw5MTk4OSA5IAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAH
IAcgBw==
</DataBase64>
</Node>
<Node><Sub>13</Sub>
<DataBase64>IDUgNSA1MjU1NTA1IDUuNS41LjUuNS41LjUuNS41LjUuNS41LjUuNS41LjUuNS41LjUuNSA1Mjk3
OSw5NTkxOSw5MTkwOSA5IAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAH
IAcgBw==
</DataBase64>
</Node>
<Node><Sub>14</Sub>
<DataBase64>IDUgNSA1xDXCNc41yTXNNc41xTUgNco1wDXXNcU10TXSNcI1zjUgNc81xTXXNcA10jXINSA1Mjk3
OSw5Njk5OSA5IDkgOSA5IAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAH
IAcgBw==
</DataBase64>
</Node>
<Node><Sub>15</Sub>
<DataBase64>IAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcg
ByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAH
IAcgBw==
</DataBase64>
</Node>
<Node><Sub>16</Sub>
<DataBase64>IAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcg
ByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAH
IAcgBw==
</DataBase64>
</Node>
<Node><Sub>17</Sub>
<DataBase64>IAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcg
ByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAH
IAcgBw==
</DataBase64>
</Node>
<Node><Sub>18</Sub>
<DataBase64>IAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcg
ByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAH
IAcgBw==
</DataBase64>
</Node>
<Node><Sub>19</Sub>
<DataBase64>IAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcg
ByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAH
IAcgBw==
</DataBase64>
</Node>
<Node><Sub>20</Sub>
<DataBase64>IAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcg
ByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAH
IAcgBw==
</DataBase64>
</Node>
<Node><Sub>21</Sub>
<DataBase64>IAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcg
ByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAH
IAcgBw==
</DataBase64>
</Node>
<Node><Sub>22</Sub>
<DataBase64>IAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcg
ByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAH
IAcgBw==
</DataBase64>
</Node>
</Node>
</Node>
<Node><Sub>PanButt</Sub>
<Data><![CDATA[Панель с кнопками@@@@@1@1@1@1@22@80@1@@1@1@@8@@@1@@@@@@@@4@4@@2;6;30;46@@@@@@@@^%ZAPM.ed.BSHLP("HELP-ALTF2")]]></Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@10@@@@@1@2;6;30;46@@@@@              Пpимеp пpименения панели.@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@11@1@10@@@@@1@1;6;37;44@@@0@^%ZAPM.ed.BSDFLT(&quot;N3&quot;)@ ONE @</Data>
</Node>
<Node><Sub>3</Sub>
<Data>1@21@1@10@@@@@1@@@@@@1@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>1@31@1@10@@@@@1@@@@@@GO@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@10@@@@@1@@@@@@Кнопкой 1 вызывается таблица N3</Data>
</Node>
<Node><Sub>2</Sub>
<Data>2@11@1@10@@@@@1@1;6;36;41@@@@^%ZAPM.ed.BSDFLT(&quot;N7&quot;)@ TWO @</Data>
</Node>
<Node><Sub>3</Sub>
<Data>2@21@1@10@@@@@1@@@@@@2@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>2@31@1@10@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@10@@@@@1@@@@@@Кнопкой 2 вызывается таблица N7 с возвратом в панель@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@11@1@10@@@@@1@@@@@@ ОТМЕНА @</Data>
</Node>
<Node><Sub>3</Sub>
<Data>3@21@1@10@@@@@1@@@@@@0@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>3@31@1@10@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>4@1@1@10@@@@@1@@@@@@Для редактирования параметров панели введите &lt;ALT-F&gt;@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>4@11@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>4@21@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>4@31@1@10@@@@@1@2;5;31;46@@@@@Нажми &lt;F1&gt;@</Data>
</Node>
</Node>
<Node><Sub>BUT</Sub>
<Data>Панель с кнопками/2;6;30;46</Data>
<Node><Sub>0</Sub>
<Data>2;6;30;46</Data>
<Node><Sub>1</Sub>
<Data>              Пpимеp пpименения панели.</Data>
<Node><Sub>1</Sub>
<Data>2;6;30;46</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Data>Кнопкой 1 вызывается таблица N3</Data>
</Node>
<Node><Sub>3</Sub>
<Data>Кнопкой 2 вызывается таблица N7 с возвратом в панель</Data>
</Node>
<Node><Sub>4</Sub>
<Data>Для редактирования параметров панели введите &lt;ALT-F&gt;</Data>
</Node>
</Node>
<Node><Sub>1</Sub>
<Data>1;6;37;44/1;6;36;41</Data>
<Node><Sub>1</Sub>
<Data> ONE </Data>
</Node>
<Node><Sub>2</Sub>
<Data> TWO </Data>
</Node>
<Node><Sub>3</Sub>
<Data> ОТМЕНА </Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Data>1</Data>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>^%ZAPM.ed.BSDFLT,N3</Data>
</Node>
<Node><Sub>2</Sub>
<Data>^%ZAPM.ed.BSDFLT,N7</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>1</Data>
</Node>
<Node><Sub>2</Sub>
<Data>2</Data>
</Node>
<Node><Sub>3</Sub>
<Data>0</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>1</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>0</Data>
</Node>
<Node><Sub>2</Sub>
<Data>0</Data>
</Node>
</Node>
</Node>
<Node><Sub>COL</Sub>
<Node><Sub>1</Sub>
<Node><Sub>2</Sub>
<Data>S d1=1</Data>
<Node><Sub>1</Sub>
<Data>1</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>STA</Sub>
<Data>,@1@1@13@-1@-1@1@1@              Пpимеp пpименения панели.</Data>
</Node>
</Node>
<Node><Sub>ProgEdit</Sub>
<Data><![CDATA[Описание pедактоpа пpогpамм@@@@@@@1@1@22@80@@11111111@@1@@5@@@@@@@@@@@1@510@@1;6;37;44//1;6;36;40//1;6;37;44//////32@@@@@@@1@]]></Data>
<Node><Sub>1</Sub>
<Data></Data>
</Node>
</Node>
<Node><Sub>Screen</Sub>
<Data><![CDATA[заготовка очень маленькой таблицы (1x1)@@@@@@@1@1@22@80@@01111100@@1@@5@@@@@@@@@@@1@510@@2;6;30;46//1;6;36;40////////32@@@@@@@1]]></Data>
<Node><Sub>1</Sub>
<Data></Data>
</Node>
</Node>
<Node><Sub>TextEdit</Sub>
<Data><![CDATA[Описание pедактоpа текста@@@@@@@1@1@22@80@@111111@@1@@5@@@@@@@@@@@1@510@@2;6;30;46//1;6;36;40////////32@@@@@@@1]]></Data>
<Node><Sub>1</Sub>
<Data></Data>
</Node>
</Node>
<Node><Sub>TextLine</Sub>
<Data><![CDATA[Строчный редактор в редакторе текста@@@@@@@20@1@22@80@@1111111@@1@@5@@@@@@@@@@@1@510@@1;6;32;44////1;6;37;44//////176@@@@@@@1]]></Data>
<Node><Sub>1</Sub>
<Data></Data>
</Node>
</Node>
<Node><Sub>Variables</Sub>
<Data><![CDATA[ТАБЛИЦА СКВОЗНЫХ ЛОКАЛЬНЫХ ПЕРЕМЕННЫХ@@@@@1@1@1@1@22@80@1@@1@1@@1@@2,1@1@@@@@@@@27@3@@1;6;35;44@@@@@@]]></Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@15@@@@@1@2;6;30;45@@@@@ имя перем.</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@16@1@15@@@@@1@1;6;37;43@@@@@   значение@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>1@31@1@50@@@@@1@2;6;30;45@@@@@      комментарий@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@15@@@@@1@2;6;30;46@@@@@vl(0)</Data>
</Node>
<Node><Sub>2</Sub>
<Data>2@16@1@15@@@1@@1@1;6;37;45@@@@@201225@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>2@31@1@50@@@@@1@@@@@@ТЕКУЩИЙ ДЕНЬ (ГГММДД)@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@15@@@@@1@2;6;30;46@@@@@vl(1)@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@16@1@15@@@1@@1@1;6;37;45@@@@@20@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>3@31@1@50@@@@@1@@@@@@ТЕКУЩИЙ ГОД@</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>4@1@1@15@@@@@1@2;6;30;46@@@@@vl(2)@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>4@16@1@15@@@1@@1@1;6;37;45@@@@@19@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>4@31@1@50@@@@@1@@@@@@ГОД НАЗАД@</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>5@1@1@15@@@@@1@2;6;30;46@@@@@vl(3)@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>5@16@1@15@@@1@@1@1;6;37;45@@@@@18@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>5@31@1@50@@@@@1@@@@@@2 ГОДА НАЗАД@</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>6@1@1@15@@@@@1@2;6;30;46@@@@@vl(11)@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>6@16@1@15@@@1@@1@1;6;37;45@@@@@201201@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>6@31@1@50@@@@@1@@@@@@НАЧАЛО ТЕКУЩЕГО МЕСЯЦА@</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>7@1@1@15@@@@@1@2;6;30;46@@@@@vl(12)@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>7@16@1@15@@@1@@1@1;6;37;45@@@@@201228@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>7@31@1@50@@@@@1@@@@@@КОНЕЦ ТЕКУЩЕГО МЕСЯЦА@</Data>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>1</Sub>
<Data>8@1@1@15@@@@@1@2;6;30;46@@@@@vl(21)@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>8@16@1@15@@@1@@1@1;6;37;45@@@@@202001@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>8@31@1@50@@@@@1@@@@@@НАЧАЛО ПРЕДИДУЩЕГО МЕСЯЦА@</Data>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>1</Sub>
<Data>9@1@1@15@@@@@1@2;6;30;46@@@@@vl(22)@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>9@16@1@15@@@1@@1@1;6;37;45@@@@@202028@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>9@31@1@50@@@@@1@@@@@@КОНЕЦ ПРЕДИДУЩЕГО МЕСЯЦА@</Data>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>1</Sub>
<Data>10@1@1@15@@@@@1@2;6;30;46@@@@@vl(31)@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>10@16@1@15@@@1@@1@1;6;37;45@@@@@201901@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>10@31@1@50@@@@@1@@@@@@НАЧАЛО ПРЕДИДУЩЕГО МЕСЯЦА ПРЕД-ГО ГОДА@</Data>
</Node>
</Node>
<Node><Sub>11</Sub>
<Node><Sub>1</Sub>
<Data>11@1@1@15@@@@@1@2;6;30;46@@@@@vl(32)@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>11@16@1@15@@@1@@1@1;6;37;45@@@@@201928@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>11@31@1@50@@@@@1@@@@@@КОНЕЦ ПРЕДИДУЩЕГО МЕСЯЦА ПРЕД-ГО ГОДА@</Data>
</Node>
</Node>
<Node><Sub>12</Sub>
<Node><Sub>1</Sub>
<Data>12@1@1@15@@@@@1@2;6;30;46@@@@@vl(4)@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>12@16@1@15@@@1@@1@1;6;37;45@@@@@25122000@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>12@31@1@50@@@@@1@@@@@@ТЕКУЩИЙ ДЕНЬ (ДДММГГ)@</Data>
</Node>
</Node>
<Node><Sub>13</Sub>
<Node><Sub>1</Sub>
<Data>13@1@1@15@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>13@16@1@15@@@@@1@1;6;37;45@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>13@31@1@50@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>14</Sub>
<Node><Sub>1</Sub>
<Data>14@1@1@15@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>14@16@1@15@@@@@1@1;6;37;45@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>14@31@1@50@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>15</Sub>
<Node><Sub>1</Sub>
<Data>15@1@1@15@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>15@16@1@15@@@@@1@1;6;37;45@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>15@31@1@50@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>16</Sub>
<Node><Sub>1</Sub>
<Data>16@1@1@15@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>16@16@1@15@@@@@1@1;6;37;45@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>16@31@1@50@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>17</Sub>
<Node><Sub>1</Sub>
<Data>17@1@1@15@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>17@16@1@15@@@@@1@1;6;37;45@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>17@31@1@50@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>18</Sub>
<Node><Sub>1</Sub>
<Data>18@1@1@15@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>18@16@1@15@@@@@1@1;6;37;45@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>18@31@1@50@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>19</Sub>
<Node><Sub>1</Sub>
<Data>19@1@1@15@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>19@16@1@15@@@@@1@1;6;37;45@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>19@31@1@50@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>20</Sub>
<Node><Sub>1</Sub>
<Data>20@1@1@15@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>20@16@1@15@@@@@1@1;6;37;45@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>20@31@1@50@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>21</Sub>
<Node><Sub>1</Sub>
<Data>21@1@1@15@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>21@16@1@15@@@@@1@1;6;37;45@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>21@31@1@50@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>22</Sub>
<Node><Sub>1</Sub>
<Data>22@1@1@15@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>22@16@1@15@@@@@1@1;6;37;45@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>22@31@1@50@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>23</Sub>
<Node><Sub>1</Sub>
<Data>23@1@1@15@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>23@16@1@15@@@@@1@1;6;37;45@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>23@31@1@50@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>24</Sub>
<Node><Sub>1</Sub>
<Data>24@1@1@15@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>24@16@1@15@@@@@1@1;6;37;45@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>24@31@1@50@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>25</Sub>
<Node><Sub>1</Sub>
<Data>25@1@1@15@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>25@16@1@15@@@@@1@1;6;37;45@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>25@31@1@50@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>26</Sub>
<Node><Sub>1</Sub>
<Data>26@1@1@15@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>26@16@1@15@@@@@1@1;6;37;45@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>26@31@1@50@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>27</Sub>
<Node><Sub>1</Sub>
<Data>27@1@1@15@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>27@16@1@15@@@@@1@1;6;37;45@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>27@31@1@50@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>FCL</Sub>
<Node><Sub>2</Sub>
<Node><Sub>2</Sub>
<Data><![CDATA[S d1=$E($TR($$ESDAY^%ZAPM.ed.BSsFUNR(6,$H),".",""),5,6)_$E($TR($$ESDAY^%ZAPM.ed.BSsFUNR(6,$H),".",""),3,4)_$E($TR($$ESDAY^%ZAPM.ed.BSsFUNR(6,$H),".",""),1,2) S vl(0)=d1]]></Data>
<Node><Sub>1</Sub>
<Data><![CDATA[$E($TR($$ESDAY(6,$H),".",""),5,6)_$E($TR($$ESDAY(6,$H),".",""),3,4)_$E($TR($$ESDAY(6,$H),".",""),1,2) S vl(0)=d1]]></Data>
</Node>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>2</Sub>
<Data>S d1=$E($TR($$ESDAY^%ZAPM.ed.BSsFUNR(6,$H),&quot;.&quot;,&quot;&quot;),5,6) S vl(1)=d1</Data>
<Node><Sub>1</Sub>
<Data>$E($TR($$ESDAY(6,$H),&quot;.&quot;,&quot;&quot;),5,6) S vl(1)=d1</Data>
</Node>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>2</Sub>
<Data>S d1=vl(1)-1 S vl(2)=d1 I d1&lt;0 S (vl(2),d1)=&quot;99&quot;</Data>
<Node><Sub>1</Sub>
<Data>vl(1)-1 S vl(2)=d1 I d1&lt;0 S (vl(2),d1)=&quot;99&quot;</Data>
</Node>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>2</Sub>
<Data>S d1=vl(1)-2 S vl(3)=d1 I d1&lt;0 S (vl(3),d1)=&quot;99&quot;</Data>
<Node><Sub>1</Sub>
<Data>vl(1)-2 S vl(3)=d1 I d1&lt;0 S (vl(3),d1)=&quot;99&quot;</Data>
</Node>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>2</Sub>
<Data>S d1=$E(vl(0),1,4)_&quot;01&quot; S vl(11)=d1</Data>
<Node><Sub>1</Sub>
<Data>$E(vl(0),1,4)_&quot;01&quot; S vl(11)=d1</Data>
</Node>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>2</Sub>
<Data>S d1=$E(vl(0),1,4)_&quot;28&quot; S vl(12)=d1</Data>
<Node><Sub>1</Sub>
<Data>$E(vl(0),1,4)_&quot;28&quot; S vl(12)=d1</Data>
</Node>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>2</Sub>
<Data>S d1=$E($$DatGuKBB^%ZAPM.ed.BSMDDR1(&quot;11&quot;_$E(vl(0),3,4)_$E(vl(0),1,2)),1,4)_&quot;01&quot; S vl(21)=d1</Data>
<Node><Sub>1</Sub>
<Data>$E($$DatGuKBB^%ZAPM.ed.BSMDDR1(&quot;11&quot;_$E(vl(0),3,4)_$E(vl(0),1,2)),1,4)_&quot;01&quot; S vl(21)=d1</Data>
</Node>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>2</Sub>
<Data>S d1=$E($$DatGuKBB^%ZAPM.ed.BSMDDR1(&quot;11&quot;_$E(vl(0),3,4)_$E(vl(0),1,2)),1,4)_&quot;28&quot; S vl(22)=d1</Data>
<Node><Sub>1</Sub>
<Data>$E($$DatGuKBB^%ZAPM.ed.BSMDDR1(&quot;11&quot;_$E(vl(0),3,4)_$E(vl(0),1,2)),1,4)_&quot;28&quot; S vl(22)=d1</Data>
</Node>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>2</Sub>
<Data>S d1=$E($$DatGuKBB^%ZAPM.ed.BSMDDR1(&quot;11&quot;_$E(vl(0),3,4)_$E(vl(2),1,2)),1,4)_&quot;01&quot; S vl(31)=d1</Data>
<Node><Sub>1</Sub>
<Data>$E($$DatGuKBB^%ZAPM.ed.BSMDDR1(&quot;11&quot;_$E(vl(0),3,4)_$E(vl(2),1,2)),1,4)_&quot;01&quot; S vl(31)=d1</Data>
</Node>
</Node>
</Node>
<Node><Sub>11</Sub>
<Node><Sub>2</Sub>
<Data>S d1=$E($$DatGuKBB^%ZAPM.ed.BSMDDR1(&quot;11&quot;_$E(vl(0),3,4)_$E(vl(2),1,2)),1,4)_&quot;28&quot; S vl(32)=d1</Data>
<Node><Sub>1</Sub>
<Data>$E($$DatGuKBB^%ZAPM.ed.BSMDDR1(&quot;11&quot;_$E(vl(0),3,4)_$E(vl(2),1,2)),1,4)_&quot;28&quot; S vl(32)=d1</Data>
</Node>
</Node>
</Node>
<Node><Sub>12</Sub>
<Node><Sub>2</Sub>
<Data>S d1=$TR($$ESDAY^%ZAPM.ed.BSsFUNR(6,$H),&quot;.&quot;,&quot;&quot;) S vl(4)=d1</Data>
<Node><Sub>1</Sub>
<Data>$TR($$ESDAY(6,$H),&quot;.&quot;,&quot;&quot;) S vl(4)=d1</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>STA</Sub>
<Data>12,2@2@1@13@-1@-1@2@1@12022000</Data>
</Node>
</Node>
<Node><Sub>oldN14</Sub>
<Data>заготовка диалоговой панели@@@@@1@1@1@1@22@80@1@@1@1@@11@@@1@@@@@1@@@16@21@@@@@@@@@@@@@@1</Data>
<Node><Sub>Dial</Sub>
<Data>TDialog@5@5@50@13@Test Dialog@1@1@0@@7@0@@@@@ @0@7@8@0@0@@@@$$CanClose^%ZAPM.ed.BSTESTD()@@@0</Data>
<Node><Sub>Button1</Sub>
<Data>TButton@10@16@8@1@Yes@1@1@8@@7@3@@1@1@@ @7@4@15@0@7@@D DoneDlg</Data>
</Node>
<Node><Sub>Button2</Sub>
<Data>TButton@25@16@8@1@No@1@1@8@@7@3@@1@2@@ @7@4@15@0@7@@@</Data>
</Node>
<Node><Sub>Button3</Sub>
<Data>TButton@40@16@8@1@Help@1@1@8@@7@3@@1@3@@ @7@4@15@0@7@@D O^%ZAPM.ed.BSF3</Data>
</Node>
<Node><Sub>Check1</Sub>
<Data>TCheck@35@11@8@1@[ ] Option1@1@1@8@@7@3@@1@7@@ @0@7@15@0@7@1@</Data>
</Node>
<Node><Sub>Check2</Sub>
<Data>TCheck@35@12@8@1@Option2 [ ]@1@1@8@@7@3@@1@8@@ @0@7@15@0@7@@</Data>
</Node>
<Node><Sub>Clock1</Sub>
<Data>TClock@71@1@8@15@000@1@1@8@@7@1@@0@0@@ @0@7</Data>
</Node>
<Node><Sub>Edit1</Sub>
<Data>TEdit@25@14@17@15@@1@1@8@Тут должно быть ваше имя  @7@1@@1@9@@­@0@7</Data>
</Node>
<Node><Sub>Label1</Sub>
<Data>TLabel@7@7@12@15@Test Label1@1@1@8@@7@0@@0@0@@ @0@7</Data>
</Node>
<Node><Sub>Label2</Sub>
<Data>TLabel@7@8@12@15@Test Label2@1@1@8@@2@0@@0@0@@ @0@7</Data>
</Node>
<Node><Sub>Label3</Sub>
<Data>TLabel@7@10@17@15@Test Label3@1@1@8@@7@1@@0@0@@ @0@7</Data>
</Node>
<Node><Sub>Label4</Sub>
<Data>TLabel@7@14@17@15@Enter your name: @1@1@8@@7@1@@0@0@@ @0@7</Data>
</Node>
<Node><Sub>Radio1</Sub>
<Data>TRadio@35@7@8@1@( ) Alternativ1@1@1@8@@7@3@@1@4@@ @0@7@15@0@7@1@@1</Data>
</Node>
<Node><Sub>Radio2</Sub>
<Data>TRadio@35@8@8@1@( ) Alternativ2@1@1@8@@7@3@@1@5@@ @0@7@15@0@7@@@1</Data>
</Node>
<Node><Sub>Radio3</Sub>
<Data>TRadio@35@9@8@1@Alternativ3 ( )@1@1@8@@7@3@@1@6@@ @0@7@15@0@7@@@1</Data>
</Node>
</Node>
</Node>
</Node>
</Global>


<Global>
<Node><Sub>^%ZAPM.ed.BSETUP</Sub>
<Data>BaSe MsW @%BS-СИСТЕМНЫЙ РАЗДЕЛ (ТАБЛИЧНЫЙ ПРОЦЕССОР)@@</Data>
<Node><Sub>BSDSR</Sub>
<Data>Директории куда сохранять NEWVER@@@@@1@1@1@1@22@80@1@@1@1@@1@@@1@@@@@1@@@1@1@@@@@@@@</Data>
<Node><Sub>0</Sub>
<Data>L:/MSW_TOOLS/ROU/BSNEW</Data>
</Node>
<Node><Sub>1</Sub>
<Data>L:/MSW_TOOLS/ROU/BSNEW</Data>
<Node><Sub>1</Sub>
<Data>1@1@1@1@@@@@1@@@@@@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Data>L:/MSW_TOOLS/ROU/BSNEW</Data>
</Node>
<Node><Sub>3</Sub>
<Data>L:/MSW_TOOLS/ROU/BSNEW</Data>
</Node>
<Node><Sub>%MIR</Sub>
<Data>L:/MSW_TOOLS/ROU/BSNEW</Data>
</Node>
<Node><Sub>ARX</Sub>
<Data>L:\MSW_TOOLS\_INSTALLATION\SOFT\BSSETUP\bsdsr.zip</Data>
</Node>
<Node><Sub>Profile</Sub>
<Data>L:/MSW_TOOLS/ROU/PROFILE</Data>
</Node>
<Node><Sub>STA</Sub>
<Data>1,1@1@1@13@-1@-1@1@1@</Data>
</Node>
</Node>
<Node><Sub>CFG</Sub>
<Data>Основные Опции Комплекса@@@@@1@1@1@1@22@80@1@@1@1@@1@@2,1@1@@@@@@@@26@5@@1;6;35;44@@@@@@</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@13@@@@@1@2;6;35;40@@@@@ Value (DFLT)</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@14@1@10@@@@@1@2;6;30;41@@@@@ Type@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>1@24@1@10@@@@@1@2;6;30;41@@@@@Atribute@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>1@34@1@35@@@@@1@2;6;33;40@@@@@ ОПИСАНИЕ@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>1@69@1@9@@@@@1@2;6;30;41@@@@@ name@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@13@@@@@1@2;6;30;43@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>2@14@1@10@@@@@1@2;6;30;43@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>2@24@1@10@@@@@1@2;6;30;43@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>2@34@1@35@@@@@1@2;6;30;43@@@@@ Основные Опции Комплекса@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>2@69@1@9@@@@@1@2;6;30;43@@@@@@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@13@@@@@1@2;6;35;40@@@@@Информационный портал@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>3@24@1@10@@@@@1@2;6;32;40@@@@@size=30@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>3@34@1@35@@@@@1@2;6;33;40@@@@@Наименование портала@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>3@69@1@9@@@@@1@2;6;32;40@@@@@IP@</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>4@1@1@13@@@@@1@2;6;35;40@@@@@BaseForYou@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>4@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>4@24@1@10@@@@@1@2;6;32;40@@@@@size=30@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>4@34@1@35@@@@@1@2;6;33;40@@@@@Название комплекса@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>4@69@1@9@@@@@1@2;6;32;40@@@@@B4I@</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>5@1@1@13@@@@@1@2;6;35;40@@@@@1@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>5@14@1@10@@@@@1@2;6;32;40@@@@@radio@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>5@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data><![CDATA[5@34@1@35@@@@@1@2;6;33;40@@@@@ТАРИФ ПО-УМОЛЧАНИЮ: ТЕСТОВЫЙ~ --//-- ЭКОНОМНЫЙ~ --//-- СТАНДАРТНЫЙ~ --//-- ПРОФЕССИОНАЛЬНЫЙ@]]></Data>
</Node>
<Node><Sub>5</Sub>
<Data>5@69@1@9@@@@@1@2;6;32;40@@@@@Tariff@</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>6@1@1@13@@@@@1@2;6;35;40@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>6@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>6@24@1@10@@@@@1@2;6;32;40@@@@@size=30@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>6@34@1@35@@@@@1@2;6;33;40@@@@@Копирайт и Номер версии комплекса@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>6@69@1@9@@@@@1@2;6;32;40@@@@@Vers@</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>7@1@1@13@@@@@1@2;6;35;40@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>7@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>7@24@1@10@@@@@1@2;6;32;40@@@@@size=30@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>7@34@1@35@@@@@1@2;6;33;40@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>7@69@1@9@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>1</Sub>
<Data>8@1@1@13@@@@@1@2;6;35;40@@@@@D:/infoportal/snx/@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>8@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>8@24@1@10@@@@@1@2;6;32;40@@@@@size=30@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>8@34@1@35@@@@@1@2;6;33;40@@@@@каталог временных файлов для записи@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>8@69@1@9@@@@@1@2;6;32;40@@@@@TempDir2@</Data>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>1</Sub>
<Data>9@1@1@13@@@@@1@2;6;35;40@@@@@SAMPLES@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>9@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>9@24@1@10@@@@@1@2;6;32;40@@@@@size=30@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>9@34@1@35@@@@@1@2;6;33;40@@@@@Текущая рабочая область для новых клиентов@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>9@69@1@9@@@@@1@2;6;32;40@@@@@CurNSP@</Data>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>1</Sub>
<Data>10@1@1@13@@@@@1@2;6;35;40@@@@@GREEN@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>10@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>10@24@1@10@@@@@1@2;6;32;40@@@@@size=30@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>10@34@1@35@@@@@1@2;6;33;40@@@@@Текущий стиль@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>10@69@1@9@@@@@1@2;6;32;40@@@@@CurCSS@</Data>
</Node>
</Node>
<Node><Sub>11</Sub>
<Node><Sub>1</Sub>
<Data>11@1@1@13@@@@@1@2;6;35;40@@@@@2@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>11@14@1@10@@@@@1@2;6;32;40@@@@@radio@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>11@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>11@34@1@35@@@@@1@2;6;33;40@@@@@Портал тарифицируется~не тарифицируется@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>11@69@1@9@@@@@1@2;6;32;40@@@@@Commerce@</Data>
</Node>
</Node>
<Node><Sub>12</Sub>
<Node><Sub>1</Sub>
<Data>12@1@1@13@@@@@1@2;6;35;40@@@@@0</Data>
</Node>
<Node><Sub>2</Sub>
<Data>12@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>12@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>12@34@1@35@@@@@1@2;6;33;40@@@@@Мультиязычность@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>12@69@1@9@@@@@1@2;6;32;40@@@@@MultiL@</Data>
</Node>
</Node>
<Node><Sub>13</Sub>
<Node><Sub>1</Sub>
<Data>13@1@1@13@@@@@1@2;6;35;40@@@@@0</Data>
</Node>
<Node><Sub>2</Sub>
<Data>13@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>13@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>13@34@1@35@@@@@1@2;6;33;40@@@@@Конкурсы проектов@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>13@69@1@9@@@@@1@2;6;32;40@@@@@Conc@</Data>
</Node>
</Node>
<Node><Sub>14</Sub>
<Node><Sub>1</Sub>
<Data>14@1@1@13@@@@@1@2;6;35;40@@@@@1</Data>
</Node>
<Node><Sub>2</Sub>
<Data>14@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>14@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>14@34@1@35@@@@@1@2;6;33;40@@@@@Включен WEB редактор программ COS@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>14@69@1@9@@@@@1@2;6;32;40@@@@@WebEditRou@</Data>
</Node>
</Node>
<Node><Sub>15</Sub>
<Node><Sub>1</Sub>
<Data>15@1@1@13@@@@@1@2;6;35;40@@@@@1</Data>
</Node>
<Node><Sub>2</Sub>
<Data>15@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>15@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>15@34@1@35@@@@@1@2;6;33;40@@@@@Включен WEB редактор данных таблиц@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>15@69@1@9@@@@@1@2;6;32;40@@@@@WebEditDT@</Data>
</Node>
</Node>
<Node><Sub>16</Sub>
<Node><Sub>1</Sub>
<Data>16@1@1@13@@@@@1@2;6;35;40@@@@@1</Data>
</Node>
<Node><Sub>2</Sub>
<Data>16@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>16@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>16@34@1@35@@@@@1@2;6;33;40@@@@@Разрешен вывод информации о сессии и системе@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>16@69@1@9@@@@@1@2;6;32;40@@@@@WebInfoSess@</Data>
</Node>
</Node>
<Node><Sub>17</Sub>
<Node><Sub>1</Sub>
<Data>17@1@1@13@@@@@1@2;6;35;40@@@@@cols=68 rows=5@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>17@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>17@24@1@10@@@@@1@2;6;32;40@@@@@size=32@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>17@34@1@35@@@@@1@2;6;33;40@@@@@Параметры TEXTAREA для кода COS@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>17@69@1@9@@@@@1@2;6;32;40@@@@@COS@</Data>
</Node>
</Node>
<Node><Sub>18</Sub>
<Node><Sub>1</Sub>
<Data>18@1@1@13@@@@@1@2;6;35;40@@@@@cols=68 rows=5@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>18@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>18@24@1@10@@@@@1@2;6;32;40@@@@@size=32@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>18@34@1@35@@@@@1@2;6;33;40@@@@@Параметры TEXTAREA для HTML@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>18@69@1@9@@@@@1@2;6;32;40@@@@@HTM@</Data>
</Node>
</Node>
<Node><Sub>19</Sub>
<Node><Sub>1</Sub>
<Data>19@1@1@13@@@@@1@2;6;30;46@@@@@1@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>19@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>19@24@1@10@@@@@1@2;6;32;40@@@@@size=35@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>19@34@1@35@@@@@1@@@@@@Разрешена ли работа с ODBC@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>19@69@1@9@@@@@1@2;6;32;40@@@@@ImportODBC@</Data>
</Node>
</Node>
<Node><Sub>20</Sub>
<Node><Sub>1</Sub>
<Data>20@1@1@13@@@@@1@2;6;30;46@@@@@1@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>20@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>20@24@1@10@@@@@1@2;6;32;40@@@@@size=35@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>20@34@1@35@@@@@1@@@@@@Разрешен ли импорт из Текстового файла@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>20@69@1@9@@@@@1@2;6;32;40@@@@@ImportTXT@</Data>
</Node>
</Node>
<Node><Sub>21</Sub>
<Node><Sub>1</Sub>
<Data>21@1@1@13@@@@@1@2;6;35;40@@@@@0</Data>
</Node>
<Node><Sub>2</Sub>
<Data>21@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>21@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data><![CDATA[21@34@1@35@@@@@1@2;6;33;40@@@@@Редактор системных таблиц (DICT,PIN,PROTECT,SESSIONS,TARIFF) выводить в одном окне@]]></Data>
</Node>
<Node><Sub>5</Sub>
<Data>21@69@1@9@@@@@1@2;6;32;40@@@@@EditTab1@</Data>
</Node>
</Node>
<Node><Sub>22</Sub>
<Node><Sub>1</Sub>
<Data>22@1@1@13@@@@@1@2;6;35;40@@@@@width=800,height=600@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>22@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>22@24@1@10@@@@@1@2;6;32;40@@@@@size=32@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>22@34@1@35@@@@@1@2;6;33;40@@@@@Размеры нового окна для редактора данных таблиц@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>22@69@1@9@@@@@1@2;6;32;40@@@@@NWT1@</Data>
</Node>
</Node>
<Node><Sub>23</Sub>
<Node><Sub>1</Sub>
<Data>23@1@1@13@@@@@1@2;6;35;40@@@@@width=800,height=600@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>23@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>23@24@1@10@@@@@1@2;6;32;40@@@@@size=32@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>23@34@1@35@@@@@1@2;6;33;40@@@@@Размеры нового окна для редактора Опций@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>23@69@1@9@@@@@1@2;6;32;40@@@@@NWO1@</Data>
</Node>
</Node>
<Node><Sub>24</Sub>
<Node><Sub>1</Sub>
<Data>24@1@1@13@@@@@1@2;6;30;46@@@@@1@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>24@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>24@24@1@10@@@@@1@2;6;32;40@@@@@size=35@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>24@34@1@35@@@@@1@@@@@@Разрешен ли пустой пароль пользователя@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>24@69@1@9@@@@@1@2;6;32;40@@@@@EmpPASS@</Data>
</Node>
</Node>
<Node><Sub>25</Sub>
<Node><Sub>1</Sub>
<Data>25@1@1@13@@@@@1@2;6;35;40@@@@@MSW@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>25@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>25@24@1@10@@@@@1@2;6;32;40@@@@@size=32@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>25@34@1@35@@@@@1@2;6;33;40@@@@@Конечный пользователь@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>25@69@1@9@@@@@1@2;6;32;40@@@@@ENDUSER@</Data>
</Node>
</Node>
<Node><Sub>26</Sub>
<Node><Sub>1</Sub>
<Data>26@1@1@13@@@@@1@2;6;35;40@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>26@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>26@24@1@10@@@@@1@2;6;32;40@@@@@size=32@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>26@34@1@35@@@@@1@2;6;33;40@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>26@69@1@9@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>59397,66776,SSS1</Data>
</Node>
<Node><Sub>OPT</Sub>
<Data>1</Data>
<Node><Sub>LST</Sub>
<Data>59397,66776,SSS1</Data>
<Node><Sub>B4I</Sub>
<Data>4</Data>
</Node>
<Node><Sub>CFG26</Sub>
<Data>26</Data>
</Node>
<Node><Sub>CFG7</Sub>
<Data>7</Data>
</Node>
<Node><Sub>COS</Sub>
<Data>17</Data>
</Node>
<Node><Sub>Commerce</Sub>
<Data>11</Data>
</Node>
<Node><Sub>Conc</Sub>
<Data>13</Data>
</Node>
<Node><Sub>CurCSS</Sub>
<Data>10</Data>
</Node>
<Node><Sub>CurNSP</Sub>
<Data>9</Data>
</Node>
<Node><Sub>ENDUSER</Sub>
<Data>25</Data>
</Node>
<Node><Sub>EditTab1</Sub>
<Data>21</Data>
</Node>
<Node><Sub>EmpPASS</Sub>
<Data>24</Data>
</Node>
<Node><Sub>HTM</Sub>
<Data>18</Data>
</Node>
<Node><Sub>IP</Sub>
<Data>3</Data>
</Node>
<Node><Sub>ImportODBC</Sub>
<Data>19</Data>
</Node>
<Node><Sub>ImportTXT</Sub>
<Data>20</Data>
</Node>
<Node><Sub>MultiL</Sub>
<Data>12</Data>
</Node>
<Node><Sub>NWO1</Sub>
<Data>23</Data>
</Node>
<Node><Sub>NWT1</Sub>
<Data>22</Data>
</Node>
<Node><Sub>Tariff</Sub>
<Data>5</Data>
</Node>
<Node><Sub>TempDir2</Sub>
<Data>8</Data>
</Node>
<Node><Sub>Vers</Sub>
<Data>6</Data>
</Node>
<Node><Sub>WebEditDT</Sub>
<Data>15</Data>
</Node>
<Node><Sub>WebEditRou</Sub>
<Data>14</Data>
</Node>
<Node><Sub>WebInfoSess</Sub>
<Data>16</Data>
</Node>
</Node>
</Node>
<Node><Sub>STA</Sub>
<Data>26,2@6@1@13@-1@-1@22@14@text</Data>
</Node>
</Node>
<Node><Sub>CFG1</Sub>
<Data>Основные Опции Комплекса@@@@@1@1@1@1@22@80@1@@1@1@@1@@2,1@1@@@@@@@@26@5@@1;6;35;44@@@@@@</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@13@@@@@1@2;6;35;40@@@@@ Value (DFLT)</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@14@1@10@@@@@1@2;6;30;41@@@@@ Type@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>1@24@1@10@@@@@1@2;6;30;41@@@@@Atribute@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>1@34@1@35@@@@@1@2;6;33;40@@@@@ ОПИСАНИЕ@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>1@69@1@9@@@@@1@2;6;30;41@@@@@ name@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@13@@@@@1@2;6;30;43@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>2@14@1@10@@@@@1@2;6;30;43@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>2@24@1@10@@@@@1@2;6;30;43@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>2@34@1@35@@@@@1@2;6;30;43@@@@@ Основные Опции Комплекса@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>2@69@1@9@@@@@1@2;6;30;43@@@@@@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@13@@@@@1@2;6;35;40@@@@@Информационный портал@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>3@24@1@10@@@@@1@2;6;32;40@@@@@size=30@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>3@34@1@35@@@@@1@2;6;33;40@@@@@Наименование портала@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>3@69@1@9@@@@@1@2;6;32;40@@@@@IP@</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>4@1@1@13@@@@@1@2;6;35;40@@@@@СКО ВВ@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>4@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>4@24@1@10@@@@@1@2;6;32;40@@@@@size=30@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>4@34@1@35@@@@@1@2;6;33;40@@@@@Название комплекса@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>4@69@1@9@@@@@1@2;6;32;40@@@@@B4I@</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>5@1@1@13@@@@@1@2;6;35;40@@@@@1@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>5@14@1@10@@@@@1@2;6;32;40@@@@@radio@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>5@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data><![CDATA[5@34@1@35@@@@@1@2;6;33;40@@@@@ТАРИФ ПО-УМОЛЧАНИЮ: ТЕСТОВЫЙ~ --//-- ЭКОНОМНЫЙ~ --//-- СТАНДАРТНЫЙ~ --//-- ПРОФЕССИОНАЛЬНЫЙ@]]></Data>
</Node>
<Node><Sub>5</Sub>
<Data>5@69@1@9@@@@@1@2;6;32;40@@@@@Tariff@</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>6@1@1@13@@@@@1@2;6;35;40@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>6@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>6@24@1@10@@@@@1@2;6;32;40@@@@@size=30@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>6@34@1@35@@@@@1@2;6;33;40@@@@@Копирайт и Номер версии комплекса@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>6@69@1@9@@@@@1@2;6;32;40@@@@@Vers@</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>7@1@1@13@@@@@1@2;6;35;40@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>7@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>7@24@1@10@@@@@1@2;6;32;40@@@@@size=30@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>7@34@1@35@@@@@1@2;6;33;40@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>7@69@1@9@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>1</Sub>
<Data>8@1@1@13@@@@@1@2;6;35;40@@@@@n:/infoportal/snx/@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>8@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>8@24@1@10@@@@@1@2;6;32;40@@@@@size=30@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>8@34@1@35@@@@@1@2;6;33;40@@@@@каталог временных файлов для записи@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>8@69@1@9@@@@@1@2;6;32;40@@@@@TempDir2@</Data>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>1</Sub>
<Data>9@1@1@13@@@@@1@2;6;35;40@@@@@SAMPLES@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>9@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>9@24@1@10@@@@@1@2;6;32;40@@@@@size=30@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>9@34@1@35@@@@@1@2;6;33;40@@@@@Текущая рабочая область для новых клиентов@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>9@69@1@9@@@@@1@2;6;32;40@@@@@CurNSP@</Data>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>1</Sub>
<Data>10@1@1@13@@@@@1@2;6;35;40@@@@@DFLT1@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>10@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>10@24@1@10@@@@@1@2;6;32;40@@@@@size=30@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>10@34@1@35@@@@@1@2;6;33;40@@@@@Текущий стиль@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>10@69@1@9@@@@@1@2;6;32;40@@@@@CurCSS@</Data>
</Node>
</Node>
<Node><Sub>11</Sub>
<Node><Sub>1</Sub>
<Data>11@1@1@13@@@@@1@2;6;35;40@@@@@2@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>11@14@1@10@@@@@1@2;6;32;40@@@@@radio@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>11@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>11@34@1@35@@@@@1@2;6;33;40@@@@@Портал тарифицируется~не тарифицируется@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>11@69@1@9@@@@@1@2;6;32;40@@@@@Commerce@</Data>
</Node>
</Node>
<Node><Sub>12</Sub>
<Node><Sub>1</Sub>
<Data>12@1@1@13@@@@@1@2;6;35;40@@@@@0</Data>
</Node>
<Node><Sub>2</Sub>
<Data>12@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>12@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>12@34@1@35@@@@@1@2;6;33;40@@@@@Мультиязычность@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>12@69@1@9@@@@@1@2;6;32;40@@@@@MultiL@</Data>
</Node>
</Node>
<Node><Sub>13</Sub>
<Node><Sub>1</Sub>
<Data>13@1@1@13@@@@@1@2;6;35;40@@@@@0</Data>
</Node>
<Node><Sub>2</Sub>
<Data>13@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>13@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>13@34@1@35@@@@@1@2;6;33;40@@@@@Конкурсы проектов@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>13@69@1@9@@@@@1@2;6;32;40@@@@@Conc@</Data>
</Node>
</Node>
<Node><Sub>14</Sub>
<Node><Sub>1</Sub>
<Data>14@1@1@13@@@@@1@2;6;35;40@@@@@1</Data>
</Node>
<Node><Sub>2</Sub>
<Data>14@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>14@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>14@34@1@35@@@@@1@2;6;33;40@@@@@Включен WEB редактор программ COS@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>14@69@1@9@@@@@1@2;6;32;40@@@@@WebEditRou@</Data>
</Node>
</Node>
<Node><Sub>15</Sub>
<Node><Sub>1</Sub>
<Data>15@1@1@13@@@@@1@2;6;35;40@@@@@1</Data>
</Node>
<Node><Sub>2</Sub>
<Data>15@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>15@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>15@34@1@35@@@@@1@2;6;33;40@@@@@Включен WEB редактор данных таблиц@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>15@69@1@9@@@@@1@2;6;32;40@@@@@WebEditDT@</Data>
</Node>
</Node>
<Node><Sub>16</Sub>
<Node><Sub>1</Sub>
<Data>16@1@1@13@@@@@1@2;6;35;40@@@@@1</Data>
</Node>
<Node><Sub>2</Sub>
<Data>16@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>16@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>16@34@1@35@@@@@1@2;6;33;40@@@@@Разрешен вывод информации о сессии и системе@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>16@69@1@9@@@@@1@2;6;32;40@@@@@WebInfoSess@</Data>
</Node>
</Node>
<Node><Sub>17</Sub>
<Node><Sub>1</Sub>
<Data>17@1@1@13@@@@@1@2;6;35;40@@@@@cols=68 rows=5@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>17@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>17@24@1@10@@@@@1@2;6;32;40@@@@@size=32@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>17@34@1@35@@@@@1@2;6;33;40@@@@@Параметры TEXTAREA для кода COS@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>17@69@1@9@@@@@1@2;6;32;40@@@@@COS@</Data>
</Node>
</Node>
<Node><Sub>18</Sub>
<Node><Sub>1</Sub>
<Data>18@1@1@13@@@@@1@2;6;35;40@@@@@cols=68 rows=5@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>18@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>18@24@1@10@@@@@1@2;6;32;40@@@@@size=32@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>18@34@1@35@@@@@1@2;6;33;40@@@@@Параметры TEXTAREA для HTML@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>18@69@1@9@@@@@1@2;6;32;40@@@@@HTM@</Data>
</Node>
</Node>
<Node><Sub>19</Sub>
<Node><Sub>1</Sub>
<Data>19@1@1@13@@@@@1@2;6;30;46@@@@@1@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>19@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>19@24@1@10@@@@@1@2;6;32;40@@@@@size=35@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>19@34@1@35@@@@@1@@@@@@Разрешена ли работа с ODBC@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>19@69@1@9@@@@@1@2;6;32;40@@@@@ImportODBC@</Data>
</Node>
</Node>
<Node><Sub>20</Sub>
<Node><Sub>1</Sub>
<Data>20@1@1@13@@@@@1@2;6;30;46@@@@@1@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>20@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>20@24@1@10@@@@@1@2;6;32;40@@@@@size=35@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>20@34@1@35@@@@@1@@@@@@Разрешен ли импорт из Текстового файла@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>20@69@1@9@@@@@1@2;6;32;40@@@@@ImportTXT@</Data>
</Node>
</Node>
<Node><Sub>21</Sub>
<Node><Sub>1</Sub>
<Data>21@1@1@13@@@@@1@2;6;35;40@@@@@0</Data>
</Node>
<Node><Sub>2</Sub>
<Data>21@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>21@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data><![CDATA[21@34@1@35@@@@@1@2;6;33;40@@@@@Редактор системных таблиц (DICT,PIN,PROTECT,SESSIONS,TARIFF) выводить в одном окне@]]></Data>
</Node>
<Node><Sub>5</Sub>
<Data>21@69@1@9@@@@@1@2;6;32;40@@@@@EditTab1@</Data>
</Node>
</Node>
<Node><Sub>22</Sub>
<Node><Sub>1</Sub>
<Data>22@1@1@13@@@@@1@2;6;35;40@@@@@width=800,height=600@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>22@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>22@24@1@10@@@@@1@2;6;32;40@@@@@size=32@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>22@34@1@35@@@@@1@2;6;33;40@@@@@Размеры нового окна для редактора данных таблиц@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>22@69@1@9@@@@@1@2;6;32;40@@@@@NWT1@</Data>
</Node>
</Node>
<Node><Sub>23</Sub>
<Node><Sub>1</Sub>
<Data>23@1@1@13@@@@@1@2;6;35;40@@@@@width=800,height=600@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>23@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>23@24@1@10@@@@@1@2;6;32;40@@@@@size=32@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>23@34@1@35@@@@@1@2;6;33;40@@@@@Размеры нового окна для редактора Опций@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>23@69@1@9@@@@@1@2;6;32;40@@@@@NWO1@</Data>
</Node>
</Node>
<Node><Sub>24</Sub>
<Node><Sub>1</Sub>
<Data>24@1@1@13@@@@@1@2;6;30;46@@@@@1@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>24@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>24@24@1@10@@@@@1@2;6;32;40@@@@@size=35@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>24@34@1@35@@@@@1@@@@@@Разрешен ли пустой пароль пользователя@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>24@69@1@9@@@@@1@2;6;32;40@@@@@EmpPASS@</Data>
</Node>
</Node>
<Node><Sub>25</Sub>
<Node><Sub>1</Sub>
<Data>25@1@1@13@@@@@1@2;6;35;40@@@@@ГЦ АСУ ГКВВ МВД России@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>25@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>25@24@1@10@@@@@1@2;6;32;40@@@@@size=32@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>25@34@1@35@@@@@1@2;6;33;40@@@@@Конечный пользователь@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>25@69@1@9@@@@@1@2;6;32;40@@@@@ENDUSER@</Data>
</Node>
</Node>
<Node><Sub>26</Sub>
<Node><Sub>1</Sub>
<Data>26@1@1@13@@@@@1@2;6;35;40@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>26@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>26@24@1@10@@@@@1@2;6;32;40@@@@@size=32@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>26@34@1@35@@@@@1@2;6;33;40@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>26@69@1@9@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>59397,66776,SSS1</Data>
</Node>
<Node><Sub>OPT</Sub>
<Data>1</Data>
<Node><Sub>LST</Sub>
<Data>59397,66776,SSS1</Data>
<Node><Sub>B4I</Sub>
<Data>4</Data>
</Node>
<Node><Sub>CFG26</Sub>
<Data>26</Data>
</Node>
<Node><Sub>CFG7</Sub>
<Data>7</Data>
</Node>
<Node><Sub>COS</Sub>
<Data>17</Data>
</Node>
<Node><Sub>Commerce</Sub>
<Data>11</Data>
</Node>
<Node><Sub>Conc</Sub>
<Data>13</Data>
</Node>
<Node><Sub>CurCSS</Sub>
<Data>10</Data>
</Node>
<Node><Sub>CurNSP</Sub>
<Data>9</Data>
</Node>
<Node><Sub>ENDUSER</Sub>
<Data>25</Data>
</Node>
<Node><Sub>EditTab1</Sub>
<Data>21</Data>
</Node>
<Node><Sub>EmpPASS</Sub>
<Data>24</Data>
</Node>
<Node><Sub>HTM</Sub>
<Data>18</Data>
</Node>
<Node><Sub>IP</Sub>
<Data>3</Data>
</Node>
<Node><Sub>ImportODBC</Sub>
<Data>19</Data>
</Node>
<Node><Sub>ImportTXT</Sub>
<Data>20</Data>
</Node>
<Node><Sub>MultiL</Sub>
<Data>12</Data>
</Node>
<Node><Sub>NWO1</Sub>
<Data>23</Data>
</Node>
<Node><Sub>NWT1</Sub>
<Data>22</Data>
</Node>
<Node><Sub>Tariff</Sub>
<Data>5</Data>
</Node>
<Node><Sub>TempDir2</Sub>
<Data>8</Data>
</Node>
<Node><Sub>Vers</Sub>
<Data>6</Data>
</Node>
<Node><Sub>WebEditDT</Sub>
<Data>15</Data>
</Node>
<Node><Sub>WebEditRou</Sub>
<Data>14</Data>
</Node>
<Node><Sub>WebInfoSess</Sub>
<Data>16</Data>
</Node>
</Node>
</Node>
<Node><Sub>STA</Sub>
<Data>25,1@6@1@13@-1@-1@21@1@ГЦ АСУ ГКВВ МВД России</Data>
</Node>
</Node>
<Node><Sub>CFG10</Sub>
<Data>Основные Опции Комплекса@@@@@1@1@1@1@22@80@1@@1@1@@1@@2,1@1@@@@@@@@26@5@@1;6;35;44@@@@@@</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@13@@@@@1@2;6;35;40@@@@@ Value (DFLT)</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@14@1@10@@@@@1@2;6;30;41@@@@@ Type@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>1@24@1@10@@@@@1@2;6;30;41@@@@@Atribute@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>1@34@1@35@@@@@1@2;6;33;40@@@@@ ОПИСАНИЕ@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>1@69@1@9@@@@@1@2;6;30;41@@@@@ name@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@13@@@@@1@2;6;30;43@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>2@14@1@10@@@@@1@2;6;30;43@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>2@24@1@10@@@@@1@2;6;30;43@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>2@34@1@35@@@@@1@2;6;30;43@@@@@ Основные Опции Комплекса@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>2@69@1@9@@@@@1@2;6;30;43@@@@@@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@13@@@@@1@2;6;35;40@@@@@Информационный портал@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>3@24@1@10@@@@@1@2;6;32;40@@@@@size=30@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>3@34@1@35@@@@@1@2;6;33;40@@@@@Наименование портала@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>3@69@1@9@@@@@1@2;6;32;40@@@@@IP@</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>4@1@1@13@@@@@1@2;6;35;40@@@@@ЧЦП ГКВВ@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>4@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>4@24@1@10@@@@@1@2;6;32;40@@@@@size=30@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>4@34@1@35@@@@@1@2;6;33;40@@@@@Название комплекса@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>4@69@1@9@@@@@1@2;6;32;40@@@@@B4I@</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>5@1@1@13@@@@@1@2;6;35;40@@@@@1@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>5@14@1@10@@@@@1@2;6;32;40@@@@@radio@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>5@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data><![CDATA[5@34@1@35@@@@@1@2;6;33;40@@@@@ТАРИФ ПО-УМОЛЧАНИЮ: ТЕСТОВЫЙ~ --//-- ЭКОНОМНЫЙ~ --//-- СТАНДАРТНЫЙ~ --//-- ПРОФЕССИОНАЛЬНЫЙ@]]></Data>
</Node>
<Node><Sub>5</Sub>
<Data>5@69@1@9@@@@@1@2;6;32;40@@@@@Tariff@</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>6@1@1@13@@@@@1@2;6;35;40@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>6@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>6@24@1@10@@@@@1@2;6;32;40@@@@@size=30@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>6@34@1@35@@@@@1@2;6;33;40@@@@@Копирайт и Номер версии комплекса@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>6@69@1@9@@@@@1@2;6;32;40@@@@@Vers@</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>7@1@1@13@@@@@1@2;6;35;40@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>7@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>7@24@1@10@@@@@1@2;6;32;40@@@@@size=30@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>7@34@1@35@@@@@1@2;6;33;40@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>7@69@1@9@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>1</Sub>
<Data>8@1@1@13@@@@@1@2;6;35;40@@@@@n:/infoportal/snx/@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>8@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>8@24@1@10@@@@@1@2;6;32;40@@@@@size=30@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>8@34@1@35@@@@@1@2;6;33;40@@@@@каталог временных файлов для записи@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>8@69@1@9@@@@@1@2;6;32;40@@@@@TempDir2@</Data>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>1</Sub>
<Data>9@1@1@13@@@@@1@2;6;35;40@@@@@SAMPLES@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>9@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>9@24@1@10@@@@@1@2;6;32;40@@@@@size=30@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>9@34@1@35@@@@@1@2;6;33;40@@@@@Текущая рабочая область для новых клиентов@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>9@69@1@9@@@@@1@2;6;32;40@@@@@CurNSP@</Data>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>1</Sub>
<Data>10@1@1@13@@@@@1@2;6;35;40@@@@@DFLT1@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>10@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>10@24@1@10@@@@@1@2;6;32;40@@@@@size=30@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>10@34@1@35@@@@@1@2;6;33;40@@@@@Текущий стиль@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>10@69@1@9@@@@@1@2;6;32;40@@@@@CurCSS@</Data>
</Node>
</Node>
<Node><Sub>11</Sub>
<Node><Sub>1</Sub>
<Data>11@1@1@13@@@@@1@2;6;35;40@@@@@2@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>11@14@1@10@@@@@1@2;6;32;40@@@@@radio@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>11@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>11@34@1@35@@@@@1@2;6;33;40@@@@@Портал тарифицируется~не тарифицируется@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>11@69@1@9@@@@@1@2;6;32;40@@@@@Commerce@</Data>
</Node>
</Node>
<Node><Sub>12</Sub>
<Node><Sub>1</Sub>
<Data>12@1@1@13@@@@@1@2;6;35;40@@@@@0</Data>
</Node>
<Node><Sub>2</Sub>
<Data>12@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>12@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>12@34@1@35@@@@@1@2;6;33;40@@@@@Мультиязычность@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>12@69@1@9@@@@@1@2;6;32;40@@@@@MultiL@</Data>
</Node>
</Node>
<Node><Sub>13</Sub>
<Node><Sub>1</Sub>
<Data>13@1@1@13@@@@@1@2;6;35;40@@@@@0</Data>
</Node>
<Node><Sub>2</Sub>
<Data>13@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>13@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>13@34@1@35@@@@@1@2;6;33;40@@@@@Конкурсы проектов@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>13@69@1@9@@@@@1@2;6;32;40@@@@@Conc@</Data>
</Node>
</Node>
<Node><Sub>14</Sub>
<Node><Sub>1</Sub>
<Data>14@1@1@13@@@@@1@2;6;35;40@@@@@1</Data>
</Node>
<Node><Sub>2</Sub>
<Data>14@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>14@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>14@34@1@35@@@@@1@2;6;33;40@@@@@Включен WEB редактор программ COS@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>14@69@1@9@@@@@1@2;6;32;40@@@@@WebEditRou@</Data>
</Node>
</Node>
<Node><Sub>15</Sub>
<Node><Sub>1</Sub>
<Data>15@1@1@13@@@@@1@2;6;35;40@@@@@1</Data>
</Node>
<Node><Sub>2</Sub>
<Data>15@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>15@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>15@34@1@35@@@@@1@2;6;33;40@@@@@Включен WEB редактор данных таблиц@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>15@69@1@9@@@@@1@2;6;32;40@@@@@WebEditDT@</Data>
</Node>
</Node>
<Node><Sub>16</Sub>
<Node><Sub>1</Sub>
<Data>16@1@1@13@@@@@1@2;6;35;40@@@@@1</Data>
</Node>
<Node><Sub>2</Sub>
<Data>16@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>16@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>16@34@1@35@@@@@1@2;6;33;40@@@@@Разрешен вывод информации о сессии и системе@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>16@69@1@9@@@@@1@2;6;32;40@@@@@WebInfoSess@</Data>
</Node>
</Node>
<Node><Sub>17</Sub>
<Node><Sub>1</Sub>
<Data>17@1@1@13@@@@@1@2;6;35;40@@@@@cols=68 rows=5@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>17@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>17@24@1@10@@@@@1@2;6;32;40@@@@@size=32@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>17@34@1@35@@@@@1@2;6;33;40@@@@@Параметры TEXTAREA для кода COS@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>17@69@1@9@@@@@1@2;6;32;40@@@@@COS@</Data>
</Node>
</Node>
<Node><Sub>18</Sub>
<Node><Sub>1</Sub>
<Data>18@1@1@13@@@@@1@2;6;35;40@@@@@cols=68 rows=5@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>18@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>18@24@1@10@@@@@1@2;6;32;40@@@@@size=32@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>18@34@1@35@@@@@1@2;6;33;40@@@@@Параметры TEXTAREA для HTML@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>18@69@1@9@@@@@1@2;6;32;40@@@@@HTM@</Data>
</Node>
</Node>
<Node><Sub>19</Sub>
<Node><Sub>1</Sub>
<Data>19@1@1@13@@@@@1@2;6;30;46@@@@@1@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>19@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>19@24@1@10@@@@@1@2;6;32;40@@@@@size=35@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>19@34@1@35@@@@@1@@@@@@Разрешена ли работа с ODBC@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>19@69@1@9@@@@@1@2;6;32;40@@@@@ImportODBC@</Data>
</Node>
</Node>
<Node><Sub>20</Sub>
<Node><Sub>1</Sub>
<Data>20@1@1@13@@@@@1@2;6;30;46@@@@@1@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>20@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>20@24@1@10@@@@@1@2;6;32;40@@@@@size=35@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>20@34@1@35@@@@@1@@@@@@Разрешен ли импорт из Текстового файла@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>20@69@1@9@@@@@1@2;6;32;40@@@@@ImportTXT@</Data>
</Node>
</Node>
<Node><Sub>21</Sub>
<Node><Sub>1</Sub>
<Data>21@1@1@13@@@@@1@2;6;35;40@@@@@0</Data>
</Node>
<Node><Sub>2</Sub>
<Data>21@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>21@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data><![CDATA[21@34@1@35@@@@@1@2;6;33;40@@@@@Редактор системных таблиц (DICT,PIN,PROTECT,SESSIONS,TARIFF) выводить в одном окне@]]></Data>
</Node>
<Node><Sub>5</Sub>
<Data>21@69@1@9@@@@@1@2;6;32;40@@@@@EditTab1@</Data>
</Node>
</Node>
<Node><Sub>22</Sub>
<Node><Sub>1</Sub>
<Data>22@1@1@13@@@@@1@2;6;35;40@@@@@width=800,height=600@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>22@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>22@24@1@10@@@@@1@2;6;32;40@@@@@size=32@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>22@34@1@35@@@@@1@2;6;33;40@@@@@Размеры нового окна для редактора данных таблиц@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>22@69@1@9@@@@@1@2;6;32;40@@@@@NWT1@</Data>
</Node>
</Node>
<Node><Sub>23</Sub>
<Node><Sub>1</Sub>
<Data>23@1@1@13@@@@@1@2;6;35;40@@@@@width=800,height=600@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>23@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>23@24@1@10@@@@@1@2;6;32;40@@@@@size=32@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>23@34@1@35@@@@@1@2;6;33;40@@@@@Размеры нового окна для редактора Опций@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>23@69@1@9@@@@@1@2;6;32;40@@@@@NWO1@</Data>
</Node>
</Node>
<Node><Sub>24</Sub>
<Node><Sub>1</Sub>
<Data>24@1@1@13@@@@@1@2;6;30;46@@@@@1@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>24@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>24@24@1@10@@@@@1@2;6;32;40@@@@@size=35@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>24@34@1@35@@@@@1@@@@@@Разрешен ли пустой пароль пользователя@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>24@69@1@9@@@@@1@2;6;32;40@@@@@EmpPASS@</Data>
</Node>
</Node>
<Node><Sub>25</Sub>
<Node><Sub>1</Sub>
<Data>25@1@1@13@@@@@1@2;6;35;40@@@@@ГЦ АСУ ГКВВ МВД России@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>25@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>25@24@1@10@@@@@1@2;6;32;40@@@@@size=32@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>25@34@1@35@@@@@1@2;6;33;40@@@@@Конечный пользователь@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>25@69@1@9@@@@@1@2;6;32;40@@@@@ENDUSER@</Data>
</Node>
</Node>
<Node><Sub>26</Sub>
<Node><Sub>1</Sub>
<Data>26@1@1@13@@@@@1@2;6;35;40@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>26@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>26@24@1@10@@@@@1@2;6;32;40@@@@@size=32@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>26@34@1@35@@@@@1@2;6;33;40@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>26@69@1@9@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>59397,66776,SSS1</Data>
</Node>
<Node><Sub>OPT</Sub>
<Data>1</Data>
<Node><Sub>LST</Sub>
<Data>59397,66776,SSS1</Data>
<Node><Sub>B4I</Sub>
<Data>4</Data>
</Node>
<Node><Sub>CFG26</Sub>
<Data>26</Data>
</Node>
<Node><Sub>CFG7</Sub>
<Data>7</Data>
</Node>
<Node><Sub>COS</Sub>
<Data>17</Data>
</Node>
<Node><Sub>Commerce</Sub>
<Data>11</Data>
</Node>
<Node><Sub>Conc</Sub>
<Data>13</Data>
</Node>
<Node><Sub>CurCSS</Sub>
<Data>10</Data>
</Node>
<Node><Sub>CurNSP</Sub>
<Data>9</Data>
</Node>
<Node><Sub>ENDUSER</Sub>
<Data>25</Data>
</Node>
<Node><Sub>EditTab1</Sub>
<Data>21</Data>
</Node>
<Node><Sub>EmpPASS</Sub>
<Data>24</Data>
</Node>
<Node><Sub>HTM</Sub>
<Data>18</Data>
</Node>
<Node><Sub>IP</Sub>
<Data>3</Data>
</Node>
<Node><Sub>ImportODBC</Sub>
<Data>19</Data>
</Node>
<Node><Sub>ImportTXT</Sub>
<Data>20</Data>
</Node>
<Node><Sub>MultiL</Sub>
<Data>12</Data>
</Node>
<Node><Sub>NWO1</Sub>
<Data>23</Data>
</Node>
<Node><Sub>NWT1</Sub>
<Data>22</Data>
</Node>
<Node><Sub>Tariff</Sub>
<Data>5</Data>
</Node>
<Node><Sub>TempDir2</Sub>
<Data>8</Data>
</Node>
<Node><Sub>Vers</Sub>
<Data>6</Data>
</Node>
<Node><Sub>WebEditDT</Sub>
<Data>15</Data>
</Node>
<Node><Sub>WebEditRou</Sub>
<Data>14</Data>
</Node>
<Node><Sub>WebInfoSess</Sub>
<Data>16</Data>
</Node>
</Node>
</Node>
<Node><Sub>STA</Sub>
<Data>4,2@2@1@13@-1@-1@4@14@text</Data>
</Node>
</Node>
<Node><Sub>CFG2</Sub>
<Data>Основные Опции Комплекса@@@@@1@1@1@1@22@80@1@@1@1@@1@@2,1@1@@@@@@@@26@5@@1;6;35;44@@@@@@</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@13@@@@@1@2;6;35;40@@@@@ Value (DFLT)</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@14@1@10@@@@@1@2;6;30;41@@@@@ Type@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>1@24@1@10@@@@@1@2;6;30;41@@@@@Atribute@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>1@34@1@35@@@@@1@2;6;33;40@@@@@ ОПИСАНИЕ@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>1@69@1@9@@@@@1@2;6;30;41@@@@@ name@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@13@@@@@1@2;6;30;43@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>2@14@1@10@@@@@1@2;6;30;43@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>2@24@1@10@@@@@1@2;6;30;43@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>2@34@1@35@@@@@1@2;6;30;43@@@@@ Основные Опции Комплекса@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>2@69@1@9@@@@@1@2;6;30;43@@@@@@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@13@@@@@1@2;6;35;40@@@@@Информационный портал@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>3@24@1@10@@@@@1@2;6;32;40@@@@@size=30@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>3@34@1@35@@@@@1@2;6;33;40@@@@@Наименование портала@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>3@69@1@9@@@@@1@2;6;32;40@@@@@IP@</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>4@1@1@13@@@@@1@2;6;35;40@@@@@МО ВВ@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>4@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>4@24@1@10@@@@@1@2;6;32;40@@@@@size=30@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>4@34@1@35@@@@@1@2;6;33;40@@@@@Название комплекса@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>4@69@1@9@@@@@1@2;6;32;40@@@@@B4I@</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>5@1@1@13@@@@@1@2;6;35;40@@@@@1@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>5@14@1@10@@@@@1@2;6;32;40@@@@@radio@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>5@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data><![CDATA[5@34@1@35@@@@@1@2;6;33;40@@@@@ТАРИФ ПО-УМОЛЧАНИЮ: ТЕСТОВЫЙ~ --//-- ЭКОНОМНЫЙ~ --//-- СТАНДАРТНЫЙ~ --//-- ПРОФЕССИОНАЛЬНЫЙ@]]></Data>
</Node>
<Node><Sub>5</Sub>
<Data>5@69@1@9@@@@@1@2;6;32;40@@@@@Tariff@</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>6@1@1@13@@@@@1@2;6;35;40@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>6@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>6@24@1@10@@@@@1@2;6;32;40@@@@@size=30@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>6@34@1@35@@@@@1@2;6;33;40@@@@@Копирайт и Номер версии комплекса@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>6@69@1@9@@@@@1@2;6;32;40@@@@@Vers@</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>7@1@1@13@@@@@1@2;6;35;40@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>7@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>7@24@1@10@@@@@1@2;6;32;40@@@@@size=30@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>7@34@1@35@@@@@1@2;6;33;40@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>7@69@1@9@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>1</Sub>
<Data>8@1@1@13@@@@@1@2;6;35;40@@@@@n:/infoportal/snx/@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>8@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>8@24@1@10@@@@@1@2;6;32;40@@@@@size=30@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>8@34@1@35@@@@@1@2;6;33;40@@@@@каталог временных файлов для записи@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>8@69@1@9@@@@@1@2;6;32;40@@@@@TempDir2@</Data>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>1</Sub>
<Data>9@1@1@13@@@@@1@2;6;35;40@@@@@SAMPLES@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>9@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>9@24@1@10@@@@@1@2;6;32;40@@@@@size=30@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>9@34@1@35@@@@@1@2;6;33;40@@@@@Текущая рабочая область для новых клиентов@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>9@69@1@9@@@@@1@2;6;32;40@@@@@CurNSP@</Data>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>1</Sub>
<Data>10@1@1@13@@@@@1@2;6;35;40@@@@@DFLT1@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>10@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>10@24@1@10@@@@@1@2;6;32;40@@@@@size=30@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>10@34@1@35@@@@@1@2;6;33;40@@@@@Текущий стиль@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>10@69@1@9@@@@@1@2;6;32;40@@@@@CurCSS@</Data>
</Node>
</Node>
<Node><Sub>11</Sub>
<Node><Sub>1</Sub>
<Data>11@1@1@13@@@@@1@2;6;35;40@@@@@2@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>11@14@1@10@@@@@1@2;6;32;40@@@@@radio@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>11@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>11@34@1@35@@@@@1@2;6;33;40@@@@@Портал тарифицируется~не тарифицируется@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>11@69@1@9@@@@@1@2;6;32;40@@@@@Commerce@</Data>
</Node>
</Node>
<Node><Sub>12</Sub>
<Node><Sub>1</Sub>
<Data>12@1@1@13@@@@@1@2;6;35;40@@@@@0</Data>
</Node>
<Node><Sub>2</Sub>
<Data>12@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>12@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>12@34@1@35@@@@@1@2;6;33;40@@@@@Мультиязычность@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>12@69@1@9@@@@@1@2;6;32;40@@@@@MultiL@</Data>
</Node>
</Node>
<Node><Sub>13</Sub>
<Node><Sub>1</Sub>
<Data>13@1@1@13@@@@@1@2;6;35;40@@@@@0</Data>
</Node>
<Node><Sub>2</Sub>
<Data>13@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>13@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>13@34@1@35@@@@@1@2;6;33;40@@@@@Конкурсы проектов@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>13@69@1@9@@@@@1@2;6;32;40@@@@@Conc@</Data>
</Node>
</Node>
<Node><Sub>14</Sub>
<Node><Sub>1</Sub>
<Data>14@1@1@13@@@@@1@2;6;35;40@@@@@1</Data>
</Node>
<Node><Sub>2</Sub>
<Data>14@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>14@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>14@34@1@35@@@@@1@2;6;33;40@@@@@Включен WEB редактор программ COS@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>14@69@1@9@@@@@1@2;6;32;40@@@@@WebEditRou@</Data>
</Node>
</Node>
<Node><Sub>15</Sub>
<Node><Sub>1</Sub>
<Data>15@1@1@13@@@@@1@2;6;35;40@@@@@1</Data>
</Node>
<Node><Sub>2</Sub>
<Data>15@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>15@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>15@34@1@35@@@@@1@2;6;33;40@@@@@Включен WEB редактор данных таблиц@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>15@69@1@9@@@@@1@2;6;32;40@@@@@WebEditDT@</Data>
</Node>
</Node>
<Node><Sub>16</Sub>
<Node><Sub>1</Sub>
<Data>16@1@1@13@@@@@1@2;6;35;40@@@@@1</Data>
</Node>
<Node><Sub>2</Sub>
<Data>16@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>16@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>16@34@1@35@@@@@1@2;6;33;40@@@@@Разрешен вывод информации о сессии и системе@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>16@69@1@9@@@@@1@2;6;32;40@@@@@WebInfoSess@</Data>
</Node>
</Node>
<Node><Sub>17</Sub>
<Node><Sub>1</Sub>
<Data>17@1@1@13@@@@@1@2;6;35;40@@@@@cols=68 rows=5@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>17@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>17@24@1@10@@@@@1@2;6;32;40@@@@@size=32@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>17@34@1@35@@@@@1@2;6;33;40@@@@@Параметры TEXTAREA для кода COS@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>17@69@1@9@@@@@1@2;6;32;40@@@@@COS@</Data>
</Node>
</Node>
<Node><Sub>18</Sub>
<Node><Sub>1</Sub>
<Data>18@1@1@13@@@@@1@2;6;35;40@@@@@cols=68 rows=5@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>18@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>18@24@1@10@@@@@1@2;6;32;40@@@@@size=32@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>18@34@1@35@@@@@1@2;6;33;40@@@@@Параметры TEXTAREA для HTML@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>18@69@1@9@@@@@1@2;6;32;40@@@@@HTM@</Data>
</Node>
</Node>
<Node><Sub>19</Sub>
<Node><Sub>1</Sub>
<Data>19@1@1@13@@@@@1@2;6;30;46@@@@@1@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>19@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>19@24@1@10@@@@@1@2;6;32;40@@@@@size=35@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>19@34@1@35@@@@@1@@@@@@Разрешена ли работа с ODBC@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>19@69@1@9@@@@@1@2;6;32;40@@@@@ImportODBC@</Data>
</Node>
</Node>
<Node><Sub>20</Sub>
<Node><Sub>1</Sub>
<Data>20@1@1@13@@@@@1@2;6;30;46@@@@@1@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>20@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>20@24@1@10@@@@@1@2;6;32;40@@@@@size=35@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>20@34@1@35@@@@@1@@@@@@Разрешен ли импорт из Текстового файла@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>20@69@1@9@@@@@1@2;6;32;40@@@@@ImportTXT@</Data>
</Node>
</Node>
<Node><Sub>21</Sub>
<Node><Sub>1</Sub>
<Data>21@1@1@13@@@@@1@2;6;35;40@@@@@0</Data>
</Node>
<Node><Sub>2</Sub>
<Data>21@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>21@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data><![CDATA[21@34@1@35@@@@@1@2;6;33;40@@@@@Редактор системных таблиц (DICT,PIN,PROTECT,SESSIONS,TARIFF) выводить в одном окне@]]></Data>
</Node>
<Node><Sub>5</Sub>
<Data>21@69@1@9@@@@@1@2;6;32;40@@@@@EditTab1@</Data>
</Node>
</Node>
<Node><Sub>22</Sub>
<Node><Sub>1</Sub>
<Data>22@1@1@13@@@@@1@2;6;35;40@@@@@width=800,height=600@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>22@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>22@24@1@10@@@@@1@2;6;32;40@@@@@size=32@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>22@34@1@35@@@@@1@2;6;33;40@@@@@Размеры нового окна для редактора данных таблиц@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>22@69@1@9@@@@@1@2;6;32;40@@@@@NWT1@</Data>
</Node>
</Node>
<Node><Sub>23</Sub>
<Node><Sub>1</Sub>
<Data>23@1@1@13@@@@@1@2;6;35;40@@@@@width=800,height=600@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>23@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>23@24@1@10@@@@@1@2;6;32;40@@@@@size=32@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>23@34@1@35@@@@@1@2;6;33;40@@@@@Размеры нового окна для редактора Опций@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>23@69@1@9@@@@@1@2;6;32;40@@@@@NWO1@</Data>
</Node>
</Node>
<Node><Sub>24</Sub>
<Node><Sub>1</Sub>
<Data>24@1@1@13@@@@@1@2;6;30;46@@@@@1@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>24@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>24@24@1@10@@@@@1@2;6;32;40@@@@@size=35@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>24@34@1@35@@@@@1@@@@@@Разрешен ли пустой пароль пользователя@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>24@69@1@9@@@@@1@2;6;32;40@@@@@EmpPASS@</Data>
</Node>
</Node>
<Node><Sub>25</Sub>
<Node><Sub>1</Sub>
<Data>25@1@1@13@@@@@1@2;6;35;40@@@@@ГЦ АСУ ГКВВ МВД России@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>25@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>25@24@1@10@@@@@1@2;6;32;40@@@@@size=32@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>25@34@1@35@@@@@1@2;6;33;40@@@@@Конечный пользователь@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>25@69@1@9@@@@@1@2;6;32;40@@@@@ENDUSER@</Data>
</Node>
</Node>
<Node><Sub>26</Sub>
<Node><Sub>1</Sub>
<Data>26@1@1@13@@@@@1@2;6;35;40@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>26@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>26@24@1@10@@@@@1@2;6;32;40@@@@@size=32@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>26@34@1@35@@@@@1@2;6;33;40@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>26@69@1@9@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>59397,66776,SSS1</Data>
</Node>
<Node><Sub>OPT</Sub>
<Data>1</Data>
<Node><Sub>LST</Sub>
<Data>59397,66776,SSS1</Data>
<Node><Sub>B4I</Sub>
<Data>4</Data>
</Node>
<Node><Sub>CFG26</Sub>
<Data>26</Data>
</Node>
<Node><Sub>CFG7</Sub>
<Data>7</Data>
</Node>
<Node><Sub>COS</Sub>
<Data>17</Data>
</Node>
<Node><Sub>Commerce</Sub>
<Data>11</Data>
</Node>
<Node><Sub>Conc</Sub>
<Data>13</Data>
</Node>
<Node><Sub>CurCSS</Sub>
<Data>10</Data>
</Node>
<Node><Sub>CurNSP</Sub>
<Data>9</Data>
</Node>
<Node><Sub>ENDUSER</Sub>
<Data>25</Data>
</Node>
<Node><Sub>EditTab1</Sub>
<Data>21</Data>
</Node>
<Node><Sub>EmpPASS</Sub>
<Data>24</Data>
</Node>
<Node><Sub>HTM</Sub>
<Data>18</Data>
</Node>
<Node><Sub>IP</Sub>
<Data>3</Data>
</Node>
<Node><Sub>ImportODBC</Sub>
<Data>19</Data>
</Node>
<Node><Sub>ImportTXT</Sub>
<Data>20</Data>
</Node>
<Node><Sub>MultiL</Sub>
<Data>12</Data>
</Node>
<Node><Sub>NWO1</Sub>
<Data>23</Data>
</Node>
<Node><Sub>NWT1</Sub>
<Data>22</Data>
</Node>
<Node><Sub>Tariff</Sub>
<Data>5</Data>
</Node>
<Node><Sub>TempDir2</Sub>
<Data>8</Data>
</Node>
<Node><Sub>Vers</Sub>
<Data>6</Data>
</Node>
<Node><Sub>WebEditDT</Sub>
<Data>15</Data>
</Node>
<Node><Sub>WebEditRou</Sub>
<Data>14</Data>
</Node>
<Node><Sub>WebInfoSess</Sub>
<Data>16</Data>
</Node>
</Node>
</Node>
<Node><Sub>STA</Sub>
<Data>25,1@22@1@13@-1@-1@5@1@ГЦ АСУ ГКВВ МВД России</Data>
</Node>
</Node>
<Node><Sub>CFG3</Sub>
<Data>Основные Опции Комплекса@@@@@1@1@1@1@22@80@1@@1@1@@1@@2,1@1@@@@@@@@26@5@@1;6;35;44@@@@@@</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@13@@@@@1@2;6;35;40@@@@@ Value (DFLT)</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@14@1@10@@@@@1@2;6;30;41@@@@@ Type@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>1@24@1@10@@@@@1@2;6;30;41@@@@@Atribute@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>1@34@1@35@@@@@1@2;6;33;40@@@@@ ОПИСАНИЕ@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>1@69@1@9@@@@@1@2;6;30;41@@@@@ name@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@13@@@@@1@2;6;30;43@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>2@14@1@10@@@@@1@2;6;30;43@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>2@24@1@10@@@@@1@2;6;30;43@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>2@34@1@35@@@@@1@2;6;30;43@@@@@ Основные Опции Комплекса@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>2@69@1@9@@@@@1@2;6;30;43@@@@@@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@13@@@@@1@2;6;35;40@@@@@Информационный портал@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>3@24@1@10@@@@@1@2;6;32;40@@@@@size=30@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>3@34@1@35@@@@@1@2;6;33;40@@@@@Наименование портала@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>3@69@1@9@@@@@1@2;6;32;40@@@@@IP@</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>4@1@1@13@@@@@1@2;6;35;40@@@@@СЗО ВВ@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>4@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>4@24@1@10@@@@@1@2;6;32;40@@@@@size=30@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>4@34@1@35@@@@@1@2;6;33;40@@@@@Название комплекса@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>4@69@1@9@@@@@1@2;6;32;40@@@@@B4I@</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>5@1@1@13@@@@@1@2;6;35;40@@@@@1@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>5@14@1@10@@@@@1@2;6;32;40@@@@@radio@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>5@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data><![CDATA[5@34@1@35@@@@@1@2;6;33;40@@@@@ТАРИФ ПО-УМОЛЧАНИЮ: ТЕСТОВЫЙ~ --//-- ЭКОНОМНЫЙ~ --//-- СТАНДАРТНЫЙ~ --//-- ПРОФЕССИОНАЛЬНЫЙ@]]></Data>
</Node>
<Node><Sub>5</Sub>
<Data>5@69@1@9@@@@@1@2;6;32;40@@@@@Tariff@</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>6@1@1@13@@@@@1@2;6;35;40@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>6@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>6@24@1@10@@@@@1@2;6;32;40@@@@@size=30@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>6@34@1@35@@@@@1@2;6;33;40@@@@@Копирайт и Номер версии комплекса@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>6@69@1@9@@@@@1@2;6;32;40@@@@@Vers@</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>7@1@1@13@@@@@1@2;6;35;40@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>7@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>7@24@1@10@@@@@1@2;6;32;40@@@@@size=30@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>7@34@1@35@@@@@1@2;6;33;40@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>7@69@1@9@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>1</Sub>
<Data>8@1@1@13@@@@@1@2;6;35;40@@@@@n:/infoportal/snx/@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>8@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>8@24@1@10@@@@@1@2;6;32;40@@@@@size=30@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>8@34@1@35@@@@@1@2;6;33;40@@@@@каталог временных файлов для записи@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>8@69@1@9@@@@@1@2;6;32;40@@@@@TempDir2@</Data>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>1</Sub>
<Data>9@1@1@13@@@@@1@2;6;35;40@@@@@SAMPLES@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>9@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>9@24@1@10@@@@@1@2;6;32;40@@@@@size=30@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>9@34@1@35@@@@@1@2;6;33;40@@@@@Текущая рабочая область для новых клиентов@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>9@69@1@9@@@@@1@2;6;32;40@@@@@CurNSP@</Data>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>1</Sub>
<Data>10@1@1@13@@@@@1@2;6;35;40@@@@@DFLT1@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>10@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>10@24@1@10@@@@@1@2;6;32;40@@@@@size=30@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>10@34@1@35@@@@@1@2;6;33;40@@@@@Текущий стиль@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>10@69@1@9@@@@@1@2;6;32;40@@@@@CurCSS@</Data>
</Node>
</Node>
<Node><Sub>11</Sub>
<Node><Sub>1</Sub>
<Data>11@1@1@13@@@@@1@2;6;35;40@@@@@2@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>11@14@1@10@@@@@1@2;6;32;40@@@@@radio@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>11@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>11@34@1@35@@@@@1@2;6;33;40@@@@@Портал тарифицируется~не тарифицируется@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>11@69@1@9@@@@@1@2;6;32;40@@@@@Commerce@</Data>
</Node>
</Node>
<Node><Sub>12</Sub>
<Node><Sub>1</Sub>
<Data>12@1@1@13@@@@@1@2;6;35;40@@@@@0</Data>
</Node>
<Node><Sub>2</Sub>
<Data>12@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>12@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>12@34@1@35@@@@@1@2;6;33;40@@@@@Мультиязычность@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>12@69@1@9@@@@@1@2;6;32;40@@@@@MultiL@</Data>
</Node>
</Node>
<Node><Sub>13</Sub>
<Node><Sub>1</Sub>
<Data>13@1@1@13@@@@@1@2;6;35;40@@@@@0</Data>
</Node>
<Node><Sub>2</Sub>
<Data>13@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>13@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>13@34@1@35@@@@@1@2;6;33;40@@@@@Конкурсы проектов@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>13@69@1@9@@@@@1@2;6;32;40@@@@@Conc@</Data>
</Node>
</Node>
<Node><Sub>14</Sub>
<Node><Sub>1</Sub>
<Data>14@1@1@13@@@@@1@2;6;35;40@@@@@1</Data>
</Node>
<Node><Sub>2</Sub>
<Data>14@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>14@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>14@34@1@35@@@@@1@2;6;33;40@@@@@Включен WEB редактор программ COS@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>14@69@1@9@@@@@1@2;6;32;40@@@@@WebEditRou@</Data>
</Node>
</Node>
<Node><Sub>15</Sub>
<Node><Sub>1</Sub>
<Data>15@1@1@13@@@@@1@2;6;35;40@@@@@1</Data>
</Node>
<Node><Sub>2</Sub>
<Data>15@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>15@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>15@34@1@35@@@@@1@2;6;33;40@@@@@Включен WEB редактор данных таблиц@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>15@69@1@9@@@@@1@2;6;32;40@@@@@WebEditDT@</Data>
</Node>
</Node>
<Node><Sub>16</Sub>
<Node><Sub>1</Sub>
<Data>16@1@1@13@@@@@1@2;6;35;40@@@@@1</Data>
</Node>
<Node><Sub>2</Sub>
<Data>16@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>16@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>16@34@1@35@@@@@1@2;6;33;40@@@@@Разрешен вывод информации о сессии и системе@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>16@69@1@9@@@@@1@2;6;32;40@@@@@WebInfoSess@</Data>
</Node>
</Node>
<Node><Sub>17</Sub>
<Node><Sub>1</Sub>
<Data>17@1@1@13@@@@@1@2;6;35;40@@@@@cols=68 rows=5@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>17@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>17@24@1@10@@@@@1@2;6;32;40@@@@@size=32@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>17@34@1@35@@@@@1@2;6;33;40@@@@@Параметры TEXTAREA для кода COS@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>17@69@1@9@@@@@1@2;6;32;40@@@@@COS@</Data>
</Node>
</Node>
<Node><Sub>18</Sub>
<Node><Sub>1</Sub>
<Data>18@1@1@13@@@@@1@2;6;35;40@@@@@cols=68 rows=5@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>18@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>18@24@1@10@@@@@1@2;6;32;40@@@@@size=32@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>18@34@1@35@@@@@1@2;6;33;40@@@@@Параметры TEXTAREA для HTML@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>18@69@1@9@@@@@1@2;6;32;40@@@@@HTM@</Data>
</Node>
</Node>
<Node><Sub>19</Sub>
<Node><Sub>1</Sub>
<Data>19@1@1@13@@@@@1@2;6;30;46@@@@@1@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>19@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>19@24@1@10@@@@@1@2;6;32;40@@@@@size=35@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>19@34@1@35@@@@@1@@@@@@Разрешена ли работа с ODBC@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>19@69@1@9@@@@@1@2;6;32;40@@@@@ImportODBC@</Data>
</Node>
</Node>
<Node><Sub>20</Sub>
<Node><Sub>1</Sub>
<Data>20@1@1@13@@@@@1@2;6;30;46@@@@@1@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>20@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>20@24@1@10@@@@@1@2;6;32;40@@@@@size=35@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>20@34@1@35@@@@@1@@@@@@Разрешен ли импорт из Текстового файла@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>20@69@1@9@@@@@1@2;6;32;40@@@@@ImportTXT@</Data>
</Node>
</Node>
<Node><Sub>21</Sub>
<Node><Sub>1</Sub>
<Data>21@1@1@13@@@@@1@2;6;35;40@@@@@0</Data>
</Node>
<Node><Sub>2</Sub>
<Data>21@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>21@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data><![CDATA[21@34@1@35@@@@@1@2;6;33;40@@@@@Редактор системных таблиц (DICT,PIN,PROTECT,SESSIONS,TARIFF) выводить в одном окне@]]></Data>
</Node>
<Node><Sub>5</Sub>
<Data>21@69@1@9@@@@@1@2;6;32;40@@@@@EditTab1@</Data>
</Node>
</Node>
<Node><Sub>22</Sub>
<Node><Sub>1</Sub>
<Data>22@1@1@13@@@@@1@2;6;35;40@@@@@width=800,height=600@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>22@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>22@24@1@10@@@@@1@2;6;32;40@@@@@size=32@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>22@34@1@35@@@@@1@2;6;33;40@@@@@Размеры нового окна для редактора данных таблиц@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>22@69@1@9@@@@@1@2;6;32;40@@@@@NWT1@</Data>
</Node>
</Node>
<Node><Sub>23</Sub>
<Node><Sub>1</Sub>
<Data>23@1@1@13@@@@@1@2;6;35;40@@@@@width=800,height=600@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>23@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>23@24@1@10@@@@@1@2;6;32;40@@@@@size=32@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>23@34@1@35@@@@@1@2;6;33;40@@@@@Размеры нового окна для редактора Опций@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>23@69@1@9@@@@@1@2;6;32;40@@@@@NWO1@</Data>
</Node>
</Node>
<Node><Sub>24</Sub>
<Node><Sub>1</Sub>
<Data>24@1@1@13@@@@@1@2;6;30;46@@@@@1@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>24@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>24@24@1@10@@@@@1@2;6;32;40@@@@@size=35@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>24@34@1@35@@@@@1@@@@@@Разрешен ли пустой пароль пользователя@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>24@69@1@9@@@@@1@2;6;32;40@@@@@EmpPASS@</Data>
</Node>
</Node>
<Node><Sub>25</Sub>
<Node><Sub>1</Sub>
<Data>25@1@1@13@@@@@1@2;6;35;40@@@@@ГЦ АСУ ГКВВ МВД России@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>25@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>25@24@1@10@@@@@1@2;6;32;40@@@@@size=32@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>25@34@1@35@@@@@1@2;6;33;40@@@@@Конечный пользователь@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>25@69@1@9@@@@@1@2;6;32;40@@@@@ENDUSER@</Data>
</Node>
</Node>
<Node><Sub>26</Sub>
<Node><Sub>1</Sub>
<Data>26@1@1@13@@@@@1@2;6;35;40@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>26@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>26@24@1@10@@@@@1@2;6;32;40@@@@@size=32@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>26@34@1@35@@@@@1@2;6;33;40@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>26@69@1@9@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>59397,66776,SSS1</Data>
</Node>
<Node><Sub>OPT</Sub>
<Data>1</Data>
<Node><Sub>LST</Sub>
<Data>59397,66776,SSS1</Data>
<Node><Sub>B4I</Sub>
<Data>4</Data>
</Node>
<Node><Sub>CFG26</Sub>
<Data>26</Data>
</Node>
<Node><Sub>CFG7</Sub>
<Data>7</Data>
</Node>
<Node><Sub>COS</Sub>
<Data>17</Data>
</Node>
<Node><Sub>Commerce</Sub>
<Data>11</Data>
</Node>
<Node><Sub>Conc</Sub>
<Data>13</Data>
</Node>
<Node><Sub>CurCSS</Sub>
<Data>10</Data>
</Node>
<Node><Sub>CurNSP</Sub>
<Data>9</Data>
</Node>
<Node><Sub>ENDUSER</Sub>
<Data>25</Data>
</Node>
<Node><Sub>EditTab1</Sub>
<Data>21</Data>
</Node>
<Node><Sub>EmpPASS</Sub>
<Data>24</Data>
</Node>
<Node><Sub>HTM</Sub>
<Data>18</Data>
</Node>
<Node><Sub>IP</Sub>
<Data>3</Data>
</Node>
<Node><Sub>ImportODBC</Sub>
<Data>19</Data>
</Node>
<Node><Sub>ImportTXT</Sub>
<Data>20</Data>
</Node>
<Node><Sub>MultiL</Sub>
<Data>12</Data>
</Node>
<Node><Sub>NWO1</Sub>
<Data>23</Data>
</Node>
<Node><Sub>NWT1</Sub>
<Data>22</Data>
</Node>
<Node><Sub>Tariff</Sub>
<Data>5</Data>
</Node>
<Node><Sub>TempDir2</Sub>
<Data>8</Data>
</Node>
<Node><Sub>Vers</Sub>
<Data>6</Data>
</Node>
<Node><Sub>WebEditDT</Sub>
<Data>15</Data>
</Node>
<Node><Sub>WebEditRou</Sub>
<Data>14</Data>
</Node>
<Node><Sub>WebInfoSess</Sub>
<Data>16</Data>
</Node>
</Node>
</Node>
<Node><Sub>STA</Sub>
<Data>4,2@2@1@13@-1@-1@4@14@text</Data>
</Node>
</Node>
<Node><Sub>CFG4</Sub>
<Data>Основные Опции Комплекса@@@@@1@1@1@1@22@80@1@@1@1@@1@@2,1@1@@@@@@@@26@5@@1;6;35;44@@@@@@</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@13@@@@@1@2;6;35;40@@@@@ Value (DFLT)</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@14@1@10@@@@@1@2;6;30;41@@@@@ Type@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>1@24@1@10@@@@@1@2;6;30;41@@@@@Atribute@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>1@34@1@35@@@@@1@2;6;33;40@@@@@ ОПИСАНИЕ@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>1@69@1@9@@@@@1@2;6;30;41@@@@@ name@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@13@@@@@1@2;6;30;43@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>2@14@1@10@@@@@1@2;6;30;43@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>2@24@1@10@@@@@1@2;6;30;43@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>2@34@1@35@@@@@1@2;6;30;43@@@@@ Основные Опции Комплекса@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>2@69@1@9@@@@@1@2;6;30;43@@@@@@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@13@@@@@1@2;6;35;40@@@@@Информационный портал@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>3@24@1@10@@@@@1@2;6;32;40@@@@@size=30@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>3@34@1@35@@@@@1@2;6;33;40@@@@@Наименование портала@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>3@69@1@9@@@@@1@2;6;32;40@@@@@IP@</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>4@1@1@13@@@@@1@2;6;35;40@@@@@ПривО ВВ@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>4@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>4@24@1@10@@@@@1@2;6;32;40@@@@@size=30@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>4@34@1@35@@@@@1@2;6;33;40@@@@@Название комплекса@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>4@69@1@9@@@@@1@2;6;32;40@@@@@B4I@</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>5@1@1@13@@@@@1@2;6;35;40@@@@@1@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>5@14@1@10@@@@@1@2;6;32;40@@@@@radio@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>5@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data><![CDATA[5@34@1@35@@@@@1@2;6;33;40@@@@@ТАРИФ ПО-УМОЛЧАНИЮ: ТЕСТОВЫЙ~ --//-- ЭКОНОМНЫЙ~ --//-- СТАНДАРТНЫЙ~ --//-- ПРОФЕССИОНАЛЬНЫЙ@]]></Data>
</Node>
<Node><Sub>5</Sub>
<Data>5@69@1@9@@@@@1@2;6;32;40@@@@@Tariff@</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>6@1@1@13@@@@@1@2;6;35;40@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>6@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>6@24@1@10@@@@@1@2;6;32;40@@@@@size=30@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>6@34@1@35@@@@@1@2;6;33;40@@@@@Копирайт и Номер версии комплекса@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>6@69@1@9@@@@@1@2;6;32;40@@@@@Vers@</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>7@1@1@13@@@@@1@2;6;35;40@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>7@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>7@24@1@10@@@@@1@2;6;32;40@@@@@size=30@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>7@34@1@35@@@@@1@2;6;33;40@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>7@69@1@9@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>1</Sub>
<Data>8@1@1@13@@@@@1@2;6;35;40@@@@@n:/infoportal/snx/@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>8@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>8@24@1@10@@@@@1@2;6;32;40@@@@@size=30@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>8@34@1@35@@@@@1@2;6;33;40@@@@@каталог временных файлов для записи@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>8@69@1@9@@@@@1@2;6;32;40@@@@@TempDir2@</Data>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>1</Sub>
<Data>9@1@1@13@@@@@1@2;6;35;40@@@@@SAMPLES@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>9@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>9@24@1@10@@@@@1@2;6;32;40@@@@@size=30@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>9@34@1@35@@@@@1@2;6;33;40@@@@@Текущая рабочая область для новых клиентов@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>9@69@1@9@@@@@1@2;6;32;40@@@@@CurNSP@</Data>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>1</Sub>
<Data>10@1@1@13@@@@@1@2;6;35;40@@@@@DFLT1@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>10@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>10@24@1@10@@@@@1@2;6;32;40@@@@@size=30@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>10@34@1@35@@@@@1@2;6;33;40@@@@@Текущий стиль@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>10@69@1@9@@@@@1@2;6;32;40@@@@@CurCSS@</Data>
</Node>
</Node>
<Node><Sub>11</Sub>
<Node><Sub>1</Sub>
<Data>11@1@1@13@@@@@1@2;6;35;40@@@@@2@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>11@14@1@10@@@@@1@2;6;32;40@@@@@radio@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>11@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>11@34@1@35@@@@@1@2;6;33;40@@@@@Портал тарифицируется~не тарифицируется@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>11@69@1@9@@@@@1@2;6;32;40@@@@@Commerce@</Data>
</Node>
</Node>
<Node><Sub>12</Sub>
<Node><Sub>1</Sub>
<Data>12@1@1@13@@@@@1@2;6;35;40@@@@@0</Data>
</Node>
<Node><Sub>2</Sub>
<Data>12@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>12@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>12@34@1@35@@@@@1@2;6;33;40@@@@@Мультиязычность@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>12@69@1@9@@@@@1@2;6;32;40@@@@@MultiL@</Data>
</Node>
</Node>
<Node><Sub>13</Sub>
<Node><Sub>1</Sub>
<Data>13@1@1@13@@@@@1@2;6;35;40@@@@@0</Data>
</Node>
<Node><Sub>2</Sub>
<Data>13@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>13@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>13@34@1@35@@@@@1@2;6;33;40@@@@@Конкурсы проектов@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>13@69@1@9@@@@@1@2;6;32;40@@@@@Conc@</Data>
</Node>
</Node>
<Node><Sub>14</Sub>
<Node><Sub>1</Sub>
<Data>14@1@1@13@@@@@1@2;6;35;40@@@@@1</Data>
</Node>
<Node><Sub>2</Sub>
<Data>14@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>14@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>14@34@1@35@@@@@1@2;6;33;40@@@@@Включен WEB редактор программ COS@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>14@69@1@9@@@@@1@2;6;32;40@@@@@WebEditRou@</Data>
</Node>
</Node>
<Node><Sub>15</Sub>
<Node><Sub>1</Sub>
<Data>15@1@1@13@@@@@1@2;6;35;40@@@@@1</Data>
</Node>
<Node><Sub>2</Sub>
<Data>15@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>15@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>15@34@1@35@@@@@1@2;6;33;40@@@@@Включен WEB редактор данных таблиц@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>15@69@1@9@@@@@1@2;6;32;40@@@@@WebEditDT@</Data>
</Node>
</Node>
<Node><Sub>16</Sub>
<Node><Sub>1</Sub>
<Data>16@1@1@13@@@@@1@2;6;35;40@@@@@1</Data>
</Node>
<Node><Sub>2</Sub>
<Data>16@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>16@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>16@34@1@35@@@@@1@2;6;33;40@@@@@Разрешен вывод информации о сессии и системе@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>16@69@1@9@@@@@1@2;6;32;40@@@@@WebInfoSess@</Data>
</Node>
</Node>
<Node><Sub>17</Sub>
<Node><Sub>1</Sub>
<Data>17@1@1@13@@@@@1@2;6;35;40@@@@@cols=68 rows=5@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>17@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>17@24@1@10@@@@@1@2;6;32;40@@@@@size=32@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>17@34@1@35@@@@@1@2;6;33;40@@@@@Параметры TEXTAREA для кода COS@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>17@69@1@9@@@@@1@2;6;32;40@@@@@COS@</Data>
</Node>
</Node>
<Node><Sub>18</Sub>
<Node><Sub>1</Sub>
<Data>18@1@1@13@@@@@1@2;6;35;40@@@@@cols=68 rows=5@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>18@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>18@24@1@10@@@@@1@2;6;32;40@@@@@size=32@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>18@34@1@35@@@@@1@2;6;33;40@@@@@Параметры TEXTAREA для HTML@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>18@69@1@9@@@@@1@2;6;32;40@@@@@HTM@</Data>
</Node>
</Node>
<Node><Sub>19</Sub>
<Node><Sub>1</Sub>
<Data>19@1@1@13@@@@@1@2;6;30;46@@@@@1@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>19@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>19@24@1@10@@@@@1@2;6;32;40@@@@@size=35@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>19@34@1@35@@@@@1@@@@@@Разрешена ли работа с ODBC@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>19@69@1@9@@@@@1@2;6;32;40@@@@@ImportODBC@</Data>
</Node>
</Node>
<Node><Sub>20</Sub>
<Node><Sub>1</Sub>
<Data>20@1@1@13@@@@@1@2;6;30;46@@@@@1@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>20@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>20@24@1@10@@@@@1@2;6;32;40@@@@@size=35@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>20@34@1@35@@@@@1@@@@@@Разрешен ли импорт из Текстового файла@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>20@69@1@9@@@@@1@2;6;32;40@@@@@ImportTXT@</Data>
</Node>
</Node>
<Node><Sub>21</Sub>
<Node><Sub>1</Sub>
<Data>21@1@1@13@@@@@1@2;6;35;40@@@@@0</Data>
</Node>
<Node><Sub>2</Sub>
<Data>21@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>21@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data><![CDATA[21@34@1@35@@@@@1@2;6;33;40@@@@@Редактор системных таблиц (DICT,PIN,PROTECT,SESSIONS,TARIFF) выводить в одном окне@]]></Data>
</Node>
<Node><Sub>5</Sub>
<Data>21@69@1@9@@@@@1@2;6;32;40@@@@@EditTab1@</Data>
</Node>
</Node>
<Node><Sub>22</Sub>
<Node><Sub>1</Sub>
<Data>22@1@1@13@@@@@1@2;6;35;40@@@@@width=800,height=600@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>22@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>22@24@1@10@@@@@1@2;6;32;40@@@@@size=32@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>22@34@1@35@@@@@1@2;6;33;40@@@@@Размеры нового окна для редактора данных таблиц@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>22@69@1@9@@@@@1@2;6;32;40@@@@@NWT1@</Data>
</Node>
</Node>
<Node><Sub>23</Sub>
<Node><Sub>1</Sub>
<Data>23@1@1@13@@@@@1@2;6;35;40@@@@@width=800,height=600@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>23@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>23@24@1@10@@@@@1@2;6;32;40@@@@@size=32@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>23@34@1@35@@@@@1@2;6;33;40@@@@@Размеры нового окна для редактора Опций@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>23@69@1@9@@@@@1@2;6;32;40@@@@@NWO1@</Data>
</Node>
</Node>
<Node><Sub>24</Sub>
<Node><Sub>1</Sub>
<Data>24@1@1@13@@@@@1@2;6;30;46@@@@@1@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>24@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>24@24@1@10@@@@@1@2;6;32;40@@@@@size=35@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>24@34@1@35@@@@@1@@@@@@Разрешен ли пустой пароль пользователя@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>24@69@1@9@@@@@1@2;6;32;40@@@@@EmpPASS@</Data>
</Node>
</Node>
<Node><Sub>25</Sub>
<Node><Sub>1</Sub>
<Data>25@1@1@13@@@@@1@2;6;35;40@@@@@ГЦ АСУ ГКВВ МВД России@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>25@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>25@24@1@10@@@@@1@2;6;32;40@@@@@size=32@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>25@34@1@35@@@@@1@2;6;33;40@@@@@Конечный пользователь@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>25@69@1@9@@@@@1@2;6;32;40@@@@@ENDUSER@</Data>
</Node>
</Node>
<Node><Sub>26</Sub>
<Node><Sub>1</Sub>
<Data>26@1@1@13@@@@@1@2;6;35;40@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>26@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>26@24@1@10@@@@@1@2;6;32;40@@@@@size=32@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>26@34@1@35@@@@@1@2;6;33;40@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>26@69@1@9@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>59397,66776,SSS1</Data>
</Node>
<Node><Sub>OPT</Sub>
<Data>1</Data>
<Node><Sub>LST</Sub>
<Data>59397,66776,SSS1</Data>
<Node><Sub>B4I</Sub>
<Data>4</Data>
</Node>
<Node><Sub>CFG26</Sub>
<Data>26</Data>
</Node>
<Node><Sub>CFG7</Sub>
<Data>7</Data>
</Node>
<Node><Sub>COS</Sub>
<Data>17</Data>
</Node>
<Node><Sub>Commerce</Sub>
<Data>11</Data>
</Node>
<Node><Sub>Conc</Sub>
<Data>13</Data>
</Node>
<Node><Sub>CurCSS</Sub>
<Data>10</Data>
</Node>
<Node><Sub>CurNSP</Sub>
<Data>9</Data>
</Node>
<Node><Sub>ENDUSER</Sub>
<Data>25</Data>
</Node>
<Node><Sub>EditTab1</Sub>
<Data>21</Data>
</Node>
<Node><Sub>EmpPASS</Sub>
<Data>24</Data>
</Node>
<Node><Sub>HTM</Sub>
<Data>18</Data>
</Node>
<Node><Sub>IP</Sub>
<Data>3</Data>
</Node>
<Node><Sub>ImportODBC</Sub>
<Data>19</Data>
</Node>
<Node><Sub>ImportTXT</Sub>
<Data>20</Data>
</Node>
<Node><Sub>MultiL</Sub>
<Data>12</Data>
</Node>
<Node><Sub>NWO1</Sub>
<Data>23</Data>
</Node>
<Node><Sub>NWT1</Sub>
<Data>22</Data>
</Node>
<Node><Sub>Tariff</Sub>
<Data>5</Data>
</Node>
<Node><Sub>TempDir2</Sub>
<Data>8</Data>
</Node>
<Node><Sub>Vers</Sub>
<Data>6</Data>
</Node>
<Node><Sub>WebEditDT</Sub>
<Data>15</Data>
</Node>
<Node><Sub>WebEditRou</Sub>
<Data>14</Data>
</Node>
<Node><Sub>WebInfoSess</Sub>
<Data>16</Data>
</Node>
</Node>
</Node>
<Node><Sub>STA</Sub>
<Data>25,1@22@1@13@-1@-1@5@1@ГЦ АСУ ГКВВ МВД России</Data>
</Node>
</Node>
<Node><Sub>CFG5</Sub>
<Data>Основные Опции Комплекса@@@@@1@1@1@1@22@80@1@@1@1@@1@@2,1@1@@@@@@@@26@5@@1;6;35;44@@@@@@</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@13@@@@@1@2;6;35;40@@@@@ Value (DFLT)</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@14@1@10@@@@@1@2;6;30;41@@@@@ Type@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>1@24@1@10@@@@@1@2;6;30;41@@@@@Atribute@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>1@34@1@35@@@@@1@2;6;33;40@@@@@ ОПИСАНИЕ@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>1@69@1@9@@@@@1@2;6;30;41@@@@@ name@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@13@@@@@1@2;6;30;43@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>2@14@1@10@@@@@1@2;6;30;43@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>2@24@1@10@@@@@1@2;6;30;43@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>2@34@1@35@@@@@1@2;6;30;43@@@@@ Основные Опции Комплекса@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>2@69@1@9@@@@@1@2;6;30;43@@@@@@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@13@@@@@1@2;6;35;40@@@@@Информационный портал@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>3@24@1@10@@@@@1@2;6;32;40@@@@@size=30@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>3@34@1@35@@@@@1@2;6;33;40@@@@@Наименование портала@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>3@69@1@9@@@@@1@2;6;32;40@@@@@IP@</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>4@1@1@13@@@@@1@2;6;35;40@@@@@УрО ВВ@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>4@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>4@24@1@10@@@@@1@2;6;32;40@@@@@size=30@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>4@34@1@35@@@@@1@2;6;33;40@@@@@Название комплекса@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>4@69@1@9@@@@@1@2;6;32;40@@@@@B4I@</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>5@1@1@13@@@@@1@2;6;35;40@@@@@1@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>5@14@1@10@@@@@1@2;6;32;40@@@@@radio@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>5@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data><![CDATA[5@34@1@35@@@@@1@2;6;33;40@@@@@ТАРИФ ПО-УМОЛЧАНИЮ: ТЕСТОВЫЙ~ --//-- ЭКОНОМНЫЙ~ --//-- СТАНДАРТНЫЙ~ --//-- ПРОФЕССИОНАЛЬНЫЙ@]]></Data>
</Node>
<Node><Sub>5</Sub>
<Data>5@69@1@9@@@@@1@2;6;32;40@@@@@Tariff@</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>6@1@1@13@@@@@1@2;6;35;40@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>6@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>6@24@1@10@@@@@1@2;6;32;40@@@@@size=30@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>6@34@1@35@@@@@1@2;6;33;40@@@@@Копирайт и Номер версии комплекса@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>6@69@1@9@@@@@1@2;6;32;40@@@@@Vers@</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>7@1@1@13@@@@@1@2;6;35;40@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>7@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>7@24@1@10@@@@@1@2;6;32;40@@@@@size=30@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>7@34@1@35@@@@@1@2;6;33;40@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>7@69@1@9@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>1</Sub>
<Data>8@1@1@13@@@@@1@2;6;35;40@@@@@n:/infoportal/snx/@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>8@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>8@24@1@10@@@@@1@2;6;32;40@@@@@size=30@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>8@34@1@35@@@@@1@2;6;33;40@@@@@каталог временных файлов для записи@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>8@69@1@9@@@@@1@2;6;32;40@@@@@TempDir2@</Data>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>1</Sub>
<Data>9@1@1@13@@@@@1@2;6;35;40@@@@@SAMPLES@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>9@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>9@24@1@10@@@@@1@2;6;32;40@@@@@size=30@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>9@34@1@35@@@@@1@2;6;33;40@@@@@Текущая рабочая область для новых клиентов@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>9@69@1@9@@@@@1@2;6;32;40@@@@@CurNSP@</Data>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>1</Sub>
<Data>10@1@1@13@@@@@1@2;6;35;40@@@@@DFLT1@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>10@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>10@24@1@10@@@@@1@2;6;32;40@@@@@size=30@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>10@34@1@35@@@@@1@2;6;33;40@@@@@Текущий стиль@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>10@69@1@9@@@@@1@2;6;32;40@@@@@CurCSS@</Data>
</Node>
</Node>
<Node><Sub>11</Sub>
<Node><Sub>1</Sub>
<Data>11@1@1@13@@@@@1@2;6;35;40@@@@@2@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>11@14@1@10@@@@@1@2;6;32;40@@@@@radio@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>11@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>11@34@1@35@@@@@1@2;6;33;40@@@@@Портал тарифицируется~не тарифицируется@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>11@69@1@9@@@@@1@2;6;32;40@@@@@Commerce@</Data>
</Node>
</Node>
<Node><Sub>12</Sub>
<Node><Sub>1</Sub>
<Data>12@1@1@13@@@@@1@2;6;35;40@@@@@0</Data>
</Node>
<Node><Sub>2</Sub>
<Data>12@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>12@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>12@34@1@35@@@@@1@2;6;33;40@@@@@Мультиязычность@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>12@69@1@9@@@@@1@2;6;32;40@@@@@MultiL@</Data>
</Node>
</Node>
<Node><Sub>13</Sub>
<Node><Sub>1</Sub>
<Data>13@1@1@13@@@@@1@2;6;35;40@@@@@0</Data>
</Node>
<Node><Sub>2</Sub>
<Data>13@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>13@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>13@34@1@35@@@@@1@2;6;33;40@@@@@Конкурсы проектов@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>13@69@1@9@@@@@1@2;6;32;40@@@@@Conc@</Data>
</Node>
</Node>
<Node><Sub>14</Sub>
<Node><Sub>1</Sub>
<Data>14@1@1@13@@@@@1@2;6;35;40@@@@@1</Data>
</Node>
<Node><Sub>2</Sub>
<Data>14@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>14@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>14@34@1@35@@@@@1@2;6;33;40@@@@@Включен WEB редактор программ COS@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>14@69@1@9@@@@@1@2;6;32;40@@@@@WebEditRou@</Data>
</Node>
</Node>
<Node><Sub>15</Sub>
<Node><Sub>1</Sub>
<Data>15@1@1@13@@@@@1@2;6;35;40@@@@@1</Data>
</Node>
<Node><Sub>2</Sub>
<Data>15@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>15@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>15@34@1@35@@@@@1@2;6;33;40@@@@@Включен WEB редактор данных таблиц@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>15@69@1@9@@@@@1@2;6;32;40@@@@@WebEditDT@</Data>
</Node>
</Node>
<Node><Sub>16</Sub>
<Node><Sub>1</Sub>
<Data>16@1@1@13@@@@@1@2;6;35;40@@@@@1</Data>
</Node>
<Node><Sub>2</Sub>
<Data>16@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>16@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>16@34@1@35@@@@@1@2;6;33;40@@@@@Разрешен вывод информации о сессии и системе@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>16@69@1@9@@@@@1@2;6;32;40@@@@@WebInfoSess@</Data>
</Node>
</Node>
<Node><Sub>17</Sub>
<Node><Sub>1</Sub>
<Data>17@1@1@13@@@@@1@2;6;35;40@@@@@cols=68 rows=5@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>17@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>17@24@1@10@@@@@1@2;6;32;40@@@@@size=32@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>17@34@1@35@@@@@1@2;6;33;40@@@@@Параметры TEXTAREA для кода COS@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>17@69@1@9@@@@@1@2;6;32;40@@@@@COS@</Data>
</Node>
</Node>
<Node><Sub>18</Sub>
<Node><Sub>1</Sub>
<Data>18@1@1@13@@@@@1@2;6;35;40@@@@@cols=68 rows=5@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>18@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>18@24@1@10@@@@@1@2;6;32;40@@@@@size=32@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>18@34@1@35@@@@@1@2;6;33;40@@@@@Параметры TEXTAREA для HTML@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>18@69@1@9@@@@@1@2;6;32;40@@@@@HTM@</Data>
</Node>
</Node>
<Node><Sub>19</Sub>
<Node><Sub>1</Sub>
<Data>19@1@1@13@@@@@1@2;6;30;46@@@@@1@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>19@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>19@24@1@10@@@@@1@2;6;32;40@@@@@size=35@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>19@34@1@35@@@@@1@@@@@@Разрешена ли работа с ODBC@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>19@69@1@9@@@@@1@2;6;32;40@@@@@ImportODBC@</Data>
</Node>
</Node>
<Node><Sub>20</Sub>
<Node><Sub>1</Sub>
<Data>20@1@1@13@@@@@1@2;6;30;46@@@@@1@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>20@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>20@24@1@10@@@@@1@2;6;32;40@@@@@size=35@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>20@34@1@35@@@@@1@@@@@@Разрешен ли импорт из Текстового файла@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>20@69@1@9@@@@@1@2;6;32;40@@@@@ImportTXT@</Data>
</Node>
</Node>
<Node><Sub>21</Sub>
<Node><Sub>1</Sub>
<Data>21@1@1@13@@@@@1@2;6;35;40@@@@@0</Data>
</Node>
<Node><Sub>2</Sub>
<Data>21@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>21@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data><![CDATA[21@34@1@35@@@@@1@2;6;33;40@@@@@Редактор системных таблиц (DICT,PIN,PROTECT,SESSIONS,TARIFF) выводить в одном окне@]]></Data>
</Node>
<Node><Sub>5</Sub>
<Data>21@69@1@9@@@@@1@2;6;32;40@@@@@EditTab1@</Data>
</Node>
</Node>
<Node><Sub>22</Sub>
<Node><Sub>1</Sub>
<Data>22@1@1@13@@@@@1@2;6;35;40@@@@@width=800,height=600@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>22@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>22@24@1@10@@@@@1@2;6;32;40@@@@@size=32@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>22@34@1@35@@@@@1@2;6;33;40@@@@@Размеры нового окна для редактора данных таблиц@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>22@69@1@9@@@@@1@2;6;32;40@@@@@NWT1@</Data>
</Node>
</Node>
<Node><Sub>23</Sub>
<Node><Sub>1</Sub>
<Data>23@1@1@13@@@@@1@2;6;35;40@@@@@width=800,height=600@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>23@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>23@24@1@10@@@@@1@2;6;32;40@@@@@size=32@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>23@34@1@35@@@@@1@2;6;33;40@@@@@Размеры нового окна для редактора Опций@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>23@69@1@9@@@@@1@2;6;32;40@@@@@NWO1@</Data>
</Node>
</Node>
<Node><Sub>24</Sub>
<Node><Sub>1</Sub>
<Data>24@1@1@13@@@@@1@2;6;30;46@@@@@1@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>24@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>24@24@1@10@@@@@1@2;6;32;40@@@@@size=35@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>24@34@1@35@@@@@1@@@@@@Разрешен ли пустой пароль пользователя@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>24@69@1@9@@@@@1@2;6;32;40@@@@@EmpPASS@</Data>
</Node>
</Node>
<Node><Sub>25</Sub>
<Node><Sub>1</Sub>
<Data>25@1@1@13@@@@@1@2;6;35;40@@@@@ГЦ АСУ ГКВВ МВД России@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>25@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>25@24@1@10@@@@@1@2;6;32;40@@@@@size=32@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>25@34@1@35@@@@@1@2;6;33;40@@@@@Конечный пользователь@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>25@69@1@9@@@@@1@2;6;32;40@@@@@ENDUSER@</Data>
</Node>
</Node>
<Node><Sub>26</Sub>
<Node><Sub>1</Sub>
<Data>26@1@1@13@@@@@1@2;6;35;40@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>26@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>26@24@1@10@@@@@1@2;6;32;40@@@@@size=32@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>26@34@1@35@@@@@1@2;6;33;40@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>26@69@1@9@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>59397,66776,SSS1</Data>
</Node>
<Node><Sub>OPT</Sub>
<Data>1</Data>
<Node><Sub>LST</Sub>
<Data>59397,66776,SSS1</Data>
<Node><Sub>B4I</Sub>
<Data>4</Data>
</Node>
<Node><Sub>CFG26</Sub>
<Data>26</Data>
</Node>
<Node><Sub>CFG7</Sub>
<Data>7</Data>
</Node>
<Node><Sub>COS</Sub>
<Data>17</Data>
</Node>
<Node><Sub>Commerce</Sub>
<Data>11</Data>
</Node>
<Node><Sub>Conc</Sub>
<Data>13</Data>
</Node>
<Node><Sub>CurCSS</Sub>
<Data>10</Data>
</Node>
<Node><Sub>CurNSP</Sub>
<Data>9</Data>
</Node>
<Node><Sub>ENDUSER</Sub>
<Data>25</Data>
</Node>
<Node><Sub>EditTab1</Sub>
<Data>21</Data>
</Node>
<Node><Sub>EmpPASS</Sub>
<Data>24</Data>
</Node>
<Node><Sub>HTM</Sub>
<Data>18</Data>
</Node>
<Node><Sub>IP</Sub>
<Data>3</Data>
</Node>
<Node><Sub>ImportODBC</Sub>
<Data>19</Data>
</Node>
<Node><Sub>ImportTXT</Sub>
<Data>20</Data>
</Node>
<Node><Sub>MultiL</Sub>
<Data>12</Data>
</Node>
<Node><Sub>NWO1</Sub>
<Data>23</Data>
</Node>
<Node><Sub>NWT1</Sub>
<Data>22</Data>
</Node>
<Node><Sub>Tariff</Sub>
<Data>5</Data>
</Node>
<Node><Sub>TempDir2</Sub>
<Data>8</Data>
</Node>
<Node><Sub>Vers</Sub>
<Data>6</Data>
</Node>
<Node><Sub>WebEditDT</Sub>
<Data>15</Data>
</Node>
<Node><Sub>WebEditRou</Sub>
<Data>14</Data>
</Node>
<Node><Sub>WebInfoSess</Sub>
<Data>16</Data>
</Node>
</Node>
</Node>
<Node><Sub>STA</Sub>
<Data>4,2@2@1@13@-1@-1@4@14@text</Data>
</Node>
</Node>
<Node><Sub>CFG6</Sub>
<Data>Основные Опции Комплекса@@@@@1@1@1@1@22@80@1@@1@1@@1@@2,1@1@@@@@@@@26@5@@1;6;35;44@@@@@@</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@13@@@@@1@2;6;35;40@@@@@ Value (DFLT)</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@14@1@10@@@@@1@2;6;30;41@@@@@ Type@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>1@24@1@10@@@@@1@2;6;30;41@@@@@Atribute@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>1@34@1@35@@@@@1@2;6;33;40@@@@@ ОПИСАНИЕ@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>1@69@1@9@@@@@1@2;6;30;41@@@@@ name@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@13@@@@@1@2;6;30;43@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>2@14@1@10@@@@@1@2;6;30;43@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>2@24@1@10@@@@@1@2;6;30;43@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>2@34@1@35@@@@@1@2;6;30;43@@@@@ Основные Опции Комплекса@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>2@69@1@9@@@@@1@2;6;30;43@@@@@@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@13@@@@@1@2;6;35;40@@@@@Информационный портал@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>3@24@1@10@@@@@1@2;6;32;40@@@@@size=30@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>3@34@1@35@@@@@1@2;6;33;40@@@@@Наименование портала@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>3@69@1@9@@@@@1@2;6;32;40@@@@@IP@</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>4@1@1@13@@@@@1@2;6;35;40@@@@@СибО ВВ@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>4@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>4@24@1@10@@@@@1@2;6;32;40@@@@@size=30@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>4@34@1@35@@@@@1@2;6;33;40@@@@@Название комплекса@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>4@69@1@9@@@@@1@2;6;32;40@@@@@B4I@</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>5@1@1@13@@@@@1@2;6;35;40@@@@@1@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>5@14@1@10@@@@@1@2;6;32;40@@@@@radio@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>5@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data><![CDATA[5@34@1@35@@@@@1@2;6;33;40@@@@@ТАРИФ ПО-УМОЛЧАНИЮ: ТЕСТОВЫЙ~ --//-- ЭКОНОМНЫЙ~ --//-- СТАНДАРТНЫЙ~ --//-- ПРОФЕССИОНАЛЬНЫЙ@]]></Data>
</Node>
<Node><Sub>5</Sub>
<Data>5@69@1@9@@@@@1@2;6;32;40@@@@@Tariff@</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>6@1@1@13@@@@@1@2;6;35;40@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>6@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>6@24@1@10@@@@@1@2;6;32;40@@@@@size=30@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>6@34@1@35@@@@@1@2;6;33;40@@@@@Копирайт и Номер версии комплекса@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>6@69@1@9@@@@@1@2;6;32;40@@@@@Vers@</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>7@1@1@13@@@@@1@2;6;35;40@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>7@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>7@24@1@10@@@@@1@2;6;32;40@@@@@size=30@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>7@34@1@35@@@@@1@2;6;33;40@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>7@69@1@9@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>1</Sub>
<Data>8@1@1@13@@@@@1@2;6;35;40@@@@@n:/infoportal/snx/@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>8@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>8@24@1@10@@@@@1@2;6;32;40@@@@@size=30@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>8@34@1@35@@@@@1@2;6;33;40@@@@@каталог временных файлов для записи@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>8@69@1@9@@@@@1@2;6;32;40@@@@@TempDir2@</Data>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>1</Sub>
<Data>9@1@1@13@@@@@1@2;6;35;40@@@@@SAMPLES@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>9@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>9@24@1@10@@@@@1@2;6;32;40@@@@@size=30@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>9@34@1@35@@@@@1@2;6;33;40@@@@@Текущая рабочая область для новых клиентов@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>9@69@1@9@@@@@1@2;6;32;40@@@@@CurNSP@</Data>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>1</Sub>
<Data>10@1@1@13@@@@@1@2;6;35;40@@@@@DFLT1@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>10@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>10@24@1@10@@@@@1@2;6;32;40@@@@@size=30@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>10@34@1@35@@@@@1@2;6;33;40@@@@@Текущий стиль@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>10@69@1@9@@@@@1@2;6;32;40@@@@@CurCSS@</Data>
</Node>
</Node>
<Node><Sub>11</Sub>
<Node><Sub>1</Sub>
<Data>11@1@1@13@@@@@1@2;6;35;40@@@@@2@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>11@14@1@10@@@@@1@2;6;32;40@@@@@radio@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>11@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>11@34@1@35@@@@@1@2;6;33;40@@@@@Портал тарифицируется~не тарифицируется@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>11@69@1@9@@@@@1@2;6;32;40@@@@@Commerce@</Data>
</Node>
</Node>
<Node><Sub>12</Sub>
<Node><Sub>1</Sub>
<Data>12@1@1@13@@@@@1@2;6;35;40@@@@@0</Data>
</Node>
<Node><Sub>2</Sub>
<Data>12@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>12@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>12@34@1@35@@@@@1@2;6;33;40@@@@@Мультиязычность@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>12@69@1@9@@@@@1@2;6;32;40@@@@@MultiL@</Data>
</Node>
</Node>
<Node><Sub>13</Sub>
<Node><Sub>1</Sub>
<Data>13@1@1@13@@@@@1@2;6;35;40@@@@@0</Data>
</Node>
<Node><Sub>2</Sub>
<Data>13@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>13@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>13@34@1@35@@@@@1@2;6;33;40@@@@@Конкурсы проектов@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>13@69@1@9@@@@@1@2;6;32;40@@@@@Conc@</Data>
</Node>
</Node>
<Node><Sub>14</Sub>
<Node><Sub>1</Sub>
<Data>14@1@1@13@@@@@1@2;6;35;40@@@@@1</Data>
</Node>
<Node><Sub>2</Sub>
<Data>14@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>14@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>14@34@1@35@@@@@1@2;6;33;40@@@@@Включен WEB редактор программ COS@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>14@69@1@9@@@@@1@2;6;32;40@@@@@WebEditRou@</Data>
</Node>
</Node>
<Node><Sub>15</Sub>
<Node><Sub>1</Sub>
<Data>15@1@1@13@@@@@1@2;6;35;40@@@@@1</Data>
</Node>
<Node><Sub>2</Sub>
<Data>15@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>15@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>15@34@1@35@@@@@1@2;6;33;40@@@@@Включен WEB редактор данных таблиц@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>15@69@1@9@@@@@1@2;6;32;40@@@@@WebEditDT@</Data>
</Node>
</Node>
<Node><Sub>16</Sub>
<Node><Sub>1</Sub>
<Data>16@1@1@13@@@@@1@2;6;35;40@@@@@1</Data>
</Node>
<Node><Sub>2</Sub>
<Data>16@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>16@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>16@34@1@35@@@@@1@2;6;33;40@@@@@Разрешен вывод информации о сессии и системе@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>16@69@1@9@@@@@1@2;6;32;40@@@@@WebInfoSess@</Data>
</Node>
</Node>
<Node><Sub>17</Sub>
<Node><Sub>1</Sub>
<Data>17@1@1@13@@@@@1@2;6;35;40@@@@@cols=68 rows=5@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>17@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>17@24@1@10@@@@@1@2;6;32;40@@@@@size=32@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>17@34@1@35@@@@@1@2;6;33;40@@@@@Параметры TEXTAREA для кода COS@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>17@69@1@9@@@@@1@2;6;32;40@@@@@COS@</Data>
</Node>
</Node>
<Node><Sub>18</Sub>
<Node><Sub>1</Sub>
<Data>18@1@1@13@@@@@1@2;6;35;40@@@@@cols=68 rows=5@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>18@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>18@24@1@10@@@@@1@2;6;32;40@@@@@size=32@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>18@34@1@35@@@@@1@2;6;33;40@@@@@Параметры TEXTAREA для HTML@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>18@69@1@9@@@@@1@2;6;32;40@@@@@HTM@</Data>
</Node>
</Node>
<Node><Sub>19</Sub>
<Node><Sub>1</Sub>
<Data>19@1@1@13@@@@@1@2;6;30;46@@@@@1@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>19@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>19@24@1@10@@@@@1@2;6;32;40@@@@@size=35@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>19@34@1@35@@@@@1@@@@@@Разрешена ли работа с ODBC@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>19@69@1@9@@@@@1@2;6;32;40@@@@@ImportODBC@</Data>
</Node>
</Node>
<Node><Sub>20</Sub>
<Node><Sub>1</Sub>
<Data>20@1@1@13@@@@@1@2;6;30;46@@@@@1@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>20@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>20@24@1@10@@@@@1@2;6;32;40@@@@@size=35@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>20@34@1@35@@@@@1@@@@@@Разрешен ли импорт из Текстового файла@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>20@69@1@9@@@@@1@2;6;32;40@@@@@ImportTXT@</Data>
</Node>
</Node>
<Node><Sub>21</Sub>
<Node><Sub>1</Sub>
<Data>21@1@1@13@@@@@1@2;6;35;40@@@@@0</Data>
</Node>
<Node><Sub>2</Sub>
<Data>21@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>21@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data><![CDATA[21@34@1@35@@@@@1@2;6;33;40@@@@@Редактор системных таблиц (DICT,PIN,PROTECT,SESSIONS,TARIFF) выводить в одном окне@]]></Data>
</Node>
<Node><Sub>5</Sub>
<Data>21@69@1@9@@@@@1@2;6;32;40@@@@@EditTab1@</Data>
</Node>
</Node>
<Node><Sub>22</Sub>
<Node><Sub>1</Sub>
<Data>22@1@1@13@@@@@1@2;6;35;40@@@@@width=800,height=600@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>22@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>22@24@1@10@@@@@1@2;6;32;40@@@@@size=32@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>22@34@1@35@@@@@1@2;6;33;40@@@@@Размеры нового окна для редактора данных таблиц@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>22@69@1@9@@@@@1@2;6;32;40@@@@@NWT1@</Data>
</Node>
</Node>
<Node><Sub>23</Sub>
<Node><Sub>1</Sub>
<Data>23@1@1@13@@@@@1@2;6;35;40@@@@@width=800,height=600@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>23@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>23@24@1@10@@@@@1@2;6;32;40@@@@@size=32@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>23@34@1@35@@@@@1@2;6;33;40@@@@@Размеры нового окна для редактора Опций@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>23@69@1@9@@@@@1@2;6;32;40@@@@@NWO1@</Data>
</Node>
</Node>
<Node><Sub>24</Sub>
<Node><Sub>1</Sub>
<Data>24@1@1@13@@@@@1@2;6;30;46@@@@@1@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>24@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>24@24@1@10@@@@@1@2;6;32;40@@@@@size=35@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>24@34@1@35@@@@@1@@@@@@Разрешен ли пустой пароль пользователя@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>24@69@1@9@@@@@1@2;6;32;40@@@@@EmpPASS@</Data>
</Node>
</Node>
<Node><Sub>25</Sub>
<Node><Sub>1</Sub>
<Data>25@1@1@13@@@@@1@2;6;35;40@@@@@ГЦ АСУ ГКВВ МВД России@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>25@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>25@24@1@10@@@@@1@2;6;32;40@@@@@size=32@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>25@34@1@35@@@@@1@2;6;33;40@@@@@Конечный пользователь@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>25@69@1@9@@@@@1@2;6;32;40@@@@@ENDUSER@</Data>
</Node>
</Node>
<Node><Sub>26</Sub>
<Node><Sub>1</Sub>
<Data>26@1@1@13@@@@@1@2;6;35;40@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>26@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>26@24@1@10@@@@@1@2;6;32;40@@@@@size=32@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>26@34@1@35@@@@@1@2;6;33;40@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>26@69@1@9@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>59397,66776,SSS1</Data>
</Node>
<Node><Sub>OPT</Sub>
<Data>1</Data>
<Node><Sub>LST</Sub>
<Data>59397,66776,SSS1</Data>
<Node><Sub>B4I</Sub>
<Data>4</Data>
</Node>
<Node><Sub>CFG26</Sub>
<Data>26</Data>
</Node>
<Node><Sub>CFG7</Sub>
<Data>7</Data>
</Node>
<Node><Sub>COS</Sub>
<Data>17</Data>
</Node>
<Node><Sub>Commerce</Sub>
<Data>11</Data>
</Node>
<Node><Sub>Conc</Sub>
<Data>13</Data>
</Node>
<Node><Sub>CurCSS</Sub>
<Data>10</Data>
</Node>
<Node><Sub>CurNSP</Sub>
<Data>9</Data>
</Node>
<Node><Sub>ENDUSER</Sub>
<Data>25</Data>
</Node>
<Node><Sub>EditTab1</Sub>
<Data>21</Data>
</Node>
<Node><Sub>EmpPASS</Sub>
<Data>24</Data>
</Node>
<Node><Sub>HTM</Sub>
<Data>18</Data>
</Node>
<Node><Sub>IP</Sub>
<Data>3</Data>
</Node>
<Node><Sub>ImportODBC</Sub>
<Data>19</Data>
</Node>
<Node><Sub>ImportTXT</Sub>
<Data>20</Data>
</Node>
<Node><Sub>MultiL</Sub>
<Data>12</Data>
</Node>
<Node><Sub>NWO1</Sub>
<Data>23</Data>
</Node>
<Node><Sub>NWT1</Sub>
<Data>22</Data>
</Node>
<Node><Sub>Tariff</Sub>
<Data>5</Data>
</Node>
<Node><Sub>TempDir2</Sub>
<Data>8</Data>
</Node>
<Node><Sub>Vers</Sub>
<Data>6</Data>
</Node>
<Node><Sub>WebEditDT</Sub>
<Data>15</Data>
</Node>
<Node><Sub>WebEditRou</Sub>
<Data>14</Data>
</Node>
<Node><Sub>WebInfoSess</Sub>
<Data>16</Data>
</Node>
</Node>
</Node>
<Node><Sub>STA</Sub>
<Data>4,2@2@1@13@-1@-1@4@14@text</Data>
</Node>
</Node>
<Node><Sub>CFG7</Sub>
<Data>Основные Опции Комплекса@@@@@1@1@1@1@22@80@1@@1@1@@1@@2,1@1@@@@@@@@26@5@@1;6;35;44@@@@@@</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@13@@@@@1@2;6;35;40@@@@@ Value (DFLT)</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@14@1@10@@@@@1@2;6;30;41@@@@@ Type@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>1@24@1@10@@@@@1@2;6;30;41@@@@@Atribute@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>1@34@1@35@@@@@1@2;6;33;40@@@@@ ОПИСАНИЕ@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>1@69@1@9@@@@@1@2;6;30;41@@@@@ name@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@13@@@@@1@2;6;30;43@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>2@14@1@10@@@@@1@2;6;30;43@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>2@24@1@10@@@@@1@2;6;30;43@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>2@34@1@35@@@@@1@2;6;30;43@@@@@ Основные Опции Комплекса@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>2@69@1@9@@@@@1@2;6;30;43@@@@@@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@13@@@@@1@2;6;35;40@@@@@Информационный портал@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>3@24@1@10@@@@@1@2;6;32;40@@@@@size=30@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>3@34@1@35@@@@@1@2;6;33;40@@@@@Наименование портала@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>3@69@1@9@@@@@1@2;6;32;40@@@@@IP@</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>4@1@1@13@@@@@1@2;6;35;40@@@@@ВО ВВ@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>4@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>4@24@1@10@@@@@1@2;6;32;40@@@@@size=30@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>4@34@1@35@@@@@1@2;6;33;40@@@@@Название комплекса@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>4@69@1@9@@@@@1@2;6;32;40@@@@@B4I@</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>5@1@1@13@@@@@1@2;6;35;40@@@@@1@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>5@14@1@10@@@@@1@2;6;32;40@@@@@radio@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>5@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data><![CDATA[5@34@1@35@@@@@1@2;6;33;40@@@@@ТАРИФ ПО-УМОЛЧАНИЮ: ТЕСТОВЫЙ~ --//-- ЭКОНОМНЫЙ~ --//-- СТАНДАРТНЫЙ~ --//-- ПРОФЕССИОНАЛЬНЫЙ@]]></Data>
</Node>
<Node><Sub>5</Sub>
<Data>5@69@1@9@@@@@1@2;6;32;40@@@@@Tariff@</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>6@1@1@13@@@@@1@2;6;35;40@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>6@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>6@24@1@10@@@@@1@2;6;32;40@@@@@size=30@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>6@34@1@35@@@@@1@2;6;33;40@@@@@Копирайт и Номер версии комплекса@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>6@69@1@9@@@@@1@2;6;32;40@@@@@Vers@</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>7@1@1@13@@@@@1@2;6;35;40@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>7@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>7@24@1@10@@@@@1@2;6;32;40@@@@@size=30@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>7@34@1@35@@@@@1@2;6;33;40@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>7@69@1@9@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>1</Sub>
<Data>8@1@1@13@@@@@1@2;6;35;40@@@@@n:/infoportal/snx/@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>8@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>8@24@1@10@@@@@1@2;6;32;40@@@@@size=30@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>8@34@1@35@@@@@1@2;6;33;40@@@@@каталог временных файлов для записи@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>8@69@1@9@@@@@1@2;6;32;40@@@@@TempDir2@</Data>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>1</Sub>
<Data>9@1@1@13@@@@@1@2;6;35;40@@@@@SAMPLES@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>9@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>9@24@1@10@@@@@1@2;6;32;40@@@@@size=30@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>9@34@1@35@@@@@1@2;6;33;40@@@@@Текущая рабочая область для новых клиентов@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>9@69@1@9@@@@@1@2;6;32;40@@@@@CurNSP@</Data>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>1</Sub>
<Data>10@1@1@13@@@@@1@2;6;35;40@@@@@DFLT1@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>10@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>10@24@1@10@@@@@1@2;6;32;40@@@@@size=30@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>10@34@1@35@@@@@1@2;6;33;40@@@@@Текущий стиль@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>10@69@1@9@@@@@1@2;6;32;40@@@@@CurCSS@</Data>
</Node>
</Node>
<Node><Sub>11</Sub>
<Node><Sub>1</Sub>
<Data>11@1@1@13@@@@@1@2;6;35;40@@@@@2@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>11@14@1@10@@@@@1@2;6;32;40@@@@@radio@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>11@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>11@34@1@35@@@@@1@2;6;33;40@@@@@Портал тарифицируется~не тарифицируется@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>11@69@1@9@@@@@1@2;6;32;40@@@@@Commerce@</Data>
</Node>
</Node>
<Node><Sub>12</Sub>
<Node><Sub>1</Sub>
<Data>12@1@1@13@@@@@1@2;6;35;40@@@@@0</Data>
</Node>
<Node><Sub>2</Sub>
<Data>12@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>12@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>12@34@1@35@@@@@1@2;6;33;40@@@@@Мультиязычность@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>12@69@1@9@@@@@1@2;6;32;40@@@@@MultiL@</Data>
</Node>
</Node>
<Node><Sub>13</Sub>
<Node><Sub>1</Sub>
<Data>13@1@1@13@@@@@1@2;6;35;40@@@@@0</Data>
</Node>
<Node><Sub>2</Sub>
<Data>13@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>13@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>13@34@1@35@@@@@1@2;6;33;40@@@@@Конкурсы проектов@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>13@69@1@9@@@@@1@2;6;32;40@@@@@Conc@</Data>
</Node>
</Node>
<Node><Sub>14</Sub>
<Node><Sub>1</Sub>
<Data>14@1@1@13@@@@@1@2;6;35;40@@@@@1</Data>
</Node>
<Node><Sub>2</Sub>
<Data>14@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>14@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>14@34@1@35@@@@@1@2;6;33;40@@@@@Включен WEB редактор программ COS@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>14@69@1@9@@@@@1@2;6;32;40@@@@@WebEditRou@</Data>
</Node>
</Node>
<Node><Sub>15</Sub>
<Node><Sub>1</Sub>
<Data>15@1@1@13@@@@@1@2;6;35;40@@@@@1</Data>
</Node>
<Node><Sub>2</Sub>
<Data>15@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>15@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>15@34@1@35@@@@@1@2;6;33;40@@@@@Включен WEB редактор данных таблиц@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>15@69@1@9@@@@@1@2;6;32;40@@@@@WebEditDT@</Data>
</Node>
</Node>
<Node><Sub>16</Sub>
<Node><Sub>1</Sub>
<Data>16@1@1@13@@@@@1@2;6;35;40@@@@@1</Data>
</Node>
<Node><Sub>2</Sub>
<Data>16@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>16@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>16@34@1@35@@@@@1@2;6;33;40@@@@@Разрешен вывод информации о сессии и системе@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>16@69@1@9@@@@@1@2;6;32;40@@@@@WebInfoSess@</Data>
</Node>
</Node>
<Node><Sub>17</Sub>
<Node><Sub>1</Sub>
<Data>17@1@1@13@@@@@1@2;6;35;40@@@@@cols=68 rows=5@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>17@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>17@24@1@10@@@@@1@2;6;32;40@@@@@size=32@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>17@34@1@35@@@@@1@2;6;33;40@@@@@Параметры TEXTAREA для кода COS@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>17@69@1@9@@@@@1@2;6;32;40@@@@@COS@</Data>
</Node>
</Node>
<Node><Sub>18</Sub>
<Node><Sub>1</Sub>
<Data>18@1@1@13@@@@@1@2;6;35;40@@@@@cols=68 rows=5@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>18@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>18@24@1@10@@@@@1@2;6;32;40@@@@@size=32@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>18@34@1@35@@@@@1@2;6;33;40@@@@@Параметры TEXTAREA для HTML@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>18@69@1@9@@@@@1@2;6;32;40@@@@@HTM@</Data>
</Node>
</Node>
<Node><Sub>19</Sub>
<Node><Sub>1</Sub>
<Data>19@1@1@13@@@@@1@2;6;30;46@@@@@1@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>19@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>19@24@1@10@@@@@1@2;6;32;40@@@@@size=35@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>19@34@1@35@@@@@1@@@@@@Разрешена ли работа с ODBC@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>19@69@1@9@@@@@1@2;6;32;40@@@@@ImportODBC@</Data>
</Node>
</Node>
<Node><Sub>20</Sub>
<Node><Sub>1</Sub>
<Data>20@1@1@13@@@@@1@2;6;30;46@@@@@1@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>20@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>20@24@1@10@@@@@1@2;6;32;40@@@@@size=35@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>20@34@1@35@@@@@1@@@@@@Разрешен ли импорт из Текстового файла@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>20@69@1@9@@@@@1@2;6;32;40@@@@@ImportTXT@</Data>
</Node>
</Node>
<Node><Sub>21</Sub>
<Node><Sub>1</Sub>
<Data>21@1@1@13@@@@@1@2;6;35;40@@@@@0</Data>
</Node>
<Node><Sub>2</Sub>
<Data>21@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>21@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data><![CDATA[21@34@1@35@@@@@1@2;6;33;40@@@@@Редактор системных таблиц (DICT,PIN,PROTECT,SESSIONS,TARIFF) выводить в одном окне@]]></Data>
</Node>
<Node><Sub>5</Sub>
<Data>21@69@1@9@@@@@1@2;6;32;40@@@@@EditTab1@</Data>
</Node>
</Node>
<Node><Sub>22</Sub>
<Node><Sub>1</Sub>
<Data>22@1@1@13@@@@@1@2;6;35;40@@@@@width=800,height=600@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>22@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>22@24@1@10@@@@@1@2;6;32;40@@@@@size=32@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>22@34@1@35@@@@@1@2;6;33;40@@@@@Размеры нового окна для редактора данных таблиц@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>22@69@1@9@@@@@1@2;6;32;40@@@@@NWT1@</Data>
</Node>
</Node>
<Node><Sub>23</Sub>
<Node><Sub>1</Sub>
<Data>23@1@1@13@@@@@1@2;6;35;40@@@@@width=800,height=600@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>23@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>23@24@1@10@@@@@1@2;6;32;40@@@@@size=32@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>23@34@1@35@@@@@1@2;6;33;40@@@@@Размеры нового окна для редактора Опций@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>23@69@1@9@@@@@1@2;6;32;40@@@@@NWO1@</Data>
</Node>
</Node>
<Node><Sub>24</Sub>
<Node><Sub>1</Sub>
<Data>24@1@1@13@@@@@1@2;6;30;46@@@@@1@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>24@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>24@24@1@10@@@@@1@2;6;32;40@@@@@size=35@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>24@34@1@35@@@@@1@@@@@@Разрешен ли пустой пароль пользователя@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>24@69@1@9@@@@@1@2;6;32;40@@@@@EmpPASS@</Data>
</Node>
</Node>
<Node><Sub>25</Sub>
<Node><Sub>1</Sub>
<Data>25@1@1@13@@@@@1@2;6;35;40@@@@@ГЦ АСУ ГКВВ МВД России@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>25@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>25@24@1@10@@@@@1@2;6;32;40@@@@@size=32@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>25@34@1@35@@@@@1@2;6;33;40@@@@@Конечный пользователь@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>25@69@1@9@@@@@1@2;6;32;40@@@@@ENDUSER@</Data>
</Node>
</Node>
<Node><Sub>26</Sub>
<Node><Sub>1</Sub>
<Data>26@1@1@13@@@@@1@2;6;35;40@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>26@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>26@24@1@10@@@@@1@2;6;32;40@@@@@size=32@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>26@34@1@35@@@@@1@2;6;33;40@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>26@69@1@9@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>59397,66776,SSS1</Data>
</Node>
<Node><Sub>OPT</Sub>
<Data>1</Data>
<Node><Sub>LST</Sub>
<Data>59397,66776,SSS1</Data>
<Node><Sub>B4I</Sub>
<Data>4</Data>
</Node>
<Node><Sub>CFG26</Sub>
<Data>26</Data>
</Node>
<Node><Sub>CFG7</Sub>
<Data>7</Data>
</Node>
<Node><Sub>COS</Sub>
<Data>17</Data>
</Node>
<Node><Sub>Commerce</Sub>
<Data>11</Data>
</Node>
<Node><Sub>Conc</Sub>
<Data>13</Data>
</Node>
<Node><Sub>CurCSS</Sub>
<Data>10</Data>
</Node>
<Node><Sub>CurNSP</Sub>
<Data>9</Data>
</Node>
<Node><Sub>ENDUSER</Sub>
<Data>25</Data>
</Node>
<Node><Sub>EditTab1</Sub>
<Data>21</Data>
</Node>
<Node><Sub>EmpPASS</Sub>
<Data>24</Data>
</Node>
<Node><Sub>HTM</Sub>
<Data>18</Data>
</Node>
<Node><Sub>IP</Sub>
<Data>3</Data>
</Node>
<Node><Sub>ImportODBC</Sub>
<Data>19</Data>
</Node>
<Node><Sub>ImportTXT</Sub>
<Data>20</Data>
</Node>
<Node><Sub>MultiL</Sub>
<Data>12</Data>
</Node>
<Node><Sub>NWO1</Sub>
<Data>23</Data>
</Node>
<Node><Sub>NWT1</Sub>
<Data>22</Data>
</Node>
<Node><Sub>Tariff</Sub>
<Data>5</Data>
</Node>
<Node><Sub>TempDir2</Sub>
<Data>8</Data>
</Node>
<Node><Sub>Vers</Sub>
<Data>6</Data>
</Node>
<Node><Sub>WebEditDT</Sub>
<Data>15</Data>
</Node>
<Node><Sub>WebEditRou</Sub>
<Data>14</Data>
</Node>
<Node><Sub>WebInfoSess</Sub>
<Data>16</Data>
</Node>
</Node>
</Node>
<Node><Sub>STA</Sub>
<Data>4,2@2@1@13@-1@-1@4@14@text</Data>
</Node>
</Node>
<Node><Sub>CFG8</Sub>
<Data>Основные Опции Комплекса@@@@@1@1@1@1@22@80@1@@1@1@@1@@2,1@1@@@@@@@@26@5@@1;6;35;44@@@@@@</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@13@@@@@1@2;6;35;40@@@@@ Value (DFLT)</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@14@1@10@@@@@1@2;6;30;41@@@@@ Type@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>1@24@1@10@@@@@1@2;6;30;41@@@@@Atribute@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>1@34@1@35@@@@@1@2;6;33;40@@@@@ ОПИСАНИЕ@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>1@69@1@9@@@@@1@2;6;30;41@@@@@ name@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@13@@@@@1@2;6;30;43@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>2@14@1@10@@@@@1@2;6;30;43@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>2@24@1@10@@@@@1@2;6;30;43@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>2@34@1@35@@@@@1@2;6;30;43@@@@@ Основные Опции Комплекса@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>2@69@1@9@@@@@1@2;6;30;43@@@@@@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@13@@@@@1@2;6;35;40@@@@@Информационный портал@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>3@24@1@10@@@@@1@2;6;32;40@@@@@size=30@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>3@34@1@35@@@@@1@2;6;33;40@@@@@Наименование портала@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>3@69@1@9@@@@@1@2;6;32;40@@@@@IP@</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>4@1@1@13@@@@@1@2;6;35;40@@@@@ОДОН@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>4@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>4@24@1@10@@@@@1@2;6;32;40@@@@@size=30@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>4@34@1@35@@@@@1@2;6;33;40@@@@@Название комплекса@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>4@69@1@9@@@@@1@2;6;32;40@@@@@B4I@</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>5@1@1@13@@@@@1@2;6;35;40@@@@@1@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>5@14@1@10@@@@@1@2;6;32;40@@@@@radio@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>5@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data><![CDATA[5@34@1@35@@@@@1@2;6;33;40@@@@@ТАРИФ ПО-УМОЛЧАНИЮ: ТЕСТОВЫЙ~ --//-- ЭКОНОМНЫЙ~ --//-- СТАНДАРТНЫЙ~ --//-- ПРОФЕССИОНАЛЬНЫЙ@]]></Data>
</Node>
<Node><Sub>5</Sub>
<Data>5@69@1@9@@@@@1@2;6;32;40@@@@@Tariff@</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>6@1@1@13@@@@@1@2;6;35;40@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>6@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>6@24@1@10@@@@@1@2;6;32;40@@@@@size=30@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>6@34@1@35@@@@@1@2;6;33;40@@@@@Копирайт и Номер версии комплекса@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>6@69@1@9@@@@@1@2;6;32;40@@@@@Vers@</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>7@1@1@13@@@@@1@2;6;35;40@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>7@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>7@24@1@10@@@@@1@2;6;32;40@@@@@size=30@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>7@34@1@35@@@@@1@2;6;33;40@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>7@69@1@9@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>1</Sub>
<Data>8@1@1@13@@@@@1@2;6;35;40@@@@@n:/infoportal/snx/@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>8@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>8@24@1@10@@@@@1@2;6;32;40@@@@@size=30@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>8@34@1@35@@@@@1@2;6;33;40@@@@@каталог временных файлов для записи@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>8@69@1@9@@@@@1@2;6;32;40@@@@@TempDir2@</Data>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>1</Sub>
<Data>9@1@1@13@@@@@1@2;6;35;40@@@@@SAMPLES@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>9@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>9@24@1@10@@@@@1@2;6;32;40@@@@@size=30@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>9@34@1@35@@@@@1@2;6;33;40@@@@@Текущая рабочая область для новых клиентов@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>9@69@1@9@@@@@1@2;6;32;40@@@@@CurNSP@</Data>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>1</Sub>
<Data>10@1@1@13@@@@@1@2;6;35;40@@@@@DFLT1@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>10@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>10@24@1@10@@@@@1@2;6;32;40@@@@@size=30@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>10@34@1@35@@@@@1@2;6;33;40@@@@@Текущий стиль@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>10@69@1@9@@@@@1@2;6;32;40@@@@@CurCSS@</Data>
</Node>
</Node>
<Node><Sub>11</Sub>
<Node><Sub>1</Sub>
<Data>11@1@1@13@@@@@1@2;6;35;40@@@@@2@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>11@14@1@10@@@@@1@2;6;32;40@@@@@radio@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>11@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>11@34@1@35@@@@@1@2;6;33;40@@@@@Портал тарифицируется~не тарифицируется@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>11@69@1@9@@@@@1@2;6;32;40@@@@@Commerce@</Data>
</Node>
</Node>
<Node><Sub>12</Sub>
<Node><Sub>1</Sub>
<Data>12@1@1@13@@@@@1@2;6;35;40@@@@@0</Data>
</Node>
<Node><Sub>2</Sub>
<Data>12@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>12@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>12@34@1@35@@@@@1@2;6;33;40@@@@@Мультиязычность@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>12@69@1@9@@@@@1@2;6;32;40@@@@@MultiL@</Data>
</Node>
</Node>
<Node><Sub>13</Sub>
<Node><Sub>1</Sub>
<Data>13@1@1@13@@@@@1@2;6;35;40@@@@@0</Data>
</Node>
<Node><Sub>2</Sub>
<Data>13@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>13@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>13@34@1@35@@@@@1@2;6;33;40@@@@@Конкурсы проектов@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>13@69@1@9@@@@@1@2;6;32;40@@@@@Conc@</Data>
</Node>
</Node>
<Node><Sub>14</Sub>
<Node><Sub>1</Sub>
<Data>14@1@1@13@@@@@1@2;6;35;40@@@@@1</Data>
</Node>
<Node><Sub>2</Sub>
<Data>14@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>14@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>14@34@1@35@@@@@1@2;6;33;40@@@@@Включен WEB редактор программ COS@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>14@69@1@9@@@@@1@2;6;32;40@@@@@WebEditRou@</Data>
</Node>
</Node>
<Node><Sub>15</Sub>
<Node><Sub>1</Sub>
<Data>15@1@1@13@@@@@1@2;6;35;40@@@@@1</Data>
</Node>
<Node><Sub>2</Sub>
<Data>15@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>15@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>15@34@1@35@@@@@1@2;6;33;40@@@@@Включен WEB редактор данных таблиц@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>15@69@1@9@@@@@1@2;6;32;40@@@@@WebEditDT@</Data>
</Node>
</Node>
<Node><Sub>16</Sub>
<Node><Sub>1</Sub>
<Data>16@1@1@13@@@@@1@2;6;35;40@@@@@1</Data>
</Node>
<Node><Sub>2</Sub>
<Data>16@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>16@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>16@34@1@35@@@@@1@2;6;33;40@@@@@Разрешен вывод информации о сессии и системе@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>16@69@1@9@@@@@1@2;6;32;40@@@@@WebInfoSess@</Data>
</Node>
</Node>
<Node><Sub>17</Sub>
<Node><Sub>1</Sub>
<Data>17@1@1@13@@@@@1@2;6;35;40@@@@@cols=68 rows=5@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>17@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>17@24@1@10@@@@@1@2;6;32;40@@@@@size=32@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>17@34@1@35@@@@@1@2;6;33;40@@@@@Параметры TEXTAREA для кода COS@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>17@69@1@9@@@@@1@2;6;32;40@@@@@COS@</Data>
</Node>
</Node>
<Node><Sub>18</Sub>
<Node><Sub>1</Sub>
<Data>18@1@1@13@@@@@1@2;6;35;40@@@@@cols=68 rows=5@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>18@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>18@24@1@10@@@@@1@2;6;32;40@@@@@size=32@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>18@34@1@35@@@@@1@2;6;33;40@@@@@Параметры TEXTAREA для HTML@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>18@69@1@9@@@@@1@2;6;32;40@@@@@HTM@</Data>
</Node>
</Node>
<Node><Sub>19</Sub>
<Node><Sub>1</Sub>
<Data>19@1@1@13@@@@@1@2;6;30;46@@@@@1@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>19@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>19@24@1@10@@@@@1@2;6;32;40@@@@@size=35@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>19@34@1@35@@@@@1@@@@@@Разрешена ли работа с ODBC@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>19@69@1@9@@@@@1@2;6;32;40@@@@@ImportODBC@</Data>
</Node>
</Node>
<Node><Sub>20</Sub>
<Node><Sub>1</Sub>
<Data>20@1@1@13@@@@@1@2;6;30;46@@@@@1@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>20@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>20@24@1@10@@@@@1@2;6;32;40@@@@@size=35@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>20@34@1@35@@@@@1@@@@@@Разрешен ли импорт из Текстового файла@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>20@69@1@9@@@@@1@2;6;32;40@@@@@ImportTXT@</Data>
</Node>
</Node>
<Node><Sub>21</Sub>
<Node><Sub>1</Sub>
<Data>21@1@1@13@@@@@1@2;6;35;40@@@@@0</Data>
</Node>
<Node><Sub>2</Sub>
<Data>21@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>21@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data><![CDATA[21@34@1@35@@@@@1@2;6;33;40@@@@@Редактор системных таблиц (DICT,PIN,PROTECT,SESSIONS,TARIFF) выводить в одном окне@]]></Data>
</Node>
<Node><Sub>5</Sub>
<Data>21@69@1@9@@@@@1@2;6;32;40@@@@@EditTab1@</Data>
</Node>
</Node>
<Node><Sub>22</Sub>
<Node><Sub>1</Sub>
<Data>22@1@1@13@@@@@1@2;6;35;40@@@@@width=800,height=600@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>22@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>22@24@1@10@@@@@1@2;6;32;40@@@@@size=32@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>22@34@1@35@@@@@1@2;6;33;40@@@@@Размеры нового окна для редактора данных таблиц@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>22@69@1@9@@@@@1@2;6;32;40@@@@@NWT1@</Data>
</Node>
</Node>
<Node><Sub>23</Sub>
<Node><Sub>1</Sub>
<Data>23@1@1@13@@@@@1@2;6;35;40@@@@@width=800,height=600@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>23@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>23@24@1@10@@@@@1@2;6;32;40@@@@@size=32@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>23@34@1@35@@@@@1@2;6;33;40@@@@@Размеры нового окна для редактора Опций@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>23@69@1@9@@@@@1@2;6;32;40@@@@@NWO1@</Data>
</Node>
</Node>
<Node><Sub>24</Sub>
<Node><Sub>1</Sub>
<Data>24@1@1@13@@@@@1@2;6;30;46@@@@@1@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>24@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>24@24@1@10@@@@@1@2;6;32;40@@@@@size=35@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>24@34@1@35@@@@@1@@@@@@Разрешен ли пустой пароль пользователя@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>24@69@1@9@@@@@1@2;6;32;40@@@@@EmpPASS@</Data>
</Node>
</Node>
<Node><Sub>25</Sub>
<Node><Sub>1</Sub>
<Data>25@1@1@13@@@@@1@2;6;35;40@@@@@ГЦ АСУ ГКВВ МВД России@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>25@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>25@24@1@10@@@@@1@2;6;32;40@@@@@size=32@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>25@34@1@35@@@@@1@2;6;33;40@@@@@Конечный пользователь@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>25@69@1@9@@@@@1@2;6;32;40@@@@@ENDUSER@</Data>
</Node>
</Node>
<Node><Sub>26</Sub>
<Node><Sub>1</Sub>
<Data>26@1@1@13@@@@@1@2;6;35;40@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>26@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>26@24@1@10@@@@@1@2;6;32;40@@@@@size=32@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>26@34@1@35@@@@@1@2;6;33;40@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>26@69@1@9@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>59397,66776,SSS1</Data>
</Node>
<Node><Sub>OPT</Sub>
<Data>1</Data>
<Node><Sub>LST</Sub>
<Data>59397,66776,SSS1</Data>
<Node><Sub>B4I</Sub>
<Data>4</Data>
</Node>
<Node><Sub>CFG26</Sub>
<Data>26</Data>
</Node>
<Node><Sub>CFG7</Sub>
<Data>7</Data>
</Node>
<Node><Sub>COS</Sub>
<Data>17</Data>
</Node>
<Node><Sub>Commerce</Sub>
<Data>11</Data>
</Node>
<Node><Sub>Conc</Sub>
<Data>13</Data>
</Node>
<Node><Sub>CurCSS</Sub>
<Data>10</Data>
</Node>
<Node><Sub>CurNSP</Sub>
<Data>9</Data>
</Node>
<Node><Sub>ENDUSER</Sub>
<Data>25</Data>
</Node>
<Node><Sub>EditTab1</Sub>
<Data>21</Data>
</Node>
<Node><Sub>EmpPASS</Sub>
<Data>24</Data>
</Node>
<Node><Sub>HTM</Sub>
<Data>18</Data>
</Node>
<Node><Sub>IP</Sub>
<Data>3</Data>
</Node>
<Node><Sub>ImportODBC</Sub>
<Data>19</Data>
</Node>
<Node><Sub>ImportTXT</Sub>
<Data>20</Data>
</Node>
<Node><Sub>MultiL</Sub>
<Data>12</Data>
</Node>
<Node><Sub>NWO1</Sub>
<Data>23</Data>
</Node>
<Node><Sub>NWT1</Sub>
<Data>22</Data>
</Node>
<Node><Sub>Tariff</Sub>
<Data>5</Data>
</Node>
<Node><Sub>TempDir2</Sub>
<Data>8</Data>
</Node>
<Node><Sub>Vers</Sub>
<Data>6</Data>
</Node>
<Node><Sub>WebEditDT</Sub>
<Data>15</Data>
</Node>
<Node><Sub>WebEditRou</Sub>
<Data>14</Data>
</Node>
<Node><Sub>WebInfoSess</Sub>
<Data>16</Data>
</Node>
</Node>
</Node>
<Node><Sub>STA</Sub>
<Data>4,2@2@1@13@-1@-1@4@14@text</Data>
</Node>
</Node>
<Node><Sub>CFG9</Sub>
<Data>Основные Опции Комплекса@@@@@1@1@1@1@22@80@1@@1@1@@1@@2,1@1@@@@@@@@26@5@@1;6;35;44@@@@@@</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@13@@@@@1@2;6;35;40@@@@@ Value (DFLT)</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@14@1@10@@@@@1@2;6;30;41@@@@@ Type@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>1@24@1@10@@@@@1@2;6;30;41@@@@@Atribute@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>1@34@1@35@@@@@1@2;6;33;40@@@@@ ОПИСАНИЕ@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>1@69@1@9@@@@@1@2;6;30;41@@@@@ name@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@13@@@@@1@2;6;30;43@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>2@14@1@10@@@@@1@2;6;30;43@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>2@24@1@10@@@@@1@2;6;30;43@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>2@34@1@35@@@@@1@2;6;30;43@@@@@ Основные Опции Комплекса@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>2@69@1@9@@@@@1@2;6;30;43@@@@@@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@13@@@@@1@2;6;35;40@@@@@Информационный портал@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>3@24@1@10@@@@@1@2;6;32;40@@@@@size=30@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>3@34@1@35@@@@@1@2;6;33;40@@@@@Наименование портала@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>3@69@1@9@@@@@1@2;6;32;40@@@@@IP@</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>4@1@1@13@@@@@1@2;6;35;40@@@@@ВОУВПО@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>4@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>4@24@1@10@@@@@1@2;6;32;40@@@@@size=30@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>4@34@1@35@@@@@1@2;6;33;40@@@@@Название комплекса@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>4@69@1@9@@@@@1@2;6;32;40@@@@@B4I@</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>5@1@1@13@@@@@1@2;6;35;40@@@@@1@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>5@14@1@10@@@@@1@2;6;32;40@@@@@radio@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>5@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data><![CDATA[5@34@1@35@@@@@1@2;6;33;40@@@@@ТАРИФ ПО-УМОЛЧАНИЮ: ТЕСТОВЫЙ~ --//-- ЭКОНОМНЫЙ~ --//-- СТАНДАРТНЫЙ~ --//-- ПРОФЕССИОНАЛЬНЫЙ@]]></Data>
</Node>
<Node><Sub>5</Sub>
<Data>5@69@1@9@@@@@1@2;6;32;40@@@@@Tariff@</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>6@1@1@13@@@@@1@2;6;35;40@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>6@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>6@24@1@10@@@@@1@2;6;32;40@@@@@size=30@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>6@34@1@35@@@@@1@2;6;33;40@@@@@Копирайт и Номер версии комплекса@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>6@69@1@9@@@@@1@2;6;32;40@@@@@Vers@</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>7@1@1@13@@@@@1@2;6;35;40@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>7@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>7@24@1@10@@@@@1@2;6;32;40@@@@@size=30@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>7@34@1@35@@@@@1@2;6;33;40@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>7@69@1@9@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>1</Sub>
<Data>8@1@1@13@@@@@1@2;6;35;40@@@@@n:/infoportal/snx/@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>8@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>8@24@1@10@@@@@1@2;6;32;40@@@@@size=30@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>8@34@1@35@@@@@1@2;6;33;40@@@@@каталог временных файлов для записи@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>8@69@1@9@@@@@1@2;6;32;40@@@@@TempDir2@</Data>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>1</Sub>
<Data>9@1@1@13@@@@@1@2;6;35;40@@@@@SAMPLES@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>9@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>9@24@1@10@@@@@1@2;6;32;40@@@@@size=30@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>9@34@1@35@@@@@1@2;6;33;40@@@@@Текущая рабочая область для новых клиентов@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>9@69@1@9@@@@@1@2;6;32;40@@@@@CurNSP@</Data>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>1</Sub>
<Data>10@1@1@13@@@@@1@2;6;35;40@@@@@DFLT1@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>10@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>10@24@1@10@@@@@1@2;6;32;40@@@@@size=30@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>10@34@1@35@@@@@1@2;6;33;40@@@@@Текущий стиль@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>10@69@1@9@@@@@1@2;6;32;40@@@@@CurCSS@</Data>
</Node>
</Node>
<Node><Sub>11</Sub>
<Node><Sub>1</Sub>
<Data>11@1@1@13@@@@@1@2;6;35;40@@@@@2@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>11@14@1@10@@@@@1@2;6;32;40@@@@@radio@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>11@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>11@34@1@35@@@@@1@2;6;33;40@@@@@Портал тарифицируется~не тарифицируется@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>11@69@1@9@@@@@1@2;6;32;40@@@@@Commerce@</Data>
</Node>
</Node>
<Node><Sub>12</Sub>
<Node><Sub>1</Sub>
<Data>12@1@1@13@@@@@1@2;6;35;40@@@@@0</Data>
</Node>
<Node><Sub>2</Sub>
<Data>12@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>12@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>12@34@1@35@@@@@1@2;6;33;40@@@@@Мультиязычность@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>12@69@1@9@@@@@1@2;6;32;40@@@@@MultiL@</Data>
</Node>
</Node>
<Node><Sub>13</Sub>
<Node><Sub>1</Sub>
<Data>13@1@1@13@@@@@1@2;6;35;40@@@@@0</Data>
</Node>
<Node><Sub>2</Sub>
<Data>13@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>13@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>13@34@1@35@@@@@1@2;6;33;40@@@@@Конкурсы проектов@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>13@69@1@9@@@@@1@2;6;32;40@@@@@Conc@</Data>
</Node>
</Node>
<Node><Sub>14</Sub>
<Node><Sub>1</Sub>
<Data>14@1@1@13@@@@@1@2;6;35;40@@@@@1</Data>
</Node>
<Node><Sub>2</Sub>
<Data>14@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>14@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>14@34@1@35@@@@@1@2;6;33;40@@@@@Включен WEB редактор программ COS@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>14@69@1@9@@@@@1@2;6;32;40@@@@@WebEditRou@</Data>
</Node>
</Node>
<Node><Sub>15</Sub>
<Node><Sub>1</Sub>
<Data>15@1@1@13@@@@@1@2;6;35;40@@@@@1</Data>
</Node>
<Node><Sub>2</Sub>
<Data>15@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>15@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>15@34@1@35@@@@@1@2;6;33;40@@@@@Включен WEB редактор данных таблиц@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>15@69@1@9@@@@@1@2;6;32;40@@@@@WebEditDT@</Data>
</Node>
</Node>
<Node><Sub>16</Sub>
<Node><Sub>1</Sub>
<Data>16@1@1@13@@@@@1@2;6;35;40@@@@@1</Data>
</Node>
<Node><Sub>2</Sub>
<Data>16@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>16@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>16@34@1@35@@@@@1@2;6;33;40@@@@@Разрешен вывод информации о сессии и системе@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>16@69@1@9@@@@@1@2;6;32;40@@@@@WebInfoSess@</Data>
</Node>
</Node>
<Node><Sub>17</Sub>
<Node><Sub>1</Sub>
<Data>17@1@1@13@@@@@1@2;6;35;40@@@@@cols=68 rows=5@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>17@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>17@24@1@10@@@@@1@2;6;32;40@@@@@size=32@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>17@34@1@35@@@@@1@2;6;33;40@@@@@Параметры TEXTAREA для кода COS@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>17@69@1@9@@@@@1@2;6;32;40@@@@@COS@</Data>
</Node>
</Node>
<Node><Sub>18</Sub>
<Node><Sub>1</Sub>
<Data>18@1@1@13@@@@@1@2;6;35;40@@@@@cols=68 rows=5@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>18@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>18@24@1@10@@@@@1@2;6;32;40@@@@@size=32@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>18@34@1@35@@@@@1@2;6;33;40@@@@@Параметры TEXTAREA для HTML@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>18@69@1@9@@@@@1@2;6;32;40@@@@@HTM@</Data>
</Node>
</Node>
<Node><Sub>19</Sub>
<Node><Sub>1</Sub>
<Data>19@1@1@13@@@@@1@2;6;30;46@@@@@1@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>19@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>19@24@1@10@@@@@1@2;6;32;40@@@@@size=35@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>19@34@1@35@@@@@1@@@@@@Разрешена ли работа с ODBC@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>19@69@1@9@@@@@1@2;6;32;40@@@@@ImportODBC@</Data>
</Node>
</Node>
<Node><Sub>20</Sub>
<Node><Sub>1</Sub>
<Data>20@1@1@13@@@@@1@2;6;30;46@@@@@1@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>20@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>20@24@1@10@@@@@1@2;6;32;40@@@@@size=35@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>20@34@1@35@@@@@1@@@@@@Разрешен ли импорт из Текстового файла@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>20@69@1@9@@@@@1@2;6;32;40@@@@@ImportTXT@</Data>
</Node>
</Node>
<Node><Sub>21</Sub>
<Node><Sub>1</Sub>
<Data>21@1@1@13@@@@@1@2;6;35;40@@@@@0</Data>
</Node>
<Node><Sub>2</Sub>
<Data>21@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>21@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data><![CDATA[21@34@1@35@@@@@1@2;6;33;40@@@@@Редактор системных таблиц (DICT,PIN,PROTECT,SESSIONS,TARIFF) выводить в одном окне@]]></Data>
</Node>
<Node><Sub>5</Sub>
<Data>21@69@1@9@@@@@1@2;6;32;40@@@@@EditTab1@</Data>
</Node>
</Node>
<Node><Sub>22</Sub>
<Node><Sub>1</Sub>
<Data>22@1@1@13@@@@@1@2;6;35;40@@@@@width=800,height=600@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>22@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>22@24@1@10@@@@@1@2;6;32;40@@@@@size=32@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>22@34@1@35@@@@@1@2;6;33;40@@@@@Размеры нового окна для редактора данных таблиц@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>22@69@1@9@@@@@1@2;6;32;40@@@@@NWT1@</Data>
</Node>
</Node>
<Node><Sub>23</Sub>
<Node><Sub>1</Sub>
<Data>23@1@1@13@@@@@1@2;6;35;40@@@@@width=800,height=600@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>23@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>23@24@1@10@@@@@1@2;6;32;40@@@@@size=32@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>23@34@1@35@@@@@1@2;6;33;40@@@@@Размеры нового окна для редактора Опций@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>23@69@1@9@@@@@1@2;6;32;40@@@@@NWO1@</Data>
</Node>
</Node>
<Node><Sub>24</Sub>
<Node><Sub>1</Sub>
<Data>24@1@1@13@@@@@1@2;6;30;46@@@@@1@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>24@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>24@24@1@10@@@@@1@2;6;32;40@@@@@size=35@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>24@34@1@35@@@@@1@@@@@@Разрешен ли пустой пароль пользователя@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>24@69@1@9@@@@@1@2;6;32;40@@@@@EmpPASS@</Data>
</Node>
</Node>
<Node><Sub>25</Sub>
<Node><Sub>1</Sub>
<Data>25@1@1@13@@@@@1@2;6;35;40@@@@@ГЦ АСУ ГКВВ МВД России@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>25@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>25@24@1@10@@@@@1@2;6;32;40@@@@@size=32@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>25@34@1@35@@@@@1@2;6;33;40@@@@@Конечный пользователь@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>25@69@1@9@@@@@1@2;6;32;40@@@@@ENDUSER@</Data>
</Node>
</Node>
<Node><Sub>26</Sub>
<Node><Sub>1</Sub>
<Data>26@1@1@13@@@@@1@2;6;35;40@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>26@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>26@24@1@10@@@@@1@2;6;32;40@@@@@size=32@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>26@34@1@35@@@@@1@2;6;33;40@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>26@69@1@9@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>59397,66776,SSS1</Data>
</Node>
<Node><Sub>OPT</Sub>
<Data>1</Data>
<Node><Sub>LST</Sub>
<Data>59397,66776,SSS1</Data>
<Node><Sub>B4I</Sub>
<Data>4</Data>
</Node>
<Node><Sub>CFG26</Sub>
<Data>26</Data>
</Node>
<Node><Sub>CFG7</Sub>
<Data>7</Data>
</Node>
<Node><Sub>COS</Sub>
<Data>17</Data>
</Node>
<Node><Sub>Commerce</Sub>
<Data>11</Data>
</Node>
<Node><Sub>Conc</Sub>
<Data>13</Data>
</Node>
<Node><Sub>CurCSS</Sub>
<Data>10</Data>
</Node>
<Node><Sub>CurNSP</Sub>
<Data>9</Data>
</Node>
<Node><Sub>ENDUSER</Sub>
<Data>25</Data>
</Node>
<Node><Sub>EditTab1</Sub>
<Data>21</Data>
</Node>
<Node><Sub>EmpPASS</Sub>
<Data>24</Data>
</Node>
<Node><Sub>HTM</Sub>
<Data>18</Data>
</Node>
<Node><Sub>IP</Sub>
<Data>3</Data>
</Node>
<Node><Sub>ImportODBC</Sub>
<Data>19</Data>
</Node>
<Node><Sub>ImportTXT</Sub>
<Data>20</Data>
</Node>
<Node><Sub>MultiL</Sub>
<Data>12</Data>
</Node>
<Node><Sub>NWO1</Sub>
<Data>23</Data>
</Node>
<Node><Sub>NWT1</Sub>
<Data>22</Data>
</Node>
<Node><Sub>Tariff</Sub>
<Data>5</Data>
</Node>
<Node><Sub>TempDir2</Sub>
<Data>8</Data>
</Node>
<Node><Sub>Vers</Sub>
<Data>6</Data>
</Node>
<Node><Sub>WebEditDT</Sub>
<Data>15</Data>
</Node>
<Node><Sub>WebEditRou</Sub>
<Data>14</Data>
</Node>
<Node><Sub>WebInfoSess</Sub>
<Data>16</Data>
</Node>
</Node>
</Node>
<Node><Sub>STA</Sub>
<Data>26,5@6@1@13@-1@-1@22@69@</Data>
</Node>
</Node>
<Node><Sub>CFGFREE</Sub>
<Data>Основные Опции Комплекса@@@@@1@1@1@1@22@80@1@@1@1@@1@@2,1@1@@@@@@@@26@5@@1;6;35;44@@@@@@</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@13@@@@@1@2;6;35;40@@@@@ Value (DFLT)</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@14@1@10@@@@@1@2;6;30;41@@@@@ Type@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>1@24@1@10@@@@@1@2;6;30;41@@@@@Atribute@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>1@34@1@35@@@@@1@2;6;33;40@@@@@ ОПИСАНИЕ@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>1@69@1@9@@@@@1@2;6;30;41@@@@@ name@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@13@@@@@1@2;6;30;43@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>2@14@1@10@@@@@1@2;6;30;43@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>2@24@1@10@@@@@1@2;6;30;43@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>2@34@1@35@@@@@1@2;6;30;43@@@@@ Основные Опции Комплекса@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>2@69@1@9@@@@@1@2;6;30;43@@@@@@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@13@@@@@1@2;6;35;40@@@@@Информационный портал@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>3@24@1@10@@@@@1@2;6;32;40@@@@@size=30@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>3@34@1@35@@@@@1@2;6;33;40@@@@@Наименование портала@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>3@69@1@9@@@@@1@2;6;32;40@@@@@IP@</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>4@1@1@13@@@@@1@2;6;35;40@@@@@B4Y@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>4@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>4@24@1@10@@@@@1@2;6;32;40@@@@@size=30@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>4@34@1@35@@@@@1@2;6;33;40@@@@@Название комплекса@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>4@69@1@9@@@@@1@2;6;32;40@@@@@B4I@</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>5@1@1@13@@@@@1@2;6;35;40@@@@@1@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>5@14@1@10@@@@@1@2;6;32;40@@@@@radio@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>5@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data><![CDATA[5@34@1@35@@@@@1@2;6;33;40@@@@@ТАРИФ ПО-УМОЛЧАНИЮ: ТЕСТОВЫЙ~ --//-- ЭКОНОМНЫЙ~ --//-- СТАНДАРТНЫЙ~ --//-- ПРОФЕССИОНАЛЬНЫЙ@]]></Data>
</Node>
<Node><Sub>5</Sub>
<Data>5@69@1@9@@@@@1@2;6;32;40@@@@@Tariff@</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>6@1@1@13@@@@@1@2;6;35;40@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>6@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>6@24@1@10@@@@@1@2;6;32;40@@@@@size=30@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>6@34@1@35@@@@@1@2;6;33;40@@@@@Копирайт и Номер версии комплекса@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>6@69@1@9@@@@@1@2;6;32;40@@@@@Vers@</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>7@1@1@13@@@@@1@2;6;35;40@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>7@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>7@24@1@10@@@@@1@2;6;32;40@@@@@size=30@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>7@34@1@35@@@@@1@2;6;33;40@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>7@69@1@9@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>1</Sub>
<Data>8@1@1@13@@@@@1@2;6;35;40@@@@@n:/infoportal/snx/@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>8@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>8@24@1@10@@@@@1@2;6;32;40@@@@@size=30@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>8@34@1@35@@@@@1@2;6;33;40@@@@@каталог временных файлов для записи@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>8@69@1@9@@@@@1@2;6;32;40@@@@@TempDir2@</Data>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>1</Sub>
<Data>9@1@1@13@@@@@1@2;6;35;40@@@@@SAMPLES@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>9@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>9@24@1@10@@@@@1@2;6;32;40@@@@@size=30@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>9@34@1@35@@@@@1@2;6;33;40@@@@@Текущая рабочая область для новых клиентов@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>9@69@1@9@@@@@1@2;6;32;40@@@@@CurNSP@</Data>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>1</Sub>
<Data>10@1@1@13@@@@@1@2;6;35;40@@@@@GREEN@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>10@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>10@24@1@10@@@@@1@2;6;32;40@@@@@size=30@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>10@34@1@35@@@@@1@2;6;33;40@@@@@Текущий стиль@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>10@69@1@9@@@@@1@2;6;32;40@@@@@CurCSS@</Data>
</Node>
</Node>
<Node><Sub>11</Sub>
<Node><Sub>1</Sub>
<Data>11@1@1@13@@@@@1@2;6;35;40@@@@@2@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>11@14@1@10@@@@@1@2;6;32;40@@@@@radio@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>11@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>11@34@1@35@@@@@1@2;6;33;40@@@@@Портал тарифицируется~не тарифицируется@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>11@69@1@9@@@@@1@2;6;32;40@@@@@Commerce@</Data>
</Node>
</Node>
<Node><Sub>12</Sub>
<Node><Sub>1</Sub>
<Data>12@1@1@13@@@@@1@2;6;35;40@@@@@0</Data>
</Node>
<Node><Sub>2</Sub>
<Data>12@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>12@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>12@34@1@35@@@@@1@2;6;33;40@@@@@Мультиязычность@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>12@69@1@9@@@@@1@2;6;32;40@@@@@MultiL@</Data>
</Node>
</Node>
<Node><Sub>13</Sub>
<Node><Sub>1</Sub>
<Data>13@1@1@13@@@@@1@2;6;35;40@@@@@0</Data>
</Node>
<Node><Sub>2</Sub>
<Data>13@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>13@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>13@34@1@35@@@@@1@2;6;33;40@@@@@Конкурсы проектов@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>13@69@1@9@@@@@1@2;6;32;40@@@@@Conc@</Data>
</Node>
</Node>
<Node><Sub>14</Sub>
<Node><Sub>1</Sub>
<Data>14@1@1@13@@@@@1@2;6;35;40@@@@@1</Data>
</Node>
<Node><Sub>2</Sub>
<Data>14@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>14@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>14@34@1@35@@@@@1@2;6;33;40@@@@@Включен WEB редактор программ COS@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>14@69@1@9@@@@@1@2;6;32;40@@@@@WebEditRou@</Data>
</Node>
</Node>
<Node><Sub>15</Sub>
<Node><Sub>1</Sub>
<Data>15@1@1@13@@@@@1@2;6;35;40@@@@@1</Data>
</Node>
<Node><Sub>2</Sub>
<Data>15@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>15@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>15@34@1@35@@@@@1@2;6;33;40@@@@@Включен WEB редактор данных таблиц@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>15@69@1@9@@@@@1@2;6;32;40@@@@@WebEditDT@</Data>
</Node>
</Node>
<Node><Sub>16</Sub>
<Node><Sub>1</Sub>
<Data>16@1@1@13@@@@@1@2;6;35;40@@@@@1</Data>
</Node>
<Node><Sub>2</Sub>
<Data>16@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>16@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>16@34@1@35@@@@@1@2;6;33;40@@@@@Разрешен вывод информации о сессии и системе@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>16@69@1@9@@@@@1@2;6;32;40@@@@@WebInfoSess@</Data>
</Node>
</Node>
<Node><Sub>17</Sub>
<Node><Sub>1</Sub>
<Data>17@1@1@13@@@@@1@2;6;35;40@@@@@cols=68 rows=5@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>17@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>17@24@1@10@@@@@1@2;6;32;40@@@@@size=32@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>17@34@1@35@@@@@1@2;6;33;40@@@@@Параметры TEXTAREA для кода COS@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>17@69@1@9@@@@@1@2;6;32;40@@@@@COS@</Data>
</Node>
</Node>
<Node><Sub>18</Sub>
<Node><Sub>1</Sub>
<Data>18@1@1@13@@@@@1@2;6;35;40@@@@@cols=68 rows=5@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>18@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>18@24@1@10@@@@@1@2;6;32;40@@@@@size=32@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>18@34@1@35@@@@@1@2;6;33;40@@@@@Параметры TEXTAREA для HTML@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>18@69@1@9@@@@@1@2;6;32;40@@@@@HTM@</Data>
</Node>
</Node>
<Node><Sub>19</Sub>
<Node><Sub>1</Sub>
<Data>19@1@1@13@@@@@1@2;6;30;46@@@@@1@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>19@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>19@24@1@10@@@@@1@2;6;32;40@@@@@size=35@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>19@34@1@35@@@@@1@@@@@@Разрешена ли работа с ODBC@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>19@69@1@9@@@@@1@2;6;32;40@@@@@ImportODBC@</Data>
</Node>
</Node>
<Node><Sub>20</Sub>
<Node><Sub>1</Sub>
<Data>20@1@1@13@@@@@1@2;6;30;46@@@@@1@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>20@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>20@24@1@10@@@@@1@2;6;32;40@@@@@size=35@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>20@34@1@35@@@@@1@@@@@@Разрешен ли импорт из Текстового файла@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>20@69@1@9@@@@@1@2;6;32;40@@@@@ImportTXT@</Data>
</Node>
</Node>
<Node><Sub>21</Sub>
<Node><Sub>1</Sub>
<Data>21@1@1@13@@@@@1@2;6;35;40@@@@@0</Data>
</Node>
<Node><Sub>2</Sub>
<Data>21@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>21@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data><![CDATA[21@34@1@35@@@@@1@2;6;33;40@@@@@Редактор системных таблиц (DICT,PIN,PROTECT,SESSIONS,TARIFF) выводить в одном окне@]]></Data>
</Node>
<Node><Sub>5</Sub>
<Data>21@69@1@9@@@@@1@2;6;32;40@@@@@EditTab1@</Data>
</Node>
</Node>
<Node><Sub>22</Sub>
<Node><Sub>1</Sub>
<Data>22@1@1@13@@@@@1@2;6;35;40@@@@@width=800,height=600@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>22@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>22@24@1@10@@@@@1@2;6;32;40@@@@@size=32@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>22@34@1@35@@@@@1@2;6;33;40@@@@@Размеры нового окна для редактора данных таблиц@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>22@69@1@9@@@@@1@2;6;32;40@@@@@NWT1@</Data>
</Node>
</Node>
<Node><Sub>23</Sub>
<Node><Sub>1</Sub>
<Data>23@1@1@13@@@@@1@2;6;35;40@@@@@width=800,height=600@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>23@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>23@24@1@10@@@@@1@2;6;32;40@@@@@size=32@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>23@34@1@35@@@@@1@2;6;33;40@@@@@Размеры нового окна для редактора Опций@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>23@69@1@9@@@@@1@2;6;32;40@@@@@NWO1@</Data>
</Node>
</Node>
<Node><Sub>24</Sub>
<Node><Sub>1</Sub>
<Data>24@1@1@13@@@@@1@2;6;30;46@@@@@1@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>24@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>24@24@1@10@@@@@1@2;6;32;40@@@@@size=35@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>24@34@1@35@@@@@1@@@@@@Разрешен ли пустой пароль пользователя@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>24@69@1@9@@@@@1@2;6;32;40@@@@@EmpPASS@</Data>
</Node>
</Node>
<Node><Sub>25</Sub>
<Node><Sub>1</Sub>
<Data>25@1@1@13@@@@@1@2;6;35;40@@@@@ГЦ АСУ ГКВВ МВД России@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>25@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>25@24@1@10@@@@@1@2;6;32;40@@@@@size=32@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>25@34@1@35@@@@@1@2;6;33;40@@@@@Конечный пользователь@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>25@69@1@9@@@@@1@2;6;32;40@@@@@ENDUSER@</Data>
</Node>
</Node>
<Node><Sub>26</Sub>
<Node><Sub>1</Sub>
<Data>26@1@1@13@@@@@1@2;6;35;40@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>26@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>26@24@1@10@@@@@1@2;6;32;40@@@@@size=32@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>26@34@1@35@@@@@1@2;6;33;40@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>26@69@1@9@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>59397,66776,SSS1</Data>
</Node>
<Node><Sub>OPT</Sub>
<Data>1</Data>
<Node><Sub>LST</Sub>
<Data>59397,66776,SSS1</Data>
<Node><Sub>B4I</Sub>
<Data>4</Data>
</Node>
<Node><Sub>CFG26</Sub>
<Data>26</Data>
</Node>
<Node><Sub>CFG7</Sub>
<Data>7</Data>
</Node>
<Node><Sub>COS</Sub>
<Data>17</Data>
</Node>
<Node><Sub>Commerce</Sub>
<Data>11</Data>
</Node>
<Node><Sub>Conc</Sub>
<Data>13</Data>
</Node>
<Node><Sub>CurCSS</Sub>
<Data>10</Data>
</Node>
<Node><Sub>CurNSP</Sub>
<Data>9</Data>
</Node>
<Node><Sub>ENDUSER</Sub>
<Data>25</Data>
</Node>
<Node><Sub>EditTab1</Sub>
<Data>21</Data>
</Node>
<Node><Sub>EmpPASS</Sub>
<Data>24</Data>
</Node>
<Node><Sub>HTM</Sub>
<Data>18</Data>
</Node>
<Node><Sub>IP</Sub>
<Data>3</Data>
</Node>
<Node><Sub>ImportODBC</Sub>
<Data>19</Data>
</Node>
<Node><Sub>ImportTXT</Sub>
<Data>20</Data>
</Node>
<Node><Sub>MultiL</Sub>
<Data>12</Data>
</Node>
<Node><Sub>NWO1</Sub>
<Data>23</Data>
</Node>
<Node><Sub>NWT1</Sub>
<Data>22</Data>
</Node>
<Node><Sub>Tariff</Sub>
<Data>5</Data>
</Node>
<Node><Sub>TempDir2</Sub>
<Data>8</Data>
</Node>
<Node><Sub>Vers</Sub>
<Data>6</Data>
</Node>
<Node><Sub>WebEditDT</Sub>
<Data>15</Data>
</Node>
<Node><Sub>WebEditRou</Sub>
<Data>14</Data>
</Node>
<Node><Sub>WebInfoSess</Sub>
<Data>16</Data>
</Node>
</Node>
</Node>
<Node><Sub>STA</Sub>
<Data>4,5@4@1@13@-1@-1@2@69@B4I</Data>
</Node>
</Node>
<Node><Sub>CFGSSS</Sub>
<Data>Основные Опции Комплекса@@@@@1@1@1@1@22@80@1@@1@1@@1@@2,1@1@@@@@@@@26@5@@1;6;35;44@@@@@@</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@13@@@@@1@2;6;35;40@@@@@ Value (DFLT)</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@14@1@10@@@@@1@2;6;30;41@@@@@ Type@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>1@24@1@10@@@@@1@2;6;30;41@@@@@Atribute@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>1@34@1@35@@@@@1@2;6;33;40@@@@@ ОПИСАНИЕ@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>1@69@1@9@@@@@1@2;6;30;41@@@@@ name@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@13@@@@@1@2;6;30;43@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>2@14@1@10@@@@@1@2;6;30;43@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>2@24@1@10@@@@@1@2;6;30;43@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>2@34@1@35@@@@@1@2;6;30;43@@@@@ Основные Опции Комплекса@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>2@69@1@9@@@@@1@2;6;30;43@@@@@@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@13@@@@@1@2;6;35;40@@@@@Информационный портал@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>3@24@1@10@@@@@1@2;6;32;40@@@@@size=30@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>3@34@1@35@@@@@1@2;6;33;40@@@@@Наименование портала@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>3@69@1@9@@@@@1@2;6;32;40@@@@@IP@</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>4@1@1@13@@@@@1@2;6;35;40@@@@@ИнРеМи@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>4@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>4@24@1@10@@@@@1@2;6;32;40@@@@@size=30@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>4@34@1@35@@@@@1@2;6;33;40@@@@@Название комплекса@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>4@69@1@9@@@@@1@2;6;32;40@@@@@B4I@</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>5@1@1@13@@@@@1@2;6;35;40@@@@@1@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>5@14@1@10@@@@@1@2;6;32;40@@@@@radio@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>5@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data><![CDATA[5@34@1@35@@@@@1@2;6;33;40@@@@@ТАРИФ ПО-УМОЛЧАНИЮ: ТЕСТОВЫЙ~ --//-- ЭКОНОМНЫЙ~ --//-- СТАНДАРТНЫЙ~ --//-- ПРОФЕССИОНАЛЬНЫЙ@]]></Data>
</Node>
<Node><Sub>5</Sub>
<Data>5@69@1@9@@@@@1@2;6;32;40@@@@@Tariff@</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>6@1@1@13@@@@@1@2;6;35;40@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>6@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>6@24@1@10@@@@@1@2;6;32;40@@@@@size=30@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>6@34@1@35@@@@@1@2;6;33;40@@@@@Копирайт и Номер версии комплекса@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>6@69@1@9@@@@@1@2;6;32;40@@@@@Vers@</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>7@1@1@13@@@@@1@2;6;35;40@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>7@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>7@24@1@10@@@@@1@2;6;32;40@@@@@size=30@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>7@34@1@35@@@@@1@2;6;33;40@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>7@69@1@9@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>1</Sub>
<Data>8@1@1@13@@@@@1@2;6;35;40@@@@@c:/infoportal/snx/@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>8@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>8@24@1@10@@@@@1@2;6;32;40@@@@@size=30@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>8@34@1@35@@@@@1@2;6;33;40@@@@@каталог временных файлов для записи@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>8@69@1@9@@@@@1@2;6;32;40@@@@@TempDir2@</Data>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>1</Sub>
<Data>9@1@1@13@@@@@1@2;6;35;40@@@@@SSS@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>9@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>9@24@1@10@@@@@1@2;6;32;40@@@@@size=30@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>9@34@1@35@@@@@1@2;6;33;40@@@@@Текущая рабочая область для новых клиентов@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>9@69@1@9@@@@@1@2;6;32;40@@@@@CurNSP@</Data>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>1</Sub>
<Data>10@1@1@13@@@@@1@2;6;35;40@@@@@CREAM@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>10@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>10@24@1@10@@@@@1@2;6;32;40@@@@@size=30@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>10@34@1@35@@@@@1@2;6;33;40@@@@@Текущий стиль@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>10@69@1@9@@@@@1@2;6;32;40@@@@@CurCSS@</Data>
</Node>
</Node>
<Node><Sub>11</Sub>
<Node><Sub>1</Sub>
<Data>11@1@1@13@@@@@1@2;6;35;40@@@@@2@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>11@14@1@10@@@@@1@2;6;32;40@@@@@radio@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>11@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>11@34@1@35@@@@@1@2;6;33;40@@@@@Портал тарифицируется~не тарифицируется@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>11@69@1@9@@@@@1@2;6;32;40@@@@@Commerce@</Data>
</Node>
</Node>
<Node><Sub>12</Sub>
<Node><Sub>1</Sub>
<Data>12@1@1@13@@@@@1@2;6;35;40@@@@@0</Data>
</Node>
<Node><Sub>2</Sub>
<Data>12@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>12@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>12@34@1@35@@@@@1@2;6;33;40@@@@@Мультиязычность@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>12@69@1@9@@@@@1@2;6;32;40@@@@@MultiL@</Data>
</Node>
</Node>
<Node><Sub>13</Sub>
<Node><Sub>1</Sub>
<Data>13@1@1@13@@@@@1@2;6;35;40@@@@@0</Data>
</Node>
<Node><Sub>2</Sub>
<Data>13@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>13@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>13@34@1@35@@@@@1@2;6;33;40@@@@@Конкурсы проектов@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>13@69@1@9@@@@@1@2;6;32;40@@@@@Conc@</Data>
</Node>
</Node>
<Node><Sub>14</Sub>
<Node><Sub>1</Sub>
<Data>14@1@1@13@@@@@1@2;6;35;40@@@@@1</Data>
</Node>
<Node><Sub>2</Sub>
<Data>14@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>14@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>14@34@1@35@@@@@1@2;6;33;40@@@@@Включен WEB редактор программ COS@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>14@69@1@9@@@@@1@2;6;32;40@@@@@WebEditRou@</Data>
</Node>
</Node>
<Node><Sub>15</Sub>
<Node><Sub>1</Sub>
<Data>15@1@1@13@@@@@1@2;6;35;40@@@@@1</Data>
</Node>
<Node><Sub>2</Sub>
<Data>15@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>15@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>15@34@1@35@@@@@1@2;6;33;40@@@@@Включен WEB редактор данных таблиц@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>15@69@1@9@@@@@1@2;6;32;40@@@@@WebEditDT@</Data>
</Node>
</Node>
<Node><Sub>16</Sub>
<Node><Sub>1</Sub>
<Data>16@1@1@13@@@@@1@2;6;35;40@@@@@1</Data>
</Node>
<Node><Sub>2</Sub>
<Data>16@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>16@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>16@34@1@35@@@@@1@2;6;33;40@@@@@Разрешен вывод информации о сессии и системе@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>16@69@1@9@@@@@1@2;6;32;40@@@@@WebInfoSess@</Data>
</Node>
</Node>
<Node><Sub>17</Sub>
<Node><Sub>1</Sub>
<Data>17@1@1@13@@@@@1@2;6;35;40@@@@@cols=68 rows=5@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>17@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>17@24@1@10@@@@@1@2;6;32;40@@@@@size=32@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>17@34@1@35@@@@@1@2;6;33;40@@@@@Параметры TEXTAREA для кода COS@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>17@69@1@9@@@@@1@2;6;32;40@@@@@COS@</Data>
</Node>
</Node>
<Node><Sub>18</Sub>
<Node><Sub>1</Sub>
<Data>18@1@1@13@@@@@1@2;6;35;40@@@@@cols=68 rows=5@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>18@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>18@24@1@10@@@@@1@2;6;32;40@@@@@size=32@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>18@34@1@35@@@@@1@2;6;33;40@@@@@Параметры TEXTAREA для HTML@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>18@69@1@9@@@@@1@2;6;32;40@@@@@HTM@</Data>
</Node>
</Node>
<Node><Sub>19</Sub>
<Node><Sub>1</Sub>
<Data>19@1@1@13@@@@@1@2;6;30;46@@@@@1@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>19@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>19@24@1@10@@@@@1@2;6;32;40@@@@@size=35@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>19@34@1@35@@@@@1@@@@@@Разрешена ли работа с ODBC@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>19@69@1@9@@@@@1@2;6;32;40@@@@@ImportODBC@</Data>
</Node>
</Node>
<Node><Sub>20</Sub>
<Node><Sub>1</Sub>
<Data>20@1@1@13@@@@@1@2;6;30;46@@@@@1@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>20@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>20@24@1@10@@@@@1@2;6;32;40@@@@@size=35@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>20@34@1@35@@@@@1@@@@@@Разрешен ли импорт из Текстового файла@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>20@69@1@9@@@@@1@2;6;32;40@@@@@ImportTXT@</Data>
</Node>
</Node>
<Node><Sub>21</Sub>
<Node><Sub>1</Sub>
<Data>21@1@1@13@@@@@1@2;6;35;40@@@@@0</Data>
</Node>
<Node><Sub>2</Sub>
<Data>21@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>21@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data><![CDATA[21@34@1@35@@@@@1@2;6;33;40@@@@@Редактор системных таблиц (DICT,PIN,PROTECT,SESSIONS,TARIFF) выводить в одном окне@]]></Data>
</Node>
<Node><Sub>5</Sub>
<Data>21@69@1@9@@@@@1@2;6;32;40@@@@@EditTab1@</Data>
</Node>
</Node>
<Node><Sub>22</Sub>
<Node><Sub>1</Sub>
<Data>22@1@1@13@@@@@1@2;6;35;40@@@@@width=800,height=600@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>22@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>22@24@1@10@@@@@1@2;6;32;40@@@@@size=32@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>22@34@1@35@@@@@1@2;6;33;40@@@@@Размеры нового окна для редактора данных таблиц@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>22@69@1@9@@@@@1@2;6;32;40@@@@@NWT1@</Data>
</Node>
</Node>
<Node><Sub>23</Sub>
<Node><Sub>1</Sub>
<Data>23@1@1@13@@@@@1@2;6;35;40@@@@@width=800,height=600@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>23@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>23@24@1@10@@@@@1@2;6;32;40@@@@@size=32@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>23@34@1@35@@@@@1@2;6;33;40@@@@@Размеры нового окна для редактора Опций@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>23@69@1@9@@@@@1@2;6;32;40@@@@@NWO1@</Data>
</Node>
</Node>
<Node><Sub>24</Sub>
<Node><Sub>1</Sub>
<Data>24@1@1@13@@@@@1@2;6;30;46@@@@@1@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>24@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>24@24@1@10@@@@@1@2;6;32;40@@@@@size=35@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>24@34@1@35@@@@@1@@@@@@Разрешен ли пустой пароль пользователя@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>24@69@1@9@@@@@1@2;6;32;40@@@@@EmpPASS@</Data>
</Node>
</Node>
<Node><Sub>25</Sub>
<Node><Sub>1</Sub>
<Data>25@1@1@13@@@@@1@2;6;35;40@@@@@ССС &amp; MSW@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>25@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>25@24@1@10@@@@@1@2;6;32;40@@@@@size=32@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>25@34@1@35@@@@@1@2;6;33;40@@@@@Конечный пользователь@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>25@69@1@9@@@@@1@2;6;32;40@@@@@ENDUSER@</Data>
</Node>
</Node>
<Node><Sub>26</Sub>
<Node><Sub>1</Sub>
<Data>26@1@1@13@@@@@1@2;6;35;40@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>26@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>26@24@1@10@@@@@1@2;6;32;40@@@@@size=32@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>26@34@1@35@@@@@1@2;6;33;40@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>26@69@1@9@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>59397,66776,SSS1</Data>
</Node>
<Node><Sub>OPT</Sub>
<Data>1</Data>
<Node><Sub>LST</Sub>
<Data>59397,66776,SSS1</Data>
<Node><Sub>B4I</Sub>
<Data>4</Data>
</Node>
<Node><Sub>CFG26</Sub>
<Data>26</Data>
</Node>
<Node><Sub>CFG7</Sub>
<Data>7</Data>
</Node>
<Node><Sub>COS</Sub>
<Data>17</Data>
</Node>
<Node><Sub>Commerce</Sub>
<Data>11</Data>
</Node>
<Node><Sub>Conc</Sub>
<Data>13</Data>
</Node>
<Node><Sub>CurCSS</Sub>
<Data>10</Data>
</Node>
<Node><Sub>CurNSP</Sub>
<Data>9</Data>
</Node>
<Node><Sub>ENDUSER</Sub>
<Data>25</Data>
</Node>
<Node><Sub>EditTab1</Sub>
<Data>21</Data>
</Node>
<Node><Sub>EmpPASS</Sub>
<Data>24</Data>
</Node>
<Node><Sub>HTM</Sub>
<Data>18</Data>
</Node>
<Node><Sub>IP</Sub>
<Data>3</Data>
</Node>
<Node><Sub>ImportODBC</Sub>
<Data>19</Data>
</Node>
<Node><Sub>ImportTXT</Sub>
<Data>20</Data>
</Node>
<Node><Sub>MultiL</Sub>
<Data>12</Data>
</Node>
<Node><Sub>NWO1</Sub>
<Data>23</Data>
</Node>
<Node><Sub>NWT1</Sub>
<Data>22</Data>
</Node>
<Node><Sub>Tariff</Sub>
<Data>5</Data>
</Node>
<Node><Sub>TempDir2</Sub>
<Data>8</Data>
</Node>
<Node><Sub>Vers</Sub>
<Data>6</Data>
</Node>
<Node><Sub>WebEditDT</Sub>
<Data>15</Data>
</Node>
<Node><Sub>WebEditRou</Sub>
<Data>14</Data>
</Node>
<Node><Sub>WebInfoSess</Sub>
<Data>16</Data>
</Node>
</Node>
</Node>
<Node><Sub>STA</Sub>
<Data>26,1@6@1@13@-1@-1@22@1@</Data>
</Node>
</Node>
<Node><Sub>COLOR</Sub>
<Data>ЦВЕТОВАЯ ПАЛИТРА %BS@@@@@1@1@2@20@14@50@1@@1@@@1@@2,2@@@@@@@@@13@2@@2;6;30;45@@@@@@@2</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@25@@@@@1@2;6;30;45@@@@@  УСТАНОВКА ЦВЕТОВ КОМПЛЕ</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@26@1@6@@@@@1@2;6;30;45@@@@@КСА</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@25@@@@@1@@@@@@ УКЗАТ.НА ПОМЕЧ.КЛЕТКЕ...</Data>
</Node>
<Node><Sub>2</Sub>
<Data>2@26@1@6@@@@0@1@@@@@2,2@2;6;31;47</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@25@@@@@1@@@@@@ УКАЗАТЕЛЬ ТЕКУЩ.КЛЕТКИ..</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@26@1@6@@@@2,2@1@@@@@3,2@2;6;34;47</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>4@1@1@25@@@@@1@@@@@@ ЦВЕТ ПОМЕЧЕННОЙ КЛЕТКИ . БЛОКА.</Data>
</Node>
<Node><Sub>2</Sub>
<Data>4@26@1@6@@@@2,2@1@@@@@4,2@2;6;37;41</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>5@1@1@25@@@@@1@@@@@@ - ЗАГОЛОВОК КАТАЛОГОВ...</Data>
</Node>
<Node><Sub>2</Sub>
<Data>5@26@1@6@@@@2,2@1@@@@@5,2@2;6;33;45</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>6@1@1@25@@@@@1@@@@@@ - ТЕКСТ КАТАЛОГОВ.......@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>6@26@1@6@@@@2,2@1@@@@@6,2@2;6;30;46@</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>7@1@1@25@@@@@1@@@@@@ - РАМКА ПАНЕЛИ СООБЩЕНИЯ</Data>
</Node>
<Node><Sub>2</Sub>
<Data>7@26@1@6@@@@2,2@1@@@@@7,2@2;6;36;44</Data>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>1</Sub>
<Data>8@1@1@25@@@@@1@@@@@@ - ТЕКСТ ПАНЕЛИ СООБЩЕНИЯ</Data>
</Node>
<Node><Sub>2</Sub>
<Data>8@26@1@6@@@@2,2@1@@@@@8,2@2;6;33;44</Data>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>1</Sub>
<Data>9@1@1@25@@@@@1@@@@@@ - ОСНОВНОЙ ФОН &quot;MEНЮ&quot;...@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>9@26@1@6@@@@2,2@1@@@@@9,2@2;6;32;40@</Data>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>1</Sub>
<Data>10@1@1@25@@@@@1@@@@@@ - ЗАСВЕТКА ПУНКТА &quot;МЕНЮ&quot;@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>10@26@1@6@@@@2,2@1@@@@@10,2@2;6;33;41@</Data>
</Node>
</Node>
<Node><Sub>11</Sub>
<Node><Sub>1</Sub>
<Data>11@1@1@25@@@@@1@@@@@@ - РАМКА ПАНЕЛИ ОШИБКИ ..@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>11@26@1@6@@@@2,2@1@@@@@11,2@2;6;36;41@</Data>
</Node>
</Node>
<Node><Sub>12</Sub>
<Node><Sub>1</Sub>
<Data>12@1@1@25@@@@@1@@@@@@ - ТЕКСТ ПАНЕЛИ ОШИБКИ ..@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>12@26@1@6@@@@2,2@1@@@@@12,2@2;6;37;41@</Data>
</Node>
</Node>
<Node><Sub>13</Sub>
<Node><Sub>1</Sub>
<Data>13@1@1@25@@@@@1@@@@@@ СООБЩЕНИЕ О ТЕК.ДЕЙСТВИИ@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>13@26@1@6@@@@2,2@1@@@@@13,2@2;6;33;40@</Data>
</Node>
</Node>
<Node><Sub>CMD</Sub>
<Node><Sub>2</Sub>
<Node><Sub>2</Sub>
<Data>S li=$$Color^%ZAPM.ed.BSF1(d)</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>2</Sub>
<Data>S li=$$Color^%ZAPM.ed.BSF1(d)</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>2</Sub>
<Data>S li=$$Color^%ZAPM.ed.BSF1(d)</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>2</Sub>
<Data>S li=$$Color^%ZAPM.ed.BSF1(d)</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>2</Sub>
<Data>S li=$$Color^%ZAPM.ed.BSF1(d)</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>2</Sub>
<Data>S li=$$Color^%ZAPM.ed.BSF1(d)</Data>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>2</Sub>
<Data>S li=$$Color^%ZAPM.ed.BSF1(d)</Data>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>2</Sub>
<Data>S li=$$Color^%ZAPM.ed.BSF1(d)</Data>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>2</Sub>
<Data>S li=$$Color^%ZAPM.ed.BSF1(d)</Data>
</Node>
</Node>
<Node><Sub>11</Sub>
<Node><Sub>2</Sub>
<Data>S li=$$Color^%ZAPM.ed.BSF1(d)</Data>
</Node>
</Node>
<Node><Sub>12</Sub>
<Node><Sub>2</Sub>
<Data>S li=$$Color^%ZAPM.ed.BSF1(d)</Data>
</Node>
</Node>
<Node><Sub>13</Sub>
<Node><Sub>2</Sub>
<Data>S li=$$Color^%ZAPM.ed.BSF1(d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>FTR</Sub>
<Node><Sub>2</Sub>
<Node><Sub>2</Sub>
<Data><![CDATA[S d1="%COLOR" I $$COLOR^%ZAPM.ed.BSsFUNM(d)!($D(MR)) W /CUP(15,25),$$atr^%ZAPM.ed.BS3(CLR)," Выбирите нужный цвет ",$$atr^%ZAPM.ed.BS3($S('MR:CLR,1:$P(%BS,"!",$S($P(BS,"@",12):1,1:2))))]]></Data>
<Node><Sub>1</Sub>
<Data><![CDATA["%COLOR" I $$COLOR(d)!($D(MR)) W /CUP(15,25),$$atr^%ZAPM.ed.BS3(CLR)," Выбирите нужный цвет ",$$atr^%ZAPM.ed.BS3($S('MR:CLR,1:$P(%BS,"!",$S($P(BS,"@",12):1,1:2))))]]></Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>57772,35420,</Data>
</Node>
<Node><Sub>STA</Sub>
<Data>4,2@2@2@27@-1@-1@5@45@2;6;37;41</Data>
</Node>
</Node>
<Node><Sub>ISS</Sub>
<Data>BSD - MSW@^BSC4.ISS@Setup</Data>
<Node><Sub>0</Sub>
<Data>59234,33176,B4I,1</Data>
<Node><Sub>O</Sub>
<Data>Общесистемные параметры</Data>
</Node>
<Node><Sub>T</Sub>
<Data>HR</Data>
</Node>
</Node>
<Node><Sub>0sys</Sub>
<Data>59234,33282,B4I,1</Data>
<Node><Sub>D</Sub>
<Data>IVCM</Data>
</Node>
<Node><Sub>O</Sub>
<Data>Идентификатор системы</Data>
</Node>
<Node><Sub>T</Sub>
<Data>0</Data>
</Node>
<Node><Sub>V</Sub>
<Data>IVCM</Data>
</Node>
</Node>
<Node><Sub>Acfg</Sub>
<Node><Sub>V</Sub>
<Data>^BSETUP(&quot;CFG&quot;)</Data>
</Node>
</Node>
<Node><Sub>Addms</Sub>
<Node><Sub>V</Sub>
<Data>2</Data>
</Node>
</Node>
<Node><Sub>Admin</Sub>
<Node><Sub>V</Sub>
<Data>Аdministrator &lt;B4I@ku-w2003sp2-&gt;тел.911;)</Data>
</Node>
</Node>
<Node><Sub>Aevlog</Sub>
<Node><Sub>V</Sub>
<Data>1</Data>
</Node>
</Node>
<Node><Sub>Aevlog1</Sub>
<Node><Sub>V</Sub>
<Data>1</Data>
</Node>
</Node>
<Node><Sub>Aevlogmail</Sub>
<Node><Sub>V</Sub>
<Data>1</Data>
</Node>
</Node>
<Node><Sub>Aft</Sub>
<Node><Sub>V</Sub>
<Data>1</Data>
</Node>
</Node>
<Node><Sub>Aftp</Sub>
<Node><Sub>V</Sub>
<Data>D:/InfoPortal/bin/msw.bat</Data>
</Node>
</Node>
<Node><Sub>AftpPort</Sub>
<Node><Sub>V</Sub>
<Data>22</Data>
</Node>
</Node>
<Node><Sub>Aftpsinx</Sub>
<Node><Sub>V</Sub>
<Data>ftp://sinxron:snx@serv-dev:22</Data>
</Node>
</Node>
<Node><Sub>Aftpsnx</Sub>
<Node><Sub>V</Sub>
<Data>sinxron:snx@ivcmsw:22</Data>
</Node>
</Node>
<Node><Sub>Asys</Sub>
<Node><Sub>V</Sub>
<Data>SERVER_CACHE</Data>
</Node>
</Node>
<Node><Sub>AsysActivX</Sub>
<Node><Sub>V</Sub>
<Data>2</Data>
</Node>
</Node>
<Node><Sub>AsysEInoActivX</Sub>
<Node><Sub>V</Sub>
<Data>0</Data>
</Node>
</Node>
<Node><Sub>AsysTerm</Sub>
<Node><Sub>V</Sub>
<Data>1</Data>
</Node>
</Node>
<Node><Sub>AsysWakka</Sub>
<Node><Sub>V</Sub>
<Data>User</Data>
</Node>
</Node>
<Node><Sub>Atkmail</Sub>
<Node><Sub>V</Sub>
<Data>1965,1960</Data>
</Node>
</Node>
<Node><Sub>Atkweb</Sub>
<Node><Sub>V</Sub>
<Data>1962</Data>
</Node>
</Node>
<Node><Sub>AtopSecret</Sub>
<Node><Sub>V</Sub>
<Data>0</Data>
</Node>
</Node>
<Node><Sub>a</Sub>
<Data>59161,63054,MSW,1,59161,63054</Data>
<Node><Sub>O</Sub>
<Data>ODBC-доступ к базам данных </Data>
</Node>
<Node><Sub>T</Sub>
<Data>HR</Data>
</Node>
</Node>
<Node><Sub>aIDSN</Sub>
<Data>59161,63048,MSW,1,59161,63048</Data>
<Node><Sub>D</Sub>
<Data>issbase</Data>
</Node>
<Node><Sub>O</Sub>
<Data>имя-DSN ODBC-доступа к базе данных администрирования ИСС (n:/issbase/Katalog_da.mdb)</Data>
</Node>
<Node><Sub>T</Sub>
<Data>0</Data>
</Node>
<Node><Sub>V</Sub>
<Data>issbase</Data>
</Node>
</Node>
<Node><Sub>aKSP</Sub>
<Data>59220,32293,B4I,1</Data>
<Node><Sub>D</Sub>
<Data>KSP</Data>
</Node>
<Node><Sub>O</Sub>
<Data>имя-DSN ODBC-доступа к таблицам структуры ВВ (U:/dsn/LAST/*.dbf)</Data>
</Node>
<Node><Sub>T</Sub>
<Data>0</Data>
</Node>
<Node><Sub>V</Sub>
<Data>KSP</Data>
</Node>
</Node>
<Node><Sub>aKSP1</Sub>
<Node><Sub>V</Sub>
<Data>KSP</Data>
</Node>
</Node>
<Node><Sub>aSTRVV</Sub>
<Data>59161,63064,MSW,1,59161,63064</Data>
<Node><Sub>D</Sub>
<Data>SH1</Data>
</Node>
<Node><Sub>O</Sub>
<Data>имя-DSN ODBC-доступа к базе данных штатов ВВ (U:/dsn/PDOX/InfShtat/*.db)</Data>
</Node>
<Node><Sub>T</Sub>
<Data>0</Data>
</Node>
<Node><Sub>V</Sub>
<Data>SH1</Data>
</Node>
</Node>
<Node><Sub>b</Sub>
<Data>59220,34860,B4I,1</Data>
<Node><Sub>O</Sub>
<Data>Пути устанавливаемые при инсталляции</Data>
</Node>
<Node><Sub>T</Sub>
<Data>HR</Data>
</Node>
</Node>
<Node><Sub>bA</Sub>
<Node><Sub>V</Sub>
<Data>D:/InfoPortal/</Data>
</Node>
</Node>
<Node><Sub>bBEE</Sub>
<Node><Sub>V</Sub>
<Data>D:/InfoPortal/WebNodes/vv/findbee/</Data>
</Node>
</Node>
<Node><Sub>bBIN</Sub>
<Node><Sub>V</Sub>
<Data>D:/InfoPortal/Bin</Data>
</Node>
</Node>
<Node><Sub>bBOOKS</Sub>
<Node><Sub>V</Sub>
<Data>D:/InfoPortal/WebNodes/vv/files/books/</Data>
</Node>
</Node>
<Node><Sub>bBOOKSdvd</Sub>
<Node><Sub>V</Sub>
<Data>http://Infoserv/vv/files/Content/Index.htm</Data>
</Node>
</Node>
<Node><Sub>bBSDSR</Sub>
<Node><Sub>V</Sub>
<Data>D:/ROU/BSNEW/</Data>
</Node>
</Node>
<Node><Sub>bBSDSRA</Sub>
<Node><Sub>V</Sub>
<Data>L:/MSW_Tools/_installation/soft/bssetup/</Data>
</Node>
</Node>
<Node><Sub>bEXZ</Sub>
<Data>59161,63009,MSW,1,59161,63009</Data>
<Node><Sub>D</Sub>
<Data>d:/MSW/VV/exz/</Data>
</Node>
<Node><Sub>O</Sub>
<Data>путь к файлам StreamFile таблицы ПК (ЭКЗАМЕНАТОР) (^[^[&quot;GLAVK&quot;]]]]]]]]]EXB(EXAM)</Data>
</Node>
<Node><Sub>T</Sub>
<Data>0</Data>
</Node>
<Node><Sub>V</Sub>
<Data>D:/InfoPortal/WebNodes/vv/exz/</Data>
</Node>
</Node>
<Node><Sub>bI</Sub>
<Data>59161,63022,MSW,1,59161,63022</Data>
<Node><Sub>D</Sub>
<Data>d:/i/</Data>
</Node>
<Node><Sub>O</Sub>
<Data>путь к файлам HTM грантам ИСС</Data>
</Node>
<Node><Sub>T</Sub>
<Data>0</Data>
</Node>
<Node><Sub>V</Sub>
<Data>D:/InfoPortal/i/</Data>
</Node>
</Node>
<Node><Sub>bI1</Sub>
<Node><Sub>V</Sub>
<Data>//infoserv/map_full/</Data>
</Node>
</Node>
<Node><Sub>bKT</Sub>
<Node><Sub>V</Sub>
<Data>http://serv-dev/vv/KT/index.html</Data>
</Node>
</Node>
<Node><Sub>bMON</Sub>
<Node><Sub>V</Sub>
<Data>D:/InfoPortal/WebNodes/vv/Streams/UFD/</Data>
</Node>
</Node>
<Node><Sub>bMON1</Sub>
<Node><Sub>V</Sub>
<Data>/vv/Streams/UFD</Data>
</Node>
</Node>
<Node><Sub>bReport</Sub>
<Data>59220,33696,B4I,1</Data>
<Node><Sub>D</Sub>
<Data>U:/Report/</Data>
</Node>
<Node><Sub>O</Sub>
<Data>путь к файлам ОТЧЕТОВ ИСС</Data>
</Node>
<Node><Sub>T</Sub>
<Data>0</Data>
</Node>
<Node><Sub>V</Sub>
<Data>U:/Report/</Data>
</Node>
</Node>
<Node><Sub>bSTRVV</Sub>
<Data>59161,63033,MSW,1,59161,63033</Data>
<Node><Sub>D</Sub>
<Data>d:/MSW/VV/STRUCT/</Data>
</Node>
<Node><Sub>O</Sub>
<Data>путь к файлам StreamFile таблицы структуры войск (^[^[&quot;GLAVK&quot;]]]]]]]]]MSM.STRVV.SVV)</Data>
</Node>
<Node><Sub>T</Sub>
<Data>0</Data>
</Node>
<Node><Sub>V</Sub>
<Data>D:/InfoPortal/WebNodes/vv/STRUCT/</Data>
</Node>
</Node>
<Node><Sub>bSTRVV1</Sub>
<Data>59220,32664,B4I,1</Data>
<Node><Sub>D</Sub>
<Data>d:/MSW/VV/STRUCT/</Data>
</Node>
<Node><Sub>O</Sub>
<Data>путь к файлам структуры войск (старый вариант)</Data>
</Node>
<Node><Sub>T</Sub>
<Data>0</Data>
</Node>
<Node><Sub>V</Sub>
<Data>d:/MSW/VV/STRUCT/</Data>
</Node>
</Node>
<Node><Sub>bSTRVVGO</Sub>
<Node><Sub>V</Sub>
<Data>N:/WebNodes/VV/STRUCT/indx/</Data>
</Node>
</Node>
<Node><Sub>bSTRVVGO1</Sub>
<Node><Sub>V</Sub>
<Data>/vv/STRUCT/indx/</Data>
</Node>
</Node>
<Node><Sub>bb4y</Sub>
<Data>59220,33331,B4I,1</Data>
<Node><Sub>D</Sub>
<Data>U:/b4y/</Data>
</Node>
<Node><Sub>O</Sub>
<Data>путь к файлам ПОРТАЛА</Data>
</Node>
<Node><Sub>T</Sub>
<Data>0</Data>
</Node>
<Node><Sub>V</Sub>
<Data>D:/InfoPortal/WebNodes/b4y/</Data>
</Node>
</Node>
<Node><Sub>bb4y1</Sub>
<Data>59220,37704,B4I,1</Data>
<Node><Sub>D</Sub>
<Data>/b4y/</Data>
</Node>
<Node><Sub>O</Sub>
<Data>путь к виртуальному каталогу  ПОРТАЛА</Data>
</Node>
<Node><Sub>T</Sub>
<Data>0</Data>
</Node>
<Node><Sub>V</Sub>
<Data>/b4y</Data>
</Node>
</Node>
<Node><Sub>bbp</Sub>
<Data>59220,33283,B4I,1</Data>
<Node><Sub>D</Sub>
<Data>U:/VV/bp/</Data>
</Node>
<Node><Sub>O</Sub>
<Data>путь к файлам БОЕВЫХ ПОТЕРЬ</Data>
</Node>
<Node><Sub>T</Sub>
<Data>0</Data>
</Node>
<Node><Sub>V</Sub>
<Data>D:/InfoPortal/WebNodes/vv/bp/</Data>
</Node>
</Node>
<Node><Sub>biss</Sub>
<Data>59220,33215,B4I,1</Data>
<Node><Sub>D</Sub>
<Data>u:/iss/</Data>
</Node>
<Node><Sub>O</Sub>
<Data>путь к файлам ИСС</Data>
</Node>
<Node><Sub>T</Sub>
<Data>0</Data>
</Node>
<Node><Sub>V</Sub>
<Data>D:/InfoPortal/WebNodes/iss/</Data>
</Node>
</Node>
<Node><Sub>biss1</Sub>
<Data>59220,37775,B4I,1</Data>
<Node><Sub>D</Sub>
<Data>/iss/</Data>
</Node>
<Node><Sub>O</Sub>
<Data>путь к виртуальному каталогу   ИСС</Data>
</Node>
<Node><Sub>T</Sub>
<Data>0</Data>
</Node>
<Node><Sub>V</Sub>
<Data>/iss/</Data>
</Node>
</Node>
<Node><Sub>bphone</Sub>
<Data>59220,33270,B4I,1</Data>
<Node><Sub>D</Sub>
<Data>U:/VV/phone/</Data>
</Node>
<Node><Sub>O</Sub>
<Data>путь к файлам ВИРТУАЛЬНОГО ГЛАВКОМАТА</Data>
</Node>
<Node><Sub>T</Sub>
<Data>0</Data>
</Node>
<Node><Sub>V</Sub>
<Data>D:/InfoPortal/WebNodes/vv/phone/</Data>
</Node>
</Node>
<Node><Sub>brtgkvv</Sub>
<Data>59220,33237,B4I,1</Data>
<Node><Sub>D</Sub>
<Data>u:/VV/rtgkvv/</Data>
</Node>
<Node><Sub>O</Sub>
<Data>путь к файлам тетради ГКВВ</Data>
</Node>
<Node><Sub>T</Sub>
<Data>0</Data>
</Node>
<Node><Sub>V</Sub>
<Data>D:/InfoPortal/WebNodes/vv/rtgkvv/</Data>
</Node>
</Node>
<Node><Sub>bzOUTtables</Sub>
<Node><Sub>V</Sub>
<Data>D:/InfoPortal/WebNodes/VV/u/REPORT/f2-files/</Data>
</Node>
</Node>
<Node><Sub>bzakon</Sub>
<Data>59220,33260,B4I,1</Data>
<Node><Sub>D</Sub>
<Data>u:/VV/zakon/</Data>
</Node>
<Node><Sub>O</Sub>
<Data>путь к файлам законов</Data>
</Node>
<Node><Sub>T</Sub>
<Data>0</Data>
</Node>
<Node><Sub>V</Sub>
<Data>D:/InfoPortal/WebNodes/vv/zakon/</Data>
</Node>
</Node>
<Node><Sub>c</Sub>
<Data>59220,34847,B4I,1</Data>
<Node><Sub>O</Sub>
<Data>Пути к файлам Баз данных Cache`</Data>
</Node>
<Node><Sub>T</Sub>
<Data>HR</Data>
</Node>
</Node>
<Node><Sub>cBsweb</Sub>
<Data>59220,34638,B4I,1</Data>
<Node><Sub>D</Sub>
<Data>n:/Bsweb/</Data>
</Node>
<Node><Sub>O</Sub>
<Data>путь к файлам Баз данных ИСС (Боевые потери, командировки, экзамены, поиск ВЧ, Архивы кадров)</Data>
</Node>
<Node><Sub>T</Sub>
<Data>0</Data>
</Node>
<Node><Sub>V</Sub>
<Data>D:/InfoPortal/CacheBase/BPweb/</Data>
</Node>
</Node>
<Node><Sub>cBsweb1</Sub>
<Data>59220,34725,B4I,1</Data>
<Node><Sub>D</Sub>
<Data>BPWEB</Data>
</Node>
<Node><Sub>O</Sub>
<Data>имя NameSpace для ИСС</Data>
</Node>
<Node><Sub>T</Sub>
<Data>0</Data>
</Node>
<Node><Sub>V</Sub>
<Data>BPWEB</Data>
</Node>
</Node>
<Node><Sub>cglavk</Sub>
<Data>59220,34243,B4I,1</Data>
<Node><Sub>D</Sub>
<Data>n:/glavk/</Data>
</Node>
<Node><Sub>O</Sub>
<Data>путь к файлам Баз данных ТАБЕЛЯ и МОЛНИИ</Data>
</Node>
<Node><Sub>T</Sub>
<Data>0</Data>
</Node>
<Node><Sub>V</Sub>
<Data>D:/InfoPortal/CacheBase/glavk/</Data>
</Node>
</Node>
<Node><Sub>cglavk1</Sub>
<Data>59220,34772,B4I,1</Data>
<Node><Sub>D</Sub>
<Data>GLAVK</Data>
</Node>
<Node><Sub>O</Sub>
<Data>имя NameSpace для ТАБЕЛЯ и МОЛНИИ</Data>
</Node>
<Node><Sub>T</Sub>
<Data>0</Data>
</Node>
<Node><Sub>V</Sub>
<Data>GLAVK</Data>
</Node>
</Node>
<Node><Sub>ckdr</Sub>
<Data>59220,34411,B4I,1</Data>
<Node><Sub>D</Sub>
<Data>n:/kdr/</Data>
</Node>
<Node><Sub>O</Sub>
<Data>путь к файлам Баз данных КАДРЫ</Data>
</Node>
<Node><Sub>T</Sub>
<Data>0</Data>
</Node>
<Node><Sub>V</Sub>
<Data>D:/InfoPortal/CacheBase/kdr/</Data>
</Node>
</Node>
<Node><Sub>ckdr1</Sub>
<Data>59220,34799,B4I,1</Data>
<Node><Sub>D</Sub>
<Data>KDR</Data>
</Node>
<Node><Sub>O</Sub>
<Data>имя NameSpace для Баз данных КАДРЫ</Data>
</Node>
<Node><Sub>T</Sub>
<Data>0</Data>
</Node>
<Node><Sub>V</Sub>
<Data>KDR</Data>
</Node>
</Node>
</Node>
<Node><Sub>MOUNT</Sub>
<Data>СПИСОК МОНТИРУЕМЫХ ТОМОВ@@@@@1@1@3@10@19@68@@1@@@@1@@2,1@@@@@@@@@16@5@@2;6;30;45@@@@@@@2</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@2@18@@@@@1@2;6;30;45@@@@@  Коментарии к    монтируемым базам</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@19@2@24@@@@@1@2;6;30;45@@@@@ DOS-ФАЙЛ для явного ... или имя удаленной сист.</Data>
</Node>
<Node><Sub>3</Sub>
<Data>1@43@2@4@@@@@1@2;6;30;45@@@@@ ИМЯ ТОМ@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>1@47@2@6@@@@@1@2;6;30;45@@@@@ ПРОВЕ РЯТЬ?@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>1@53@2@7@@@@@1@2;6;30;45@@@@@ РАЗДЕ- ЛЯЕМАЯ@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@18@@@@@1@2;6;35;46@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@19@1@24@@@@@1@2;6;30;46@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>3@43@1@4@@@@@1@1;6;34;46@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>3@47@1@6@@@@@1@1;6;34;46@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>3@53@1@7@@@@@1@1;6;34;46@@@@@@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>4@1@1@18@@@@@1@2;6;35;46@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>4@19@1@24@@@@@1@2;6;30;46@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>4@43@1@4@@@@@1@1;6;34;46@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>4@47@1@6@@@@@1@1;6;34;46@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>4@53@1@7@@@@@1@1;6;34;46@@@@@@</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>5@1@1@18@@@@@1@2;6;35;46@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>5@19@1@24@@@@@1@2;6;30;46@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>5@43@1@4@@@@@1@1;6;34;46@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>5@47@1@6@@@@@1@1;6;34;46@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>5@53@1@7@@@@@1@1;6;34;46@@@@@@</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>6@1@1@18@@@@@1@2;6;35;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>6@19@1@24@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>6@43@1@4@@@@@1@1;6;34;46@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>6@47@1@6@@@@@1@1;6;34;46@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>6@53@1@7@@@@@1@1;6;34;46@@@@@@</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>7@1@1@18@@@@@1@2;6;35;46@@@@@---- ЛОКАЛЬНЫЕ ---</Data>
</Node>
<Node><Sub>2</Sub>
<Data>7@19@1@24@@@@@1@2;6;30;46@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>7@43@1@4@@@@@1@1;6;34;46@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>7@47@1@6@@@@@1@1;6;34;46@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>7@53@1@7@@@@@1@1;6;34;46@@@@@@</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>8@1@1@18@@@@@1@2;6;35;46@@@@@СИСТЕМНЫЙ ТОМ</Data>
</Node>
<Node><Sub>2</Sub>
<Data>8@19@1@24@@@@@1@2;6;30;46@@@@@C:\MSM-BASE\base\sys.msm</Data>
</Node>
<Node><Sub>3</Sub>
<Data>8@43@1@4@@@@@1@1;6;34;46@@@@@sys@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>8@47@1@6@@@@@1@1;6;34;46@@@@@N@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>8@53@1@7@@@@@1@1;6;34;46@@@@@Y@</Data>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>1</Sub>
<Data>9@1@1@18@@@@@1@2;6;35;46@@@@@ТАБЕЛЬ ОТЧЕТНОСТИ</Data>
</Node>
<Node><Sub>2</Sub>
<Data>9@19@1@24@@@@@1@2;6;30;46@@@@@C:\MSM-BASE\base\tab.msm</Data>
</Node>
<Node><Sub>3</Sub>
<Data>9@43@1@4@@@@@1@1;6;34;46@@@@@tab@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>9@47@1@6@@@@@1@1;6;34;46@@@@@N@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>9@53@1@7@@@@@1@1;6;34;46@@@@@Y@</Data>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>1</Sub>
<Data>10@1@1@18@@@@@1@2;6;35;46@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>10@19@1@24@@@@@1@2;6;30;46@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>10@43@1@4@@@@@1@1;6;34;46@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>10@47@1@6@@@@@1@1;6;34;46@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>10@53@1@7@@@@@1@1;6;34;46@@@@@@</Data>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>1</Sub>
<Data>11@1@1@18@@@@@1@2;6;35;46@@@@@---- УДАЛЕННЫЕ ---@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>11@19@1@24@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>11@43@1@4@@@@@1@1;6;34;46@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>11@47@1@6@@@@@1@1;6;34;46@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>11@53@1@7@@@@@1@1;6;34;46@@@@@@</Data>
</Node>
</Node>
<Node><Sub>11</Sub>
<Node><Sub>1</Sub>
<Data>12@1@1@18@@@@@1@2;6;35;46@@@@@БАЗА &lt;&lt;&lt;МОЛНИИ&gt;&gt;&gt;@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>12@19@1@24@@@@@1@2;6;30;46@@@@@SRV@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>12@43@1@4@@@@@1@1;6;34;46@@@@@MOL@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>12@47@1@6@@@@@1@1;6;34;46@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>12@53@1@7@@@@@1@1;6;34;46@@@@@@</Data>
</Node>
</Node>
<Node><Sub>12</Sub>
<Node><Sub>1</Sub>
<Data>13@1@1@18@@@@@1@2;6;35;46@@@@@СИСТЕМНЫЙ ТОМ</Data>
</Node>
<Node><Sub>2</Sub>
<Data>13@19@1@24@@@@@1@2;6;30;46@@@@@SRV@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>13@43@1@4@@@@@1@1;6;34;46@@@@@SYS@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>13@47@1@6@@@@@1@1;6;34;46@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>13@53@1@7@@@@@1@1;6;34;46@@@@@@</Data>
</Node>
</Node>
<Node><Sub>13</Sub>
<Node><Sub>1</Sub>
<Data>14@1@1@18@@@@@1@2;6;35;46@@@@@ТАБЕЛЬ ОТЧЕТНОСТИ</Data>
</Node>
<Node><Sub>2</Sub>
<Data>14@19@1@24@@@@@1@2;6;30;46@@@@@SRV@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>14@43@1@4@@@@@1@1;6;34;46@@@@@TAB@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>14@47@1@6@@@@@1@1;6;34;46@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>14@53@1@7@@@@@1@1;6;34;46@@@@@@</Data>
</Node>
</Node>
<Node><Sub>14</Sub>
<Node><Sub>1</Sub>
<Data>15@1@1@18@@@@@1@2;6;35;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>15@19@1@24@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>15@43@1@4@@@@@1@1;6;34;46@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>15@47@1@6@@@@@1@1;6;34;46@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>15@53@1@7@@@@@1@1;6;34;46@@@@@@</Data>
</Node>
</Node>
<Node><Sub>15</Sub>
<Node><Sub>1</Sub>
<Data>16@1@1@18@@@@@1@2;6;35;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>16@19@1@24@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>16@43@1@4@@@@@1@1;6;34;46@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>16@47@1@6@@@@@1@1;6;34;46@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>16@53@1@7@@@@@1@1;6;34;46@@@@@@</Data>
</Node>
</Node>
<Node><Sub>16</Sub>
<Node><Sub>1</Sub>
<Data>17@1@1@18@@@@@1@2;6;35;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>17@19@1@24@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>17@43@1@4@@@@@1@1;6;34;46@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>17@47@1@6@@@@@1@1;6;34;46@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>17@53@1@7@@@@@1@1;6;34;46@@@@@@</Data>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>57877,42789,MS</Data>
</Node>
<Node><Sub>STA</Sub>
<Data>2,1@2@1@27@-1@-1@5@10@</Data>
</Node>
</Node>
<Node><Sub>OPTION</Sub>
<Data>таблица OPTION для %BS+@@@@@1@1@1@1@22@80@1@@1@1@@1@@2,1@1@@@@@@@@8@5@@1;6;35;44@@@@@@</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@13@@@@@1@2;6;30;45@@@@@ Value (DFLT)</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@14@1@10@@@@@1@2;6;30;41@@@@@ Type@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>1@24@1@10@@@@@1@2;6;30;41@@@@@Atribute@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>1@34@1@35@@@@@1@2;6;30;45@@@@@ ОПИСАНИЕ@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>1@69@1@9@@@@@1@2;6;30;41@@@@@ name@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@13@@@@@1@2;6;30;45@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>2@14@1@10@@@@@1@2;6;30;41@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>2@24@1@10@@@@@1@2;6;30;41@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>2@34@1@35@@@@@1@2;6;30;45@@@@@ Основные Опции Комплекса@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>2@69@1@9@@@@@1@2;6;30;41@@@@@@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@13@@@@@1@2;6;30;46@@@@@1</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>3@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>3@34@1@35@@@@@1@@@@@@ ТРЕБОВАТЬ РЕГИСТРАЦИЮ В %BS@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>3@69@1@9@@@@@1@2;6;32;40@@@@@REG1@</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>4@1@1@13@@@@@1@2;6;30;46@@@@@1@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>4@14@1@10@@@@@1@2;6;32;40@@@@@checkbox@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>4@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>4@34@1@35@@@@@1@@@@@@ РАЗРЕШИТЬ ДОСТУП К БИБЛИОТЕЧНЫМ РАЗДЕЛАМ@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>4@69@1@9@@@@@1@2;6;32;40@@@@@LIB1@</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>5@1@1@13@@@@@1@2;6;30;46@@@@@3@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>5@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>5@24@1@10@@@@@1@2;6;32;40@@@@@size=35@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>5@34@1@35@@@@@1@@@@@@ За сколько дней оставлять буфер сессий (DFLT=1)@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>5@69@1@9@@@@@1@2;6;32;40@@@@@TMP1@</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>6@1@1@13@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>6@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>6@24@1@10@@@@@1@2;6;32;40@@@@@size=35@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>6@34@1@35@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>6@69@1@9@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>7@1@1@13@@@@@1@2;6;30;46@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>7@14@1@10@@@@@1@2;6;32;40@@@@@text@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>7@24@1@10@@@@@1@2;6;32;40@@@@@SIZE=35@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>7@34@1@35@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>7@69@1@9@@@@@1@2;6;32;40@@@@@TXT1@</Data>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>1</Sub>
<Data>8@1@1@13@@@@@1@2;6;30;46@@@@@1@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>8@14@1@10@@@@@1@2;6;32;40@@@@@radio@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>8@24@1@10@@@@@1@2;6;32;40@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>8@34@1@35@@@@@1@@@@@@ПЕРВЫЙ~ ВТОРОЙ~ ТРЕТИЙ@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>8@69@1@9@@@@@1@2;6;32;40@@@@@RAD1@</Data>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>58451,44000,MS</Data>
</Node>
<Node><Sub>OPT</Sub>
<Data>1</Data>
</Node>
<Node><Sub>STA</Sub>
<Data>4,5@2@1@13@-1@-1@4@69@LIB1</Data>
</Node>
</Node>
<Node><Sub>PARPRN</Sub>
<Data>параметры принтеров по-умолчанию@@@@@1@1@3@17@19@66@1@@1@@@1@@2,2@1@@@@@1@@@9@2@@1;6;32;44@@@@@@@2</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@25@@@@@1@2;6;30;46@@@@@         ПАРАМЕТРЫ ПРИНТ-@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@26@1@25@@@@@1@2;6;30;46@@@@@СЕРВЕРОВ@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@2@25@@@@@1@@@@@@АВТОМАТИЧЕСКИЙ ЗАПУСК ПРИ___СТАРТЕ %BS (ИМЯ П-С)__@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>2@26@2@25@@@@0@1@1;6;31;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>4@1@2@25@@@@@1@@@@@@КОЛИЧЕСТВО СЕКУНД ОЖИДАТЬ_____ОТКЛИК СЕРВЕРА______@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>4@26@2@25@@@@2,2@1@1;6;31;44@@@@@10@</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>6@1@2@25@@@@@1@@@@@@ЧАСТОТА ПРОВЕРКИ ФЛАГА   __ПРИНТ-ЗАПРОСА (сек)____@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>6@26@2@25@@@@2,2@1@1;6;31;44@@@@@2@</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>8@1@2@25@@@@@1@@@@@@АВТОМАТИЧЕСКИЙ ОСТАНОВ   ___СЕРВЕРА ПОСЛЕ ПЕЧАТИ__@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>8@26@2@25@@@@2,2@1@1;6;31;44@@@@@Y@</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>10@1@2@25@@@@@1@@@@@@РАЗМЕР MSM РАЗДЕЛА ПРИ   __СТАРТЕ СЕРВЕРА (байт)__@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>10@26@2@25@@@@2,2@1@1;6;31;44@@@@@4000@</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>12@1@2@25@@@@@1@@@@@@АВТОМАТОМ УДАЛЯТЬ ИСПОЛЬ-_____ЗОВАННЫЕ БУФЕРА_____@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>12@26@2@25@@@@2,2@1@1;6;31;44@@@@@N@</Data>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>1</Sub>
<Data>14@1@2@25@@@@@1@@@@@@ТРАНСЛИРОВАТЬ ПСКЕВДОГРА-__________ФИКУ___________@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>14@26@2@25@@@@@1@1;6;31;44@@@@@||||||--|+||==||=--=-=--==-====-=---==-@</Data>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>1</Sub>
<Data>16@1@2@25@@@@@1@@@@@@НА КАКИЕ СИМВОЛЫ ТРАНСЛИ-__РОВАТЬ ПСКЕВДОГРАФИКУ__@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>16@26@2@25@@@@@1@1;6;31;44@@@@@||||||--|+||==||=-=-|=--==-====-=---==-@</Data>
</Node>
</Node>
<Node><Sub>FTR</Sub>
<Node><Sub>2</Sub>
<Node><Sub>2</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>57774,67450,</Data>
</Node>
<Node><Sub>STA</Sub>
<Data>2,2@2@2@27@-1@-1@4@42@</Data>
</Node>
</Node>
<Node><Sub>PATH</Sub>
<Data><![CDATA[Путь к поддиректориям@@@@@1@1@2@15@21@67@1@@1@@@1@@2,4@1@@@@@1@@@14@5@@1;6;37;44@@@@@@@2@^%ZAPM.ed.BSDDR("DDRPARMH")@@@@1]]></Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@1@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@2@1@25@@@@@1@2;6;37;44@@@@@         Пути к файлам и @</Data>
</Node>
<Node><Sub>3</Sub>
<Data>1@27@1@1@@@@@1@2;6;37;44@@@@@п@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>1@28@1@25@@@@@1@2;6;37;44@@@@@оддиректориям@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>1@53@1@1@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@2@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>2@2@2@25@@@@@1@@@@@@Путь к поддиректории но- вых версий комплекса.@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>2@27@2@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>2@28@2@25@@@@@1@2;6;34;46@@@@@n:\infoportal\webnodes\vv\bsdoc\@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>2@53@2@1@1@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>4@1@1@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>4@2@1@25@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>4@27@1@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>4@28@1@25@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>4@53@1@1@1@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>5@1@2@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>5@2@2@25@@@@@1@@@@@@Имя файла и путь к протоколу тестирования@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>5@27@2@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>5@28@2@25@@@@@1@2;6;34;46@@@@@\system\TESTED.RPT@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>5@53@2@1@1@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>7@1@1@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>7@2@1@25@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>7@27@1@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>7@28@1@25@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>7@53@1@1@1@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>8@1@2@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>8@2@2@25@@@@@1@@@@@@Имя файла и путь к протоколу регистрации@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>8@27@2@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>8@28@2@25@@@@@1@2;6;34;46@@@@@^[&quot;GLAVK&quot;]BSprotkl@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>8@53@2@1@1@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>10@1@1@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>10@2@1@25@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>10@27@1@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>10@28@1@25@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>10@53@1@1@1@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>1</Sub>
<Data>11@1@2@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>11@2@2@25@@@@@1@@@@@@Путь к поддиректории файлов руководства %BS.@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>11@27@2@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>11@28@2@25@@@@@1@2;6;34;46@@@@@n:\infoportal\webnodes\vv\bsdoc\bsdoc\@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>11@53@2@1@1@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>1</Sub>
<Data>13@1@1@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>13@2@1@25@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>13@27@1@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>13@28@1@25@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>13@53@1@1@1@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>1</Sub>
<Data>14@1@2@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>14@2@2@25@@@@@1@@@@@@Директория запасного ко- пирования масс.и программ@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>14@27@2@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>14@28@2@25@@@@@1@2;6;34;46@@@@@\!\@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>14@53@2@1@1@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>11</Sub>
<Node><Sub>1</Sub>
<Data>16@1@1@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>16@2@1@25@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>16@27@1@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>16@28@1@25@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>16@53@1@1@1@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>12</Sub>
<Node><Sub>1</Sub>
<Data>17@1@2@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>17@2@2@25@@@@@1@@@@@@Диск и базовая поддиректория установки комплекса@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>17@27@2@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>17@28@2@25@@@@@1@2;6;34;46@@@@@n:\infoportal\snx\@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>17@53@2@1@1@@@@1@@@@@@</Data>
</Node>
</Node>
<Node><Sub>13</Sub>
<Node><Sub>1</Sub>
<Data>19@1@1@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>19@2@1@25@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>19@27@1@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>19@28@1@25@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>19@53@1@1@1@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>14</Sub>
<Node><Sub>1</Sub>
<Data>20@1@1@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>20@2@1@25@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>20@27@1@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>20@28@1@25@@@@@1@2;6;34;46@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>20@53@1@1@1@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>57737,39202,MS</Data>
</Node>
<Node><Sub>OPT</Sub>
<Data>2,4,2</Data>
</Node>
<Node><Sub>STA</Sub>
<Data>10,4@2@4@27@-1@-1@15@42@\!\</Data>
</Node>
</Node>
<Node><Sub>PRNDFLT</Sub>
<Data><![CDATA[ПАРАМЕТРЫ ПРИНТЕРА ПО-УМОЛЧАНИЮ@@@@@1@1@2@10@20@52@1@@1@@@1@@3,2@@@@@@@@@19@2@@2;6;30;45@@@@@@@2@@@@@1]]></Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@27@1@@@@1@2;6;30;45@@@@@ПАРАМЕТРЫ УСТРОЙСТВА ПЕЧАТИ</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@28@1@16@1@@@@1@2;6;30;45@@@@@ ПО-УМОЛЧАНИЮ</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@27@1@@@0@1@2;6;30;45@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>2@28@1@16@1@@@2,1@1@2;6;30;45@@@@@@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@27@1@@@@1@2;6;35;46@@@@@  80 СИМВОЛОВ В СТРОКЕ ..@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@28@1@16@@@@@1@1;6;34;46@@@@@27,80@</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>4@1@1@27@1@@@@1@2;6;35;46@@@@@  90 ....................@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>4@28@1@16@@@@@1@1;6;34;46@@@@@27,77@</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>5@1@1@27@1@@@@1@2;6;35;46@@@@@  132 ...................@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>5@28@1@16@@@@@1@1;6;34;46@@@@@27,80,15@</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>6@1@1@27@1@@@@1@2;6;35;46@@@@@  160 ...................@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>6@28@1@16@@@@@1@1;6;34;46@@@@@27,77,15@</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>7@1@1@27@1@@@@1@2;6;35;46@@@@@  70 СТРОК НА СТРАНИЦЕ ..</Data>
</Node>
<Node><Sub>2</Sub>
<Data>7@28@1@16@@@@@1@1;6;34;46@@@@@27,51,33</Data>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>1</Sub>
<Data>8@1@1@27@1@@@@1@2;6;35;46@@@@@  30 ....................</Data>
</Node>
<Node><Sub>2</Sub>
<Data>8@28@1@16@@@@@1@1;6;34;46@@@@@27,51,74</Data>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>1</Sub>
<Data>9@1@1@27@1@@@@1@2;6;35;46@@@@@  60 ....................@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>9@28@1@16@@@@@1@1;6;34;46@@@@@27,51,39@</Data>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>1</Sub>
<Data>10@1@1@27@1@@@@1@2;6;35;46@@@@@  100 ...................@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>10@28@1@16@@@@@1@1;6;34;46@@@@@27,51,23@</Data>
</Node>
</Node>
<Node><Sub>11</Sub>
<Node><Sub>1</Sub>
<Data>11@1@1@27@1@@@@1@2;6;35;46@@@@@  130 ...................@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>11@28@1@16@@@@@1@1;6;34;46@@@@@27,51,18@</Data>
</Node>
</Node>
<Node><Sub>12</Sub>
<Node><Sub>1</Sub>
<Data>12@1@1@27@1@@@@1@2;6;35;46@@@@@  250 ...................@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>12@28@1@16@@@@@1@1;6;34;46@@@@@27,51,10@</Data>
</Node>
</Node>
<Node><Sub>13</Sub>
<Node><Sub>1</Sub>
<Data>13@1@1@27@1@@@@1@2;6;35;46@@@@@  ДВОЙНОЕ КАЧЕСТВО ПЕЧАТИ@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>13@28@1@16@@@@@1@1;6;34;46@@@@@27,69@</Data>
</Node>
</Node>
<Node><Sub>14</Sub>
<Node><Sub>1</Sub>
<Data>14@1@1@27@1@@@@1@2;6;35;46@@@@@  ОБЫЧНОЕ КАЧЕСТВО@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>14@28@1@16@@@@@1@1;6;34;46@@@@@27,68@</Data>
</Node>
</Node>
<Node><Sub>15</Sub>
<Node><Sub>1</Sub>
<Data>15@1@1@27@1@@@@1@2;6;35;46@@@@@          СБРОС УСТАНОВОК@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>15@28@1@16@@@@@1@1;6;34;46@@@@@27,80,27,51,39@</Data>
</Node>
</Node>
<Node><Sub>16</Sub>
<Node><Sub>1</Sub>
<Data>16@1@1@27@1@@@2,1@1@2;6;30;45@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>16@28@1@16@1@@@2,1@1@2;6;30;45@@@@@@</Data>
</Node>
</Node>
<Node><Sub>17</Sub>
<Node><Sub>1</Sub>
<Data>17@1@1@27@@@@@1@2;6;35;46@@@@@    УСТРОЙСТВО ВЫВОДА@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>17@28@1@16@@@@@1@1;6;34;46@@@@PRN,^%ZAPM.ed.BSJPRN,,,,&lt;&gt;@|PRN|\\REFUGE\HPDeskJe@</Data>
</Node>
</Node>
<Node><Sub>18</Sub>
<Node><Sub>1</Sub>
<Data>18@1@1@27@1@@@@1@2;6;35;46@@@@@ МАКС.КОЛ-ВО СИМВОЛОВ@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>18@28@1@16@@@@@1@1;6;34;46@@@@@511@</Data>
</Node>
</Node>
<Node><Sub>19</Sub>
<Node><Sub>1</Sub>
<Data>19@1@1@27@@@@@1@2;6;35;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>19@28@1@16@@@@@1@1;6;34;46@@@@@@</Data>
</Node>
</Node>
<Node><Sub>FTR</Sub>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$TR($J(&quot;&quot;,27),&quot; &quot;,&quot;=&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$TR($J(&quot;&quot;,27),&quot; &quot;,&quot;=&quot;)</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>Free</Sub>
<Data>56819,49693</Data>
</Node>
<Node><Sub>LST</Sub>
<Data>59467,71331,MSW</Data>
</Node>
<Node><Sub>STA</Sub>
<Data>14,2@3@2@27@-1@-1@15@37@27,68</Data>
<Node><Sub>0</Sub>
<Data>20</Data>
</Node>
<Node><Sub>2</Sub>
<DataBase64>IF7PXsBe0F7AXsxexV7SXtBe214gXs9exV7XXsBe0l7IXiBewl4gXtRezl7QXsxewF7SXsVeIF4g
XiReQ14oXlNeUl4pXiBeIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAH
IAcgBw==
</DataBase64>
</Node>
<Node><Sub>3</Sub>
<DataBase64>IF4gXi1eLV4tXi1eLV4tXi1eLV4tXi1eLV4tXi1eLV4tXi1eLV4tXi1eLV4tXi1eLV4tXi1eLV4t
Xi1eLV4tXi1eLV4gXiBeIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAH
IAcgBw==
</DataBase64>
</Node>
<Node><Sub>4</Sub>
<DataBase64>IDUgNSA1ODUwNSA10TXINcw1wjXONcs1zjXCNSA1wjUgNdE10jXQNc41yjXFNSA1LjUuNSA1Mng3
eCx4OHgweCB4IHggeCB4IAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAH
IAcgBw==
</DataBase64>
</Node>
<Node><Sub>5</Sub>
<DataBase64>IDUgNSA1OTUwNSA1LjUuNS41LjUuNS41LjUuNS41LjUuNS41LjUuNS41LjUuNS41LjUuNSA1Mjk3
OSw5Nzk3OSA5IDkgOSA5IAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAH
IAcgBw==
</DataBase64>
</Node>
<Node><Sub>6</Sub>
<DataBase64>IDUgNSA1MTUzNTI1IDUuNS41LjUuNS41LjUuNS41LjUuNS41LjUuNS41LjUuNS41LjUuNSA1Mjk3
OSw5ODkwOSw5MTk1OSA5IAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAH
IAcgBw==
</DataBase64>
</Node>
<Node><Sub>7</Sub>
<DataBase64>IDUgNSA1MTU2NTA1IDUuNS41LjUuNS41LjUuNS41LjUuNS41LjUuNS41LjUuNS41LjUuNSA1Mjk3
OSw5Nzk3OSw5MTk1OSA5IAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAH
IAcgBw==
</DataBase64>
</Node>
<Node><Sub>8</Sub>
<DataBase64>IDUgNSA1NzUwNSA10TXSNdA1zjXKNSA1zTXANSA10TXSNdA1wDXNNcg11jXFNSA1LjUuNSA1Mjk3
OSw5NTkxOSw5MzkzOSA5IAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAH
IAcgBw==
</DataBase64>
</Node>
<Node><Sub>9</Sub>
<DataBase64>IDUgNSA1MzUwNSA1LjUuNS41LjUuNS41LjUuNS41LjUuNS41LjUuNS41LjUuNS41LjUuNSA1Mjk3
OSw5NTkxOSw5Nzk0OSA5IAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAH
IAcgBw==
</DataBase64>
</Node>
<Node><Sub>10</Sub>
<DataBase64>IDUgNSA1NjUwNSA1LjUuNS41LjUuNS41LjUuNS41LjUuNS41LjUuNS41LjUuNS41LjUuNSA1Mjk3
OSw5NTkxOSw5Mzk5OSA5IAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAH
IAcgBw==
</DataBase64>
</Node>
<Node><Sub>11</Sub>
<DataBase64>IDUgNSA1MTUwNTA1IDUuNS41LjUuNS41LjUuNS41LjUuNS41LjUuNS41LjUuNS41LjUuNSA1Mjk3
OSw5NTkxOSw5MjkzOSA5IAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAH
IAcgBw==
</DataBase64>
</Node>
<Node><Sub>12</Sub>
<DataBase64>IDUgNSA1MTUzNTA1IDUuNS41LjUuNS41LjUuNS41LjUuNS41LjUuNS41LjUuNS41LjUuNSA1Mjk3
OSw5NTkxOSw5MTk4OSA5IAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAH
IAcgBw==
</DataBase64>
</Node>
<Node><Sub>13</Sub>
<DataBase64>IDUgNSA1MjU1NTA1IDUuNS41LjUuNS41LjUuNS41LjUuNS41LjUuNS41LjUuNS41LjUuNSA1Mjk3
OSw5NTkxOSw5MTkwOSA5IAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAH
IAcgBw==
</DataBase64>
</Node>
<Node><Sub>14</Sub>
<DataBase64>IDUgNSA1xDXCNc41yTXNNc41xTUgNco1wDXXNcU10TXSNcI1zjUgNc81xTXXNcA10jXINSA1Mjk3
OSw5Njk5OSA5IDkgOSA5IAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAH
IAcgBw==
</DataBase64>
</Node>
<Node><Sub>15</Sub>
<DataBase64>IAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcg
ByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAH
IAcgBw==
</DataBase64>
</Node>
<Node><Sub>16</Sub>
<DataBase64>IAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcg
ByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAH
IAcgBw==
</DataBase64>
</Node>
<Node><Sub>17</Sub>
<DataBase64>IAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcg
ByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAH
IAcgBw==
</DataBase64>
</Node>
<Node><Sub>18</Sub>
<DataBase64>IAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcg
ByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAH
IAcgBw==
</DataBase64>
</Node>
<Node><Sub>19</Sub>
<DataBase64>IAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcg
ByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAH
IAcgBw==
</DataBase64>
</Node>
<Node><Sub>20</Sub>
<DataBase64>IAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcg
ByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAH
IAcgBw==
</DataBase64>
</Node>
<Node><Sub>21</Sub>
<DataBase64>IAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcg
ByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAH
IAcgBw==
</DataBase64>
</Node>
<Node><Sub>22</Sub>
<DataBase64>IAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcg
ByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAHIAcgByAH
IAcgBw==
</DataBase64>
</Node>
</Node>
</Node>
<Node><Sub>SERVER</Sub>
<Data>М-СЕРВЕР, ЗАЩИТА ИНФОРМАЦИИ@@@@@1@1@2@15@21@67@1@@1@@@1@@2,4@1@@@@@1@@@16@5@@2;6;36;44@@@@@@@2@@@@@1</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@1@1@@@@1@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@2@1@25@1@@@@1@2;6;33;44@@@@@              Параметры С@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>1@27@1@1@1@@@@1@2;6;33;44@@@@@Е@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>1@28@1@25@1@@@@1@2;6;33;44@@@@@РВЕРА@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>1@53@1@1@1@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@2@1@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>2@2@2@25@1@@@@1@@@@@@Полная ссылка к глобали, последняя версия %BS@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>2@27@2@1@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>2@28@2@25@@@@@1@2;6;34;46@@@@@A\^[&quot;GLAVK&quot;]BSLast@@@@@^%ZAPM.ed.BSHLP(&quot;VerHigh&quot;)</Data>
</Node>
<Node><Sub>5</Sub>
<Data>2@53@2@1@1@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>4@1@1@1@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>4@2@1@25@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>4@27@1@1@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>4@28@1@25@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>4@53@1@1@1@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>5@1@2@1@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>5@2@2@25@1@@@@1@@@@@@Полная ссылка к глобали, обмена сетевой информац.@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>5@27@2@1@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>5@28@2@25@@@@@1@2;6;34;46@@@@@0\^[&quot;GLAVK&quot;]BServInf@@@@@^%ZAPM.ed.BSHLP(&quot;ServInfo&quot;)</Data>
</Node>
<Node><Sub>5</Sub>
<Data>5@53@2@1@1@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>7@1@1@1@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>7@2@1@25@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>7@27@1@1@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>7@28@1@25@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>7@53@1@1@1@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>8@1@2@1@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>8@2@2@25@1@@@@1@@@@@@Параметры секретного уда-ления обьектов %BS@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>8@27@2@1@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>8@28@2@25@@@@@1@2;6;34;46@@@@@N\N\N\Y@@@@@^%ZAPM.ed.BSHLP(&quot;SecDel&quot;)</Data>
</Node>
<Node><Sub>5</Sub>
<Data>8@53@2@1@1@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>10@1@1@1@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>10@2@1@25@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>10@27@1@1@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>10@28@1@25@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>10@53@1@1@1@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>1</Sub>
<Data>11@1@1@1@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>11@2@1@25@@@@@1@@@@@@Глобальные Буфера вывода@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>11@27@1@1@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data><![CDATA[11@28@1@25@@@@@1@2;6;34;46@@@@@^["GLAVK"]GlobAll ^["GLAVK"]GlobMOL ^["GLAVK"]GlobTAB ^%ZAPM.ed.BSbufS@@@@@^%ZAPM.ed.BSHLP("GLF1")]]></Data>
</Node>
<Node><Sub>5</Sub>
<Data>11@53@1@1@1@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>1</Sub>
<Data>12@1@1@1@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>12@2@1@25@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>12@27@1@1@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>12@28@1@25@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>12@53@1@1@1@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>1</Sub>
<Data>13@1@2@1@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>13@2@2@25@@@@@1@@@@@@Директория файлов для DDR@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>13@27@2@1@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>13@28@2@25@@@@@1@2;6;34;46@@@@@N:\InfoPortal\WebNodes\VV\u\ddr\@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>13@53@2@1@1@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>11</Sub>
<Node><Sub>1</Sub>
<Data>15@1@1@1@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>15@2@1@25@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>15@27@1@1@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>15@28@1@25@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>15@53@1@1@1@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>12</Sub>
<Node><Sub>1</Sub>
<Data>16@1@1@1@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>16@2@1@25@1@@@@1@@@@@@Таблица общих переменных @</Data>
</Node>
<Node><Sub>3</Sub>
<Data>16@27@1@1@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>16@28@1@25@@@@@1@2;6;34;46@@@@@^[&quot;GLAVK&quot;]SRV(&quot;Variables&quot;)@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>16@53@1@1@1@@@@1@@@@@@</Data>
</Node>
</Node>
<Node><Sub>13</Sub>
<Node><Sub>1</Sub>
<Data>17@1@1@1@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>17@2@1@25@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>17@27@1@1@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>17@28@1@25@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>17@53@1@1@1@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>14</Sub>
<Node><Sub>1</Sub>
<Data>18@1@1@1@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>18@2@1@25@@@@@1@@@@@@Начальный Номер терминала @</Data>
</Node>
<Node><Sub>3</Sub>
<Data>18@27@1@1@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>18@28@1@25@@@@@1@2;6;34;46@@@@@33@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>18@53@1@1@1@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>15</Sub>
<Node><Sub>1</Sub>
<Data>19@1@1@1@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>19@2@1@25@@@@@1@@@@@@Путь к сетевым ресурсам@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>19@27@1@1@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>19@28@1@25@@@@@1@2;6;30;47@@@@@N:\InfoPortal\webnodes\vv\u\REPORT\@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>19@53@1@1@1@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>16</Sub>
<Node><Sub>1</Sub>
<Data>20@1@1@1@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>20@2@1@25@@@@@1@@@@@@IP Основного WEB-Сервера@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>20@27@1@1@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>20@28@1@25@@@@@1@2;6;34;46@@@@@IVCMSW@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>20@53@1@1@1@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>59260,73792,MSW</Data>
</Node>
<Node><Sub>OPT</Sub>
<Data>2,4,2</Data>
</Node>
<Node><Sub>STA</Sub>
<Data>8,4@2@4@27@-1@-1@12@42@^[&quot;GLAVK&quot;]GlobAll ^[&quot;GLAVK&quot;]GlobMOL ^[&quot;GLAVK&quot;]GlobTAB ^%ZAPM.ed.BSbufS</Data>
</Node>
</Node>
<Node><Sub>SETUP</Sub>
<Data>ПАРАМЕТРЫ КОМПЛЕКСА@ADM@@@@1@1@2@10@21@60@1@@1@@@1@@2,2@@@@@@@@@20@3@@2;6;32;44@@@@@@@2@@@@@</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@26@@@@@1@2;6;30;45@@@@@    УСТАНОВКА ОПЦИЙ КОМПЛЕ</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@27@1@18@@@@@1@2;6;30;45@@@@@КСА</Data>
</Node>
<Node><Sub>3</Sub>
<Data>1@45@1@7@@@@@1@2;6;30;45@@@@@  DFLT@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@26@@@@@1@2;6;37;44@@@@@ MIN-e количество блоков -</Data>
</Node>
<Node><Sub>2</Sub>
<Data>2@27@1@18@@@@@1@2;6;30;46@@@@@200</Data>
</Node>
<Node><Sub>3</Sub>
<Data>2@45@1@7@@@@0@1@2;6;32;44@@@@2,3@@@@@@^%ZAPM.ed.BSHLP(&quot;DFLT&quot;)</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@26@@@@@1@2;6;37;44@@@@@Гасить экран-тип картинки</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@27@1@18@@@@@1@2;6;30;46@@@@@9999999-7--%BS@@@@@^%ZAPM.ed.BSHLP(&quot;TipGluc&quot;)</Data>
</Node>
<Node><Sub>3</Sub>
<Data>3@45@1@7@@@@0@1@2;6;32;44@@@@3,3@@@@@@^%ZAPM.ed.BSHLP(&quot;DFLT&quot;)</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>4@1@1@26@@@@@1@2;6;37;44@@@@@Доступ к DOS View/Edit/Del</Data>
</Node>
<Node><Sub>2</Sub>
<Data>4@27@1@18@@@@0@1@2;6;30;46@@@@@300/300/3000@@@@@^%ZAPM.ed.BSHLP(&quot;ACCESHELP&quot;)</Data>
</Node>
<Node><Sub>3</Sub>
<Data>4@45@1@7@@@@0@1@2;6;32;44@@@@4,3@@@@@@^%ZAPM.ed.BSHLP(&quot;DFLT&quot;)</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>5@1@1@26@@@@@1@2;6;37;44@@@@@Доступ к MSM Read/Edit/Kil</Data>
</Node>
<Node><Sub>2</Sub>
<Data>5@27@1@18@@@@@1@2;6;30;46@@@@@Y/Y/Y@@@@@^%ZAPM.ed.BSHLP(&quot;ACCESHELP&quot;)</Data>
</Node>
<Node><Sub>3</Sub>
<Data>5@45@1@7@@@@0@1@2;6;32;44@@@@5,3@@@@@@^%ZAPM.ed.BSHLP(&quot;DFLT&quot;)</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>6@1@1@26@@@@@1@2;6;37;44@@@@@КОДЫ УПРАВЛЕНИЯ ПРИНТЕРОМ-@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>6@27@1@18@1@@@@1@2;6;30;46@@@@^%ZAPM.ed.BSDFLT(&quot;PRNDFLT&quot;)@ ...@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>6@45@1@7@@@@0@1@2;6;32;44@@@@6,3@@@@@@^%ZAPM.ed.BSHLP(&quot;DFLT&quot;)</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>7@1@1@26@@@@@1@2;6;37;44@@@@@      ЦВЕТОВАЯ ПАЛИТРА   -</Data>
</Node>
<Node><Sub>2</Sub>
<Data>7@27@1@18@1@@@@1@2;6;30;46@@@@^%ZAPM.ed.BSETUP(&quot;COLOR&quot;)@ ...</Data>
</Node>
<Node><Sub>3</Sub>
<Data>7@45@1@7@@@@0@1@2;6;32;44@@@@7,3@@@@@@^%ZAPM.ed.BSHLP(&quot;DFLT&quot;)</Data>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>1</Sub>
<Data>8@1@1@26@@@@@1@2;6;37;44@@@@@ПУТИ К ФАЙЛАМ И ДИРЕК-ЯМ.-  </Data>
</Node>
<Node><Sub>2</Sub>
<Data><![CDATA[8@27@1@18@@@@0@1@2;6;30;46@@@@^%ZAPM.ed.BSETUP("PATH")@C:\MYWORK\MSM\MSM414\@@@@@^%ZAPM.ed.BSHLP("SETUPDOS")]]></Data>
</Node>
<Node><Sub>3</Sub>
<Data>8@45@1@7@@@@0@1@2;6;32;44@@@@8,3@@@@@@^%ZAPM.ed.BSHLP(&quot;DFLT&quot;)</Data>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>1</Sub>
<Data>9@1@1@26@@@@@1@2;6;37;44@@@@@Пароль администратора ADM@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>9@27@1@18@@@@0@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>9@45@1@7@@@@0@1@2;6;32;44@@@@^%ZAPM.ed.BSVOL(&quot;DATE&quot;)@@@@@@^%ZAPM.ed.BSHLP(&quot;DFLT&quot;)</Data>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>1</Sub>
<Data>10@1@1@26@@@@@1@2;6;37;44@@@@@    DDP технология %BS   -@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>10@27@1@18@@@@0@1@2;6;30;46@@@@^%ZAPM.ed.BSS(&quot;DDPYES&quot;)@0@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>10@45@1@7@@@@0@1@2;6;32;44@@@@10,3@@@@@@^%ZAPM.ed.BSHLP(&quot;DFLT&quot;)</Data>
</Node>
</Node>
<Node><Sub>11</Sub>
<Node><Sub>1</Sub>
<Data>11@1@1@26@@@@@1@2;6;37;44@@@@@     МОНТИРУЕМЫЕ ТОМА    -@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>11@27@1@18@1@@@@1@2;6;30;46@@@@^%ZAPM.ed.BSETUP(&quot;MOUNT&quot;)@ ...@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>11@45@1@7@@@@0@1@2;6;32;44@@@@11,3@@@@@@^%ZAPM.ed.BSHLP(&quot;DFLT&quot;)</Data>
</Node>
</Node>
<Node><Sub>12</Sub>
<Node><Sub>1</Sub>
<Data>12@1@1@26@@@@@1@2;6;37;44@@@@@Раздел таблиц по умолчанию@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>12@27@1@18@@@@@1@2;6;30;46@@@@@^%ZAPM.ed.BSCDFLT@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>12@45@1@7@@@@0@1@2;6;32;44@@@@12,3@@@@@@^%ZAPM.ed.BSHLP(&quot;DFLT&quot;)</Data>
</Node>
</Node>
<Node><Sub>13</Sub>
<Node><Sub>1</Sub>
<Data>13@1@1@26@@@@@1@2;6;37;44@@@@@ Размеp буффеpа History  -@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>13@27@1@18@@@@@1@2;6;30;46@@@@@40@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>13@45@1@7@@@@0@1@2;6;32;44@@@@13,3@@@@@@^%ZAPM.ed.BSHLP(&quot;DFLT&quot;)</Data>
</Node>
</Node>
<Node><Sub>14</Sub>
<Node><Sub>1</Sub>
<Data>14@1@1@26@@@@@1@2;6;37;44@@@@@РТА-80Л используем на COM-@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>14@27@1@18@@@@0@1@2;6;30;46@@@@@1@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>14@45@1@7@@@@0@1@2;6;32;44@@@@14,3@@@@@@^%ZAPM.ed.BSHLP(&quot;DFLT&quot;)</Data>
</Node>
</Node>
<Node><Sub>15</Sub>
<Node><Sub>1</Sub>
<Data>15@1@1@26@@@@@1@2;6;37;44@@@@@Пpи &lt;INS&gt; двигать маркер -@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>15@27@1@18@@@@0@1@2;6;30;46@@@@^%ZAPM.ed.BSS(&quot;MOVE&quot;)@1@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>15@45@1@7@@@@0@1@2;6;32;44@@@@15,3@@@@@@^%ZAPM.ed.BSHLP(&quot;DFLT&quot;)</Data>
</Node>
</Node>
<Node><Sub>16</Sub>
<Node><Sub>1</Sub>
<Data>16@1@1@26@@@@@1@2;6;37;44@@@@@После редактора маркер   -@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>16@27@1@18@@@@15,2@1@2;6;30;46@@@@^%ZAPM.ed.BSS(&quot;MOVE&quot;)@0@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>16@45@1@7@@@@0@1@2;6;32;44@@@@16,3@@@@@@^%ZAPM.ed.BSHLP(&quot;DFLT&quot;)</Data>
</Node>
</Node>
<Node><Sub>17</Sub>
<Node><Sub>1</Sub>
<Data>17@1@1@26@@@@@1@2;6;37;44@@@@@       СЕТЕВЫЕ ПАРАМЕТРЫ -@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>17@27@1@18@@@@0@1@2;6;30;46@@@@^%ZAPM.ed.BSETUP(&quot;SERVER&quot;)@@@@@@^%ZAPM.ed.BSHLP(&quot;SETUPDOS&quot;)</Data>
</Node>
<Node><Sub>3</Sub>
<Data>17@45@1@7@@@@0@1@2;6;32;44@@@@17,3@@@@@@^%ZAPM.ed.BSHLP(&quot;DFLT&quot;)</Data>
</Node>
</Node>
<Node><Sub>18</Sub>
<Node><Sub>1</Sub>
<Data>18@1@1@26@@@@@1@2;6;37;44@@@@@        ПАРАМЕТРЫ ПЕЧАТИ -@</Data>
</Node>
<Node><Sub>2</Sub>
<Data><![CDATA[18@27@1@18@@@@0@1@2;6;30;46@@@@^%ZAPM.ed.BSETUP("PARPRN")@???SEIKOSHA\MSW\3@@@@@^%ZAPM.ed.BSHLP("SETUPDOS")]]></Data>
</Node>
<Node><Sub>3</Sub>
<Data>18@45@1@7@@@@0@1@2;6;32;44@@@@18,3@@@@@@^%ZAPM.ed.BSHLP(&quot;DFLT&quot;)</Data>
</Node>
</Node>
<Node><Sub>19</Sub>
<Node><Sub>1</Sub>
<Data>19@1@1@26@@@@@1@2;6;37;44@@@@@   СИСТЕМНЫЕ БАЗЫ ДАННЫХ -@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>19@27@1@18@@@@0@1@2;6;30;46@@@@^%ZAPM.ed.BSVOL(&quot;BDSYS&quot;)@@@@@@^%ZAPM.ed.BSHLP(&quot;SETUPDOS&quot;)</Data>
</Node>
<Node><Sub>3</Sub>
<Data>19@45@1@7@@@@@1@2;6;32;44@@@@19,3@EndUser@@@@@^%ZAPM.ed.BSHLP(&quot;DFLT&quot;)</Data>
</Node>
</Node>
<Node><Sub>20</Sub>
<Node><Sub>1</Sub>
<Data>20@1@1@26@@@@@1@2;6;37;44@@@@@ Системные флаги комплекса@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>20@27@1@18@@@@@1@2;6;30;46@@@@@00000010001111111@@@@@^%ZAPM.ed.BSHLP(&quot;SetHelp&quot;)</Data>
</Node>
<Node><Sub>3</Sub>
<Data>20@45@1@7@@@@0@1@2;6;32;44@@@@20,3@@@@@@^%ZAPM.ed.BSHLP(&quot;DFLT&quot;)</Data>
</Node>
</Node>
<Node><Sub>CMD</Sub>
<Node><Sub>2</Sub>
<Node><Sub>3</Sub>
<Data><![CDATA[D Yes^%ZAPM.ed.BSXfun("Возвращаем настройки по-умолчанию ?") I YES>0 S $P(^%ZAPM.ed.BSETUP("SETUP",2,2),"@",15)=$P(^%ZAPM.ed.BSS("SETUP",2,2),"@",15)]]></Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>3</Sub>
<Data><![CDATA[D Yes^%ZAPM.ed.BSXfun("Возвращаем настройки по-умолчанию ?") I YES>0 S $P(^%ZAPM.ed.BSETUP("SETUP",3,2),"@",15)=$P(^%ZAPM.ed.BSS("SETUP",3,2),"@",15)]]></Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>3</Sub>
<Data><![CDATA[D Yes^%ZAPM.ed.BSXfun("Возвращаем настройки по-умолчанию ?") I YES>0 S $P(^%ZAPM.ed.BSETUP("SETUP",4,2),"@",15)=$P(^%ZAPM.ed.BSS("SETUP",4,2),"@",15)]]></Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>3</Sub>
<Data><![CDATA[D Yes^%ZAPM.ed.BSXfun("Возвращаем настройки по-умолчанию ?") I YES>0 S $P(^%ZAPM.ed.BSETUP("SETUP",5,2),"@",15)=$P(^%ZAPM.ed.BSS("SETUP",5,2),"@",15)]]></Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>3</Sub>
<Data><![CDATA[D Yes^%ZAPM.ed.BSXfun("Возвращаем настройки по-умолчанию ?") I YES>0 S BSr1="^%ZAPM.ed.BSDFLT",BSt1="PRNDFLT",BSr2="^%ZAPM.ed.BSETUP",BSt2=BSt1 D COPY^%ZAPM.ed.BSTK]]></Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>3</Sub>
<Data><![CDATA[D Yes^%ZAPM.ed.BSXfun("Возвращаем настройки по-умолчанию ?") I YES>0 S BSr1="^%ZAPM.ed.BSS",BSt1="COLOR",BSr2="^%ZAPM.ed.BSETUP",BSt2=BSt1 D COPY^%ZAPM.ed.BSTK]]></Data>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>2</Sub>
<Data>I $$ADMIN^%ZAPM.ed.BS() S IYI=&quot;^%ZAPM.ed.BSETUP,PATH&quot; D NE^%ZAPM.ed.BSN</Data>
</Node>
<Node><Sub>3</Sub>
<Data><![CDATA[D Yes^%ZAPM.ed.BSXfun("Возвращаем настройки по-умолчанию ?") I YES>0 S BSr1="^%ZAPM.ed.BSS",BSt1="PATH",BSr2="^%ZAPM.ed.BSETUP",BSt2=BSt1 D COPY^%ZAPM.ed.BSTK]]></Data>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>3</Sub>
<Data><![CDATA[D Yes^%ZAPM.ed.BSXfun("Возвращаем настройки по-умолчанию ?") I YES>0 S $P(^%ZAPM.ed.BSETUP("SETUP",9,2),"@",15)=$P(^%ZAPM.ed.BSS("SETUP",9,2),"@",15)]]></Data>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>3</Sub>
<Data><![CDATA[D Yes^%ZAPM.ed.BSXfun("Возвращаем настройки по-умолчанию ?") I YES>0 S $P(^%ZAPM.ed.BSETUP("SETUP",10,2),"@",15)=$P(^%ZAPM.ed.BSS("SETUP",10,2),"@",15)]]></Data>
</Node>
</Node>
<Node><Sub>11</Sub>
<Node><Sub>3</Sub>
<Data><![CDATA[D Yes^%ZAPM.ed.BSXfun("Возвращаем настройки по-умолчанию ?") I YES>0 S BSr1="^%ZAPM.ed.BSS",BSt1="MOUNT",BSr2="^%ZAPM.ed.BSETUP",BSt2=BSt1 D COPY^%ZAPM.ed.BSTK]]></Data>
</Node>
</Node>
<Node><Sub>12</Sub>
<Node><Sub>3</Sub>
<Data><![CDATA[D Yes^%ZAPM.ed.BSXfun("Возвращаем настройки по-умолчанию ?") I YES>0 S $P(^%ZAPM.ed.BSETUP("SETUP",12,2),"@",15)=$P(^%ZAPM.ed.BSS("SETUP",12,2),"@",15)]]></Data>
</Node>
</Node>
<Node><Sub>13</Sub>
<Node><Sub>3</Sub>
<Data><![CDATA[D Yes^%ZAPM.ed.BSXfun("Возвращаем настройки по-умолчанию ?") I YES>0 S $P(^%ZAPM.ed.BSETUP("SETUP",13,2),"@",15)=$P(^%ZAPM.ed.BSS("SETUP",13,2),"@",15)]]></Data>
</Node>
</Node>
<Node><Sub>14</Sub>
<Node><Sub>3</Sub>
<Data><![CDATA[D Yes^%ZAPM.ed.BSXfun("Возвращаем настройки по-умолчанию ?") I YES>0 S $P(^%ZAPM.ed.BSETUP("SETUP",14,2),"@",15)=$P(^%ZAPM.ed.BSS("SETUP",14,2),"@",15)]]></Data>
</Node>
</Node>
<Node><Sub>15</Sub>
<Node><Sub>3</Sub>
<Data><![CDATA[D Yes^%ZAPM.ed.BSXfun("Возвращаем настройки по-умолчанию ?") I YES>0 S $P(^%ZAPM.ed.BSETUP("SETUP",15,2),"@",15)=$P(^%ZAPM.ed.BSS("SETUP",15,2),"@",15)]]></Data>
</Node>
</Node>
<Node><Sub>16</Sub>
<Node><Sub>3</Sub>
<Data><![CDATA[D Yes^%ZAPM.ed.BSXfun("Возвращаем настройки по-умолчанию ?") I YES>0 S $P(^%ZAPM.ed.BSETUP("SETUP",16,2),"@",15)=$P(^%ZAPM.ed.BSS("SETUP",16,2),"@",15)]]></Data>
</Node>
</Node>
<Node><Sub>17</Sub>
<Node><Sub>3</Sub>
<Data><![CDATA[D Yes^%ZAPM.ed.BSXfun("Возвращаем настройки по-умолчанию ?") I YES>0 S BSr1="^%ZAPM.ed.BSS",BSt1="SERVER",BSr2="^%ZAPM.ed.BSETUP",BSt2=BSt1 D COPY^%ZAPM.ed.BSTK]]></Data>
</Node>
</Node>
<Node><Sub>18</Sub>
<Node><Sub>3</Sub>
<Data><![CDATA[D Yes^%ZAPM.ed.BSXfun("Возвращаем настройки по-умолчанию ?") I YES>0 S BSr1="^%ZAPM.ed.BSDFLT",BSt1="PARPRN",BSr2="^%ZAPM.ed.BSETUP",BSt2=BSt1 D COPY^%ZAPM.ed.BSTK]]></Data>
</Node>
</Node>
<Node><Sub>19</Sub>
<Node><Sub>2</Sub>
<Data>I $$ADMIN^%ZAPM.ed.BS() S IYI=&quot;^%ZAPM.ed.BSVOL,BDSYS&quot; D NE^%ZAPM.ed.BSN</Data>
</Node>
<Node><Sub>3</Sub>
<Data>D REGISTR^%ZAPM.ed.BS3</Data>
</Node>
</Node>
<Node><Sub>20</Sub>
<Node><Sub>3</Sub>
<Data><![CDATA[D Yes^%ZAPM.ed.BSXfun("Возвращаем настройки по-умолчанию ?") I YES>0 S $P(^%ZAPM.ed.BSETUP("SETUP",20,2),"@",15)=$P(^%ZAPM.ed.BSS("SETUP",20,2),"@",15)]]></Data>
</Node>
</Node>
</Node>
<Node><Sub>FTR</Sub>
<Node><Sub>2</Sub>
<Node><Sub>3</Sub>
<Data>S d1=&quot;&lt;Enter&gt;&quot;</Data>
<Node><Sub>1</Sub>
<Data>&quot;&lt;Enter&gt;&quot;</Data>
</Node>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>3</Sub>
<Data>S d1=&quot;&lt;Enter&gt;&quot;</Data>
<Node><Sub>1</Sub>
<Data>&quot;&lt;Enter&gt;&quot;</Data>
</Node>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>2</Sub>
<Data>S d1=d_&quot; (Kb)&quot;</Data>
<Node><Sub>1</Sub>
<Data>d_&quot; (Kb)&quot;</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Data>S d1=&quot;&lt;Enter&gt;&quot;</Data>
<Node><Sub>1</Sub>
<Data>&quot;&lt;Enter&gt;&quot;</Data>
</Node>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>3</Sub>
<Data>S d1=&quot;&lt;Enter&gt;&quot;</Data>
<Node><Sub>1</Sub>
<Data>&quot;&lt;Enter&gt;&quot;</Data>
</Node>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>3</Sub>
<Data>S d1=&quot;&lt;Enter&gt;&quot;</Data>
<Node><Sub>1</Sub>
<Data>&quot;&lt;Enter&gt;&quot;</Data>
</Node>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>3</Sub>
<Data>S d1=&quot;&lt;Enter&gt;&quot;</Data>
<Node><Sub>1</Sub>
<Data>&quot;&lt;Enter&gt;&quot;</Data>
</Node>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>2</Sub>
<Data>S d1=&quot; ...&quot;</Data>
<Node><Sub>1</Sub>
<Data>&quot; ...&quot;</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Data>S d1=&quot;&lt;Enter&gt;&quot;</Data>
<Node><Sub>1</Sub>
<Data>&quot;&lt;Enter&gt;&quot;</Data>
</Node>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>2</Sub>
<Data>S d1=$TR($J(&quot;&quot;,19),&quot; &quot;,&quot;§&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$TR($J(&quot;&quot;,19),&quot; &quot;,&quot;§&quot;)</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Data>S d1=&quot;SysDate&quot;</Data>
<Node><Sub>1</Sub>
<Data>&quot;SysDate&quot;</Data>
</Node>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>2</Sub>
<Data>S d1=$S(d=1:&quot;Да&quot;,1:&quot;Нет&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$S(d=1:&quot;Да&quot;,1:&quot;Нет&quot;)</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Data>S d1=&quot;&lt;Enter&gt;&quot;</Data>
<Node><Sub>1</Sub>
<Data>&quot;&lt;Enter&gt;&quot;</Data>
</Node>
</Node>
</Node>
<Node><Sub>11</Sub>
<Node><Sub>3</Sub>
<Data>S d1=&quot;&lt;Enter&gt;&quot;</Data>
<Node><Sub>1</Sub>
<Data>&quot;&lt;Enter&gt;&quot;</Data>
</Node>
</Node>
</Node>
<Node><Sub>12</Sub>
<Node><Sub>3</Sub>
<Data>S d1=&quot;&lt;Enter&gt;&quot;</Data>
<Node><Sub>1</Sub>
<Data>&quot;&lt;Enter&gt;&quot;</Data>
</Node>
</Node>
</Node>
<Node><Sub>13</Sub>
<Node><Sub>3</Sub>
<Data>S d1=&quot;&lt;Enter&gt;&quot;</Data>
<Node><Sub>1</Sub>
<Data>&quot;&lt;Enter&gt;&quot;</Data>
</Node>
</Node>
</Node>
<Node><Sub>14</Sub>
<Node><Sub>2</Sub>
<Data>S d1=$S(d=1!(d=2):d,1:&quot;нет&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$S(d=1!(d=2):d,1:&quot;нет&quot;)</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Data>S d1=&quot;&lt;Enter&gt;&quot;</Data>
<Node><Sub>1</Sub>
<Data>&quot;&lt;Enter&gt;&quot;</Data>
</Node>
</Node>
</Node>
<Node><Sub>15</Sub>
<Node><Sub>2</Sub>
<Data>S d1=$S(d=1:&quot;вниз&quot;,d=2:&quot;вправо&quot;,1:&quot;нет&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$S(d=1:&quot;вниз&quot;,d=2:&quot;вправо&quot;,1:&quot;нет&quot;)</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Data>S d1=&quot;&lt;Enter&gt;&quot;</Data>
<Node><Sub>1</Sub>
<Data>&quot;&lt;Enter&gt;&quot;</Data>
</Node>
</Node>
</Node>
<Node><Sub>16</Sub>
<Node><Sub>3</Sub>
<Data>S d1=&quot;&lt;Enter&gt;&quot;</Data>
<Node><Sub>1</Sub>
<Data>&quot;&lt;Enter&gt;&quot;</Data>
</Node>
</Node>
</Node>
<Node><Sub>17</Sub>
<Node><Sub>2</Sub>
<Data>S d1=&quot; ...&quot;</Data>
<Node><Sub>1</Sub>
<Data>&quot; ...&quot;</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Data>S d1=&quot;&lt;Enter&gt;&quot;</Data>
<Node><Sub>1</Sub>
<Data>&quot;&lt;Enter&gt;&quot;</Data>
</Node>
</Node>
</Node>
<Node><Sub>18</Sub>
<Node><Sub>2</Sub>
<Data>S d1=&quot; ...&quot;</Data>
<Node><Sub>1</Sub>
<Data>&quot; ...&quot;</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Data>S d1=&quot;&lt;Enter&gt;&quot;</Data>
<Node><Sub>1</Sub>
<Data>&quot;&lt;Enter&gt;&quot;</Data>
</Node>
</Node>
</Node>
<Node><Sub>19</Sub>
<Node><Sub>2</Sub>
<Data>S d1=&quot; ...&quot;</Data>
<Node><Sub>1</Sub>
<Data>&quot; ...&quot;</Data>
</Node>
</Node>
</Node>
<Node><Sub>20</Sub>
<Node><Sub>3</Sub>
<Data>S d1=&quot;&lt;Enter&gt;&quot;</Data>
<Node><Sub>1</Sub>
<Data>&quot;&lt;Enter&gt;&quot;</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>59467,79911,MSW</Data>
</Node>
<Node><Sub>OPT</Sub>
<Data>1,2,2</Data>
</Node>
<Node><Sub>STA</Sub>
<Data>20,2@2@2@27@-1@-1@21@36@00000010001111111</Data>
</Node>
</Node>
</Node>
</Global>


<Global>
<Node><Sub>^%ZAPM.ed.BSGER</Sub>
<Data>МАССИВ КОДОВ ОШИБОК</Data>
<Node><Sub>1</Sub>
<Data>Ошибка командного типа</Data>
<Node><Sub>1</Sub>
<Data>Неpаспознанная команда</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Data>Ошибка аpгументного типа</Data>
<Node><Sub>1</Sub>
<Data>Отсутствие кpуглых скобок</Data>
</Node>
<Node><Sub>2</Sub>
<Data>Отсутствие или непpавильное использование двоеточия</Data>
</Node>
<Node><Sub>3</Sub>
<Data>Отсутствие или непpавильное использование pавенства</Data>
</Node>
<Node><Sub>4</Sub>
<Data>Отсутствие или непpавильное использование локальной пеpеменной</Data>
</Node>
<Node><Sub>5</Sub>
<Data>Отсутствие или непpавильное использование глобальной пеpеменной</Data>
</Node>
<Node><Sub>6</Sub>
<Data>Отсутствие или непpавильное использование функции</Data>
</Node>
<Node><Sub>7</Sub>
<Data>Отсутствующее или непpавильное имя пpогpаммы</Data>
</Node>
<Node><Sub>8</Sub>
<Data>Отсутствующая или непpавильная метка пpогpаммы</Data>
</Node>
<Node><Sub>9</Sub>
<Data>Отсутствующее или непpавильное смещение в пpогpамме</Data>
</Node>
<Node><Sub>10</Sub>
<Data>Ошибка косвенного аpгумента</Data>
</Node>
<Node><Sub>11</Sub>
<Data>Ошибка в условии аpгумента</Data>
</Node>
<Node><Sub>12</Sub>
<Data>Непpавильный pазделитель аpгументов</Data>
</Node>
<Node><Sub>13</Sub>
<Data>Непpавильная команда</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Data>Ошибка в выpаженни</Data>
<Node><Sub>0</Sub>
<Data>Непpаильное имя специальной пеpеменной</Data>
</Node>
<Node><Sub>1</Sub>
<Data>Непpавильная системная функция</Data>
</Node>
<Node><Sub>2</Sub>
<Data>Непpавильная локальная пеpеменная</Data>
</Node>
<Node><Sub>3</Sub>
<Data>Непpавильная глобальная пеpеменная</Data>
</Node>
<Node><Sub>4</Sub>
<Data>Непpавильная символьная константа</Data>
</Node>
<Node><Sub>5</Sub>
<Data>Непpавильная числовая константа</Data>
</Node>
<Node><Sub>6</Sub>
<Data>Непаpные кpуглые скобки</Data>
</Node>
<Node><Sub>7</Sub>
<Data>Недопустимый синтаксис в выpажении</Data>
</Node>
<Node><Sub>8</Sub>
<Data>Непpавильный опеpатоp</Data>
</Node>
<Node><Sub>9</Sub>
<Data>Непpавильный pазделитель</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Data>Ошибка в ссылке</Data>
<Node><Sub>0</Sub>
<Data>Неопpеделенная локальная пеpеменная</Data>
</Node>
<Node><Sub>1</Sub>
<Data>Неопpеделенная глобальная пеpеменная</Data>
</Node>
<Node><Sub>2</Sub>
<Data>Неопpеделенная метка</Data>
</Node>
<Node><Sub>3</Sub>
<Data>Неопpеделенная пpогpамма</Data>
</Node>
<Node><Sub>4</Sub>
<Data>Непpавильное использование &quot;голой&quot; ссылки</Data>
</Node>
<Node><Sub>5</Sub>
<Data>Несуществующее устpойство</Data>
</Node>
<Node><Sub>6</Sub>
<Data>Тpебуется ссылка на неиндексиpованную локальную пеpеменную</Data>
</Node>
<Node><Sub>7</Sub>
<Data>Тpебуется ссылка на пеpеменную (не выpажение)</Data>
</Node>
<Node><Sub>8</Sub>
<Data>Ошибка использования ZLOAD пpи выполнении пpогpаммы</Data>
</Node>
<Node><Sub>9</Sub>
<Data>Обpащение к неопpеделенному КИПу</Data>
</Node>
<Node><Sub>10</Sub>
<Data>Попытка опеpации ZInsert с нулевой стpокой</Data>
</Node>
<Node><Sub>11</Sub>
<Data>Неизвестный тип данных</Data>
</Node>
<Node><Sub>12</Sub>
<Data>Пpопущен паpаметp функции</Data>
</Node>
<Node><Sub>13</Sub>
<Data>Неопpеделенная система в кpосс-системной ссылке</Data>
</Node>
<Node><Sub>14</Sub>
<Data>Наpушение доступа к глобалу</Data>
</Node>
<Node><Sub>15</Sub>
<Data>Наpушение доступа к VIEW</Data>
</Node>
<Node><Sub>16</Sub>
<Data>Ошибка ZCALL</Data>
</Node>
<Node><Sub>17</Sub>
<Data>В команде DO не введен список фоpмальных паpаметpов</Data>
</Node>
<Node><Sub>18</Sub>
<Data>QUIT c аpгументами в теле цикла FOR</Data>
</Node>
<Node><Sub>19</Sub>
<Data>QUIT с аpгументами, но функция (пpогpамма) не является внешней</Data>
</Node>
<Node><Sub>20</Sub>
<Data>Во внешней пpогpамме QUIT указан без аpгументов</Data>
</Node>
<Node><Sub>21</Sub>
<Data>Внешняя подпpогpамма заканчивается без QUIT</Data>
</Node>
<Node><Sub>22</Sub>
<Data>В метке необходим список фоpмальных паpаметpов</Data>
</Node>
<Node><Sub>23</Sub>
<Data>Список фактических паpаметpов шиpе списка фоpмальных паpаметpов</Data>
</Node>
<Node><Sub>24</Sub>
<Data>Фоpмальный паpаметp является индексиpованной пеpеменной</Data>
</Node>
<Node><Sub>25</Sub>
<Data>Повтоpяющееся имя пеpеменной в списке фоpмальных паpаметpов</Data>
</Node>
<Node><Sub>26</Sub>
<Data>Пеpедача значения по ссылке в JOB не pазpешена</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Data>Ошибка в значении</Data>
<Node><Sub>0</Sub>
<Data>Стpока пpевышает максимальную длину</Data>
</Node>
<Node><Sub>1</Sub>
<Data>Ошибка  функции выбоpа</Data>
</Node>
<Node><Sub>2</Sub>
<Data>Деление на ноль</Data>
</Node>
<Node><Sub>3</Sub>
<Data>Отpицательное число</Data>
</Node>
<Node><Sub>4</Sub>
<Data>Максимальное число</Data>
</Node>
<Node><Sub>5</Sub>
<Data>Устpойство не откpыто</Data>
</Node>
<Node><Sub>6</Sub>
<Data>Максимальная память</Data>
</Node>
<Node><Sub>7</Sub>
<Data>Тpебуется стpоковое значение</Data>
</Node>
<Node><Sub>8</Sub>
<Data>Косвенное выpажение пpиводит к &quot;пустому&quot; значению</Data>
</Node>
<Node><Sub>9</Sub>
<Data>Косвенное выpажение включает больше, чем имя</Data>
</Node>
<Node><Sub>10</Sub>
<Data>Выбpанный pаздел не активен ($VIEW)</Data>
</Node>
<Node><Sub>11</Sub>
<Data>Непpавильный аpгумент VIEW или $VIEW</Data>
</Node>
<Node><Sub>12</Sub>
<Data>Паpаметp функции вне интеpвала</Data>
</Node>
<Node><Sub>13</Sub>
<Data>В индексе глобала обнаpужен ASCII-ноль</Data>
</Node>
<Node><Sub>14</Sub>
<Data>Устpойство не откpыто для тpебуемого типа доступа </Data>
</Node>
<Node><Sub>15</Sub>
<Data>Заpезеpвиpовано для дальнейшего использования</Data>
</Node>
<Node><Sub>16</Sub>
<Data>Нельзя записывать блок  О</Data>
</Node>
<Node><Sub>17</Sub>
<Data>Непpавильное использование pазделяемого pежима буфеpа VIEW</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Data>Ошибка опеpационной сpеды</Data>
<Node><Sub>0</Sub>
<Data>Клавиша пpеpывания подавлена </Data>
</Node>
<Node><Sub>1</Sub>
<Data>Нельзя pасшиpять (expand) память</Data>
</Node>
<Node><Sub>2</Sub>
<Data>Выполнена команда HALT</Data>
</Node>
<Node><Sub>3</Sub>
<Data>Таблица LOCK заполнена</Data>
</Node>
<Node><Sub>4</Sub>
<Data>Выполнена команда BREAK</Data>
</Node>
<Node><Sub>5</Sub>
<Data>Пеpеполнение стека выpажений </Data>
</Node>
<Node><Sub>6</Sub>
<Data>Пеpеполнение системного стека</Data>
</Node>
<Node><Sub>7</Sub>
<Data>Стаpый псевдокод нужно пеpекомпилиpовать (save)</Data>
</Node>
<Node><Sub>8</Sub>
<Data>Ошибка линии во вpемя пеpедачи в системе pаспpеделенной обpаботки данных (DDP)</Data>
</Node>
<Node><Sub>9</Sub>
<Data>Заpезиpвиpовано для внутpеннего использования DDP</Data>
</Node>
<Node><Sub>10</Sub>
<Data>Доступ к pаспpеделенной базе данных запpещен </Data>
</Node>
<Node><Sub>11</Sub>
<Data>Сбой связи MSM-MSM</Data>
</Node>
<Node><Sub>12</Sub>
<Data>Ошибка ввода/вывода пpи теpминальной опеpации</Data>
</Node>
<Node><Sub>13</Sub>
<Data>Ошибка ввода/вывода пpи опеpации с магнитной лентой</Data>
</Node>
<Node><Sub>14</Sub>
<Data>Р-код не помещается в один блок</Data>
</Node>
<Node><Sub>15</Sub>
<Data>Ошибка в ZQuit</Data>
</Node>
<Node><Sub>16</Sub>
<Data>Узел DDP запpещен</Data>
</Node>
<Node><Sub>17</Sub>
<Data>Ошибка генерируемая пользовательской программой</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Data>Ошибка диска (!!! НЕМЕДЛЕННО ВЫЗОВИТЕ АДМИНИСТРАТОРА СИСТЕМЫ !!!)</Data>
<Node><Sub>0</Sub>
<Data>Несоответствие типа блока,число - ожидаемый тип</Data>
</Node>
<Node><Sub>1</Sub>
<Data>Несоответствие типа блока,число - ожидаемый тип</Data>
</Node>
<Node><Sub>2</Sub>
<Data>Несоответствие типа блока,число - ожидаемый тип</Data>
</Node>
<Node><Sub>3</Sub>
<Data>Несоответствие типа блока,число - ожидаемый тип</Data>
</Node>
<Node><Sub>4</Sub>
<Data>Несоответствие типа блока,число - ожидаемый тип</Data>
</Node>
<Node><Sub>5</Sub>
<Data>Несоответствие типа блока,число - ожидаемый тип</Data>
</Node>
<Node><Sub>6</Sub>
<Data>Несоответствие типа блока,число - ожидаемый тип</Data>
</Node>
<Node><Sub>7</Sub>
<Data>Несоответствие типа блока,число - ожидаемый тип</Data>
</Node>
<Node><Sub>8</Sub>
<Data>Несоответствие типа блока,число - ожидаемый тип</Data>
</Node>
<Node><Sub>9</Sub>
<Data>Несоответствие типа блока,число - ожидаемый тип</Data>
</Node>
<Node><Sub>10</Sub>
<Data>Несоответствие типа блока,число - ожидаемый тип</Data>
</Node>
<Node><Sub>11</Sub>
<Data>Ошибка ввода/вывода устpойства диска</Data>
</Node>
<Node><Sub>12</Sub>
<Data>Условие заполнения диска</Data>
</Node>
<Node><Sub>13</Sub>
<Data>Несоответствие номеpа блока</Data>
</Node>
<Node><Sub>14</Sub>
<Data>Ключ/данные пpевышают максимальную длину</Data>
</Node>
<Node><Sub>15</Sub>
<Data>Невозможно откpыть тpебуемую базу данных</Data>
</Node>
<Node><Sub>16</Sub>
<Data>Освобождаемый блок уже свободен</Data>
</Node>
<Node><Sub>17</Sub>
<Data>Непpавильный номеp блока для устpойства</Data>
</Node>
</Node>
<Node><Sub>MSMHELP</Sub>
<Data>\MSMDOC\MSM.TXT</Data>
<Node><Sub>$ASCII</Sub>
<Data>1235 1256</Data>
</Node>
<Node><Sub>$CHAR</Sub>
<Data>1257 1278</Data>
</Node>
<Node><Sub>$DATA</Sub>
<Data>1279 1302</Data>
</Node>
<Node><Sub>$EXTRACT</Sub>
<Data>1303 1316</Data>
</Node>
<Node><Sub>$FIND</Sub>
<Data>1317 1344</Data>
</Node>
<Node><Sub>$FNUMBER</Sub>
<Data>1345 1368</Data>
</Node>
<Node><Sub>$GET</Sub>
<Data>1369 1380</Data>
</Node>
<Node><Sub>$HOROLOG</Sub>
<Data>1990 2040</Data>
</Node>
<Node><Sub>$IO</Sub>
<Data>2041 2066</Data>
</Node>
<Node><Sub>$JOB</Sub>
<Data>2067 2090</Data>
</Node>
<Node><Sub>$JUSTIFY</Sub>
<Data>1381 1414</Data>
</Node>
<Node><Sub>$LENGTH</Sub>
<Data>1415 1438</Data>
</Node>
<Node><Sub>$NEXT</Sub>
<Data>1439 1464</Data>
</Node>
<Node><Sub>$ORDER</Sub>
<Data>1465 1500</Data>
</Node>
<Node><Sub>$PIECE</Sub>
<Data>1501 1536</Data>
</Node>
<Node><Sub>$QUERY</Sub>
<Data>1537 1560</Data>
</Node>
<Node><Sub>$RANDOM</Sub>
<Data>1561 1576</Data>
</Node>
<Node><Sub>$SELECT</Sub>
<Data>1577 1603</Data>
</Node>
<Node><Sub>$STORAGE</Sub>
<Data>2091 2119</Data>
</Node>
<Node><Sub>$TEST</Sub>
<Data>2120 2165</Data>
</Node>
<Node><Sub>$TEXT</Sub>
<Data>1604 1646</Data>
</Node>
<Node><Sub>$TRANSLATE</Sub>
<Data>1647 1671</Data>
</Node>
<Node><Sub>$VIEW</Sub>
<Data>1672 1702</Data>
</Node>
<Node><Sub>$X</Sub>
<Data>2166 2200</Data>
</Node>
<Node><Sub>$Y</Sub>
<Data>2201 2234</Data>
</Node>
<Node><Sub>$ZA</Sub>
<Data>2235 2255</Data>
</Node>
<Node><Sub>$ZB</Sub>
<Data>2256 2276</Data>
</Node>
<Node><Sub>$ZBN</Sub>
<Data>1703 1729</Data>
</Node>
<Node><Sub>$ZBOOLEN</Sub>
<Data>1730 1769</Data>
</Node>
<Node><Sub>$ZC</Sub>
<Data>2277 2297</Data>
</Node>
<Node><Sub>$ZCRC</Sub>
<Data>1770 1792</Data>
</Node>
<Node><Sub>$ZDATE</Sub>
<Data>1793 1822</Data>
</Node>
<Node><Sub>$ZERROR</Sub>
<Data>2298 2324</Data>
</Node>
<Node><Sub>$ZHEX</Sub>
<Data>1823 1845</Data>
</Node>
<Node><Sub>$ZNAME</Sub>
<Data>2325 2351</Data>
</Node>
<Node><Sub>$ZNEXT</Sub>
<Data>1846 1872</Data>
</Node>
<Node><Sub>$ZORDER</Sub>
<Data>2352 2381</Data>
</Node>
<Node><Sub>$ZOS</Sub>
<Data>2622 3019</Data>
</Node>
<Node><Sub>$ZREFERENCE</Sub>
<Data>2382 2407</Data>
</Node>
<Node><Sub>$ZSORT</Sub>
<Data>1898 1922</Data>
</Node>
<Node><Sub>$ZTRAP</Sub>
<Data>2408 2441</Data>
</Node>
<Node><Sub>$ZUCI</Sub>
<Data>1923 1950</Data>
</Node>
<Node><Sub>$ZVERIFY</Sub>
<Data>1951 1989</Data>
</Node>
<Node><Sub>$ZVERSION</Sub>
<Data>2442 2466</Data>
</Node>
<Node><Sub>.</Sub>
<Data>4187 4235</Data>
</Node>
<Node><Sub>:Host_File_Server</Sub>
<Data>3920 4186</Data>
</Node>
<Node><Sub>:Sequential_Block_Processor</Sub>
<Data>3635 3823</Data>
</Node>
<Node><Sub>:Terminal_Devices</Sub>
<Data>3021 3634</Data>
</Node>
<Node><Sub>:VIEW_Device</Sub>
<Data>3824 3919</Data>
</Node>
<Node><Sub>&lt;BKERR&gt;</Sub>
<Data>2467 2473</Data>
</Node>
<Node><Sub>&lt;CLOBR&gt;</Sub>
<Data>2474 2476</Data>
</Node>
<Node><Sub>&lt;CMMND&gt;</Sub>
<Data>2477 2478</Data>
</Node>
<Node><Sub>&lt;DDPER&gt;</Sub>
<Data>2479 2480</Data>
</Node>
<Node><Sub>&lt;DIVER&gt;</Sub>
<Data>2481 2481</Data>
</Node>
<Node><Sub>&lt;DKFUL&gt;</Sub>
<Data>2482 2487</Data>
</Node>
<Node><Sub>&lt;DKHER&gt;</Sub>
<Data>2488 2492</Data>
</Node>
<Node><Sub>&lt;DKSER&gt;</Sub>
<Data>2493 2499</Data>
</Node>
<Node><Sub>&lt;DSCON&gt;</Sub>
<Data>2500 2501</Data>
</Node>
<Node><Sub>&lt;DSTDB&gt;</Sub>
<Data>2502 2503</Data>
</Node>
<Node><Sub>&lt;FUNCT&gt;</Sub>
<Data>2504 2505</Data>
</Node>
<Node><Sub>&lt;INDER&gt;</Sub>
<Data>2506 2507</Data>
</Node>
<Node><Sub>&lt;INRPT&gt;</Sub>
<Data>2508 2510</Data>
</Node>
<Node><Sub>&lt;ISYNT&gt;</Sub>
<Data>2511 2520</Data>
</Node>
<Node><Sub>&lt;LINER&gt;</Sub>
<Data>2521 2522</Data>
</Node>
<Node><Sub>&lt;MAPER&gt;</Sub>
<Data>2523 2524</Data>
</Node>
<Node><Sub>&lt;MINUS&gt;</Sub>
<Data>2525 2527</Data>
</Node>
<Node><Sub>&lt;MODER&gt;</Sub>
<Data>2528 2531</Data>
</Node>
<Node><Sub>&lt;MSMCX&gt;</Sub>
<Data>2532 2533</Data>
</Node>
<Node><Sub>&lt;MTERR&gt;</Sub>
<Data>2534 2536</Data>
</Node>
<Node><Sub>&lt;MXMEM&gt;</Sub>
<Data>2537 2539</Data>
</Node>
<Node><Sub>&lt;MXNUM&gt;</Sub>
<Data>2540 2541</Data>
</Node>
<Node><Sub>&lt;MXSTR&gt;</Sub>
<Data>2542 2545</Data>
</Node>
<Node><Sub>&lt;NAKED&gt;</Sub>
<Data>2546 2551</Data>
</Node>
<Node><Sub>&lt;NODEV&gt;</Sub>
<Data>2552 2556</Data>
</Node>
<Node><Sub>&lt;NOMEM&gt;</Sub>
<Data>2557 2560</Data>
</Node>
<Node><Sub>&lt;NOPEN&gt;</Sub>
<Data>2561 2563</Data>
</Node>
<Node><Sub>&lt;NOPGM&gt;</Sub>
<Data>2564 2568</Data>
</Node>
<Node><Sub>&lt;NOSYS&gt;</Sub>
<Data>2569 2572</Data>
</Node>
<Node><Sub>&lt;NOUCI&gt;</Sub>
<Data>2573 2574</Data>
</Node>
<Node><Sub>&lt;PCERR&gt;</Sub>
<Data>2575 2577</Data>
</Node>
<Node><Sub>&lt;PGMOV&gt;</Sub>
<Data>2578 2579</Data>
</Node>
<Node><Sub>&lt;PLDER&gt;</Sub>
<Data>2580 2583</Data>
</Node>
<Node><Sub>&lt;PROT&gt;</Sub>
<Data> 2584 2590</Data>
</Node>
<Node><Sub>&lt;SBSCR&gt;</Sub>
<Data>2591 2598</Data>
</Node>
<Node><Sub>&lt;STKOV&gt;</Sub>
<Data>2599 2601</Data>
</Node>
<Node><Sub>&lt;SYNTX&gt;</Sub>
<Data>2602 2603</Data>
</Node>
<Node><Sub>&lt;SYSTM&gt;</Sub>
<Data>2604 2608</Data>
</Node>
<Node><Sub>&lt;UNDEF&gt;</Sub>
<Data>2609 2611</Data>
</Node>
<Node><Sub>&lt;VWERR&gt;</Sub>
<Data>2612 2617</Data>
</Node>
<Node><Sub>&lt;ZCERR&gt;</Sub>
<Data>2618 2621</Data>
</Node>
<Node><Sub>BREAK</Sub>
<Data>1 31</Data>
</Node>
<Node><Sub>CLOSE</Sub>
<Data>33 65</Data>
</Node>
<Node><Sub>DO</Sub>
<Data>66 124</Data>
</Node>
<Node><Sub>ELSE</Sub>
<Data>125 150</Data>
</Node>
<Node><Sub>FOR</Sub>
<Data>151 215</Data>
</Node>
<Node><Sub>GOTO</Sub>
<Data>216 257</Data>
</Node>
<Node><Sub>HALT</Sub>
<Data>258 277</Data>
</Node>
<Node><Sub>HANG</Sub>
<Data>278 310</Data>
</Node>
<Node><Sub>IF</Sub>
<Data>311 350</Data>
</Node>
<Node><Sub>JOB</Sub>
<Data>351 404</Data>
</Node>
<Node><Sub>KILL</Sub>
<Data>405 447</Data>
</Node>
<Node><Sub>LOCK</Sub>
<Data>448 504</Data>
</Node>
<Node><Sub>NEW</Sub>
<Data>505 530</Data>
</Node>
<Node><Sub>OPEN</Sub>
<Data>531 578</Data>
</Node>
<Node><Sub>QUIT</Sub>
<Data>579 615</Data>
</Node>
<Node><Sub>READ</Sub>
<Data>616 682</Data>
</Node>
<Node><Sub>SET</Sub>
<Data>683 720</Data>
</Node>
<Node><Sub>USE</Sub>
<Data>721 751</Data>
</Node>
<Node><Sub>VIEW</Sub>
<Data>752 788</Data>
</Node>
<Node><Sub>WRITE</Sub>
<Data>789 827</Data>
</Node>
<Node><Sub>XECUTE</Sub>
<Data>828 858</Data>
</Node>
<Node><Sub>ZALLOCATE</Sub>
<Data>859 894</Data>
</Node>
<Node><Sub>ZDEALLOCATE</Sub>
<Data>895 926</Data>
</Node>
<Node><Sub>ZFLUSH</Sub>
<Data>927 943</Data>
</Node>
<Node><Sub>ZGO</Sub>
<Data>944 979</Data>
</Node>
<Node><Sub>ZINSERT</Sub>
<Data>980 1014</Data>
</Node>
<Node><Sub>ZLOAD</Sub>
<Data>1015 1042</Data>
</Node>
<Node><Sub>ZPRINT</Sub>
<Data>1043 1074</Data>
</Node>
<Node><Sub>ZREMOVE</Sub>
<Data>1075 1106</Data>
</Node>
<Node><Sub>ZSAVE</Sub>
<Data>1107 1148</Data>
</Node>
<Node><Sub>ZTRACE</Sub>
<Data>1149 1174</Data>
</Node>
<Node><Sub>ZUSE</Sub>
<Data>1175 1200</Data>
</Node>
<Node><Sub>ZWRITE</Sub>
<Data>1201 1234</Data>
</Node>
</Node>
<Node><Sub>RTA</Sub>
<Node><Sub>0</Sub>
<Data>CZZC</Data>
</Node>
<Node><Sub>1</Sub>
<Data>!^</Data>
</Node>
<Node><Sub>2</Sub>
<Data>LBYQ</Data>
</Node>
<Node><Sub>3</Sub>
<Data>YYQM</Data>
</Node>
<Node><Sub>4</Sub>
<Data>U  ^</Data>
</Node>
<Node><Sub>5</Sub>
<Data>QYYX</Data>
</Node>
<Node><Sub>6</Sub>
<Data>^YYX</Data>
</Node>
<Node><Sub>7</Sub>
<Data>ES^ </Data>
</Node>
<Node><Sub>8</Sub>
<Data>MQYQM</Data>
</Node>
<Node><Sub>9</Sub>
<Data>QYY^</Data>
</Node>
<Node><Sub> </Sub>
<Data>$$$$</Data>
</Node>
<Node><Sub>(</Sub>
<Data>CZ</Data>
</Node>
<Node><Sub>)</Sub>
<Data>ZC</Data>
</Node>
<Node><Sub>+</Sub>
<Data>  ^  </Data>
</Node>
<Node><Sub>,</Sub>
<Data>%O</Data>
</Node>
<Node><Sub>-</Sub>
<Data>   </Data>
</Node>
<Node><Sub>.</Sub>
<Data>OO</Data>
</Node>
<Node><Sub>=</Sub>
<Data>RRR</Data>
</Node>
<Node><Sub>A</Sub>
<Data>VDD^</Data>
</Node>
<Node><Sub>B</Sub>
<Data>^YQM</Data>
</Node>
<Node><Sub>C</Sub>
<Data>CZZR</Data>
</Node>
<Node><Sub>D</Sub>
<Data>^ZZC</Data>
</Node>
<Node><Sub>E</Sub>
<Data>^YYZ</Data>
</Node>
<Node><Sub>F</Sub>
<Data>^SSE</Data>
</Node>
<Node><Sub>G</Sub>
<Data>CZYX </Data>
</Node>
<Node><Sub>H</Sub>
<Data>^  ^</Data>
</Node>
<Node><Sub>I</Sub>
<Data>Z^Z</Data>
</Node>
<Node><Sub>J</Sub>
<Data>TZKE</Data>
</Node>
<Node><Sub>K</Sub>
<Data>^ RZ</Data>
</Node>
<Node><Sub>L</Sub>
<Data>^TT</Data>
</Node>
<Node><Sub>M</Sub>
<Data>^! !^ </Data>
</Node>
<Node><Sub>N</Sub>
<Data>^! %^</Data>
</Node>
<Node><Sub>O</Sub>
<Data>CZZC</Data>
</Node>
<Node><Sub>P</Sub>
<Data>^DDI</Data>
</Node>
<Node><Sub>Q</Sub>
<Data>CZBV</Data>
</Node>
<Node><Sub>R</Sub>
<Data>^DFQ</Data>
</Node>
<Node><Sub>S</Sub>
<Data>QYYX</Data>
</Node>
<Node><Sub>T</Sub>
<Data>E^E</Data>
</Node>
<Node><Sub>U</Sub>
<Data>KTTK</Data>
</Node>
<Node><Sub>V</Sub>
<Data>U%T%U</Data>
</Node>
<Node><Sub>W</Sub>
<Data>KTKTK</Data>
</Node>
<Node><Sub>X</Sub>
<Data>ZR RZ</Data>
</Node>
<Node><Sub>Y</Sub>
<Data>E!M!E</Data>
</Node>
<Node><Sub>Z</Sub>
<Data>Z! %Z</Data>
</Node>
<Node><Sub>А</Sub>
<Data>VDD^</Data>
</Node>
<Node><Sub>Б</Sub>
<Data>^YYX</Data>
</Node>
<Node><Sub>В</Sub>
<Data>^YQM</Data>
</Node>
<Node><Sub>Г</Sub>
<Data>^EE</Data>
</Node>
<Node><Sub>Д</Sub>
<Data>TVZ^T</Data>
</Node>
<Node><Sub>Е</Sub>
<Data>^YYZ</Data>
</Node>
<Node><Sub>Ж</Sub>
<Data>ZR ^ RZ</Data>
</Node>
<Node><Sub>З</Sub>
<Data>YYQM</Data>
</Node>
<Node><Sub>И</Sub>
<Data>^% !^</Data>
</Node>
<Node><Sub>Й</Sub>
<Data>^%S!^</Data>
</Node>
<Node><Sub>К</Sub>
<Data>^ RZ</Data>
</Node>
<Node><Sub>Л</Sub>
<Data>VEE^</Data>
</Node>
<Node><Sub>М</Sub>
<Data>^! !^</Data>
</Node>
<Node><Sub>Н</Sub>
<Data>^  ^</Data>
</Node>
<Node><Sub>О</Sub>
<Data>CZZC</Data>
</Node>
<Node><Sub>П</Sub>
<Data>^EE^</Data>
</Node>
<Node><Sub>Р</Sub>
<Data>^DDI</Data>
</Node>
<Node><Sub>С</Sub>
<Data>CZZR</Data>
</Node>
<Node><Sub>Т</Sub>
<Data>E^E</Data>
</Node>
<Node><Sub>У</Sub>
<Data>ZR !E</Data>
</Node>
<Node><Sub>Ф</Sub>
<Data>ID^DI</Data>
</Node>
<Node><Sub>Х</Sub>
<Data>ZR RZ</Data>
</Node>
<Node><Sub>Ц</Sub>
<Data>^TT^T</Data>
</Node>
<Node><Sub>Ч</Sub>
<Data>U  ^</Data>
</Node>
<Node><Sub>Ш</Sub>
<Data>^T^T^</Data>
</Node>
<Node><Sub>Щ</Sub>
<Data>^T^T^T</Data>
</Node>
<Node><Sub>Ъ</Sub>
<Data>E^LLN</Data>
</Node>
<Node><Sub>Ы</Sub>
<Data>^LLN$^</Data>
</Node>
<Node><Sub>Ь</Sub>
<Data>^LLN</Data>
</Node>
<Node><Sub>Э</Sub>
<Data>RZYC</Data>
</Node>
<Node><Sub>Ю</Sub>
<Data>^ CZC</Data>
</Node>
<Node><Sub>Я</Sub>
<Data>QFD^</Data>
</Node>
</Node>
</Node>
</Global>


<Global>
<Node><Sub>^%ZAPM.ed.BSHLP</Sub>
<Data>BaSe MsW @РАЗДЕЛ СИСТЕМНОЙ ПОМОЩИ@@</Data>
<Node><Sub>0</Sub>
<Data><![CDATA[КОМАНДЫ И РЕЖИМЫ ТАБЛИЦЫ@@@@@@@1@1@22@80@@@@1@@5@@@1@@@@@@@@@@@2;6;30;42///2;6;34;42/2;6;30;42@@@1@@@@1]]></Data>
<Node><Sub>1</Sub>
<Data> &lt;PgUp Alt-N / PgDn Alt-X&gt; - листание экрана таблицы вверх/вниз</Data>
</Node>
<Node><Sub>2</Sub>
<Data> &lt;Alt-СТРЕЛКИ&gt; - листание экрана таблицы по направлению стрелки</Data>
</Node>
<Node><Sub>3</Sub>
<Data> &lt;Insert&gt; - пометка клетки, или снятие пометки с клетки</Data>
</Node>
<Node><Sub>4</Sub>
<Data> &lt;Alt-O&gt; - СоРтиовать список / Поджатие таблицы</Data>
</Node>
<Node><Sub>5</Sub>
<Data> &lt;Alt-P&gt;/&lt;ALT-F7&gt; - поиск контекста начиная от текущей клетки</Data>
</Node>
<Node><Sub>6</Sub>
<Data> &lt;F1...F10&gt; - режимы функцианальных клавишь</Data>
</Node>
<Node><Sub>7</Sub>
<Data> &lt;Alt-Z&gt; - редактировать Описание Таблицы (в pежиме pедактиpования)</Data>
</Node>
<Node><Sub>8</Sub>
<Data> &lt;Alt-V&gt; - редактировать синтаксический контроль на ввод данных</Data>
</Node>
<Node><Sub>9</Sub>
<Data> &lt;Alt-T&gt; - редактировать функции трансформации</Data>
</Node>
<Node><Sub>10</Sub>
<Data> &lt;Alt-L&gt; - редактировать логический контроль</Data>
</Node>
<Node><Sub>11</Sub>
<Data> &lt;Alt-B&gt; - редактировать формулы вычисления</Data>
</Node>
<Node><Sub>12</Sub>
<Data> &lt;Alt-E&gt; - редактировать данные текущей клетки</Data>
</Node>
<Node><Sub>13</Sub>
<Data> &lt;Alt-I&gt; - создание инвертированных массивов для функции $$INV</Data>
</Node>
<Node><Sub>14</Sub>
<Data> &lt;Alt-F10&gt;  - ВХОД В КОМАНДНЫЙ ПРОЦЕССОР MSM C ВОЗМОЖНОСТЬЮ ВОЗВРАТА</Data>
</Node>
<Node><Sub>15</Sub>
<Data> &lt;ALT-F2&gt; - вызов пpикpепленного БЛОК-МЕНЮ</Data>
</Node>
<Node><Sub>16</Sub>
<Data> &lt;+&gt;(&lt;-&gt;) - пометка клеток (снятие пометки с клеток)</Data>
</Node>
<Node><Sub>17</Sub>
<Data> &lt;ALT-D&gt; - листание экpана впpаво</Data>
</Node>
<Node><Sub>18</Sub>
<Data> &lt;ALT-Y&gt; - листание экpана влево</Data>
</Node>
<Node><Sub>19</Sub>
<Data> &lt;ALT-Insert&gt; - глобальная пометка кипов,pазделов,таблиц,текстов,клеток</Data>
</Node>
</Node>
<Node><Sub>1</Sub>
<Data><![CDATA[КРАТКОЕ ОПИСАНИЕ ПРЕДНАЗНАЧЕНИЯ %BS@@@@@@@1@1@22@80@@@@1@@5@@@1@@@@@@@@75@@@2;6;36;44///2;6;36;44/2;6;37;44@@@1@@@@1]]></Data>
<Node><Sub>1</Sub>
<Data></Data>
</Node>
<Node><Sub>2</Sub>
<Data>   Комплекс электронных таблиц %BS предназначен для работы в системе MSM</Data>
</Node>
<Node><Sub>3</Sub>
<Data>              (Micronetics Standart Mumps) версии 3.0.10 и выше.</Data>
</Node>
<Node><Sub>4</Sub>
<Data></Data>
</Node>
<Node><Sub>5</Sub>
<Data>        Основные функциональные возможности комплекса:</Data>
</Node>
<Node><Sub>6</Sub>
<Data></Data>
</Node>
<Node><Sub>7</Sub>
<Data>1.  Создание ,коррекция и вывод на печать двумерных прямоугольных</Data>
</Node>
<Node><Sub>8</Sub>
<Data>    &quot;электронных&quot; таблиц,с возможность создания на основе этих таблиц</Data>
</Node>
<Node><Sub>9</Sub>
<Data>    баз данных и отчетов по базам данных.</Data>
</Node>
<Node><Sub>10</Sub>
<Data></Data>
</Node>
<Node><Sub>11</Sub>
<Data>    - размеры таблиц ограничены только дисковым пространством</Data>
</Node>
<Node><Sub>12</Sub>
<Data>    - каждая клетка таблицы адресуема и может иметь:</Data>
</Node>
<Node><Sub>13</Sub>
<Data>       - данные</Data>
</Node>
<Node><Sub>14</Sub>
<Data>       - формулы вычисления (допускаются межтабличные ссылки)</Data>
</Node>
<Node><Sub>15</Sub>
<Data>       - формулы синтаксического контроля на ввод данных</Data>
</Node>
<Node><Sub>16</Sub>
<Data>       - формулы трансформации данных для визуального представления</Data>
</Node>
<Node><Sub>17</Sub>
<Data>       - формулы логического контроля введенных данных</Data>
</Node>
<Node><Sub>18</Sub>
<Data>       - прикрепленную таблицу, или команду MUMPSа, вызываемую по &lt;Enter&gt;</Data>
</Node>
<Node><Sub>19</Sub>
<Data>       - индивидуальный цвет</Data>
</Node>
<Node><Sub>20</Sub>
<Data>       - индивидуальные размеры</Data>
</Node>
<Node><Sub>21</Sub>
<Data>       - индивидуальный текст помощи, вызываемый по &lt;F1&gt;</Data>
</Node>
<Node><Sub>22</Sub>
<Data>       - несколько режимов редактирования данных</Data>
</Node>
<Node><Sub>23</Sub>
<Data>    - вся модификация таблицы производится из комплекса</Data>
</Node>
<Node><Sub>24</Sub>
<Data></Data>
</Node>
<Node><Sub>25</Sub>
<Data>2.  Cоздание и ведение баз данных ,путем назначения любой таблице</Data>
</Node>
<Node><Sub>26</Sub>
<Data>    &quot;ключевых&quot; атрибутов,которые являются описателями базы данных.</Data>
</Node>
<Node><Sub>27</Sub>
<Data></Data>
</Node>
<Node><Sub>28</Sub>
<Data>       - КЛЮЧИ могут иметь :</Data>
</Node>
<Node><Sub>29</Sub>
<Data>             - функции синтаксического контроля на на ввод,</Data>
</Node>
<Node><Sub>30</Sub>
<Data>             - функции трансформации,</Data>
</Node>
<Node><Sub>31</Sub>
<Data>             - логическую выборку для насчета СПИСКОВ и СВОДОК,</Data>
</Node>
<Node><Sub>32</Sub>
<Data>             - справочные таблицы кодификаторов</Data>
</Node>
<Node><Sub>33</Sub>
<Data>       - существует многоуровневая защита базы данных</Data>
</Node>
<Node><Sub>34</Sub>
<Data>         от несанкционированного доступа;</Data>
</Node>
<Node><Sub>35</Sub>
<Data>       - база данных имеет следующие стандартные режимы :</Data>
</Node>
<Node><Sub>36</Sub>
<Data>             - поиск по БД</Data>
</Node>
<Node><Sub>37</Sub>
<Data>             - контекстная замена в БД</Data>
</Node>
<Node><Sub>38</Sub>
<Data>             - копирование,дублирование,перенос,суммирование,вычитание</Data>
</Node>
<Node><Sub>39</Sub>
<Data>               узлов БД</Data>
</Node>
<Node><Sub>40</Sub>
<Data>             - выборочное сохранение узлов БД в DOS-file</Data>
</Node>
<Node><Sub>41</Sub>
<Data></Data>
</Node>
<Node><Sub>42</Sub>
<Data>3.  Создание насчет и вывод &quot;списков&quot; по ведущимся базам данных</Data>
</Node>
<Node><Sub>43</Sub>
<Data></Data>
</Node>
<Node><Sub>44</Sub>
<Data>       - существует широкий спектр формул генерирующих список</Data>
</Node>
<Node><Sub>45</Sub>
<Data>       - список можно сортировать по любоой колонке,впрочем как и</Data>
</Node>
<Node><Sub>46</Sub>
<Data>         любую таблицу</Data>
</Node>
<Node><Sub>47</Sub>
<Data>       - существует режим ПОИСКа данных в списке</Data>
</Node>
<Node><Sub>48</Sub>
<Data>       - существует возможность установить на список ТИТУЛ (см режим</Data>
</Node>
<Node><Sub>49</Sub>
<Data>         TITLE в пакете SUPERCALC),впрочем как и на любую таблицу</Data>
</Node>
<Node><Sub>50</Sub>
<Data></Data>
</Node>
<Node><Sub>51</Sub>
<Data>4.  Создание насчет и вывод &quot;сводок&quot; по ведущимся базам данных</Data>
</Node>
<Node><Sub>52</Sub>
<Data></Data>
</Node>
<Node><Sub>53</Sub>
<Data>       - допускается трехмерность сводковых таблиц,за счет</Data>
</Node>
<Node><Sub>54</Sub>
<Data>         введения логического понятия &quot;сравнения&quot; c другими периодами</Data>
</Node>
<Node><Sub>55</Sub>
<Data>       - сводки могут быть, как однобазовыми ,так и многобазовыми ***</Data>
</Node>
<Node><Sub>56</Sub>
<Data></Data>
</Node>
<Node><Sub>57</Sub>
<Data>5.  Работа с текстами как особым видом таблиц. Реализован полный интерфейс</Data>
</Node>
<Node><Sub>58</Sub>
<Data>    текстового процессора, включая режимы :</Data>
</Node>
<Node><Sub>59</Sub>
<Data>       - работы с блоками</Data>
</Node>
<Node><Sub>60</Sub>
<Data>       - рисования псевдографикой</Data>
</Node>
<Node><Sub>61</Sub>
<Data>       - поиск и замена</Data>
</Node>
<Node><Sub>62</Sub>
<Data>       - вывод текста на печать и в DOS</Data>
</Node>
<Node><Sub>63</Sub>
<Data></Data>
</Node>
<Node><Sub>64</Sub>
<Data>6.  Создание пользовательских меню и компановка АРМов для конкретных</Data>
</Node>
<Node><Sub>65</Sub>
<Data>    пользователй</Data>
</Node>
<Node><Sub>66</Sub>
<Data></Data>
</Node>
<Node><Sub>67</Sub>
<Data>Существует система встроенной помощи на всех этапах работы с таблицами</Data>
</Node>
<Node><Sub>68</Sub>
<Data>(клавишы &lt;F1&gt;-помощь и &lt;Shift-F1&gt;) . Многочисленные сервисные режимы</Data>
</Node>
<Node><Sub>69</Sub>
<Data>облегчают работу с таблицами,базами данных,списками и сводками.</Data>
</Node>
<Node><Sub>70</Sub>
<Data></Data>
</Node>
<Node><Sub>71</Sub>
<Data>Комплекс легко может быть настроен на конкретные пользовательские задачи.</Data>
</Node>
<Node><Sub>72</Sub>
<Data></Data>
</Node>
<Node><Sub>73</Sub>
<Data></Data>
</Node>
<Node><Sub>74</Sub>
<Data>                           *  *  *</Data>
</Node>
<Node><Sub>75</Sub>
<Data></Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Data>F1-ВЫВОД@@@@@@@@@@@@@@@@5@@@@@@@@@@@335@@</Data>
<Node><Sub>1</Sub>
<Data>    РЕЖИМ ВЫВОДА (ТАБЛИЦЫ,  ДАННЫХ) НА  ПЕЧАТЬ,  В  ASCII-ФАЙЛ,  НА</Data>
</Node>
<Node><Sub>2</Sub>
<Data>                               РТА-80Л.</Data>
</Node>
<Node><Sub>3</Sub>
<Data></Data>
</Node>
<Node><Sub>4</Sub>
<Data>     Для знакомства  со  всеми  режимами вывода предлагается пример со</Data>
</Node>
<Node><Sub>5</Sub>
<Data>стандартной таблицей отчета (ширина - 73 символов,  высота - 20 симво-</Data>
</Node>
<Node><Sub>6</Sub>
<Data>лов). Режим вывода вызывается по 2 пункту основного подстрочного меню:</Data>
</Node>
<Node><Sub>7</Sub>
<Data></Data>
</Node>
<Node><Sub>8</Sub>
<Data>---------- Экран 1.. -----------------------------------------------------------</Data>
</Node>
<Node><Sub>9</Sub>
<Data>|                СТАНДАРТНАЯ   ЭЛЕКТРОННАЯ   ТАБЛИЦА                           |</Data>
</Node>
<Node><Sub>10</Sub>
<Data>|==========================================================================    |</Data>
</Node>
<Node><Sub>11</Sub>
<Data>||        |      |      |      |      |      |      |      |      |       |    |</Data>
</Node>
<Node><Sub>12</Sub>
<Data>||        |      |      |      |      |      |      |      |      |       |    |</Data>
</Node>
<Node><Sub>13</Sub>
<Data>||        |      |      |      |      |      |      |      |      |       |    |</Data>
</Node>
<Node><Sub>14</Sub>
<Data>||========|===============================================================|    |</Data>
</Node>
<Node><Sub>15</Sub>
<Data>||  1     |   2  |  3   |  4   |  5   |  6   |  7   |  8   |  9   |  10   |    |</Data>
</Node>
<Node><Sub>16</Sub>
<Data>||========|===============================================================|    |</Data>
</Node>
<Node><Sub>17</Sub>
<Data>||        |      |      |      |      |      |      |      |      |       |    |</Data>
</Node>
<Node><Sub>18</Sub>
<Data>||---------------+------+------+------+------+------+------+------+-------|    |</Data>
</Node>
<Node><Sub>19</Sub>
<Data>||        |      |      |      |      |      |      |      |      |       |    |</Data>
</Node>
<Node><Sub>20</Sub>
<Data>||---------------+------+------+------+------+------+------+------+-------|    |</Data>
</Node>
<Node><Sub>21</Sub>
<Data>||        |      |      |      |      |      |      |      |      |       |    |</Data>
</Node>
<Node><Sub>22</Sub>
<Data>|             О.Т       1x1                                                    |</Data>
</Node>
<Node><Sub>23</Sub>
<Data>| 1.ОПИС 2.ВЫВОД 3.ЗАПИСЬ 4.РЕД 5.КОПИР 6.СЕРВИС 7.ПОИСК 8.УДАЛ 9.ИНФО 10.ВЫХ |</Data>
</Node>
<Node><Sub>24</Sub>
<Data>|        Вывод Таблиц и Данных на печать и в DOS-файл                         |</Data>
</Node>
<Node><Sub>25</Sub>
<Data>| {14,3,&quot;A&quot;,&quot;A&quot;,&quot;TAF&quot;,&quot;TAF&quot;} = -                                               |</Data>
</Node>
<Node><Sub>26</Sub>
<Data>--------------------------------------------------------------------------------</Data>
</Node>
<Node><Sub>27</Sub>
<Data>     Далее предлагается подменю:</Data>
</Node>
<Node><Sub>28</Sub>
<Data></Data>
</Node>
<Node><Sub>29</Sub>
<Data>| ВСЕ БЛОК                                                                    |</Data>
</Node>
<Node><Sub>30</Sub>
<Data>| Выводить всю таблицу                                                        |</Data>
</Node>
<Node><Sub>31</Sub>
<Data>-------------------------------------------------------------------------------</Data>
</Node>
<Node><Sub>32</Sub>
<Data>    12.1. В режиме &quot;ВЫВОД&quot; возможны 2 варианта:</Data>
</Node>
<Node><Sub>33</Sub>
<Data>1. Вывод полностью по всей таблице.</Data>
</Node>
<Node><Sub>34</Sub>
<Data>2. Вывод только по клеткам,  помеченным блоком. Если в таблице нет по-</Data>
</Node>
<Node><Sub>35</Sub>
<Data>меченных клеток,  то в режиме &quot;БЛОК&quot; последует соответствующее сообще-</Data>
</Node>
<Node><Sub>36</Sub>
<Data>ние. В  случае наличия пометки создается буферная таблица и дальнейшие</Data>
</Node>
<Node><Sub>37</Sub>
<Data>действия по выводу будут касаться уже ее.  Вложенные меню для дальней-</Data>
</Node>
<Node><Sub>38</Sub>
<Data>шей работы идентичны, как для всей таблицы, так и для блока:</Data>
</Node>
<Node><Sub>39</Sub>
<Data></Data>
</Node>
<Node><Sub>40</Sub>
<Data>| ТАБЛИЦУ ДАННЫЕ                                                              |</Data>
</Node>
<Node><Sub>41</Sub>
<Data>| Выводить всю таблицу                                                        |</Data>
</Node>
<Node><Sub>42</Sub>
<Data>-------------------------------------------------------------------------------</Data>
</Node>
<Node><Sub>43</Sub>
<Data></Data>
</Node>
<Node><Sub>44</Sub>
<Data>    12.2. В режиме &quot;ВЫВОД&quot; возможны 2 варианта:</Data>
</Node>
<Node><Sub>45</Sub>
<Data>1. Вывод таблицы в том виде, в каком она представлена на экране (&quot;ТАБ-</Data>
</Node>
<Node><Sub>46</Sub>
<Data>ЛИЦУ&quot;).</Data>
</Node>
<Node><Sub>47</Sub>
<Data>2. Вывод только информации из клеток,  имеющих символьные имена вывода</Data>
</Node>
<Node><Sub>48</Sub>
<Data>(&quot;ДАННЫЕ&quot;), в формате перфоленты (группы разделяются символом &quot;=&quot;).</Data>
</Node>
<Node><Sub>49</Sub>
<Data></Data>
</Node>
<Node><Sub>50</Sub>
<Data>    Сначала рассмотрим 1 вариант. Предлагается вложенное меню:</Data>
</Node>
<Node><Sub>51</Sub>
<Data>|</Data>
</Node>
<Node><Sub>52</Sub>
<Data>| ПЕЧАТЬ ASCII-ФАЙЛ ТЕКСТ РТА-80Л                                             |</Data>
</Node>
<Node><Sub>53</Sub>
<Data>| Пpинтеp                                                                     |</Data>
</Node>
<Node><Sub>54</Sub>
<Data>-------------------------------------------------------------------------------</Data>
</Node>
<Node><Sub>55</Sub>
<Data>.¬</Data>
</Node>
<Node><Sub>56</Sub>
<Data></Data>
</Node>
<Node><Sub>57</Sub>
<Data>    12.2.1. При выборе режима &quot;ПЕЧАТЬ&quot; - следующее меню:</Data>
</Node>
<Node><Sub>58</Sub>
<Data></Data>
</Node>
<Node><Sub>59</Sub>
<Data>|</Data>
</Node>
<Node><Sub>60</Sub>
<Data>| ВЫВОД ОПЦИИ ПАРАМЕТРЫ_ПРИНТЕРА                                              |</Data>
</Node>
<Node><Sub>61</Sub>
<Data>| Всю таблицу                                                                 |</Data>
</Node>
<Node><Sub>62</Sub>
<Data>-------------------------------------------------------------------------------</Data>
</Node>
<Node><Sub>63</Sub>
<Data>    Следует отметить,  что для других устройств в меню отсутствует оп-</Data>
</Node>
<Node><Sub>64</Sub>
<Data>ция &quot;ПАРАМЕТРЫ_ПРИНТЕРА&quot;, в остальном - режимы вывода схожи.</Data>
</Node>
<Node><Sub>65</Sub>
<Data></Data>
</Node>
<Node><Sub>66</Sub>
<Data>    12.2.2. Опции вывода таблицы.</Data>
</Node>
<Node><Sub>67</Sub>
<Data></Data>
</Node>
<Node><Sub>68</Sub>
<Data>    В режиме  вывода  таблицы на устройство существует возможность су-</Data>
</Node>
<Node><Sub>69</Sub>
<Data>щественно варьировать форматом вывода (размеры страницы, левый отступ,</Data>
</Node>
<Node><Sub>70</Sub>
<Data>режим  печати  для принтера,  дублирование титула на каждой странице).</Data>
</Node>
<Node><Sub>71</Sub>
<Data>Рассмотрим подробно режим &quot;ОПЦИИ&quot;. Для всех устройств вывода использу-</Data>
</Node>
<Node><Sub>72</Sub>
<Data>ется одна стандартная таблица опций,  в которой, в зависимости от выб-</Data>
</Node>
<Node><Sub>73</Sub>
<Data>ранного устройства,  предлагаютя  стандартные  опции  (отмечены  опции</Data>
</Node>
<Node><Sub>74</Sub>
<Data>только  для принтера).Если таблица впервые выводится наустройство,  то</Data>
</Node>
<Node><Sub>75</Sub>
<Data>вид опций вывода - следующий:</Data>
</Node>
<Node><Sub>76</Sub>
<Data>---------- Экран 2.. -----------------------------------------------------------</Data>
</Node>
<Node><Sub>77</Sub>
<Data>|             ----------------------------------------------------             |</Data>
</Node>
<Node><Sub>78</Sub>
<Data>|=============|               Опции вывода таблицы               |=========    |</Data>
</Node>
<Node><Sub>79</Sub>
<Data>||        |   |                                                  ||       |    |</Data>
</Node>
<Node><Sub>80</Sub>
<Data>||        |   | Устройство вывода (N устройства печати,    3     ||       |    |</Data>
</Node>
<Node><Sub>81</Sub>
<Data>||        |   | имя DOS-файла, имя текста)                       ||       |    |</Data>
</Node>
<Node><Sub>82</Sub>
<Data>||========|===|                                                  |========|    |</Data>
</Node>
<Node><Sub>83</Sub>
<Data>||  1     |   | Количество символов в строке (0 - 511)     0     ||  10   |    |</Data>
</Node>
<Node><Sub>84</Sub>
<Data>||========|===|                                                  |========|    |</Data>
</Node>
<Node><Sub>85</Sub>
<Data>||        |   | Количество строк на странице (0 - max,     0     ||       |    |</Data>
</Node>
<Node><Sub>86</Sub>
<Data>||------------|      символ - разделитель страниц)               |+-------|    |</Data>
</Node>
<Node><Sub>87</Sub>
<Data>||        |   |                                                  ||       |    |</Data>
</Node>
<Node><Sub>88</Sub>
<Data>||------------| Отступ от левого края (для принтера)       0     |+-------|    |</Data>
</Node>
<Node><Sub>89</Sub>
<Data>||        |   |                                                  ||       |    |</Data>
</Node>
<Node><Sub>90</Sub>
<Data>||------------| Дублировать титул                          Да    |+-------|    |</Data>
</Node>
<Node><Sub>91</Sub>
<Data>||        |   |                                                  ||       |    |</Data>
</Node>
<Node><Sub>92</Sub>
<Data>||------------| Режим печати страниц (для принтера)        1     |+-------|    |</Data>
</Node>
<Node><Sub>93</Sub>
<Data>||        |   |                                                  ||       |    |</Data>
</Node>
<Node><Sub>94</Sub>
<Data>|=============| Использовать карту вывода                  Нет   |=========    |</Data>
</Node>
<Node><Sub>95</Sub>
<Data>|             |                                                  |             |</Data>
</Node>
<Node><Sub>96</Sub>
<Data>|             | Сохранить настройки                        Нет   |             |</Data>
</Node>
<Node><Sub>97</Sub>
<Data>|             |                                                  |             |</Data>
</Node>
<Node><Sub>98</Sub>
<Data>|             ----------------------------------------------------             |</Data>
</Node>
<Node><Sub>99</Sub>
<Data>|    ТРАН     О.Т       1x10         СИНТ          Бл                          |</Data>
</Node>
<Node><Sub>100</Sub>
<Data>|                                                                              |</Data>
</Node>
<Node><Sub>101</Sub>
<Data>| {8,2,&quot;fTS1u&quot;,&quot;%BSbufB&quot;,&quot;TAF&quot;,&quot;TAF&quot;} = 0                                      |</Data>
</Node>
<Node><Sub>102</Sub>
<Data>--------------------------------------------------------------------------------</Data>
</Node>
<Node><Sub>103</Sub>
<Data>    Необходимо, зная размеры таблицы,  параметры  устройства,  выбрать</Data>
</Node>
<Node><Sub>104</Sub>
<Data>оптимальный  размер страницы.  По умолчанию в опциях выставлены макси-</Data>
</Node>
<Node><Sub>105</Sub>
<Data>мальные размеры страницы (значение 0 соответсвует 511 символам в стро-</Data>
</Node>
<Node><Sub>106</Sub>
<Data>ке и неограниченному числу строк на странице). Для принтера нужно выс-</Data>
</Node>
<Node><Sub>107</Sub>
<Data>тавить количество символов в строке, учитывая ширину каретки и возмож-</Data>
</Node>
<Node><Sub>108</Sub>
<Data>ность плотной печати (для файла это не имеет значения). Номер устройс-</Data>
</Node>
<Node><Sub>109</Sub>
<Data>тва печати (для файла - полный путь,  для текста - полная ссылка), ко-</Data>
</Node>
<Node><Sub>110</Sub>
<Data>личество символов,  количество строк и размер отступа заносятся симво-</Data>
</Node>
<Node><Sub>111</Sub>
<Data>лами или цифрами.  Остальные опции определяются при нажатии &lt;ENTER&gt;  в</Data>
</Node>
<Node><Sub>112</Sub>
<Data>нужном окне и выборе предлагаемого варианта (по &lt;ENTER&gt;).</Data>
</Node>
<Node><Sub>113</Sub>
<Data>    Дублирование титула - если &quot;ДА&quot;,  то титул будет дублироваться  на</Data>
</Node>
<Node><Sub>114</Sub>
<Data>каждой странице.</Data>
</Node>
<Node><Sub>115</Sub>
<Data>.¬</Data>
</Node>
<Node><Sub>116</Sub>
<Data>    &quot;Режим печати&quot;:</Data>
</Node>
<Node><Sub>117</Sub>
<Data>---------- Экран 3.. -----------------------------------------------------------</Data>
</Node>
<Node><Sub>118</Sub>
<Data>|             ----------------------------------------------------             |</Data>
</Node>
<Node><Sub>119</Sub>
<Data>|=============|               Опции вывода таблицы               |=========    |</Data>
</Node>
<Node><Sub>120</Sub>
<Data>||        |   |                                                  ||       |    |</Data>
</Node>
<Node><Sub>121</Sub>
<Data>||        |   | Устройство вывода (N устройства печати,    3     ||       |    |</Data>
</Node>
<Node><Sub>122</Sub>
<Data>||        |   | имя DOS-файла, имя текста)                       ||       |    |</Data>
</Node>
<Node><Sub>123</Sub>
<Data>||========|===|                                                  |========|    |</Data>
</Node>
<Node><Sub>124</Sub>
<Data>||  1     |   | Количество символов в строке (0 - 511)     0     ||  10   |    |</Data>
</Node>
<Node><Sub>125</Sub>
<Data>||========|===|                                                  |========|    |</Data>
</Node>
<Node><Sub>126</Sub>
<Data>||        |   | Количество строк на странице (0 - max,     0     ||       |    |</Data>
</Node>
<Node><Sub>127</Sub>
<Data>||---------------------------------------------------------------------------- |</Data>
</Node>
<Node><Sub>128</Sub>
<Data>|| |                   Выберите, пожалуйста, режим печати                    | |</Data>
</Node>
<Node><Sub>129</Sub>
<Data>||-|                                                                         | |</Data>
</Node>
<Node><Sub>130</Sub>
<Data>|| | Потоком без перевода формата_ Потоком с переводом формата_ Постранично_ | |</Data>
</Node>
<Node><Sub>131</Sub>
<Data>||-|  ----------------------------  ---------------------------  ----------- | |</Data>
</Node>
<Node><Sub>132</Sub>
<Data>|| --------------------------------------------------------------------------- |</Data>
</Node>
<Node><Sub>133</Sub>
<Data>||------------| Режим печати страниц (для принтера)        1     |+-------|    |</Data>
</Node>
<Node><Sub>134</Sub>
<Data>||        |   |                                                  ||       |    |</Data>
</Node>
<Node><Sub>135</Sub>
<Data>|=============| Использовать карту вывода                  Нет   |=========    |</Data>
</Node>
<Node><Sub>136</Sub>
<Data>|             |                                                  |             |</Data>
</Node>
<Node><Sub>137</Sub>
<Data>|             | Сохранить настройки                        Нет   |             |</Data>
</Node>
<Node><Sub>138</Sub>
<Data>|             |                                                  |             |</Data>
</Node>
<Node><Sub>139</Sub>
<Data>|             ----------------------------------------------------             |</Data>
</Node>
<Node><Sub>140</Sub>
<Data>|    ТРАН     О.Т       1x10         СИНТ ТАБ      Бл                          |</Data>
</Node>
<Node><Sub>141</Sub>
<Data>|                                                                              |</Data>
</Node>
<Node><Sub>142</Sub>
<Data>| {12,2,&quot;fTS1u&quot;,&quot;%BSbufB&quot;,&quot;TAF&quot;,&quot;TAF&quot;} = 1                                     |</Data>
</Node>
<Node><Sub>143</Sub>
<Data>--------------------------------------------------------------------------------</Data>
</Node>
<Node><Sub>144</Sub>
<Data>    &quot;Потоком без перевода формата&quot; - печать постранично (справа-налево</Data>
</Node>
<Node><Sub>145</Sub>
<Data>и сверху-вниз) без  перевода формата после страницы.</Data>
</Node>
<Node><Sub>146</Sub>
<Data>    &quot;Потоком с переводом страницы&quot; - аналогично, но после каждой стра-</Data>
</Node>
<Node><Sub>147</Sub>
<Data>ницы - перевод формата.</Data>
</Node>
<Node><Sub>148</Sub>
<Data>    &quot;Постранично&quot; - после выдачи каждой страницы печать прерывается  и</Data>
</Node>
<Node><Sub>149</Sub>
<Data>на экране  появляется  запрос на печать очередной страницы.  При подт-</Data>
</Node>
<Node><Sub>150</Sub>
<Data>верждении предлагается запрос на перевод формата.  Этот режим рекомен-</Data>
</Node>
<Node><Sub>151</Sub>
<Data>дуется для  принтеров  с  лоточной загрузкой или ручной подачей бумаги</Data>
</Node>
<Node><Sub>152</Sub>
<Data>(после приостановки печати можно вставить новый лист).</Data>
</Node>
<Node><Sub>153</Sub>
<Data>    &quot;Использовать карту  вывода&quot;  - если &quot;НЕТ&quot;,  то после формирования</Data>
</Node>
<Node><Sub>154</Sub>
<Data>буфера вывода сразу начинается вывод на устройство всей таблицы.  Если</Data>
</Node>
<Node><Sub>155</Sub>
<Data>- &quot;ДА&quot;,то предлагается карта вывода,  где каждая страница представлена</Data>
</Node>
<Node><Sub>156</Sub>
<Data>клеткой. Дальнейший вывод - из карты (см. ниже).</Data>
</Node>
<Node><Sub>157</Sub>
<Data>    &quot;Сохранить настройки&quot;:</Data>
</Node>
<Node><Sub>158</Sub>
<Data>---------- Экран 4.. -----------------------------------------------------------</Data>
</Node>
<Node><Sub>159</Sub>
<Data>|             ----------------------------------------------------             |</Data>
</Node>
<Node><Sub>160</Sub>
<Data>|=============|               Опции вывода таблицы               |=========    |</Data>
</Node>
<Node><Sub>161</Sub>
<Data>||        |   |                                                  ||       |    |</Data>
</Node>
<Node><Sub>162</Sub>
<Data>||        |   | Устройство вывода (N устройства печати,    3     ||       |    |</Data>
</Node>
<Node><Sub>163</Sub>
<Data>||        |   | имя DOS-файла, имя текста)                       ||       |    |</Data>
</Node>
<Node><Sub>164</Sub>
<Data>||========|===|                                                  |========|    |</Data>
</Node>
<Node><Sub>165</Sub>
<Data>||  1     |   | Количество символов в строке (0 - 511)     0     ||  10   |    |</Data>
</Node>
<Node><Sub>166</Sub>
<Data>||========|===|                                                  |========|    |</Data>
</Node>
<Node><Sub>167</Sub>
<Data>||        |   | Количество строк на странице (0 - max,     0     ||       |    |</Data>
</Node>
<Node><Sub>168</Sub>
<Data>||------------|   ---------------------------------------------- |+-------|    |</Data>
</Node>
<Node><Sub>169</Sub>
<Data>||        |   |   |            Выберите, пожалуйста            | ||       |    |</Data>
</Node>
<Node><Sub>170</Sub>
<Data>||------------| От|                                            | |+-------|    |</Data>
</Node>
<Node><Sub>171</Sub>
<Data>||        |   |   |  Не сохранять _  На 1 сеанс _  Сохранить _ | ||       |    |</Data>
</Node>
<Node><Sub>172</Sub>
<Data>||------------| Ду|  --------------  ------------  ----------- | |+-------|    |</Data>
</Node>
<Node><Sub>173</Sub>
<Data>||        |   |   ---------------------------------------------- ||       |    |</Data>
</Node>
<Node><Sub>174</Sub>
<Data>||------------| Режим печати страниц (для принтера)        1     |+-------|    |</Data>
</Node>
<Node><Sub>175</Sub>
<Data>||        |   |                                                  ||       |    |</Data>
</Node>
<Node><Sub>176</Sub>
<Data>|=============| Использовать карту вывода                  Нет   |=========    |</Data>
</Node>
<Node><Sub>177</Sub>
<Data>|             |                                                  |             |</Data>
</Node>
<Node><Sub>178</Sub>
<Data>|             | Сохранить настройки                        Нет   |             |</Data>
</Node>
<Node><Sub>179</Sub>
<Data>|             |                                                  |             |</Data>
</Node>
<Node><Sub>180</Sub>
<Data>|             ----------------------------------------------------             |</Data>
</Node>
<Node><Sub>181</Sub>
<Data>|    ТРАН     О.Т       1x10         СИНТ ТАБ      Бл                          |</Data>
</Node>
<Node><Sub>182</Sub>
<Data>|                                                                              |</Data>
</Node>
<Node><Sub>183</Sub>
<Data>| {16,2,&quot;fTS1u&quot;,&quot;%BSbufB&quot;,&quot;TAF&quot;,&quot;TAF&quot;} = 0                                     |</Data>
</Node>
<Node><Sub>184</Sub>
<Data>--------------------------------------------------------------------------------</Data>
</Node>
<Node><Sub>185</Sub>
<Data>.¬</Data>
</Node>
<Node><Sub>186</Sub>
<Data>    Если &quot;Сохранить&quot;, то измененные опции записываются в описание таб-</Data>
</Node>
<Node><Sub>187</Sub>
<Data>лицы, и, в последующем, будут для нее стандартными. Если &quot;На 1 сеанс&quot;,</Data>
</Node>
<Node><Sub>188</Sub>
<Data>то изменения  будут  использованы только на этот сеанс работы с табли-</Data>
</Node>
<Node><Sub>189</Sub>
<Data>цей. Если &quot;Не сохранять&quot;,  то будут использованы стандартные опции или</Data>
</Node>
<Node><Sub>190</Sub>
<Data>запомненные ранее. Выход из таблицы - по &lt;ESC&gt;.</Data>
</Node>
<Node><Sub>191</Sub>
<Data></Data>
</Node>
<Node><Sub>192</Sub>
<Data>    12.2.3. Параметры принтера.</Data>
</Node>
<Node><Sub>193</Sub>
<Data></Data>
</Node>
<Node><Sub>194</Sub>
<Data>---------- Экран 5.. -----------------------------------------------------------</Data>
</Node>
<Node><Sub>195</Sub>
<Data>|                СТАНДАРТНАЯ   ЭЛЕКТРОННАЯ   ТАБЛИЦА                           |</Data>
</Node>
<Node><Sub>196</Sub>
<Data>|==========================================================================    |</Data>
</Node>
<Node><Sub>197</Sub>
<Data>||        |      |      |      |      |      |      |      |      |       |    |</Data>
</Node>
<Node><Sub>198</Sub>
<Data>||        |      |      --------------------------------   |      |       |    |</Data>
</Node>
<Node><Sub>199</Sub>
<Data>||        |      |      |      ПАРАМЕТРЫ  ПРИНТЕРА     |   |      |       |    |</Data>
</Node>
<Node><Sub>200</Sub>
<Data>||========|=============|        Выбор - &lt;ENTER&gt;       |==================|    |</Data>
</Node>
<Node><Sub>201</Sub>
<Data>||  1     |   2  |  3   |  80 СИМВОЛОВ В СТРОКЕ ..     |   |  9   |  10   |    |</Data>
</Node>
<Node><Sub>202</Sub>
<Data>||========|=============|  90 ....................  Y  |==================|    |</Data>
</Node>
<Node><Sub>203</Sub>
<Data>||        |      |      |  132 ...................     |   |      |       |    |</Data>
</Node>
<Node><Sub>204</Sub>
<Data>||---------------+------|  160 ...................     |---+------+-------|    |</Data>
</Node>
<Node><Sub>205</Sub>
<Data>||        |      |      |  70 СТРОК НА СТРАНИЦЕ ..     |   |      |       |    |</Data>
</Node>
<Node><Sub>206</Sub>
<Data>||---------------+------|  30 ....................     |---+------+-------|    |</Data>
</Node>
<Node><Sub>207</Sub>
<Data>||        |      |      |  60 ....................     |   |      |       |    |</Data>
</Node>
<Node><Sub>208</Sub>
<Data>||---------------+------|  100 ...................     |---+------+-------|    |</Data>
</Node>
<Node><Sub>209</Sub>
<Data>||        |      |      |  130 ...................  Y  |   |      |       |    |</Data>
</Node>
<Node><Sub>210</Sub>
<Data>||---------------+------|  250 ...................     |---+------+-------|    |</Data>
</Node>
<Node><Sub>211</Sub>
<Data>||        |      |      |  ДВОЙНОЕ КАЧЕСТВО ПЕЧАТИ  Y  |   |      |       |    |</Data>
</Node>
<Node><Sub>212</Sub>
<Data>|=======================|  ОБЫЧНОЕ КАЧЕСТВО            |===================    |</Data>
</Node>
<Node><Sub>213</Sub>
<Data>|                       --------------------------------                       |</Data>
</Node>
<Node><Sub>214</Sub>
<Data>|             О.Т       1x8                                                    |</Data>
</Node>
<Node><Sub>215</Sub>
<Data>--------------------------------------------------------------------------------</Data>
</Node>
<Node><Sub>216</Sub>
<Data></Data>
</Node>
<Node><Sub>217</Sub>
<Data>     В зависимости от ширины каретки принтера, ширины и высоты страни-</Data>
</Node>
<Node><Sub>218</Sub>
<Data>цы  (из  опций) можно выбрать параметры принтера в данной таблице.  По</Data>
</Node>
<Node><Sub>219</Sub>
<Data>&lt;ENTER&gt; выбераются нужные (появляется символ &quot;Y&quot;).  При выходе из таб-</Data>
</Node>
<Node><Sub>220</Sub>
<Data>лицы  по  &lt;ESC&gt; параметры сохраняются в описании таблицы (если не было</Data>
</Node>
<Node><Sub>221</Sub>
<Data>изменений,  то параметры обнуляются). Параметры определяются в расчете</Data>
</Node>
<Node><Sub>222</Sub>
<Data>на стандартный лист формата А4 принтера с узкой кареткой.</Data>
</Node>
<Node><Sub>223</Sub>
<Data></Data>
</Node>
<Node><Sub>224</Sub>
<Data>    12.2.4. Вывод на устойство.</Data>
</Node>
<Node><Sub>225</Sub>
<Data></Data>
</Node>
<Node><Sub>226</Sub>
<Data>    12.2.4.1. С картой вывода.</Data>
</Node>
<Node><Sub>227</Sub>
<Data></Data>
</Node>
<Node><Sub>228</Sub>
<Data>    На экране появляется карта следующего вида:</Data>
</Node>
<Node><Sub>229</Sub>
<Data>---------- Экран 6.. -----------------------------------------------------------</Data>
</Node>
<Node><Sub>230</Sub>
<Data>| &lt;ENTER&gt;-Экран Колонка  :Колонка  :Колонка  :                                 |</Data>
</Node>
<Node><Sub>231</Sub>
<Data>| &lt;F2&gt; - Вывод  1         2         3                                          |</Data>
</Node>
<Node><Sub>232</Sub>
<Data>| &lt;F3&gt; - Опции  #1:1:8    #9:1:17   #18:1:21                                   |</Data>
</Node>
<Node><Sub>233</Sub>
<Data>|Страница :1                                                                   |</Data>
</Node>
<Node><Sub>234</Sub>
<Data>|#1:1:8                                                                        |</Data>
</Node>
<Node><Sub>235</Sub>
<Data>|                                                                              |</Data>
</Node>
<Node><Sub>236</Sub>
<Data>|Страница :2                                                                   |</Data>
</Node>
<Node><Sub>237</Sub>
<Data>|#9:1:16                                                                       |</Data>
</Node>
<Node><Sub>238</Sub>
<Data>|                                                                              |</Data>
</Node>
<Node><Sub>239</Sub>
<Data>|             О.Т       3x10                                                   |</Data>
</Node>
<Node><Sub>240</Sub>
<Data>|                                                                              |</Data>
</Node>
<Node><Sub>241</Sub>
<Data>| {2,2,&quot;W1u&quot;,&quot;%BSbufB&quot;,&quot;TAF&quot;,&quot;TAF&quot;} =                                          |</Data>
</Node>
<Node><Sub>242</Sub>
<Data>--------------------------------------------------------------------------------</Data>
</Node>
<Node><Sub>243</Sub>
<Data>    Количество строк  и колонок зависит от размеров таблицы и заданных</Data>
</Node>
<Node><Sub>244</Sub>
<Data>размеров страницы (от 1 и больше).  Установив курсор в нужную  клетку,</Data>
</Node>
<Node><Sub>245</Sub>
<Data>можно (на выбор): просмотреть страницу на экране (в текстовом редакто-</Data>
</Node>
<Node><Sub>246</Sub>
<Data>ре с возможностью коррекции и вывода);  выдать на устройство; изменить</Data>
</Node>
<Node><Sub>247</Sub>
<Data>параметры принтера для каждой страницы.</Data>
</Node>
<Node><Sub>248</Sub>
<Data></Data>
</Node>
<Node><Sub>249</Sub>
<Data>.¬</Data>
</Node>
<Node><Sub>250</Sub>
<Data>    12.2.4.2. На принтер.</Data>
</Node>
<Node><Sub>251</Sub>
<Data></Data>
</Node>
<Node><Sub>252</Sub>
<Data>    Предлагается запрос:</Data>
</Node>
<Node><Sub>253</Sub>
<Data>---------- Экран 7.. -----------------------------------------------------------</Data>
</Node>
<Node><Sub>254</Sub>
<Data>|                СТАНДАРТНАЯ   ЭЛЕКТРОННАЯ   ТАБЛИЦА                           |</Data>
</Node>
<Node><Sub>255</Sub>
<Data>|==========================================================================    |</Data>
</Node>
<Node><Sub>256</Sub>
<Data>||        |      |      |      |      |      |      |      |      |       |    |</Data>
</Node>
<Node><Sub>257</Sub>
<Data>||        |      |      |      |      |      |      |      |      |       |    |</Data>
</Node>
<Node><Sub>258</Sub>
<Data>||        |      |      |      |      |      |      |      |      |       |    |</Data>
</Node>
<Node><Sub>259</Sub>
<Data>||========|===============================================================|    |</Data>
</Node>
<Node><Sub>260</Sub>
<Data>||  1     |   2  |  3   |  4   |  5   |  6   |  7   |  8   |  9   |  10   |    |</Data>
</Node>
<Node><Sub>261</Sub>
<Data>||========|===============================================================|    |</Data>
</Node>
<Node><Sub>262</Sub>
<Data>||        |      |      |      |      |      |      |      |      |       |    |</Data>
</Node>
<Node><Sub>263</Sub>
<Data>||---------------+------+----------------------------------+------+-------|    |</Data>
</Node>
<Node><Sub>264</Sub>
<Data>||        |      |      | | Псевдографику сохранять ? |    |      |       |    |</Data>
</Node>
<Node><Sub>265</Sub>
<Data>||---------------+------+-|                           |----+------+-------|    |</Data>
</Node>
<Node><Sub>266</Sub>
<Data>||        |      |      | |                           |    |      |       |    |</Data>
</Node>
<Node><Sub>267</Sub>
<Data>||---------------+------+-|       ДА  _   НЕТ  _      |----+------+-------|    |</Data>
</Node>
<Node><Sub>268</Sub>
<Data>||        |      |      | |      ------  -------      |    |      |       |    |</Data>
</Node>
<Node><Sub>269</Sub>
<Data>||---------------+------+----------------------------------+------+-------|    |</Data>
</Node>
<Node><Sub>270</Sub>
<Data>||        |      |      |      |      |      |      |      |      |       |    |</Data>
</Node>
<Node><Sub>271</Sub>
<Data>|==========================================================================    |</Data>
</Node>
<Node><Sub>272</Sub>
<Data>|             О.Т       1x8                                                    |</Data>
</Node>
<Node><Sub>273</Sub>
<Data>|     ...Формируется карта вывода !...44                                       |</Data>
</Node>
<Node><Sub>274</Sub>
<Data>|                                                                              |</Data>
</Node>
<Node><Sub>275</Sub>
<Data>--------------------------------------------------------------------------------</Data>
</Node>
<Node><Sub>276</Sub>
<Data>    Если &quot;НЕТ&quot;  -  все символы псевдографики будут заменены на &quot;-&quot; или</Data>
</Node>
<Node><Sub>277</Sub>
<Data>&quot;|&quot;, при этом принтер гораздо быстрее распечатает таблицу  (рекоменду-</Data>
</Node>
<Node><Sub>278</Sub>
<Data>ется для  черновика).  Далее  следует  запрос о готовности устройства.</Data>
</Node>
<Node><Sub>279</Sub>
<Data>После чего возникает сообщение &quot;Прерывание печати - по  &lt;ESC&gt;&quot;.  После</Data>
</Node>
<Node><Sub>280</Sub>
<Data>завершения вывода  или прерывании печати предлагается выдать еще 1 эк-</Data>
</Node>
<Node><Sub>281</Sub>
<Data>земпляр. В случае отказа пользователь переходит в режим просмотра таб-</Data>
</Node>
<Node><Sub>282</Sub>
<Data>лицы или карты вывода.</Data>
</Node>
<Node><Sub>283</Sub>
<Data>    При дальнейшей работе с таблицей при выводе  на  устройство  перед</Data>
</Node>
<Node><Sub>284</Sub>
<Data>формированием буфера вывода предлагается вопрос:</Data>
</Node>
<Node><Sub>285</Sub>
<Data>|                        --------------------------------                      |</Data>
</Node>
<Node><Sub>286</Sub>
<Data>|                        | Есть готовый буфер! Выдаем ? |                      |</Data>
</Node>
<Node><Sub>287</Sub>
<Data>|                        |                              |                      |</Data>
</Node>
<Node><Sub>288</Sub>
<Data>|                        |                              |                      |</Data>
</Node>
<Node><Sub>289</Sub>
<Data>|                        |         ДА  _   НЕТ  _       |                      |</Data>
</Node>
<Node><Sub>290</Sub>
<Data>|                        |        ------  -------       |                      |</Data>
</Node>
<Node><Sub>291</Sub>
<Data>|                        --------------------------------                      |</Data>
</Node>
<Node><Sub>292</Sub>
<Data>|                                                                              |</Data>
</Node>
<Node><Sub>293</Sub>
<Data>    Если &quot;ДА&quot;, то выводится готовый буфер, в противном случае - форми-</Data>
</Node>
<Node><Sub>294</Sub>
<Data>руется новый.</Data>
</Node>
<Node><Sub>295</Sub>
<Data>    Нужно помнить, что буфер привязывается к имени таблицы, значит при</Data>
</Node>
<Node><Sub>296</Sub>
<Data>работе с базами данных при переходе к данным другого ключа будет пред-</Data>
</Node>
<Node><Sub>297</Sub>
<Data>ложен для выдачи буфер с данными предыдущего ключа ! При вызове табли-</Data>
</Node>
<Node><Sub>298</Sub>
<Data>цы опций буфер очищается.</Data>
</Node>
<Node><Sub>299</Sub>
<Data></Data>
</Node>
<Node><Sub>300</Sub>
<Data>    12.2.4.3. Вывод в файл.</Data>
</Node>
<Node><Sub>301</Sub>
<Data></Data>
</Node>
<Node><Sub>302</Sub>
<Data>    Процесс подготовки к выводу аналогичен,  но после формирования бу-</Data>
</Node>
<Node><Sub>303</Sub>
<Data>фера вывода поступает приглашение определить полный путь к файлу:</Data>
</Node>
<Node><Sub>304</Sub>
<Data>|                                                                              |</Data>
</Node>
<Node><Sub>305</Sub>
<Data>|-[  Введите полный путь к DOS-файлу для ЗАПИСИ (F3-Каталог)  ]----------------|</Data>
</Node>
<Node><Sub>306</Sub>
<Data>||·············································································|</Data>
</Node>
<Node><Sub>307</Sub>
<Data>|-----[  0]--------------------------------------------------------[ -1]-Вставк|</Data>
</Node>
<Node><Sub>308</Sub>
<Data>--------------------------------------------------------------------------------</Data>
</Node>
<Node><Sub>309</Sub>
<Data>    После определения пути происходит процесс вывода.</Data>
</Node>
<Node><Sub>310</Sub>
<Data></Data>
</Node>
<Node><Sub>311</Sub>
<Data>.¬</Data>
</Node>
<Node><Sub>312</Sub>
<Data>    12.2.4.4. Вывод в текст.</Data>
</Node>
<Node><Sub>313</Sub>
<Data></Data>
</Node>
<Node><Sub>314</Sub>
<Data>    Процесс подготовки к выводу аналогичен,  но после формирования бу-</Data>
</Node>
<Node><Sub>315</Sub>
<Data>фера вывода  поступает  приглашение определить имя таблицы,  в которую</Data>
</Node>
<Node><Sub>316</Sub>
<Data>будет выведена информация:</Data>
</Node>
<Node><Sub>317</Sub>
<Data>|                                                                              |</Data>
</Node>
<Node><Sub>318</Sub>
<Data>|-[  ВВОДИТЕ ссылку на таблицу:(TABL,PART,UCI,SYS) &lt;F3&gt;-КАТАЛОГ &lt;F1&gt;-ПОМОЩЬ ]--|</Data>
</Node>
<Node><Sub>319</Sub>
<Data>||·············································································|</Data>
</Node>
<Node><Sub>320</Sub>
<Data>|-----[  0]--------------------------------------------------------[ -1]-Вставк|</Data>
</Node>
<Node><Sub>321</Sub>
<Data>--------------------------------------------------------------------------------</Data>
</Node>
<Node><Sub>322</Sub>
<Data>    После определения пути происходит процесс вывода. Этот режим можно</Data>
</Node>
<Node><Sub>323</Sub>
<Data>использовать в процессе работы с коррекцией описания таблицы.</Data>
</Node>
<Node><Sub>324</Sub>
<Data></Data>
</Node>
<Node><Sub>325</Sub>
<Data>    12.2.2. Вывод данных.</Data>
</Node>
<Node><Sub>326</Sub>
<Data></Data>
</Node>
<Node><Sub>327</Sub>
<Data>    Предлагается меню:</Data>
</Node>
<Node><Sub>328</Sub>
<Data>|</Data>
</Node>
<Node><Sub>329</Sub>
<Data>| ПЕЧАТЬ ASCII-ФАЙЛ ТЕКСТ РТА-80Л                                             |</Data>
</Node>
<Node><Sub>330</Sub>
<Data>| Пpинтеp                                                                     |</Data>
</Node>
<Node><Sub>331</Sub>
<Data>-------------------------------------------------------------------------------</Data>
</Node>
<Node><Sub>332</Sub>
<Data>    После выбора устройства формируется буфер вывода. Дальнейшие сооб-</Data>
</Node>
<Node><Sub>333</Sub>
<Data>щения и предложения идентичны тем,  что описаны в пункте &quot;Вывод табли-</Data>
</Node>
<Node><Sub>334</Sub>
<Data>цы&quot;. Но при выборе устройства &quot;ТЕКСТ&quot; на экране предлагается режим ра-</Data>
</Node>
<Node><Sub>335</Sub>
<Data>боты в текстовом редакторе с буфером вывода.</Data>
</Node>
</Node>
<Node><Sub>101</Sub>
<Data>F1-МЕНЮ-ВЫЧ@@@@@@@1@1@22@80@@@@1@@5@@@1@@@@@@@@@@@2;6;30;42///2;6;34;42/2;6;30;42@@@1@@@@1</Data>
<Node><Sub>1</Sub>
<Data> ВЫЧ предназначены для изменения данных текущей клетки,независимо</Data>
</Node>
<Node><Sub>2</Sub>
<Data> от того ,где эти данные хранятся; в описании таблицы ,или в базе</Data>
</Node>
<Node><Sub>3</Sub>
<Data> данных. Примеры простейших ВЫЧ :</Data>
</Node>
<Node><Sub>4</Sub>
<Data>  123   ;данные текущей клетки всегда будут равны 123</Data>
</Node>
<Node><Sub>5</Sub>
<Data>  {2,3}+{44,6}  ;...будут равны сумме двух клеток текущей таблицы</Data>
</Node>
<Node><Sub>6</Sub>
<Data>  {2,3}+{6,6,TAB,PAR,UCI}  ;...</Data>
</Node>
<Node><Sub>7</Sub>
<Data></Data>
</Node>
<Node><Sub>8</Sub>
<Data></Data>
</Node>
<Node><Sub>9</Sub>
<Data></Data>
</Node>
<Node><Sub>10</Sub>
<Data></Data>
</Node>
<Node><Sub>11</Sub>
<Data>  Вычисления в таблице будут происходить ,при наличии ВЫЧ постоянно</Data>
</Node>
<Node><Sub>12</Sub>
<Data>  справо-налево сверху вниз, если в описании таблицы эти ОПЦии</Data>
</Node>
<Node><Sub>13</Sub>
<Data>  не изменены в режиме РЕДактирования .</Data>
</Node>
<Node><Sub>14</Sub>
<Data>(Существуют стандарные ВЫЧ смотрите ALT-F1 в режиме строчного редактора)</Data>
</Node>
</Node>
<Node><Sub>102</Sub>
<Data>F1-МЕНЮ-ТРАНС@@@@@@@1@1@22@80@@@@1@@5@@@1@@@@@@@@@@@2;6;30;42///2;6;34;42/2;6;30;42@@@1@@@@1</Data>
<Node><Sub>1</Sub>
<Data> ТРАН предназначены для изменения данных текущей клетки, только</Data>
</Node>
<Node><Sub>2</Sub>
<Data> для визуального представления пользователю. Содержание данных</Data>
</Node>
<Node><Sub>3</Sub>
<Data> клетки ни в описании таблицы ,ни в базе данных не меняется.</Data>
</Node>
<Node><Sub>4</Sub>
<Data>(Существуют стандарные ТРАН смотрите ALT-F1 в режиме строчного редактора)</Data>
</Node>
</Node>
<Node><Sub>105</Sub>
<Data>РЕЖИМ ВОССТАНОВЛЕНИЯ@@@@@@@1@1@22@80@@@@1@@5@@@1@@@@@@@@@@@2;6;30;42///2;6;34;42/2;6;30;42@@@1@@@@1</Data>
<Node><Sub>1</Sub>
<Data>    ЕСЛИ восстанавливаете сохранееную ТАБЛИЦУ ,то текущая таблица</Data>
</Node>
<Node><Sub>2</Sub>
<Data> полностью замещается восстанавливаемой.</Data>
</Node>
<Node><Sub>3</Sub>
<Data></Data>
</Node>
<Node><Sub>4</Sub>
<Data>    ЕСЛИ восстанавливаете таблицу из DOS-файла,то текст в DOS-файле</Data>
</Node>
<Node><Sub>5</Sub>
<Data> должен быть сформированн в следующем формате :</Data>
</Node>
<Node><Sub>6</Sub>
<Data></Data>
</Node>
<Node><Sub>7</Sub>
<Data>  -  в левой веpхней позиции должен быть символ #;</Data>
</Node>
<Node><Sub>8</Sub>
<Data>  -  1-строка и 1-позиция DOS-файла должны определять колонки и строки</Data>
</Node>
<Node><Sub>9</Sub>
<Data>   будущей таблицы чередованием символов ПРОБЕЛ и НЕ_ПРОБЕЛ,например:</Data>
</Node>
<Node><Sub>10</Sub>
<Data>  1-строка    #        xxxxx      xxxxx    x      xxxxxxx</Data>
</Node>
<Node><Sub>11</Sub>
<Data>               --------------------------------------------</Data>
</Node>
<Node><Sub>12</Sub>
<Data>               !       !   !      !   !    !      !     !</Data>
</Node>
<Node><Sub>13</Sub>
<Data>               !       !   !      !   !    !      !     !</Data>
</Node>
<Node><Sub>14</Sub>
<Data>               ---------------------------------------</Data>
</Node>
<Node><Sub>15</Sub>
<Data>              x!       !   !      !   !    !      !</Data>
</Node>
<Node><Sub>16</Sub>
<Data>               ----------------------------------</Data>
</Node>
<Node><Sub>17</Sub>
<Data>              x!       !   !      !   !    !</Data>
</Node>
<Node><Sub>18</Sub>
<Data>              x!       !   !      !</Data>
</Node>
<Node><Sub>19</Sub>
<Data>               -----------------</Data>
</Node>
<Node><Sub>20</Sub>
<Data>   1-позиция -&gt;</Data>
</Node>
</Node>
<Node><Sub>114</Sub>
<Data>F1-МЕНЮ-ЛОГ@@@@@@@1@1@22@80@@@@1@@5@@@1@@@@@@@@@@@2;6;30;42///2;6;34;42/2;6;30;42@@@1@@@@1</Data>
<Node><Sub>1</Sub>
<Data> ЛОГ будут выполнятся только при выходе пользователя из таблицы.</Data>
</Node>
<Node><Sub>2</Sub>
<Data> Если ЛОГ при выполнении выставила $T=0,то считается логический</Data>
</Node>
<Node><Sub>3</Sub>
<Data> контроль не прошел. Если после выполнении существуют ЛОГ не про-</Data>
</Node>
<Node><Sub>4</Sub>
<Data> шедшие логический контроль КОМПЛЕКС спросит помечать ли эти клетки ?</Data>
</Node>
<Node><Sub>5</Sub>
<Data> Cпростит вернуться ли назад для коррекции данных ?</Data>
</Node>
<Node><Sub>6</Sub>
<Data></Data>
</Node>
<Node><Sub>7</Sub>
<Data></Data>
</Node>
</Node>
<Node><Sub>116</Sub>
<Data>F1-МЕНЮ-СИНТ@@@@@@@1@1@22@80@@@@1@@5@@@1@@@@@@@@@@@2;6;30;42///2;6;34;42/2;6;30;42@@@1@@@@1</Data>
<Node><Sub>1</Sub>
<Data> СИНТ будут выполнятся только при вводе данных в текущую клетку</Data>
</Node>
<Node><Sub>2</Sub>
<Data> таблицы. СИНТ могут наряду с синтасическим контролем данных,</Data>
</Node>
<Node><Sub>3</Sub>
<Data> производить их трансформацию.</Data>
</Node>
<Node><Sub>4</Sub>
<Data></Data>
</Node>
<Node><Sub>5</Sub>
<Data>(Существуют стандарные СИНТ смотрите ALT-F1 в режиме строчного редактора)</Data>
</Node>
</Node>
<Node><Sub>200</Sub>
<Data><![CDATA[ОПИСАНИЕ ФУНКЦИЙ ВЫЧИСЛЕНИЯ@@@@@@@1@1@22@80@@@@1@@5@@@1@@@@@@@@185@@@2;6;30;42///2;6;34;42/2;6;30;42@@@1@@@@1]]></Data>
<Node><Sub>1</Sub>
<Data>1.            ________________________________________________</Data>
</Node>
<Node><Sub>2</Sub>
<Data>···­­­---===========   ОБЩЕГО НАЗНАЧЕНИЯ  (ЦИКЛИЧНЫЕ)   =============---­­­···</Data>
</Node>
<Node><Sub>3</Sub>
<Data>              ------------------------------------------------</Data>
</Node>
<Node><Sub>4</Sub>
<Data>$$SUM(S1,B,S2,I,X) - суммирование данных клеток от S1 до S2 с шагом B      </Data>
</Node>
<Node><Sub>5</Sub>
<Data>                   при условии I                                           </Data>
</Node>
<Node><Sub>6</Sub>
<Data>   S1,S2 - ссылки на клетки ТЕКУЩЕЙ таблицы в кавычках и фигурных скобках: </Data>
</Node>
<Node><Sub>7</Sub>
<Data>    &quot;{номер строки,номер колонки}&quot;                                         </Data>
</Node>
<Node><Sub>8</Sub>
<Data>                                                                           </Data>
</Node>
<Node><Sub>9</Sub>
<Data>      например  &quot;{2,5}&quot;  для 2 строки и 5 колонки                          </Data>
</Node>
<Node><Sub>10</Sub>
<Data>   B - шаг цикла (целое число)                                             </Data>
</Node>
<Node><Sub>11</Sub>
<Data>   I - условие ,например &quot;{{s,k}}=2&quot; ,где s и k переменные цикла           </Data>
</Node>
<Node><Sub>12</Sub>
<Data>               ,или &quot;{{s,k}}&gt;1&amp;({{s,k}}&lt;10)&quot;                               </Data>
</Node>
<Node><Sub>13</Sub>
<Data>       для условия ссылки на клетки с переменными цикла должны быть в      </Data>
</Node>
<Node><Sub>14</Sub>
<Data>       в двойных фигурных скобках !!!                                      </Data>
</Node>
<Node><Sub>15</Sub>
<Data>   X=1 - то при результате равном 0   $$SUM(...)=0                         </Data>
</Node>
<Node><Sub>16</Sub>
<Data>   X=0 - то при результате равном 0   $$SUM(...)=&quot;&quot;                        </Data>
</Node>
<Node><Sub>17</Sub>
<Data>$$MAX(S1,B,S2,I) - максимум                                                </Data>
</Node>
<Node><Sub>18</Sub>
<Data>$$MIN(S1,B,S2,I) - минимум                                                 </Data>
</Node>
<Node><Sub>19</Sub>
<Data>$$PLU(S1,B,S2,I) - считает сколько раз выполненилось условие I             </Data>
</Node>
<Node><Sub>20</Sub>
<Data>2.            ________________________________________________</Data>
</Node>
<Node><Sub>21</Sub>
<Data>···­­­---===========   ОБЩЕГО НАЗНАЧЕНИЯ (не цикличные) =============---­­­···</Data>
</Node>
<Node><Sub>22</Sub>
<Data>              ------------------------------------------------</Data>
</Node>
<Node><Sub>23</Sub>
<Data>$$PROC(A1,A2,E,K,P) - Вычисление процента числа A1 от числа A2             </Data>
</Node>
<Node><Sub>24</Sub>
<Data>                      с точностью K                                        </Data>
</Node>
<Node><Sub>25</Sub>
<Data> E = 1 ,то при Ошибке Деления на 0 значение функции =&lt;DIVER&gt;               </Data>
</Node>
<Node><Sub>26</Sub>
<Data> K = Количество знаков после запятой                                       </Data>
</Node>
<Node><Sub>27</Sub>
<Data> P = 1 ,то к значению процента прилеплять символ %                         </Data>
</Node>
<Node><Sub>28</Sub>
<Data>                                                                           </Data>
</Node>
<Node><Sub>29</Sub>
<Data>   A1,A2 - ссылки на клетки !!! без кавычек !!!                            </Data>
</Node>
<Node><Sub>30</Sub>
<Data>   ,например  {2,5}  для 2 строки и 5 колонки                              </Data>
</Node>
<Node><Sub>31</Sub>
<Data>{2,5,&quot;TAB&quot;}       - таблицы TAB текущего pаздела                           </Data>
</Node>
<Node><Sub>32</Sub>
<Data>{2,5,&quot;TAB&quot;,&quot;PAR&quot;} - раздела PAR таблицы TAB текущего кипа                  </Data>
</Node>
<Node><Sub>33</Sub>
<Data>{2,5,&quot;TAB&quot;,&quot;PAR&quot;,&quot;UCI&quot;,&quot;SYS&quot;} - ... кипа UCI , тома SYS  **                </Data>
</Node>
<Node><Sub>34</Sub>
<Data> ( возможен и желателен новый синтаксис полной адресации , который         </Data>
</Node>
<Node><Sub>35</Sub>
<Data>  поддаётся трансляции приложений при переносе в другие тома и системы):   </Data>
</Node>
<Node><Sub>36</Sub>
<Data>{2,5,&quot;TAB&quot;,&quot;PAR&quot;,&quot;[&quot;&quot;UCI&quot;&quot;,&quot;&quot;SYS&quot;&quot;]&quot;,&quot;&quot;} - ... кипа UCI , тома SYS **      </Data>
</Node>
<Node><Sub>37</Sub>
<Data>{2,5,&quot;TAB&quot;,&quot;PAR&quot;,&quot;&quot;,&quot;[&quot;&quot;UCI&quot;&quot;,&quot;&quot;SYS&quot;&quot;]&quot;} - ... кипа UCI , тома SYS **      </Data>
</Node>
<Node><Sub>38</Sub>
<Data>  ** - все три записи идентичны                                            </Data>
</Node>
<Node><Sub>39</Sub>
<Data>                                                                           </Data>
</Node>
<Node><Sub>40</Sub>
<Data>$$DEL(A1,A2) - деление A1 на A2                                            </Data>
</Node>
<Node><Sub>41</Sub>
<Data>$$OST(A1,A2) - остаток от деления A1 на A2                                 </Data>
</Node>
<Node><Sub>42</Sub>
<Data>$$DEN(A1,A2) - деление нацело A1 на A2                                     </Data>
</Node>
<Node><Sub>43</Sub>
<Data>$$OKR(A1,B)  - округлить A1 с точностью до B знаков после точки            </Data>
</Node>
<Node><Sub>44</Sub>
<Data>$$STE(A1,B)  - возвести A1 в степень B                                     </Data>
</Node>
<Node><Sub>45</Sub>
<Data>$$ABS(A1)    - абсолютное значение A1                                      </Data>
</Node>
<Node><Sub>46</Sub>
<Data>$$SetVar(N,V,Z,B) - ПРИСВОИТЬ ПЕРЕМЕННОЙ С ИМЕНЕМ N ДЛЯ ТЕКУЩЕЙ ТАБЛИЦЫ,</Data>
</Node>
<Node><Sub>47</Sub>
<Data>                  ЗНАЧЕНИЕ V. ЕСЛИ  Z=1 ,ТО ПУСТЫЕ ПЕРЕМЕННЫЕ НЕ ПРИСВАИВАТЬ </Data>
</Node>
<Node><Sub>48</Sub>
<Data>                                    B=1 ДОЛЖНА РАБОТАТЬ НЕ В СВОДКАХ\СПИСКАХ</Data>
</Node>
<Node><Sub>49</Sub>
<Data>                                    B=0 РАБОТАТЬ ДОЛЖНА В СВОДКАХ\СПИСКАХ</Data>
</Node>
<Node><Sub>50</Sub>
<Data> !!!! $$SetVar(N,V,Z,B)=1   ВСЕГДА !!!</Data>
</Node>
<Node><Sub>51</Sub>
<Data>ДЛЯ ТОГО ЧТОБЫ ВЫЗВАТЬ ПЕРЕМЕННУЮ С ИМЕНЕМ N ДЛЯ ТЕКУЩЕЙ ТАБЛИЦЫ,</Data>
</Node>
<Node><Sub>52</Sub>
<Data>ВОСПОЛЬЗУЙТЕСЬ ФУНКЦИЕЙ            $$Var(N)</Data>
</Node>
<Node><Sub>53</Sub>
<Data></Data>
</Node>
<Node><Sub>54</Sub>
<Data>                                                                           </Data>
</Node>
<Node><Sub>55</Sub>
<Data> Если вы ходите использовать значение текущей клетки ,то вместо            </Data>
</Node>
<Node><Sub>56</Sub>
<Data>        ссылки A1 можете поставить переменную   d или d0                   </Data>
</Node>
<Node><Sub>57</Sub>
<Data>                     Если d=&quot;&quot; ,то d0=0                                    </Data>
</Node>
<Node><Sub>58</Sub>
<Data>3.            ________________________________________________</Data>
</Node>
<Node><Sub>59</Sub>
<Data>···­­­---===========       ГЕНЕРИРУЮЩИХ СПИСОК          =============---­­­···</Data>
</Node>
<Node><Sub>60</Sub>
<Data>              ------------------------------------------------</Data>
</Node>
<Node><Sub>61</Sub>
<Data> $$TSP(P,C,S,T,Z) - главная (обязательная) функция списка                  </Data>
</Node>
<Node><Sub>62</Sub>
<Data>      P - ссылка на раздел,таблицу. Например:    (P=&quot;PAR,TAB&quot;)             </Data>
</Node>
<Node><Sub>63</Sub>
<Data>      C - строки описывающие цикл списка.        (C=&quot;4&quot;)                   </Data>
</Node>
<Node><Sub>64</Sub>
<Data>      S - строки в формате FOR описывающие шапку (S=&quot;1:1:3&quot;)               </Data>
</Node>
<Node><Sub>65</Sub>
<Data>      T - строки описывающие итог                (T=&quot;5,6&quot;)                 </Data>
</Node>
<Node><Sub>66</Sub>
<Data>      Z - текст заголовка           (Z=&quot;ЗАГОЛОВОК СПИСКА&quot;)                 </Data>
</Node>
<Node><Sub>67</Sub>
<Data>                                                                           </Data>
</Node>
<Node><Sub>68</Sub>
<Data> $$TSPGL(U) - условие на обработку документа                               </Data>
</Node>
<Node><Sub>69</Sub>
<Data>     U=&quot;{i,j}&gt;1&quot; Если условие не прошло,карта не обрабатывается            </Data>
</Node>
<Node><Sub>70</Sub>
<Data>  $$TSPGL(&quot;$$SetVar(1,k3,1,0)&quot;) - пример использования присвоения переменной</Data>
</Node>
<Node><Sub>71</Sub>
<Data>                                  для текущей таблицы (смотри в $$SetVar)</Data>
</Node>
<Node><Sub>72</Sub>
<Data>                                                                           </Data>
</Node>
<Node><Sub>73</Sub>
<Data> $$TSPL(A1,D,A2,I,X) - функция вычисления строки цикла списка              </Data>
</Node>
<Node><Sub>74</Sub>
<Data>      D=&quot;&quot; ,то включаются в список A1 и A2 при выполнении I                </Data>
</Node>
<Node><Sub>75</Sub>
<Data>      D=&quot;{i,j}&quot;,то включаются в список A1,D и A2                           </Data>
</Node>
<Node><Sub>76</Sub>
<Data>      D=ЧИСЛО ,то включаются в список от A1 до A2 с шагом D                </Data>
</Node>
<Node><Sub>77</Sub>
<Data>      D=&quot;~&quot;,то выполнится по XECUTE команда A1.(ki-текущие ключи)          </Data>
</Node>
<Node><Sub>78</Sub>
<Data>      X=1  - длинные хвосты данных загибать ,увеличивая высоту              </Data>
</Node>
<Node><Sub>79</Sub>
<Data>             строки списка                                                  </Data>
</Node>
<Node><Sub>80</Sub>
<Data>      X=12 - длинные хвосты трансформированных данных (измененных функциями</Data>
</Node>
<Node><Sub>81</Sub>
<Data>             трансформации) загибать, увеличивая высоту...</Data>
</Node>
<Node><Sub>82</Sub>
<Data>                                                                           </Data>
</Node>
<Node><Sub>83</Sub>
<Data> $$TSPN(I) - сквозная нумерация строк списка,при условии I                 </Data>
</Node>
<Node><Sub>84</Sub>
<Data>                                                                           </Data>
</Node>
<Node><Sub>85</Sub>
<Data> $$TSPPI(A,B,C,E) - функкция генеpации пpомежуточных итогов списка         </Data>
</Node>
<Node><Sub>86</Sub>
<Data>   A - стpоки пpомеж.итогов в фоpмате FOR                                  </Data>
</Node>
<Node><Sub>87</Sub>
<Data>   B=0 - итог фоpмиpуется до достижения условия C                           </Data>
</Node>
<Node><Sub>88</Sub>
<Data>   B=1 - итог фоpмиpуется после достижения условия C                        </Data>
</Node>
<Node><Sub>89</Sub>
<Data>   C - условие достижения условия (НАПРИМЕР:C=&quot;{2,3}=57&quot;)                  </Data>
</Node>
<Node><Sub>90</Sub>
<Data>   C=&quot;$$PAGE(D)&quot; - функция генеpации условия постpаничной pазбивки списка  </Data>
</Node>
<Node><Sub>91</Sub>
<Data>      D - количество стpок в стpанице                                      </Data>
</Node>
<Node><Sub>92</Sub>
<Data>   E=1 - ??????????                                                        </Data>
</Node>
<Node><Sub>93</Sub>
<Data>                                                                           </Data>
</Node>
<Node><Sub>94</Sub>
<Data> $$SUMSPPI(K,1,1,L) - функция суммиpования пpомежуточных итогов списка    </Data>
</Node>
<Node><Sub>95</Sub>
<Data> $$SUMSPI(K,1,1,L) - функция суммиpования итогов списка                   </Data>
</Node>
<Node><Sub>96</Sub>
<Data>   K - номеp колонки котоpую суммиpовать                                   </Data>
</Node>
<Node><Sub>97</Sub>
<Data>   L - логика на суммиpование  (НАПРИМЕР:L=&quot;{s,k}=777&quot;)                    </Data>
</Node>
<Node><Sub>98</Sub>
<Data>4.            ________________________________________________</Data>
</Node>
<Node><Sub>99</Sub>
<Data>···­­­---===========       ГЕНЕРИРУЮЩИХ СВОДКУ          =============---­­­···</Data>
</Node>
<Node><Sub>100</Sub>
<Data>              ------------------------------------------------</Data>
</Node>
<Node><Sub>101</Sub>
<Data> $$TSV(S,C,K,Z,N) - главная (обязательная) функция сводки                  </Data>
</Node>
<Node><Sub>102</Sub>
<Data>      S - ссылки на разделы,таблицы. Например:(S=&quot;^PAR,TAB^PAR1,TTT&quot;)      </Data>
</Node>
<Node><Sub>103</Sub>
<Data>      C - строка ,где находятся функции $$TSVL                             </Data>
</Node>
<Node><Sub>104</Sub>
<Data>      K - колонка ,где находятся функции $$TSVV или $$TSVD                 </Data>
</Node>
<Node><Sub>105</Sub>
<Data>      Z - текст заголовка           (Z=&quot;ЗАГОЛОВОК СПИСКА&quot;)                 </Data>
</Node>
<Node><Sub>106</Sub>
<Data>      N=&quot;A;B&quot; ,где  A=номеp колонки сpавнения                             </Data>
</Node>
<Node><Sub>107</Sub>
<Data>                    B=&quot;C&quot; - поставить номеp сpавнения                         </Data>
</Node>
<Node><Sub>108</Sub>
<Data>                    B=0 - поставить 1 значение из диапазона выборки 0 ключа</Data>
</Node>
<Node><Sub>109</Sub>
<Data>                    B=1 - поставить 1 значение из диапазона выборки 1 ключа</Data>
</Node>
<Node><Sub>110</Sub>
<Data>                    B=№ - поставить 1 значение из диапазона выборки № ключа</Data>
</Node>
<Node><Sub>111</Sub>
<Data>                                                                           </Data>
</Node>
<Node><Sub>112</Sub>
<Data> $$TSVGL(U,,,,,N) - условие на обработку документа                         </Data>
</Node>
<Node><Sub>113</Sub>
<Data>     U=&quot;{i,j}&gt;1&quot; Если условие не прошло,карта не обрабатывается            </Data>
</Node>
<Node><Sub>114</Sub>
<Data>  $$TSVGL(&quot;$$SetVar(1,k3,1,0)&quot;) - пример использования присвоения переменной</Data>
</Node>
<Node><Sub>115</Sub>
<Data>                                  для текущей таблицы (смотри в $$SetVar)</Data>
</Node>
<Node><Sub>116</Sub>
<Data>                                                                           </Data>
</Node>
<Node><Sub>117</Sub>
<Data> $$TSVL(A1,D,A2,I,X,N) - функция вычисления для текущей колонки            </Data>
</Node>
<Node><Sub>118</Sub>
<Data>      D=&quot;&quot; ,то вычисляются данные A1 и A2 при выполнении I                 </Data>
</Node>
<Node><Sub>119</Sub>
<Data>      D=&quot;{i,j}&quot;,то вычисляются данные  A1,D и A2                           </Data>
</Node>
<Node><Sub>120</Sub>
<Data>      D=ЧИСЛО ,то вычисляются данные от A1 до A2 с шагом D                 </Data>
</Node>
<Node><Sub>121</Sub>
<Data>      D=&quot;~&quot;,то выполнится по XECUTE команда A1.(ki-текущие ключи)          </Data>
</Node>
<Node><Sub>122</Sub>
<Data>      X=2 - данные в текущей клетке увеличатся на значение A1 при выполнении I</Data>
</Node>
<Node><Sub>123</Sub>
<Data>      N - порядковый номер Базы Данных из функции $$TSV                    </Data>
</Node>
<Node><Sub>124</Sub>
<Data>              (по-умолчанию 1)</Data>
</Node>
<Node><Sub>125</Sub>
<Data> $$TSVV(I,A1,D,A2,I,N) - функция логики для текущей строки                 </Data>
</Node>
<Node><Sub>126</Sub>
<Data>      I - если выполняется ,то вычисления продолжатся в $$TSVL             </Data>
</Node>
<Node><Sub>127</Sub>
<Data>                                                                           </Data>
</Node>
<Node><Sub>128</Sub>
<Data> $$TSVD(&quot;^MAS@^[&quot;&quot;GLAVK&quot;&quot;]MAS1@^MAS2...&quot;,R,E,SH)  - аналог $$TSVV</Data>
</Node>
<Node><Sub>129</Sub>
<Data>     ^MAS(i) - имя массива МикроЗапросов сводки        </Data>
</Node>
<Node><Sub>130</Sub>
<Data>      R -  номер строки разделителя между МикроЗапросами                   </Data>
</Node>
<Node><Sub>131</Sub>
<Data>      E -  номер строки завершения сводки                                   </Data>
</Node>
<Node><Sub>132</Sub>
<Data>      SH=&quot;^[&quot;&quot;GLAVK&quot;&quot;]SHA&quot; - полная ссылка на таблицу, которая будет</Data>
</Node>
<Node><Sub>133</Sub>
<Data>      являться шаблоном при формировании временной таблицы микрозапросов,</Data>
</Node>
<Node><Sub>134</Sub>
<Data>      когда мы захотим уточнить боковину.</Data>
</Node>
<Node><Sub>135</Sub>
<Data>                                                                           </Data>
</Node>
<Node><Sub>136</Sub>
<Data> $$TSVN - функция вывода номеров уровня сравнения                          </Data>
</Node>
<Node><Sub>137</Sub>
<Data></Data>
</Node>
<Node><Sub>138</Sub>
<Data>5.            ________________________________________________</Data>
</Node>
<Node><Sub>139</Sub>
<Data>···­­­---===========   ФУНКЦИИ АТРИБУТОВ ТАБЛИЦЫ        =============---­­­···</Data>
</Node>
<Node><Sub>140</Sub>
<Data>              ------------------------------------------------</Data>
</Node>
<Node><Sub>141</Sub>
<Data>---------------------------------------------------------------------------</Data>
</Node>
<Node><Sub>142</Sub>
<Data>       ! ИСПОЛЬЗОВАНИЕ ФУНКЦИЙ АТРИБУТОВ ТАБЛИЦЫ   !                       </Data>
</Node>
<Node><Sub>143</Sub>
<Data>       ---------------------------------------------                       </Data>
</Node>
<Node><Sub>144</Sub>
<Data>                                                                           </Data>
</Node>
<Node><Sub>145</Sub>
<Data> $$AC(%1) - ЦВЕТ КЛЕТКИ %1 ,где %1 - ссылка на клетку                      </Data>
</Node>
<Node><Sub>146</Sub>
<Data>            (НАПРИМЕР: %1=&quot;{23,76}&quot; или %1=&quot;{12,5,TABL,PART}&quot;)             </Data>
</Node>
<Node><Sub>147</Sub>
<Data> $$AD(%1) - ДЛИНА %1                                                       </Data>
</Node>
<Node><Sub>148</Sub>
<Data>                                                                           </Data>
</Node>
<Node><Sub>149</Sub>
<Data> $$AH(%1)  - ВЫСОТА %1                                                     </Data>
</Node>
<Node><Sub>150</Sub>
<Data>                                                                           </Data>
</Node>
<Node><Sub>151</Sub>
<Data> $$AP(%1) - ЕСЛИ КЛЕТКА %1 ПОМЕЧЕНА В БЛОКЕ ТО $$AP(%1)=1                  </Data>
</Node>
<Node><Sub>152</Sub>
<Data>                                                                           </Data>
</Node>
<Node><Sub>153</Sub>
<Data> $$AX(%1) - АБСОЛЮТНАЯ КООРДИНАТА ПО X КЛЕТКИ %1                           </Data>
</Node>
<Node><Sub>154</Sub>
<Data>                                                                           </Data>
</Node>
<Node><Sub>155</Sub>
<Data> $$AY(%1) - АБСОЛЮТНАЯ КООРДИНАТА ПО Y КЛЕТКИ %1                           </Data>
</Node>
<Node><Sub>156</Sub>
<Data>                                                                           </Data>
</Node>
<Node><Sub>157</Sub>
<Data> $$AT(%1,%2) - ТЕКСТ ФОРМУЛЫ ТРАНСФОРМАЦИИ КЛЕТКИ %1,ЕСЛИ                  </Data>
</Node>
<Node><Sub>158</Sub>
<Data>               %2=1 - ИСХОДНЫЙ                                             </Data>
</Node>
<Node><Sub>159</Sub>
<Data>               %2=0 - ИСПОЛНЯЕМЫЙ                                          </Data>
</Node>
<Node><Sub>160</Sub>
<Data>                                                                           </Data>
</Node>
<Node><Sub>161</Sub>
<Data> $$AR(%1,%2) - ТЕКСТ ФОРМУЛЫ СИНТАКСИЧЕСКОГО КОНТРОЛЯ КЛЕТКИ %1,ЕСЛИ       </Data>
</Node>
<Node><Sub>162</Sub>
<Data>               %2=1 - ИСХОДНЫЙ                                             </Data>
</Node>
<Node><Sub>163</Sub>
<Data>               %2=0 - ИСПОЛНЯЕМЫЙ                                          </Data>
</Node>
<Node><Sub>164</Sub>
<Data>                                                                           </Data>
</Node>
<Node><Sub>165</Sub>
<Data> $$AL(%1,%2) - ТЕКСТ ФОРМУЛЫ ЛОГИЧЕСКОГО КОНТРОЛЯ КЛЕТКИ %1,ЕСЛИ           </Data>
</Node>
<Node><Sub>166</Sub>
<Data>               %2=1 - ИСХОДНЫЙ                                             </Data>
</Node>
<Node><Sub>167</Sub>
<Data>               %2=0 - ИСПОЛНЯЕМЫЙ                                          </Data>
</Node>
<Node><Sub>168</Sub>
<Data>                                                                           </Data>
</Node>
<Node><Sub>169</Sub>
<Data> $$AF(%1,%2) - ТЕКСТ ФОРМУЛЫ ВЫЧИСЛЕНИЯ КЛЕТКИ %1,ЕСЛИ                     </Data>
</Node>
<Node><Sub>170</Sub>
<Data>               %2=1 - ИСХОДНЫЙ                                             </Data>
</Node>
<Node><Sub>171</Sub>
<Data>               %2=0 - ИСПОЛНЯЕМЫЙ                                          </Data>
</Node>
<Node><Sub>172</Sub>
<Data>                                                                           </Data>
</Node>
<Node><Sub>173</Sub>
<Data> $$AB(%1) - ЕСЛИ %1 ХРАНИТСЯ В БАЗЕ, ТО $$AB(%1)=1                         </Data>
</Node>
<Node><Sub>174</Sub>
<Data>                                                                           </Data>
</Node>
<Node><Sub>175</Sub>
<Data> $$AU(%1,%2) %2=# PICE ДЛЯ КЛЕТКИ %1                                       </Data>
</Node>
<Node><Sub>176</Sub>
<Data>                                                                           </Data>
</Node>
<Node><Sub>177</Sub>
<Data> $$ATB(%1) - ИМЯ БАЗЫ ДАННЫХ ТАБЛИЦЫ %1                                    </Data>
</Node>
<Node><Sub>178</Sub>
<Data>                                                                           </Data>
</Node>
<Node><Sub>179</Sub>
<Data> $$ATK(%1) - КОЛ-ВО КОЛОНОК У ТАБЛИЦЫ %1                                   </Data>
</Node>
<Node><Sub>180</Sub>
<Data>                                                                           </Data>
</Node>
<Node><Sub>181</Sub>
<Data> $$ATU(%1,%2) - %2=# PICE ДЛЯ ТАБЛИЦЫ %1                                   </Data>
</Node>
<Node><Sub>182</Sub>
<Data>                                                                           </Data>
</Node>
<Node><Sub>183</Sub>
<Data> $$ATS(%1) - КОЛ-ВО СТРОК У ТАБЛИЦЫ %1                                     </Data>
</Node>
<Node><Sub>184</Sub>
<Data>                                                                           </Data>
</Node>
<Node><Sub>185</Sub>
<Data><![CDATA[ $$ATC(%1) - ОБЩИЙ ЦВЕТ ТАБЛИЦЫ %1                                                                           ]]></Data>
</Node>
</Node>
<Node><Sub>201</Sub>
<Data><![CDATA[ОПИСАНИЕ ФУНКЦИЙ ТРАНСФОРМАЦИИ@@@@@@@1@1@22@80@@@@1@@5@@@1@@@@@@@@283@@@2;6;30;42///2;6;34;42/2;6;30;42@@@1@@@@1]]></Data>
<Node><Sub>1</Sub>
<Data>1.            ________________________________________________</Data>
</Node>
<Node><Sub>2</Sub>
<Data>···­­­---===========           ОБЩЕГО НАЗНАЧЕНИЯ        =============---­­­···</Data>
</Node>
<Node><Sub>3</Sub>
<Data>              ------------------------------------------------</Data>
</Node>
<Node><Sub>4</Sub>
<Data> $$Data - ДАТА И ВРЕМЯ С ТЕКСТОМ    </Data>
</Node>
<Node><Sub>5</Sub>
<Data> </Data>
</Node>
<Node><Sub>6</Sub>
<Data> $$LongS(x,S) ТРАНСФОРМАЦИЯ ДЛЯ ДЛИННЫХ СТРОК </Data>
</Node>
<Node><Sub>7</Sub>
<Data>           x- номер колонки в которой начинается длинная строка</Data>
</Node>
<Node><Sub>8</Sub>
<Data>           S- сама длинная строка</Data>
</Node>
<Node><Sub>9</Sub>
<Data></Data>
</Node>
<Node><Sub>10</Sub>
<Data> $$DTT(T,d0) - трансформирует дату из ГГММДД в ДД.ММ.ГГ,если T=6.              DTT^%ZAPM.ed.BSsFUNR</Data>
</Node>
<Node><Sub>11</Sub>
<Data>       если T=9,то трансформирует из ГГММДДЧЧММ в ЧЧ:ММ ДД.ММ.ГГ</Data>
</Node>
<Node><Sub>12</Sub>
<Data></Data>
</Node>
<Node><Sub>13</Sub>
<Data><![CDATA[ $$ESDAY(T,d0) - трансформирует дату из $H в ДД.ММ.ГГ,если T=6.                ESDAY^%ZAPM.ed.BSsFUNR]]></Data>
</Node>
<Node><Sub>14</Sub>
<Data>                                  если T=4 в ГГГГ (год)</Data>
</Node>
<Node><Sub>15</Sub>
<Data>                                  если T=9 в ЧЧ:ММ ДД.ММ.ГГ</Data>
</Node>
<Node><Sub>16</Sub>
<Data>                                  если T=8 в ЧЧ:ММ:СС ДД.ММ.ГГ</Data>
</Node>
<Node><Sub>17</Sub>
<Data></Data>
</Node>
<Node><Sub>18</Sub>
<Data> $$MZ^%ZAPM.ed.BSTABE2(d) - СПЕЦИАЛЬНАЯ ФУНКЦИЯ ТРАНСФОРМАЦИИ ПЕРЕКЛЮЧЕНИЯ С СЕКРЕТНОЙ</Data>
</Node>
<Node><Sub>19</Sub>
<Data>                    БОКОВИНЫ НА &quot;НЕ СЕКРЕТНУЮ&quot; ПО КЛАВИШЕ &quot;~&quot;      </Data>
</Node>
<Node><Sub>20</Sub>
<Data> $$TIN(&quot;^INV&quot;,d0,F) - обратная к функции $$INV (см.функции синт.контроля)      TIN^%ZAPM.ed.BSsFUNR</Data>
</Node>
<Node><Sub>21</Sub>
<Data>       трансформирует d0=код в текст КОДИФИКАТОРА ^INV</Data>
</Node>
<Node><Sub>22</Sub>
<Data>       Если F=1 ,то при Ошибке $$TIN(&quot;^INV&quot;,d0,1)=&quot;&quot;</Data>
</Node>
<Node><Sub>23</Sub>
<Data></Data>
</Node>
<Node><Sub>24</Sub>
<Data><![CDATA[ $$DATHR(T,d0) - переводит ГГММДД В системную дату $H                          DATHR^%ZAPM.ed.BSsFUNR]]></Data>
</Node>
<Node><Sub>25</Sub>
<Data>     если T=6 - ГГММДД ---&gt; В количество дней</Data>
</Node>
<Node><Sub>26</Sub>
<Data>     если T=9 - ГГММДДЧЧММ -&gt; В кол-во дней,кол-во секунд</Data>
</Node>
<Node><Sub>27</Sub>
<Data></Data>
</Node>
<Node><Sub>28</Sub>
<Data> $$WEEK(T,d0) - переводит день дату из ГГММДД в:                               WEEK^%ZAPM.ed.BSsFUNR</Data>
</Node>
<Node><Sub>29</Sub>
<Data>     если T=1 - текст дня недели</Data>
</Node>
<Node><Sub>30</Sub>
<Data>     если T=2 - номер дня недели</Data>
</Node>
<Node><Sub>31</Sub>
<Data> </Data>
</Node>
<Node><Sub>32</Sub>
<Data> $$TXTD(d) - Представление числа прописью из                                   TXTD^%ZAPM.ed.BSsFUNR</Data>
</Node>
<Node><Sub>33</Sub>
<Data>     d=ГГММДД      в ДД месяц ГГ</Data>
</Node>
<Node><Sub>34</Sub>
<Data>     d=ГГГГММДД    в ДД месяц ГГГГ</Data>
</Node>
<Node><Sub>35</Sub>
<Data></Data>
</Node>
<Node><Sub>36</Sub>
<Data><![CDATA[ $$CENTR(d,L,C) - ЦентРиРование Данных клетки                                  CENTR^%ZAPM.ed.BSsFUNM]]></Data>
</Node>
<Node><Sub>37</Sub>
<Data>   L=ДЛИНА (для применения вне таблиц) , если L=0 , то длина берется из клетки</Data>
</Node>
<Node><Sub>38</Sub>
<Data>    если C=1 -то центрирование</Data>
</Node>
<Node><Sub>39</Sub>
<Data>    если C=2 -то впpаво</Data>
</Node>
<Node><Sub>40</Sub>
<Data>    если C=0 -то влево</Data>
</Node>
<Node><Sub>41</Sub>
<Data></Data>
</Node>
<Node><Sub>42</Sub>
<Data><![CDATA[ $$DSCORR(d,M) - ФОРМАТИРОВАНИЕ ТЕКСТА В КЛЕТКЕ С ПЕРЕНОСОМ ПО СЛОВАМ          DSCORR^%ZAPM.ed.BSsFUNM]]></Data>
</Node>
<Node><Sub>43</Sub>
<Data>    M- на сколько уменьшить длину текущей клетки</Data>
</Node>
<Node><Sub>44</Sub>
<Data></Data>
</Node>
<Node><Sub>45</Sub>
<Data> $$CELL(1,2,3,4) ;ПСЕВДОГРАФИКА            3 |                                 CELL^%ZAPM.ed.BSsFUNM</Data>
</Node>
<Node><Sub>46</Sub>
<Data>        1 - Данные в клетке        2  =======|  4</Data>
</Node>
<Node><Sub>47</Sub>
<Data></Data>
</Node>
<Node><Sub>48</Sub>
<Data>    Примеры: $$CELL(d,&quot;=&quot;,&quot;|&quot;,&quot;=&quot;) - Угловая двойная</Data>
</Node>
<Node><Sub>49</Sub>
<Data>             $$CELL(d,&quot;-&quot;,&quot;|&quot;,&quot;-&quot;) - Угловая одинарная</Data>
</Node>
<Node><Sub>50</Sub>
<Data>             $$CELL(d,&quot;-&quot;,&quot;|&quot;,&quot;|&quot;) - Средняя смешанная</Data>
</Node>
<Node><Sub>51</Sub>
<Data></Data>
</Node>
<Node><Sub>52</Sub>
<Data> $$MONEY(d) - Денежное ПРедставление данных</Data>
</Node>
<Node><Sub>53</Sub>
<Data></Data>
</Node>
<Node><Sub>54</Sub>
<Data> $$MONT(d) - Пpедставление текста месяца ,пpи d=номеp месяца</Data>
</Node>
<Node><Sub>55</Sub>
<Data></Data>
</Node>
<Node><Sub>56</Sub>
<Data> $$SPSTR(1) - функция нумеpация стpаниц в списке с пpомежуточными итогами</Data>
</Node>
<Node><Sub>57</Sub>
<Data></Data>
</Node>
<Node><Sub>58</Sub>
<Data> $$SelecBut(%1,%2,%3) - ЗАВИСИМЫЕ CЕЛЕКТОРНЫЕ КНОПКИ</Data>
</Node>
<Node><Sub>59</Sub>
<Data>  %1- ТИП КНОПОК ПАНЕЛИ  1=[X]   2=(o)  3=&lt;§&gt;</Data>
</Node>
<Node><Sub>60</Sub>
<Data>  %2=1 ПРЕДУСТАНОВКА КНОПКИ В ПОЛОЖЕНИИ &quot;ON&quot;</Data>
</Node>
<Node><Sub>61</Sub>
<Data>  %3= ВОЗВРАЩАЕМЫЕ ДАННЫЕ ПРИ &quot;ON&quot;</Data>
</Node>
<Node><Sub>62</Sub>
<Data> НЕОБХОДИМА ПРОГРАММА ПРЕДОБРАБОТКИ КЛАВИШ В ОПИСАНИИ ТАБЛИЦЫ: SelZ^%ZAPM.ed.BSF9</Data>
</Node>
<Node><Sub>63</Sub>
<Data>  (пример в таблице ^%ZAPM.ed.BSS(&quot;selekt-z&quot;))</Data>
</Node>
<Node><Sub>64</Sub>
<Data></Data>
</Node>
<Node><Sub>65</Sub>
<Data> $$But(%1) - ОКАНТОВЫВАЕТ ДАННЫЕ %1 В ВИДЕ КНОПКИ</Data>
</Node>
<Node><Sub>66</Sub>
<Data>  (пример в таблице ^%ZAPM.ed.BSS(&quot;ARMB&quot;))</Data>
</Node>
<Node><Sub>67</Sub>
<Data></Data>
</Node>
<Node><Sub>68</Sub>
<Data>                                * * * * *</Data>
</Node>
<Node><Sub>69</Sub>
<Data>ПРИМЕРЫ:</Data>
</Node>
<Node><Sub>70</Sub>
<Data></Data>
</Node>
<Node><Sub>71</Sub>
<Data> $TR($J(&quot;&quot;,9),&quot; &quot;,&quot;|&quot;) - организация повтора &quot;|&quot; девять раз</Data>
</Node>
<Node><Sub>72</Sub>
<Data>    (необходимо применять в клетках разделителя колонок при вклюненном</Data>
</Node>
<Node><Sub>73</Sub>
<Data>    &quot;загибании &quot; длинных данных СПИСКА в функции $$TSPL(...,,,,&quot;1&quot;).</Data>
</Node>
<Node><Sub>74</Sub>
<Data> </Data>
</Node>
<Node><Sub>75</Sub>
<Data><![CDATA[ $G(d0)_" "_$S(d0'=0:{7,3,"10101L","F10101","[""GLAVK""]","",+$G(%KEYS(0)),+$G(%KEYS(1)),+$G(%KEYS(2)),$G(%KEYS(3)),$G(d0)},1:"ОБЩАЯ ЧАСТЬ")]]></Data>
</Node>
<Node><Sub>76</Sub>
<Data> трансформация в ключах для вывода значений из карты БД на уровень ключей...</Data>
</Node>
<Node><Sub>77</Sub>
<Data>  </Data>
</Node>
<Node><Sub>78</Sub>
<Data>2.            ________________________________________________</Data>
</Node>
<Node><Sub>79</Sub>
<Data>···­­­---=========== Некоторые Внутренние функции ОС MSM=============---­­­···</Data>
</Node>
<Node><Sub>80</Sub>
<Data>              ------------------------------------------------</Data>
</Node>
<Node><Sub>81</Sub>
<Data></Data>
</Node>
<Node><Sub>82</Sub>
<Data>$TRANSLATE - Возвращает строку символов отранслированную по маске</Data>
</Node>
<Node><Sub>83</Sub>
<Data>------------------------------</Data>
</Node>
<Node><Sub>84</Sub>
<Data>Синтаксис  :       $TR{ANSLATE}(String,From{,To})</Data>
</Node>
<Node><Sub>85</Sub>
<Data>Определения:</Data>
</Node>
<Node><Sub>86</Sub>
<Data>       String               строка</Data>
</Node>
<Node><Sub>87</Sub>
<Data>       From                 строка символов - маска для замены &quot;ЧТО&quot;</Data>
</Node>
<Node><Sub>88</Sub>
<Data>       To                   строка символов - маска для замены &quot;НА ЧТО&quot;</Data>
</Node>
<Node><Sub>89</Sub>
<Data>Примеры:</Data>
</Node>
<Node><Sub>90</Sub>
<Data> -     $TR(&quot;ABCDE&quot;,&quot;A&quot;,&quot;X&quot;)            XBCDE - replaces A with X.</Data>
</Node>
<Node><Sub>91</Sub>
<Data> -     $TR(&quot;ABCDE&quot;,&quot;AB&quot;,&quot;X&quot;)           XCDE - replaces A with X</Data>
</Node>
<Node><Sub>92</Sub>
<Data>                                       and B with null.</Data>
</Node>
<Node><Sub>93</Sub>
<Data> -     $TR(&quot;ABCDE&quot;,&quot;AB&quot;,&quot;ab&quot;)          abCDE - replaces A with a</Data>
</Node>
<Node><Sub>94</Sub>
<Data>                                       and B with b.</Data>
</Node>
<Node><Sub>95</Sub>
<Data> -     S X=&quot;A&quot;,Y=&quot;B&quot;,Z=&quot;C&quot;             Indirection can be used.  The code</Data>
</Node>
<Node><Sub>96</Sub>
<Data>       S A=&quot;ABCDE&quot;,B=&quot;AB&quot;,C=&quot;ab&quot;       returns the string &quot;abCDE&quot;.</Data>
</Node>
<Node><Sub>97</Sub>
<Data>       $TR(@X,@Y,@Z)</Data>
</Node>
<Node><Sub>98</Sub>
<Data></Data>
</Node>
<Node><Sub>99</Sub>
<Data></Data>
</Node>
<Node><Sub>100</Sub>
<Data>$JUSTIFY - Возвращает строку сомволов дополненную с левой стороны пробелами</Data>
</Node>
<Node><Sub>101</Sub>
<Data>----------------------------</Data>
</Node>
<Node><Sub>102</Sub>
<Data>Синтаксис  :       $J{USTIFY}(String,Field{,Fraction})</Data>
</Node>
<Node><Sub>103</Sub>
<Data>Определения:</Data>
</Node>
<Node><Sub>104</Sub>
<Data>       String               строка</Data>
</Node>
<Node><Sub>105</Sub>
<Data>       Field                длина поля</Data>
</Node>
<Node><Sub>106</Sub>
<Data>       Fraction             требуемое количество разрядов после точки</Data>
</Node>
<Node><Sub>107</Sub>
<Data>Примеры    :</Data>
</Node>
<Node><Sub>108</Sub>
<Data> -     SET X=12.35                     $JUSTIFY(X,6)=&quot; 12.35&quot;</Data>
</Node>
<Node><Sub>109</Sub>
<Data>                                       $J(X,5)=&quot;12.35&quot;</Data>
</Node>
<Node><Sub>110</Sub>
<Data>                                       $J(X,4)=&quot;12.35&quot;</Data>
</Node>
<Node><Sub>111</Sub>
<Data>                                       $J(X,3)=&quot;12.35&quot;</Data>
</Node>
<Node><Sub>112</Sub>
<Data>                                       $J(X,7,4)=&quot;12.3500&quot;</Data>
</Node>
<Node><Sub>113</Sub>
<Data>                                       $J(X,7,3)=&quot; 12.350&quot;</Data>
</Node>
<Node><Sub>114</Sub>
<Data>                                       $J(X,7,2)=&quot;  12.35&quot;</Data>
</Node>
<Node><Sub>115</Sub>
<Data>                                       $J(X,7,1)=&quot;   12.4&quot;</Data>
</Node>
<Node><Sub>116</Sub>
<Data>                                       $J(X,7,0)=&quot;     12&quot;</Data>
</Node>
<Node><Sub>117</Sub>
<Data></Data>
</Node>
<Node><Sub>118</Sub>
<Data> -     S Y=197                         $J(Y,7,2)=&quot; 197.00&quot;</Data>
</Node>
<Node><Sub>119</Sub>
<Data></Data>
</Node>
<Node><Sub>120</Sub>
<Data> -     S W=1.487                       $J(W,7,2)=&quot;   1.49&quot;</Data>
</Node>
<Node><Sub>121</Sub>
<Data>                                       $J(W,7,1)=&quot;    1.5&quot;</Data>
</Node>
<Node><Sub>122</Sub>
<Data>                                       $J(W,7,0)=&quot;      1&quot;</Data>
</Node>
<Node><Sub>123</Sub>
<Data></Data>
</Node>
<Node><Sub>124</Sub>
<Data> -     S Z=&quot;123.4ABC&quot;                  $J(Z,10)=&quot;  123.4ABC&quot;</Data>
</Node>
<Node><Sub>125</Sub>
<Data>                                       $J(Z,10,2)=&quot;    123.40&quot;</Data>
</Node>
<Node><Sub>126</Sub>
<Data>                                       $J(Z,10,0)=&quot;       123&quot;</Data>
</Node>
<Node><Sub>127</Sub>
<Data></Data>
</Node>
<Node><Sub>128</Sub>
<Data>$PIECE - возвращает подстроку выделенную из строки по заданному разделителю</Data>
</Node>
<Node><Sub>129</Sub>
<Data>-----------------------------</Data>
</Node>
<Node><Sub>130</Sub>
<Data>Синтаксис  :       $P{IECE}(String,Delimiter{,First{,Last}})</Data>
</Node>
<Node><Sub>131</Sub>
<Data>Определения:</Data>
</Node>
<Node><Sub>132</Sub>
<Data>       String               строка символов</Data>
</Node>
<Node><Sub>133</Sub>
<Data>       Delimiter            разделитель</Data>
</Node>
<Node><Sub>134</Sub>
<Data>       First                номер начального поля</Data>
</Node>
<Node><Sub>135</Sub>
<Data>       Last                 номер конечного поля</Data>
</Node>
<Node><Sub>136</Sub>
<Data>Примеры:</Data>
</Node>
<Node><Sub>137</Sub>
<Data> -     SET X=&quot;ABC*DEF&quot;                 $PIECE(X,&quot;*&quot;)=&quot;ABC&quot;</Data>
</Node>
<Node><Sub>138</Sub>
<Data>                                       $P(X,&quot;*&quot;,1)=&quot;ABC&quot;</Data>
</Node>
<Node><Sub>139</Sub>
<Data>                                       $P(X,&quot;*&quot;,2)=&quot;DEF&quot;</Data>
</Node>
<Node><Sub>140</Sub>
<Data>                                       $P(X,&quot;*&quot;,3)=&quot;&quot; (null string)</Data>
</Node>
<Node><Sub>141</Sub>
<Data>                                       $P(X,&quot;B&quot;,1)=&quot;A&quot;</Data>
</Node>
<Node><Sub>142</Sub>
<Data>                                       $P(X,&quot;/&quot;,1)=&quot;ABC*DEF&quot;</Data>
</Node>
<Node><Sub>143</Sub>
<Data></Data>
</Node>
<Node><Sub>144</Sub>
<Data> -     S Y=&quot;B&quot;                         $P(X,Y,1)=&quot;A&quot;</Data>
</Node>
<Node><Sub>145</Sub>
<Data>                                       $P(X,Y,2)=&quot;C*DEF&quot;</Data>
</Node>
<Node><Sub>146</Sub>
<Data></Data>
</Node>
<Node><Sub>147</Sub>
<Data> -     S Z=&quot;A.B.C.D&quot;                   $P(Z,&quot;.&quot;,1)=&quot;A&quot;</Data>
</Node>
<Node><Sub>148</Sub>
<Data>                                       $P(Z,&quot;.&quot;,2,3)=&quot;B.C&quot;</Data>
</Node>
<Node><Sub>149</Sub>
<Data>                                       $P(Z,&quot;.&quot;,1,100)=&quot;A.B.C.D&quot;</Data>
</Node>
<Node><Sub>150</Sub>
<Data>                                       $P(Z,&quot;.&quot;,0)=&quot;&quot; (null string)</Data>
</Node>
<Node><Sub>151</Sub>
<Data>                                       $P(Z,&quot;.&quot;,3,2)=&quot;&quot; (null string)</Data>
</Node>
<Node><Sub>152</Sub>
<Data>                                       $P(Z,&quot;&quot;,1,100)=&quot;&quot; (null string)</Data>
</Node>
<Node><Sub>153</Sub>
<Data></Data>
</Node>
<Node><Sub>154</Sub>
<Data> -     S Z=&quot;A.B.C.D&quot;,$P(Z,&quot;.&quot;,2,3)=123</Data>
</Node>
<Node><Sub>155</Sub>
<Data></Data>
</Node>
<Node><Sub>156</Sub>
<Data>                                       Z=&quot;A.123.D&quot;</Data>
</Node>
<Node><Sub>157</Sub>
<Data></Data>
</Node>
<Node><Sub>158</Sub>
<Data> -     S Z=&quot;A.&quot;,$P(Z,&quot;.&quot;,5)=123        Z=&quot;A....123&quot;</Data>
</Node>
<Node><Sub>159</Sub>
<Data></Data>
</Node>
<Node><Sub>160</Sub>
<Data> -     K Z S $P(Z,&quot;.&quot;,5)=3             Z=&quot;....3&quot;</Data>
</Node>
<Node><Sub>161</Sub>
<Data></Data>
</Node>
<Node><Sub>162</Sub>
<Data> -     S Z=&quot;ABC&quot;,$P(Z,&quot;&quot;,1)=123        Z=123</Data>
</Node>
<Node><Sub>163</Sub>
<Data></Data>
</Node>
<Node><Sub>164</Sub>
<Data> -     S Z=&quot;ABC&quot;,$P($Z,&quot;&quot;2)=123        Z=&quot;ABC123&quot;</Data>
</Node>
<Node><Sub>165</Sub>
<Data></Data>
</Node>
<Node><Sub>166</Sub>
<Data>$EXTRACT - возвращает подстроку выделенную из строки по заданным позициям</Data>
</Node>
<Node><Sub>167</Sub>
<Data>-------------------------------</Data>
</Node>
<Node><Sub>168</Sub>
<Data>Синтаксис  :       $E{XTRACT}(String{,Begin{,End}})</Data>
</Node>
<Node><Sub>169</Sub>
<Data>Определения:</Data>
</Node>
<Node><Sub>170</Sub>
<Data>       String               строка символов</Data>
</Node>
<Node><Sub>171</Sub>
<Data>       Begin                начальная позиция</Data>
</Node>
<Node><Sub>172</Sub>
<Data>       End                  конечная позиция</Data>
</Node>
<Node><Sub>173</Sub>
<Data>Примеры:</Data>
</Node>
<Node><Sub>174</Sub>
<Data> -     SET X=&quot;ABCDE&quot;                   $E(X)=&quot;A&quot;</Data>
</Node>
<Node><Sub>175</Sub>
<Data>                                       $E(X,1)=&quot;A&quot;</Data>
</Node>
<Node><Sub>176</Sub>
<Data>                                       $E(X,2)=&quot;B&quot;</Data>
</Node>
<Node><Sub>177</Sub>
<Data>                                       $E(X,1,2)=&quot;AB&quot;</Data>
</Node>
<Node><Sub>178</Sub>
<Data>                                       $E(X,1,4)=&quot;ABCD&quot;</Data>
</Node>
<Node><Sub>179</Sub>
<Data>                                       $E(X,0,100)=&quot;ABCDE&quot;</Data>
</Node>
<Node><Sub>180</Sub>
<Data>                                       $E(X,3.9)=&quot;C&quot; (uses 3 as begin)</Data>
</Node>
<Node><Sub>181</Sub>
<Data>                                       $E(x,-1,6)=&quot;ABCDE&quot;</Data>
</Node>
<Node><Sub>182</Sub>
<Data>                                       $E(X,0)=&quot;&quot; (null string)</Data>
</Node>
<Node><Sub>183</Sub>
<Data>                                       $E(X,99)=&quot;&quot; (null string)</Data>
</Node>
<Node><Sub>184</Sub>
<Data>                                       $E(X,-3)=&quot;&quot; (null string)</Data>
</Node>
<Node><Sub>185</Sub>
<Data>                                       $E(X,3,2)=&quot;&quot; (null string)</Data>
</Node>
<Node><Sub>186</Sub>
<Data>                                       $E(X,-10,-5)=&quot;&quot; (null string)</Data>
</Node>
<Node><Sub>187</Sub>
<Data></Data>
</Node>
<Node><Sub>188</Sub>
<Data> -     S A(1)=&quot;2BC&quot;                    $E(A(1),A(1))=&quot;B&quot;</Data>
</Node>
<Node><Sub>189</Sub>
<Data></Data>
</Node>
<Node><Sub>190</Sub>
<Data> -     S X=&quot;ABCDE&quot;,$E(X,3,4)=12        X=&quot;AB12E&quot;</Data>
</Node>
<Node><Sub>191</Sub>
<Data></Data>
</Node>
<Node><Sub>192</Sub>
<Data> -     S X=&quot;ABCDE&quot;,$E(X,2,4)=1         X=&quot;A1E&quot;</Data>
</Node>
<Node><Sub>193</Sub>
<Data></Data>
</Node>
<Node><Sub>194</Sub>
<Data> -     S X=&quot;A&quot;,$E(X,3)=1               X=&quot;A 1&quot;</Data>
</Node>
<Node><Sub>195</Sub>
<Data></Data>
</Node>
<Node><Sub>196</Sub>
<Data> -     K X S $E(X,3,4)=12              X=&quot;  12&quot;</Data>
</Node>
<Node><Sub>197</Sub>
<Data></Data>
</Node>
<Node><Sub>198</Sub>
<Data> -     S A=&quot;NAME&quot;,NAME=&quot;AB&quot;</Data>
</Node>
<Node><Sub>199</Sub>
<Data>       S $E(@A)=1 NAME=&quot;1B&quot;</Data>
</Node>
<Node><Sub>200</Sub>
<Data></Data>
</Node>
<Node><Sub>201</Sub>
<Data>$GET - возвращает значение переменной, если она существует.</Data>
</Node>
<Node><Sub>202</Sub>
<Data>--------------------------</Data>
</Node>
<Node><Sub>203</Sub>
<Data>Синтаксис  :       $G{ET}(Variable{,DefaultVal})</Data>
</Node>
<Node><Sub>204</Sub>
<Data>Определения:</Data>
</Node>
<Node><Sub>205</Sub>
<Data>       Variable          имя переменной</Data>
</Node>
<Node><Sub>206</Sub>
<Data>       DefaultVal        возвращаемое значение, если переменная не существует</Data>
</Node>
<Node><Sub>207</Sub>
<Data>Примеры:</Data>
</Node>
<Node><Sub>208</Sub>
<Data> -     KILL ABC                        $GET(ABC,&quot;123&quot;)=123</Data>
</Node>
<Node><Sub>209</Sub>
<Data>                                       $G(ABC(1,3))=&quot;&quot;</Data>
</Node>
<Node><Sub>210</Sub>
<Data>                                       $G(ABC(1,3),&quot;EMPTY&quot;)=&quot;EMPTY&quot;</Data>
</Node>
<Node><Sub>211</Sub>
<Data></Data>
</Node>
<Node><Sub>212</Sub>
<Data> -     S ABC(1,3)=4                    $G(ABC(1,3),&quot;EMPTY&quot;)=4</Data>
</Node>
<Node><Sub>213</Sub>
<Data></Data>
</Node>
<Node><Sub>214</Sub>
<Data>$FNUMBER - функция форматирования. Выдает значение выражения,</Data>
</Node>
<Node><Sub>215</Sub>
<Data>----------------------------------</Data>
</Node>
<Node><Sub>216</Sub>
<Data> форматированного согласно маске, определенной пользователем,</Data>
</Node>
<Node><Sub>217</Sub>
<Data> в поле определенного  размера.  Маска - шаблон последовательности знаков.</Data>
</Node>
<Node><Sub>218</Sub>
<Data>                                                                            </Data>
</Node>
<Node><Sub>219</Sub>
<Data>    СИНТАКСИС:                                                              </Data>
</Node>
<Node><Sub>220</Sub>
<Data>                                                                            </Data>
</Node>
<Node><Sub>221</Sub>
<Data>$FN&lt;UMBER&gt;(ЧИСЛО,ФОРМАТ&lt;,ДРОБ.ЧАСТЬ&gt;)                                       </Data>
</Node>
<Node><Sub>222</Sub>
<Data>                                                                            </Data>
</Node>
<Node><Sub>223</Sub>
<Data>    ОПРЕДЕЛЕНИЕ:                                                            </Data>
</Node>
<Node><Sub>224</Sub>
<Data>                                                                            </Data>
</Node>
<Node><Sub>225</Sub>
<Data>      ЧИСЛО      - Любое числовое выражение.                                </Data>
</Node>
<Node><Sub>226</Sub>
<Data>                                                                            </Data>
</Node>
<Node><Sub>227</Sub>
<Data>      ФОРМАТ     - Выражение символьного типа, которое определяет           </Data>
</Node>
<Node><Sub>228</Sub>
<Data>                   форматирование, выполняемое для ЧИСЛА.                   </Data>
</Node>
<Node><Sub>229</Sub>
<Data>                                                                            </Data>
</Node>
<Node><Sub>230</Sub>
<Data>      ДРОБ.ЧАСТЬ -  Целочисленное  выражение,  которое  определяет          </Data>
</Node>
<Node><Sub>231</Sub>
<Data>                    число цифр справа от десятичной точки.                  </Data>
</Node>
<Node><Sub>232</Sub>
<Data>                                                                            </Data>
</Node>
<Node><Sub>233</Sub>
<Data>    Функция $FNUMBER выдает определенное число как строку, формати-         </Data>
</Node>
<Node><Sub>234</Sub>
<Data>рованную согласно шаблону,  который задается с помощью кодов ФОРМА-         </Data>
</Node>
<Node><Sub>235</Sub>
<Data>ТА. Коды ФОРМАТА могут быть следующими:                                     </Data>
</Node>
<Node><Sub>236</Sub>
<Data>                                                                            </Data>
</Node>
<Node><Sub>237</Sub>
<Data>=================================================================           </Data>
</Node>
<Node><Sub>238</Sub>
<Data>#  Коды  #  Результат выполнения функции. #                                 </Data>
</Node>
<Node><Sub>239</Sub>
<Data>=================================================================           </Data>
</Node>
<Node><Sub>240</Sub>
<Data>   +         Добавляет знак &apos;+&apos;  ко  всем   положительным                   </Data>
</Node>
<Node><Sub>241</Sub>
<Data>             значениям ЧИСЛА.                                               </Data>
</Node>
<Node><Sub>242</Sub>
<Data>   -         Запрещает  (подавляет) знак &apos;-&apos; у отрицательных зна-           </Data>
</Node>
<Node><Sub>243</Sub>
<Data>             чений ЧИСЛА, т.е. выдает абсолютное значение ЧИСЛА.            </Data>
</Node>
<Node><Sub>244</Sub>
<Data>   ,         Вставляет в форматируемое ЧИСЛО запятую через каждую            </Data>
</Node>
<Node><Sub>245</Sub>
<Data>             третью позицию слева от десятичной точки.                      </Data>
</Node>
<Node><Sub>246</Sub>
<Data>   Т         Показывает ЧИСЛО со знаком &apos;+&apos; или &apos;-&apos;, идущими за             </Data>
</Node>
<Node><Sub>247</Sub>
<Data>             ЧИСЛОМ.                                                        </Data>
</Node>
<Node><Sub>248</Sub>
<Data>             Если знак подавлется (т.е. положительное число или             </Data>
</Node>
<Node><Sub>249</Sub>
<Data>             код форматирования &apos;-&apos;), добавлется хвостовой пробел.          </Data>
</Node>
<Node><Sub>250</Sub>
<Data>   Р         Представляет отрицательное значение ЧИСЛА в скобках.           </Data>
</Node>
<Node><Sub>251</Sub>
<Data>             Если же значение ЧИСЛА положительно, то вместо ско-            </Data>
</Node>
<Node><Sub>252</Sub>
<Data>             бок, на их же позициях, будут вставлены пробелы.               </Data>
</Node>
<Node><Sub>253</Sub>
<Data>                                                                            </Data>
</Node>
<Node><Sub>254</Sub>
<Data>    Порядок в котором определены коды ФОРМАТА,  не влияет на обра-          </Data>
</Node>
<Node><Sub>255</Sub>
<Data>ботку.  Если какой-либо код ФОРМАТА определен более чем один  раз,          </Data>
</Node>
<Node><Sub>256</Sub>
<Data>то он будет проигнорирован.  Если определенный ФОРМАТ - пусто, бу-          </Data>
</Node>
<Node><Sub>257</Sub>
<Data>дет выдано исходное значение ЧИСЛА.  Если задан  код  формата  &apos;Р&apos;          </Data>
</Node>
<Node><Sub>258</Sub>
<Data>вместе с кодами &apos;Т&apos;, &apos;+&apos; или &apos;-&apos;, то произойдет ошибка.                     </Data>
</Node>
<Node><Sub>259</Sub>
<Data>                                                                            </Data>
</Node>
<Node><Sub>260</Sub>
<Data>    ДРОБ.ЧАСТЬ отображает  число позиций справа от десятичной точ-          </Data>
</Node>
<Node><Sub>261</Sub>
<Data>ки.  Когда производится вычисление нового значения числа  согласно          </Data>
</Node>
<Node><Sub>262</Sub>
<Data>формату,  то это вычисление производится с округлением и, если это          </Data>
</Node>
<Node><Sub>263</Sub>
<Data>требуется, с добавлением незначащих нулей в дробной  части  числа.          </Data>
</Node>
<Node><Sub>264</Sub>
<Data>Если -1&lt;ЧИСЛО&lt;1, то ведущий ноль всегда будет присутствовать в ре-          </Data>
</Node>
<Node><Sub>265</Sub>
<Data>зультате.                                                                   </Data>
</Node>
<Node><Sub>266</Sub>
<Data>                                                                            </Data>
</Node>
<Node><Sub>267</Sub>
<Data>    ПРИМЕРЫ:                                                                </Data>
</Node>
<Node><Sub>268</Sub>
<Data>                                                                            </Data>
</Node>
<Node><Sub>269</Sub>
<Data>     Команда:            Значение функции:                                  </Data>
</Node>
<Node><Sub>270</Sub>
<Data>                                                                            </Data>
</Node>
<Node><Sub>271</Sub>
<Data>1.   SET X=3.14159       $FN(X,&quot;+&quot;)=&quot;+3.14159&quot;                              </Data>
</Node>
<Node><Sub>272</Sub>
<Data>                         $FN(X,&quot;+T&quot;,4)=&quot;3.1416+&quot;                            </Data>
</Node>
<Node><Sub>273</Sub>
<Data>                         $FN(X,&quot;P&quot;,3)=&quot; 3.142 &quot;                             </Data>
</Node>
<Node><Sub>274</Sub>
<Data>                         $FN(X,&quot;P&quot;,0)=&quot; 3 &quot;                                 </Data>
</Node>
<Node><Sub>275</Sub>
<Data>                         $FN(X,&quot;+T&quot;)=&quot;3.14159+&quot;                             </Data>
</Node>
<Node><Sub>276</Sub>
<Data>                         $FN(X,&quot;P&quot;,4)=&quot; 3.1416 &quot;                            </Data>
</Node>
<Node><Sub>277</Sub>
<Data>                         $FN(X,&quot;P&quot;,2)=&quot; 3.14 &quot;                              </Data>
</Node>
<Node><Sub>278</Sub>
<Data>2.   S X=-15.406         $FN(X,&quot;T&quot;)=&quot;15.406-&quot;                               </Data>
</Node>
<Node><Sub>279</Sub>
<Data>                         $FN(X,&quot;PT-&quot;)=ошибка                                </Data>
</Node>
<Node><Sub>280</Sub>
<Data>                         $FN(X,&quot;T&quot;,2)=&quot;15.41-&quot;                              </Data>
</Node>
<Node><Sub>281</Sub>
<Data>                         $FN(X,&quot;P&quot;)=&quot;(15.406)&quot;                              </Data>
</Node>
<Node><Sub>282</Sub>
<Data>3.    S X=1234567        $FN(X,&quot;,&quot;,2)=&quot;1,234,567.00&quot;                        </Data>
</Node>
<Node><Sub>283</Sub>
<Data>                                                                            </Data>
</Node>
</Node>
<Node><Sub>203</Sub>
<Data><![CDATA[ОПИСАНИЕ ФУНКЦИЙ ЛОГИЧЕСКОГО КОНТРОЛЯ@@@@@@@1@1@22@80@@@@1@@5@@@1@@@@@@@@58@@@2;6;30;42///2;6;34;42/2;6;30;42@@@1@@@@1]]></Data>
<Node><Sub>1</Sub>
<Data>1.            ________________________________________________</Data>
</Node>
<Node><Sub>2</Sub>
<Data>···­­­---===========           ОБЩЕГО НАЗНАЧЕНИЯ        =============---­­­···</Data>
</Node>
<Node><Sub>3</Sub>
<Data>              ------------------------------------------------</Data>
</Node>
<Node><Sub>4</Sub>
<Data></Data>
</Node>
<Node><Sub>5</Sub>
<Data>  Для проверки суммы по строке таблицы:</Data>
</Node>
<Node><Sub>6</Sub>
<Data>  +{ny,nx}=({ny,nx+2}+{ny,nx+4}+...) (текущая колонка равна сумме последующих)</Data>
</Node>
<Node><Sub>7</Sub>
<Data></Data>
</Node>
<Node><Sub>8</Sub>
<Data>  Для проверки суммы по колонке таблицы:</Data>
</Node>
<Node><Sub>9</Sub>
<Data>  +{ny,nx}=({ny+2,nx}+{ny+4,nx}+...) (текущая строка равна сумме последующих)</Data>
</Node>
<Node><Sub>10</Sub>
<Data>               </Data>
</Node>
<Node><Sub>11</Sub>
<Data>  {2,3}&gt;1&amp;({2,3}&lt;10) - (данные клетки 2,3 должны быть больше 1 и меньше 10)</Data>
</Node>
<Node><Sub>12</Sub>
<Data></Data>
</Node>
<Node><Sub>13</Sub>
<Data><![CDATA[ $$CHO(N,T,F,L,I,E,F1,HIS) - ОпРЕДЕЛЕНИЕ ПЕРЕМЕННОЙ  сHOSe(N) НА СЕАНС ПОЛЬЗОВАТЕЛЕМ     CHO^%ZAPM.ed.BSsFUNM]]></Data>
</Node>
<Node><Sub>14</Sub>
<Data>  T - ТЕКСТ ПРИГЛАШЕНИЯ ВВЕСТИ ПЕРЕМЕННУЮ</Data>
</Node>
<Node><Sub>15</Sub>
<Data>  F - ПЕРВОНАЧАЛЬНЫЕ ДАННЫЕ ПЕРЕМЕННОЙ</Data>
</Node>
<Node><Sub>16</Sub>
<Data>  L - ФОРМУЛА ТРАНСФОРМАЦИИ ВВЕДЕННОЙ ПЕРЕМЕННОЙ d</Data>
</Node>
<Node><Sub>17</Sub>
<Data>  I - ИМЯ ПЕРЕМЕННОЙ, С КОТОРОЙ ПРЕДСТОИТ СРАВНИВАТЬ</Data>
</Node>
<Node><Sub>18</Sub>
<Data>  E - ВЫЗОВ ТАБЛИЦЫ ПРИ ВВОДЕ &lt;ENTER&gt; ИЛИ &quot;?&quot; ССЫЛКА = &quot;BST,BSR,UIC,SYS&quot;</Data>
</Node>
<Node><Sub>19</Sub>
<Data>  F1 - ВЫЗОВ ТАБЛИЦЫ\ТЕКСТА ПО &lt;F1&gt;           ССЫЛКА = &quot;BST,BSR,UIC,SYS&quot;</Data>
</Node>
<Node><Sub>20</Sub>
<Data>  HIS - ССЫЛКА НА МАССИВ ПРЕДИСТОРИИ, НАПРИМЕР:&quot;^%ZAPM.ed.BSbufB(&quot;&quot;HISCHOISE1&quot;&quot;)&quot;</Data>
</Node>
<Node><Sub>21</Sub>
<Data></Data>
</Node>
<Node><Sub>22</Sub>
<Data>     Например: k1=$$CHO^%ZAPM.ed.BSsFUNM(1,&quot;Введите Дату:&quot;,121295,&quot;&quot;,&quot;k1&quot;)</Data>
</Node>
<Node><Sub>23</Sub>
<Data>     - ОпРЕДЕЛЕНИЕ ПЕРЕМЕННОЙ  сHOSe(1) НА СЕАНС ПОЛЬЗОВАТЕЛЕМ</Data>
</Node>
<Node><Sub>24</Sub>
<Data>  (ЕСЛИ ПОЛЬЗОВАТЕЛЕМ ВВЕДЕНО &quot;ALL&quot; , ТО УСЛОВИЕ ВСЕГДА ИСТИНО)</Data>
</Node>
<Node><Sub>25</Sub>
<Data></Data>
</Node>
<Node><Sub>26</Sub>
<Data><![CDATA[  $$LOGIC(%1,%2,%3,%4,%5) ;БАЗА ЛОГИЧЕСКИХ УСЛОВИЙ                               LOGIC^%ZAPM.ed.BSsFUNM]]></Data>
</Node>
<Node><Sub>27</Sub>
<Data>   %1-НОМЕР ПЕРЕМЕННОЙ</Data>
</Node>
<Node><Sub>28</Sub>
<Data>   %2-ИМЯ ТАБЛИЦЫ,РАЗДЕЛА ОПИСАНИЯ БАЗЫ ЛОГ. УСЛОВИЙ (DFLT=&quot;LOGIC,%BSZ&quot;)</Data>
</Node>
<Node><Sub>29</Sub>
<Data>   %3-ИМЯ УЗЛА В БАЗЕ ЛОГИЧЕСКИХ УСЛОВИЙ</Data>
</Node>
<Node><Sub>30</Sub>
<Data>   %4-ВЫЗОВ ТАБЛИЦЫ\ТЕКСТА ПО &lt;F1&gt;             ССЫЛКА = &quot;BST,BSR,UIC,SYS&quot;</Data>
</Node>
<Node><Sub>31</Sub>
<Data>   %5-КОМАНДА НА ТРАНСЛЯЦИЮ ФОРМУЛ</Data>
</Node>
<Node><Sub>32</Sub>
<Data>     Например: I $$LOGIC^%ZAPM.ed.BSsFUNM(1,&quot;&quot;,&quot;ЧАСТИ&quot;,&quot;&quot;,&quot;S t2=$TR(t2,&quot;&quot;k2&quot;&quot;,&quot;&quot;k3&quot;&quot;)&quot;)</Data>
</Node>
<Node><Sub>33</Sub>
<Data></Data>
</Node>
<Node><Sub>34</Sub>
<Data><![CDATA[  $$LOGTXT(%1) ;ВЫБРАННЫЙ ТЕКСТ ИЗ БАЗЫ ЛОГ. УСЛОВИЙ                          LOGTXT^%ZAPM.ed.BSsFUNM     ]]></Data>
</Node>
<Node><Sub>35</Sub>
<Data><![CDATA[  $$LOGSEL(%1) ;СЕЛЕКТОР ЛОГИЧЕСКИХ УСЛОВИЙ                                   LOGSEL^%ZAPM.ed.BSsFUNM     ]]></Data>
</Node>
<Node><Sub>36</Sub>
<Data></Data>
</Node>
<Node><Sub>37</Sub>
<Data><![CDATA[  $$SELECT(%1,%2,%3) ;ФУНКЦИЯ SELECT ИЗ БАЗЫ ДАННЫХ ЛОГИЧЕСКИХ УСЛОВИЙ        SELECT^%ZAPM.ed.BSsFUNM]]></Data>
</Node>
<Node><Sub>38</Sub>
<Data>   %1-НОМЕР ПЕРЕМЕННОЙ</Data>
</Node>
<Node><Sub>39</Sub>
<Data>   %2-ИМЯ ТАБЛИЦЫ,РАЗДЕЛА ОПИСАНИЯ БАЗЫ ЛОГ. УСЛОВИЙ (DFLT=&quot;LOGIC,%BSZ&quot;)</Data>
</Node>
<Node><Sub>40</Sub>
<Data>   %3-ИМЯ УЗЛА В БАЗЕ ЛОГИЧЕСКИХ УСЛОВИЙ</Data>
</Node>
<Node><Sub>41</Sub>
<Data></Data>
</Node>
<Node><Sub>42</Sub>
<Data>     </Data>
</Node>
<Node><Sub>43</Sub>
<Data> $$MTBD(MAS,LOG) - ЛОГИЧЕСКАЯ ФУНКЦИЯ-ДИСПЕТЧЕР МНОГО-ТАБЛИЧНОЙ БАЗЫ ДАННЫХ</Data>
</Node>
<Node><Sub>44</Sub>
<Data>  ,где MAS -полная ссылка на кодификатор селектора МультиТабличной Базы Данных</Data>
</Node>
<Node><Sub>45</Sub>
<Data>       LOG -Формула $SELECT оперирующая переменной d в которой лежит текущее</Data>
</Node>
<Node><Sub>46</Sub>
<Data>            значение ключа    </Data>
</Node>
<Node><Sub>47</Sub>
<Data>Например: $$MTBD(&quot;^[&quot;&quot;GLAVK&quot;&quot;]MOLsel&quot;) - используем селектор МультиБазы</Data>
</Node>
<Node><Sub>48</Sub>
<Data></Data>
</Node>
<Node><Sub>49</Sub>
<Data>      $$MTBD(&quot;&quot;,&quot;$S(d=&quot;&quot;00&quot;&quot;:&quot;&quot;^[&quot;&quot;&quot;&quot;GLAVK&quot;&quot;&quot;&quot;]MOL,F1&quot;&quot;,1:&quot;&quot;^[&quot;&quot;&quot;&quot;GLAVK&quot;&quot;&quot;&quot;]MOL,F1L&quot;&quot;)&quot;)</Data>
</Node>
<Node><Sub>50</Sub>
<Data>             используем Функцию Селектор</Data>
</Node>
<Node><Sub>51</Sub>
<Data></Data>
</Node>
<Node><Sub>52</Sub>
<Data><![CDATA[   $$MTBD("^[""GLAVK""]MOLsel","$S(d=""00"":""^[""""GLAVK""""]MOL,F1"",1:""^[""""GLAVK""""]MOL,F1L"")")]]></Data>
</Node>
<Node><Sub>53</Sub>
<Data>                используем  то, и то </Data>
</Node>
<Node><Sub>54</Sub>
<Data></Data>
</Node>
<Node><Sub>55</Sub>
<Data> $$MONTD(1,2) - Арифметические операции с месяцем даты</Data>
</Node>
<Node><Sub>56</Sub>
<Data>         1=ГГММДД   </Data>
</Node>
<Node><Sub>57</Sub>
<Data><![CDATA[         2=Количество месяцев прибавить или отнять                                                  $$MONTD("940311",2)="940511"                 $$MONTD("940311",-1)="940211"                $$MONTD("941011",3)="950111"]]></Data>
</Node>
<Node><Sub>58</Sub>
<Data></Data>
</Node>
</Node>
<Node><Sub>204</Sub>
<Data><![CDATA[ОПИСАНИЕ ФУНКЦИЙ СИНТАКСИЧЕСКОГО КОНТРОЛЯ@@@@@@@1@1@22@80@@@@1@@5@@@1@@@@@@@@80@@@2;6;30;42///2;6;34;42/2;6;30;42@@@1@@@@1]]></Data>
<Node><Sub>1</Sub>
<Data>1.            ________________________________________________</Data>
</Node>
<Node><Sub>2</Sub>
<Data>···­­­---===========           ОБЩЕГО НАЗНАЧЕНИЯ        =============---­­­···</Data>
</Node>
<Node><Sub>3</Sub>
<Data>              ------------------------------------------------</Data>
</Node>
<Node><Sub>4</Sub>
<Data></Data>
</Node>
<Node><Sub>5</Sub>
<Data><![CDATA[ $$INV("^INV","READ",M) - ввод и изменение данных происходит по правилу        $$INV^%ZAPM.ed.BSsFUNR]]></Data>
</Node>
<Node><Sub>6</Sub>
<Data>   КОДИФИКАТОРА ^INV,    где ^INV(1,код)=текст ^INV(2,текст)=код</Data>
</Node>
<Node><Sub>7</Sub>
<Data> т.о. если вы ввели d=код ,то $$INV(...)=код</Data>
</Node>
<Node><Sub>8</Sub>
<Data>      если вы ввели d=тек* ,то $$INV(...)=код</Data>
</Node>
<Node><Sub>9</Sub>
<Data>  M=1 - то появляется возможность в pежиме ввода добавить в КОДИФИКАТОР</Data>
</Node>
<Node><Sub>10</Sub>
<Data>        новый код с текстом</Data>
</Node>
<Node><Sub>11</Sub>
<Data> </Data>
</Node>
<Node><Sub>12</Sub>
<Data><![CDATA[ $$YEARM(1,"READ") - КОНТРОЛЬ ДАТЫ В ФОРМАТЕ ГГММ или ГГГГММ                   $$YEARM^%ZAPM.ed.BSsFUNR]]></Data>
</Node>
<Node><Sub>13</Sub>
<Data></Data>
</Node>
<Node><Sub>14</Sub>
<Data><![CDATA[ $$DAT(T,"READ") - контроль и трансформация даты                               $$DAT^%ZAPM.ed.BSsFUNR]]></Data>
</Node>
<Node><Sub>15</Sub>
<Data>      если T=6 и вы ввели ГГММДД ,то производится контроль даты</Data>
</Node>
<Node><Sub>16</Sub>
<Data>      если T=7 и вы ввели ГГММДДЧЧМИ ,то производится контроль даты и времени</Data>
</Node>
<Node><Sub>17</Sub>
<Data></Data>
</Node>
<Node><Sub>18</Sub>
<Data> *  если T=0 и вы ввели ДДММГГ ,то $$DAT(...)=ГГММДД        \ старая идеология</Data>
</Node>
<Node><Sub>19</Sub>
<Data> *  если T=1 и вы ввели ЧЧММДДММГГ ,то $$DAT(...)=ГГММДДЧЧМИ/     функции</Data>
</Node>
<Node><Sub>20</Sub>
<Data></Data>
</Node>
<Node><Sub>21</Sub>
<Data>     ГГ - год две или четыре цифры (например 94 или 1995 или 2001)</Data>
</Node>
<Node><Sub>22</Sub>
<Data>     ММ - месяц две цифры (например май=05 или ноябрь=11)</Data>
</Node>
<Node><Sub>23</Sub>
<Data>     ДД - день две цифры (например 06 или 23)</Data>
</Node>
<Node><Sub>24</Sub>
<Data>     ЧЧ - часы две цифры (например 07 или 11)</Data>
</Node>
<Node><Sub>25</Sub>
<Data>     МИ - минуты две цифры (например 08 или 54)</Data>
</Node>
<Node><Sub>26</Sub>
<Data></Data>
</Node>
<Node><Sub>27</Sub>
<Data> $$IF(L,&quot;READ&quot;,X,S) - синтаксический контроль на ввод</Data>
</Node>
<Node><Sub>28</Sub>
<Data>      если вы ввели 1,а L=&quot;d&gt;10&quot; ,то будет сообщение S</Data>
</Node>
<Node><Sub>29</Sub>
<Data>      если вы ввели &quot;СЛОВО&quot;,а L=&quot;$A(d)&gt;127&quot;,то будет сообщение S</Data>
</Node>
<Node><Sub>30</Sub>
<Data>     S -  сообщение всплывающее на экране в случае ошибки</Data>
</Node>
<Node><Sub>31</Sub>
<Data>     X - команда изменяющая переменную d (трансформация вводимых данных)</Data>
</Node>
<Node><Sub>32</Sub>
<Data>     Например X=&quot;S d=d*2&quot;</Data>
</Node>
<Node><Sub>33</Sub>
<Data></Data>
</Node>
<Node><Sub>34</Sub>
<Data>  (функции можно использовать и в ТРАНС,ЛОГ,ВЫЧ только вместо &quot;READ&quot; </Data>
</Node>
<Node><Sub>35</Sub>
<Data>   нужно поставить те данные котоpые будут контpолиpоваться и </Data>
</Node>
<Node><Sub>36</Sub>
<Data>   тpансфоpмиpоватся .Напpимеp: d или {12,37} )                      </Data>
</Node>
<Node><Sub>37</Sub>
<Data></Data>
</Node>
<Node><Sub>38</Sub>
<Data>2.            ________________________________________________</Data>
</Node>
<Node><Sub>39</Sub>
<Data>···­­­---===========    ПРИМЕРЫ УСЛОВИЙ СИНТ.КОНТРОЛЯ   =============---­­­···</Data>
</Node>
<Node><Sub>40</Sub>
<Data>              ------------------------------------------------</Data>
</Node>
<Node><Sub>41</Sub>
<Data></Data>
</Node>
<Node><Sub>42</Sub>
<Data>$$IF(&quot;d0?1N&amp;(d0&apos;&gt;5)&quot;,&quot;READ&quot;,&quot;&quot;,&quot;Только ЧИСЛО от 0 до 5!&quot;)- ДЛЯ ОЦЕНОК</Data>
</Node>
<Node><Sub>43</Sub>
<Data>$$IF(&quot;d0?.N0.1&quot;&quot;.&quot;&quot;.N&amp;(d0&lt;900)&quot;,&quot;READ&quot;,&quot;&quot;,&quot;Только ЧИСЛО !&quot;) - % БОЛЬШЕ 100</Data>
</Node>
<Node><Sub>44</Sub>
<Data>$$IF(&quot;d0?1N.N&quot;,&quot;READ&quot;,&quot;&quot;,&quot;Только ЦЕЛОЕ ЧИСЛО !&quot;) - ЦЕЛЫЕ</Data>
</Node>
<Node><Sub>45</Sub>
<Data>$$IF(&quot;d0?.N0.1&quot;&quot;.&quot;&quot;.N&amp;(d0&apos;&gt;100)&quot;,&quot;READ&quot;,&quot;&quot;,&quot;Только ЧИСЛО до 100!&quot;)-% НЕ БОЛЕЕ 100</Data>
</Node>
<Node><Sub>46</Sub>
<Data>$$IF(&quot;d0?.N0.1&quot;&quot;.&quot;&quot;.N&quot;,&quot;READ&quot;,&quot;&quot;,&quot;Только ЧИСЛО !&quot;) - Только ЧИСЛО</Data>
</Node>
<Node><Sub>47</Sub>
<Data></Data>
</Node>
<Node><Sub>48</Sub>
<Data>        ПРИМЕР, КАК ОБОЙТИСЬ КОМАНДАМИ MSM, ВМЕСТО $$IF(...</Data>
</Node>
<Node><Sub>49</Sub>
<Data>            d I d&apos;?.N S YES=0,ls=&quot;ДОЛЖНО БЫТЬ ЧИСЛОМ!&quot;</Data>
</Node>
<Node><Sub>50</Sub>
<Data>                                                           </Data>
</Node>
<Node><Sub>51</Sub>
<Data>3.            ________________________________________________</Data>
</Node>
<Node><Sub>52</Sub>
<Data>···­­­---===========      ПРОВЕРКА ПО ШАБЛОНУ (?)       =============---­­­···</Data>
</Node>
<Node><Sub>53</Sub>
<Data>              ------------------------------------------------</Data>
</Node>
<Node><Sub>54</Sub>
<Data>    Проверяет значение на соответствие опреленному шаблону.          </Data>
</Node>
<Node><Sub>55</Sub>
<Data></Data>
</Node>
<Node><Sub>56</Sub>
<Data>    СИНТАКСИС:                                                       </Data>
</Node>
<Node><Sub>57</Sub>
<Data>         операнд1?шаблон                                             </Data>
</Node>
<Node><Sub>58</Sub>
<Data></Data>
</Node>
<Node><Sub>59</Sub>
<Data>    ОПРЕДЕЛЕНИЕ:                                                     </Data>
</Node>
<Node><Sub>60</Sub>
<Data>    Этот оператор сравнивает строку,  определенную операндом1,   с   </Data>
</Node>
<Node><Sub>61</Sub>
<Data>шаблоном, расположенным за оператором. Если строка операнда1 соот-   </Data>
</Node>
<Node><Sub>62</Sub>
<Data>ветствует строке шаблона,  то  значение  операции  будет  &quot;ИСТИНА&quot;   </Data>
</Node>
<Node><Sub>63</Sub>
<Data>(т.е.  1),  иначе оно будет &quot;ЛОЖЬ&quot; (т.е.  0). Комбинации следующих   </Data>
</Node>
<Node><Sub>64</Sub>
<Data>символов могут быть использованы для создания шаблона. См.приложе-   </Data>
</Node>
<Node><Sub>65</Sub>
<Data>ние  А  для  получения  дополнительной  информации  о наборе кодов   </Data>
</Node>
<Node><Sub>66</Sub>
<Data>ASCII.                                                               </Data>
</Node>
<Node><Sub>67</Sub>
<Data>                                                                     </Data>
</Node>
<Node><Sub>68</Sub>
<Data>  ЗНАЧЕНИЕ                       ОПИСАНИЕ                            </Data>
</Node>
<Node><Sub>69</Sub>
<Data>  =================================================================  </Data>
</Node>
<Node><Sub>70</Sub>
<Data>   A      52 алфавитных символа ( т.е.  все  строчные и  прописные   </Data>
</Node>
<Node><Sub>71</Sub>
<Data>          буквы на верхнем и нижнем регистрах).                      </Data>
</Node>
<Node><Sub>72</Sub>
<Data>   C      Управляющие символы ASCII(т.е. десятичные значения кодов   </Data>
</Node>
<Node><Sub>73</Sub>
<Data>          от 0 до 31 и 127).                                         </Data>
</Node>
<Node><Sub>74</Sub>
<Data>   E      Все 128 символов ASCII плюс  128  символов  расширенного   </Data>
</Node>
<Node><Sub>75</Sub>
<Data>          набора ASCII.                                              </Data>
</Node>
<Node><Sub>76</Sub>
<Data>   L      26 строчных букв.                                          </Data>
</Node>
<Node><Sub>77</Sub>
<Data>   N      Цифры от 0 до 9.                                           </Data>
</Node>
<Node><Sub>78</Sub>
<Data>   P      33 символа пунктуации , включая пробел.                    </Data>
</Node>
<Node><Sub>79</Sub>
<Data>   U      26 прописных букв.                                         </Data>
</Node>
<Node><Sub>80</Sub>
<Data></Data>
</Node>
</Node>
<Node><Sub>205</Sub>
<Data><![CDATA[ПРЕД/ПОСЛЕ ДВИЖЕНИЕ УКАЗАТЕЛЯ@@@@@@@1@1@22@80@@@@1@@5@@@1@@@@@@@@@@@2;6;30;42///2;6;34;42/2;6;30;42@@@1@@@@1]]></Data>
<Node><Sub>1</Sub>
<Data>   K,Y,X - Общий вид </Data>
</Node>
<Node><Sub>2</Sub>
<Data>  -------------------------</Data>
</Node>
<Node><Sub>3</Sub>
<Data>   K=0 - ДВИЖЕНИЕ УКАЗАТЕЛЯ ПЕРЕД ПОЗИЦИОНИРОВАНИЕМ В КЛЕТКУ</Data>
</Node>
<Node><Sub>4</Sub>
<Data>     1 -   ----//-------    ПОСЛЕ КОРРЕКЦИИ ДАННЫХ В КЛЕТКЕ</Data>
</Node>
<Node><Sub>5</Sub>
<Data>   Y - КОЛИЧЕСТВО КЛЕТОК   Y&gt;0  ВНИЗ</Data>
</Node>
<Node><Sub>6</Sub>
<Data>           ----//------    Y&lt;0  ВВЕРХ</Data>
</Node>
<Node><Sub>7</Sub>
<Data>   X -     ----//-----     X&gt;0  ВПРАВО</Data>
</Node>
<Node><Sub>8</Sub>
<Data>           ----//----      X&lt;0  ВЛЕВО</Data>
</Node>
</Node>
<Node><Sub>%BS-CM7209</Sub>
<Data><![CDATA[КОМАНДЫ И РЕЖИМЫ ТАБЛИЦЫ@@@@@@@1@1@22@80@@@@1@@5@@@1@@@@@@@@1@@@2;6;30;42///2;6;34;42/2;6;30;42@@@1@@@@1]]></Data>
<Node><Sub>1</Sub>
<Data>НЕТ НИЧЕГО...</Data>
</Node>
</Node>
<Node><Sub>%BS-CM7238</Sub>
<Data><![CDATA[КОМАНДЫ И РЕЖИМЫ ТАБЛИЦЫ@@@@@@@1@1@22@80@@@@1@@5@@@1@@@@@@@@@@@2;6;30;42///2;6;34;42/2;6;30;42@@@1@@@@1]]></Data>
<Node><Sub>1</Sub>
<Data> &lt;УТ Ctr-N / ВСС Ctr-X&gt; - листание экрана таблицы вверх/вниз</Data>
</Node>
<Node><Sub>2</Sub>
<Data> &lt;РТ / ВПС&gt; - установка экрана в начало / конец таблицы</Data>
</Node>
<Node><Sub>3</Sub>
<Data> &lt;ПТ&gt; - пометка клетки, или снятие пометки с клетки</Data>
</Node>
<Node><Sub>4</Sub>
<Data> &lt;Ctr-O&gt; - СоРтиовать список / Поджатие таблицы</Data>
</Node>
<Node><Sub>5</Sub>
<Data> &lt;Ctr-P&gt; - поиск контекста начиная от текущей клетки</Data>
</Node>
<Node><Sub>6</Sub>
<Data> &lt;F1...F10&gt; - режимы функцианальных клавишь     </Data>
</Node>
<Node><Sub>7</Sub>
<Data> &lt;Ctr-Z&gt; - редактировать Описание Таблицы (в pежиме pедактиpования)</Data>
</Node>
<Node><Sub>8</Sub>
<Data> &lt;Ctr-V&gt; - редактировать синтаксический контроль на ввод данных</Data>
</Node>
<Node><Sub>9</Sub>
<Data> &lt;Ctr-T&gt; - редактировать функции трансформации</Data>
</Node>
<Node><Sub>10</Sub>
<Data> &lt;Ctr-L&gt; - редактировать логический контроль</Data>
</Node>
<Node><Sub>11</Sub>
<Data> &lt;Ctr-B&gt; - редактировать формулы вычисления</Data>
</Node>
<Node><Sub>12</Sub>
<Data> &lt;Ctr-E&gt; - редактировать данные текущей клетки</Data>
</Node>
<Node><Sub>13</Sub>
<Data> &lt;Ctr-I&gt; - создание инвертированных массивов для функции $$INV</Data>
</Node>
<Node><Sub>14</Sub>
<Data> &lt;Ctr- &gt; -                      </Data>
</Node>
<Node><Sub>15</Sub>
<Data> &lt;???&gt; - вызов пpикpепленного БЛОК-МЕНЮ                       </Data>
</Node>
<Node><Sub>16</Sub>
<Data> &lt;+&gt;(&lt;-&gt;) - пометка клеток (снятие пометки с клеток)</Data>
</Node>
<Node><Sub>17</Sub>
<Data> &lt;Ctr-D&gt; - листание экpана впpаво</Data>
</Node>
<Node><Sub>18</Sub>
<Data> &lt;Ctr-Y&gt; - листание экpана влево</Data>
</Node>
<Node><Sub>19</Sub>
<Data> &lt;???&gt; - глобальная пометка кипов,pазделов,таблиц,текстов,клеток</Data>
</Node>
</Node>
<Node><Sub>%BS-PC</Sub>
<Data><![CDATA[КОМАНДЫ И РЕЖИМЫ ТАБЛИЦЫ@@@@@@@1@1@21@76@@@@1@@5@@@1@@@@@@@@33@@@2;6;30;42///2;6;34;42/2;6;30;42@@@1@@@@1]]></Data>
<Node><Sub>1</Sub>
<Data>          PgUp или         &lt;Alt-I&gt; - листание экрана таблицы вверх</Data>
</Node>
<Node><Sub>2</Sub>
<Data>листание экpана влево - &lt;ALT-J&gt;  !  &lt;ALT-K&gt; - листание экpана впpаво</Data>
</Node>
<Node><Sub>3</Sub>
<Data>              PgDn или         &lt;Alt-M&gt; - листание экрана таблицы вниз</Data>
</Node>
<Node><Sub>4</Sub>
<Data> &lt;Ctrl-PageUp&gt; &lt;ALT-U&gt;- установка экрана верхнюю часть таблицы</Data>
</Node>
<Node><Sub>5</Sub>
<Data> &lt;Ctrl-PageDown&gt; &lt;ALT-N&gt;- установка экрана нижнюю часть таблицы</Data>
</Node>
<Node><Sub>6</Sub>
<Data> &lt;Ctrl-L&gt; - добавление буфер обмена полную ссылку на текущую клетку</Data>
</Node>
<Node><Sub>7</Sub>
<Data> &lt;Alt-СТРЕЛКИ&gt; - листание экрана таблицы по направлению стрелки</Data>
</Node>
<Node><Sub>8</Sub>
<Data> &lt;Tab&gt;/&lt;Shift-TAB&gt; - установка указателя на клетку разрешенную к коррекции</Data>
</Node>
<Node><Sub>9</Sub>
<Data> &lt;Insert&gt; - пометка клетки, или снятие пометки с клетки</Data>
</Node>
<Node><Sub>10</Sub>
<Data> &lt;Delete&gt; - Удаление данных текущей клетки</Data>
</Node>
<Node><Sub>11</Sub>
<Data> &lt;F1...F10&gt; - режимы функцианальных клавишь </Data>
</Node>
<Node><Sub>12</Sub>
<Data> &lt;ALT- =&gt; или Ctrl-\   - вызов калькулятора</Data>
</Node>
<Node><Sub>13</Sub>
<Data> &lt;Alt-P&gt; - поиск контекста начиная от текущей клетки</Data>
</Node>
<Node><Sub>14</Sub>
<Data> &lt;Alt-Y&gt; - поиск контекста в базе данных</Data>
</Node>
<Node><Sub>15</Sub>
<Data> &lt;Alt-O&gt; - СоРтиовать список / Поджатие таблицы</Data>
</Node>
<Node><Sub>16</Sub>
<Data> &lt;Alt-Z&gt; - редактировать Описание Таблицы (в pежиме pедактиpования)</Data>
</Node>
<Node><Sub>17</Sub>
<Data> &lt;Alt-V&gt; - редактировать синтаксический контроль на ввод данных</Data>
</Node>
<Node><Sub>18</Sub>
<Data> &lt;Alt-T&gt; - редактировать функции трансформации</Data>
</Node>
<Node><Sub>19</Sub>
<Data> &lt;Alt-L&gt; - редактировать логический контроль</Data>
</Node>
<Node><Sub>20</Sub>
<Data> &lt;Alt-B&gt; - редактировать формулы вычисления</Data>
</Node>
<Node><Sub>21</Sub>
<Data> &lt;Alt-E&gt; - редактировать данные текущей клетки</Data>
</Node>
<Node><Sub>22</Sub>
<Data> &lt;Alt-S&gt; - редактировать данные текущей клетки в строчном редакторе</Data>
</Node>
<Node><Sub>23</Sub>
<Data> &lt;Alt-F&gt; - включение СТАНДАРНОЙ ОБРАБОТКИ функцианальных клавиш</Data>
</Node>
<Node><Sub>24</Sub>
<Data> &lt;Alt-С&gt; - редактировать символьные имена клеток на вывод данных</Data>
</Node>
<Node><Sub>25</Sub>
<Data> &lt;ALT-F2&gt; - вызов пpикpепленного БЛОК-МЕНЮ</Data>
</Node>
<Node><Sub>26</Sub>
<Data> &lt;ALT-F7&gt; - поиск контекста функц.ТРАНСФ начиная от текущей клетки</Data>
</Node>
<Node><Sub>27</Sub>
<Data> &lt;+&gt;(&lt;-&gt;) - пометка клеток (снятие пометки с клеток)</Data>
</Node>
<Node><Sub>28</Sub>
<Data> &lt;Shift-F1&gt; - ВЫЗОВ ДОКУМЕНТАЦИИ ПО ИСПОЛЬЗОВАНИЮ %BS</Data>
</Node>
<Node><Sub>29</Sub>
<Data> &lt;Shift-F5&gt; - КОПИРОВАНИЕ ТЕКУЩЕЙ ТАБЛИЦЫ В ГЛОБАЛЬНЫЙ РАЗДЕЛ ОТЧЕТОВ</Data>
</Node>
<Node><Sub>30</Sub>
<Data> &lt;Shift-F7&gt; - ПОВТОРНЫЙ ПОИСК по строке определенной в &lt;ALT-F7&gt;</Data>
</Node>
<Node><Sub>31</Sub>
<Data> &lt;ALT-Insert&gt; - пометка и включение в список МИКРОЗАПРОСОВ,или включение</Data>
</Node>
<Node><Sub>32</Sub>
<Data>                ЗАПРОСОВ в ПАКЕТЫ для групповой работы с ними.</Data>
</Node>
<Node><Sub>33</Sub>
<Data>                пpогpамм,массивов для дальнейших гpупповых опеpаций</Data>
</Node>
</Node>
<Node><Sub>%BS-PCTERM</Sub>
<Data><![CDATA[КОМАНДЫ И РЕЖИМЫ ТАБЛИЦЫ@@@@@@@1@1@21@76@@@@1@@5@@@1@@@@@@@@22@@@2;6;30;42///2;6;34;42/2;6;30;42@@@1@@@@1]]></Data>
<Node><Sub>1</Sub>
<Data> &lt;PgUp Alt-N / PgDn Alt-X&gt; - листание экрана таблицы вверх/вниз</Data>
</Node>
<Node><Sub>2</Sub>
<Data> &lt;Alt-СТРЕЛКИ&gt; - листание экрана таблицы по направлению стрелки</Data>
</Node>
<Node><Sub>3</Sub>
<Data> &lt;Tab&gt;/&lt;Shift-TAB&gt; - установка указателя на клетку разрешенную к коррекции</Data>
</Node>
<Node><Sub>4</Sub>
<Data> &lt;Insert&gt; - пометка клетки, или снятие пометки с клетки</Data>
</Node>
<Node><Sub>5</Sub>
<Data> &lt;Alt-O&gt; - СоРтиовать список / Поджатие таблицы</Data>
</Node>
<Node><Sub>6</Sub>
<Data> &lt;Alt-P&gt;/&lt;ALT-F7&gt; - поиск контекста начиная от текущей клетки</Data>
</Node>
<Node><Sub>7</Sub>
<Data> &lt;F1...F10&gt; - режимы функцианальных клавишь</Data>
</Node>
<Node><Sub>8</Sub>
<Data> &lt;Alt-Z&gt; - редактировать Описание Таблицы (в pежиме pедактиpования)</Data>
</Node>
<Node><Sub>9</Sub>
<Data> &lt;Alt-V&gt; - редактировать синтаксический контроль на ввод данных</Data>
</Node>
<Node><Sub>10</Sub>
<Data> &lt;Alt-T&gt; - редактировать функции трансформации</Data>
</Node>
<Node><Sub>11</Sub>
<Data> &lt;Alt-L&gt; - редактировать логический контроль</Data>
</Node>
<Node><Sub>12</Sub>
<Data> &lt;Alt-B&gt; - редактировать формулы вычисления</Data>
</Node>
<Node><Sub>13</Sub>
<Data> &lt;Alt-E&gt; - редактировать данные текущей клетки</Data>
</Node>
<Node><Sub>14</Sub>
<Data> &lt;Alt-I&gt; - создание инвертированных массивов для функции $$INV</Data>
</Node>
<Node><Sub>15</Sub>
<Data> &lt;Alt-F&gt; - включение СТАНДАРНОЙ ОБРАБОТКИ функцианальных клавиш</Data>
</Node>
<Node><Sub>16</Sub>
<Data> &lt;ALT-F2&gt; - вызов пpикpепленного БЛОК-МЕНЮ</Data>
</Node>
<Node><Sub>17</Sub>
<Data> &lt;+&gt;(&lt;-&gt;) - пометка клеток (снятие пометки с клеток)</Data>
</Node>
<Node><Sub>18</Sub>
<Data> &lt;ALT-D&gt; - листание экpана впpаво</Data>
</Node>
<Node><Sub>19</Sub>
<Data> &lt;ALT-Y&gt; - листание экpана влево</Data>
</Node>
<Node><Sub>20</Sub>
<Data> &lt;Shift-F1&gt; - ВЫЗОВ ДОКУМЕНТАЦИИ ПО ИСПОЛЬЗОВАНИЮ %BS</Data>
</Node>
<Node><Sub>21</Sub>
<Data> &lt;ALT-Insert&gt; - глобальная пометка кипов,pазделов,таблиц,текстов,клеток</Data>
</Node>
<Node><Sub>22</Sub>
<Data>                пpогpамм,массивов для дальнейших гpупповых опеpаций</Data>
</Node>
</Node>
<Node><Sub>%BS-PD</Sub>
<Data><![CDATA[КОМАНДЫ И РЕЖИМЫ ТАБЛИЦЫ@@@@@@@1@1@22@80@@@@1@@5@@@1@@@@@@@@1@@@2;6;30;42///2;6;34;42/2;6;30;42@@@1@@@@1]]></Data>
<Node><Sub>1</Sub>
<Data>НЕТ НИЧЕГО...</Data>
</Node>
</Node>
<Node><Sub>ACCESHELP</Sub>
<Data><![CDATA[параметры для регулирования доступа к ресурсам системы@@@@@@@3@10@20@70@@@@1@@5@@@1@@@ 1@@@@@16@@@2;6;36;44///2;6;36;44/2;6;37;44@@@@@@@1]]></Data>
<Node><Sub>1</Sub>
<Data> Введите\редактируйте параметры доступа к MSM ресурсам</Data>
</Node>
<Node><Sub>2</Sub>
<Data>A/B/C/D</Data>
</Node>
<Node><Sub>3</Sub>
<Data>      - где A= Y - разрешен доступ для просмотра ПРОГ\МАСС</Data>
</Node>
<Node><Sub>4</Sub>
<Data>               N - запрещен</Data>
</Node>
<Node><Sub>5</Sub>
<Data>            B= Y - разрешен доступ для редактир. ПРОГ\МАСС</Data>
</Node>
<Node><Sub>6</Sub>
<Data>               N - запрещен</Data>
</Node>
<Node><Sub>7</Sub>
<Data>            С= Y - разрешен доступ для удаления ПРОГ\МАСС</Data>
</Node>
<Node><Sub>8</Sub>
<Data>               N - запрещен</Data>
</Node>
<Node><Sub>9</Sub>
<Data>          D= Y - разрешен доступ к управлению %BS-серверами</Data>
</Node>
<Node><Sub>10</Sub>
<Data> Введите\редактируйте параметры доступа к DOS ресурсам</Data>
</Node>
<Node><Sub>11</Sub>
<Data>V/E/D - где V - максимальный размер (Kb) файла разрешенный</Data>
</Node>
<Node><Sub>12</Sub>
<Data>                для просмотра</Data>
</Node>
<Node><Sub>13</Sub>
<Data>            E - максимальный размер (Kb) файла разрешенный</Data>
</Node>
<Node><Sub>14</Sub>
<Data>                для редактирования</Data>
</Node>
<Node><Sub>15</Sub>
<Data>            D - максимальный размер (Kb) файла разрешенный</Data>
</Node>
<Node><Sub>16</Sub>
<Data>                для удаления</Data>
</Node>
</Node>
<Node><Sub>ALT-F10</Sub>
<Data><![CDATA[помощь коммандера %BS@@@@@@@5@10@20@70@@@@1@@5@@@1@@@ 1@@@@@7@@@2;6;36;44///2;6;36;44/2;6;37;44@@@@@@@1]]></Data>
<Node><Sub>1</Sub>
<Data></Data>
</Node>
<Node><Sub>2</Sub>
<Data></Data>
</Node>
<Node><Sub>3</Sub>
<Data>    Введите команду MUMPS , которую хотите исполнить </Data>
</Node>
<Node><Sub>4</Sub>
<Data>                      сейчас же.</Data>
</Node>
<Node><Sub>5</Sub>
<Data></Data>
</Node>
<Node><Sub>6</Sub>
<Data>  ?   - посмотреть\редактировать список команд %BS</Data>
</Node>
<Node><Sub>7</Sub>
<Data></Data>
</Node>
<Node><Sub>8</Sub>
<Data>  ?$JO - посмотреть описание специальной переменной $JOB</Data>
</Node>
<Node><Sub>9</Sub>
<Data>  ?&lt;DKHER - посмотреть описание ошибки &lt;DKHER&gt;</Data>
</Node>
<Node><Sub>10</Sub>
<Data>  ?. - посмотреть возможные шаблоны</Data>
</Node>
<Node><Sub>11</Sub>
<Data>  ?:Terminal_Devices</Data>
</Node>
<Node><Sub>12</Sub>
<Data>  ?:Sequential_Block_Processor</Data>
</Node>
<Node><Sub>13</Sub>
<Data>  ?:VIEW_Device</Data>
</Node>
<Node><Sub>14</Sub>
<Data>  ?:Host_File_Server</Data>
</Node>
</Node>
<Node><Sub>ArmHelp</Sub>
<Data><![CDATA[Описание парамеров@@@@@@@6@10@18@70@@@@1@@5@@@1@@@ 1@@@@@12@@@2;6;36;44///2;6;36;44/2;6;37;44@@@@@@@1]]></Data>
<Node><Sub>1</Sub>
<Data> ВВЕДИТЕ ПАРАМЕТР ВЫЗОВА АВТОМАТИЗИРОВАННОГО РАБОЧЕГО</Data>
</Node>
<Node><Sub>2</Sub>
<Data> МЕСТА В ФОРМАТЕ:  T,P,U,S-Y-X</Data>
</Node>
<Node><Sub>3</Sub>
<Data> , где:</Data>
</Node>
<Node><Sub>4</Sub>
<Data>      Т - ИМЯ ТАБЛИЦЫ   \ таблица входа в АРМ</Data>
</Node>
<Node><Sub>5</Sub>
<Data>      P - ИМЯ РАЗДЕЛА   /</Data>
</Node>
<Node><Sub>6</Sub>
<Data>      U - ИМЯ КИПА</Data>
</Node>
<Node><Sub>7</Sub>
<Data>      S - ИМЯ ТОМА</Data>
</Node>
<Node><Sub>8</Sub>
<Data>      Y=1 - ОБЯЗАТЕЛЬНО ЗАПУСКАТЬ В ЯВНО СМОНТИРОВАННОМ</Data>
</Node>
<Node><Sub>9</Sub>
<Data>            ТОМЕ S КИПЕ U</Data>
</Node>
<Node><Sub>10</Sub>
<Data>      X- MUMPS КОД ЗАПУСКА ПРИЛОЖЕНИЯ &gt;</Data>
</Node>
<Node><Sub>11</Sub>
<Data>      X=D MMENU^%ZAPM.ed.BSTT(&quot;УЗЕЛ ГЛАВНОГО МЕНЮ&quot;) - ПОДКЛЮЧИТЬ</Data>
</Node>
<Node><Sub>12</Sub>
<Data>      ДЛЯ &quot;УЗЕЛ ГЛАВНОГО МЕНЮ&quot;</Data>
</Node>
</Node>
<Node><Sub>CAL</Sub>
<Data>Режимы работы@@@@@@@2@10@19@70@@@@1@@5@@@1@@@ 1@@@@@16@@@2;6;36;44///2;6;36;44/2;6;37;44@@@@@@@1</Data>
<Node><Sub>1</Sub>
<Data>  В строке записывается последовательность арифметических</Data>
</Node>
<Node><Sub>2</Sub>
<Data>операций (возможно выражение с использованием скобок).</Data>
</Node>
<Node><Sub>3</Sub>
<Data>По &lt;ENTER&gt; производится вычисление выражения, результат ко-</Data>
</Node>
<Node><Sub>4</Sub>
<Data>торого высвечивается в строке. Знак = в конце выражения не-</Data>
</Node>
<Node><Sub>5</Sub>
<Data>обязателен. Выполнение операций - последовательное (слева-</Data>
</Node>
<Node><Sub>6</Sub>
<Data>направо).</Data>
</Node>
<Node><Sub>7</Sub>
<Data> Основные арифметические действия:  +  сложение</Data>
</Node>
<Node><Sub>8</Sub>
<Data>                                    -  вычитание</Data>
</Node>
<Node><Sub>9</Sub>
<Data>                                    *  умножение</Data>
</Node>
<Node><Sub>10</Sub>
<Data>                                    /  деление</Data>
</Node>
<Node><Sub>11</Sub>
<Data>                                    \  деление по модулю</Data>
</Node>
<Node><Sub>12</Sub>
<Data>Выход из Калькулятора: без записи результатов &lt;Esc&gt; </Data>
</Node>
<Node><Sub>13</Sub>
<Data>                       с записью результатов  &lt;F10&gt;</Data>
</Node>
<Node><Sub>14</Sub>
<Data>                       в текущую клетку.</Data>
</Node>
<Node><Sub>15</Sub>
<Data>Если в таблице была пометка, то в калькулятор соберутся</Data>
</Node>
<Node><Sub>16</Sub>
<Data>данные всех помеченных клеток.</Data>
</Node>
</Node>
<Node><Sub>CMDSRV</Sub>
<Data>Команды М-Серверу@@@@@@@1@1@22@80@@@@1@@5@@@1@@@ 1@@@@@20@@@2;6;36;44///2;6;36;44/2;6;37;44@@@@@@@1</Data>
<Node><Sub>1</Sub>
<Data>              ________________________________________________</Data>
</Node>
<Node><Sub>2</Sub>
<Data>···­­­---===========   ВНУТРЕННИЕ КОМАНДЫ КОМАНДЕРУ    =============---­­­···</Data>
</Node>
<Node><Sub>3</Sub>
<Data>              ------------------------------------------------</Data>
</Node>
<Node><Sub>4</Sub>
<Data>LIST ;КОМАНДА КОМАНДЕРУ ПОКАЗАТЬ СПИСОК АКТИВНЫХ %BS-СЕРВЕРОВ</Data>
</Node>
<Node><Sub>5</Sub>
<Data>LAST ;Прочитать последнюю месагу посланную на твою станцию</Data>
</Node>
<Node><Sub>6</Sub>
<Data>GO ;ЗАПУСК %BS-СЕРВЕРА, ЕСЛИ ОН НЕ БЫЛ ЗАПУЩЕН </Data>
</Node>
<Node><Sub>7</Sub>
<Data>              ________________________________________________</Data>
</Node>
<Node><Sub>8</Sub>
<Data>···­­­---=========== КОМАНДЫ, ОТПРАВЛЯЕМЫЕ %BS-СЕРВЕРУ =============---­­­···</Data>
</Node>
<Node><Sub>9</Sub>
<Data>              ------------------------------------------------</Data>
</Node>
<Node><Sub>10</Sub>
<Data>SYS D STOP ;ОСТАНОВ %BS-СЕРВЕРА</Data>
</Node>
<Node><Sub>11</Sub>
<Data>SYS D MSG(&quot;Ну что дружок, Му-у-ч-аешься ? ... &quot;) ;послать месагу %BS-Серверу</Data>
</Node>
<Node><Sub>12</Sub>
<Data>SYS D EXIT^%ZAPM.ed.BSERVF(1,Sec) ;ОСТАНОВ MSM-СТАНЦИИ ЕСЛИ НЕТ АКТИВНЫХ СОЕДИНЕНИЙ DDP</Data>
</Node>
<Node><Sub>13</Sub>
<Data>SYS D EXIT^%ZAPM.ed.BSERVF(2,Sec) ;БЕЗУСЛОВНЫЙ ОСТАНОВ MSM-СТАНЦИИ,Sec=СЕКУНДЫ ЗАДЕРЖКИ</Data>
</Node>
<Node><Sub>14</Sub>
<Data>SYS D UPG^%ZAPM.ed.BSERVF(1) ;АВТОМАТИЧЕСКОЕ ПОВЫШЕНИЕ ВЕРСИИ %BS, ЕСЛИ ТЕКУЩАЯ НИЖЕ</Data>
</Node>
<Node><Sub>15</Sub>
<Data>SYS D UPG^%ZAPM.ed.BSERVF(2) ;БЕЗУСЛОВНОЕ АВТОМАТИЧЕСКОЕ ПОВЫШЕНИЕ ВЕРСИИ %BS</Data>
</Node>
<Node><Sub>16</Sub>
<Data>SYS D %BSKJ^%ZAPM.ed.BSERVF ;СНЯТЬ С ВЫПОЛНЕНИЯ ОСНОВНОЕ ЗАДАНИЕ %BS-ПРОЦЕССА</Data>
</Node>
<Node><Sub>17</Sub>
<Data>SYS D KJ^%ZAPM.ed.BSERVF(N) ;СНЯТЬ С ВЫПОЛНЕНИЯ ЗАДАНИЕ С НОМЕРОМ N</Data>
</Node>
<Node><Sub>18</Sub>
<Data>SYS D EXE^%ZAPM.ed.BSERVF(&quot;MEM.EXE&quot;,0) ;ВЫЗОВ ДОС-ПРОЦЕССА ,ЕСЛИ НЕ М-СЕРВЕР</Data>
</Node>
<Node><Sub>19</Sub>
<Data>D PEEK^%ZAPM.ed.BSERVF(&quot;SYS&quot;,8) ;СМОТРЕТЬ ЭКРАН В СИСТЕМЕ &quot;SYS&quot;,И ЖДАТЬ ОТКЛИКА 8 СЕК</Data>
</Node>
<Node><Sub>20</Sub>
<Data></Data>
</Node>
</Node>
<Node><Sub>CtructG</Sub>
<Data><![CDATA[описание стpуктуpы pазделов и таблиц !!! Gamma@@@@@@@1@1@22@80@@@@1@@5@@@1@@@@@@@@203@@@2;6;36;44///2;6;36;44/2;6;37;44@@@@@@@1]]></Data>
<Node><Sub>1</Sub>
<Data>                  1. ОПИСАНИЕ ЗАГОЛОВКА РАЗДЕЛА %BS</Data>
</Node>
<Node><Sub>2</Sub>
<Data>                  ---------------------------------</Data>
</Node>
<Node><Sub>3</Sub>
<Data> BSR - РАЗДЕЛ ТАБЛИЦ ^BSR=&quot;BaSe MsW @ КОМЕНТАРИЙ @S@ ПАРОЛЬ КОРРЕКЦИИ ХАР-К@X@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>                            1         2           3    4                    5</Data>
</Node>
<Node><Sub>5</Sub>
<Data>                      S=&quot;&amp;&quot; - РАЗДЕЛ СКРЫТЫЙ  (СМ ПРИЛОЖЕНИЕ 1 п 5.)</Data>
</Node>
<Node><Sub>6</Sub>
<Data>                      BST - ИМЯ ТАБЛИЦЫ В РАЗДЕЛЕ</Data>
</Node>
<Node><Sub>7</Sub>
<Data>                      X - РЕЗЕРВ</Data>
</Node>
<Node><Sub>8</Sub>
<Data></Data>
</Node>
<Node><Sub>9</Sub>
<Data>                  2. ОПИСАНИЕ СТРУКТУРЫ ТАБЛИЦЫ %BS</Data>
</Node>
<Node><Sub>10</Sub>
<Data>                  ---------------------------------</Data>
</Node>
<Node><Sub>11</Sub>
<Data></Data>
</Node>
<Node><Sub>12</Sub>
<Data> ^BSR(BST)=...   ЕСЛИ  $E(BST,1)=&quot;&amp;&quot; - ТАБЛИЦА СКРЫТАЯ (СМ ПРИЛОЖЕНИЕ 1 п 5.)</Data>
</Node>
<Node><Sub>13</Sub>
<Data> &quot;HI@P1@DT@P2@P3@  @  @BSY1@BSX1@BSY2@BSX2@ MR@   @   @FK@Z@ТИП@V@T@ C@VS @O.</Data>
</Node>
<Node><Sub>14</Sub>
<Data>   1  2 3   4  5  6  7  8    9    10   11   12  13  14 15 16 17 18 19 20 21 22</Data>
</Node>
<Node><Sub>15</Sub>
<Data> ...@ST@PZ@CU@RE@LO@se@ke@OPN@CLR@FS@LS ZA LL SO HF RA GM PF PK</Data>
</Node>
<Node><Sub>16</Sub>
<Data>     23 24 25 26 27 28 29 30  31  32 33 34 35 36 37 38 39 40 41</Data>
</Node>
<Node><Sub>17</Sub>
<Data>   1   HI =1 - ТАБЛИЦА СКРЫТА</Data>
</Node>
<Node><Sub>18</Sub>
<Data>   2   P1 - ПАРОЛЬ НА ВХОД В ТАБЛИЦУ</Data>
</Node>
<Node><Sub>19</Sub>
<Data>?  3   DT=&quot;i,j&quot; - КЛЕТКА УСТАНОВКИ НИЖНЕГО ТИТУЛА</Data>
</Node>
<Node><Sub>20</Sub>
<Data>   4   P2 - ПАРОЛЬ НА КОРРЕКЦИЮ ОПИСАНИЯ ТАБЛИЦЫ</Data>
</Node>
<Node><Sub>21</Sub>
<Data>   5   P3 - ПАРОЛЬ НА КОРРЕКЦИЮ ДАННЫХ ТАБЛИЦЫ</Data>
</Node>
<Node><Sub>22</Sub>
<Data>?  6</Data>
</Node>
<Node><Sub>23</Sub>
<Data>?  7</Data>
</Node>
<Node><Sub>24</Sub>
<Data>   8   BSY1    \</Data>
</Node>
<Node><Sub>25</Sub>
<Data>   9   BSX1     \  ГРАНИЧНЫЕ КООРДИНАТЫ</Data>
</Node>
<Node><Sub>26</Sub>
<Data>   10  BSY2     /        ТАБЛИЦЫ</Data>
</Node>
<Node><Sub>27</Sub>
<Data>   11  BSX2    /</Data>
</Node>
<Node><Sub>28</Sub>
<Data>   12  MR   =2  - ИНФОРМАЦИЯ ПО КЛЕТКЕ ПОЛНАЯ (ВСЕГДА В РЕЖИМЕ РЕДАКТИРОВАНИЯ)</Data>
</Node>
<Node><Sub>29</Sub>
<Data>             1  - ИНФОРМАЦИЯ ПО КЛЕТКЕ ЧАСТИЧНАЯ</Data>
</Node>
<Node><Sub>30</Sub>
<Data>             &quot;&quot; - ИНФОРМАЦИЯ ПО КЛЕТКЕ ОТСУТСТВУЕТ</Data>
</Node>
<Node><Sub>31</Sub>
<Data>?  13  MR24 =</Data>
</Node>
<Node><Sub>32</Sub>
<Data></Data>
</Node>
<Node><Sub>33</Sub>
<Data>?  14  MR25 =</Data>
</Node>
<Node><Sub>34</Sub>
<Data></Data>
</Node>
<Node><Sub>35</Sub>
<Data></Data>
</Node>
<Node><Sub>36</Sub>
<Data>?  15  FK   =1 - ФУНКЦИАНАЛЬНЫЕ КЛАВИШИ ВКЛЮЧЕНЫ И ОБРАБАТЫВАЮТСЯ СТАНДАРТНО.</Data>
</Node>
<Node><Sub>37</Sub>
<Data>            =LAB^ROU -ССЫЛКА НА ПРОГРАММУ НЕСТАНДАРТНОЙ ОБРАБОТКИ F-КЛАВИШ</Data>
</Node>
<Node><Sub>38</Sub>
<Data>              ,ГДЕ    LAB ;...R1=27,R2=79,R3=КОД ФУНКЦИАНАЛЬНОЙ КЛАВИШИ</Data>
</Node>
<Node><Sub>39</Sub>
<Data>                          ;...ny-НОМЕР СТРОКИ КЛЕТКИ,nx-НОМЕР КОЛОНКИ,d-ДАННЫЕ</Data>
</Node>
<Node><Sub>40</Sub>
<Data>                          G 0^%ZAPM.ed.BSTM ;КОРРЕКТНЫЙ ВОЗВРАТ</Data>
</Node>
<Node><Sub>41</Sub>
<Data>               (СМОТРИ ПРИМЕР :TAB+5^%ZAPM.ed.BS)</Data>
</Node>
<Node><Sub>42</Sub>
<Data>   16  Z=1  - ЗАЩИТА ВСЕЙ ТАБЛИЦЫ ОТ КОРРЕКЦИИ ВКЛЮЧЕНА $D(%ZAP)</Data>
</Node>
<Node><Sub>43</Sub>
<Data>   17  ТИП       =1 - ТАБЛИЦА БЕЗ БАЗЫ ДАННЫХ (САМА ПО СЕБЕ) (ПО УМОЛЧАНИЮ)</Data>
</Node>
<Node><Sub>44</Sub>
<Data>                  2 - --//-- С БАЗОЙ ДАННЫХ (ОПИСАНИЕ БАЗ В ^BSR(BST,&quot;KEY&quot;)</Data>
</Node>
<Node><Sub>45</Sub>
<Data>                  3 - ТАБЛИЦА-СПИСОК</Data>
</Node>
<Node><Sub>46</Sub>
<Data>                  4 - ТАБЛИЦА-СВОДКА</Data>
</Node>
<Node><Sub>47</Sub>
<Data>                  5 - ТЕКСТ</Data>
</Node>
<Node><Sub>48</Sub>
<Data>                  6 - БЛАНК</Data>
</Node>
<Node><Sub>49</Sub>
<Data>                  7 - МЕНЮ ПОЛЬЗОВАТЕЛЯ</Data>
</Node>
<Node><Sub>50</Sub>
<Data>   18  V = 1 -ПОРЯДОК ВЫЧИСЛЕНИЙ (ПО УМОЛЧАНИЮ СЛЕВО-НАПРАВО,СВЕРХУ-ВНИЗ)</Data>
</Node>
<Node><Sub>51</Sub>
<Data>           2 - СЛЕВО-НАПРАВО СНИЗУ-ВВЕРХ</Data>
</Node>
<Node><Sub>52</Sub>
<Data>           3 - СПРАВО-НАЛЕВО СВЕРХУ-ВНИЗ</Data>
</Node>
<Node><Sub>53</Sub>
<Data>           4 - СПРАВО-НАЛЕВО СНИЗУ-ВВЕРХ</Data>
</Node>
<Node><Sub>54</Sub>
<Data></Data>
</Node>
<Node><Sub>55</Sub>
<Data>   19  T=&quot;i,j&quot; - КЛЕТКА УСТАНОВКИ ВЕРХНЕГО ТИТУЛА</Data>
</Node>
<Node><Sub>56</Sub>
<Data>   20  C=&quot;&quot; - ВЫЧИСЛЕНИЯ ПРОИЗВОДЯТСЯ ПОСТОЯННО, C=1 - ПО КОМАНДЕ F6</Data>
</Node>
<Node><Sub>57</Sub>
<Data>*  21  VS=1 -ВКЛЮЧЕН ВИДЕО-СТАТУС</Data>
</Node>
<Node><Sub>58</Sub>
<Data>   22  O=1 - ТАБЛИЦА БЫЛА ОПТИМИЗИРОВАНА</Data>
</Node>
<Node><Sub>59</Sub>
<Data>   23  ST=&quot;&quot; ВЫКЛЮЧЕН СТАТУС</Data>
</Node>
<Node><Sub>60</Sub>
<Data>*  24  PZ=&quot;S&quot;-ЭТО СПИСОК ,PZ=1 -ПОДЖАТА</Data>
</Node>
<Node><Sub>61</Sub>
<Data>*  25  CU=1 КУРСОР В ТЕКУЩЕЙ КЛЕТКЕ</Data>
</Node>
<Node><Sub>62</Sub>
<Data>*  26  RE=&quot;&quot; РЕДАКТИРОВАНИЕ ПРОИСХОДИТ В ТЕКУЩЕЙ КЛЕТКЕ</Data>
</Node>
<Node><Sub>63</Sub>
<Data>       RE=1  РЕДАКТИРОВАНИЕ ПРОИСХОДИТ В СТРОЧНОМ РЕДАКТОРЕ</Data>
</Node>
<Node><Sub>64</Sub>
<Data>   27  LO=1 ЛОГИЧЕСКИЙ КОНТРОЛЬ ВЫКЛЮЧЕН</Data>
</Node>
<Node><Sub>65</Sub>
<Data>   28  se - КОЛ-ВО СТРОК В ТАБЛИЦЕ</Data>
</Node>
<Node><Sub>66</Sub>
<Data>   29  ke - КОЛ-ВО СТОЛБЦОВ В ТАБЛИЦЕ</Data>
</Node>
<Node><Sub>67</Sub>
<Data>   30  OPN=&quot;&quot; - ТАБЛИЦА ОТКРЫТА</Data>
</Node>
<Node><Sub>68</Sub>
<Data>          =&quot;SYS&quot;_$I_&quot;i&quot;_ИМЯ - ИНФОРМАЦИЯ О ТОМ,КТО ЗАКРЫЛ ТАБЛИЦУ</Data>
</Node>
<Node><Sub>69</Sub>
<Data>   31  CLR - ЦВЕТ ВСЕЙ ТАБЛИЦЫ</Data>
</Node>
<Node><Sub>70</Sub>
<Data>   32  FS - В ФОРМ.ВЫЧ. ЕСТЬ ССЫЛКИ НА ДРУГИЕ ФОРМУЛЫ ВЫЧИСЛЕНИЯ</Data>
</Node>
<Node><Sub>71</Sub>
<Data>   33  LS - В ФОРМ.ЛОГ. ЕСТЬ ССЫЛКИ НА ДРУГИЕ ФОРМУЛЫ ЛОГИЧЕСКОГО КОНТРОЛЯ</Data>
</Node>
<Node><Sub>72</Sub>
<Data>*  34  ZA = 1 -ТАБЛИЦУ НЕ ЗАКРЫВАТЬ</Data>
</Node>
<Node><Sub>73</Sub>
<Data>   35  LL - ФОРМИРОВАТЬ СПИСОК ЛОГИЧЕСКИХ ОШИБОК С СИМВ.ИМЕНАМИ НА ВЫВОД</Data>
</Node>
<Node><Sub>74</Sub>
<Data>*  36  SO =A,B  A - C КАКОЙ СТРОКИ СОРТИРОВАТЬ   B - ШАГ СОРТИРОВКИ</Data>
</Node>
<Node><Sub>75</Sub>
<Data>   37  HF =1 ЕСТЬ ССЫЛКИ НА HFS НА ЛОКАЛЬНЫХ ПРИВОДАХ ^BSR(BST,&quot;HVL&quot;,&quot;VOL&quot;)=HF</Data>
</Node>
<Node><Sub>76</Sub>
<Data>   38  RA =1 ОДИНАРНАЯ РАМКА  2 ДВОЙНАЯ РАМКА  $C(...) РАМКА КОДОМ</Data>
</Node>
<Node><Sub>77</Sub>
<Data>   39  GM =1 Таблица %BS-Gamma Version</Data>
</Node>
<Node><Sub>78</Sub>
<Data>   40  PF =1 ВКЛЮЧЕН РЕЖИМ ПРОСМОТРА</Data>
</Node>
<Node><Sub>79</Sub>
<Data>   41  PK =ПРЕДОБРАБОТКА КЛАВИШ  D @PK (СМ.ВЫЗОВЫ ТЕКСТОВОГО ПРОЦЕССОРА)</Data>
</Node>
<Node><Sub>80</Sub>
<Data></Data>
</Node>
<Node><Sub>81</Sub>
<Data>* - Помеченны пункты,которые в ТЕКСТАХ используются по другому</Data>
</Node>
<Node><Sub>82</Sub>
<Data>    СМ док по ТЕКСТОВОМУ ПРОЦЕССОРУ</Data>
</Node>
<Node><Sub>83</Sub>
<Data></Data>
</Node>
<Node><Sub>84</Sub>
<Data>    ^BSR(BST,0)=КОМЕНТАРИЙ К ТАБЛИЦЕ</Data>
</Node>
<Node><Sub>85</Sub>
<Data>    ^BSR(BST,0,0,4)= НЕСТАНДАРТНЫЙ HELP ДЛЯ ВСЕЙ ТАБЛИЦЫ</Data>
</Node>
<Node><Sub>86</Sub>
<Data></Data>
</Node>
<Node><Sub>87</Sub>
<Data>    ^BSR(BST,0,k,1)=Long@ ...</Data>
</Node>
<Node><Sub>88</Sub>
<Data>       Long - Длина колонки k</Data>
</Node>
<Node><Sub>89</Sub>
<Data>    ^BSR(BST,0,k,4)= НЕСТАНДАРТНЫЙ HELP ДЛЯ ВСЕЙ КОЛОНКИ k</Data>
</Node>
<Node><Sub>90</Sub>
<Data></Data>
</Node>
<Node><Sub>91</Sub>
<Data>    ^BSR(BST,s,0,1)=High@ ...</Data>
</Node>
<Node><Sub>92</Sub>
<Data>       High - Высота строки s</Data>
</Node>
<Node><Sub>93</Sub>
<Data>    ^BSR(BST,s,0,4)= НЕСТАНДАРТНЫЙ HELP ДЛЯ ВСЕЙ СТРОКИ s</Data>
</Node>
<Node><Sub>94</Sub>
<Data></Data>
</Node>
<Node><Sub>95</Sub>
<Data>          ...      1   2   3    4    5   6   7    8    9   10  11 12  13   14</Data>
</Node>
<Node><Sub>96</Sub>
<Data>    ^BSR(BST,i,j)=&quot;AT@ XB@ WIN@ F1 @ K @ W @ FC @ FT @ B @ S @   @   @ LC @ G</Data>
</Node>
<Node><Sub>97</Sub>
<Data></Data>
</Node>
<Node><Sub>98</Sub>
<Data>              15  16  17   18</Data>
</Node>
<Node><Sub>99</Sub>
<Data>            @   @ R @ MOV @ IO @</Data>
</Node>
<Node><Sub>100</Sub>
<Data></Data>
</Node>
<Node><Sub>101</Sub>
<Data>  1 AT=ny,nx - АТРИБУТЫ КЛЕТКИ ХРАНЯТСЯ В ny,nx</Data>
</Node>
<Node><Sub>102</Sub>
<Data>  2 XB  = СИМВОЛЬНОЕ ИМЯ АДРЕСАЦИИ КЛЕТКИ</Data>
</Node>
<Node><Sub>103</Sub>
<Data>  3 WIN - РАЗМЕРЫ Y,X ОКНА ЭКРАННОГО РЕДАКТИРОВАНИЯ КЛЕТКИ</Data>
</Node>
<Node><Sub>104</Sub>
<Data>  4 F1 = 0 - СУЩЕСТВУЕТ НЕСТАНДАРТНЫЙ HELP ДЛЯ КЛЕТКИ</Data>
</Node>
<Node><Sub>105</Sub>
<Data>          &quot;i,j&quot; - ССЫЛКА НА НЕСТАНДАРТНЫЙ HELP ДЛЯ КЛЕТКИ В ДРУГОЙ КЛЕТКЕ</Data>
</Node>
<Node><Sub>106</Sub>
<Data></Data>
</Node>
<Node><Sub>107</Sub>
<Data>  5  K  = 1 - ЗАПРЕЩЕНА КОРРЕКЦИЯ КЛЕТКИ</Data>
</Node>
<Node><Sub>108</Sub>
<Data>  6  W  -  НОМЕР ИЛИ ИМЯ ПОЛЯ В СТРУКТУРЕ DBF</Data>
</Node>
<Node><Sub>109</Sub>
<Data>  7  FC = 0 - ЕСТЬ ФУНКЦИЯ ВЫЧИСЛЕНИЯ</Data>
</Node>
<Node><Sub>110</Sub>
<Data>          2 или 3 - функции генерирующие список / сводку</Data>
</Node>
<Node><Sub>111</Sub>
<Data>          &quot;i,j&quot; - ССЫЛКА НА ФВ ДРУГОЙ КЛЕТКИ</Data>
</Node>
<Node><Sub>112</Sub>
<Data>  8  FT = &quot;0&quot; - ЕСТЬ ФУНКЦИЯ ТРАНСФОРМАЦИИ</Data>
</Node>
<Node><Sub>113</Sub>
<Data>          &quot;i,j&quot; - ССЫЛКА НА ФТ ДРУГОЙ КЛЕТКИ</Data>
</Node>
<Node><Sub>114</Sub>
<Data>  9  B  = &quot;&quot;- СОДЕРЖАНИЕ КЛЕТКИ ХРАНИТСЯ В ОПИСАНИИ ТАБЛИЦЫ,B=1 - В Б.ДАННЫХ</Data>
</Node>
<Node><Sub>115</Sub>
<Data>  10 S  - МИГАНИЕ;КОД ЦВЕТА СИМВОЛА КЛЕТКИ;КОД ЦВЕТА ФОНА</Data>
</Node>
<Node><Sub>116</Sub>
<Data>? 11</Data>
</Node>
<Node><Sub>117</Sub>
<Data>? 12</Data>
</Node>
<Node><Sub>118</Sub>
<Data>  13 LC = &quot;0&quot; - ЕСТЬ ЛОГИЧЕСКИЙ КОНТРОЛЬ</Data>
</Node>
<Node><Sub>119</Sub>
<Data>          &quot;i,j&quot; - ССЫЛКА НА ЛОГИЧЕСКИЙ КОНТРОЛЬ ДРУГОЙ КЛЕТКИ</Data>
</Node>
<Node><Sub>120</Sub>
<Data>  14 G  - =0 СУЩЕСТВУЕТ ПОЛНАЯ ССЫЛКА НА ТАБЛИЦУ ПО &lt;Enter&gt;</Data>
</Node>
<Node><Sub>121</Sub>
<Data>          =1 СУЩЕСТВУЕТ КОМАНДА MUMPS ПО &lt;Enter&gt;</Data>
</Node>
<Node><Sub>122</Sub>
<Data>          =i,j - ПОЛНАЯ ССЫЛКА НА ТАБЛИЦУ ИЛИ КОМАНДУ В ДРУГОЙ КЛЕТКЕ</Data>
</Node>
<Node><Sub>123</Sub>
<Data>  15</Data>
</Node>
<Node><Sub>124</Sub>
<Data></Data>
</Node>
<Node><Sub>125</Sub>
<Data>  16 R  = 0 - ЕСТЬ СИНТАКСИЧЕСКИЙ КОНТРОЛЬ НА ВВОД</Data>
</Node>
<Node><Sub>126</Sub>
<Data>          &quot;i,j&quot; - ССЫЛКА НА СИНТ.В ДРУГОЙ КЛЕТКЕ</Data>
</Node>
<Node><Sub>127</Sub>
<Data>  17 MOV - P,Y,X - ПРЕД/ПОСТ ДВИЖЕНИЕ УКАЗАТЕЛЯ</Data>
</Node>
<Node><Sub>128</Sub>
<Data>  18 IO = СИМВОЛЬНОЕ_ИМЯ_ВЫВОДА_ДАННЫХ</Data>
</Node>
<Node><Sub>129</Sub>
<Data></Data>
</Node>
<Node><Sub>130</Sub>
<Data>    ^BSR(BST,i,j,4)=ПОЛНАЯ ЗАКРЫТАЯ ССЫЛКА НА ТЕКСТ HELPa ДЛЯ ВХОДА ПО &lt;F1&gt;</Data>
</Node>
<Node><Sub>131</Sub>
<Data>    ^BSR(BST,i,j,8)=ФУНКЦИЯ ТРАНСФОРМАЦИИ...ВЫПОЛН.ТЕКСТ</Data>
</Node>
<Node><Sub>132</Sub>
<Data>                 8,1)=ИСХОДНЫЙ ТЕКСТ</Data>
</Node>
<Node><Sub>133</Sub>
<Data>    ^BSR(BST,i,j,7)=ФОРМУЛА ВЫЧИСЛЕНИЯ ДЛЯ {i,j}...ВЫПОЛН.ТЕКСТ</Data>
</Node>
<Node><Sub>134</Sub>
<Data>                 7,1)=ИСХОДНЫЙ ТЕКСТ</Data>
</Node>
<Node><Sub>135</Sub>
<Data>    ^BSR(BST,i,j,13)=ФОРМУЛА ЛОГИЧЕСКОГО КОНТРОЛЯ...ВЫПОЛН.ТЕКСТ</Data>
</Node>
<Node><Sub>136</Sub>
<Data>                 13,1)=ИСХ.ТЕКСТ</Data>
</Node>
<Node><Sub>137</Sub>
<Data>    ^BSR(BST,i,j,14)=ПОЛНАЯ ЗАКРЫТАЯ ССЫЛКА НА ТАБЛИЦУ ДЛЯ ВХОДА ПО &lt;Enter&gt;</Data>
</Node>
<Node><Sub>138</Sub>
<Data>                     ИЛИ КОМАНДА MUMPS ДЛЯ ВЫПОЛНЕНИЯ ПО &lt;Enter&gt;</Data>
</Node>
<Node><Sub>139</Sub>
<Data>    ^BSR(BST,i,j,16)=СИНТАКСИЧЕСКИЙ КОНТРОЛЬ НА ВВОД</Data>
</Node>
<Node><Sub>140</Sub>
<Data>                 16,1)=ИСХ.ТЕКСТ</Data>
</Node>
<Node><Sub>141</Sub>
<Data></Data>
</Node>
<Node><Sub>142</Sub>
<Data>??? ^BSR(BST,&quot;KEY&quot;)=^BASEDATE [@^PAR,TAB]  - БАЗА ДАННЫХ ДЛЯ ТАБЛИЦЫ</Data>
</Node>
<Node><Sub>143</Sub>
<Data>                      1   2   4  5   6     10  12 13 14  15 16</Data>
</Node>
<Node><Sub>144</Sub>
<Data>    ^BSR(BST,&quot;KEY&quot;,0)=NZ@TN@@KZ@NEW@%YY@@@@KC@@TK@LC@TAB@KT@RTR... - ИМЕННОЙ КЛ</Data>
</Node>
<Node><Sub>145</Sub>
<Data>    ^BSR(BST,&quot;KEY&quot;,1)=NZ@TN@@KZ@@%KSP@... - 1-Й ИНДЕКСНЫЙ КЛЮЧ</Data>
</Node>
<Node><Sub>146</Sub>
<Data>    ^BSR(BST,&quot;KEY&quot;,2)=NZ@TN@@KZ@@%DAT@... - 2-Й ИНДЕКСНЫЙ КЛЮЧ</Data>
</Node>
<Node><Sub>147</Sub>
<Data>       .......    ,k)=...     TN - ТЕКСТ НАЧАЛА</Data>
</Node>
<Node><Sub>148</Sub>
<Data>                              TK - ТЕКСТ КОНЦА</Data>
</Node>
<Node><Sub>149</Sub>
<Data>                  ,5)=...     %YY - Y,X РАЗМЕРЫ ТАБЛИЦЫ СПИСКА ДАННЫХ КЛЮЧА</Data>
</Node>
<Node><Sub>150</Sub>
<Data>                              KC - ЦВЕТ (СМ.S)</Data>
</Node>
<Node><Sub>151</Sub>
<Data>                              KT - ТЕКСТ ПРИГЛАШЕНИЯ ВВЕСТИ ДАННЫЕ КЛЮЧА</Data>
</Node>
<Node><Sub>152</Sub>
<Data>                              NZ,KZ - НАЧАЛЬНОЕ И КОНЕЧНОЕ ЗНАЧЕНИЕ КЛЮЧА</Data>
</Node>
<Node><Sub>153</Sub>
<Data>                              LC=0 -ЕСЛИ ЕСТЬ ЛОГИКА НА КЛЮЧ</Data>
</Node>
<Node><Sub>154</Sub>
<Data>                              NEW - ТЕКСТ ПРИГЛАШЕНИЯ ВВОДА НОВЫЕ ДАННЫЕ КЛЮЧА</Data>
</Node>
<Node><Sub>155</Sub>
<Data>                              TAB - ССЫЛКА НА РАЗДЕЛ,ТАБЛИЦУ,прикрепленную к</Data>
</Node>
<Node><Sub>156</Sub>
<Data>                                    ключу</Data>
</Node>
<Node><Sub>157</Sub>
<Data>    ^BSR(BST,&quot;KEY&quot;,k,1)=ИСПОЛНЯЕМЫЙ ТЕКСТ ФОРМУЛЫ СИНТ. КОНТРОЛЯ</Data>
</Node>
<Node><Sub>158</Sub>
<Data>                   k,2)=ИСХОДНЫЙ ТЕКСТ ФОРМУЛЫ СИН.КОНТР.</Data>
</Node>
<Node><Sub>159</Sub>
<Data>                   k,3)=ИСП.ТЕКСТ ФУНКЦИИ ТРАНСФОРМАЦИИ</Data>
</Node>
<Node><Sub>160</Sub>
<Data>                   k,4)=ИСХОДНЫЙ ТЕКСТ Ф.ТРАНСФОРМАЦИИ</Data>
</Node>
<Node><Sub>161</Sub>
<Data>                   k,5)=&quot;I $$MTBD(&quot;^MAS&quot;) -МУЛЬТИ-ТАБЛИЧНАЯ БАЗА ДАННЫХ</Data>
</Node>
<Node><Sub>162</Sub>
<Data>                   k,6)=ИСХОДНЫЙ ТЕКСТ $$MTBD</Data>
</Node>
<Node><Sub>163</Sub>
<Data>                   k,10)=ТЕКСТ ВЫБОРКИ ПО КЛЮЧУ k ДЛЯ СПИСКОВ И СВОДОК</Data>
</Node>
<Node><Sub>164</Sub>
<Data>                   k,10,1)=ИСПОЛНЯЕМЫЙ ТЕСТ ФОРМУЛЫ НА ВЫБОРКУ</Data>
</Node>
<Node><Sub>165</Sub>
<Data>                     10,2)=ИСХОДНЫЙ ТЕКСТ</Data>
</Node>
<Node><Sub>166</Sub>
<Data>                    ...</Data>
</Node>
<Node><Sub>167</Sub>
<Data>                   k,11)=...</Data>
</Node>
<Node><Sub>168</Sub>
<Data>    ^BSR(BST,&quot;STA&quot;)=&quot;i,j@BSY@BSX</Data>
</Node>
<Node><Sub>169</Sub>
<Data>             &quot;VID&quot;,0)=...</Data>
</Node>
<Node><Sub>170</Sub>
<Data>             &quot;VID&quot;,1)=...  СОДЕРЖАНИЕ ВИДЕОБУФЕРА</Data>
</Node>
<Node><Sub>171</Sub>
<Data></Data>
</Node>
<Node><Sub>172</Sub>
<Data>    ^BSR(BST,&quot;ZPR&quot;,ИМЯ)=&quot;КОМЕН@Явн1сравн@0&quot; - ЗАПРОС СПИСКА/СВОДКИ</Data>
</Node>
<Node><Sub>173</Sub>
<Data>                   ИМЯ-ИМЯ ЗАПРОСА</Data>
</Node>
<Node><Sub>174</Sub>
<Data>                   ...</Data>
</Node>
<Node><Sub>175</Sub>
<Data>    ^BSR(BST,&quot;INV&quot;)=&quot;^MAS&quot; - ИМЯ ПОСЛЕДНЕГО КОДИФИКАТОРА</Data>
</Node>
<Node><Sub>176</Sub>
<Data></Data>
</Node>
<Node><Sub>177</Sub>
<Data>    ^BSR(BST,&quot;PRN&quot;)=&quot;LP@ST@LG@TI@LT@UK@PT@</Data>
</Node>
<Node><Sub>178</Sub>
<Data>                     LP - НОМЕР ПЕЧАТИ</Data>
</Node>
<Node><Sub>179</Sub>
<Data>                     ST - КОЛ-ВО СТРОК В СТРАНИЦЕ</Data>
</Node>
<Node><Sub>180</Sub>
<Data>                     LG - КОЛ-ВО ПОЗИЦИИ ...</Data>
</Node>
<Node><Sub>181</Sub>
<Data>                     TI - ДУБЛИРОВАТЬ ТИТУЛ   1/0</Data>
</Node>
<Node><Sub>182</Sub>
<Data>                     LT - ЛЕВОЕ ПОЛЕ</Data>
</Node>
<Node><Sub>183</Sub>
<Data>                     UK - ИСПОЛЬЗОВАТЬ КАРТУ ВЫВОДА 1/0</Data>
</Node>
<Node><Sub>184</Sub>
<Data>                     PT - ПЕЧАТЬ ПОТОКОМ ?  1/0</Data>
</Node>
<Node><Sub>185</Sub>
<Data>    ^BSR(BST,&quot;HFS&quot;)=...АНАЛОГИЧНО &quot;PRN&quot;</Data>
</Node>
<Node><Sub>186</Sub>
<Data>    ^BSR(BST,&quot;SHR&quot;)=КОДЫ УПРАВЛЕНИЯ ПРИНТЕРОМ</Data>
</Node>
<Node><Sub>187</Sub>
<Data>    ^BSR(BST,&quot;HVL&quot;) - ЕСТЬ ССЫЛКИ НА БАЗЫ ДАННЫХ НА СМЕННЫЕ ПРИВОДЫ</Data>
</Node>
<Node><Sub>188</Sub>
<Data>                  ,&quot;VOL&quot;)=A:\HFS1</Data>
</Node>
<Node><Sub>189</Sub>
<Data>                    ... )=B:\HFS2</Data>
</Node>
<Node><Sub>190</Sub>
<Data>?    ^BSR(BST,&quot;AF2&quot;)=BSr,BSt - ССЫЛКА НА БЛОЧНОЕ БЛОЧНОЕ МЕНЮ ТАБЛИЦЫ</Data>
</Node>
<Node><Sub>191</Sub>
<Data>??    ^BSR(BST,&quot;AF2&quot;,1,1)=[САМО МЕНЮ.....] ФОРМАТА ^%ZAPM.ed.BSB</Data>
</Node>
<Node><Sub>192</Sub>
<Data>                   ....</Data>
</Node>
<Node><Sub>193</Sub>
<Data>    ^BSR(BST,&quot;XBD&quot;)=СИМВОЛЫ УНИКАЛИЗАЦИИ ИМЕН ХРАНЕНИЯ В БД</Data>
</Node>
<Node><Sub>194</Sub>
<Data>    ^BSR(BST,&quot;MNU&quot;)=КОД ЦВЕТА МЕНЮ ДЛЯ  VIEW</Data>
</Node>
<Node><Sub>195</Sub>
<Data>    ^BSR(BST,&quot;DBF&quot;)=СТРУКТУРА DBF ...</Data>
</Node>
<Node><Sub>196</Sub>
<Data></Data>
</Node>
<Node><Sub>197</Sub>
<Data></Data>
</Node>
<Node><Sub>198</Sub>
<Data>    ^%ZAPM.ed.BSHLP(i) - РАЗДЕЛ СИСТЕМНОЙ ПОМОЩИ</Data>
</Node>
<Node><Sub>199</Sub>
<Data>           (i,1)=ТЕКСТ ПОМОЩИ</Data>
</Node>
<Node><Sub>200</Sub>
<Data>            ...</Data>
</Node>
<Node><Sub>201</Sub>
<Data>    ^%ZAPM.ed.BSX(i) - СКРЫТЫЙ РАЗДЕЛ ТЕКСТОВОГО РЕДАКТОРА</Data>
</Node>
<Node><Sub>202</Sub>
<Data></Data>
</Node>
<Node><Sub>203</Sub>
<Data>    ^%ZAPM.ed.BSETUP(i) - РАЗДЕЛ ТЕКУЩИХ ПАРАМЕТРОВ %BS</Data>
</Node>
</Node>
<Node><Sub>D0</Sub>
<Data>Документация по %BSX@@@@@1@1@7@20@17@60@1@@1@@1@1@@3,1@1@@@@@@@@11@1@@2;6;30;45@@@@@@@1</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@41@@@@0@1@2;6;30;45@@@@@ Документация табличного пpоцессоpа</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@41@1@@@0@1@2;6;30;45@@@@@=============================================</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data><![CDATA[3@1@1@41@@@@0@1@@@@@^%ZAPM.ed.BSHLP("D1")@===   ПОДПРОГРАММЫ %BS ПРЕДОБРАБОТКИ  =============---­­­···@]]></Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data><![CDATA[4@1@1@41@@@@3,1@1@@@@@^%ZAPM.ed.BSHLP("D2")@===      Работа С Таблицами %BS       =============---­­­···@]]></Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data><![CDATA[5@1@1@41@@@@@1@@@@@^%ZAPM.ed.BSHLP("D3")@===         Работа С Экраном          =============---­­­···@]]></Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data><![CDATA[6@1@1@41@@@@@1@@@@@^%ZAPM.ed.BSHLP("D4")@===        Работа Со строками         =============---­­­···@]]></Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data><![CDATA[7@1@1@41@@@@@1@@@@@^%ZAPM.ed.BSHLP("D5")@===    Работа С Базами данных MSM     =============---­­­···@]]></Data>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>1</Sub>
<Data><![CDATA[8@1@1@41@@@@@1@@@@@^%ZAPM.ed.BSHLP("D6")@===         Работа с Файлами          =============---­­­···@]]></Data>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>1</Sub>
<Data><![CDATA[9@1@1@41@@@@@1@@@@@^%ZAPM.ed.BSHLP("D7")@===        Работа С Массивами         =============---­­­···@]]></Data>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>1</Sub>
<Data><![CDATA[10@1@1@41@@@@@1@@@@@^%ZAPM.ed.BSHLP("D8")@===         Системные Работы          =============---­­­···@]]></Data>
</Node>
</Node>
<Node><Sub>11</Sub>
<Node><Sub>1</Sub>
<Data><![CDATA[11@1@1@41@@@@@1@@@@@^%ZAPM.ed.BSHLP("D9")@===   Полезные,Часто нужные штучки    =============---­­­···@]]></Data>
</Node>
</Node>
<Node><Sub>FTR</Sub>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>STA</Sub>
<Data>8,1@3@1@27@-1@-1@14@20@===         Работа с Файлами          =============---­­­···</Data>
</Node>
</Node>
<Node><Sub>D1</Sub>
<Data><![CDATA[ПОДПРОГРАММЫ %BS ПРЕДОБРАБОТКИ@@@@@@@1@1@22@80@@@@1@@5@@@1@@@ 1@@@@@53@@@2;6;36;44///2;6;36;44/2;6;37;44@@@@@@@1]]></Data>
<Node><Sub>1</Sub>
<Data>1.</Data>
</Node>
<Node><Sub>2</Sub>
<Data>···­­­---===========   ПОДПРОГРАММЫ %BS ПРЕДОБРАБОТКИ  =============---­­­···</Data>
</Node>
<Node><Sub>3</Sub>
<Data>              ------------------------------------------------</Data>
</Node>
<Node><Sub>4</Sub>
<Data>Программы предобработки используют скэн-коды клавитуры введенные пользователем</Data>
</Node>
<Node><Sub>5</Sub>
<Data>и распологающие в переменных R1,R2,R3. Программы предобработки действуют</Data>
</Node>
<Node><Sub>6</Sub>
<Data>только в то время, когда пользователь находится в таблице или тексте.</Data>
</Node>
<Node><Sub>7</Sub>
<Data>Проверить скэн-код клавиши можно программным модулем </Data>
</Node>
<Node><Sub>8</Sub>
<Data>D CL^%ZAPM.ed.BSF4,Keys^%ZAPM.ed.BSXfun1         ,или            F  D READM^%ZAPM.ed.BSre W !</Data>
</Node>
<Node><Sub>9</Sub>
<Data>R1 - обычно может принимать значения от 0 до 255. Переменная R1 может</Data>
</Node>
<Node><Sub>10</Sub>
<Data>принимать специальные значения, анализируя которые в программах предобработки</Data>
</Node>
<Node><Sub>11</Sub>
<Data>можно выполнять те, или иные специальные действия.</Data>
</Node>
<Node><Sub>12</Sub>
<Data>R1=333 - вход в таблицу после перевычислений</Data>
</Node>
<Node><Sub>13</Sub>
<Data> ...</Data>
</Node>
<Node><Sub>14</Sub>
<Data>R1=777 - выход из таблицы описания БД перед записью значений в БД</Data>
</Node>
<Node><Sub>15</Sub>
<Data>R1=888 - выход из таблицы описания БД после записи значений в БД</Data>
</Node>
<Node><Sub>16</Sub>
<Data>R1=999 - выход из таблицы</Data>
</Node>
<Node><Sub>17</Sub>
<Data>Вставить программу предобработки в любую таблицу</Data>
</Node>
<Node><Sub>18</Sub>
<Data></Data>
</Node>
<Node><Sub>19</Sub>
<Data>···­­­---===========   примеры программ предобработки  =============---­­­···</Data>
</Node>
<Node><Sub>20</Sub>
<Data>              ------------------------------------------------</Data>
</Node>
<Node><Sub>21</Sub>
<Data>AF10^%ZAPM.ed.BSF12    -  ПРЕДОБРАБОТКА ДЛЯ БС-ИНТЕРФЕЙСА</Data>
</Node>
<Node><Sub>22</Sub>
<Data></Data>
</Node>
<Node><Sub>23</Sub>
<Data>TreeCopy^%ZAPM.ed.BSF10 - ПРЕДОБРАБОТКА ДЛЯ УЗЛОВ БД</Data>
</Node>
<Node><Sub>24</Sub>
<Data></Data>
</Node>
<Node><Sub>25</Sub>
<Data>STRUKT^%ZAPM.ed.BSF10  -  ВОЗМОЖНОСТЬ ИСПОЛЬЗОВАТЬ БД КАК ТАБЛИЦУ ПРИКРЕПЛЕННУЮ К</Data>
</Node>
<Node><Sub>26</Sub>
<Data>                  КЛЕТКЕ.ВЫХОД ИЗ ЛЮБОГО УРОВНЯ КЛЮЧЕЙ ПО КЛАВИШЕ &lt;F10&gt;</Data>
</Node>
<Node><Sub>27</Sub>
<Data></Data>
</Node>
<Node><Sub>28</Sub>
<Data>SelZ^%ZAPM.ed.BSF9     -  ПРЕДОБРАБОТКА КЛАВИШ (ПАНЕЛЬ ЗАВИСИМЫХ СЕЛЕКТОРНЫХ КНОПОК)</Data>
</Node>
<Node><Sub>29</Sub>
<Data>                  НУЖНА Ф.ТРАН - $$SelecBut^%ZAPM.ed.BSsFUNM(T)</Data>
</Node>
<Node><Sub>30</Sub>
<Data>                                              </Data>
</Node>
<Node><Sub>31</Sub>
<Data>PDM^%ZAPM.ed.BSF10(U)  -  ОРГАНИЗАЦИЯ Pall-Down-Menu В ТАБЛИЦАХ</Data>
</Node>
<Node><Sub>32</Sub>
<Data>                  --------------------------------------    U=1  </Data>
</Node>
<Node><Sub>33</Sub>
<Data>                  ------------```````-------------------</Data>
</Node>
<Node><Sub>34</Sub>
<Data>                           -----------------</Data>
</Node>
<Node><Sub>35</Sub>
<Data>                           |---------------|   U=2</Data>
</Node>
<Node><Sub>36</Sub>
<Data>                           |---------------|</Data>
</Node>
<Node><Sub>37</Sub>
<Data>                           -----------------</Data>
</Node>
<Node><Sub>38</Sub>
<Data></Data>
</Node>
<Node><Sub>39</Sub>
<Data> -  ПРИМЕР ПРОВЕРКИ КОРРЕКЦИИ КАРТЫ БД ПЕРЕД ЗАПИСЬЮ В БД</Data>
</Node>
<Node><Sub>40</Sub>
<Data>RECORD ;ПРИМЕР</Data>
</Node>
<Node><Sub>41</Sub>
<Data> I R1=777 D</Data>
</Node>
<Node><Sub>42</Sub>
<Data> .; $G(^%ZAPM.ed.BSbufB(&quot;BB&quot;_$P_$J_&quot;u&quot;_%BS(15),20,3)) - ДАННЫЕ КЛЕТКИ {20,3} (БУФЕР)</Data>
</Node>
<Node><Sub>43</Sub>
<Data> .; @(BSD_%KEYS(0))@(%KEYS(1),%KEYS(2),%KEYS(3),%KEYS(4)) - УЗЕЛ БД</Data>
</Node>
<Node><Sub>44</Sub>
<Data> Q</Data>
</Node>
<Node><Sub>45</Sub>
<Data></Data>
</Node>
<Node><Sub>46</Sub>
<Data>CloseCLC^%ZAPM.ed.BSre ;МОДУЛЬ ПРЕДОБРАБОТКИ</Data>
</Node>
<Node><Sub>47</Sub>
<Data>                ВЫКЛЮЧИТЬ ПЕРЕВЫЧИСЛЕНИЯ ПОСЛЕ ПЕРВОГО РАЗА</Data>
</Node>
<Node><Sub>48</Sub>
<Data>                </Data>
</Node>
<Node><Sub>49</Sub>
<Data>ENTER^%ZAPM.ed.BSIND    ВКЛЮЧИТЬ ПЕРЕКОДИРОВАНИЯ &lt;ENTER&gt; НА &lt;ALT-Y&gt; ДЛЯ КЛЕТКИ {12,3}</Data>
</Node>
<Node><Sub>50</Sub>
<Data>                (ПРИМЕР)</Data>
</Node>
<Node><Sub>51</Sub>
<Data>DECODE^%ZAPM.ed.BSIND(S,C,OT,KU) ;ПЕРЕКОДИРОВКА ДЛЯ КЛЕТКИ СТРОКИ=S , КОЛОНКИ=C</Data>
</Node>
<Node><Sub>52</Sub>
<Data>                          ИСХОДНЫЕ КОДЫ OT=&quot;13,-1,-1&quot;</Data>
</Node>
<Node><Sub>53</Sub>
<Data>                          ПОДМЕНЯЕМЫЕ КОДЫ KU=&quot;13,-1,-1&quot;</Data>
</Node>
</Node>
<Node><Sub>D2</Sub>
<Data><![CDATA[Работа С Таблицами %BS@@@@@@@1@1@22@80@@@@1@@5@@@1@@@ 1@@@@@145@@@2;6;36;44///2;6;36;44/2;6;37;44@@@@@@@1]]></Data>
<Node><Sub>1</Sub>
<Data>2.</Data>
</Node>
<Node><Sub>2</Sub>
<Data>···­­­---===========   Работа С Таблицами %BS          =============---­­­···</Data>
</Node>
<Node><Sub>3</Sub>
<Data>              ------------------------------------------------</Data>
</Node>
<Node><Sub>4</Sub>
<Data>  Вход в таблицу          S BSR=&quot;^PART&quot;,BST=&quot;TAB&quot;              ny,nx-кооpди.</Data>
</Node>
<Node><Sub>5</Sub>
<Data>                           D ^%ZAPM.ed.BST                              R1-код</Data>
</Node>
<Node><Sub>6</Sub>
<Data>                                                            d=текущие данные</Data>
</Node>
<Node><Sub>7</Sub>
<Data></Data>
</Node>
<Node><Sub>8</Sub>
<Data>   Загрузка локалей %BS    D CLr^%ZAPM.ed.BSF4                          clr,... и тд</Data>
</Node>
<Node><Sub>9</Sub>
<Data>                                                                (Пpиложение</Data>
</Node>
<Node><Sub>10</Sub>
<Data></Data>
</Node>
<Node><Sub>11</Sub>
<Data>   Вход в таблицу по ^NEW  S IYI=&quot;^PART(TAB&quot; D NE^%ZAPM.ed.BSN         см 1.</Data>
</Node>
<Node><Sub>12</Sub>
<Data>   c сохранением видео -    или</Data>
</Node>
<Node><Sub>13</Sub>
<Data>    картинки               D Table^%ZAPM.ed.BSN(BSR,BST)   возвращает  YES, где</Data>
</Node>
<Node><Sub>14</Sub>
<Data>                 YES=1@2@3@4@5@6@7@8@9    - статус выхода из таблицы</Data>
</Node>
<Node><Sub>15</Sub>
<Data>                 1=Y,X - номер клетки</Data>
</Node>
<Node><Sub>16</Sub>
<Data>                 7 - координата клетки по строке</Data>
</Node>
<Node><Sub>17</Sub>
<Data>                 8 - координата клетки по колонке</Data>
</Node>
<Node><Sub>18</Sub>
<Data>                 4,5,6 - скан коды</Data>
</Node>
<Node><Sub>19</Sub>
<Data>                 9 - данные лежащие в этой клетке</Data>
</Node>
<Node><Sub>20</Sub>
<Data></Data>
</Node>
<Node><Sub>21</Sub>
<Data> Вход в формируемую таблицу  S IYI=&quot;PARAM,%BSVOL,,,&lt;&gt;&quot; D ENTER^%ZAPM.ed.BSN</Data>
</Node>
<Node><Sub>22</Sub>
<Data>   из ключей базы данных        Q:date=&quot;&quot;</Data>
</Node>
<Node><Sub>23</Sub>
<Data></Data>
</Node>
<Node><Sub>24</Sub>
<Data>ВОЗВРАЩАЕТ ВЫБРАННЫЙ 1 УЗЕЛ  $$UZEL^%ZAPM.ed.BSVOL(TAB,PAR,UCI,SYS,&quot;TEXT ПРИГЛАШЕНИЯ&quot;)</Data>
</Node>
<Node><Sub>25</Sub>
<Data> ИЗ БАЗЫ ДАННЫХ</Data>
</Node>
<Node><Sub>26</Sub>
<Data></Data>
</Node>
<Node><Sub>27</Sub>
<Data>                    $$A^%ZAPM.ed.BSA(i,j,BST,BSR,UCI,VOL,KEY0,KEY1,KEY2,...,KEY9)</Data>
</Node>
<Node><Sub>28</Sub>
<Data>  Доставание        DataCell^%ZAPM.ed.BSF8(BSR,BST,i,j) Q $P($G(@BSR@(BST,i,j)),&quot;@&quot;,15)</Data>
</Node>
<Node><Sub>29</Sub>
<Data>  некоторых         ColrCell^%ZAPM.ed.BSF8(BSR,BST,i,j) Q $P($G(@BSR@(BST,i,j)),&quot;@&quot;,10)</Data>
</Node>
<Node><Sub>30</Sub>
<Data>  данных            EntrCell^%ZAPM.ed.BSF8(BSR,BST,i,j) Q $P($G(@BSR@(BST,i,j)),&quot;@&quot;,14)</Data>
</Node>
<Node><Sub>31</Sub>
<Data>  из таблицы        LogCell^%ZAPM.ed.BSF8(BSR,BST,i,j) Q $P($G(@BSR@(BST,i,j)),&quot;@&quot;,13)</Data>
</Node>
<Node><Sub>32</Sub>
<Data></Data>
</Node>
<Node><Sub>33</Sub>
<Data></Data>
</Node>
<Node><Sub>34</Sub>
<Data>   Форматирование таблицы   S BSR=&quot;^PART&quot;,BST=&quot;TAB&quot;</Data>
</Node>
<Node><Sub>35</Sub>
<Data>                            D TAB^%ZAPM.ed.BSF1,TIT^%ZAPM.ed.BST,W^%ZAPM.ed.BST G B^%ZAPM.ed.BSTM</Data>
</Node>
<Node><Sub>36</Sub>
<Data></Data>
</Node>
<Node><Sub>37</Sub>
<Data>   Глобальные параметры  </Data>
</Node>
<Node><Sub>38</Sub>
<Data>   Таблицы  S $P(@(BSR_&quot;(BST)&quot;),&quot;@&quot;,N)   D R^%ZAPM.ed.BSF4(N,S)    N-номеp $P S-что</Data>
</Node>
<Node><Sub>39</Sub>
<Data></Data>
</Node>
<Node><Sub>40</Sub>
<Data> Перебор помеченных   S BSR=&quot;^PART&quot;,BST=&quot;TAB&quot;,do=&quot;команда для текущей ^BSR(BST,i,j)&quot;</Data>
</Node>
<Node><Sub>41</Sub>
<Data>  клеток               D BLOK^%ZAPM.ed.BSF1</Data>
</Node>
<Node><Sub>42</Sub>
<Data></Data>
</Node>
<Node><Sub>43</Sub>
<Data>   Перебор всех клеток  S BSR=&quot;^PART&quot;,BST=&quot;TAB&quot;,do=&quot;команда для текущей ^BSR(BST,i,j)&quot;</Data>
</Node>
<Node><Sub>44</Sub>
<Data>                        D ALLT^%ZAPM.ed.BSS1</Data>
</Node>
<Node><Sub>45</Sub>
<Data></Data>
</Node>
<Node><Sub>46</Sub>
<Data>Перерисовка клеток           S do=&quot;I &quot;&quot;23&quot;&quot;&apos;[$P(@$ZR,&quot;&quot;@&quot;&quot;,7) D W^%ZAPM.ed.BSTM&quot;</Data>
</Node>
<Node><Sub>47</Sub>
<Data>таблицы-находясь в ней       D 66^%ZAPM.ed.BSF3      (пример)</Data>
</Node>
<Node><Sub>48</Sub>
<Data>самой (для программ </Data>
</Node>
<Node><Sub>49</Sub>
<Data>предобработки функ.клавиш)</Data>
</Node>
<Node><Sub>50</Sub>
<Data></Data>
</Node>
<Node><Sub>51</Sub>
<Data>  Определить порядок цикла S BSR=&quot;^PART&quot;,BST=&quot;TAB&quot;            I=переменная</Data>
</Node>
<Node><Sub>52</Sub>
<Data>  пробега  по таблице       D FOR^%ZAPM.ed.BSF3                        X I_&quot;команда</Data>
</Node>
<Node><Sub>53</Sub>
<Data>                                                                 для ny,nx&quot;</Data>
</Node>
<Node><Sub>54</Sub>
<Data>   Формирование таблицы      F...D CR^%ZAPM.ed.BSN  l1,l2,...-длины кол    BSR,BST</Data>
</Node>
<Node><Sub>55</Sub>
<Data>                                           col(j)=ЦВЕТА</Data>
</Node>
<Node><Sub>56</Sub>
<Data>                            в цикле        t1,t2,...-тексты</Data>
</Node>
<Node><Sub>57</Sub>
<Data>                           CREATE^%ZAPM.ed.BSN-    ke-кол-во колонок</Data>
</Node>
<Node><Sub>58</Sub>
<Data>                           -завершение с   BSr,BSt-имена...</Data>
</Node>
<Node><Sub>59</Sub>
<Data>                           входом в табл.  v-высота стpоки</Data>
</Node>
<Node><Sub>60</Sub>
<Data>                           CREAT^%ZAPM.ed.BSN-без tIT-титул</Data>
</Node>
<Node><Sub>61</Sub>
<Data>                           входа в табл.  Fk=&quot;&quot; выкл Ф.КЛАВИШ.</Data>
</Node>
<Node><Sub>62</Sub>
<Data></Data>
</Node>
<Node><Sub>63</Sub>
<Data>   Формирование текста     F...D CR^%ZAPM.ed.BSTT</Data>
</Node>
<Node><Sub>64</Sub>
<Data>                            в цикле       t0-текст</Data>
</Node>
<Node><Sub>65</Sub>
<Data>                           CREATE^%ZAPM.ed.BSTT    ke-кол-во колонок</Data>
</Node>
<Node><Sub>66</Sub>
<Data>                           -завершение с   BSr,BSt-имена...</Data>
</Node>
<Node><Sub>67</Sub>
<Data>                           входом в текст  Fk=&quot;&quot; выкл Ф.КЛАВИШ.</Data>
</Node>
<Node><Sub>68</Sub>
<Data>                           CREAT^%ZAPM.ed.BSTT без</Data>
</Node>
<Node><Sub>69</Sub>
<Data>                           входа в текст</Data>
</Node>
<Node><Sub>70</Sub>
<Data></Data>
</Node>
<Node><Sub>71</Sub>
<Data>   Формирование текста   (НОВЫЙ ВАРИАНТ)</Data>
</Node>
<Node><Sub>72</Sub>
<Data></Data>
</Node>
<Node><Sub>73</Sub>
<Data> N BSr,BSt,i,se,ke,tIT,Fk,Obraz,Ob,CReATe,j,cl ;ПРИВАТНЫЕ ПЕРЕМЕННЫЕ</Data>
</Node>
<Node><Sub>74</Sub>
<Data> D TempT^%ZAPM.ed.BSTT ;ИНИЦИАЛИЗАЦИЯ</Data>
</Node>
<Node><Sub>75</Sub>
<Data> D TempTX^%ZAPM.ed.BSTT(str) ;ТЕКУЩАЯ СТРОКА</Data>
</Node>
<Node><Sub>76</Sub>
<Data> D TempTXT^%ZAPM.ed.BSTT(&quot;ЗАГОЛОВОК&quot;,$G(@%BS(20)@(&quot;ErrorTXT&quot;))) ;И ШАБЛОН</Data>
</Node>
<Node><Sub>77</Sub>
<Data> D TempTXTE^%ZAPM.ed.BSTT ;ВХОД В ТЕКСТ ИЛИ  d ^%ZAPM.ed.BSX(&quot;TEXT&quot;,BSr,BSt) ...YES=Str</Data>
</Node>
<Node><Sub>78</Sub>
<Data> D TempTXDEL ;УДАЛИТЬ ТЕКСТ                               </Data>
</Node>
<Node><Sub>79</Sub>
<Data></Data>
</Node>
<Node><Sub>80</Sub>
<Data>  Копировать таблицу     S BSr1=&quot;^P&quot;,BSt1=&quot;T&quot;,BSr2=&quot;^P1&quot;,BSt2=&quot;T1&quot;</Data>
</Node>
<Node><Sub>81</Sub>
<Data>   в таблицу              D COPY^%ZAPM.ed.BSTK</Data>
</Node>
<Node><Sub>82</Sub>
<Data></Data>
</Node>
<Node><Sub>83</Sub>
<Data></Data>
</Node>
<Node><Sub>84</Sub>
<Data> - Запуск насчета сводки &quot;MOL1008&quot; комплекса &quot;Аналитические формы&quot;</Data>
</Node>
<Node><Sub>85</Sub>
<Data>   S G1(1)=990322,G2(1)=990422,bok=21,C=1 D LOAD^%ZAPM.ed.BSzvU(&quot;MOL1008&quot;,1)</Data>
</Node>
<Node><Sub>86</Sub>
<Data>   ,где G1,G2,C - периоды насчета</Data>
</Node>
<Node><Sub>87</Sub>
<Data>   bok - номер стандартной боковины</Data>
</Node>
<Node><Sub>88</Sub>
<Data> - Или   D LOAD^%ZAPM.ed.BSzvU(&quot;MOL1008&quot;) - периоды насчета определить в диалоге   </Data>
</Node>
<Node><Sub>89</Sub>
<Data> - Или   D LOAD1^%ZAPM.ed.BSzvU - сводку и периоды определить в диалоге</Data>
</Node>
<Node><Sub>90</Sub>
<Data></Data>
</Node>
<Node><Sub>91</Sub>
<Data> - Запуск насчета списка &quot;10203#13&quot; комплекса &quot;Аналитические формы&quot;</Data>
</Node>
<Node><Sub>92</Sub>
<Data>   S G1(1)=990101,G2(1)=990422,C=1 D LOAD^%ZAPM.ed.BSzlU(&quot;10203#13&quot;,1)</Data>
</Node>
<Node><Sub>93</Sub>
<Data>   ,где G1,G2,C - периоды насчета</Data>
</Node>
<Node><Sub>94</Sub>
<Data> - или   D LOAD^%ZAPM.ed.BSzlU(&quot;10203#13&quot;) - периоды насчета определить в диалоге</Data>
</Node>
<Node><Sub>95</Sub>
<Data> - Или   D LOAD1^%ZAPM.ed.BSzlU - список и периоды определить в диалоге</Data>
</Node>
<Node><Sub>96</Sub>
<Data></Data>
</Node>
<Node><Sub>97</Sub>
<Data></Data>
</Node>
<Node><Sub>98</Sub>
<Data>  D ZPSTART^%ZAPM.ed.BSZPS(ZPN,BSrz,BStz,ZPR,ZPT) ;СТАРТ ЗАПРОСА</Data>
</Node>
<Node><Sub>99</Sub>
<Data>             ;BSrz,BStz-раздел и сводка/список</Data>
</Node>
<Node><Sub>100</Sub>
<Data>             ;ZPN-имя запроса</Data>
</Node>
<Node><Sub>101</Sub>
<Data>             ;ZPR-раздел куда записывать ZPT-имя таблицы</Data>
</Node>
<Node><Sub>102</Sub>
<Data>             ;(по умолчанию ZPR=BSrz,ZPT=BStz_(&quot;.Last&quot;+1))</Data>
</Node>
<Node><Sub>103</Sub>
<Data></Data>
</Node>
<Node><Sub>104</Sub>
<Data></Data>
</Node>
<Node><Sub>105</Sub>
<Data>   Действие над текущими  S do=&quot;действие над</Data>
</Node>
<Node><Sub>106</Sub>
<Data>   клетками экрана           ^BSR(BST,ny,nx)&quot;</Data>
</Node>
<Node><Sub>107</Sub>
<Data>                          D 66^%ZAPM.ed.BSF3</Data>
</Node>
<Node><Sub>108</Sub>
<Data></Data>
</Node>
<Node><Sub>109</Sub>
<Data>   Ретрансляция формул     S BSt=&quot;^PAR&quot;,BSr=&quot;TAB&quot; D TRANS^%ZAPM.ed.BSS1</Data>
</Node>
<Node><Sub>110</Sub>
<Data>   таблицы</Data>
</Node>
<Node><Sub>111</Sub>
<Data></Data>
</Node>
<Node><Sub>112</Sub>
<Data>    СНЯТЬ ПОМЕТКУ С ТАБЛИЦЫ       D UNMARK^%ZAPM.ed.BSF11(U)</Data>
</Node>
<Node><Sub>113</Sub>
<Data>    BSR,BST</Data>
</Node>
<Node><Sub>114</Sub>
<Data></Data>
</Node>
<Node><Sub>115</Sub>
<Data>    СДЕЛАТЬ ПОМЕТКУ ТАБЛИЦЫ       D MARK^%ZAPM.ed.BSF11(U,M)</Data>
</Node>
<Node><Sub>116</Sub>
<Data>    BSR,BST ПО ДАННЫМ M МАССИВА</Data>
</Node>
<Node><Sub>117</Sub>
<Data></Data>
</Node>
<Node><Sub>118</Sub>
<Data>    ВНУТРЕННЯЯ ТОЧКА ВХОДА ДЛЯ  D IntTXT2T^%ZAPM.ed.BSBL1</Data>
</Node>
<Node><Sub>119</Sub>
<Data>    СОЗДАНИЯ ТАБЛИЦЫ ИЗ ТЕКСТА</Data>
</Node>
<Node><Sub>120</Sub>
<Data>    ФОРМАТА %BS ИЗ BSr,BSt ---&gt; BSR,BST</Data>
</Node>
<Node><Sub>121</Sub>
<Data>    </Data>
</Node>
<Node><Sub>122</Sub>
<Data>   СОЗДАТЬ НОВУЮ ТАБЛИЦУ  D D^%ZAPM.ed.BSDIR(ot,do,fi,co,fo,BSR,BST,com,new,</Data>
</Node>
<Node><Sub>123</Sub>
<Data>   ОБЪЕКТОВ                 cmdl,Fk,comnew)</Data>
</Node>
<Node><Sub>124</Sub>
<Data></Data>
</Node>
<Node><Sub>125</Sub>
<Data>                ;new=1 СТРОКА НОВОГО ОБ&apos;ЕКТА (2 СТРОКА) ОБЯЗАТЕЛЬНА</Data>
</Node>
<Node><Sub>126</Sub>
<Data>                ;new=2 СТРОКА НОВОГО ОБ&apos;ЕКТА ...ТОЛЬКО ПРИ ОТСУТСТВИИ ОБ&apos;ЕКТОВ</Data>
</Node>
<Node><Sub>127</Sub>
<Data>                ;new=&quot;&quot; СТРОКА НОВОГО ОБ&apos;ЕКТА НЕ НУЖНА</Data>
</Node>
<Node><Sub>128</Sub>
<Data>                ;cmdl   КОМАНДА СПЕЦ-ПОДСКАЗКИ</Data>
</Node>
<Node><Sub>129</Sub>
<Data>                com comnew - коментарии и т.д.</Data>
</Node>
<Node><Sub>130</Sub>
<Data></Data>
</Node>
<Node><Sub>131</Sub>
<Data>   КОМАНДЫ ВЫЗОВА MUMPS ПОВЕШЕННЫЕ НА КЛЕТКУ:</Data>
</Node>
<Node><Sub>132</Sub>
<Data></Data>
</Node>
<Node><Sub>133</Sub>
<Data>ВЫЗОВ РАЗДЕЛА %BS ДЛЯ РАБОТЫ В НЕМ</Data>
</Node>
<Node><Sub>134</Sub>
<Data>             N Pddp,%NAM,IntBS S %NAM=&quot;^PART&quot; ;ЭТО ИМЯ РАЗДЕЛА</Data>
</Node>
<Node><Sub>135</Sub>
<Data>             S IntBS=1 D TAB^%ZAPM.ed.BS</Data>
</Node>
<Node><Sub>136</Sub>
<Data>   </Data>
</Node>
<Node><Sub>137</Sub>
<Data>   D CellTab^%ZAPM.ed.BSMDDR2(X,Z) ;ФУНКЦИЯ ВЫЗОВА ТАБЛИЦЫ БЕЗ ВОЗВРАТА</Data>
</Node>
<Node><Sub>138</Sub>
<Data>    X-СИМВ.ИМЯ КЛЕТКИ ХРАНЕНИЯ В БД,ГДЕ ЛЕЖИТ ССЫЛКА НА ТАБЛИЦУ В ФОРМАТЕ</Data>
</Node>
<Node><Sub>139</Sub>
<Data>         ^[&quot;GLAVK&quot;]PAR(&quot;TAB&quot;)</Data>
</Node>
<Node><Sub>140</Sub>
<Data>    Z=1 НЕЗАПИСЫВАТЬ ВОЗВРАЩАЕМОЕ ЗНАЧЕНИЕ</Data>
</Node>
<Node><Sub>141</Sub>
<Data>    </Data>
</Node>
<Node><Sub>142</Sub>
<Data><![CDATA[ВЫЗОВ ВРЕМЕННОЙ ТАБЛИЦЫ        S i=$$LOAD^%ZAPM.ed.BSscrF("^%ZAPM.ed.BSVOL(CopyTree)",2,2,"~","CopyTrP^%ZAPM.ed.BSBD") I R1=27 Q 0    ]]></Data>
</Node>
<Node><Sub>143</Sub>
<Data>НА ОСНОВЕ ШАБЛОНА И ВОЗВРАТ</Data>
</Node>
<Node><Sub>144</Sub>
<Data>ИЗМЕНЕИЙ В НЕЙ ПРОИЗВЕДЕННЫХ</Data>
</Node>
<Node><Sub>145</Sub>
<Data></Data>
</Node>
</Node>
<Node><Sub>D3</Sub>
<Data>Работа С Экраном@@@@@@@1@1@22@80@@@@1@@5@@@1@@@ 1@@@@@40@@@2;6;36;44///2;6;36;44/2;6;37;44@@@@@@@1</Data>
<Node><Sub>1</Sub>
<Data>3.</Data>
</Node>
<Node><Sub>2</Sub>
<Data>···­­­---===========         Работа С Экраном          =============---­­­···</Data>
</Node>
<Node><Sub>3</Sub>
<Data>              ------------------------------------------------</Data>
</Node>
<Node><Sub>4</Sub>
<Data>   Запомнить экpан          D SA^%ZAPM.ed.BSsBUF ...</Data>
</Node>
<Node><Sub>5</Sub>
<Data>   Восстановить экpан       D RE^%ZAPM.ed.BSsBUF</Data>
</Node>
<Node><Sub>6</Sub>
<Data></Data>
</Node>
<Node><Sub>7</Sub>
<Data>   Вход в таблицу  без      S BSR=&quot;^PART&quot;,BST=&quot;TAB&quot;             см 1.</Data>
</Node>
<Node><Sub>8</Sub>
<Data>   сохpанения видео         D ENTER^%ZAPM.ed.BSN</Data>
</Node>
<Node><Sub>9</Sub>
<Data></Data>
</Node>
<Node><Sub>10</Sub>
<Data>   Вывод сообщений об       S ls=&quot;ТЕКСТ ОШИБКИ&quot; D O^%ZAPM.ed.BSF7  или</Data>
</Node>
<Node><Sub>11</Sub>
<Data>   ошибке                   D ErrMsg^%ZAPM.ed.BSXfun(&quot;ТЕКСТ ОШИБКИ&quot;)</Data>
</Node>
<Node><Sub>12</Sub>
<Data></Data>
</Node>
<Node><Sub>13</Sub>
<Data>   Вывод простого сообщения D OkMsg^%ZAPM.ed.BSXfun(&quot;ТЕКСТ&quot;)</Data>
</Node>
<Node><Sub>14</Sub>
<Data></Data>
</Node>
<Node><Sub>15</Sub>
<Data>   Меню  ДА/НЕТ             S ls=&quot;ВЫ УВЕРЕНЫ ?&quot; D YES^%ZAPM.ed.BSF&quot;      YES=1 ИСТИНА</Data>
</Node>
<Node><Sub>16</Sub>
<Data></Data>
</Node>
<Node><Sub>17</Sub>
<Data>   Сообщение о действии     S ls=&quot;ТЕКСТ&quot; D WAITS^%ZAPM.ed.BSF2          X WA-счетчик</Data>
</Node>
<Node><Sub>18</Sub>
<Data>                            D Wait^%ZAPM.ed.BSXfun(&quot;ТЕКСТ&quot;)</Data>
</Node>
<Node><Sub>19</Sub>
<Data></Data>
</Node>
<Node><Sub>20</Sub>
<Data>   Сообщение &quot;ЖДИТЕ...&quot;     WAIT^%ZAPM.ed.BSF2                           WA</Data>
</Node>
<Node><Sub>21</Sub>
<Data>                    </Data>
</Node>
<Node><Sub>22</Sub>
<Data>   Разрешить эхо            D OP^%ZAPM.ed.BSF4</Data>
</Node>
<Node><Sub>23</Sub>
<Data></Data>
</Node>
<Node><Sub>24</Sub>
<Data>   Запретить эхо            D CL^%ZAPM.ed.BSF4</Data>
</Node>
<Node><Sub>25</Sub>
<Data></Data>
</Node>
<Node><Sub>26</Sub>
<Data>   Меню                    D MENU^%ZAPM.ed.BSF5(&quot; YES NO &quot;,&quot;ВВЕДИТЕ&quot;,ПРЕДУСТАНОВКА)</Data>
</Node>
<Node><Sub>27</Sub>
<Data>                           %B-блок выбоpа</Data>
</Node>
<Node><Sub>28</Sub>
<Data></Data>
</Node>
<Node><Sub>29</Sub>
<Data>   Сообщение &quot;РЕЖИМ НА ОТ-  D O^%ZAPM.ed.BSF3</Data>
</Node>
<Node><Sub>30</Sub>
<Data>             ЛАДКЕ&quot;</Data>
</Node>
<Node><Sub>31</Sub>
<Data></Data>
</Node>
<Node><Sub>32</Sub>
<Data>   ТЕКСТ КОДОВ ОШИБКИ       W !,$$ErrSay^%ZAPM.ed.BSF8($ZE)</Data>
</Node>
<Node><Sub>33</Sub>
<Data></Data>
</Node>
<Node><Sub>34</Sub>
<Data>   ВЫЗОВ ПАНЕЛИ С КНОПКАМИ   D EnterP^%ZAPM.ed.BSF8(&quot;^%ZAPM.ed.BSS(&quot;&quot;REPAIR&quot;&quot;,&quot;&quot;BUT&quot;&quot;)&quot;)</Data>
</Node>
<Node><Sub>35</Sub>
<Data>                             R1=27 &lt;Esc&gt; =13 &lt;Enter&gt;</Data>
</Node>
<Node><Sub>36</Sub>
<Data>                             d=НОМЕР КНОПКИ</Data>
</Node>
<Node><Sub>37</Sub>
<Data>                             </Data>
</Node>
<Node><Sub>38</Sub>
<Data> СМОТРЕТЬ ЭКРАН В СИСТЕМЕ      D PEEK^%ZAPM.ed.BSERVF(&quot;SYS&quot;,8)</Data>
</Node>
<Node><Sub>39</Sub>
<Data> &quot;SYS&quot;, И ЖДАТЬ ОТКЛИКА 8 СЕК                         </Data>
</Node>
<Node><Sub>40</Sub>
<Data>     </Data>
</Node>
</Node>
<Node><Sub>D4</Sub>
<Data>Работа Со строками@@@@@@@1@1@22@80@@@@1@@5@@@1@@@ 1@@@@@54@@@2;6;36;44///2;6;36;44/2;6;37;44@@@@@@@1</Data>
<Node><Sub>1</Sub>
<Data>4.            ________________________________________________</Data>
</Node>
<Node><Sub>2</Sub>
<Data>···­­­---===========         Работа Со строками        =============---­­­···</Data>
</Node>
<Node><Sub>3</Sub>
<Data>              ------------------------------------------------</Data>
</Node>
<Node><Sub>4</Sub>
<Data></Data>
</Node>
<Node><Sub>5</Sub>
<Data> ПЕРЕКОДИРОВАТЬ ФАЙЛ ИЗ ASCII В ANSI     D AS^%ZAPM.ed.BSre(V,&quot;&quot;) ;V=ИМЯ ТЕКСТОВОГО ДОС-ФАЙЛА</Data>
</Node>
<Node><Sub>6</Sub>
<Data></Data>
</Node>
<Node><Sub>7</Sub>
<Data> ПЕРЕКОДИРОВАТЬ ФАЙЛ ИЗ ASCII В HTML     D AS^%ZAPM.ed.BSre(V,&quot;HTM&quot;) ;V=ИМЯ ТЕКСТОВОГО ДОС-ФАЙЛА</Data>
</Node>
<Node><Sub>8</Sub>
<Data></Data>
</Node>
<Node><Sub>9</Sub>
<Data> ПЕРЕКОДИРОВКА ИЗ ASCII В ANSI        $$ANSI^%ZAPM.ed.BSre(S)   ;S-СТРОКА</Data>
</Node>
<Node><Sub>10</Sub>
<Data></Data>
</Node>
<Node><Sub>11</Sub>
<Data> ТРАНСЛИРОВАТЬ ТЕКСТ ДЛЯ HTML         $$TEGS^%ZAPM.ed.BSre(S)   ;S-СТРОКА</Data>
</Node>
<Node><Sub>12</Sub>
<Data></Data>
</Node>
<Node><Sub>13</Sub>
<Data> МАЛЕНЬКИЕ БУКВЫ В БОЛЬШИЕ            $$BIGL^%ZAPM.ed.BSsFUNM(S)</Data>
</Node>
<Node><Sub>14</Sub>
<Data> БОЛЬШИЕ БУКВЫ В МАЛЕНЬКИЕ            $$LITL^%ZAPM.ed.BSsFUNM(S)</Data>
</Node>
<Node><Sub>15</Sub>
<Data></Data>
</Node>
<Node><Sub>16</Sub>
<Data> Удаление пробелов в строке концевых  $$Cut^%ZAPM.ed.BSF10(s,0)</Data>
</Node>
<Node><Sub>17</Sub>
<Data>                            начальных $$Cut^%ZAPM.ed.BSF10(s,1)</Data>
</Node>
<Node><Sub>18</Sub>
<Data>                      ... и тех и тех $$CutS^%ZAPM.ed.BSF10(s)   </Data>
</Node>
<Node><Sub>19</Sub>
<Data>  </Data>
</Node>
<Node><Sub>20</Sub>
<Data>  Тpансфоpмация данных    S S=&quot;123&quot;,A=&quot;2&quot;,B=&quot;789&quot;,C=$$TR^%ZAPM.ed.BSsFUNM(S,A,B)</Data>
</Node>
<Node><Sub>21</Sub>
<Data>                           C=&quot;17893&quot;</Data>
</Node>
<Node><Sub>22</Sub>
<Data></Data>
</Node>
<Node><Sub>23</Sub>
<Data>  Строковый редактор  S ls=&quot;Text&quot;</Data>
</Node>
<Node><Sub>24</Sub>
<Data>                       S li=&quot;строка&quot;                        li-результат</Data>
</Node>
<Node><Sub>25</Sub>
<Data>                       S ll=&quot;запрещенные символы&quot;            YES=0 отмена</Data>
</Node>
<Node><Sub>26</Sub>
<Data>                       D LE^%ZAPM.ed.BSS</Data>
</Node>
<Node><Sub>27</Sub>
<Data>                              или</Data>
</Node>
<Node><Sub>28</Sub>
<Data>                       S li=$$LineEdit^%ZAPM.ed.BSXfun(&quot;СТРОКА&quot;,&quot;ТЕКСТ&quot;)</Data>
</Node>
<Node><Sub>29</Sub>
<Data></Data>
</Node>
<Node><Sub>30</Sub>
<Data>  Трансформация строки S li=&quot;^[^[&quot;GLAVK&quot;]]]]]]]]]]]]P(T)&quot;                    li=&quot;T,R,U,S&quot;</Data>
</Node>
<Node><Sub>31</Sub>
<Data>                        D TIR^%ZAPM.ed.BST4</Data>
</Node>
<Node><Sub>32</Sub>
<Data></Data>
</Node>
<Node><Sub>33</Sub>
<Data>  Трансформация строки  S PT=&quot;^[^[&quot;GLAVK&quot;]]]]]]]]]]]]P(T)&quot;</Data>
</Node>
<Node><Sub>34</Sub>
<Data>                        $$PT^%ZAPM.ed.BSPK(PT,1)=&quot;^[^[&quot;GLAVK&quot;]]]]]]]]]]]]P&quot;   ;РАЗДЕЛ</Data>
</Node>
<Node><Sub>35</Sub>
<Data>                        $$PT^%ZAPM.ed.BSPK(PT,0)=&quot;T&quot;           ;ТАБЛИЦА</Data>
</Node>
<Node><Sub>36</Sub>
<Data></Data>
</Node>
<Node><Sub>37</Sub>
<Data>   Определение раздела и  S li=&quot;TAB,PAR,UCI,SYS&quot;         BSr=&quot;^[^[&quot;GLAVK&quot;]]]]]]]]]]]]PAR&quot;</Data>
</Node>
<Node><Sub>38</Sub>
<Data>   таблицы                D RIT^%ZAPM.ed.BSF3                    BSt=&quot;TAB&quot;</Data>
</Node>
<Node><Sub>39</Sub>
<Data></Data>
</Node>
<Node><Sub>40</Sub>
<Data>   Определение глобалей   S li=&quot;^MAS&quot; D GLO^%ZAPM.ed.BSF3             GL-ИМЯ МАССИВА</Data>
</Node>
<Node><Sub>41</Sub>
<Data></Data>
</Node>
<Node><Sub>42</Sub>
<Data>   Опpеделение глобалей   S li=&quot;^MAS&quot; D GL^%ZAPM.ed.BSF3             GL-ИМЯ МАССИВА</Data>
</Node>
<Node><Sub>43</Sub>
<Data>   (без вопpоса о глоб)</Data>
</Node>
<Node><Sub>44</Sub>
<Data></Data>
</Node>
<Node><Sub>45</Sub>
<Data>ПРИСВОЕНИЕ В ЛОКАЛЬ PR         D PR^%ZAPM.ed.BSSR(U,J,S)</Data>
</Node>
<Node><Sub>46</Sub>
<Data>БАЙТА S В ПОЗИЦИЮ J УРОВНЯ U</Data>
</Node>
<Node><Sub>47</Sub>
<Data></Data>
</Node>
<Node><Sub>48</Sub>
<Data>ВЕРНУТЬ БАЙТ ПО НОМЕРУ J       $$PRI^%ZAPM.ed.BSSR(U,J)</Data>
</Node>
<Node><Sub>49</Sub>
<Data>УРОВНЯ U</Data>
</Node>
<Node><Sub>50</Sub>
<Data></Data>
</Node>
<Node><Sub>51</Sub>
<Data>ПРИСВОИТЬ ДЛИННУЮ ЛОКАЛЬ В ГЛОБАЛЬ  D GLSET^%ZAPM.ed.BSF12(G,S)</Data>
</Node>
<Node><Sub>52</Sub>
<Data></Data>
</Node>
<Node><Sub>53</Sub>
<Data>ВЕРНУТЬ ДЛИННУЮ СТРОКУ ИЗ ГЛОБАЛИ   $$GLRET^%ZAPM.ed.BSF12(G)</Data>
</Node>
<Node><Sub>54</Sub>
<Data>                                              </Data>
</Node>
</Node>
<Node><Sub>D5</Sub>
<Data><![CDATA[Работа С Базами данных MSM@@@@@@@1@1@22@80@@@@1@@5@@@1@@@ 1@@@@@67@@@2;6;36;44///2;6;36;44/2;6;37;44@@@@@@@1]]></Data>
<Node><Sub>1</Sub>
<Data>5.            ________________________________________________</Data>
</Node>
<Node><Sub>2</Sub>
<Data>···­­­---===========    Работа С Базами данных MSM     =============---­­­···</Data>
</Node>
<Node><Sub>3</Sub>
<Data>              ------------------------------------------------</Data>
</Node>
<Node><Sub>4</Sub>
<Data>              ________________________________________________</Data>
</Node>
<Node><Sub>5</Sub>
<Data>···­­­---===========  СИСТЕМНЫЕ БАЗЫ ДАННЫХ КОМПЛЕКСА  =============---­­­···</Data>
</Node>
<Node><Sub>6</Sub>
<Data>              ------------------------------------------------</Data>
</Node>
<Node><Sub>7</Sub>
<Data> Таблицы описания БД    По-умолчанию   Комментарий</Data>
</Node>
<Node><Sub>8</Sub>
<Data> ---------------------------------------------------</Data>
</Node>
<Node><Sub>9</Sub>
<Data>^%ZAPM.ed.BSS(&quot;USER&quot;,&quot;KEY&quot;)     ^%ZAPM.ed.BSU          ;ПОЛЬЗОВАТЕЛИ %BS</Data>
</Node>
<Node><Sub>10</Sub>
<Data>^%ZAPM.ed.BSDDR(&quot;DDR&quot;,&quot;KEY&quot;)    ^%ZAPM.ed.BSddr        ;ФОРМЫ DDR</Data>
</Node>
<Node><Sub>11</Sub>
<Data>^%ZAPM.ed.BSS(&quot;XECUTE&quot;,&quot;KEY&quot;)   ^%ZAPM.ed.BSex         ;КОММАНДЕР %BS</Data>
</Node>
<Node><Sub>12</Sub>
<Data>^%ZAPM.ed.BSS(&quot;ARM&quot;,&quot;KEY&quot;)      ^%ZAPM.ed.BSARM        ;АРМЫ %BS</Data>
</Node>
<Node><Sub>13</Sub>
<Data>^%ZAPM.ed.BSS(&quot;CMD&quot;,&quot;KEY&quot;)      ^%ZAPM.ed.BScmd        ;КОМАНДЕР %BS</Data>
</Node>
<Node><Sub>14</Sub>
<Data>^%ZAPM.ed.BSJPRN(&quot;PRN&quot;,&quot;KEY&quot;)   ^%ZAPM.ed.BSJPR        ;ПРИНТ-СИСТЕМА</Data>
</Node>
<Node><Sub>15</Sub>
<Data>^%ZAPM.ed.BSVOL(&quot;MARK&quot;,&quot;KEY&quot;)   ^%ZAPM.ed.BSmark       ;БАЗА ПОМЕТОК</Data>
</Node>
<Node><Sub>16</Sub>
<Data>^%ZAPM.ed.BSMDDR(&quot;BPO&quot;,&quot;KEY&quot;)   ^%ZAPM.ed.BSbpo        ;НОВАЯ БД DDR</Data>
</Node>
<Node><Sub>17</Sub>
<Data>^%ZAPM.ed.BSVOL(&quot;PACKET&quot;,&quot;KEY&quot;) ^%ZAPM.ed.BSpack       ;БД ПАКЕТОВ ЗАПРОСОВ</Data>
</Node>
<Node><Sub>18</Sub>
<Data>^%ZAPM.ed.BSVOL(&quot;F8&quot;,&quot;KEY&quot;)     ^%ZAPM.ed.BSdel        ;БД УДАЛЕННЫХ ТАБЛИЦ</Data>
</Node>
<Node><Sub>19</Sub>
<Data>^%ZAPM.ed.BSVOL(&quot;TRM&quot;,&quot;KEY&quot;)    ^%ZAPM.ed.BStrm        ;БД ТЕРМИНАЛОВ</Data>
</Node>
<Node><Sub>20</Sub>
<Data>^%ZAPM.ed.BSVOL(&quot;MainMenu&quot;,&quot;KEY&quot;)    ^%ZAPM.ed.BSMMenu ;БД МЕНЮ</Data>
</Node>
<Node><Sub>21</Sub>
<Data></Data>
</Node>
<Node><Sub>22</Sub>
<Data>              ________________________________________________</Data>
</Node>
<Node><Sub>23</Sub>
<Data>···­­­---===========  ФУНКЦИИ И МОДУЛИ РАБОТЫ С БД     =============---­­­···</Data>
</Node>
<Node><Sub>24</Sub>
<Data>              ------------------------------------------------</Data>
</Node>
<Node><Sub>25</Sub>
<Data></Data>
</Node>
<Node><Sub>26</Sub>
<Data>   ТЕСТ БАЗЫ ДАННЫХ         D TestBD^%B</Data>
</Node>
<Node><Sub>27</Sub>
<Data>   БЕЗ ОТЧЕТА</Data>
</Node>
<Node><Sub>28</Sub>
<Data></Data>
</Node>
<Node><Sub>29</Sub>
<Data></Data>
</Node>
<Node><Sub>30</Sub>
<Data>   Монтирование базы данных S %BShNAME=&quot;D:\BD.MSM&quot;</Data>
</Node>
<Node><Sub>31</Sub>
<Data>                            D MOU^%ZAPM.ed.BSF4</Data>
</Node>
<Node><Sub>32</Sub>
<Data></Data>
</Node>
<Node><Sub>33</Sub>
<Data>   Демонтирование базы    D UNMO^%ZAPM.ed.BSF4</Data>
</Node>
<Node><Sub>34</Sub>
<Data>   последней в системе</Data>
</Node>
<Node><Sub>35</Sub>
<Data>   смонтированной</Data>
</Node>
<Node><Sub>36</Sub>
<Data></Data>
</Node>
<Node><Sub>37</Sub>
<Data>   Демонтирование базы    S X=НОМЕР ГРУППЫ ТОМОВ</Data>
</Node>
<Node><Sub>38</Sub>
<Data>                          D UNM^%ZAPM.ed.BSF4</Data>
</Node>
<Node><Sub>39</Sub>
<Data></Data>
</Node>
<Node><Sub>40</Sub>
<Data>   Переход в КИП          S uci=&quot;КИП,ТОМ&quot; D %GU^%ZAPM.ed.BSF4             YES</Data>
</Node>
<Node><Sub>41</Sub>
<Data>                          или $$ZU^%ZAPM.ed.BSF4(&quot;UCI&quot;,&quot;SYS&quot;)=1 ПЕРЕШЕЛ</Data>
</Node>
<Node><Sub>42</Sub>
<Data>                              $$ZU^%ZAPM.ed.BSF4(&quot;UCI&quot;,&quot;SYS&quot;)=0 НЕ СМОГ</Data>
</Node>
<Node><Sub>43</Sub>
<Data></Data>
</Node>
<Node><Sub>44</Sub>
<Data>   Определить текущий КИП S uci=$$UCI^%ZAPM.ed.BS3(0)</Data>
</Node>
<Node><Sub>45</Sub>
<Data></Data>
</Node>
<Node><Sub>46</Sub>
<Data>   Пеpеход в системный кип   D MRG^%ZAPM.ed.BS</Data>
</Node>
<Node><Sub>47</Sub>
<Data></Data>
</Node>
<Node><Sub>48</Sub>
<Data>   Проход по всем КИПам    S DOX=&quot;действие&quot; над i-массив</Data>
</Node>
<Node><Sub>49</Sub>
<Data>   Разделам,Таблицам          iI-таблица</Data>
</Node>
<Node><Sub>50</Sub>
<Data>                            D STA^%ZAPM.ed.BSF5</Data>
</Node>
<Node><Sub>51</Sub>
<Data></Data>
</Node>
<Node><Sub>52</Sub>
<Data>   Проход по всем КИПам    S DOBD=&quot;действие&quot; над i-имя Базы Данных</Data>
</Node>
<Node><Sub>53</Sub>
<Data>   и Базам Данных           D STA^%ZAPM.ed.BSF5</Data>
</Node>
<Node><Sub>54</Sub>
<Data></Data>
</Node>
<Node><Sub>55</Sub>
<Data>   ТРАНСЛЯЦИЯ ССЫЛОК        D TranGlob^%ZAPM.ed.BSGLOB</Data>
</Node>
<Node><Sub>56</Sub>
<Data>   ВСЕГО ТОМА               или через прокачки томов VOL-FIX      </Data>
</Node>
<Node><Sub>57</Sub>
<Data></Data>
</Node>
<Node><Sub>58</Sub>
<Data>   ПОЛУЧИТЬ ССЫЛКУ НА       $$KBD^%ZAPM.ed.BSF12(&quot;^PART(&quot;&quot;TOBD&quot;&quot;)&quot;)</Data>
</Node>
<Node><Sub>59</Sub>
<Data>   БАЗУ ДАННЫХ</Data>
</Node>
<Node><Sub>60</Sub>
<Data></Data>
</Node>
<Node><Sub>61</Sub>
<Data>  I $$SetTBD^%ZAPM.ed.BSF13(&quot;ИМЯ1&quot;)=1 - УСТАНОВИЛСЯ ТЕКУЩИЙ ПЕРЕКЛЮЧАТЕЛЬ БАЗ ДАННЫХ</Data>
</Node>
<Node><Sub>62</Sub>
<Data>                                НА  &quot;ИМЯ1&quot;</Data>
</Node>
<Node><Sub>63</Sub>
<Data>  I $$SetTBD^%ZAPM.ed.BSF13(&quot;ИМЯ1&quot;)=0 - ПЕРЕКЛЮЧАТЕЛЬ БАЗ ДАННЫХ НЕ УСТАНОВИЛСЯ</Data>
</Node>
<Node><Sub>64</Sub>
<Data></Data>
</Node>
<Node><Sub>65</Sub>
<Data>  D ClearTBD^%ZAPM.ed.BSF13 - ОЧИСТИТЬ ПЕРЕКЛЮЧАТЕЛЬ БАЗ ДАННЫХ</Data>
</Node>
<Node><Sub>66</Sub>
<Data>  </Data>
</Node>
<Node><Sub>67</Sub>
<Data>  W $$ShowTBD^%ZAPM.ed.BSF13 - ПОСМОТРЕТЬ КАКОЙ ВЫСТАВЛЕН ПЕРЕКЛЮЧАТЕЛЬ БАЗ ДАННЫХ</Data>
</Node>
</Node>
<Node><Sub>D6</Sub>
<Data>Работа с Файлами@@@@@@@1@1@22@80@@@@1@@5@@@1@@@ 1@@@@@57@@@2;6;36;44///2;6;36;44/2;6;37;44@@@@@@@1</Data>
<Node><Sub>1</Sub>
<Data>6.            ________________________________________________</Data>
</Node>
<Node><Sub>2</Sub>
<Data>···­­­---===========         Работа с Файлами          =============---­­­···</Data>
</Node>
<Node><Sub>3</Sub>
<Data>              ------------------------------------------------</Data>
</Node>
<Node><Sub>4</Sub>
<Data> Диск  установленного комплекса    $$CurDisk^%ZAPM.ed.BSre()</Data>
</Node>
<Node><Sub>5</Sub>
<Data>   (для Cache&apos;)</Data>
</Node>
<Node><Sub>6</Sub>
<Data></Data>
</Node>
<Node><Sub>7</Sub>
<Data> Базовая поддиректория             $$CurDir^%ZAPM.ed.BSre(Disk)</Data>
</Node>
<Node><Sub>8</Sub>
<Data> установленного комплекса</Data>
</Node>
<Node><Sub>9</Sub>
<Data>   (для Cache&apos;)</Data>
</Node>
<Node><Sub>10</Sub>
<Data></Data>
</Node>
<Node><Sub>11</Sub>
<Data> ЗАКАЧКА ИЗ ДБФ В МАССИВ  $$DBFREAD^%ZAPM.ed.BSre(S1,F,S2,GL,N)=-1  - ОШИБКА</Data>
</Node>
<Node><Sub>12</Sub>
<Data> С ВЫБОРОМ                S1 = ТЕКСТ ПРИГЛАШЕНИЯ ВВЕСТИ ИМЯ DBF</Data>
</Node>
<Node><Sub>13</Sub>
<Data> ФАЙЛА И МАССИВА          F  = ИМЯ DBF</Data>
</Node>
<Node><Sub>14</Sub>
<Data>                          S2 = ТЕКСТ ПРИГЛАШЕНИЯ ВВЕСТИ ИМЯ буферного массива</Data>
</Node>
<Node><Sub>15</Sub>
<Data>                          GL = ИМЯ буферного массива</Data>
</Node>
<Node><Sub>16</Sub>
<Data>                          N = 0   ВЫВОДИТЬ СЧЕТЧИК</Data>
</Node>
<Node><Sub>17</Sub>
<Data>                          N = 1   НЕ ВЫВОДИТЬ СЧЕТЧИК</Data>
</Node>
<Node><Sub>18</Sub>
<Data></Data>
</Node>
<Node><Sub>19</Sub>
<Data> ЗАКАЧКА ИЗ DBF-ФАЙЛА В МАССИВ    $$DB^%ZAPM.ed.BSre(%FN,GL)=-1  - ОШИБКА</Data>
</Node>
<Node><Sub>20</Sub>
<Data></Data>
</Node>
<Node><Sub>21</Sub>
<Data>  Открыть DOS-File для   D DOSOPN^%ZAPM.ed.BSBL1                     %FN</Data>
</Node>
<Node><Sub>22</Sub>
<Data>   записи                 или                                 %DEV</Data>
</Node>
<Node><Sub>23</Sub>
<Data>                          D DosOpn^%ZAPM.ed.BSBL1(номер устр,имя Файла)</Data>
</Node>
<Node><Sub>24</Sub>
<Data>             или</Data>
</Node>
<Node><Sub>25</Sub>
<Data>             S DOS=51,FNO=&quot;File.TXT&quot; I $$Open^%ZAPM.ed.BSXdos(FNO,&quot;W&quot;)</Data>
</Node>
<Node><Sub>26</Sub>
<Data></Data>
</Node>
<Node><Sub>27</Sub>
<Data>  Открыть DOS-File для   D DOSREAD^%ZAPM.ed.BSS1                     %FN</Data>
</Node>
<Node><Sub>28</Sub>
<Data>   чтения                 или                                 %DEV</Data>
</Node>
<Node><Sub>29</Sub>
<Data>                          D DosRead^%ZAPM.ed.BSS1(номер устр,имя Файла)</Data>
</Node>
<Node><Sub>30</Sub>
<Data>             или</Data>
</Node>
<Node><Sub>31</Sub>
<Data>             S DOS=51,FNO=&quot;File.TXT&quot; I $$Open^%ZAPM.ed.BSXdos(FNO,&quot;R&quot;)              </Data>
</Node>
<Node><Sub>32</Sub>
<Data>ИЛИ:</Data>
</Node>
<Node><Sub>33</Sub>
<Data>   Cтрочный редактор с    S %IN=0 для Записи                %FN-имя DF</Data>
</Node>
<Node><Sub>34</Sub>
<Data>   HISTORY и вызовом      S %IN=1 для Чтения                %DEV-устрой-</Data>
</Node>
<Node><Sub>35</Sub>
<Data>   каталога DOS           D FILE^%ZAPM.ed.BSDOS2                         ство</Data>
</Node>
<Node><Sub>36</Sub>
<Data></Data>
</Node>
<Node><Sub>37</Sub>
<Data></Data>
</Node>
<Node><Sub>38</Sub>
<Data>ОТКРЫТИЕ УСТРОЙСТВА HFS   D DosRec^%ZAPM.ed.BSMSMF(%DEV,%FN)</Data>
</Node>
<Node><Sub>39</Sub>
<Data> ДЛЯ ДОЗАПИСИ</Data>
</Node>
<Node><Sub>40</Sub>
<Data> </Data>
</Node>
<Node><Sub>41</Sub>
<Data> Войти в каталог DOS    D DOS^%ZAPM.ed.BSDOS                         R1-код</Data>
</Node>
<Node><Sub>42</Sub>
<Data>                                                               %File-имя</Data>
</Node>
<Node><Sub>43</Sub>
<Data>                                                                 файла</Data>
</Node>
<Node><Sub>44</Sub>
<Data>  Закрыть DOS-File       S %FN-имя файла</Data>
</Node>
<Node><Sub>45</Sub>
<Data>                          S %DEV-устр-во</Data>
</Node>
<Node><Sub>46</Sub>
<Data>                          D CLO^%ZAPM.ed.BSS1</Data>
</Node>
<Node><Sub>47</Sub>
<Data></Data>
</Node>
<Node><Sub>48</Sub>
<Data>  СЛУЧАЙНОЕ ИМЯ ФАЙЛА     $$RANDFILE^%ZAPM.ed.BSF11</Data>
</Node>
<Node><Sub>49</Sub>
<Data></Data>
</Node>
<Node><Sub>50</Sub>
<Data> ДОПИСЫВАЕТ F ТЕКУЩИМ ДИСКОМ    $$AddFile^%ZAPM.ed.BSDOS2(F)</Data>
</Node>
<Node><Sub>51</Sub>
<Data> И ПОДДИРЕКТОРИЕЙ</Data>
</Node>
<Node><Sub>52</Sub>
<Data></Data>
</Node>
<Node><Sub>53</Sub>
<Data>  ВЫЗОВ ФАЙЛА В ТЕКСТ      D DOSTXT^%ZAPM.ed.BSDOS2(FN)</Data>
</Node>
<Node><Sub>54</Sub>
<Data>   И ПРОСМОТР ТЕКСТА        </Data>
</Node>
<Node><Sub>55</Sub>
<Data></Data>
</Node>
<Node><Sub>56</Sub>
<Data>ПЕРЕКОДИРОВКА ФАЙЛА        D Ascii2An^%ZAPM.ed.BSre</Data>
</Node>
<Node><Sub>57</Sub>
<Data>ИЗ ASCII В ANSI</Data>
</Node>
</Node>
<Node><Sub>D7</Sub>
<Data>Работа С Массивами@@@@@@@1@1@22@80@@@@1@@5@@@1@@@ 1@@@@@77@@@2;6;36;44///2;6;36;44/2;6;37;44@@@@@@@1</Data>
<Node><Sub>1</Sub>
<Data>7.            ________________________________________________</Data>
</Node>
<Node><Sub>2</Sub>
<Data>···­­­---===========         Работа С Массивами        =============---­­­···</Data>
</Node>
<Node><Sub>3</Sub>
<Data>              ------------------------------------------------</Data>
</Node>
<Node><Sub>4</Sub>
<Data></Data>
</Node>
<Node><Sub>5</Sub>
<Data>ВХОД В РЕДАКТОР ГЛОБАЛИ   D ^%ZAPM.ed.BSMSMG(&quot;^A(1,2,3)&quot;)</Data>
</Node>
<Node><Sub>6</Sub>
<Data>          ИЛИ ЛОКАЛИ      D ^%ZAPM.ed.BSMSMG(&quot;XXX&quot;)</Data>
</Node>
<Node><Sub>7</Sub>
<Data></Data>
</Node>
<Node><Sub>8</Sub>
<Data>ПРОВЕРИТЬ МАССИВ НА СУЩЕСТВОВАНИЕ  I $$Data^%ZAPM.ed.BSF12(G)=1    ДА</Data>
</Node>
<Node><Sub>9</Sub>
<Data>ИЛИ ДОСТУПНОСТЬ ПО СЕТИ                               0    НЕТ</Data>
</Node>
<Node><Sub>10</Sub>
<Data></Data>
</Node>
<Node><Sub>11</Sub>
<Data>   Копировать дерево в    S TRe1=&quot;^A(1,2&quot;,TRe2=&quot;^B(2&quot; D TREE^%ZAPM.ed.BSTK</Data>
</Node>
<Node><Sub>12</Sub>
<Data>   дерево</Data>
</Node>
<Node><Sub>13</Sub>
<Data></Data>
</Node>
<Node><Sub>14</Sub>
<Data>   Копировать массив в    S TRe1=&quot;^A&quot;,TRe2=&quot;^B&quot; D TRE^%ZAPM.ed.BSTK</Data>
</Node>
<Node><Sub>15</Sub>
<Data>   массив                 S NOKILLER=1,TRe1=&quot;^A&quot;,TRe2=&quot;^B&quot; D TRE^%ZAPM.ed.BSTK</Data>
</Node>
<Node><Sub>16</Sub>
<Data>                           (не удалять @TRe2)</Data>
</Node>
<Node><Sub>17</Sub>
<Data>ИЛИ:</Data>
</Node>
<Node><Sub>18</Sub>
<Data>   КОПИРОВАНИЕ УЗЛА В УЗЕЛ   D Copy^%ZAPM.ed.BSF8(TRe1,TRe2,NOKILLER,S) </Data>
</Node>
<Node><Sub>19</Sub>
<Data>                            ;TRe1 и TRe2 полные глобальные ссылки ... ^A(1,2)</Data>
</Node>
<Node><Sub>20</Sub>
<Data>                            ;S=1 - Выводить счет узлов</Data>
</Node>
<Node><Sub>21</Sub>
<Data>                            ;S=&quot;TEXT&quot; - Выводить TEXT со счетом узлов</Data>
</Node>
<Node><Sub>22</Sub>
<Data>                            ;NOKILLER=1   Неудалять Целевой узел TRe2</Data>
</Node>
<Node><Sub>23</Sub>
<Data>                            ;NOKILLER=&quot;&quot;  УДАЛЯТЬ</Data>
</Node>
<Node><Sub>24</Sub>
<Data>                            ;!!!ЕСЛИ TRe1=Код СИМВОЛА ,КАКИМ ПЕРЕЗАПИСЫВАТЬ</Data>
</Node>
<Node><Sub>25</Sub>
<Data>                            ;      УДАЛЯЕМЫЕ ДАННЫЕ В УЗЛЕ TRe2</Data>
</Node>
<Node><Sub>26</Sub>
<Data>                            ;TRe2=Номер Устройства ВЫВОДА УЗЛОВ TRe1</Data>
</Node>
<Node><Sub>27</Sub>
<Data></Data>
</Node>
<Node><Sub>28</Sub>
<Data></Data>
</Node>
<Node><Sub>29</Sub>
<Data>  Изменение характеристик S %GLB=&quot;^KSP&quot;   -имя массива</Data>
</Node>
<Node><Sub>30</Sub>
<Data>   защиты массива          S %OPT=2        1/2/3/4 -- SYSTEM/WORLD/GROUP/USER</Data>
</Node>
<Node><Sub>31</Sub>
<Data>                           S %B=3          1/2/3/4 -- NONE/READ/RW/RWD</Data>
</Node>
<Node><Sub>32</Sub>
<Data>                           D INT^%ZAPM.ed.BSGCH</Data>
</Node>
<Node><Sub>33</Sub>
<Data></Data>
</Node>
<Node><Sub>34</Sub>
<Data>   Или                     D In^%ZAPM.ed.BSGCH(%GLB,%OPT,%B)-------------------------</Data>
</Node>
<Node><Sub>35</Sub>
<Data>                                                   --------------------     |</Data>
</Node>
<Node><Sub>36</Sub>
<Data>   Смотреть характеристики W $$RP^%ZAPM.ed.BSGCH(&quot;^KSP&quot;)=XXXX   -имя массива  |     |</Data>
</Node>
<Node><Sub>37</Sub>
<Data>   защиты массива                                |--------------      |     |</Data>
</Node>
<Node><Sub>38</Sub>
<Data>                                                 ----- SYSTEM/WORLD/GROUP/USER</Data>
</Node>
<Node><Sub>39</Sub>
<Data>                           XXXX = 1/2/3/4 -- NONE/READ/RW/RWD</Data>
</Node>
<Node><Sub>40</Sub>
<Data>                           XXXX = КОД ОШИБКИ  0 - неопределенная ошибка</Data>
</Node>
<Node><Sub>41</Sub>
<Data>                                             -1 - неверное имя массива</Data>
</Node>
<Node><Sub>42</Sub>
<Data>                                             -2 - неверное имя кипа</Data>
</Node>
<Node><Sub>43</Sub>
<Data>                                             -3 - занято устройство 63</Data>
</Node>
<Node><Sub>44</Sub>
<Data>                                             -4 - массив не найден в кипе</Data>
</Node>
<Node><Sub>45</Sub>
<Data>                                             -5 - отказано в доступе к массиву</Data>
</Node>
<Node><Sub>46</Sub>
<Data>                 например :2314  SYSTEM=READ</Data>
</Node>
<Node><Sub>47</Sub>
<Data>                                 WORLD=R/W</Data>
</Node>
<Node><Sub>48</Sub>
<Data>                                 GROUP=NONE</Data>
</Node>
<Node><Sub>49</Sub>
<Data>                                 USER=RWD</Data>
</Node>
<Node><Sub>50</Sub>
<Data></Data>
</Node>
<Node><Sub>51</Sub>
<Data>   Изменение характеристик     D CP^%ZAPM.ed.BSGCH(&quot;^KSP&quot;,XXXX)</Data>
</Node>
<Node><Sub>52</Sub>
<Data>   защиты массива          </Data>
</Node>
<Node><Sub>53</Sub>
<Data></Data>
</Node>
<Node><Sub>54</Sub>
<Data>   Включить ссылку Мас-</Data>
</Node>
<Node><Sub>55</Sub>
<Data>   сива в таблицу LOCK         S GLO=&quot;^MAS(1,2,3)&quot; D L^%ZAPM.ed.BS3(GLO)</Data>
</Node>
<Node><Sub>56</Sub>
<Data> </Data>
</Node>
<Node><Sub>57</Sub>
<Data>   Выключить ссылку Мас-</Data>
</Node>
<Node><Sub>58</Sub>
<Data>   сива из таблицы LOCK        S GLO=&quot;^MAS(1,2,3)&quot; D U^%ZAPM.ed.BS3(GLO)</Data>
</Node>
<Node><Sub>59</Sub>
<Data></Data>
</Node>
<Node><Sub>60</Sub>
<Data>   Вывод массива на уст-во S TRe1-открытая</Data>
</Node>
<Node><Sub>61</Sub>
<Data>                                  ссылка</Data>
</Node>
<Node><Sub>62</Sub>
<Data>                           S %DEV-номер устр-ва</Data>
</Node>
<Node><Sub>63</Sub>
<Data>                           D TRDEV^%ZAPM.ed.BSTK</Data>
</Node>
<Node><Sub>64</Sub>
<Data></Data>
</Node>
<Node><Sub>65</Sub>
<Data>   X=Действие с Узлом @g    D XGlob^%ZAPM.ed.BSF9(U,X,S)</Data>
</Node>
<Node><Sub>66</Sub>
<Data>   (проход по $ZO)          S=1 - Выводить счет узлов</Data>
</Node>
<Node><Sub>67</Sub>
<Data>                            U=Полная ссылка</Data>
</Node>
<Node><Sub>68</Sub>
<Data>                            X=Действие с Узлом @g</Data>
</Node>
<Node><Sub>69</Sub>
<Data></Data>
</Node>
<Node><Sub>70</Sub>
<Data>   Поиск узла по контексту  D FIND^%ZAPM.ed.BS2(G,S,U,D)</Data>
</Node>
<Node><Sub>71</Sub>
<Data>                            G-МАССИВ        </Data>
</Node>
<Node><Sub>72</Sub>
<Data>   (проход по $O)           S-КОНТЕКСТ</Data>
</Node>
<Node><Sub>73</Sub>
<Data>                            U-НОМЕР УРОВНЯ</Data>
</Node>
<Node><Sub>74</Sub>
<Data>                            D-ДЕЙСТВИЕ ПРИ НАХОЖДЕНИИ  S END=1 - КОНЕЦ ПОИСКА</Data>
</Node>
<Node><Sub>75</Sub>
<Data></Data>
</Node>
<Node><Sub>76</Sub>
<Data>  СЛУЧАЙНАЯ ССЫЛКА          $$TMPG^%ZAPM.ed.BSF11</Data>
</Node>
<Node><Sub>77</Sub>
<Data>  ВРЕМЕННОГО МАССИВА </Data>
</Node>
</Node>
<Node><Sub>D8</Sub>
<Data>Системные Работы@@@@@@@1@1@22@80@@@@1@@5@@@1@@@ 1@@@@@77@@@2;6;36;44///2;6;36;44/2;6;37;44@@@@@@@1</Data>
<Node><Sub>1</Sub>
<Data>8.            ________________________________________________</Data>
</Node>
<Node><Sub>2</Sub>
<Data>···­­­---===========         Системные Работы          =============---­­­···</Data>
</Node>
<Node><Sub>3</Sub>
<Data>              ------------------------------------------------</Data>
</Node>
<Node><Sub>4</Sub>
<Data>ЗАЧИСТКА МУСОРА НА ТЕКУЩЕМ ТОМЕ:    D CLE^%ZAPM.ed.BSD2</Data>
</Node>
<Node><Sub>5</Sub>
<Data>АНАЛОГ WipeInfo ДЛЯ MSM 4.x</Data>
</Node>
<Node><Sub>6</Sub>
<Data></Data>
</Node>
<Node><Sub>7</Sub>
<Data>ЗАПУСК ФОНОВОГО ТЕСТЕРА БД         SERVER^%ZAPM.ed.BSTIMER</Data>
</Node>
<Node><Sub>8</Sub>
<Data>ДЛЯ СЕРВЕРА MSM</Data>
</Node>
<Node><Sub>9</Sub>
<Data>ПАРМЕТРЫ ТАЙМЕРА СМОТРИ В ^%ZAPM.ed.BSS(&quot;TIMER&quot;)</Data>
</Node>
<Node><Sub>10</Sub>
<Data></Data>
</Node>
<Node><Sub>11</Sub>
<Data>D IntSELF^%ZAPM.ed.BSMENU(1) ;АВТОМАТИЧЕСКОЕ ПОВЫШЕНИЕ ВЕРСИИ %BS, ЕСЛИ ТЕКУЩАЯ НИЖЕ</Data>
</Node>
<Node><Sub>12</Sub>
<Data>D IntSELF^%ZAPM.ed.BSMENU(2) ;БЕЗУСЛОВНОЕ АВТОМАТИЧЕСКОЕ ПОВЫШЕНИЕ ВЕРСИИ %BS</Data>
</Node>
<Node><Sub>13</Sub>
<Data>  </Data>
</Node>
<Node><Sub>14</Sub>
<Data>   В КАКОЙ ВЕРСИИ MSM        $$4^%ZAPM.ed.BSD2() =1    ЭТО 4.0.X</Data>
</Node>
<Node><Sub>15</Sub>
<Data>   МЫ НАХОДИМСЯ </Data>
</Node>
<Node><Sub>16</Sub>
<Data></Data>
</Node>
<Node><Sub>17</Sub>
<Data>   Расшиpение памяти pазде- D SIZE^%ZAPM.ed.BSN(KB)   KB - на сколько</Data>
</Node>
<Node><Sub>18</Sub>
<Data>   ла пользователя                                 килобайт увеличить</Data>
</Node>
<Node><Sub>19</Sub>
<Data></Data>
</Node>
<Node><Sub>20</Sub>
<Data></Data>
</Node>
<Node><Sub>21</Sub>
<Data>   Аналог команды NEW        D N^%ZAPM.ed.BSN(P)      P-список локалей</Data>
</Node>
<Node><Sub>22</Sub>
<Data>  с сохранением локалей в     ...              не сохраняемых</Data>
</Node>
<Node><Sub>23</Sub>
<Data>  ^%ZAPM.ed.BSbufB(&quot;AN&quot;_$I_&quot;u&quot;_%nE   D  Q^%ZAPM.ed.BSN(P)     P=&quot;A,CD,%e,...,Z&quot;</Data>
</Node>
<Node><Sub>24</Sub>
<Data></Data>
</Node>
<Node><Sub>25</Sub>
<Data>   Пpовеpить паpоль         D PASCHECK^%ZAPM.ed.BS1(M,T,P,S,V)</Data>
</Node>
<Node><Sub>26</Sub>
<Data>                            ,где M - имя массива                $T,@V</Data>
</Node>
<Node><Sub>27</Sub>
<Data>                                 T - индекс 1-го уpов</Data>
</Node>
<Node><Sub>28</Sub>
<Data>                                 P - номеp $P(...,&quot;@&quot;)</Data>
</Node>
<Node><Sub>29</Sub>
<Data>                                 S=текст</Data>
</Node>
<Node><Sub>30</Sub>
<Data>                                 V-пеpеменная</Data>
</Node>
<Node><Sub>31</Sub>
<Data></Data>
</Node>
<Node><Sub>32</Sub>
<Data>   Установить паpоль        D PASSWORD^%ZAPM.ed.BSF4(M,T,P,S,V)</Data>
</Node>
<Node><Sub>33</Sub>
<Data></Data>
</Node>
<Node><Sub>34</Sub>
<Data>   Открыть Порт с РТА80л    I $$OPN^%ZAPM.ed.BSDDRR(DEV,MOD)=1 Открыт удачно %IO и Т.Д.</Data>
</Node>
<Node><Sub>35</Sub>
<Data>                            MOD=&quot;R&quot; для чтения</Data>
</Node>
<Node><Sub>36</Sub>
<Data>                                &quot;W&quot; для записи</Data>
</Node>
<Node><Sub>37</Sub>
<Data></Data>
</Node>
<Node><Sub>38</Sub>
<Data>   ВЫВЕСТИ НА РТА СТРОКУ    D Write^%ZAPM.ed.BSDDRR(String)</Data>
</Node>
<Node><Sub>39</Sub>
<Data></Data>
</Node>
<Node><Sub>40</Sub>
<Data>   СЧИТАТЬ С РТА СТРОКУ     S A=$$Read^%ZAPM.ed.BSDDRR()</Data>
</Node>
<Node><Sub>41</Sub>
<Data></Data>
</Node>
<Node><Sub>42</Sub>
<Data>   ЗАКРЫТЬ РТА              D EXIT^%ZAPM.ed.BSDDRR</Data>
</Node>
<Node><Sub>43</Sub>
<Data></Data>
</Node>
<Node><Sub>44</Sub>
<Data>   CОЗДАНИЕ ПРИЛОЖЕНИЯ       D GRAPP^%ZAPM.ed.BSZGAP</Data>
</Node>
<Node><Sub>45</Sub>
<Data>   РАБОТАЮЩЕГО ПОД %BS</Data>
</Node>
<Node><Sub>46</Sub>
<Data></Data>
</Node>
<Node><Sub>47</Sub>
<Data>   ВОССТАНОВЛЕНИЕ ПРИЛОЖЕНИЯ D INSTAPP^%ZAPM.ed.BSZGAP(%DEV,%FN)</Data>
</Node>
<Node><Sub>48</Sub>
<Data>   РАБОТАЮЩЕГО ПОД %BS</Data>
</Node>
<Node><Sub>49</Sub>
<Data></Data>
</Node>
<Node><Sub>50</Sub>
<Data>   ЗАКРЫТИЕ СИСТЕМЫ                  D SSD^%ZAPM.ed.BSD2</Data>
</Node>
<Node><Sub>51</Sub>
<Data>ОСТАНОВ ЕСЛИ НЕТ АКТИВНЫХ ЛИНИЙ DDP  D SS^%ZAPM.ed.BSD2</Data>
</Node>
<Node><Sub>52</Sub>
<Data>  ОСТАНОВ БЕЗУСЛОВНЫЙ                D S^%ZAPM.ed.BSD2</Data>
</Node>
<Node><Sub>53</Sub>
<Data></Data>
</Node>
<Node><Sub>54</Sub>
<Data>   УДАЛЕНИЕ ВСЕХ !!! БАЗ ДАННЫХ %BS     D KBD^%ZAPM.ed.BSGLOB</Data>
</Node>
<Node><Sub>55</Sub>
<Data>   </Data>
</Node>
<Node><Sub>56</Sub>
<Data>   ОПРЕДЕЛЕНИЕ ТИПА МАССИВА S Tip=$$TipMass^%ZAPM.ed.BSGLOB(&quot;^MASS&quot;)</Data>
</Node>
<Node><Sub>57</Sub>
<Data>                            Tip=1 - РАЗДЕЛ</Data>
</Node>
<Node><Sub>58</Sub>
<Data>                            Tip=2 - КОДИФИКАТОР</Data>
</Node>
<Node><Sub>59</Sub>
<Data>                            Tip=3 - БАЗА ДАННЫХ</Data>
</Node>
<Node><Sub>60</Sub>
<Data>                            Tip=0 - НЕЗНАКОМЫЙ</Data>
</Node>
<Node><Sub>61</Sub>
<Data>                            </Data>
</Node>
<Node><Sub>62</Sub>
<Data>   ВЫЗОВ НА ВЫПОЛНЕНИЕ      A=0 ;ВЫЗОВ ДОС-ПРОЦЕССА, ЕСЛИ НЕТ DDP</Data>
</Node>
<Node><Sub>63</Sub>
<Data>   ДОС-ПРОЦЕССА для MSM     A=1 ;ВЫЗОВ ДОС-ПРОЦЕССА В ЛЮБОМ СЛУЧАЕ,ЕСЛИ НЕ</Data>
</Node>
<Node><Sub>64</Sub>
<Data>                                 М-СЕРВЕР</Data>
</Node>
<Node><Sub>65</Sub>
<Data>                           S=&quot;ТЕКСТ СООБЩЕНИЯ&quot; ЕСЛИ ddp ВКЛ И ДОС ПРОЦЕСС ВЫКЛ</Data>
</Node>
<Node><Sub>66</Sub>
<Data>                            D EXE^%ZAPM.ed.BSDOS(&quot;MEM.EXE&quot;,A,S)</Data>
</Node>
<Node><Sub>67</Sub>
<Data></Data>
</Node>
<Node><Sub>68</Sub>
<Data>   РАЗМЕР ФАЙЛА В БАЙТАХ    $$SizeFile^%ZAPM.ed.BSDOS2(P)=1/0</Data>
</Node>
<Node><Sub>69</Sub>
<Data>   РАЗРЕШЕННОГО К        P=1 - ПРОСМОТРУ</Data>
</Node>
<Node><Sub>70</Sub>
<Data>                         P=2 - РЕДАКТИРОВАНИЮ</Data>
</Node>
<Node><Sub>71</Sub>
<Data>                         P=3 - УДАЛЕНИЯ</Data>
</Node>
<Node><Sub>72</Sub>
<Data></Data>
</Node>
<Node><Sub>73</Sub>
<Data>   ФЛАГ РАЗРЕШЕНИЯ ДОСТУПА  $$AccesMSM^%ZAPM.ed.BSDOS2(P)=1/0</Data>
</Node>
<Node><Sub>74</Sub>
<Data>   MSM РЕСУРСАМ          P=1 - ПРОСМОТРУ МАССИВОВ И ПРОГРАММ</Data>
</Node>
<Node><Sub>75</Sub>
<Data>                         P=2 - РЕДАКТИРОВАНИЮ МАССИВОВ И ПРОГРАММ</Data>
</Node>
<Node><Sub>76</Sub>
<Data>                         P=3 - УДАЛЕНИЯ МАССИВОВ И ПРОГРАММ</Data>
</Node>
<Node><Sub>77</Sub>
<Data>                         P=4 - УПРАВЛЕНИЕ %BS-СЕРВЕРАМИ</Data>
</Node>
</Node>
<Node><Sub>D9</Sub>
<Data><![CDATA[Полезные,Часто нужные штучки@@@@@@@1@1@22@80@@@@1@@5@@@1@@@ 1@@@@@16@@@2;6;36;44///2;6;36;44/2;6;37;44@@@@@@@1]]></Data>
<Node><Sub>1</Sub>
<Data>9.            ________________________________________________</Data>
</Node>
<Node><Sub>2</Sub>
<Data>···­­­---===========   Полезные,Часто нужные штучки    =============---­­­···</Data>
</Node>
<Node><Sub>3</Sub>
<Data>              ------------------------------------------------</Data>
</Node>
<Node><Sub>4</Sub>
<Data>МОДУЛЬ ЛОВУШКИ       S %zT=$ZT,$ZT=&quot;ER^%ZAPM.ed.BS...&quot;</Data>
</Node>
<Node><Sub>5</Sub>
<Data>                        ...</Data>
</Node>
<Node><Sub>6</Sub>
<Data>                  ER D ErrMsg^%ZAPM.ed.BSXfun($ZE_&quot; &quot;_$$ErrSay^%ZAPM.ed.BSF8($ZE)) S $ZT=$G(%zT) Q</Data>
</Node>
<Node><Sub>7</Sub>
<Data></Data>
</Node>
<Node><Sub>8</Sub>
<Data>ПРОГРАММНАЯ ЛОВУШКА  D x^%ZAPM.ed.BS3(1)     ;---//--- для msm 4.x.x</Data>
</Node>
<Node><Sub>9</Sub>
<Data>                     W /x(1)         ;---//--- для msm 3.x.x</Data>
</Node>
<Node><Sub>10</Sub>
<Data></Data>
</Node>
<Node><Sub>11</Sub>
<Data>ВРЕМЯ РАБОТЫ         T^%ZAPM.ed.BSF12        S TmpTime=$P($H,&quot;,&quot;,2) ;НАЧАЛО</Data>
</Node>
<Node><Sub>12</Sub>
<Data><![CDATA[МОДУЛЯ               Ti^%ZAPM.ed.BSF12       S TmpTime=$P($H,",",2)-TmpTime D OkMsg^%ZAPM.ed.BSXfun("Работало "_(TmpTime/60)_" Мин.")]]></Data>
</Node>
<Node><Sub>13</Sub>
<Data></Data>
</Node>
<Node><Sub>14</Sub>
<Data>ВХОД В РЕДАКТОР ГЛОБАЛИ   D ^%ZAPM.ed.BSMSMG(&quot;^A(1,2,3)&quot;)</Data>
</Node>
<Node><Sub>15</Sub>
<Data></Data>
</Node>
<Node><Sub>16</Sub>
<Data>ВЫВОД ПРОГРАММ И МАССИВОВ КАЖДОГО КИПА     D RGDOUT^%ZAPM.ed.BSF9</Data>
</Node>
</Node>
<Node><Sub>DFLT</Sub>
<Data>помощь@@@@@@@7@10@15@60@@@@1@@5@@@1@@@ 1@@@@@13@@@2;6;36;44///2;6;36;44/2;6;37;44@@@@@@@1</Data>
<Node><Sub>1</Sub>
<Data></Data>
</Node>
<Node><Sub>2</Sub>
<Data></Data>
</Node>
<Node><Sub>3</Sub>
<Data>  Что бы вернуть исходное значение по-умолчанию,</Data>
</Node>
<Node><Sub>4</Sub>
<Data>               нажмите &lt;Enter&gt;.</Data>
</Node>
<Node><Sub>5</Sub>
<Data></Data>
</Node>
<Node><Sub>6</Sub>
<Data></Data>
</Node>
<Node><Sub>7</Sub>
<Data></Data>
</Node>
<Node><Sub>8</Sub>
<Data></Data>
</Node>
<Node><Sub>9</Sub>
<Data></Data>
</Node>
<Node><Sub>10</Sub>
<Data></Data>
</Node>
<Node><Sub>11</Sub>
<Data></Data>
</Node>
<Node><Sub>12</Sub>
<Data></Data>
</Node>
<Node><Sub>13</Sub>
<Data></Data>
</Node>
</Node>
<Node><Sub>DIRHELP</Sub>
<Data><![CDATA[помощь для выборки@@@@@@@5@10@17@70@@@@1@@5@@@1@@@ 1@@@@@12@@@2;6;36;44///2;6;36;44/2;6;37;44@@@@@@@1]]></Data>
<Node><Sub>1</Sub>
<Data></Data>
</Node>
<Node><Sub>2</Sub>
<Data>     ВЫБЕРИТЕ КЛАВИШЕЙ &lt;INSERT&gt; ОБЪЕКТЫ ДЛЯ ВКЛЮЧЕНИЯ</Data>
</Node>
<Node><Sub>3</Sub>
<Data>                        В СПИСОК</Data>
</Node>
<Node><Sub>4</Sub>
<Data></Data>
</Node>
<Node><Sub>5</Sub>
<Data>         И ... НАОБОРОТ</Data>
</Node>
<Node><Sub>6</Sub>
<Data></Data>
</Node>
<Node><Sub>7</Sub>
<Data></Data>
</Node>
<Node><Sub>8</Sub>
<Data></Data>
</Node>
<Node><Sub>9</Sub>
<Data></Data>
</Node>
<Node><Sub>10</Sub>
<Data></Data>
</Node>
<Node><Sub>11</Sub>
<Data></Data>
</Node>
<Node><Sub>12</Sub>
<Data></Data>
</Node>
</Node>
<Node><Sub>DOC_TAB</Sub>
<Data><![CDATA[описание стpуктуpы pазделов и таблиц@@@@@@@1@1@22@80@@@@1@@5@@@1@@@@@@@@600@@@2;6;36;44///2;6;36;44/2;6;37;44@@@@@@@1]]></Data>
<Node><Sub>1</Sub>
<Data>1.            ________________________________________________</Data>
</Node>
<Node><Sub>2</Sub>
<Data>···­­­---===========   ОПИСАНИЕ ЗАГОЛОВКА РАЗДЕЛА %BS   =============---­­­···</Data>
</Node>
<Node><Sub>3</Sub>
<Data>              ------------------------------------------------</Data>
</Node>
<Node><Sub>4</Sub>
<Data> BSR - РАЗДЕЛ ТАБЛИЦ ^BSR=&quot;BaSe MsW @ КОМЕНТАРИЙ @S@ ПАРОЛЬ КОРРЕКЦИИ ХАР-К@X@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>                            1         2           3    4                    5</Data>
</Node>
<Node><Sub>6</Sub>
<Data>                      S=&quot;&amp;&quot; - РАЗДЕЛ СКРЫТЫЙ  (СМ ПРИЛОЖЕНИЕ 1 п 5.)</Data>
</Node>
<Node><Sub>7</Sub>
<Data>                      BST - ИМЯ ТАБЛИЦЫ В РАЗДЕЛЕ</Data>
</Node>
<Node><Sub>8</Sub>
<Data>                      X - ИМЯ ПОЛЬЗОВАТЕЛЯ СОЗДАВШЕГО РАЗДЕЛ</Data>
</Node>
<Node><Sub>9</Sub>
<Data></Data>
</Node>
<Node><Sub>10</Sub>
<Data>2.            ________________________________________________</Data>
</Node>
<Node><Sub>11</Sub>
<Data>···­­­---===========  ОПИСАНИЕ СТРУКТУРЫ ТАБЛИЦЫ %BS    =============---­­­···</Data>
</Node>
<Node><Sub>12</Sub>
<Data>              ------------------------------------------------</Data>
</Node>
<Node><Sub>13</Sub>
<Data></Data>
</Node>
<Node><Sub>14</Sub>
<Data> ^BSR(BST)=...   ЕСЛИ  $E(BST,1)=&quot;&amp;&quot; - ТАБЛИЦА СКРЫТАЯ (СМ ПРИЛОЖЕНИЕ 1 п 5.)</Data>
</Node>
<Node><Sub>15</Sub>
<Data> &quot;КОМ@P1@P0@P2@P3@P5@P4@BSY1@BSX1@BSY2@BSX2@M23@M24@M25@FK@Z@ТИП@V@T@ C@VS @O.</Data>
</Node>
<Node><Sub>16</Sub>
<Data>   1  2  3  4  5  6  7  8    9    10   11   12  13  14 15 16 17 18 19 20 21 22</Data>
</Node>
<Node><Sub>17</Sub>
<Data> ...@ST@PZ@CU@RE@LO@se@ke@OPN@CLR@FS@LS ZA LL SO HF RA F1 PF PK HI UK PO PD OB</Data>
</Node>
<Node><Sub>18</Sub>
<Data>     23 24 25 26 27 28 29 30  31  32 33 34 35 36 37 38 39 40 41 42 43 44 45 46</Data>
</Node>
<Node><Sub>19</Sub>
<Data> ...@fo@VL@CM@TP@PP</Data>
</Node>
<Node><Sub>20</Sub>
<Data>     47 48 49 50 51</Data>
</Node>
<Node><Sub>21</Sub>
<Data>   1   КОМ - КОМЕНТАРИЙ К ТАБЛИЦЕ</Data>
</Node>
<Node><Sub>22</Sub>
<Data>   2   P1 - ПАРОЛЬ НА ВХОД В ТАБЛИЦУ</Data>
</Node>
<Node><Sub>23</Sub>
<Data> * 3   P0 = 1 - В ТАБЛИЦЕ ЕСТЬ ПОМЕЧЕННЫЙ БЛОК (ИЛИ КОЛ-ВО ПОМЕЧЕННЫХ КЛЕТОК)</Data>
</Node>
<Node><Sub>24</Sub>
<Data>   4   P2 - ПАРОЛЬ НА КОРРЕКЦИЮ ОПИСАНИЯ ТАБЛИЦЫ</Data>
</Node>
<Node><Sub>25</Sub>
<Data>   5   P3 - ПАРОЛЬ НА КОРРЕКЦИЮ ДАННЫХ ТАБЛИЦЫ</Data>
</Node>
<Node><Sub>26</Sub>
<Data> * 7   P4 = 1 - БЫЛА КОРРЕКЦИЯ ОПИСАНИЯ ТАБЛИЦЫ</Data>
</Node>
<Node><Sub>27</Sub>
<Data> * 6   P5 = 1 - БЫЛА КОРРЕКЦИЯ ДАННЫХ ТАБЛИЦЫ</Data>
</Node>
<Node><Sub>28</Sub>
<Data>   8   BSY1    \</Data>
</Node>
<Node><Sub>29</Sub>
<Data>   9   BSX1     \  ГРАНИЧНЫЕ КООРДИНАТЫ</Data>
</Node>
<Node><Sub>30</Sub>
<Data>   10  BSY2     /        ТАБЛИЦЫ</Data>
</Node>
<Node><Sub>31</Sub>
<Data>   11  BSX2    /</Data>
</Node>
<Node><Sub>32</Sub>
<Data> * 12  MR23 =1 - ИНФОРМАЦИЯ ПО КЛЕТКЕ В 23 СЛУЖЕБНОЙ СТРОКЕ</Data>
</Node>
<Node><Sub>33</Sub>
<Data>             X =(СМ MR25)</Data>
</Node>
<Node><Sub>34</Sub>
<Data> * 13  MR24 =1 -   -----//----          24  ----//----</Data>
</Node>
<Node><Sub>35</Sub>
<Data>             X =(СМ MR25)</Data>
</Node>
<Node><Sub>36</Sub>
<Data> * 14  MR25 =1 -   -----//-----         25  ----//----</Data>
</Node>
<Node><Sub>37</Sub>
<Data>             X =КОМАНДА ПОЛЬЗОВАТЕЛЯ ПЕРЕД ЗАСВЕТКОЙ ТЕКУЩЕЙ КЛЕТКИ</Data>
</Node>
<Node><Sub>38</Sub>
<Data>               (СМОТРИ ПРИМЕР :UCI+7^%ZAPM.ed.BS)</Data>
</Node>
<Node><Sub>39</Sub>
<Data>   15  FK   =1 - ФУНКЦИАНАЛЬНЫЕ КЛАВИШИ ВКЛЮЧЕНЫ И ОБРАБАТЫВАЮТСЯ СТАНДАРТНО.</Data>
</Node>
<Node><Sub>40</Sub>
<Data>            =LAB^ROU -ССЫЛКА НА ПРОГРАММУ НЕСТАНДАРТНОЙ ОБРАБОТКИ F-КЛАВИШ</Data>
</Node>
<Node><Sub>41</Sub>
<Data>              ,ГДЕ    LAB ;...R1=27,R2=79,R3=КОД ФУНКЦИАНАЛЬНОЙ КЛАВИШИ</Data>
</Node>
<Node><Sub>42</Sub>
<Data>                          ;...ny-НОМЕР СТРОКИ КЛЕТКИ,nx-НОМЕР КОЛОНКИ,d-ДАННЫЕ</Data>
</Node>
<Node><Sub>43</Sub>
<Data>                          G 0^%ZAPM.ed.BSTM ;КОРРЕКТНЫЙ ВОЗВРАТ</Data>
</Node>
<Node><Sub>44</Sub>
<Data>               (СМОТРИ ПРИМЕР :TAB+5^%ZAPM.ed.BS)</Data>
</Node>
<Node><Sub>45</Sub>
<Data>   16  Z=1  - ЗАЩИТА ВСЕЙ ТАБЛИЦЫ ОТ КОРРЕКЦИИ ВКЛЮЧЕНА $D(%ZAP)</Data>
</Node>
<Node><Sub>46</Sub>
<Data>   17  ТИП -ТИП  =1 - ТАБЛИЦА БЕЗ БАЗЫ ДАННЫХ (САМА ПО СЕБЕ) (ПО УМОЛЧАНИЮ)</Data>
</Node>
<Node><Sub>47</Sub>
<Data>                  2 - --//-- С БАЗОЙ ДАННЫХ (ОПИСАНИЕ БАЗ В ^BSR(BST,&quot;KEY&quot;)</Data>
</Node>
<Node><Sub>48</Sub>
<Data>                  3 - ТАБЛИЦА-СПИСОК</Data>
</Node>
<Node><Sub>49</Sub>
<Data>                  4 - ТАБЛИЦА-СВОДКА</Data>
</Node>
<Node><Sub>50</Sub>
<Data>                  5 - ТЕКСТ</Data>
</Node>
<Node><Sub>51</Sub>
<Data>                  6 - ЛИНК - ЗАГРУЗКА ДРУГОЙ ТАБЛИЦЫ С ПАРАМЕТРАМИ</Data>
</Node>
<Node><Sub>52</Sub>
<Data>                  7 - МЕНЮ ПОЛЬЗОВАТЕЛЯ</Data>
</Node>
<Node><Sub>53</Sub>
<Data>                  8 - ПАНЕЛЬ С КНОПКАМИ</Data>
</Node>
<Node><Sub>54</Sub>
<Data>                  9 - </Data>
</Node>
<Node><Sub>55</Sub>
<Data>                 10 - </Data>
</Node>
<Node><Sub>56</Sub>
<Data>                 11 - </Data>
</Node>
<Node><Sub>57</Sub>
<Data>   18  V = 1 -ПОРЯДОК ВЫЧИСЛЕНИЙ (ПО УМОЛЧАНИЮ СЛЕВО-НАПРАВО,СВЕРХУ-ВНИЗ)</Data>
</Node>
<Node><Sub>58</Sub>
<Data>           2 - СЛЕВО-НАПРАВО СНИЗУ-ВВЕРХ</Data>
</Node>
<Node><Sub>59</Sub>
<Data>           3 - СПРАВО-НАЛЕВО СВЕРХУ-ВНИЗ</Data>
</Node>
<Node><Sub>60</Sub>
<Data>           4 - СПРАВО-НАЛЕВО СНИЗУ-ВВЕРХ</Data>
</Node>
<Node><Sub>61</Sub>
<Data>   19  T=&quot;i,j&quot; - КЛЕТКА УСТАНОВКИ ТИТУЛА</Data>
</Node>
<Node><Sub>62</Sub>
<Data>   20  C=1  - ВЫЧИСЛЕНИЯ ПРОИЗВОДЯТСЯ ПОСТОЯННО</Data>
</Node>
<Node><Sub>63</Sub>
<Data>       C=&quot;&quot; - ТОЛЬКО ПО КОМАНДЕ F6</Data>
</Node>
<Node><Sub>64</Sub>
<Data>       C=2  - ПРОИЗВОДЯТСЯ ПОСТОЯННО, НО НЕ ДЕЛАТЬ ПРИ ВЫХОДЕ ИЗ ТАБЛИЦЫ</Data>
</Node>
<Node><Sub>65</Sub>
<Data> * 21  VS=1 -ВКЛЮЧЕН ВИДЕО-СТАТУС (УЖЕ НЕ ИСПОЛЬЗУЕТСЯ!!!!!!!)</Data>
</Node>
<Node><Sub>66</Sub>
<Data>   22  O=1 - ТАБЛИЦА БЫЛА ОПТИМИЗИРОВАНА</Data>
</Node>
<Node><Sub>67</Sub>
<Data>   23  ST=1 ВЫКЛЮЧЕН СТАТУС</Data>
</Node>
<Node><Sub>68</Sub>
<Data> * 24  PZ=&quot;S&quot;-ЭТО СПИСОК ,PZ=1 -ПОДЖАТА</Data>
</Node>
<Node><Sub>69</Sub>
<Data> * 25  CU=1 КУРСОР В ТЕКУЩЕЙ КЛЕТКЕ</Data>
</Node>
<Node><Sub>70</Sub>
<Data> * 26  RE=&quot;&quot; РЕДАКТИРОВАНИЕ ПРОИСХОДИТ В ТЕКУЩЕЙ КЛЕТКЕ</Data>
</Node>
<Node><Sub>71</Sub>
<Data>       RE=1  РЕДАКТИРОВАНИЕ ПРОИСХОДИТ В СТРОЧНОМ РЕДАКТОРЕ</Data>
</Node>
<Node><Sub>72</Sub>
<Data>   27  LO=1 ЛОГИЧЕСКИЙ КОНТРОЛЬ ВЫКЛЮЧЕН</Data>
</Node>
<Node><Sub>73</Sub>
<Data>   28  se - КОЛ-ВО СТРОК В ТАБЛИЦЕ</Data>
</Node>
<Node><Sub>74</Sub>
<Data>   29  ke - КОЛ-ВО СТОЛБЦОВ В ТАБЛИЦЕ</Data>
</Node>
<Node><Sub>75</Sub>
<Data>   30  OPN=&quot;&quot; - ТАБЛИЦА ОТКРЫТА</Data>
</Node>
<Node><Sub>76</Sub>
<Data>          =&quot;SYS&quot;_$I_&quot;i&quot;_ИМЯ - ИНФОРМАЦИЯ О ТОМ,КТО ЗАКРЫЛ ТАБЛИЦУ</Data>
</Node>
<Node><Sub>77</Sub>
<Data>   31  CLR - ЦВЕТ ВСЕЙ ТАБЛИЦЫ</Data>
</Node>
<Node><Sub>78</Sub>
<Data>   32  FS - В ФОРМ.ВЫЧ. ЕСТЬ ССЫЛКИ НА ДРУГИЕ ФОРМУЛЫ ВЫЧИСЛЕНИЯ</Data>
</Node>
<Node><Sub>79</Sub>
<Data>   33  LS - В ФОРМ.ЛОГ. ЕСТЬ ССЫЛКИ НА ДРУГИЕ ФОРМУЛЫ ЛОГИЧЕСКОГО КОНТРОЛЯ</Data>
</Node>
<Node><Sub>80</Sub>
<Data> * 34  ZA = 1 -ТАБЛИЦУ НЕ ЗАКРЫВАТЬ</Data>
</Node>
<Node><Sub>81</Sub>
<Data>   35  LL =&quot;&quot;  -  СПИСОК ЛОГИЧЕСКИХ ОШИБОК СТАНДАРТНЫЙ</Data>
</Node>
<Node><Sub>82</Sub>
<Data>          =2,3 - ФОРМИРОВАТЬ СПИСОК ЛОГИЧЕСКИХ ОШИБОК С СИМВ.ИМЕНАМИ НА ВЫВОД,</Data>
</Node>
<Node><Sub>83</Sub>
<Data>                 и в 1 колонке списка выводить данные из 2,3 колоки списка</Data>
</Node>
<Node><Sub>84</Sub>
<Data> * 36  SO =A,B,C,D  A - С КАКОЙ СТРОКИ СОРТИРОВАТЬ   B - ШАГ СОРТИРОВКИ</Data>
</Node>
<Node><Sub>85</Sub>
<Data>      C=1 СОРТИРОВАТЬ ПО УБЫВАНИЮ D=&quot;N!N1!N3!&quot; - ПО КАКОЙ КОЛОНКЕ СОРТИРОВАТЬ</Data>
</Node>
<Node><Sub>86</Sub>
<Data>      (ДЛЯ СПИСКА ЭТОТ ПАРАМЕТР, ВКЛЮЧАЕТ АВТОСОРТИРОВКУ)</Data>
</Node>
<Node><Sub>87</Sub>
<Data>   37  HF =1 ЕСТЬ ССЫЛКИ НА HFS НА ЛОКАЛЬНЫХ ПРИВОДАХ ^BSR(BST,&quot;HVL&quot;,&quot;VOL&quot;)=HF</Data>
</Node>
<Node><Sub>88</Sub>
<Data>   38  RA =1 ОДИНАРНАЯ РАМКА  2 ДВОЙНАЯ РАМКА  $C(...) РАМКА КОДОМ</Data>
</Node>
<Node><Sub>89</Sub>
<Data>   39  F1 = НЕСТАНДАРТНЫЙ HELP ДЛЯ ВСЕЙ ТАБЛИЦЫ</Data>
</Node>
<Node><Sub>90</Sub>
<Data>   40  PF =1 ВКЛЮЧЕН РЕЖИМ ПРОСМОТРА И КОРРЕКЦИИ</Data>
</Node>
<Node><Sub>91</Sub>
<Data>   41  PK =ПРЕДОБРАБОТКА КЛАВИШ  D @PK (СМ.ВЫЗОВЫ ТЕКСТОВОГО ПРОЦЕССОРА)</Data>
</Node>
<Node><Sub>92</Sub>
<Data>   42  HI =1 - ТАБЛИЦА СКРЫТА</Data>
</Node>
<Node><Sub>93</Sub>
<Data> * 43  UK =1 УКАЗАТЕЛЬ ТОЛЬКО В КЛЕТКАХ РАЗРЕШЕННЫХ К КОРРЕКЦИИ</Data>
</Node>
<Node><Sub>94</Sub>
<Data> * 44  PO  ПОСТДВИЖЕНИЕ УКАЗАТЕЛЯ =&quot;&quot; ОБЩЕСИСТЕМНОЕ</Data>
</Node>
<Node><Sub>95</Sub>
<Data>           ПОСЛЕ РЕДАКТИРОВАНИЯ   =0  НЕТ</Data>
</Node>
<Node><Sub>96</Sub>
<Data>                                  =1  ВНИЗ</Data>
</Node>
<Node><Sub>97</Sub>
<Data>                                  =2  ПРАВО</Data>
</Node>
<Node><Sub>98</Sub>
<Data>    45  PD =1 НЕ ПОДТВЕРЖДАТЬ ЗАПИСЬ В БАЗУ ДАННЫХ</Data>
</Node>
<Node><Sub>99</Sub>
<Data>    46  OB ССЫЛКА НА ТЕКСТ ОБОЕВ ТАБЛИЦЫ</Data>
</Node>
<Node><Sub>100</Sub>
<Data>    47  fo=1 проверять формат представления данных в насчитанных списках и</Data>
</Node>
<Node><Sub>101</Sub>
<Data>        сводках. Если длины данных в некоторых клетках выходят за предел</Data>
</Node>
<Node><Sub>102</Sub>
<Data>        (длина*высота) таблиц, то эти клетки помечаются и задаются вопрос об</Data>
</Node>
<Node><Sub>103</Sub>
<Data>        автоматической раздвижке колонок.</Data>
</Node>
<Node><Sub>104</Sub>
<Data>    48  VL=AB</Data>
</Node>
<Node><Sub>105</Sub>
<Data>          A=1 Вычислять значения КЛЕТОК, если ЛОГИЧЕСКИЙ КОНТРОЛЬ НЕ ПРОШЕЛ</Data>
</Node>
<Node><Sub>106</Sub>
<Data>          A=0 НЕ ВЫЧИСЛЯТЬ ...</Data>
</Node>
<Node><Sub>107</Sub>
<Data>          B=0 - ПРЕДЛАГАТЬ ПОСМОТРЕТЬ ПЕРЕЧЕНЬ ОШИБОК ЛОГ.КОНТРОЛЯ</Data>
</Node>
<Node><Sub>108</Sub>
<Data>          B=1 - НЕ ПРЕДЛАГАТЬ ...</Data>
</Node>
<Node><Sub>109</Sub>
<Data>    49  CM=1 ТЕКСТ КОМЕНТАРИЯ ВСТАВЛЯТЬ В ВОПРОС О ЗАПИСИ КОРРЕКЦИИ В БД</Data>
</Node>
<Node><Sub>110</Sub>
<Data>    50  TP=&quot;y,x&quot; ТИТУЛ ТОЛКО ДЛЯ ПЕЧАТИ</Data>
</Node>
<Node><Sub>111</Sub>
<Data>    51  PP=A,B,C,D      ПАРАМЕТРЫ ПОДЖАТИЯ ДЛЯ СВОДОК (PRESSCFG^%ZAPM.ed.BSSR)</Data>
</Node>
<Node><Sub>112</Sub>
<Data>        ( Разделитель по &apos;строкам,колонкам\ТитулY,X&quot;)</Data>
</Node>
<Node><Sub>113</Sub>
<Data>                             A        B         C D</Data>
</Node>
<Node><Sub>114</Sub>
<Data>    52  PЕЗЕРВ !!! ФЛАГ=Y2000</Data>
</Node>
<Node><Sub>115</Sub>
<Data> *  Помеченны пункты,которые в ТЕКСТАХ используются по другому</Data>
</Node>
<Node><Sub>116</Sub>
<Data>    СМ док по ТЕКСТОВОМУ ПРОЦЕССОРУ</Data>
</Node>
<Node><Sub>117</Sub>
<Data></Data>
</Node>
<Node><Sub>118</Sub>
<Data>    ^BSR(BST,1,1)=...</Data>
</Node>
<Node><Sub>119</Sub>
<Data>    ^BSR(BST,1,2)=...</Data>
</Node>
<Node><Sub>120</Sub>
<Data>          ...      1   2   3    4    5   6   7    8    9   10  11 12  13   14</Data>
</Node>
<Node><Sub>121</Sub>
<Data>    ^BSR(BST,i,j)=&quot;Y @ X @ LY @ LX @ K @ W @ FC @ FT @ B @ S @ F @ M @ LC @ G</Data>
</Node>
<Node><Sub>122</Sub>
<Data></Data>
</Node>
<Node><Sub>123</Sub>
<Data>              15  16  17   18   19  20  21</Data>
</Node>
<Node><Sub>124</Sub>
<Data>            @ D @ R @ ??? @ N @ RES F1 WIN</Data>
</Node>
<Node><Sub>125</Sub>
<Data>  1  Y  - АБСОЛЮТНАЯ КООРДИНАТА КЛЕТКИ {i,j} ПО Y</Data>
</Node>
<Node><Sub>126</Sub>
<Data>  2  X  -              --//-- ПО X</Data>
</Node>
<Node><Sub>127</Sub>
<Data>  3  LY - ВЫСОТА КЛЕТКИ</Data>
</Node>
<Node><Sub>128</Sub>
<Data>  4  LX - ДЛИНА КЛЕТКИ</Data>
</Node>
<Node><Sub>129</Sub>
<Data>  5  K  = 1 - ЗАПРЕЩЕНА КОРРЕКЦИЯ КЛЕТКИ</Data>
</Node>
<Node><Sub>130</Sub>
<Data>  6  W  -  НОМЕР ПОЛЯ В СТРУКТУРЕ DBF</Data>
</Node>
<Node><Sub>131</Sub>
<Data>  7  FC = 1 - ЕСТЬ ФУНКЦИЯ ВЫЧИСЛЕНИЯ</Data>
</Node>
<Node><Sub>132</Sub>
<Data>          2 или 3 - функции генерирующие список / сводку</Data>
</Node>
<Node><Sub>133</Sub>
<Data>          &quot;i,j&quot; - ССЫЛКА НА ФВ ДРУГОЙ КЛЕТКИ</Data>
</Node>
<Node><Sub>134</Sub>
<Data>  8  FT = &quot;0&quot; - ЕСТЬ ФУНКЦИЯ ТРАНСФОРМАЦИИ</Data>
</Node>
<Node><Sub>135</Sub>
<Data>          &quot;i,j&quot; - ССЫЛКА НА ФТ ДРУГОЙ КЛЕТКИ</Data>
</Node>
<Node><Sub>136</Sub>
<Data>  9  B  = 1 - СОДЕРЖАНИЕ КЛЕТКИ ХРАНИТСЯ В ОПИСАНИИ ТАБЛИЦЫ,B=2 - В Б.ДАННЫХ</Data>
</Node>
<Node><Sub>137</Sub>
<Data>  10 S  - МИГАНИЕ;ЦВЕТ СИМВОЛА КЛЕТКИ;ЦВЕТ ФОНА</Data>
</Node>
<Node><Sub>138</Sub>
<Data>  11 F  - 1 - ЛОГИЧЕСКИЙ КОНТРОЛЬ НЕ ПРОШЕЛ</Data>
</Node>
<Node><Sub>139</Sub>
<Data>  15 D  - САМО СОДЕРЖАНИЕ КЛЕТКИ ,ЕСЛИ B=1 ($L(D)&lt;130)</Data>
</Node>
<Node><Sub>140</Sub>
<Data>  12 M  = 1 КЛЕТКА В ПОМЕЧЕНA B БЛОКЕ</Data>
</Node>
<Node><Sub>141</Sub>
<Data>  13 LC = &quot;0&quot; - ЕСТЬ ЛОГИЧЕСКИЙ КОНТРОЛЬ</Data>
</Node>
<Node><Sub>142</Sub>
<Data>          &quot;i,j&quot; - ССЫЛКА НА ЛОГИЧЕСКИЙ КОНТРОЛЬ ДРУГОЙ КЛЕТКИ</Data>
</Node>
<Node><Sub>143</Sub>
<Data>  14 G  - =ПОЛНАЯ ССЫЛКА НА ТАБЛИЦУ ПО &lt;Enter&gt;</Data>
</Node>
<Node><Sub>144</Sub>
<Data>          =0 - СУЩЕСТВУЕТ КОМАНДА В  ^BSR(BST,&quot;CMD&quot;,i,j)=КОМАНДА MUMPS</Data>
</Node>
<Node><Sub>145</Sub>
<Data>          =i,j - КОМАНДА В ДРУГОЙ КЛЕТКЕ</Data>
</Node>
<Node><Sub>146</Sub>
<Data>  16 R  = 0 - ЕСТЬ СИНТАКСИЧЕСКИЙ КОНТРОЛЬ НА ВВОД</Data>
</Node>
<Node><Sub>147</Sub>
<Data>          &quot;i,j&quot; - ССЫЛКА НА СИНТ.В ДРУГОЙ КЛЕТКЕ</Data>
</Node>
<Node><Sub>148</Sub>
<Data>  17    описание текст ключа (Сache&apos;Object only)</Data>
</Node>
<Node><Sub>149</Sub>
<Data>  18 N  = 1#2#3#4#5  , ГДЕ</Data>
</Node>
<Node><Sub>150</Sub>
<Data>              1=СИМВОЛЬНОЕ_ИМЯ_ХРАНЕНИЯ_В_БД</Data>
</Node>
<Node><Sub>151</Sub>
<Data>           2=ИМЯ_ВЫВОДА_ДАННЫХ</Data>
</Node>
<Node><Sub>152</Sub>
<Data>        3=ССЫЛКА НА КЛЕТКУ, ГДЕ ЛЕЖИТ ФОРМУЛА ВЫЧИСЛЕНИЯ,ИЗМЕНЯЮЩЯЯ ДАННЫЕ ДЛЯ</Data>
</Node>
<Node><Sub>153</Sub>
<Data>          ВЫВОДА В ФОРМАТЕ ПЕРФОЛЕНТЫ (---=ФФФФФ=ДАТ11111=...=++++)</Data>
</Node>
<Node><Sub>154</Sub>
<Data>        4=1 ПРИ СУММИРОВАНИИ ИЛИ ВЫЧИТАНИЯ УЗЛОВ БД, ЭТА КЛЕТКА НЕ ОБРАБАТЫВАЕТСЯ</Data>
</Node>
<Node><Sub>155</Sub>
<Data>        5=ТЕКСТ ПРИГЛАШЕНИЯ ВВОДА ДАННЫХ В ПОЛЕ. (ТЕРМИНАЛЬНЫЙ РЕЖИМ)</Data>
</Node>
<Node><Sub>156</Sub>
<Data>  19 RES - РЕЗЕРВ</Data>
</Node>
<Node><Sub>157</Sub>
<Data>  20 F1 = НЕСТАНДАРТНЫЙ HELP ДЛЯ КЛЕТКИ</Data>
</Node>
<Node><Sub>158</Sub>
<Data>  21 WIN - РАЗМЕРЫ Y,X ОКНА РЕДАКТИРОВАНИЯ КЛЕТКИ</Data>
</Node>
<Node><Sub>159</Sub>
<Data></Data>
</Node>
<Node><Sub>160</Sub>
<Data>    ^BSR(BST,&quot;FTR&quot;,i,j)=ФУНКЦИЯ ТРАНСФОРМАЦИИ...ВЫПОЛН.ТЕКСТ</Data>
</Node>
<Node><Sub>161</Sub>
<Data>                   i,j,1)=ИСХОДНЫЙ ТЕКСТ</Data>
</Node>
<Node><Sub>162</Sub>
<Data>    ^BSR(BST,&quot;FCL&quot;,i,j)=ФОРМУЛА ВЫЧИСЛЕНИЯ ДЛЯ {i,j}...ВЫПОЛН.ТЕКСТ</Data>
</Node>
<Node><Sub>163</Sub>
<Data>                   i,j,1)=ИСХОДНЫЙ ТЕКСТ</Data>
</Node>
<Node><Sub>164</Sub>
<Data>    ^BSR(BST,&quot;COL&quot;,i,j)=ФОРМУЛА ЛОГИЧЕСКОГО КОНТРОЛЯ...ВЫПОЛН.ТЕКСТ</Data>
</Node>
<Node><Sub>165</Sub>
<Data>                   i,j,1)=ИСХ.ТЕКСТ</Data>
</Node>
<Node><Sub>166</Sub>
<Data>    ^BSR(BST,&quot;RTR&quot;,i,j)=СИНТАКСИЧЕСКИЙ КОНТРОЛЬ НА ВВОД</Data>
</Node>
<Node><Sub>167</Sub>
<Data>                   i,j,1)=ИСХ.ТЕКСТ</Data>
</Node>
<Node><Sub>168</Sub>
<Data></Data>
</Node>
<Node><Sub>169</Sub>
<Data>  ^BSR(BST,&quot;KEY&quot;)=^BASEDATE [@^PAR,TAB]  - БАЗА ДАННЫХ ДЛЯ ТАБЛИЦЫ</Data>
</Node>
<Node><Sub>170</Sub>
<Data>                 1   2  3 4  5    6   7   10  12 13 14  15 16  20</Data>
</Node>
<Node><Sub>171</Sub>
<Data>                      2:1:6,10,12:1:16,20,22 S $P(@$ZR,&quot;@&quot;,k)=@(&quot;k&quot;_k)</Data>
</Node>
<Node><Sub>172</Sub>
<Data>^BSR(BST,&quot;KEY&quot;,0)=NZ@TN@...@KZ@NEW@YX@TT@@TV@KC@@TK@LC@TAB@KT@RT -ИМЕННОЙ КЛЮЧ</Data>
</Node>
<Node><Sub>173</Sub>
<Data>^BSR(BST,&quot;KEY&quot;,1)=NZ@TN@...@KZ@@YX@... - 1-Й ИНДЕКСНЫЙ КЛЮЧ</Data>
</Node>
<Node><Sub>174</Sub>
<Data>^BSR(BST,&quot;KEY&quot;,2)=NZ@TN@...@KZ@@YX@... - 2-Й ИНДЕКСНЫЙ КЛЮЧ</Data>
</Node>
<Node><Sub>175</Sub>
<Data>                           1  NZ - НАЧАЛЬНОЕ</Data>
</Node>
<Node><Sub>176</Sub>
<Data>                           2  TN - ТЕКСТ НАЧАЛА В СПИСКЕ\СВОДКЕ</Data>
</Node>
<Node><Sub>177</Sub>
<Data>                           4  KZ - И КОНЕЧНОЕ ЗНАЧЕНИЕ КЛЮЧА</Data>
</Node>
<Node><Sub>178</Sub>
<Data>                           5  NEW - ТЕКСТ ПРИГЛАШЕНИЯ ВВОДА НОВЫЕ ДАННЫЕ КЛЮЧА</Data>
</Node>
<Node><Sub>179</Sub>
<Data>                           6  YX - Y,X РАЗМЕРЫ ТАБЛИЦЫ СПИСКА ДАННЫХ КЛЮЧА</Data>
</Node>
<Node><Sub>180</Sub>
<Data>                                   или HiddenLastKey для одноеменного режима</Data>
</Node>
<Node><Sub>181</Sub>
<Data>                                   (см.</Data>
</Node>
<Node><Sub>182</Sub>
<Data>                           9  TV - ТЕКСТ ПРИ ОПРЕДЕЛЕНИИ ВЫБОРКИ  </Data>
</Node>
<Node><Sub>183</Sub>
<Data>                          10  KC - ЦВЕТ (СМ.S)</Data>
</Node>
<Node><Sub>184</Sub>
<Data>                          12  TK - ТЕКСТ КОНЦА В СПИСКЕ\СВОДКЕ</Data>
</Node>
<Node><Sub>185</Sub>
<Data>                          13  LC=0 -ЕСЛИ ЕСТЬ ЛОГИКА НА КЛЮЧ</Data>
</Node>
<Node><Sub>186</Sub>
<Data>                          14  TAB - ССЫЛКА НА РАЗДЕЛ,ТАБЛИЦУ,прикрепленную к ключам</Data>
</Node>
<Node><Sub>187</Sub>
<Data>                          15  KT - ТЕКСТ ПРИГЛАШЕНИЯ ВВЕСТИ ДАННЫЕ КЛЮЧА</Data>
</Node>
<Node><Sub>188</Sub>
<Data>                          17  ткст описания ключа (Сache&apos;Object only)</Data>
</Node>
<Node><Sub>189</Sub>
<Data>                          20  HL - ССЫЛКА НА РАЗДЕЛ,ТЕКСТ ПОМОЩИ</Data>
</Node>
<Node><Sub>190</Sub>
<Data>                          21  тип данных ключа (Сache&apos;Object only)</Data>
</Node>
<Node><Sub>191</Sub>
<Data>                          22  имя поля ключа (Сache&apos;Object only)                          </Data>
</Node>
<Node><Sub>192</Sub>
<Data>    ^BSR(BST,&quot;KEY&quot;,k,1)=ИСПОЛНЯЕМЫЙ ТЕКСТ ФОРМУЛЫ СИНТ. КОНТРОЛЯ</Data>
</Node>
<Node><Sub>193</Sub>
<Data>                   k,2)=ИСХОДНЫЙ ТЕКСТ ФОРМУЛЫ СИН.КОНТР.</Data>
</Node>
<Node><Sub>194</Sub>
<Data>                   k,3)=ИСП.ТЕКСТ ФУНКЦИИ ТРАНСФОРМАЦИИ</Data>
</Node>
<Node><Sub>195</Sub>
<Data>                   k,4)=ИСХОДНЫЙ ТЕКСТ Ф.ТРАНСФОРМАЦИИ</Data>
</Node>
<Node><Sub>196</Sub>
<Data>                   k,5)=&quot;I $$MTBD(&quot;^MAS&quot;) -МУЛЬТИ-ТАБЛИЧНАЯ БАЗА ДАННЫХ</Data>
</Node>
<Node><Sub>197</Sub>
<Data>                   k,6)=ИСХОДНЫЙ ТЕКСТ $$MTBD</Data>
</Node>
<Node><Sub>198</Sub>
<Data>                    ...</Data>
</Node>
<Node><Sub>199</Sub>
<Data>                   k,10)=ТЕКСТ ВЫБОРКИ ПО КЛЮЧУ k ДЛЯ СПИСКОВ И СВОДОК</Data>
</Node>
<Node><Sub>200</Sub>
<Data>                   k,10,1)=ИСПОЛНЯЕМЫЙ ТЕКСТ ФОРМУЛЫ НА ВЫБОРКУ</Data>
</Node>
<Node><Sub>201</Sub>
<Data>                     10,2)=ИСХОДНЫЙ ТЕКСТ</Data>
</Node>
<Node><Sub>202</Sub>
<Data>                    ...</Data>
</Node>
<Node><Sub>203</Sub>
<Data>                   k,11)=...</Data>
</Node>
<Node><Sub>204</Sub>
<Data>    ^BSR(BST,&quot;Key&quot;) - ПАРАМЕТРЫ ОФОРМЛЕНИЯ ВЫВОДА СПИСКОВ И СВОДОК</Data>
</Node>
<Node><Sub>205</Sub>
<Data>              ...</Data>
</Node>
<Node><Sub>206</Sub>
<Data>    $P(^BSR(BST,&quot;Key&quot;,1),&quot;@&quot;,15)=&quot;NEWVIEW&quot; </Data>
</Node>
<Node><Sub>207</Sub>
<Data></Data>
</Node>
<Node><Sub>208</Sub>
<Data>    ^BSR(BST,&quot;STA&quot;)=&quot;i,j@BSY@BSX@R1@R2@R3@MY@MX@dанные&quot; СТРОКА СТАТУСА</Data>
</Node>
<Node><Sub>209</Sub>
<Data>             &quot;STA&quot;,0)=...</Data>
</Node>
<Node><Sub>210</Sub>
<Data>             &quot;STA&quot;,1)=...  СОДЕРЖАНИЕ ВИДЕОБУФЕРА</Data>
</Node>
<Node><Sub>211</Sub>
<Data></Data>
</Node>
<Node><Sub>212</Sub>
<Data>    ^BSR(BST,&quot;ZPr&quot;,ИМЯ)=&quot;КОМЕН@Явн1сравн@0&quot; - ЗАПРОС СПИСКА/СВОДКИ</Data>
</Node>
<Node><Sub>213</Sub>
<Data>                   ИМЯ-ИМЯ ЗАПРОСА</Data>
</Node>
<Node><Sub>214</Sub>
<Data>                   ...</Data>
</Node>
<Node><Sub>215</Sub>
<Data>    ^BSR(BST,&quot;INV&quot;)=&quot;^MAS&quot; - ИМЯ ПОСЛЕДНЕГО КОДИФИКАТОРА</Data>
</Node>
<Node><Sub>216</Sub>
<Data>    ^BSR(BST,&quot;DIN&quot;)=&quot;^MAS&quot; - ИМЯ ПОСЛЕДНЕГО МИКРОЗАПРОСА</Data>
</Node>
<Node><Sub>217</Sub>
<Data></Data>
</Node>
<Node><Sub>218</Sub>
<Data>    ^BSR(BST,&quot;PRN&quot;)=&quot;LP@ST@LG@TI@LT@UK@PT@</Data>
</Node>
<Node><Sub>219</Sub>
<Data>                     LP - КОЛИЧЕСТВО ЭКЗЕМПЛЯРОВ</Data>
</Node>
<Node><Sub>220</Sub>
<Data>                     ST - КОЛ-ВО СТРОК В СТРАНИЦЕ</Data>
</Node>
<Node><Sub>221</Sub>
<Data>                     LG - КОЛ-ВО ПОЗИЦИИ ...</Data>
</Node>
<Node><Sub>222</Sub>
<Data>                     TI - ДУБЛИРОВАТЬ ТИТУЛ   1/0</Data>
</Node>
<Node><Sub>223</Sub>
<Data>                     LT - ЛЕВОЕ ПОЛЕ</Data>
</Node>
<Node><Sub>224</Sub>
<Data>                     UK - ИСПОЛЬЗОВАТЬ КАРТУ ВЫВОДА 1/0</Data>
</Node>
<Node><Sub>225</Sub>
<Data>                     PT - ПЕЧАТЬ ПОТОКОМ ?  1/0</Data>
</Node>
<Node><Sub>226</Sub>
<Data>    ^BSR(BST,&quot;HFS&quot;)=...АНАЛОГИЧНО &quot;PRN&quot;</Data>
</Node>
<Node><Sub>227</Sub>
<Data>    ^BSR(BST,&quot;TXT&quot;)=...АНАЛОГИЧНО &quot;PRN&quot;</Data>
</Node>
<Node><Sub>228</Sub>
<Data>    ^BSR(BST,&quot;SHR&quot;)=КОДЫ УПРАВЛЕНИЯ ПРИНТЕРОМ</Data>
</Node>
<Node><Sub>229</Sub>
<Data>    ^BSR(BST,&quot;HVL&quot;) - ЕСТЬ ССЫЛКИ НА БАЗЫ ДАННЫХ НА СМЕННЫЕ ПРИВОДЫ</Data>
</Node>
<Node><Sub>230</Sub>
<Data>                  ,&quot;VOL&quot;)=A:\HFS1</Data>
</Node>
<Node><Sub>231</Sub>
<Data>                    ... )=B:\HFS2</Data>
</Node>
<Node><Sub>232</Sub>
<Data>    ^BSR(BST,&quot;AF2&quot;)=BSr,BSt - ССЫЛКА НА БЛОЧНОЕ БЛОЧНОЕ МЕНЮ ТАБЛИЦЫ</Data>
</Node>
<Node><Sub>233</Sub>
<Data>    ^BSR(BST,&quot;AF2&quot;,1,1)=[САМО МЕНЮ.....] ФОРМАТА ^%ZAPM.ed.BSB</Data>
</Node>
<Node><Sub>234</Sub>
<Data>    ^BSR(BST,&quot;AFG&quot;,1,1)=ССЫЛКА МЕСТА ХРАНЕНИЯ МЕНЮ</Data>
</Node>
<Node><Sub>235</Sub>
<Data>                   ....</Data>
</Node>
<Node><Sub>236</Sub>
<Data>    ^BSR(BST,&quot;AFO&quot;)=ДЛЯ СПИСКА ПАРАМЕТРЫ АВТО-ФОРМАТИРОВАНИЯ</Data>
</Node>
<Node><Sub>237</Sub>
<Data>    ^BSR(BST,&quot;XBD&quot;)=СИМВОЛЫ УНИКАЛИЗАЦИИ ИМЕН ХРАНЕНИЯ В БД</Data>
</Node>
<Node><Sub>238</Sub>
<Data>    ^BSR(BST,&quot;LST&quot;)=$H,ИМЯ_ПОЛЬЗОВАТЕЛЯ - КТО ПОСЛЕДНИЙ РЕДАКТИРОВАЛ\КОПИРОВАЛ ТАБЛИЦУ</Data>
</Node>
<Node><Sub>239</Sub>
<Data>    ^BSR(BST,&quot;USM&quot;)=КОД ЦВЕТА МЕНЮ ДЛЯ  VIEW</Data>
</Node>
<Node><Sub>240</Sub>
<Data>    ^BSR(BST,&quot;DBF&quot;)=СТРУКТУРА DBF ...</Data>
</Node>
<Node><Sub>241</Sub>
<Data>    ^BSR(BST,&quot;VST&quot;)=ВИДЕОСТАТУС</Data>
</Node>
<Node><Sub>242</Sub>
<Data>    ^BSR(BST,&quot;INDEX&quot;)=ПАРАМЕТРЫ ДЛЯ ИНДЕКСИРОВАННЫХ ПЕРЕМЕННЫХ ТОБД</Data>
</Node>
<Node><Sub>243</Sub>
<Data>    ^BSR(BST,&quot;INDEX&quot;,&quot;ИМЯ&quot;)=ССЫЛКА ИНДЕКСНОЙ БД</Data>
</Node>
<Node><Sub>244</Sub>
<Data>    ^BSR(BST,&quot;SVO&quot;)=ПАРАМЕТРЫ НАСЧЕТА СВОДКИ (СМ.^%ZAPM.ed.BSHLP,SVO)</Data>
</Node>
<Node><Sub>245</Sub>
<Data></Data>
</Node>
<Node><Sub>246</Sub>
<Data>    ^BSR(BST,&quot;TSV&quot;)=ПАРАМЕТРЫ НАСЧЕТА СВОДКИ (СМ.^%ZAPM.ed.BSHLP,SVO)</Data>
</Node>
<Node><Sub>247</Sub>
<Data>    ^BSR(BST,&quot;TSP&quot;)=ПАРАМЕТРЫ НАСЧЕТА СПИСКА</Data>
</Node>
<Node><Sub>248</Sub>
<Data>    </Data>
</Node>
<Node><Sub>249</Sub>
<Data>    ^BSR(BST,&quot;BUT&quot;)=ПАРАМЕТРЫ ПАНЕЛИ С КНОПКАМИ</Data>
</Node>
<Node><Sub>250</Sub>
<Data>    ^BSR(BST,&quot;Dial&quot;)=ПАРАМЕТРЫ ДИАЛОГОВОЙ ПАНЕЛИ</Data>
</Node>
<Node><Sub>251</Sub>
<Data>    ^BSR(BST,&quot;CMD&quot;)=КОМАНДА М ПРИКРЕПЛЕННАЯ К КЛЕТКЕ</Data>
</Node>
<Node><Sub>252</Sub>
<Data>    ^BSR(BST,&quot;Var&quot;)=ПЕРЕМЕННЫЕ ХРАНИМЫЕ В ТАБЛИЦЕ (СМ.ФУНКЦИИ $$Var)</Data>
</Node>
<Node><Sub>253</Sub>
<Data></Data>
</Node>
<Node><Sub>254</Sub>
<Data>    ^BSR(BST,&quot;PER&quot;)=КОЛИЧЕСТВО ПЕРИОДОВ СРАВНЕНИЯ ДЛЯ ВСЕХ СВОДОК</Data>
</Node>
<Node><Sub>255</Sub>
<Data>    ^BSR(BST,&quot;PERUSER&quot;)=КТО И ...</Data>
</Node>
<Node><Sub>256</Sub>
<Data>    ^BSR(BST,&quot;PERDATE&quot;)=... И КОГДА НАСЧИТЫВАЛ СВОДКИ И СПИСКИ</Data>
</Node>
<Node><Sub>257</Sub>
<Data>    ^BSR(BST,&quot;PERIOD&quot;,N)=ПЕРИОДЫ СРАВНЕНИЯ, ГДЕ N-НОМЕР</Data>
</Node>
<Node><Sub>258</Sub>
<Data>    ^BSR(BST,&quot;ExcelOut&quot;)=A,B,C   A- информация для экспорта в Excel из сводки</Data>
</Node>
<Node><Sub>259</Sub>
<Data>                                 B=1 - запрещено выводить конвертором</Data>
</Node>
<Node><Sub>260</Sub>
<Data>                                 C- номер строки с которой начнется шапка</Data>
</Node>
<Node><Sub>261</Sub>
<Data></Data>
</Node>
<Node><Sub>262</Sub>
<Data>    ^BSR(BST,&quot;SVM&quot;)=ТЕКСТ КОМАНДЫ СОХРАНЕНИЯ В ТАБЛИЦЕ</Data>
</Node>
<Node><Sub>263</Sub>
<Data>    ^BSR(BST,&quot;RSM&quot;)=ТЕКСТ КОМАНДЫ ВОССТАНОВЛЕНИЯ В ТАБЛИЦЕ </Data>
</Node>
<Node><Sub>264</Sub>
<Data>    ^BSR(BST,&quot;DDR&quot;)= - ССЫЛКА НА 1 УРОВЕНЬ БАЗЫ ДАННЫХ ОПИСАНИЯ DDR</Data>
</Node>
<Node><Sub>265</Sub>
<Data>    ^BSR(BST,&quot;AskPage&quot;)= СЛУЖЕБНЫЕ ДЛЯ ТЕКСТОВОГО ПРОЦЕССОРА</Data>
</Node>
<Node><Sub>266</Sub>
<Data>    ^BSR(BST,&quot;Cahrs&quot;)=                 В.Лащева</Data>
</Node>
<Node><Sub>267</Sub>
<Data>    ^BSR(BST,&quot;Cursiv&quot;)=</Data>
</Node>
<Node><Sub>268</Sub>
<Data>    ^BSR(BST,&quot;DoRight&quot;)=</Data>
</Node>
<Node><Sub>269</Sub>
<Data>    ^BSR(BST,&quot;DoubleStrike&quot;)=</Data>
</Node>
<Node><Sub>270</Sub>
<Data>    ^BSR(BST,&quot;Eject&quot;)=</Data>
</Node>
<Node><Sub>271</Sub>
<Data>    ^BSR(BST,&quot;Emphasise&quot;)=</Data>
</Node>
<Node><Sub>272</Sub>
<Data>    ^BSR(BST,&quot;Left&quot;)=</Data>
</Node>
<Node><Sub>273</Sub>
<Data>    ^BSR(BST,&quot;Lines&quot;)=</Data>
</Node>
<Node><Sub>274</Sub>
<Data>    ^BSR(BST,&quot;Margin&quot;)=</Data>
</Node>
<Node><Sub>275</Sub>
<Data>    ^BSR(BST,&quot;NLQ&quot;)=</Data>
</Node>
<Node><Sub>276</Sub>
<Data>    ^BSR(BST,&quot;PageBreak&quot;)=</Data>
</Node>
<Node><Sub>277</Sub>
<Data>    ^BSR(BST,&quot;PageNum&quot;)=</Data>
</Node>
<Node><Sub>278</Sub>
<Data>    ^BSR(BST,&quot;Red&quot;)=</Data>
</Node>
<Node><Sub>279</Sub>
<Data>    ^BSR(BST,&quot;Right&quot;)=</Data>
</Node>
<Node><Sub>280</Sub>
<Data>    ^BSR(BST,&quot;Set&quot;)=</Data>
</Node>
<Node><Sub>281</Sub>
<Data>    ^BSR(BST,&quot;Step&quot;)=</Data>
</Node>
<Node><Sub>282</Sub>
<Data>    ^BSR(BST,&quot;SubTitle&quot;)=</Data>
</Node>
<Node><Sub>283</Sub>
<Data>    ^BSR(BST,&quot;User&quot;)=</Data>
</Node>
<Node><Sub>284</Sub>
<Data>    </Data>
</Node>
<Node><Sub>285</Sub>
<Data>    ^BSR(BST,&quot;Free&quot;)= \ СЛУЖЕБНЫЕ</Data>
</Node>
<Node><Sub>286</Sub>
<Data>    ^BSR(BST,&quot;DOS&quot;)=   &gt;      МОИ И</Data>
</Node>
<Node><Sub>287</Sub>
<Data>    ^BSR(BST,&quot;QQQ&quot;)=  /          ПОЛЬЗОВАТЕЛЬСКИЕ</Data>
</Node>
<Node><Sub>288</Sub>
<Data>    ^BSR(BST,&quot;REM&quot;)=ДОПОЛНИТЕЛЬНЫЙ КОМЕНТАРИЙ К ТАБЛИЦЕ</Data>
</Node>
<Node><Sub>289</Sub>
<Data></Data>
</Node>
<Node><Sub>290</Sub>
<Data>    ^BSR(BST,&quot;OPT&quot;)=1 ТАБЛИЦА ОПЦИЙ 5-КОЛОНОЧНАЯ \ Cache&apos;</Data>
</Node>
<Node><Sub>291</Sub>
<Data>              или  =X1,X2,Y                      / Only</Data>
</Node>
<Node><Sub>292</Sub>
<Data>  X1-колонка текста  X2-колонка данных  Y-строка с которой начинаются данные</Data>
</Node>
<Node><Sub>293</Sub>
<Data>    </Data>
</Node>
<Node><Sub>294</Sub>
<Data>    ^%ZAPM.ed.BSHLP(i) - РАЗДЕЛ СИСТЕМНОЙ ПОМОЩИ</Data>
</Node>
<Node><Sub>295</Sub>
<Data>           (i,1)=ТЕКСТ ПОМОЩИ</Data>
</Node>
<Node><Sub>296</Sub>
<Data>            ...</Data>
</Node>
<Node><Sub>297</Sub>
<Data>    ^%ZAPM.ed.BSX(i) - СКРЫТЫЙ РАЗДЕЛ ТЕКСТОВОГО РЕДАКТОРА</Data>
</Node>
<Node><Sub>298</Sub>
<Data></Data>
</Node>
<Node><Sub>299</Sub>
<Data>    ^%ZAPM.ed.BSETUP(i) - РАЗДЕЛ ТЕКУЩИХ ПАРАМЕТРОВ %BS</Data>
</Node>
<Node><Sub>300</Sub>
<Data></Data>
</Node>
<Node><Sub>301</Sub>
<Data>3.            ________________________________________________</Data>
</Node>
<Node><Sub>302</Sub>
<Data>···­­­---===========     СТРУКТУРА БЛОЧНОГО МЕНЮ       =============---­­­···</Data>
</Node>
<Node><Sub>303</Sub>
<Data>              ------------------------------------------------</Data>
</Node>
<Node><Sub>304</Sub>
<Data></Data>
</Node>
<Node><Sub>305</Sub>
<Data>^MAS(i,1)=TEX@HELP@R@X@N@D@G@I</Data>
</Node>
<Node><Sub>306</Sub>
<Data>           1   2   3 4 5 6 7 8</Data>
</Node>
<Node><Sub>307</Sub>
<Data></Data>
</Node>
<Node><Sub>308</Sub>
<Data>1  TEX - СОДЕРЖАНИЕ БЛОЧНОГО МЕНЮ  TEX=&quot; BLOK1 BLOK2 BLOK3 ... BLOKN &quot;</Data>
</Node>
<Node><Sub>309</Sub>
<Data>2  HELP - ИМЯ МАССИВА HELPa</Data>
</Node>
<Node><Sub>310</Sub>
<Data>3   R - РАЗДЕЛИТЕЛЬ МЕЖДУ БЛОКАМИ В TEX   R=&quot; &quot;</Data>
</Node>
<Node><Sub>311</Sub>
<Data>4   X - РЕЗЕРВ</Data>
</Node>
<Node><Sub>312</Sub>
<Data>5   N - НОМЕР УРОВНЯ ДЛЯ СТРОК ПОДСКАЗКИ  ^MAS(N,k)=&quot;Тескст&quot; ДЛЯ k-го БЛОКА</Data>
</Node>
<Node><Sub>313</Sub>
<Data>6   D - ВЫПОЛНЕНИЕ ВЫБОРА ДЛЯ БЛОКОВ  D=&quot;D ^%SS;D ^%SP;;D ^%SSD&quot;</Data>
</Node>
<Node><Sub>314</Sub>
<Data>7   G - ФОРМИРУЕТ ЛОКАЛЬ %GO=$P(G,&quot;;&quot;,НОМЕР) ,где НОМЕР-номер выбранного блока</Data>
</Node>
<Node><Sub>315</Sub>
<Data>        (если выбора не было ,то %GO не существует)</Data>
</Node>
<Node><Sub>316</Sub>
<Data>8   I - ИНДЕКС ПЕРВОГО УРОВНЯ МАССИВА  HELP  ДЛЯ ВЫЗОВА ТАБЛИЦЫ ПО F1</Data>
</Node>
<Node><Sub>317</Sub>
<Data></Data>
</Node>
<Node><Sub>318</Sub>
<Data></Data>
</Node>
<Node><Sub>319</Sub>
<Data>          Темные блоки меню - локальный массив Dark(...) ,по структуре</Data>
</Node>
<Node><Sub>320</Sub>
<Data>          узлов идентичен ^MAS .</Data>
</Node>
<Node><Sub>321</Sub>
<Data>          (TEX=&quot; 1 0 1 1 0 &quot; не выберать по Enter 2 и 5 блок)</Data>
</Node>
<Node><Sub>322</Sub>
<Data></Data>
</Node>
<Node><Sub>323</Sub>
<Data>4.            ________________________________________________</Data>
</Node>
<Node><Sub>324</Sub>
<Data>···­­­---===========  ОПИСАНИЕ СТРУКТУРЫ КОДИФИКАТОРА   =============---­­­···</Data>
</Node>
<Node><Sub>325</Sub>
<Data>              ------------------------------------------------</Data>
</Node>
<Node><Sub>326</Sub>
<Data></Data>
</Node>
<Node><Sub>327</Sub>
<Data>^MAS=%BS-invert-^ZZ,XX@COMMENT@X1@X2@@@$H@G@S@L</Data>
</Node>
<Node><Sub>328</Sub>
<Data>^MAS(1,KOD)=TXT</Data>
</Node>
<Node><Sub>329</Sub>
<Data>^MAS(2,TXT)=KOD</Data>
</Node>
<Node><Sub>330</Sub>
<Data>^MAS(3,i)=KOD_$C(0)_TXT  - ТАБЛИЦА С КОМЕНТАРИЯМИ ДЛЯ EXCEL КОРРЕКЦИИ.</Data>
</Node>
<Node><Sub>331</Sub>
<Data>^MAS(4,i)=KOD_$C(0)_TXT  - ДЛЯ КОРРЕКЦИИ В ФОРМЕ. Если существует, то</Data>
</Node>
<Node><Sub>332</Sub>
<Data>                           EXCEL корекция запрещена.</Data>
</Node>
<Node><Sub>333</Sub>
<Data>   1  ^ZZ,XX=РАЗДЕЛ,ТАБЛИЦА НА ОСНОВАНИИ КОТОРОЙ СДЕЛАН КОДИФИКАТОР</Data>
</Node>
<Node><Sub>334</Sub>
<Data>   2   COMMENT=КОМЕНТАРИЙ</Data>
</Node>
<Node><Sub>335</Sub>
<Data>   3   X1=КОЛОНКА КОДОВ</Data>
</Node>
<Node><Sub>336</Sub>
<Data>   4   X2=КОЛОНКА ТЕКСТОВ</Data>
</Node>
<Node><Sub>337</Sub>
<Data>   7   $H=СИСТЕМНАЯ ДАТА</Data>
</Node>
<Node><Sub>338</Sub>
<Data>   8   G=1 ФЛАГ НОВОГО ТИПА КОДИФИКАТОРА</Data>
</Node>
<Node><Sub>339</Sub>
<Data>   9   S=12 КОД КОТОРЫМ &quot;СЕКРЕТИТЬ&quot; КОДИФИКАТОР</Data>
</Node>
<Node><Sub>340</Sub>
<Data>   10  L=ИМЯ ПОЛЬЗОВАТЕЛЯ ПОСЛЕДНЕГО РЕДАКТОРА</Data>
</Node>
<Node><Sub>341</Sub>
<Data></Data>
</Node>
<Node><Sub>342</Sub>
<Data>5.            ________________________________________________</Data>
</Node>
<Node><Sub>343</Sub>
<Data>···­­­---===========  ОПИСАНИЕ СТРУКТУРЫ М/ЗАПРОСОВ     =============---­­­···</Data>
</Node>
<Node><Sub>344</Sub>
<Data>              ------------------------------------------------</Data>
</Node>
<Node><Sub>345</Sub>
<Data></Data>
</Node>
<Node><Sub>346</Sub>
<Data>^MAS=%BS-dinamo-^ZZ,XX@COMMENT@@@@@$H@@S</Data>
</Node>
<Node><Sub>347</Sub>
<Data>^MAS(1,i)=TXT @ ФОРМУЛА ДЛЯ СВОДКИ $$TSVV(...)</Data>
</Node>
<Node><Sub>348</Sub>
<Data></Data>
</Node>
<Node><Sub>349</Sub>
<Data>   1   ^ZZ,XX=РАЗДЕЛ,ТАБЛИЦА НА ОСНОВАНИИ КОТОРОЙ СДЕЛАН МИКРОЗАПРОС</Data>
</Node>
<Node><Sub>350</Sub>
<Data>   2   COMMENT=КОМЕНТАРИЙ</Data>
</Node>
<Node><Sub>351</Sub>
<Data>   7   $H=СИСТЕМНАЯ ДАТА</Data>
</Node>
<Node><Sub>352</Sub>
<Data>   8   G=1 ФЛАГ НОВОГО ТИПА МЗАПРОСА</Data>
</Node>
<Node><Sub>353</Sub>
<Data>   9   S=12 КОД КОТОРЫМ &quot;СЕКРЕТИТЬ&quot; МИКРОЗАПРОС</Data>
</Node>
<Node><Sub>354</Sub>
<Data></Data>
</Node>
<Node><Sub>355</Sub>
<Data>6.            ________________________________________________</Data>
</Node>
<Node><Sub>356</Sub>
<Data>···­­­---===========     ОПИСАНИЕ ПАНЕЛИ С КНОПКАМИ    =============---­­­···</Data>
</Node>
<Node><Sub>357</Sub>
<Data>              ------------------------------------------------      </Data>
</Node>
<Node><Sub>358</Sub>
<Data></Data>
</Node>
<Node><Sub>359</Sub>
<Data>^BSR(BST,&quot;BUT&quot;)=ЦВЕТ ВСЕЙ ПАНЕЛИ</Data>
</Node>
<Node><Sub>360</Sub>
<Data>^BSR(BST,&quot;BUT&quot;,0)=ЦВЕТ ПОЯНЯЮЩЕГО ТЕКСТА</Data>
</Node>
<Node><Sub>361</Sub>
<Data>^BSR(BST,&quot;BUT&quot;,0,1)=САМ ТЕКСТ1</Data>
</Node>
<Node><Sub>362</Sub>
<Data>^BSR(BST,&quot;BUT&quot;,0,...)=САМ ТЕКСТ2</Data>
</Node>
<Node><Sub>363</Sub>
<Data>^BSR(BST,&quot;BUT&quot;,0,Т)=САМ ТЕКСТТ</Data>
</Node>
<Node><Sub>364</Sub>
<Data>^BSR(BST,&quot;BUT&quot;,1)=ЦВЕТ ПАССИВНОЙ КНОПКИ/ЦВЕТ АКТИВНОЙ КНОПКИ</Data>
</Node>
<Node><Sub>365</Sub>
<Data>^BSR(BST,&quot;BUT&quot;,1,1)=ТЕКСТ 1 КНОПКИ</Data>
</Node>
<Node><Sub>366</Sub>
<Data>^BSR(BST,&quot;BUT&quot;,1,2)=ТЕКСТ 2 КНОПКИ</Data>
</Node>
<Node><Sub>367</Sub>
<Data>          ...</Data>
</Node>
<Node><Sub>368</Sub>
<Data>^BSR(BST,&quot;BUT&quot;,2)=2    ПРЕДУСТАНОВКА НА 2 КНОПКУ</Data>
</Node>
<Node><Sub>369</Sub>
<Data>^BSR(BST,&quot;BUT&quot;,3,2)=М-КОМАНДА ИЛИ ВХОД В ТЕКСТ ДЛЯ 2 КНОПКИ</Data>
</Node>
<Node><Sub>370</Sub>
<Data>^BSR(BST,&quot;BUT&quot;,4,1)=ЗНАЧЕНИЕ, ВОЗВРАЩАЕМОЕ 1 КНОПКОЙ ПРИ ЕЕ ВЫБОРЕ</Data>
</Node>
<Node><Sub>371</Sub>
<Data>^BSR(BST,&quot;BUT&quot;,4,2)=ЗНАЧЕНИЕ, ВОЗВРАЩАЕМОЕ 2 КНОПКОЙ ПРИ ЕЕ ВЫБОРЕ</Data>
</Node>
<Node><Sub>372</Sub>
<Data>^BSR(BST,&quot;BUT&quot;,6,1)=0 НЕ НУЖЕН ВОЗВРАТ В ПАНЕЛЬ, ЕСЛИ ДЛЯ 1 КНОПКИ ЕСТЬ </Data>
</Node>
<Node><Sub>373</Sub>
<Data>                      ВЫЗОВ М-ПРОЦЕССА И ВХОД В ТАБЛИЦУ</Data>
</Node>
<Node><Sub>374</Sub>
<Data> </Data>
</Node>
<Node><Sub>375</Sub>
<Data>7.            ________________________________________________</Data>
</Node>
<Node><Sub>376</Sub>
<Data>···­­­---===========   ЛОКАЛЬНЫЕ ПЕРЕМЕННЫЕ КОМПЛЕКСА   =============---­­­···</Data>
</Node>
<Node><Sub>377</Sub>
<Data>              ------------------------------------------------</Data>
</Node>
<Node><Sub>378</Sub>
<Data>  после 119  до 119 версии</Data>
</Node>
<Node><Sub>379</Sub>
<Data></Data>
</Node>
<Node><Sub>380</Sub>
<Data>  %BS(1) =   ABCDEFJ   после 267 версии</Data>
</Node>
<Node><Sub>381</Sub>
<Data>            , где:</Data>
</Node>
<Node><Sub>382</Sub>
<Data>1  A=1  Автозапуск сборщика системной информации ^RTHIST</Data>
</Node>
<Node><Sub>383</Sub>
<Data>2  B=1  Заходить в командер MSM</Data>
</Node>
<Node><Sub>384</Sub>
<Data>3  C=1  Разрешена команда &lt;ALT-F10&gt;</Data>
</Node>
<Node><Sub>385</Sub>
<Data>4  D=1  Разрешена команда &lt;ALT-F11&gt;</Data>
</Node>
<Node><Sub>386</Sub>
<Data>5  E=1  Разрешена команда &lt;ALT-F12&gt;</Data>
</Node>
<Node><Sub>387</Sub>
<Data>6  F=1  Ваша машина ,является MSM-Server</Data>
</Node>
<Node><Sub>388</Sub>
<Data>7  J=1  Разрешить корректировать и показывать комментарий к</Data>
</Node>
<Node><Sub>389</Sub>
<Data>       кипу</Data>
</Node>
<Node><Sub>390</Sub>
<Data>8  H=1  Разрешить использовать &quot;Мышь&quot; ;4.;</Data>
</Node>
<Node><Sub>391</Sub>
<Data></Data>
</Node>
<Node><Sub>392</Sub>
<Data>  %BS - clr - цветовая палитра %BS   $P(%BS,&quot;!&quot;,i), где</Data>
</Node>
<Node><Sub>393</Sub>
<Data>           i=1 - ?</Data>
</Node>
<Node><Sub>394</Sub>
<Data>             2 -Цвет Указателя текущей клетки</Data>
</Node>
<Node><Sub>395</Sub>
<Data>             3 -Помеченная</Data>
</Node>
<Node><Sub>396</Sub>
<Data>             4 -Цвет Шапки Каталогов</Data>
</Node>
<Node><Sub>397</Sub>
<Data>             5 -Цвет Тела Каталогов</Data>
</Node>
<Node><Sub>398</Sub>
<Data>             6 -Цвет РАМКИ ПРОСТОГО Сообщения</Data>
</Node>
<Node><Sub>399</Sub>
<Data>             7 -Цвет ТЕКСТА ПРОСТОГО Сообщения</Data>
</Node>
<Node><Sub>400</Sub>
<Data>             8 -Цвет Основного Фона Меню</Data>
</Node>
<Node><Sub>401</Sub>
<Data>             9 -Цвет Засветки Блока Меню</Data>
</Node>
<Node><Sub>402</Sub>
<Data>             10 -Цвет РАМКИ Сообщения об Ошибке</Data>
</Node>
<Node><Sub>403</Sub>
<Data>             11 -Цвет ТЕКСТА Сообщения об Ошибке</Data>
</Node>
<Node><Sub>404</Sub>
<Data>             12 -Цвет Текущего Действия</Data>
</Node>
<Node><Sub>405</Sub>
<Data>  %BS(2)     GLUC - через склько секунд гасить экран динамической картинкой</Data>
</Node>
<Node><Sub>406</Sub>
<Data>  %BS(3) - НОВЫЙ ИДЕНТИФИКАТОР ВМЕСТО $PRINCIPAL    СМ.^%ZAPM.ed.BSVOL(&quot;TRM&quot;)</Data>
</Node>
<Node><Sub>407</Sub>
<Data>  %BS(4)     vDr - список локальных пpиводов</Data>
</Node>
<Node><Sub>408</Sub>
<Data>  %BS(5)     Постдвижение указателя при &lt;Ins&gt; 1=вниз 2=вправо</Data>
</Node>
<Node><Sub>409</Sub>
<Data>  %BS(6)     Количество оставшихся свободных блоков для выдачи предупреждения</Data>
</Node>
<Node><Sub>410</Sub>
<Data>  %BS(7)     netVOL - массив сетевых томов</Data>
</Node>
<Node><Sub>411</Sub>
<Data>  %BS(8)     Nv - массив HFS используемых таблицей</Data>
</Node>
<Node><Sub>412</Sub>
<Data>  %BS(9)     ChEcKhFs - ???</Data>
</Node>
<Node><Sub>413</Sub>
<Data>  %BS(10)    kOd1 - СТРОКИ ДЛЯ NS</Data>
</Node>
<Node><Sub>414</Sub>
<Data>  %BS(11)    kOd2 - ДЛЯ ПЕРЕКОДИРОВКИ ТЕМИНАЛОВ</Data>
</Node>
<Node><Sub>415</Sub>
<Data>  %BS(12)    %q - имя пользователя</Data>
</Node>
<Node><Sub>416</Sub>
<Data>  %BS(13) -  ИМЯ ТЕКУЩЕЙ NAMESPACE</Data>
</Node>
<Node><Sub>417</Sub>
<Data>  %BS(14)    ФЛАГИ-ПАРАМЕТРЫ ДЛЯ ТЕМИНАЛОВ</Data>
</Node>
<Node><Sub>418</Sub>
<Data>  %BS(14,1) - КОД ПЕРЕНАПРАВЛЕНИЯ ПОТОКА ВЫВОДА С ЭКРАНА НА ПРИНТЕР   </Data>
</Node>
<Node><Sub>419</Sub>
<Data>  %BS(14,2) - КОД ОТМЕНЫ ПЕРЕНАПРАВЛЕНИЯ ПОТОКА ВЫВОДА С ЭКРАНА НА ПРИНТЕР</Data>
</Node>
<Node><Sub>420</Sub>
<Data>  %BS(15)    %nE  - номер текущего уровня таблицы</Data>
</Node>
<Node><Sub>421</Sub>
<Data>  %BS(16)    Постдвижение указателя после редактирования 1=вниз 2=вправо</Data>
</Node>
<Node><Sub>422</Sub>
<Data>  %BS(17)    ШЕСТНАДЦАТИРИЧНЫЙ АДРЕС НАЧАЛА ВИДЕОПАМЯТИ</Data>
</Node>
<Node><Sub>423</Sub>
<Data>  %BS(18)    ИМЯ БАЗЫ ДАННЫХ ПОЛЬЗОВАТЕЛЕЙ %BS</Data>
</Node>
<Node><Sub>424</Sub>
<Data>  %BS(19)    НОМЕР УСТРОЙСТВА ПЕЧАТИ (создается PrnSetUp^%ZAPM.ed.BSXform)</Data>
</Node>
<Node><Sub>425</Sub>
<Data>  %BS(20)   =ИМЯ РАЗДЕЛА УМАЛЧИВАЕМЫХ ОБЪЕКТОВ И ХАРАКТЕРИСТИК</Data>
</Node>
<Node><Sub>426</Sub>
<Data>  %BS(21)   - ИНФОРМАЦИЯ О ПАРАМЕТРАХ УСТРОЙСТВА РТА-80Л (СМ:^%ZAPM.ed.BSDDRR+16)</Data>
</Node>
<Node><Sub>427</Sub>
<Data>  %BS(22)   = ХАРАКТЕРИСТИКИ =PART,KODIF,BASE</Data>
</Node>
<Node><Sub>428</Sub>
<Data>  %BS(23)   = 1 Комплекс использует DDP и доступные тома в БД пользователей </Data>
</Node>
<Node><Sub>429</Sub>
<Data>                ^...(&quot;USER&quot;,1,&quot;REMOTE_UCI,REMOTE_VOL&quot;,&quot;*&quot; ...</Data>
</Node>
<Node><Sub>430</Sub>
<Data>  %BS(24,1)   = ФАЙЛ ПРОТОКОЛА СИСТЕМНЫХ ДЕЙСТВИЙ</Data>
</Node>
<Node><Sub>431</Sub>
<Data>  %BS(24,2)   = ФАЙЛ ПРОТОКОЛА ТЕСТИРОВАНИЙ ТОМОВ</Data>
</Node>
<Node><Sub>432</Sub>
<Data>         ...</Data>
</Node>
<Node><Sub>433</Sub>
<Data>  %BS(32)   = СТАНДАРТНАЯ МНЕМОНИЧЕСКО-ИМЕННАЯ ОБЛАСТЬ</Data>
</Node>
<Node><Sub>434</Sub>
<Data>  %BS(33)   = 3/3/33 - ОГРАНИЧЕНИЕ ДОСТУПА К ДОС-ИНТЕРФЕЙСУ</Data>
</Node>
<Node><Sub>435</Sub>
<Data>  %BS(34)   = Y/Y/Y  - ОГРАНИЧЕНИЕ ДОСТУПА К M-ИНТЕРФЕЙСУ</Data>
</Node>
<Node><Sub>436</Sub>
<Data>  %BS(35)   = ТАБЛИЦА ТРАНСЛЯЦИИ КОДОВ КЛАВИТУРЫ</Data>
</Node>
<Node><Sub>437</Sub>
<Data>  %BS(36)   = НАСТОЯЩАЯ ДАТА ВМЕСТО $H</Data>
</Node>
<Node><Sub>438</Sub>
<Data>  %BS(37)   = ИМЯ УЗЛА ГРУППЫ ПОЛЬЗОВАТЕЛЕЙ</Data>
</Node>
<Node><Sub>439</Sub>
<Data>  %BS(38)   = КОМЕНТАРИЙ К ИМЕНИ ПОЛЬЗОВАТЕЛЯ - WHO ?</Data>
</Node>
<Node><Sub>440</Sub>
<Data>  %BS(39)   = ГРАНД ПРИЛОЖЕНИЯ (Cache&apos;Only)</Data>
</Node>
<Node><Sub>441</Sub>
<Data>  %BS(40)   = ИДЕНТИФИКАТОР СЕССИИ (Cache&apos;Only)</Data>
</Node>
<Node><Sub>442</Sub>
<Data>  %BS(41)   = IP - АДРЕС</Data>
</Node>
<Node><Sub>443</Sub>
<Data>  %BS(42)   = ИМЯ КОМПЬЮТЕРА</Data>
</Node>
<Node><Sub>444</Sub>
<Data>  %BS(43)   = $C(13,10) ЕСЛИ НЕ ТЕЛНЕТ, А TCP-СОКЕТ</Data>
</Node>
<Node><Sub>445</Sub>
<Data>  %BS(44)   = A,B,C</Data>
</Node>
<Node><Sub>446</Sub>
<Data>            A=1 Event Log Windows</Data>
</Node>
<Node><Sub>447</Sub>
<Data>            B=1 E-MAIL Админу посылать о Важных событиях</Data>
</Node>
<Node><Sub>448</Sub>
<Data></Data>
</Node>
<Node><Sub>449</Sub>
<Data>  %BS(&quot;Tmp&quot;,...) - ВРЕМЕННЫЙ УЗЕЛ ДЛЯ СПЕЦИАЛЬНЫХ РЕЖИМОВ</Data>
</Node>
<Node><Sub>450</Sub>
<Data></Data>
</Node>
<Node><Sub>451</Sub>
<Data>  после 267      до 267</Data>
</Node>
<Node><Sub>452</Sub>
<Data>  -----------------------</Data>
</Node>
<Node><Sub>453</Sub>
<Data>  %BS(&quot;Tmp&quot;,1)   Syd    ТОМ </Data>
</Node>
<Node><Sub>454</Sub>
<Data>  %BS(&quot;Tmp&quot;,2)   Ucd    КИП</Data>
</Node>
<Node><Sub>455</Sub>
<Data>  %BS(&quot;Tmp&quot;,3)   Uddp   ...</Data>
</Node>
<Node><Sub>456</Sub>
<Data>  %BS(&quot;Tmp&quot;,4)   Vddp   ...</Data>
</Node>
<Node><Sub>457</Sub>
<Data>  %BS(&quot;Tmp&quot;,5)   Sddp   ...</Data>
</Node>
<Node><Sub>458</Sub>
<Data>  %BS(&quot;Tmp&quot;,6)   UVddp  KИП,ТОМ</Data>
</Node>
<Node><Sub>459</Sub>
<Data></Data>
</Node>
<Node><Sub>460</Sub>
<Data>8.            ________________________________________________</Data>
</Node>
<Node><Sub>461</Sub>
<Data>···­­­---===========   ЗАРЕЗЕРВИРОВАННЫЕ ЛОКАЛИ  %BS    =============---­­­···</Data>
</Node>
<Node><Sub>462</Sub>
<Data>              ------------------------------------------------</Data>
</Node>
<Node><Sub>463</Sub>
<Data></Data>
</Node>
<Node><Sub>464</Sub>
<Data>      ny,nx - номер строки,колонки текущей клетки</Data>
</Node>
<Node><Sub>465</Sub>
<Data>      se    - количество строк в текущей таблицы</Data>
</Node>
<Node><Sub>466</Sub>
<Data>      ke    - количество колонок в текущей таблицы</Data>
</Node>
<Node><Sub>467</Sub>
<Data>      d     - данные текущей клетки</Data>
</Node>
<Node><Sub>468</Sub>
<Data>      d0    - данные текущей клетки (если d=&quot;&quot; ,то d0=0)</Data>
</Node>
<Node><Sub>469</Sub>
<Data>      d1    - данные текущей клетки трансформированные функцией ТРАНС</Data>
</Node>
<Node><Sub>470</Sub>
<Data>      BS    - строка описатель текущей клетки</Data>
</Node>
<Node><Sub>471</Sub>
<Data>      B     - строка описатель текущей таблицы</Data>
</Node>
<Node><Sub>472</Sub>
<Data>      BSD   - имя базы данных</Data>
</Node>
<Node><Sub>473</Sub>
<Data>      BSR,BST - имя раздела,таблицы</Data>
</Node>
<Node><Sub>474</Sub>
<Data>      EXITout - $D(...) - досрочный выход из текущей таблицы</Data>
</Node>
<Node><Sub>475</Sub>
<Data>      MY,MX - координаты текущей клетки</Data>
</Node>
<Node><Sub>476</Sub>
<Data>      zr    - ПОЛНАЯ ГЛОБАЛЬНАЯ ССЫЛКА НА ТЕКУЩУЮ КАРТУ БАЗУ ДАННЫХ СПИСКА</Data>
</Node>
<Node><Sub>477</Sub>
<Data>      vl(...) Пользовательские Локальные переменные, Определяемые в ссылке на</Data>
</Node>
<Node><Sub>478</Sub>
<Data>              таблицу  {12,4,&quot;SERVER&quot;,&quot;%BSETUP&quot;,&quot;MGR&quot;,&quot;МSW&quot;}, или если там</Data>
</Node>
<Node><Sub>479</Sub>
<Data>              пусто в ^%ZAPM.ed.BSDFLT(&quot;Variables&quot;).</Data>
</Node>
<Node><Sub>480</Sub>
<Data></Data>
</Node>
<Node><Sub>481</Sub>
<Data>9.            ________________________________________________</Data>
</Node>
<Node><Sub>482</Sub>
<Data>···­­­---===========        ПЕРЕМЕННЫЕ ТАБЛИЦЫ %BS      =============---­­­···</Data>
</Node>
<Node><Sub>483</Sub>
<Data>              ------------------------------------------------</Data>
</Node>
<Node><Sub>484</Sub>
<Data></Data>
</Node>
<Node><Sub>485</Sub>
<Data>      TIP - тип таблицы</Data>
</Node>
<Node><Sub>486</Sub>
<Data>      %w(2) - пароль на вход таблицы</Data>
</Node>
<Node><Sub>487</Sub>
<Data>      %w(4) - пароль коррекцию описания таблицы</Data>
</Node>
<Node><Sub>488</Sub>
<Data>      %w(5) - пароль коррекцию данных таблицы</Data>
</Node>
<Node><Sub>489</Sub>
<Data>      %w(6,1) - имя раздела для текущей таблицы</Data>
</Node>
<Node><Sub>490</Sub>
<Data>      %w(6,2) - имя кипа для текущей таблицы</Data>
</Node>
<Node><Sub>491</Sub>
<Data>      %w(6,3) - имя тома для текущей таблицы</Data>
</Node>
<Node><Sub>492</Sub>
<Data>      BS - строка описатель текущей клетки</Data>
</Node>
<Node><Sub>493</Sub>
<Data>      B - строка описатель текущей таблицы</Data>
</Node>
<Node><Sub>494</Sub>
<Data>      MR =1/0 - триггер вкл/выкл засветки текущей клетки</Data>
</Node>
<Node><Sub>495</Sub>
<Data>      BSD - имя базы данных</Data>
</Node>
<Node><Sub>496</Sub>
<Data>      BSR,BST - имя раздела,таблицы</Data>
</Node>
<Node><Sub>497</Sub>
<Data>      %CAL =1 - включено вычисление сразу</Data>
</Node>
<Node><Sub>498</Sub>
<Data>      %COL =1 - логический контроль включен</Data>
</Node>
<Node><Sub>499</Sub>
<Data>      EXITout - $D(...) - досрочный выход из текущей таблицы</Data>
</Node>
<Node><Sub>500</Sub>
<Data>      MY,MX - координаты текущей клетки</Data>
</Node>
<Node><Sub>501</Sub>
<Data>      BX,BY,BSX1,BSX2,BSY1,BSY2 - служебные массивы текущей таблицы</Data>
</Node>
<Node><Sub>502</Sub>
<Data>      BSD - имя базы данных</Data>
</Node>
<Node><Sub>503</Sub>
<Data></Data>
</Node>
<Node><Sub>504</Sub>
<Data>10.           ________________________________________________</Data>
</Node>
<Node><Sub>505</Sub>
<Data>···­­­---===========         БУФЕРА     %BS-PC         =============---­­­···</Data>
</Node>
<Node><Sub>506</Sub>
<Data>              ------------------------------------------------</Data>
</Node>
<Node><Sub>507</Sub>
<Data></Data>
</Node>
<Node><Sub>508</Sub>
<Data>    ^%ZAPM.ed.BSbufS(&quot;SP\SV&quot;) - СИСТЕМНЫЙ РАЗДЕЛ НАСЧИТАННЫХ СВОДОК И СПИСКОВ</Data>
</Node>
<Node><Sub>509</Sub>
<Data></Data>
</Node>
<Node><Sub>510</Sub>
<Data>    ^%ZAPM.ed.BSbufB - БУФЕР КОМПЛЕКСА %BS</Data>
</Node>
<Node><Sub>511</Sub>
<Data>    ^%ZAPM.ed.BSbufB(&quot;CLR&quot;)-ТАБЛИЦА ВЫБОРА ЦВЕТОВОЙ ПАЛИТРЫ</Data>
</Node>
<Node><Sub>512</Sub>
<Data>    ^%ZAPM.ed.BSbufB(&quot;INFO_K&quot;)-ТАБЛИЦА ИНФОРМАЦИИ ПО КЛЕТКЕ</Data>
</Node>
<Node><Sub>513</Sub>
<Data></Data>
</Node>
<Node><Sub>514</Sub>
<Data>    ^%ZAPM.ed.BSbufB(&quot;KCH&quot;_$I_&quot;u&quot;_%BS(15))=1#2#3#4#5#6#7#8#9#10# - БУФЕР ВЫБОРКИ</Data>
</Node>
<Node><Sub>515</Sub>
<Data>                                                 ДЛЯ НАСЧЕТА СПИСКА\СВОДКИ</Data>
</Node>
<Node><Sub>516</Sub>
<Data>     1 - ССЫЛКА НА ТАБЛИЦУ ОПИСАНИЯ СВОДКИ\СПИСКА</Data>
</Node>
<Node><Sub>517</Sub>
<Data>     2 - ТИП ЗАПУСКА 1,2-ФОНОВЫЙ &quot;&quot; ЯВНЫЙ</Data>
</Node>
<Node><Sub>518</Sub>
<Data>     3 - 1@2 1- ССЫЛКА НА МАССИВ БАЗЫ ДАННЫХ</Data>
</Node>
<Node><Sub>519</Sub>
<Data>             2- ССЫЛКА НА ТАБЛИЦУ ОПИСАНИЯ БД</Data>
</Node>
<Node><Sub>520</Sub>
<Data>     7 - КОЛИЧЕСТВО СРАВНЕНИЙ</Data>
</Node>
<Node><Sub>521</Sub>
<Data>     9 - ССЫЛКА НА МАССИВ МИКРОЗАПРОСА</Data>
</Node>
<Node><Sub>522</Sub>
<Data>     10=1,2,3  1 - СТРОКА РАЗДЕЛИТЕЛЯ БОКОВИНЫ СВОДКИ</Data>
</Node>
<Node><Sub>523</Sub>
<Data>               2 - СТРОКА ОКОНЧАНИЯ СВОДКИ</Data>
</Node>
<Node><Sub>524</Sub>
<Data>               3 - Y</Data>
</Node>
<Node><Sub>525</Sub>
<Data>               4 - X</Data>
</Node>
<Node><Sub>526</Sub>
<Data>    </Data>
</Node>
<Node><Sub>527</Sub>
<Data>    ^%ZAPM.ed.BSbufB(&quot;ALINS&quot;_$I_&quot;u&quot;)) - СПИСОК ГЛОБАЛЬНОЙ ПОМЕТКИ</Data>
</Node>
<Node><Sub>528</Sub>
<Data>    ^%ZAPM.ed.BSbufB(&quot;VarLogS&quot;_$I_&quot;u&quot;,i)) - БУФЕР ВЫЧИСЛЯЕМЫХ КЛЕТОК ПРИ ЛОГ.ОШИБКАХ</Data>
</Node>
<Node><Sub>529</Sub>
<Data>    ^%ZAPM.ed.BSbufB(&quot;HISTMSGSRV&quot;)-Буффеp HISTORY для СООБЩЕНИЙ М-Серверу</Data>
</Node>
<Node><Sub>530</Sub>
<Data>    ^%ZAPM.ed.BSbufB(&quot;HISTCMDSRV&quot;)-Буффеp HISTORY для команд М-Серверу</Data>
</Node>
<Node><Sub>531</Sub>
<Data>    ^%ZAPM.ed.BSbufB(&quot;HISPROG...&quot;)-Буффеp HISTORY для имен пpогpамм</Data>
</Node>
<Node><Sub>532</Sub>
<Data>    ^%ZAPM.ed.BSbufB(&quot;HISARREY...&quot;)-Буффеp HISTORY для имен массивов</Data>
</Node>
<Node><Sub>533</Sub>
<Data>    ^%ZAPM.ed.BSbufB(&quot;HISARREYFILTR...&quot;)-Буффеp HISTORY для ФИЛЬТРОВ массивов</Data>
</Node>
<Node><Sub>534</Sub>
<Data>    ^%ZAPM.ed.BSbufB(&quot;HISARREYINDX...&quot;)-Буффеp HISTORY для ИНДЕКСОВ массивов</Data>
</Node>
<Node><Sub>535</Sub>
<Data>    ^%ZAPM.ed.BSbufB(&quot;HISCTL...&quot;)-Буффеp HISTORY для стpочного pедактоpа</Data>
</Node>
<Node><Sub>536</Sub>
<Data>    ^%ZAPM.ed.BSbufB(&quot;HISCHOISE...&quot;)-Буффеp HISTORY для стpочного pедактоpа CHOISE</Data>
</Node>
<Node><Sub>537</Sub>
<Data>    ^%ZAPM.ed.BSbufB(&quot;HISFILE...&quot;)-Буффеp HISTORY для имен ДОС-ФАЙЛОВ</Data>
</Node>
<Node><Sub>538</Sub>
<Data>    ^%ZAPM.ed.BSbufB(&quot;HISFIND...&quot;)-Буффеp HISTORY для СТРОК ПОИСКА ГРУППОВОГО РЕД.ПРГ.</Data>
</Node>
<Node><Sub>539</Sub>
<Data>    ^%ZAPM.ed.BSbufB(&quot;HISCALC&quot;_$I))-Буффеp HISTORY для калькулятора</Data>
</Node>
<Node><Sub>540</Sub>
<Data>    ^%ZAPM.ed.BSbufB(&quot;HISEARCH...&quot;)-Буффеp HISTORY для имен строк поиска и замены</Data>
</Node>
<Node><Sub>541</Sub>
<Data>                      ...=(Номер_Терминала)_$G(Имя_Пользователя)</Data>
</Node>
<Node><Sub>542</Sub>
<Data>    ^%ZAPM.ed.BSbufB(&quot;HIStory...&quot;)-Буффеp HISTORY для ...</Data>
</Node>
<Node><Sub>543</Sub>
<Data>    ^%ZAPM.ed.BSbufB(&quot;DBF_TMP&quot;_$I)-Буффеp работы с DBF</Data>
</Node>
<Node><Sub>544</Sub>
<Data>    ^%ZAPM.ed.BSbufB(&quot;Page&quot;_$I_&quot;u&quot;_%BS(15))-Буффеp работы со страницами текста</Data>
</Node>
<Node><Sub>545</Sub>
<Data>    ^%ZAPM.ed.BSbufB(&quot;PRNset&quot;)-Буффеp НАСТРОЙКИ ПЕЧАТИ</Data>
</Node>
<Node><Sub>546</Sub>
<Data></Data>
</Node>
<Node><Sub>547</Sub>
<Data>*  ^%ZAPM.ed.BSbufB(&quot;Buffers&quot;,$I,Полное_имя_таблицы,&quot;Date&quot;,ny,nx) -Буфер корректи-</Data>
</Node>
<Node><Sub>548</Sub>
<Data>              руемых данных клеток</Data>
</Node>
<Node><Sub>549</Sub>
<Data>*  ^%ZAPM.ed.BSbufB(&quot;Buffers&quot;,$I,Полное_имя_таблицы,&quot;Mark&quot;,ny,nx) -Буфер помеченных</Data>
</Node>
<Node><Sub>550</Sub>
<Data>              клеток</Data>
</Node>
<Node><Sub>551</Sub>
<Data>*  ^%ZAPM.ed.BSbufB(&quot;Buffers&quot;,$I,Полное_имя_таблицы,&quot;Press&quot;,ny)-Буфер поджатых СТРОК</Data>
</Node>
<Node><Sub>552</Sub>
<Data>*  ^%ZAPM.ed.BSbufB(&quot;Buffers&quot;,$I,Полное_имя_таблицы,&quot;Press&quot;,nx)-Буфер поджатых КОЛОНОК</Data>
</Node>
<Node><Sub>553</Sub>
<Data></Data>
</Node>
<Node><Sub>554</Sub>
<Data>*  ^%ZAPM.ed.BSbufB(&quot;Stack1u&quot;,$I) -Буфер стэка таблиц вызвавших интерфейсы</Data>
</Node>
<Node><Sub>555</Sub>
<Data></Data>
</Node>
<Node><Sub>556</Sub>
<Data>    ^%ZAPM.ed.BSbufB($I) - БУФЕР СОХРАНЕНИЯ/ВОССТАНОВЛЕНИЯ КЛЕТКИ,БЛОКА,ТАБЛИЦЫ</Data>
</Node>
<Node><Sub>557</Sub>
<Data>            ($I,i,j)=...</Data>
</Node>
<Node><Sub>558</Sub>
<Data>            (0,$I,1)= БУФЕР ПОДСТРОКИ &lt;ALT-J&gt;</Data>
</Node>
<Node><Sub>559</Sub>
<Data>            (0,$I,2)= БУФЕР ОБРАЗЦА ПОИСКА &lt;Alt-F7&gt;</Data>
</Node>
<Node><Sub>560</Sub>
<Data>            (0,$I,3)= БУФЕР СОХРАНЕНИЯ/ВОССТАНОВЛЕНИЯ БЛОКА БАЗЫ ДАННЫХ</Data>
</Node>
<Node><Sub>561</Sub>
<Data>            (0,$I,4)= БУФЕР ИСТОРИИ ДЛЯ DOS-ФАЙЛОВ</Data>
</Node>
<Node><Sub>562</Sub>
<Data>            (0,$I,5)= РЕЗЕРВ SET</Data>
</Node>
<Node><Sub>563</Sub>
<Data>            (0,$I,6)= БУФЕР ВЫБОРКИ ТАБЛИЦ</Data>
</Node>
<Node><Sub>564</Sub>
<Data>            (0,$I,6,ИМЯ)=...</Data>
</Node>
<Node><Sub>565</Sub>
<Data>            (0,$I,7)= БУФЕР ВЫБОРКИ DOS-ФАЙЛОВ</Data>
</Node>
<Node><Sub>566</Sub>
<Data>            (0,$I,7,ИМЯ)=...</Data>
</Node>
<Node><Sub>567</Sub>
<Data>            (0,$I,8)- БУФЕР ПЕРЕКЛЮЧАТЕЛЯ РЕЖИМА ВСТАВКИ РЕДАКТОРА</Data>
</Node>
<Node><Sub>568</Sub>
<Data>            (0,$I,9)- БУФЕР РЕДАКТОРА МАССИВОВ ДЛЯ &lt;ALT-K&gt;</Data>
</Node>
<Node><Sub>569</Sub>
<Data>            (0,$I,10)- БУФЕР РЕДАКТОРА МАССИВОВ ДЛЯ &lt;CTL-F5&gt;</Data>
</Node>
<Node><Sub>570</Sub>
<Data>            (0,$I,11)- БУФЕР МЕНЕДЖЕРА БД ДЛЯ &lt;CTL-F5&gt;            </Data>
</Node>
<Node><Sub>571</Sub>
<Data>            (0,$I,12)=НОМЕР ТЕКУЩЕГО КЛЮЧА,КОЛИЧЕСТВО КЛЮЧЕЙ</Data>
</Node>
<Node><Sub>572</Sub>
<Data>            </Data>
</Node>
<Node><Sub>573</Sub>
<Data>            (2,$I,1)- БУФЕР КЛЕТКИ</Data>
</Node>
<Node><Sub>574</Sub>
<Data>            (2,$I,2)- БУФЕР БЛОКА</Data>
</Node>
<Node><Sub>575</Sub>
<Data>            (2,$I,3)- БУФЕР ТАБЛИЦЫ</Data>
</Node>
<Node><Sub>576</Sub>
<Data>            (2,$I,4)- БУФЕРА ТЕКСТА</Data>
</Node>
<Node><Sub>577</Sub>
<Data>            (2,$I,5)- УЗЕЛ РЕГИСТРАЦИИ В ТЕКСТЕ</Data>
</Node>
<Node><Sub>578</Sub>
<Data>            (2,$I,6)- ???</Data>
</Node>
<Node><Sub>579</Sub>
<Data>            (2,$I,7)- ИМЯ РЕДАКТОРА МАССИВОВ</Data>
</Node>
<Node><Sub>580</Sub>
<Data>            (2,$I,8)- БУФФЕР РЕДАКТОРА МАССИВА</Data>
</Node>
<Node><Sub>581</Sub>
<Data>            (2,$I,9)- БУФФЕР РЕДАКТОРА МАССИВА (ПОТОМКИ ПРИ УДАЛЕНИИ УЗЛА)</Data>
</Node>
<Node><Sub>582</Sub>
<Data>            (2,$I,10)- Буфер работы с DBF</Data>
</Node>
<Node><Sub>583</Sub>
<Data>            (2,$I,11)- Буфер ФОРМАТИРОВАНИЯ ТЕКСТА</Data>
</Node>
<Node><Sub>584</Sub>
<Data></Data>
</Node>
<Node><Sub>585</Sub>
<Data>            (&quot;???&quot;_$i_&quot;u&quot;_%nE)=буферные таблицы комплекса</Data>
</Node>
<Node><Sub>586</Sub>
<Data></Data>
</Node>
<Node><Sub>587</Sub>
<Data> *  Только для Gamma Version</Data>
</Node>
<Node><Sub>588</Sub>
<Data></Data>
</Node>
<Node><Sub>589</Sub>
<Data>11.           ________________________________________________</Data>
</Node>
<Node><Sub>590</Sub>
<Data>···­­­---===========         ЗАГОЛОВОК БАЗЫ ДАННЫХ      =============---­­­···</Data>
</Node>
<Node><Sub>591</Sub>
<Data>              ------------------------------------------------</Data>
</Node>
<Node><Sub>592</Sub>
<Data></Data>
</Node>
<Node><Sub>593</Sub>
<Data>^NAMEBASE=&quot;BSD - MSW@PART@TABL@REM@FLAG&quot;</Data>
</Node>
<Node><Sub>594</Sub>
<Data>        2 PART-ИМЯ РАЗДЕЛА</Data>
</Node>
<Node><Sub>595</Sub>
<Data>        3 TABL-ИМЯ ТАБЛИЦЫ</Data>
</Node>
<Node><Sub>596</Sub>
<Data>        4 REM -КОМЕНТАРИЙ</Data>
</Node>
<Node><Sub>597</Sub>
<Data>        5 FLAG=1 ИНФОРМАЦИЯ В WINDOWS-КОДИРОВКЕ   </Data>
</Node>
<Node><Sub>598</Sub>
<Data></Data>
</Node>
<Node><Sub>599</Sub>
<Data>^NAMEBASE=&quot;BSD - MSW@^[&quot;&quot;GLAVK&quot;&quot;]F10311@10311&quot;</Data>
</Node>
<Node><Sub>600</Sub>
<Data></Data>
</Node>
</Node>
<Node><Sub>Find</Sub>
<Data>параметры поиска@@@@@@@2@10@22@70@@@@1@@5@@@1@@@ 1@@@@@41@@@1;6;37;44//2;6;33;40@@@@@@@1</Data>
<Node><Sub>1</Sub>
<Data> Если введете только строку текста, то программа будет</Data>
</Node>
<Node><Sub>2</Sub>
<Data> искать все поля начинающиеся на данный контекст.</Data>
</Node>
<Node><Sub>3</Sub>
<Data> НАПРИМЕР:  ИВА     - выберутся  ИВАНОВ И.И.</Data>
</Node>
<Node><Sub>4</Sub>
<Data>                                 ИВАЩЕНКО</Data>
</Node>
<Node><Sub>5</Sub>
<Data>                                 ИВАНИДЗЕ</Data>
</Node>
<Node><Sub>6</Sub>
<Data> Если введете строку  СА*НОВ -   САФОНОВ</Data>
</Node>
<Node><Sub>7</Sub>
<Data>                                 САРАФАНОВ</Data>
</Node>
<Node><Sub>8</Sub>
<Data>                                 САНОВ</Data>
</Node>
<Node><Sub>9</Sub>
<Data> Если введете строку  СА?НОВ -   САРНОВ</Data>
</Node>
<Node><Sub>10</Sub>
<Data>                                 САМНОВ</Data>
</Node>
<Node><Sub>11</Sub>
<Data>                                 САДНОВ</Data>
</Node>
<Node><Sub>12</Sub>
<Data> </Data>
</Node>
<Node><Sub>13</Sub>
<Data> Если введете строку  @  то войдете в индексную БД, если</Data>
</Node>
<Node><Sub>14</Sub>
<Data> ------------------------------------------------- она есть</Data>
</Node>
<Node><Sub>15</Sub>
<Data> </Data>
</Node>
<Node><Sub>16</Sub>
<Data> Если введете @+ , то комплекс заново создаст индексно-</Data>
</Node>
<Node><Sub>17</Sub>
<Data> поисковый массив по ранее сконфигурированным параметрам</Data>
</Node>
<Node><Sub>18</Sub>
<Data></Data>
</Node>
<Node><Sub>19</Sub>
<Data> Если введете @- , то комплекс удалит индексно-</Data>
</Node>
<Node><Sub>20</Sub>
<Data> поисковый массив для текущего показателя</Data>
</Node>
<Node><Sub>21</Sub>
<Data></Data>
</Node>
<Node><Sub>22</Sub>
<Data>(ВНИМАНИЕ ! ПРИ КОРРЕКЦИИ ОСНОВНОЙ БАЗЫ ДАННЫХ ИНДЕКСНО-</Data>
</Node>
<Node><Sub>23</Sub>
<Data>ПОИСКОВЫЙ МАССИВ НЕ ОБНОВЛЯЕТСЯ. ОБНОВЛЯЙТЕ САМИ ПО МЕРЕ</Data>
</Node>
<Node><Sub>24</Sub>
<Data>НЕОБХОДИМОСТИ...</Data>
</Node>
<Node><Sub>25</Sub>
<Data></Data>
</Node>
<Node><Sub>26</Sub>
<Data></Data>
</Node>
<Node><Sub>27</Sub>
<Data>ПРИМЕР ФОРМУЛЫ СОЗДАНИЯ ИНДЕКСОВ:</Data>
</Node>
<Node><Sub>28</Sub>
<Data></Data>
</Node>
<Node><Sub>29</Sub>
<Data><![CDATA[F k0=94:1:99,"00","01","02","03" S k1="" F  S k1=$O(@(BSD_k0)@(k1)) Q:k1=""  S k2="" F  S k2=$O(@(BSD_k0)@(k1,k2)) Q:k2=""  S k3="" F  S k3=$O(@(BSD_k0)@(k1,k2,k3)) Q:k3=""  D CRE($NA(@(BSD_k0)@(k1,k2,k3)),"$E($G(^(57),0),1,3)","$G(^(57),0)","k1","k2","k3")]]></Data>
</Node>
<Node><Sub>30</Sub>
<Data></Data>
</Node>
<Node><Sub>31</Sub>
<Data> ... то система создаст индексно-поисковый массив по</Data>
</Node>
<Node><Sub>32</Sub>
<Data> данным ТЕКУЩЕЙ КЛЕТКИ в указанной</Data>
</Node>
<Node><Sub>33</Sub>
<Data> последовательности,</Data>
</Node>
<Node><Sub>34</Sub>
<Data> только по именным ключам 94:1:99,&quot;00&quot;,&quot;01&quot;,&quot;02&quot;,&quot;03&quot; базы данных</Data>
</Node>
<Node><Sub>35</Sub>
<Data> по всем индексным ключам 1-3</Data>
</Node>
<Node><Sub>36</Sub>
<Data> сам индексно-поисковый массив будет включать:</Data>
</Node>
<Node><Sub>37</Sub>
<Data> 1-     3 символа 57 показателя</Data>
</Node>
<Node><Sub>38</Sub>
<Data> 2-     полный 57 показатель</Data>
</Node>
<Node><Sub>39</Sub>
<Data> 3-     1 индексный ключ </Data>
</Node>
<Node><Sub>40</Sub>
<Data> 4-     2 индексный ключ </Data>
</Node>
<Node><Sub>41</Sub>
<Data> 5-     3 индексный ключ </Data>
</Node>
</Node>
<Node><Sub>ForWinNT</Sub>
<Data><![CDATA[For MSM Windows NT - System Routine@@@@@@@1@1@22@80@@@@1@@5@@@1@@@ 1@@@@@16@@@1;6;37;44//1;6;36;40@@@@@@@1]]></Data>
<Node><Sub>1</Sub>
<Data>-------------------------------------------------------------------------------</Data>
</Node>
<Node><Sub>2</Sub>
<Data>|         For MSM Windows NT - System Routine                                 |</Data>
</Node>
<Node><Sub>3</Sub>
<Data>|                                                                             |</Data>
</Node>
<Node><Sub>4</Sub>
<Data>|D ^%SS            - System Status                                            |</Data>
</Node>
<Node><Sub>5</Sub>
<Data>|D ^%SP            - Space System                                             |</Data>
</Node>
<Node><Sub>6</Sub>
<Data>|D ^SSD            - System Shutdoun                                          |</Data>
</Node>
<Node><Sub>7</Sub>
<Data>|D ^SYSGEN         - System Generation                                        |</Data>
</Node>
<Node><Sub>8</Sub>
<Data>|D ^OLC            - OnLine Compression                                       |</Data>
</Node>
<Node><Sub>9</Sub>
<Data>|D ^DBMAINT        - DataBase Utility                                         |</Data>
</Node>
<Node><Sub>10</Sub>
<Data>|D ^UCIMGR         - UCI Manager                                              |</Data>
</Node>
<Node><Sub>11</Sub>
<Data>|D SERVER^%ZAPM.ed.BSTIMER - Start Shadows Tester                                     |</Data>
</Node>
<Node><Sub>12</Sub>
<Data>|D STATUS^%ZAPM.ed.BSTIMER - Status Shadows Tester                                    |</Data>
</Node>
<Node><Sub>13</Sub>
<Data>|D CLE^%ZAPM.ed.BSD2       - WipeInfo DataBase (Run in current volume)                |</Data>
</Node>
<Node><Sub>14</Sub>
<Data>|D ^LOCKTAB        - Locked Table                                             |</Data>
</Node>
<Node><Sub>15</Sub>
<Data>|D ^KILLJOB        - Jobs Terminater                                          |</Data>
</Node>
<Node><Sub>16</Sub>
<Data>-------------------------------------------------------------------------------</Data>
</Node>
</Node>
<Node><Sub>GLF1</Sub>
<Data>ССЫЛКИ НА ГЛОБАЛЬНЫЕ БУФЕРА@@@@@@@7@10@19@70@@@@1@@5@@@1@@@ 1@@@@@15@@@1;6;37;44//2;6;33;40@@@@@@@1</Data>
<Node><Sub>1</Sub>
<Data></Data>
</Node>
<Node><Sub>2</Sub>
<Data></Data>
</Node>
<Node><Sub>3</Sub>
<Data> НАДО ВВЕСТИ ПОЛНЫЕ ГЛОБАЛЬНЫЕ ССЫЛКИ НА МАССИВЫ, КОТОРЫЕ</Data>
</Node>
<Node><Sub>4</Sub>
<Data> СТАНУТ ГЛОБАЛЬНЫМИ РАЗДЕЛАМИ ВЫВОДА. НЕСКОЛЬКО РАЗДЕЛОВ</Data>
</Node>
<Node><Sub>5</Sub>
<Data> ДОПУСТИМО ВВОДИТЬ ЧЕРЕЗ РАЗДЕЛИТЕЛЬ &quot; &quot; (ПРОБЕЛ)</Data>
</Node>
<Node><Sub>6</Sub>
<Data></Data>
</Node>
<Node><Sub>7</Sub>
<Data></Data>
</Node>
<Node><Sub>8</Sub>
<Data></Data>
</Node>
<Node><Sub>9</Sub>
<Data></Data>
</Node>
<Node><Sub>10</Sub>
<Data></Data>
</Node>
<Node><Sub>11</Sub>
<Data></Data>
</Node>
<Node><Sub>12</Sub>
<Data></Data>
</Node>
<Node><Sub>13</Sub>
<Data></Data>
</Node>
<Node><Sub>14</Sub>
<Data></Data>
</Node>
<Node><Sub>15</Sub>
<Data></Data>
</Node>
</Node>
<Node><Sub>GUIDE</Sub>
<Data>ССЫЛКИ НА ДОКУМЕНТАЦИЮ В ДОС ФАЙЛАХ@@@@@1@1@1@1@22@77@@@@@1@1@@3,1@1@@@@@@@@28@1@@@@@@@@@2</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@77@@@@@1@@@@@@                 ОПИСАНИЕ КОМПЛЕКСА %BS </Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@77@@@@@1@@@@@@      =============================================</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@77@@@@@1@@@@@3,1@                    ...Содержание...@</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>4@1@1@77@@@@@1@@@@@4,1@  ...ЧТО НОВОГО ПРОИЗОШЛО ПОСЛЕ СОЗДАНИЯ 8.300 ВЕРСИИ ...@</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>5@1@1@77@@@@@1@@@@@5,1@ГЛАВА 1.Основные возможности и назначение  .................... 1-1@</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>6@1@1@77@@@@@1@@@@@6,1@ГЛАВА 2.Порядок инсталляции комплекса  ........................ 2-1@</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>7@1@1@77@@@@@1@@@@@7,1@ГЛАВА 3.Введение.Пример ввода нового пользователя %BS ......... 3-1@</Data>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>1</Sub>
<Data>8@1@1@77@@@@@1@@@@@8,1@ГЛАВА 4.Пример создания Кодификатора  ......................... 4-1@</Data>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>1</Sub>
<Data>9@1@1@77@@@@@1@@@@@9,1@ГЛАВА 5.Пример создания Таблицы Описания Базы Данных  ......... 5-1@</Data>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>1</Sub>
<Data>10@1@1@77@@@@@1@@@@@10,1@ГЛАВА 6.Пример созд-я типовой Таблицы Опис-я Списка по Б.Д. ... 6-1@</Data>
</Node>
</Node>
<Node><Sub>11</Sub>
<Node><Sub>1</Sub>
<Data>11@1@1@77@@@@@1@@@@@11,1@ГЛАВА 7.Пример создания Таблицы Описания Сводки по Б.Д. ....... 7-1@</Data>
</Node>
</Node>
<Node><Sub>12</Sub>
<Node><Sub>1</Sub>
<Data>12@1@1@77@@@@@1@@@@@12,1@ГЛАВА 8.Пример настройки Модуля Ввода информации (DDR) ........ 8-1@</Data>
</Node>
</Node>
<Node><Sub>13</Sub>
<Node><Sub>1</Sub>
<Data>13@1@1@77@@@@@1@@@@@13,1@ГЛАВА 9.Пример сеанса работы с узлами Базы Данных ............. 9-1@</Data>
</Node>
</Node>
<Node><Sub>14</Sub>
<Node><Sub>1</Sub>
<Data>14@1@1@77@@@@@1@@@@@14,1@ГЛАВА10.Пример насчета списка по Базе Данных .................. 10-1@</Data>
</Node>
</Node>
<Node><Sub>15</Sub>
<Node><Sub>1</Sub>
<Data>15@1@1@77@@@@@1@@@@@15,1@ГЛАВА11.Пример насчета сводки по Базе Данных .................. 11-1@</Data>
</Node>
</Node>
<Node><Sub>16</Sub>
<Node><Sub>1</Sub>
<Data>16@1@1@77@@@@@1@@@@@16,1@ГЛАВА12.Пример вывода таблицы(данных) на печать и ДОС-файл .... 12-1@</Data>
</Node>
</Node>
<Node><Sub>17</Sub>
<Node><Sub>1</Sub>
<Data>17@1@1@77@@@@@1@@@@@17,1@ГЛАВА13.Пример создания Автоматизированного Рабочего Места с .. 13-1@</Data>
</Node>
</Node>
<Node><Sub>18</Sub>
<Node><Sub>1</Sub>
<Data>18@1@1@77@@@@@1@@@@@18,1@ГЛАВА14.Пример модификации SETUP комплекса %BS ................ 14-1@</Data>
</Node>
</Node>
<Node><Sub>19</Sub>
<Node><Sub>1</Sub>
<Data>19@1@1@77@@@@@1@@@@@19,1@ГЛАВА15.Пример работы ком-кса с DBF-файлами(экспорт,импорт).... 15-1@</Data>
</Node>
</Node>
<Node><Sub>20</Sub>
<Node><Sub>1</Sub>
<Data>20@1@1@77@@@@@1@@@@@20,1@ГЛАВА16.Пример расширения возможностей настройки таблицы ...... 16-1@</Data>
</Node>
</Node>
<Node><Sub>21</Sub>
<Node><Sub>1</Sub>
<Data>21@1@1@77@@@@@1@@@@@21,1@ГЛАВА17.Пример создания широкой таблицы ....................... 17-1@</Data>
</Node>
</Node>
<Node><Sub>22</Sub>
<Node><Sub>1</Sub>
<Data>22@1@1@77@@@@@1@@@@@22,1@ГЛАВА18.Пример создания нетипового списка по базе данных....... 18-1@</Data>
</Node>
</Node>
<Node><Sub>23</Sub>
<Node><Sub>1</Sub>
<Data>23@1@1@77@@@@@1@@@@@23,1@ГЛАВА19.Раздел таблиц по умолчанию ............................ 19-1@</Data>
</Node>
</Node>
<Node><Sub>24</Sub>
<Node><Sub>1</Sub>
<Data>24@1@1@77@@@@@1@@@@@24,1@ГЛАВА20.MSM-NET технология в комплексе %BS .................... 20-1@</Data>
</Node>
</Node>
<Node><Sub>25</Sub>
<Node><Sub>1</Sub>
<Data>25@1@1@77@@@@@1@@@@@25,1@ГЛАВА21.Создание и Инсталляция приложений в комплексе %BS ..... 21-1@</Data>
</Node>
</Node>
<Node><Sub>26</Sub>
<Node><Sub>1</Sub>
<Data>26@1@1@77@@@@@1@@@@@26,1@ГЛАВА22.Предобработка Функцианальных Клавиш.................... 22-1@</Data>
</Node>
</Node>
<Node><Sub>27</Sub>
<Node><Sub>1</Sub>
<Data>27@1@1@77@@@@@1@@@@@27,1@ГЛАВА23.Таблицы Аналитических Форм............................. 23-1@</Data>
</Node>
</Node>
<Node><Sub>28</Sub>
<Node><Sub>1</Sub>
<Data>28@1@1@77@@@@@1@@@@@28,1@ГЛАВА24.РЕЖИМЫ АДМИНИСТРАТОРА ................................. П1-1@</Data>
</Node>
</Node>
<Node><Sub>CMD</Sub>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>D HELP^%ZAPM.ed.BSDOS2(0)</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>D NEW^%ZAPM.ed.BSDOS2(0)</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>D HELP^%ZAPM.ed.BSDOS2(1)</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>D HELP^%ZAPM.ed.BSDOS2(2)</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>D HELP^%ZAPM.ed.BSDOS2(3)</Data>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>1</Sub>
<Data>D HELP^%ZAPM.ed.BSDOS2(4)</Data>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>1</Sub>
<Data>D HELP^%ZAPM.ed.BSDOS2(5)</Data>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>1</Sub>
<Data>D HELP^%ZAPM.ed.BSDOS2(6)</Data>
</Node>
</Node>
<Node><Sub>11</Sub>
<Node><Sub>1</Sub>
<Data>D HELP^%ZAPM.ed.BSDOS2(7)</Data>
</Node>
</Node>
<Node><Sub>12</Sub>
<Node><Sub>1</Sub>
<Data>D HELP^%ZAPM.ed.BSDOS2(8)</Data>
</Node>
</Node>
<Node><Sub>13</Sub>
<Node><Sub>1</Sub>
<Data>D HELP^%ZAPM.ed.BSDOS2(9)</Data>
</Node>
</Node>
<Node><Sub>14</Sub>
<Node><Sub>1</Sub>
<Data>D HELP^%ZAPM.ed.BSDOS2(10)</Data>
</Node>
</Node>
<Node><Sub>15</Sub>
<Node><Sub>1</Sub>
<Data>D HELP^%ZAPM.ed.BSDOS2(11)</Data>
</Node>
</Node>
<Node><Sub>16</Sub>
<Node><Sub>1</Sub>
<Data>D HELP^%ZAPM.ed.BSDOS2(12)</Data>
</Node>
</Node>
<Node><Sub>17</Sub>
<Node><Sub>1</Sub>
<Data>D HELP^%ZAPM.ed.BSDOS2(13)</Data>
</Node>
</Node>
<Node><Sub>18</Sub>
<Node><Sub>1</Sub>
<Data>D HELP^%ZAPM.ed.BSDOS2(14)</Data>
</Node>
</Node>
<Node><Sub>19</Sub>
<Node><Sub>1</Sub>
<Data>D HELP^%ZAPM.ed.BSDOS2(15)</Data>
</Node>
</Node>
<Node><Sub>20</Sub>
<Node><Sub>1</Sub>
<Data>D HELP^%ZAPM.ed.BSDOS2(16)</Data>
</Node>
</Node>
<Node><Sub>21</Sub>
<Node><Sub>1</Sub>
<Data>D HELP^%ZAPM.ed.BSDOS2(17)</Data>
</Node>
</Node>
<Node><Sub>22</Sub>
<Node><Sub>1</Sub>
<Data>D HELP^%ZAPM.ed.BSDOS2(18)</Data>
</Node>
</Node>
<Node><Sub>23</Sub>
<Node><Sub>1</Sub>
<Data>D HELP^%ZAPM.ed.BSDOS2(19)</Data>
</Node>
</Node>
<Node><Sub>24</Sub>
<Node><Sub>1</Sub>
<Data>D HELP^%ZAPM.ed.BSDOS2(20)</Data>
</Node>
</Node>
<Node><Sub>25</Sub>
<Node><Sub>1</Sub>
<Data>D HELP^%ZAPM.ed.BSDOS2(21)</Data>
</Node>
</Node>
<Node><Sub>26</Sub>
<Node><Sub>1</Sub>
<Data>D HELP^%ZAPM.ed.BSDOS2(22)</Data>
</Node>
</Node>
<Node><Sub>27</Sub>
<Node><Sub>1</Sub>
<Data>D HELP^%ZAPM.ed.BSDOS2(23)</Data>
</Node>
</Node>
<Node><Sub>28</Sub>
<Node><Sub>1</Sub>
<Data>D HELP^%ZAPM.ed.BSDOS2(24)</Data>
</Node>
</Node>
<Node><Sub>29</Sub>
<Node><Sub>1</Sub>
<Data>D HELP^%ZAPM.ed.BSDOS2(25)</Data>
</Node>
</Node>
<Node><Sub>31</Sub>
<Node><Sub>1</Sub>
<Data>D HELPP^%ZAPM.ed.BSDOS2(1)</Data>
</Node>
</Node>
<Node><Sub>32</Sub>
<Node><Sub>1</Sub>
<Data>D HELPP^%ZAPM.ed.BSDOS2(2)</Data>
</Node>
</Node>
<Node><Sub>33</Sub>
<Node><Sub>1</Sub>
<Data>D HELPP^%ZAPM.ed.BSDOS2(3)</Data>
</Node>
</Node>
<Node><Sub>34</Sub>
<Node><Sub>1</Sub>
<Data>D HELPP^%ZAPM.ed.BSDOS2(4)</Data>
</Node>
</Node>
<Node><Sub>35</Sub>
<Node><Sub>1</Sub>
<Data>D HELPP^%ZAPM.ed.BSDOS2(5)</Data>
</Node>
</Node>
<Node><Sub>36</Sub>
<Node><Sub>1</Sub>
<Data>D HELPP^%ZAPM.ed.BSDOS2(6)</Data>
</Node>
</Node>
<Node><Sub>37</Sub>
<Node><Sub>1</Sub>
<Data>D HELPP^%ZAPM.ed.BSDOS2(7)</Data>
</Node>
</Node>
<Node><Sub>38</Sub>
<Node><Sub>1</Sub>
<Data>D HELPP^%ZAPM.ed.BSDOS2(8)</Data>
</Node>
</Node>
<Node><Sub>39</Sub>
<Node><Sub>1</Sub>
<Data>D HELPP^%ZAPM.ed.BSDOS2(9)</Data>
</Node>
</Node>
<Node><Sub>40</Sub>
<Node><Sub>1</Sub>
<Data>D HELPP^%ZAPM.ed.BSDOS2(10)</Data>
</Node>
</Node>
<Node><Sub>41</Sub>
<Node><Sub>1</Sub>
<Data>D HELPP^%ZAPM.ed.BSDOS2(11)</Data>
</Node>
</Node>
<Node><Sub>42</Sub>
<Node><Sub>1</Sub>
<Data>D HELPP^%ZAPM.ed.BSDOS2(12)</Data>
</Node>
</Node>
<Node><Sub>43</Sub>
<Node><Sub>1</Sub>
<Data>D HELPP^%ZAPM.ed.BSDOS2(13)</Data>
</Node>
</Node>
<Node><Sub>44</Sub>
<Node><Sub>1</Sub>
<Data>D HELPP^%ZAPM.ed.BSDOS2(14)</Data>
</Node>
</Node>
<Node><Sub>45</Sub>
<Node><Sub>1</Sub>
<Data>D HELPP^%ZAPM.ed.BSDOS2(15)</Data>
</Node>
</Node>
<Node><Sub>46</Sub>
<Node><Sub>1</Sub>
<Data>D HELPP^%ZAPM.ed.BSDOS2(16)</Data>
</Node>
</Node>
<Node><Sub>47</Sub>
<Node><Sub>1</Sub>
<Data>D HELPP^%ZAPM.ed.BSDOS2(17)</Data>
</Node>
</Node>
<Node><Sub>48</Sub>
<Node><Sub>1</Sub>
<Data>D HELPP^%ZAPM.ed.BSDOS2(18)</Data>
</Node>
</Node>
<Node><Sub>49</Sub>
<Node><Sub>1</Sub>
<Data>D HELPP^%ZAPM.ed.BSDOS2(19)</Data>
</Node>
</Node>
<Node><Sub>50</Sub>
<Node><Sub>1</Sub>
<Data>D HELPP^%ZAPM.ed.BSDOS2(20)</Data>
</Node>
</Node>
<Node><Sub>51</Sub>
<Node><Sub>1</Sub>
<Data>D HELPP^%ZAPM.ed.BSDOS2(21)</Data>
</Node>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>60200,54023,Styx</Data>
</Node>
<Node><Sub>STA</Sub>
<Data>28,1@9@1@27@-1@-1@22@1@ГЛАВА24.РЕЖИМЫ АДМИНИСТРАТОРА ................................. П1-1</Data>
</Node>
</Node>
<Node><Sub>HELP-ALTF2</Sub>
<Data><![CDATA[СОЗДАНИЕ СТРОЧНО-БЛОЧНОГО МЕНЮ И ПАНЕЛИ С КНОПКАМИ@@@@@@@1@1@22@80@@@@1@@5@@@1@@@@@@@@85@@@2;6;36;44///2;6;36;44/2;6;37;44@@@@@@@1]]></Data>
<Node><Sub>1</Sub>
<Data>                 1.   Поpядок создания СБ меню</Data>
</Node>
<Node><Sub>2</Sub>
<Data></Data>
</Node>
<Node><Sub>3</Sub>
<Data>        В %BS есть возможности пользователю самому создать стpочно-блочное</Data>
</Node>
<Node><Sub>4</Sub>
<Data>(СБ) меню и пpекpепить его к опpеделенной таблице. Для этого можно использо-</Data>
</Node>
<Node><Sub>5</Sub>
<Data>вать текущую таблицу.</Data>
</Node>
<Node><Sub>6</Sub>
<Data>- Количество колонок должно быть не меньше чем максимальное количество пунк-</Data>
</Node>
<Node><Sub>7</Sub>
<Data>  тов у будующего СБ меню.</Data>
</Node>
<Node><Sub>8</Sub>
<Data>- Количество стpок должно быть не меньше количества вложенностей</Data>
</Node>
<Node><Sub>9</Sub>
<Data>  вашего меню .</Data>
</Node>
<Node><Sub>10</Sub>
<Data></Data>
</Node>
<Node><Sub>11</Sub>
<Data></Data>
</Node>
<Node><Sub>12</Sub>
<Data>- В пеpвой стpоке в клетке вводятся данные в фоpмате:</Data>
</Node>
<Node><Sub>13</Sub>
<Data>  &quot;ТЕКСТ_ПУНКТ_МЕНЮ_текстпояснения к пункту меню&quot;</Data>
</Node>
<Node><Sub>14</Sub>
<Data>Если пункт меню не имеет вложенного подменю, то он должен заканчиваться</Data>
</Node>
<Node><Sub>15</Sub>
<Data>входом в какую-то таблицу или выполнением команды MUMPS (F4,ОП,ТАВ)</Data>
</Node>
<Node><Sub>16</Sub>
<Data>Если пункт меню имеет ответвление , то  мы вводим в меню команду MUMPS:</Data>
</Node>
<Node><Sub>17</Sub>
<Data>1_2 и в стpоке 2 с колонки 1 вводим пункты меню, аналогично 1.2</Data>
</Node>
<Node><Sub>18</Sub>
<Data>После того как СБ меню мы полность описали</Data>
</Node>
<Node><Sub>19</Sub>
<Data></Data>
</Node>
<Node><Sub>20</Sub>
<Data>                    Фоpмиpование СБ меню</Data>
</Node>
<Node><Sub>21</Sub>
<Data></Data>
</Node>
<Node><Sub>22</Sub>
<Data>- запоминаем pезультаты коppекции F3,</Data>
</Node>
<Node><Sub>23</Sub>
<Data>- устанавливаем указатель в пеpвую стpоку,</Data>
</Node>
<Node><Sub>24</Sub>
<Data>- входим в pежим сеpвиса F6, создать, Блочное меню ,</Data>
</Node>
<Node><Sub>25</Sub>
<Data>- подтвеpждаем наше намеpение,</Data>
</Node>
<Node><Sub>26</Sub>
<Data>- опpеделяем к какой таблице мы пpекpепляем наше меню,</Data>
</Node>
<Node><Sub>27</Sub>
<Data>- опpеделяем в какой таблице будем его хpанить.</Data>
</Node>
<Node><Sub>28</Sub>
<Data>(Если ваше СБ меню должно пpекpепляться к нескольким таблицам, то целесо-</Data>
</Node>
<Node><Sub>29</Sub>
<Data>обpазно хpанить само меню в текущей таблице, а пpикpепленное меню пpовести</Data>
</Node>
<Node><Sub>30</Sub>
<Data>для каждой таблице по п.п.1.3)</Data>
</Node>
<Node><Sub>31</Sub>
<Data>(Пpимеp таблица описания СБ меню можно посмотpеть в pазделе %BSS. вызов</Data>
</Node>
<Node><Sub>32</Sub>
<Data>Alt-F2).</Data>
</Node>
<Node><Sub>33</Sub>
<Data>Для того чтобы пpовеpить pаботу СБ меню войдите в ту таблицу, куда вы пpек-</Data>
</Node>
<Node><Sub>34</Sub>
<Data>pепили СБ меню и введите команду &lt;Alt-F2&gt;. В 24 стpоки экpана должно поя-</Data>
</Node>
<Node><Sub>35</Sub>
<Data>виться ваше СБ меню. Пpотестиpуйте его входом во все пункты.</Data>
</Node>
<Node><Sub>36</Sub>
<Data>ВНИМАНИЕ!!!!  Очень остоpожно  используйте в СБ меню вызовы выполнения</Data>
</Node>
<Node><Sub>37</Sub>
<Data>команд MUMPS. Некоppектное удаление или пеpеопpеделение пеpеменных исполь-</Data>
</Node>
<Node><Sub>38</Sub>
<Data>зуемых %BS фатально сложется на pаботу комплекса.</Data>
</Node>
<Node><Sub>39</Sub>
<Data>        (смотрите пример таблицы ALTF2 раздела %BSS)</Data>
</Node>
<Node><Sub>40</Sub>
<Data></Data>
</Node>
<Node><Sub>41</Sub>
<Data>                 2.   Поpядок создания Панели с кнопками</Data>
</Node>
<Node><Sub>42</Sub>
<Data></Data>
</Node>
<Node><Sub>43</Sub>
<Data>      В %BS есть возможности пользователю самому создать Панель с кнопками</Data>
</Node>
<Node><Sub>44</Sub>
<Data></Data>
</Node>
<Node><Sub>45</Sub>
<Data>           Для этого можно использовать текущую таблицу.</Data>
</Node>
<Node><Sub>46</Sub>
<Data>- Количество стpок должно быть не меньше чем максимальное количество кнопок</Data>
</Node>
<Node><Sub>47</Sub>
<Data>  у будующей панели</Data>
</Node>
<Node><Sub>48</Sub>
<Data></Data>
</Node>
<Node><Sub>49</Sub>
<Data>- В пеpвой колонке вводятся данные ,которые в панели будут играть</Data>
</Node>
<Node><Sub>50</Sub>
<Data>  роль поясняющего текста.</Data>
</Node>
<Node><Sub>51</Sub>
<Data>- Во второй колонке вводятся тексты кнопок и, Если по нажатию кнопки</Data>
</Node>
<Node><Sub>52</Sub>
<Data>  необходимы входы в какую-то таблицу или выполнение команды</Data>
</Node>
<Node><Sub>53</Sub>
<Data>  MUMPS - ВХОДЫ В ТАБЛИЦЫ ИЛИ КОМАНДЫ MSM (F4,ОП,ТАВ)</Data>
</Node>
<Node><Sub>54</Sub>
<Data>- В 3 колонке вводятся данные ,которые должна возвращать таблица-панель</Data>
</Node>
<Node><Sub>55</Sub>
<Data>  при выборе соответствующей кнопки.</Data>
</Node>
<Node><Sub>56</Sub>
<Data>- В 4 колонке вводится &quot;GO&quot; в каждой строке ,где в кнопке вызов таблицы</Data>
</Node>
<Node><Sub>57</Sub>
<Data>  или команды определен ,но возврат в панель не нужен</Data>
</Node>
<Node><Sub>58</Sub>
<Data>- Расположение панели на экране будет центрировано , если координаты</Data>
</Node>
<Node><Sub>59</Sub>
<Data>  таблицы останутся неизменные - X=1,Y=1.  Или будут определены координатами</Data>
</Node>
<Node><Sub>60</Sub>
<Data>  таблицы.</Data>
</Node>
<Node><Sub>61</Sub>
<Data>- Предустановка указателя осуществляется на ту кнопку в описателе, которой</Data>
</Node>
<Node><Sub>62</Sub>
<Data>  есть функция логического контроля</Data>
</Node>
<Node><Sub>63</Sub>
<Data>- Заголовком панели будет коментарий таблицы</Data>
</Node>
<Node><Sub>64</Sub>
<Data>- Цвет панели определяется цветом всей таблицы</Data>
</Node>
<Node><Sub>65</Sub>
<Data>- Цвет каждой строки текста определяется цветом этой строки</Data>
</Node>
<Node><Sub>66</Sub>
<Data>- Цвет пассивной кнопки - цвет кнопки 1 строки</Data>
</Node>
<Node><Sub>67</Sub>
<Data>- Цвет активной кнопки - цвет кнопки 2 строки</Data>
</Node>
<Node><Sub>68</Sub>
<Data></Data>
</Node>
<Node><Sub>69</Sub>
<Data>                    Фоpмиpование Панели с кнопками</Data>
</Node>
<Node><Sub>70</Sub>
<Data></Data>
</Node>
<Node><Sub>71</Sub>
<Data>- запоминаем pезультаты коppекции F3,</Data>
</Node>
<Node><Sub>72</Sub>
<Data>- устанавливаем указатель в пеpвую стpоку,</Data>
</Node>
<Node><Sub>73</Sub>
<Data>- входим в pежим сеpвиса F6, создать,  Панели с кнопками ,</Data>
</Node>
<Node><Sub>74</Sub>
<Data>- подтвеpждаем наше намеpение, если это необходимо</Data>
</Node>
<Node><Sub>75</Sub>
<Data></Data>
</Node>
<Node><Sub>76</Sub>
<Data>Для того чтобы пpовеpить pаботу  Панели с кнопками войдите в ту таблицу,</Data>
</Node>
<Node><Sub>77</Sub>
<Data>куда вы пpекpепили Панель с кнопками.</Data>
</Node>
<Node><Sub>78</Sub>
<Data>Пpотестиpуйте его входом во все пункты.</Data>
</Node>
<Node><Sub>79</Sub>
<Data></Data>
</Node>
<Node><Sub>80</Sub>
<Data>ВНИМАНИЕ!!!!  Очень остоpожно  используйте в Панелях с кнопками вызовы</Data>
</Node>
<Node><Sub>81</Sub>
<Data>выполнения команд MUMPS. Некоppектное удаление или пеpеопpеделение пеpеменных</Data>
</Node>
<Node><Sub>82</Sub>
<Data>используемых %BS фатально сложется на pаботу комплекса.</Data>
</Node>
<Node><Sub>83</Sub>
<Data>        (смотрите пример таблицы REPAIR раздела %BSS)</Data>
</Node>
<Node><Sub>84</Sub>
<Data>ДЛЯ ТОГО ЧТОБЫ ВОЙТИ В РЕЖИМ РЕДАКТИРОВАНИЯ ПАНЕЛИ С КНОПКАМИ ВВЕДИТЕ</Data>
</Node>
<Node><Sub>85</Sub>
<Data>                    КОМАНДУ &lt;ALT-F&gt; !!!!</Data>
</Node>
</Node>
<Node><Sub>HELPGE</Sub>
<Data><![CDATA[РЕЖИМЫ РЕДАКТИРОВАНИЯ МАССИВА@@@@@@@2@4@22@78@@@@1@@5@@@1@@@@@@@@19@@@2;6;30;42///2;6;34;42/2;6;30;42@@@@@@@1]]></Data>
<Node><Sub>1</Sub>
<Data>  &lt;Del&gt;      - УДАЛЕНИЕ ТЕКУЩЕГО СИМВОЛА</Data>
</Node>
<Node><Sub>2</Sub>
<Data>  &lt;Ctrl-P&gt;   - ПЕРЕХОД ДЛЯ РЕДАКТИРОВАНИЯ В ПОЛЕ ИНДЕКСОВ</Data>
</Node>
<Node><Sub>3</Sub>
<Data>  &lt;Ctrl-K&gt;   - УДАЛЕНИЕ ТЕКУЩЕГО УЗЛА СО ВСЕМИ ПОТОМКАМИ</Data>
</Node>
<Node><Sub>4</Sub>
<Data>  &lt;Alt-K&gt;    - УДАЛЕНИЕ ТЕКУЩЕГО УЗЛА БЕЗ УДАЛЕНИЯ ПОТОМКОВ</Data>
</Node>
<Node><Sub>5</Sub>
<Data>  &lt;Ctrl-]&gt;   - УДАЛИТЬ СИМВОЛЫ В СТРОКЕ ОТ МАРКЕРА И ДО КОНЦА</Data>
</Node>
<Node><Sub>6</Sub>
<Data>  &lt;Home&gt;     - УСТАНОВКА МАРКЕРА НА НАЧАЛО СТРОКИ</Data>
</Node>
<Node><Sub>7</Sub>
<Data>  &lt;End&gt;      - УСТАНОВКА МАРКЕРА НА КОНЕЦ СТРОКИ</Data>
</Node>
<Node><Sub>8</Sub>
<Data>  &lt;Tab&gt;      - УСТАНОВКА МАРКЕРА НА 10 СИМВОЛОВ ПРАВЕЕ</Data>
</Node>
<Node><Sub>9</Sub>
<Data>  &lt;Shift-Tab&gt;- УСТАНОВКА МАРКЕРА НА 10 СИМВОЛОВ ЛЕВЕЕ</Data>
</Node>
<Node><Sub>10</Sub>
<Data>  &lt;Esc&gt;      - ВЫХОД ИЗ РЕДАКТОРА</Data>
</Node>
<Node><Sub>11</Sub>
<Data>  &lt;Ctrl-J&gt;   - ОТМЕНИТЬ КОРРЕКЦИЮ ТЕКУЩЕЙ СТРОКИ</Data>
</Node>
<Node><Sub>12</Sub>
<Data>  &lt;Ctrl-L&gt;   - ЗАПОМНИТЬ ФРАГМЕНТ СТРОКИ ОТ МАРКЕРА И ПРАВЕЕ</Data>
</Node>
<Node><Sub>13</Sub>
<Data>  &lt;Ctrl-T&gt;   - ВСТАВИТЬ ФРАГМЕНТ СТРОКИ КОТОРЫЙ ЗАПОМНИЛИ ПО &lt;Ctrl-L&gt;</Data>
</Node>
<Node><Sub>14</Sub>
<Data>  &lt;Ctrl-F5&gt;  - КОПИРОВАТЬ ТЕКУЩИЙ УЗЕЛ В БУФЕР</Data>
</Node>
<Node><Sub>15</Sub>
<Data>  &lt;Ctrl-F6&gt;  - КОПИРОВАТЬ ИЗ БУФЕРА В ТЕКУЩИЙ УЗЕЛ</Data>
</Node>
<Node><Sub>16</Sub>
<Data>  &lt;Alt-T&gt;    - ПРОСМОТР ИСТОРИЮ &lt;Ctrl-L&gt; С ВЫБОРОМ И ВСТАВКИ В СТРОКУ</Data>
</Node>
<Node><Sub>17</Sub>
<Data>  &lt;Insert&gt;   - ВКЛЮЧИТЬ / ВЫКЛЮЧИТЬ РЕЖИМ ВСТАВКИ</Data>
</Node>
<Node><Sub>18</Sub>
<Data>  &lt;Shift-F1&gt; - СМОТРЕТЬ ДОКУМЕНТАЦИЮ НА %BS</Data>
</Node>
<Node><Sub>19</Sub>
<Data>  &lt;Alt-F10&gt;  - ВХОД В КОМАНДНЫЙ ПРОЦЕССОР MSM C ВОЗМОЖНОСТЬЮ ВОЗВРАТА</Data>
</Node>
</Node>
<Node><Sub>HELPGI</Sub>
<Data><![CDATA[РЕЖИМЫ РЕДАКТИРОВАНИЯ ИНДЕКСОВ МАССИВА@@@@@@@3@4@20@78@@@@1@@5@@@1@@@@@@@@@@@2;6;30;42///2;6;34;42/2;6;30;42@@@@@@@1]]></Data>
<Node><Sub>1</Sub>
<Data></Data>
</Node>
<Node><Sub>2</Sub>
<Data></Data>
</Node>
<Node><Sub>3</Sub>
<Data>  &lt;F1&gt;       - ПОМОЩЬ</Data>
</Node>
<Node><Sub>4</Sub>
<Data>  &lt;Ctrl-P&gt;   - ПЕРЕХОД ДЛЯ РЕДАКТИРОВАНИЯ В ПОЛЕ СТРОК</Data>
</Node>
<Node><Sub>5</Sub>
<Data>  &lt;Tab&gt;      - УСТАНОВКА МАРКЕРА НА 10 СИМВОЛОВ ПРАВЕЕ</Data>
</Node>
<Node><Sub>6</Sub>
<Data>  &lt;Shift-Tab&gt;- УСТАНОВКА МАРКЕРА НА 10 СИМВОЛОВ ЛЕВЕЕ</Data>
</Node>
<Node><Sub>7</Sub>
<Data>  &lt;Esc&gt;      - ВЫХОД ИЗ РЕДАКТОРА ИНДЕКСОВ </Data>
</Node>
<Node><Sub>8</Sub>
<Data>  &lt;Ctrl-L&gt;   - ЗАПОМНИТЬ ФРАГМЕНТ СТРОКИ ОТ МАРКЕРА И ПРАВЕЕ</Data>
</Node>
<Node><Sub>9</Sub>
<Data>  &lt;Ctrl-T&gt;   - ВСТАВИТЬ ФРАГМЕНТ СТРОКИ</Data>
</Node>
<Node><Sub>10</Sub>
<Data>  &lt;Insert&gt;   - ВКЛЮЧИТЬ / ВЫКЛЮЧИТЬ РЕЖИМ ВСТАВКИ</Data>
</Node>
<Node><Sub>11</Sub>
<Data></Data>
</Node>
<Node><Sub>12</Sub>
<Data></Data>
</Node>
<Node><Sub>13</Sub>
<Data></Data>
</Node>
<Node><Sub>14</Sub>
<Data></Data>
</Node>
<Node><Sub>15</Sub>
<Data></Data>
</Node>
<Node><Sub>16</Sub>
<Data></Data>
</Node>
<Node><Sub>17</Sub>
<Data></Data>
</Node>
</Node>
<Node><Sub>HELPGL</Sub>
<Data><![CDATA[РЕЖИМЫ ПРОСМОТРА МАССИВА@@@@@@@3@5@19@70@@@@1@@5@@@1@@@@@@@@14@@@2;6;30;42///2;6;34;42/2;6;30;42@@@@@@@1]]></Data>
<Node><Sub>1</Sub>
<Data></Data>
</Node>
<Node><Sub>2</Sub>
<Data>  DOWN - СКРОЛИНГ МАССИВА ВНИЗ ПО ДЕРЕВУ</Data>
</Node>
<Node><Sub>3</Sub>
<Data>  UP   - СКРОЛИНГ МАССИВА ВВЕРХ ПО ДЕРЕВУ</Data>
</Node>
<Node><Sub>4</Sub>
<Data>  PgDn - ЛИСТАНИЕ МАССИВА ВНИЗ НА СТРАНИЦУ</Data>
</Node>
<Node><Sub>5</Sub>
<Data>  PgUp - ЛИСТАНИЕ МАССИВА ВВЕРХ НА СТРАНИЦУ</Data>
</Node>
<Node><Sub>6</Sub>
<Data>  +    - УВЕЛИЧЕНИЕ СКОРОСТИ СКРОЛИНГА</Data>
</Node>
<Node><Sub>7</Sub>
<Data>  -    - УМЕНЬШЕНИЕ СКОРОСТИ СКРОЛИНГА</Data>
</Node>
<Node><Sub>8</Sub>
<Data>  F4   - ВХОД В РЕДАКТОР МАССИВА</Data>
</Node>
<Node><Sub>9</Sub>
<Data>  F5   - ВКЛЮЧЕНИЕ РЕЖИМА ПРОСМОТРА/РЕДАКТИРОВАНИЯ</Data>
</Node>
<Node><Sub>10</Sub>
<Data>         МАССИВА ПО ДЕРЕВУ</Data>
</Node>
<Node><Sub>11</Sub>
<Data>  F6   - ФИЛЬТР ПРОСМОТРА</Data>
</Node>
<Node><Sub>12</Sub>
<Data>  F7   - УСТАНОВКА НА ОПРЕДЕЛЕННУЮ ССЫЛКУ</Data>
</Node>
<Node><Sub>13</Sub>
<Data></Data>
</Node>
<Node><Sub>14</Sub>
<Data></Data>
</Node>
</Node>
<Node><Sub>HELP_F</Sub>
<Data><![CDATA[ОПИСАНИЕ ПРИМЕНЕНИЯ ФИЛЬТРА@@@@@@@3@4@20@78@@@@1@@5@@@1@@@@@@@@@@@2;6;30;42///2;6;34;42/2;6;30;42@@@@@@@1]]></Data>
<Node><Sub>1</Sub>
<Data></Data>
</Node>
<Node><Sub>2</Sub>
<Data></Data>
</Node>
<Node><Sub>3</Sub>
<Data>        ВВОДИТЕ ФИЛЬТР ПРОСМОТРА МАССИВА В ВВИДЕ КОМАНДЫ IF</Data>
</Node>
<Node><Sub>4</Sub>
<Data>  </Data>
</Node>
<Node><Sub>5</Sub>
<Data>          g=ПЕРЕМЕННАЯ СОДЕРЖАЩАЯ ССЫЛКУ НА НА МАССИВ</Data>
</Node>
<Node><Sub>6</Sub>
<Data></Data>
</Node>
<Node><Sub>7</Sub>
<Data>          @g - СОДЕРЖИТ ДАННЫЕ МАССИВА</Data>
</Node>
<Node><Sub>8</Sub>
<Data></Data>
</Node>
<Node><Sub>9</Sub>
<Data>        НАПРИМЕР: ЕСЛИ МЫ ХОТИМ, ЧТОБЫ ПРИ ПРОСМОТРЕ НАМ ПОКАЗАЛИ</Data>
</Node>
<Node><Sub>10</Sub>
<Data>                  ТОЛЬКО УЗЛЫ НА ПЕРВОМ УРОВНЕ СОДЕРЖАЩИЕ &quot;5&quot;,А </Data>
</Node>
<Node><Sub>11</Sub>
<Data>                  ДАННЫЕ - ВКЛЮЧАЮТ &quot;0&quot; ,ТО ФИЛЬТР БУДЕТ ТАКОЙ</Data>
</Node>
<Node><Sub>12</Sub>
<Data></Data>
</Node>
<Node><Sub>13</Sub>
<Data>                I $P($P(g,&quot;,&quot;),&quot;(&quot;,2)[&quot;5&quot;,@g[&quot;0&quot;</Data>
</Node>
</Node>
<Node><Sub>KEY_BD</Sub>
<Data><![CDATA[ОПИСАНИЕ РАБОТЫ С УЗЛАМИ БАЗЫ ДАННЫХ@@@@@@@1@1@22@80@@@@1@@5@@@1@@@@@@@@29@@@2;6;36;44///2;6;36;44/2;6;37;44@@@@@@@1]]></Data>
<Node><Sub>1</Sub>
<Data>    - УСТАНОВИТЕ УКАЗАТЕЛЬ НА НУЖНЫЙ УЗЕЛ И ВВЕДИТЕ &lt;Enter&gt; ,ДЛЯ РАСКРЫТИЯ</Data>
</Node>
<Node><Sub>2</Sub>
<Data>      СООТВЕТСТВУЮЩЕГО УЗЛА БАЗЫ ДАННЫХ;</Data>
</Node>
<Node><Sub>3</Sub>
<Data>    - ДЛЯ ВВОДА НОВОГО УЗЛА УСТАНОВИТЕ УКАЗАТЕЛЬ НА 2 СТРОКУ И ВВЕДИТЕ &lt;Enter&gt;</Data>
</Node>
<Node><Sub>4</Sub>
<Data>    - ДЛЯ ВОЗВРАТА НА ПРЕДИДУЩИЙ УРОВЕНЬ УЗЛОВ ВВЕДИТЕ &lt;Esc&gt;,ИЛИ</Data>
</Node>
<Node><Sub>5</Sub>
<Data>      ВВЕДИТЕ &lt;Enter&gt; УСТАНОВИВ УКАЗАТЕЛЬ НА 1 СТРОКУ;</Data>
</Node>
<Node><Sub>6</Sub>
<Data> &lt;F3&gt; - ВВОД ИЛИ ИЗМЕНЕНИЕ ПАРОЛЯ НА УЗЕЛ БАЗЫ ДАННЫХ НА КОТОРОМ СТОИТ</Data>
</Node>
<Node><Sub>7</Sub>
<Data>        УКАЗАТЕЛЬ</Data>
</Node>
<Node><Sub>8</Sub>
<Data> &lt;F4&gt; - ВОЙТИ В ТАБЛИЦУ ОПИСАНИЯ БАЗЫ ДАННЫХ ДЛЯ ЕЁ МОДИФИКАЦИИ</Data>
</Node>
<Node><Sub>9</Sub>
<Data> &lt;F5&gt; - СОХРАНЕНИЕ / ВОССТАНОВЛЕНИЕ УЗЛОВ БД В DOS-ФАЙЛЕ</Data>
</Node>
<Node><Sub>10</Sub>
<Data> &lt;F6&gt; - РАБОТА С УЗЛАМИ БД (СУММИРОВАНИЕ,ДУБЛИРОВАНИЕ,ПОИСК,ПЕРЕЗАПИСЬ И Т.Д.)</Data>
</Node>
<Node><Sub>11</Sub>
<Data> &lt;F7&gt; - ПРИКРЕПИТЬ НА УЗЕЛ ТАБЛИЦУ;</Data>
</Node>
<Node><Sub>12</Sub>
<Data>        ДЛЯ ЭТОГО РАСКРОЙТЕ УЗЕЛ НА КОТОРОМ НЕТ ДАННЫХ И ВВЕДИТЕ &lt;F7&gt;</Data>
</Node>
<Node><Sub>13</Sub>
<Data>        ОПРЕДЕЛИТЕ ССЫЛКУ НА ПРИКРЕПЛЕННУЮ ТАБЛИЦУ (ЕСЛИ В ЭТОЙ ТАБЛИЦЕ</Data>
</Node>
<Node><Sub>14</Sub>
<Data>        ЕСТЬ КЛЕТКИ ХРАНЯЩИЕСЯ В БД,ТО ДАННЫЕ БУДУТ ХРАНИТСЯ НА УЗЛЕ К</Data>
</Node>
<Node><Sub>15</Sub>
<Data>        КОТОРОМУ ПРИКРЕПЛЕНА ТАБЛИЦА)</Data>
</Node>
<Node><Sub>16</Sub>
<Data> &lt;F8&gt; - ОТКРЕПИТЬ ТАБЛИЦУ ОТ УЗЛА ИЛИ УДАЛИТЬ УЗЕЛ БАЗЫ ДАННЫХ;</Data>
</Node>
<Node><Sub>17</Sub>
<Data>В таблице ключей вправее может быть представленна дополнительная информация</Data>
</Node>
<Node><Sub>18</Sub>
<Data>о ключе. например:(16:34 ПП 26.11.93 user,flag)</Data>
</Node>
<Node><Sub>19</Sub>
<Data>                     |       |        |    |--- . логических ошибок нет</Data>
</Node>
<Node><Sub>20</Sub>
<Data>                     |       |        |    |--- ? контроль не производился</Data>
</Node>
<Node><Sub>21</Sub>
<Data>                     |       |        |    ---- ! есть логические ошибки</Data>
</Node>
<Node><Sub>22</Sub>
<Data>                     |       |        ---- имя пользователя</Data>
</Node>
<Node><Sub>23</Sub>
<Data>                     |       --- дата последней модификации данных узла</Data>
</Node>
<Node><Sub>24</Sub>
<Data>                     --- время последней модификации данных узла</Data>
</Node>
<Node><Sub>25</Sub>
<Data></Data>
</Node>
<Node><Sub>26</Sub>
<Data>  &lt;Ctrl-F5&gt;  - КОПИРОВАТЬ ДЕРЕВО УЗЛОВ БД В БУФЕР                             </Data>
</Node>
<Node><Sub>27</Sub>
<Data>  &lt;Ctrl-F6&gt;  - КОПИРОВАТЬ ИЗ БУФЕРА В ТЕКУЩИЙ УЗЕЛ БД</Data>
</Node>
<Node><Sub>28</Sub>
<Data>               (ПРИМЕНЯТЬ РЕЖИМ, НАХОДЯСЬ НА УРОВЕНЬ ВЫШЕ, СОХРАНЕННОГО</Data>
</Node>
<Node><Sub>29</Sub>
<Data>               БУФЕРА !!!)</Data>
</Node>
</Node>
<Node><Sub>KEY_CHO</Sub>
<Data><![CDATA[ВЫБОРКА КЛЮЧЕЙ ДЛЯ НАСЧЕТА СПИСКОВ И СВОДОК@@@@@@@5@10@22@70@@@@1@@5@@@1@@@ 1@@@@@18@@@2;6;36;44///2;6;36;44/2;6;37;44@@@@@@@1]]></Data>
<Node><Sub>1</Sub>
<Data>ОТ ... это начальная граница перебора ключей пробега по </Data>
</Node>
<Node><Sub>2</Sub>
<Data>       базе данных</Data>
</Node>
<Node><Sub>3</Sub>
<Data>   Если вы удалите значение данного параметра и он</Data>
</Node>
<Node><Sub>4</Sub>
<Data>   станет пустым, то тем самым вы закажете перебор С НАЧАЛА</Data>
</Node>
<Node><Sub>5</Sub>
<Data>ДО ... это конецная граница ...</Data>
</Node>
<Node><Sub>6</Sub>
<Data>   Если вы удалите значение данного параметра и он</Data>
</Node>
<Node><Sub>7</Sub>
<Data>   станет пустым, то тем самым вы закажете перебор ДО КОНЦА</Data>
</Node>
<Node><Sub>8</Sub>
<Data></Data>
</Node>
<Node><Sub>9</Sub>
<Data>    Ниже идут шаблоны условий на данные ключей </Data>
</Node>
<Node><Sub>10</Sub>
<Data>    </Data>
</Node>
<Node><Sub>11</Sub>
<Data>Введя печатный символ вы оказываетесь в строке</Data>
</Node>
<Node><Sub>12</Sub>
<Data> редактирования данного шаблона, который имеет формат:</Data>
</Node>
<Node><Sub>13</Sub>
<Data> </Data>
</Node>
<Node><Sub>14</Sub>
<Data> ТЕКСТ # ФОРМУЛА</Data>
</Node>
<Node><Sub>15</Sub>
<Data></Data>
</Node>
<Node><Sub>16</Sub>
<Data>ТЕКСТ - который появится сразу после заголовка насчитанной</Data>
</Node>
<Node><Sub>17</Sub>
<Data>        сводки или списка</Data>
</Node>
<Node><Sub>18</Sub>
<Data>ФОРМУЛА - в формате команды IF на переменные k1,k2,k3,...</Data>
</Node>
</Node>
<Node><Sub>KEY_HELP</Sub>
<Data><![CDATA[ОПИСАНИЕ КЛЮЧЕЙ БАЗЫ ДАННЫХ@@@@@@@1@1@22@80@@@@1@@5@@@1@@@@@@@@86@@@2;6;30;42///2;6;34;42/2;6;30;42@@@@@@@1]]></Data>
<Node><Sub>1</Sub>
<Data>1. - Описание ключей БД начните с определением ИМЕНИ самой БАЗЫ ДАННЫХ в клетке</Data>
</Node>
<Node><Sub>2</Sub>
<Data> {12,6} таблицы описания.Если в вашей БД будет применяться  ИМЕННОЙ ключ,то</Data>
</Node>
<Node><Sub>3</Sub>
<Data> имя БД должно выбраться таким образом чтобы &quot;слепленная&quot; с любым именным</Data>
</Node>
<Node><Sub>4</Sub>
<Data> ключем по длине не привышала 8 символов.Причем,в имени БД и именных ключах</Data>
</Node>
<Node><Sub>5</Sub>
<Data> не должно присутствовать русских букв ,специальных и псевдографических симво-</Data>
</Node>
<Node><Sub>6</Sub>
<Data> лов.</Data>
</Node>
<Node><Sub>7</Sub>
<Data>  - Дополнительно в клетке {12,7} можно выбрать ссылку на узел базы данных DDR</Data>
</Node>
<Node><Sub>8</Sub>
<Data> эта ссылка позволит правильно выводить и вводить данные по этой задаче в</Data>
</Node>
<Node><Sub>9</Sub>
<Data> &quot;Формате ПФЛ (перфоленты)&quot;</Data>
</Node>
<Node><Sub>10</Sub>
<Data>  - Дополнительно в клетке {12,8} можно ввести ссылку на имя базы данных</Data>
</Node>
<Node><Sub>11</Sub>
<Data> в которой будут формироваться индексно-поисковые ключи. В противном случае</Data>
</Node>
<Node><Sub>12</Sub>
<Data>индексно-поисковые ключи будут формироваться во временном массиве и при выходе</Data>
</Node>
<Node><Sub>13</Sub>
<Data>из комплекса он будет уничтожаться. Фомировать индексно-поисковые ключи и</Data>
</Node>
<Node><Sub>14</Sub>
<Data>использовать их можно в карте БД горячей клавишей &lt;ALT-Y&gt; или F7--&gt;В БД</Data>
</Node>
<Node><Sub>15</Sub>
<Data> </Data>
</Node>
<Node><Sub>16</Sub>
<Data>2. - данные 1 колонки будут высвечиваться при определении выборки для насчета</Data>
</Node>
<Node><Sub>17</Sub>
<Data>   списков и сводок</Data>
</Node>
<Node><Sub>18</Sub>
<Data></Data>
</Node>
<Node><Sub>19</Sub>
<Data>3. - 2 строка таблицы описания содержит информацию по именному ключу</Data>
</Node>
<Node><Sub>20</Sub>
<Data>     ИМЕННОЙ КЛЮЧ  =  ФАКТИЧЕСКИ ДОБАВЛЯЕТСЯ К ИМЕНИ МАССИВА БАЗЫ ДАННЫХ</Data>
</Node>
<Node><Sub>21</Sub>
<Data></Data>
</Node>
<Node><Sub>22</Sub>
<Data>4. - с 3 по 11 - по индексным ключам</Data>
</Node>
<Node><Sub>23</Sub>
<Data>     ИНДЕКСННЫЙ КЛЮЧ  =  БУДЕТ ИНДЕКСОМ МАССИВА БАЗЫ ДАННЫХ СООТВЕТСТВУЮЩЕГО</Data>
</Node>
<Node><Sub>24</Sub>
<Data>                       УРОВНЯ.</Data>
</Node>
<Node><Sub>25</Sub>
<Data>5. - В данных 2 колонки содержится информация о размере клеток формируемой</Data>
</Node>
<Node><Sub>26</Sub>
<Data>   таблицы при раскрытии узла БД соответствющего уровня и информации о времени</Data>
</Node>
<Node><Sub>27</Sub>
<Data>   последней модификации узла ,пользователе и логических ошибках в данных.</Data>
</Node>
<Node><Sub>28</Sub>
<Data>   A,B,C,D   где</Data>
</Node>
<Node><Sub>29</Sub>
<Data>   A - высота клеток</Data>
</Node>
<Node><Sub>30</Sub>
<Data>   B - длина клеток</Data>
</Node>
<Node><Sub>31</Sub>
<Data>   C=TIME - инфрмация о времени,дате и пользователе, последним модиф. узел БД</Data>
</Node>
<Node><Sub>32</Sub>
<Data>   D=ссылка на массив, в котором будет индексироваться значения текущего ключа</Data>
</Node>
<Node><Sub>33</Sub>
<Data>     (он может быть один для разных ключей и клеток хранимых в базе данных)</Data>
</Node>
<Node><Sub>34</Sub>
<Data>   </Data>
</Node>
<Node><Sub>35</Sub>
<Data>   (Например: 1,40,TIME - высота клеток 1, длина - 40, инфрмация о времени)</Data>
</Node>
<Node><Sub>36</Sub>
<Data>   Параметр TIME работает в только в последнем индексном ключе</Data>
</Node>
<Node><Sub>37</Sub>
<Data>   Если TIME включен ,то в таблице содержания ключей появится дата последней</Data>
</Node>
<Node><Sub>38</Sub>
<Data>   модификации узла ,имя пользователя производившем коррекцию и флаг состояния</Data>
</Node>
<Node><Sub>39</Sub>
<Data>   информации :  . - логических ошибок нет</Data>
</Node>
<Node><Sub>40</Sub>
<Data>                 ? - узлы заводились ПРИЛОЖЕНИЕМ DDR (Диспетчером ввода) и</Data>
</Node>
<Node><Sub>41</Sub>
<Data>                     информации о логических ошибках отсутствует</Data>
</Node>
<Node><Sub>42</Sub>
<Data>                 ! - есть логические ошибки</Data>
</Node>
<Node><Sub>43</Sub>
<Data></Data>
</Node>
<Node><Sub>44</Sub>
<Data>   - Если на клетку 2 колонки установлена опция входа в таблицу по &lt;Enter&gt;, то</Data>
</Node>
<Node><Sub>45</Sub>
<Data>     данная таблица будет использована в качестве шаблона для формирования</Data>
</Node>
<Node><Sub>46</Sub>
<Data>     данных соответствующего ключа (см.в %BSDFLT таблицу N15)</Data>
</Node>
<Node><Sub>47</Sub>
<Data></Data>
</Node>
<Node><Sub>48</Sub>
<Data>   - Если в последнем ключе во 2 колонке в данных стоит значение</Data>
</Node>
<Node><Sub>49</Sub>
<Data>   HiddenLastKey , то это значит:</Data>
</Node>
<Node><Sub>50</Sub>
<Data>    - после определения предпоследнего ключа мы сразу попадем в таблицу</Data>
</Node>
<Node><Sub>51</Sub>
<Data>    - в этой таблице СИМВОЛЬНЫЕ ИМЕНА ВЫВОДА комплекс будет считать ИМЕНАМИ</Data>
</Node>
<Node><Sub>52</Sub>
<Data>     ХРАНЕНИЯ В БАЗЕ ДАННЫХ</Data>
</Node>
<Node><Sub>53</Sub>
<Data>    - СИМВОЛЬНОЕ ИМЯ ВЫВОДА описанное в п.6 будет содержать значения последнего</Data>
</Node>
<Node><Sub>54</Sub>
<Data>     ключа для таблицы.    </Data>
</Node>
<Node><Sub>55</Sub>
<Data>                          (Фу! Я сам это понимаю с трудом...)</Data>
</Node>
<Node><Sub>56</Sub>
<Data>                 </Data>
</Node>
<Node><Sub>57</Sub>
<Data>6. - В данных 3 колонки содержится текст приглашения для ввода нового ключа</Data>
</Node>
<Node><Sub>58</Sub>
<Data>   - в режиме HiddenLastKey - данные этой колонки должны равняться СИМВОЛЬНОМУ</Data>
</Node>
<Node><Sub>59</Sub>
<Data>     ИМЕНИ ВЫВОДА по которому будут искаться значения последнего ключа.</Data>
</Node>
<Node><Sub>60</Sub>
<Data></Data>
</Node>
<Node><Sub>61</Sub>
<Data>7. - В данных 4 колонки содержится текст для выбора пункта приглашения ввода</Data>
</Node>
<Node><Sub>62</Sub>
<Data>   нового ключа и цвет таблицы формируемой при раскрытии узла БД</Data>
</Node>
<Node><Sub>63</Sub>
<Data>   - в режиме HiddenLastKey - данные этой колонки должны равняться Y1,X1,Y2,X2</Data>
</Node>
<Node><Sub>64</Sub>
<Data>     это диапазон таблицы в котором находятся СИМВОЛЬНЫЕ ИМЕНА ВЫВОДА</Data>
</Node>
<Node><Sub>65</Sub>
<Data>     значений последнего ключа для таблицы.    </Data>
</Node>
<Node><Sub>66</Sub>
<Data></Data>
</Node>
<Node><Sub>67</Sub>
<Data>8. - В атрибутах 5 колонки могут содержаться Формула ТРАНсформации,</Data>
</Node>
<Node><Sub>68</Sub>
<Data>   Формула СИНТаксического контроля данных ключа ,ТАБлица вызова по клавиши</Data>
</Node>
<Node><Sub>69</Sub>
<Data>   &lt;Enter&gt; и в Формуле ЛОГического контроля - функции $$MTBD</Data>
</Node>
<Node><Sub>70</Sub>
<Data>    (для создания МультиТабличнойБазыДанных).</Data>
</Node>
<Node><Sub>71</Sub>
<Data>9. - колонки с 6 по 15 используются только для определения параметров выборки</Data>
</Node>
<Node><Sub>72</Sub>
<Data>   списков и сводок генерируемых по БД.</Data>
</Node>
<Node><Sub>73</Sub>
<Data>10. - 6 и 7 -диапазон данных ключей обрабатываемых при генерации списков и сводок</Data>
</Node>
<Node><Sub>74</Sub>
<Data> - 8 и 9 -текст в первой строке после заголовка списка и сводки с информацией</Data>
</Node>
<Node><Sub>75</Sub>
<Data>   о диапазоне выборки</Data>
</Node>
<Node><Sub>76</Sub>
<Data>   Если текст=NONE ,то ничего в первой строке после заголовка списка и сводки</Data>
</Node>
<Node><Sub>77</Sub>
<Data>   не выводится.</Data>
</Node>
<Node><Sub>78</Sub>
<Data>11. - Колонки с 10 по 15 используются для создания выборки основанной на</Data>
</Node>
<Node><Sub>79</Sub>
<Data>   ЛОГической формуле.</Data>
</Node>
<Node><Sub>80</Sub>
<Data>   Данные=Тексту ,который появится в меню при организации выборки для выдачи</Data>
</Node>
<Node><Sub>81</Sub>
<Data>   СПИСКОВ и СВОДОК;</Data>
</Node>
<Node><Sub>82</Sub>
<Data>   На месте Формулы ЛОГического контроля должная стоять Формула вычисления</Data>
</Node>
<Node><Sub>83</Sub>
<Data>   для выборки.( Например,ключ 2 это дата и формула для выборки МАЯ-месяца</Data>
</Node>
<Node><Sub>84</Sub>
<Data>   будет такая :+$E(k2,3,4)=5 ,где k1,k2,k3,k4,k5,k6,k7,k8,k9 - зарезервиро-</Data>
</Node>
<Node><Sub>85</Sub>
<Data>   ванные локальные переменныя содержащие текущее значения соответствующего</Data>
</Node>
<Node><Sub>86</Sub>
<Data>   ключа.</Data>
</Node>
</Node>
<Node><Sub>KEY_HELP_C</Sub>
<Data><![CDATA[ОПИСАНИЕ СПЕЦИАЛЬНОЙ ВЫБОРКИ КЛЮЧЕЙ БАЗЫ ДАННЫХ@@@@@@@1@1@22@80@@@@1@@5@@@1@@@@@@@@23@@@2;6;30;42///2;6;34;42/2;6;30;42@@@@@@@1]]></Data>
<Node><Sub>1</Sub>
<Data>      ВСЕ ЭТИ ПАРАМЕТРЫ ИМЕЮТ ПРИОРЕТЕТ ПЕРЕД АНАЛОГИЧНЫМИ ПАРАМЕТРАМИ,</Data>
</Node>
<Node><Sub>2</Sub>
<Data>      ОПРЕДЕЛЕННЫМИ В ТАБЛИЦЕ ОПИСАНИЯ КЛЮЧЕЙ БАЗЫ ДАННЫХ !!!!!!!!!!!!!</Data>
</Node>
<Node><Sub>3</Sub>
<Data></Data>
</Node>
<Node><Sub>4</Sub>
<Data> </Data>
</Node>
<Node><Sub>5</Sub>
<Data>1. - данные 1 колонки будут высвечиваться при определении выборки для насчета</Data>
</Node>
<Node><Sub>6</Sub>
<Data>     списков и сводок</Data>
</Node>
<Node><Sub>7</Sub>
<Data></Data>
</Node>
<Node><Sub>8</Sub>
<Data>2. - 2 колонка таблицы должна содержать непустую информацию для того чтобы,</Data>
</Node>
<Node><Sub>9</Sub>
<Data>     параметры для текущего ключа ЗАРАБОТАЛИ !!! (ВАЖНО)</Data>
</Node>
<Node><Sub>10</Sub>
<Data>     </Data>
</Node>
<Node><Sub>11</Sub>
<Data>3. - В атрибутах 5 колонки может содержаться Формула ТРАНсформации, которая</Data>
</Node>
<Node><Sub>12</Sub>
<Data>     изменит представление данных определенных в выборке ОТ и ДО в насчитаных</Data>
</Node>
<Node><Sub>13</Sub>
<Data>     СВОДКЕ\СПИСКЕ</Data>
</Node>
<Node><Sub>14</Sub>
<Data></Data>
</Node>
<Node><Sub>15</Sub>
<Data>4. - Колонки с 10 по 15 используются для создания выборки основанной на</Data>
</Node>
<Node><Sub>16</Sub>
<Data>   ЛОГической формуле.</Data>
</Node>
<Node><Sub>17</Sub>
<Data>   Данные=Тексту ,который появится в меню при организации выборки для выдачи</Data>
</Node>
<Node><Sub>18</Sub>
<Data>   СПИСКОВ и СВОДОК;</Data>
</Node>
<Node><Sub>19</Sub>
<Data>   На месте Формулы ЛОГического контроля должная стоять Формула вычисления</Data>
</Node>
<Node><Sub>20</Sub>
<Data>   для выборки.( Например,ключ 2 это дата и формула для выборки МАЯ-месяца</Data>
</Node>
<Node><Sub>21</Sub>
<Data>   будет такая :+$E(k2,3,4)=5 ,где k1,k2,k3,k4,k5,k6,k7,k8,k9 - зарезервиро-</Data>
</Node>
<Node><Sub>22</Sub>
<Data>   ванные локальные переменныя содержащие текущее значения соответствующего</Data>
</Node>
<Node><Sub>23</Sub>
<Data>   ключа.</Data>
</Node>
</Node>
<Node><Sub>KH1</Sub>
<Data>МАССИВ БАЗЫ ДАННЫХ@@@@@@@7@10@19@70@@@@1@@5@@@1@@@ 1@@@@@19@@@1;6;37;44//2;6;33;40@@@@@@@1</Data>
<Node><Sub>1</Sub>
<Data></Data>
</Node>
<Node><Sub>2</Sub>
<Data> - Описание ключей БД начните с определением ИМЕНИ самой</Data>
</Node>
<Node><Sub>3</Sub>
<Data> БАЗЫ ДАННЫХ в клетке {12,6} таблицы описания.Если в вашей</Data>
</Node>
<Node><Sub>4</Sub>
<Data> БД будет применяться  ИМЕННОЙ ключ,то имя БД должно</Data>
</Node>
<Node><Sub>5</Sub>
<Data> выбраться таким образом чтобы &quot;слепленная&quot; с любым именным</Data>
</Node>
<Node><Sub>6</Sub>
<Data> ключем по длине не привышала 8 символов.Причем,в имени БД</Data>
</Node>
<Node><Sub>7</Sub>
<Data> и именных ключах не должно присутствовать русских букв,</Data>
</Node>
<Node><Sub>8</Sub>
<Data> специальных и псевдографических символов.</Data>
</Node>
<Node><Sub>9</Sub>
<Data></Data>
</Node>
<Node><Sub>10</Sub>
<Data></Data>
</Node>
<Node><Sub>11</Sub>
<Data></Data>
</Node>
<Node><Sub>12</Sub>
<Data></Data>
</Node>
<Node><Sub>13</Sub>
<Data></Data>
</Node>
<Node><Sub>14</Sub>
<Data></Data>
</Node>
<Node><Sub>15</Sub>
<Data></Data>
</Node>
<Node><Sub>16</Sub>
<Data></Data>
</Node>
<Node><Sub>17</Sub>
<Data></Data>
</Node>
<Node><Sub>18</Sub>
<Data></Data>
</Node>
<Node><Sub>19</Sub>
<Data></Data>
</Node>
</Node>
<Node><Sub>KH2</Sub>
<Data>ССЫЛКА НА УЗЕЛ DDR@@@@@@@7@10@19@70@@@@1@@5@@@1@@@ 1@@@@@16@@@1;6;37;44//2;6;33;40@@@@@@@1</Data>
<Node><Sub>1</Sub>
<Data></Data>
</Node>
<Node><Sub>2</Sub>
<Data> - Дополнительно в клетке {12,7} можно выбрать ссылку на</Data>
</Node>
<Node><Sub>3</Sub>
<Data> узел базы данных DDR эта ссылка позволит правильно</Data>
</Node>
<Node><Sub>4</Sub>
<Data> выводить и вводить данные по этой задаче в </Data>
</Node>
<Node><Sub>5</Sub>
<Data> &quot;Формате ПФЛ (перфоленты)&quot;</Data>
</Node>
<Node><Sub>6</Sub>
<Data></Data>
</Node>
<Node><Sub>7</Sub>
<Data></Data>
</Node>
<Node><Sub>8</Sub>
<Data></Data>
</Node>
<Node><Sub>9</Sub>
<Data></Data>
</Node>
<Node><Sub>10</Sub>
<Data></Data>
</Node>
<Node><Sub>11</Sub>
<Data></Data>
</Node>
<Node><Sub>12</Sub>
<Data></Data>
</Node>
<Node><Sub>13</Sub>
<Data></Data>
</Node>
<Node><Sub>14</Sub>
<Data></Data>
</Node>
<Node><Sub>15</Sub>
<Data></Data>
</Node>
<Node><Sub>16</Sub>
<Data></Data>
</Node>
</Node>
<Node><Sub>KH3</Sub>
<Data>МАССИВ ПОИСКОВОЙ БАЗЫ ДАННЫХ@@@@@@@7@10@19@70@@@@1@@5@@@1@@@ 1@@@@@18@@@1;6;37;44//2;6;33;40@@@@@@@1</Data>
<Node><Sub>1</Sub>
<Data></Data>
</Node>
<Node><Sub>2</Sub>
<Data>  - Дополнительно в клетке {12,8} можно ввести ссылку на </Data>
</Node>
<Node><Sub>3</Sub>
<Data>  имя базы данных в которой будут формироваться индексно-</Data>
</Node>
<Node><Sub>4</Sub>
<Data>  поисковые ключи. В противном случае индексно-поисковые</Data>
</Node>
<Node><Sub>5</Sub>
<Data>  ключи будут формироваться во временном массиве и при</Data>
</Node>
<Node><Sub>6</Sub>
<Data>  выходе из комплекса он будет уничтожаться. Фомировать</Data>
</Node>
<Node><Sub>7</Sub>
<Data>  индексно-поисковые ключи и использовать их можно в карте</Data>
</Node>
<Node><Sub>8</Sub>
<Data>  БД горячей клавишей &lt;ALT-Y&gt; или F7--&gt;В БД</Data>
</Node>
<Node><Sub>9</Sub>
<Data></Data>
</Node>
<Node><Sub>10</Sub>
<Data></Data>
</Node>
<Node><Sub>11</Sub>
<Data></Data>
</Node>
<Node><Sub>12</Sub>
<Data></Data>
</Node>
<Node><Sub>13</Sub>
<Data></Data>
</Node>
<Node><Sub>14</Sub>
<Data></Data>
</Node>
<Node><Sub>15</Sub>
<Data></Data>
</Node>
<Node><Sub>16</Sub>
<Data></Data>
</Node>
<Node><Sub>17</Sub>
<Data></Data>
</Node>
<Node><Sub>18</Sub>
<Data></Data>
</Node>
</Node>
<Node><Sub>KODs</Sub>
<Data><![CDATA[схема команд и меню (сделал Золотов В.В. 1997)@@@@@@@1@1@22@79@@@@1@@5@@@1@@@@@@@@191@@@2;6;30;45//2;6;30;45//2;6;30;45@@@@@@@1]]></Data>
<Node><Sub>1</Sub>
<Data>1.ОПИС (Общее описание комплекса) Shift-F1 -&gt; последний пункт</Data>
</Node>
<Node><Sub>2</Sub>
<Data>2.ВЫВОД ----&gt; ПОЛНОСТЬЮ ------&gt; ТАБЛИЦУ -----&gt; ПЕЧАТЬ ------&gt; ВЫВОД</Data>
</Node>
<Node><Sub>3</Sub>
<Data> (Таблицы |               |               |             |---&gt; ОПЦИИ</Data>
</Node>
<Node><Sub>4</Sub>
<Data> и данных)|               |               |             ----&gt; ПРИНТ-УСТАНОВКИ</Data>
</Node>
<Node><Sub>5</Sub>
<Data>          |               |               |--&gt; ASCII-ФАЙЛ ------&gt; ВЫВОД</Data>
</Node>
<Node><Sub>6</Sub>
<Data>          |               |               |                 ----&gt; ОПЦИИ</Data>
</Node>
<Node><Sub>7</Sub>
<Data>          |               |               |--&gt; ТЕКСТ ------&gt; ВЫВОД</Data>
</Node>
<Node><Sub>8</Sub>
<Data>          |               |               |            ----&gt; ОПЦИИ</Data>
</Node>
<Node><Sub>9</Sub>
<Data>          |               |               ---&gt; РТА-80Л (порт)------&gt; ВЫВОД</Data>
</Node>
<Node><Sub>10</Sub>
<Data>          |               |                                    ----&gt; ОПЦИИ</Data>
</Node>
<Node><Sub>11</Sub>
<Data>          |               ----&gt; ДАННЫЕ ------ &gt; -----&gt; ПЕЧАТЬ</Data>
</Node>
<Node><Sub>12</Sub>
<Data>          |                                       |--&gt; ASCII-ФАЙЛ</Data>
</Node>
<Node><Sub>13</Sub>
<Data>          |                                       |--&gt; ТЕКСТ</Data>
</Node>
<Node><Sub>14</Sub>
<Data>          |                                       ---&gt; РТА-80Л (порт)</Data>
</Node>
<Node><Sub>15</Sub>
<Data>          --&gt; ТОЛЬКО_БЛОК ----&gt; ТАБЛИЦУ -----&gt; ПЕЧАТЬ</Data>
</Node>
<Node><Sub>16</Sub>
<Data>                            |             |--&gt; ASCII-ФАЙЛ</Data>
</Node>
<Node><Sub>17</Sub>
<Data>                            |             |--&gt; ТЕКСТ</Data>
</Node>
<Node><Sub>18</Sub>
<Data>                            |             ---&gt; РТА-80Л (порт)</Data>
</Node>
<Node><Sub>19</Sub>
<Data>                            --&gt; ДАННЫЕ ------&gt; -----&gt; ПЕЧАТЬ</Data>
</Node>
<Node><Sub>20</Sub>
<Data>                                                 |--&gt; ASCII-ФАЙЛ</Data>
</Node>
<Node><Sub>21</Sub>
<Data>                                                 |--&gt; ТЕКСТ</Data>
</Node>
<Node><Sub>22</Sub>
<Data>                                                 ---&gt; РТА-80Л (порт)</Data>
</Node>
<Node><Sub>23</Sub>
<Data>3.ЗАПИСЬ</Data>
</Node>
<Node><Sub>24</Sub>
<Data>4.РЕД--&gt; КЛЕТКУ (Alt-E) (редактирование данных клетки)</Data>
</Node>
<Node><Sub>25</Sub>
<Data>      |&gt; ОПИС_ТАБЛИЦЫ ---&gt; ВЫЧ (Alt-C)----------------------------&gt; РЕДАКТИРОВАТЬ_ФОРМУЛУ</Data>
</Node>
<Node><Sub>26</Sub>
<Data>      |                 |  (редактирование функций вычиления) ----&gt; КОПИРОВАТЬ_В_БЛОК</Data>
</Node>
<Node><Sub>27</Sub>
<Data>      |                 |&gt; ТРАН (Flt-T) ----------------------------&gt; РЕДАКТИРОВАТЬ_ФОРМУЛУ</Data>
</Node>
<Node><Sub>28</Sub>
<Data>      |                 |  (редактирование функций трансформации)---&gt;  КОПИРОВАТЬ_В_БЛОК</Data>
</Node>
<Node><Sub>29</Sub>
<Data>      |                 |&gt; ИМЯ ---&gt; ИМЯ_ХРАНЕНИЯ_В_БАЗЕ_ДАННЫХ ----&gt; РЕДАКТИРОВАТЬ</Data>
</Node>
<Node><Sub>30</Sub>
<Data>      |                 |       |                                --&gt; АВТОМ.УСТАНОВКА_ВО_ВСЁМ_БЛОКЕ</Data>
</Node>
<Node><Sub>31</Sub>
<Data>      |                 |       |-&gt; ИМЯ_ВЫВОДА_ДАННЫХ ------&gt; РЕДАКТИРОВАТЬ</Data>
</Node>
<Node><Sub>32</Sub>
<Data>      |                 |       |                       |---&gt; КОПИРОВАТЬ_В_БЛОК</Data>
</Node>
<Node><Sub>33</Sub>
<Data>      |                 |       |                       ----&gt; ССЫЛКА_НА_ВЫЧ</Data>
</Node>
<Node><Sub>34</Sub>
<Data>      |                 |       --&gt; ПОЛЯ_DBF ------&gt; СТРУКТУРА_DBF ------&gt; ИЗ_DBF-ФАЙЛА</Data>
</Node>
<Node><Sub>35</Sub>
<Data>      |                 |                      |                     ----&gt; ИЗ_БАЗЫ_ОБРАЗЦОВ</Data>
</Node>
<Node><Sub>36</Sub>
<Data>      |                 |                      |---&gt; РЕДАКТИРОВАТЬ</Data>
</Node>
<Node><Sub>37</Sub>
<Data>      |                 |                      ----&gt; КОПИРОВАТЬ_В_БЛОК</Data>
</Node>
<Node><Sub>38</Sub>
<Data>      |                 |&gt; ГДЕ ------&gt; КЛЕТКА</Data>
</Node>
<Node><Sub>39</Sub>
<Data>      |                 |        |---&gt; БЛОК</Data>
</Node>
<Node><Sub>40</Sub>
<Data>      |                 |        |---&gt; ХРАНИМ_В_ОПИСАНИИ_ТАБЛИЦЫ</Data>
</Node>
<Node><Sub>41</Sub>
<Data>      |                 |        ----&gt; ХРАНИМ_В_БАЗЕ_ДАННЫХ</Data>
</Node>
<Node><Sub>42</Sub>
<Data>      |                 |&gt; ВОСС -----&gt; ИЗ_БУФЕРА ------&gt; КЛЕТКА</Data>
</Node>
<Node><Sub>43</Sub>
<Data>      |                 |        |                 |---&gt; БЛОК</Data>
</Node>
<Node><Sub>44</Sub>
<Data>      |                 |        |                 |---&gt; ТАБЛИЦА</Data>
</Node>
<Node><Sub>45</Sub>
<Data>      |                 |        |                 |---&gt; ТЕКСТ</Data>
</Node>
<Node><Sub>46</Sub>
<Data>      |                 |        |                 ----&gt; АТРИБУТЫ</Data>
</Node>
<Node><Sub>47</Sub>
<Data>      |                 |        |-&gt; ИЗ_ASCII-ФАЙЛА ---&gt; ВЕСЬ_DBF_В_ТАБЛИЦУ</Data>
</Node>
<Node><Sub>48</Sub>
<Data>      |                 |        |                   |-&gt; ЗАМЕНА_ДАННЫХ_ИЗ_DBF</Data>
</Node>
<Node><Sub>49</Sub>
<Data>      |                 |        |                   --&gt; ЗАМЕНА_БЛОКА_ИЗ_DBF</Data>
</Node>
<Node><Sub>50</Sub>
<Data>      |                 |        |-&gt; ИЗ_DBF-ФАЙЛА</Data>
</Node>
<Node><Sub>51</Sub>
<Data>      |                 |        --&gt; ИЗ_ТЕКСТА</Data>
</Node>
<Node><Sub>52</Sub>
<Data>      |                 |&gt; ЗАП ------&gt; КЛЕТКА (переключение статуса клетки)</Data>
</Node>
<Node><Sub>53</Sub>
<Data>      |                 |        |---&gt; БЛОК ------&gt; РАЗРЕШИТЬ</Data>
</Node>
<Node><Sub>54</Sub>
<Data>      |                 |        |            ----&gt; ЗАПРЕТИТЬ</Data>
</Node>
<Node><Sub>55</Sub>
<Data>      |                 |        ----&gt; ВСЯ_ТАБЛИЦА ------&gt; РАЗРЕШИТЬ</Data>
</Node>
<Node><Sub>56</Sub>
<Data>      |                 |                            ----&gt; ЗАПРЕТИТЬ</Data>
</Node>
<Node><Sub>57</Sub>
<Data>      |                 |&gt; ВЫС ------&gt; СТРОКИ ---</Data>
</Node>
<Node><Sub>58</Sub>
<Data>      |                 |        ----&gt; БЛОК ----|</Data>
</Node>
<Node><Sub>59</Sub>
<Data>      |                 |&gt; ДЛИН ------&gt; КОЛОНКИ-+&gt;вход в строковый редактор и</Data>
</Node>
<Node><Sub>60</Sub>
<Data>      |                 |         ----&gt; БЛОК ---|  определения параметров</Data>
</Node>
<Node><Sub>61</Sub>
<Data>      |                 |&gt; ВСТ ------&gt; СТРОК ---|</Data>
</Node>
<Node><Sub>62</Sub>
<Data>      |                 |        ----&gt; КОЛОНОК --</Data>
</Node>
<Node><Sub>63</Sub>
<Data>      |                 |&gt; КЛЮЧ ------&gt; I_ТАБЛИЦА_КЛЮЧЕЙ ------ вход</Data>
</Node>
<Node><Sub>64</Sub>
<Data>      |                 |         |---&gt; II_ТАБЛИЦА_КЛЮЧЕЙ ----+&gt;в таблицу</Data>
</Node>
<Node><Sub>65</Sub>
<Data>      |                 |         |---&gt; III_ТАБЛИЦА_КЛЮЧЕЙ ---| описания ключей</Data>
</Node>
<Node><Sub>66</Sub>
<Data>      |                 |         ----&gt; ВЗЯТЬ_ЗА_ОСНОВУ_ЧУЖИЕ -</Data>
</Node>
<Node><Sub>67</Sub>
<Data>      |                 |&gt; ЦВЕТ ------&gt; КЛЕТКА ------------------------ вход</Data>
</Node>
<Node><Sub>68</Sub>
<Data>      |                 |         |---&gt; БЛОК -------------------------+&gt;в таблицу выбора</Data>
</Node>
<Node><Sub>69</Sub>
<Data>      |                 |         |---&gt; ЦВЕТ_ИЗ_ТЕКУЩЕЙ_КЛЕТКИ_В_БЛОК-| цветовых </Data>
</Node>
<Node><Sub>70</Sub>
<Data>      |                 |         ----&gt; ВСЕЙ_ТАБЛИЦЫ ------------------ атрибутов</Data>
</Node>
<Node><Sub>71</Sub>
<Data>      |                 |&gt; ТАБ ------&gt; ВХОД_В_ТАБЛИЦУ ----</Data>
</Node>
<Node><Sub>72</Sub>
<Data>      |                 |        |---&gt; ВЫПОЛНИТЬ_КОМАНДУ-+&gt; ввод/коррекция входов в таблицу</Data>
</Node>
<Node><Sub>73</Sub>
<Data>      |                 |        ----&gt; КОПИРОВАТЬ_В_БЛОК--</Data>
</Node>
<Node><Sub>74</Sub>
<Data>      |                 |&gt; УДАЛ ------&gt; СТРОКИ</Data>
</Node>
<Node><Sub>75</Sub>
<Data>      |                 |         |---&gt; КОЛОНКИ</Data>
</Node>
<Node><Sub>76</Sub>
<Data>      |                 |         |---&gt; ПРИКРЕПЛ_Строчно-Блочного_МЕНЮ</Data>
</Node>
<Node><Sub>77</Sub>
<Data>      |                 |         |---&gt; КЛЮЧИ</Data>
</Node>
<Node><Sub>78</Sub>
<Data>      |                 |         |---&gt; ФОРМУЛЫ ------&gt; !!!ВЫЧИСЛ</Data>
</Node>
<Node><Sub>79</Sub>
<Data>      |                 |         |               |---&gt; ТРАНС</Data>
</Node>
<Node><Sub>80</Sub>
<Data>      |                 |         |               |---&gt; СИНТ</Data>
</Node>
<Node><Sub>81</Sub>
<Data>      |                 |         |               ----&gt; ЛОГИКИ!!!</Data>
</Node>
<Node><Sub>82</Sub>
<Data>      |                 |         |---&gt; СТРУКТ_DBF</Data>
</Node>
<Node><Sub>83</Sub>
<Data>      |                 |         |---&gt; ПРОБЕЛЫ</Data>
</Node>
<Node><Sub>84</Sub>
<Data>      |                 |         ----&gt; ПАНЕЛЬ</Data>
</Node>
<Node><Sub>85</Sub>
<Data>      |                 |&gt; ЛОГ (Alt-L) ------&gt; РЕДАКТИРОВАТЬ_ЛОГ.КОНТРОЛЬ</Data>
</Node>
<Node><Sub>86</Sub>
<Data>      |                 |                |---&gt; КОПИРОВАТЬ_В_БЛОК</Data>
</Node>
<Node><Sub>87</Sub>
<Data>      |                 |                ----&gt; РЕДАКТИРОВАТЬ_ТЕКСТ_ОБ_ОШИБКЕ</Data>
</Node>
<Node><Sub>88</Sub>
<Data>      |                 |&gt;ОПЦ-&gt;ОКНО (размеры окна просмотра таблицы)-------------</Data>
</Node>
<Node><Sub>89</Sub>
<Data>      |                 |    |&gt;ИНФ ------&gt; ПОЛНАЯ (инф.о клетки в 23,24,25 стр)-|</Data>
</Node>
<Node><Sub>90</Sub>
<Data>      |                 |    |       |---&gt; ЧАСТИЧНАЯ (только в 25 строке)-------|</Data>
</Node>
<Node><Sub>91</Sub>
<Data>      |                 |    |       ----&gt; НЕ_НАДО -----------------------------|</Data>
</Node>
<Node><Sub>92</Sub>
<Data>      |                 |    |&gt;Ф.КЛ ------&gt; ВКЛЮЧЕНЫ ---------------------------|</Data>
</Node>
<Node><Sub>93</Sub>
<Data>      |                 |    |        ----&gt; ВЫКЛЮЧЕНЫ --------------------------|</Data>
</Node>
<Node><Sub>94</Sub>
<Data>      |                 |    |&gt;ЗАЩ ------&gt; ВЫКЛЮЧЕНA (защита от коррекции)------|</Data>
</Node>
<Node><Sub>95</Sub>
<Data>      |                 |    |       ----&gt; ВКЛЮЧЕНA ----------------------------|</Data>
</Node>
<Node><Sub>96</Sub>
<Data>      |                 |    |&gt;ВЫЧ ------&gt; ПОРЯДОК ---&gt;СПРАВО-НАЛЕВО,СВЕРХУ-ВНИЗ|</Data>
</Node>
<Node><Sub>97</Sub>
<Data>      |                 |    |       |     ВЫЧИСЛЕНИЙ|&gt;СПР-НАЛ,СНИ-ВВЕРХ -------|</Data>
</Node>
<Node><Sub>98</Sub>
<Data>      |                 |    |       |               |&gt;СЛЕВ-НАП,СВЕР-ВНИЗ ------|</Data>
</Node>
<Node><Sub>99</Sub>
<Data>      |                 |    |       |               -&gt;С-НАП,СН-ВВ -------------|</Data>
</Node>
<Node><Sub>100</Sub>
<Data>      |                 |    |       -&gt; КОГДА_ВЫЧИСЛЯТЬ--&gt; ВЫЧИСЛЯТЬ_ПОСТОЯННО -|</Data>
</Node>
<Node><Sub>101</Sub>
<Data>      |                 |    |                          -&gt; ТОЛЬКО_ПО_КОМАНДЕ(F6)|</Data>
</Node>
<Node><Sub>102</Sub>
<Data>      |                 |    |&gt;ТИТУЛ ------&gt; ОЧИСТИТЬ --------------------------|</Data>
</Node>
<Node><Sub>103</Sub>
<Data>      |                 |    |         ----&gt; УСТАНОВИТЬ-------------------------|</Data>
</Node>
<Node><Sub>104</Sub>
<Data>      |                 |    |&gt;ПАР ------&gt; ПАРОЛЬ_НА_ВХОД ----------------------|</Data>
</Node>
<Node><Sub>105</Sub>
<Data>      |                 |    |       |---&gt; ПАРОЛЬ_КОРРЕКЦИИ_ДАННЫХ -------------|</Data>
</Node>
<Node><Sub>106</Sub>
<Data>      |                 |    |       ----&gt; ПАРОЛЬ_КОРРЕКЦИИ_ОПИСАНИЯ_ТАБЛИЦЫ ---|</Data>
</Node>
<Node><Sub>107</Sub>
<Data>      |                 |    |&gt;ВИДЕО ------&gt; ВЫКЛЮЧИТЬ -------------------------|</Data>
</Node>
<Node><Sub>108</Sub>
<Data>      |                 |    |         ----&gt; ВКЛЮЧИТЬ --------------------------|</Data>
</Node>
<Node><Sub>109</Sub>
<Data>      |                 |    |&gt;СТАТ ------&gt; ВЫКЛЮЧИТЬ --------------------------|</Data>
</Node>
<Node><Sub>110</Sub>
<Data>      |                 |    |        ----&gt; ВКЛЮЧИТЬ ---------------------------|</Data>
</Node>
<Node><Sub>111</Sub>
<Data>      |                 |    |&gt;ТИП ------&gt; ПОЛЬЗОВАТЕЛЬСКОЕ_МЕНЮ ----&gt; ВКЛЮЧИТЬ-|</Data>
</Node>
<Node><Sub>112</Sub>
<Data>      |                 |    |       |                             --&gt; ВЫКЛЮЧИТЬ|</Data>
</Node>
<Node><Sub>113</Sub>
<Data>      |                 |    |       ----&gt;  ТАБ_В_ТЕКСТ ------------------------|</Data>
</Node>
<Node><Sub>114</Sub>
<Data>      |                 |    |&gt;КУРС ------&gt; В_24_СТРОКЕ ------------------------|</Data>
</Node>
<Node><Sub>115</Sub>
<Data>      |                 |    |        ----&gt; В_ТЕКУЩЕЙ_КЛЕТКЕ--------------------+&gt; Определение</Data>
</Node>
<Node><Sub>116</Sub>
<Data>      |                 |    |&gt;РЕД ------&gt; В_24_СТРОКЕ -------------------------|  общих</Data>
</Node>
<Node><Sub>117</Sub>
<Data>      |                 |    |       |---&gt; В_ТЕКУЩЕЙ_КЛЕТКЕ --------------------|  параметров</Data>
</Node>
<Node><Sub>118</Sub>
<Data>      |                 |    |       ----&gt; В_ОКНЕ ------------------------------|  таблицы</Data>
</Node>
<Node><Sub>119</Sub>
<Data>      |                 |    |&gt;ЛОГ ------&gt; ВКЛ ---------------------------------|</Data>
</Node>
<Node><Sub>120</Sub>
<Data>      |                 |    |       ----&gt; ВЫКЛ --------------------------------|</Data>
</Node>
<Node><Sub>121</Sub>
<Data>      |                 |    |&gt;!!! (ОПТИМИЗАЦИЯ ТАБЛИЦЫ)------------------------|</Data>
</Node>
<Node><Sub>122</Sub>
<Data>      |                 |    |&gt;ЗАКР ------&gt; ЗАКРЫВАТЬ --------------------------|</Data>
</Node>
<Node><Sub>123</Sub>
<Data>      |                 |    |        ----&gt; НЕ_ЗАКРЫВАТЬ -----------------------|</Data>
</Node>
<Node><Sub>124</Sub>
<Data>      |                 |    -&gt;ГЛО ------&gt; СОРТ ------&gt; РАЗРЕШИТЬ сортировку----|   </Data>
</Node>
<Node><Sub>125</Sub>
<Data>      |                 |            |            ----&gt; ЗАПРЕТИТЬ --------------|</Data>
</Node>
<Node><Sub>126</Sub>
<Data>      |                 |            |&gt; ЛОГИКА--&gt; СТАНДАРТНЫЙ_СПИСОК_ЛОГ_ОШИБОК-|</Data>
</Node>
<Node><Sub>127</Sub>
<Data>      |                 |            |         -&gt; СПИСОК_ПО_ИМЕНАМ_ВЫВОДА ------|</Data>
</Node>
<Node><Sub>128</Sub>
<Data>      |                 |            |---&gt; РАМКА ------&gt; ОТМЕНИТЬ --------------|</Data>
</Node>
<Node><Sub>129</Sub>
<Data>      |                 |            |             |---&gt; ОДИНАРНАЯ -------------|</Data>
</Node>
<Node><Sub>130</Sub>
<Data>      |                 |            |             |---&gt; ДВОЙНАЯ ---------------|</Data>
</Node>
<Node><Sub>131</Sub>
<Data>      |                 |            |             ----&gt; СИМВОЛОМ --------------|</Data>
</Node>
<Node><Sub>132</Sub>
<Data>      |                 |            |---&gt; СМ_И_ИСК ---&gt; ВКЛЮЧИТЬ просмотр и----|</Data>
</Node>
<Node><Sub>133</Sub>
<Data>      |                 |            |               --&gt; ВЫКЛЮЧИТЬ поиск--------|</Data>
</Node>
<Node><Sub>134</Sub>
<Data>      |                 |            |---&gt; ОБЖАТЬ ------------------------------|</Data>
</Node>
<Node><Sub>135</Sub>
<Data>      |                 |            |---&gt; F1 (нестандартный текст помощи)------|</Data>
</Node>
<Node><Sub>136</Sub>
<Data>      |                 |            |---&gt; СКРЫТ ------&gt; ВКЛЮЧИТЬ --------------|</Data>
</Node>
<Node><Sub>137</Sub>
<Data>      |                 |            |             ----&gt; ВЫКЛЮЧИТЬ -------------|</Data>
</Node>
<Node><Sub>138</Sub>
<Data>      |                 |            |---&gt; УКАЗ ------&gt; ВКЛЮЧИТЬ ---------------|</Data>
</Node>
<Node><Sub>139</Sub>
<Data>      |                 |            |            ----&gt; ВЫКЛЮЧИТЬ --------------|</Data>
</Node>
<Node><Sub>140</Sub>
<Data>      |                 |            |---&gt; ПРЕДОБ ------------------------------|</Data>
</Node>
<Node><Sub>141</Sub>
<Data>      |                 |            |---&gt; ПОДТВ ------&gt; ВКЛЮЧИТЬ --------------|</Data>
</Node>
<Node><Sub>142</Sub>
<Data>      |                 |            |             ----&gt; ВЫКЛЮЧИТЬ -------------|</Data>
</Node>
<Node><Sub>143</Sub>
<Data>      |                 |            ----&gt; ОБОИ ---------------------------------</Data>
</Node>
<Node><Sub>144</Sub>
<Data>      |                 |&gt;СИНТ (Alt-V)--&gt;РЕДАКТИРОВАТЬ_СИНТАКСИЧЕСКИЙ_КОНТРОЛЬ</Data>
</Node>
<Node><Sub>145</Sub>
<Data>      |                 |              -&gt;КОПИРОВАТЬ_В_БЛОК</Data>
</Node>
<Node><Sub>146</Sub>
<Data>      |                 |&gt;ДВЖ ------&gt; ВНИЗ</Data>
</Node>
<Node><Sub>147</Sub>
<Data>      |                 |       |---&gt; ВПРАВО</Data>
</Node>
<Node><Sub>148</Sub>
<Data>      |                 |       |---&gt; НЕТ</Data>
</Node>
<Node><Sub>149</Sub>
<Data>      |                 |       ----&gt; ОБЩЕСИСТЕМНОЕ</Data>
</Node>
<Node><Sub>150</Sub>
<Data>      |                 -&gt;F1 (ПОМОЩЬ)--&gt; РЕДАКТИРОВАТЬ</Data>
</Node>
<Node><Sub>151</Sub>
<Data>      |                               -&gt; КОПИРОВАТЬ_ИЗ_ТЕКУЩЕЙ_КЛЕТКИ_В_БЛОК</Data>
</Node>
<Node><Sub>152</Sub>
<Data>      |-&gt; ЭКРАННОЕ_РЕДАКТИРОВАНИЕ_БЛОКА</Data>
</Node>
<Node><Sub>153</Sub>
<Data>      --&gt; ДУБЛ.ДАННЫЕ_В_БЛОК</Data>
</Node>
<Node><Sub>154</Sub>
<Data>5.КОПИР ------&gt; КЛЕТКУ_В_БУФЕР</Data>
</Node>
<Node><Sub>155</Sub>
<Data>          |---&gt; БЛОК_В_БУФЕР</Data>
</Node>
<Node><Sub>156</Sub>
<Data>          |---&gt; ОП.ТАБЛ._В_БУФЕР</Data>
</Node>
<Node><Sub>157</Sub>
<Data>          |---&gt; ДАННЫЕ_БЛОКА ------&gt; СОХРАНИТЬ_В_БУФЕРЕ</Data>
</Node>
<Node><Sub>158</Sub>
<Data>          |                    ----&gt; ВОССТАНОВИТЬ_ИЗ_БУФЕРА</Data>
</Node>
<Node><Sub>159</Sub>
<Data>          ----&gt; В_ТЕКСТ.БУФЕР ------&gt; СОХРАНИТЬ_В_БЛОКОВОМ_БУФЕРЕ</Data>
</Node>
<Node><Sub>160</Sub>
<Data>                                ----&gt; СОЗРАНИТЬ_В_БУФЕРЕ_ВСЕГО_ТЕКСТА</Data>
</Node>
<Node><Sub>161</Sub>
<Data>6.СЕРВИС ------&gt; ВЫЧИСЛ (Произвести перевычисления)</Data>
</Node>
<Node><Sub>162</Sub>
<Data>           |---&gt; СОРТИРОВ/ПОДЖАТИЕ ------&gt; ПОДЖАТЬ_ПО_СТРОКАМ</Data>
</Node>
<Node><Sub>163</Sub>
<Data>           |                         |---&gt; КОЛОНКАМ</Data>
</Node>
<Node><Sub>164</Sub>
<Data>           |                         ----&gt; ОБЩЕЕ_ПОДЖАТИЕ</Data>
</Node>
<Node><Sub>165</Sub>
<Data>           |-&gt; СОЗДАТЬ --&gt;КОДИФИКАТОРЫ --&gt; ИЗ_ТАБЛИЦЫ_-&gt;&gt;_КОДИФИКАТОР</Data>
</Node>
<Node><Sub>166</Sub>
<Data>           |            |               -&gt; ИЗ_КОДИФИКАТОРА--&gt;&gt;_ТАБЛИЦУ</Data>
</Node>
<Node><Sub>167</Sub>
<Data>           |            |&gt;МИКРОЗАПРОСЫ --&gt; ИЗ_ТАБЛИЦЫ_-&gt;&gt;_МИКРОЗАПРОСЫ </Data>
</Node>
<Node><Sub>168</Sub>
<Data>           |            |&gt;МЕНЮ_БЛОЧНОЕ  -&gt; ИЗ_МИКРОЗАПРОСОВ-&gt;&gt;_ТАБЛИЦУ </Data>
</Node>
<Node><Sub>169</Sub>
<Data>           |            -&gt;ПАНЕЛЬ_С_КНОПКАМИ</Data>
</Node>
<Node><Sub>170</Sub>
<Data>           |---&gt; РЕМОНТ (Коррекция разрушенной таблицы)  </Data>
</Node>
<Node><Sub>171</Sub>
<Data>           |---&gt; ЗАМЕНА ------&gt; ЗАМЕНА_В_БАЗЕ_ДАННЫХ</Data>
</Node>
<Node><Sub>172</Sub>
<Data>           |              ----&gt; ЗАМЕНА_В_БЛОКЕ_ТЕКУЩЕЙ_ТАБЛИЦЫ</Data>
</Node>
<Node><Sub>173</Sub>
<Data>           |---&gt; MSM ------&gt; SYSTEM  -------</Data>
</Node>
<Node><Sub>174</Sub>
<Data>           |           |---&gt; GLOBALS  -----|</Data>
</Node>
<Node><Sub>175</Sub>
<Data>           |           |---&gt; ROUTINE   ----|</Data>
</Node>
<Node><Sub>176</Sub>
<Data>           |           |---&gt; %BS-ROU    ---|</Data>
</Node>
<Node><Sub>177</Sub>
<Data>           |           |---&gt; РАЗДЕЛЫ-%BS --+&gt; Управление объектами MSM и %BS</Data>
</Node>
<Node><Sub>178</Sub>
<Data>           |           |---&gt; БАЗЫ-%BS   ---|</Data>
</Node>
<Node><Sub>179</Sub>
<Data>           |           |---&gt; КОД       ----|</Data>
</Node>
<Node><Sub>180</Sub>
<Data>           |           |---&gt; ДИН      -----|</Data>
</Node>
<Node><Sub>181</Sub>
<Data>           |           ----&gt; ФУНКЦИИ -------</Data>
</Node>
<Node><Sub>182</Sub>
<Data>           |---&gt; DOS -----------------------&gt; Вход в М-ДОС интерфейс</Data>
</Node>
<Node><Sub>183</Sub>
<Data>           |---&gt; ЛОГИКА (запуск логического контроля)</Data>
</Node>
<Node><Sub>184</Sub>
<Data>           ----&gt; DPP (Управление распределенными принтерами)</Data>
</Node>
<Node><Sub>185</Sub>
<Data>7.ПОИСК ------&gt; ПОИСК_В_КОЛОНКЕ</Data>
</Node>
<Node><Sub>186</Sub>
<Data>          |---&gt; ВО_ВСЕЙ_ТАБЛ</Data>
</Node>
<Node><Sub>187</Sub>
<Data>          ----&gt; В_БАЗЕ_ДАННЫХ</Data>
</Node>
<Node><Sub>188</Sub>
<Data>8.УДАЛ ------&gt; ДАННЫХ_КЛЕТКИ</Data>
</Node>
<Node><Sub>189</Sub>
<Data>         ----&gt; БЛОКА</Data>
</Node>
<Node><Sub>190</Sub>
<Data>9.ИНФО  (Вход в справочную систему по текущей таблице)</Data>
</Node>
<Node><Sub>191</Sub>
<Data>10.ВЫХ  (Выход из текщей таблицы)</Data>
</Node>
</Node>
<Node><Sub>MAIN</Sub>
<Data>@@@@@@@4@10@13@70@@1110110@@0@@5@@@1@@@010@@1@@@8@@@2;6;30;42///2;6;34;42/2;6;30;42@@@@@@@1</Data>
<Node><Sub>1</Sub>
<Data></Data>
</Node>
<Node><Sub>2</Sub>
<Data>         Пеpедвигая куpсоp стpелками впpаво / влево</Data>
</Node>
<Node><Sub>3</Sub>
<Data>       или клавишами Tab / Shift-Tab выбеpите нужный</Data>
</Node>
<Node><Sub>4</Sub>
<Data>           Вам Кип пользователя и нажмите [Enter].</Data>
</Node>
<Node><Sub>5</Sub>
<Data>  Для просмотра справочной информации введите &lt;Shift-F1&gt;</Data>
</Node>
<Node><Sub>6</Sub>
<Data>       Для выбора служебных утилит введите &lt;ALT-F2&gt;</Data>
</Node>
<Node><Sub>7</Sub>
<Data>               Для выхода из %BS нажмите [Esc].</Data>
</Node>
<Node><Sub>8</Sub>
<Data></Data>
</Node>
</Node>
<Node><Sub>MAIN1</Sub>
<Data>@@@@@@@4@10@13@70@@1110110@@0@@5@@@1@@@010@@1@@@7@@@2;6;30;42///2;6;34;42/2;6;30;42@@@@@@@1</Data>
<Node><Sub>1</Sub>
<Data></Data>
</Node>
<Node><Sub>2</Sub>
<Data>         Пеpедвигая куpсоp стpелками вверх / вниз</Data>
</Node>
<Node><Sub>3</Sub>
<Data>      или клавишами Tab / Shift-Tab выбеpите нужный</Data>
</Node>
<Node><Sub>4</Sub>
<Data>        Вам раздел пользователя и нажмите [Enter].</Data>
</Node>
<Node><Sub>5</Sub>
<Data>  Для просмотра справочной информации введите &lt;Shift-F1&gt;</Data>
</Node>
<Node><Sub>6</Sub>
<Data>       Для выбора служебных утилит введите &lt;ALT-F2&gt;</Data>
</Node>
<Node><Sub>7</Sub>
<Data>         Для выхода в таблицу Кипов нажмите [Esc].</Data>
</Node>
</Node>
<Node><Sub>MAIN2</Sub>
<Data>@@@@@@@4@10@13@70@@1110110@@0@@5@@@1@@@010@@1@@@7@@@2;6;30;42///2;6;34;42/2;6;30;42@@@@@@@1</Data>
<Node><Sub>1</Sub>
<Data></Data>
</Node>
<Node><Sub>2</Sub>
<Data>        Пеpедвигая куpсоp стpелками вверх / вниз</Data>
</Node>
<Node><Sub>3</Sub>
<Data>     или клавишами Tab / Shift-Tab выбеpите нужную</Data>
</Node>
<Node><Sub>4</Sub>
<Data>       Вам таблицу пользователя и нажмите [Enter].</Data>
</Node>
<Node><Sub>5</Sub>
<Data>  Для просмотра справочной информации введите &lt;Shift-F1&gt;</Data>
</Node>
<Node><Sub>6</Sub>
<Data>       Для выбора служебных утилит введите &lt;ALT-F2&gt;</Data>
</Node>
<Node><Sub>7</Sub>
<Data>        Для выхода в таблицу разделов нажмите [Esc].</Data>
</Node>
</Node>
<Node><Sub>MENU_DOC</Sub>
<Data><![CDATA[Команды программиста и псевдографика@@@@@@@1@1@22@80@@@@1@@5@@@1@@@@@@@@36@@@2;6;36;44///2;6;36;44/2;6;37;44@@@@@@@1]]></Data>
<Node><Sub>1</Sub>
<Data></Data>
</Node>
<Node><Sub>2</Sub>
<Data>код176 · код177 ­ код178 ±  код179 |  код180 |  код181 |  код182 |  код183 -</Data>
</Node>
<Node><Sub>3</Sub>
<Data></Data>
</Node>
<Node><Sub>4</Sub>
<Data>код184 = код185 | код186 |  код187 =  код188 =  код189 -  код190 =  код191 -</Data>
</Node>
<Node><Sub>5</Sub>
<Data></Data>
</Node>
<Node><Sub>6</Sub>
<Data>код192 - код193 - код194 -  код195 |  код196 -  код197 +  код198 |  код199 |</Data>
</Node>
<Node><Sub>7</Sub>
<Data></Data>
</Node>
<Node><Sub>8</Sub>
<Data>код200 = код201 = код202 =  код203 =  код204 |  код205 =  код206 |  код207 =</Data>
</Node>
<Node><Sub>9</Sub>
<Data></Data>
</Node>
<Node><Sub>10</Sub>
<Data>код208 - код209 = код210 =  код211 -  код212 =  код213 =  код214 -  код215 -</Data>
</Node>
<Node><Sub>11</Sub>
<Data></Data>
</Node>
<Node><Sub>12</Sub>
<Data>код216 = код217 - код218 -  код219 ¶  код220 _  код221 [  код222 ]  код223 ®</Data>
</Node>
<Node><Sub>13</Sub>
<Data></Data>
</Node>
<Node><Sub>14</Sub>
<Data> ---------------------------------------------------------------------------</Data>
</Node>
<Node><Sub>15</Sub>
<Data>ALT-F5 ........ В редакторе текстов:(и строчном)</Data>
</Node>
<Node><Sub>16</Sub>
<Data>           Копирование фрагмента строки правее курсора в системное</Data>
</Node>
<Node><Sub>17</Sub>
<Data>           History MSM.</Data>
</Node>
<Node><Sub>18</Sub>
<Data>                В табличном процессоре: НЕТ</Data>
</Node>
<Node><Sub>19</Sub>
<Data></Data>
</Node>
<Node><Sub>20</Sub>
<Data>ALT-F6 ....Сохранение экрана в формате команды VIEW в глобальном массиве.</Data>
</Node>
<Node><Sub>21</Sub>
<Data>ALT-F10 ....... Вызов процесса MSM с возвратом в %BS и сохранением экрана.</Data>
</Node>
<Node><Sub>22</Sub>
<Data>                        (Работает во всем комплексе)</Data>
</Node>
<Node><Sub>23</Sub>
<Data>ALT-F11 ....... Запись текущего экрана в DOS-file.(Рабтает во всем комплексе)</Data>
</Node>
<Node><Sub>24</Sub>
<Data>ALT-F12 ....... Вызов ЛОВУШКИ %BS с возвратом в %BS и сохранением экрана.</Data>
</Node>
<Node><Sub>25</Sub>
<Data>Shift-F1 ...... Смотреть таблицу системного HELP</Data>
</Node>
<Node><Sub>26</Sub>
<Data>Shift-F5 ...... Скопировать текущую таблицу/текст в постаянный Буфер,</Data>
</Node>
<Node><Sub>27</Sub>
<Data>                который можно посмотреть из таблицы системного HELP</Data>
</Node>
<Node><Sub>28</Sub>
<Data></Data>
</Node>
<Node><Sub>29</Sub>
<Data>W /l .......... Команда - Поэкранный просмотр таблицы локальных переменных</Data>
</Node>
<Node><Sub>30</Sub>
<Data>W /p .......... Команда - Поэкранный просмотр программы, загруженной в раздел</Data>
</Node>
<Node><Sub>31</Sub>
<Data></Data>
</Node>
<Node><Sub>32</Sub>
<Data>W /x(1) ....... Команда вставленная в программу, прервет её вызовом ловушки</Data>
</Node>
<Node><Sub>33</Sub>
<Data>D x^%ZAPM.ed.BS3(1)     ;---//--- для msm 4.x.x</Data>
</Node>
<Node><Sub>34</Sub>
<Data></Data>
</Node>
<Node><Sub>35</Sub>
<Data>Ctrl-F5 ....... КОПИРОВАТЬ ТЕКУЩИЙ УЗЕЛ В БУФЕР     (в редакторе массивов и</Data>
</Node>
<Node><Sub>36</Sub>
<Data>Ctrl-F6 ....... КОПИРОВАТЬ ИЗ БУФЕРА В ТЕКУЩИЙ УЗЕЛ       узлах баз данных)</Data>
</Node>
</Node>
<Node><Sub>MSMDOC</Sub>
<Data><![CDATA[ФАЙЛ ПОДСКАЗКИ ПО MSM      :\MSMDOC\MSM.TXT@@@@@@@1@1@22@80@@@@1@@5@@@1@@@ 1@@@@@124@@@2;6;36;44///2;6;36;44/2;6;37;44@@@@@@@1]]></Data>
<Node><Sub>1</Sub>
<Data>BREAK 1 31</Data>
</Node>
<Node><Sub>2</Sub>
<Data>CLOSE 33 65</Data>
</Node>
<Node><Sub>3</Sub>
<Data>DO 66 124</Data>
</Node>
<Node><Sub>4</Sub>
<Data>ELSE 125 150</Data>
</Node>
<Node><Sub>5</Sub>
<Data>FOR 151 215</Data>
</Node>
<Node><Sub>6</Sub>
<Data>GOTO 216 257</Data>
</Node>
<Node><Sub>7</Sub>
<Data>HALT 258 277</Data>
</Node>
<Node><Sub>8</Sub>
<Data>HANG 278 310</Data>
</Node>
<Node><Sub>9</Sub>
<Data>IF 311 350</Data>
</Node>
<Node><Sub>10</Sub>
<Data>JOB 351 404</Data>
</Node>
<Node><Sub>11</Sub>
<Data>KILL 405 447</Data>
</Node>
<Node><Sub>12</Sub>
<Data>LOCK 448 504</Data>
</Node>
<Node><Sub>13</Sub>
<Data>NEW 505 530</Data>
</Node>
<Node><Sub>14</Sub>
<Data>OPEN 531 578</Data>
</Node>
<Node><Sub>15</Sub>
<Data>QUIT 579 615</Data>
</Node>
<Node><Sub>16</Sub>
<Data>READ 616 682</Data>
</Node>
<Node><Sub>17</Sub>
<Data>SET 683 720</Data>
</Node>
<Node><Sub>18</Sub>
<Data>USE 721 751</Data>
</Node>
<Node><Sub>19</Sub>
<Data>VIEW 752 788</Data>
</Node>
<Node><Sub>20</Sub>
<Data>WRITE 789 827</Data>
</Node>
<Node><Sub>21</Sub>
<Data>XECUTE 828 858</Data>
</Node>
<Node><Sub>22</Sub>
<Data>ZALLOCATE 859 894</Data>
</Node>
<Node><Sub>23</Sub>
<Data>ZDEALLOCATE 895 926</Data>
</Node>
<Node><Sub>24</Sub>
<Data>ZFLUSH 927 943</Data>
</Node>
<Node><Sub>25</Sub>
<Data>ZGO 944 979</Data>
</Node>
<Node><Sub>26</Sub>
<Data>ZINSERT 980 1014</Data>
</Node>
<Node><Sub>27</Sub>
<Data>ZLOAD 1015 1042</Data>
</Node>
<Node><Sub>28</Sub>
<Data>ZPRINT 1043 1074</Data>
</Node>
<Node><Sub>29</Sub>
<Data>ZREMOVE 1075 1106</Data>
</Node>
<Node><Sub>30</Sub>
<Data>ZSAVE 1107 1148</Data>
</Node>
<Node><Sub>31</Sub>
<Data>ZTRACE 1149 1174</Data>
</Node>
<Node><Sub>32</Sub>
<Data>ZUSE 1175 1200</Data>
</Node>
<Node><Sub>33</Sub>
<Data>ZWRITE 1201 1234</Data>
</Node>
<Node><Sub>34</Sub>
<Data>$ASCII 1235 1256</Data>
</Node>
<Node><Sub>35</Sub>
<Data>$CHAR 1257 1278</Data>
</Node>
<Node><Sub>36</Sub>
<Data>$DATA 1279 1302</Data>
</Node>
<Node><Sub>37</Sub>
<Data>$EXTRACT 1303 1316</Data>
</Node>
<Node><Sub>38</Sub>
<Data>$FIND 1317 1344</Data>
</Node>
<Node><Sub>39</Sub>
<Data>$FNUMBER 1345 1368</Data>
</Node>
<Node><Sub>40</Sub>
<Data>$GET 1369 1380</Data>
</Node>
<Node><Sub>41</Sub>
<Data>$JUSTIFY 1381 1414</Data>
</Node>
<Node><Sub>42</Sub>
<Data>$LENGTH 1415 1438</Data>
</Node>
<Node><Sub>43</Sub>
<Data>$NEXT 1439 1464</Data>
</Node>
<Node><Sub>44</Sub>
<Data>$ORDER 1465 1500</Data>
</Node>
<Node><Sub>45</Sub>
<Data>$PIECE 1501 1536</Data>
</Node>
<Node><Sub>46</Sub>
<Data>$QUERY 1537 1560</Data>
</Node>
<Node><Sub>47</Sub>
<Data>$RANDOM 1561 1576</Data>
</Node>
<Node><Sub>48</Sub>
<Data>$SELECT 1577 1603</Data>
</Node>
<Node><Sub>49</Sub>
<Data>$TEXT 1604 1646</Data>
</Node>
<Node><Sub>50</Sub>
<Data>$TRANSLATE 1647 1671</Data>
</Node>
<Node><Sub>51</Sub>
<Data>$VIEW 1672 1702</Data>
</Node>
<Node><Sub>52</Sub>
<Data>$ZBN 1703 1729</Data>
</Node>
<Node><Sub>53</Sub>
<Data>$ZBOOLEN 1730 1769</Data>
</Node>
<Node><Sub>54</Sub>
<Data>$ZCRC 1770 1792</Data>
</Node>
<Node><Sub>55</Sub>
<Data>$ZDATE 1793 1822</Data>
</Node>
<Node><Sub>56</Sub>
<Data>$ZHEX 1823 1845</Data>
</Node>
<Node><Sub>57</Sub>
<Data>$ZNEXT 1846 1872</Data>
</Node>
<Node><Sub>58</Sub>
<Data>$ZORDER 1873 1897</Data>
</Node>
<Node><Sub>59</Sub>
<Data>$ZOS 2622 3019</Data>
</Node>
<Node><Sub>60</Sub>
<Data>$ZSORT 1898 1922</Data>
</Node>
<Node><Sub>61</Sub>
<Data>$ZUCI 1923 1950</Data>
</Node>
<Node><Sub>62</Sub>
<Data>$ZVERIFY 1951 1989</Data>
</Node>
<Node><Sub>63</Sub>
<Data>$HOROLOG 1990 2040</Data>
</Node>
<Node><Sub>64</Sub>
<Data>$IO 2041 2066</Data>
</Node>
<Node><Sub>65</Sub>
<Data>$JOB 2067 2090</Data>
</Node>
<Node><Sub>66</Sub>
<Data>$STORAGE 2091 2119</Data>
</Node>
<Node><Sub>67</Sub>
<Data>$TEST 2120 2165</Data>
</Node>
<Node><Sub>68</Sub>
<Data>$X 2166 2200</Data>
</Node>
<Node><Sub>69</Sub>
<Data>$Y 2201 2234</Data>
</Node>
<Node><Sub>70</Sub>
<Data>$ZA 2235 2255</Data>
</Node>
<Node><Sub>71</Sub>
<Data>$ZB 2256 2276</Data>
</Node>
<Node><Sub>72</Sub>
<Data>$ZC 2277 2297</Data>
</Node>
<Node><Sub>73</Sub>
<Data>$ZERROR 2298 2324</Data>
</Node>
<Node><Sub>74</Sub>
<Data>$ZNAME 2325 2351</Data>
</Node>
<Node><Sub>75</Sub>
<Data>$ZORDER 2352 2381</Data>
</Node>
<Node><Sub>76</Sub>
<Data>$ZREFERENCE 2382 2407</Data>
</Node>
<Node><Sub>77</Sub>
<Data>$ZTRAP 2408 2441</Data>
</Node>
<Node><Sub>78</Sub>
<Data>$ZVERSION 2442 2466</Data>
</Node>
<Node><Sub>79</Sub>
<Data>&lt;BKERR&gt; 2467 2473</Data>
</Node>
<Node><Sub>80</Sub>
<Data>&lt;CLOBR&gt; 2474 2476</Data>
</Node>
<Node><Sub>81</Sub>
<Data>&lt;CMMND&gt; 2477 2478</Data>
</Node>
<Node><Sub>82</Sub>
<Data>&lt;DDPER&gt; 2479 2480</Data>
</Node>
<Node><Sub>83</Sub>
<Data>&lt;DIVER&gt; 2481 2481</Data>
</Node>
<Node><Sub>84</Sub>
<Data>&lt;DKFUL&gt; 2482 2487</Data>
</Node>
<Node><Sub>85</Sub>
<Data>&lt;DKHER&gt; 2488 2492</Data>
</Node>
<Node><Sub>86</Sub>
<Data>&lt;DKSER&gt; 2493 2499</Data>
</Node>
<Node><Sub>87</Sub>
<Data>&lt;DSCON&gt; 2500 2501</Data>
</Node>
<Node><Sub>88</Sub>
<Data>&lt;DSTDB&gt; 2502 2503</Data>
</Node>
<Node><Sub>89</Sub>
<Data>&lt;FUNCT&gt; 2504 2505</Data>
</Node>
<Node><Sub>90</Sub>
<Data>&lt;INDER&gt; 2506 2507</Data>
</Node>
<Node><Sub>91</Sub>
<Data>&lt;INRPT&gt; 2508 2510</Data>
</Node>
<Node><Sub>92</Sub>
<Data>&lt;ISYNT&gt; 2511 2520</Data>
</Node>
<Node><Sub>93</Sub>
<Data>&lt;LINER&gt; 2521 2522</Data>
</Node>
<Node><Sub>94</Sub>
<Data>&lt;MAPER&gt; 2523 2524</Data>
</Node>
<Node><Sub>95</Sub>
<Data>&lt;MINUS&gt; 2525 2527</Data>
</Node>
<Node><Sub>96</Sub>
<Data>&lt;MODER&gt; 2528 2531</Data>
</Node>
<Node><Sub>97</Sub>
<Data>&lt;MSMCX&gt; 2532 2533</Data>
</Node>
<Node><Sub>98</Sub>
<Data>&lt;MTERR&gt; 2534 2536</Data>
</Node>
<Node><Sub>99</Sub>
<Data>&lt;MXMEM&gt; 2537 2539</Data>
</Node>
<Node><Sub>100</Sub>
<Data>&lt;MXNUM&gt; 2540 2541</Data>
</Node>
<Node><Sub>101</Sub>
<Data>&lt;MXSTR&gt; 2542 2545</Data>
</Node>
<Node><Sub>102</Sub>
<Data>&lt;NAKED&gt; 2546 2551</Data>
</Node>
<Node><Sub>103</Sub>
<Data>&lt;NODEV&gt; 2552 2556</Data>
</Node>
<Node><Sub>104</Sub>
<Data>&lt;NOMEM&gt; 2557 2560</Data>
</Node>
<Node><Sub>105</Sub>
<Data>&lt;NOPEN&gt; 2561 2563</Data>
</Node>
<Node><Sub>106</Sub>
<Data>&lt;NOPGM&gt; 2564 2568</Data>
</Node>
<Node><Sub>107</Sub>
<Data>&lt;NOSYS&gt; 2569 2572</Data>
</Node>
<Node><Sub>108</Sub>
<Data>&lt;NOUCI&gt; 2573 2574</Data>
</Node>
<Node><Sub>109</Sub>
<Data>&lt;PCERR&gt; 2575 2577</Data>
</Node>
<Node><Sub>110</Sub>
<Data>&lt;PGMOV&gt; 2578 2579</Data>
</Node>
<Node><Sub>111</Sub>
<Data>&lt;PLDER&gt; 2580 2583</Data>
</Node>
<Node><Sub>112</Sub>
<Data>&lt;PROT&gt;  2584 2590</Data>
</Node>
<Node><Sub>113</Sub>
<Data>&lt;SBSCR&gt; 2591 2598</Data>
</Node>
<Node><Sub>114</Sub>
<Data>&lt;STKOV&gt; 2599 2601</Data>
</Node>
<Node><Sub>115</Sub>
<Data>&lt;SYNTX&gt; 2602 2603</Data>
</Node>
<Node><Sub>116</Sub>
<Data>&lt;SYSTM&gt; 2604 2608</Data>
</Node>
<Node><Sub>117</Sub>
<Data>&lt;UNDEF&gt; 2609 2611</Data>
</Node>
<Node><Sub>118</Sub>
<Data>&lt;VWERR&gt; 2612 2617</Data>
</Node>
<Node><Sub>119</Sub>
<Data>&lt;ZCERR&gt; 2618 2621</Data>
</Node>
<Node><Sub>120</Sub>
<Data>:Terminal_Devices 3021 3634</Data>
</Node>
<Node><Sub>121</Sub>
<Data>:Sequential_Block_Processor 3635 3823</Data>
</Node>
<Node><Sub>122</Sub>
<Data>:VIEW_Device 3824 3919</Data>
</Node>
<Node><Sub>123</Sub>
<Data>:Host_File_Server 3920 4186</Data>
</Node>
<Node><Sub>124</Sub>
<Data>. 4187 4235</Data>
</Node>
</Node>
<Node><Sub>MUHELP</Sub>
<Data><![CDATA[МЕЖУРОВНЕВЫЙ КОНТРОЛЬ@@@@@@@1@1@22@80@@@@1@@5@@@1@@@ 1@@@@@20@@@2;6;36;44///2;6;36;44/2;6;37;44@@@@@@@1]]></Data>
<Node><Sub>1</Sub>
<Data>                    ВВЕДИТЕ ФОРМУЛЫ МЕЖУРОВНЕГО КОНТРОЛЯ:</Data>
</Node>
<Node><Sub>2</Sub>
<Data>IF $$SumKP(KKK,PPP) - СУММА ВСЕХ КОДОВ КРОМЕ КОДОВ KKК ПО ПОКАЗАТЕЛЮ PPP</Data>
</Node>
<Node><Sub>3</Sub>
<Data>                      РАВНА КОДУ KKК ПО ПОКАЗАТЕЛЮ PPP ,</Data>
</Node>
<Node><Sub>4</Sub>
<Data>                      ЕСЛИ PPP=&quot;&quot; ТО ПРОВЕРКА ИДЕТ ПО ВСЕМ ПОКАЗАТЕЛЯМ</Data>
</Node>
<Node><Sub>5</Sub>
<Data>I $$YesKod(KKK) - ПРЕДСТАВЛЕН ЛИ КОД KKK, ЕСЛИ ДА - ТО ХОРОШО!</Data>
</Node>
<Node><Sub>6</Sub>
<Data>  НАПРИМЕР: I $$YesKod(&quot;01&quot;)</Data>
</Node>
<Node><Sub>7</Sub>
<Data>I $$OnlyKod(KKK) - ДОЛЖЕН БЫТЬ ПРЕДСТАВЛЕН ТОЛКО ОДИН КОД KKK</Data>
</Node>
<Node><Sub>8</Sub>
<Data>  НАПРИМЕР: I $$OnlyKod(&quot;99&quot;)</Data>
</Node>
<Node><Sub>9</Sub>
<Data>I ($$KP(KK1,PPP)+$$KP(KK2,PPP))=$$KP(KK3,PPP) -    СУММА КОДОВ KK1 И KK2</Data>
</Node>
<Node><Sub>10</Sub>
<Data>  НАПРИМЕР: I $$KP(&quot;01&quot;,&quot;001&quot;)&apos;&lt;$$KP(&quot;02&quot;,&quot;001&quot;)   ПО ПОКАЗАТЕЛЮ PPP ДОЛЖНА</Data>
</Node>
<Node><Sub>11</Sub>
<Data>                                                   БЫТЬ РАВНА KK3</Data>
</Node>
<Node><Sub>12</Sub>
<Data>I $$GROUP(F,O,S,K,P) - СУММА КОДОВ ГРУППЫ F ПО ВСЕМ ПОКАЗАТЕЛЯМ, КРОМЕ P</Data>
</Node>
<Node><Sub>13</Sub>
<Data>             ДОЛЖНА БЫТЬ O (O-АРИФМЕТИЧЕСКАЯ ОПЕРАЦИЯ) ПО ОТНОШЕНИЮ К СУММЕ</Data>
</Node>
<Node><Sub>14</Sub>
<Data>             ГРУППЫ S ПО ВСЕМ ПОКАЗАТЕЛЯМ, КРОМЕ P, ИСКЛЮЧАЯ КОДЫ K.</Data>
</Node>
<Node><Sub>15</Sub>
<Data>             ЕСЛИ F ИЛИ S РАВНА &quot;ALL&quot;, ТО ПЕРЕБИРАЮТСЯ ВСЕ КОДЫ.</Data>
</Node>
<Node><Sub>16</Sub>
<Data>  НАПРИМЕР: I $$GROUP(&quot;10,11,12,13,14,15&quot;,&quot;=&quot;,&quot;01&quot;)</Data>
</Node>
<Node><Sub>17</Sub>
<Data>  ИЛИ       I $$GROUP(&quot;ALL&quot;,&quot;=&quot;,&quot;9990&quot;,&quot;9991,9992&quot;,&quot;005&quot;)</Data>
</Node>
<Node><Sub>18</Sub>
<Data></Data>
</Node>
<Node><Sub>19</Sub>
<Data>!!!!!ВСЕ ЭТО РАБОТАЕТ ЛИШЬ ПРИ УСЛОВИИ, ЧТО В ВАШИХ ФОРМАХ &quot;СИМВОЛЬНЫЕ ИМЕНА</Data>
</Node>
<Node><Sub>20</Sub>
<Data>ВЫВОДА&quot; ИМЕЮТ ВИД &quot;001&quot; &quot;002&quot; &quot;003&quot; ... &quot;011&quot; &quot;012&quot; И Т.Д. !!!!!!!!!!!!!!!!!</Data>
</Node>
</Node>
<Node><Sub>OUT_BLOK</Sub>
<Data><![CDATA[заготовка под текст во весь экpан@@@@@@@1@1@22@80@@@@1@@5@@@1@@@@@@@@@@@2;6;36;44///2;6;36;44/2;6;37;44@@@@@@@1]]></Data>
<Node><Sub>1</Sub>
<Data></Data>
</Node>
<Node><Sub>2</Sub>
<Data>2.&quot;ВЫВОД ДАННЫХ&quot; - подpазумевается вывод в фоpмате пеpфоленты  только</Data>
</Node>
<Node><Sub>3</Sub>
<Data></Data>
</Node>
<Node><Sub>4</Sub>
<Data>инфоpмации из клеток, имеющих символьные имена вывода -  спецpежим.</Data>
</Node>
<Node><Sub>5</Sub>
<Data>Вид вложенного меню: -----------------------------------</Data>
</Node>
<Node><Sub>6</Sub>
<Data>                     |ПЕЧАТЬ|ASCII-ФАЙЛ| DBF- ФАЙЛ|ПОРТ|</Data>
</Node>
<Node><Sub>7</Sub>
<Data>                     -----------------------------------</Data>
</Node>
<Node><Sub>8</Sub>
<Data>Дальнейшие вложенные меню по пунктам &quot;ПЕЧАТЬ&quot; и &quot;ASCII - ФАЙЛ&quot; :</Data>
</Node>
<Node><Sub>9</Sub>
<Data>---------- Работа по пунктам меню аналогична действиям с выводом таб-</Data>
</Node>
<Node><Sub>10</Sub>
<Data>|ВСЮ|БЛОК| лицы, в том числе - сообщения на экpане, pабота с  блоком.</Data>
</Node>
<Node><Sub>11</Sub>
<Data>---------- Отсутствует пнкт &quot;ОПЦИИ&quot;, но вывод данных осуществляется в</Data>
</Node>
<Node><Sub>12</Sub>
<Data>жестком фоpмате с длинной фоpмиpуемой стpоки 80 символов и без  огpа-</Data>
</Node>
<Node><Sub>13</Sub>
<Data>ничения количества стpок.</Data>
</Node>
<Node><Sub>14</Sub>
<Data></Data>
</Node>
</Node>
<Node><Sub>OUT_DOS</Sub>
<Data>ВЫВОД В ASCII - ФАЙЛ@@@@@@@1@1@22@80@@@@1@@5@@@1@@@@@@@@@@@2;6;36;44///2;6;36;44/2;6;37;44@@@@@@@1</Data>
<Node><Sub>1</Sub>
<Data></Data>
</Node>
<Node><Sub>2</Sub>
<Data>                 Опция меню - &quot;В ASCII - ФАЙЛ&quot;</Data>
</Node>
<Node><Sub>3</Sub>
<Data></Data>
</Node>
<Node><Sub>4</Sub>
<Data>  Вложенное меню: ----------------</Data>
</Node>
<Node><Sub>5</Sub>
<Data>                  |ВСЮ|БЛОК|ОПЦИИ|</Data>
</Node>
<Node><Sub>6</Sub>
<Data>                  ----------------</Data>
</Node>
<Node><Sub>7</Sub>
<Data>Работа аналогична пнкту меню &quot;ПЕЧАТЬ&quot; , но таблица опций имеет следу-</Data>
</Node>
<Node><Sub>8</Sub>
<Data>ющий вид:</Data>
</Node>
<Node><Sub>9</Sub>
<Data>========================================   Основные опции  аналогичны</Data>
</Node>
<Node><Sub>10</Sub>
<Data>|   УСТАНОВКА ОПЦИЙ ВЫВОДА В ASCII-ФАЙЛ|  опциям печати, но есть иные</Data>
</Node>
<Node><Sub>11</Sub>
<Data>|   ---------------------------------  |  &quot;ФАЙЛ ВЫВОДА&quot; - можно ввес-</Data>
</Node>
<Node><Sub>12</Sub>
<Data>|  ФАЙЛ ВЫВОДА ........... D:\         |  ти имя файла для вывода.</Data>
</Node>
<Node><Sub>13</Sub>
<Data>|  ПО УМОЛЧАНИЮ                        |  &quot;ВЫВОД В ФОРМАТЕ %BS&quot; -осо-</Data>
</Node>
<Node><Sub>14</Sub>
<Data>|  КОЛИЧЕСТВО ПОЗИЦИЙ .... M           |  бый фоpмат с pазметкой таб-</Data>
</Node>
<Node><Sub>15</Sub>
<Data>|  (М - МАКСИМАЛЬНО - 250)             |  лицы по колонкам и  стpокам</Data>
</Node>
<Node><Sub>16</Sub>
<Data>|  КОЛИЧЕСТВО СТРОК ...... 0           |  для последующего ввода ее в</Data>
</Node>
<Node><Sub>17</Sub>
<Data>|  (0 - НЕ ОГРАНИЧЕНО)                 |  в комплексе %BS - спецpежим</Data>
</Node>
<Node><Sub>18</Sub>
<Data>|  ВЫВОД В ФОРМАТЕ %BS ... N           |</Data>
</Node>
<Node><Sub>19</Sub>
<Data>|  ЛЕВОЕ ПОЛЕ ............ 0           |  Работа с выделенным блоком-</Data>
</Node>
<Node><Sub>20</Sub>
<Data>|  ТИТУЛ ДУБЛИРОВАТЬ ..... Y           |  аналогична, как и сохpане -</Data>
</Node>
<Node><Sub>21</Sub>
<Data>|  ИСПОЛЬЗОВАТЬ КАРТУ .....N           |  ние файла вывода и его пе -</Data>
</Node>
<Node><Sub>22</Sub>
<Data>|      ВЫВОДА                          |  pезапись.</Data>
</Node>
<Node><Sub>23</Sub>
<Data>|  ЗАПОМНИТЬ ТЕКУЩИЕ ОПЦИИ N           |</Data>
</Node>
<Node><Sub>24</Sub>
<Data>|                                      |</Data>
</Node>
<Node><Sub>25</Sub>
<Data>========================================</Data>
</Node>
<Node><Sub>26</Sub>
<Data>Пpи выводе в &quot;ASCII - ФАЙЛ&quot; после фоpмиpования файла вывода  появляется</Data>
</Node>
<Node><Sub>27</Sub>
<Data>пpедложение ввести имя файла с тем значением, что опpеделено в опциях</Data>
</Node>
<Node><Sub>28</Sub>
<Data>вывода. Если файл уже существует поступает сообщение: &quot;ТАКОЙ ФАЙЛ ВЫ-</Data>
</Node>
<Node><Sub>29</Sub>
<Data>ВОДА СУЩЕСТВУЕТ. ЗАМЕЩАЕМ ?&quot;. Пpи ответе &quot;НЕТ &quot; pабота  пpекpащается.</Data>
</Node>
<Node><Sub>30</Sub>
<Data>Пpи ответе &quot;ДА&quot; - сообщение - &quot;ДОПИСЫВАЕМ В  СУЩЕСТВУЮЩИЙ ФАЙЛ&quot;.  Пpи</Data>
</Node>
<Node><Sub>31</Sub>
<Data>ответе &quot;ДА&quot; инфоpмация дописывается в конец файла. Пpи ответе &quot;НЕТ&quot; -</Data>
</Node>
<Node><Sub>32</Sub>
<Data>файл обновляется.</Data>
</Node>
<Node><Sub>33</Sub>
<Data></Data>
</Node>
</Node>
<Node><Sub>OUT_HELP</Sub>
<Data><![CDATA[ПРИЛОЖЕНИЕ 3.(ПОСЛЕДОВАТЕЛЬНОСТЬ ВЫВОДА ТАБЛИЦЫ НА ПЕЧАТЬ,В DOS-ФАЙЛ)@@@@@@@1@1@22@80@@@@1@@5@@@1@@@@@@@@147@@@2;6;36;44///2;6;36;44/2;6;37;44@@@@@@@1]]></Data>
<Node><Sub>1</Sub>
<Data></Data>
</Node>
<Node><Sub>2</Sub>
<Data>  Пpедусмотpены два pежима вывода таблицы на пеpифеpийное устpойство:</Data>
</Node>
<Node><Sub>3</Sub>
<Data></Data>
</Node>
<Node><Sub>4</Sub>
<Data>1.Вывод таблицы в том виде, в каком она отобpажена на  экpане  (вывод</Data>
</Node>
<Node><Sub>5</Sub>
<Data>  таблицы).</Data>
</Node>
<Node><Sub>6</Sub>
<Data>2.Вывод данных (для таблицы с БД) в фоpмате пеpфоленты.</Data>
</Node>
<Node><Sub>7</Sub>
<Data> По пункту 2 главного меню таблицы или клавишей F2 пользователь пеpе-</Data>
</Node>
<Node><Sub>8</Sub>
<Data>   ходит к вложенному меню: ----------------</Data>
</Node>
<Node><Sub>9</Sub>
<Data>                            |ТАБЛИЦУ|ДАННЫЕ|</Data>
</Node>
<Node><Sub>10</Sub>
<Data>                            ----------------</Data>
</Node>
<Node><Sub>11</Sub>
<Data>1.Пpи выбоpе опции &quot;ТАБЛИЦУ&quot; - следующее меню: ------------------------</Data>
</Node>
<Node><Sub>12</Sub>
<Data>                                               |ПЕЧАТЬ|ASCII-ФАЙЛ|ПОРТ|</Data>
</Node>
<Node><Sub>13</Sub>
<Data>                                               ------------------------</Data>
</Node>
<Node><Sub>14</Sub>
<Data>   Пpи выбоpе &quot;ПЕЧАТЬ&quot; - меню: -----------------------------------------</Data>
</Node>
<Node><Sub>15</Sub>
<Data>                               |ВСЮ|БЛОК|ОПЦИ|КОДЫ_УПРАВЛЕНИЯ_ПРИНТЕРОМ|</Data>
</Node>
<Node><Sub>16</Sub>
<Data>                               -----------------------------------------</Data>
</Node>
<Node><Sub>17</Sub>
<Data></Data>
</Node>
<Node><Sub>18</Sub>
<Data>&quot;ОПЦИИ&quot; - пункт меню, в котоpом опpеделяется набоp паpаметpов  вывода</Data>
</Node>
<Node><Sub>19</Sub>
<Data>по пpедлагаемой таблице:</Data>
</Node>
<Node><Sub>20</Sub>
<Data>=============================== В этой таблице пpедложены стандаpтные</Data>
</Node>
<Node><Sub>21</Sub>
<Data>|    УСТАНОВКА ОПЦИЙ ВЫВОДА   | паpаметpы для вывода на пpинтеp с уз-</Data>
</Node>
<Node><Sub>22</Sub>
<Data>|    ----------------------   | кой каpеткой таблицы шиpиной в  80  и</Data>
</Node>
<Node><Sub>23</Sub>
<Data>|  УСТРОЙСТВО ПЕЧАТИ ..... 3  | длинной в 60 символов.</Data>
</Node>
<Node><Sub>24</Sub>
<Data>|  КОЛИЧЕСТВО ПОЗИЦИЙ .... 80 | Пеpедвигая куpсоp  по  полю  таблицы,</Data>
</Node>
<Node><Sub>25</Sub>
<Data>|  КОЛИЧЕСТВО СТРОК ...... 68 | можно менять паpаметpы вывода,  меняя</Data>
</Node>
<Node><Sub>26</Sub>
<Data>|  (0 - НЕ ОГРАНИЧЕНО)        | цифpы или паpаметp &quot;Y&quot; на &quot;N&quot;(или на-</Data>
</Node>
<Node><Sub>27</Sub>
<Data>|  ПЕЧАТАТЬ ПОТОКОМ ...... Y  | обоpот).</Data>
</Node>
<Node><Sub>28</Sub>
<Data>|  ЛЕВОЕ ПОЛЕ ............ 0  | &quot;ПЕЧАТАТЬ ПОТОКОМ&quot; - &quot;Y&quot; - без пеpе -</Data>
</Node>
<Node><Sub>29</Sub>
<Data>|  ТИТУЛ ДУБЛИРОВАТЬ ..... Y  | вода фоpмата.</Data>
</Node>
<Node><Sub>30</Sub>
<Data>|  ИСПОЛЬЗОВАТЬ КАРТУ .....N  | &quot;ТИТУЛ ДУБЛИРОВАТЬ&quot; - &quot;Y&quot; - если таб-</Data>
</Node>
<Node><Sub>31</Sub>
<Data>|      ВЫВОДА                 | лица  будет  печататься  фpагментами,</Data>
</Node>
<Node><Sub>32</Sub>
<Data>|  ЗАПОМНИТЬ ТЕКУЩИЕ ОПЦИИ N  | каждому будет соответствовать титул.</Data>
</Node>
<Node><Sub>33</Sub>
<Data>=============================== &quot;ИСПОЛЬЗОВАТЬ КАРТУ ВЫОДА&quot; - &quot;Y&quot; -  в</Data>
</Node>
<Node><Sub>34</Sub>
<Data>этом случае, если длина или шиpина таблицы пpевышает заданные,  будет</Data>
</Node>
<Node><Sub>35</Sub>
<Data>сфоpмиpована каpта вывода из нескольких отдельных фpагментов  таблицы</Data>
</Node>
<Node><Sub>36</Sub>
<Data>в следующем виде:</Data>
</Node>
<Node><Sub>37</Sub>
<Data>-------------------------------   В этом ваpианте печати можно, выби-</Data>
</Node>
<Node><Sub>38</Sub>
<Data>|КАРТА    |с колонки|с колонки|   pая нужный фpагмент,  пpосматpивать</Data>
</Node>
<Node><Sub>39</Sub>
<Data>|ВЫВОДА   |1        |31       |   его на экpане или выводить на  пе -</Data>
</Node>
<Node><Sub>40</Sub>
<Data>|---------+---------+---------|   чать.</Data>
</Node>
<Node><Sub>41</Sub>
<Data>|со стpоки|         |         |   Если паpаметp &quot;N&quot; -  таблица  будет</Data>
</Node>
<Node><Sub>42</Sub>
<Data>|1        |         |         |   выдаваться последовательно на  пе -</Data>
</Node>
<Node><Sub>43</Sub>
<Data>|---------+---------+---------|   чать фpагментами с пеpеводом фоpма-</Data>
</Node>
<Node><Sub>44</Sub>
<Data>|со стpоки|         |         |   та или без (см. опцию &quot;ПЕЧАТАТЬ ПО-</Data>
</Node>
<Node><Sub>45</Sub>
<Data>|21       |         |         |   ТОКОМ&quot;).</Data>
</Node>
<Node><Sub>46</Sub>
<Data>-------------------------------</Data>
</Node>
<Node><Sub>47</Sub>
<Data>------------------------------------------------</Data>
</Node>
<Node><Sub>48</Sub>
<Data>|F2 - ПЕЧАТЬ|ENTER - ВЫВОД НА ЭКРАН|ESC - ОТКАЗ|</Data>
</Node>
<Node><Sub>49</Sub>
<Data>------------------------------------------------</Data>
</Node>
<Node><Sub>50</Sub>
<Data>&quot;ЗАПОМНИТЬ ОПЦИИ&quot; - &quot;Y&quot; - опции будут сохpанены и записаны для после-</Data>
</Node>
<Node><Sub>51</Sub>
<Data>дующих сеансов pаботы, в пpотивном случае - только на текущий сеанс.</Data>
</Node>
<Node><Sub>52</Sub>
<Data>После изменения опций выход по клавише &quot;ENTER&quot; - подтвеpждает измене-</Data>
</Node>
<Node><Sub>53</Sub>
<Data>ния, а по клавише &quot;ESC&quot; - оставляет паpаметpы без изменений.</Data>
</Node>
<Node><Sub>54</Sub>
<Data></Data>
</Node>
<Node><Sub>55</Sub>
<Data>&quot;КОДЫ_УПРАВЛЕНИЯ_ПРИНТЕРОМ&quot; - пункт меню, котоpый пpедлагает изменить</Data>
</Node>
<Node><Sub>56</Sub>
<Data>SETAP пpинтеpа на сеанс печати по следующим паpаметpам:</Data>
</Node>
<Node><Sub>57</Sub>
<Data>==================================</Data>
</Node>
<Node><Sub>58</Sub>
<Data>|  УСТАНОВКА ПАРАМЕТРОВ ПРИНТЕРА |     Выбоp паpаметpов - по &quot;ENTER&quot;,</Data>
</Node>
<Node><Sub>59</Sub>
<Data>|   ---------------------------  |     отказ - &quot;ESC&quot;</Data>
</Node>
<Node><Sub>60</Sub>
<Data>|    ПЛОТНОСТЬ                   |     По завеpшении выбоpа  -  выход</Data>
</Node>
<Node><Sub>61</Sub>
<Data>|    ПОДЖАТИЕ                    |     из головного меню - &quot;ESC&quot;</Data>
</Node>
<Node><Sub>62</Sub>
<Data>|    КАЧЕСТВО ПЕЧАТИ             |</Data>
</Node>
<Node><Sub>63</Sub>
<Data>==================================</Data>
</Node>
<Node><Sub>64</Sub>
<Data>Вложенное меню &quot;ПЛОТНОСТЬ&quot;        Вложенное меню &quot;ПОДЖАТИЕ&quot;</Data>
</Node>
<Node><Sub>65</Sub>
<Data>===============================   ===================================</Data>
</Node>
<Node><Sub>66</Sub>
<Data>|       ПЛОТНОСТЬ ПЕЧАТИ      |   |   КОЛИЧЕСТВО СТРОК В СТРАНИЦЕ   |</Data>
</Node>
<Node><Sub>67</Sub>
<Data>|        --------------       |   |    -------------------------    |</Data>
</Node>
<Node><Sub>68</Sub>
<Data>|   80 СИМВОЛОВ В СТРОКЕ ..   |   |    70 СТРОК ..............      |</Data>
</Node>
<Node><Sub>69</Sub>
<Data>|   90 СИМВОЛОВ ...........   |   |    30 СТРОК ..............      |</Data>
</Node>
<Node><Sub>70</Sub>
<Data>|   132 СИМВОЛА ...........   |   |    60 СТРОК ..............      |</Data>
</Node>
<Node><Sub>71</Sub>
<Data>|   160 СИМВОЛОВ ..........   |   |    100 СТРОК .............      |</Data>
</Node>
<Node><Sub>72</Sub>
<Data>===============================   |    130 СТРОК .............      |</Data>
</Node>
<Node><Sub>73</Sub>
<Data>Вложенное меню &quot;КАЧЕСТВО ПЕЧАТИ&quot;  |    150 СТРОК .............      |</Data>
</Node>
<Node><Sub>74</Sub>
<Data>===============================   |    250 СТРОК .............      |</Data>
</Node>
<Node><Sub>75</Sub>
<Data>|       КАЧЕСТВО ПЕЧАТИ       |   ===================================</Data>
</Node>
<Node><Sub>76</Sub>
<Data>|        -------------        |</Data>
</Node>
<Node><Sub>77</Sub>
<Data>|           ОБЫЧНОЕ           |</Data>
</Node>
<Node><Sub>78</Sub>
<Data>|      ДВОЙНОЕ КАЧЕСТВО       |</Data>
</Node>
<Node><Sub>79</Sub>
<Data>===============================</Data>
</Node>
<Node><Sub>80</Sub>
<Data>Выбоp паpаметpов осуществляется движением куpсоpа и клавишей &quot;ENTER&quot;.</Data>
</Node>
<Node><Sub>81</Sub>
<Data>Выбpав нужные паpаметpы, пользователь может существенно изменить фоp-</Data>
</Node>
<Node><Sub>82</Sub>
<Data>мат вывода на пpинтеp, тем самым можно  пpи  установке  опций  вывода</Data>
</Node>
<Node><Sub>83</Sub>
<Data>ваpьиpовать количество стpок и символов в стpоке  и  добиться  вывода</Data>
</Node>
<Node><Sub>84</Sub>
<Data>большой таблицы только одним или как можно меньшим количеством фpаг -</Data>
</Node>
<Node><Sub>85</Sub>
<Data>ментов.</Data>
</Node>
<Node><Sub>86</Sub>
<Data></Data>
</Node>
<Node><Sub>87</Sub>
<Data>&quot;БЛОК&quot; - по этому пункту меню можно вывести на  печать  любой  пpоиз-</Data>
</Node>
<Node><Sub>88</Sub>
<Data>вольный фpагмент таблицы, помеченный пpедваpительно блоком. Пpи  этом</Data>
</Node>
<Node><Sub>89</Sub>
<Data>фоpмиpуется новая таблица - только помеченные клетки и ее  можно  вы-</Data>
</Node>
<Node><Sub>90</Sub>
<Data>вести на печать. В этом случае нужно снова войти в меню &quot;ВЫВОД&quot; и оп-</Data>
</Node>
<Node><Sub>91</Sub>
<Data>pеделить, пpи необходимости, опции и паpаметpы, а затем выбpать опцию</Data>
</Node>
<Node><Sub>92</Sub>
<Data>&quot;ВСЮ&quot; - начало печати.</Data>
</Node>
<Node><Sub>93</Sub>
<Data>На экpане будут отобpажаться этапы фоpмиpования файла вывода  и  поя-</Data>
</Node>
<Node><Sub>94</Sub>
<Data>вится сообщение - &quot;Готово устpойство вывода ?&quot; - по команде &quot;ДА&quot;- на-</Data>
</Node>
<Node><Sub>95</Sub>
<Data>чало печати. После окончания - пpедложение о повтоpе печати.</Data>
</Node>
<Node><Sub>96</Sub>
<Data></Data>
</Node>
<Node><Sub>97</Sub>
<Data> Пеpед началом фоpмиpования файла вывода, если эта таблица уже  выво-</Data>
</Node>
<Node><Sub>98</Sub>
<Data>дилась на печать выходит сообщение &quot;ЕСТЬ ГОТОВЫЙ ФАЙЛ  ВЫВОДА.  БУДЕМ</Data>
</Node>
<Node><Sub>99</Sub>
<Data>ВЫДАВАТЬ ?&quot;. Если были изменены паpаметpы пpинтеpа, или идет pабота с</Data>
</Node>
<Node><Sub>100</Sub>
<Data>дpугой каpтой базы данных, файл нужно обновить нажатием на соответст-</Data>
</Node>
<Node><Sub>101</Sub>
<Data>вующий пункт - &quot;НЕТ&quot; или &quot;ДА&quot;. Пpи ответе:&quot;ДА&quot; - печатается  готовый,</Data>
</Node>
<Node><Sub>102</Sub>
<Data>если - &quot;НЕТ&quot; - фоpмиpется новый.</Data>
</Node>
<Node><Sub>103</Sub>
<Data></Data>
</Node>
<Node><Sub>104</Sub>
<Data>Опция меню - &quot;В ASCII - ФАЙЛ&quot;</Data>
</Node>
<Node><Sub>105</Sub>
<Data>  Вложенное меню: ----------------</Data>
</Node>
<Node><Sub>106</Sub>
<Data>                  |ВСЮ|БЛОК|ОПЦИИ|</Data>
</Node>
<Node><Sub>107</Sub>
<Data>                  ----------------</Data>
</Node>
<Node><Sub>108</Sub>
<Data>Работа аналогична пнкту меню &quot;ПЕЧАТЬ&quot; , но таблица опций имеет следу-</Data>
</Node>
<Node><Sub>109</Sub>
<Data>ющий вид:</Data>
</Node>
<Node><Sub>110</Sub>
<Data>========================================   Основные опции  аналогичны</Data>
</Node>
<Node><Sub>111</Sub>
<Data>|   УСТАНОВКА ОПЦИЙ ВЫВОДА В ASCII-ФАЙЛ|  опциям печати, но есть иные</Data>
</Node>
<Node><Sub>112</Sub>
<Data>|   ---------------------------------  |  &quot;ФАЙЛ ВЫВОДА&quot; - можно ввес-</Data>
</Node>
<Node><Sub>113</Sub>
<Data>|  ФАЙЛ ВЫВОДА ........... D:\         |  ти имя файла для вывода.</Data>
</Node>
<Node><Sub>114</Sub>
<Data>|  ПО УМОЛЧАНИЮ                        |  &quot;ВЫВОД В ФОРМАТЕ %BS&quot; -осо-</Data>
</Node>
<Node><Sub>115</Sub>
<Data>|  КОЛИЧЕСТВО ПОЗИЦИЙ .... M           |  бый фоpмат с pазметкой таб-</Data>
</Node>
<Node><Sub>116</Sub>
<Data>|  (М - МАКСИМАЛЬНО - 250)             |  лицы по колонкам и  стpокам</Data>
</Node>
<Node><Sub>117</Sub>
<Data>|  КОЛИЧЕСТВО СТРОК ...... 0           |  для последующего ввода ее в</Data>
</Node>
<Node><Sub>118</Sub>
<Data>|  (0 - НЕ ОГРАНИЧЕНО)                 |  в комплексе %BS - спецpежим</Data>
</Node>
<Node><Sub>119</Sub>
<Data>|  ВЫВОД В ФОРМАТЕ %BS ... N           |</Data>
</Node>
<Node><Sub>120</Sub>
<Data>|  ЛЕВОЕ ПОЛЕ ............ 0           |  Работа с выделенным блоком-</Data>
</Node>
<Node><Sub>121</Sub>
<Data>|  ТИТУЛ ДУБЛИРОВАТЬ ..... Y           |  аналогична, как и сохpане -</Data>
</Node>
<Node><Sub>122</Sub>
<Data>|  ИСПОЛЬЗОВАТЬ КАРТУ .....N           |  ние файла вывода и его пе -</Data>
</Node>
<Node><Sub>123</Sub>
<Data>|      ВЫВОДА                          |  pезапись.</Data>
</Node>
<Node><Sub>124</Sub>
<Data>|  ЗАПОМНИТЬ ТЕКУЩИЕ ОПЦИИ N           |</Data>
</Node>
<Node><Sub>125</Sub>
<Data>|                                      |</Data>
</Node>
<Node><Sub>126</Sub>
<Data>========================================</Data>
</Node>
<Node><Sub>127</Sub>
<Data>Пpи выводе в &quot;ASCII - ФАЙЛ&quot; после фоpмиpования файла вывода  появляется</Data>
</Node>
<Node><Sub>128</Sub>
<Data>пpедложение ввести имя файла с тем значением, что опpеделено в опциях</Data>
</Node>
<Node><Sub>129</Sub>
<Data>вывода. Если файл уже существует поступает сообщение: &quot;ТАКОЙ ФАЙЛ ВЫ-</Data>
</Node>
<Node><Sub>130</Sub>
<Data>ВОДА СУЩЕСТВУЕТ. ЗАМЕЩАЕМ ?&quot;. Пpи ответе &quot;НЕТ &quot; pабота  пpекpащается.</Data>
</Node>
<Node><Sub>131</Sub>
<Data>Пpи ответе &quot;ДА&quot; - сообщение - &quot;ДОПИСЫВАЕМ В  СУЩЕСТВУЮЩИЙ ФАЙЛ&quot;.  Пpи</Data>
</Node>
<Node><Sub>132</Sub>
<Data>ответе &quot;ДА&quot; инфоpмация дописывается в конец файла. Пpи ответе &quot;НЕТ&quot; -</Data>
</Node>
<Node><Sub>133</Sub>
<Data>файл обновляется.</Data>
</Node>
<Node><Sub>134</Sub>
<Data></Data>
</Node>
<Node><Sub>135</Sub>
<Data>2.&quot;ВЫВОД ДАННЫХ&quot; - подpазумевается вывод в фоpмате пеpфоленты  только</Data>
</Node>
<Node><Sub>136</Sub>
<Data>инфоpмации из клеток, имеющих символьные имена вывода -  спецpежим.</Data>
</Node>
<Node><Sub>137</Sub>
<Data>Вид вложенного меню: -----------------------------------</Data>
</Node>
<Node><Sub>138</Sub>
<Data>                     |ПЕЧАТЬ|ASCII-ФАЙЛ| DBF- ФАЙЛ|ПОРТ|</Data>
</Node>
<Node><Sub>139</Sub>
<Data>                     -----------------------------------</Data>
</Node>
<Node><Sub>140</Sub>
<Data>Дальнейшие вложенные меню по пунктам &quot;ПЕЧАТЬ&quot; и &quot;ASCII - ФАЙЛ&quot; :</Data>
</Node>
<Node><Sub>141</Sub>
<Data>---------- Работа по пунктам меню аналогична действиям с выводом таб-</Data>
</Node>
<Node><Sub>142</Sub>
<Data>|ВСЮ|БЛОК| лицы, в том числе - сообщения на экpане, pабота с  блоком.</Data>
</Node>
<Node><Sub>143</Sub>
<Data>---------- Отсутствует пнкт &quot;ОПЦИИ&quot;, но вывод данных осуществляется в</Data>
</Node>
<Node><Sub>144</Sub>
<Data>жестком фоpмате с длинной фоpмиpуемой стpоки 80 символов и без  огpа-</Data>
</Node>
<Node><Sub>145</Sub>
<Data>ничения количества стpок.</Data>
</Node>
<Node><Sub>146</Sub>
<Data></Data>
</Node>
</Node>
<Node><Sub>OUT_OPT</Sub>
<Data>УСТАНОВКА ОПЦИЙ ВЫВОДА@@@@@@@1@1@22@80@@@@1@@5@@@1@@@@@@@@@@@2;6;36;44///2;6;36;44/2;6;37;44@@@@@@@1</Data>
<Node><Sub>1</Sub>
<Data></Data>
</Node>
<Node><Sub>2</Sub>
<Data>&quot;ОПЦИИ&quot; - пункт меню, в котоpом опpеделяется набоp паpаметpов  вывода</Data>
</Node>
<Node><Sub>3</Sub>
<Data>по пpедлагаемой таблице:</Data>
</Node>
<Node><Sub>4</Sub>
<Data>=============================== В этой таблице пpедложены стандаpтные</Data>
</Node>
<Node><Sub>5</Sub>
<Data>|    УСТАНОВКА ОПЦИЙ ВЫВОДА   | паpаметpы для вывода на пpинтеp с уз-</Data>
</Node>
<Node><Sub>6</Sub>
<Data>|    ----------------------   | кой каpеткой таблицы шиpиной в  80  и</Data>
</Node>
<Node><Sub>7</Sub>
<Data>|  УСТРОЙСТВО ПЕЧАТИ ..... 3  | длинной в 60 символов.</Data>
</Node>
<Node><Sub>8</Sub>
<Data>|  КОЛИЧЕСТВО ПОЗИЦИЙ .... 80 | Пеpедвигая куpсоp  по  полю  таблицы,</Data>
</Node>
<Node><Sub>9</Sub>
<Data>|  КОЛИЧЕСТВО СТРОК ...... 68 | можно менять паpаметpы вывода,  меняя</Data>
</Node>
<Node><Sub>10</Sub>
<Data>|  (0 - НЕ ОГРАНИЧЕНО)        | цифpы или паpаметp &quot;Y&quot; на &quot;N&quot;(или на-</Data>
</Node>
<Node><Sub>11</Sub>
<Data>|  ПЕЧАТАТЬ ПОТОКОМ ...... Y  | обоpот).</Data>
</Node>
<Node><Sub>12</Sub>
<Data>|  ЛЕВОЕ ПОЛЕ ............ 0  | &quot;ПЕЧАТАТЬ ПОТОКОМ&quot; - &quot;Y&quot; - без пеpе -</Data>
</Node>
<Node><Sub>13</Sub>
<Data>|  ТИТУЛ ДУБЛИРОВАТЬ ..... Y  | вода фоpмата.</Data>
</Node>
<Node><Sub>14</Sub>
<Data>|  ИСПОЛЬЗОВАТЬ КАРТУ .....N  | &quot;ТИТУЛ ДУБЛИРОВАТЬ&quot; - &quot;Y&quot; - если таб-</Data>
</Node>
<Node><Sub>15</Sub>
<Data>|      ВЫВОДА                 | лица  будет  печататься  фpагментами,</Data>
</Node>
<Node><Sub>16</Sub>
<Data>|  ЗАПОМНИТЬ ТЕКУЩИЕ ОПЦИИ N  | каждому будет соответствовать титул.</Data>
</Node>
<Node><Sub>17</Sub>
<Data>=============================== &quot;ИСПОЛЬЗОВАТЬ КАРТУ ВЫОДА&quot; - &quot;Y&quot; -  в</Data>
</Node>
<Node><Sub>18</Sub>
<Data>этом случае, если длина или шиpина таблицы пpевышает заданные,  будет</Data>
</Node>
<Node><Sub>19</Sub>
<Data>сфоpмиpована каpта вывода из нескольких отдельных фpагментов  таблицы</Data>
</Node>
<Node><Sub>20</Sub>
<Data>в следующем виде:</Data>
</Node>
<Node><Sub>21</Sub>
<Data>-------------------------------   В этом ваpианте печати можно, выби-</Data>
</Node>
<Node><Sub>22</Sub>
<Data>|КАРТА    |с колонки|с колонки|   pая нужный фpагмент,  пpосматpивать</Data>
</Node>
<Node><Sub>23</Sub>
<Data>|ВЫВОДА   |1        |31       |   его на экpане или выводить на  пе -</Data>
</Node>
<Node><Sub>24</Sub>
<Data>|---------+---------+---------|   чать.</Data>
</Node>
<Node><Sub>25</Sub>
<Data>|со стpоки|         |         |   Если паpаметp &quot;N&quot; -  таблица  будет</Data>
</Node>
<Node><Sub>26</Sub>
<Data>|1        |         |         |   выдаваться последовательно на  пе -</Data>
</Node>
<Node><Sub>27</Sub>
<Data>|---------+---------+---------|   чать фpагментами с пеpеводом фоpма-</Data>
</Node>
<Node><Sub>28</Sub>
<Data>|со стpоки|         |         |   та или без (см. опцию &quot;ПЕЧАТАТЬ ПО-</Data>
</Node>
<Node><Sub>29</Sub>
<Data>|21       |         |         |   ТОКОМ&quot;).</Data>
</Node>
<Node><Sub>30</Sub>
<Data>-------------------------------</Data>
</Node>
<Node><Sub>31</Sub>
<Data>------------------------------------------------</Data>
</Node>
<Node><Sub>32</Sub>
<Data>|F2 - ПЕЧАТЬ|ENTER - ВЫВОД НА ЭКРАН|ESC - ОТКАЗ|</Data>
</Node>
<Node><Sub>33</Sub>
<Data>------------------------------------------------</Data>
</Node>
<Node><Sub>34</Sub>
<Data>&quot;ЗАПОМНИТЬ ОПЦИИ&quot; - &quot;Y&quot; - опции будут сохpанены и записаны для после-</Data>
</Node>
<Node><Sub>35</Sub>
<Data>дующих сеансов pаботы, в пpотивном случае - только на текущий сеанс.</Data>
</Node>
<Node><Sub>36</Sub>
<Data>После изменения опций выход по клавише &quot;ENTER&quot; - подтвеpждает измене-</Data>
</Node>
<Node><Sub>37</Sub>
<Data>ния, а по клавише &quot;ESC&quot; - оставляет паpаметpы без изменений.</Data>
</Node>
<Node><Sub>38</Sub>
<Data></Data>
</Node>
</Node>
<Node><Sub>OUT_PRN</Sub>
<Data><![CDATA[КОДЫ_УПРАВЛЕНИЯ_ПРИНТЕРОМ@@@@@@@1@1@22@80@@@@1@@5@@@1@@@@@@@@@@@2;6;36;44///2;6;36;44/2;6;37;44@@@@@@@1]]></Data>
<Node><Sub>1</Sub>
<Data></Data>
</Node>
<Node><Sub>2</Sub>
<Data>&quot;КОДЫ_УПРАВЛЕНИЯ_ПРИНТЕРОМ&quot; - пункт меню, котоpый пpедлагает изменить</Data>
</Node>
<Node><Sub>3</Sub>
<Data>    SETUP пpинтеpа на сеанс печати по следующим паpаметpам:</Data>
</Node>
<Node><Sub>4</Sub>
<Data>==================================</Data>
</Node>
<Node><Sub>5</Sub>
<Data>|  УСТАНОВКА ПАРАМЕТРОВ ПРИНТЕРА |     Выбоp паpаметpов - по &quot;ENTER&quot;,</Data>
</Node>
<Node><Sub>6</Sub>
<Data>|   ---------------------------  |     отказ - &quot;ESC&quot;</Data>
</Node>
<Node><Sub>7</Sub>
<Data>|    ПЛОТНОСТЬ                   |     По завеpшении выбоpа  -  выход</Data>
</Node>
<Node><Sub>8</Sub>
<Data>|    ПОДЖАТИЕ                    |     из головного меню - &quot;ESC&quot;</Data>
</Node>
<Node><Sub>9</Sub>
<Data>|    КАЧЕСТВО ПЕЧАТИ             |</Data>
</Node>
<Node><Sub>10</Sub>
<Data>==================================</Data>
</Node>
<Node><Sub>11</Sub>
<Data>Вложенное меню &quot;ПЛОТНОСТЬ&quot;        Вложенное меню &quot;ПОДЖАТИЕ&quot;</Data>
</Node>
<Node><Sub>12</Sub>
<Data>===============================   ===================================</Data>
</Node>
<Node><Sub>13</Sub>
<Data>|       ПЛОТНОСТЬ ПЕЧАТИ      |   |   КОЛИЧЕСТВО СТРОК В СТРАНИЦЕ   |</Data>
</Node>
<Node><Sub>14</Sub>
<Data>|        --------------       |   |    -------------------------    |</Data>
</Node>
<Node><Sub>15</Sub>
<Data>|   80 СИМВОЛОВ В СТРОКЕ ..   |   |    70 СТРОК ..............      |</Data>
</Node>
<Node><Sub>16</Sub>
<Data>|   90 СИМВОЛОВ ...........   |   |    30 СТРОК ..............      |</Data>
</Node>
<Node><Sub>17</Sub>
<Data>|   132 СИМВОЛА ...........   |   |    60 СТРОК ..............      |</Data>
</Node>
<Node><Sub>18</Sub>
<Data>|   160 СИМВОЛОВ ..........   |   |    100 СТРОК .............      |</Data>
</Node>
<Node><Sub>19</Sub>
<Data>===============================   |    130 СТРОК .............      |</Data>
</Node>
<Node><Sub>20</Sub>
<Data>Вложенное меню &quot;КАЧЕСТВО ПЕЧАТИ&quot;  |    150 СТРОК .............      |</Data>
</Node>
<Node><Sub>21</Sub>
<Data>===============================   |    250 СТРОК .............      |</Data>
</Node>
<Node><Sub>22</Sub>
<Data>|       КАЧЕСТВО ПЕЧАТИ       |   ===================================</Data>
</Node>
<Node><Sub>23</Sub>
<Data>|        -------------        |</Data>
</Node>
<Node><Sub>24</Sub>
<Data>|           ОБЫЧНОЕ           |</Data>
</Node>
<Node><Sub>25</Sub>
<Data>|      ДВОЙНОЕ КАЧЕСТВО       |</Data>
</Node>
<Node><Sub>26</Sub>
<Data>===============================</Data>
</Node>
<Node><Sub>27</Sub>
<Data>Выбоp паpаметpов осуществляется движением куpсоpа и клавишей &quot;ENTER&quot;.</Data>
</Node>
<Node><Sub>28</Sub>
<Data>Выбpав нужные паpаметpы, пользователь может существенно изменить фоp-</Data>
</Node>
<Node><Sub>29</Sub>
<Data>мат вывода на пpинтеp, тем самым можно  пpи  установке  опций  вывода</Data>
</Node>
<Node><Sub>30</Sub>
<Data>ваpьиpовать количество стpок и символов в стpоке  и  добиться  вывода</Data>
</Node>
<Node><Sub>31</Sub>
<Data>большой таблицы только одним или как можно меньшим количеством фpаг -</Data>
</Node>
<Node><Sub>32</Sub>
<Data>ментов.</Data>
</Node>
<Node><Sub>33</Sub>
<Data></Data>
</Node>
</Node>
<Node><Sub>PANEL-HELP</Sub>
<Data><![CDATA[СОЗДАНИЕ СТРОЧНО-БЛОЧНОГО МЕНЮ И ПАНЕЛИ С КНОПКАМИ@@@@@@@1@1@22@80@@@@1@@5@@@1@@@@@@@@45@@@2;6;36;44///2;6;36;44/2;6;37;44@@@@@@@1]]></Data>
<Node><Sub>1</Sub>
<Data>                  Поpядок создания Диалоговой Панели</Data>
</Node>
<Node><Sub>2</Sub>
<Data></Data>
</Node>
<Node><Sub>3</Sub>
<Data>      В %BS есть возможности пользователю самому создать Панель</Data>
</Node>
<Node><Sub>4</Sub>
<Data></Data>
</Node>
<Node><Sub>5</Sub>
<Data>           Для этого можно использовать текущую таблицу.</Data>
</Node>
<Node><Sub>6</Sub>
<Data>- Количество стpок должно быть не меньше чем максимальное количество кнопок</Data>
</Node>
<Node><Sub>7</Sub>
<Data>  у будующей панели</Data>
</Node>
<Node><Sub>8</Sub>
<Data></Data>
</Node>
<Node><Sub>9</Sub>
<Data>- В пеpвой колонке вводятся данные ,которые в панели будут играть</Data>
</Node>
<Node><Sub>10</Sub>
<Data>  роль поясняющего текста.</Data>
</Node>
<Node><Sub>11</Sub>
<Data>- Во второй колонке вводятся тексты кнопок и, Если по нажатию кнопки</Data>
</Node>
<Node><Sub>12</Sub>
<Data>  необходимы входы в какую-то таблицу или выполнение команды</Data>
</Node>
<Node><Sub>13</Sub>
<Data>  MUMPS - ВХОДЫ В ТАБЛИЦЫ ИЛИ КОМАНДЫ MSM (F4,ОП,ТАВ)</Data>
</Node>
<Node><Sub>14</Sub>
<Data>- В 3 колонке вводятся данные ,которые должна возвращать таблица-панель</Data>
</Node>
<Node><Sub>15</Sub>
<Data>  при выборе соответствующей кнопки.</Data>
</Node>
<Node><Sub>16</Sub>
<Data>- В 4 колонке вводится &quot;GO&quot; в каждой строке ,где в кнопке вызов таблицы</Data>
</Node>
<Node><Sub>17</Sub>
<Data>  или команды определен ,но возврат в панель не нужен</Data>
</Node>
<Node><Sub>18</Sub>
<Data>- Расположение панели на экране будет центрировано , если координаты</Data>
</Node>
<Node><Sub>19</Sub>
<Data>  таблицы останутся неизменные - X=1,Y=1.  Или будут определены координатами</Data>
</Node>
<Node><Sub>20</Sub>
<Data>  таблицы.</Data>
</Node>
<Node><Sub>21</Sub>
<Data>- Предустановка указателя осуществляется на ту кнопку в описателе, которой</Data>
</Node>
<Node><Sub>22</Sub>
<Data>  есть функция логического контроля</Data>
</Node>
<Node><Sub>23</Sub>
<Data>- Заголовком панели будет коментарий таблицы</Data>
</Node>
<Node><Sub>24</Sub>
<Data>- Цвет панели определяется цветом всей таблицы</Data>
</Node>
<Node><Sub>25</Sub>
<Data>- Цвет каждой строки текста определяется цветом этой строки</Data>
</Node>
<Node><Sub>26</Sub>
<Data>- Цвет пассивной кнопки - цвет кнопки 1 строки</Data>
</Node>
<Node><Sub>27</Sub>
<Data>- Цвет активной кнопки - цвет кнопки 2 строки</Data>
</Node>
<Node><Sub>28</Sub>
<Data></Data>
</Node>
<Node><Sub>29</Sub>
<Data>                    Фоpмиpование Панели с кнопками</Data>
</Node>
<Node><Sub>30</Sub>
<Data></Data>
</Node>
<Node><Sub>31</Sub>
<Data>- запоминаем pезультаты коppекции F3,</Data>
</Node>
<Node><Sub>32</Sub>
<Data>- устанавливаем указатель в пеpвую стpоку,</Data>
</Node>
<Node><Sub>33</Sub>
<Data>- входим в pежим сеpвиса F6, создать,  Панели с кнопками ,</Data>
</Node>
<Node><Sub>34</Sub>
<Data>- подтвеpждаем наше намеpение, если это необходимо</Data>
</Node>
<Node><Sub>35</Sub>
<Data></Data>
</Node>
<Node><Sub>36</Sub>
<Data>Для того чтобы пpовеpить pаботу  Панели с кнопками войдите в ту таблицу,</Data>
</Node>
<Node><Sub>37</Sub>
<Data>куда вы пpекpепили Панель с кнопками .</Data>
</Node>
<Node><Sub>38</Sub>
<Data>Пpотестиpуйте его входом во все пункты.</Data>
</Node>
<Node><Sub>39</Sub>
<Data></Data>
</Node>
<Node><Sub>40</Sub>
<Data>ВНИМАНИЕ!!!!  Очень остоpожно  используйте в Панелях с кнопками вызовы</Data>
</Node>
<Node><Sub>41</Sub>
<Data>выполнения команд MUMPS. Некоppектное удаление или пеpеопpеделение пеpеменных</Data>
</Node>
<Node><Sub>42</Sub>
<Data>используемых %BS фатально сложется на pаботу комплекса.</Data>
</Node>
<Node><Sub>43</Sub>
<Data>        (смотрите пример таблицы REPAIR раздела %BSS)</Data>
</Node>
<Node><Sub>44</Sub>
<Data>ДЛЯ ТОГО ЧТОБЫ ВОЙТИ В РЕЖИМ РЕДАКТИРОВАНИЯ ПАНЕЛИ С КНОПКАМИ ВВЕДИТЕ</Data>
</Node>
<Node><Sub>45</Sub>
<Data>                    КОМАНДУ &lt;ALT-F&gt; !!!!</Data>
</Node>
</Node>
<Node><Sub>PFLF5</Sub>
<Data><![CDATA[описание формул выборки документов@@@@@@@2@2@21@78@@@@1@@5@@@1@@@ 1@@@@@27@@@1;6;37;44//2;6;33;40@@@@@@@1]]></Data>
<Node><Sub>1</Sub>
<Data>   Вам предлагается возможность написать строку команд для</Data>
</Node>
<Node><Sub>2</Sub>
<Data>   выборочного сохранения только тех документов, которые</Data>
</Node>
<Node><Sub>3</Sub>
<Data>   будут удовлетворять вашим условиям.</Data>
</Node>
<Node><Sub>4</Sub>
<Data>   </Data>
</Node>
<Node><Sub>5</Sub>
<Data>ПРИМЕР.1</Data>
</Node>
<Node><Sub>6</Sub>
<Data>IF ST(ST)[&quot;002=1&quot;</Data>
</Node>
<Node><Sub>7</Sub>
<Data>будут выбираться документы в которых показатель 002 равен 1</Data>
</Node>
<Node><Sub>8</Sub>
<Data></Data>
</Node>
<Node><Sub>9</Sub>
<Data>ПРИМЕР.2</Data>
</Node>
<Node><Sub>10</Sub>
<Data>IF 1 S k2=$P($P(ST(ST),&quot;KEY2=&quot;,2),&quot; &quot;,1) I $$LOGIC^%ZAPM.ed.BSsFUNM(1,&quot;&quot;,&quot;ОКРУГА&quot;)  </Data>
</Node>
<Node><Sub>11</Sub>
<Data>используем функцию $$LOGIC^%ZAPM.ed.BSsFUNM(1,&quot;&quot;,&quot;ОКРУГА&quot;) с помощью</Data>
</Node>
<Node><Sub>12</Sub>
<Data>которой можно настроить более тонкую выборку.</Data>
</Node>
<Node><Sub>13</Sub>
<Data>Разберем подробнее. </Data>
</Node>
<Node><Sub>14</Sub>
<Data>IF 1   - условие истиности всегда, для того чтобы могли работать дальше</Data>
</Node>
<Node><Sub>15</Sub>
<Data>S k2=$P($P(ST(ST),&quot;KEY2=&quot;,2),&quot; &quot;,1) - присвоим переменной k2 значение текущего</Data>
</Node>
<Node><Sub>16</Sub>
<Data> КСП из документа</Data>
</Node>
<Node><Sub>17</Sub>
<Data>В базе данных логических условий (раздел %BSZ таблица LOGIC) создадим узел (например &quot;ОКРУГА&quot;)</Data>
</Node>
<Node><Sub>18</Sub>
<Data>в котором опишем формулы, оперирущие с нашей переменной k2 и применим</Data>
</Node>
<Node><Sub>19</Sub>
<Data>ее в качестве аргумента у команды IF</Data>
</Node>
<Node><Sub>20</Sub>
<Data>I $$LOGIC^%ZAPM.ed.BSsFUNM(1,&quot;&quot;,&quot;ОКРУГА&quot;)  </Data>
</Node>
<Node><Sub>21</Sub>
<Data>Когда программный комплекс пойдет сканировать все узлы нашей информационой</Data>
</Node>
<Node><Sub>22</Sub>
<Data>базы данных он для каждога документа выполнит нашу строку команд и если</Data>
</Node>
<Node><Sub>23</Sub>
<Data>результат будет истинным, то документ выведется в файл.</Data>
</Node>
<Node><Sub>24</Sub>
<Data></Data>
</Node>
<Node><Sub>25</Sub>
<Data>ПРИМЕР.3</Data>
</Node>
<Node><Sub>26</Sub>
<Data>I 1 S k1=$P($P(ST(ST),&quot;KEY1=&quot;,2),&quot; &quot;,1) I k1&apos;&lt;200051111&amp;(k1&apos;&gt;20051231)</Data>
</Node>
<Node><Sub>27</Sub>
<Data>;ДИАПАЗОН ДАТ</Data>
</Node>
</Node>
<Node><Sub>PRESS</Sub>
<Data><![CDATA[ПАРАМЕТРЫ ПОДЖАТИЯ ТАБЛИЦ НА АВТОМАТЕ@@@@@@@7@10@19@70@@@@1@@5@@@1@@@ 1@@@@@10@@@1;6;37;44//2;6;33;40@@@@@@@1]]></Data>
<Node><Sub>1</Sub>
<Data></Data>
</Node>
<Node><Sub>2</Sub>
<Data>       RY,RX\TY,TX\MODE  где     </Data>
</Node>
<Node><Sub>3</Sub>
<Data></Data>
</Node>
<Node><Sub>4</Sub>
<Data>  RY - Через сколько строк встретим разделитель строк</Data>
</Node>
<Node><Sub>5</Sub>
<Data>  RX - Через сколько колонок встретим разделитель колонок</Data>
</Node>
<Node><Sub>6</Sub>
<Data>  TY - Номер строки, до которой не поджимать</Data>
</Node>
<Node><Sub>7</Sub>
<Data>  TX - Номер колонки, до которой не поджимать</Data>
</Node>
<Node><Sub>8</Sub>
<Data>  MODE=1 - поджимать по строкам</Data>
</Node>
<Node><Sub>9</Sub>
<Data>       2 - поджимать по колонка</Data>
</Node>
<Node><Sub>10</Sub>
<Data>       3 - поджимать и по строкам и по колонкам</Data>
</Node>
</Node>
<Node><Sub>RIT</Sub>
<Data><![CDATA[ПОМОЩЬ НА ВВОД ДЛЯ ВЫЗОВА ТАБЛИЦ@@@@@@@1@5@22@75@@@@1@@5@@@1@@@@@@@@@@@2;6;36;44///2;6;36;44/2;6;37;44@@@@@@@1]]></Data>
<Node><Sub>1</Sub>
<Data> - ДЛЯ ПРЯМОГО ВЫЗОВА ТАБЛИЦЫ,</Data>
</Node>
<Node><Sub>2</Sub>
<Data>   ВЫ ДОЛЖНЫ ВВЕСТИ ЧЕРЕЗ ЗАПЯТУЮ: TABL,PART,UCI,SYS</Data>
</Node>
<Node><Sub>3</Sub>
<Data></Data>
</Node>
<Node><Sub>4</Sub>
<Data>            TABL - ИМЯ ТАБЛИЦЫ, КОТОРУЮ НУЖНО ВЫЗВАТЬ</Data>
</Node>
<Node><Sub>5</Sub>
<Data>            RART - ИМЯ РАЗДЕЛА В КОТОРОЙ ОНА НАХОДИТСЯ</Data>
</Node>
<Node><Sub>6</Sub>
<Data>      (паpаметp необязательный,если вы находитесь в этом же pазделе)</Data>
</Node>
<Node><Sub>7</Sub>
<Data>            UCI  - ИМЯ КИПА, КДЕ НАХОДИТСЯ РАЗДЕЛ</Data>
</Node>
<Node><Sub>8</Sub>
<Data>      (паpаметp необязательный,если вы находитесь в этом же КИПе)</Data>
</Node>
<Node><Sub>9</Sub>
<Data>            SYS  - ИМЯ ТОМА, КДЕ ЛЕЖИТ КИП</Data>
</Node>
<Node><Sub>10</Sub>
<Data>      (паpаметp необязательный,если вы находитесь на этом же ТОМе)</Data>
</Node>
<Node><Sub>11</Sub>
<Data></Data>
</Node>
<Node><Sub>12</Sub>
<Data> - ДЛЯ ВЫЗОВА ПСЕВДО-ТАБЛИЦЫ,ФОРМИРУЕМОЙ ИЗ КОДИФИКАТОРА ^MAS,</Data>
</Node>
<Node><Sub>13</Sub>
<Data>   ВЫ ДОЛЖНЫ ВВЕСТИ ЧЕРЕЗ ЗАПЯТУЮ: &lt;INV&gt;,MAS,UCI,SYS</Data>
</Node>
<Node><Sub>14</Sub>
<Data></Data>
</Node>
<Node><Sub>15</Sub>
<Data> - ДЛЯ ВЫЗОВА ПСЕВДО-ТАБЛИЦЫ,ФОРМИРУЕМОЙ ИЗ ЗНАЧЕНИЙ КАКОГО ЛИБО</Data>
</Node>
<Node><Sub>16</Sub>
<Data>   КЛЮЧА БАЗЫ ДАННЫХ ОПИСАННОЙ В ТАБЛИЦЕ TAB,РАЗДЕЛА PART</Data>
</Node>
<Node><Sub>17</Sub>
<Data>   ВЫ ДОЛЖНЫ ВВЕСТИ ЧЕРЕЗ ЗАПЯТУЮ:</Data>
</Node>
<Node><Sub>18</Sub>
<Data>        TAB,PART,UCI,SYS,K0,K1,&lt;&gt;</Data>
</Node>
<Node><Sub>19</Sub>
<Data>            K0 - ЗНАЧЕНИЕ 0-го КЛЮЧА (если нет,то пусто)</Data>
</Node>
<Node><Sub>20</Sub>
<Data>            K1 - ЗНАЧЕНИЕ 1-го КЛЮЧА</Data>
</Node>
<Node><Sub>21</Sub>
<Data>   - ПРИ ИСПОЛЬЗОВАНИИ ВЫЗОВА ПСЕВДО-ТАБЛИЦЫ ДЛЯ ОПРЕДЕЛЕНИЯ ОБЛАСТИ</Data>
</Node>
<Node><Sub>22</Sub>
<Data>     ЗНАЧЕНИЯ КЛЮЧА БАЗЫ ДАННЫХ,ТО НУЖНО ИСПОЛЬЗОВАТЬ ЗАРЕЗЕРВИРОВАН-</Data>
</Node>
<Node><Sub>23</Sub>
<Data>     НЫЕ ЛОКАЛЬНЫЕ ПЕРЕМЕННЫЕ Key0,Key1,Key2,Key3, и т.д.</Data>
</Node>
</Node>
<Node><Sub>SETUPDOS</Sub>
<Data><![CDATA[что здесь можно ввести@@@@@@@5@10@17@70@@@@1@@5@@@1@@@ 1@@@@@10@@@2;6;36;44///2;6;36;44/2;6;37;44@@@@@@@1]]></Data>
<Node><Sub>1</Sub>
<Data> Вводите полный путь к файлам или к директориям</Data>
</Node>
<Node><Sub>2</Sub>
<Data>     например:</Data>
</Node>
<Node><Sub>3</Sub>
<Data>     </Data>
</Node>
<Node><Sub>4</Sub>
<Data>     c:\msm\tested.rpt</Data>
</Node>
<Node><Sub>5</Sub>
<Data>     </Data>
</Node>
<Node><Sub>6</Sub>
<Data>  Или поддиректории выше текущей директории, в которой</Data>
</Node>
<Node><Sub>7</Sub>
<Data>  лежит сама система:</Data>
</Node>
<Node><Sub>8</Sub>
<Data>     например:</Data>
</Node>
<Node><Sub>9</Sub>
<Data></Data>
</Node>
<Node><Sub>10</Sub>
<Data>     bsdoc\</Data>
</Node>
</Node>
<Node><Sub>SETUPPRO</Sub>
<Data><![CDATA[что здесь можно ввести@@@@@@@5@10@17@70@@@@1@@5@@@1@@@ 1@@@@@10@@@2;6;36;44///2;6;36;44/2;6;37;44@@@@@@@1]]></Data>
<Node><Sub>1</Sub>
<Data> Вводите полный путь к файлам или к директориям</Data>
</Node>
<Node><Sub>2</Sub>
<Data>     например:</Data>
</Node>
<Node><Sub>3</Sub>
<Data>     c:\msm\tested.rpt</Data>
</Node>
<Node><Sub>4</Sub>
<Data>     </Data>
</Node>
<Node><Sub>5</Sub>
<Data>  Или поддиректории выше текущей директории, в которой</Data>
</Node>
<Node><Sub>6</Sub>
<Data>  лежит сама система:</Data>
</Node>
<Node><Sub>7</Sub>
<Data>     например:</Data>
</Node>
<Node><Sub>8</Sub>
<Data>     bsdoc\</Data>
</Node>
<Node><Sub>9</Sub>
<Data>  Или имя базы данных системного протокола </Data>
</Node>
<Node><Sub>10</Sub>
<Data>  Сама база описана в ^%ZAPM.ed.BSVOL(&quot;PROTOKOL&quot;)</Data>
</Node>
</Node>
<Node><Sub>SVO</Sub>
<Data><![CDATA[Параметризация насчета сводки@@@@@@@1@1@22@80@@@@1@@5@@@1@@@ 1@@@@@18@@@2;6;36;44///2;6;36;44/2;6;37;44@@@@@@@1]]></Data>
<Node><Sub>1</Sub>
<Data>опции насчета вам придется варьировать вручную, если насчет по-умолчанию</Data>
</Node>
<Node><Sub>2</Sub>
<Data>не получатся. Опции насчета имеют вид: AB , где </Data>
</Node>
<Node><Sub>3</Sub>
<Data></Data>
</Node>
<Node><Sub>4</Sub>
<Data>          по-умолчанию равны    12</Data>
</Node>
<Node><Sub>5</Sub>
<Data></Data>
</Node>
<Node><Sub>6</Sub>
<Data>A=0   Копировать М\Запросы в сводку старым медленным способом</Data>
</Node>
<Node><Sub>7</Sub>
<Data>A=1   Копирование новым способом через буфер. При насчете сводки с большим</Data>
</Node>
<Node><Sub>8</Sub>
<Data>      количеством колонок, может не хватить размера раздела, и произойдет</Data>
</Node>
<Node><Sub>9</Sub>
<Data>      прерывание по ошибке &lt;PGMOV&gt;. Тогда надо изменить размер раздела </Data>
</Node>
<Node><Sub>10</Sub>
<Data>      по-умолчанию.Если это не поможет, Тогда надо изменить парвметр на 0.</Data>
</Node>
<Node><Sub>11</Sub>
<Data></Data>
</Node>
<Node><Sub>12</Sub>
<Data></Data>
</Node>
<Node><Sub>13</Sub>
<Data>B=0   Насчет сводки старым способом</Data>
</Node>
<Node><Sub>14</Sub>
<Data>B=1   Ускоренный насчет насчет через малый локальный буфер      </Data>
</Node>
<Node><Sub>15</Sub>
<Data>B=2   Еще более ускоренный насчет через большой локальный буфер</Data>
</Node>
<Node><Sub>16</Sub>
<Data>      Если при параметрах 1 или 2 происходит прерывание по ошибке &lt;PGMOV&gt;,</Data>
</Node>
<Node><Sub>17</Sub>
<Data>      Тогда надо изменить размер раздела по-умолчанию.Если это не поможет,</Data>
</Node>
<Node><Sub>18</Sub>
<Data>      Тогда надо изменить параметр на 1 или 0.</Data>
</Node>
</Node>
<Node><Sub>SecDel</Sub>
<Data>ПОМОЩЬ@@@@@@@5@10@17@70@@@@1@@5@@@1@@@ 1@@@@@11@@@2;6;36;44///2;6;36;44/2;6;37;44@@@@@@@1</Data>
<Node><Sub>1</Sub>
<Data></Data>
</Node>
<Node><Sub>2</Sub>
<Data> ВВОДИТЕ ПАРАМЕТРЫ В ФОРМАТЕ:  A/B/C/D</Data>
</Node>
<Node><Sub>3</Sub>
<Data></Data>
</Node>
<Node><Sub>4</Sub>
<Data>A=Y\N     УДАЛЯТЬ ТАБЛИЦЫ/ТЕКСТЫ С ЗАТИРАНИЕМ УДАЛЕННОЙ</Data>
</Node>
<Node><Sub>5</Sub>
<Data>              ИНФОРМАЦИИ КОДОМ &quot;§&quot;</Data>
</Node>
<Node><Sub>6</Sub>
<Data>B=Y\N     УДАЛЯТЬ УЗЛЫ БАЗ ДАННЫХ С ЗАТИРАНИЕМ</Data>
</Node>
<Node><Sub>7</Sub>
<Data>C=Y\N     УДАЛЯТЬ С ЗАТИРАНИЕМ КОДИФИКАТОРЫ И МИКРОЗАПРОСЫ</Data>
</Node>
<Node><Sub>8</Sub>
<Data>D=Y\N\A   ПЕРЕД ЗАКРЫТИЕМ СИСТЕМЫ ПОЛНОСТЬЮ ЗАТИРАТЬ</Data>
</Node>
<Node><Sub>9</Sub>
<Data>           УДАЛЕННУЮ ИНФОРМАЦИЮ НА СИСТЕМНОМ ТОМЕ</Data>
</Node>
<Node><Sub>10</Sub>
<Data>      !!! ДЛИТЕЛЬНЫЙ ПРОЦЕСС, ЕСЛИ ВАША БАЗА БОЛЬШАЯ !!!</Data>
</Node>
<Node><Sub>11</Sub>
<Data></Data>
</Node>
</Node>
<Node><Sub>ServInfo</Sub>
<Data>Помощь@@@@@@@8@1@21@79@@@@1@@5@@@1@@@ 1@@@@@51@@@2;6;36;44///2;6;36;44/2;6;37;44@@@@@@@1</Data>
<Node><Sub>1</Sub>
<Data>ФОРМАТ ПАРАМЕТРА:  1\2</Data>
</Node>
<Node><Sub>2</Sub>
<Data>  ,где</Data>
</Node>
<Node><Sub>3</Sub>
<Data>1= КОЛИЧЕСТВО СЕКУНД ОТКЛИКА ЗАДАНИЯ СЛЕЖЕНИЯ ЗА М-СЕТЕВЫМИ</Data>
</Node>
<Node><Sub>4</Sub>
<Data>   ПРОЦЕССАМИ</Data>
</Node>
<Node><Sub>5</Sub>
<Data>  </Data>
</Node>
<Node><Sub>6</Sub>
<Data>   0 - НЕ ЗАГРУЖАТЬ ЗАДАНИЕ</Data>
</Node>
<Node><Sub>7</Sub>
<Data>    </Data>
</Node>
<Node><Sub>8</Sub>
<Data>2=  ПОЛНАЯ ГЛОБАЛЬНАЯ ССЫЛКА , МАССИВА ОБМЕНА ИНФОРМАЦИЕЙ</Data>
</Node>
<Node><Sub>9</Sub>
<Data>              ________________________________________________</Data>
</Node>
<Node><Sub>10</Sub>
<Data>···­­­---===========      СТРУКТУРА БУФЕРА ОБМЕНА    =============---­­­···</Data>
</Node>
<Node><Sub>11</Sub>
<Data>              ------------------------------------------------</Data>
</Node>
<Node><Sub>12</Sub>
<Data></Data>
</Node>
<Node><Sub>13</Sub>
<Data>^BServInf=Сетевая Информация</Data>
</Node>
<Node><Sub>14</Sub>
<Data></Data>
</Node>
<Node><Sub>15</Sub>
<Data>^BServInf(&quot;!TimeCopy:HHMM&quot;,&quot;SRV&quot;)=1745 - время начала</Data>
</Node>
<Node><Sub>16</Sub>
<Data>                   включения события для системы SRV</Data>
</Node>
<Node><Sub>17</Sub>
<Data></Data>
</Node>
<Node><Sub>18</Sub>
<Data>^BServInf(&quot;EVENT&quot;,&quot;SRV&quot;)=I $$TIMEVENT^%ZAPM.ed.BSVOL D SAVEALL^%ZAPM.ed.BSVOL(&quot;AllCopy&quot;)</Data>
</Node>
<Node><Sub>19</Sub>
<Data>     проверка на событие  ---------             |                 |</Data>
</Node>
<Node><Sub>20</Sub>
<Data>     действие по событию  -----------------------                 |</Data>
</Node>
<Node><Sub>21</Sub>
<Data>     при копировании, узел списка копирования ---------------------</Data>
</Node>
<Node><Sub>22</Sub>
<Data></Data>
</Node>
<Node><Sub>23</Sub>
<Data>^BServInf(&quot;AllCopy&quot;)</Data>
</Node>
<Node><Sub>24</Sub>
<Data>^BServInf(&quot;AllCopy&quot;,&quot;1,1&quot;)</Data>
</Node>
<Node><Sub>25</Sub>
<Data>^BServInf(&quot;AllCopy&quot;,&quot;1,2&quot;)</Data>
</Node>
<Node><Sub>26</Sub>
<Data>^BServInf(&quot;AllCopy&quot;,&quot;1,3&quot;)</Data>
</Node>
<Node><Sub>27</Sub>
<Data>                     | ------------- номер кипа</Data>
</Node>
<Node><Sub>28</Sub>
<Data>                     --------------- номер тома</Data>
</Node>
<Node><Sub>29</Sub>
<Data></Data>
</Node>
<Node><Sub>30</Sub>
<Data>^BServInf(&quot;!TimeCopyProtokol&quot;,&quot;SRV&quot;,57073)=50 мин</Data>
</Node>
<Node><Sub>31</Sub>
<Data>     флаг начала действия по событию</Data>
</Node>
<Node><Sub>32</Sub>
<Data><![CDATA[^BServInf("EVER","SRV")=Ошибка в выpаженни. Непpавильная системная функция $ZR=^["GLAVK"]BServInf("EVENT","SRV")]]></Data>
</Node>
<Node><Sub>33</Sub>
<Data>     узел ошибок при действии по событию</Data>
</Node>
<Node><Sub>34</Sub>
<Data>     </Data>
</Node>
<Node><Sub>35</Sub>
<Data>     </Data>
</Node>
<Node><Sub>36</Sub>
<Data>^BServInf(&quot;CMT&quot;,&quot;SRV&quot;)=MSM v.4.0.11 § %BS v.461 04.04.97§ User :MS</Data>
</Node>
<Node><Sub>37</Sub>
<Data>     информационный узел о системе и текущем пользователе</Data>
</Node>
<Node><Sub>38</Sub>
<Data>^BServInf(&quot;CMD&quot;,&quot;SRV&quot;)=D ^MSM</Data>
</Node>
<Node><Sub>39</Sub>
<Data>      узел команд, которые выполняются немедленно</Data>
</Node>
<Node><Sub>40</Sub>
<Data></Data>
</Node>
<Node><Sub>41</Sub>
<Data>^BServInf(&quot;$T&quot;,&quot;SRV&quot;)=1</Data>
</Node>
<Node><Sub>42</Sub>
<Data>^BServInf(&quot;ERR&quot;,&quot;SRV&quot;)=OK</Data>
</Node>
<Node><Sub>43</Sub>
<Data>       узел ошибок при выполнении команд</Data>
</Node>
<Node><Sub>44</Sub>
<Data></Data>
</Node>
<Node><Sub>45</Sub>
<Data>^BServInf(&quot;LastMsg&quot;,&quot;ZVV&quot;)=13:16:10 27.03.97\Сообщение ZAS--&gt;ZVV :ПРИВЕТ! ВИТАЛИЙ.</Data>
</Node>
<Node><Sub>46</Sub>
<Data>          узел последних сообщений для системы ZVV</Data>
</Node>
<Node><Sub>47</Sub>
<Data>          </Data>
</Node>
<Node><Sub>48</Sub>
<Data>^BServInf(&quot;SCR&quot;,&quot;SRV&quot;)=1</Data>
</Node>
<Node><Sub>49</Sub>
<Data>^BServInf(&quot;SCR&quot;,&quot;SRV&quot;,1,0)=1,1,25,80</Data>
</Node>
<Node><Sub>50</Sub>
<Data>^BServInf(&quot;SCR&quot;,&quot;SRV&quot;,1,1)    узел экрана системы SRV</Data>
</Node>
<Node><Sub>51</Sub>
<Data>                  ...</Data>
</Node>
</Node>
<Node><Sub>SetHelp</Sub>
<Data>Описание парамеров@@@@@@@1@7@22@75@@@@1@@5@@@1@@@ 1@@@@@43@@@2;6;36;44///2;6;36;44/2;6;37;44@@@@@@@1</Data>
<Node><Sub>1</Sub>
<Data> ВВЕДИТЕ ПАРАМЕТРЫ СИСТЕМНЫХ ФЛАГОВ В ФОРМАТЕ:  ABCDEFJHIKLMNOPQR...</Data>
</Node>
<Node><Sub>2</Sub>
<Data> , где:</Data>
</Node>
<Node><Sub>3</Sub>
<Data>A  1=1  Автозапуск сборщика системной информации ^RTHIST</Data>
</Node>
<Node><Sub>4</Sub>
<Data>B  2=1  Заходить в командер MSM при выходе из %BS</Data>
</Node>
<Node><Sub>5</Sub>
<Data>C  3=1  Разрешен вход в М-командер по команде &lt;ALT-F10&gt;</Data>
</Node>
<Node><Sub>6</Sub>
<Data>C  3=2  Вход в М-командер по любому печатному символу</Data>
</Node>
<Node><Sub>7</Sub>
<Data>D  4=1  Разрешена команда &lt;ALT-F11&gt;</Data>
</Node>
<Node><Sub>8</Sub>
<Data>E  5=1  Разрешена команда &lt;ALT-F12&gt;</Data>
</Node>
<Node><Sub>9</Sub>
<Data>F  6=1  Ваша машина ,является MSM-Server</Data>
</Node>
<Node><Sub>10</Sub>
<Data>J  7=1  Разрешить корректировать и показывать комментарий к</Data>
</Node>
<Node><Sub>11</Sub>
<Data>       кипу</Data>
</Node>
<Node><Sub>12</Sub>
<Data>H  8=1  Разрешить использовать &quot;Мышь&quot; (для MSM ver 4.0.x)</Data>
</Node>
<Node><Sub>13</Sub>
<Data>I  9=0  Использование ПРИНТЕРОВ локальных - (по-старому)</Data>
</Node>
<Node><Sub>14</Sub>
<Data>   9=1  Использовать ПРИНТ-СЕРВЕРОВ только удаленных систем</Data>
</Node>
<Node><Sub>15</Sub>
<Data>   9=2  Всегда Использовать ПРИНТ-СЕРВЕРА</Data>
</Node>
<Node><Sub>16</Sub>
<Data>   9=3  Запретить использовать ЛЮБЫХ УСТ-В ВЫВОДА (ПРИНТЕРОВ,ДОС)</Data>
</Node>
<Node><Sub>17</Sub>
<Data>K 10=0  При изменении длины колонок,работает Старая идеология</Data>
</Node>
<Node><Sub>18</Sub>
<Data>  10=1  в новую длину,без параметров &gt;&lt;&gt;,будет подставляться &gt;</Data>
</Node>
<Node><Sub>19</Sub>
<Data>  10=2  в новую длину,без параметров &gt;&lt;&gt;,будет подставляться &lt;</Data>
</Node>
<Node><Sub>20</Sub>
<Data>  10=3  в новую длину,без параметров &gt;&lt;&gt;,будет подставляться &lt;&gt;</Data>
</Node>
<Node><Sub>21</Sub>
<Data>L 11=0  Диспетчеp ввода инфоpмации, Аналитические Формы (СТАРАЯ ВЕРСИЯ)</Data>
</Node>
<Node><Sub>22</Sub>
<Data>  11=1  Диспетчеp ввода инфоpмации, Аналитические Формы  (НОВАЯ ВЕРСИЯ)</Data>
</Node>
<Node><Sub>23</Sub>
<Data><![CDATA[M 12=0 История Ввода строк:разная Для каждого терминала и пользователя     =================================]]></Data>
</Node>
<Node><Sub>24</Sub>
<Data><![CDATA[  12=1 -\\- одинакова для всех терминалов - разная для пользователей       |  УСТАНОВКА ЦВЕТОВ КОМПЛЕКСА   |]]></Data>
</Node>
<Node><Sub>25</Sub>
<Data><![CDATA[  12=2 -\\- одинакова для всех терминалов и пользователей                  | УКЗАТ.НА ПОМЕЧ.КЛЕТКЕ...%COLOR|]]></Data>
</Node>
<Node><Sub>26</Sub>
<Data><![CDATA[N 13=1 Включить возможность создавать запросы по СПИСКАМ\СВОДКАМ           | УКАЗАТЕЛЬ ТЕКУЩ.КЛЕТКИ..%COLOR|]]></Data>
</Node>
<Node><Sub>27</Sub>
<Data><![CDATA[  13=0 Можно только исполнять запросы                                      | ЦВЕТ ПОМЕЧЕННОЙ КЛЕТКИ .%COLOR|]]></Data>
</Node>
<Node><Sub>28</Sub>
<Data><![CDATA[O 14=1 Обязательное формирование полного года ГГГГ в Ф.СИНТ. $DAT          | - ЗАГОЛОВОК КАТАЛОГОВ...%COLOR| 1<--]]></Data>
</Node>
<Node><Sub>29</Sub>
<Data><![CDATA[  14=0 по-старому                                                          | - ТЕКСТ КАТАЛОГОВ.......%COLOR| 2  |]]></Data>
</Node>
<Node><Sub>30</Sub>
<Data><![CDATA[P 15=1 Запретить прерывание <Ctrl-C>                                       | - РАМКА ПАНЕЛИ СООБЩЕНИЯ%COLOR| 3  |]]></Data>
</Node>
<Node><Sub>31</Sub>
<Data><![CDATA[  15=0 Разрешить прерывание <Ctrl-C>                                       | - ТЕКСТ ПАНЕЛИ СООБЩЕНИЯ%COLOR| 4  |]]></Data>
</Node>
<Node><Sub>32</Sub>
<Data><![CDATA[Q 16=1 Запретить делать запись о удалении таблиц в Сист.протоколе          | - ОСНОВНОЙ ФОН "MEНЮ"...%COLOR| 5  |]]></Data>
</Node>
<Node><Sub>33</Sub>
<Data><![CDATA[  16=0 Запись производить всегда                                           | - ЗАСВЕТКА ПУНКТА "МЕНЮ"%COLOR| 6  |]]></Data>
</Node>
<Node><Sub>34</Sub>
<Data><![CDATA[R 17=1 Клавиша Del эквивалентна F8 в списке РАЗДЕЛОВ,ТАБЛИЦ,КЛЮЧЕЙ,ФАЙЛОВ  | - РАМКА ПАНЕЛИ ОШИБКИ ..%COLOR| 7  |]]></Data>
</Node>
<Node><Sub>35</Sub>
<Data><![CDATA[  17=0 все по-старому                                                      | - ТЕКСТ ПАНЕЛИ ОШИБКИ ..%COLOR| 8  |]]></Data>
</Node>
<Node><Sub>36</Sub>
<Data>  17=2 Клавиши F8 и Del можно применять только к данным клеток</Data>
</Node>
<Node><Sub>37</Sub>
<Data>  17=3 Клавиши F8 и Del заблокированы (запрещено что либо удалять)</Data>
</Node>
<Node><Sub>38</Sub>
<Data><![CDATA[S 18=1 Включен контроль синтаксиса программ для Cache'                     | СООБЩЕНИЕ О ТЕК.ДЕЙСТВИИ%COLOR| 9  |]]></Data>
</Node>
<Node><Sub>39</Sub>
<Data><![CDATA[  18=0 Выключен                                                            ====== Выберите нужный цвет =====    |]]></Data>
</Node>
<Node><Sub>40</Sub>
<Data><![CDATA[T 19=N Включено подавление цветовой палитры для Cache'. N-номер цвета из системной цветовой палитры -------------]]></Data>
</Node>
<Node><Sub>41</Sub>
<Data>  19=0 Выключен</Data>
</Node>
<Node><Sub>42</Sub>
<Data>U 20=1 Запрещено работать незарегистрированным</Data>
</Node>
<Node><Sub>43</Sub>
<Data>  20=0 Незарегистрированным работать можно, если БД пользователей пуста</Data>
</Node>
</Node>
<Node><Sub>TITPRN</Sub>
<Data>ТИТУЛ ВЫВОДА@@@@@@@7@10@19@70@@@@1@@5@@@1@@@ 1@@@@@16@@@2;6;36;44///2;6;36;44/2;6;37;44@@@@@@@1</Data>
<Node><Sub>1</Sub>
<Data>В САМОЙ ТАБЛИЦЕ ТИТУЛ МОЖЕТ БЫТЬ НЕУСТАНОВЛЕН, ПО ПРИЧИНЕ,</Data>
</Node>
<Node><Sub>2</Sub>
<Data>НАПРИМЕР ВЫСОКОЙ ШАПКИ.</Data>
</Node>
<Node><Sub>3</Sub>
<Data>          НО ЕСЛИ НАДО ЧТО БЫ ВЫВОД ОСУЩЕСТВЛЯЛСЯ С</Data>
</Node>
<Node><Sub>4</Sub>
<Data>     ТИТУЛОМ , ТО МОЖНО УСТАНОВИТЬ, ТАК НАЗЫВАЕМЫЙ ТИТУЛ</Data>
</Node>
<Node><Sub>5</Sub>
<Data>ДЛЯ ВЫВОДА.</Data>
</Node>
<Node><Sub>6</Sub>
<Data></Data>
</Node>
<Node><Sub>7</Sub>
<Data>    ДЛЯ ЭТОГО В ОПЦИЯХ НА ВЫВОД ВВЕСТИ ВМЕСТО 1 ИЛИ 0</Data>
</Node>
<Node><Sub>8</Sub>
<Data>    ТИТУЛ В ФОРМАТЕ Y,X</Data>
</Node>
<Node><Sub>9</Sub>
<Data>    Y- СТРОКА ТИТУЛА</Data>
</Node>
<Node><Sub>10</Sub>
<Data>    X- КОЛОНКА ТИТУЛА</Data>
</Node>
<Node><Sub>11</Sub>
<Data></Data>
</Node>
<Node><Sub>12</Sub>
<Data></Data>
</Node>
<Node><Sub>13</Sub>
<Data></Data>
</Node>
<Node><Sub>14</Sub>
<Data></Data>
</Node>
<Node><Sub>15</Sub>
<Data></Data>
</Node>
<Node><Sub>16</Sub>
<Data></Data>
</Node>
</Node>
<Node><Sub>TRAP</Sub>
<Data>ПОМОЩЬ ДЛЯ ЛОВУШКИ@@@@@@@7@10@19@70@@@@1@@5@@@1@@@ 1@@@@@8@@@2;6;36;44///2;6;36;44/2;6;37;44@@@@@@@1</Data>
<Node><Sub>1</Sub>
<Data></Data>
</Node>
<Node><Sub>2</Sub>
<Data>ВВЕДИТЕ КОМАНДЫ - М ЯЗЫКА или :</Data>
</Node>
<Node><Sub>3</Sub>
<Data>                               </Data>
</Node>
<Node><Sub>4</Sub>
<Data>LT - ВЫЗВАТЬ ТАБЛИЦУ ЛОКИРОВАННЫХ ПЕРЕМЕННЫХ</Data>
</Node>
<Node><Sub>5</Sub>
<Data>/L - ПОЭКРАННОЕ ЛИСТАНИЕ СПИСКА ЛОКАЛЬНЫХ ПЕРЕМЕННЫХ</Data>
</Node>
<Node><Sub>6</Sub>
<Data>LI - СПИСОК УЖЕ ВВЕДЕНЫХ КОМАНД</Data>
</Node>
<Node><Sub>7</Sub>
<Data></Data>
</Node>
<Node><Sub>8</Sub>
<Data>НОМЕР_УЖЕ_ВВЕДЕННОЙ_КОМАНДЫ - ВЫПОЛНЕНИЕ КОМАНДЫ</Data>
</Node>
</Node>
<Node><Sub>TRIGGER</Sub>
<Data><![CDATA[помощь на уровень ИМЕН ПЕРЕКЛЮЧАТЕЛЯ@@@@@@@7@10@19@70@@@@1@@5@@@1@@@ 1@@@@@15@@@2;6;36;44///2;6;36;44/2;6;37;44@@@@@@@1]]></Data>
<Node><Sub>1</Sub>
<Data></Data>
</Node>
<Node><Sub>2</Sub>
<Data>         ВВЕДИТЕ ИМЯ ПЕРЕКЛЮЧАТЕЛЯ БАЗ ДАННЫХ</Data>
</Node>
<Node><Sub>3</Sub>
<Data></Data>
</Node>
<Node><Sub>4</Sub>
<Data> ЭТО ИМЯ МОЖНО БУДЕТ ИСПОЛЬЗОВАТЬ В ПОЛЬЗОВАТЕЛЬСКИХ</Data>
</Node>
<Node><Sub>5</Sub>
<Data> ПРОГРАММАХ:</Data>
</Node>
<Node><Sub>6</Sub>
<Data> </Data>
</Node>
<Node><Sub>7</Sub>
<Data>&gt;I $$SetTBD^%ZAPM.ed.BSF13(&quot;ИМЯ1&quot;)=1 - УСТАНОВИЛСЯ ТЕКУЩИЙ</Data>
</Node>
<Node><Sub>8</Sub>
<Data>                               ПЕРЕКЛЮЧАТЕЛЬ НА  &quot;ИМЯ1&quot;</Data>
</Node>
<Node><Sub>9</Sub>
<Data>&gt;I $$SetTBD^%ZAPM.ed.BSF13(&quot;ИМЯ1&quot;)=0 - ПЕРЕКЛЮЧАТЕЛЬ НЕ УСТАНОВИЛСЯ</Data>
</Node>
<Node><Sub>10</Sub>
<Data></Data>
</Node>
<Node><Sub>11</Sub>
<Data>&gt;D ClearTBD^%ZAPM.ed.BSF13 - ОЧИСТИТЬ ПЕРЕКЛЮЧАТЕЛЬ</Data>
</Node>
<Node><Sub>12</Sub>
<Data></Data>
</Node>
<Node><Sub>13</Sub>
<Data>&gt;W $$ShowTBD^%ZAPM.ed.BSF13() - ПОСМОТРЕТЬ КАКОЙ ПЕРЕККЛЮЧАТЕЛЬ </Data>
</Node>
<Node><Sub>14</Sub>
<Data>                        УСТАНОВЛЕН</Data>
</Node>
<Node><Sub>15</Sub>
<Data>P.S.  ПЕРЕКЛЮЧАТЕЛЬ НЕ ЗАПИСИТ ОТ ИМЕНИ ПОЛЬЗОВАТЕЛЯ</Data>
</Node>
</Node>
<Node><Sub>TRIGGER1</Sub>
<Data><![CDATA[помощь на уровень КАКОЙ МАССИВ БАЗЫ ДАННЫХ@@@@@@@7@10@19@70@@@@1@@5@@@1@@@ 1@@@@@7@@@2;6;36;44///2;6;36;44/2;6;37;44@@@@@@@1]]></Data>
<Node><Sub>1</Sub>
<Data></Data>
</Node>
<Node><Sub>2</Sub>
<Data> ВВЕДИТЕ ССЫЛКУ МАССИВА БД, КОТОРУЮ БУДЕМ ПЕРЕКЛЮЧАТЬ</Data>
</Node>
<Node><Sub>3</Sub>
<Data></Data>
</Node>
<Node><Sub>4</Sub>
<Data>  В ФОРМАТЕ:</Data>
</Node>
<Node><Sub>5</Sub>
<Data>  </Data>
</Node>
<Node><Sub>6</Sub>
<Data>  ^[^[&quot;GLAVK&quot;]]]]]]]]]]]]MASSIV</Data>
</Node>
<Node><Sub>7</Sub>
<Data></Data>
</Node>
</Node>
<Node><Sub>TRIGGER2</Sub>
<Data><![CDATA[помощь на уровень МЕНЯЕМ НА КАКОЙ МАССИВ БАЗЫ ДАННЫХ@@@@@@@7@10@19@70@@@@1@@5@@@1@@@ 1@@@@@6@@@2;6;36;44///2;6;36;44/2;6;37;44@@@@@@@1]]></Data>
<Node><Sub>1</Sub>
<Data></Data>
</Node>
<Node><Sub>2</Sub>
<Data>  ВВЕДИТЕ ССЫЛКУ МАССИВА БД, НА КОТОРУЮ БУДЕМ ПЕРЕКЛЮЧАТЬ</Data>
</Node>
<Node><Sub>3</Sub>
<Data>  В ФОРМАТЕ:</Data>
</Node>
<Node><Sub>4</Sub>
<Data>  </Data>
</Node>
<Node><Sub>5</Sub>
<Data>  ^[^[&quot;GLAVK&quot;]]]]]]]]]]]]MASSIV</Data>
</Node>
<Node><Sub>6</Sub>
<Data></Data>
</Node>
</Node>
<Node><Sub>TipGluc</Sub>
<Data><![CDATA[Описание парамеров SaveScreens@@@@@@@3@10@22@70@@@@1@@5@@@1@@@ 1@@@@@18@@@2;6;36;44///2;6;36;44/2;6;37;44@@@@@@@1]]></Data>
<Node><Sub>1</Sub>
<Data> </Data>
</Node>
<Node><Sub>2</Sub>
<Data> Параметры  Хранителей Экрана В ФОРМАТЕ:  TTT-X-D-S</Data>
</Node>
<Node><Sub>3</Sub>
<Data> </Data>
</Node>
<Node><Sub>4</Sub>
<Data>,где: ТТТ - Количество секунд, по истечении которых, если</Data>
</Node>
<Node><Sub>5</Sub>
<Data>            не вводилось ни каких команд модифицированные</Data>
</Node>
<Node><Sub>6</Sub>
<Data>            дисковые буфера запишутся из памяти на диск</Data>
</Node>
<Node><Sub>7</Sub>
<Data>     X - Тип картинки при потушенном экране:</Data>
</Node>
<Node><Sub>8</Sub>
<Data>     X=1 - Прыгающий по экрану прямоугольник</Data>
</Node>
<Node><Sub>9</Sub>
<Data>     X=2 - Падающий снег    X=5 - Бегущая строка       </Data>
</Node>
<Node><Sub>10</Sub>
<Data>     X=3 - Дорога           X=6 - Медленное гашение экрана</Data>
</Node>
<Node><Sub>11</Sub>
<Data>     X=4 - Движущие Строки  X=7 - Неподвижная строка</Data>
</Node>
<Node><Sub>12</Sub>
<Data>      D- Скорость движения картинки (1-1000) для X= 1-5 </Data>
</Node>
<Node><Sub>13</Sub>
<Data>      S- Текст что писать в строке для X= 5,7      </Data>
</Node>
<Node><Sub>14</Sub>
<Data>      X=&quot;D LABEL^ROU&quot; - Запуск MSM программы</Data>
</Node>
<Node><Sub>15</Sub>
<Data>                     D=0 - без сброса буферов</Data>
</Node>
<Node><Sub>16</Sub>
<Data>                     D=1 - со сбросом буферов</Data>
</Node>
<Node><Sub>17</Sub>
<Data>      X=&quot;C:\UTL\PROG.EXE&quot; запуск DOS-программы,  D-пусто</Data>
</Node>
<Node><Sub>18</Sub>
<Data>               (Для MSM Version 4.0.x)</Data>
</Node>
</Node>
<Node><Sub>USERK1</Sub>
<Data><![CDATA[помощь на уровень ИМЕН ПОЛЬЗОВАТЕЛЕЙ@@@@@@@5@10@17@70@@@@1@@5@@@1@@@ 1@@@@@11@@@2;6;30;42///2;6;34;42/2;6;30;42@@@@@@@1]]></Data>
<Node><Sub>1</Sub>
<Data></Data>
</Node>
<Node><Sub>2</Sub>
<Data>    ВВЕДИТЕ ТРЕХСИМВОЛЬНОЕ ИМЯ ПОЛЬЗОВАТЕЛЯ ВАШЕГО</Data>
</Node>
<Node><Sub>3</Sub>
<Data>                      КОМПЛЕКСА</Data>
</Node>
<Node><Sub>4</Sub>
<Data></Data>
</Node>
<Node><Sub>5</Sub>
<Data> ПОТОМ ПРОГРАММА ПОПРОСИТ ВВЕСТИ ПАРОЛЬ И ПОЛНОЕ ИМЯ</Data>
</Node>
<Node><Sub>6</Sub>
<Data></Data>
</Node>
<Node><Sub>7</Sub>
<Data></Data>
</Node>
<Node><Sub>8</Sub>
<Data></Data>
</Node>
<Node><Sub>9</Sub>
<Data></Data>
</Node>
<Node><Sub>10</Sub>
<Data></Data>
</Node>
<Node><Sub>11</Sub>
<Data></Data>
</Node>
</Node>
<Node><Sub>USERK2</Sub>
<Data><![CDATA[помощь на уровень доступных томов@@@@@@@5@10@17@70@@@@1@@5@@@1@@@ 1@@@@@9@@@2;6;30;42///2;6;34;42/2;6;30;42@@@@@@@1]]></Data>
<Node><Sub>1</Sub>
<Data>ВВЕДИТЕ:</Data>
</Node>
<Node><Sub>2</Sub>
<Data>VOL - имя тома доступное пользователю</Data>
</Node>
<Node><Sub>3</Sub>
<Data>  * - все тома баз данных доступны для пользователя</Data>
</Node>
<Node><Sub>4</Sub>
<Data>  0 - прикрепление таблицы ограничения доступа USER_EX,%BSS</Data>
</Node>
<Node><Sub>5</Sub>
<Data>  1 - определение КИП,ТОМ доступного по DDP</Data>
</Node>
<Node><Sub>6</Sub>
<Data>  2 - определение умалчиваемых путей ввода/вывода</Data>
</Node>
<Node><Sub>7</Sub>
<Data>      ДОС-файлов</Data>
</Node>
<Node><Sub>8</Sub>
<Data>  3 - УЗЕЛ &quot;АДМИНИСТРАТОР&quot;</Data>
</Node>
<Node><Sub>9</Sub>
<Data>  4 - ПЕРЕАДРЕССАЦИЯ ИМЕН БАЗ ДАННЫХ, ПРАВА ДОСТУПА</Data>
</Node>
</Node>
<Node><Sub>USERK3</Sub>
<Data><![CDATA[помощь на уровень доступных кипов@@@@@@@5@10@17@70@@@@1@@5@@@1@@@ 1@@@@@21@@@2;6;30;42///2;6;34;42/2;6;30;42@@@@@@@1]]></Data>
<Node><Sub>1</Sub>
<Data>ВВЕДИТЕ:</Data>
</Node>
<Node><Sub>2</Sub>
<Data></Data>
</Node>
<Node><Sub>3</Sub>
<Data>    UCI - имя кипа доступное пользователю</Data>
</Node>
<Node><Sub>4</Sub>
<Data>      * - все кипы баз данных доступны для пользователя</Data>
</Node>
<Node><Sub>5</Sub>
<Data></Data>
</Node>
<Node><Sub>6</Sub>
<Data>UCI,VOL - кип и том доступный по DDP (если вы ввели на</Data>
</Node>
<Node><Sub>7</Sub>
<Data>          уровне томов 1)</Data>
</Node>
<Node><Sub>8</Sub>
<Data></Data>
</Node>
<Node><Sub>9</Sub>
<Data>     IN - уровень для пути к ДОС-файлам ввода поумолчанию</Data>
</Node>
<Node><Sub>10</Sub>
<Data>    OUT - уровень для пути к ДОС-файлам вывода поумолчанию</Data>
</Node>
<Node><Sub>11</Sub>
<Data>          (если вы ввели на уровне томов 2)</Data>
</Node>
<Node><Sub>12</Sub>
<Data></Data>
</Node>
<Node><Sub>13</Sub>
<Data>ВВЕДИТЕ * ЕСЛИ ПОЛЬЗОВАТЕЛЬ -  &quot;АДМИНИСТРАТОР&quot;</Data>
</Node>
<Node><Sub>14</Sub>
<Data>          (если вы ввели на уровне томов 3)</Data>
</Node>
<Node><Sub>15</Sub>
<Data></Data>
</Node>
<Node><Sub>16</Sub>
<Data>ДЛЯ ПЕРЕАДРЕССАЦИИ БАЗ ДАННЫХ:</Data>
</Node>
<Node><Sub>17</Sub>
<Data>-  ВВЕДИТЕ ССЫЛКУ НА ТАБЛИЦУ ОПИСАНИЯ БАЗ ДАННЫХ В ФОРМАТЕ</Data>
</Node>
<Node><Sub>18</Sub>
<Data>  ^PARTITION(~MANE_TOBD~)</Data>
</Node>
<Node><Sub>19</Sub>
<Data>(если NAME_TOBD - мультибаза, то должны быть указаны</Data>
</Node>
<Node><Sub>20</Sub>
<Data>  все таблицы описыващие эту МУЛЬТИБАЗУ)</Data>
</Node>
<Node><Sub>21</Sub>
<Data>- 0 - узел новых системных флагов для этой группы пользователей</Data>
</Node>
</Node>
<Node><Sub>USERK4</Sub>
<Data><![CDATA[помощь на уровень доступных разделов@@@@@@@5@10@17@70@@@@1@@5@@@1@@@ 1@@@@@15@@@2;6;30;42///2;6;34;42/2;6;30;42@@@@@@@1]]></Data>
<Node><Sub>1</Sub>
<Data>ВВЕДИТЕ:</Data>
</Node>
<Node><Sub>2</Sub>
<Data></Data>
</Node>
<Node><Sub>3</Sub>
<Data>    PART - имя раздела доступное пользователю</Data>
</Node>
<Node><Sub>4</Sub>
<Data>       * - все разделы доступны для пользователя</Data>
</Node>
<Node><Sub>5</Sub>
<Data> D:\PATH - путь к ДОС-файлам ввода\вывода поумолчанию</Data>
</Node>
<Node><Sub>6</Sub>
<Data>          (если вы ввели на уровне томов 2 ,а на уровне</Data>
</Node>
<Node><Sub>7</Sub>
<Data>          кипов IN или OUT)</Data>
</Node>
<Node><Sub>8</Sub>
<Data></Data>
</Node>
<Node><Sub>9</Sub>
<Data>ДЛЯ ПЕРЕАДРЕССАЦИИ БАЗ ДАННЫХ ВВЕДИТЕ:</Data>
</Node>
<Node><Sub>10</Sub>
<Data> - ССЫЛКУ НА ПОДМЕНЯЕМЫЙ МАССИВ БАЗЫ ДАННЫХ В ФОРМАТЕ</Data>
</Node>
<Node><Sub>11</Sub>
<Data>   ^[^[&quot;GLAVK&quot;]]]]]]]]]]]]MASS</Data>
</Node>
<Node><Sub>12</Sub>
<Data> - 1 - ЕСЛИ ПОДМЕНА НЕ НУЖНА, </Data>
</Node>
<Node><Sub>13</Sub>
<Data>   НО НАДО ПОНИЗИТЬ ПРАВА ДОСТУПА</Data>
</Node>
<Node><Sub>14</Sub>
<Data>если на 3 уровне 0, то здесь должны быть системные флаги</Data>
</Node>
<Node><Sub>15</Sub>
<Data>например 0000000030110100210 - максимально урезанные права</Data>
</Node>
</Node>
<Node><Sub>USERK5</Sub>
<Data><![CDATA[помощь на уровень доступных таблиц@@@@@@@5@10@17@70@@@@1@@5@@@1@@@ 1@@@@@21@@@2;6;30;42///2;6;34;42/2;6;30;42@@@@@@@1]]></Data>
<Node><Sub>1</Sub>
<Data>ВВЕДИТЕ:</Data>
</Node>
<Node><Sub>2</Sub>
<Data></Data>
</Node>
<Node><Sub>3</Sub>
<Data>    TAB - имя таблицы доступное пользователю</Data>
</Node>
<Node><Sub>4</Sub>
<Data>      * - все таблицы доступны для пользователя</Data>
</Node>
<Node><Sub>5</Sub>
<Data>      * - завершение определения путей умалчиваемого ввода</Data>
</Node>
<Node><Sub>6</Sub>
<Data>          вывода (если вы ввели на уровне томов 2 , на</Data>
</Node>
<Node><Sub>7</Sub>
<Data>          уровне кипов IN или OUT , а на уровне разделов</Data>
</Node>
<Node><Sub>8</Sub>
<Data>          пути к ДОС-файлам)</Data>
</Node>
<Node><Sub>9</Sub>
<Data></Data>
</Node>
<Node><Sub>10</Sub>
<Data>ДЛЯ ПЕРЕАДРЕССАЦИИ БАЗ ДАННЫХ,ИЛИ ОГРАНИЧЕНИЯ ДОСТУПА</Data>
</Node>
<Node><Sub>11</Sub>
<Data>ВВЕДИТЕ:</Data>
</Node>
<Node><Sub>12</Sub>
<Data>  - &quot;RWD&quot; или &quot;*&quot;  - ПОЛНЫЙ ДОСТУП</Data>
</Node>
<Node><Sub>13</Sub>
<Data>  - &quot;P&quot;  - ТОЛЬКО ЧТЕНИЕ без права допуска в карту БД</Data>
</Node>
<Node><Sub>14</Sub>
<Data>           И ПРИКРЕПЛЕННУЮ ТАБЛИЦУ</Data>
</Node>
<Node><Sub>15</Sub>
<Data>  - &quot;I&quot;  - ТОЛЬКО ЧТЕНИЕ без права допуска в карту БД,</Data>
</Node>
<Node><Sub>16</Sub>
<Data>           НО МОЖНО ВХОДИТЬ В ПРИКРЕПЛЕННУЮ ТАБЛИЦУ</Data>
</Node>
<Node><Sub>17</Sub>
<Data>  - &quot;R&quot;  - ТОЛЬКО ЧТЕНИЕ с правом допуска в карту БД</Data>
</Node>
<Node><Sub>18</Sub>
<Data>  - &quot;RW&quot;  - ЧТЕНИЕ И ЗАПИСЬ</Data>
</Node>
<Node><Sub>19</Sub>
<Data>  - &quot;RWN&quot;  - ЧТЕНИЕ И ЗАПИСЬ с правом допуска в карту БД,</Data>
</Node>
<Node><Sub>20</Sub>
<Data>            но без права вводить новые УЗЛЫ.</Data>
</Node>
<Node><Sub>21</Sub>
<Data>  - &quot;NONE&quot;  - ДОСТУПА НЕТ</Data>
</Node>
</Node>
<Node><Sub>VerHigh</Sub>
<Data>помощь@@@@@@@5@10@17@70@@@@1@@5@@@1@@@ 1@@@@@9@@@2;6;30;42///2;6;34;42/2;6;30;42@@@@@@@1</Data>
<Node><Sub>1</Sub>
<Data></Data>
</Node>
<Node><Sub>2</Sub>
<Data>ФОРМАТ ПАРАМЕТРА:  1\2</Data>
</Node>
<Node><Sub>3</Sub>
<Data>  ,где</Data>
</Node>
<Node><Sub>4</Sub>
<Data></Data>
</Node>
<Node><Sub>5</Sub>
<Data>1=  A - ПОВЫШАТЬ ВЕРСИЮ ВСЕГДА АВТОМАТИЧЕСКИ</Data>
</Node>
<Node><Sub>6</Sub>
<Data>    Y - СПРАШИВАТЬ ПОВЫШАТЬ ЛИ ВЕРСИЮ</Data>
</Node>
<Node><Sub>7</Sub>
<Data>    N - НИКОГДА НЕ ПОВЫШАТЬ</Data>
</Node>
<Node><Sub>8</Sub>
<Data>2=  ПОЛНАЯ ГЛОБАЛЬНАЯ ССЫЛКА , ГДЕ ЛЕЖИТ ПОСЛЕДНЯЯ ВЕРСИЯ</Data>
</Node>
<Node><Sub>9</Sub>
<Data>    КОМПЛЕКСА</Data>
</Node>
</Node>
</Node>
</Global>


<Global>
<Node><Sub>^%ZAPM.ed.BSR</Sub>
<Data></Data>
<Node><Sub>1</Sub>
<Node><Sub>0</Sub>
<Data>1</Data>
</Node>
<Node><Sub>1</Sub>
<Data><![CDATA[±>®>®>®>®>®>®>®>®>®>®>®>®>®>®>®>®>®>®>®>®>®>®>®>®>®>®>®>®>®>®>®>®>®>®>®>®>®>®>®>®>®>®>®>®>®>®>®>®>®>®>®>®>®>®>®>®>®>®>®>®>®>®>®>®>®>®>®>®>®>®>®>®>®>®>®>®>±>]]></Data>
</Node>
<Node><Sub>2</Sub>
<Data><![CDATA[±> > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > >±>]]></Data>
</Node>
<Node><Sub>3</Sub>
<Data><![CDATA[±> > > > > > > > > > > > > > > > > > > > > >¶>±>±> > > > > > > > > >_>±>±>±>±>_> > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > >±>]]></Data>
</Node>
<Node><Sub>4</Sub>
<Data><![CDATA[±> > > > > > > > > >¶>¶>¶> > > > > > > > >¶>±>±>·> > > > > > > > > >±>±>­>·>®>±>±>_> > > > > > > > > > > > > > > >_>±>±>±> > > > > > >|> > > > > > > > > >±>]]></Data>
</Node>
<Node><Sub>5</Sub>
<Data><![CDATA[±> > > > > > > > > > >­>¶>­> > > > > > >¶>±>±>·> > > > > > > > > > >±>±>·> > >_>±>±>·> > > > > > > > > > > > >_>±>_>±>®>·> > > > > > >|> > > > > > > > > >±>]]></Data>
</Node>
<Node><Sub>6</Sub>
<Data><![CDATA[±> > > > > > > > > > > >­>­> > > > > >¶>±>±>·> > > > > > > > > > > >±>±>·>_>±>±>®>·> > > > > > > > > > > > > >±>±>®>·> > > > > >->=>­>¶>­>=>=>-> > > > > >±>]]></Data>
</Node>
<Node><Sub>7</Sub>
<Data><![CDATA[±> > > > > > > > > > > > >·> > > > >¶>±>±>·> > > > > > > > > > > > >]>±>·> >®>±>±>_> > > > > > > > > > > >_>±>­>±>±> > > > > > > > > >¶> > > > > > > > > >±>]]></Data>
</Node>
<Node><Sub>8</Sub>
<Data><![CDATA[±> > > > > > > > > > > > > > > > >¶>±>±>·> > > > > > > > > > > > > >±>±>·> > > >®>±>±> > > > > > > > >_>±>®>·> >·>±>±> > > > > > > > >|> > > > > > > > > >±>]]></Data>
</Node>
<Node><Sub>9</Sub>
<Data><![CDATA[±> > > > > > > > > > > > > > > >¶>±>±>·> > > > > > > > > > > > >]> >±>[> > > > > >·>±>±> > > > > >_>±>®> > > > > >·>±>±> > > > > > > >|> >|> > > > > > > >±>]]></Data>
</Node>
<Node><Sub>10</Sub>
<Data><![CDATA[±> > > > > > > > > > > > > > >¶>±>±>·> > > >_>±>±>·> > > > > >]>[>]>±>·> > > > > >±>±>±>·> > > >­>®> > > > > > > > >·>±>±> > > > > > > >->|>=>-> > > > > >±>]]></Data>
</Node>
<Node><Sub>11</Sub>
<Data><![CDATA[±> > > > > > > > > > > > > >¶>±>±>·> > > > >±>±>­> > > > > > >±> >±>[> >_> > >_>±>±>±>·> > > > > > > > > > > > > > > >±>±>[> > > > > > > >|> > > > > > > >±>]]></Data>
</Node>
<Node><Sub>12</Sub>
<Data><![CDATA[±> > > > > > >_>¶>¶>_> >_>±>±>±>·> > > > > >±>­> > > > > > >±>[>]>±>·> >®>±>±>±>±>®>a> > > > > > > >±> > > > > > > > >­>±>±>·> > > > > > > > > > > > > > >±>]]></Data>
</Node>
<Node><Sub>13</Sub>
<Data><![CDATA[±> > > > > > >¶>_>_>±>±>±>±>®>a>t>a> > > > >·> > > > > > > >­>±>±>[> > > > > > > > > > > > > > > > >·>±>_> > > > > >_>±>±>­> > > > > > > > > > >+> > > > >±>]]></Data>
</Node>
<Node><Sub>14</Sub>
<Data><![CDATA[±> > > > > > > >®>®>®>®> > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > >·>­>±>±>±>±>±>®>®>e> > > > > > > > > > > > > > > > >±>]]></Data>
</Node>
<Node><Sub>15</Sub>
<Data><![CDATA[±> > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > >±>]]></Data>
</Node>
<Node><Sub>16</Sub>
<Data><![CDATA[±> > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > >±>]]></Data>
</Node>
<Node><Sub>17</Sub>
<Data><![CDATA[±> > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > >±>]]></Data>
</Node>
<Node><Sub>18</Sub>
<Data><![CDATA[±> > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > >±>]]></Data>
</Node>
<Node><Sub>19</Sub>
<Data><![CDATA[±> > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > >±>]]></Data>
</Node>
<Node><Sub>20</Sub>
<Data><![CDATA[±> > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > >±>]]></Data>
</Node>
<Node><Sub>21</Sub>
<Data><![CDATA[±> > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > >±>]]></Data>
</Node>
<Node><Sub>22</Sub>
<Data><![CDATA[±> > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > >±>]]></Data>
</Node>
<Node><Sub>23</Sub>
<Data><![CDATA[±>_>_>_>_>_>_>_>_>_>_>_>_>_>_>_>_>_>_>_>_>_>_>_>_>_>_>_>_>_>_>_>_>_>_>_>_>_>_>_>_>_>_>_>_>_>_>_>_>_>_>_>_>_>_>_>_>_>_>_>_>_>_>_>_>_>_>_>_>_>_>_>_>_>_>_>_>±>]]></Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>0</Sub>
<Data>1</Data>
</Node>
<Node><Sub>1</Sub>
<Data>================================================================================</Data>
</Node>
<Node><Sub>2</Sub>
<Data>|                                                                              |</Data>
</Node>
<Node><Sub>3</Sub>
<Data>|==============================================================================| </Data>
</Node>
<Node><Sub>4</Sub>
<Data>|                                                                              | </Data>
</Node>
<Node><Sub>5</Sub>
<Data>|------------------------------------------------------------------------------| </Data>
</Node>
<Node><Sub>6</Sub>
<Data>|                                                                              | </Data>
</Node>
<Node><Sub>7</Sub>
<Data>|                                                                              | </Data>
</Node>
<Node><Sub>8</Sub>
<Data>|                                                                              | </Data>
</Node>
<Node><Sub>9</Sub>
<Data>|                                                                              | </Data>
</Node>
<Node><Sub>10</Sub>
<Data>|                                                                              | </Data>
</Node>
<Node><Sub>11</Sub>
<Data>|                                                                              | </Data>
</Node>
<Node><Sub>12</Sub>
<Data>|                                                                              | </Data>
</Node>
<Node><Sub>13</Sub>
<Data>|                                                                              | </Data>
</Node>
<Node><Sub>14</Sub>
<Data>|                                                                              | </Data>
</Node>
<Node><Sub>15</Sub>
<Data>|                                                                              | </Data>
</Node>
<Node><Sub>16</Sub>
<Data>|                                                                              | </Data>
</Node>
<Node><Sub>17</Sub>
<Data>|                                                                              | </Data>
</Node>
<Node><Sub>18</Sub>
<Data>|                                                                              | </Data>
</Node>
<Node><Sub>19</Sub>
<Data>|                                                                              | </Data>
</Node>
<Node><Sub>20</Sub>
<Data>|                                                                              |</Data>
</Node>
<Node><Sub>21</Sub>
<Data>|                                                                              | </Data>
</Node>
<Node><Sub>22</Sub>
<Data>|                                                                              | </Data>
</Node>
<Node><Sub>23</Sub>
<Data>|------------------------------------------------------------------------------| </Data>
</Node>
<Node><Sub>24</Sub>
<Data>|                                                                              | </Data>
</Node>
<Node><Sub>25</Sub>
<Data>================================================================================ </Data>
</Node>
</Node>
<Node><Sub>KEY-PC</Sub>
<Data>;PC-CONSOL,ARM_TERM</Data>
<Node><Sub>0</Sub>
<Node><Sub>1</Sub>
<Data>27,79,80,-1,-1</Data>
</Node>
<Node><Sub>2</Sub>
<Data>27,79,81,-1,-1</Data>
</Node>
<Node><Sub>3</Sub>
<Data>27,79,82,-1,-1</Data>
</Node>
<Node><Sub>4</Sub>
<Data>27,79,83,-1,-1</Data>
</Node>
<Node><Sub>5</Sub>
<Data>27,79,84,-1,-1</Data>
</Node>
<Node><Sub>6</Sub>
<Data>27,79,85,-1,-1</Data>
</Node>
<Node><Sub>7</Sub>
<Data>27,79,86,-1,-1</Data>
</Node>
<Node><Sub>8</Sub>
<Data>27,79,87,-1,-1</Data>
</Node>
<Node><Sub>9</Sub>
<Data>27,79,88,-1,-1</Data>
</Node>
<Node><Sub>10</Sub>
<Data>27,79,89,-1,-1</Data>
</Node>
<Node><Sub>11</Sub>
<Data>0,133,-1,-1,-1</Data>
</Node>
<Node><Sub>12</Sub>
<Data>0,134,-1,-1,-1</Data>
</Node>
<Node><Sub>65</Sub>
<Data>65,-1,-1,-1,-1</Data>
</Node>
<Node><Sub>66</Sub>
<Data>66,-1,-1,-1,-1</Data>
</Node>
<Node><Sub>67</Sub>
<Data>67,-1,-1,-1,-1</Data>
</Node>
<Node><Sub>68</Sub>
<Data>68,-1,-1,-1,-1</Data>
</Node>
<Node><Sub>69</Sub>
<Data>69,-1,-1,-1,-1</Data>
</Node>
<Node><Sub>70</Sub>
<Data>70,-1,-1,-1,-1</Data>
</Node>
<Node><Sub>71</Sub>
<Data>71,-1,-1,-1,-1</Data>
</Node>
<Node><Sub>72</Sub>
<Data>72,-1,-1,-1,-1</Data>
</Node>
<Node><Sub>73</Sub>
<Data>73,-1,-1,-1,-1</Data>
</Node>
<Node><Sub>74</Sub>
<Data>74,-1,-1,-1,-1</Data>
</Node>
<Node><Sub>75</Sub>
<Data>75,-1,-1,-1,-1</Data>
</Node>
<Node><Sub>76</Sub>
<Data>76,-1,-1,-1,-1</Data>
</Node>
<Node><Sub>77</Sub>
<Data>77,-1,-1,-1,-1</Data>
</Node>
<Node><Sub>78</Sub>
<Data>78,-1,-1,-1,-1</Data>
</Node>
<Node><Sub>79</Sub>
<Data>79,-1,-1,-1,-1</Data>
</Node>
<Node><Sub>80</Sub>
<Data>80,-1,-1,-1,-1</Data>
</Node>
<Node><Sub>81</Sub>
<Data>81,-1,-1,-1,-1</Data>
</Node>
<Node><Sub>82</Sub>
<Data>82,-1,-1,-1,-1</Data>
</Node>
<Node><Sub>83</Sub>
<Data>83,-1,-1,-1,-1</Data>
</Node>
<Node><Sub>84</Sub>
<Data>84,-1,-1,-1,-1</Data>
</Node>
<Node><Sub>85</Sub>
<Data>85,-1,-1,-1,-1</Data>
</Node>
<Node><Sub>86</Sub>
<Data>86,-1,-1,-1,-1</Data>
</Node>
<Node><Sub>87</Sub>
<Data>87,-1,-1,-1,-1</Data>
</Node>
<Node><Sub>88</Sub>
<Data>88,-1,-1,-1,-1</Data>
</Node>
<Node><Sub>89</Sub>
<Data>89,-1,-1,-1,-1</Data>
</Node>
<Node><Sub>90</Sub>
<Data>90,-1,-1,-1,-1</Data>
</Node>
<Node><Sub>BCSP</Sub>
<Data>8,-1,-1,-1,-1</Data>
</Node>
<Node><Sub>DL</Sub>
<Data>127,-1,-1,-1,-1</Data>
</Node>
<Node><Sub>DN</Sub>
<Data>27,91,66,-1,-1</Data>
</Node>
<Node><Sub>EN</Sub>
<Data>0,79,-1,-1,-1</Data>
</Node>
<Node><Sub>HM</Sub>
<Data>0,71,-1,-1,-1</Data>
</Node>
<Node><Sub>IN</Sub>
<Data>0,82,-1,-1,-1</Data>
</Node>
<Node><Sub>LT</Sub>
<Data>27,91,68,-1,-1</Data>
</Node>
<Node><Sub>PD</Sub>
<Data>0,81,-1,-1,-1</Data>
</Node>
<Node><Sub>PU</Sub>
<Data>0,73,-1,-1,-1</Data>
</Node>
<Node><Sub>RT</Sub>
<Data>27,91,67,-1,-1</Data>
</Node>
<Node><Sub>UP</Sub>
<Data>27,91,65,-1,-1</Data>
</Node>
</Node>
<Node><Sub>ALT</Sub>
<Node><Sub>1</Sub>
<Data>0,104,-1,-1,-1</Data>
</Node>
<Node><Sub>2</Sub>
<Data>0,105,-1,-1,-1</Data>
</Node>
<Node><Sub>3</Sub>
<Data>0,106,-1,-1,-1</Data>
</Node>
<Node><Sub>4</Sub>
<Data>0,107,-1,-1,-1</Data>
</Node>
<Node><Sub>5</Sub>
<Data>0,108,-1,-1,-1</Data>
</Node>
<Node><Sub>6</Sub>
<Data>0,109,-1,-1,-1</Data>
</Node>
<Node><Sub>7</Sub>
<Data>0,110,-1,-1,-1</Data>
</Node>
<Node><Sub>8</Sub>
<Data>0,111,-1,-1,-1</Data>
</Node>
<Node><Sub>9</Sub>
<Data>0,112,-1,-1,-1</Data>
</Node>
<Node><Sub>10</Sub>
<Data>0,113,-1,-1,-1</Data>
</Node>
<Node><Sub>11</Sub>
<Data>0,139,-1,-1,-1</Data>
</Node>
<Node><Sub>12</Sub>
<Data>0,140,-1,-1,-1</Data>
</Node>
<Node><Sub>65</Sub>
<Data>0,30,-1,-1,-1</Data>
</Node>
<Node><Sub>66</Sub>
<Data>0,48,-1,-1,-1</Data>
</Node>
<Node><Sub>67</Sub>
<Data>0,46,-1,-1,-1</Data>
</Node>
<Node><Sub>68</Sub>
<Data>0,32,-1,-1,-1</Data>
</Node>
<Node><Sub>69</Sub>
<Data>0,18,-1,-1,-1</Data>
</Node>
<Node><Sub>70</Sub>
<Data>0,33,-1,-1,-1</Data>
</Node>
<Node><Sub>71</Sub>
<Data>0,34,-1,-1,-1</Data>
</Node>
<Node><Sub>72</Sub>
<Data>0,35,-1,-1,-1</Data>
</Node>
<Node><Sub>73</Sub>
<Data>0,23,-1,-1,-1</Data>
</Node>
<Node><Sub>74</Sub>
<Data>0,36,-1,-1,-1</Data>
</Node>
<Node><Sub>75</Sub>
<Data>0,37,-1,-1,-1</Data>
</Node>
<Node><Sub>76</Sub>
<Data>0,38,-1,-1,-1</Data>
</Node>
<Node><Sub>77</Sub>
<Data>0,50,-1,-1,-1</Data>
</Node>
<Node><Sub>78</Sub>
<Data>0,49,-1,-1,-1</Data>
</Node>
<Node><Sub>79</Sub>
<Data>0,24,-1,-1,-1</Data>
</Node>
<Node><Sub>80</Sub>
<Data>0,25,-1,-1,-1</Data>
</Node>
<Node><Sub>81</Sub>
<Data>0,16,-1,-1,-1</Data>
</Node>
<Node><Sub>82</Sub>
<Data>0,19,-1,-1,-1</Data>
</Node>
<Node><Sub>83</Sub>
<Data>0,31,-1,-1,-1</Data>
</Node>
<Node><Sub>84</Sub>
<Data>0,20,-1,-1,-1</Data>
</Node>
<Node><Sub>85</Sub>
<Data>0,22,-1,-1,-1</Data>
</Node>
<Node><Sub>86</Sub>
<Data>0,47,-1,-1,-1</Data>
</Node>
<Node><Sub>88</Sub>
<Data>0,45,-1,-1,-1</Data>
</Node>
<Node><Sub>89</Sub>
<Data>0,21,-1,-1,-1</Data>
</Node>
<Node><Sub>90</Sub>
<Data>0,44,-1,-1,-1</Data>
</Node>
<Node><Sub>BCSP</Sub>
<Data>0,14,-1,-1,-1</Data>
</Node>
<Node><Sub>DL</Sub>
<Data>0,163,-1,-1,-1</Data>
</Node>
<Node><Sub>DN</Sub>
<Data>0,160,-1,-1,-1</Data>
</Node>
<Node><Sub>EN</Sub>
<Data>0,159,-1,-1,-1</Data>
</Node>
<Node><Sub>HM</Sub>
<Data>0,151,-1,-1,-1</Data>
</Node>
<Node><Sub>IN</Sub>
<Data>0,162,-1,-1,-1</Data>
</Node>
<Node><Sub>LT</Sub>
<Data>0,155,-1,-1,-1</Data>
</Node>
<Node><Sub>PD</Sub>
<Data>0,161,-1,-1,-1</Data>
</Node>
<Node><Sub>PU</Sub>
<Data>0,153,-1,-1,-1</Data>
</Node>
<Node><Sub>RT</Sub>
<Data>0,157,-1,-1,-1</Data>
</Node>
<Node><Sub>UP</Sub>
<Data>0,152,-1,-1,-1</Data>
</Node>
</Node>
<Node><Sub>CRL</Sub>
<Node><Sub>1</Sub>
<Data>0,94,-1,-1,-1</Data>
</Node>
<Node><Sub>2</Sub>
<Data>0,95,-1,-1,-1</Data>
</Node>
<Node><Sub>3</Sub>
<Data>0,96,-1,-1,-1</Data>
</Node>
<Node><Sub>4</Sub>
<Data>0,97,-1,-1,-1</Data>
</Node>
<Node><Sub>5</Sub>
<Data>0,98,-1,-1,-1</Data>
</Node>
<Node><Sub>6</Sub>
<Data>0,99,-1,-1,-1</Data>
</Node>
<Node><Sub>7</Sub>
<Data>0,100,-1,-1,-1</Data>
</Node>
<Node><Sub>8</Sub>
<Data>0,101,-1,-1,-1</Data>
</Node>
<Node><Sub>9</Sub>
<Data>0,102,-1,-1,-1</Data>
</Node>
<Node><Sub>10</Sub>
<Data>0,103,-1,-1,-1</Data>
</Node>
<Node><Sub>11</Sub>
<Data>0,137,-1,-1,-1</Data>
</Node>
<Node><Sub>12</Sub>
<Data>0,138,-1,-1,-1</Data>
</Node>
<Node><Sub>65</Sub>
<Data>1,-1,-1,-1,-1</Data>
</Node>
<Node><Sub>66</Sub>
<Data>2,-1,-1,-1,-1</Data>
</Node>
<Node><Sub>67</Sub>
<Data>27,-1,-1,-1,-1</Data>
</Node>
<Node><Sub>68</Sub>
<Data>4,-1,-1,-1,-1</Data>
</Node>
<Node><Sub>69</Sub>
<Data>5,-1,-1,-1,-1</Data>
</Node>
<Node><Sub>70</Sub>
<Data>6,-1,-1,-1,-1</Data>
</Node>
<Node><Sub>71</Sub>
<Data>7,-1,-1,-1,-1</Data>
</Node>
<Node><Sub>72</Sub>
<Data>8,-1,-1,-1,-1</Data>
</Node>
<Node><Sub>73</Sub>
<Data>9,-1,-1,-1,-1</Data>
</Node>
<Node><Sub>74</Sub>
<Data>10,-1,-1,-1,-1</Data>
</Node>
<Node><Sub>75</Sub>
<Data>11,-1,-1,-1,-1</Data>
</Node>
<Node><Sub>76</Sub>
<Data>12,-1,-1,-1,-1</Data>
</Node>
<Node><Sub>77</Sub>
<Data>13,-1,-1,-1,-1</Data>
</Node>
<Node><Sub>78</Sub>
<Data>14,-1,-1,-1,-1</Data>
</Node>
<Node><Sub>79</Sub>
<Data>13,-1,-1,-1,-1</Data>
</Node>
<Node><Sub>80</Sub>
<Data>18,-1,-1,-1,-1</Data>
</Node>
<Node><Sub>81</Sub>
<Data>0,16,-1,-1,-1</Data>
</Node>
<Node><Sub>82</Sub>
<Data>18,-1,-1,-1,-1</Data>
</Node>
<Node><Sub>83</Sub>
<Data>13,-1,-1,-1,-1</Data>
</Node>
<Node><Sub>84</Sub>
<Data>20,-1,-1,-1,-1</Data>
</Node>
<Node><Sub>85</Sub>
<Data>21,-1,-1,-1,-1</Data>
</Node>
<Node><Sub>86</Sub>
<Data>22,-1,-1,-1,-1</Data>
</Node>
<Node><Sub>87</Sub>
<Data>23,-1,-1,-1,-1</Data>
</Node>
<Node><Sub>88</Sub>
<Data>24,-1,-1,-1,-1</Data>
</Node>
<Node><Sub>89</Sub>
<Data>25,-1,-1,-1,-1</Data>
</Node>
<Node><Sub>90</Sub>
<Data>26,-1,-1,-1,-1</Data>
</Node>
<Node><Sub>BCSP</Sub>
<Data>127,-1,-1,-1,-1</Data>
</Node>
<Node><Sub>DL</Sub>
<Data>0,147,-1,-1,-1</Data>
</Node>
<Node><Sub>DN</Sub>
<Data>0,145,-1,-1,-1</Data>
</Node>
<Node><Sub>EN</Sub>
<Data>0,117,-1,-1,-1</Data>
</Node>
<Node><Sub>HM</Sub>
<Data>0,119,-1,-1,-1</Data>
</Node>
<Node><Sub>IN</Sub>
<Data>0,146,-1,-1,-1</Data>
</Node>
<Node><Sub>LT</Sub>
<Data>0,115,-1,-1,-1</Data>
</Node>
<Node><Sub>PD</Sub>
<Data>0,118,-1,-1,-1</Data>
</Node>
<Node><Sub>PU</Sub>
<Data>0,132,-1,-1,-1</Data>
</Node>
<Node><Sub>RT</Sub>
<Data>0,116,-1,-1,-1</Data>
</Node>
<Node><Sub>UP</Sub>
<Data>0,141,-1,-1,-1</Data>
</Node>
</Node>
<Node><Sub>SFT</Sub>
<Node><Sub>1</Sub>
<Data>0,84,-1,-1,-1</Data>
</Node>
<Node><Sub>2</Sub>
<Data>0,85,-1,-1,-1</Data>
</Node>
<Node><Sub>3</Sub>
<Data>0,86,-1,-1,-1</Data>
</Node>
<Node><Sub>4</Sub>
<Data>0,87,-1,-1,-1</Data>
</Node>
<Node><Sub>5</Sub>
<Data>0,88,-1,-1,-1</Data>
</Node>
<Node><Sub>6</Sub>
<Data>0,89,-1,-1,-1</Data>
</Node>
<Node><Sub>7</Sub>
<Data>0,90,-1,-1,-1</Data>
</Node>
<Node><Sub>8</Sub>
<Data>0,91,-1,-1,-1</Data>
</Node>
<Node><Sub>9</Sub>
<Data>0,92,-1,-1,-1</Data>
</Node>
<Node><Sub>10</Sub>
<Data>0,93,-1,-1,-1</Data>
</Node>
<Node><Sub>11</Sub>
<Data>0,135,-1,-1,-1</Data>
</Node>
<Node><Sub>12</Sub>
<Data>0,136,-1,-1,-1</Data>
</Node>
<Node><Sub>65</Sub>
<Data>97,-1,-1,-1,-1</Data>
</Node>
<Node><Sub>66</Sub>
<Data>98,-1,-1,-1,-1</Data>
</Node>
<Node><Sub>67</Sub>
<Data>99,-1,-1,-1,-1</Data>
</Node>
<Node><Sub>68</Sub>
<Data>100,-1,-1,-1,-1</Data>
</Node>
<Node><Sub>69</Sub>
<Data>101,-1,-1,-1,-1</Data>
</Node>
<Node><Sub>70</Sub>
<Data>102,-1,-1,-1,-1</Data>
</Node>
<Node><Sub>71</Sub>
<Data>103,-1,-1,-1,-1</Data>
</Node>
<Node><Sub>72</Sub>
<Data>104,-1,-1,-1,-1</Data>
</Node>
<Node><Sub>73</Sub>
<Data>105,-1,-1,-1,-1</Data>
</Node>
<Node><Sub>74</Sub>
<Data>106,-1,-1,-1,-1</Data>
</Node>
<Node><Sub>75</Sub>
<Data>107,-1,-1,-1,-1</Data>
</Node>
<Node><Sub>76</Sub>
<Data>108,-1,-1,-1,-1</Data>
</Node>
<Node><Sub>77</Sub>
<Data>109,-1,-1,-1,-1</Data>
</Node>
<Node><Sub>78</Sub>
<Data>110,-1,-1,-1,-1</Data>
</Node>
<Node><Sub>79</Sub>
<Data>111,-1,-1,-1,-1</Data>
</Node>
<Node><Sub>80</Sub>
<Data>112,-1,-1,-1,-1</Data>
</Node>
<Node><Sub>81</Sub>
<Data>113,-1,-1,-1,-1</Data>
</Node>
<Node><Sub>82</Sub>
<Data>114,-1,-1,-1,-1</Data>
</Node>
<Node><Sub>83</Sub>
<Data>115,-1,-1,-1,-1</Data>
</Node>
<Node><Sub>84</Sub>
<Data>116,-1,-1,-1,-1</Data>
</Node>
<Node><Sub>85</Sub>
<Data>117,-1,-1,-1,-1</Data>
</Node>
<Node><Sub>86</Sub>
<Data>118,-1,-1,-1,-1</Data>
</Node>
<Node><Sub>87</Sub>
<Data>119,-1,-1,-1,-1</Data>
</Node>
<Node><Sub>88</Sub>
<Data>120,-1,-1,-1,-1</Data>
</Node>
<Node><Sub>89</Sub>
<Data>121,-1,-1,-1,-1</Data>
</Node>
<Node><Sub>90</Sub>
<Data>122,-1,-1,-1,-1</Data>
</Node>
<Node><Sub>BCSP</Sub>
<Data>8,-1,-1,-1,-1</Data>
</Node>
<Node><Sub>DL</Sub>
<Data>127,-1,-1,-1,-1</Data>
</Node>
<Node><Sub>DN</Sub>
<Data>27,91,66,-1,-1</Data>
</Node>
<Node><Sub>EN</Sub>
<Data>0,79,-1,-1,-1</Data>
</Node>
<Node><Sub>HM</Sub>
<Data>0,71,-1,-1,-1</Data>
</Node>
<Node><Sub>IN</Sub>
<Data>0,82,-1,-1,-1</Data>
</Node>
<Node><Sub>LT</Sub>
<Data>27,91,68,-1,-1</Data>
</Node>
<Node><Sub>PD</Sub>
<Data>0,81,-1,-1,-1</Data>
</Node>
<Node><Sub>PU</Sub>
<Data>0,73,-1,-1,-1</Data>
</Node>
<Node><Sub>RT</Sub>
<Data>27,91,67,-1,-1</Data>
</Node>
<Node><Sub>UP</Sub>
<Data>27,91,65,-1,-1</Data>
</Node>
</Node>
</Node>
<Node><Sub>PCTT</Sub>
<Data>;PCTT-TERMINAL,PCPC &amp; etc.</Data>
<Node><Sub>0</Sub>
<Node><Sub>1</Sub>
<Data>27,80,-1,-1,-1</Data>
</Node>
<Node><Sub>2</Sub>
<Data>27,81,-1,-1,-1</Data>
</Node>
<Node><Sub>3</Sub>
<Data>27,82,-1,-1,-1</Data>
</Node>
<Node><Sub>4</Sub>
<Data>27,83,-1,-1,-1</Data>
</Node>
<Node><Sub>5</Sub>
<Data>27,84,-1,-1,-1</Data>
</Node>
<Node><Sub>6</Sub>
<Data>27,85,-1,-1,-1</Data>
</Node>
<Node><Sub>7</Sub>
<Data>27,86,-1,-1,-1</Data>
</Node>
<Node><Sub>8</Sub>
<Data>27,87,-1,-1,-1</Data>
</Node>
<Node><Sub>9</Sub>
<Data>27,88,-1,-1,-1</Data>
</Node>
<Node><Sub>10</Sub>
<Data>27,89,-1,-1,-1</Data>
</Node>
<Node><Sub>BCSP</Sub>
<Data>8,-1,-1,-1,-1</Data>
</Node>
<Node><Sub>DL</Sub>
<Data>127,-1,-1,-1,-1</Data>
</Node>
<Node><Sub>DN</Sub>
<Data>27,91,66,-1,-1</Data>
</Node>
<Node><Sub>EN</Sub>
<Data>0,79,-1,-1,-1</Data>
</Node>
<Node><Sub>HM</Sub>
<Data>0,71,-1,-1,-1</Data>
</Node>
<Node><Sub>IN</Sub>
<Data>0,82,-1,-1,-1</Data>
</Node>
<Node><Sub>LT</Sub>
<Data>27,91,68,-1,-1</Data>
</Node>
<Node><Sub>PD</Sub>
<Data>0,81,-1,-1,-1</Data>
</Node>
<Node><Sub>PU</Sub>
<Data>0,73,-1,-1,-1</Data>
</Node>
<Node><Sub>RT</Sub>
<Data>27,91,67,-1,-1</Data>
</Node>
<Node><Sub>UP</Sub>
<Data>27,91,65,-1,-1</Data>
</Node>
</Node>
<Node><Sub>CRL</Sub>
<Node><Sub>1</Sub>
<Data>27,112,-1,-1,-1</Data>
</Node>
<Node><Sub>2</Sub>
<Data>27,113,-1,-1,-1</Data>
</Node>
<Node><Sub>3</Sub>
<Data>27,114,-1,-1,-1</Data>
</Node>
<Node><Sub>4</Sub>
<Data>27,115,-1,-1,-1</Data>
</Node>
<Node><Sub>5</Sub>
<Data>27,116,-1,-1,-1</Data>
</Node>
<Node><Sub>6</Sub>
<Data>27,117,-1,-1,-1</Data>
</Node>
<Node><Sub>7</Sub>
<Data>27,118,-1,-1,-1</Data>
</Node>
<Node><Sub>8</Sub>
<Data>27,119,-1,-1,-1</Data>
</Node>
<Node><Sub>9</Sub>
<Data>27,120,-1,-1,-1</Data>
</Node>
<Node><Sub>10</Sub>
<Data>27,121,-1,-1,-1</Data>
</Node>
<Node><Sub>BCSP</Sub>
<Data>127,-1,-1,-1,-1</Data>
</Node>
</Node>
<Node><Sub>SFT</Sub>
<Node><Sub>1</Sub>
<Data>27,91,80,-1,-1</Data>
</Node>
<Node><Sub>2</Sub>
<Data>27,91,81,-1,-1</Data>
</Node>
<Node><Sub>3</Sub>
<Data>27,91,82,-1,-1</Data>
</Node>
<Node><Sub>4</Sub>
<Data>27,91,83,-1,-1</Data>
</Node>
<Node><Sub>5</Sub>
<Data>27,91,84,-1,-1</Data>
</Node>
<Node><Sub>6</Sub>
<Data>27,91,85,-1,-1</Data>
</Node>
<Node><Sub>7</Sub>
<Data>27,91,86,-1,-1</Data>
</Node>
<Node><Sub>8</Sub>
<Data>27,91,87,-1,-1</Data>
</Node>
<Node><Sub>9</Sub>
<Data>27,91,88,-1,-1</Data>
</Node>
<Node><Sub>10</Sub>
<Data>27,91,89,-1,-1</Data>
</Node>
<Node><Sub>BCSP</Sub>
<Data>8,-1,-1,-1,-1</Data>
</Node>
<Node><Sub>DL</Sub>
<Data>127,-1,-1,-1,-1</Data>
</Node>
<Node><Sub>DN</Sub>
<Data>27,91,66,-1,-1</Data>
</Node>
<Node><Sub>EN</Sub>
<Data>0,79,-1,-1,-1</Data>
</Node>
<Node><Sub>HM</Sub>
<Data>0,71,-1,-1,-1</Data>
</Node>
<Node><Sub>IN</Sub>
<Data>0,82,-1,-1,-1</Data>
</Node>
<Node><Sub>LT</Sub>
<Data>27,91,68,-1,-1</Data>
</Node>
<Node><Sub>PD</Sub>
<Data>0,81,-1,-1,-1</Data>
</Node>
<Node><Sub>PU</Sub>
<Data>0,73,-1,-1,-1</Data>
</Node>
<Node><Sub>RT</Sub>
<Data>27,91,67,-1,-1</Data>
</Node>
<Node><Sub>UP</Sub>
<Data>27,91,65,-1,-1</Data>
</Node>
</Node>
</Node>
</Node>
</Global>


<Global>
<Node><Sub>^%ZAPM.ed.BSS</Sub>
<Data>BaSe MsW @%BS-СИСТЕМНЫЙ РАЗДЕЛ (ТАБЛИЧНЫЙ ПРОЦЕССОР) ;)@@</Data>
<Node><Sub>ALINS</Sub>
<Data>ШАБЛОН ДЛЯ СБОРНЫХ МИКРОЗАПРОСОВ@@@@@1@1@1@1@22@80@@@@1@@1@@2,1@1@@@@@@@@2@2@@2;6;30;45@@@@@@</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@2@30@@@@@1@2;6;30;43@@@@@Текст в бокови-не сводки</Data>
</Node>
<Node><Sub>2</Sub>
<Data><![CDATA[1@31@2@49@@@@@1@2;6;30;43@@@@@  Формулы $$TSVV для сводки в формате:$$TSVV("k2=1234")                                           или :k2=1234@]]></Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@30@@@@@1@2;6;30;46@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@31@1@49@@@@@1@2;6;30;42@@@@@@</Data>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>65813,80565,m</Data>
</Node>
<Node><Sub>PRN</Sub>
<Data>1#0#0#0#1#1#0</Data>
</Node>
<Node><Sub>STA</Sub>
<Data>2,1@2@1@13@-1@-1@3@1@</Data>
</Node>
</Node>
<Node><Sub>ALTF</Sub>
<Data><![CDATA[ТАБЛИЦА КОРРЕКЦИИ ТЕКУЩЕГО БЛОКА МЕНЮ !!!@@@@@@1@4@10@19@39@1@@1@1@@1@@1,2@1@@@@@1@@@9@2@@1;6;34;44@@@@@@@2]]></Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@2@15@@@@@1@@@@@@ ТЕКСТ БЛОКА</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@16@2@15@@@@@1@2;6;37;44@@@@@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>3@1@2@15@@@@@1@@@@@@    ИНДЕКС       help-СТРОКИ@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@16@2@15@@@@@1@2;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>5@1@2@15@@@@@1@@@@@@  help-СТРОКА@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>5@16@2@15@@@@@1@2;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>7@1@2@15@@@@@1@@@@@@ HELP-ТЕКСТ F1     (РАЗДЕЛ)@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>7@16@2@15@@@@@1@2;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>9@1@2@15@@@@@1@@@@@@ HELP-ТЕКСТ F1     (ТАБЛИЦА)@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>9@16@2@15@@@@@1@2;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>11@1@2@15@@@@@1@@@@@@ %GO - ССЫЛКА@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>11@16@2@15@@@@@1@2;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>13@1@2@15@@@@@1@@@@@@ КОМАНДА,ВЫПОЛНЯЕМАЯ ПО XECUTE@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>13@16@2@15@@@@@1@2;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>1</Sub>
<Data>15@1@1@15@@@@@1@@@@@@ССЫЛКА МАССИВА@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>15@16@1@15@@@@@1@2;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>1</Sub>
<Data>16@1@1@15@@@@@1@@@@@@   !!!!!!@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>16@16@1@15@@@@@1@2;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>STA</Sub>
<Data>9,2@1@2@13@-1@-1@19@25@</Data>
</Node>
</Node>
<Node><Sub>ALTF2</Sub>
<Data><![CDATA[БЛОК-МЕНЮ %BS@@@@@1@1@1@1@22@80@1@@1@1@@1@@@1@@@@@@@@1@9@@1;6;33;43@@@@@@@@^%ZAPM.ed.BSHLP("HELP-ALTF2")]]></Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@10@@@@@1@@@@@1,1@М-ЗАПРОСЫ Вход в таблицу сформированную вами из разных микрозапросов@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@11@1@10@@@@@1@@@@@1,2@АНАЛИТИКА Вход в комплекс &quot;Аналитические Формы&quot;@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>1@21@1@10@@@@@1@@@@@1,3@NAME Регистрация под Другим именем пользователя</Data>
</Node>
<Node><Sub>4</Sub>
<Data>1@31@1@10@@@@@1@@@@@^%ZAPM.ed.BSS(&quot;ARM&quot;)@ARM Список автоматизиpованных pабочих мест %BS@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>1@41@1@10@@@@@1@@@@@1,5@DDR  Диспетчеp ввода инфоpмации в базы данных</Data>
</Node>
<Node><Sub>6</Sub>
<Data>1@51@1@10@@@@@1@@@@@1,6@OUT Вывод информации в формализованном виде (&quot;СТАРЫЙ формат ПФЛ&quot;)@@@@</Data>
</Node>
<Node><Sub>7</Sub>
<Data>1@61@1@10@@@@@1@@@@@1,7@ПАРОЛЬ Сменить пароль@@@@</Data>
</Node>
<Node><Sub>8</Sub>
<Data>1@71@1@10@@@@@1@@@@@1,8@КОМЕНТ Смена коментария в ИМЕНИ пользователя@@@@</Data>
</Node>
<Node><Sub>9</Sub>
<Data>1@81@1@10@@@@@1@@@@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>AF2</Sub>
<Data>^%ZAPM.ed.BSS,ALTF2</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data><![CDATA[ М-ЗАПРОСЫ АНАЛИТИКА NAME ARM DDR OUT ПАРОЛЬ КОМЕНТ @6@ @0@BLo,"AF2",911@D ^%ZAPM.ed.BSGLOB;D AF^%ZAPM.ed.BSF7;D CHNAME^%ZAPM.ed.BSF7;S IYI="^%ZAPM.ed.BSS(""ARM"")" D NEB^%ZAPM.ed.BSN;D DDR^%ZAPM.ed.BSF7;D ^%ZAPM.ed.BSTABE1;D CHANGE^%ZAPM.ed.BSF12(0);D CHANGE^%ZAPM.ed.BSF12(1)@]]></Data>
</Node>
</Node>
<Node><Sub>911</Sub>
<Node><Sub>1</Sub>
<Data>Вход в таблицу сформированную вами из разных микрозапросов</Data>
</Node>
<Node><Sub>2</Sub>
<Data>Вход в комплекс &quot;Аналитические Формы&quot;</Data>
</Node>
<Node><Sub>3</Sub>
<Data>Регистрация под Другим именем пользователя</Data>
</Node>
<Node><Sub>4</Sub>
<Data>Список автоматизиpованных pабочих мест %BS</Data>
</Node>
<Node><Sub>5</Sub>
<Data> Диспетчеp ввода инфоpмации в базы данных</Data>
</Node>
<Node><Sub>6</Sub>
<Data>Вывод информации в формализованном виде (&quot;СТАРЫЙ формат ПФЛ&quot;)</Data>
</Node>
<Node><Sub>7</Sub>
<Data>Сменить пароль</Data>
</Node>
<Node><Sub>8</Sub>
<Data>Смена коментария в ИМЕНИ пользователя</Data>
</Node>
</Node>
</Node>
<Node><Sub>AFG</Sub>
<Node><Sub>1</Sub>
<Data>^%ZAPM.ed.BSS,ALTF2</Data>
</Node>
<Node><Sub>2</Sub>
<Data>^%ZAPM.ed.BSS,ALTF2</Data>
</Node>
</Node>
<Node><Sub>CMD</Sub>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>D ^%ZAPM.ed.BSGLOB</Data>
</Node>
<Node><Sub>2</Sub>
<Data>D AF^%ZAPM.ed.BSF7</Data>
</Node>
<Node><Sub>3</Sub>
<Data>D CHNAME^%ZAPM.ed.BSF7</Data>
</Node>
<Node><Sub>5</Sub>
<Data>D DDR^%ZAPM.ed.BSF7</Data>
</Node>
<Node><Sub>6</Sub>
<Data>D ^%ZAPM.ed.BSTABE1</Data>
</Node>
<Node><Sub>7</Sub>
<Data>D CHANGE^%ZAPM.ed.BSF12(0)</Data>
</Node>
<Node><Sub>8</Sub>
<Data>D CHANGE^%ZAPM.ed.BSF12(1)</Data>
</Node>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>58054,51152,MS</Data>
</Node>
<Node><Sub>STA</Sub>
<Data>1,1@1@1@13@-1@-1@1@1@М-ЗАПРОСЫ Вход в таблицу сформированную вами из разных микрозапросов</Data>
</Node>
</Node>
<Node><Sub>APPLIC</Sub>
<Data>ИНСТАЛЛЯЦИЯ ПРИЛОЖЕНИЯ@@@@@1@1@4@2@18@79@@@@@@1@@@1@@@@@@@@14@5@@1;6;35;44@@@@@@@1@@@@@1</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@3@1@@@0@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@4@1@56@1@@@@1@2;6;37;44@@@@@И н с т а л л я ц и я   П р и л о ж е н и я  д л я  %BS@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>1@60@1@3@1@@@@1@2;6;37;44@@@@@Ver@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>1@63@1@13@1@@@0@1@2;6;37;44@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>1@76@1@3@1@@@@1@2;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@3@1@@@@1@2;6;37;44@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>2@4@1@56@1@@@@1@2;6;37;44@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>2@60@1@3@1@@@@1@2;6;37;44@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>2@63@1@13@1@@@@1@2;6;37;44@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>2@76@1@3@1@@@@1@2;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>3@1@2@3@1@@@0@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@4@2@56@1@@@0@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>3@60@2@3@1@@@@1@2;6;37;44@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>3@63@2@13@1@@@0@1@2;6;37;44@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>3@76@2@3@1@@@@1@2;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>5@1@1@3@1@@@0@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>5@4@1@56@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>5@60@1@3@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>5@63@1@13@1@@@@1@1;6;37;44@@@@@  кип,том@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>5@76@1@3@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>6@1@1@3@1@@@0@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>6@4@1@56@1@@@@1@2;6;37;44@@@@@Укажите куда устанавливать приложение ..................@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>6@60@1@3@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>6@63@1@13@@@1@0@1@2;6;30;46@@@@@ Ошибка: &lt;FUNCTION&gt;CAL+2^%ZAPM.ed.BSF3@0</Data>
</Node>
<Node><Sub>5</Sub>
<Data>6@76@1@3@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>7@1@1@3@1@@@0@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>7@4@1@56@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>7@60@1@3@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>7@63@1@13@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>7@76@1@3@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>8@1@1@3@1@@@0@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>8@4@1@56@1@@@0@1@2;6;37;44@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>8@60@1@3@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>8@63@1@13@@@@5,4@1@2;6;30;46@@@@@@5,4</Data>
</Node>
<Node><Sub>5</Sub>
<Data>8@76@1@3@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>1</Sub>
<Data>9@1@1@3@1@@@0@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>9@4@1@56@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>9@60@1@3@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>9@63@1@13@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>9@76@1@3@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>1</Sub>
<Data>10@1@1@3@1@@@0@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>10@4@1@56@1@@@0@1@2;6;37;44@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>10@60@1@3@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>10@63@1@13@@@@5,4@1@2;6;30;46@@@@@@5,4</Data>
</Node>
<Node><Sub>5</Sub>
<Data>10@76@1@3@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>1</Sub>
<Data>11@1@1@3@1@@@0@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>11@4@1@56@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>11@60@1@3@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>11@63@1@13@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>11@76@1@3@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>11</Sub>
<Node><Sub>1</Sub>
<Data>12@1@1@3@1@@@0@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>12@4@1@56@1@@@0@1@2;6;37;44@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>12@60@1@3@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>12@63@1@13@@@@5,4@1@2;6;30;46@@@@@@5,4</Data>
</Node>
<Node><Sub>5</Sub>
<Data>12@76@1@3@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>12</Sub>
<Node><Sub>1</Sub>
<Data>13@1@1@3@1@@@0@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>13@4@1@56@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>13@60@1@3@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>13@63@1@13@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>13@76@1@3@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>13</Sub>
<Node><Sub>1</Sub>
<Data>14@1@1@3@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>14@4@1@56@1@@@@1@2;6;37;44@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>14@60@1@3@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>14@63@1@13@1@@@5,4@1@2;6;37;44@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>14@76@1@3@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>14</Sub>
<Node><Sub>1</Sub>
<Data>15@1@1@3@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>15@4@1@56@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>15@60@1@3@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>15@63@1@13@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>15@76@1@3@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>FCL</Sub>
<Node><Sub>5</Sub>
<Node><Sub>4</Sub>
<Data>S d1=$zu(0)</Data>
<Node><Sub>1</Sub>
<Data>$zu(0)</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>FTR</Sub>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Data>S d1=&quot; &quot;_$g(^%ZAPM.ed.BS)</Data>
<Node><Sub>1</Sub>
<Data>&quot; &quot;_$g(^%ZAPM.ed.BS)</Data>
</Node>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Data>S d1=$G(^BStranS(&quot;App&quot;,&quot;Rem&quot;),&quot;...&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$G(^BStranS(&quot;App&quot;,&quot;Rem&quot;),&quot;...&quot;)</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Data>S d1=&quot;   Создано:     &quot;_$$ESDAY^%ZAPM.ed.BSsFUNR(6,$G(^BStranS(&quot;App&quot;,&quot;Date&quot;),&quot;?&quot;))</Data>
<Node><Sub>1</Sub>
<Data>&quot;   Создано:     &quot;_$$ESDAY(6,$G(^BStranS(&quot;App&quot;,&quot;Date&quot;),&quot;?&quot;))</Data>
</Node>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Data>S d1=$G(^BStranS(&quot;App&quot;,&quot;Tra&quot;,1,1))_$TR($J(&quot;&quot;,56),&quot; &quot;,&quot;.&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$G(^BStranS(&quot;App&quot;,&quot;Tra&quot;,1,1))_$TR($J(&quot;&quot;,56),&quot; &quot;,&quot;.&quot;)</Data>
</Node>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Data>S d1=$G(^BStranS(&quot;App&quot;,&quot;Tra&quot;,2,1))_$TR($J(&quot;&quot;,56),&quot; &quot;,&quot;.&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$G(^BStranS(&quot;App&quot;,&quot;Tra&quot;,2,1))_$TR($J(&quot;&quot;,56),&quot; &quot;,&quot;.&quot;)</Data>
</Node>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>11</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Data>S d1=$G(^BStranS(&quot;App&quot;,&quot;Tra&quot;,3,1))_$TR($J(&quot;&quot;,56),&quot; &quot;,&quot;.&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$G(^BStranS(&quot;App&quot;,&quot;Tra&quot;,3,1))_$TR($J(&quot;&quot;,56),&quot; &quot;,&quot;.&quot;)</Data>
</Node>
</Node>
</Node>
<Node><Sub>12</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>RTR</Sub>
<Node><Sub>5</Sub>
<Node><Sub>4</Sub>
<Data>S d1=$$IF^%ZAPM.ed.BSsFUNR(&quot;d?3A1&quot;&quot;,&quot;&quot;3A&quot;,&quot;READ&quot;,&quot;&quot;,&quot;Введите ИМЯ КИПА и через запятую ИМЯ ТОМА&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$$IF(&quot;d?3A1&quot;&quot;,&quot;&quot;3A&quot;,&quot;READ&quot;,&quot;&quot;,&quot;Введите ИМЯ КИПА и через запятую ИМЯ ТОМА&quot;)</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>STA</Sub>
<Data>5,4@1@1@27@-1@-1@9@64@ Ошибка: &lt;FUNCTION&gt;CAL+2^%ZAPM.ed.BSF3</Data>
</Node>
</Node>
<Node><Sub>ARM</Sub>
<Data><![CDATA[БАЗА АВТОМАТИЗИРОВАННЫХ РАБОЧИХ МЕСТ@@@@@1@1@1@1@22@80@1@@1@@@2@@3,4@1@@@@@1@@@8@5@@2;6;30;46@@@@@@@@^%ZAPM.ed.BSHLP("ArmHelp")@@@@1]]></Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@1@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@2@1@30@@@@@1@@@@@@ ТАБЛИЦА АВТОМАТИЗИРОВАННЫХ РА</Data>
</Node>
<Node><Sub>3</Sub>
<Data>1@32@1@1@@@@@1@@@@@@Б</Data>
</Node>
<Node><Sub>4</Sub>
<Data>1@33@1@40@@@@0@1@2;6;30;46@@@@@ОЧИХ МЕСТ</Data>
</Node>
<Node><Sub>5</Sub>
<Data>1@73@1@1@@@@@1@@@@@@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@1@@@@@1@@@@@@=</Data>
</Node>
<Node><Sub>2</Sub>
<Data>2@2@1@30@@@@0@1@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>2@32@1@1@@@@@1@@@@@@=</Data>
</Node>
<Node><Sub>4</Sub>
<Data>2@33@1@40@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>2@73@1@1@@@@@1@@@@@@=</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@2@1@30@@@@@1@@@@@@Коментаpий к АРМу</Data>
</Node>
<Node><Sub>3</Sub>
<Data>3@32@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>4</Sub>
<Data>3@33@1@40@@@@@2@1;6;34;46@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>3@73@1@1@1@@@@1@@@@@@|</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>4@1@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>2</Sub>
<Data>4@2@1@30@@@@6,2@1@@@@@@---</Data>
</Node>
<Node><Sub>3</Sub>
<Data>4@32@1@1@@@@@1@@@@@@-</Data>
</Node>
<Node><Sub>4</Sub>
<Data>4@33@1@40@1@@@6,2@1@@@@@@-------</Data>
</Node>
<Node><Sub>5</Sub>
<Data>4@73@1@1@1@@@@1@@@@@@|</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>5@1@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>2</Sub>
<Data>5@2@1@30@@@@@1@@@@@@Cсылка АРМа(TABL,PART,UCI,SYS)</Data>
</Node>
<Node><Sub>3</Sub>
<Data>5@32@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>4</Sub>
<Data>5@33@1@40@@@@0@2@1;6;34;46@@@@5,4@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>5@73@1@1@1@@@@1@@@@@@|</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>6@1@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>2</Sub>
<Data>6@2@1@30@@@@0@1@@@@@@---</Data>
</Node>
<Node><Sub>3</Sub>
<Data>6@32@1@1@@@@@1@@@@@@-</Data>
</Node>
<Node><Sub>4</Sub>
<Data>6@33@1@40@1@@@6,2@1@@@@@@-------</Data>
</Node>
<Node><Sub>5</Sub>
<Data>6@73@1@1@1@@@@1@@@@@@|</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>7@1@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>2</Sub>
<Data>7@2@1@30@@@@@1@@@@@@Для того, чтобы Войти в АРМ -</Data>
</Node>
<Node><Sub>3</Sub>
<Data>7@32@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>4</Sub>
<Data>7@33@1@40@@@@@1@1;6;34;46@@@@7,4@... введите &lt;Enter&gt;@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>7@73@1@1@1@@@@1@@@@@@|</Data>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>1</Sub>
<Data>8@1@1@1@@@@@1@@@@@@=</Data>
</Node>
<Node><Sub>2</Sub>
<Data>8@2@1@30@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>8@32@1@1@@@@@1@@@@@@=</Data>
</Node>
<Node><Sub>4</Sub>
<Data>8@33@1@40@1@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>8@73@1@1@1@@@@1@@@@@@=</Data>
</Node>
</Node>
<Node><Sub>CMD</Sub>
<Node><Sub>5</Sub>
<Node><Sub>4</Sub>
<Data>D ATAB^%ZAPM.ed.BSTT</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>4</Sub>
<Data>D EnterAR^%ZAPM.ed.BSTT</Data>
</Node>
</Node>
</Node>
<Node><Sub>FTR</Sub>
<Node><Sub>1</Sub>
<Node><Sub>4</Sub>
<Data>S d1=&quot;ОЧИХ МЕСТ:&quot;_$G(k1,&quot;?&quot;) S date=$G(k1,0)</Data>
<Node><Sub>1</Sub>
<Data>&quot;ОЧИХ МЕСТ:&quot;_$G(k1,&quot;?&quot;) S date=$G(k1,0)</Data>
</Node>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>2</Sub>
<Data>S d1=$TR($J(&quot;&quot;,40),&quot; &quot;,&quot;=&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$TR($J(&quot;&quot;,40),&quot; &quot;,&quot;=&quot;)</Data>
</Node>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>4</Sub>
<Data>S d1=d1 S %BS(&quot;Tmp&quot;,&quot;Butt77&quot;,1)=d1</Data>
<Node><Sub>1</Sub>
<Data>d1 S %BS(&quot;Tmp&quot;,&quot;Butt77&quot;,1)=d1</Data>
</Node>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>2</Sub>
<Data>S d1=$TR($J(&quot;&quot;,40),&quot; &quot;,&quot;-&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$TR($J(&quot;&quot;,40),&quot; &quot;,&quot;-&quot;)</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>Free</Sub>
<Data>58067,77679</Data>
</Node>
<Node><Sub>KEY</Sub>
<Data>^%ZAPM.ed.BSARM</Data>
<Node><Sub>1</Sub>
<Data>!@@@§@НОВЫЙ АРМ@1,70@@@ 1-Й ИНДЕКСНЫЙ@2;6;30;42@@@@@Введите ИМЯ АРМа (до 9 букв и цыфр)@@@@@</Data>
<Node><Sub>3</Sub>
<Data>S d1=d_$TR($J(&quot;&quot;,10-$L(d)),&quot; &quot;,&quot;.&quot;)_$$A^%ZAPM.ed.BSA(3,4,&quot;ARM&quot;,&quot;%BSS&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;,$G(d,0))</Data>
</Node>
<Node><Sub>4</Sub>
<Data>d_$TR($J(&quot;&quot;,10-$L(d)),&quot; &quot;,&quot;.&quot;)_{3,4,&quot;ARM&quot;,&quot;%BSS&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;,$G(d,0)}</Data>
</Node>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>58067,77679,</Data>
</Node>
<Node><Sub>STA</Sub>
<Data>5,4@3@4@27@-1@-1@5@33@</Data>
</Node>
</Node>
<Node><Sub>ARMB</Sub>
<Data><![CDATA[ОПРЕДЕЛЕНИЕ ПАРАМЕТРОВ ЗАПУСКА АРМА@@@@@1@1@5@10@18@47@1@@1@@@1@@@1@@@@@1@@@10@3@@1;6;32;44@@@@@@@1@@@@@1]]></Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@11@1@@@@1@@@@@@Имя таблицы</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@12@1@1@1@@@@1@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>1@13@1@26@@@@@1@2;6;30;46@@@@2,3@0</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@11@1@@@@1@@@@@@Имя раздела</Data>
</Node>
<Node><Sub>2</Sub>
<Data>2@12@1@1@1@@@@1@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>2@13@1@26@@@@@1@2;6;30;46@@@@2,3@INSP</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@11@1@@@@1@@@@@@   Имя кипа</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@12@1@1@1@@@@1@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>3@13@1@26@@@@@1@2;6;30;46@@@@2,3@KID@0</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>4@1@1@11@1@@@@1@@@@@@   Имя тома</Data>
</Node>
<Node><Sub>2</Sub>
<Data>4@12@1@1@1@@@@1@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>4@13@1@26@@@@@1@2;6;30;46@@@@2,3@VOI</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>5@1@1@11@1@@@@1@@@@@@-----------</Data>
</Node>
<Node><Sub>2</Sub>
<Data>5@12@1@1@1@@@@1@@@@@@-</Data>
</Node>
<Node><Sub>3</Sub>
<Data>5@13@1@26@1@@@@1@@@@@@--------------------------</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>6@1@3@11@@@@0@1@1;6;32;44@@@@6,1@0</Data>
</Node>
<Node><Sub>2</Sub>
<Data>6@12@3@1@1@@@@1@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>6@13@3@26@1@@@@1@@@@@@Обязательно запускать     приложение из явно смонти-рованного КИП,ТОМ.</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>9@1@1@11@1@@@@1@@@@@@-----------</Data>
</Node>
<Node><Sub>2</Sub>
<Data>9@12@1@1@1@@@@1@@@@@@-</Data>
</Node>
<Node><Sub>3</Sub>
<Data>9@13@1@26@1@@@@1@@@@@@--------------------------</Data>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>1</Sub>
<Data>10@1@2@11@1@@@@1@@@@@@ Программа    запуска</Data>
</Node>
<Node><Sub>2</Sub>
<Data>10@12@2@1@1@@@@1@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>10@13@2@26@@@@@1@2;6;30;46@@@@8,3@</Data>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>1</Sub>
<Data>12@1@1@11@1@@@@1@@@@@@-----------</Data>
</Node>
<Node><Sub>2</Sub>
<Data>12@12@1@1@1@@@@1@@@@@@-</Data>
</Node>
<Node><Sub>3</Sub>
<Data>12@13@1@26@1@@@@1@@@@@@--------------------------</Data>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>1</Sub>
<Data>13@1@2@11@@@@0@1@1;6;32;44@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>13@12@2@1@1@@@@1@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>13@13@2@26@@@1@0@1@1;6;32;44@@@@@0,INSP,KID,VOI-0-</Data>
</Node>
</Node>
<Node><Sub>CMD</Sub>
<Node><Sub>2</Sub>
<Node><Sub>3</Sub>
<Data>D ^%ZAPM.ed.BSD S li=$G(%File),ls=&quot;Запомните (CTRL-L) Ссылку на таблицу&quot; D LE^%ZAPM.ed.BSTT</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>D ABUT^%ZAPM.ed.BSTT</Data>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>3</Sub>
<Data>D ABUTZ^%ZAPM.ed.BSTT</Data>
</Node>
</Node>
</Node>
<Node><Sub>FCL</Sub>
<Node><Sub>10</Sub>
<Node><Sub>3</Sub>
<Data><![CDATA[S d1=$$A^%ZAPM.ed.BSA(1,3)_","_$$A^%ZAPM.ed.BSA(2,3)_","_$$A^%ZAPM.ed.BSA(3,3)_","_$$A^%ZAPM.ed.BSA(4,3)_"-"_$$A^%ZAPM.ed.BSA(6,1)_"-"_$$A^%ZAPM.ed.BSA(8,3)]]></Data>
<Node><Sub>1</Sub>
<Data>{1,3}_&quot;,&quot;_{2,3}_&quot;,&quot;_{3,3}_&quot;,&quot;_{4,3}_&quot;-&quot;_{6,1}_&quot;-&quot;_{8,3}</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>FTR</Sub>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$Butt^%ZAPM.ed.BSsFUNM($S($$A^%ZAPM.ed.BSA(6,1)=1:&quot;    ДА&quot;,1:&quot;    НЕТ&quot;))</Data>
<Node><Sub>1</Sub>
<Data>$$Butt($S({6,1}=1:&quot;    ДА&quot;,1:&quot;    НЕТ&quot;))</Data>
</Node>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$Butt^%ZAPM.ed.BSsFUNM(&quot;  ОТМЕНА&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$$Butt(&quot;  ОТМЕНА&quot;)</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Data>S d1=$$Butt^%ZAPM.ed.BSsFUNM(&quot;   ЗАПОМНИТЬ ПАРАМЕТРЫ&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$$Butt(&quot;   ЗАПОМНИТЬ ПАРАМЕТРЫ&quot;)</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>RTR</Sub>
<Node><Sub>3</Sub>
<Node><Sub>3</Sub>
<Data>S d1=$P($P($G(%BS(&quot;Tmp&quot;,&quot;Butt77&quot;,1)),&quot;-&quot;,1),&quot;,&quot;,4)</Data>
<Node><Sub>1</Sub>
<Data>$P($P($G(%BS(&quot;Tmp&quot;,&quot;Butt77&quot;,1)),&quot;-&quot;,1),&quot;,&quot;,4)</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>STA</Sub>
<Data>10,3@1@1@27@-1@-1@10@10@0,INSP,KID,VOI-0-</Data>
</Node>
</Node>
<Node><Sub>CLR</Sub>
<Data>ВСЕ ЦВЕТА@@@@@@1@10@10@17@73@1@@1@@@1@@@1@@@@@@@@8@16@@@@@@@@@2</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@4@@@@0@1@2;6;30;40@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@5@1@4@@@@1,1@1@2;6;30;41@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>3</Sub>
<Data>1@9@1@4@@@@1,1@1@2;6;30;42@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>4</Sub>
<Data>1@13@1@4@@@@1,1@1@2;6;30;43@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>5</Sub>
<Data>1@17@1@4@@@@1,1@1@2;6;30;44@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>6</Sub>
<Data>1@21@1@4@@@@1,1@1@2;6;30;45@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>7</Sub>
<Data>1@25@1@4@@@@1,1@1@2;6;30;46@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>8</Sub>
<Data>1@29@1@4@@@@1,1@1@2;6;30;47@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>9</Sub>
<Data>1@33@1@4@@@@1,1@1@1;6;30;40@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>10</Sub>
<Data>1@37@1@4@@@@1,1@1@1;6;30;41@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>11</Sub>
<Data>1@41@1@4@@@@1,1@1@1;6;30;42@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>12</Sub>
<Data>1@45@1@4@@@@1,1@1@1;6;30;43@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>13</Sub>
<Data>1@49@1@4@@@@1,1@1@1;6;30;44@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>14</Sub>
<Data>1@53@1@4@@@@1,1@1@1;6;30;45@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>15</Sub>
<Data>1@57@1@4@@@@1,1@1@1;6;30;46@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>16</Sub>
<Data>1@61@1@4@@@@1,1@1@1;6;30;47@@@@@ &lt;&gt; </Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@4@@@@1,1@1@2;6;31;40@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>2</Sub>
<Data>2@5@1@4@@@@1,1@1@2;6;31;41@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>3</Sub>
<Data>2@9@1@4@@@@1,1@1@2;6;31;42@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>4</Sub>
<Data>2@13@1@4@@@@1,1@1@2;6;31;43@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>5</Sub>
<Data>2@17@1@4@@@@1,1@1@2;6;31;44@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>6</Sub>
<Data>2@21@1@4@@@@1,1@1@2;6;31;45@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>7</Sub>
<Data>2@25@1@4@@@@1,1@1@2;6;31;46@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>8</Sub>
<Data>2@29@1@4@@@@1,1@1@2;6;31;47@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>9</Sub>
<Data>2@33@1@4@@@@1,1@1@1;6;31;40@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>10</Sub>
<Data>2@37@1@4@@@@1,1@1@1;6;31;41@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>11</Sub>
<Data>2@41@1@4@@@@1,1@1@1;6;31;42@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>12</Sub>
<Data>2@45@1@4@@@@1,1@1@1;6;31;43@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>13</Sub>
<Data>2@49@1@4@@@@1,1@1@1;6;31;44@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>14</Sub>
<Data>2@53@1@4@@@@1,1@1@1;6;31;45@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>15</Sub>
<Data>2@57@1@4@@@@1,1@1@1;6;31;46@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>16</Sub>
<Data>2@61@1@4@@@@1,1@1@1;6;31;47@@@@@ &lt;&gt; </Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@4@@@@1,1@1@2;6;32;40@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@5@1@4@@@@1,1@1@2;6;32;41@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>3</Sub>
<Data>3@9@1@4@@@@1,1@1@2;6;32;42@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>4</Sub>
<Data>3@13@1@4@@@@1,1@1@2;6;32;43@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>5</Sub>
<Data>3@17@1@4@@@@1,1@1@2;6;32;44@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>6</Sub>
<Data>3@21@1@4@@@@1,1@1@2;6;32;45@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>7</Sub>
<Data>3@25@1@4@@@@1,1@1@2;6;32;46@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>8</Sub>
<Data>3@29@1@4@@@@1,1@1@2;6;32;47@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>9</Sub>
<Data>3@33@1@4@@@@1,1@1@1;6;32;40@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>10</Sub>
<Data>3@37@1@4@@@@1,1@1@1;6;32;41@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>11</Sub>
<Data>3@41@1@4@@@@1,1@1@1;6;32;42@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>12</Sub>
<Data>3@45@1@4@@@@1,1@1@1;6;32;43@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>13</Sub>
<Data>3@49@1@4@@@@1,1@1@1;6;32;44@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>14</Sub>
<Data>3@53@1@4@@@@1,1@1@1;6;32;45@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>15</Sub>
<Data>3@57@1@4@@@@1,1@1@1;6;32;46@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>16</Sub>
<Data>3@61@1@4@@@@1,1@1@1;6;32;47@@@@@ &lt;&gt; </Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>4@1@1@4@@@@1,1@1@2;6;33;40@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>2</Sub>
<Data>4@5@1@4@@@@1,1@1@2;6;33;41@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>3</Sub>
<Data>4@9@1@4@@@@1,1@1@2;6;33;42@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>4</Sub>
<Data>4@13@1@4@@@@1,1@1@2;6;33;43@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>5</Sub>
<Data>4@17@1@4@@@@1,1@1@2;6;33;44@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>6</Sub>
<Data>4@21@1@4@@@@1,1@1@2;6;33;45@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>7</Sub>
<Data>4@25@1@4@@@@1,1@1@2;6;33;46@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>8</Sub>
<Data>4@29@1@4@@@@1,1@1@2;6;33;47@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>9</Sub>
<Data>4@33@1@4@@@@1,1@1@2;6;33;40@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>10</Sub>
<Data>4@37@1@4@@@@1,1@1@2;6;30;41@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>11</Sub>
<Data>4@41@1@4@@@@1,1@1@2;6;30;42@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>12</Sub>
<Data>4@45@1@4@@@@1,1@1@1;6;33;43@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>13</Sub>
<Data>4@49@1@4@@@@1,1@1@2;6;37;44@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>14</Sub>
<Data>4@53@1@4@@@@1,1@1@2;6;30;45@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>15</Sub>
<Data>4@57@1@4@@@@1,1@1@2;6;30;46@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>16</Sub>
<Data>4@61@1@4@@@@1,1@1@1;6;33;47@@@@@ &lt;&gt; </Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>5@1@1@4@@@@1,1@1@2;6;34;40@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>2</Sub>
<Data>5@5@1@4@@@@1,1@1@2;6;34;41@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>3</Sub>
<Data>5@9@1@4@@@@1,1@1@2;6;34;42@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>4</Sub>
<Data>5@13@1@4@@@@1,1@1@2;6;34;43@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>5</Sub>
<Data>5@17@1@4@@@@1,1@1@2;6;34;44@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>6</Sub>
<Data>5@21@1@4@@@@1,1@1@2;6;34;45@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>7</Sub>
<Data>5@25@1@4@@@@1,1@1@2;6;34;46@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>8</Sub>
<Data>5@29@1@4@@@@1,1@1@2;6;34;47@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>9</Sub>
<Data>5@33@1@4@@@@1,1@1@1;6;34;40@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>10</Sub>
<Data>5@37@1@4@@@@1,1@1@1;6;34;41@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>11</Sub>
<Data>5@41@1@4@@@@1,1@1@1;6;34;42@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>12</Sub>
<Data>5@45@1@4@@@@1,1@1@1;6;34;43@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>13</Sub>
<Data>5@49@1@4@@@@1,1@1@1;6;34;44@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>14</Sub>
<Data>5@53@1@4@@@@1,1@1@1;6;34;45@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>15</Sub>
<Data>5@57@1@4@@@@1,1@1@1;6;34;46@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>16</Sub>
<Data>5@61@1@4@@@@1,1@1@1;6;34;47@@@@@ &lt;&gt; </Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>6@1@1@4@@@@1,1@1@2;6;35;40@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>2</Sub>
<Data>6@5@1@4@@@@1,1@1@2;6;35;41@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>3</Sub>
<Data>6@9@1@4@@@@1,1@1@2;6;35;42@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>4</Sub>
<Data>6@13@1@4@@@@1,1@1@2;6;35;43@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>5</Sub>
<Data>6@17@1@4@@@@1,1@1@2;6;35;44@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>6</Sub>
<Data>6@21@1@4@@@@1,1@1@2;6;35;45@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>7</Sub>
<Data>6@25@1@4@@@@1,1@1@2;6;35;46@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>8</Sub>
<Data>6@29@1@4@@@@1,1@1@2;6;35;47@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>9</Sub>
<Data>6@33@1@4@@@@1,1@1@1;6;35;40@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>10</Sub>
<Data>6@37@1@4@@@@1,1@1@1;6;35;41@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>11</Sub>
<Data>6@41@1@4@@@@1,1@1@1;6;35;42@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>12</Sub>
<Data>6@45@1@4@@@@1,1@1@1;6;35;43@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>13</Sub>
<Data>6@49@1@4@@@@1,1@1@1;6;35;44@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>14</Sub>
<Data>6@53@1@4@@@@1,1@1@1;6;35;45@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>15</Sub>
<Data>6@57@1@4@@@@1,1@1@1;6;35;46@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>16</Sub>
<Data>6@61@1@4@@@@1,1@1@1;6;35;47@@@@@ &lt;&gt; </Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>7@1@1@4@@@@1,1@1@2;6;36;40@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>2</Sub>
<Data>7@5@1@4@@@@1,1@1@2;6;36;41@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>3</Sub>
<Data>7@9@1@4@@@@1,1@1@2;6;36;42@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>4</Sub>
<Data>7@13@1@4@@@@1,1@1@2;6;36;43@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>5</Sub>
<Data>7@17@1@4@@@@1,1@1@2;6;36;44@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>6</Sub>
<Data>7@21@1@4@@@@1,1@1@2;6;36;45@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>7</Sub>
<Data>7@25@1@4@@@@1,1@1@2;6;36;46@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>8</Sub>
<Data>7@29@1@4@@@@1,1@1@2;6;36;47@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>9</Sub>
<Data>7@33@1@4@@@@1,1@1@1;6;36;40@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>10</Sub>
<Data>7@37@1@4@@@@1,1@1@1;6;36;41@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>11</Sub>
<Data>7@41@1@4@@@@1,1@1@1;6;36;42@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>12</Sub>
<Data>7@45@1@4@@@@1,1@1@1;6;36;43@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>13</Sub>
<Data>7@49@1@4@@@@1,1@1@1;6;37;44@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>14</Sub>
<Data>7@53@1@4@@@@1,1@1@2;6;30;45@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>15</Sub>
<Data>7@57@1@4@@@@1,1@1@1;6;36;46@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>16</Sub>
<Data>7@61@1@4@@@@1,1@1@1;6;36;47@@@@@ &lt;&gt; </Data>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>1</Sub>
<Data>8@1@1@4@@@@1,1@1@2;6;37;40@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>2</Sub>
<Data>8@5@1@4@@@@1,1@1@2;6;37;41@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>3</Sub>
<Data>8@9@1@4@@@@1,1@1@2;6;37;42@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>4</Sub>
<Data>8@13@1@4@@@@1,1@1@2;6;37;43@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>5</Sub>
<Data>8@17@1@4@@@@1,1@1@2;6;37;44@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>6</Sub>
<Data>8@21@1@4@@@@1,1@1@2;6;37;45@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>7</Sub>
<Data>8@25@1@4@@@@1,1@1@2;6;37;46@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>8</Sub>
<Data>8@29@1@4@@@@1,1@1@2;6;37;47@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>9</Sub>
<Data>8@33@1@4@@@@1,1@1@1;6;37;40@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>10</Sub>
<Data>8@37@1@4@@@@1,1@1@1;6;37;41@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>11</Sub>
<Data>8@41@1@4@@@@1,1@1@1;6;37;42@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>12</Sub>
<Data>8@45@1@4@@@@1,1@1@1;6;37;43@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>13</Sub>
<Data>8@49@1@4@@@@1,1@1@1;6;37;44@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>14</Sub>
<Data>8@53@1@4@@@@1,1@1@1;6;37;45@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>15</Sub>
<Data>8@57@1@4@@@@1,1@1@2;6;30;46@@@@@ &lt;&gt; </Data>
</Node>
<Node><Sub>16</Sub>
<Data>8@61@1@4@@@@1,1@1@1;6;37;47@@@@@ &lt;&gt; </Data>
</Node>
</Node>
<Node><Sub>FTR</Sub>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data><![CDATA[S d1=d I $D(MR) W /CUP(19,15),$$atr^%ZAPM.ed.BS3($P(BS,"@",10))," Выберите цвет и нажмите <Enter>, - иначе <Esc> ",$P(BS,"@",10)," ",$$atr^%ZAPM.ed.BS3($S('MR:CLR,1:$P(%BS,"!",$S($P(BS,"@",12):1,1:2))))]]></Data>
<Node><Sub>1</Sub>
<Data><![CDATA[d I $D(MR) W /CUP(19,15),$$atr^%ZAPM.ed.BS3($P(BS,"@",10))," Выберите цвет и нажмите <Enter>, - иначе <Esc> ",$P(BS,"@",10)," ",$$atr^%ZAPM.ed.BS3($S('MR:CLR,1:$P(%BS,"!",$S($P(BS,"@",12):1,1:2))))]]></Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>57762,64283,</Data>
</Node>
<Node><Sub>STA</Sub>
<Data>8,2@1@1@27@-1@-1@17@14@ &lt;&gt; </Data>
</Node>
</Node>
<Node><Sub>CMD</Sub>
<Data><![CDATA[КОМАНДЕР %BS ПО <ALT-F10>@@@@@1@1@1@1@22@80@1@@1@1@@2@@1,2@1@@@@@@@@3@2@@2;6;30;46@@@@@@@@@@@@@@@@@@1]]></Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@15@@@@@1@@@@@@  КОМЕНТАРИЙ:</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@16@1@55@@@@@2@2;6;30;46@@@@@@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@15@@@@@1@@@@@@ КОМАНДА MSM:</Data>
</Node>
<Node><Sub>2</Sub>
<Data>2@16@1@55@@@@@2@2;6;30;46@@@@@@@@c</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@15@@@@@1@@@@@@Запоминать ?@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@16@1@55@@@@0@2@2;6;30;46@@@@@@@@S</Data>
</Node>
</Node>
<Node><Sub>FTR</Sub>
<Node><Sub>3</Sub>
<Node><Sub>2</Sub>
<Data>S d1=$S(d&apos;=&quot;&quot;:&quot;NO&quot;,1:&quot;YES&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$S(d&apos;=&quot;&quot;:&quot;NO&quot;,1:&quot;YES&quot;)</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>Free</Sub>
<Data>59962,49325</Data>
</Node>
<Node><Sub>KEY</Sub>
<Data>^[&quot;%SYS&quot;,&quot;&quot;]%BSCcmd</Data>
<Node><Sub>1</Sub>
<Data>@@@@НОВАЯ КОМАНДА@1,70@@@ 1-Й ИНДЕКСНЫЙ@2;6;30;42@@@@@Введите Команду вызова@@@@@</Data>
<Node><Sub>3</Sub>
<Data>S d1=d_$TR($J(&quot;&quot;,20-$L(d)),&quot; &quot;,&quot;.&quot;)_$$A^%ZAPM.ed.BSA(1,2,&quot;CMD&quot;,&quot;^%ZAPM.ed.BSS&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;,$G(d,0))</Data>
</Node>
<Node><Sub>4</Sub>
<Data>d_$TR($J(&quot;&quot;,20-$L(d)),&quot; &quot;,&quot;.&quot;)_{1,2,&quot;CMD&quot;,&quot;^%ZAPM.ed.BSS&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;,$G(d,0)}</Data>
</Node>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>59962,49325,Styx</Data>
</Node>
<Node><Sub>STA</Sub>
<Data>2,2@1@2@13@-1@-1@2@16@</Data>
</Node>
</Node>
<Node><Sub>COLOR</Sub>
<Data>ЦВЕТОВАЯ ПАЛИТРА %BS@@@@@1@1@2@20@14@50@1@@1@@@1@@2,2@@@@@@@@@13@2@@2;6;30;45@@@@@@@2</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@25@@@@@1@2;6;30;45@@@@@  УСТАНОВКА ЦВЕТОВ КОМПЛЕ</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@26@1@6@@@@@1@2;6;30;45@@@@@КСА</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@25@@@@@1@@@@@@ УКЗАТ.НА ПОМЕЧ.КЛЕТКЕ...</Data>
</Node>
<Node><Sub>2</Sub>
<Data>2@26@1@6@@@@0@1@@@@@2,2@1;6;31;47</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@25@@@@@1@@@@@@ УКАЗАТЕЛЬ ТЕКУЩ.КЛЕТКИ..</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@26@1@6@@@@2,2@1@@@@@3,2@1;6;37;47</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>4@1@1@25@@@@@1@@@@@@ ЦВЕТ ПОМЕЧЕННОЙ КЛЕТКИ . БЛОКА.</Data>
</Node>
<Node><Sub>2</Sub>
<Data>4@26@1@6@@@@2,2@1@@@@@4,2@1;6;37;41</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>5@1@1@25@@@@@1@@@@@@ - ЗАГОЛОВОК КАТАЛОГОВ...</Data>
</Node>
<Node><Sub>2</Sub>
<Data>5@26@1@6@@@@2,2@1@@@@@5,2@2;6;30;45</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>6@1@1@25@@@@@1@@@@@@ - ТЕКСТ КАТАЛОГОВ.......@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>6@26@1@6@@@@2,2@1@@@@@6,2@2;6;30;46@</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>7@1@1@25@@@@@1@@@@@@ - РАМКА ПАНЕЛИ СООБЩЕНИЯ</Data>
</Node>
<Node><Sub>2</Sub>
<Data>7@26@1@6@@@@2,2@1@@@@@7,2@1;6;37;44</Data>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>1</Sub>
<Data>8@1@1@25@@@@@1@@@@@@ - ТЕКСТ ПАНЕЛИ СООБЩЕНИЯ</Data>
</Node>
<Node><Sub>2</Sub>
<Data>8@26@1@6@@@@2,2@1@@@@@8,2@2;6;37;44</Data>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>1</Sub>
<Data>9@1@1@25@@@@@1@@@@@@ - ОСНОВНОЙ ФОН &quot;MEНЮ&quot;...@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>9@26@1@6@@@@2,2@1@@@@@9,2@2;6;30;46@</Data>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>1</Sub>
<Data>10@1@1@25@@@@@1@@@@@@ - ЗАСВЕТКА ПУНКТА &quot;МЕНЮ&quot;@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>10@26@1@6@@@@2,2@1@@@@@10,2@2;6;30;46@</Data>
</Node>
</Node>
<Node><Sub>11</Sub>
<Node><Sub>1</Sub>
<Data>11@1@1@25@@@@@1@@@@@@ - РАМКА ПАНЕЛИ ОШИБКИ ..@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>11@26@1@6@@@@2,2@1@@@@@11,2@2;6;30;41@</Data>
</Node>
</Node>
<Node><Sub>12</Sub>
<Node><Sub>1</Sub>
<Data>12@1@1@25@@@@@1@@@@@@ - ТЕКСТ ПАНЕЛИ ОШИБКИ ..@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>12@26@1@6@@@@2,2@1@@@@@12,2@1;6;37;41@</Data>
</Node>
</Node>
<Node><Sub>13</Sub>
<Node><Sub>1</Sub>
<Data>13@1@1@25@@@@@1@@@@@@ СООБЩЕНИЕ О ТЕК.ДЕЙСТВИИ@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>13@26@1@6@@@@2,2@1@@@@@13,2@1;6;32;40@</Data>
</Node>
</Node>
<Node><Sub>CMD</Sub>
<Node><Sub>2</Sub>
<Node><Sub>2</Sub>
<Data>S li=$$Color^%ZAPM.ed.BSF1(d)</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>2</Sub>
<Data>S li=$$Color^%ZAPM.ed.BSF1(d)</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>2</Sub>
<Data>S li=$$Color^%ZAPM.ed.BSF1(d)</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>2</Sub>
<Data>S li=$$Color^%ZAPM.ed.BSF1(d)</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>2</Sub>
<Data>S li=$$Color^%ZAPM.ed.BSF1(d)</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>2</Sub>
<Data>S li=$$Color^%ZAPM.ed.BSF1(d)</Data>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>2</Sub>
<Data>S li=$$Color^%ZAPM.ed.BSF1(d)</Data>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>2</Sub>
<Data>S li=$$Color^%ZAPM.ed.BSF1(d)</Data>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>2</Sub>
<Data>S li=$$Color^%ZAPM.ed.BSF1(d)</Data>
</Node>
</Node>
<Node><Sub>11</Sub>
<Node><Sub>2</Sub>
<Data>S li=$$Color^%ZAPM.ed.BSF1(d)</Data>
</Node>
</Node>
<Node><Sub>12</Sub>
<Node><Sub>2</Sub>
<Data>S li=$$Color^%ZAPM.ed.BSF1(d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>FTR</Sub>
<Node><Sub>2</Sub>
<Node><Sub>2</Sub>
<Data><![CDATA[S d1="%COLOR" I $$COLOR^%ZAPM.ed.BSsFUNM(d)!($D(MR)) W /CUP(15,25),$$atr^%ZAPM.ed.BS3(CLR)," Выберите нужный цвет ",$$atr^%ZAPM.ed.BS3($S('MR:CLR,1:$P(%BS,"!",$S($P(BS,"@",12):1,1:2))))]]></Data>
<Node><Sub>1</Sub>
<Data><![CDATA["%COLOR" I $$COLOR(d)!($D(MR)) W /CUP(15,25),$$atr^%ZAPM.ed.BS3(CLR)," Выберите нужный цвет ",$$atr^%ZAPM.ed.BS3($S('MR:CLR,1:$P(%BS,"!",$S($P(BS,"@",12):1,1:2))))]]></Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>STA</Sub>
<Data>13,2@2@2@27@-1@-1@14@45@1;6;32;40</Data>
</Node>
</Node>
<Node><Sub>CacheServ</Sub>
<Data><![CDATA[Cache-СЕРВЕР, ЗАЩИТА ИНФОРМАЦИИ@@@@@1@1@2@15@21@67@1@@1@@@1@@2,4@1@@@@@1@@@16@5@@1;6;37;44@@@@@@@2@@@@@1]]></Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@1@1@@@@1@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@2@1@25@@@@@1@2;6;37;44@@@@@              Параметры C@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>1@27@1@1@@@@@1@2;6;37;44@@@@@a@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>1@28@1@25@@@@@1@2;6;37;44@@@@@che&apos;-Сервера@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>1@53@1@1@1@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@2@1@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>2@2@2@25@@@@@1@@@@@@Полная ссылка к глобали, последняя версия %BS@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>2@27@2@1@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>2@28@2@25@@@@@1@2;6;34;46@@@@@@@@@@^%ZAPM.ed.BSHLP(&quot;VerHigh&quot;)</Data>
</Node>
<Node><Sub>5</Sub>
<Data>2@53@2@1@1@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>4@1@1@1@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>4@2@1@25@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>4@27@1@1@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>4@28@1@25@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>4@53@1@1@1@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>5@1@2@1@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>5@2@2@25@@@@@1@@@@@@Полная ссылка к глобали, обмена сетевой информац.@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>5@27@2@1@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>5@28@2@25@@@@@1@2;6;34;46@@@@@0\^[&quot;GLAVK&quot;]BServInf@@@@@^%ZAPM.ed.BSHLP(&quot;ServInfo&quot;)</Data>
</Node>
<Node><Sub>5</Sub>
<Data>5@53@2@1@1@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>7@1@1@1@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>7@2@1@25@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>7@27@1@1@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>7@28@1@25@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>7@53@1@1@1@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>8@1@2@1@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>8@2@2@25@@@@@1@@@@@@Параметры секретного уда-ления обьектов %BS@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>8@27@2@1@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>8@28@2@25@@@@@1@2;6;34;46@@@@@N\N\N\Y@@@@@^%ZAPM.ed.BSHLP(&quot;SecDel&quot;)</Data>
</Node>
<Node><Sub>5</Sub>
<Data>8@53@2@1@1@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>10@1@1@1@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>10@2@1@25@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>10@27@1@1@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>10@28@1@25@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>10@53@1@1@1@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>1</Sub>
<Data>11@1@1@1@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>11@2@1@25@@@@@1@@@@@@Сетевой Буфер вывода@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>11@27@1@1@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>11@28@1@25@@@@@1@2;6;34;46@@@@@^[&quot;GLAVK&quot;]%BSbufS@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>11@53@1@1@1@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>1</Sub>
<Data>12@1@1@1@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>12@2@1@25@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>12@27@1@1@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>12@28@1@25@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>12@53@1@1@1@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>1</Sub>
<Data>13@1@2@1@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>13@2@2@25@@@@@1@@@@@@Директория запасного ко- пирования масс.и программ@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>13@27@2@1@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>13@28@2@25@@@@@1@2;6;34;46@@@@@C:\!\@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>13@53@2@1@1@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>11</Sub>
<Node><Sub>1</Sub>
<Data>15@1@1@1@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>15@2@1@25@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>15@27@1@1@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>15@28@1@25@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>15@53@1@1@1@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>12</Sub>
<Node><Sub>1</Sub>
<Data>16@1@1@1@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>16@2@1@25@@@@@1@@@@@@Таблица общих переменных @</Data>
</Node>
<Node><Sub>3</Sub>
<Data>16@27@1@1@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>16@28@1@25@@@@@1@2;6;34;46@@@@@^[&quot;GLAVK&quot;]SRV(&quot;Variables&quot;)@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>16@53@1@1@1@@@@1@@@@@@</Data>
</Node>
</Node>
<Node><Sub>13</Sub>
<Node><Sub>1</Sub>
<Data>17@1@1@1@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>17@2@1@25@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>17@27@1@1@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>17@28@1@25@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>17@53@1@1@1@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>14</Sub>
<Node><Sub>1</Sub>
<Data>18@1@1@1@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>18@2@1@25@@@@@1@@@@@@Стартовый № терминалов@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>18@27@1@1@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>18@28@1@25@@@@@1@2;6;34;46@@@@@8@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>18@53@1@1@1@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>15</Sub>
<Node><Sub>1</Sub>
<Data>19@1@1@1@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>19@2@1@25@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>19@27@1@1@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>19@28@1@25@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>19@53@1@1@1@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>16</Sub>
<Node><Sub>1</Sub>
<Data>20@1@1@1@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>20@2@1@25@@@@@1@@@@@@Имя Вашего WEB СЕРВЕРА@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>20@27@1@1@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>20@28@1@25@@@@@1@2;6;34;46@@@@@CacheServer@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>20@53@1@1@1@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>57772,43697,</Data>
</Node>
<Node><Sub>OPT</Sub>
<Data>2,4,2</Data>
</Node>
<Node><Sub>STA</Sub>
<Data>12,4@2@4@27@-1@-1@17@42@^[&quot;GLAVK&quot;]SRV(&quot;Variables&quot;)</Data>
</Node>
</Node>
<Node><Sub>DDPYES</Sub>
<Data>@@@@@1@1@1@1@22@80@1@@1@1@@8@@@1@@@@@@@@3@3@@1;6;32;44@@@@@@@@^%ZAPM.ed.BSHLP(&quot;HELP-ALTF2&quot;)</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@10@@@@@1@@@@@@ Используется Вашей Системой DDP ?!!! @@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@11@1@10@@@@@1@1;6;30;43@@@@@  ДА  @</Data>
</Node>
<Node><Sub>3</Sub>
<Data>1@21@1@10@@@@@1@@@@@@1@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@10@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>2@11@1@10@@@@@1@1;6;36;43@@@0@@ НЕТ @</Data>
</Node>
<Node><Sub>3</Sub>
<Data>2@21@1@10@@@@@1@@@@@@0@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@11@1@10@@@@@1@@@@@3,2@ ПОМОЩЬ @</Data>
</Node>
<Node><Sub>3</Sub>
<Data>3@21@1@10@@@@@1@@@@@@0@</Data>
</Node>
</Node>
<Node><Sub>BUT</Sub>
<Data>/1;6;32;44</Data>
<Node><Sub>0</Sub>
<Data>1;6;32;44</Data>
<Node><Sub>1</Sub>
<Data> Используется Вашей Системой DDP ?!!! </Data>
</Node>
</Node>
<Node><Sub>1</Sub>
<Data>1;6;30;43/1;6;36;43</Data>
<Node><Sub>1</Sub>
<Data>  ДА  </Data>
</Node>
<Node><Sub>2</Sub>
<Data> НЕТ </Data>
</Node>
<Node><Sub>3</Sub>
<Data> ПОМОЩЬ </Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Data>2</Data>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>3</Sub>
<Data>3,2</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>1</Data>
</Node>
<Node><Sub>2</Sub>
<Data>0</Data>
</Node>
<Node><Sub>3</Sub>
<Data>0</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>0</Data>
</Node>
<Node><Sub>2</Sub>
<Data>0</Data>
</Node>
</Node>
</Node>
<Node><Sub>CMD</Sub>
<Node><Sub>3</Sub>
<Node><Sub>2</Sub>
<Data>D HELP^%ZAPM.ed.BSDOS2(20)</Data>
</Node>
</Node>
</Node>
<Node><Sub>COL</Sub>
<Node><Sub>2</Sub>
<Node><Sub>2</Sub>
<Data>I 1</Data>
<Node><Sub>1</Sub>
<Data>1</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>STA</Sub>
<Data>,@1@1@13@-1@-1@3@21@0</Data>
</Node>
</Node>
<Node><Sub>DFLT</Sub>
<Data>заготовка очень маленькой таблицы (1x1)@@@@@1@1@1@1@22@80@1@@1@1@@1@@@1@@@@@1@@@1@1@@@@@@@@</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@1@@@@@1@@@@@@</Data>
</Node>
</Node>
<Node><Sub>STA</Sub>
<Data>1,1@1@1@13@-1@-1@1@1@</Data>
</Node>
</Node>
<Node><Sub>DIR</Sub>
<Data><![CDATA[заготовка под таблицу каталога@@@@@1@1@1@1@21@80@@@@@1@1@@2,1@1@@@@@@@@2@8@@2;6;34;46@@@@@@@@^%ZAPM.ed.BSHLP("DIRHELP")]]></Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@9@@@@@1@2;6;30;45@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@10@1@9@@@@@1@2;6;30;45@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>1@19@1@9@@@@@1@2;6;30;45@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>1@28@1@9@@@@0@1@2;6;30;45@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>1@37@1@9@@@@@1@2;6;30;45@@@@@(помеченн@</Data>
</Node>
<Node><Sub>6</Sub>
<Data>1@46@1@9@@@@@1@2;6;30;45@@@@@ых всего@</Data>
</Node>
<Node><Sub>7</Sub>
<Data>1@55@1@9@@@@0@1@2;6;30;45@@@@@@</Data>
</Node>
<Node><Sub>8</Sub>
<Data>1@64@1@9@@@@@1@2;6;30;45@@@@@@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@9@@@@0@1@2;6;34;46@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>2@10@1@9@@@@2,1@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>2@19@1@9@@@@2,1@1@@@@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>2@28@1@9@@@@2,1@1@@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>2@37@1@9@@@@2,1@1@@@@@@@</Data>
</Node>
<Node><Sub>6</Sub>
<Data>2@46@1@9@@@@2,1@1@@@@@@@</Data>
</Node>
<Node><Sub>7</Sub>
<Data>2@55@1@9@@@@2,1@1@@@@@@@</Data>
</Node>
<Node><Sub>8</Sub>
<Data>2@64@1@9@@@@2,1@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>FTR</Sub>
<Node><Sub>1</Sub>
<Node><Sub>4</Sub>
<Data>S d1=$ZU(0)</Data>
<Node><Sub>1</Sub>
<Data>$ZU(0)</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Data>S d1=+$P(B,&quot;@&quot;,3)_&quot;)&quot;</Data>
<Node><Sub>1</Sub>
<Data>+$P(B,&quot;@&quot;,3)_&quot;)&quot;</Data>
</Node>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data><![CDATA[S d1=" "_d I %BSTM,d'="",$$A^%ZAPM.ed.BSA(1,3)["прогр" W /CUP(22,1),$$atr^%ZAPM.ed.BS3(0),/EL(0),$$clr^%ZAPM.ed.BS3(4) ZL @d W $E($T(+1),1,75)]]></Data>
<Node><Sub>1</Sub>
<Data><![CDATA[" "_d I %BSTM,d'="",{1,3}["прогр" W /CUP(22,1),$$atr^%ZAPM.ed.BS3(0),/EL(0),$$clr^%ZAPM.ed.BS3(4) ZL @d W $E($T(+1),1,75)]]></Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>STA</Sub>
<Data>2,5@2@1@27@-1@-1@2@37@</Data>
</Node>
</Node>
<Node><Sub>DIR2</Sub>
<Data>заготовка под таблицу каталога новая@@1@@@1@1@1@1@22@80@1@@1@@@1@@2,1@1@@@@@@@@2@4@@1;6;35;44@@@@@@</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@19@@@@@1@2;6;34;46@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@20@1@19@@@@@1@2;6;34;46@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>1@39@1@19@@@@@1@2;6;34;46@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>1@58@1@19@@@@@1@2;6;34;46@@@@@@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@19@@@@@1@2;6;31;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>2@20@1@19@@@@@1@2;6;31;46@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>2@39@1@19@@@@@1@2;6;31;46@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>2@58@1@19@@@@@1@2;6;31;46@@@@@@</Data>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>65813,85456,m</Data>
</Node>
<Node><Sub>OPT</Sub>
<Data>1</Data>
</Node>
<Node><Sub>STA</Sub>
<Data>2,1@2@1@27@-1@-1@2@1@</Data>
</Node>
</Node>
<Node><Sub>ENTER</Sub>
<Data><![CDATA[регистрация в %BS !!!@@1@@@1@1@1@1@22@80@1@@1@1@@1@@@1@@@@@@@@5@6@@2;6;37;44@@@@@@@@^%ZAPM.ed.BSHLP("HELP-ALTF2")]]></Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@10@@@@@1@@@@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@11@1@10@@@@@1@1;6;32;44@@1@@@ РЕГИСТРАЦИЯ @</Data>
</Node>
<Node><Sub>3</Sub>
<Data>1@21@1@10@@@@@1@@@1@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>1@31@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>1@41@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>6</Sub>
<Data>1@51@1@10@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@10@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>2@11@1@10@@@@@1@1;6;32;44@@1@@@ ВОЗВРАТ @</Data>
</Node>
<Node><Sub>3</Sub>
<Data>2@21@1@10@@@@@1@@@1@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>2@31@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>2@41@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>6</Sub>
<Data>2@51@1@10@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@11@1@10@@@@@1@1;6;32;44@@1@@@ ПОМОЩЬ @</Data>
</Node>
<Node><Sub>3</Sub>
<Data>3@21@1@10@@@@@1@@@1@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>3@31@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>3@41@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>6</Sub>
<Data>3@51@1@10@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>4@1@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>4@11@1@10@@@@@1@1;6;32;44@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>4@21@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>4@31@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>4@41@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>6</Sub>
<Data>4@51@1@10@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>5@1@1@10@@@@@1@@@@@@Если не@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>5@11@1@10@@@@@1@@@@@@знаете,что@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>5@21@1@10@@@@@1@@@@@@ делать -@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>5@31@1@10@@@@@1@@@@@@введите@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>5@41@1@10@@@@@1@@@@@@&lt;F1&gt;@</Data>
</Node>
<Node><Sub>6</Sub>
<Data>5@51@1@10@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>STA</Sub>
<Data>4,3@1@1@13@-1@-1@4@21@</Data>
</Node>
</Node>
<Node><Sub>EditRou</Sub>
<Data><![CDATA[Пакетный поиск и редактирование@@1@@@1@1@11@7@17@70@@@@@1@7@@@1@@@@@1@@@7@2@@2;6;30;46@@@1@@@@@@@MENU^%ZAPM.ed.BSF11]]></Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@34@@@@0@1@@@@@1,1@ПОИСК МЕТОК В ПРОГРАММАХ...</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@35@1@30@@@@1,1@1@1;6;32;46@@@@1,2@...ВХОД В ПРОТОКОЛ@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@34@@@@1,1@1@@@@@2,1@ПОИСК КОНТЕКСТА В ПРОГРАММАХ...</Data>
</Node>
<Node><Sub>2</Sub>
<Data>2@35@1@30@@@@1,1@1@1;6;32;46@@@@2,2@...ВХОД В ПРОТОКОЛ@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@34@@@@1,1@1@@@@@3,1@ПОИСК И ЗАМЕНА В ПРОГРАММАХ...@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@35@1@30@@@@1,1@1@1;6;32;46@@@@3,2@...ВХОД В ПРОТОКОЛ@</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>4@1@1@34@@@@1,1@1@@@@@4,1@ПОИСК ДЛЯ РЕДАКТИРОВАНИЯ...@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>4@35@1@30@@@@1,1@1@1;6;32;46@@@@4,2@...ВХОД В ПРОТОКОЛ@</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>5@1@1@34@@@@1,1@1@1;6;32;46@@@@5,1@ПОИСК КОНТЕКСТА В ГЛОБАЛАХ...@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>5@35@1@30@@@@1,1@1@@@@@5,2@...ВХОД В ПРОТОКОЛ@</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>6@1@1@34@@@@1,1@1@1;6;32;46@@@@6,1@ПОИСК И ЗАМЕНА В ДАННЫХ ГЛОБАЛАХ..@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>6@35@1@30@@@@1,1@1@@@@@6,2@...ВХОД В ПРОТОКОЛ@</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>7@1@1@34@@@@1,1@1@1;6;32;46@@@@7,1@ФИЛЬТРОВАНИЕ ССЫЛОК МАССИВОВ...@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>7@35@1@30@@@@1,1@1@@@@@7,2@...ВХОД В ПРОТОКОЛ@</Data>
</Node>
</Node>
<Node><Sub>CMD</Sub>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>D E^%ZAPM.ed.BSER(&quot;1^%ZAPM.ed.BSER1&quot;)</Data>
</Node>
<Node><Sub>2</Sub>
<Data>D RSE^%ZAPM.ed.BSMSMF(1)</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>D E^%ZAPM.ed.BSER(&quot;2^%ZAPM.ed.BSER1&quot;)</Data>
</Node>
<Node><Sub>2</Sub>
<Data>D RSE^%ZAPM.ed.BSMSMF(2)</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>D E^%ZAPM.ed.BSER(&quot;3^%ZAPM.ed.BSER&quot;)</Data>
</Node>
<Node><Sub>2</Sub>
<Data>D RSE^%ZAPM.ed.BSMSMF(3)</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>D E^%ZAPM.ed.BSER(&quot;4^%ZAPM.ed.BSER1&quot;)</Data>
</Node>
<Node><Sub>2</Sub>
<Data>D RSE^%ZAPM.ed.BSMSMF(4)</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>D FIND^%ZAPM.ed.BSMSMGF</Data>
</Node>
<Node><Sub>2</Sub>
<Data>D PROTOKOL^%ZAPM.ed.BSMSMGF(1)</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>D REPLAY^%ZAPM.ed.BSMSMGF</Data>
</Node>
<Node><Sub>2</Sub>
<Data>D PROTOKOL^%ZAPM.ed.BSMSMGF(2)</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>D FILTER^%ZAPM.ed.BSMSMGF</Data>
</Node>
<Node><Sub>2</Sub>
<Data>D PROTOKOL^%ZAPM.ed.BSMSMGF(3)</Data>
</Node>
</Node>
</Node>
<Node><Sub>FTR</Sub>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>57185,39221,</Data>
</Node>
<Node><Sub>STA</Sub>
<Data>1,1@1@1@27@-1@-1@11@7@ПОИСК МЕТОК В ПРОГРАММАХ...</Data>
</Node>
<Node><Sub>USM</Sub>
<Data>48@2;6;30;46</Data>
</Node>
</Node>
<Node><Sub>EndUser</Sub>
<Data>конечный пользователь@@@@@@@7@10@19@70@@@@1@@5@@@1@@@ 1@@@@@5@@@1;6;37;44//2;6;33;40@@@@@@@1</Data>
<Node><Sub>1</Sub>
<Data>MSW</Data>
</Node>
<Node><Sub>2</Sub>
<Data></Data>
</Node>
<Node><Sub>3</Sub>
<Data></Data>
</Node>
<Node><Sub>4</Sub>
<Data></Data>
</Node>
<Node><Sub>5</Sub>
<Data></Data>
</Node>
</Node>
<Node><Sub>FUN_BUT</Sub>
<Data>@@1@@@1@1@1@1@22@80@1@@1@1@@8@@@1@@@@@@@@5@3@@2;6;37;44@@@@@@@@^%ZAPM.ed.BSHLP(&quot;HELP-ALTF2&quot;)</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@10@@@@@1@@@@@@        Выберите тип использования функции@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@11@1@10@@@@@1@1;6;32;44@@@@@ЦИКЛИЧНАЯ@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>1@21@1@10@@@@@1@@@@@@1@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@10@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>2@11@1@10@@@@@1@2;6;30;45@@@@@СИМВОЛЬНАЯ@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>2@21@1@10@@@@@1@@@@@@2@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@11@1@10@@@@@1@1;6;32;44@@@@@СПИСКОВАЯ@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>3@21@1@10@@@@@1@@@@@@3@</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>4@1@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>4@11@1@10@@@@@1@1;6;32;44@@@@@СВОДКОВАЯ@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>4@21@1@10@@@@@1@@@@@@4@</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>5@1@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>5@11@1@10@@@@@1@@@@@@ЧИСЛОВАЯ@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>5@21@1@10@@@@@1@@@@@@0@</Data>
</Node>
</Node>
<Node><Sub>BUT</Sub>
<Data>/2;6;37;44</Data>
<Node><Sub>0</Sub>
<Data>2;6;37;44</Data>
<Node><Sub>1</Sub>
<Data>        Выберите тип использования функции</Data>
</Node>
</Node>
<Node><Sub>1</Sub>
<Data>1;6;32;44/2;6;30;45</Data>
<Node><Sub>1</Sub>
<Data>ЦИКЛИЧНАЯ</Data>
</Node>
<Node><Sub>2</Sub>
<Data>СИМВОЛЬНАЯ</Data>
</Node>
<Node><Sub>3</Sub>
<Data>СПИСКОВАЯ</Data>
</Node>
<Node><Sub>4</Sub>
<Data>СВОДКОВАЯ</Data>
</Node>
<Node><Sub>5</Sub>
<Data>ЧИСЛОВАЯ</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>1</Data>
</Node>
<Node><Sub>2</Sub>
<Data>2</Data>
</Node>
<Node><Sub>3</Sub>
<Data>3</Data>
</Node>
<Node><Sub>4</Sub>
<Data>4</Data>
</Node>
<Node><Sub>5</Sub>
<Data>0</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>0</Data>
</Node>
<Node><Sub>2</Sub>
<Data>0</Data>
</Node>
</Node>
</Node>
<Node><Sub>STA</Sub>
<Data>1,3@1@1@13@-1@-1@1@21@1</Data>
</Node>
</Node>
<Node><Sub>FUN_ED</Sub>
<Data>Функции %BS@@@@@1@1@1@1@22@80@1@@1@@@2@@3,4@1@@@@@1@@@12@5@@2;6;30;46@@@@@@@@@@@@1@1</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@1@1@@@@1@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@2@1@30@1@@@@1@@@@@@        ТАБЛИЦА РЕДАКТИРОВАНИЯ </Data>
</Node>
<Node><Sub>3</Sub>
<Data>1@32@1@1@1@@@@1@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>1@33@1@45@@@@0@1@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>1@78@1@1@1@@@@1@@@@@@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@1@1@@@@1@@@@@@=</Data>
</Node>
<Node><Sub>2</Sub>
<Data>2@2@1@30@1@@@0@1@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>2@32@1@1@1@@@@1@@@@@@=</Data>
</Node>
<Node><Sub>4</Sub>
<Data>2@33@1@45@1@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>2@78@1@1@1@@@@1@@@@@@=</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>3@1@10@1@1@@@0@1@@@@@@|</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@2@10@30@@@@@1@@@@@@ Текст Описания функции</Data>
</Node>
<Node><Sub>3</Sub>
<Data>3@32@10@1@1@@@3,1@1@@@@@@|</Data>
</Node>
<Node><Sub>4</Sub>
<Data>3@33@10@45@@@@@2@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>3@78@10@1@1@@@3,1@1@@@@@@|</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>13@1@1@1@1@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>2</Sub>
<Data>13@2@1@30@1@@@0@1@@@@@@---</Data>
</Node>
<Node><Sub>3</Sub>
<Data>13@32@1@1@1@@@@1@@@@@@-</Data>
</Node>
<Node><Sub>4</Sub>
<Data>13@33@1@45@1@@@4,2@1@@@@@@------</Data>
</Node>
<Node><Sub>5</Sub>
<Data>13@78@1@1@1@@@@1@@@@@@|</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>14@1@1@1@1@@@7,1@1@@@@@@|</Data>
</Node>
<Node><Sub>2</Sub>
<Data>14@2@1@30@1@@@@1@@@@@@ Коментаpий</Data>
</Node>
<Node><Sub>3</Sub>
<Data>14@32@1@1@1@@@7,1@1@@@@@@|</Data>
</Node>
<Node><Sub>4</Sub>
<Data>14@33@1@45@@@@@2@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>14@78@1@1@1@@@7,1@1@@@@@@|</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>15@1@1@1@1@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>2</Sub>
<Data>15@2@1@30@1@@@4,2@1@@@@@@---</Data>
</Node>
<Node><Sub>3</Sub>
<Data>15@32@1@1@1@@@@1@@@@@@-</Data>
</Node>
<Node><Sub>4</Sub>
<Data>15@33@1@45@1@@@4,2@1@@@@@@------</Data>
</Node>
<Node><Sub>5</Sub>
<Data>15@78@1@1@1@@@@1@@@@@@|</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>16@1@1@1@1@@@7,1@1@@@@@@|</Data>
</Node>
<Node><Sub>2</Sub>
<Data>16@2@1@30@@@@@1@@@@@@ Тип Вызова</Data>
</Node>
<Node><Sub>3</Sub>
<Data>16@32@1@1@1@@@7,1@1@@@@@@|</Data>
</Node>
<Node><Sub>4</Sub>
<Data>16@33@1@45@@@@0@2@2;6;37;44@@@@^%ZAPM.ed.BSS(&quot;FUN_BUT&quot;)@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>16@78@1@1@1@@@7,1@1@@@@@@|</Data>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>1</Sub>
<Data>17@1@1@1@1@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>2</Sub>
<Data>17@2@1@30@1@@@4,2@1@@@@@@---</Data>
</Node>
<Node><Sub>3</Sub>
<Data>17@32@1@1@1@@@@1@@@@@@-</Data>
</Node>
<Node><Sub>4</Sub>
<Data>17@33@1@45@1@@@4,2@1@@@@@@------</Data>
</Node>
<Node><Sub>5</Sub>
<Data>17@78@1@1@1@@@@1@@@@@@|</Data>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>1</Sub>
<Data>18@1@1@1@1@@@7,1@1@@@@@@|</Data>
</Node>
<Node><Sub>2</Sub>
<Data>18@2@1@30@@@@@1@@@@@@ Количество параметров</Data>
</Node>
<Node><Sub>3</Sub>
<Data>18@32@1@1@1@@@7,1@1@@@@@@|</Data>
</Node>
<Node><Sub>4</Sub>
<Data>18@33@1@45@@@@@1@2;6;37;44@@@@@1</Data>
</Node>
<Node><Sub>5</Sub>
<Data>18@78@1@1@1@@@7,1@1@@@@@@|</Data>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>1</Sub>
<Data>19@1@1@1@1@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>2</Sub>
<Data>19@2@1@30@1@@@4,2@1@@@@@@---</Data>
</Node>
<Node><Sub>3</Sub>
<Data>19@32@1@1@1@@@@1@@@@@@-</Data>
</Node>
<Node><Sub>4</Sub>
<Data>19@33@1@45@1@@@4,2@1@@@@@@------</Data>
</Node>
<Node><Sub>5</Sub>
<Data>19@78@1@1@1@@@@1@@@@@@|</Data>
</Node>
</Node>
<Node><Sub>11</Sub>
<Node><Sub>1</Sub>
<Data>20@1@1@1@1@@@7,1@1@@@@@@|</Data>
</Node>
<Node><Sub>2</Sub>
<Data>20@2@1@30@@@@@1@@@@@@ Ссылка Вызова (программа)</Data>
</Node>
<Node><Sub>3</Sub>
<Data>20@32@1@1@1@@@7,1@1@@@@@@|</Data>
</Node>
<Node><Sub>4</Sub>
<Data>20@33@1@45@@@@@2@2;6;37;44@@@@11,4@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>20@78@1@1@1@@@7,1@1@@@@@@|</Data>
</Node>
</Node>
<Node><Sub>12</Sub>
<Node><Sub>1</Sub>
<Data>21@1@1@1@1@@@@1@@@@@@=</Data>
</Node>
<Node><Sub>2</Sub>
<Data>21@2@1@30@1@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>21@32@1@1@1@@@@1@@@@@@=</Data>
</Node>
<Node><Sub>4</Sub>
<Data>21@33@1@45@1@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>21@78@1@1@1@@@@1@@@@@@=</Data>
</Node>
</Node>
<Node><Sub>CMD</Sub>
<Node><Sub>11</Sub>
<Node><Sub>4</Sub>
<Data>D ROU^%ZAPM.ed.BSMSMF</Data>
</Node>
</Node>
</Node>
<Node><Sub>FTR</Sub>
<Node><Sub>1</Sub>
<Node><Sub>4</Sub>
<Data>S d1=$G(k1)</Data>
<Node><Sub>1</Sub>
<Data>$G(k1)</Data>
</Node>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>2</Sub>
<Data>S d1=$TR($J(&quot;&quot;,45),&quot; &quot;,&quot;=&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$TR($J(&quot;&quot;,45),&quot; &quot;,&quot;=&quot;)</Data>
</Node>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$TR($J(&quot;&quot;,10),&quot; &quot;,&quot;|&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$TR($J(&quot;&quot;,10),&quot; &quot;,&quot;|&quot;)</Data>
</Node>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>2</Sub>
<Data>S d1=$TR($J(&quot;&quot;,45),&quot; &quot;,&quot;-&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$TR($J(&quot;&quot;,45),&quot; &quot;,&quot;-&quot;)</Data>
</Node>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>4</Sub>
<Data>S d1=$S(d=1:&quot;ЦИКЛИЧНАЯ&quot;,d=2:&quot;СИМВОЛЬНАЯ&quot;,d=3:&quot;СПИСКОВАЯ&quot;,d=4:&quot;СВОДКОВАЯ&quot;,d=0:&quot;ЧИСЛОВАЯ&quot;,1:&quot;&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$S(d=1:&quot;ЦИКЛИЧНАЯ&quot;,d=2:&quot;СИМВОЛЬНАЯ&quot;,d=3:&quot;СПИСКОВАЯ&quot;,d=4:&quot;СВОДКОВАЯ&quot;,d=0:&quot;ЧИСЛОВАЯ&quot;,1:&quot;&quot;)</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>Free</Sub>
<Data>57995,51073</Data>
</Node>
<Node><Sub>KEY</Sub>
<Data>^%ZAPM.ed.BSFUN</Data>
<Node><Sub>1</Sub>
<Data>@@@@НОВАЯ ФУНКЦИЯ %BS@1,70@@@ 1-Й ИНДЕКСНЫЙ@2;6;30;42@@@@@Введите Имя Новой Функции@@@@@</Data>
<Node><Sub>3</Sub>
<Data><![CDATA[S d1=d_$TR($J("",10-$L(d))," ",".")_$$A^%ZAPM.ed.BSA(5,4,"FUN_ED","%BSS","","","",$G(d,0)) I d1["<NO" S d1=$P(d1,"<NO")_"комментарий в программе"]]></Data>
</Node>
<Node><Sub>4</Sub>
<Data><![CDATA[d_$TR($J("",10-$L(d))," ",".")_{5,4,"FUN_ED","%BSS","","","",$G(d,0)} I d1["<NO" S d1=$P(d1,"<NO")_"комментарий в программе"]]></Data>
</Node>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>57995,51073,MS</Data>
</Node>
<Node><Sub>STA</Sub>
<Data>5,4@3@4@27@-1@-1@14@33@</Data>
</Node>
</Node>
<Node><Sub>INFO</Sub>
<Data>ИНФОРМАЦИЯ ПО ТАБЛИЦЕ@@@@@1@1@1@1@22@80@1@@1@@@1@@20,2@1@@@@@1@@@21@5@@1;6;37;44@@@@@@@@@@@@1</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@29@1@@@0@1@@@@@@=============================</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@30@1@12@1@@@@1@@@@@@============</Data>
</Node>
<Node><Sub>3</Sub>
<Data>1@42@1@29@1@@@@1@@@@@@=============================</Data>
</Node>
<Node><Sub>4</Sub>
<Data>1@71@1@6@1@@@@1@@@@@@======</Data>
</Node>
<Node><Sub>5</Sub>
<Data>1@77@1@1@1@@@@1@@@@@@=</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@29@1@@@@1@@@@@@| Micronetics Standart Mumps|</Data>
</Node>
<Node><Sub>2</Sub>
<Data>2@30@1@12@1@@@0@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>2@42@1@29@1@@@@1@@@@@@| Комплекс %BS веpсии       |</Data>
</Node>
<Node><Sub>4</Sub>
<Data>2@71@1@6@1@@@0@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>2@77@1@1@1@@@@1@@@@@@|</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@29@1@@@@1@@@@@@|      Текущий КИП,ТОМ      |</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@30@1@12@1@@@0@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>3@42@1@29@1@@@@1@@@@@@| Тип таблицы ===============</Data>
</Node>
<Node><Sub>4</Sub>
<Data>3@71@1@6@1@@@0@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>3@77@1@1@1@@@@1@@@@@@|</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>4@1@1@29@1@@@@1@@@@@@|          Текущий pаздел   |</Data>
</Node>
<Node><Sub>2</Sub>
<Data>4@30@1@12@1@@@0@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>4@42@1@29@1@@@0@1@@@@@@| Тип таблицы               |</Data>
</Node>
<Node><Sub>4</Sub>
<Data>4@71@1@6@1@@@@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>4@77@1@1@1@@@@1@@@@@@|</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>5@1@1@29@1@@@@1@@@@@@|===========================|</Data>
</Node>
<Node><Sub>2</Sub>
<Data>5@30@1@12@1@@@@1@@@@@@============</Data>
</Node>
<Node><Sub>3</Sub>
<Data>5@42@1@29@1@@@@1@@@@@@|============================</Data>
</Node>
<Node><Sub>4</Sub>
<Data>5@71@1@6@1@@@@1@@@@@@======</Data>
</Node>
<Node><Sub>5</Sub>
<Data>5@77@1@1@1@@@@1@@@@@@|</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>6@1@1@29@1@@@@1@@@@@@|Паpоли: ВХОД,КоpДан,КоpОпис|</Data>
</Node>
<Node><Sub>2</Sub>
<Data>6@30@1@12@1@@@0@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>6@42@1@29@1@@@@1@@@@@@| Статус таблицы включен    |</Data>
</Node>
<Node><Sub>4</Sub>
<Data>6@71@1@6@1@@@0@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>6@77@1@1@1@@@@1@@@@@@|</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>7@1@1@29@1@@@@1@@@@@@| Кооpдинаты окна пpосмотpа |</Data>
</Node>
<Node><Sub>2</Sub>
<Data>7@30@1@12@1@@@0@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>7@42@1@29@1@@@@1@@@@@@| Защита всей таблицы       |</Data>
</Node>
<Node><Sub>4</Sub>
<Data>7@71@1@6@1@@@0@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>7@77@1@1@1@@@@1@@@@@@|</Data>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>1</Sub>
<Data>8@1@1@29@1@@@@1@@@@@@|   Титул таблицы           |</Data>
</Node>
<Node><Sub>2</Sub>
<Data>8@30@1@12@1@@@0@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>8@42@1@29@1@@@@1@@@@@@| Таблица оптимизиpована    |</Data>
</Node>
<Node><Sub>4</Sub>
<Data>8@71@1@6@1@@@0@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>8@77@1@1@1@@@@1@@@@@@|</Data>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>1</Sub>
<Data>9@1@1@29@1@@@@1@@@@@@|  Видеостатус таблицы      |</Data>
</Node>
<Node><Sub>2</Sub>
<Data>9@30@1@12@1@@@0@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>9@42@1@29@1@@@@1@@@@@@| Таблица соpтиpуема        |</Data>
</Node>
<Node><Sub>4</Sub>
<Data>9@71@1@6@1@@@0@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>9@77@1@1@1@@@@1@@@@@@|</Data>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>1</Sub>
<Data>10@1@1@29@1@@@@1@@@@@@|  Логический контpоль      |</Data>
</Node>
<Node><Sub>2</Sub>
<Data>10@30@1@12@1@@@0@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>10@42@1@29@1@@@@1@@@@@@| Стандаpтная обpаботка F_кл|</Data>
</Node>
<Node><Sub>4</Sub>
<Data>10@71@1@6@1@@@0@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>10@77@1@1@1@@@@1@@@@@@|</Data>
</Node>
</Node>
<Node><Sub>11</Sub>
<Node><Sub>1</Sub>
<Data>11@1@1@29@1@@@@1@@@@@@| Количество стpок,колонок  |</Data>
</Node>
<Node><Sub>2</Sub>
<Data>11@30@1@12@1@@@0@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>11@42@1@29@1@@@@1@@@@@@| Есть ссылки на БД лок.пpив|</Data>
</Node>
<Node><Sub>4</Sub>
<Data>11@71@1@6@1@@@0@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>11@77@1@1@1@@@@1@@@@@@|</Data>
</Node>
</Node>
<Node><Sub>12</Sub>
<Node><Sub>1</Sub>
<Data>12@1@1@29@1@@@@1@@@@@@| Поpядок вычисления        |</Data>
</Node>
<Node><Sub>2</Sub>
<Data>12@30@1@12@1@@@0@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>12@42@1@29@1@@@@1@@@@@@| Вычисления постоянно      |</Data>
</Node>
<Node><Sub>4</Sub>
<Data>12@71@1@6@1@@@0@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>12@77@1@1@1@@@@1@@@@@@|</Data>
</Node>
</Node>
<Node><Sub>13</Sub>
<Node><Sub>1</Sub>
<Data>13@1@1@29@1@@@@1@@@@@@| Список Лог Кон по симв.им.|</Data>
</Node>
<Node><Sub>2</Sub>
<Data>13@30@1@12@1@@@0@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>13@42@1@29@1@@@@1@@@@@@| Таблица закpывается       |</Data>
</Node>
<Node><Sub>4</Sub>
<Data>13@71@1@6@1@@@0@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>13@77@1@1@1@@@@1@@@@@@|</Data>
</Node>
</Node>
<Node><Sub>14</Sub>
<Node><Sub>1</Sub>
<Data>14@1@1@29@1@@@@1@@@@@@| Нестандаpтный HELP по F1  |</Data>
</Node>
<Node><Sub>2</Sub>
<Data>14@30@1@12@1@@@0@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>14@42@1@29@1@@@@1@@@@@@| Режим пpосмотpа и поиска  |</Data>
</Node>
<Node><Sub>4</Sub>
<Data>14@71@1@6@1@@@0@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>14@77@1@1@1@@@@1@@@@@@|</Data>
</Node>
</Node>
<Node><Sub>15</Sub>
<Node><Sub>1</Sub>
<Data>15@1@1@29@1@@@@1@@@@@@| База данных               |</Data>
</Node>
<Node><Sub>2</Sub>
<Data>15@30@1@12@1@@@0@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>15@42@1@29@1@@@@1@@@@@@| Постдвижение указателя    |</Data>
</Node>
<Node><Sub>4</Sub>
<Data>15@71@1@6@1@@@0@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>15@77@1@1@1@@@@1@@@@@@|</Data>
</Node>
</Node>
<Node><Sub>16</Sub>
<Node><Sub>1</Sub>
<Data>16@1@1@29@1@@@@1@@@@@@| Предобработка клавиш      |</Data>
</Node>
<Node><Sub>2</Sub>
<Data>16@30@1@12@1@@@0@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>16@42@1@29@1@@@@1@@@@@@|Указатель только на разреш.|</Data>
</Node>
<Node><Sub>4</Sub>
<Data>16@71@1@6@1@@@0@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>16@77@1@1@1@@@@1@@@@@@|</Data>
</Node>
</Node>
<Node><Sub>17</Sub>
<Node><Sub>1</Sub>
<Data>17@1@1@29@1@@@@1@@@@@@| Таблица скрытая           |</Data>
</Node>
<Node><Sub>2</Sub>
<Data>17@30@1@12@1@@@0@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>17@42@1@29@1@@@@1@@@@@@| Кооpдинаты клетки         |</Data>
</Node>
<Node><Sub>4</Sub>
<Data>17@71@1@6@1@@@0@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>17@77@1@1@1@@@@1@@@@@@|</Data>
</Node>
</Node>
<Node><Sub>18</Sub>
<Node><Sub>1</Sub>
<Data>18@1@1@29@1@@@@1@@@@@@| Подтвержать запись в базу |</Data>
</Node>
<Node><Sub>2</Sub>
<Data>18@30@1@12@1@@@0@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>18@42@1@29@1@@@@1@@@@@@| АвтоФорматирование таблицы|</Data>
</Node>
<Node><Sub>4</Sub>
<Data>18@71@1@6@1@@@0@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>18@77@1@1@1@@@@1@@@@@@|</Data>
</Node>
</Node>
<Node><Sub>19</Sub>
<Node><Sub>1</Sub>
<Data>19@1@1@29@1@@@@1@@@@@@|============================</Data>
</Node>
<Node><Sub>2</Sub>
<Data>19@30@1@12@1@@@@1@@@@@@============</Data>
</Node>
<Node><Sub>3</Sub>
<Data>19@42@1@29@1@@@@1@@@@@@=============================</Data>
</Node>
<Node><Sub>4</Sub>
<Data>19@71@1@6@1@@@@1@@@@@@======</Data>
</Node>
<Node><Sub>5</Sub>
<Data>19@77@1@1@1@@@@1@@@@@@|</Data>
</Node>
</Node>
<Node><Sub>20</Sub>
<Node><Sub>1</Sub>
<Data>20@1@1@29@1@@@@1@@@@@@|               ИНФОРМАЦИЯ О:</Data>
</Node>
<Node><Sub>2</Sub>
<Data>20@30@1@12@@@@0@1@1;6;32;44@@@@^%ZAPM.ed.BSS(&quot;INFO_B&quot;)@ БАЗЕ ДАННЫХ</Data>
</Node>
<Node><Sub>3</Sub>
<Data>20@42@1@29@@@@0@1@1;6;32;44@@@@^%ZAPM.ed.BSbufB(&quot;INFO_K&quot;)@D 75^CONVERT</Data>
</Node>
<Node><Sub>4</Sub>
<Data>20@71@1@6@@@@0@1@1;6;32;44@@@@^%ZAPM.ed.BSS(&quot;INFO_ALL&quot;)@СВОДНАЯ ИНФОРМАЦИЯ ПО ВСЕЙ ТАБЛИЦЕ</Data>
</Node>
<Node><Sub>5</Sub>
<Data>20@77@1@1@1@@@@1@@@@@@|</Data>
</Node>
</Node>
<Node><Sub>21</Sub>
<Node><Sub>1</Sub>
<Data>21@1@1@29@1@@@@1@@@@@@=============================</Data>
</Node>
<Node><Sub>2</Sub>
<Data>21@30@1@12@1@@@@1@@@@@@============</Data>
</Node>
<Node><Sub>3</Sub>
<Data>21@42@1@29@1@@@@1@@@@@@=============================</Data>
</Node>
<Node><Sub>4</Sub>
<Data>21@71@1@6@1@@@@1@@@@@@======</Data>
</Node>
<Node><Sub>5</Sub>
<Data>21@77@1@1@1@@@@1@@@@@@=</Data>
</Node>
</Node>
<Node><Sub>FTR</Sub>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>S d1=d S iS=$G(%KAT(1)),iB=$G(%KAT(2)),iBS=$G(%KAT(3))</Data>
<Node><Sub>1</Sub>
<Data>d S iS=$G(%KAT(1)),iB=$G(%KAT(2)),iBS=$G(%KAT(3))</Data>
</Node>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>2</Sub>
<Data>S d1=$P($ZV,&quot; &quot;,3)</Data>
<Node><Sub>1</Sub>
<Data>$P($ZV,&quot; &quot;,3)</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Data>S d1=&quot; &quot;_+$G(^%ZAPM.ed.BS)</Data>
<Node><Sub>1</Sub>
<Data>&quot; &quot;_+$G(^%ZAPM.ed.BS)</Data>
</Node>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>2</Sub>
<Data>S d1=$ZU(0)</Data>
<Node><Sub>1</Sub>
<Data>$ZU(0)</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Data>S d1=$$TIP^%ZAPM.ed.BS($P($G(%KAT(2)),&quot;@&quot;,17))</Data>
<Node><Sub>1</Sub>
<Data>$$TIP^%ZAPM.ed.BS($P($G(%KAT(2)),&quot;@&quot;,17))</Data>
</Node>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>2</Sub>
<Data><![CDATA[S d1=$S($P($G(%KAT(1)),"!",2)["]":"^"_$P($P($G(%KAT(1)),"!",2),"]",2),1:$P($G(%KAT(1)),"!",2)) S iB=$G(%KAT(2)),iS=$G(%KAT(3))]]></Data>
<Node><Sub>1</Sub>
<Data><![CDATA[$S($P($G(%KAT(1)),"!",2)["]":"^"_$P($P($G(%KAT(1)),"!",2),"]",2),1:$P($G(%KAT(1)),"!",2)) S iB=$G(%KAT(2)),iS=$G(%KAT(3))]]></Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Data>S d1=&quot;| &quot;_$P($G(%KAT(1)),&quot;!&quot;,3)</Data>
<Node><Sub>1</Sub>
<Data>&quot;| &quot;_$P($G(%KAT(1)),&quot;!&quot;,3)</Data>
</Node>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>2</Sub>
<Data><![CDATA[S d1=$S($P($G(iB),"@",2)'="":"Y",1:"N")_","_$S($P($G(iB),"@",5)'="":"Y",1:"N")_","_$S($P($G(iB),"@",4)'="":"Y",1:"N")]]></Data>
<Node><Sub>1</Sub>
<Data><![CDATA[$S($P($G(iB),"@",2)'="":"Y",1:"N")_","_$S($P($G(iB),"@",5)'="":"Y",1:"N")_","_$S($P($G(iB),"@",4)'="":"Y",1:"N")]]></Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Data>S d1=$S(&apos;$P($G(iB),&quot;@&quot;,16):&quot;Y&quot;,1:&quot;N&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$S(&apos;$P($G(iB),&quot;@&quot;,16):&quot;Y&quot;,1:&quot;N&quot;)</Data>
</Node>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>2</Sub>
<Data>S d1=$TR($P($G(iB),&quot;@&quot;,8,11),&quot;@&quot;,&quot;,&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$TR($P($G(iB),&quot;@&quot;,8,11),&quot;@&quot;,&quot;,&quot;)</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Data>S d1=$S($P($G(iB),&quot;@&quot;,16):&quot;Y&quot;,1:&quot;N&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$S($P($G(iB),&quot;@&quot;,16):&quot;Y&quot;,1:&quot;N&quot;)</Data>
</Node>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>2</Sub>
<Data>S d1=$P($G(iB),&quot;@&quot;,19)</Data>
<Node><Sub>1</Sub>
<Data>$P($G(iB),&quot;@&quot;,19)</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Data>S d1=$S($P($G(iB),&quot;@&quot;,22):&quot;Y&quot;,1:&quot;N&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$S($P($G(iB),&quot;@&quot;,22):&quot;Y&quot;,1:&quot;N&quot;)</Data>
</Node>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>2</Sub>
<Data>S d1=$S($P($G(iB),&quot;@&quot;,19):&quot;Y&quot;,1:&quot;N&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$S($P($G(iB),&quot;@&quot;,19):&quot;Y&quot;,1:&quot;N&quot;)</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Data>S d1=$P($G(iB),&quot;@&quot;,36)</Data>
<Node><Sub>1</Sub>
<Data>$P($G(iB),&quot;@&quot;,36)</Data>
</Node>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>2</Sub>
<Data>S d1=$S($P($G(iB),&quot;@&quot;,27):&quot;N&quot;,1:&quot;Y&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$S($P($G(iB),&quot;@&quot;,27):&quot;N&quot;,1:&quot;Y&quot;)</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Data>S d1=$S($P($G(iB),&quot;@&quot;,15):&quot;Y&quot;,1:&quot;N&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$S($P($G(iB),&quot;@&quot;,15):&quot;Y&quot;,1:&quot;N&quot;)</Data>
</Node>
</Node>
</Node>
<Node><Sub>11</Sub>
<Node><Sub>2</Sub>
<Data>S d1=$TR($P($G(iB),&quot;@&quot;,28,29),&quot;@&quot;,&quot;x&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$TR($P($G(iB),&quot;@&quot;,28,29),&quot;@&quot;,&quot;x&quot;)</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Data>S d1=$S($P($G(iB),&quot;@&quot;,37):&quot;Y&quot;,1:&quot;N&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$S($P($G(iB),&quot;@&quot;,37):&quot;Y&quot;,1:&quot;N&quot;)</Data>
</Node>
</Node>
</Node>
<Node><Sub>12</Sub>
<Node><Sub>2</Sub>
<Data>S d1=$S(&quot;1&quot;[$P($G(iB),&quot;@&quot;,18):&quot;&gt;V&quot;,$P(G(iB),&quot;@&quot;,18)=2:&quot;&gt;^&quot;,$P(G(iB),&quot;@&quot;,18)=3:&quot;&lt;V&quot;,1:&quot;&lt;^&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$S(&quot;1&quot;[$P($G(iB),&quot;@&quot;,18):&quot;&gt;V&quot;,$P(G(iB),&quot;@&quot;,18)=2:&quot;&gt;^&quot;,$P(G(iB),&quot;@&quot;,18)=3:&quot;&lt;V&quot;,1:&quot;&lt;^&quot;)</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Data>S d1=$S($P($G(iB),&quot;@&quot;,20):&quot;Y&quot;,1:&quot;N&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$S($P($G(iB),&quot;@&quot;,20):&quot;Y&quot;,1:&quot;N&quot;)</Data>
</Node>
</Node>
</Node>
<Node><Sub>13</Sub>
<Node><Sub>2</Sub>
<Data>S d1=$S($P($G(iB),&quot;@&quot;,35):$P($G(iB),&quot;@&quot;,35),1:&quot;N&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$S($P($G(iB),&quot;@&quot;,35):$P($G(iB),&quot;@&quot;,35),1:&quot;N&quot;)</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Data>S d1=$S(&apos;$P($G(iB),&quot;@&quot;,16):&quot;Y&quot;,1:&quot;N&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$S(&apos;$P($G(iB),&quot;@&quot;,16):&quot;Y&quot;,1:&quot;N&quot;)</Data>
</Node>
</Node>
</Node>
<Node><Sub>14</Sub>
<Node><Sub>2</Sub>
<Data>S d1=$P($G(%KAT(2)),&quot;@&quot;,39)</Data>
<Node><Sub>1</Sub>
<Data>$P($G(%KAT(2)),&quot;@&quot;,39)</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Data>S d1=$S($P($G(iB),&quot;@&quot;,40):&quot;Y&quot;,1:&quot;N&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$S($P($G(iB),&quot;@&quot;,40):&quot;Y&quot;,1:&quot;N&quot;)</Data>
</Node>
</Node>
</Node>
<Node><Sub>15</Sub>
<Node><Sub>2</Sub>
<Data>S d1=$G(%KAT(5),&quot;нет&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$G(%KAT(5),&quot;нет&quot;)</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Data><![CDATA[S d1=$S($P($G(iB),"@",44)="":"систем",$P($G(iB),"@",44)=0:"нет",$P($G(iB),"@",44)=1:"вниз",$P($G(iB),"@",44)=2:"вправо",1:"?")]]></Data>
<Node><Sub>1</Sub>
<Data><![CDATA[$S($P($G(iB),"@",44)="":"систем",$P($G(iB),"@",44)=0:"нет",$P($G(iB),"@",44)=1:"вниз",$P($G(iB),"@",44)=2:"вправо",1:"?")]]></Data>
</Node>
</Node>
</Node>
<Node><Sub>16</Sub>
<Node><Sub>2</Sub>
<Data>S d1=$S($P($G(iB),&quot;@&quot;,41)=&quot;&quot;:&quot;нет&quot;,1:$P($G(iB),&quot;@&quot;,41))</Data>
<Node><Sub>1</Sub>
<Data>$S($P($G(iB),&quot;@&quot;,41)=&quot;&quot;:&quot;нет&quot;,1:$P($G(iB),&quot;@&quot;,41))</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Data>S d1=$S($P($G(iB),&quot;@&quot;,43):&quot;Y&quot;,1:&quot;N&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$S($P($G(iB),&quot;@&quot;,43):&quot;Y&quot;,1:&quot;N&quot;)</Data>
</Node>
</Node>
</Node>
<Node><Sub>17</Sub>
<Node><Sub>2</Sub>
<Data>S d1=$S($P($G(iB),&quot;@&quot;,42):&quot;Y&quot;,1:&quot;N&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$S($P($G(iB),&quot;@&quot;,42):&quot;Y&quot;,1:&quot;N&quot;)</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Data>S d1=$P($G(%KAT(3)),&quot;@&quot;)_&quot;,&quot;_$P($G(%KAT(3)),&quot;@&quot;,2)</Data>
<Node><Sub>1</Sub>
<Data>$P($G(%KAT(3)),&quot;@&quot;)_&quot;,&quot;_$P($G(%KAT(3)),&quot;@&quot;,2)</Data>
</Node>
</Node>
</Node>
<Node><Sub>18</Sub>
<Node><Sub>2</Sub>
<Data>S d1=$S($P($G(iB),&quot;@&quot;,45):&quot;Y&quot;,1:&quot;N&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$S($P($G(iB),&quot;@&quot;,45):&quot;Y&quot;,1:&quot;N&quot;)</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Data>S d1=$S($P($G(iB),&quot;@&quot;,47):&quot;Y&quot;,1:&quot;N&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$S($P($G(iB),&quot;@&quot;,47):&quot;Y&quot;,1:&quot;N&quot;)</Data>
</Node>
</Node>
</Node>
<Node><Sub>20</Sub>
<Node><Sub>2</Sub>
<Data>S d1=&quot; БАЗЕ ДАННЫХ&quot;</Data>
<Node><Sub>1</Sub>
<Data>&quot; БАЗЕ ДАННЫХ&quot;</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Data>S d1=&quot;, O КЛЕТКЕ&quot;_$G(%KAT(4))</Data>
<Node><Sub>1</Sub>
<Data>&quot;, O КЛЕТКЕ&quot;_$G(%KAT(4))</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Data>S d1=&quot;,ВСЕ&quot;</Data>
<Node><Sub>1</Sub>
<Data>&quot;,ВСЕ&quot;</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>STA</Sub>
<Data>20,3@20@2@27@-1@-1@20@42@D 75^CONVERT</Data>
</Node>
</Node>
<Node><Sub>INFO_ALL</Sub>
<Data><![CDATA[СВОДНЫЙ ОТЧЕТ ПО ТАБЛИЦЕ@@1@@@1@1@9@11@17@65@@@@@1@7@@@1@@@@@1@@@9@1@@1;6;35;44@@@1@@@@@@@MENU^%ZAPM.ed.BSF11]]></Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@55@@@@0@1@@@@@1,1@ФОРМУЛЫ ВЫЧИСЛЕНИЯ</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@55@@@@0@1@@@@@2,1@ФОРМУЛЫ ТРАНСФОРМАЦИИ</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@55@@@@0@1@@@@@3,1@ФОРМУЛЫ ЛОГИЧЕСКОГО КОНТРОЛЯ@</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>4@1@1@55@@@@0@1@@@@@4,1@ФОРМУЛЫ СИНТАКСИЧЕСКОГО КОНТРОЛЯ НА ВВОД@</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>5@1@1@55@@@@0@1@@@@@5,1@ВЫЗОВЫ КОМАНД &quot;MUMPS&quot;@</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>6@1@1@55@@@@0@1@@@@@6,1@ВЫЗОВЫ ТАБЛИЦ@</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>7@1@1@55@@@@0@1@@@@@7,1@ИМЕНА ПОЛЕЙ ВЫВОДА@</Data>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>1</Sub>
<Data>8@1@1@55@@@@0@1@@@@@8,1@ИМЕНА ХРАНЕНИЯ В БАЗЕ ДАННЫХ@</Data>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>1</Sub>
<Data>9@1@1@55@@@@0@1@1;6;31;44@@@@9,1@СВОДНАЯ ИНФОРМАЦИЯ ПО ВСЕЙ ТАБЛИЦЕ@</Data>
</Node>
</Node>
<Node><Sub>CMD</Sub>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>D NNN^%ZAPM.ed.BSN(),FCL^%ZAPM.ed.BSTT,QQQ^%ZAPM.ed.BSN()</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>D NNN^%ZAPM.ed.BSN(),FTR^%ZAPM.ed.BSTT,QQQ^%ZAPM.ed.BSN()</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>D NNN^%ZAPM.ed.BSN(),COL^%ZAPM.ed.BSTT,QQQ^%ZAPM.ed.BSN()</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>D NNN^%ZAPM.ed.BSN(),RTR^%ZAPM.ed.BSTT,QQQ^%ZAPM.ed.BSN()</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>D NNN^%ZAPM.ed.BSN(),CMD^%ZAPM.ed.BSTT,QQQ^%ZAPM.ed.BSN()</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>D NNN^%ZAPM.ed.BSN(),TAB^%ZAPM.ed.BSTT,QQQ^%ZAPM.ed.BSN()</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>D NNN^%ZAPM.ed.BSN(),NAO^%ZAPM.ed.BSTT,QQQ^%ZAPM.ed.BSN()</Data>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>1</Sub>
<Data>D NNN^%ZAPM.ed.BSN(),NAX^%ZAPM.ed.BSTT,QQQ^%ZAPM.ed.BSN()</Data>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>1</Sub>
<Data>D SUMMINFO^%ZAPM.ed.BSrep0</Data>
</Node>
</Node>
</Node>
<Node><Sub>FTR</Sub>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>STA</Sub>
<Data>9,1@1@1@27@-1@-1@17@11@СВОДНАЯ ИНФОРМАЦИЯ ПО ВСЕЙ ТАБЛИЦЕ</Data>
</Node>
<Node><Sub>USM</Sub>
<Data>29@1;6;35;44</Data>
</Node>
</Node>
<Node><Sub>INFO_B</Sub>
<Data><![CDATA[ИНФО ПО БАЗЕ ДАННОЙ@@1@@@1@1@1@1@22@80@1@@1@@1@1@@4,2@1@@@@@1@@@14@19@@1;6;37;44@@@@@@@@@@ViewT^%ZAPM.ed.BSF9]]></Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@3@@@@@1@@@@@@---</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@4@1@9@@@@@1@@@@@@---------</Data>
</Node>
<Node><Sub>3</Sub>
<Data>1@13@1@1@@@@@1@@@@@@-</Data>
</Node>
<Node><Sub>4</Sub>
<Data>1@14@1@11@@@@@1@@@@@@-----------</Data>
</Node>
<Node><Sub>5</Sub>
<Data>1@25@1@1@@@@@1@@@@@@-</Data>
</Node>
<Node><Sub>6</Sub>
<Data>1@26@1@7@@@@@1@@@@@@-------</Data>
</Node>
<Node><Sub>7</Sub>
<Data>1@33@1@1@@@@@1@@@@@@-</Data>
</Node>
<Node><Sub>8</Sub>
<Data>1@34@1@6@@@@@1@@@@@@------</Data>
</Node>
<Node><Sub>9</Sub>
<Data>1@40@1@1@@@@@1@@@@@@-</Data>
</Node>
<Node><Sub>10</Sub>
<Data>1@41@1@7@@@@@1@@@@@@-------</Data>
</Node>
<Node><Sub>11</Sub>
<Data>1@48@1@1@@@@@1@@@@@@-</Data>
</Node>
<Node><Sub>12</Sub>
<Data>1@49@1@7@@@@@1@@@@@@-------</Data>
</Node>
<Node><Sub>13</Sub>
<Data>1@56@1@1@@@@@1@@@@@@-</Data>
</Node>
<Node><Sub>14</Sub>
<Data>1@57@1@6@@@@@1@@@@@@------</Data>
</Node>
<Node><Sub>15</Sub>
<Data>1@63@1@1@@@@@1@@@@@@-</Data>
</Node>
<Node><Sub>16</Sub>
<Data>1@64@1@5@@@@@1@@@@@@-----</Data>
</Node>
<Node><Sub>17</Sub>
<Data>1@69@1@1@@@@@1@@@@@@-</Data>
</Node>
<Node><Sub>18</Sub>
<Data>1@70@1@6@@@@@1@@@@@@------</Data>
</Node>
<Node><Sub>19</Sub>
<Data>1@76@1@1@@@@@1@@@@@@-</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@3@@@@@1@@@@@@|Ба</Data>
</Node>
<Node><Sub>2</Sub>
<Data>2@4@1@9@@@@@1@@@@@@за данных</Data>
</Node>
<Node><Sub>3</Sub>
<Data>2@13@1@1@@@@@1@@@@@@:</Data>
</Node>
<Node><Sub>4</Sub>
<Data>2@14@1@11@@@@0@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>2@25@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>6</Sub>
<Data>2@26@1@7@@@@@1@@@@@@   КИП:</Data>
</Node>
<Node><Sub>7</Sub>
<Data>2@33@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>8</Sub>
<Data>2@34@1@6@@@@0@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>9</Sub>
<Data>2@40@1@1@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>10</Sub>
<Data>2@41@1@7@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>11</Sub>
<Data>2@48@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>12</Sub>
<Data>2@49@1@7@@@@@1@@@@@@   ТОМ:</Data>
</Node>
<Node><Sub>13</Sub>
<Data>2@56@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>14</Sub>
<Data>2@57@1@6@@@@0@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>15</Sub>
<Data>2@63@1@1@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>16</Sub>
<Data>2@64@1@5@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>17</Sub>
<Data>2@69@1@1@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>18</Sub>
<Data>2@70@1@6@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>19</Sub>
<Data>2@76@1@1@@@@@1@@@@@@|</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>3@1@5@3@@@@@1@@@@@@|--|N-|  |пp|--</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@4@5@9@@@@@1@@@@@@---------ключа     текст   иглашения---------</Data>
</Node>
<Node><Sub>3</Sub>
<Data>3@13@5@1@@@@@1@@@@@@-|||+</Data>
</Node>
<Node><Sub>4</Sub>
<Data>3@14@5@11@@@@@1@@@@@@-----------исх.текст  фоpмул СИНТ  контpоля -----------</Data>
</Node>
<Node><Sub>5</Sub>
<Data>3@25@5@1@@@@@1@@@@@@+|||+</Data>
</Node>
<Node><Sub>6</Sub>
<Data>3@26@5@7@@@@@1@@@@@@-------       ТРАНСФР       -------</Data>
</Node>
<Node><Sub>7</Sub>
<Data>3@33@5@1@@@@@1@@@@@@+|||+</Data>
</Node>
<Node><Sub>8</Sub>
<Data>3@34@5@6@@@@@1@@@@@@------       МТБД       ------</Data>
</Node>
<Node><Sub>9</Sub>
<Data>3@40@5@1@@@@@1@@@@@@-|||+</Data>
</Node>
<Node><Sub>10</Sub>
<Data>3@41@5@7@@@@@1@@@@@@-------ПРИКРЕП ТАБЛ ККЛЮЧУ  -------</Data>
</Node>
<Node><Sub>11</Sub>
<Data>3@48@5@1@@@@@1@@@@@@+|||+</Data>
</Node>
<Node><Sub>12</Sub>
<Data>3@49@5@7@@@@@1@@@@@@-------       ОСОБАЯ ВЫБОРКА-------</Data>
</Node>
<Node><Sub>13</Sub>
<Data>3@56@5@1@@@@@1@@@@@@+|||+</Data>
</Node>
<Node><Sub>14</Sub>
<Data>3@57@5@6@@@@@1@@@@@@------                  ------</Data>
</Node>
<Node><Sub>15</Sub>
<Data>3@63@5@1@@@@@1@@@@@@-|||+</Data>
</Node>
<Node><Sub>16</Sub>
<Data>3@64@5@5@@@@@1@@@@@@-----               -----</Data>
</Node>
<Node><Sub>17</Sub>
<Data>3@69@5@1@@@@@1@@@@@@-|||+</Data>
</Node>
<Node><Sub>18</Sub>
<Data>3@70@5@6@@@@@1@@@@@@------                  ------</Data>
</Node>
<Node><Sub>19</Sub>
<Data>3@76@5@1@@@@@1@@@@@@|||||</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>8@1@1@3@@@@@1@@@@@@|0|</Data>
</Node>
<Node><Sub>2</Sub>
<Data>8@4@1@9@@@@0@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>8@13@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>4</Sub>
<Data>8@14@1@11@@@@0@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>8@25@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>6</Sub>
<Data>8@26@1@7@@@@0@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>7</Sub>
<Data>8@33@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>8</Sub>
<Data>8@34@1@6@@@@0@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>9</Sub>
<Data>8@40@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>10</Sub>
<Data>8@41@1@7@@@@0@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>11</Sub>
<Data>8@48@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>12</Sub>
<Data>8@49@1@7@@@@0@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>13</Sub>
<Data>8@56@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>14</Sub>
<Data>8@57@1@6@@@@@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>15</Sub>
<Data>8@63@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>16</Sub>
<Data>8@64@1@5@@@@@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>17</Sub>
<Data>8@69@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>18</Sub>
<Data>8@70@1@6@@@@@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>19</Sub>
<Data>8@76@1@1@@@@@1@@@@@@|</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>9@1@1@3@@@@@1@@@@@@|1|</Data>
</Node>
<Node><Sub>2</Sub>
<Data>9@4@1@9@@@@4,2@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>9@13@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>4</Sub>
<Data>9@14@1@11@@@@4,4@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>9@25@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>6</Sub>
<Data>9@26@1@7@@@@4,6@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>7</Sub>
<Data>9@33@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>8</Sub>
<Data>9@34@1@6@@@@4,8@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>9</Sub>
<Data>9@40@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>10</Sub>
<Data>9@41@1@7@@@@4,10@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>11</Sub>
<Data>9@48@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>12</Sub>
<Data>9@49@1@7@@@@4,12@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>13</Sub>
<Data>9@56@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>14</Sub>
<Data>9@57@1@6@@@@@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>15</Sub>
<Data>9@63@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>16</Sub>
<Data>9@64@1@5@@@@@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>17</Sub>
<Data>9@69@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>18</Sub>
<Data>9@70@1@6@@@@@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>19</Sub>
<Data>9@76@1@1@@@@@1@@@@@@|</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>10@1@1@3@@@@@1@@@@@@|2|</Data>
</Node>
<Node><Sub>2</Sub>
<Data>10@4@1@9@@@@4,2@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>10@13@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>4</Sub>
<Data>10@14@1@11@@@@4,4@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>10@25@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>6</Sub>
<Data>10@26@1@7@@@@4,6@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>7</Sub>
<Data>10@33@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>8</Sub>
<Data>10@34@1@6@@@@4,8@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>9</Sub>
<Data>10@40@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>10</Sub>
<Data>10@41@1@7@@@@4,10@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>11</Sub>
<Data>10@48@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>12</Sub>
<Data>10@49@1@7@@@@4,12@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>13</Sub>
<Data>10@56@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>14</Sub>
<Data>10@57@1@6@@@@@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>15</Sub>
<Data>10@63@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>16</Sub>
<Data>10@64@1@5@@@@@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>17</Sub>
<Data>10@69@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>18</Sub>
<Data>10@70@1@6@@@@@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>19</Sub>
<Data>10@76@1@1@@@@@1@@@@@@|</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>11@1@1@3@@@@@1@@@@@@|3|</Data>
</Node>
<Node><Sub>2</Sub>
<Data>11@4@1@9@@@@4,2@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>11@13@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>4</Sub>
<Data>11@14@1@11@@@@4,4@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>11@25@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>6</Sub>
<Data>11@26@1@7@@@@4,6@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>7</Sub>
<Data>11@33@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>8</Sub>
<Data>11@34@1@6@@@@4,8@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>9</Sub>
<Data>11@40@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>10</Sub>
<Data>11@41@1@7@@@@4,10@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>11</Sub>
<Data>11@48@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>12</Sub>
<Data>11@49@1@7@@@@4,12@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>13</Sub>
<Data>11@56@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>14</Sub>
<Data>11@57@1@6@@@@@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>15</Sub>
<Data>11@63@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>16</Sub>
<Data>11@64@1@5@@@@@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>17</Sub>
<Data>11@69@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>18</Sub>
<Data>11@70@1@6@@@@@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>19</Sub>
<Data>11@76@1@1@@@@@1@@@@@@|</Data>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>1</Sub>
<Data>12@1@1@3@@@@@1@@@@@@|4|</Data>
</Node>
<Node><Sub>2</Sub>
<Data>12@4@1@9@@@@4,2@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>12@13@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>4</Sub>
<Data>12@14@1@11@@@@4,4@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>12@25@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>6</Sub>
<Data>12@26@1@7@@@@4,6@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>7</Sub>
<Data>12@33@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>8</Sub>
<Data>12@34@1@6@@@@4,8@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>9</Sub>
<Data>12@40@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>10</Sub>
<Data>12@41@1@7@@@@4,10@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>11</Sub>
<Data>12@48@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>12</Sub>
<Data>12@49@1@7@@@@4,12@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>13</Sub>
<Data>12@56@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>14</Sub>
<Data>12@57@1@6@@@@@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>15</Sub>
<Data>12@63@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>16</Sub>
<Data>12@64@1@5@@@@@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>17</Sub>
<Data>12@69@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>18</Sub>
<Data>12@70@1@6@@@@@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>19</Sub>
<Data>12@76@1@1@@@@@1@@@@@@|</Data>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>1</Sub>
<Data>13@1@1@3@@@@@1@@@@@@|5|</Data>
</Node>
<Node><Sub>2</Sub>
<Data>13@4@1@9@@@@4,2@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>13@13@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>4</Sub>
<Data>13@14@1@11@@@@4,4@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>13@25@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>6</Sub>
<Data>13@26@1@7@@@@4,6@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>7</Sub>
<Data>13@33@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>8</Sub>
<Data>13@34@1@6@@@@4,8@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>9</Sub>
<Data>13@40@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>10</Sub>
<Data>13@41@1@7@@@@4,10@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>11</Sub>
<Data>13@48@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>12</Sub>
<Data>13@49@1@7@@@@4,12@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>13</Sub>
<Data>13@56@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>14</Sub>
<Data>13@57@1@6@@@@@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>15</Sub>
<Data>13@63@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>16</Sub>
<Data>13@64@1@5@@@@@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>17</Sub>
<Data>13@69@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>18</Sub>
<Data>13@70@1@6@@@@@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>19</Sub>
<Data>13@76@1@1@@@@@1@@@@@@|</Data>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>1</Sub>
<Data>14@1@1@3@@@@@1@@@@@@|6|</Data>
</Node>
<Node><Sub>2</Sub>
<Data>14@4@1@9@@@@4,2@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>14@13@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>4</Sub>
<Data>14@14@1@11@@@@4,4@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>14@25@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>6</Sub>
<Data>14@26@1@7@@@@4,6@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>7</Sub>
<Data>14@33@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>8</Sub>
<Data>14@34@1@6@@@@4,8@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>9</Sub>
<Data>14@40@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>10</Sub>
<Data>14@41@1@7@@@@4,10@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>11</Sub>
<Data>14@48@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>12</Sub>
<Data>14@49@1@7@@@@4,12@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>13</Sub>
<Data>14@56@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>14</Sub>
<Data>14@57@1@6@@@@@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>15</Sub>
<Data>14@63@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>16</Sub>
<Data>14@64@1@5@@@@@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>17</Sub>
<Data>14@69@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>18</Sub>
<Data>14@70@1@6@@@@@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>19</Sub>
<Data>14@76@1@1@@@@@1@@@@@@|</Data>
</Node>
</Node>
<Node><Sub>11</Sub>
<Node><Sub>1</Sub>
<Data>15@1@1@3@@@@@1@@@@@@|7|</Data>
</Node>
<Node><Sub>2</Sub>
<Data>15@4@1@9@@@@4,2@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>15@13@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>4</Sub>
<Data>15@14@1@11@@@@4,4@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>15@25@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>6</Sub>
<Data>15@26@1@7@@@@4,6@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>7</Sub>
<Data>15@33@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>8</Sub>
<Data>15@34@1@6@@@@4,8@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>9</Sub>
<Data>15@40@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>10</Sub>
<Data>15@41@1@7@@@@4,10@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>11</Sub>
<Data>15@48@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>12</Sub>
<Data>15@49@1@7@@@@4,12@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>13</Sub>
<Data>15@56@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>14</Sub>
<Data>15@57@1@6@@@@@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>15</Sub>
<Data>15@63@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>16</Sub>
<Data>15@64@1@5@@@@@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>17</Sub>
<Data>15@69@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>18</Sub>
<Data>15@70@1@6@@@@@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>19</Sub>
<Data>15@76@1@1@@@@@1@@@@@@|</Data>
</Node>
</Node>
<Node><Sub>12</Sub>
<Node><Sub>1</Sub>
<Data>16@1@1@3@@@@@1@@@@@@|8|</Data>
</Node>
<Node><Sub>2</Sub>
<Data>16@4@1@9@@@@4,2@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>16@13@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>4</Sub>
<Data>16@14@1@11@@@@4,4@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>16@25@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>6</Sub>
<Data>16@26@1@7@@@@4,6@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>7</Sub>
<Data>16@33@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>8</Sub>
<Data>16@34@1@6@@@@4,8@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>9</Sub>
<Data>16@40@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>10</Sub>
<Data>16@41@1@7@@@@4,10@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>11</Sub>
<Data>16@48@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>12</Sub>
<Data>16@49@1@7@@@@4,12@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>13</Sub>
<Data>16@56@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>14</Sub>
<Data>16@57@1@6@@@@@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>15</Sub>
<Data>16@63@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>16</Sub>
<Data>16@64@1@5@@@@@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>17</Sub>
<Data>16@69@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>18</Sub>
<Data>16@70@1@6@@@@@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>19</Sub>
<Data>16@76@1@1@@@@@1@@@@@@|</Data>
</Node>
</Node>
<Node><Sub>13</Sub>
<Node><Sub>1</Sub>
<Data>17@1@1@3@@@@@1@@@@@@|9|</Data>
</Node>
<Node><Sub>2</Sub>
<Data>17@4@1@9@@@@4,2@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>17@13@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>4</Sub>
<Data>17@14@1@11@@@@4,4@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>17@25@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>6</Sub>
<Data>17@26@1@7@@@@4,6@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>7</Sub>
<Data>17@33@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>8</Sub>
<Data>17@34@1@6@@@@4,8@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>9</Sub>
<Data>17@40@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>10</Sub>
<Data>17@41@1@7@@@@4,10@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>11</Sub>
<Data>17@48@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>12</Sub>
<Data>17@49@1@7@@@@4,12@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>13</Sub>
<Data>17@56@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>14</Sub>
<Data>17@57@1@6@@@@@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>15</Sub>
<Data>17@63@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>16</Sub>
<Data>17@64@1@5@@@@@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>17</Sub>
<Data>17@69@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>18</Sub>
<Data>17@70@1@6@@@@@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>19</Sub>
<Data>17@76@1@1@@@@@1@@@@@@|</Data>
</Node>
</Node>
<Node><Sub>14</Sub>
<Node><Sub>1</Sub>
<Data>18@1@1@3@@@@@1@@@@@@---</Data>
</Node>
<Node><Sub>2</Sub>
<Data>18@4@1@9@@@@@1@@@@@@---------</Data>
</Node>
<Node><Sub>3</Sub>
<Data>18@13@1@1@@@@@1@@@@@@-</Data>
</Node>
<Node><Sub>4</Sub>
<Data>18@14@1@11@@@@@1@@@@@@-----------</Data>
</Node>
<Node><Sub>5</Sub>
<Data>18@25@1@1@@@@@1@@@@@@-</Data>
</Node>
<Node><Sub>6</Sub>
<Data>18@26@1@7@@@@@1@@@@@@-------</Data>
</Node>
<Node><Sub>7</Sub>
<Data>18@33@1@1@@@@@1@@@@@@-</Data>
</Node>
<Node><Sub>8</Sub>
<Data>18@34@1@6@@@@@1@@@@@@------</Data>
</Node>
<Node><Sub>9</Sub>
<Data>18@40@1@1@@@@@1@@@@@@-</Data>
</Node>
<Node><Sub>10</Sub>
<Data>18@41@1@7@@@@@1@@@@@@-------</Data>
</Node>
<Node><Sub>11</Sub>
<Data>18@48@1@1@@@@@1@@@@@@-</Data>
</Node>
<Node><Sub>12</Sub>
<Data>18@49@1@7@@@@@1@@@@@@-------</Data>
</Node>
<Node><Sub>13</Sub>
<Data>18@56@1@1@@@@@1@@@@@@-</Data>
</Node>
<Node><Sub>14</Sub>
<Data>18@57@1@6@@@@@1@@@@@@------</Data>
</Node>
<Node><Sub>15</Sub>
<Data>18@63@1@1@@@@@1@@@@@@-</Data>
</Node>
<Node><Sub>16</Sub>
<Data>18@64@1@5@@@@@1@@@@@@-----</Data>
</Node>
<Node><Sub>17</Sub>
<Data>18@69@1@1@@@@@1@@@@@@-</Data>
</Node>
<Node><Sub>18</Sub>
<Data>18@70@1@6@@@@@1@@@@@@------</Data>
</Node>
<Node><Sub>19</Sub>
<Data>18@76@1@1@@@@@1@@@@@@-</Data>
</Node>
</Node>
<Node><Sub>FTR</Sub>
<Node><Sub>2</Sub>
<Node><Sub>4</Sub>
<Data>S d1=$S($P($G(%KAT(5)),&quot;]&quot;,2)=&quot;&quot;:$G(%KAT(5)),1:$P($G(%KAT(5)),&quot;]&quot;,2))</Data>
<Node><Sub>1</Sub>
<Data>$S($P($G(%KAT(5)),&quot;]&quot;,2)=&quot;&quot;:$G(%KAT(5)),1:$P($G(%KAT(5)),&quot;]&quot;,2))</Data>
</Node>
</Node>
<Node><Sub>8</Sub>
<Data>S d1=$P($P($G(%KAT(5)),&quot;[&quot;,2),&quot;,&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$P($P($G(%KAT(5)),&quot;[&quot;,2),&quot;,&quot;)</Data>
</Node>
</Node>
<Node><Sub>14</Sub>
<Data>S d1=$P($P($G(%KAT(5)),&quot;]&quot;,1),&quot;,&quot;,2)</Data>
<Node><Sub>1</Sub>
<Data>$P($P($G(%KAT(5)),&quot;]&quot;,1),&quot;,&quot;,2)</Data>
</Node>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>2</Sub>
<Data>S d1=$P($G(%KAT(5,ny-4)),&quot;@&quot;,15)</Data>
<Node><Sub>1</Sub>
<Data>$P($G(%KAT(5,ny-4)),&quot;@&quot;,15)</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Data>S d1=$G(%KAT(5,ny-4,2))</Data>
<Node><Sub>1</Sub>
<Data>$G(%KAT(5,ny-4,2))</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Data>S d1=$G(%KAT(5,ny-4,4))</Data>
<Node><Sub>1</Sub>
<Data>$G(%KAT(5,ny-4,4))</Data>
</Node>
</Node>
<Node><Sub>8</Sub>
<Data>S d1=$G(%KAT(5,ny-4,6))</Data>
<Node><Sub>1</Sub>
<Data>$G(%KAT(5,ny-4,6))</Data>
</Node>
</Node>
<Node><Sub>10</Sub>
<Data>S d1=$P($G(%KAT(5,ny-4)),&quot;@&quot;,14)</Data>
<Node><Sub>1</Sub>
<Data>$P($G(%KAT(5,ny-4)),&quot;@&quot;,14)</Data>
</Node>
</Node>
<Node><Sub>12</Sub>
<Data>S d1=$G(%KAT(5,ny-4,10))</Data>
<Node><Sub>1</Sub>
<Data>$G(%KAT(5,ny-4,10))</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>STA</Sub>
<Data>4,2@4@2@27@-1@-1@8@4@</Data>
</Node>
</Node>
<Node><Sub>INFO_K</Sub>
<Data>ИНФО ПО ТЕКУЩЕЙ КЛЕТКЕ@@@@@1@1@1@1@22@80@1@@1@@@1@@@1@@@@@1@@@21@5@@1;6;37;44@@@@@@</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@17@@@@@1@@@@@@-----------------</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@18@1@5@@@@@1@@@@@@-----</Data>
</Node>
<Node><Sub>3</Sub>
<Data>1@23@1@1@@@@@1@@@@@@-</Data>
</Node>
<Node><Sub>4</Sub>
<Data>1@24@1@52@@@@@1@@@@@@----------------------------------------------------</Data>
</Node>
<Node><Sub>5</Sub>
<Data>1@76@1@1@@@@@1@@@@@@-</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@17@@@@@1@@@@@@|СИМВ.ИМЯ ВЫВОДА|</Data>
</Node>
<Node><Sub>2</Sub>
<Data>2@18@1@5@@@@0@1@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>2@23@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>4</Sub>
<Data>2@24@1@52@@@@0@1@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>2@76@1@1@@@@@1@@@@@@|</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@17@@@@@1@@@@@@|               |</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@18@1@5@@@1@@1@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>3@23@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>4</Sub>
<Data>3@24@1@52@@@@0@1@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>3@76@1@1@@@@@1@@@@@@|</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>4@1@1@17@@@@@1@@@@@@|---------------+</Data>
</Node>
<Node><Sub>2</Sub>
<Data>4@18@1@5@@@@@1@@@@@@-----</Data>
</Node>
<Node><Sub>3</Sub>
<Data>4@23@1@1@@@@@1@@@@@@+</Data>
</Node>
<Node><Sub>4</Sub>
<Data>4@24@1@52@@@@@1@@@@@@----------------------------------------------------</Data>
</Node>
<Node><Sub>5</Sub>
<Data>4@76@1@1@@@@@1@@@@@@|</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>5@1@1@17@@@@@1@@@@@@| ВЫЧ     ИСХ   |</Data>
</Node>
<Node><Sub>2</Sub>
<Data>5@18@1@5@@@1@@1@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>5@23@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>4</Sub>
<Data>5@24@1@52@@@1@@1@1;6;32;44@@@@@-</Data>
</Node>
<Node><Sub>5</Sub>
<Data>5@76@1@1@@@@@1@@@@@@|</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>6@1@1@17@@@@@1@@@@@@|         ИСП   |</Data>
</Node>
<Node><Sub>2</Sub>
<Data>6@18@1@5@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>6@23@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>4</Sub>
<Data>6@24@1@52@@@1@@1@1;6;32;44@@@@@-</Data>
</Node>
<Node><Sub>5</Sub>
<Data>6@76@1@1@@@@@1@@@@@@|</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>7@1@1@17@@@@@1@@@@@@|---------------+</Data>
</Node>
<Node><Sub>2</Sub>
<Data>7@18@1@5@@@@@1@@@@@@-----</Data>
</Node>
<Node><Sub>3</Sub>
<Data>7@23@1@1@@@@@1@@@@@@+</Data>
</Node>
<Node><Sub>4</Sub>
<Data>7@24@1@52@@@@@1@@@@@@----------------------------------------------------</Data>
</Node>
<Node><Sub>5</Sub>
<Data>7@76@1@1@@@@@1@@@@@@|</Data>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>1</Sub>
<Data>8@1@1@17@@@@@1@@@@@@| ТРАНС   ИСХ   |</Data>
</Node>
<Node><Sub>2</Sub>
<Data>8@18@1@5@@@1@@1@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>8@23@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>4</Sub>
<Data>8@24@1@52@@@1@@1@1;6;32;44@@@@@-</Data>
</Node>
<Node><Sub>5</Sub>
<Data>8@76@1@1@@@@@1@@@@@@|</Data>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>1</Sub>
<Data>9@1@1@17@@@@@1@@@@@@|         ИСП   |</Data>
</Node>
<Node><Sub>2</Sub>
<Data>9@18@1@5@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>9@23@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>4</Sub>
<Data>9@24@1@52@@@1@@1@1;6;32;44@@@@@-</Data>
</Node>
<Node><Sub>5</Sub>
<Data>9@76@1@1@@@@@1@@@@@@|</Data>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>1</Sub>
<Data>10@1@1@17@@@@@1@@@@@@|---------------+</Data>
</Node>
<Node><Sub>2</Sub>
<Data>10@18@1@5@@@@@1@@@@@@-----</Data>
</Node>
<Node><Sub>3</Sub>
<Data>10@23@1@1@@@@@1@@@@@@+</Data>
</Node>
<Node><Sub>4</Sub>
<Data>10@24@1@52@@@@@1@@@@@@----------------------------------------------------</Data>
</Node>
<Node><Sub>5</Sub>
<Data>10@76@1@1@@@@@1@@@@@@|</Data>
</Node>
</Node>
<Node><Sub>11</Sub>
<Node><Sub>1</Sub>
<Data>11@1@1@17@@@@@1@@@@@@| СИНТ    ИСХ   |</Data>
</Node>
<Node><Sub>2</Sub>
<Data>11@18@1@5@@@1@@1@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>11@23@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>4</Sub>
<Data>11@24@1@52@@@1@@1@1;6;32;44@@@@@-</Data>
</Node>
<Node><Sub>5</Sub>
<Data>11@76@1@1@@@@@1@@@@@@|</Data>
</Node>
</Node>
<Node><Sub>12</Sub>
<Node><Sub>1</Sub>
<Data>12@1@1@17@@@@@1@@@@@@|         ИСП   |</Data>
</Node>
<Node><Sub>2</Sub>
<Data>12@18@1@5@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>12@23@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>4</Sub>
<Data>12@24@1@52@@@1@@1@1;6;32;44@@@@@-</Data>
</Node>
<Node><Sub>5</Sub>
<Data>12@76@1@1@@@@@1@@@@@@|</Data>
</Node>
</Node>
<Node><Sub>13</Sub>
<Node><Sub>1</Sub>
<Data>13@1@1@17@@@@@1@@@@@@|---------------+</Data>
</Node>
<Node><Sub>2</Sub>
<Data>13@18@1@5@@@@@1@@@@@@-----</Data>
</Node>
<Node><Sub>3</Sub>
<Data>13@23@1@1@@@@@1@@@@@@+</Data>
</Node>
<Node><Sub>4</Sub>
<Data>13@24@1@52@@@@@1@@@@@@----------------------------------------------------</Data>
</Node>
<Node><Sub>5</Sub>
<Data>13@76@1@1@@@@@1@@@@@@|</Data>
</Node>
</Node>
<Node><Sub>14</Sub>
<Node><Sub>1</Sub>
<Data>14@1@1@17@@@@@1@@@@@@| ЛОГ     ИСХ   |</Data>
</Node>
<Node><Sub>2</Sub>
<Data>14@18@1@5@@@1@@1@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>14@23@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>4</Sub>
<Data>14@24@1@52@@@1@@1@1;6;32;44@@@@@-</Data>
</Node>
<Node><Sub>5</Sub>
<Data>14@76@1@1@@@@@1@@@@@@|</Data>
</Node>
</Node>
<Node><Sub>15</Sub>
<Node><Sub>1</Sub>
<Data>15@1@1@17@@@@@1@@@@@@|         ИСП   |</Data>
</Node>
<Node><Sub>2</Sub>
<Data>15@18@1@5@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>15@23@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>4</Sub>
<Data>15@24@1@52@@@1@@1@1;6;32;44@@@@@-</Data>
</Node>
<Node><Sub>5</Sub>
<Data>15@76@1@1@@@@@1@@@@@@|</Data>
</Node>
</Node>
<Node><Sub>16</Sub>
<Node><Sub>1</Sub>
<Data>16@1@1@17@@@@@1@@@@@@|ТЕКСТ ОБ ОШИБКЕ|@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>16@18@1@5@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>16@23@1@1@@@@@1@@@@@@|@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>16@24@1@52@@@1@@1@1;6;32;44@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>16@76@1@1@@@@@1@@@@@@|@</Data>
</Node>
</Node>
<Node><Sub>17</Sub>
<Node><Sub>1</Sub>
<Data>17@1@1@17@@@@@1@@@@@@|---------------+</Data>
</Node>
<Node><Sub>2</Sub>
<Data>17@18@1@5@@@@@1@@@@@@-----</Data>
</Node>
<Node><Sub>3</Sub>
<Data>17@23@1@1@@@@@1@@@@@@+</Data>
</Node>
<Node><Sub>4</Sub>
<Data>17@24@1@52@@@@@1@@@@@@----------------------------------------------------</Data>
</Node>
<Node><Sub>5</Sub>
<Data>17@76@1@1@@@@@1@@@@@@|</Data>
</Node>
</Node>
<Node><Sub>18</Sub>
<Node><Sub>1</Sub>
<Data>18@1@1@17@@@@@1@@@@@@| ВХОД В ТАБЛИЦУ|</Data>
</Node>
<Node><Sub>2</Sub>
<Data>18@18@1@5@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>18@23@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>4</Sub>
<Data>18@24@1@52@@@1@@1@1;6;32;44@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>18@76@1@1@@@@@1@@@@@@|</Data>
</Node>
</Node>
<Node><Sub>19</Sub>
<Node><Sub>1</Sub>
<Data>19@1@1@17@@@@@1@@@@@@| КОМАНДА MUMPSa|</Data>
</Node>
<Node><Sub>2</Sub>
<Data>19@18@1@5@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>19@23@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>4</Sub>
<Data>19@24@1@52@@@1@@1@1;6;32;44@@@@@-</Data>
</Node>
<Node><Sub>5</Sub>
<Data>19@76@1@1@@@@@1@@@@@@|</Data>
</Node>
</Node>
<Node><Sub>20</Sub>
<Node><Sub>1</Sub>
<Data>20@1@1@17@@@@@1@@@@@@| HELP на КЛЕТКУ|</Data>
</Node>
<Node><Sub>2</Sub>
<Data>20@18@1@5@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>20@23@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>4</Sub>
<Data>20@24@1@52@@@1@@1@1;6;32;44@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>20@76@1@1@@@@@1@@@@@@|</Data>
</Node>
</Node>
<Node><Sub>21</Sub>
<Node><Sub>1</Sub>
<Data>21@1@1@17@@@@@1@@@@@@-----------------</Data>
</Node>
<Node><Sub>2</Sub>
<Data>21@18@1@5@@@@@1@@@@@@-----</Data>
</Node>
<Node><Sub>3</Sub>
<Data>21@23@1@1@@@@@1@@@@@@-</Data>
</Node>
<Node><Sub>4</Sub>
<Data>21@24@1@52@@@@@1@@@@@@----------------------------------------------------</Data>
</Node>
<Node><Sub>5</Sub>
<Data>21@76@1@1@@@@@1@@@@@@-</Data>
</Node>
</Node>
<Node><Sub>FCL</Sub>
<Node><Sub>3</Sub>
<Node><Sub>2</Sub>
<Data>S d1=&quot;&quot; S iB=$G(%KAT(2)),iS=$G(%KAT(3))</Data>
<Node><Sub>1</Sub>
<Data>&quot;&quot; S iB=$G(%KAT(2)),iS=$G(%KAT(3))</Data>
</Node>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>2</Sub>
<Data>S d1=$P($G(iS),&quot;@&quot;,7)</Data>
<Node><Sub>1</Sub>
<Data>$P($G(iS),&quot;@&quot;,7)</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Data>S d1=$G(%KAT(4,&quot;FCL&quot;,1),&quot;-&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$G(%KAT(4,&quot;FCL&quot;,1),&quot;-&quot;)</Data>
</Node>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>4</Sub>
<Data>S d1=$G(%KAT(4,&quot;FCL&quot;),&quot;-&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$G(%KAT(4,&quot;FCL&quot;),&quot;-&quot;)</Data>
</Node>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>2</Sub>
<Data>S d1=$P($G(iS),&quot;@&quot;,8)</Data>
<Node><Sub>1</Sub>
<Data>$P($G(iS),&quot;@&quot;,8)</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Data>S d1=$G(%KAT(4,&quot;FTR&quot;,1),&quot;-&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$G(%KAT(4,&quot;FTR&quot;,1),&quot;-&quot;)</Data>
</Node>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>4</Sub>
<Data>S d1=$G(%KAT(4,&quot;FTR&quot;),&quot;-&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$G(%KAT(4,&quot;FTR&quot;),&quot;-&quot;)</Data>
</Node>
</Node>
</Node>
<Node><Sub>11</Sub>
<Node><Sub>2</Sub>
<Data>S d1=$P($G(iS),&quot;@&quot;,16)</Data>
<Node><Sub>1</Sub>
<Data>$P($G(iS),&quot;@&quot;,16)</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Data>S d1=$G(%KAT(4,&quot;RTR&quot;,1),&quot;-&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$G(%KAT(4,&quot;RTR&quot;,1),&quot;-&quot;)</Data>
</Node>
</Node>
</Node>
<Node><Sub>12</Sub>
<Node><Sub>4</Sub>
<Data>S d1=$G(%KAT(4,&quot;RTR&quot;),&quot;-&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$G(%KAT(4,&quot;RTR&quot;),&quot;-&quot;)</Data>
</Node>
</Node>
</Node>
<Node><Sub>14</Sub>
<Node><Sub>2</Sub>
<Data>S d1=$P($G(iS),&quot;@&quot;,13)</Data>
<Node><Sub>1</Sub>
<Data>$P($G(iS),&quot;@&quot;,13)</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Data>S d1=$G(%KAT(4,&quot;COL&quot;,1),&quot;-&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$G(%KAT(4,&quot;COL&quot;,1),&quot;-&quot;)</Data>
</Node>
</Node>
</Node>
<Node><Sub>15</Sub>
<Node><Sub>4</Sub>
<Data>S d1=$G(%KAT(4,&quot;COL&quot;),&quot;-&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$G(%KAT(4,&quot;COL&quot;),&quot;-&quot;)</Data>
</Node>
</Node>
</Node>
<Node><Sub>16</Sub>
<Node><Sub>4</Sub>
<Data>S d1=$G(%KAT(4,&quot;COL&quot;,2))</Data>
<Node><Sub>1</Sub>
<Data>$G(%KAT(4,&quot;COL&quot;,2))</Data>
</Node>
</Node>
</Node>
<Node><Sub>18</Sub>
<Node><Sub>4</Sub>
<Data>S d1=$S($P($G(%KAT(3)),&quot;@&quot;,14):&quot;&quot;,1:$P($G(%KAT(3)),&quot;@&quot;,14))</Data>
<Node><Sub>1</Sub>
<Data>$S($P($G(%KAT(3)),&quot;@&quot;,14):&quot;&quot;,1:$P($G(%KAT(3)),&quot;@&quot;,14))</Data>
</Node>
</Node>
</Node>
<Node><Sub>19</Sub>
<Node><Sub>4</Sub>
<Data>S d1=$G(%KAT(4,&quot;CMD&quot;),&quot;-&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$G(%KAT(4,&quot;CMD&quot;),&quot;-&quot;)</Data>
</Node>
</Node>
</Node>
<Node><Sub>20</Sub>
<Node><Sub>4</Sub>
<Data>S d1=$P($G(%KAT(3)),&quot;@&quot;,39)</Data>
<Node><Sub>1</Sub>
<Data>$P($G(%KAT(3)),&quot;@&quot;,39)</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>FTR</Sub>
<Node><Sub>2</Sub>
<Node><Sub>2</Sub>
<Data>S d1=$P($P($G(%KAT(3)),&quot;@&quot;,18),&quot;#&quot;,2)</Data>
<Node><Sub>1</Sub>
<Data>$P($P($G(%KAT(3)),&quot;@&quot;,18),&quot;#&quot;,2)</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Data>S d1=&quot; СИМВОЛЬНОЕ ИМЯ ХРАНЕНИЯ В БД:&quot;_$P($P($G(%KAT(3)),&quot;@&quot;,18),&quot;#&quot;,1)</Data>
<Node><Sub>1</Sub>
<Data>&quot; СИМВОЛЬНОЕ ИМЯ ХРАНЕНИЯ В БД:&quot;_$P($P($G(%KAT(3)),&quot;@&quot;,18),&quot;#&quot;,1)</Data>
</Node>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>4</Sub>
<Data>S d1=&quot; АБСОЛЮТНЫЕ КООРДИНАТЫ КЛЕТКИ Y,X:   &quot;_$TR($P($G(%KAT(3)),&quot;@&quot;,1,2),&quot;@&quot;,&quot;,&quot;)</Data>
<Node><Sub>1</Sub>
<Data>&quot; АБСОЛЮТНЫЕ КООРДИНАТЫ КЛЕТКИ Y,X:   &quot;_$TR($P($G(%KAT(3)),&quot;@&quot;,1,2),&quot;@&quot;,&quot;,&quot;)</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>STA</Sub>
<Data>20,4@1@1@27@-1@-1@1@1@</Data>
</Node>
</Node>
<Node><Sub>INSTALL</Sub>
<Data>ТАБЛИЦА ГЕНЕРАЦИЙ ПРИЛОЖЕНИЙ@@@@@1@1@2@2@20@79@@@@@@1@@@1@@@@@@@@18@5@@1;6;35;44@@@@@@@1@@@@@1</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@3@1@@@0@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@4@1@56@1@@@@1@2;6;37;44@@@@@И н с т а л л я ц и я   П р и л о ж е н и я  д л я  %BS@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>1@60@1@3@1@@@@1@2;6;37;44@@@@@Ver@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>1@63@1@13@1@@@0@1@2;6;37;44@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>1@76@1@3@1@@@@1@2;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@3@1@@@@1@2;6;37;44@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>2@4@1@56@1@@@@1@2;6;37;44@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>2@60@1@3@1@@@@1@2;6;37;44@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>2@63@1@13@1@@@@1@2;6;37;44@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>2@76@1@3@1@@@@1@2;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>3@1@2@3@1@@@0@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@4@2@56@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>3@60@2@3@1@@@@1@2;6;37;44@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>3@63@2@13@1@@@0@1@2;6;37;44@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>3@76@2@3@1@@@@1@2;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>5@1@1@3@1@@@0@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>5@4@1@56@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>5@60@1@3@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>5@63@1@13@1@@@@1@1;6;37;44@@@@@  кип,том@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>5@76@1@3@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>6@1@1@3@1@@@0@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>6@4@1@56@1@@@@1@2;6;37;44@@@@@Безусловная трансляция текущего КИПа,ТОМа приложения ...@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>6@60@1@3@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>6@63@1@13@@@1@0@1@2;6;30;46@@@@@MGR,MSW@0</Data>
</Node>
<Node><Sub>5</Sub>
<Data>6@76@1@3@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>7@1@1@3@1@@@0@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>7@4@1@56@1@@@@1@1;6;37;44@@@@@  Введите приглашение для трансляции пути Кип,Том .....@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>7@60@1@3@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>7@63@1@13@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>7@76@1@3@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>8@1@1@3@1@@@0@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>8@4@1@56@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>8@60@1@3@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>8@63@1@13@@@@5,4@1@2;6;30;46@@@@@@5,4</Data>
</Node>
<Node><Sub>5</Sub>
<Data>8@76@1@3@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>1</Sub>
<Data>9@1@1@3@1@@@0@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>9@4@1@56@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>9@60@1@3@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>9@63@1@13@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>9@76@1@3@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>1</Sub>
<Data>10@1@1@3@1@@@0@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>10@4@1@56@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>10@60@1@3@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>10@63@1@13@@@@5,4@1@2;6;30;46@@@@@@5,4</Data>
</Node>
<Node><Sub>5</Sub>
<Data>10@76@1@3@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>1</Sub>
<Data>11@1@1@3@1@@@0@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>11@4@1@56@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>11@60@1@3@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>11@63@1@13@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>11@76@1@3@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>11</Sub>
<Node><Sub>1</Sub>
<Data>12@1@1@3@1@@@0@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>12@4@1@56@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>12@60@1@3@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>12@63@1@13@@@@5,4@1@2;6;30;46@@@@@@5,4</Data>
</Node>
<Node><Sub>5</Sub>
<Data>12@76@1@3@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>12</Sub>
<Node><Sub>1</Sub>
<Data>13@1@1@3@1@@@0@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>13@4@1@56@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>13@60@1@3@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>13@63@1@13@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>13@76@1@3@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>13</Sub>
<Node><Sub>1</Sub>
<Data>14@1@1@3@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>14@4@1@56@@@@@1@2;6;30;45@@@@13,2@  Выбор Всех массивов для приложения (нажмите &lt;Enter&gt;)@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>14@60@1@3@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>14@63@1@13@@@@5,4@1@2;6;30;45@@@@13,4@ Программы@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>14@76@1@3@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>14</Sub>
<Node><Sub>1</Sub>
<Data>15@1@1@3@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>15@4@1@56@@@@@1@2;6;30;45@@@@14,2@    Выбор НЕТранслируемых массивов (нажмите &lt;Enter&gt;)@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>15@60@1@3@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>15@63@1@13@1@@@@1@1;6;37;44@@@@@   команда@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>15@76@1@3@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>15</Sub>
<Node><Sub>1</Sub>
<Data>16@1@1@3@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>16@4@1@56@1@@@@1@1;6;37;44@@@@@   Введите команды MUMPS ,которые надо выполнить при@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>16@60@1@3@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>16@63@1@13@@@@5,4@1@2;6;30;46@@@@@@@@@@@3,50</Data>
</Node>
<Node><Sub>5</Sub>
<Data>16@76@1@3@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>16</Sub>
<Node><Sub>1</Sub>
<Data>17@1@1@3@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>17@4@1@56@1@@@@1@1;6;37;44@@@@@          инсталляции вашего приложения. @</Data>
</Node>
<Node><Sub>3</Sub>
<Data>17@60@1@3@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>17@63@1@13@1@@@@1@1;6;37;44@@@@@    (Y/N)@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>17@76@1@3@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>17</Sub>
<Node><Sub>1</Sub>
<Data>18@1@1@3@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>18@4@1@56@1@@@@1@1;6;37;44@@@@@Введите подтверждение или отказ (Y/N) сохранения значе-@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>18@60@1@3@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>18@63@1@13@@@@5,4@1@2;6;30;46@@@@^%ZAPM.ed.BSS(&quot;YES&quot;)@N@0</Data>
</Node>
<Node><Sub>5</Sub>
<Data>18@76@1@3@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>18</Sub>
<Node><Sub>1</Sub>
<Data>19@1@1@3@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>19@4@1@56@1@@@@1@1;6;37;44@@@@@     ний характеристик защиты массивов приложения.@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>19@60@1@3@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>19@63@1@13@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>19@76@1@3@1@@@@1@1;6;37;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>CMD</Sub>
<Node><Sub>13</Sub>
<Node><Sub>2</Sub>
<Data><![CDATA[W #,!," *** ВЫБЕРИТЕ ВСЕ МАССИВЫ ДЛЯ ПРИЛОЖЕНИЯ ***",! D ^%GSEL,Copy^%ZAPM.ed.BSF8("^UTILITY("_$J_")","^BStranS(""Glo"")")]]></Data>
</Node>
<Node><Sub>4</Sub>
<Data><![CDATA[W #,!," *** ВЫБЕРИТЕ ПРОГРАММЫ ДЛЯ ПРИЛОЖЕНИЯ ***",! D ^%RSEL,Copy^%ZAPM.ed.BSF8("^UTILITY("_$J_")","^BStranS(""Rou"")")]]></Data>
</Node>
</Node>
<Node><Sub>14</Sub>
<Node><Sub>2</Sub>
<Data><![CDATA[W #,!," *** ВЫБЕРИТЕ НЕТРАНСЛИРУЕМЫЕ МАССИВЫ ДЛЯ ПРИЛОЖЕНИЯ ***",! D ^%GSEL,Copy^%ZAPM.ed.BSF8("^UTILITY("_$J_")","^BStranS(""NoTrGlo"")")]]></Data>
</Node>
</Node>
</Node>
<Node><Sub>FCL</Sub>
<Node><Sub>5</Sub>
<Node><Sub>4</Sub>
<Data>S d1=$zu(0)</Data>
<Node><Sub>1</Sub>
<Data>$zu(0)</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>FTR</Sub>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Data>S d1=&quot; &quot;_$g(^%ZAPM.ed.BS)</Data>
<Node><Sub>1</Sub>
<Data>&quot; &quot;_$g(^%ZAPM.ed.BS)</Data>
</Node>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Data>S d1=$$ESDAY^%ZAPM.ed.BSsFUNR(6,$$h^%ZAPM.ed.BS3)</Data>
<Node><Sub>1</Sub>
<Data>$$ESDAY(6,$$h^%ZAPM.ed.BS3)</Data>
</Node>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>11</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>12</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>RTR</Sub>
<Node><Sub>5</Sub>
<Node><Sub>4</Sub>
<Data>S d1=$$IF^%ZAPM.ed.BSsFUNR(&quot;d?3A1&quot;&quot;,&quot;&quot;3A&quot;,&quot;READ&quot;,&quot;&quot;,&quot;Введите ИМЯ КИПА и через запятую ИМЯ ТОМА&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$$IF(&quot;d?3A1&quot;&quot;,&quot;&quot;3A&quot;,&quot;READ&quot;,&quot;&quot;,&quot;Введите ИМЯ КИПА и через запятую ИМЯ ТОМА&quot;)</Data>
</Node>
</Node>
</Node>
<Node><Sub>17</Sub>
<Node><Sub>4</Sub>
<Data><![CDATA[S d1=$$IF^%ZAPM.ed.BSsFUNR("""YNyn""[d","READ","S:d=""y"" d=""Y"" S:d=""n"" d=""N""","Введите только Y или N")]]></Data>
<Node><Sub>1</Sub>
<Data>$$IF(&quot;&quot;&quot;YNyn&quot;&quot;[d&quot;,&quot;READ&quot;,&quot;S:d=&quot;&quot;y&quot;&quot; d=&quot;&quot;Y&quot;&quot; S:d=&quot;&quot;n&quot;&quot; d=&quot;&quot;N&quot;&quot;&quot;,&quot;Введите только Y или N&quot;)</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>STA</Sub>
<Data>5,4@1@1@27@-1@-1@11@5@MGR,MSW</Data>
</Node>
</Node>
<Node><Sub>KCH0</Sub>
<Data><![CDATA[СТАНДАРНАЯ ВЫБОРКА ИМЕННОГО КЛЮЧА@@1@@@1@1@1@1@22@78@@@@@@1@@3,3@@@@@@@@1@3@3@@@@@@@@@@^%ZAPM.ed.BSHLP("KEY_HELP")@@]]></Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@1@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@2@1@15@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>1@17@1@35@@@@@1@@@@@@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@3@1@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>2@2@3@15@@@@@1@2;6;30;45@@@@@  Определите       именной          ключ</Data>
</Node>
<Node><Sub>3</Sub>
<Data>2@17@3@35@@@@@1@1;6;32;45@@@@@                ?</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>5@1@1@1@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>5@2@1@15@@@@@1@2;6;30;46@@@@@  ----------&gt;</Data>
</Node>
<Node><Sub>3</Sub>
<Data>5@17@1@35@@@@@1@2;6;34;46@@@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>59501,34107,MSW</Data>
</Node>
<Node><Sub>STA</Sub>
<Data>3,3@3@3@27@-1@-1@5@17@</Data>
</Node>
</Node>
<Node><Sub>KCH1</Sub>
<Data><![CDATA[СТАНДАРНАЯ ВЫБОРКА ИНДЕКСНОГО КЛЮЧА@@@@@1@1@1@1@22@80@@X MRMR@@%F4^%ZAPM.ed.BST2@@1@@3,3@@@@@@1@@1@5@3@@2;6;37;40@@@@@@@@^%ZAPM.ed.BSHLP("KEY_CHO")@@PREDTEMP^%ZAPM.ed.BSF11]]></Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@1@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@2@1@15@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>1@17@1@34@@@@@1@@@@@@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@3@1@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>2@2@3@15@@@@@1@2;6;30;45@@@@@    ВЫБОРКА      ИНДЕКСНОГО        КЛЮЧА</Data>
</Node>
<Node><Sub>3</Sub>
<Data>2@17@3@34@@@@@1@2;6;30;45@@@@@                ?</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>5@1@1@1@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>5@2@1@15@@@@@1@2;6;30;46@@@@@  ОТ..........</Data>
</Node>
<Node><Sub>3</Sub>
<Data>5@17@1@34@@@@0@1@2;6;34;46@@@@@</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>6@1@1@1@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>6@2@1@15@@@@@1@2;6;30;46@@@@@  ДО..........</Data>
</Node>
<Node><Sub>3</Sub>
<Data>6@17@1@34@@@@0@1@2;6;34;46@@@@@@0</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>7@1@1@1@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>7@2@1@15@@@@@1@2;6;30;45@@@@@  ШАБЛОН......</Data>
</Node>
<Node><Sub>3</Sub>
<Data>7@17@1@34@@@@@1@2;6;30;45@@@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>FTR</Sub>
<Node><Sub>3</Sub>
<Node><Sub>3</Sub>
<Data>S d1=d I d1=&quot;&quot; S d1=&quot;НАЧАЛА&quot;</Data>
<Node><Sub>1</Sub>
<Data>d I d1=&quot;&quot; S d1=&quot;НАЧАЛА&quot;</Data>
</Node>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>3</Sub>
<Data>S d1=d I d1=&quot;&quot; S d1=&quot;КОНЦА&quot;</Data>
<Node><Sub>1</Sub>
<Data>d I d1=&quot;&quot; S d1=&quot;КОНЦА&quot;</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>59501,34151,MSW</Data>
</Node>
<Node><Sub>RTR</Sub>
<Node><Sub>4</Sub>
<Node><Sub>3</Sub>
<Data><![CDATA[S d1=$$IF^%ZAPM.ed.BSsFUNR("d'=""""&($$A^%ZAPM.ed.BSA(3,3)'="""")&(d]$$A^%ZAPM.ed.BSA(3,3))!(d="""")!(d=$$A^%ZAPM.ed.BSA(3,3))!($$A^%ZAPM.ed.BSA(3,3)="""")","READ","","ПАРАМЕТР 'ДО' ДОЛЖЕН СЛЕДОВАТЬ ЗА 'ОТ' !")]]></Data>
<Node><Sub>1</Sub>
<Data><![CDATA[$$IF("d'=""""&({3,3}'="""")&(d]{3,3})!(d="""")!(d={3,3})!({3,3}="""")","READ","","ПАРАМЕТР 'ДО' ДОЛЖЕН СЛЕДОВАТЬ ЗА 'ОТ' !")]]></Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>STA</Sub>
<Data>3,3@3@3@27@-1@-1@5@17@</Data>
</Node>
</Node>
<Node><Sub>KEY0</Sub>
<Data><![CDATA[ n/n 0 ОПРЕДЕЛЕНИЕ КЛЮЧЕЙ@@@@@1@1@1@1@22@78@1@@1@1@@1@@2,1@@@@@@@1@1@12@15@@@@@@@@@@^%ZAPM.ed.BSHLP("KEY_HELP")]]></Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@3@15@@@@@1@2;6;30;46@@@@@---------------|    КЛЮЧИ   | |------------|</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@16@3@10@@@@@1@2;6;30;46@@@@@----------РАЗМЕРЫ:  Y,X,TIME</Data>
</Node>
<Node><Sub>3</Sub>
<Data>1@26@3@7@@@@@1@2;6;30;46@@@@@------- ТЕКСТ  ПРИГЛ.</Data>
</Node>
<Node><Sub>4</Sub>
<Data>1@33@3@4@@@@@1@2;6;30;46@@@@@----ЦВЕТТЕКСТ</Data>
</Node>
<Node><Sub>5</Sub>
<Data>1@37@3@8@@@@@1@2;6;30;46@@@@@-------- ТРАН    СИН.ТАБ</Data>
</Node>
<Node><Sub>6</Sub>
<Data>1@45@3@10@@@@@1@2;6;30;46@@@@@---------- НАЧАЛЬНОЕ ЗНАЧЕНИЕ</Data>
</Node>
<Node><Sub>7</Sub>
<Data>1@55@3@10@@@@@1@2;6;30;46@@@@@---------- КОНЕЧНОЕ  ЗНАЧЕНИЕ</Data>
</Node>
<Node><Sub>8</Sub>
<Data>1@65@3@7@@@@@1@2;6;30;46@@@@@ текст начала ключа</Data>
</Node>
<Node><Sub>9</Sub>
<Data>1@72@3@7@@@@@1@2;6;30;46@@@@@ текст конца   ключа</Data>
</Node>
<Node><Sub>10</Sub>
<Data>1@79@3@7@@@@@1@2;6;30;46@@@@@ВЫБОР   1@</Data>
</Node>
<Node><Sub>11</Sub>
<Data>1@86@3@7@@@@@1@2;6;30;46@@@@@ВЫБОР   2@</Data>
</Node>
<Node><Sub>12</Sub>
<Data>1@93@3@7@@@@@1@2;6;30;46@@@@@ВЫБОР   3@</Data>
</Node>
<Node><Sub>13</Sub>
<Data>1@100@3@7@@@@@1@2;6;30;46@@@@@ВЫБОР   4@</Data>
</Node>
<Node><Sub>14</Sub>
<Data>1@107@3@7@@@@@1@2;6;30;46@@@@@ВЫБОР   5@</Data>
</Node>
<Node><Sub>15</Sub>
<Data>1@114@3@7@@@@@1@2;6;30;46@@@@@...@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>4@1@1@15@@@@@1@2;6;30;46@@@@@ ИМЕННОЙ КЛЮЧ</Data>
</Node>
<Node><Sub>2</Sub>
<Data>4@16@1@10@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>4@26@1@7@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>4@33@1@4@@@@@1@2;6;30;41@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>4@37@1@8@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>6</Sub>
<Data>4@45@1@10@@@@@1@@@@@@@0</Data>
</Node>
<Node><Sub>7</Sub>
<Data>4@55@1@10@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>8</Sub>
<Data>4@65@1@7@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>9</Sub>
<Data>4@72@1@7@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>10</Sub>
<Data>4@79@1@7@@@@@1@@@@@@XXX@</Data>
</Node>
<Node><Sub>11</Sub>
<Data>4@86@1@7@@@@@1@@@@@@XXX@</Data>
</Node>
<Node><Sub>12</Sub>
<Data>4@93@1@7@@@@@1@@@@@@XXX@</Data>
</Node>
<Node><Sub>13</Sub>
<Data>4@100@1@7@@@@@1@@@@@@XXX@</Data>
</Node>
<Node><Sub>14</Sub>
<Data>4@107@1@7@@@@@1@@@@@@XXX@</Data>
</Node>
<Node><Sub>15</Sub>
<Data>4@114@1@7@@@@@1@@@@@@...@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>5@1@1@15@@@@@1@2;6;30;46@@@@@ 1-Й ИНДЕКСНЫЙ</Data>
</Node>
<Node><Sub>2</Sub>
<Data>5@16@1@10@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>5@26@1@7@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>5@33@1@4@@@@@1@2;6;30;42@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>5@37@1@8@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>6</Sub>
<Data>5@45@1@10@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>7</Sub>
<Data>5@55@1@10@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>8</Sub>
<Data>5@65@1@7@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>9</Sub>
<Data>5@72@1@7@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>10</Sub>
<Data>5@79@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>11</Sub>
<Data>5@86@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>12</Sub>
<Data>5@93@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>13</Sub>
<Data>5@100@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>14</Sub>
<Data>5@107@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>15</Sub>
<Data>5@114@1@7@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>6@1@1@15@@@@@1@2;6;30;46@@@@@ 2-Й ИНДЕКСНЫЙ</Data>
</Node>
<Node><Sub>2</Sub>
<Data>6@16@1@10@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>6@26@1@7@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>6@33@1@4@@@@@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>6@37@1@8@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>6</Sub>
<Data>6@45@1@10@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>7</Sub>
<Data>6@55@1@10@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>8</Sub>
<Data>6@65@1@7@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>9</Sub>
<Data>6@72@1@7@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>10</Sub>
<Data>6@79@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>11</Sub>
<Data>6@86@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>12</Sub>
<Data>6@93@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>13</Sub>
<Data>6@100@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>14</Sub>
<Data>6@107@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>15</Sub>
<Data>6@114@1@7@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>7@1@1@15@@@@@1@2;6;30;46@@@@@ 3-Й ИНДЕКСНЫЙ</Data>
</Node>
<Node><Sub>2</Sub>
<Data>7@16@1@10@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>7@26@1@7@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>7@33@1@4@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>7@37@1@8@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>6</Sub>
<Data>7@45@1@10@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>7</Sub>
<Data>7@55@1@10@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>8</Sub>
<Data>7@65@1@7@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>9</Sub>
<Data>7@72@1@7@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>10</Sub>
<Data>7@79@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>11</Sub>
<Data>7@86@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>12</Sub>
<Data>7@93@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>13</Sub>
<Data>7@100@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>14</Sub>
<Data>7@107@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>15</Sub>
<Data>7@114@1@7@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>8@1@1@15@@@@@1@2;6;30;46@@@@@ 4-Й ИНДЕКСНЫЙ</Data>
</Node>
<Node><Sub>2</Sub>
<Data>8@16@1@10@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>8@26@1@7@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>8@33@1@4@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>8@37@1@8@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>6</Sub>
<Data>8@45@1@10@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>7</Sub>
<Data>8@55@1@10@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>8</Sub>
<Data>8@65@1@7@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>9</Sub>
<Data>8@72@1@7@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>10</Sub>
<Data>8@79@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>11</Sub>
<Data>8@86@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>12</Sub>
<Data>8@93@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>13</Sub>
<Data>8@100@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>14</Sub>
<Data>8@107@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>15</Sub>
<Data>8@114@1@7@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>9@1@1@15@@@@@1@2;6;30;46@@@@@ 5-Й ИНДЕКСНЫЙ@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>9@16@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>9@26@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>9@33@1@4@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>9@37@1@8@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>6</Sub>
<Data>9@45@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>7</Sub>
<Data>9@55@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>8</Sub>
<Data>9@65@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>9</Sub>
<Data>9@72@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>10</Sub>
<Data>9@79@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>11</Sub>
<Data>9@86@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>12</Sub>
<Data>9@93@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>13</Sub>
<Data>9@100@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>14</Sub>
<Data>9@107@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>15</Sub>
<Data>9@114@1@7@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>1</Sub>
<Data>10@1@1@15@@@@@1@2;6;30;46@@@@@ 6-Й ИНДЕКСНЫЙ@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>10@16@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>10@26@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>10@33@1@4@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>10@37@1@8@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>6</Sub>
<Data>10@45@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>7</Sub>
<Data>10@55@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>8</Sub>
<Data>10@65@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>9</Sub>
<Data>10@72@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>10</Sub>
<Data>10@79@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>11</Sub>
<Data>10@86@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>12</Sub>
<Data>10@93@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>13</Sub>
<Data>10@100@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>14</Sub>
<Data>10@107@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>15</Sub>
<Data>10@114@1@7@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>1</Sub>
<Data>11@1@1@15@@@@@1@2;6;30;46@@@@@ 7-Й ИНДЕКСНЫЙ@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>11@16@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>11@26@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>11@33@1@4@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>11@37@1@8@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>6</Sub>
<Data>11@45@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>7</Sub>
<Data>11@55@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>8</Sub>
<Data>11@65@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>9</Sub>
<Data>11@72@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>10</Sub>
<Data>11@79@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>11</Sub>
<Data>11@86@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>12</Sub>
<Data>11@93@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>13</Sub>
<Data>11@100@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>14</Sub>
<Data>11@107@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>15</Sub>
<Data>11@114@1@7@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>1</Sub>
<Data>12@1@1@15@@@@@1@2;6;30;46@@@@@ 8-Й ИНДЕКСНЫЙ@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>12@16@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>12@26@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>12@33@1@4@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>12@37@1@8@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>6</Sub>
<Data>12@45@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>7</Sub>
<Data>12@55@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>8</Sub>
<Data>12@65@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>9</Sub>
<Data>12@72@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>10</Sub>
<Data>12@79@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>11</Sub>
<Data>12@86@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>12</Sub>
<Data>12@93@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>13</Sub>
<Data>12@100@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>14</Sub>
<Data>12@107@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>15</Sub>
<Data>12@114@1@7@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>11</Sub>
<Node><Sub>1</Sub>
<Data>13@1@1@15@@@@@1@2;6;30;46@@@@@ 9-Й ИНДЕКСНЫЙ</Data>
</Node>
<Node><Sub>2</Sub>
<Data>13@16@1@10@@@@@1@@@@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>13@26@1@7@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>13@33@1@4@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>13@37@1@8@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>6</Sub>
<Data>13@45@1@10@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>7</Sub>
<Data>13@55@1@10@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>8</Sub>
<Data>13@65@1@7@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>9</Sub>
<Data>13@72@1@7@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>10</Sub>
<Data><![CDATA[13@79@1@7@@@@@1@@@@0@@Текст ,который появится в меню при организации выборки для выдачи СПИСКОВ и СВОДОК@]]></Data>
</Node>
<Node><Sub>11</Sub>
<Data>13@86@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>12</Sub>
<Data>13@93@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>13</Sub>
<Data>13@100@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>14</Sub>
<Data>13@107@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>15</Sub>
<Data>13@114@1@7@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>12</Sub>
<Node><Sub>1</Sub>
<Data>14@1@1@15@@@@@1@2;6;30;45@@@@@ОПИСАНИЕ КЛЮЧЕЙ</Data>
</Node>
<Node><Sub>2</Sub>
<Data>14@16@1@10@@@@@1@2;6;30;45@@@@@ ДЛЯ ТАБЛИ</Data>
</Node>
<Node><Sub>3</Sub>
<Data>14@26@1@7@@@@@1@2;6;30;45@@@@@ЦЫ</Data>
</Node>
<Node><Sub>4</Sub>
<Data>14@33@1@4@@@@@1@2;6;30;45@@@@@БАЗА Д</Data>
</Node>
<Node><Sub>5</Sub>
<Data>14@37@1@8@@@@@1@2;6;30;45@@@@@ ДАННЫХ:</Data>
</Node>
<Node><Sub>6</Sub>
<Data>14@45@1@10@@@@@1@1;6;37;45@1@@@@???@@@@@^%ZAPM.ed.BSHLP(&quot;KH1&quot;)</Data>
</Node>
<Node><Sub>7</Sub>
<Data>14@55@1@10@@@@@1@1;6;37;45@@@@^%ZAPM.ed.BSMDDR(&quot;DDR&quot;)@@0@@@@^%ZAPM.ed.BSHLP(&quot;KH2&quot;)</Data>
</Node>
<Node><Sub>8</Sub>
<Data>14@65@1@7@@@@@1@1;6;37;45@@@@@@@@@@^%ZAPM.ed.BSHLP(&quot;KH3&quot;)</Data>
</Node>
<Node><Sub>9</Sub>
<Data>14@72@1@7@@@@@1@1;6;37;45@@@@@ВЫБОР-&gt;</Data>
</Node>
<Node><Sub>10</Sub>
<Data>14@79@1@7@@@@@1@1;6;37;45@@@@@ВВЕДИТЕ@</Data>
</Node>
<Node><Sub>11</Sub>
<Data>14@86@1@7@@@@@1@1;6;37;45@@@@@ В НУЖН@</Data>
</Node>
<Node><Sub>12</Sub>
<Data>14@93@1@7@@@@@1@1;6;37;45@@@@@УЮ КЛЕТ@</Data>
</Node>
<Node><Sub>13</Sub>
<Data>14@100@1@7@@@@@1@1;6;37;45@@@@@КУ ТЕКС@</Data>
</Node>
<Node><Sub>14</Sub>
<Data>14@107@1@7@@@@@1@1;6;37;45@@@@@Т И Ф.Л@</Data>
</Node>
<Node><Sub>15</Sub>
<Data>14@114@1@7@@@@@1@1;6;37;45@@@@@ОГИКИ@</Data>
</Node>
</Node>
<Node><Sub>CMD</Sub>
<Node><Sub>12</Sub>
<Node><Sub>7</Sub>
<Data>S IYI=&quot;PARAM,%BSVOL,,,&lt;&gt;&quot; D ENTER^%ZAPM.ed.BSN</Data>
</Node>
</Node>
</Node>
<Node><Sub>COL</Sub>
<Node><Sub>11</Sub>
<Node><Sub>10</Sub>
<Data><![CDATA[I 1 ;3 - ДИАПАЗОН, или Формула вычисления для выборки. Например,ключ 2 это дата и формула для выборки МАЯ-месяца будет такая :+$E(k2,3,4)=5]]></Data>
<Node><Sub>1</Sub>
<Data><![CDATA[1 ;3 - ДИАПАЗОН, или Формула вычисления для выборки. Например,ключ 2 это дата и формула для выборки МАЯ-месяца будет такая :+$E(k2,3,4)=5]]></Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>58093,50527,MS</Data>
</Node>
<Node><Sub>RTR</Sub>
<Node><Sub>2</Sub>
<Node><Sub>6</Sub>
<Data>S d1=$$IF^%ZAPM.ed.BSsFUNR(&quot;d&apos;?.E1P.E&quot;,&quot;READ&quot;,&quot;&quot;,&quot;СИМВОЛ ПУНКТУАЦИИ В ИМЕННОМ КЛЮЧЕ ЗАПРЕЩЕН&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$$IF(&quot;d&apos;?.E1P.E&quot;,&quot;READ&quot;,&quot;&quot;,&quot;СИМВОЛ ПУНКТУАЦИИ В ИМЕННОМ КЛЮЧЕ ЗАПРЕЩЕН&quot;)</Data>
</Node>
</Node>
</Node>
<Node><Sub>12</Sub>
<Node><Sub>7</Sub>
<Data>S d1=$$IF^%ZAPM.ed.BSsFUNR(&quot;$$SINDDR^%ZAPM.ed.BSBD(d)&quot;,&quot;READ&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$$IF(&quot;$$SINDDR^%ZAPM.ed.BSBD(d)&quot;,&quot;READ&quot;)</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>STA</Sub>
<Data>2,1@2@1@13@-1@-1@4@1@ ИМЕННОЙ КЛЮЧ</Data>
</Node>
</Node>
<Node><Sub>KEY1</Sub>
<Data><![CDATA[ n/n 1 ОПРЕДЕЛЕНИЕ КЛЮЧЕЙ@@@@@1@1@1@1@22@78@1@@1@1@@1@@2,1@@@@@@@1@1@12@15@@@@@@@@@@^%ZAPM.ed.BSHLP("KEY_HELP")]]></Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@3@15@@@@@1@2;6;30;46@@@@@---------------|    КЛЮЧИ   | |------------|</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@16@3@10@@@@@1@2;6;30;46@@@@@----------РАЗМЕРЫ:  Y,X,TIME</Data>
</Node>
<Node><Sub>3</Sub>
<Data>1@26@3@7@@@@@1@2;6;30;46@@@@@------- ТЕКСТ  ПРИГЛ.</Data>
</Node>
<Node><Sub>4</Sub>
<Data>1@33@3@4@@@@@1@2;6;30;46@@@@@----ЦВЕТТЕКСТ</Data>
</Node>
<Node><Sub>5</Sub>
<Data>1@37@3@8@@@@@1@2;6;30;46@@@@@-------- ТРАН    СИН.ТАБ</Data>
</Node>
<Node><Sub>6</Sub>
<Data>1@45@3@10@@@@@1@2;6;30;46@@@@@---------- НАЧАЛЬНОЕ ЗНАЧЕНИЕ</Data>
</Node>
<Node><Sub>7</Sub>
<Data>1@55@3@10@@@@@1@2;6;30;46@@@@@---------- КОНЕЧНОЕ  ЗНАЧЕНИЕ</Data>
</Node>
<Node><Sub>8</Sub>
<Data>1@65@3@7@@@@@1@2;6;30;46@@@@@ текст начала ключа</Data>
</Node>
<Node><Sub>9</Sub>
<Data>1@72@3@7@@@@@1@2;6;30;46@@@@@ текст конца   ключа</Data>
</Node>
<Node><Sub>10</Sub>
<Data>1@79@3@7@@@@@1@2;6;30;46@@@@@ВЫБОР   1@</Data>
</Node>
<Node><Sub>11</Sub>
<Data>1@86@3@7@@@@@1@2;6;30;46@@@@@ВЫБОР   2@</Data>
</Node>
<Node><Sub>12</Sub>
<Data>1@93@3@7@@@@@1@2;6;30;46@@@@@ВЫБОР   3@</Data>
</Node>
<Node><Sub>13</Sub>
<Data>1@100@3@7@@@@@1@2;6;30;46@@@@@ВЫБОР   4@</Data>
</Node>
<Node><Sub>14</Sub>
<Data>1@107@3@7@@@@@1@2;6;30;46@@@@@ВЫБОР   5@</Data>
</Node>
<Node><Sub>15</Sub>
<Data>1@114@3@7@@@@@1@2;6;30;46@@@@@...@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>4@1@1@15@@@@@1@2;6;30;46@@@@@ ИМЕННОЙ КЛЮЧ</Data>
</Node>
<Node><Sub>2</Sub>
<Data>4@16@1@10@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>4@26@1@7@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>4@33@1@4@@@@@1@2;6;30;41@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>4@37@1@8@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>6</Sub>
<Data>4@45@1@10@@@@@1@@@@@@@0</Data>
</Node>
<Node><Sub>7</Sub>
<Data>4@55@1@10@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>8</Sub>
<Data>4@65@1@7@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>9</Sub>
<Data>4@72@1@7@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>10</Sub>
<Data>4@79@1@7@@@@@1@@@@@@XXX@</Data>
</Node>
<Node><Sub>11</Sub>
<Data>4@86@1@7@@@@@1@@@@@@XXX@</Data>
</Node>
<Node><Sub>12</Sub>
<Data>4@93@1@7@@@@@1@@@@@@XXX@</Data>
</Node>
<Node><Sub>13</Sub>
<Data>4@100@1@7@@@@@1@@@@@@XXX@</Data>
</Node>
<Node><Sub>14</Sub>
<Data>4@107@1@7@@@@@1@@@@@@XXX@</Data>
</Node>
<Node><Sub>15</Sub>
<Data>4@114@1@7@@@@@1@@@@@@...@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>5@1@1@15@@@@@1@2;6;30;46@@@@@ 1-Й ИНДЕКСНЫЙ</Data>
</Node>
<Node><Sub>2</Sub>
<Data>5@16@1@10@@@@@1@@@@@@1,70</Data>
</Node>
<Node><Sub>3</Sub>
<Data>5@26@1@7@@@@@1@@@@@@Введите Код структурных подразделений (2,4 или 9 цыфр)</Data>
</Node>
<Node><Sub>4</Sub>
<Data>5@33@1@4@@@@@1@2;6;30;42@@@@@НОВОЕ КСП</Data>
</Node>
<Node><Sub>5</Sub>
<Data>5@37@1@8@@@@@1@@@@@@64</Data>
</Node>
<Node><Sub>6</Sub>
<Data>5@45@1@10@@@@@1@@@@@@49</Data>
</Node>
<Node><Sub>7</Sub>
<Data>5@55@1@10@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>8</Sub>
<Data>5@65@1@7@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>9</Sub>
<Data>5@72@1@7@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>10</Sub>
<Data>5@79@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>11</Sub>
<Data>5@86@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>12</Sub>
<Data>5@93@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>13</Sub>
<Data>5@100@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>14</Sub>
<Data>5@107@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>15</Sub>
<Data>5@114@1@7@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>6@1@1@15@@@@@1@2;6;30;46@@@@@ 2-Й ИНДЕКСНЫЙ</Data>
</Node>
<Node><Sub>2</Sub>
<Data>6@16@1@10@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>6@26@1@7@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>6@33@1@4@@@@@1@2;6;37;44@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>6@37@1@8@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>6</Sub>
<Data>6@45@1@10@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>7</Sub>
<Data>6@55@1@10@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>8</Sub>
<Data>6@65@1@7@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>9</Sub>
<Data>6@72@1@7@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>10</Sub>
<Data>6@79@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>11</Sub>
<Data>6@86@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>12</Sub>
<Data>6@93@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>13</Sub>
<Data>6@100@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>14</Sub>
<Data>6@107@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>15</Sub>
<Data>6@114@1@7@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>7@1@1@15@@@@@1@2;6;30;46@@@@@ 3-Й ИНДЕКСНЫЙ</Data>
</Node>
<Node><Sub>2</Sub>
<Data>7@16@1@10@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>7@26@1@7@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>7@33@1@4@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>7@37@1@8@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>6</Sub>
<Data>7@45@1@10@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>7</Sub>
<Data>7@55@1@10@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>8</Sub>
<Data>7@65@1@7@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>9</Sub>
<Data>7@72@1@7@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>10</Sub>
<Data>7@79@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>11</Sub>
<Data>7@86@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>12</Sub>
<Data>7@93@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>13</Sub>
<Data>7@100@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>14</Sub>
<Data>7@107@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>15</Sub>
<Data>7@114@1@7@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>8@1@1@15@@@@@1@2;6;30;46@@@@@ 4-Й ИНДЕКСНЫЙ</Data>
</Node>
<Node><Sub>2</Sub>
<Data>8@16@1@10@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>8@26@1@7@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>8@33@1@4@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>8@37@1@8@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>6</Sub>
<Data>8@45@1@10@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>7</Sub>
<Data>8@55@1@10@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>8</Sub>
<Data>8@65@1@7@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>9</Sub>
<Data>8@72@1@7@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>10</Sub>
<Data>8@79@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>11</Sub>
<Data>8@86@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>12</Sub>
<Data>8@93@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>13</Sub>
<Data>8@100@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>14</Sub>
<Data>8@107@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>15</Sub>
<Data>8@114@1@7@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>9@1@1@15@@@@@1@2;6;30;46@@@@@ 5-Й ИНДЕКСНЫЙ@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>9@16@1@10@@@@@1@@@@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>9@26@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>9@33@1@4@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>9@37@1@8@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>6</Sub>
<Data>9@45@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>7</Sub>
<Data>9@55@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>8</Sub>
<Data>9@65@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>9</Sub>
<Data>9@72@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>10</Sub>
<Data>9@79@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>11</Sub>
<Data>9@86@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>12</Sub>
<Data>9@93@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>13</Sub>
<Data>9@100@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>14</Sub>
<Data>9@107@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>15</Sub>
<Data>9@114@1@7@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>1</Sub>
<Data>10@1@1@15@@@@@1@2;6;30;46@@@@@ 6-Й ИНДЕКСНЫЙ@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>10@16@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>10@26@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>10@33@1@4@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>10@37@1@8@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>6</Sub>
<Data>10@45@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>7</Sub>
<Data>10@55@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>8</Sub>
<Data>10@65@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>9</Sub>
<Data>10@72@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>10</Sub>
<Data>10@79@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>11</Sub>
<Data>10@86@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>12</Sub>
<Data>10@93@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>13</Sub>
<Data>10@100@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>14</Sub>
<Data>10@107@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>15</Sub>
<Data>10@114@1@7@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>1</Sub>
<Data>11@1@1@15@@@@@1@2;6;30;46@@@@@ 7-Й ИНДЕКСНЫЙ@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>11@16@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>11@26@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>11@33@1@4@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>11@37@1@8@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>6</Sub>
<Data>11@45@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>7</Sub>
<Data>11@55@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>8</Sub>
<Data>11@65@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>9</Sub>
<Data>11@72@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>10</Sub>
<Data>11@79@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>11</Sub>
<Data>11@86@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>12</Sub>
<Data>11@93@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>13</Sub>
<Data>11@100@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>14</Sub>
<Data>11@107@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>15</Sub>
<Data>11@114@1@7@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>1</Sub>
<Data>12@1@1@15@@@@@1@2;6;30;46@@@@@ 8-Й ИНДЕКСНЫЙ@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>12@16@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>12@26@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>12@33@1@4@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>12@37@1@8@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>6</Sub>
<Data>12@45@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>7</Sub>
<Data>12@55@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>8</Sub>
<Data>12@65@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>9</Sub>
<Data>12@72@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>10</Sub>
<Data>12@79@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>11</Sub>
<Data>12@86@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>12</Sub>
<Data>12@93@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>13</Sub>
<Data>12@100@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>14</Sub>
<Data>12@107@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>15</Sub>
<Data>12@114@1@7@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>11</Sub>
<Node><Sub>1</Sub>
<Data>13@1@1@15@@@@@1@2;6;30;46@@@@@ 9-Й ИНДЕКСНЫЙ</Data>
</Node>
<Node><Sub>2</Sub>
<Data>13@16@1@10@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>13@26@1@7@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>13@33@1@4@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>13@37@1@8@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>6</Sub>
<Data>13@45@1@10@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>7</Sub>
<Data>13@55@1@10@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>8</Sub>
<Data>13@65@1@7@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>9</Sub>
<Data>13@72@1@7@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>10</Sub>
<Data><![CDATA[13@79@1@7@@@@@1@@@@0@@Текст ,который появится в меню при организации выборки для выдачи СПИСКОВ и СВОДОК@]]></Data>
</Node>
<Node><Sub>11</Sub>
<Data>13@86@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>12</Sub>
<Data>13@93@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>13</Sub>
<Data>13@100@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>14</Sub>
<Data>13@107@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>15</Sub>
<Data>13@114@1@7@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>12</Sub>
<Node><Sub>1</Sub>
<Data>14@1@1@15@@@@@1@2;6;30;45@@@@@ОПИСАНИЕ КЛЮЧЕЙ</Data>
</Node>
<Node><Sub>2</Sub>
<Data>14@16@1@10@@@@@1@2;6;30;45@@@@@ ДЛЯ ТАБЛИ</Data>
</Node>
<Node><Sub>3</Sub>
<Data>14@26@1@7@@@@@1@2;6;30;45@@@@@ЦЫ</Data>
</Node>
<Node><Sub>4</Sub>
<Data>14@33@1@4@@@@@1@2;6;30;45@@@@@БАЗА Д</Data>
</Node>
<Node><Sub>5</Sub>
<Data>14@37@1@8@@@@@1@2;6;30;45@@@@@ ДАННЫХ:</Data>
</Node>
<Node><Sub>6</Sub>
<Data>14@45@1@10@@@@@1@1;6;37;45@1@@@@???@@@@@^%ZAPM.ed.BSHLP(&quot;KH1&quot;)</Data>
</Node>
<Node><Sub>7</Sub>
<Data>14@55@1@10@@@@@1@1;6;37;45@@@@12,7@@0@@@@^%ZAPM.ed.BSHLP(&quot;KH2&quot;)</Data>
</Node>
<Node><Sub>8</Sub>
<Data>14@65@1@7@@@@@1@1;6;37;45@@@@@@@@@@^%ZAPM.ed.BSHLP(&quot;KH3&quot;)</Data>
</Node>
<Node><Sub>9</Sub>
<Data>14@72@1@7@@@@@1@1;6;37;45@@@@@ВЫБОР-&gt;</Data>
</Node>
<Node><Sub>10</Sub>
<Data>14@79@1@7@@@@@1@1;6;37;45@@@@@ВВЕДИТЕ@</Data>
</Node>
<Node><Sub>11</Sub>
<Data>14@86@1@7@@@@@1@1;6;37;45@@@@@ В НУЖН@</Data>
</Node>
<Node><Sub>12</Sub>
<Data>14@93@1@7@@@@@1@1;6;37;45@@@@@УЮ КЛЕТ@</Data>
</Node>
<Node><Sub>13</Sub>
<Data>14@100@1@7@@@@@1@1;6;37;45@@@@@КУ ТЕКС@</Data>
</Node>
<Node><Sub>14</Sub>
<Data>14@107@1@7@@@@@1@1;6;37;45@@@@@Т И Ф.Л@</Data>
</Node>
<Node><Sub>15</Sub>
<Data>14@114@1@7@@@@@1@1;6;37;45@@@@@ОГИКИ@</Data>
</Node>
</Node>
<Node><Sub>CMD</Sub>
<Node><Sub>12</Sub>
<Node><Sub>7</Sub>
<Data>S IYI=&quot;PARAM,%BSVOL,,,&lt;&gt;&quot; D ENTER^%ZAPM.ed.BSN</Data>
</Node>
</Node>
</Node>
<Node><Sub>COL</Sub>
<Node><Sub>11</Sub>
<Node><Sub>10</Sub>
<Data><![CDATA[I 1 ;Формула вычисления для выборки. Например,ключ 2 это         дата и формула для выборки МАЯ-месяца будет такая :+$E(k2,3,4)=5]]></Data>
<Node><Sub>1</Sub>
<Data><![CDATA[1 ;Формула вычисления для выборки. Например,ключ 2 это         дата и формула для выборки МАЯ-месяца будет такая :+$E(k2,3,4)=5]]></Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>58093,50564,MS</Data>
</Node>
<Node><Sub>RTR</Sub>
<Node><Sub>2</Sub>
<Node><Sub>6</Sub>
<Data>S d1=$$IF^%ZAPM.ed.BSsFUNR(&quot;d&apos;?.E1P.E&quot;,&quot;READ&quot;,&quot;&quot;,&quot;СИМВОЛ ПУНКТУАЦИИ В ИМЕННОМ КЛЮЧЕ ЗАПРЕЩЕН&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$$IF(&quot;d&apos;?.E1P.E&quot;,&quot;READ&quot;,&quot;&quot;,&quot;СИМВОЛ ПУНКТУАЦИИ В ИМЕННОМ КЛЮЧЕ ЗАПРЕЩЕН&quot;)</Data>
</Node>
</Node>
</Node>
<Node><Sub>12</Sub>
<Node><Sub>7</Sub>
<Data>S d1=$$IF^%ZAPM.ed.BSsFUNR(&quot;$$SINDDR^%ZAPM.ed.BSBD(d)&quot;,&quot;READ&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$$IF(&quot;$$SINDDR^%ZAPM.ed.BSBD(d)&quot;,&quot;READ&quot;)</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>STA</Sub>
<Data>2,5@2@1@13@-1@-1@4@37@</Data>
</Node>
</Node>
<Node><Sub>KEY2</Sub>
<Data><![CDATA[ n/n 2 ОПРЕДЕЛЕНИЕ КЛЮЧЕЙ@@@@@1@1@1@1@22@78@1@@1@1@@1@@2,1@@@@@@@1@1@12@15@@@@@@@@@@^%ZAPM.ed.BSHLP("KEY_HELP")]]></Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@3@15@@@@@1@2;6;30;46@@@@@---------------|    КЛЮЧИ   | |------------|</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@16@3@10@@@@@1@2;6;30;46@@@@@----------РАЗМЕРЫ:  Y,X,TIME</Data>
</Node>
<Node><Sub>3</Sub>
<Data>1@26@3@7@@@@@1@2;6;30;46@@@@@------- ТЕКСТ  ПРИГЛ.</Data>
</Node>
<Node><Sub>4</Sub>
<Data>1@33@3@4@@@@@1@2;6;30;46@@@@@----ЦВЕТТЕКСТ</Data>
</Node>
<Node><Sub>5</Sub>
<Data>1@37@3@8@@@@@1@2;6;30;46@@@@@-------- ТРАН    СИН.ТАБ</Data>
</Node>
<Node><Sub>6</Sub>
<Data>1@45@3@10@@@@@1@2;6;30;46@@@@@---------- НАЧАЛЬНОЕ ЗНАЧЕНИЕ</Data>
</Node>
<Node><Sub>7</Sub>
<Data>1@55@3@10@@@@@1@2;6;30;46@@@@@---------- КОНЕЧНОЕ  ЗНАЧЕНИЕ</Data>
</Node>
<Node><Sub>8</Sub>
<Data>1@65@3@7@@@@@1@2;6;30;46@@@@@ текст начала ключа</Data>
</Node>
<Node><Sub>9</Sub>
<Data>1@72@3@7@@@@@1@2;6;30;46@@@@@ текст конца   ключа</Data>
</Node>
<Node><Sub>10</Sub>
<Data>1@79@3@7@@@@@1@2;6;30;46@@@@@ВЫБОР   1@</Data>
</Node>
<Node><Sub>11</Sub>
<Data>1@86@3@7@@@@@1@2;6;30;46@@@@@ВЫБОР   2@</Data>
</Node>
<Node><Sub>12</Sub>
<Data>1@93@3@7@@@@@1@2;6;30;46@@@@@ВЫБОР   3@</Data>
</Node>
<Node><Sub>13</Sub>
<Data>1@100@3@7@@@@@1@2;6;30;46@@@@@ВЫБОР   4@</Data>
</Node>
<Node><Sub>14</Sub>
<Data>1@107@3@7@@@@@1@2;6;30;46@@@@@ВЫБОР   5@</Data>
</Node>
<Node><Sub>15</Sub>
<Data>1@114@3@7@@@@@1@2;6;30;46@@@@@...@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>4@1@1@15@@@@@1@2;6;30;46@@@@@ ИМЕННОЙ КЛЮЧ</Data>
</Node>
<Node><Sub>2</Sub>
<Data>4@16@1@10@@@@@1@@@@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>4@26@1@7@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>4@33@1@4@@@@@1@2;6;30;41@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>4@37@1@8@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>6</Sub>
<Data>4@45@1@10@@@@@1@@@@@@@0</Data>
</Node>
<Node><Sub>7</Sub>
<Data>4@55@1@10@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>8</Sub>
<Data>4@65@1@7@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>9</Sub>
<Data>4@72@1@7@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>10</Sub>
<Data>4@79@1@7@@@@@1@@@@@@XXX@</Data>
</Node>
<Node><Sub>11</Sub>
<Data>4@86@1@7@@@@@1@@@@@@XXX@</Data>
</Node>
<Node><Sub>12</Sub>
<Data>4@93@1@7@@@@@1@@@@@@XXX@</Data>
</Node>
<Node><Sub>13</Sub>
<Data>4@100@1@7@@@@@1@@@@@@XXX@</Data>
</Node>
<Node><Sub>14</Sub>
<Data>4@107@1@7@@@@@1@@@@@@XXX@</Data>
</Node>
<Node><Sub>15</Sub>
<Data>4@114@1@7@@@@@1@@@@@@...@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>5@1@1@15@@@@@1@2;6;30;46@@@@@ 1-Й ИНДЕКСНЫЙ</Data>
</Node>
<Node><Sub>2</Sub>
<Data>5@16@1@10@@@@@1@@@@@@1,60,TIME</Data>
</Node>
<Node><Sub>3</Sub>
<Data>5@26@1@7@@@@@1@@@@@@Введите Код структурных подразделений (2,4 или 9 цыфр)</Data>
</Node>
<Node><Sub>4</Sub>
<Data>5@33@1@4@@@@@1@2;6;30;42@@@@@НОВОЕ КСП</Data>
</Node>
<Node><Sub>5</Sub>
<Data>5@37@1@8@@@@@1@@@@@@64</Data>
</Node>
<Node><Sub>6</Sub>
<Data>5@45@1@10@@@@@1@@@@@@49</Data>
</Node>
<Node><Sub>7</Sub>
<Data>5@55@1@10@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>8</Sub>
<Data>5@65@1@7@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>9</Sub>
<Data>5@72@1@7@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>10</Sub>
<Data>5@79@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>11</Sub>
<Data>5@86@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>12</Sub>
<Data>5@93@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>13</Sub>
<Data>5@100@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>14</Sub>
<Data>5@107@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>15</Sub>
<Data>5@114@1@7@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>6@1@1@15@@@@@1@2;6;30;46@@@@@ 2-Й ИНДЕКСНЫЙ</Data>
</Node>
<Node><Sub>2</Sub>
<Data>6@16@1@10@@@@@1@@@@@@1,40</Data>
</Node>
<Node><Sub>3</Sub>
<Data>6@26@1@7@@@@@1@@@@@@Введите месяц и день в формате (ММДД) </Data>
</Node>
<Node><Sub>4</Sub>
<Data>6@33@1@4@@@@@1@2;6;37;44@@@@@НОВАЯ ДАТА</Data>
</Node>
<Node><Sub>5</Sub>
<Data>6@37@1@8@@@@@1@@@@@@0912</Data>
</Node>
<Node><Sub>6</Sub>
<Data>6@45@1@10@@@@@1@@@@@@0101</Data>
</Node>
<Node><Sub>7</Sub>
<Data>6@55@1@10@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>8</Sub>
<Data>6@65@1@7@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>9</Sub>
<Data>6@72@1@7@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>10</Sub>
<Data>6@79@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>11</Sub>
<Data>6@86@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>12</Sub>
<Data>6@93@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>13</Sub>
<Data>6@100@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>14</Sub>
<Data>6@107@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>15</Sub>
<Data>6@114@1@7@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>7@1@1@15@@@@@1@2;6;30;46@@@@@ 3-Й ИНДЕКСНЫЙ</Data>
</Node>
<Node><Sub>2</Sub>
<Data>7@16@1@10@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>7@26@1@7@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>7@33@1@4@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>7@37@1@8@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>6</Sub>
<Data>7@45@1@10@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>7</Sub>
<Data>7@55@1@10@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>8</Sub>
<Data>7@65@1@7@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>9</Sub>
<Data>7@72@1@7@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>10</Sub>
<Data>7@79@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>11</Sub>
<Data>7@86@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>12</Sub>
<Data>7@93@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>13</Sub>
<Data>7@100@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>14</Sub>
<Data>7@107@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>15</Sub>
<Data>7@114@1@7@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>8@1@1@15@@@@@1@2;6;30;46@@@@@ 4-Й ИНДЕКСНЫЙ</Data>
</Node>
<Node><Sub>2</Sub>
<Data>8@16@1@10@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>8@26@1@7@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>8@33@1@4@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>8@37@1@8@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>6</Sub>
<Data>8@45@1@10@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>7</Sub>
<Data>8@55@1@10@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>8</Sub>
<Data>8@65@1@7@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>9</Sub>
<Data>8@72@1@7@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>10</Sub>
<Data>8@79@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>11</Sub>
<Data>8@86@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>12</Sub>
<Data>8@93@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>13</Sub>
<Data>8@100@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>14</Sub>
<Data>8@107@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>15</Sub>
<Data>8@114@1@7@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>9@1@1@15@@@@@1@2;6;30;46@@@@@ 5-Й ИНДЕКСНЫЙ@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>9@16@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>9@26@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>9@33@1@4@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>9@37@1@8@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>6</Sub>
<Data>9@45@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>7</Sub>
<Data>9@55@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>8</Sub>
<Data>9@65@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>9</Sub>
<Data>9@72@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>10</Sub>
<Data>9@79@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>11</Sub>
<Data>9@86@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>12</Sub>
<Data>9@93@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>13</Sub>
<Data>9@100@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>14</Sub>
<Data>9@107@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>15</Sub>
<Data>9@114@1@7@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>1</Sub>
<Data>10@1@1@15@@@@@1@2;6;30;46@@@@@ 6-Й ИНДЕКСНЫЙ@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>10@16@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>10@26@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>10@33@1@4@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>10@37@1@8@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>6</Sub>
<Data>10@45@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>7</Sub>
<Data>10@55@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>8</Sub>
<Data>10@65@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>9</Sub>
<Data>10@72@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>10</Sub>
<Data>10@79@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>11</Sub>
<Data>10@86@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>12</Sub>
<Data>10@93@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>13</Sub>
<Data>10@100@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>14</Sub>
<Data>10@107@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>15</Sub>
<Data>10@114@1@7@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>1</Sub>
<Data>11@1@1@15@@@@@1@2;6;30;46@@@@@ 7-Й ИНДЕКСНЫЙ@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>11@16@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>11@26@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>11@33@1@4@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>11@37@1@8@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>6</Sub>
<Data>11@45@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>7</Sub>
<Data>11@55@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>8</Sub>
<Data>11@65@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>9</Sub>
<Data>11@72@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>10</Sub>
<Data>11@79@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>11</Sub>
<Data>11@86@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>12</Sub>
<Data>11@93@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>13</Sub>
<Data>11@100@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>14</Sub>
<Data>11@107@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>15</Sub>
<Data>11@114@1@7@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>1</Sub>
<Data>12@1@1@15@@@@@1@2;6;30;46@@@@@ 8-Й ИНДЕКСНЫЙ@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>12@16@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>12@26@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>12@33@1@4@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>12@37@1@8@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>6</Sub>
<Data>12@45@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>7</Sub>
<Data>12@55@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>8</Sub>
<Data>12@65@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>9</Sub>
<Data>12@72@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>10</Sub>
<Data>12@79@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>11</Sub>
<Data>12@86@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>12</Sub>
<Data>12@93@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>13</Sub>
<Data>12@100@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>14</Sub>
<Data>12@107@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>15</Sub>
<Data>12@114@1@7@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>11</Sub>
<Node><Sub>1</Sub>
<Data>13@1@1@15@@@@@1@2;6;30;46@@@@@ 9-Й ИНДЕКСНЫЙ</Data>
</Node>
<Node><Sub>2</Sub>
<Data>13@16@1@10@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>13@26@1@7@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>13@33@1@4@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>13@37@1@8@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>6</Sub>
<Data>13@45@1@10@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>7</Sub>
<Data>13@55@1@10@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>8</Sub>
<Data>13@65@1@7@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>9</Sub>
<Data>13@72@1@7@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>10</Sub>
<Data><![CDATA[13@79@1@7@@@@@1@@@@0@@Текст ,который появится в меню при организации выборки для выдачи СПИСКОВ и СВОДОК@]]></Data>
</Node>
<Node><Sub>11</Sub>
<Data>13@86@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>12</Sub>
<Data>13@93@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>13</Sub>
<Data>13@100@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>14</Sub>
<Data>13@107@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>15</Sub>
<Data>13@114@1@7@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>12</Sub>
<Node><Sub>1</Sub>
<Data>14@1@1@15@@@@@1@2;6;30;45@@@@@ОПИСАНИЕ КЛЮЧЕЙ</Data>
</Node>
<Node><Sub>2</Sub>
<Data>14@16@1@10@@@@@1@2;6;30;45@@@@@ ДЛЯ ТАБЛИ</Data>
</Node>
<Node><Sub>3</Sub>
<Data>14@26@1@7@@@@@1@2;6;30;45@@@@@ЦЫ</Data>
</Node>
<Node><Sub>4</Sub>
<Data>14@33@1@4@@@@@1@2;6;30;45@@@@@БАЗА Д</Data>
</Node>
<Node><Sub>5</Sub>
<Data>14@37@1@8@@@@@1@2;6;30;45@@@@@ ДАННЫХ:</Data>
</Node>
<Node><Sub>6</Sub>
<Data>14@45@1@10@@@@@1@1;6;37;45@1@@@@???@@@@@^%ZAPM.ed.BSHLP(&quot;KH1&quot;)</Data>
</Node>
<Node><Sub>7</Sub>
<Data>14@55@1@10@@@@@1@1;6;37;45@@@@12,7@@0@@@@^%ZAPM.ed.BSHLP(&quot;KH2&quot;)</Data>
</Node>
<Node><Sub>8</Sub>
<Data>14@65@1@7@@@@@1@1;6;37;45@@@@@@@@@@^%ZAPM.ed.BSHLP(&quot;KH3&quot;)</Data>
</Node>
<Node><Sub>9</Sub>
<Data>14@72@1@7@@@@@1@1;6;37;45@@@@@ВЫБОР-&gt;</Data>
</Node>
<Node><Sub>10</Sub>
<Data>14@79@1@7@@@@@1@1;6;37;45@@@@@ВВЕДИТЕ@</Data>
</Node>
<Node><Sub>11</Sub>
<Data>14@86@1@7@@@@@1@1;6;37;45@@@@@ В НУЖН@</Data>
</Node>
<Node><Sub>12</Sub>
<Data>14@93@1@7@@@@@1@1;6;37;45@@@@@УЮ КЛЕТ@</Data>
</Node>
<Node><Sub>13</Sub>
<Data>14@100@1@7@@@@@1@1;6;37;45@@@@@КУ ТЕКС@</Data>
</Node>
<Node><Sub>14</Sub>
<Data>14@107@1@7@@@@@1@1;6;37;45@@@@@Т И Ф.Л@</Data>
</Node>
<Node><Sub>15</Sub>
<Data>14@114@1@7@@@@@1@1;6;37;45@@@@@ОГИКИ@</Data>
</Node>
</Node>
<Node><Sub>CMD</Sub>
<Node><Sub>12</Sub>
<Node><Sub>7</Sub>
<Data>S IYI=&quot;PARAM,%BSVOL,,,&lt;&gt;&quot; D ENTER^%ZAPM.ed.BSN</Data>
</Node>
</Node>
</Node>
<Node><Sub>COL</Sub>
<Node><Sub>11</Sub>
<Node><Sub>10</Sub>
<Data><![CDATA[I 1 ;Формула вычисления для выборки. Например,ключ 2 это         дата и формула для выборки МАЯ-месяца будет такая :+$E(k2,3,4)=5]]></Data>
<Node><Sub>1</Sub>
<Data><![CDATA[1 ;Формула вычисления для выборки. Например,ключ 2 это         дата и формула для выборки МАЯ-месяца будет такая :+$E(k2,3,4)=5]]></Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>58093,50584,MS</Data>
</Node>
<Node><Sub>RTR</Sub>
<Node><Sub>2</Sub>
<Node><Sub>6</Sub>
<Data>S d1=$$IF^%ZAPM.ed.BSsFUNR(&quot;d&apos;?.E1P.E&quot;,&quot;READ&quot;,&quot;&quot;,&quot;СИМВОЛ ПУНКТУАЦИИ В ИМЕННОМ КЛЮЧЕ ЗАПРЕЩЕН&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$$IF(&quot;d&apos;?.E1P.E&quot;,&quot;READ&quot;,&quot;&quot;,&quot;СИМВОЛ ПУНКТУАЦИИ В ИМЕННОМ КЛЮЧЕ ЗАПРЕЩЕН&quot;)</Data>
</Node>
</Node>
</Node>
<Node><Sub>12</Sub>
<Node><Sub>7</Sub>
<Data>S d1=$$IF^%ZAPM.ed.BSsFUNR(&quot;$$SINDDR^%ZAPM.ed.BSBD(d)&quot;,&quot;READ&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$$IF(&quot;$$SINDDR^%ZAPM.ed.BSBD(d)&quot;,&quot;READ&quot;)</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>STA</Sub>
<Data>2,5@2@1@13@-1@-1@4@37@</Data>
</Node>
</Node>
<Node><Sub>KEY3</Sub>
<Data><![CDATA[ n/n 3 ОПРЕДЕЛЕНИЕ КЛЮЧЕЙ@@@@@1@1@1@1@22@78@1@@1@1@@1@@2,1@@@@@@@1@1@12@15@@@@@@@@@@^%ZAPM.ed.BSHLP("KEY_HELP")]]></Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@3@15@@@@@1@2;6;30;46@@@@@---------------|    КЛЮЧИ   | |------------|</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@16@3@10@@@@@1@2;6;30;46@@@@@----------РАЗМЕРЫ:  Y,X,TIME</Data>
</Node>
<Node><Sub>3</Sub>
<Data>1@26@3@7@@@@@1@2;6;30;46@@@@@------- ТЕКСТ  ПРИГЛ.</Data>
</Node>
<Node><Sub>4</Sub>
<Data>1@33@3@4@@@@@1@2;6;30;46@@@@@----ЦВЕТТЕКСТ</Data>
</Node>
<Node><Sub>5</Sub>
<Data>1@37@3@8@@@@@1@2;6;30;46@@@@@-------- ТРАН    СИН.ТАБ</Data>
</Node>
<Node><Sub>6</Sub>
<Data>1@45@3@10@@@@@1@2;6;30;46@@@@@---------- НАЧАЛЬНОЕ ЗНАЧЕНИЕ</Data>
</Node>
<Node><Sub>7</Sub>
<Data>1@55@3@10@@@@@1@2;6;30;46@@@@@---------- КОНЕЧНОЕ  ЗНАЧЕНИЕ</Data>
</Node>
<Node><Sub>8</Sub>
<Data>1@65@3@7@@@@@1@2;6;30;46@@@@@ текст начала ключа</Data>
</Node>
<Node><Sub>9</Sub>
<Data>1@72@3@7@@@@@1@2;6;30;46@@@@@ текст конца   ключа</Data>
</Node>
<Node><Sub>10</Sub>
<Data>1@79@3@7@@@@@1@2;6;30;46@@@@@ВЫБОР   1@</Data>
</Node>
<Node><Sub>11</Sub>
<Data>1@86@3@7@@@@@1@2;6;30;46@@@@@ВЫБОР   2@</Data>
</Node>
<Node><Sub>12</Sub>
<Data>1@93@3@7@@@@@1@2;6;30;46@@@@@ВЫБОР   3@</Data>
</Node>
<Node><Sub>13</Sub>
<Data>1@100@3@7@@@@@1@2;6;30;46@@@@@ВЫБОР   4@</Data>
</Node>
<Node><Sub>14</Sub>
<Data>1@107@3@7@@@@@1@2;6;30;46@@@@@ВЫБОР   5@</Data>
</Node>
<Node><Sub>15</Sub>
<Data>1@114@3@7@@@@@1@2;6;30;46@@@@@...@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>4@1@1@15@@@@@1@2;6;30;46@@@@@ ИМЕННОЙ КЛЮЧ</Data>
</Node>
<Node><Sub>2</Sub>
<Data>4@16@1@10@@@@@1@@@@@@1,20</Data>
</Node>
<Node><Sub>3</Sub>
<Data>4@26@1@7@@@@@1@@@@@@Введите год в формате (ГГ)</Data>
</Node>
<Node><Sub>4</Sub>
<Data>4@33@1@4@@@@@1@2;6;30;41@@@@@НОВЫЙ ГОД</Data>
</Node>
<Node><Sub>5</Sub>
<Data>4@37@1@8@@@@@1@@@@@@99</Data>
</Node>
<Node><Sub>6</Sub>
<Data>4@45@1@10@@@@@1@@@@@@@0</Data>
</Node>
<Node><Sub>7</Sub>
<Data>4@55@1@10@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>8</Sub>
<Data>4@65@1@7@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>9</Sub>
<Data>4@72@1@7@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>10</Sub>
<Data>4@79@1@7@@@@@1@@@@@@XXX@</Data>
</Node>
<Node><Sub>11</Sub>
<Data>4@86@1@7@@@@@1@@@@@@XXX@</Data>
</Node>
<Node><Sub>12</Sub>
<Data>4@93@1@7@@@@@1@@@@@@XXX@</Data>
</Node>
<Node><Sub>13</Sub>
<Data>4@100@1@7@@@@@1@@@@@@XXX@</Data>
</Node>
<Node><Sub>14</Sub>
<Data>4@107@1@7@@@@@1@@@@@@XXX@</Data>
</Node>
<Node><Sub>15</Sub>
<Data>4@114@1@7@@@@@1@@@@@@...@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>5@1@1@15@@@@@1@2;6;30;46@@@@@ 1-Й ИНДЕКСНЫЙ</Data>
</Node>
<Node><Sub>2</Sub>
<Data>5@16@1@10@@@@@1@@@@@@1,50@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>5@26@1@7@@@@@1@@@@@@Введите Код структурных подразделений (2,4 или 9 цыфр)</Data>
</Node>
<Node><Sub>4</Sub>
<Data>5@33@1@4@@@@@1@2;6;30;42@@@@@НОВОЕ КСП</Data>
</Node>
<Node><Sub>5</Sub>
<Data>5@37@1@8@@@@@1@@@@@@64</Data>
</Node>
<Node><Sub>6</Sub>
<Data>5@45@1@10@@@@@1@@@@@@49</Data>
</Node>
<Node><Sub>7</Sub>
<Data>5@55@1@10@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>8</Sub>
<Data>5@65@1@7@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>9</Sub>
<Data>5@72@1@7@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>10</Sub>
<Data>5@79@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>11</Sub>
<Data>5@86@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>12</Sub>
<Data>5@93@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>13</Sub>
<Data>5@100@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>14</Sub>
<Data>5@107@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>15</Sub>
<Data>5@114@1@7@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>6@1@1@15@@@@@1@2;6;30;46@@@@@ 2-Й ИНДЕКСНЫЙ</Data>
</Node>
<Node><Sub>2</Sub>
<Data>6@16@1@10@@@@@1@@@@@@1,40,TIME</Data>
</Node>
<Node><Sub>3</Sub>
<Data>6@26@1@7@@@@@1@@@@@@Введите месяц и день в формате (ММДД) </Data>
</Node>
<Node><Sub>4</Sub>
<Data>6@33@1@4@@@@@1@2;6;37;44@@@@@НОВАЯ ДАТА</Data>
</Node>
<Node><Sub>5</Sub>
<Data>6@37@1@8@@@@@1@@@@@@0912</Data>
</Node>
<Node><Sub>6</Sub>
<Data>6@45@1@10@@@@@1@@@@@@0101</Data>
</Node>
<Node><Sub>7</Sub>
<Data>6@55@1@10@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>8</Sub>
<Data>6@65@1@7@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>9</Sub>
<Data>6@72@1@7@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>10</Sub>
<Data>6@79@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>11</Sub>
<Data>6@86@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>12</Sub>
<Data>6@93@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>13</Sub>
<Data>6@100@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>14</Sub>
<Data>6@107@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>15</Sub>
<Data>6@114@1@7@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>7@1@1@15@@@@@1@2;6;30;46@@@@@ 3-Й ИНДЕКСНЫЙ</Data>
</Node>
<Node><Sub>2</Sub>
<Data>7@16@1@10@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>7@26@1@7@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>7@33@1@4@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>7@37@1@8@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>6</Sub>
<Data>7@45@1@10@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>7</Sub>
<Data>7@55@1@10@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>8</Sub>
<Data>7@65@1@7@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>9</Sub>
<Data>7@72@1@7@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>10</Sub>
<Data>7@79@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>11</Sub>
<Data>7@86@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>12</Sub>
<Data>7@93@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>13</Sub>
<Data>7@100@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>14</Sub>
<Data>7@107@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>15</Sub>
<Data>7@114@1@7@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>8@1@1@15@@@@@1@2;6;30;46@@@@@ 4-Й ИНДЕКСНЫЙ</Data>
</Node>
<Node><Sub>2</Sub>
<Data>8@16@1@10@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>8@26@1@7@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>8@33@1@4@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>8@37@1@8@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>6</Sub>
<Data>8@45@1@10@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>7</Sub>
<Data>8@55@1@10@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>8</Sub>
<Data>8@65@1@7@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>9</Sub>
<Data>8@72@1@7@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>10</Sub>
<Data>8@79@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>11</Sub>
<Data>8@86@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>12</Sub>
<Data>8@93@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>13</Sub>
<Data>8@100@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>14</Sub>
<Data>8@107@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>15</Sub>
<Data>8@114@1@7@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>9@1@1@15@@@@@1@2;6;30;46@@@@@ 5-Й ИНДЕКСНЫЙ@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>9@16@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>9@26@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>9@33@1@4@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>9@37@1@8@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>6</Sub>
<Data>9@45@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>7</Sub>
<Data>9@55@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>8</Sub>
<Data>9@65@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>9</Sub>
<Data>9@72@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>10</Sub>
<Data>9@79@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>11</Sub>
<Data>9@86@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>12</Sub>
<Data>9@93@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>13</Sub>
<Data>9@100@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>14</Sub>
<Data>9@107@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>15</Sub>
<Data>9@114@1@7@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>1</Sub>
<Data>10@1@1@15@@@@@1@2;6;30;46@@@@@ 6-Й ИНДЕКСНЫЙ@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>10@16@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>10@26@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>10@33@1@4@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>10@37@1@8@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>6</Sub>
<Data>10@45@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>7</Sub>
<Data>10@55@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>8</Sub>
<Data>10@65@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>9</Sub>
<Data>10@72@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>10</Sub>
<Data>10@79@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>11</Sub>
<Data>10@86@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>12</Sub>
<Data>10@93@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>13</Sub>
<Data>10@100@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>14</Sub>
<Data>10@107@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>15</Sub>
<Data>10@114@1@7@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>1</Sub>
<Data>11@1@1@15@@@@@1@2;6;30;46@@@@@ 7-Й ИНДЕКСНЫЙ@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>11@16@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>11@26@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>11@33@1@4@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>11@37@1@8@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>6</Sub>
<Data>11@45@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>7</Sub>
<Data>11@55@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>8</Sub>
<Data>11@65@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>9</Sub>
<Data>11@72@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>10</Sub>
<Data>11@79@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>11</Sub>
<Data>11@86@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>12</Sub>
<Data>11@93@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>13</Sub>
<Data>11@100@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>14</Sub>
<Data>11@107@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>15</Sub>
<Data>11@114@1@7@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>1</Sub>
<Data>12@1@1@15@@@@@1@2;6;30;46@@@@@ 8-Й ИНДЕКСНЫЙ@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>12@16@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>12@26@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>12@33@1@4@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>12@37@1@8@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>6</Sub>
<Data>12@45@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>7</Sub>
<Data>12@55@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>8</Sub>
<Data>12@65@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>9</Sub>
<Data>12@72@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>10</Sub>
<Data>12@79@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>11</Sub>
<Data>12@86@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>12</Sub>
<Data>12@93@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>13</Sub>
<Data>12@100@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>14</Sub>
<Data>12@107@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>15</Sub>
<Data>12@114@1@7@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>11</Sub>
<Node><Sub>1</Sub>
<Data>13@1@1@15@@@@@1@2;6;30;46@@@@@ 9-Й ИНДЕКСНЫЙ</Data>
</Node>
<Node><Sub>2</Sub>
<Data>13@16@1@10@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>13@26@1@7@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>13@33@1@4@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>13@37@1@8@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>6</Sub>
<Data>13@45@1@10@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>7</Sub>
<Data>13@55@1@10@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>8</Sub>
<Data>13@65@1@7@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>9</Sub>
<Data>13@72@1@7@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>10</Sub>
<Data><![CDATA[13@79@1@7@@@@@1@@@@0@@Текст ,который появится в меню при организации выборки для выдачи СПИСКОВ и СВОДОК@]]></Data>
</Node>
<Node><Sub>11</Sub>
<Data>13@86@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>12</Sub>
<Data>13@93@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>13</Sub>
<Data>13@100@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>14</Sub>
<Data>13@107@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>15</Sub>
<Data>13@114@1@7@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>12</Sub>
<Node><Sub>1</Sub>
<Data>14@1@1@15@@@@@1@2;6;30;45@@@@@ОПИСАНИЕ КЛЮЧЕЙ</Data>
</Node>
<Node><Sub>2</Sub>
<Data>14@16@1@10@@@@@1@2;6;30;45@@@@@ ДЛЯ ТАБЛИ</Data>
</Node>
<Node><Sub>3</Sub>
<Data>14@26@1@7@@@@@1@2;6;30;45@@@@@ЦЫ</Data>
</Node>
<Node><Sub>4</Sub>
<Data>14@33@1@4@@@@@1@2;6;30;45@@@@@БАЗА Д</Data>
</Node>
<Node><Sub>5</Sub>
<Data>14@37@1@8@@@@@1@2;6;30;45@@@@@ ДАННЫХ:</Data>
</Node>
<Node><Sub>6</Sub>
<Data>14@45@1@10@@@@@1@1;6;37;45@1@@@@???@@@@@^%ZAPM.ed.BSHLP(&quot;KH1&quot;)</Data>
</Node>
<Node><Sub>7</Sub>
<Data>14@55@1@10@@@@@1@1;6;37;45@@@@12,7@@0@@@@^%ZAPM.ed.BSHLP(&quot;KH2&quot;)</Data>
</Node>
<Node><Sub>8</Sub>
<Data>14@65@1@7@@@@@1@1;6;37;45@@@@@@@@@@^%ZAPM.ed.BSHLP(&quot;KH3&quot;)</Data>
</Node>
<Node><Sub>9</Sub>
<Data>14@72@1@7@@@@@1@1;6;37;45@@@@@ВЫБОР-&gt;</Data>
</Node>
<Node><Sub>10</Sub>
<Data>14@79@1@7@@@@@1@1;6;37;45@@@@@ВВЕДИТЕ@</Data>
</Node>
<Node><Sub>11</Sub>
<Data>14@86@1@7@@@@@1@1;6;37;45@@@@@ В НУЖН@</Data>
</Node>
<Node><Sub>12</Sub>
<Data>14@93@1@7@@@@@1@1;6;37;45@@@@@УЮ КЛЕТ@</Data>
</Node>
<Node><Sub>13</Sub>
<Data>14@100@1@7@@@@@1@1;6;37;45@@@@@КУ ТЕКС@</Data>
</Node>
<Node><Sub>14</Sub>
<Data>14@107@1@7@@@@@1@1;6;37;45@@@@@Т И Ф.Л@</Data>
</Node>
<Node><Sub>15</Sub>
<Data>14@114@1@7@@@@@1@1;6;37;45@@@@@ОГИКИ@</Data>
</Node>
</Node>
<Node><Sub>CMD</Sub>
<Node><Sub>12</Sub>
<Node><Sub>7</Sub>
<Data>S IYI=&quot;PARAM,%BSVOL,,,&lt;&gt;&quot; D ENTER^%ZAPM.ed.BSN</Data>
</Node>
</Node>
</Node>
<Node><Sub>COL</Sub>
<Node><Sub>11</Sub>
<Node><Sub>10</Sub>
<Data><![CDATA[I 1 ;Формула вычисления для выборки. Например,ключ 2 это         дата и формула для выборки МАЯ-месяца будет такая :+$E(k2,3,4)=5]]></Data>
<Node><Sub>1</Sub>
<Data><![CDATA[1 ;Формула вычисления для выборки. Например,ключ 2 это         дата и формула для выборки МАЯ-месяца будет такая :+$E(k2,3,4)=5]]></Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>58093,50598,MS</Data>
</Node>
<Node><Sub>RTR</Sub>
<Node><Sub>2</Sub>
<Node><Sub>6</Sub>
<Data>S d1=$$IF^%ZAPM.ed.BSsFUNR(&quot;d&apos;?.E1P.E&quot;,&quot;READ&quot;,&quot;&quot;,&quot;СИМВОЛ ПУНКТУАЦИИ В ИМЕННОМ КЛЮЧЕ ЗАПРЕЩЕН&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$$IF(&quot;d&apos;?.E1P.E&quot;,&quot;READ&quot;,&quot;&quot;,&quot;СИМВОЛ ПУНКТУАЦИИ В ИМЕННОМ КЛЮЧЕ ЗАПРЕЩЕН&quot;)</Data>
</Node>
</Node>
</Node>
<Node><Sub>12</Sub>
<Node><Sub>7</Sub>
<Data>S d1=$$IF^%ZAPM.ed.BSsFUNR(&quot;$$SINDDR^%ZAPM.ed.BSBD(d)&quot;,&quot;READ&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$$IF(&quot;$$SINDDR^%ZAPM.ed.BSBD(d)&quot;,&quot;READ&quot;)</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>STA</Sub>
<Data>2,5@2@1@13@-1@-1@4@37@99</Data>
</Node>
</Node>
<Node><Sub>Key0</Sub>
<Data><![CDATA[ПАРАМЕТРЫ КЛЮЧЕЙ ДЛЯ СПИСКОВ\СВОДОК@@@@@1@1@1@1@22@78@1@@1@1@@1@@2,1@@@@@@@1@1@11@15@@@@@@@@@@^%ZAPM.ed.BSHLP("KEY_HELP_C")]]></Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@3@15@@@@@1@2;6;30;46@@@@@---------------|    КЛЮЧИ   | |------------|</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@16@3@10@@@@@1@2;6;30;46@@@@@----------</Data>
</Node>
<Node><Sub>3</Sub>
<Data>1@26@3@7@@@@@1@2;6;30;46@@@@@-------</Data>
</Node>
<Node><Sub>4</Sub>
<Data>1@33@3@4@@@@@1@2;6;30;46@@@@@----</Data>
</Node>
<Node><Sub>5</Sub>
<Data>1@37@3@8@@@@@1@2;6;30;46@@@@@-------- ТРАН    СИН.ТАБ</Data>
</Node>
<Node><Sub>6</Sub>
<Data>1@45@3@10@@@@@1@2;6;30;46@@@@@----------</Data>
</Node>
<Node><Sub>7</Sub>
<Data>1@55@3@10@@@@@1@2;6;30;46@@@@@---------- </Data>
</Node>
<Node><Sub>8</Sub>
<Data>1@65@3@7@@@@@1@2;6;30;46@@@@@</Data>
</Node>
<Node><Sub>9</Sub>
<Data>1@72@3@7@@@@@1@2;6;30;46@@@@@</Data>
</Node>
<Node><Sub>10</Sub>
<Data>1@79@3@7@@@@@1@2;6;30;46@@@@@ВЫБОР   1@</Data>
</Node>
<Node><Sub>11</Sub>
<Data>1@86@3@7@@@@@1@2;6;30;46@@@@@ВЫБОР   2@</Data>
</Node>
<Node><Sub>12</Sub>
<Data>1@93@3@7@@@@@1@2;6;30;46@@@@@ВЫБОР   3@</Data>
</Node>
<Node><Sub>13</Sub>
<Data>1@100@3@7@@@@@1@2;6;30;46@@@@@ВЫБОР   4@</Data>
</Node>
<Node><Sub>14</Sub>
<Data>1@107@3@7@@@@@1@2;6;30;46@@@@@ВЫБОР   5@</Data>
</Node>
<Node><Sub>15</Sub>
<Data>1@114@3@7@@@@@1@2;6;30;46@@@@@...@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>4@1@1@15@@@@@1@2;6;30;46@@@@@ ИМЕННОЙ КЛЮЧ@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>4@16@1@10@@@@@1@1;6;32;44@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>4@26@1@7@@@@@1@1;6;32;44@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>4@33@1@4@@@@@1@1;6;32;44@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>4@37@1@8@@@@@1@1;6;32;44@@@@@</Data>
</Node>
<Node><Sub>6</Sub>
<Data>4@45@1@10@@@@@1@1;6;32;44@@@@@@0</Data>
</Node>
<Node><Sub>7</Sub>
<Data>4@55@1@10@@@@@1@1;6;32;44@@@@@</Data>
</Node>
<Node><Sub>8</Sub>
<Data>4@65@1@7@@@@@1@1;6;32;44@@@@@</Data>
</Node>
<Node><Sub>9</Sub>
<Data>4@72@1@7@@@@@1@1;6;32;44@@@@@</Data>
</Node>
<Node><Sub>10</Sub>
<Data>4@79@1@7@@@@@1@@@@@@XXX@</Data>
</Node>
<Node><Sub>11</Sub>
<Data>4@86@1@7@@@@@1@@@@@@XXX@</Data>
</Node>
<Node><Sub>12</Sub>
<Data>4@93@1@7@@@@@1@@@@@@XXX@</Data>
</Node>
<Node><Sub>13</Sub>
<Data>4@100@1@7@@@@@1@@@@@@XXX@</Data>
</Node>
<Node><Sub>14</Sub>
<Data>4@107@1@7@@@@@1@@@@@@XXX@</Data>
</Node>
<Node><Sub>15</Sub>
<Data>4@114@1@7@@@@@1@@@@@@...@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>5@1@1@15@@@@@1@2;6;30;46@@@@@ 1-Й ИНДЕКСНЫЙ</Data>
</Node>
<Node><Sub>2</Sub>
<Data>5@16@1@10@@@@@1@1;6;32;44@@@@@O&apos;k@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>5@26@1@7@@@@@1@1;6;32;44@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>5@33@1@4@@@@@1@1;6;32;44@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>5@37@1@8@@@@0@1@1;6;32;44@@@@@991211</Data>
</Node>
<Node><Sub>6</Sub>
<Data>5@45@1@10@@@@@1@1;6;32;44@@@@@</Data>
</Node>
<Node><Sub>7</Sub>
<Data>5@55@1@10@@@@@1@1;6;32;44@@@@@</Data>
</Node>
<Node><Sub>8</Sub>
<Data>5@65@1@7@@@@@1@1;6;32;44@@@@@</Data>
</Node>
<Node><Sub>9</Sub>
<Data>5@72@1@7@@@@@1@1;6;32;44@@@@@</Data>
</Node>
<Node><Sub>10</Sub>
<Data>5@79@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>11</Sub>
<Data>5@86@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>12</Sub>
<Data>5@93@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>13</Sub>
<Data>5@100@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>14</Sub>
<Data>5@107@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>15</Sub>
<Data>5@114@1@7@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>6@1@1@15@@@@@1@2;6;30;46@@@@@ 2-Й ИНДЕКСНЫЙ</Data>
</Node>
<Node><Sub>2</Sub>
<Data>6@16@1@10@@@@@1@1;6;32;44@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>6@26@1@7@@@@@1@1;6;32;44@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>6@33@1@4@@@@@1@1;6;32;44@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>6@37@1@8@@@@@1@1;6;32;44@@@@@</Data>
</Node>
<Node><Sub>6</Sub>
<Data>6@45@1@10@@@@@1@1;6;32;44@@@@@</Data>
</Node>
<Node><Sub>7</Sub>
<Data>6@55@1@10@@@@@1@1;6;32;44@@@@@</Data>
</Node>
<Node><Sub>8</Sub>
<Data>6@65@1@7@@@@@1@1;6;32;44@@@@@</Data>
</Node>
<Node><Sub>9</Sub>
<Data>6@72@1@7@@@@@1@1;6;32;44@@@@@</Data>
</Node>
<Node><Sub>10</Sub>
<Data>6@79@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>11</Sub>
<Data>6@86@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>12</Sub>
<Data>6@93@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>13</Sub>
<Data>6@100@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>14</Sub>
<Data>6@107@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>15</Sub>
<Data>6@114@1@7@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>7@1@1@15@@@@@1@2;6;30;46@@@@@ 3-Й ИНДЕКСНЫЙ</Data>
</Node>
<Node><Sub>2</Sub>
<Data>7@16@1@10@@@@@1@1;6;32;44@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>7@26@1@7@@@@@1@1;6;32;44@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>7@33@1@4@@@@@1@1;6;32;44@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>7@37@1@8@@@@@1@1;6;32;44@@@@@</Data>
</Node>
<Node><Sub>6</Sub>
<Data>7@45@1@10@@@@@1@1;6;32;44@@@@@</Data>
</Node>
<Node><Sub>7</Sub>
<Data>7@55@1@10@@@@@1@1;6;32;44@@@@@</Data>
</Node>
<Node><Sub>8</Sub>
<Data>7@65@1@7@@@@@1@1;6;32;44@@@@@</Data>
</Node>
<Node><Sub>9</Sub>
<Data>7@72@1@7@@@@@1@1;6;32;44@@@@@</Data>
</Node>
<Node><Sub>10</Sub>
<Data>7@79@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>11</Sub>
<Data>7@86@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>12</Sub>
<Data>7@93@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>13</Sub>
<Data>7@100@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>14</Sub>
<Data>7@107@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>15</Sub>
<Data>7@114@1@7@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>8@1@1@15@@@@@1@2;6;30;46@@@@@ 4-Й ИНДЕКСНЫЙ</Data>
</Node>
<Node><Sub>2</Sub>
<Data>8@16@1@10@@@@@1@1;6;32;44@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>8@26@1@7@@@@@1@1;6;32;44@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>8@33@1@4@@@@@1@1;6;32;44@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>8@37@1@8@@@@@1@1;6;32;44@@@@@</Data>
</Node>
<Node><Sub>6</Sub>
<Data>8@45@1@10@@@@@1@1;6;32;44@@@@@</Data>
</Node>
<Node><Sub>7</Sub>
<Data>8@55@1@10@@@@@1@1;6;32;44@@@@@</Data>
</Node>
<Node><Sub>8</Sub>
<Data>8@65@1@7@@@@@1@1;6;32;44@@@@@</Data>
</Node>
<Node><Sub>9</Sub>
<Data>8@72@1@7@@@@@1@1;6;32;44@@@@@</Data>
</Node>
<Node><Sub>10</Sub>
<Data>8@79@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>11</Sub>
<Data>8@86@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>12</Sub>
<Data>8@93@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>13</Sub>
<Data>8@100@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>14</Sub>
<Data>8@107@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>15</Sub>
<Data>8@114@1@7@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>9@1@1@15@@@@@1@2;6;30;46@@@@@ 5-Й ИНДЕКСНЫЙ@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>9@16@1@10@@@@@1@1;6;32;44@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>9@26@1@7@@@@@1@1;6;32;44@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>9@33@1@4@@@@@1@1;6;32;44@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>9@37@1@8@@@@@1@1;6;32;44@@@@@@</Data>
</Node>
<Node><Sub>6</Sub>
<Data>9@45@1@10@@@@@1@1;6;32;44@@@@@@</Data>
</Node>
<Node><Sub>7</Sub>
<Data>9@55@1@10@@@@@1@1;6;32;44@@@@@@</Data>
</Node>
<Node><Sub>8</Sub>
<Data>9@65@1@7@@@@@1@1;6;32;44@@@@@@</Data>
</Node>
<Node><Sub>9</Sub>
<Data>9@72@1@7@@@@@1@1;6;32;44@@@@@@</Data>
</Node>
<Node><Sub>10</Sub>
<Data>9@79@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>11</Sub>
<Data>9@86@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>12</Sub>
<Data>9@93@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>13</Sub>
<Data>9@100@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>14</Sub>
<Data>9@107@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>15</Sub>
<Data>9@114@1@7@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>1</Sub>
<Data>10@1@1@15@@@@@1@2;6;30;46@@@@@ 6-Й ИНДЕКСНЫЙ@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>10@16@1@10@@@@@1@1;6;32;44@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>10@26@1@7@@@@@1@1;6;32;44@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>10@33@1@4@@@@@1@1;6;32;44@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>10@37@1@8@@@@@1@1;6;32;44@@@@@@</Data>
</Node>
<Node><Sub>6</Sub>
<Data>10@45@1@10@@@@@1@1;6;32;44@@@@@@</Data>
</Node>
<Node><Sub>7</Sub>
<Data>10@55@1@10@@@@@1@1;6;32;44@@@@@@</Data>
</Node>
<Node><Sub>8</Sub>
<Data>10@65@1@7@@@@@1@1;6;32;44@@@@@@</Data>
</Node>
<Node><Sub>9</Sub>
<Data>10@72@1@7@@@@@1@1;6;32;44@@@@@@</Data>
</Node>
<Node><Sub>10</Sub>
<Data>10@79@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>11</Sub>
<Data>10@86@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>12</Sub>
<Data>10@93@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>13</Sub>
<Data>10@100@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>14</Sub>
<Data>10@107@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>15</Sub>
<Data>10@114@1@7@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>1</Sub>
<Data>11@1@1@15@@@@@1@2;6;30;46@@@@@ 7-Й ИНДЕКСНЫЙ@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>11@16@1@10@@@@@1@1;6;32;44@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>11@26@1@7@@@@@1@1;6;32;44@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>11@33@1@4@@@@@1@1;6;32;44@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>11@37@1@8@@@@@1@1;6;32;44@@@@@@</Data>
</Node>
<Node><Sub>6</Sub>
<Data>11@45@1@10@@@@@1@1;6;32;44@@@@@@</Data>
</Node>
<Node><Sub>7</Sub>
<Data>11@55@1@10@@@@@1@1;6;32;44@@@@@@</Data>
</Node>
<Node><Sub>8</Sub>
<Data>11@65@1@7@@@@@1@1;6;32;44@@@@@@</Data>
</Node>
<Node><Sub>9</Sub>
<Data>11@72@1@7@@@@@1@1;6;32;44@@@@@@</Data>
</Node>
<Node><Sub>10</Sub>
<Data>11@79@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>11</Sub>
<Data>11@86@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>12</Sub>
<Data>11@93@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>13</Sub>
<Data>11@100@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>14</Sub>
<Data>11@107@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>15</Sub>
<Data>11@114@1@7@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>1</Sub>
<Data>12@1@1@15@@@@@1@2;6;30;46@@@@@ 8-Й ИНДЕКСНЫЙ@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>12@16@1@10@@@@@1@1;6;32;44@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>12@26@1@7@@@@@1@1;6;32;44@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>12@33@1@4@@@@@1@1;6;32;44@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>12@37@1@8@@@@@1@1;6;32;44@@@@@@</Data>
</Node>
<Node><Sub>6</Sub>
<Data>12@45@1@10@@@@@1@1;6;32;44@@@@@@</Data>
</Node>
<Node><Sub>7</Sub>
<Data>12@55@1@10@@@@@1@1;6;32;44@@@@@@</Data>
</Node>
<Node><Sub>8</Sub>
<Data>12@65@1@7@@@@@1@1;6;32;44@@@@@@</Data>
</Node>
<Node><Sub>9</Sub>
<Data>12@72@1@7@@@@@1@1;6;32;44@@@@@@</Data>
</Node>
<Node><Sub>10</Sub>
<Data>12@79@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>11</Sub>
<Data>12@86@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>12</Sub>
<Data>12@93@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>13</Sub>
<Data>12@100@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>14</Sub>
<Data>12@107@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>15</Sub>
<Data>12@114@1@7@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>11</Sub>
<Node><Sub>1</Sub>
<Data>13@1@1@15@@@@@1@2;6;30;46@@@@@ 9-Й ИНДЕКСНЫЙ</Data>
</Node>
<Node><Sub>2</Sub>
<Data>13@16@1@10@@@@@1@1;6;32;44@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>13@26@1@7@@@@@1@1;6;32;44@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>13@33@1@4@@@@@1@1;6;32;44@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>13@37@1@8@@@@@1@1;6;32;44@@@@@</Data>
</Node>
<Node><Sub>6</Sub>
<Data>13@45@1@10@@@@@1@1;6;32;44@@@@@</Data>
</Node>
<Node><Sub>7</Sub>
<Data>13@55@1@10@@@@@1@1;6;32;44@@@@@</Data>
</Node>
<Node><Sub>8</Sub>
<Data>13@65@1@7@@@@@1@1;6;32;44@@@@@</Data>
</Node>
<Node><Sub>9</Sub>
<Data>13@72@1@7@@@@@1@1;6;32;44@@@@@</Data>
</Node>
<Node><Sub>10</Sub>
<Data><![CDATA[13@79@1@7@@@@@1@@@@0@@Текст ,который появится в меню при организации выборки для выдачи СПИСКОВ и СВОДОК@]]></Data>
</Node>
<Node><Sub>11</Sub>
<Data>13@86@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>12</Sub>
<Data>13@93@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>13</Sub>
<Data>13@100@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>14</Sub>
<Data>13@107@1@7@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>15</Sub>
<Data>13@114@1@7@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>COL</Sub>
<Node><Sub>11</Sub>
<Node><Sub>10</Sub>
<Data><![CDATA[I 1 ;Формула вычисления для выборки. Например,ключ 2 это         дата и формула для выборки МАЯ-месяца будет такая :+$E(k2,3,4)=5]]></Data>
<Node><Sub>1</Sub>
<Data><![CDATA[1 ;Формула вычисления для выборки. Например,ключ 2 это         дата и формула для выборки МАЯ-месяца будет такая :+$E(k2,3,4)=5]]></Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>FTR</Sub>
<Node><Sub>3</Sub>
<Node><Sub>5</Sub>
<Data>S d1=$E(d,5,6)_&quot;.&quot;_$E(d,3,4)_&quot;.&quot;_$E(d,1,2)</Data>
<Node><Sub>1</Sub>
<Data>$E(d,5,6)_&quot;.&quot;_$E(d,3,4)_&quot;.&quot;_$E(d,1,2)</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>RTR</Sub>
<Node><Sub>2</Sub>
<Node><Sub>6</Sub>
<Data>S d1=$$IF^%ZAPM.ed.BSsFUNR(&quot;d&apos;?.E1P.E&quot;,&quot;READ&quot;,&quot;&quot;,&quot;СИМВОЛ ПУНКТУАЦИИ В ИМЕННОМ КЛЮЧЕ ЗАПРЕЩЕН&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$$IF(&quot;d&apos;?.E1P.E&quot;,&quot;READ&quot;,&quot;&quot;,&quot;СИМВОЛ ПУНКТУАЦИИ В ИМЕННОМ КЛЮЧЕ ЗАПРЕЩЕН&quot;)</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>STA</Sub>
<Data>2,1@2@1@13@-1@-1@4@1@ ИМЕННОЙ КЛЮЧ</Data>
</Node>
</Node>
<Node><Sub>LOGON</Sub>
<Data>@@@@@1@1@1@1@22@80@1@@1@1@@8@@@1@@@@@@@@4@3@@1;6;32;44@@@@@@@@^%ZAPM.ed.BSHLP(&quot;HELP-ALTF2&quot;)</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@10@@@@@1@@@@@@ Выберите Пожалуйста Режим работы ? @@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@11@1@10@@@@@1@1;6;30;43@@@0@@ СНОВА В %BS @</Data>
</Node>
<Node><Sub>3</Sub>
<Data>1@21@1@10@@@@@1@@@@@@1@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@10@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>2@11@1@10@@@@@1@1;6;36;43@@@@@ НАЗАД В ДОС @</Data>
</Node>
<Node><Sub>3</Sub>
<Data>2@21@1@10@@@@@1@@@@@@2@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@11@1@10@@@@@1@@@@@3,2@ ПОМОЩЬ @</Data>
</Node>
<Node><Sub>3</Sub>
<Data>3@21@1@10@@@@@1@@@@@@0@</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>4@1@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>4@11@1@10@@@@@1@@@@@4,2@ DDP @</Data>
</Node>
<Node><Sub>3</Sub>
<Data>4@21@1@10@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>BUT</Sub>
<Data>/1;6;32;44</Data>
<Node><Sub>0</Sub>
<Data>1;6;32;44</Data>
<Node><Sub>1</Sub>
<Data> Выберите Пожалуйста Режим работы ? </Data>
</Node>
</Node>
<Node><Sub>1</Sub>
<Data>1;6;30;43/1;6;36;43</Data>
<Node><Sub>1</Sub>
<Data> СНОВА В %BS </Data>
</Node>
<Node><Sub>2</Sub>
<Data> НАЗАД В ДОС </Data>
</Node>
<Node><Sub>3</Sub>
<Data> ПОМОЩЬ </Data>
</Node>
<Node><Sub>4</Sub>
<Data> DDP </Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Data>1</Data>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>3</Sub>
<Data>3,2</Data>
</Node>
<Node><Sub>4</Sub>
<Data>4,2</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>1</Data>
</Node>
<Node><Sub>2</Sub>
<Data>2</Data>
</Node>
<Node><Sub>3</Sub>
<Data>0</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>0</Data>
</Node>
<Node><Sub>2</Sub>
<Data>0</Data>
</Node>
</Node>
</Node>
<Node><Sub>CMD</Sub>
<Node><Sub>3</Sub>
<Node><Sub>2</Sub>
<Data>S:$E(%BS(1),20)&amp;(%BS(12)=&quot;&quot;) %BS(12)=&quot;???&quot; S BST=&quot;GUIDE&quot;,BSR=&quot;^%ZAPM.ed.BSHLP&quot; D ^%ZAPM.ed.BST</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>2</Sub>
<Data><![CDATA[N  W #,"<<<< Если не видно СЕРВЕРА, то выполните пункт 2, а потом пункт 1 >>>>",!,"     ...при неудаче перезагрузитесь...",!!!!!! D ^DDP W # Q]]></Data>
</Node>
</Node>
</Node>
<Node><Sub>COL</Sub>
<Node><Sub>1</Sub>
<Node><Sub>2</Sub>
<Data>I 1</Data>
<Node><Sub>1</Sub>
<Data>1</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>58206,54732,???</Data>
</Node>
<Node><Sub>STA</Sub>
<Data>,@1@1@-2@-2@-2@1@11@ СНОВА В %BS </Data>
</Node>
</Node>
<Node><Sub>MOUNT</Sub>
<Data>СПИСОК МОНТИРУЕМЫХ ТОМОВ@@@@@1@1@3@13@19@71@@1@@@@1@@2,1@@@@@@@@@16@5@@2;6;30;45@@@@@@@2</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@2@18@@@@@1@2;6;30;45@@@@@  Коментарии к    монтируемым базам</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@19@2@24@@@@@1@2;6;30;45@@@@@ DOS-ФАЙЛ для явного ... или имя удаленной сист.</Data>
</Node>
<Node><Sub>3</Sub>
<Data>1@43@2@4@@@@@1@2;6;30;45@@@@@ ИМЯ ТОМ@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>1@47@2@6@@@@@1@2;6;30;45@@@@@ ПРОВЕ РЯТЬ?@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>1@53@2@7@@@@@1@2;6;30;45@@@@@ РАЗДЕ- ЛЯЕМАЯ@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@18@@@@@1@2;6;30;46@@@@@СИСТЕМНЫЙ ТОМ</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@19@1@24@@@@@1@2;6;30;46@@@@@SRV@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>3@43@1@4@@@@@1@2;6;30;46@@@@@SYS@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>3@47@1@6@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>3@53@1@7@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>4@1@1@18@@@@@1@2;6;30;46@@@@@ТАБЕЛЬ ОТЧЕТНОСТИ</Data>
</Node>
<Node><Sub>2</Sub>
<Data>4@19@1@24@@@@@1@2;6;30;46@@@@@SRV@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>4@43@1@4@@@@@1@2;6;30;46@@@@@TAB@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>4@47@1@6@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>4@53@1@7@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>5@1@1@18@@@@@1@2;6;30;46@@@@@МОЛНИЯ@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>5@19@1@24@@@@@1@2;6;30;46@@@@@WNT@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>5@43@1@4@@@@@1@2;6;30;46@@@@@VOI@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>5@47@1@6@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>5@53@1@7@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>6@1@1@18@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>6@19@1@24@@@@@1@2;6;30;46@@@@@d:\!\tab.wnt@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>6@43@1@4@@@@@1@2;6;30;46@@@@@TTT@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>6@47@1@6@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>6@53@1@7@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>7@1@1@18@@@@@1@2;6;30;46@@@@@---- ЛОКАЛЬНЫЕ ---</Data>
</Node>
<Node><Sub>2</Sub>
<Data>7@19@1@24@@@@@1@2;6;30;46@@@@@ БАЗЫ</Data>
</Node>
<Node><Sub>3</Sub>
<Data>7@43@1@4@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>7@47@1@6@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>7@53@1@7@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>8@1@1@18@@@@@1@2;6;30;46@@@@@СИСТЕМНЫЙ ТОМ</Data>
</Node>
<Node><Sub>2</Sub>
<Data>8@19@1@24@@@@@1@2;6;30;46@@@@@\base.tyl\full\sy.msm</Data>
</Node>
<Node><Sub>3</Sub>
<Data>8@43@1@4@@@@@1@2;6;30;46@@@@@SSS@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>8@47@1@6@@@@@1@2;6;30;46@@@@@N@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>8@53@1@7@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>1</Sub>
<Data>9@1@1@18@@@@@1@2;6;30;46@@@@@ТАБЕЛЬ ОТЧЕТНОСТИ</Data>
</Node>
<Node><Sub>2</Sub>
<Data>9@19@1@24@@@@@1@2;6;30;46@@@@@\base.tyl\full\ta.MSM</Data>
</Node>
<Node><Sub>3</Sub>
<Data>9@43@1@4@@@@@1@2;6;30;46@@@@@TTT@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>9@47@1@6@@@@@1@2;6;30;46@@@@@N@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>9@53@1@7@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>1</Sub>
<Data>10@1@1@18@@@@@1@2;6;30;46@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>10@19@1@24@@@@@1@2;6;30;46@@@@@\base.tyl\smail\sy.msm</Data>
</Node>
<Node><Sub>3</Sub>
<Data>10@43@1@4@@@@@1@2;6;30;46@@@@@sss@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>10@47@1@6@@@@@1@2;6;30;46@@@@@N@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>10@53@1@7@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>1</Sub>
<Data>11@1@1@18@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>11@19@1@24@@@@@1@2;6;30;46@@@@@\base.tyl\smail\ta.msm@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>11@43@1@4@@@@@1@2;6;30;46@@@@@ttt@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>11@47@1@6@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>11@53@1@7@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
</Node>
<Node><Sub>11</Sub>
<Node><Sub>1</Sub>
<Data>12@1@1@18@@@@@1@2;6;30;46@@@@@---- УДАЛЕННЫЕ ---@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>12@19@1@24@@@@@1@2;6;30;46@@@@@БАЗЫ@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>12@43@1@4@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>12@47@1@6@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>12@53@1@7@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
</Node>
<Node><Sub>12</Sub>
<Node><Sub>1</Sub>
<Data>13@1@1@18@@@@@1@2;6;30;46@@@@@СИСТЕМНЫЙ ТОМ</Data>
</Node>
<Node><Sub>2</Sub>
<Data>13@19@1@24@@@@@1@2;6;30;46@@@@@SRV@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>13@43@1@4@@@@@1@2;6;30;46@@@@@SYS@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>13@47@1@6@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>13@53@1@7@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
</Node>
<Node><Sub>13</Sub>
<Node><Sub>1</Sub>
<Data>14@1@1@18@@@@@1@2;6;30;46@@@@@ТАБЕЛЬ ОТЧЕТНОСТИ</Data>
</Node>
<Node><Sub>2</Sub>
<Data>14@19@1@24@@@@@1@2;6;30;46@@@@@SRV@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>14@43@1@4@@@@@1@2;6;30;46@@@@@TAB@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>14@47@1@6@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>14@53@1@7@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
</Node>
<Node><Sub>14</Sub>
<Node><Sub>1</Sub>
<Data>15@1@1@18@@@@@1@2;6;30;46@@@@@МОЛНИЯ@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>15@19@1@24@@@@@1@2;6;30;46@@@@@SRV@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>15@43@1@4@@@@@1@2;6;30;46@@@@@VOI@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>15@47@1@6@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>15@53@1@7@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
</Node>
<Node><Sub>15</Sub>
<Node><Sub>1</Sub>
<Data>16@1@1@18@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>16@19@1@24@@@@@1@2;6;30;46@@@@@WNT@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>16@43@1@4@@@@@1@2;6;30;46@@@@@WNT@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>16@47@1@6@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>16@53@1@7@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
</Node>
<Node><Sub>16</Sub>
<Node><Sub>1</Sub>
<Data>17@1@1@18@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>17@19@1@24@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>17@43@1@4@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>17@47@1@6@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>17@53@1@7@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>57877,42789,MS</Data>
</Node>
<Node><Sub>STA</Sub>
<Data>16,3@2@1@27@-1@-1@19@55@</Data>
</Node>
</Node>
<Node><Sub>MOVE</Sub>
<Data>@@@@@1@1@1@1@22@80@1@@1@1@@8@@@1@@@@@@@@3@3@@1;6;32;44@@@@@@@@^%ZAPM.ed.BSHLP(&quot;HELP-ALTF2&quot;)</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@10@@@@@1@@@@@@ Постдвижение указателя. Выберите Пожалуйста.@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@11@1@10@@@@@1@1;6;30;43@@@@@ ВНИЗ @</Data>
</Node>
<Node><Sub>3</Sub>
<Data>1@21@1@10@@@@@1@@@@@@1@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@10@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>2@11@1@10@@@@@1@1;6;36;43@@@0@@ ВПРАВО @</Data>
</Node>
<Node><Sub>3</Sub>
<Data>2@21@1@10@@@@@1@@@@@@2@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@11@1@10@@@@@1@@@@@@ ОТКАЗ @</Data>
</Node>
<Node><Sub>3</Sub>
<Data>3@21@1@10@@@@@1@@@@@@0@</Data>
</Node>
</Node>
<Node><Sub>BUT</Sub>
<Data>/1;6;32;44</Data>
<Node><Sub>0</Sub>
<Data>1;6;32;44</Data>
<Node><Sub>1</Sub>
<Data> Постдвижение указателя. Выберите Пожалуйста.</Data>
</Node>
</Node>
<Node><Sub>1</Sub>
<Data>1;6;30;43/1;6;36;43</Data>
<Node><Sub>1</Sub>
<Data> ВНИЗ </Data>
</Node>
<Node><Sub>2</Sub>
<Data> ВПРАВО </Data>
</Node>
<Node><Sub>3</Sub>
<Data> ОТКАЗ </Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Data>2</Data>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>1</Data>
</Node>
<Node><Sub>2</Sub>
<Data>2</Data>
</Node>
<Node><Sub>3</Sub>
<Data>0</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>0</Data>
</Node>
<Node><Sub>2</Sub>
<Data>0</Data>
</Node>
</Node>
</Node>
<Node><Sub>COL</Sub>
<Node><Sub>2</Sub>
<Node><Sub>2</Sub>
<Data>I 1</Data>
<Node><Sub>1</Sub>
<Data>1</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>STA</Sub>
<Data>,@1@1@13@-1@-1@1@21@1</Data>
</Node>
</Node>
<Node><Sub>MSM-SERVER</Sub>
<Data>@@@@@1@1@1@1@22@80@1@@1@1@@8@@@1@@@@@1@@@17@3@@2;6;30;41@@@@@@@@@@@@1</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@69@@@@@1@@@@@@                              ±±±</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@70@1@1@@@@@1@1;6;35;41@@@0@@ ПРЕКРАТИТЬ </Data>
</Node>
<Node><Sub>3</Sub>
<Data>1@71@1@1@@@@@1@@@@@@0</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@69@@@@@1@@@@@@                             ±±±±±</Data>
</Node>
<Node><Sub>2</Sub>
<Data>2@70@1@1@@@@@1@1;6;36;46@@@@@ ПРОДОЛЖИТЬ ОСТАНОВ (ДЕМОНТИРОВАНИЕ) </Data>
</Node>
<Node><Sub>3</Sub>
<Data>2@71@1@1@@@@@1@@@@@@1</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@69@@@@@1@@@@@@                            ±±± ±±±</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@70@1@1@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>3@71@1@1@@@@@1@@@@@@</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>4@1@1@69@@@@@1@@@@@@                           ±±±   ±±±</Data>
</Node>
<Node><Sub>2</Sub>
<Data>4@70@1@1@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>4@71@1@1@@@@@1@@@@@@</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>5@1@1@69@@@@@1@@@@@@  В Н И М А Н И Е !!!!!!  ±±±     ±±±  В А Ш А  С И С Т Е М А</Data>
</Node>
<Node><Sub>2</Sub>
<Data>5@70@1@1@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>5@71@1@1@@@@@1@@@@@@</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>6@1@1@69@@@@@1@@@@@@                         ±±±       ±±±</Data>
</Node>
<Node><Sub>2</Sub>
<Data>6@70@1@1@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>6@71@1@1@@@@@1@@@@@@</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>7@1@1@69@@@@@1@@@@@@  ±±          ±±        ±±±    ±±   ±±±        ±±          ±±</Data>
</Node>
<Node><Sub>2</Sub>
<Data>7@70@1@1@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>7@71@1@1@@@@@1@@@@@@</Data>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>1</Sub>
<Data>8@1@1@69@@@@@1@@@@@@  ±±±        ±±±       ±±±    ±±     ±±±       ±±±        ±±±</Data>
</Node>
<Node><Sub>2</Sub>
<Data>8@70@1@1@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>8@71@1@1@@@@@1@@@@@@</Data>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>1</Sub>
<Data>9@1@1@69@@@@@1@@@@@@  ±±±±      ±±±±      ±±±    ±±       ±±±      ±±±±      ±±±±</Data>
</Node>
<Node><Sub>2</Sub>
<Data>9@70@1@1@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>9@71@1@1@@@@@1@@@@@@</Data>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>1</Sub>
<Data>10@1@1@69@@@@@1@@@@@@  ±± ±±    ±± ±±     ±±±    ±±±±±±±±   ±±±     ±± ±±    ±± ±±</Data>
</Node>
<Node><Sub>2</Sub>
<Data>10@70@1@1@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>10@71@1@1@@@@@1@@@@@@</Data>
</Node>
</Node>
<Node><Sub>11</Sub>
<Node><Sub>1</Sub>
<Data>11@1@1@69@@@@@1@@@@@@  ±±  ±±  ±±  ±±    ±±±          ±±     ±±±    ±±  ±±  ±±  ±±</Data>
</Node>
<Node><Sub>2</Sub>
<Data>11@70@1@1@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>11@71@1@1@@@@@1@@@@@@</Data>
</Node>
</Node>
<Node><Sub>12</Sub>
<Node><Sub>1</Sub>
<Data>12@1@1@69@@@@@1@@@@@@  ±±   ±±±±   ±±   ±±±          ±±       ±±±   ±±   ±±±±   ±±</Data>
</Node>
<Node><Sub>2</Sub>
<Data>12@70@1@1@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>12@71@1@1@@@@@1@@@@@@</Data>
</Node>
</Node>
<Node><Sub>13</Sub>
<Node><Sub>1</Sub>
<Data>13@1@1@69@@@@@1@@@@@@  ±±    ±±    ±±  ±±±          ±±         ±±±  ±±    ±±    ±±</Data>
</Node>
<Node><Sub>2</Sub>
<Data>13@70@1@1@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>13@71@1@1@@@@@1@@@@@@</Data>
</Node>
</Node>
<Node><Sub>14</Sub>
<Node><Sub>1</Sub>
<Data>14@1@1@69@@@@@1@@@@@@                 ±±±                       ±±±</Data>
</Node>
<Node><Sub>2</Sub>
<Data>14@70@1@1@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>14@71@1@1@@@@@1@@@@@@</Data>
</Node>
</Node>
<Node><Sub>15</Sub>
<Node><Sub>1</Sub>
<Data>15@1@1@69@@@@@1@@@@@@Я В Л Я Е Т С Я ±±±          ±±             ±±±  С Е Р В Е Р О М</Data>
</Node>
<Node><Sub>2</Sub>
<Data>15@70@1@1@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>15@71@1@1@@@@@1@@@@@@</Data>
</Node>
</Node>
<Node><Sub>16</Sub>
<Node><Sub>1</Sub>
<Data>16@1@1@69@@@@@1@@@@@@               ±±±                           ±±±</Data>
</Node>
<Node><Sub>2</Sub>
<Data>16@70@1@1@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>16@71@1@1@@@@@1@@@@@@</Data>
</Node>
</Node>
<Node><Sub>17</Sub>
<Node><Sub>1</Sub>
<Data>17@1@1@69@@@@@1@@@@@@              ±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±</Data>
</Node>
<Node><Sub>2</Sub>
<Data>17@70@1@1@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>17@71@1@1@@@@@1@@@@@@</Data>
</Node>
</Node>
<Node><Sub>BUT</Sub>
<Data>/2;6;30;41</Data>
<Node><Sub>0</Sub>
<Data>2;6;30;41</Data>
<Node><Sub>1</Sub>
<Data>                              ±±±</Data>
</Node>
<Node><Sub>2</Sub>
<Data>                             ±±±±±</Data>
</Node>
<Node><Sub>3</Sub>
<Data>                            ±±± ±±±</Data>
</Node>
<Node><Sub>4</Sub>
<Data>                           ±±±   ±±±</Data>
</Node>
<Node><Sub>5</Sub>
<Data>  В Н И М А Н И Е !!!!!!  ±±±     ±±±  В А Ш А  С И С Т Е М А</Data>
</Node>
<Node><Sub>6</Sub>
<Data>                         ±±±       ±±±</Data>
</Node>
<Node><Sub>7</Sub>
<Data>  ±±          ±±        ±±±    ±±   ±±±        ±±          ±±</Data>
</Node>
<Node><Sub>8</Sub>
<Data>  ±±±        ±±±       ±±±    ±±     ±±±       ±±±        ±±±</Data>
</Node>
<Node><Sub>9</Sub>
<Data>  ±±±±      ±±±±      ±±±    ±±       ±±±      ±±±±      ±±±±</Data>
</Node>
<Node><Sub>10</Sub>
<Data>  ±± ±±    ±± ±±     ±±±    ±±±±±±±±   ±±±     ±± ±±    ±± ±±</Data>
</Node>
<Node><Sub>11</Sub>
<Data>  ±±  ±±  ±±  ±±    ±±±          ±±     ±±±    ±±  ±±  ±±  ±±</Data>
</Node>
<Node><Sub>12</Sub>
<Data>  ±±   ±±±±   ±±   ±±±          ±±       ±±±   ±±   ±±±±   ±±</Data>
</Node>
<Node><Sub>13</Sub>
<Data>  ±±    ±±    ±±  ±±±          ±±         ±±±  ±±    ±±    ±±</Data>
</Node>
<Node><Sub>14</Sub>
<Data>                 ±±±                       ±±±</Data>
</Node>
<Node><Sub>15</Sub>
<Data>Я В Л Я Е Т С Я ±±±          ±±             ±±±  С Е Р В Е Р О М</Data>
</Node>
<Node><Sub>16</Sub>
<Data>               ±±±                           ±±±</Data>
</Node>
<Node><Sub>17</Sub>
<Data>              ±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±</Data>
</Node>
</Node>
<Node><Sub>1</Sub>
<Data>1;6;35;41/1;6;36;46</Data>
<Node><Sub>1</Sub>
<Data> ПРЕКРАТИТЬ </Data>
</Node>
<Node><Sub>2</Sub>
<Data> ПРОДОЛЖИТЬ ОСТАНОВ (ДЕМОНТИРОВАНИЕ) </Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Data>1</Data>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>0</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>0</Data>
</Node>
<Node><Sub>2</Sub>
<Data>0</Data>
</Node>
</Node>
</Node>
<Node><Sub>COL</Sub>
<Node><Sub>1</Sub>
<Node><Sub>2</Sub>
<Data>I 1</Data>
<Node><Sub>1</Sub>
<Data>1</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>STA</Sub>
<Data>,@1@1@13@-1@-1@15@71@</Data>
</Node>
</Node>
<Node><Sub>OPout</Sub>
<Data><![CDATA[Опции вывода@@@@@1@1@2@15@21@64@1@@1@@@1@@2,2@1@@@@@1@@@17@2@@1;6;37;44@@@@@@@1@^%ZAPM.ed.BSS("POutH")@@@@1]]></Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@2@40@@@@@1@1;6;31;44@@@@@               Опции вывода таблицы</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@41@2@10@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data><![CDATA[3@1@2@40@@@@@1@@@@@@ По-умолчанию Имя DOS-файла, имя текста,или Для ПРИНТЕРА -количество экземпляров@]]></Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@41@2@10@@@@4,2@1@@@@@@1@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>5@1@1@40@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>5@41@1@10@1@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>6@1@1@40@@@@@1@2;6;37;44@@@@@ Количество символов в строке (0 - 511)@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>6@41@1@10@@@@0@1@@@@@@0@0@@@</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>7@1@1@40@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>7@41@1@10@1@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data><![CDATA[8@1@2@40@@@@@1@2;6;37;44@@@@@ Количество строк на странице (0 - max,       символ - разделитель страниц)@]]></Data>
</Node>
<Node><Sub>2</Sub>
<Data>8@41@2@10@@@@4,2@1@@@@@@0@0</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>10@1@1@40@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>10@41@1@10@1@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>1</Sub>
<Data>11@1@1@40@@@@@1@2;6;37;44@@@@@ Отступ от левого края (для принтера)@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>11@41@1@10@@@@4,2@1@@@@@@0@0</Data>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>1</Sub>
<Data>12@1@1@40@@@@@1@1;6;35;44@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>12@41@1@10@1@@@@1@@@@@^%ZAPM.ed.BSS(&quot;OPout4&quot;)@@</Data>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>1</Sub>
<Data>13@1@1@40@@@@@1@1;6;35;44@@@@@Дублировать титул (Y,X-титул для вывода)@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>13@41@1@10@@@@0@1@@@@@^%ZAPM.ed.BSS(&quot;OPout4&quot;)@1@0</Data>
</Node>
</Node>
<Node><Sub>11</Sub>
<Node><Sub>1</Sub>
<Data>14@1@1@40@@@@@1@1;6;35;44@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>14@41@1@10@1@@@@1@@@@@^%ZAPM.ed.BSS(&quot;OPout4&quot;)@@</Data>
</Node>
</Node>
<Node><Sub>12</Sub>
<Node><Sub>1</Sub>
<Data>15@1@1@40@@@@@1@@@@@@ Режим печати страниц (для принтера)@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>15@41@1@10@@@@4,2@1@@@@@^%ZAPM.ed.BSS(&quot;OPout3&quot;)@1@0</Data>
</Node>
</Node>
<Node><Sub>13</Sub>
<Node><Sub>1</Sub>
<Data>16@1@1@40@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>16@41@1@10@1@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>14</Sub>
<Node><Sub>1</Sub>
<Data>17@1@1@40@@@@@1@1;6;32;44@@@@@ Использовать карту вывода@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>17@41@1@10@@@@10,2@1@@@@@^%ZAPM.ed.BSS(&quot;OPout4&quot;)@1@0</Data>
</Node>
</Node>
<Node><Sub>15</Sub>
<Node><Sub>1</Sub>
<Data>18@1@1@40@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>18@41@1@10@1@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>16</Sub>
<Node><Sub>1</Sub>
<Data>19@1@1@40@@@@@1@1;6;31;44@@@@@ Сохранить настройки@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>19@41@1@10@@@@0@1@1;6;32;44@@@@^%ZAPM.ed.BSS(&quot;OPout2&quot;)@2@0</Data>
</Node>
</Node>
<Node><Sub>17</Sub>
<Node><Sub>1</Sub>
<Data>20@1@1@40@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>20@41@1@10@1@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>FTR</Sub>
<Node><Sub>4</Sub>
<Node><Sub>2</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>2</Sub>
<Data>S d1=$S($$A^%ZAPM.ed.BSA(ny,nx)=0:&quot;    Нет&quot;,1:&quot;    Да&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$S({ny,nx}=0:&quot;    Нет&quot;,1:&quot;    Да&quot;)</Data>
</Node>
</Node>
</Node>
<Node><Sub>16</Sub>
<Node><Sub>2</Sub>
<Data>S d1=$S($$A^%ZAPM.ed.BSA(ny,nx)=0:&quot;    Нет&quot;,$$A^%ZAPM.ed.BSA(ny,nx)=1:&quot; На сеанс&quot;,1:&quot;    Да&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$S({ny,nx}=0:&quot;    Нет&quot;,{ny,nx}=1:&quot; На сеанс&quot;,1:&quot;    Да&quot;)</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>57908,59272,MS</Data>
</Node>
<Node><Sub>RTR</Sub>
<Node><Sub>4</Sub>
<Node><Sub>2</Sub>
<Data>S d1=$$IF^%ZAPM.ed.BSsFUNR(&quot;d0&apos;&lt;0&amp;(d0&apos;&gt;511)&quot;,&quot;READ&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$$IF(&quot;d0&apos;&lt;0&amp;(d0&apos;&gt;511)&quot;,&quot;READ&quot;)</Data>
</Node>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>2</Sub>
<Data>S d1=$$IF^%ZAPM.ed.BSsFUNR(&quot;d0=+d0!($L(d0)=1)&quot;,&quot;READ&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$$IF(&quot;d0=+d0!($L(d0)=1)&quot;,&quot;READ&quot;)</Data>
</Node>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>2</Sub>
<Data>S d1=$$IF^%ZAPM.ed.BSsFUNR(&quot;d0&apos;&lt;0&amp;(d0&apos;&gt;120)&quot;,&quot;READ&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$$IF(&quot;d0&apos;&lt;0&amp;(d0&apos;&gt;120)&quot;,&quot;READ&quot;)</Data>
</Node>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>2</Sub>
<Data>S d1=$$IF^%ZAPM.ed.BSsFUNR(&quot;d0=0!(d0=1)!(d0?.N1&quot;&quot;,&quot;&quot;.N)&quot;,&quot;READ&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$$IF(&quot;d0=0!(d0=1)!(d0?.N1&quot;&quot;,&quot;&quot;.N)&quot;,&quot;READ&quot;)</Data>
</Node>
</Node>
</Node>
<Node><Sub>12</Sub>
<Node><Sub>2</Sub>
<Data>S d1=$$IF^%ZAPM.ed.BSsFUNR(&quot;d0=1!(d0=2)!(d0=3)&quot;,&quot;READ&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$$IF(&quot;d0=1!(d0=2)!(d0=3)&quot;,&quot;READ&quot;)</Data>
</Node>
</Node>
</Node>
<Node><Sub>14</Sub>
<Node><Sub>2</Sub>
<Data>S d1=$$IF^%ZAPM.ed.BSsFUNR(&quot;d0=0!(d0=1)&quot;,&quot;READ&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$$IF(&quot;d0=0!(d0=1)&quot;,&quot;READ&quot;)</Data>
</Node>
</Node>
</Node>
<Node><Sub>16</Sub>
<Node><Sub>2</Sub>
<Data>S d1=$$IF^%ZAPM.ed.BSsFUNR(&quot;d0=0!(d0=1)!(d0=2)&quot;,&quot;READ&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$$IF(&quot;d0=0!(d0=1)!(d0=2)&quot;,&quot;READ&quot;)</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>STA</Sub>
<Data>4,2@2@2@27@-1@-1@7@55@0</Data>
</Node>
</Node>
<Node><Sub>OPout0</Sub>
<Data>Параметры принтера@@@@@1@1@5@25@18@54@@@@@@1@@2,2@@@@@@@@@13@2@@2;6;37;44@@@@@@@1@@@3^%ZAPM.ed.BSout</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@2@27@@@@@1@2;6;34;46@@@@@      ПАРАМЕТРЫ  ПРИНТЕРА          Выбор - &lt;ENTER&gt;</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@28@2@3@@@@@1@2;6;34;46@@@@@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@27@@@@0@1@1;6;32;44@@@@@3,2@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@28@1@3@@@@@1@1;6;32;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>4@1@1@27@@@@0@1@1;6;32;44@@@@@4,2@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>4@28@1@3@@@@@1@1;6;32;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>5@1@1@27@@@@0@1@1;6;32;44@@@@@5,2@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>5@28@1@3@@@@@1@1;6;32;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>6@1@1@27@@@@0@1@1;6;32;44@@@@@6,2@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>6@28@1@3@@@@@1@1;6;32;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>7@1@1@27@@@@0@1@1;6;37;44@@@@@7,2</Data>
</Node>
<Node><Sub>2</Sub>
<Data>7@28@1@3@@@@@1@1;6;32;44@@@@@</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>8@1@1@27@@@@0@1@1;6;37;44@@@@@8,2</Data>
</Node>
<Node><Sub>2</Sub>
<Data>8@28@1@3@@@@@1@1;6;32;44@@@@@</Data>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>1</Sub>
<Data>9@1@1@27@@@@0@1@1;6;37;44@@@@@9,2@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>9@28@1@3@@@@@1@1;6;32;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>1</Sub>
<Data>10@1@1@27@@@@0@1@1;6;37;44@@@@@10,2@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>10@28@1@3@@@@@1@1;6;32;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>1</Sub>
<Data>11@1@1@27@@@@0@1@1;6;37;44@@@@@11,2@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>11@28@1@3@@@@@1@1;6;32;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>11</Sub>
<Node><Sub>1</Sub>
<Data>12@1@1@27@@@@0@1@1;6;37;44@@@@@12,2@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>12@28@1@3@@@@@1@1;6;32;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>12</Sub>
<Node><Sub>1</Sub>
<Data>13@1@1@27@@@@0@1@1;6;32;44@@@@@13,2@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>13@28@1@3@@@@@1@1;6;32;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>13</Sub>
<Node><Sub>1</Sub>
<Data>14@1@1@27@@@@0@1@1;6;32;44@@@@@14,2@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>14@28@1@3@@@@@1@1;6;32;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>FTR</Sub>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>S d1=&quot;  80 СИМВОЛОВ В СТРОКЕ ..&quot;</Data>
<Node><Sub>1</Sub>
<Data>&quot;  80 СИМВОЛОВ В СТРОКЕ ..&quot;</Data>
</Node>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>S d1=&quot;  90 ....................&quot;</Data>
<Node><Sub>1</Sub>
<Data>&quot;  90 ....................&quot;</Data>
</Node>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>S d1=&quot;  132 ...................&quot;</Data>
<Node><Sub>1</Sub>
<Data>&quot;  132 ...................&quot;</Data>
</Node>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>S d1=&quot;  160 ...................&quot;</Data>
<Node><Sub>1</Sub>
<Data>&quot;  160 ...................&quot;</Data>
</Node>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>S d1=&quot;  70 СТРОК НА СТРАНИЦЕ ..&quot;</Data>
<Node><Sub>1</Sub>
<Data>&quot;  70 СТРОК НА СТРАНИЦЕ ..&quot;</Data>
</Node>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>S d1=&quot;  30 ....................&quot;</Data>
<Node><Sub>1</Sub>
<Data>&quot;  30 ....................&quot;</Data>
</Node>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>1</Sub>
<Data>S d1=&quot;  60 ....................&quot;</Data>
<Node><Sub>1</Sub>
<Data>&quot;  60 ....................&quot;</Data>
</Node>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>1</Sub>
<Data>S d1=&quot;  100 ...................&quot;</Data>
<Node><Sub>1</Sub>
<Data>&quot;  100 ...................&quot;</Data>
</Node>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>1</Sub>
<Data>S d1=&quot;  130 ...................&quot;</Data>
<Node><Sub>1</Sub>
<Data>&quot;  130 ...................&quot;</Data>
</Node>
</Node>
</Node>
<Node><Sub>11</Sub>
<Node><Sub>1</Sub>
<Data>S d1=&quot;  250 ...................&quot;</Data>
<Node><Sub>1</Sub>
<Data>&quot;  250 ...................&quot;</Data>
</Node>
</Node>
</Node>
<Node><Sub>12</Sub>
<Node><Sub>1</Sub>
<Data>S d1=&quot;  ДВОЙНОЕ КАЧЕСТВО ПЕЧАТИ&quot;</Data>
<Node><Sub>1</Sub>
<Data>&quot;  ДВОЙНОЕ КАЧЕСТВО ПЕЧАТИ&quot;</Data>
</Node>
</Node>
</Node>
<Node><Sub>13</Sub>
<Node><Sub>1</Sub>
<Data>S d1=&quot;  ОБЫЧНОЕ КАЧЕСТВО&quot;</Data>
<Node><Sub>1</Sub>
<Data>&quot;  ОБЫЧНОЕ КАЧЕСТВО&quot;</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>STA</Sub>
<Data>10,2@2@2@27@-1@-1@15@52@</Data>
</Node>
</Node>
<Node><Sub>OPout1</Sub>
<Data>Стандартные настройки опций@@1@@@1@1@1@1@22@80@1@@1@1@@1@@@1@@@@@1@@@5@2@@1;6;37;44@@@@@@</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@40@@@@@1@1;6;31;44@@@@@ Строка настроек</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@41@1@10@@@@@1@1;6;31;44@@@@@Устройство@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@40@@@@@1@@@@@@1#0#0#0#1#1#1@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>2@41@1@10@@@@@1@@@@@@ PRN@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@40@@@@@1@@@@@@#0#0##1##0@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@41@1@10@@@@@1@@@@@@ ASCII@</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>4@1@1@40@@@@@1@@@@@@#0#0##1##0@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>4@41@1@10@@@@@1@@@@@@ TXT@</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>5@1@1@40@@@@@1@@@@@@#65#0##1##0@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>5@41@1@10@@@@@1@@@@@@ COM@</Data>
</Node>
</Node>
<Node><Sub>STA</Sub>
<Data>1,1@1@1@13@-1@-1@1@1@ Строка настроек</Data>
</Node>
</Node>
<Node><Sub>OPout2</Sub>
<Data>@@1@@@1@1@1@1@22@80@1@@1@1@@8@@@1@@@@@@@@3@3@@2;6;37;44@@@@@@@@^%ZAPM.ed.BSHLP(&quot;HELP-ALTF2&quot;)</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@10@@@@@1@@@@@@            Выберите, пожалуйста  @@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@11@1@10@@@@@1@2;6;30;45@@@@@ Сохранить @</Data>
</Node>
<Node><Sub>3</Sub>
<Data>1@21@1@10@@@@@1@@@@@@2@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@10@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>2@11@1@10@@@@@1@2;6;30;47@@@@@ Не сохранять @</Data>
</Node>
<Node><Sub>3</Sub>
<Data>2@21@1@10@@@@@1@@@@@@1@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@11@1@10@@@@@1@2;6;30;47@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>3@21@1@10@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>BUT</Sub>
<Data>/2;6;37;44</Data>
<Node><Sub>0</Sub>
<Data>2;6;37;44</Data>
<Node><Sub>1</Sub>
<Data>            Выберите, пожалуйста  </Data>
</Node>
</Node>
<Node><Sub>1</Sub>
<Data>2;6;30;45/2;6;30;47</Data>
<Node><Sub>1</Sub>
<Data> Сохранить </Data>
</Node>
<Node><Sub>2</Sub>
<Data> Не сохранять </Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>2</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>0</Data>
</Node>
<Node><Sub>2</Sub>
<Data>0</Data>
</Node>
</Node>
</Node>
<Node><Sub>STA</Sub>
<Data>2,1@1@1@13@-1@-1@2@1@</Data>
</Node>
</Node>
<Node><Sub>OPout3</Sub>
<Data>@@1@@@1@1@1@1@22@80@1@@1@1@@8@@@1@@@@@@@@3@3@@2;6;37;44@@@@@@@@^%ZAPM.ed.BSHLP(&quot;HELP-ALTF2&quot;)</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@2@10@@@@@1@@@@@@                   Выберите, пожалуйста, режим печати@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@11@2@10@@@@@1@1;6;37;44@@@@@Потоком без перевода формата@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>1@21@2@10@@@@@1@@@@@@1@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>3@1@2@10@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@11@2@10@@@@@1@2;6;34;46@@@@@Потоком с переводом формата@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>3@21@2@10@@@@@1@@@@@@2@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>5@1@2@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>5@11@2@10@@@@@1@2;6;34;46@@@@@Постранично@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>5@21@2@10@@@@@1@@@@@@3@</Data>
</Node>
</Node>
<Node><Sub>BUT</Sub>
<Data>/2;6;37;44</Data>
<Node><Sub>0</Sub>
<Data>2;6;37;44</Data>
<Node><Sub>1</Sub>
<Data>                   Выберите, пожалуйста, режим печати</Data>
</Node>
</Node>
<Node><Sub>1</Sub>
<Data>1;6;37;44/2;6;34;46</Data>
<Node><Sub>1</Sub>
<Data>Потоком без перевода формата</Data>
</Node>
<Node><Sub>2</Sub>
<Data>Потоком с переводом формата</Data>
</Node>
<Node><Sub>3</Sub>
<Data>Постранично</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>1</Data>
</Node>
<Node><Sub>2</Sub>
<Data>2</Data>
</Node>
<Node><Sub>3</Sub>
<Data>3</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>0</Data>
</Node>
<Node><Sub>2</Sub>
<Data>0</Data>
</Node>
</Node>
</Node>
<Node><Sub>STA</Sub>
<Data>3,1@1@1@-2@-2@-2@5@1@</Data>
</Node>
</Node>
<Node><Sub>OPout4</Sub>
<Data>@@@@@1@1@1@1@22@80@1@@1@1@@8@@@1@@@@@@@@2@3@@2;6;37;44@@@@@@@@^%ZAPM.ed.BSHLP(&quot;HELP-ALTF2&quot;)</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@10@@@@@1@@@@@@   Выберите пожалуйста  @@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@11@1@10@@@@@1@1;6;32;44@@@@@  ДА  @</Data>
</Node>
<Node><Sub>3</Sub>
<Data>1@21@1@10@@@@@1@@@@@@1@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@10@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>2@11@1@10@@@@@1@2;6;30;45@@@@@  НЕТ  @</Data>
</Node>
<Node><Sub>3</Sub>
<Data>2@21@1@10@@@@@1@@@@@@0@</Data>
</Node>
</Node>
<Node><Sub>BUT</Sub>
<Data>/2;6;37;44</Data>
<Node><Sub>0</Sub>
<Data>2;6;37;44</Data>
<Node><Sub>1</Sub>
<Data>   Выберите пожалуйста  </Data>
</Node>
</Node>
<Node><Sub>1</Sub>
<Data>1;6;32;44/2;6;30;45</Data>
<Node><Sub>1</Sub>
<Data>  ДА  </Data>
</Node>
<Node><Sub>2</Sub>
<Data>  НЕТ  </Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>1</Data>
</Node>
<Node><Sub>2</Sub>
<Data>0</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>0</Data>
</Node>
<Node><Sub>2</Sub>
<Data>0</Data>
</Node>
</Node>
</Node>
<Node><Sub>STA</Sub>
<Data>2,2@1@1@13@-1@-1@2@11@  НЕТ  </Data>
</Node>
</Node>
<Node><Sub>OPout5</Sub>
<Data>Пакетный вывод готовых форм@@@@@1@1@3@6@19@73@1@@1@@@1@@2,4@1@@@@@1@@@11@5@@1;6;37;44@@@@@@@1@@@@@1</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@1@1@@@@1@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@2@1@35@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>1@37@1@1@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>1@38@1@30@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>1@68@1@1@1@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@3@1@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data><![CDATA[2@2@3@35@1@@@@1@2;6;30;46@@@@@Список полных (таблица,раздел,КИП, том) имен таблиц через"~".Например: SP1,%BSbufS~SV1,KOD,SYS,TAB@]]></Data>
</Node>
<Node><Sub>3</Sub>
<Data>2@37@3@1@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>2@38@3@30@@@@@1@2;6;30;46@@@@^%ZAPM.ed.BSZ(&quot;Sz5&quot;)@QQQ@@@@@@4,60</Data>
</Node>
<Node><Sub>5</Sub>
<Data>2@68@3@1@1@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>5@1@1@1@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>5@2@1@35@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>5@37@1@1@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>5@38@1@30@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>5@68@1@1@1@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>6@1@1@1@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>6@2@1@35@1@@@@1@2;6;30;46@@@@@ Сохранять ли псевдографику ?@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>6@37@1@1@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>6@38@1@30@@@@0@1@2;6;30;46@@@@^%ZAPM.ed.BSZ(&quot;YES&quot;)@Y@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>6@68@1@1@1@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>7@1@1@1@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>7@2@1@35@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>7@37@1@1@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>7@38@1@30@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>7@68@1@1@1@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>8@1@4@1@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data><![CDATA[8@2@4@35@1@@@@1@2;6;30;46@@@@@  Устройство вывода пакета:         1 - на принтер                     2 - ASCII-файл                     3 - в таблицу-текст@]]></Data>
</Node>
<Node><Sub>3</Sub>
<Data>8@37@4@1@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>8@38@4@30@@@@0@1@2;6;30;46@@@@@1@0</Data>
</Node>
<Node><Sub>5</Sub>
<Data>8@68@4@1@1@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>12@1@1@1@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>12@2@1@35@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>12@37@1@1@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>12@38@1@30@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>12@68@1@1@1@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>1</Sub>
<Data>13@1@2@1@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>13@2@2@35@1@@@@1@2;6;30;46@@@@@ Условие для вывода пакета в        ASCII-файл@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>13@37@2@1@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>13@38@2@30@@@@0@1@2;6;30;46@@@@^%ZAPM.ed.BSS(&quot;OPout6&quot;)@@0</Data>
</Node>
<Node><Sub>5</Sub>
<Data>13@68@2@1@1@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>1</Sub>
<Data>15@1@1@1@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>15@2@1@35@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>15@37@1@1@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>15@38@1@30@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>15@68@1@1@1@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>1</Sub>
<Data>16@1@1@1@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>16@2@1@35@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>16@37@1@1@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>16@38@1@30@@@@0@1@2;6;34;46@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>16@68@1@1@1@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>11</Sub>
<Node><Sub>1</Sub>
<Data>17@1@1@1@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>17@2@1@35@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>17@37@1@1@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>17@38@1@30@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>17@68@1@1@1@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>FTR</Sub>
<Node><Sub>4</Sub>
<Node><Sub>4</Sub>
<Data>S d1=$S(d0=&quot;Y&quot;:&quot;Сохранять&quot;,1:&quot;&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$S(d0=&quot;Y&quot;:&quot;Сохранять&quot;,1:&quot;&quot;)</Data>
</Node>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>4</Sub>
<Data>S d1=$S(d0=1:&quot;принтер&quot;,d0=2:&quot;файл&quot;,d0=3:&quot;таблица - текст&quot;,1:&quot;&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$S(d0=1:&quot;принтер&quot;,d0=2:&quot;файл&quot;,d0=3:&quot;таблица - текст&quot;,1:&quot;&quot;)</Data>
</Node>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>4</Sub>
<Data><![CDATA[S d1=$S(d0=1:"Перезапись файла для каждой   таблицы",d0=2:"Перезапись файла для первой   таблицы и добавление следующих",1:"С запросом на изменение файла для каждой таблицы")]]></Data>
<Node><Sub>1</Sub>
<Data><![CDATA[$S(d0=1:"Перезапись файла для каждой   таблицы",d0=2:"Перезапись файла для первой   таблицы и добавление следующих",1:"С запросом на изменение файла для каждой таблицы")]]></Data>
</Node>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>4</Sub>
<Data>S d1=&quot;         &lt; E N T E R &gt;&quot;</Data>
<Node><Sub>1</Sub>
<Data>&quot;         &lt; E N T E R &gt;&quot;</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>57569,36601,TAF</Data>
</Node>
<Node><Sub>RTR</Sub>
<Node><Sub>6</Sub>
<Node><Sub>4</Sub>
<Data>S d1=$$IF^%ZAPM.ed.BSsFUNR(&quot;d0=1!(d0=2)!(d0=3)&quot;,&quot;READ&quot;,&quot;&quot;,&quot;Только 1 или 2 или 3 !!&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$$IF(&quot;d0=1!(d0=2)!(d0=3)&quot;,&quot;READ&quot;,&quot;&quot;,&quot;Только 1 или 2 или 3 !!&quot;)</Data>
</Node>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>4</Sub>
<Data>S d1=$$IF^%ZAPM.ed.BSsFUNR(&quot;d0=1!(d0=2)&quot;,&quot;READ&quot;,&quot;&quot;,&quot;Только 1 или 2 !!&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$$IF(&quot;d0=1!(d0=2)&quot;,&quot;READ&quot;,&quot;&quot;,&quot;Только 1 или 2 !!&quot;)</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>STA</Sub>
<Data>10,4@2@4@27@-1@-1@18@43@</Data>
</Node>
</Node>
<Node><Sub>OPout6</Sub>
<Data>Условия вывода в файл@@1@@@1@1@8@11@9@71@1@@1@@1@1@@1,2@1@@@@@1@@@2@2@@1;6;37;45@@@@@@@1</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@60@@@@@1@@@@@@ Перезапись файла для каждой таблицы</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@61@1@1@@@@@1@1;6;37;42@@@@@1@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@60@@@@@1@@@@@@ Перезапись файла для первой таблицы и добавление следующих@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>2@61@1@1@@@@@1@1;6;37;42@@@@@2@</Data>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>57568,35277,TAF</Data>
</Node>
<Node><Sub>STA</Sub>
<Data>1,2@1@2@27@-1@-1@8@71@1</Data>
</Node>
</Node>
<Node><Sub>OWNER</Sub>
<Data>Хозяин@@@@@1@@5@10@13@49@@@@1@@5@@@1@@@ 1@@@@@7@@@1;6;37;44//2;6;33;40@@@@@@@1</Data>
<Node><Sub>1</Sub>
<Data>%BS </Data>
</Node>
<Node><Sub>2</Sub>
<Data>(C) 1992-2007 Sergey W. Mikhaylenko</Data>
</Node>
<Node><Sub>3</Sub>
<Data>Information BS-Portal</Data>
</Node>
<Node><Sub>4</Sub>
<Data>All rights reserved</Data>
</Node>
<Node><Sub>5</Sub>
<Data>---------------------</Data>
</Node>
<Node><Sub>6</Sub>
<Data></Data>
</Node>
<Node><Sub>7</Sub>
<Data></Data>
</Node>
</Node>
<Node><Sub>PATH</Sub>
<Data><![CDATA[Путь к поддиректориям@@@@@1@1@2@15@21@67@1@@1@@@1@@2,4@1@@@@@1@@@14@5@@1;6;37;44@@@@@@@2@^%ZAPM.ed.BSHLP("SETUPDOS")@@@@1]]></Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@1@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@2@1@25@@@@@1@2;6;37;44@@@@@         Пути к файлам и @</Data>
</Node>
<Node><Sub>3</Sub>
<Data>1@27@1@1@@@@@1@2;6;37;44@@@@@п@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>1@28@1@25@@@@@1@2;6;37;44@@@@@оддиректориям@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>1@53@1@1@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@2@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>2@2@2@25@@@@@1@@@@@@Путь к поддиректории но- вых версий комплекса.@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>2@27@2@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>2@28@2@25@@@@@1@2;6;34;46@@@@@\bsver\@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>2@53@2@1@1@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>4@1@1@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>4@2@1@25@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>4@27@1@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>4@28@1@25@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>4@53@1@1@1@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>5@1@2@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>5@2@2@25@@@@@1@@@@@@Имя файла и путь к протоколу тестирования@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>5@27@2@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>5@28@2@25@@@@@1@2;6;34;46@@@@@\system\TESTED.RPT@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>5@53@2@1@1@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>7@1@1@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>7@2@1@25@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>7@27@1@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>7@28@1@25@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>7@53@1@1@1@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>8@1@2@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>8@2@2@25@@@@@1@@@@@@Имя файла и путь к протоколу регистрации@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>8@27@2@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>8@28@2@25@@@@@1@2;6;34;46@@@@@^[&quot;GLAVK&quot;]BSprotkl@@@@@^%ZAPM.ed.BSHLP(&quot;SETUPPRO&quot;)</Data>
</Node>
<Node><Sub>5</Sub>
<Data>8@53@2@1@1@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>10@1@1@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>10@2@1@25@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>10@27@1@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>10@28@1@25@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>10@53@1@1@1@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>1</Sub>
<Data>11@1@2@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>11@2@2@25@@@@@1@@@@@@Путь к поддиректории файлов руководства %BS.@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>11@27@2@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>11@28@2@25@@@@@1@2;6;34;46@@@@@\bsdoc\@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>11@53@2@1@1@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>1</Sub>
<Data>13@1@1@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>13@2@1@25@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>13@27@1@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>13@28@1@25@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>13@53@1@1@1@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>1</Sub>
<Data>14@1@2@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>14@2@2@25@@@@@1@@@@@@Директория запасного ко- пирования масс.и программ@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>14@27@2@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>14@28@2@25@@@@@1@2;6;34;46@@@@@\!\@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>14@53@2@1@1@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>11</Sub>
<Node><Sub>1</Sub>
<Data>16@1@1@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>16@2@1@25@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>16@27@1@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>16@28@1@25@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>16@53@1@1@1@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>12</Sub>
<Node><Sub>1</Sub>
<Data>17@1@2@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>17@2@2@25@@@@@1@@@@@@Диск и базовая поддиректория установки комплекса@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>17@27@2@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>17@28@2@25@@@@@1@2;6;34;46@@@@@D:\MSM414@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>17@53@2@1@1@@@@1@@@@@@</Data>
</Node>
</Node>
<Node><Sub>13</Sub>
<Node><Sub>1</Sub>
<Data>19@1@1@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>19@2@1@25@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>19@27@1@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>19@28@1@25@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>19@53@1@1@1@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>14</Sub>
<Node><Sub>1</Sub>
<Data>20@1@1@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>20@2@1@25@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>20@27@1@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>20@28@1@25@@@@@1@2;6;34;46@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>20@53@1@1@1@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>57871,60855,MS</Data>
</Node>
<Node><Sub>OPT</Sub>
<Data>2,4,2</Data>
</Node>
<Node><Sub>STA</Sub>
<Data>10,4@2@4@27@-1@-1@15@42@\!\</Data>
</Node>
</Node>
<Node><Sub>POutH</Sub>
<Data>Описание Опций вывода таблицы@@@@@@@1@1@22@80@@@@1@@5@@@1@@@ 1@@@@@26@@@1;6;37;44//1;6;36;40@@@@@@@1</Data>
<Node><Sub>1</Sub>
<Data>                                            / Если выводим в ДОС, то имя ДОС-файла</Data>
</Node>
<Node><Sub>2</Sub>
<Data><![CDATA[ По-умолчанию Имя DOS-файла, имя текста,    / Если выводим в ТЕСТ, то имя Текста в формате  TABL,PART,KIP,TOM]]></Data>
</Node>
<Node><Sub>3</Sub>
<Data><![CDATA[или Для ПРИНТЕРА -количество экземпляров    - Если печатаем, то можно поставить количество экземпляров - сколько надо распечатать]]></Data>
</Node>
<Node><Sub>4</Sub>
<Data>                                                  </Data>
</Node>
<Node><Sub>5</Sub>
<Data><![CDATA[ Количество символов в строке (0 - 511)     - Если выставим 0 , то выводим всю таблицу в один экран, какая длинная она бы не была]]></Data>
</Node>
<Node><Sub>6</Sub>
<Data><![CDATA[                                            \ Если выставим 100 , то выводим таблицу "нарезанную" по экранам, не шире 100 символов]]></Data>
</Node>
<Node><Sub>7</Sub>
<Data><![CDATA[                                            \ Если выставим 80,100,120 , то выводим таблицу "нарезанную" по экранам, где 1 экран не шире 80 символов, 2 - 100, 3 - 120 соответственно]]></Data>
</Node>
<Node><Sub>8</Sub>
<Data>                                                  </Data>
</Node>
<Node><Sub>9</Sub>
<Data><![CDATA[ Количество строк на странице (0 - max,     - Если выставим 0 , то выводим всю таблицу без формирования страниц]]></Data>
</Node>
<Node><Sub>10</Sub>
<Data><![CDATA[      символ - разделитель страниц)         - Можно поставить "символ - разделитель" , всретив который программа автоматически переведет страницу]]></Data>
</Node>
<Node><Sub>11</Sub>
<Data>                                                  </Data>
</Node>
<Node><Sub>12</Sub>
<Data> Отступ от левого края (для принтера)       Сколько символов отступить     </Data>
</Node>
<Node><Sub>13</Sub>
<Data>                                                  </Data>
</Node>
<Node><Sub>14</Sub>
<Data><![CDATA[Дублировать титул (Y,X-титул для вывода)    - Если выставим 1 , то экраны будут формироваться с титулами (шапки и боковины будут дублировася на каждый экран)]]></Data>
</Node>
<Node><Sub>15</Sub>
<Data><![CDATA[                                            \ Если выставим 1 , но в таблице титул не установлен, то титул и не будет использоват ... ну нет его, что поделаешь ?]]></Data>
</Node>
<Node><Sub>16</Sub>
<Data><![CDATA[                                            \ Для тех случаев, когда титула нет, или его нельзя выставить (высокая шапка)]]></Data>
</Node>
<Node><Sub>17</Sub>
<Data><![CDATA[                                              можно поставить Y,X который будет играть роль титула для печати,]]></Data>
</Node>
<Node><Sub>18</Sub>
<Data>                                              ,где (Y-1) номера строк титула шапки</Data>
</Node>
<Node><Sub>19</Sub>
<Data>                                                   (X-1) номера колонок титула боковины</Data>
</Node>
<Node><Sub>20</Sub>
<Data> Режим печати страниц (для принтера)        1 - печатаем потоком, без перевода формата</Data>
</Node>
<Node><Sub>21</Sub>
<Data>                                            2 - переводим формат, после каждого экземпляра</Data>
</Node>
<Node><Sub>22</Sub>
<Data>                                            3 - переводим формат, после каждой страницы</Data>
</Node>
<Node><Sub>23</Sub>
<Data>                                                  </Data>
</Node>
<Node><Sub>24</Sub>
<Data><![CDATA[ Использовать карту вывода                  1 - появляется возможность контролировать вывод каждого экрана]]></Data>
</Node>
<Node><Sub>25</Sub>
<Data>                                                покромсанной таблицы</Data>
</Node>
<Node><Sub>26</Sub>
<Data> Сохранить настройки                        1 - сохраняем параметры вывода таблицы</Data>
</Node>
</Node>
<Node><Sub>REPAIR</Sub>
<Data>@@1@@@1@1@1@1@22@80@1@@1@1@@8@@@1@@@@@@@@3@3@@2;6;30;41@@@@@@@@^%ZAPM.ed.BSHLP(&quot;HELP-ALTF2&quot;)</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@10@@@@@1@@@@@@            ВНИМАНИЕ !!!@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@11@1@10@@@@@1@1;6;30;43@@@@@ РЕМОНТ @</Data>
</Node>
<Node><Sub>3</Sub>
<Data>1@21@1@10@@@@@1@@@@@@1@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@10@@@@@1@@@@@@  ЭТО ОЧЕНЬ СУРОВЫЙ ПРОЦЕСС. КРЕПКО ПОДУМАЙТЕ  </Data>
</Node>
<Node><Sub>2</Sub>
<Data>2@11@1@10@@@@@1@1;6;36;43@@@0@@ ОТКАЗАТЬСЯ @</Data>
</Node>
<Node><Sub>3</Sub>
<Data>2@21@1@10@@@@@1@@@@@@2@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@10@@@@@1@@@@@@  ПРЕЖДЕ ЧЕМ ЗАПУСТИТЬ РЕМОНТ.@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@11@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>3@21@1@10@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>BUT</Sub>
<Data>/2;6;30;41</Data>
<Node><Sub>0</Sub>
<Data>2;6;30;41</Data>
<Node><Sub>1</Sub>
<Data>            ВНИМАНИЕ !!!</Data>
</Node>
<Node><Sub>2</Sub>
<Data>  ЭТО ОЧЕНЬ СУРОВЫЙ ПРОЦЕСС. КРЕПКО ПОДУМАЙТЕ  </Data>
</Node>
<Node><Sub>3</Sub>
<Data>  ПРЕЖДЕ ЧЕМ ЗАПУСТИТЬ РЕМОНТ.</Data>
</Node>
</Node>
<Node><Sub>1</Sub>
<Data>1;6;30;43/1;6;36;43</Data>
<Node><Sub>1</Sub>
<Data> РЕМОНТ </Data>
</Node>
<Node><Sub>2</Sub>
<Data> ОТКАЗАТЬСЯ </Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Data>2</Data>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>1</Data>
</Node>
<Node><Sub>2</Sub>
<Data>2</Data>
</Node>
</Node>
</Node>
<Node><Sub>COL</Sub>
<Node><Sub>2</Sub>
<Node><Sub>2</Sub>
<Data>I 1</Data>
<Node><Sub>1</Sub>
<Data>1</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>STA</Sub>
<Data>,@1@1@13@-1@-1@1@1@            ВНИМАНИЕ !!!</Data>
</Node>
</Node>
<Node><Sub>SERV-UTL</Sub>
<Data>MENU&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;КЛИЕТ-СЕРВЕР@@@@@1@1@3@17@16@56@1@@1@@1@1@@3,1@1@@@@@@@@14@1@@2;6;30;47@@@@@@@2</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@40@@@@0@1@@@@@@MSM-SERVER-UTILITY</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@40@@@@0@1@@@@@@=============================================</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@40@@@@0@1@@@@@3,1@Активные DDP цепи@</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>4@1@1@40@@@@0@1@@@@@4,1@Состояние системы@</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>5@1@1@40@@@@0@1@@@@@5,1@Свободное место на томах баз данных@</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>6@1@1@40@@@@0@1@1;6;31;47@@@@6,1@Послать сообщение %BS-пользователям@</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>7@1@1@40@@@@1,1@1@2;6;30;47@@@@7,1@Распределение Дискового пространства@</Data>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>1</Sub>
<Data>8@1@1@40@@@@0@1@@@@@8,1@Запасное копирование@</Data>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>1</Sub>
<Data>9@1@1@40@@@@0@1@@@@@9,1@Горячее запасное копирование@</Data>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>1</Sub>
<Data>10@1@1@40@@@@0@1@@@@@10,1@Управление DDP@</Data>
</Node>
</Node>
<Node><Sub>11</Sub>
<Node><Sub>1</Sub>
<Data>11@1@1@40@@@@1,1@1@@@@@11,1@Таблица локированных переменных@</Data>
</Node>
</Node>
<Node><Sub>12</Sub>
<Node><Sub>1</Sub>
<Data>12@1@1@40@@@@0@1@1;6;31;47@@@@12,1@Управление клиентами %BS-сети@</Data>
</Node>
</Node>
<Node><Sub>13</Sub>
<Node><Sub>1</Sub>
<Data>13@1@1@40@@@@1,1@1@2;6;30;47@@@@13,1@Параметры %BS-Сетевой работы@</Data>
</Node>
</Node>
<Node><Sub>14</Sub>
<Node><Sub>1</Sub>
<Data>14@1@1@40@@@@1,1@1@2;6;30;47@@@@14,1@Тест %BS-Сетевой производительности@</Data>
</Node>
</Node>
<Node><Sub>CMD</Sub>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>N  D VERIFDDP^%ZAPM.ed.BSD2 W $$r^%ZAPM.ed.BS3 Q  ;ПРОВЕРКА АКТИВНОСТИ DDP</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>N  W # d ^%SS W $$r^%ZAPM.ed.BS3 Q</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>N  W # D ^%SP W $$r^%ZAPM.ed.BS3 Q</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>D SEND^%ZAPM.ed.BSERV</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>D SPACE^%ZAPM.ed.BSERV</Data>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>1</Sub>
<Data>N  W # D MGR^%ZAPM.ed.BS,^MSMDR Q</Data>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>1</Sub>
<Data>N  W # D MGR^%ZAPM.ed.BS,^OLB Q</Data>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>1</Sub>
<Data>N  W # D MGR^%ZAPM.ed.BS,^DDP Q</Data>
</Node>
</Node>
<Node><Sub>11</Sub>
<Node><Sub>1</Sub>
<Data>N  W # D MGR^%ZAPM.ed.BS,^LOCKTAB W $$r^%ZAPM.ed.BS3 Q</Data>
</Node>
</Node>
<Node><Sub>12</Sub>
<Node><Sub>1</Sub>
<Data>D CTRL^%ZAPM.ed.BSERV</Data>
</Node>
</Node>
<Node><Sub>13</Sub>
<Node><Sub>1</Sub>
<Data>I $$ADMIN^%ZAPM.ed.BS() S IYI=&quot;^%ZAPM.ed.BSETUP,SERVER&quot; D NE^%ZAPM.ed.BSN</Data>
</Node>
</Node>
<Node><Sub>14</Sub>
<Node><Sub>1</Sub>
<Data>D TEST^%ZAPM.ed.BS2</Data>
</Node>
</Node>
</Node>
<Node><Sub>FTR</Sub>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>12</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>58079,60968,KSG</Data>
</Node>
<Node><Sub>STA</Sub>
<Data>14,1@3@1@27@-1@-1@16@17@Тест %BS-Сетевой производительности</Data>
</Node>
</Node>
<Node><Sub>SERVER</Sub>
<Data>М-СЕРВЕР, ЗАЩИТА ИНФОРМАЦИИ@@@@@1@1@2@15@21@67@1@@1@@@1@@2,4@1@@@@@1@@@16@5@@2;6;36;44@@@@@@@2@@@@@1</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@1@1@@@@1@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@2@1@25@1@@@@1@2;6;33;44@@@@@              Параметры С@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>1@27@1@1@1@@@@1@2;6;33;44@@@@@Е@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>1@28@1@25@1@@@@1@2;6;33;44@@@@@РВЕРА@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>1@53@1@1@1@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@2@1@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>2@2@2@25@1@@@@1@@@@@@Полная ссылка к глобали, последняя версия %BS@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>2@27@2@1@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>2@28@2@25@@@@@1@2;6;34;46@@@@@A\^[&quot;GLAVK&quot;]BSLast@@@@@^%ZAPM.ed.BSHLP(&quot;VerHigh&quot;)</Data>
</Node>
<Node><Sub>5</Sub>
<Data>2@53@2@1@1@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>4@1@1@1@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>4@2@1@25@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>4@27@1@1@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>4@28@1@25@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>4@53@1@1@1@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>5@1@2@1@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>5@2@2@25@1@@@@1@@@@@@Полная ссылка к глобали, обмена сетевой информац.@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>5@27@2@1@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>5@28@2@25@@@@@1@2;6;34;46@@@@@0\^[&quot;GLAVK&quot;]BServInf@@@@@^%ZAPM.ed.BSHLP(&quot;ServInfo&quot;)</Data>
</Node>
<Node><Sub>5</Sub>
<Data>5@53@2@1@1@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>7@1@1@1@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>7@2@1@25@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>7@27@1@1@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>7@28@1@25@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>7@53@1@1@1@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>8@1@2@1@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>8@2@2@25@1@@@@1@@@@@@Параметры секретного уда-ления обьектов %BS@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>8@27@2@1@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>8@28@2@25@@@@@1@2;6;34;46@@@@@N\N\N\Y@@@@@^%ZAPM.ed.BSHLP(&quot;SecDel&quot;)</Data>
</Node>
<Node><Sub>5</Sub>
<Data>8@53@2@1@1@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>10@1@1@1@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>10@2@1@25@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>10@27@1@1@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>10@28@1@25@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>10@53@1@1@1@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>1</Sub>
<Data>11@1@1@1@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>11@2@1@25@@@@@1@@@@@@Глобальные Буфера вывода@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>11@27@1@1@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data><![CDATA[11@28@1@25@@@@@1@2;6;34;46@@@@@^["GLAVK"]GlobAll ^["GLAVK"]GlobMOL ^["GLAVK"]GlobTAB ^%ZAPM.ed.BSbufS@@@@@^%ZAPM.ed.BSHLP("GLF1")]]></Data>
</Node>
<Node><Sub>5</Sub>
<Data>11@53@1@1@1@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>1</Sub>
<Data>12@1@1@1@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>12@2@1@25@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>12@27@1@1@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>12@28@1@25@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>12@53@1@1@1@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>1</Sub>
<Data>13@1@2@1@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>13@2@2@25@@@@@1@@@@@@Директория файлов для DDR@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>13@27@2@1@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>13@28@2@25@@@@@1@2;6;34;46@@@@@n:\ddr\@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>13@53@2@1@1@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>11</Sub>
<Node><Sub>1</Sub>
<Data>15@1@1@1@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>15@2@1@25@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>15@27@1@1@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>15@28@1@25@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>15@53@1@1@1@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>12</Sub>
<Node><Sub>1</Sub>
<Data>16@1@1@1@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>16@2@1@25@1@@@@1@@@@@@Таблица общих переменных @</Data>
</Node>
<Node><Sub>3</Sub>
<Data>16@27@1@1@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>16@28@1@25@@@@@1@2;6;34;46@@@@@^[&quot;GLAVK&quot;]SRV(&quot;Variables&quot;)@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>16@53@1@1@1@@@@1@@@@@@</Data>
</Node>
</Node>
<Node><Sub>13</Sub>
<Node><Sub>1</Sub>
<Data>17@1@1@1@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>17@2@1@25@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>17@27@1@1@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>17@28@1@25@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>17@53@1@1@1@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>14</Sub>
<Node><Sub>1</Sub>
<Data>18@1@1@1@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>18@2@1@25@@@@@1@@@@@@Начальный Номер терминала @</Data>
</Node>
<Node><Sub>3</Sub>
<Data>18@27@1@1@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>18@28@1@25@@@@@1@2;6;34;46@@@@@33@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>18@53@1@1@1@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>15</Sub>
<Node><Sub>1</Sub>
<Data>19@1@1@1@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>19@2@1@25@@@@@1@@@@@@Путь к сетевым ресурсам@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>19@27@1@1@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>19@28@1@25@@@@@1@2;6;30;47@@@@@n:\webnodes\vv\u\REPORT\@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>19@53@1@1@1@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>16</Sub>
<Node><Sub>1</Sub>
<Data>20@1@1@1@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>20@2@1@25@@@@@1@@@@@@IP Основного WEB-Сервера@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>20@27@1@1@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>20@28@1@25@@@@@1@2;6;34;46@@@@@ivcmsw/iss@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>20@53@1@1@1@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>58324,32363,MS</Data>
</Node>
<Node><Sub>OPT</Sub>
<Data>2,4,2</Data>
</Node>
<Node><Sub>STA</Sub>
<Data>12,4@2@4@27@-1@-1@17@42@^[&quot;GLAVK&quot;]SRV(&quot;Variables&quot;)</Data>
</Node>
</Node>
<Node><Sub>SETUP</Sub>
<Data>ПАРАМЕТРЫ КОМПЛЕКСА@ADM@@@@1@1@2@10@21@60@1@@1@@@1@@2,2@@@@@@@@@20@3@@2;6;30;45@@@@@@@2@@@@@</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@26@@@@@1@2;6;30;45@@@@@    УСТАНОВКА ОПЦИЙ КОМПЛЕ</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@27@1@18@@@@@1@2;6;30;45@@@@@КСА</Data>
</Node>
<Node><Sub>3</Sub>
<Data>1@45@1@7@@@@@1@2;6;30;45@@@@@  DFLT@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@26@@@@@1@2;6;37;44@@@@@ MIN-e количество блоков -</Data>
</Node>
<Node><Sub>2</Sub>
<Data>2@27@1@18@@@@@1@2;6;30;46@@@@@200</Data>
</Node>
<Node><Sub>3</Sub>
<Data>2@45@1@7@@@@0@1@1;6;32;46@@@@2,3@@@@@@^%ZAPM.ed.BSHLP(&quot;DFLT&quot;)</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@26@@@@@1@2;6;37;44@@@@@Гасить экран-тип картинки</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@27@1@18@@@@@1@2;6;30;46@@@@@199-7--%BS@@@@@^%ZAPM.ed.BSHLP(&quot;TipGluc&quot;)</Data>
</Node>
<Node><Sub>3</Sub>
<Data>3@45@1@7@@@@0@1@1;6;32;46@@@@3,3@@@@@@^%ZAPM.ed.BSHLP(&quot;DFLT&quot;)</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>4@1@1@26@@@@@1@2;6;37;44@@@@@Доступ к DOS View/Edit/Del</Data>
</Node>
<Node><Sub>2</Sub>
<Data>4@27@1@18@@@@0@1@2;6;30;46@@@@@300/300/3000@@@@@^%ZAPM.ed.BSHLP(&quot;ACCESHELP&quot;)</Data>
</Node>
<Node><Sub>3</Sub>
<Data>4@45@1@7@@@@0@1@1;6;32;46@@@@4,3@@@@@@^%ZAPM.ed.BSHLP(&quot;DFLT&quot;)</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>5@1@1@26@@@@@1@2;6;37;44@@@@@Доступ к MSM Read/Edit/Kil</Data>
</Node>
<Node><Sub>2</Sub>
<Data>5@27@1@18@@@@@1@2;6;30;46@@@@@Y/Y/Y@@@@@^%ZAPM.ed.BSHLP(&quot;ACCESHELP&quot;)</Data>
</Node>
<Node><Sub>3</Sub>
<Data>5@45@1@7@@@@0@1@1;6;32;46@@@@5,3@@@@@@^%ZAPM.ed.BSHLP(&quot;DFLT&quot;)</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>6@1@1@26@@@@@1@2;6;37;44@@@@@КОДЫ УПРАВЛЕНИЯ ПРИНТЕРОМ-@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>6@27@1@18@1@@@@1@2;6;30;46@@@@^%ZAPM.ed.BSDFLT(&quot;PRNDFLT&quot;)@ ...@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>6@45@1@7@@@@0@1@1;6;32;46@@@@6,3@@@@@@^%ZAPM.ed.BSHLP(&quot;DFLT&quot;)</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>7@1@1@26@@@@@1@2;6;37;44@@@@@      ЦВЕТОВАЯ ПАЛИТРА   -</Data>
</Node>
<Node><Sub>2</Sub>
<Data>7@27@1@18@1@@@@1@2;6;30;46@@@@^%ZAPM.ed.BSETUP(&quot;COLOR&quot;)@ ...</Data>
</Node>
<Node><Sub>3</Sub>
<Data>7@45@1@7@@@@0@1@1;6;32;46@@@@7,3@@@@@@^%ZAPM.ed.BSHLP(&quot;DFLT&quot;)</Data>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>1</Sub>
<Data>8@1@1@26@@@@@1@2;6;37;44@@@@@ПУТИ К ФАЙЛАМ И ДИРЕК-ЯМ.-  </Data>
</Node>
<Node><Sub>2</Sub>
<Data>8@27@1@18@1@@@0@1@2;6;30;46@@@@8,2@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>8@45@1@7@@@@0@1@1;6;32;46@@@@8,3@@@@@@^%ZAPM.ed.BSHLP(&quot;DFLT&quot;)</Data>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>1</Sub>
<Data>9@1@1@26@@@@@1@2;6;37;44@@@@@Пароль администратора ADM@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>9@27@1@18@@@@0@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>9@45@1@7@@@@0@1@1;6;31;44@@@@^%ZAPM.ed.BSVOL(&quot;DATE&quot;)@@@@@@^%ZAPM.ed.BSHLP(&quot;DFLT&quot;)</Data>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>1</Sub>
<Data>10@1@1@26@@@@@1@2;6;37;44@@@@@    DDP технология %BS   -@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>10@27@1@18@@@@0@1@2;6;30;46@@@@^%ZAPM.ed.BSS(&quot;DDPYES&quot;)@0@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>10@45@1@7@@@@0@1@1;6;32;46@@@@10,3@@@@@@^%ZAPM.ed.BSHLP(&quot;DFLT&quot;)</Data>
</Node>
</Node>
<Node><Sub>11</Sub>
<Node><Sub>1</Sub>
<Data>11@1@1@26@@@@@1@2;6;37;44@@@@@     МОНТИРУЕМЫЕ ТОМА    -@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>11@27@1@18@1@@@@1@2;6;30;46@@@@^%ZAPM.ed.BSETUP(&quot;MOUNT&quot;)@ ...@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>11@45@1@7@@@@0@1@1;6;32;46@@@@11,3@@@@@@^%ZAPM.ed.BSHLP(&quot;DFLT&quot;)</Data>
</Node>
</Node>
<Node><Sub>12</Sub>
<Node><Sub>1</Sub>
<Data>12@1@1@26@@@@@1@2;6;37;44@@@@@Раздел таблиц по умолчанию@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>12@27@1@18@@@@@1@2;6;30;46@@@@@^%ZAPM.ed.BSDFLT@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>12@45@1@7@@@@0@1@1;6;32;46@@@@12,3@@@@@@^%ZAPM.ed.BSHLP(&quot;DFLT&quot;)</Data>
</Node>
</Node>
<Node><Sub>13</Sub>
<Node><Sub>1</Sub>
<Data>13@1@1@26@@@@@1@2;6;37;44@@@@@ Размеp буффеpа History  -@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>13@27@1@18@@@@@1@2;6;30;46@@@@@70@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>13@45@1@7@@@@0@1@1;6;32;46@@@@13,3@@@@@@^%ZAPM.ed.BSHLP(&quot;DFLT&quot;)</Data>
</Node>
</Node>
<Node><Sub>14</Sub>
<Node><Sub>1</Sub>
<Data>14@1@1@26@@@@@1@2;6;37;44@@@@@РТА-80Л используем на COM-@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>14@27@1@18@@@@0@1@2;6;30;46@@@@@1@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>14@45@1@7@@@@0@1@1;6;32;46@@@@14,3@@@@@@^%ZAPM.ed.BSHLP(&quot;DFLT&quot;)</Data>
</Node>
</Node>
<Node><Sub>15</Sub>
<Node><Sub>1</Sub>
<Data>15@1@1@26@@@@@1@2;6;37;44@@@@@Пpи &lt;INS&gt; двигать маркер -@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>15@27@1@18@@@@0@1@2;6;30;46@@@@^%ZAPM.ed.BSS(&quot;MOVE&quot;)@1@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>15@45@1@7@@@@0@1@1;6;32;46@@@@15,3@@@@@@^%ZAPM.ed.BSHLP(&quot;DFLT&quot;)</Data>
</Node>
</Node>
<Node><Sub>16</Sub>
<Node><Sub>1</Sub>
<Data>16@1@1@26@@@@@1@2;6;37;44@@@@@После редактора маркер   -@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>16@27@1@18@@@@15,2@1@2;6;30;46@@@@^%ZAPM.ed.BSS(&quot;MOVE&quot;)@2@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>16@45@1@7@@@@0@1@1;6;32;46@@@@16,3@@@@@@^%ZAPM.ed.BSHLP(&quot;DFLT&quot;)</Data>
</Node>
</Node>
<Node><Sub>17</Sub>
<Node><Sub>1</Sub>
<Data>17@1@1@26@@@@@1@2;6;37;44@@@@@       СЕТЕВЫЕ ПАРАМЕТРЫ -@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>17@27@1@18@1@@@0@1@2;6;30;46@@@@^%ZAPM.ed.BSS(&quot;SERV-UTL&quot;)@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>17@45@1@7@@@@0@1@1;6;32;46@@@@17,3@@@@@@^%ZAPM.ed.BSHLP(&quot;DFLT&quot;)</Data>
</Node>
</Node>
<Node><Sub>18</Sub>
<Node><Sub>1</Sub>
<Data>18@1@1@26@@@@@1@2;6;37;44@@@@@        ПАРАМЕТРЫ ПЕЧАТИ -@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>18@27@1@18@1@@@0@1@2;6;30;46@@@@^%ZAPM.ed.BSETUP(&quot;PARPRN&quot;)@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>18@45@1@7@@@@0@1@1;6;32;46@@@@18,3@@@@@@^%ZAPM.ed.BSHLP(&quot;DFLT&quot;)</Data>
</Node>
</Node>
<Node><Sub>19</Sub>
<Node><Sub>1</Sub>
<Data>19@1@1@26@@@@@1@2;6;37;44@@@@@   СИСТЕМНЫЕ БАЗЫ ДАННЫХ -@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>19@27@1@18@1@@@0@1@2;6;30;46@@@@19,2@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>19@45@1@7@@@@@1@1;6;31;44@@@@19,3@EndUser@@@@@^%ZAPM.ed.BSHLP(&quot;DFLT&quot;)</Data>
</Node>
</Node>
<Node><Sub>20</Sub>
<Node><Sub>1</Sub>
<Data>20@1@1@26@@@@@1@2;6;37;44@@@@@ Системные флаги комплекса@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>20@27@1@18@@@@@1@2;6;30;46@@@@@00111010001211000001@@@@@^%ZAPM.ed.BSHLP(&quot;SetHelp&quot;)</Data>
</Node>
<Node><Sub>3</Sub>
<Data>20@45@1@7@@@@0@1@1;6;32;46@@@@20,3@@@@@@^%ZAPM.ed.BSHLP(&quot;DFLT&quot;)</Data>
</Node>
</Node>
<Node><Sub>CMD</Sub>
<Node><Sub>2</Sub>
<Node><Sub>3</Sub>
<Data><![CDATA[D Yes^%ZAPM.ed.BSXfun("Возвращаем настройки по-умолчанию ?") I YES>0 S $P(^%ZAPM.ed.BSETUP("SETUP",2,2),"@",15)=$P(^%ZAPM.ed.BSS("SETUP",2,2),"@",15)]]></Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>3</Sub>
<Data><![CDATA[D Yes^%ZAPM.ed.BSXfun("Возвращаем настройки по-умолчанию ?") I YES>0 S $P(^%ZAPM.ed.BSETUP("SETUP",3,2),"@",15)=$P(^%ZAPM.ed.BSS("SETUP",3,2),"@",15)]]></Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>3</Sub>
<Data><![CDATA[D Yes^%ZAPM.ed.BSXfun("Возвращаем настройки по-умолчанию ?") I YES>0 S $P(^%ZAPM.ed.BSETUP("SETUP",4,2),"@",15)=$P(^%ZAPM.ed.BSS("SETUP",4,2),"@",15)]]></Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>3</Sub>
<Data><![CDATA[D Yes^%ZAPM.ed.BSXfun("Возвращаем настройки по-умолчанию ?") I YES>0 S $P(^%ZAPM.ed.BSETUP("SETUP",5,2),"@",15)=$P(^%ZAPM.ed.BSS("SETUP",5,2),"@",15)]]></Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>3</Sub>
<Data><![CDATA[D Yes^%ZAPM.ed.BSXfun("Возвращаем настройки по-умолчанию ?") I YES>0 S BSr1="^%ZAPM.ed.BSDFLT",BSt1="PRNDFLT",BSr2="^%ZAPM.ed.BSETUP",BSt2=BSt1 D COPY^%ZAPM.ed.BSTK]]></Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>3</Sub>
<Data><![CDATA[D Yes^%ZAPM.ed.BSXfun("Возвращаем настройки по-умолчанию ?") I YES>0 S BSr1="^%ZAPM.ed.BSS",BSt1="COLOR",BSr2="^%ZAPM.ed.BSETUP",BSt2=BSt1 D COPY^%ZAPM.ed.BSTK]]></Data>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>2</Sub>
<Data>I $$ADMIN^%ZAPM.ed.BS() S IYI=&quot;^%ZAPM.ed.BSETUP,PATH&quot; D NE^%ZAPM.ed.BSN</Data>
</Node>
<Node><Sub>3</Sub>
<Data><![CDATA[D Yes^%ZAPM.ed.BSXfun("Возвращаем настройки по-умолчанию ?") I YES>0 S BSr1="^%ZAPM.ed.BSS",BSt1="PATH",BSr2="^%ZAPM.ed.BSETUP",BSt2=BSt1 D COPY^%ZAPM.ed.BSTK]]></Data>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>3</Sub>
<Data><![CDATA[D Yes^%ZAPM.ed.BSXfun("Возвращаем настройки по-умолчанию ?") I YES>0 S $P(^%ZAPM.ed.BSETUP("SETUP",9,2),"@",15)=$P(^%ZAPM.ed.BSS("SETUP",9,2),"@",15)]]></Data>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>3</Sub>
<Data><![CDATA[D Yes^%ZAPM.ed.BSXfun("Возвращаем настройки по-умолчанию ?") I YES>0 S $P(^%ZAPM.ed.BSETUP("SETUP",10,2),"@",15)=$P(^%ZAPM.ed.BSS("SETUP",10,2),"@",15)]]></Data>
</Node>
</Node>
<Node><Sub>11</Sub>
<Node><Sub>3</Sub>
<Data><![CDATA[D Yes^%ZAPM.ed.BSXfun("Возвращаем настройки по-умолчанию ?") I YES>0 S BSr1="^%ZAPM.ed.BSS",BSt1="MOUNT",BSr2="^%ZAPM.ed.BSETUP",BSt2=BSt1 D COPY^%ZAPM.ed.BSTK]]></Data>
</Node>
</Node>
<Node><Sub>12</Sub>
<Node><Sub>3</Sub>
<Data><![CDATA[D Yes^%ZAPM.ed.BSXfun("Возвращаем настройки по-умолчанию ?") I YES>0 S $P(^%ZAPM.ed.BSETUP("SETUP",12,2),"@",15)=$P(^%ZAPM.ed.BSS("SETUP",12,2),"@",15)]]></Data>
</Node>
</Node>
<Node><Sub>13</Sub>
<Node><Sub>3</Sub>
<Data><![CDATA[D Yes^%ZAPM.ed.BSXfun("Возвращаем настройки по-умолчанию ?") I YES>0 S $P(^%ZAPM.ed.BSETUP("SETUP",13,2),"@",15)=$P(^%ZAPM.ed.BSS("SETUP",13,2),"@",15)]]></Data>
</Node>
</Node>
<Node><Sub>14</Sub>
<Node><Sub>3</Sub>
<Data><![CDATA[D Yes^%ZAPM.ed.BSXfun("Возвращаем настройки по-умолчанию ?") I YES>0 S $P(^%ZAPM.ed.BSETUP("SETUP",14,2),"@",15)=$P(^%ZAPM.ed.BSS("SETUP",14,2),"@",15)]]></Data>
</Node>
</Node>
<Node><Sub>15</Sub>
<Node><Sub>3</Sub>
<Data><![CDATA[D Yes^%ZAPM.ed.BSXfun("Возвращаем настройки по-умолчанию ?") I YES>0 S $P(^%ZAPM.ed.BSETUP("SETUP",15,2),"@",15)=$P(^%ZAPM.ed.BSS("SETUP",15,2),"@",15)]]></Data>
</Node>
</Node>
<Node><Sub>16</Sub>
<Node><Sub>3</Sub>
<Data><![CDATA[D Yes^%ZAPM.ed.BSXfun("Возвращаем настройки по-умолчанию ?") I YES>0 S $P(^%ZAPM.ed.BSETUP("SETUP",16,2),"@",15)=$P(^%ZAPM.ed.BSS("SETUP",16,2),"@",15)]]></Data>
</Node>
</Node>
<Node><Sub>17</Sub>
<Node><Sub>3</Sub>
<Data><![CDATA[D Yes^%ZAPM.ed.BSXfun("Возвращаем настройки по-умолчанию ?") I YES>0 S BSr1="^%ZAPM.ed.BSS",BSt1="SERVER",BSr2="^%ZAPM.ed.BSETUP",BSt2=BSt1 D COPY^%ZAPM.ed.BSTK]]></Data>
</Node>
</Node>
<Node><Sub>18</Sub>
<Node><Sub>3</Sub>
<Data><![CDATA[D Yes^%ZAPM.ed.BSXfun("Возвращаем настройки по-умолчанию ?") I YES>0 S BSr1="^%ZAPM.ed.BSDFLT",BSt1="PARPRN",BSr2="^%ZAPM.ed.BSETUP",BSt2=BSt1 D COPY^%ZAPM.ed.BSTK]]></Data>
</Node>
</Node>
<Node><Sub>19</Sub>
<Node><Sub>2</Sub>
<Data>I $$ADMIN^%ZAPM.ed.BS() S IYI=&quot;^%ZAPM.ed.BSVOL,BDSYS&quot; D NE^%ZAPM.ed.BSN</Data>
</Node>
<Node><Sub>3</Sub>
<Data>D REGISTR^%ZAPM.ed.BS3</Data>
</Node>
</Node>
<Node><Sub>20</Sub>
<Node><Sub>3</Sub>
<Data><![CDATA[D Yes^%ZAPM.ed.BSXfun("Возвращаем настройки по-умолчанию ?") I YES>0 S $P(^%ZAPM.ed.BSETUP("SETUP",20,2),"@",15)=$P(^%ZAPM.ed.BSS("SETUP",20,2),"@",15)]]></Data>
</Node>
</Node>
</Node>
<Node><Sub>FTR</Sub>
<Node><Sub>2</Sub>
<Node><Sub>3</Sub>
<Data>S d1=&quot;&lt;Enter&gt;&quot;</Data>
<Node><Sub>1</Sub>
<Data>&quot;&lt;Enter&gt;&quot;</Data>
</Node>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>3</Sub>
<Data>S d1=&quot;&lt;Enter&gt;&quot;</Data>
<Node><Sub>1</Sub>
<Data>&quot;&lt;Enter&gt;&quot;</Data>
</Node>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>2</Sub>
<Data>S d1=d_&quot; (Kb)&quot;</Data>
<Node><Sub>1</Sub>
<Data>d_&quot; (Kb)&quot;</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Data>S d1=&quot;&lt;Enter&gt;&quot;</Data>
<Node><Sub>1</Sub>
<Data>&quot;&lt;Enter&gt;&quot;</Data>
</Node>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>3</Sub>
<Data>S d1=&quot;&lt;Enter&gt;&quot;</Data>
<Node><Sub>1</Sub>
<Data>&quot;&lt;Enter&gt;&quot;</Data>
</Node>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>3</Sub>
<Data>S d1=&quot;&lt;Enter&gt;&quot;</Data>
<Node><Sub>1</Sub>
<Data>&quot;&lt;Enter&gt;&quot;</Data>
</Node>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>3</Sub>
<Data>S d1=&quot;&lt;Enter&gt;&quot;</Data>
<Node><Sub>1</Sub>
<Data>&quot;&lt;Enter&gt;&quot;</Data>
</Node>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>2</Sub>
<Data>S d1=&quot; ...&quot;</Data>
<Node><Sub>1</Sub>
<Data>&quot; ...&quot;</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Data>S d1=&quot;&lt;Enter&gt;&quot;</Data>
<Node><Sub>1</Sub>
<Data>&quot;&lt;Enter&gt;&quot;</Data>
</Node>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>2</Sub>
<Data>S d1=$TR($J(&quot;&quot;,19),&quot; &quot;,&quot;§&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$TR($J(&quot;&quot;,19),&quot; &quot;,&quot;§&quot;)</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Data>S d1=&quot;SysDate&quot;</Data>
<Node><Sub>1</Sub>
<Data>&quot;SysDate&quot;</Data>
</Node>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>2</Sub>
<Data>S d1=$S(d=1:&quot;Да&quot;,1:&quot;Нет&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$S(d=1:&quot;Да&quot;,1:&quot;Нет&quot;)</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Data>S d1=&quot;&lt;Enter&gt;&quot;</Data>
<Node><Sub>1</Sub>
<Data>&quot;&lt;Enter&gt;&quot;</Data>
</Node>
</Node>
</Node>
<Node><Sub>11</Sub>
<Node><Sub>3</Sub>
<Data>S d1=&quot;&lt;Enter&gt;&quot;</Data>
<Node><Sub>1</Sub>
<Data>&quot;&lt;Enter&gt;&quot;</Data>
</Node>
</Node>
</Node>
<Node><Sub>12</Sub>
<Node><Sub>3</Sub>
<Data>S d1=&quot;&lt;Enter&gt;&quot;</Data>
<Node><Sub>1</Sub>
<Data>&quot;&lt;Enter&gt;&quot;</Data>
</Node>
</Node>
</Node>
<Node><Sub>13</Sub>
<Node><Sub>3</Sub>
<Data>S d1=&quot;&lt;Enter&gt;&quot;</Data>
<Node><Sub>1</Sub>
<Data>&quot;&lt;Enter&gt;&quot;</Data>
</Node>
</Node>
</Node>
<Node><Sub>14</Sub>
<Node><Sub>2</Sub>
<Data>S d1=$S(d=1!(d=2):d,1:&quot;нет&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$S(d=1!(d=2):d,1:&quot;нет&quot;)</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Data>S d1=&quot;&lt;Enter&gt;&quot;</Data>
<Node><Sub>1</Sub>
<Data>&quot;&lt;Enter&gt;&quot;</Data>
</Node>
</Node>
</Node>
<Node><Sub>15</Sub>
<Node><Sub>2</Sub>
<Data>S d1=$S(d=1:&quot;вниз&quot;,d=2:&quot;вправо&quot;,1:&quot;нет&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$S(d=1:&quot;вниз&quot;,d=2:&quot;вправо&quot;,1:&quot;нет&quot;)</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Data>S d1=&quot;&lt;Enter&gt;&quot;</Data>
<Node><Sub>1</Sub>
<Data>&quot;&lt;Enter&gt;&quot;</Data>
</Node>
</Node>
</Node>
<Node><Sub>16</Sub>
<Node><Sub>3</Sub>
<Data>S d1=&quot;&lt;Enter&gt;&quot;</Data>
<Node><Sub>1</Sub>
<Data>&quot;&lt;Enter&gt;&quot;</Data>
</Node>
</Node>
</Node>
<Node><Sub>17</Sub>
<Node><Sub>2</Sub>
<Data>S d1=&quot; ...&quot;</Data>
<Node><Sub>1</Sub>
<Data>&quot; ...&quot;</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Data>S d1=&quot;&lt;Enter&gt;&quot;</Data>
<Node><Sub>1</Sub>
<Data>&quot;&lt;Enter&gt;&quot;</Data>
</Node>
</Node>
</Node>
<Node><Sub>18</Sub>
<Node><Sub>2</Sub>
<Data>S d1=&quot; ...&quot;</Data>
<Node><Sub>1</Sub>
<Data>&quot; ...&quot;</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Data>S d1=&quot;&lt;Enter&gt;&quot;</Data>
<Node><Sub>1</Sub>
<Data>&quot;&lt;Enter&gt;&quot;</Data>
</Node>
</Node>
</Node>
<Node><Sub>19</Sub>
<Node><Sub>2</Sub>
<Data>S d1=&quot; ...&quot;</Data>
<Node><Sub>1</Sub>
<Data>&quot; ...&quot;</Data>
</Node>
</Node>
</Node>
<Node><Sub>20</Sub>
<Node><Sub>3</Sub>
<Data>S d1=&quot;&lt;Enter&gt;&quot;</Data>
<Node><Sub>1</Sub>
<Data>&quot;&lt;Enter&gt;&quot;</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>58503,52027,MS</Data>
</Node>
<Node><Sub>OPT</Sub>
<Data>1,2,2</Data>
</Node>
<Node><Sub>STA</Sub>
<Data>19,2@2@2@27@-1@-1@20@36@</Data>
</Node>
</Node>
<Node><Sub>SSD</Sub>
<Data>@@1@@@1@1@15@10@22@80@1@@1@1@@8@@@1@@@@@@@@3@3@@2;6;30;41@@@@@@@@^%ZAPM.ed.BSHLP(&quot;HELP-ALTF2&quot;)</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@10@@@@@1@@@@@@            ВНИМАНИЕ !!!@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@11@1@10@@@@@1@1;6;30;43@@@@@ ОСТАНОВ (ДЕМОНТИРОВАНИЕ) @</Data>
</Node>
<Node><Sub>3</Sub>
<Data>1@21@1@10@@@@@1@@@@@@1@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@10@@@@@1@@@@@@ ВАШУ СИСТЕМУ (ТОМ) могут использовать по DDP !!! </Data>
</Node>
<Node><Sub>2</Sub>
<Data>2@11@1@10@@@@@1@1;6;36;43@@@0@@ ПРЕКРАТИТЬ @</Data>
</Node>
<Node><Sub>3</Sub>
<Data>2@21@1@10@@@@@1@@@@@@0@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@10@@@@@1@@@@@@ ОСТАНОВИТЬ СИСТЕМУ (ДЕМОНТИРОВАТЬ ТОМ) ?@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@11@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>3@21@1@10@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>BUT</Sub>
<Data>/2;6;30;41</Data>
<Node><Sub>0</Sub>
<Data>2;6;30;41</Data>
<Node><Sub>1</Sub>
<Data>            ВНИМАНИЕ !!!</Data>
</Node>
<Node><Sub>2</Sub>
<Data> ВАШУ СИСТЕМУ (ТОМ) могут использовать по DDP !!! </Data>
</Node>
<Node><Sub>3</Sub>
<Data> ОСТАНОВИТЬ СИСТЕМУ (ДЕМОНТИРОВАТЬ ТОМ) ?</Data>
</Node>
</Node>
<Node><Sub>1</Sub>
<Data>1;6;30;43/1;6;36;43</Data>
<Node><Sub>1</Sub>
<Data> ОСТАНОВ (ДЕМОНТИРОВАНИЕ) </Data>
</Node>
<Node><Sub>2</Sub>
<Data> ПРЕКРАТИТЬ </Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Data>2</Data>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>1</Data>
</Node>
<Node><Sub>2</Sub>
<Data>0</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>15</Data>
</Node>
<Node><Sub>2</Sub>
<Data>10</Data>
</Node>
</Node>
</Node>
<Node><Sub>COL</Sub>
<Node><Sub>2</Sub>
<Node><Sub>2</Sub>
<Data>I 1</Data>
<Node><Sub>1</Sub>
<Data>1</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>STA</Sub>
<Data>,@1@1@13@-1@-1@17@30@</Data>
</Node>
</Node>
<Node><Sub>STAT</Sub>
<Data>СТАТИСТИКА@@1@@@1@1@12@11@14@65@@@@@1@7@@@1@@@@@1@@@3@1@@2;6;30;46@@@1@@@</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@55@@@@0@1@@@@@@ПОЛЬЗОВАТЕЛИ</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@55@@@@1,1@1@@@@@@ИНФОРМАЦИЯ ПО ТОМАМ</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@55@@@@1,1@1@@@@@@ОШИБКИ@</Data>
</Node>
</Node>
<Node><Sub>FTR</Sub>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>STA</Sub>
<Data>3,1@1@1@27@-1@-1@14@11@ОШИБКИ</Data>
</Node>
<Node><Sub>USM</Sub>
<Data>48@2;6;30;46</Data>
</Node>
</Node>
<Node><Sub>ShiftF1</Sub>
<Data><![CDATA[СИСТЕМНАЯ ПОМОЩЬ@@1@@@1@1@6@19@22@58@@@@@1@7@@@1@@@@@1@@@17@1@@2;6;30;46@@@1@@@@@@@MENU^%ZAPM.ed.BSF11]]></Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@40@1@@@0@1@2;6;30;46@@@@^%ZAPM.ed.BSC(&quot;FUN&quot;)@Cache&apos;-ОПИСАНИЕ ФУНКЦИЙ И МОДУЛЕЙ</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@40@1@@@0@1@@@@@^%ZAPM.ed.BSHLP(&quot;GUIDE&quot;)@Документация по %BS (инструкции)</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@40@1@@@0@1@@@@@^%ZAPM.ed.BSX(&quot;Doc&quot;)@Документация по текстовому процессору@</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>4@1@1@40@1@@@0@1@@@@@^%ZAPM.ed.BSHLP(&quot;D0&quot;)@Документация по табличному процессору@</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>5@1@1@40@1@@@0@1@2;6;34;46@@@@^%ZAPM.ed.BSHLP(&quot;DOC_TAB&quot;)@Стpуктуpа %BS-ресурсов. Локали,буфера,NS@</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>6@1@1@40@1@@@0@1@@@@@^%ZAPM.ed.BSHLP(&quot;MENU_DOC&quot;)@ Команды программиста и псевдографика@</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>7@1@1@40@1@@@0@1@2;6;30;46@@@@^%ZAPM.ed.BSHLP(200)@Функции ВЫЧисления@</Data>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>1</Sub>
<Data>8@1@1@40@1@@@0@1@2;6;30;46@@@@^%ZAPM.ed.BSHLP(201)@Функции ТРАНсфоpмации@</Data>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>1</Sub>
<Data>9@1@1@40@1@@@0@1@2;6;30;46@@@@^%ZAPM.ed.BSHLP(203)@Функции ЛОГического контpоля@</Data>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>1</Sub>
<Data>10@1@1@40@1@@@0@1@2;6;30;46@@@@^%ZAPM.ed.BSHLP(204)@Функции СИНТаксического контpоля на ввод@</Data>
</Node>
</Node>
<Node><Sub>11</Sub>
<Node><Sub>1</Sub>
<Data>11@1@1@40@@@@0@1@2;6;31;46@@@@11,1@ БАЗА ДАННЫХ BB0@</Data>
</Node>
</Node>
<Node><Sub>12</Sub>
<Node><Sub>1</Sub>
<Data>12@1@1@40@@@@0@1@2;6;34;46@@@@12,1@ БАЗА ДАННЫХ BB1@</Data>
</Node>
</Node>
<Node><Sub>13</Sub>
<Node><Sub>1</Sub>
<Data>13@1@1@40@1@@@0@1@@@@@^%ZAPM.ed.BSHLP(&quot;SetHelp&quot;)@Описание системных флагов %BS(1)@</Data>
</Node>
</Node>
<Node><Sub>14</Sub>
<Node><Sub>1</Sub>
<Data>14@1@1@40@1@@@0@1@2;6;30;46@@@@^%ZAPM.ed.BSVOL(&quot;MARK&quot;)@Редактировать Базу Данных Пометок@</Data>
</Node>
</Node>
<Node><Sub>15</Sub>
<Node><Sub>1</Sub>
<Data>15@1@1@40@1@@@0@1@2;6;31;46@@@@15,1@ГЛОБАЛЬНЫЙ РАЗДЕЛ ОТЧЕТОВ@</Data>
</Node>
</Node>
<Node><Sub>16</Sub>
<Node><Sub>1</Sub>
<Data>16@1@1@40@1@@@0@1@2;6;31;46@@@@16,1@@</Data>
</Node>
</Node>
<Node><Sub>17</Sub>
<Node><Sub>1</Sub>
<Data>17@1@1@40@@@@0@1@2;6;35;46@@@@17,1@ Редактор массивов@</Data>
</Node>
</Node>
<Node><Sub>CMD</Sub>
<Node><Sub>11</Sub>
<Node><Sub>1</Sub>
<Data>N IYI S IYI=&quot;^[&quot;&quot;GLAVK&quot;&quot;]MKOD,KSPML&quot; D NE^%ZAPM.ed.BSN</Data>
</Node>
</Node>
<Node><Sub>12</Sub>
<Node><Sub>1</Sub>
<Data>N IYI S IYI=&quot;^[&quot;&quot;GLAVK&quot;&quot;]MKOD,KSPTO&quot; D NE^%ZAPM.ed.BSN</Data>
</Node>
</Node>
<Node><Sub>14</Sub>
<Node><Sub>1</Sub>
<Data>d ^%ZAPM.ed.BSD</Data>
</Node>
</Node>
<Node><Sub>15</Sub>
<Node><Sub>1</Sub>
<Data>D BUFENTER^%ZAPM.ed.BSF12</Data>
</Node>
</Node>
<Node><Sub>16</Sub>
<Node><Sub>1</Sub>
<Data>D PARTIT^%ZAPM.ed.BSF12($$cB^%ZAPM.ed.BSSV)</Data>
</Node>
</Node>
<Node><Sub>17</Sub>
<Node><Sub>1</Sub>
<Data>D ^%ZAPM.ed.BSMSMG()</Data>
</Node>
</Node>
</Node>
<Node><Sub>FTR</Sub>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>11</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>12</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>13</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>14</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>15</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>16</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(&quot;ЛОКАЛЬНЫЙ РАЗДЕЛ ОТЧЕТОВ для &apos;&quot;_$G(%BS(12))_&quot;&apos;&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(&quot;ЛОКАЛЬНЫЙ РАЗДЕЛ ОТЧЕТОВ для &apos;&quot;_$G(%BS(12))_&quot;&apos;&quot;)</Data>
</Node>
</Node>
</Node>
<Node><Sub>17</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>59470,64606,MSW</Data>
</Node>
<Node><Sub>STA</Sub>
<Data>8,1@1@1@27@-1@-1@13@19@Функции ТРАНсфоpмации</Data>
</Node>
</Node>
<Node><Sub>TABKEY</Sub>
<Data>ТАБЛИЦА ПОЛЬЗОВАТЕЛЬСКОЙ НАСТРОЙКИ ALT-F2@@@@@1@1@1@1@22@80@1@@1@1@@1@@@1@@@@@1@@@1@2@@@@@@@@</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data><![CDATA[1@1@1@10@@@@@1@@@@@1,1@СУММИРОВАНИЕ_ЧНП сканирование ключей и пересуммирование частей непоср.подчинения]]></Data>
</Node>
<Node><Sub>2</Sub>
<Data><![CDATA[1@11@1@10@@@@@1@@@@@1,2@СУММИРОВАНИЕ_ЗА_ДИВИЗИИ сканирование ключей и пересуммирование частей подчинененных соединению@]]></Data>
</Node>
</Node>
<Node><Sub>AF2</Sub>
<Data>^%ZAPM.ed.BSS,TABKEY</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data><![CDATA[ СУММИРОВАНИЕ_ЧНП СУММИРОВАНИЕ_ЗА_ДИВИЗИИ @6@ @0@BLo,"AF2",911@D CNP^%ZAPM.ed.BSTABEL;D SUM^%ZAPM.ed.BSTABEL@]]></Data>
</Node>
</Node>
<Node><Sub>911</Sub>
<Node><Sub>1</Sub>
<Data>сканирование ключей и пересуммирование частей непоср.подчинения</Data>
</Node>
<Node><Sub>2</Sub>
<Data>сканирование ключей и пересуммирование частей подчинененных соединению</Data>
</Node>
</Node>
</Node>
<Node><Sub>AFG</Sub>
<Node><Sub>1</Sub>
<Data>^%ZAPM.ed.BSS,TABKEY</Data>
</Node>
<Node><Sub>2</Sub>
<Data>^%ZAPM.ed.BSS,TABKEY</Data>
</Node>
</Node>
<Node><Sub>CMD</Sub>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>D CNP^%ZAPM.ed.BSTABEL</Data>
</Node>
<Node><Sub>2</Sub>
<Data>D SUM^%ZAPM.ed.BSTABEL</Data>
</Node>
</Node>
</Node>
<Node><Sub>STA</Sub>
<Data><![CDATA[1,2@1@1@13@-1@-1@1@11@СУММИРОВАНИЕ_ЗА_ДИВИЗИИ сканирование ключей и пересуммирование частей подчинененных соединению]]></Data>
</Node>
</Node>
<Node><Sub>TIMER</Sub>
<Data><![CDATA[ТАБЛИЦА ПАРАМЕТРОВ ЗАДАЧИ ТЕСТИРОВАНИЯ@@@@@1@1@2@15@19@67@1@@1@@@1@@2,4@1@@@@@1@@@14@5@@1;6;37;44@@@@@@@2@^%ZAPM.ed.BSDDR("DDRPARMH")@@@@1]]></Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@1@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@2@1@25@@@@@1@2;6;37;44@@@@@ПАРАМЕТРЫ ЗАПУСКА ТАЙМЕРА@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>1@27@1@1@@@@@1@2;6;37;44@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>1@28@1@25@@@@@1@2;6;37;44@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>1@53@1@1@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@2@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>2@2@2@25@@@@@1@@@@@@ВРЕМЯ ЗАПУСКА ПРОГРАММ   ПРОВЕРКИ И КОПИРОВАНИЯ@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>2@27@2@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>2@28@2@25@@@@@1@2;6;34;46@@@@@4:00@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>2@53@2@1@1@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>4@1@1@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>4@2@1@25@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>4@27@1@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>4@28@1@25@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>4@53@1@1@1@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>5@1@1@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>5@2@1@25@@@@@1@@@@@@ВРЕМЯ ПЕРИОДА ТАЙМЕРА сек@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>5@27@1@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>5@28@1@25@@@@@1@2;6;34;46@@@@@40@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>5@53@1@1@1@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>6@1@1@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>6@2@1@25@@@@@1@@@@@@СТРОКА ЗАПУСКА АРХИВИР.@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>6@27@1@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>6@28@1@25@@@@@1@2;6;34;46@@@@@D:\MSM\TEST\ARJ-COPY.BAT @</Data>
</Node>
<Node><Sub>5</Sub>
<Data>6@53@1@1@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>7@1@1@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>7@2@1@25@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>7@27@1@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>7@28@1@25@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>7@53@1@1@1@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>8@1@2@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>8@2@2@25@@@@@1@@@@@@ПОЛНЫЕ ПУТЬ И ИМЯ ФАЙЛА  ЖУРНАЛА УСП.ТЕСТИРОВАНИЯ@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>8@27@2@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>8@28@2@25@@@@@1@2;6;34;46@@@@@D:\MSM\TEST\TESTPASS.OK@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>8@53@2@1@1@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>1</Sub>
<Data>10@1@1@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>10@2@1@25@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>10@27@1@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>10@28@1@25@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>10@53@1@1@1@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>1</Sub>
<Data>11@1@2@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>11@2@2@25@@@@@1@@@@@@ПОЛНЫЕ ПУТЬ И ИМЯ ФАЙЛА  ПРИ НЕУДАЧНОМ ТЕСТЕ@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>11@27@2@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>11@28@2@25@@@@@1@2;6;34;46@@@@@D:\MSM\TEST\TESTPASS.BAD@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>11@53@2@1@1@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>1</Sub>
<Data>13@1@1@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>13@2@1@25@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>13@27@1@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>13@28@1@25@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>13@53@1@1@1@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>11</Sub>
<Node><Sub>1</Sub>
<Data>14@1@2@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>14@2@2@25@@@@@1@@@@@@ПОЛНЫЕ ПУТЬ И ИМЯ ФАЙЛА  ДЛЯ ЗАПУСКА АРХИВИРОВАНИЯ@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>14@27@2@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>14@28@2@25@@@@@1@2;6;34;46@@@@@D:\MSM\TEST\ARJSTART.BAT@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>14@53@2@1@1@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>12</Sub>
<Node><Sub>1</Sub>
<Data>16@1@1@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>16@2@1@25@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>16@27@1@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>16@28@1@25@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>16@53@1@1@1@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>13</Sub>
<Node><Sub>1</Sub>
<Data>17@1@1@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>17@2@1@25@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>17@27@1@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>17@28@1@25@@@@@1@2;6;34;46@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>17@53@1@1@1@@@@1@@@@@@</Data>
</Node>
</Node>
<Node><Sub>14</Sub>
<Node><Sub>1</Sub>
<Data>18@1@1@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>18@2@1@25@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>18@27@1@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>18@28@1@25@1@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>18@53@1@1@1@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>CMD</Sub>
<Node><Sub>10</Sub>
<Node><Sub>4</Sub>
<Data>D START^%ZAPM.ed.BSTIMER</Data>
</Node>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>57828,38179,MS</Data>
</Node>
<Node><Sub>STA</Sub>
<Data>7,4@2@4@27@-1@-1@9@42@D:\MSM\TEST\TESTPASS.OK</Data>
</Node>
</Node>
<Node><Sub>TRIGGER</Sub>
<Data>ПЕРЕКЛЮЧАТЕЛЬ БАЗ ДАННЫХ@@@@@1@1@1@1@22@80@1@@1@1@@2@@2,1@1@@@@@1@@@2@1@@2;6;37;44@@@@@@</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@2@40@@@@@1@@@@@@ ВВЕДИТЕ ССЫЛКУ МАССИВА БД, НА КОТОРУЮ   БУДЕМ ПЕРЕКЛЮЧАТЬ (^MASSBD)</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@40@@@@@2@@@@@@@@@0@@^%ZAPM.ed.BSHLP(&quot;TRIGGER2&quot;)</Data>
</Node>
</Node>
<Node><Sub>Free</Sub>
<Data>57856,44353</Data>
</Node>
<Node><Sub>KEY</Sub>
<Data>^[&quot;GLAVK&quot;]BStrigg</Data>
<Node><Sub>1</Sub>
<Data><![CDATA[ФФФ@@ФФФ@@НОВОЕ ИМЯ ПЕРЕКЛЮЧАТЕЛЯ@1,75@@@ 1-Й ИНДЕКСНЫЙ@2;6;30;42@@@@@ВВЕДИТЕ ИМЯ ПЕРЕКЛЮЧАТЕЛЯ БАЗ ДАННЫХ@@@@@^%ZAPM.ed.BSHLP("TRIGGER")]]></Data>
</Node>
<Node><Sub>2</Sub>
<Data><![CDATA[ФФФ@@ФФФ@@НОВАЯ ССЫЛКА МАССИВА@1,75@@@ 2-Й ИНДЕКСНЫЙ@2;6;37;44@@@@@ВВЕДИТЕ ССЫЛКУ МАССИВА БД, КОТОРУЮ БУДЕМ ПЕРЕКЛЮЧАТЬ (^MASSBD1)@@@@@^%ZAPM.ed.BSHLP("TRIGGER1")]]></Data>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>57856,44353,MS</Data>
</Node>
<Node><Sub>STA</Sub>
<Data>2,1@2@1@13@-1@-1@3@1@</Data>
</Node>
</Node>
<Node><Sub>USER</Sub>
<Data><![CDATA[ТАБЛИЦА ПОЛЬЗОВАТЕЛЕЙ@@@@@1@1@1@1@22@80@1@@1@@@2@@3,2@1@@@@@1@@@4@2@@@@@@@@@@@@USERSBAS^%ZAPM.ed.BSF13]]></Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@60@@@@@1@2;6;35;46@@@@@       ДОПУСТИМЫЕ  АТРИБУТЫ </Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@61@1@10@@@@@1@1;6;35;46@@@@@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@60@@@1@@1@2;6;35;46@@@@@ Пользователь :0 Таблица 0,0,0,0</Data>
</Node>
<Node><Sub>2</Sub>
<Data>2@61@1@10@@@@@1@1;6;35;46@@@@@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@60@@@@@1@1;6;30;42@@@@@   РАЗРЕШЕНО КОРРЕКТИРОВАТЬ ДАННЫЕ ТАБЛИЦЫ  ...........@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@61@1@10@@@@@2@1;6;30;42@@@@@@</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>4@1@1@60@@@@@1@1;6;30;42@@@@@   РАЗРЕШЕНО РЕДАКТИРОВАНИЕ ОПИСАНИЕ ТАБЛИЦЫ...........@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>4@61@1@10@@@@@2@1;6;30;42@@@@@@</Data>
</Node>
</Node>
<Node><Sub>FCL</Sub>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>S d1=&quot; Пользователь :&quot;_$G(k1)_&quot; Таблица &quot;_$G(k5)_&quot;,&quot;_$G(k4)_&quot;,&quot;_$G(k3)_&quot;,&quot;_$G(k2)</Data>
<Node><Sub>1</Sub>
<Data>&quot; Пользователь :&quot;_$G(k1)_&quot; Таблица &quot;_$G(k5)_&quot;,&quot;_$G(k4)_&quot;,&quot;_$G(k3)_&quot;,&quot;_$G(k2)</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>KEY</Sub>
<Data>^[&quot;GLAVK&quot;,&quot;&quot;]BSuserS</Data>
<Node><Sub>1</Sub>
<Data><![CDATA[@@@@ввод нового пользователя@1,70@^%ZAPM.ed.BSS("USERt")@@ 1-Й ИНДЕКСНЫЙ@2;6;30;42@@@@@Введите ИМЯ пользователя (до 3 Символов)@0@@@@^%ZAPM.ed.BSHLP("USERK1")]]></Data>
<Node><Sub>1</Sub>
<Data>S d1=$$NEWuser^%ZAPM.ed.BSsFUNM(d)</Data>
</Node>
<Node><Sub>2</Sub>
<Data>MSW</Data>
</Node>
<Node><Sub>3</Sub>
<Data><![CDATA[S d1=d0_$TR($J("",10-$L(d0))," ",".")_$G(@$G(BSD,"^%")@(".@WHO",d0))_" <-- WG:"_$G(@$G(BSD,"^%")@(d0,0,"9,4"))]]></Data>
</Node>
<Node><Sub>4</Sub>
<Data><![CDATA[d0_$TR($J("",10-$L(d0))," ",".")_$G(@$G(BSD,"^%")@(".@WHO",d0))_" <-- WG:"_$G(@$G(BSD,"^%")@(d0,0,"9,4"))]]></Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Data><![CDATA[@@1@@ВВОД НОВОГО УЗЛА ПАРАМЕТРОВ@1,70@@@ 2-Й ИНДЕКСНЫЙ@2;6;37;44@@@@@Имя тома(3 буквы) *-ЛЮБОЙ,1-Доступ по DDP,2-умал.пути,4-Доступ,переопр.БД@0@@@@^%ZAPM.ed.BSHLP("USERK2")]]></Data>
<Node><Sub>1</Sub>
<Data>S d1=$$ASYS^%ZAPM.ed.BSsFUNM(d,$G(%NAm))</Data>
</Node>
<Node><Sub>2</Sub>
<Data>$$ASYS(d,$G(%NAm))</Data>
</Node>
<Node><Sub>3</Sub>
<Data><![CDATA[S d1=$S(d="*":"Любой ТОМ доступен",d=0:"Прикрепленная таблица доступа",d=1:"Доступ по DDP",d=2:"Умалчиваемые пути",d=4:"Переопределения Баз Данных,Права Доступа",d=3:"АДМИНИСТРАТОР!",1:d)]]></Data>
</Node>
<Node><Sub>4</Sub>
<Data><![CDATA[$S(d="*":"Любой ТОМ доступен",d=0:"Прикрепленная таблица доступа",d=1:"Доступ по DDP",d=2:"Умалчиваемые пути",d=4:"Переопределения Баз Данных,Права Доступа",d=3:"АДМИНИСТРАТОР!",1:d)]]></Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Data><![CDATA[@@@@ввод нового доступного кипа@1,70@@@ 3-Й ИНДЕКСНЫЙ@1;6;37;44@@@@@Введите имя кипа (3 буквы)@0@@@@^%ZAPM.ed.BSHLP("USERK3")]]></Data>
<Node><Sub>1</Sub>
<Data>S d1=$$AUCI^%ZAPM.ed.BSsFUNM(d,$G(%NAm))</Data>
</Node>
<Node><Sub>2</Sub>
<Data>$$AUCI(d,$G(%NAm))</Data>
</Node>
<Node><Sub>3</Sub>
<Data><![CDATA[S d1=$S(d="*":"Любой КИП доступен",d="IN":"Умалчиваемые Пути ВВОДА",d="OUT":"Умалчиваемые Пути ВЫВОДА",1:d)]]></Data>
</Node>
<Node><Sub>4</Sub>
<Data><![CDATA[$S(d="*":"Любой КИП доступен",d="IN":"Умалчиваемые Пути ВВОДА",d="OUT":"Умалчиваемые Пути ВЫВОДА",1:d)]]></Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Data><![CDATA[@@PAR@@ввод нового доступного pаздела@1,70@@@ 4-Й ИНДЕКСНЫЙ@1;6;31;45@@@@@Введите имя Раздела@0@@@@^%ZAPM.ed.BSHLP("USERK4")]]></Data>
<Node><Sub>1</Sub>
<Data>S d1=$$APAR^%ZAPM.ed.BSsFUNM(d,$G(%NAm))</Data>
</Node>
<Node><Sub>2</Sub>
<Data>$$APAR(d,$G(%NAm))</Data>
</Node>
<Node><Sub>3</Sub>
<Data>S d1=$S(d=&quot;*&quot;:&quot;Любой РАЗДЕЛ доступен&quot;,1:d)</Data>
</Node>
<Node><Sub>4</Sub>
<Data>$S(d=&quot;*&quot;:&quot;Любой РАЗДЕЛ доступен&quot;,1:d)</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Data><![CDATA[@@@@ввод новой доступной таблицы@1,70,TIME@@@ 5-Й ИНДЕКСНЫЙ@1;6;33;43@@@@@Введите имя таблицы@0@@@@^%ZAPM.ed.BSHLP("USERK5")]]></Data>
<Node><Sub>1</Sub>
<Data>S d1=$$ATAB^%ZAPM.ed.BSsFUNM(d,$G(%NAm))</Data>
</Node>
<Node><Sub>2</Sub>
<Data>$$ATAB(d,$G(%NAm))</Data>
</Node>
<Node><Sub>3</Sub>
<Data>S d1=$S(d=&quot;*&quot;:&quot;Любая ТАБЛИЦА доступна&quot;,1:d)</Data>
</Node>
<Node><Sub>4</Sub>
<Data>$S(d=&quot;*&quot;:&quot;Любая ТАБЛИЦА доступна&quot;,1:d)</Data>
</Node>
<Node><Sub>10</Sub>
<Data>Текст ,который появится в меню при организации выборки для выдачи СПИСКОВ и СВОДОК</Data>
<Node><Sub>1</Sub>
<Data><![CDATA[I 1 ;Формула вычисления для выборки. Например,ключ 2 это         дата и формула для выборки МАЯ-месяца будет такая :+$E(k2,3,4)=5]]></Data>
</Node>
<Node><Sub>2</Sub>
<Data><![CDATA[1 ;Формула вычисления для выборки. Например,ключ 2 это         дата и формула для выборки МАЯ-месяца будет такая :+$E(k2,3,4)=5]]></Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>59316,45964,MSW</Data>
</Node>
<Node><Sub>STA</Sub>
<Data>3,2@3@2@27@-1@-1@3@61@</Data>
</Node>
</Node>
<Node><Sub>USER_EX</Sub>
<Data><![CDATA[ПРИКРЕПЛЕННЫЙ АРМ И ОГРАНИЧЕНИЕ ДОСТУПА@@@@@1@1@1@1@22@80@1@@1@1@@1@@3,4@1@@@@@1@@@10@5@@1;6;35;43@@@@@@@@^%ZAPM.ed.BSHLP("ACCESHELP")@@@@1]]></Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@1@1@@@@1@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@2@1@45@1@@@@1@@@@@@           ТАБЛИЦА ДОСТУПА ПОЛЬЗОВАТЕЛЯ:</Data>
</Node>
<Node><Sub>3</Sub>
<Data>1@47@1@1@1@@@@1@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>1@48@1@17@1@@@0@1@1;6;33;43@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>1@65@1@1@1@@@@1@@@@@@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@1@1@@@@1@@@@@@=</Data>
</Node>
<Node><Sub>2</Sub>
<Data>2@2@1@45@1@@@0@1@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>2@47@1@1@1@@@@1@@@@@@=</Data>
</Node>
<Node><Sub>4</Sub>
<Data>2@48@1@17@1@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>2@65@1@1@1@@@@1@@@@@@=</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@1@1@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@2@1@45@1@@@@1@@@@@@Доступ к MUMPS интеpфейсу        (YN/YN/YN)</Data>
</Node>
<Node><Sub>3</Sub>
<Data>3@47@1@1@1@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>4</Sub>
<Data>3@48@1@17@@@1@@2@1;6;33;43@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>3@65@1@1@1@@@@1@@@@@@|</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>4@1@1@1@1@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>2</Sub>
<Data>4@2@1@45@1@@@6,2@1@@@@@@---</Data>
</Node>
<Node><Sub>3</Sub>
<Data>4@47@1@1@1@@@@1@@@@@@-</Data>
</Node>
<Node><Sub>4</Sub>
<Data>4@48@1@17@1@@@6,2@1@@@@@@-------</Data>
</Node>
<Node><Sub>5</Sub>
<Data>4@65@1@1@1@@@@1@@@@@@|</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>5@1@1@1@1@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>2</Sub>
<Data>5@2@1@45@1@@@@1@@@@@@Доступ к DOS интеpфейсу (View/Edit/Del) Kb</Data>
</Node>
<Node><Sub>3</Sub>
<Data>5@47@1@1@1@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>4</Sub>
<Data>5@48@1@17@@@1@@2@1;6;33;43@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>5@65@1@1@1@@@@1@@@@@@|</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>6@1@1@1@1@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>2</Sub>
<Data>6@2@1@45@1@@@0@1@@@@@@---</Data>
</Node>
<Node><Sub>3</Sub>
<Data>6@47@1@1@1@@@@1@@@@@@-</Data>
</Node>
<Node><Sub>4</Sub>
<Data>6@48@1@17@1@@@6,2@1@@@@@@-------</Data>
</Node>
<Node><Sub>5</Sub>
<Data>6@65@1@1@1@@@@1@@@@@@|</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>7@1@1@1@1@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>2</Sub>
<Data>7@2@1@45@1@@@@1@@@@@@Пpикpепленное Автом.Рабочее Место     (Имя)</Data>
</Node>
<Node><Sub>3</Sub>
<Data>7@47@1@1@1@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>4</Sub>
<Data>7@48@1@17@@@@@2@1;6;33;43@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>7@65@1@1@1@@@@1@@@@@@|@@@@</Data>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>1</Sub>
<Data>8@1@1@1@1@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>2</Sub>
<Data>8@2@1@45@1@@@0@1@@@@@@---</Data>
</Node>
<Node><Sub>3</Sub>
<Data>8@47@1@1@1@@@@1@@@@@@-</Data>
</Node>
<Node><Sub>4</Sub>
<Data>8@48@1@17@1@@@6,2@1@@@@@@-------</Data>
</Node>
<Node><Sub>5</Sub>
<Data>8@65@1@1@1@@@@1@@@@@@|</Data>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>1</Sub>
<Data>9@1@1@1@1@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>2</Sub>
<Data>9@2@1@45@@@@@1@@@@@@Эквивалентный пользователь            (Имя)</Data>
</Node>
<Node><Sub>3</Sub>
<Data>9@47@1@1@1@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>4</Sub>
<Data>9@48@1@17@@@@@2@1;6;33;43@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>9@65@1@1@1@@@@1@@@@@@|@@@@</Data>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>1</Sub>
<Data>10@1@1@1@1@@@@1@@@@@@=</Data>
</Node>
<Node><Sub>2</Sub>
<Data>10@2@1@45@1@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>10@47@1@1@1@@@@1@@@@@@=</Data>
</Node>
<Node><Sub>4</Sub>
<Data>10@48@1@17@1@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>10@65@1@1@1@@@@1@@@@@@=</Data>
</Node>
</Node>
<Node><Sub>FCL</Sub>
<Node><Sub>3</Sub>
<Node><Sub>4</Sub>
<Data>S d1=$S($$A^%ZAPM.ed.BSA(3,4)=&quot;&quot;:$$A^%ZAPM.ed.BSA(5,2,&quot;SETUP&quot;,&quot;%BSETUP&quot;),1:$$A^%ZAPM.ed.BSA(3,4))</Data>
<Node><Sub>1</Sub>
<Data>$S({3,4}=&quot;&quot;:{5,2,&quot;SETUP&quot;,&quot;%BSETUP&quot;},1:{3,4})</Data>
</Node>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>4</Sub>
<Data>S d1=$S($$A^%ZAPM.ed.BSA(5,4)=&quot;&quot;:$$A^%ZAPM.ed.BSA(4,2,&quot;SETUP&quot;,&quot;%BSETUP&quot;),1:$$A^%ZAPM.ed.BSA(5,4))</Data>
<Node><Sub>1</Sub>
<Data>$S({5,4}=&quot;&quot;:{4,2,&quot;SETUP&quot;,&quot;%BSETUP&quot;},1:{5,4})</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>FTR</Sub>
<Node><Sub>1</Sub>
<Node><Sub>4</Sub>
<Data>S d1=$G(Key1)</Data>
<Node><Sub>1</Sub>
<Data>$G(Key1)</Data>
</Node>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>2</Sub>
<Data>S d1=$TR($J(&quot;&quot;,45),&quot; &quot;,&quot;=&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$TR($J(&quot;&quot;,45),&quot; &quot;,&quot;=&quot;)</Data>
</Node>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>2</Sub>
<Data>S d1=$TR($J(&quot;&quot;,45),&quot; &quot;,&quot;-&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$TR($J(&quot;&quot;,45),&quot; &quot;,&quot;-&quot;)</Data>
</Node>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>2</Sub>
<Data>S d1=$TR($J(&quot;&quot;,45),&quot; &quot;,&quot;-&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$TR($J(&quot;&quot;,45),&quot; &quot;,&quot;-&quot;)</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>57511,64074,MS</Data>
</Node>
<Node><Sub>STA</Sub>
<Data>5,4@3@4@13@-1@-1@3@48@</Data>
</Node>
</Node>
<Node><Sub>USERt</Sub>
<Data>заготовка ДЛЯ КЛЮЧА по пользователям@@@@@1@1@1@1@22@79@1@@1@1@@1@@@1@@@@@1@@@3@1@@2;6;34;46@@@@@@@</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@75@@@@@1@2;6;37;44@@@@@ .. Вернуться назад</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data><![CDATA[2@1@1@75@@@@@1@2;6;30;45@@@@@Ввод нового пользователя            По <Alt+F2> - смена пароля и коментария]]></Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@75@@@@0@1@2;6;30;45@@@@@@</Data>
</Node>
</Node>
<Node><Sub>AF2</Sub>
<Data>^%ZAPM.ed.BSS,USERt</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data> Смена_пароля Смена_коментария @6@ @0@BLo,&quot;AF2&quot;,911@D CHPW^%ZAPM.ed.BSF12;D CHCM^%ZAPM.ed.BSF12@</Data>
</Node>
</Node>
<Node><Sub>911</Sub>
<Node><Sub>1</Sub>
<Data>Смена пароля для текущего пользователя</Data>
</Node>
<Node><Sub>2</Sub>
<Data>Смена коментария для текущего пользователя</Data>
</Node>
</Node>
</Node>
<Node><Sub>FTR</Sub>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data><![CDATA[S d1=d0_$TR($J("",10-$L(d0))," ",".")_$G(@$G(BSD,"^%")@(".@WHO",d0))_" <-- WG:"_$G(@$G(BSD,"^%")@(d0,0,"9,4"))]]></Data>
<Node><Sub>1</Sub>
<Data><![CDATA[d0_$TR($J("",10-$L(d0))," ",".")_$G(@$G(BSD,"^%")@(".@WHO",d0))_" <-- WG:"_$G(@$G(BSD,"^%")@(d0,0,"9,4"))]]></Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>58121,38122,MS</Data>
</Node>
<Node><Sub>STA</Sub>
<Data>3,1@1@1@13@-1@-1@3@1@</Data>
</Node>
</Node>
<Node><Sub>USERtC</Sub>
<Data>ТАБЛИЦА ПОЛЬЗОВАТЕЛЬСКОЙ НАСТРОЙКИ ALT-F2@@@@@1@1@1@1@22@80@1@@1@1@@1@@@1@@@@@1@@@1@2@@@@@@@@</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@10@@@@@1@@@@@1,1@Смена_пароля Смена пароля для текущего пользователя</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@11@1@10@@@@@1@@@@@1,2@Смена_коментария Смена коментария для текущего пользователя@</Data>
</Node>
</Node>
<Node><Sub>AF2</Sub>
<Data>^%ZAPM.ed.BSS,USERtC</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data> Смена_пароля Смена_коментария @6@ @0@BLo,&quot;AF2&quot;,911@D CHPW^%ZAPM.ed.BSF12;D CHCM^%ZAPM.ed.BSF12@</Data>
</Node>
</Node>
<Node><Sub>911</Sub>
<Node><Sub>1</Sub>
<Data>Смена пароля для текущего пользователя</Data>
</Node>
<Node><Sub>2</Sub>
<Data>Смена коментария для текущего пользователя</Data>
</Node>
</Node>
</Node>
<Node><Sub>AFG</Sub>
<Node><Sub>1</Sub>
<Data>^%ZAPM.ed.BSS,USERt</Data>
</Node>
<Node><Sub>2</Sub>
<Data>^%ZAPM.ed.BSS,USERt</Data>
</Node>
</Node>
<Node><Sub>CMD</Sub>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>D CHPW^%ZAPM.ed.BSF12</Data>
</Node>
<Node><Sub>2</Sub>
<Data>D CHCM^%ZAPM.ed.BSF12</Data>
</Node>
</Node>
</Node>
<Node><Sub>STA</Sub>
<Data>1,1@1@1@13@-1@-1@1@1@Смена_пароля Смена пароля для текущего пользователя</Data>
</Node>
</Node>
<Node><Sub>UTILITY</Sub>
<Data><![CDATA[СИСТЕМНЫЕ ПРОГРАММЫ@ADM@1@@@1@1@8@11@20@65@@@@@1@7@@@1@@@@@1@@@13@1@@2;6;30;46@@@1@@@@@@@MENU^%ZAPM.ed.BSF11]]></Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@55@@@@0@1@@@@@1,1@СТАТИСТИКА MSM</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@55@@@@1,1@1@@@@@2,1@МОНИТОР DDP (^DDP)@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@55@@@@1,1@1@@@@@3,1@СИСТЕМНЫЕ ПРОГРАММЫ (^%UTL)</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>4@1@1@55@@@@1,1@1@@@@@4,1@ПОДНЯТИЕ ПОТЕРЯННЫХ БЛОКОВ (^RECOVER)@</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>5@1@1@55@@@@1,1@1@@@@@5,1@ПРОВЕРКА НАЗНАЧЕНИЯ КАРТ БЛОКОВ (^VERIFY)@</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>6@1@1@55@@@@1,1@1@@@@@6,1@КОМПРЕССИЯ,РЕМОНТ,РАЗМЕР МАССИВОВ (^GBMAINT)@</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>7@1@1@55@@@@1,1@1@@@@@7,1@РЕЗЕРВНОЕ КОПИРОВАНИЕ ГРУПП ТОМОВ (^MSMDR)@</Data>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>1</Sub>
<Data>8@1@1@55@@@@1,1@1@@@@@8,1@МЕНЕДЖЕР ГРУПП ТОМОВ (^DBMAINT)@</Data>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>1</Sub>
<Data>9@1@1@55@@@@1,1@1@@@@@9,1@МЕНЕДЖЕР КИПОВ (^UCIMGR)@</Data>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>1</Sub>
<Data>10@1@1@55@@@@0@1@@@@@10,1@КОНФИГУРАЦИЯ (^SYSGEN)@</Data>
</Node>
</Node>
<Node><Sub>11</Sub>
<Node><Sub>1</Sub>
<Data>11@1@1@55@@@@1,1@1@@@@@11,1@СЧЕТЧИКИ СИСТЕМЫ@</Data>
</Node>
</Node>
<Node><Sub>12</Sub>
<Node><Sub>1</Sub>
<Data>12@1@1@55@@@@1,1@1@@@@@^%ZAPM.ed.BSS(&quot;VOLS-FIX&quot;)@ПРОКАЧКА ТОМОВ@</Data>
</Node>
</Node>
<Node><Sub>13</Sub>
<Node><Sub>1</Sub>
<Data>13@1@1@55@@@@1,1@1@@@@@12,1@РЕМОНТ@</Data>
</Node>
</Node>
<Node><Sub>CMD</Sub>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>W # N  D ^RTHIST Q</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>W # N  D ^DDP Q</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>W # N  D ^%UTL Q</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>W # N  D ^RECOVER Q</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>W # N  D ^VERIFY W $$r^%ZAPM.ed.BS3 Q</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>W # N  D ^GBMAINT Q</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>W # N  D ^MSMDR Q</Data>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>1</Sub>
<Data>W # N  D ^DBMAINT Q</Data>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>1</Sub>
<Data>W # N  D ^UCIMGR Q</Data>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>1</Sub>
<Data>W # N  D ^SYSGEN Q</Data>
</Node>
</Node>
<Node><Sub>11</Sub>
<Node><Sub>1</Sub>
<Data>W # N  D ^RTHIST Q</Data>
</Node>
</Node>
<Node><Sub>12</Sub>
<Node><Sub>1</Sub>
<Data>W # N  D ^DBFIX Q</Data>
</Node>
</Node>
</Node>
<Node><Sub>FTR</Sub>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>57547,52482,</Data>
</Node>
<Node><Sub>STA</Sub>
<Data>1,1@1@1@27@-1@-1@8@11@СТАТИСТИКА MSM</Data>
</Node>
<Node><Sub>USM</Sub>
<Data>48@2;6;30;46</Data>
</Node>
</Node>
<Node><Sub>VOLS-FIX</Sub>
<Data>ТОТАЛЬНАЯ МОДИФИКАЦИЯ ТОМОВ@@1@@@1@1@10@11@16@65@@@@@1@7@@@1@@@@@1@@@3@1@@2;6;30;46@@@1@@@</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@55@@@@0@1@@@@@1,1@ДИАГНОСТИКА ССЫЛОК В ТОМЕ</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@55@@@@0@1@@@@@2,1@ПРОКАЧКА ССЫЛОК В ТОМЕ С ЗАМЕНОЙ ОДНОЙ НА ДРУГУЮ</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@55@@@@0@1@2;6;30;41@@@@3,1@!!! УДАЛЕНИЕ ИНФОРМАЦИОННЫХ БАЗ ДАННЫХ !!!@</Data>
</Node>
</Node>
<Node><Sub>CMD</Sub>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>D Diag^%ZAPM.ed.BSGLOB</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>D TranGlob^%ZAPM.ed.BSGLOB</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>D KBD^%ZAPM.ed.BSGLOB</Data>
</Node>
</Node>
</Node>
<Node><Sub>FTR</Sub>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>STA</Sub>
<Data>1,1@1@1@27@-1@-1@10@11@ДИАГНОСТИКА ССЫЛОК В ТОМЕ</Data>
</Node>
<Node><Sub>USM</Sub>
<Data>48@2;6;30;46</Data>
</Node>
</Node>
<Node><Sub>XECUTE</Sub>
<Data><![CDATA[Вызовы команд MUMPS при входе в комплекс@ADM@@@@1@1@1@1@22@80@1@@1@@@2@@3,4@1@@@@@1@@@8@5@@2;6;30;46@@@@@@@@^%ZAPM.ed.BSS("XECUTE_T")@@@@1]]></Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@1@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@2@1@30@@@@@1@@@@@@ ТАБЛИЦА ИСПОЛНЕНИЯ ПРОГРАММ</Data>
</Node>
<Node><Sub>3</Sub>
<Data>1@32@1@1@@@@@1@@@@@@:</Data>
</Node>
<Node><Sub>4</Sub>
<Data>1@33@1@40@@@@0@1@2;6;30;46@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>1@73@1@1@@@@@1@@@@@@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@1@@@@@1@@@@@@=</Data>
</Node>
<Node><Sub>2</Sub>
<Data>2@2@1@30@@@@0@1@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>2@32@1@1@@@@@1@@@@@@=</Data>
</Node>
<Node><Sub>4</Sub>
<Data>2@33@1@40@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>2@73@1@1@@@@@1@@@@@@=</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@2@1@30@@@@@1@@@@@@Коментаpий к ВЫЗОВУ</Data>
</Node>
<Node><Sub>3</Sub>
<Data>3@32@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>4</Sub>
<Data>3@33@1@40@@@@@2@1;6;34;46@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>3@73@1@1@@@@@1@@@@@@|</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>4@1@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>2</Sub>
<Data>4@2@1@30@@@@6,2@1@@@@@@---</Data>
</Node>
<Node><Sub>3</Sub>
<Data>4@32@1@1@@@@@1@@@@@@-</Data>
</Node>
<Node><Sub>4</Sub>
<Data>4@33@1@40@1@@@6,2@1@@@@@@-------</Data>
</Node>
<Node><Sub>5</Sub>
<Data>4@73@1@1@1@@@@1@@@@@@|</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>5@1@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>2</Sub>
<Data>5@2@1@30@@@@@1@@@@@@Условие (когда вызывать)</Data>
</Node>
<Node><Sub>3</Sub>
<Data>5@32@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>4</Sub>
<Data>5@33@1@40@@@@@2@1;6;34;46@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>5@73@1@1@1@@@@1@@@@@@|</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>6@1@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>2</Sub>
<Data>6@2@1@30@@@@0@1@@@@@@---</Data>
</Node>
<Node><Sub>3</Sub>
<Data>6@32@1@1@@@@@1@@@@@@-</Data>
</Node>
<Node><Sub>4</Sub>
<Data>6@33@1@40@1@@@6,2@1@@@@@@-------</Data>
</Node>
<Node><Sub>5</Sub>
<Data>6@73@1@1@1@@@@1@@@@@@|</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>7@1@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>2</Sub>
<Data>7@2@1@30@@@@@1@@@@@@Команда MUMPS вызова</Data>
</Node>
<Node><Sub>3</Sub>
<Data>7@32@1@1@@@@@1@@@@@@|</Data>
</Node>
<Node><Sub>4</Sub>
<Data>7@33@1@40@@@@@2@1;6;34;46@@@@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>7@73@1@1@1@@@@1@@@@@@|</Data>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>1</Sub>
<Data>8@1@1@1@@@@@1@@@@@@=</Data>
</Node>
<Node><Sub>2</Sub>
<Data>8@2@1@30@@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>8@32@1@1@@@@@1@@@@@@=</Data>
</Node>
<Node><Sub>4</Sub>
<Data>8@33@1@40@1@@@2,2@1@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>8@73@1@1@1@@@@1@@@@@@=</Data>
</Node>
</Node>
<Node><Sub>FTR</Sub>
<Node><Sub>1</Sub>
<Node><Sub>4</Sub>
<Data>S d1=$G(k1,&quot;?&quot;) S date=$G(k1,0)</Data>
<Node><Sub>1</Sub>
<Data>$G(k1,&quot;?&quot;) S date=$G(k1,0)</Data>
</Node>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>2</Sub>
<Data>S d1=$TR($J(&quot;&quot;,40),&quot; &quot;,&quot;=&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$TR($J(&quot;&quot;,40),&quot; &quot;,&quot;=&quot;)</Data>
</Node>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>2</Sub>
<Data>S d1=$TR($J(&quot;&quot;,40),&quot; &quot;,&quot;-&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$TR($J(&quot;&quot;,40),&quot; &quot;,&quot;-&quot;)</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>Free</Sub>
<Data>59892,11531</Data>
</Node>
<Node><Sub>KEY</Sub>
<Data>^%ZAPM.ed.BSex</Data>
<Node><Sub>1</Sub>
<Data>!@@@§@НОВЫЙ ВЫЗОВ@1,70@@@ 1-Й ИНДЕКСНЫЙ@2;6;30;42@@@@@Введите ИМЯ ВЫЗОВА (до 9 букв и цыфр)@@@@@</Data>
<Node><Sub>3</Sub>
<Data>S d1=d_$TR($J(&quot;&quot;,10-$L(d)),&quot; &quot;,&quot;.&quot;)_$$A^%ZAPM.ed.BSA(3,4,&quot;XECUTE&quot;,&quot;%BSS&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;,$G(d,0))</Data>
</Node>
<Node><Sub>4</Sub>
<Data>d_$TR($J(&quot;&quot;,10-$L(d)),&quot; &quot;,&quot;.&quot;)_{3,4,&quot;XECUTE&quot;,&quot;%BSS&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;,$G(d,0)}</Data>
</Node>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>59892,11531,Styx</Data>
</Node>
<Node><Sub>STA</Sub>
<Data>3,4@3@4@-2@-2@-2@3@33@</Data>
</Node>
</Node>
<Node><Sub>XECUTE_T</Sub>
<Data>ВЫЗОВЫ КОМАНД MUMPS@@@@@@@5@10@17@70@@@@1@@5@@@1@@@ 1@@@@@10@@@1;6;37;44//2;6;33;40@@@@@@@1</Data>
<Node><Sub>1</Sub>
<Data></Data>
</Node>
<Node><Sub>2</Sub>
<Data>0 - ДО РЕГИСТРАЦИИ ПОЛЬЗОВАТЕЛЯ</Data>
</Node>
<Node><Sub>3</Sub>
<Data>1 - ПОСЛЕ РЕГИСТРАЦИИ </Data>
</Node>
<Node><Sub>4</Sub>
<Data>2 - ПОСЛЕ ОПРЕДЕЛЕНИЯ КИПОВ,ТОМОВ</Data>
</Node>
<Node><Sub>5</Sub>
<Data>3 - ПОСЛЕ ОПРЕДЕЛЕНИЯ РАЗДЕЛА</Data>
</Node>
<Node><Sub>6</Sub>
<Data>4 - ПЕРЕД ВХОДОМ В ТАБЛИЦУ</Data>
</Node>
<Node><Sub>7</Sub>
<Data>                      </Data>
</Node>
<Node><Sub>8</Sub>
<Data></Data>
</Node>
<Node><Sub>9</Sub>
<Data></Data>
</Node>
<Node><Sub>10</Sub>
<Data>9 - ПЕРЕД УХОДОМ В ДОС</Data>
</Node>
</Node>
<Node><Sub>YES</Sub>
<Data>@@1@@@1@1@1@1@22@80@1@@1@1@@8@@@1@@@@@@@@2@3@@1;6;37;45@@@@@@@@^%ZAPM.ed.BSHLP(&quot;HELP-ALTF2&quot;)</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@10@@@@@1@@@@@@   Выберите пожалуйста   @@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@11@1@10@@@@@1@2;6;30;45@@@@@  ДА  @</Data>
</Node>
<Node><Sub>3</Sub>
<Data>1@21@1@10@@@@@1@@@@@@Y@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@10@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>2@11@1@10@@@@@1@2;6;30;41@@@@@  НЕТ  @</Data>
</Node>
<Node><Sub>3</Sub>
<Data>2@21@1@10@@@@@1@@@@@@N@</Data>
</Node>
</Node>
<Node><Sub>BUT</Sub>
<Data>/1;6;37;45</Data>
<Node><Sub>0</Sub>
<Data>1;6;37;45</Data>
<Node><Sub>1</Sub>
<Data>   Выберите пожалуйста   </Data>
</Node>
</Node>
<Node><Sub>1</Sub>
<Data>2;6;30;45/2;6;30;41</Data>
<Node><Sub>1</Sub>
<Data>  ДА  </Data>
</Node>
<Node><Sub>2</Sub>
<Data>  НЕТ  </Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>Y</Data>
</Node>
<Node><Sub>2</Sub>
<Data>N</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>0</Data>
</Node>
<Node><Sub>2</Sub>
<Data>0</Data>
</Node>
</Node>
</Node>
<Node><Sub>STA</Sub>
<Data>1,1@1@1@13@-1@-1@1@1@   Выберите пожалуйста   </Data>
</Node>
</Node>
<Node><Sub>selekt-z</Sub>
<Data><![CDATA[Пример применения зависимых кнопок@@@@@1@1@1@1@22@80@1@@1@1@@1@@@1@@@@@@@@4@1@@2;6;37;44@@@@@@@@^%ZAPM.ed.BSHLP("HELP-ALTF2")@@SelZ^%ZAPM.ed.BSF9]]></Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@10@@@@0@1@@@@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@10@@@@0@1@@@@@@1</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@10@@@@0@1@@@@@@ @</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>4@1@1@10@@@@0@1@@@@@@Q@</Data>
</Node>
</Node>
<Node><Sub>FTR</Sub>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM($$SelecBut^%ZAPM.ed.BSsFUNM(1,0,&quot;1&quot;))</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR($$SelecBut(1,0,&quot;1&quot;))</Data>
</Node>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM($$SelecBut^%ZAPM.ed.BSsFUNM(1,0,&quot;22&quot;))</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR($$SelecBut(1,0,&quot;22&quot;))</Data>
</Node>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM($$SelecBut^%ZAPM.ed.BSsFUNM(1,1,&quot;333&quot;))</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR($$SelecBut(1,1,&quot;333&quot;))</Data>
</Node>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM($$SelecBut^%ZAPM.ed.BSsFUNM(1,0,&quot;4444&quot;))</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR($$SelecBut(1,0,&quot;4444&quot;))</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>STA</Sub>
<Data>4,1@1@1@-2@-2@-2@4@1@</Data>
</Node>
</Node>
</Node>
</Global>


<Global>
<Node><Sub>^%ZAPM.ed.BSVOL</Sub>
<Data>BaSe MsW @%BS-СИСТЕМНЫЕ ПРИЛОЖЕНИЯ@@</Data>
<Node><Sub>ACTFILE</Sub>
<Data>БАЗА ДЕЙСТВИЙ С ФАЙЛАМИ@@@@@1@1@1@1@22@80@1@@1@@@2@@2,2@1@@@@@1@@@3@2@@@@@@@@@@</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@2@20@@@@@1@2;6;35;42@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@21@2@53@@@@0@1@2;6;35;42@@@@@@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>3@1@2@20@@@@@1@2;6;35;42@@@@@      КОМЕНТАРИЙ</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@21@2@53@@@@@2@1;6;33;43@@@@@@@@REM@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>5@1@2@20@@@@@1@2;6;35;42@@@@@КОМАНДА М ДЛЯ РАБОТЫС ФАЙЛОМ=FILE,SIZE@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>5@21@2@53@@@@@2@1;6;33;43@@@@@@@@NSP</Data>
</Node>
</Node>
<Node><Sub>FTR</Sub>
<Node><Sub>1</Sub>
<Node><Sub>2</Sub>
<Data>S d1=&quot; ДЕЙСТВИЕ :&quot;_$G(k1,&quot;?&quot;)</Data>
<Node><Sub>1</Sub>
<Data>&quot; ДЕЙСТВИЕ :&quot;_$G(k1,&quot;?&quot;)</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>Free</Sub>
<Data>58210,38110</Data>
</Node>
<Node><Sub>KEY</Sub>
<Data>^%ZAPM.ed.BSactF</Data>
<Node><Sub>1</Sub>
<Data>0@@@§@НОВАЯ КОМАНДА @1,75@@@ 1-Й ИНДЕКСНЫЙ@2;6;37;44@@@@@НОВАЯ КОМАНДА@@@@@</Data>
<Node><Sub>3</Sub>
<Data>S d1=d_&quot;...&quot;_$$A^%ZAPM.ed.BSA(2,2,&quot;ACTFILE&quot;,&quot;^%ZAPM.ed.BSVOL&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;,$G(d,0))</Data>
</Node>
<Node><Sub>4</Sub>
<Data>d_&quot;...&quot;_{2,2,&quot;ACTFILE&quot;,&quot;^%ZAPM.ed.BSVOL&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;,$G(d,0)}</Data>
</Node>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>58210,38110,MS</Data>
</Node>
<Node><Sub>STA</Sub>
<Data>3,2@2@2@27@-1@-1@5@21@</Data>
</Node>
</Node>
<Node><Sub>BDSYS</Sub>
<Data><![CDATA[БАЗЫ ДАННЫХ КОМПЛЕКСА@@1@@@1@1@6@11@22@65@@@@@1@7@@@1@@@@@1@@@17@1@@2;6;30;46@@@1@@@@@@@MENU^%ZAPM.ed.BSF11]]></Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@55@@@@0@1@2;6;31;46@@@@1,1@ПОЛЬЗОВАТЕЛИ КОМПЛЕКСА</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@55@@@@1,1@1@@@@@^%ZAPM.ed.BSS(&quot;ARM&quot;)@АВТОМАТИЗИРОВАННЫЕ РАБОЧИЕ МЕСТА (АРМы)</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@55@@@@1,1@1@@@@@^%ZAPM.ed.BSVOL(&quot;MARK&quot;)@БАЗА ПОМЕТОК@</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>4@1@1@55@@@@1,1@1@@@@@^%ZAPM.ed.BSVOL(&quot;TRM&quot;)@ТЕРМИНАЛЫ@</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data><![CDATA[5@1@1@55@@@@1,1@1@@@@@^%ZAPM.ed.BSVOL("ACTFILE")@БАЗА ГРУППОВЫХ ОПЕРАЦИЙ С ФАЙЛАМИ (F6-DOS-FILE-...-F6)@]]></Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>6@1@1@55@@@@1,1@1@@@@@^%ZAPM.ed.BSVOL(&quot;UPGR&quot;)@КОНТРОЛЬНЫЕ СУММЫ ПРОГРАММ И МАССИВОВ@</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>7@1@1@55@@@@1,1@1@2;6;34;46@@@@^%ZAPM.ed.BSS(&quot;CMD&quot;)@МАКРОКОМАНДЫ %BS-КОМАНДЕРА@</Data>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>1</Sub>
<Data>8@1@1@55@@@@1,1@1@@@@@^%ZAPM.ed.BSS(&quot;FUN_ED&quot;)@ЗАРЕГИСТРИРОВАННЫЕ ФУНКЦИИ@</Data>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>1</Sub>
<Data>9@1@1@55@@@@1,1@1@@@@@^%ZAPM.ed.BSS(&quot;XECUTE&quot;)@КОМАНДЫ ВЫПОЛНЯЕМЫЕ ПО СОБЫТИЯМ@</Data>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>1</Sub>
<Data>10@1@1@55@@@@1,1@1@@@@@^%ZAPM.ed.BSdbf(&quot;StructDBF&quot;)@БАЗА ДАННЫХ СТРУКТУР DBF-ФАЙЛОВ@</Data>
</Node>
</Node>
<Node><Sub>11</Sub>
<Node><Sub>1</Sub>
<Data><![CDATA[11@1@1@55@@@@1,1@1@1;6;30;46@@@@^%ZAPM.ed.BSDDR("DDR")@ДИСПЕЧЕР ВВОДА ИНФОРМАЦИИ (СТАРАЯ-DDR Тимофеева)@]]></Data>
</Node>
</Node>
<Node><Sub>12</Sub>
<Node><Sub>1</Sub>
<Data><![CDATA[12@1@1@55@@@@1,1@1@1;6;30;46@@@@^%ZAPM.ed.BSDDR("DDRB")@БУФЕР ПРЕДРИТЕЛЬНОЙ ОБРАБОТКИ (СТАРАЯ-DDR Тимофеева)@]]></Data>
</Node>
</Node>
<Node><Sub>13</Sub>
<Node><Sub>1</Sub>
<Data>13@1@1@55@@@@1,1@1@2;6;30;46@@@@^%ZAPM.ed.BSMDDR(&quot;DDR&quot;)@ДИСПЕЧЕР ВВОДА ИНФОРМАЦИИ (НОВАЯ КОНЦЕПЦИЯ)@</Data>
</Node>
</Node>
<Node><Sub>14</Sub>
<Node><Sub>1</Sub>
<Data>14@1@1@55@@@@1,1@1@2;6;30;46@@@@^%ZAPM.ed.BSMDDR(&quot;BPO&quot;)@БУФЕР ПРЕДРИТЕЛЬНОЙ ОБРАБОТКИ@</Data>
</Node>
</Node>
<Node><Sub>15</Sub>
<Node><Sub>1</Sub>
<Data><![CDATA[15@1@1@55@@@@1,1@1@1;6;31;46@@@@^%ZAPM.ed.BSS("TRIGGER")@БАЗА ПЕРЕАДРЕСАЦИЯ МАССИВОВ БАЗ ДАННЫХ (ТРИГГЕР)@]]></Data>
</Node>
</Node>
<Node><Sub>16</Sub>
<Node><Sub>1</Sub>
<Data>16@1@1@55@@@@1,1@1@2;6;31;46@@@@^%ZAPM.ed.BSVOL(&quot;PROTOKOL&quot;)@СИСТЕМНЫЙ ПРОТОКОЛ@</Data>
</Node>
</Node>
<Node><Sub>17</Sub>
<Node><Sub>1</Sub>
<Data>17@1@1@55@@@@1,1@1@2;6;31;46@@@@^%ZAPM.ed.BSVOL(&quot;MainMenu&quot;)@ПУНКТЫ МЕНЮ ПОЛЬЗОВАТЕЛЕЙ@</Data>
</Node>
</Node>
<Node><Sub>CMD</Sub>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data><![CDATA[D:$ZV'["Cach" Table^%ZAPM.ed.BSN("^%ZAPM.ed.BSS","USER") D:$ZV["Cach" Table^%ZAPM.ed.BSN("^%ZAPM.ed.BSC","PROTECT")]]></Data>
</Node>
</Node>
</Node>
<Node><Sub>FTR</Sub>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>58503,52463,MS</Data>
</Node>
<Node><Sub>STA</Sub>
<Data>11,1@1@1@27@-1@-1@16@11@ДИСПЕЧЕР ВВОДА ИНФОРМАЦИИ (СТАРАЯ-DDR Тимофеева)</Data>
</Node>
</Node>
<Node><Sub>CopyTree</Sub>
<Data>БАЗА ДАННЫХ ПАРАМЕТРОВ ПРОКАЧЕК@@@@@1@1@1@1@22@80@1@@1@@@1@@@1@@@@@1@@@19@5@@@@@@@@@@@@@@1</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@13@1@@@@1@1;6;32;44@@@@@-------------</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@14@1@17@1@@@@1@1;6;32;44@@@@@--------- Откуда</Data>
</Node>
<Node><Sub>3</Sub>
<Data>1@31@1@3@1@@@@1@1;6;32;44@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>1@34@1@17@1@@@@1@1;6;32;44@@@@@ Куда  ----------</Data>
</Node>
<Node><Sub>5</Sub>
<Data>1@51@1@16@1@@@@1@1;6;32;44@@@@@----------------</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@13@1@@@@1@1;6;32;44@@@@@|        k0</Data>
</Node>
<Node><Sub>2</Sub>
<Data>2@14@1@17@@@@@1@2;6;30;46@@@@@@@@k0@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>2@31@1@3@1@@@@1@1;6;32;44@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>2@34@1@17@@@@@1@2;6;30;46@@@@@@@@v@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>2@51@1@16@1@@@@1@1;6;32;44@@@@@               |</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@13@1@@@@1@1;6;32;44@@@@@|</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@14@1@17@1@@@@1@1;6;32;44@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>3@31@1@3@1@@@@1@1;6;32;44@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>3@34@1@17@1@@@@1@1;6;32;44@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>3@51@1@16@1@@@@1@1;6;32;44@@@@@               |</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>4@1@1@13@1@@@@1@1;6;32;44@@@@@|        k1 </Data>
</Node>
<Node><Sub>2</Sub>
<Data>4@14@1@17@@@@@1@2;6;30;46@@@@@@@@p@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>4@31@1@3@1@@@@1@1;6;32;44@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>4@34@1@17@@@@@1@2;6;30;46@@@@@@@@t@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>4@51@1@16@1@@@@1@1;6;32;44@@@@@               |</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>5@1@1@13@1@@@@1@1;6;32;44@@@@@|</Data>
</Node>
<Node><Sub>2</Sub>
<Data>5@14@1@17@1@@@@1@1;6;32;44@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>5@31@1@3@1@@@@1@1;6;32;44@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>5@34@1@17@1@@@@1@1;6;32;44@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>5@51@1@16@1@@@@1@1;6;32;44@@@@@               |</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>6@1@1@13@1@@@@1@1;6;32;44@@@@@|        k2</Data>
</Node>
<Node><Sub>2</Sub>
<Data>6@14@1@17@@@@@1@2;6;30;46@@@@@@@@b@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>6@31@1@3@1@@@@1@1;6;32;44@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>6@34@1@17@@@@@1@2;6;30;46@@@@@@@@b1@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>6@51@1@16@1@@@@1@1;6;32;44@@@@@               |</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>7@1@1@13@1@@@@1@1;6;32;44@@@@@|</Data>
</Node>
<Node><Sub>2</Sub>
<Data>7@14@1@17@1@@@@1@1;6;32;44@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>7@31@1@3@1@@@@1@1;6;32;44@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>7@34@1@17@1@@@@1@1;6;32;44@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>7@51@1@16@1@@@@1@1;6;32;44@@@@@               |</Data>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>1</Sub>
<Data>8@1@1@13@1@@@@1@1;6;32;44@@@@@|        k3</Data>
</Node>
<Node><Sub>2</Sub>
<Data>8@14@1@17@@@@@1@2;6;30;46@@@@@@@@k@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>8@31@1@3@1@@@@1@1;6;32;44@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>8@34@1@17@@@@@1@2;6;30;46@@@@@@@@k1@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>8@51@1@16@1@@@@1@1;6;32;44@@@@@               |</Data>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>1</Sub>
<Data>9@1@1@13@1@@@@1@1;6;32;44@@@@@|</Data>
</Node>
<Node><Sub>2</Sub>
<Data>9@14@1@17@1@@@@1@1;6;32;44@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>9@31@1@3@1@@@@1@1;6;32;44@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>9@34@1@17@1@@@@1@1;6;32;44@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>9@51@1@16@1@@@@1@1;6;32;44@@@@@               |</Data>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>1</Sub>
<Data>10@1@1@13@1@@@@1@1;6;32;44@@@@@|        k4</Data>
</Node>
<Node><Sub>2</Sub>
<Data>10@14@1@17@@@@@1@2;6;30;46@@@@@@@@m@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>10@31@1@3@1@@@@1@1;6;32;44@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>10@34@1@17@@@@@1@2;6;30;46@@@@@@@@m1@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>10@51@1@16@1@@@@1@1;6;32;44@@@@@               |</Data>
</Node>
</Node>
<Node><Sub>11</Sub>
<Node><Sub>1</Sub>
<Data>11@1@1@13@1@@@@1@1;6;32;44@@@@@|</Data>
</Node>
<Node><Sub>2</Sub>
<Data>11@14@1@17@1@@@@1@1;6;32;44@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>11@31@1@3@1@@@@1@1;6;32;44@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>11@34@1@17@1@@@@1@1;6;32;44@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>11@51@1@16@1@@@@1@1;6;32;44@@@@@               |</Data>
</Node>
</Node>
<Node><Sub>12</Sub>
<Node><Sub>1</Sub>
<Data>12@1@1@13@1@@@@1@1;6;32;44@@@@@|        k5</Data>
</Node>
<Node><Sub>2</Sub>
<Data>12@14@1@17@@@@@1@2;6;30;46@@@@@@@@w@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>12@31@1@3@1@@@@1@1;6;32;44@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>12@34@1@17@@@@@1@2;6;30;46@@@@@@@@r@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>12@51@1@16@1@@@@1@1;6;32;44@@@@@               |</Data>
</Node>
</Node>
<Node><Sub>13</Sub>
<Node><Sub>1</Sub>
<Data>13@1@1@13@1@@@@1@1;6;32;44@@@@@|</Data>
</Node>
<Node><Sub>2</Sub>
<Data>13@14@1@17@1@@@@1@1;6;32;44@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>13@31@1@3@1@@@@1@1;6;32;44@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>13@34@1@17@1@@@@1@1;6;32;44@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>13@51@1@16@1@@@@1@1;6;32;44@@@@@               |</Data>
</Node>
</Node>
<Node><Sub>14</Sub>
<Node><Sub>1</Sub>
<Data>14@1@1@13@1@@@@1@1;6;32;44@@@@@|        k6</Data>
</Node>
<Node><Sub>2</Sub>
<Data>14@14@1@17@@@@@1@2;6;30;46@@@@@@@@sw@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>14@31@1@3@1@@@@1@1;6;32;44@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>14@34@1@17@@@@@1@2;6;30;46@@@@@@@@sr@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>14@51@1@16@1@@@@1@1;6;32;44@@@@@               |</Data>
</Node>
</Node>
<Node><Sub>15</Sub>
<Node><Sub>1</Sub>
<Data>15@1@1@13@1@@@@1@1;6;32;44@@@@@|</Data>
</Node>
<Node><Sub>2</Sub>
<Data>15@14@1@17@1@@@@1@1;6;32;44@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>15@31@1@3@1@@@@1@1;6;32;44@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>15@34@1@17@1@@@@1@1;6;32;44@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>15@51@1@16@1@@@@1@1;6;32;44@@@@@               |</Data>
</Node>
</Node>
<Node><Sub>16</Sub>
<Node><Sub>1</Sub>
<Data>16@1@1@13@1@@@@1@1;6;32;44@@@@@|        k7</Data>
</Node>
<Node><Sub>2</Sub>
<Data>16@14@1@17@@@@@1@2;6;30;46@@@@@@@@c@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>16@31@1@3@1@@@@1@1;6;32;44@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>16@34@1@17@@@@@1@2;6;30;46@@@@@@@@pro@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>16@51@1@16@1@@@@1@1;6;32;44@@@@@               |</Data>
</Node>
</Node>
<Node><Sub>17</Sub>
<Node><Sub>1</Sub>
<Data>17@1@1@13@1@@@@1@1;6;32;44@@@@@|</Data>
</Node>
<Node><Sub>2</Sub>
<Data>17@14@1@17@1@@@@1@1;6;32;44@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>17@31@1@3@1@@@@1@1;6;32;44@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>17@34@1@17@1@@@@1@1;6;32;44@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>17@51@1@16@1@@@@1@1;6;32;44@@@@@               |</Data>
</Node>
</Node>
<Node><Sub>18</Sub>
<Node><Sub>1</Sub>
<Data>18@1@1@13@1@@@@1@1;6;32;44@@@@@|        k8</Data>
</Node>
<Node><Sub>2</Sub>
<Data>18@14@1@17@@@@@1@2;6;30;46@@@@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>18@31@1@3@1@@@@1@1;6;32;44@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>18@34@1@17@@@@@1@2;6;30;46@@@@@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>18@51@1@16@1@@@@1@1;6;32;44@@@@@               |</Data>
</Node>
</Node>
<Node><Sub>19</Sub>
<Node><Sub>1</Sub>
<Data>19@1@1@13@1@@@@1@1;6;32;44@@@@@-------------</Data>
</Node>
<Node><Sub>2</Sub>
<Data>19@14@1@17@1@@@@1@1;6;32;44@@@@@-----------------</Data>
</Node>
<Node><Sub>3</Sub>
<Data>19@31@1@3@1@@@@1@1;6;32;44@@@@@---</Data>
</Node>
<Node><Sub>4</Sub>
<Data>19@34@1@17@1@@@@1@1;6;32;44@@@@@-----------------</Data>
</Node>
<Node><Sub>5</Sub>
<Data>19@51@1@16@1@@@@1@1;6;32;44@@@@@----------------</Data>
</Node>
</Node>
<Node><Sub>Free</Sub>
<Data>57901,51021</Data>
</Node>
<Node><Sub>LST</Sub>
<Data>57901,51047,MS</Data>
</Node>
<Node><Sub>STA</Sub>
<Data>8,4@1@1@27@-1@-1@8@34@</Data>
</Node>
</Node>
<Node><Sub>DATE</Sub>
<Data><![CDATA[>>>ПОДМЕНА СИСТЕМНОЙ ДАТЫ, ЕСЛИ В ОС ДАТА НЕ ВЕРНА@@@@@1@1@12@11@13@65@@@@@1@7@@@1@@@@@1@@@2@1@@2;6;30;46@@@1@@@@@@@MENU^%ZAPM.ed.BSF11]]></Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@55@@@@0@1@@@@@1,1@НЕ ДЕЛАТЬ ПОДМЕНУ СИСТЕМНОЙ ДАТЫ</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@55@@@@1,1@1@@@@@2,1@ПОДМЕНЯТЬ СИСТЕМНУЮ ДАТУ</Data>
</Node>
</Node>
<Node><Sub>CMD</Sub>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>D NODATE^%ZAPM.ed.BSre</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>D SYSDATE^%ZAPM.ed.BSre</Data>
</Node>
</Node>
</Node>
<Node><Sub>FTR</Sub>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>57584,54877,</Data>
</Node>
<Node><Sub>STA</Sub>
<Data>1,1@1@1@27@-1@-1@12@11@НЕ ДЕЛАТЬ ПОДМЕНУ СИСТЕМНОЙ ДАТЫ</Data>
</Node>
</Node>
<Node><Sub>INDEX</Sub>
<Data><![CDATA[ПУНКТЫ МЕНЮ ПОИСКОВОЙ БАЗЫ@@@@@1@1@1@1@22@80@1@@1@@@2@@2,2@1@@@@@1@@@4@2@@@@@@@@@@@@STRUKT^%ZAPM.ed.BSF10]]></Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@6@60@@@@0@1@2;6;31;46@@@@@       ДОПУСТИМЫЕ  АТРИБУТЫ </Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@61@6@19@@@@@1@2;6;30;46@@@@@                       ВЫЗОВ ЗАДАЧИ      ГЛАВНОГО МЕНЮ</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>7@1@2@60@@@@@1@2;6;30;42@@@@@ПОЛНАЯ ССЫЛКА НА ТАБЛИЦУ\ТЕКСТ ^[&quot;&quot;GLAVK&quot;&quot;]PARTITION(&quot;TABLE&quot;)@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>7@61@2@19@@@@@2@1;6;30;42@@@@@@@@USPT</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data><![CDATA[9@1@2@60@@@@@1@2;6;30;42@@@@@ МЕСТО ВЫЗОВА ТАБЛИЦЫ И КОМАНДЫ: Для Cache' ["NameSpace",""] 0-в системном                   Для MSM    ["UCI","VOL"]@]]></Data>
</Node>
<Node><Sub>2</Sub>
<Data>9@61@2@19@@@@@2@2;6;30;42@@@@@@@@NS</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>11@1@2@60@@@@@1@2;6;30;42@@@@@             КОМАНДА МSM или Cache&apos;@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>11@61@2@19@@@@@2@1;6;30;42@@@@@@@@CMD</Data>
</Node>
</Node>
<Node><Sub>FTR</Sub>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>S d1=&quot; МЕНЮ :&quot;_$G(k1)_&quot;,&quot;_$G(k2)_&quot;,&quot;_$G(k3)_&quot;,&quot;_$G(k4)_&quot;,&quot;_$G(k5)</Data>
<Node><Sub>1</Sub>
<Data>&quot; МЕНЮ :&quot;_$G(k1)_&quot;,&quot;_$G(k2)_&quot;,&quot;_$G(k3)_&quot;,&quot;_$G(k4)_&quot;,&quot;_$G(k5)</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>Free</Sub>
<Data>58127,36798</Data>
</Node>
<Node><Sub>KEY</Sub>
<Data>^%ZAPM.ed.BSindex</Data>
<Node><Sub>1</Sub>
<Data><![CDATA[@@@@ВВЕДИТЕ <F10> ДЛЯ ВЫХОДА С ВЫБОРОМ, - <ESC> - НАЗАД <ENTER> - ВПЕРЕД@1,70@^%ZAPM.ed.BSVOL("INDEXK")@@ 1-Й ИНДЕКСНЫЙ@2;6;30;42@@@@@Введите наименования Меню 1 уровня@@@@@]]></Data>
</Node>
<Node><Sub>2</Sub>
<Data><![CDATA[@@@@ВВЕДИТЕ <F10> ДЛЯ ВЫХОДА С ВЫБОРОМ, - <ESC> - НАЗАД <ENTER> - ВПЕРЕД@1,70@@@ 2-Й ИНДЕКСНЫЙ@2;6;37;44@@@@@Введите наименования Пункта Меню 2 уровня@@@@@]]></Data>
</Node>
<Node><Sub>3</Sub>
<Data><![CDATA[@@@@ВВЕДИТЕ <F10> ДЛЯ ВЫХОДА С ВЫБОРОМ, - <ESC> - НАЗАД <ENTER> - ВПЕРЕД@1,70@@@ 3-Й ИНДЕКСНЫЙ@1;6;37;44@@@@@Введите наименования Пункта Меню 3 уровня@@@@@]]></Data>
</Node>
<Node><Sub>4</Sub>
<Data><![CDATA[@@@@ВВЕДИТЕ <F10> ДЛЯ ВЫХОДА С ВЫБОРОМ, - <ESC> - НАЗАД <ENTER> - ВПЕРЕД@1,70@@@ 4-Й ИНДЕКСНЫЙ@1;6;31;45@@@@@Введите наименования Пункта Меню 4 уровня@@@@@]]></Data>
</Node>
<Node><Sub>5</Sub>
<Data><![CDATA[@@@@ВВЕДИТЕ <F10> ДЛЯ ВЫХОДА С ВЫБОРОМ, - <ESC> - НАЗАД <ENTER> - ВПЕРЕД@1,70@@@ 5-Й ИНДЕКСНЫЙ@1;6;33;43@@@@@Введите наименования Пункта Меню 5 уровня@@@@@]]></Data>
<Node><Sub>10</Sub>
<Data>Текст ,который появится в меню при организации выборки для выдачи СПИСКОВ и СВОДОК</Data>
<Node><Sub>1</Sub>
<Data><![CDATA[I 1 ;Формула вычисления для выборки. Например,ключ 2 это         дата и формула для выборки МАЯ-месяца будет такая :+$E(k2,3,4)=5]]></Data>
</Node>
<Node><Sub>2</Sub>
<Data><![CDATA[1 ;Формула вычисления для выборки. Например,ключ 2 это         дата и формула для выборки МАЯ-месяца будет такая :+$E(k2,3,4)=5]]></Data>
</Node>
</Node>
</Node>
<Node><Sub>6</Sub>
<Data><![CDATA[@@@@ВВЕДИТЕ <F10> ДЛЯ ВЫХОДА С ВЫБОРОМ, - <ESC> - НАЗАД <ENTER> - ВПЕРЕД@1,70@@@ 6-Й ИНДЕКСНЫЙ@@@@@@Введите наименования Пункта Меню 6 уровня@@@@@]]></Data>
</Node>
<Node><Sub>7</Sub>
<Data><![CDATA[@@@@ВВЕДИТЕ <F10> ДЛЯ ВЫХОДА С ВЫБОРОМ, - <ESC> - НАЗАД <ENTER> - ВПЕРЕД@1,70@@@ 7-Й ИНДЕКСНЫЙ@@@@@@Введите наименования Пункта Меню 7 уровня@@@@@]]></Data>
</Node>
<Node><Sub>8</Sub>
<Data><![CDATA[@@@@ВВЕДИТЕ <F10> ДЛЯ ВЫХОДА С ВЫБОРОМ, - <ESC> - НАЗАД <ENTER> - ВПЕРЕД@1,70@@@ 8-Й ИНДЕКСНЫЙ@@@@@@Введите наименования Пункта Меню 8 уровня@@@@@]]></Data>
</Node>
<Node><Sub>9</Sub>
<Data><![CDATA[@@@@ВВЕДИТЕ <F10> ДЛЯ ВЫХОДА С ВЫБОРОМ, - <ESC> - НАЗАД <ENTER> - ВПЕРЕД@1,70,TIME@@@ 9-Й ИНДЕКСНЫЙ@@@@@@Введите наименования Пункта Меню 9 уровня@@@@@]]></Data>
<Node><Sub>10</Sub>
<Data>Текст ,который появится в меню при организации выборки для выдачи СПИСКОВ и СВОДОК</Data>
<Node><Sub>1</Sub>
<Data><![CDATA[I 1 ;3 - ДИАПАЗОН, или Формула вычисления для выборки. Например,ключ 2 это дата и формула для выборки МАЯ-месяца будет такая :+$E(k2,3,4)=5]]></Data>
</Node>
<Node><Sub>2</Sub>
<Data><![CDATA[1 ;3 - ДИАПАЗОН, или Формула вычисления для выборки. Например,ключ 2 это дата и формула для выборки МАЯ-месяца будет такая :+$E(k2,3,4)=5]]></Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>58127,36798,MS</Data>
</Node>
<Node><Sub>STA</Sub>
<Data>4,2@2@2@-2@-2@-2@11@61@</Data>
</Node>
</Node>
<Node><Sub>INDEXK</Sub>
<Data><![CDATA[заготовка ДЛЯ КЛЮЧА по ИНДЕКСНОЙ БД@@@@@1@1@1@1@22@79@1@@1@1@@1@@@1@@@@@1@@@3@1@@2;6;34;46@@@@@@@@@1,4,0]]></Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@75@@@@@1@2;6;37;44@@@@@ .. Вернуться назад</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@75@@@@@1@2;6;30;45@@@@@ ВВЕДИТЕ &lt;F10&gt; ДЛЯ ВЫХОДА С ВЫБОРОМ, - &lt;ESC&gt; - НАЗАД &lt;ENTER&gt; - ВПЕРЕД</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@75@@@@@1@2;6;30;45@@@@@@</Data>
</Node>
</Node>
<Node><Sub>AF2</Sub>
<Data>^%ZAPM.ed.BSS,USERt</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data> Смена_пароля Смена_коментария @6@ @0@BLo,&quot;AF2&quot;,911@D CHPW^%ZAPM.ed.BSF12;D CHCM^%ZAPM.ed.BSF12@</Data>
</Node>
</Node>
<Node><Sub>911</Sub>
<Node><Sub>1</Sub>
<Data>Смена пароля для текущего пользователя</Data>
</Node>
<Node><Sub>2</Sub>
<Data>Смена коментария для текущего пользователя</Data>
</Node>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>58127,37133,MS</Data>
</Node>
<Node><Sub>STA</Sub>
<Data>1,1@1@1@13@-1@-1@1@1@ .. Вернуться назад</Data>
</Node>
</Node>
<Node><Sub>INDEXP</Sub>
<Data>ПАРАМЕТРЫ ИНДЕКСИРОВАНИЯ@@@@@1@1@1@1@22@80@1@@1@@@1@@@1@@@@@@@@17@2@@1;6;35;44@@@@@@</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@30@@@@@1@2;6;30;45@@@@@    ИНДЕКСИРОВАНИЕ ПОКАЗАТЕЛЯ</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@31@1@30@@@@@1@2;6;30;45@@@@@@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@30@@@@@1@2;6;30;46@@@@@             ИМЯ ИНДЕКСНОЙ БД</Data>
</Node>
<Node><Sub>2</Sub>
<Data>2@31@1@30@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@30@@@@@1@2;6;30;46@@@@@  ПЕРВЫЙ УРОВЕНЬ ИНДЕКСНОЙ БД@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@31@1@30@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>4@1@1@30@@@@@1@2;6;30;46@@@@@ФОРМИРОВАНИЕ ИНДЕКСОВ ПОТОКОМ@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>4@31@1@30@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>5@1@1@30@@@@@1@2;6;30;46@@@@@      УДАЛЕНИЕ ОДНОГО ИНДЕКСА@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>5@31@1@30@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>6@1@1@30@@@@@1@2;6;30;46@@@@@       ВСТАВКА ОДНОГО ИНДЕКСА@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>6@31@1@30@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>7@1@1@30@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>7@31@1@30@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>1</Sub>
<Data>8@1@1@30@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>8@31@1@30@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>1</Sub>
<Data>9@1@1@30@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>9@31@1@30@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>1</Sub>
<Data>10@1@1@30@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>10@31@1@30@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>11</Sub>
<Node><Sub>1</Sub>
<Data>11@1@1@30@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>11@31@1@30@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>12</Sub>
<Node><Sub>1</Sub>
<Data>12@1@1@30@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>12@31@1@30@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>13</Sub>
<Node><Sub>1</Sub>
<Data>13@1@1@30@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>13@31@1@30@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>14</Sub>
<Node><Sub>1</Sub>
<Data>14@1@1@30@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>14@31@1@30@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>15</Sub>
<Node><Sub>1</Sub>
<Data>15@1@1@30@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>15@31@1@30@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>16</Sub>
<Node><Sub>1</Sub>
<Data>16@1@1@30@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>16@31@1@30@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>17</Sub>
<Node><Sub>1</Sub>
<Data>17@1@1@30@@@@@1@2;6;30;46@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>17@31@1@30@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>58134,33649,MS</Data>
</Node>
<Node><Sub>STA</Sub>
<Data>2,1@1@1@27@-1@-1@2@1@             ИМЯ ИНДЕКСНОЙ БД</Data>
</Node>
</Node>
<Node><Sub>LISTBUF</Sub>
<Data><![CDATA[заготовка под перечень глобальных разделов@@@@@1@1@2@15@19@67@1@@1@@@1@@4,4@1@@@@@1@@@12@4@@1;6;37;44@@@@@@@2@^%ZAPM.ed.BSDDR("DDRPARMH")@@@@1]]></Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@2@1@25@@@@@1@@@@@@  Глобальные разделы (буфера@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>1@27@1@1@@@@@1@@@@@@е@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>1@28@1@25@1@@@@1@@@@@@ра обмена и вывода)@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>2@2@1@25@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>2@27@1@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>2@28@1@25@@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@2@1@25@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>3@27@1@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>3@28@1@25@1@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>4@1@2@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>4@2@2@25@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>4@27@2@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>4@28@2@25@@@@@1@2;6;34;46@@@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>6@1@1@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>6@2@1@25@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>6@27@1@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>6@28@1@25@1@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>7@1@2@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>7@2@2@25@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>7@27@2@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>7@28@2@25@@@@@1@2;6;34;46@@@@@@</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>9@1@1@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>9@2@1@25@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>9@27@1@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>9@28@1@25@1@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>1</Sub>
<Data>10@1@2@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>10@2@2@25@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>10@27@2@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>10@28@2@25@@@@@1@2;6;34;46@@@@@@</Data>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>1</Sub>
<Data>12@1@1@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>12@2@1@25@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>12@27@1@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>12@28@1@25@1@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>1</Sub>
<Data>13@1@2@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>13@2@2@25@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>13@27@2@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>13@28@2@25@@@@@1@2;6;34;46@@@@@@</Data>
</Node>
</Node>
<Node><Sub>11</Sub>
<Node><Sub>1</Sub>
<Data>15@1@1@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>15@2@1@25@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>15@27@1@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>15@28@1@25@1@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>12</Sub>
<Node><Sub>1</Sub>
<Data>16@1@2@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>16@2@2@25@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>16@27@2@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>16@28@2@25@@@@@1@2;6;34;46@@@@@@</Data>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>58024,51879,MS</Data>
</Node>
<Node><Sub>STA</Sub>
<Data>6,4@4@4@27@-1@-1@8@42@</Data>
</Node>
</Node>
<Node><Sub>MARK</Sub>
<Data><![CDATA[БАЗА ДАННЫХ ПОМЕТОК@@@@@1@1@1@1@22@80@1@@1@@@2@@2,2@1@@@@@@@@2@4@@1;6;35;44@@@@@@@@^%ZAPM.ed.BSVOL("MARKHELP")]]></Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@2@1@@@@@1@2;6;30;45@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@2@2@10@@@@@1@2;6;30;45@@@@@ строки@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>1@12@2@10@@@@@1@2;6;30;45@@@@@ колонки@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>1@22@2@55@@@@@1@2;6;30;45@@@@@ Команда IF на пометку клеток таблицы@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>3@1@5@1@@@@@2@2;6;30;46@@@@@@@@CMT</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@2@5@10@@@@@2@@@@@@@@@STR</Data>
</Node>
<Node><Sub>3</Sub>
<Data>3@12@5@10@@@@@2@2;6;30;46@@@@@@@@KOL@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>3@22@5@55@@@@@2@2;6;37;44@@@@@@@@CMD</Data>
</Node>
</Node>
<Node><Sub>Free</Sub>
<Data>59479,82874</Data>
</Node>
<Node><Sub>KEY</Sub>
<Data>^[&quot;GLAVK&quot;,&quot;&quot;]BSmark</Data>
<Node><Sub>1</Sub>
<Data><![CDATA[@@@@ВВОД НОВОЙ ПОМЕТКИ@1,70,TIME@@@ 1-Й ИНДЕКСНЫЙ@2;6;30;42@@@@@Введите новую выборку пометки таблицы@@@@@]]></Data>
<Node><Sub>3</Sub>
<Data>S d1=d</Data>
</Node>
<Node><Sub>4</Sub>
<Data>d</Data>
</Node>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>59479,82874,MSW</Data>
</Node>
<Node><Sub>STA</Sub>
<Data>2,2@2@2@27@-1@-1@3@2@</Data>
</Node>
</Node>
<Node><Sub>MARKHELP</Sub>
<Data>ПАРАМЕТРЫ БАЗЫ ПОМЕТОК@@@@@@@5@10@21@70@@@@1@@5@@@1@@@ 1@@@@@15@@@1;6;37;44//2;6;33;40@@@@@@@1</Data>
<Node><Sub>1</Sub>
<Data>В колонках &quot;строки&quot; и &quot;колонки&quot; можно поставить следующие</Data>
</Node>
<Node><Sub>2</Sub>
<Data>параметры:   (примеры)</Data>
</Node>
<Node><Sub>3</Sub>
<Data></Data>
</Node>
<Node><Sub>4</Sub>
<Data>23          - конкретная строка\колонка</Data>
</Node>
<Node><Sub>5</Sub>
<Data>1:2:34      - с 1 по 34 с шагом 2</Data>
</Node>
<Node><Sub>6</Sub>
<Data>3,7,9:1:se  - 3,7 и с 9 до последней строки</Data>
</Node>
<Node><Sub>7</Sub>
<Data>1,8,ke      - 1,8 и последняя колонка</Data>
</Node>
<Node><Sub>8</Sub>
<Data></Data>
</Node>
<Node><Sub>9</Sub>
<Data>В колонке команды IF надо ввести команду MUMPS.</Data>
</Node>
<Node><Sub>10</Sub>
<Data>Если результат будет ИСТИНА то клетка помечается в БЛОК</Data>
</Node>
<Node><Sub>11</Sub>
<Data></Data>
</Node>
<Node><Sub>12</Sub>
<Data>Можно оперировать переменными: </Data>
</Node>
<Node><Sub>13</Sub>
<Data>ny       - текущая строка</Data>
</Node>
<Node><Sub>14</Sub>
<Data>nx       - текущая колонка</Data>
</Node>
<Node><Sub>15</Sub>
<Data>d        - данные текущей клетки</Data>
</Node>
</Node>
<Node><Sub>MENU</Sub>
<Data><![CDATA[                         >>>МОНИТОР ПРОКАЧЕК@@1@@@1@1@12@11@15@65@@@@@1@7@@@1@@@@@1@@@3@1@@2;6;30;46@@@1@@@@@@@MENU^%ZAPM.ed.BSF11]]></Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@55@@@@0@1@@@@@^%ZAPM.ed.BSVOL(&quot;PARAM&quot;)@ОПРЕДЕЛЕНИЕ ПАРАМЕТРОВ ПРОКАЧКИ</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@55@@@@0@1@@@@@2,1@ЗАПУСТИТЬ ПРОКАЧКУ</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@55@@@@1,1@1@@@@@3,1@ДИАГНОСТИКА ТОМА НА ССЫЛКИ@</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>4@1@1@55@@@@0@1@1;6;35;46@@@@4,1@!!! УДАЛЕНИЕ ИНФОРМАЦИИ В БАЗАХ ДАННЫХ !!!@</Data>
</Node>
</Node>
<Node><Sub>CMD</Sub>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>D START^%ZAPM.ed.BSVOL</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>D Diag^%ZAPM.ed.BSGLOB</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>D KBD^%ZAPM.ed.BSGLOB</Data>
</Node>
</Node>
</Node>
<Node><Sub>FTR</Sub>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>57794,65876,</Data>
</Node>
<Node><Sub>STA</Sub>
<Data>2,1@1@1@27@-1@-1@13@11@ЗАПУСТИТЬ ПРОКАЧКУ</Data>
</Node>
<Node><Sub>USM</Sub>
<Data>48@2;6;30;46</Data>
</Node>
</Node>
<Node><Sub>MainMenu</Sub>
<Data>ПУНКТЫ МЕНЮ ДЛЯ ПОЛЬЗОВАТЕЛЕЙ@@@@@1@1@1@1@22@80@1@@1@@@2@@2,2@1@@@@@1@@@4@2@@@@@@@@@@@@</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@6@60@@@@0@1@2;6;31;46@@@@@       ДОПУСТИМЫЕ  АТРИБУТЫ </Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@61@6@19@@@@@1@2;6;30;46@@@@@                       ВЫЗОВ ЗАДАЧИ      ГЛАВНОГО МЕНЮ</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>7@1@2@60@@@@@1@2;6;30;42@@@@@ПОЛНАЯ ССЫЛКА НА ТАБЛИЦУ\ТЕКСТ ^[&quot;&quot;GLAVK&quot;&quot;]PARTITION(&quot;TABLE&quot;)@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>7@61@2@19@@@@@2@1;6;30;42@@@@@@@@USPT</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data><![CDATA[9@1@2@60@@@@@1@2;6;30;42@@@@@ МЕСТО ВЫЗОВА ТАБЛИЦЫ И КОМАНДЫ: Для Cache' ["NameSpace",""] 0-в системном                   Для MSM    ["UCI","VOL"]@]]></Data>
</Node>
<Node><Sub>2</Sub>
<Data>9@61@2@19@@@@@2@2;6;30;42@@@@@@@@NS</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>11@1@2@60@@@@@1@2;6;30;42@@@@@             КОМАНДА МSM или Cache&apos;@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>11@61@2@19@@@@@2@1;6;30;42@@@@@@@@CMD</Data>
</Node>
</Node>
<Node><Sub>FTR</Sub>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>S d1=&quot; МЕНЮ :&quot;_$G(k1)_&quot;,&quot;_$G(k2)_&quot;,&quot;_$G(k3)_&quot;,&quot;_$G(k4)_&quot;,&quot;_$G(k5)</Data>
<Node><Sub>1</Sub>
<Data>&quot; МЕНЮ :&quot;_$G(k1)_&quot;,&quot;_$G(k2)_&quot;,&quot;_$G(k3)_&quot;,&quot;_$G(k4)_&quot;,&quot;_$G(k5)</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>Free</Sub>
<Data>58093,49278</Data>
</Node>
<Node><Sub>KEY</Sub>
<Data>^[&quot;GLAVK&quot;]BSMMenu</Data>
<Node><Sub>1</Sub>
<Data><![CDATA[@@@@ВВОД НОВОГО ПУНКТА МЕНЮ@1,70@@@ 1-Й ИНДЕКСНЫЙ@2;6;30;42@@@@@Введите наименования Меню 1 уровня@@@@@]]></Data>
</Node>
<Node><Sub>2</Sub>
<Data><![CDATA[@@@@ВВОД НОВОГО ПУНКТА МЕНЮ@1,70@@@ 2-Й ИНДЕКСНЫЙ@2;6;37;44@@@@@Введите наименования Пункта Меню 2 уровня (Если пункта нет, то *)@@@@@]]></Data>
</Node>
<Node><Sub>3</Sub>
<Data><![CDATA[@@@@ВВОД НОВОГО ПУНКТА МЕНЮ@1,70@@@ 3-Й ИНДЕКСНЫЙ@1;6;37;44@@@@@Введите наименования Пункта Меню 3 уровня (Если пункта нет, то *)@@@@@]]></Data>
</Node>
<Node><Sub>4</Sub>
<Data><![CDATA[@@@@ВВОД НОВОГО ПУНКТА МЕНЮ@1,70@@@ 4-Й ИНДЕКСНЫЙ@1;6;31;45@@@@@Введите наименования Пункта Меню 4 уровня (Если пункта нет, то *)@@@@@]]></Data>
</Node>
<Node><Sub>5</Sub>
<Data><![CDATA[@@@@ВВОД НОВОГО ПУНКТА МЕНЮ@1,70,TIME@@@ 5-Й ИНДЕКСНЫЙ@1;6;33;43@@@@@Введите наименования Пункта Меню 5 уровня (Если пункта нет, то *)@@@@@]]></Data>
<Node><Sub>10</Sub>
<Data>Текст ,который появится в меню при организации выборки для выдачи СПИСКОВ и СВОДОК</Data>
<Node><Sub>1</Sub>
<Data><![CDATA[I 1 ;Формула вычисления для выборки. Например,ключ 2 это         дата и формула для выборки МАЯ-месяца будет такая :+$E(k2,3,4)=5]]></Data>
</Node>
<Node><Sub>2</Sub>
<Data><![CDATA[1 ;Формула вычисления для выборки. Например,ключ 2 это         дата и формула для выборки МАЯ-месяца будет такая :+$E(k2,3,4)=5]]></Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>58093,49278,MS</Data>
</Node>
<Node><Sub>STA</Sub>
<Data>2,2@2@2@27@-1@-1@7@61@</Data>
</Node>
</Node>
<Node><Sub>MenuPatt</Sub>
<Data>ШАБЛОН ДЛЯ МЕНЮ@@@@@1@1@1@1@22@80@@1@@@1@1@@3,1@1@@@@@@@@4@1@@2;6;30;45@@@@@@</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@77@@@@0@1@2;6;30;43@@@@@SSSSSSSS</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@77@@@@0@1@2;6;30;43@@@@@ASAS@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@77@@@@0@1@2;6;34;46@@@@@ .. назад &lt;Esc&gt;, выбрать пункт меню &lt;Enter&gt;, спецрежимы &lt;Alt-F2&gt;@</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>4@1@1@77@@@@3,1@1@2;6;30;46@@@@@@</Data>
</Node>
</Node>
<Node><Sub>FTR</Sub>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(&quot; %BS ver.&quot;_$G(^%ZAPM.ed.BS)_&quot; in &quot;_$ZV)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(&quot; %BS ver.&quot;_$G(^%ZAPM.ed.BS)_&quot; in &quot;_$ZV)</Data>
</Node>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data><![CDATA[S d1=$$CENTR^%ZAPM.ed.BSsFUNM($TR($J("",$G(MLevel))," ","<")_" Сегодня :"_$$WEEKEND^%ZAPM.ed.BSsFUNR(1,$$h^%ZAPM.ed.BS3())_",  "_$$ESDAY^%ZAPM.ed.BSsFUNR(8,$$h^%ZAPM.ed.BS3())_", Пользователь :"_$G(%BS(12),"?"))]]></Data>
<Node><Sub>1</Sub>
<Data><![CDATA[$$CENTR($TR($J("",$G(MLevel))," ","<")_" Сегодня :"_$$WEEKEND^%ZAPM.ed.BSsFUNR(1,$$h^%ZAPM.ed.BS3())_",  "_$$ESDAY^%ZAPM.ed.BSsFUNR(8,$$h^%ZAPM.ed.BS3())_", Пользователь :"_$G(%BS(12),"?"))]]></Data>
</Node>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>S d1=&quot; &quot;_d</Data>
<Node><Sub>1</Sub>
<Data>&quot; &quot;_d</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>58069,59376,MS</Data>
</Node>
<Node><Sub>PRN</Sub>
<Data>1#0#0#0#1#1#0</Data>
</Node>
<Node><Sub>STA</Sub>
<Data>3,1@3@1@27@-1@-1@3@1@ .. назад &lt;Esc&gt;, выбрать пункт меню &lt;Enter&gt;, спецрежимы &lt;Alt-F2&gt;</Data>
</Node>
</Node>
<Node><Sub>OUTCARD</Sub>
<Data>ШАБЛОН ДЛЯ КАРТЫ ВЫВОДА !!!@@@@@1@1@1@1@22@80@1@@1@1@@1@@@1@@@@@@@@2@2@@2;6;37;44@@@@@@@@</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@3@20@@@@@1@@@@@@    КАРТА ВЫВОДА          ТАБЛИЦЫ@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@21@3@15@@@@0@1@2;6;30;45@@@@@@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>4@1@2@20@@@@0@1@2;6;30;46@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>4@21@2@15@@@@@1@1;6;32;44@@@@@@</Data>
</Node>
</Node>
<Node><Sub>FTR</Sub>
<Node><Sub>1</Sub>
<Node><Sub>2</Sub>
<Data>S d1=&quot;    Колонки                   &quot;_d</Data>
<Node><Sub>1</Sub>
<Data>&quot;    Колонки                   &quot;_d</Data>
</Node>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>S d1=&quot;     Строки         &quot;_d</Data>
<Node><Sub>1</Sub>
<Data>&quot;     Строки         &quot;_d</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>STA</Sub>
<Data>2,2@1@1@13@-1@-1@4@21@</Data>
</Node>
</Node>
<Node><Sub>PACK</Sub>
<Data><![CDATA[ПАКЕТНЫЙ РЕЖИМ !!!@@1@@@1@1@10@11@15@65@@@@@1@7@@@1@@@@@1@@@6@1@@2;6;30;46@@@1@@@@@@@MENU^%ZAPM.ed.BSF11]]></Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@55@@@@0@1@2;6;30;46@@@@1,1@1.ЗАПУСК ПАКЕТОВ НА ВЫПОЛНЕНИЕ</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@55@@@@1,1@1@2;6;30;46@@@@2,1@2.ФОРМИРОВАНИЕ БУФЕРОВ ДЛЯ ПЕЧАТИ</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@55@@@@1,1@1@2;6;30;46@@@@3,1@3.ПЕЧАТЬ СФОРМИРОВАННЫХ БУФЕРОВ@</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>4@1@1@55@@@@1,1@1@@@@@4,1@ЧИСТКА БУФЕРОВ ПЕЧАТИ@</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>5@1@1@55@@@@1,1@1@1;6;36;46@@@@^%ZAPM.ed.BSVOL(&quot;PACKET&quot;)@РЕДАКТИРОВАНИЕ ПАКЕТОВ ЗАПРОСОВ@</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>6@1@1@55@@@@1,1@1@2;6;30;46@@@@6,1@ВЫПОЛНИТЬ ПОСЛЕДОВАТЕЛЬНО 1.2.3. ПУНКТ@</Data>
</Node>
</Node>
<Node><Sub>CMD</Sub>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>D START^%ZAPM.ed.BSPK</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>D FBP^%ZAPM.ed.BSPK</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>D PBP^%ZAPM.ed.BSPK</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>D CLEARBUF^%ZAPM.ed.BSPK</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>D PACKET^%ZAPM.ed.BSPK</Data>
</Node>
</Node>
</Node>
<Node><Sub>FTR</Sub>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>STA</Sub>
<Data>6,1@1@1@27@-1@-1@15@11@ВЫПОЛНИТЬ ПОСЛЕДОВАТЕЛЬНО 1.2.3. ПУНКТ</Data>
</Node>
<Node><Sub>USM</Sub>
<Data>48@2;6;30;46</Data>
</Node>
</Node>
<Node><Sub>PACKBUT</Sub>
<Data>@@1@@@1@1@1@1@22@80@1@@1@1@@8@@@1@@@@@@@@3@3@@2;6;37;44@@@@@@@@^%ZAPM.ed.BSHLP(&quot;HELP-ALTF2&quot;)</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@10@@@@@1@@@@@@        Выберите тип запуска запроса@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@11@1@10@@@@@1@1;6;32;44@@@@@ЛОКАЛЬНЫЙ ЗАПУСК@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>1@21@1@10@@@@@1@@@@@@Q@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@10@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>2@11@1@10@@@@@1@2;6;30;45@@@@@ФОНОВЫЙ ЛОКАЛЬНЫЙ@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>2@21@1@10@@@@@1@@@@@@F@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@10@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@11@1@10@@@@@1@1;6;32;44@@@@@ФОНОВЫЙ НА М-СЕРВЕРЕ@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>3@21@1@10@@@@@1@@@@@@R@</Data>
</Node>
</Node>
<Node><Sub>BUT</Sub>
<Data>/2;6;37;44</Data>
<Node><Sub>0</Sub>
<Data>2;6;37;44</Data>
<Node><Sub>1</Sub>
<Data>        Выберите тип запуска запроса</Data>
</Node>
</Node>
<Node><Sub>1</Sub>
<Data>1;6;32;44/2;6;30;45</Data>
<Node><Sub>1</Sub>
<Data>ЛОКАЛЬНЫЙ ЗАПУСК</Data>
</Node>
<Node><Sub>2</Sub>
<Data>ФОНОВЫЙ ЛОКАЛЬНЫЙ</Data>
</Node>
<Node><Sub>3</Sub>
<Data>ФОНОВЫЙ НА М-СЕРВЕРЕ</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>Q</Data>
</Node>
<Node><Sub>2</Sub>
<Data>F</Data>
</Node>
<Node><Sub>3</Sub>
<Data>R</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>0</Data>
</Node>
<Node><Sub>2</Sub>
<Data>0</Data>
</Node>
</Node>
</Node>
<Node><Sub>STA</Sub>
<Data>1,1@1@1@13@-1@-1@1@1@        Выберите тип запуска запроса</Data>
</Node>
</Node>
<Node><Sub>PACKET</Sub>
<Data>ПАКЕТ ЗАПРОСОВ !!!@@@@@1@1@1@1@22@80@1@@1@@@2@@4,2@1@@@@@1@@@7@2@@@@@@@@@@@@@@@@@@@@1</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@2@25@@@@@1@2;6;35;42@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@26@2@53@@@@0@1@2;6;35;42@@@@@@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>3@1@2@25@@@@@1@2;6;35;42@@@@@Коментарий</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@26@2@53@@@@@2@2;6;31;46@@@@@@@@K</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>5@1@2@25@@@@@1@2;6;30;42@@@@@Имя ЗАПРОСА</Data>
</Node>
<Node><Sub>2</Sub>
<Data>5@26@2@53@@@@@2@2;6;30;46@@@@@@@@N</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>7@1@2@25@@@@@1@2;6;30;42@@@@@^[&quot;GLAVK&quot;]РАЗДЕЛ,ТОС@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>7@26@2@53@@@@@2@2;6;30;46@@@@4,2@@@@PT</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>9@1@2@25@@@@0@2@1;6;30;42@@@@@@@@TZ</Data>
</Node>
<Node><Sub>2</Sub>
<Data>9@26@2@53@@@@@2@2;6;34;46@@@@5,2@@@@TT</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>11@1@2@25@@@@0@2@1;6;30;42@@@@@@@@TB</Data>
</Node>
<Node><Sub>2</Sub>
<Data>11@26@2@53@@@@@2@2;6;34;46@@@@@@@@BP</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>13@1@2@25@@@@0@2@1;6;30;42@@@@@@@@TP</Data>
</Node>
<Node><Sub>2</Sub>
<Data>13@26@2@53@@@@0@2@2;6;34;46@@@@^%ZAPM.ed.BSVOL(&quot;YES&quot;)@@@@ST</Data>
</Node>
</Node>
<Node><Sub>CMD</Sub>
<Node><Sub>4</Sub>
<Node><Sub>2</Sub>
<Data>D CellTab^%ZAPM.ed.BSMDDR2(&quot;PT&quot;,1)</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>2</Sub>
<Data>D CellTab^%ZAPM.ed.BSMDDR2(&quot;TT&quot;,1)</Data>
</Node>
</Node>
</Node>
<Node><Sub>FTR</Sub>
<Node><Sub>1</Sub>
<Node><Sub>2</Sub>
<Data>S d1=&quot;      ПАКЕТ &apos;&quot;_$G(k1)_&quot;&apos;, ЗАПРОС НОМЕР &quot;_$G(k2)</Data>
<Node><Sub>1</Sub>
<Data>&quot;      ПАКЕТ &apos;&quot;_$G(k1)_&quot;&apos;, ЗАПРОС НОМЕР &quot;_$G(k2)</Data>
</Node>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>S d1=&quot; Считался ЗАПРОС &quot;_d</Data>
<Node><Sub>1</Sub>
<Data>&quot; Считался ЗАПРОС &quot;_d</Data>
</Node>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>S d1=&quot; Считался БУФЕР &quot;_d</Data>
<Node><Sub>1</Sub>
<Data>&quot; Считался БУФЕР &quot;_d</Data>
</Node>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>S d1=&quot; Время ПЕЧАТИ &quot;_d</Data>
<Node><Sub>1</Sub>
<Data>&quot; Время ПЕЧАТИ &quot;_d</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Data>S d1=&quot;ЗАПРОС &quot;_$S(d:&quot;ВКЛЮЧЕН НА ОБРАБОТКУ&quot;,1:&quot;ВЫКЛЮЧЕН&quot;)</Data>
<Node><Sub>1</Sub>
<Data>&quot;ЗАПРОС &quot;_$S(d:&quot;ВКЛЮЧЕН НА ОБРАБОТКУ&quot;,1:&quot;ВЫКЛЮЧЕН&quot;)</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>Free</Sub>
<Data>57219,47644</Data>
</Node>
<Node><Sub>KEY</Sub>
<Data>^%ZAPM.ed.BSpack</Data>
<Node><Sub>1</Sub>
<Data>@@@@НОВЫЙ ПАКЕТ@1,60@@@ 1-Й ИНДЕКСНЫЙ@2;6;30;42@@@@@Введите ИМЯ или НОМЕР ПАКЕТА@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>@@@@НОВЫЙ ЗАПРОС@1,60@@@ 2-Й ИНДЕКСНЫЙ@2;6;37;44@@@@@Введите НОМЕР ЗАПРОСА В ПАКЕТЕ@@@@@</Data>
<Node><Sub>3</Sub>
<Data><![CDATA[S d1=d_$TR($J("",10-$L(d))," ",".")_$$A^%ZAPM.ed.BSA(2,2,"PACKET","%BSVOL","","","",$G(%KEYS(1),"?"),$G(d,0))]]></Data>
</Node>
<Node><Sub>4</Sub>
<Data>d_$TR($J(&quot;&quot;,10-$L(d)),&quot; &quot;,&quot;.&quot;)_{2,2,&quot;PACKET&quot;,&quot;%BSVOL&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;,$G(%KEYS(1),&quot;?&quot;),$G(d,0)}</Data>
</Node>
</Node>
</Node>
<Node><Sub>STA</Sub>
<Data>4,2@4@2@27@-1@-1@7@26@</Data>
</Node>
</Node>
<Node><Sub>PARAM</Sub>
<Data>БАЗА ДАННЫХ ПАРАМЕТРОВ ПРОКАЧЕК@@1@@@1@1@1@1@22@80@1@@1@@@2@@@1@@@@@1@@@20@5@@@@@@@@@@@@@@1</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@13@1@@@@1@1;6;32;44@@@@@-------------</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@14@1@17@1@@@@1@1;6;32;44@@@@@--------- область</Data>
</Node>
<Node><Sub>3</Sub>
<Data>1@31@1@3@1@@@@1@1;6;32;44@@@@@ де</Data>
</Node>
<Node><Sub>4</Sub>
<Data>1@34@1@17@1@@@@1@1;6;32;44@@@@@йствия ----------</Data>
</Node>
<Node><Sub>5</Sub>
<Data>1@51@1@16@1@@@@1@1;6;32;44@@@@@----------------</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@13@1@@@@1@1;6;32;44@@@@@|     кип(u)</Data>
</Node>
<Node><Sub>2</Sub>
<Data>2@14@1@17@@@@@2@2;6;30;46@@@@@@0@@u</Data>
</Node>
<Node><Sub>3</Sub>
<Data>2@31@1@3@1@@@@1@1;6;32;44@@@@@ ,</Data>
</Node>
<Node><Sub>4</Sub>
<Data>2@34@1@17@@@@@2@2;6;30;46@@@@@@0@@v</Data>
</Node>
<Node><Sub>5</Sub>
<Data>2@51@1@16@1@@@@1@1;6;32;44@@@@@ том(v)        |</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@13@1@@@@1@1;6;32;44@@@@@|</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@14@1@17@1@@@@1@1;6;32;44@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>3@31@1@3@1@@@@1@1;6;32;44@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>3@34@1@17@1@@@@1@1;6;32;44@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>3@51@1@16@1@@@@1@1;6;32;44@@@@@               |</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>4@1@1@13@1@@@@1@1;6;32;44@@@@@| разделы(p)</Data>
</Node>
<Node><Sub>2</Sub>
<Data>4@14@1@17@@@@@2@2;6;30;46@@@@@@@@p@@^%ZAPM.ed.BSVOL(&quot;u&quot;)</Data>
</Node>
<Node><Sub>3</Sub>
<Data>4@31@1@3@1@@@@1@1;6;32;44@@@@@ -</Data>
</Node>
<Node><Sub>4</Sub>
<Data>4@34@1@17@@@@@2@2;6;30;46@@@@@@@@t@@^%ZAPM.ed.BSVOL(&quot;t&quot;)</Data>
</Node>
<Node><Sub>5</Sub>
<Data>4@51@1@16@1@@@@1@1;6;32;44@@@@@ таблица (t)   |</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>5@1@1@13@1@@@@1@1;6;32;44@@@@@|</Data>
</Node>
<Node><Sub>2</Sub>
<Data>5@14@1@17@1@@@@1@1;6;32;44@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>5@31@1@3@1@@@@1@1;6;32;44@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>5@34@1@17@1@@@@1@1;6;32;44@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>5@51@1@16@1@@@@1@1;6;32;44@@@@@               |</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>6@1@1@13@1@@@@1@1;6;32;44@@@@@|    базы(b)</Data>
</Node>
<Node><Sub>2</Sub>
<Data>6@14@1@17@@@@@2@2;6;30;46@@@@@@@@b@@^%ZAPM.ed.BSVOL(&quot;b&quot;)</Data>
</Node>
<Node><Sub>3</Sub>
<Data>6@31@1@3@1@@@@1@1;6;32;44@@@@@ -</Data>
</Node>
<Node><Sub>4</Sub>
<Data>6@34@1@17@@@@@2@2;6;30;46@@1@@@@@@b1</Data>
</Node>
<Node><Sub>5</Sub>
<Data>6@51@1@16@1@@@@1@1;6;32;44@@@@@ уровни(b1,...)|</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>7@1@1@13@1@@@@1@1;6;32;44@@@@@|</Data>
</Node>
<Node><Sub>2</Sub>
<Data>7@14@1@17@1@@@@1@1;6;32;44@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>7@31@1@3@1@@@@1@1;6;32;44@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>7@34@1@17@1@@@@1@1;6;32;44@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>7@51@1@16@1@@@@1@1;6;32;44@@@@@               |</Data>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>1</Sub>
<Data>8@1@1@13@1@@@@1@1;6;32;44@@@@@|  кодиф.(k)</Data>
</Node>
<Node><Sub>2</Sub>
<Data>8@14@1@17@@@@@2@2;6;30;46@@@@@@@@k@@^%ZAPM.ed.BSVOL(&quot;k&quot;)</Data>
</Node>
<Node><Sub>3</Sub>
<Data>8@31@1@3@1@@@@1@1;6;32;44@@@@@ -</Data>
</Node>
<Node><Sub>4</Sub>
<Data>8@34@1@17@@@@@2@2;6;30;46@@1@@@@@@k1</Data>
</Node>
<Node><Sub>5</Sub>
<Data>8@51@1@16@1@@@@1@1;6;32;44@@@@@ уровень(k1,k2)|</Data>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>1</Sub>
<Data>9@1@1@13@1@@@@1@1;6;32;44@@@@@|</Data>
</Node>
<Node><Sub>2</Sub>
<Data>9@14@1@17@1@@@@1@1;6;32;44@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>9@31@1@3@1@@@@1@1;6;32;44@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>9@34@1@17@1@@@@1@1;6;32;44@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>9@51@1@16@1@@@@1@1;6;32;44@@@@@               |</Data>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>1</Sub>
<Data>10@1@1@13@1@@@@1@1;6;32;44@@@@@| массивы(i)</Data>
</Node>
<Node><Sub>2</Sub>
<Data>10@14@1@17@@@@@2@2;6;30;46@@@@@@@@m@@^%ZAPM.ed.BSVOL(&quot;m&quot;)</Data>
</Node>
<Node><Sub>3</Sub>
<Data>10@31@1@3@1@@@@1@1;6;32;44@@@@@ -</Data>
</Node>
<Node><Sub>4</Sub>
<Data>10@34@1@17@@@@@2@2;6;30;46@@1@@@@@@m1</Data>
</Node>
<Node><Sub>5</Sub>
<Data>10@51@1@16@1@@@@1@1;6;32;44@@@@@ уровни(m1,...)|</Data>
</Node>
</Node>
<Node><Sub>11</Sub>
<Node><Sub>1</Sub>
<Data>11@1@1@13@1@@@@1@1;6;32;44@@@@@-------------</Data>
</Node>
<Node><Sub>2</Sub>
<Data>11@14@1@17@1@@@@1@1;6;32;44@@@@@-----------------</Data>
</Node>
<Node><Sub>3</Sub>
<Data>11@31@1@3@1@@@@1@1;6;32;44@@@@@---</Data>
</Node>
<Node><Sub>4</Sub>
<Data>11@34@1@17@1@@@@1@1;6;32;44@@@@@-----------------</Data>
</Node>
<Node><Sub>5</Sub>
<Data>11@51@1@16@1@@@@1@1;6;32;44@@@@@----------------</Data>
</Node>
</Node>
<Node><Sub>12</Sub>
<Node><Sub>1</Sub>
<Data>12@1@1@13@1@@@@1@1;6;32;44@@@@@-------------</Data>
</Node>
<Node><Sub>2</Sub>
<Data>12@14@1@17@1@@@@1@1;6;32;44@@@@@--------- пункты</Data>
</Node>
<Node><Sub>3</Sub>
<Data>12@31@1@3@1@@@@1@1;6;32;44@@@@@ де</Data>
</Node>
<Node><Sub>4</Sub>
<Data>12@34@1@17@1@@@@1@1;6;32;44@@@@@йствия ----------</Data>
</Node>
<Node><Sub>5</Sub>
<Data>12@51@1@16@1@@@@1@1;6;32;44@@@@@----------------</Data>
</Node>
</Node>
<Node><Sub>13</Sub>
<Node><Sub>1</Sub>
<Data>13@1@1@13@1@@@@1@1;6;32;44@@@@@|что заменять</Data>
</Node>
<Node><Sub>2</Sub>
<Data>13@14@1@17@@@@@2@2;6;30;46@@@@@@@@w</Data>
</Node>
<Node><Sub>3</Sub>
<Data>13@31@1@3@1@@@@1@1;6;32;44@@@@@ .</Data>
</Node>
<Node><Sub>4</Sub>
<Data>13@34@1@17@@@@@2@2;6;30;46@@@@@@@@r</Data>
</Node>
<Node><Sub>5</Sub>
<Data>13@51@1@16@1@@@@1@1;6;32;44@@@@@ на что замена |</Data>
</Node>
</Node>
<Node><Sub>14</Sub>
<Node><Sub>1</Sub>
<Data>14@1@1@13@1@@@@1@1;6;32;44@@@@@|</Data>
</Node>
<Node><Sub>2</Sub>
<Data>14@14@1@17@1@@@@1@1;6;32;44@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>14@31@1@3@1@@@@1@1;6;32;44@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>14@34@1@17@1@@@@1@1;6;32;44@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>14@51@1@16@1@@@@1@1;6;32;44@@@@@               |</Data>
</Node>
</Node>
<Node><Sub>15</Sub>
<Node><Sub>1</Sub>
<Data>15@1@1@13@1@@@@1@1;6;32;44@@@@@|ссылка &quot;что&quot;</Data>
</Node>
<Node><Sub>2</Sub>
<Data>15@14@1@17@@@@@2@2;6;30;46@@@@@@@@sw</Data>
</Node>
<Node><Sub>3</Sub>
<Data>15@31@1@3@1@@@@1@1;6;32;44@@@@@ .</Data>
</Node>
<Node><Sub>4</Sub>
<Data>15@34@1@17@@@@@2@2;6;30;46@@@@@@@@sr</Data>
</Node>
<Node><Sub>5</Sub>
<Data>15@51@1@16@1@@@@1@1;6;32;44@@@@@ссылка &quot;на что&quot;|</Data>
</Node>
</Node>
<Node><Sub>16</Sub>
<Node><Sub>1</Sub>
<Data>16@1@1@13@1@@@@1@1;6;32;44@@@@@|</Data>
</Node>
<Node><Sub>2</Sub>
<Data>16@14@1@17@1@@@@1@1;6;32;44@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>16@31@1@3@1@@@@1@1;6;32;44@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>16@34@1@17@1@@@@1@1;6;32;44@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>16@51@1@16@1@@@@1@1;6;32;44@@@@@               |</Data>
</Node>
</Node>
<Node><Sub>17</Sub>
<Node><Sub>1</Sub>
<Data>17@1@1@13@1@@@@1@1;6;32;44@@@@@|команда с g</Data>
</Node>
<Node><Sub>2</Sub>
<Data>17@14@1@17@@@@@2@2;6;30;46@@@@@@@@c</Data>
</Node>
<Node><Sub>3</Sub>
<Data>17@31@1@3@1@@@@1@1;6;32;44@@@@@ -</Data>
</Node>
<Node><Sub>4</Sub>
<Data>17@34@1@17@@@@@2@2;6;30;46@@@@@@@@pro</Data>
</Node>
<Node><Sub>5</Sub>
<Data>17@51@1@16@1@@@@1@1;6;32;44@@@@@ защита глобала|</Data>
</Node>
</Node>
<Node><Sub>18</Sub>
<Node><Sub>1</Sub>
<Data>18@1@1@13@1@@@@1@1;6;32;44@@@@@|</Data>
</Node>
<Node><Sub>2</Sub>
<Data>18@14@1@17@1@@@@1@1;6;32;44@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>18@31@1@3@1@@@@1@1;6;32;44@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>18@34@1@17@1@@@@1@1;6;32;44@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>18@51@1@16@1@@@@1@1;6;32;44@@@@@               |</Data>
</Node>
</Node>
<Node><Sub>19</Sub>
<Node><Sub>1</Sub>
<Data>19@1@1@13@1@@@@1@1;6;32;44@@@@@|</Data>
</Node>
<Node><Sub>2</Sub>
<Data>19@14@1@17@@@@@2@2;6;30;46@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>19@31@1@3@1@@@@1@1;6;32;44@@@@@ .</Data>
</Node>
<Node><Sub>4</Sub>
<Data>19@34@1@17@@@@@2@2;6;30;46@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>19@51@1@16@1@@@@1@1;6;32;44@@@@@               |</Data>
</Node>
</Node>
<Node><Sub>20</Sub>
<Node><Sub>1</Sub>
<Data>20@1@1@13@1@@@@1@1;6;32;44@@@@@-------------</Data>
</Node>
<Node><Sub>2</Sub>
<Data>20@14@1@17@1@@@@1@1;6;32;44@@@@@-----------------</Data>
</Node>
<Node><Sub>3</Sub>
<Data>20@31@1@3@1@@@@1@1;6;32;44@@@@@---</Data>
</Node>
<Node><Sub>4</Sub>
<Data>20@34@1@17@1@@@@1@1;6;32;44@@@@@-----------------</Data>
</Node>
<Node><Sub>5</Sub>
<Data>20@51@1@16@1@@@@1@1;6;32;44@@@@@----------------</Data>
</Node>
</Node>
<Node><Sub>Free</Sub>
<Data>57318,46760</Data>
</Node>
<Node><Sub>KEY</Sub>
<Data>^[&quot;GLAVK&quot;]BSVOL</Data>
<Node><Sub>1</Sub>
<Data><![CDATA[@@@@ВВОД НОВОГО УЗЛА ПАРАМЕТРОВ ПРОКАЧЕК@1,70,TIME@@@ 1-Й ИНДЕКСНЫЙ@2;6;30;42@@@@@Введите УЗЕЛ ПРОКАЧЕК@@@@@]]></Data>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>57318,46760,MS</Data>
</Node>
<Node><Sub>RTR</Sub>
<Node><Sub>2</Sub>
<Node><Sub>2</Sub>
<Data>S d1=$$IF^%ZAPM.ed.BSsFUNR(&quot;d?3A!(d=&quot;&quot;*&quot;&quot;)&quot;,&quot;READ&quot;,&quot;&quot;,&quot;Введите ИМЯ КИПА&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$$IF(&quot;d?3A!(d=&quot;&quot;*&quot;&quot;)&quot;,&quot;READ&quot;,&quot;&quot;,&quot;Введите ИМЯ КИПА&quot;)</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Data>S d1=$$IF^%ZAPM.ed.BSsFUNR(&quot;d?3A!(d=&quot;&quot;*&quot;&quot;)&quot;,&quot;READ&quot;,&quot;&quot;,&quot;Введите ИМЯ ТОМА&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$$IF(&quot;d?3A!(d=&quot;&quot;*&quot;&quot;)&quot;,&quot;READ&quot;,&quot;&quot;,&quot;Введите ИМЯ ТОМА&quot;)</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>STA</Sub>
<Data>2,2@1@1@27@-1@-1@2@14@</Data>
</Node>
</Node>
<Node><Sub>PROTOKOL</Sub>
<Data>ПРОТОКОЛИРОВАНИЕ ДЕЙСТВИЙ ПОЛЬЗОВАТЕЛЕЙ@@@@@1@1@1@1@22@80@1@@1@@@2@@2,2@1@@@@@1@@@5@2@@@@@@@@</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@2@20@@@@@1@2;6;35;42@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@21@2@53@@@@0@1@2;6;35;42@@@@@@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>3@1@2@20@@@@@1@2;6;35;42@@@@@       ПОЛЬЗОВАТЕЛЬ</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@21@2@53@@@@@2@1;6;32;40@@@@@@@@U@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>5@1@2@20@@@@@1@2;6;35;42@@@@@          ПАРАМЕТРЫ@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>5@21@2@53@@@@@2@1;6;32;40@@@@@@@@S</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>7@1@2@20@@@@@1@2;6;35;42@@@@@           ДЕЙСТВИЕ@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>7@21@2@53@@@@@2@1;6;32;40@@@@@@@@A</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>9@1@2@20@@@@@1@2;6;35;42@@@@@           Источник@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>9@21@2@53@@@@@2@1;6;32;40@@@@@@@@Arm</Data>
</Node>
</Node>
<Node><Sub>Compile</Sub>
<Data>OK 17:58:34 2007-08-19</Data>
</Node>
<Node><Sub>FTR</Sub>
<Node><Sub>1</Sub>
<Node><Sub>2</Sub>
<Data>S d1=&quot; ДАТА &quot;_$$ESDAY^%ZAPM.ed.BSsFUNR(9,$G(k1,&quot;1&quot;)_&quot;,&quot;_$G(k2,&quot;1&quot;))</Data>
<Node><Sub>1</Sub>
<Data>&quot; ДАТА &quot;_$$ESDAY^%ZAPM.ed.BSsFUNR(9,$G(k1,&quot;1&quot;)_&quot;,&quot;_$G(k2,&quot;1&quot;))</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>Free</Sub>
<Data>60865,45960</Data>
</Node>
<Node><Sub>KEY</Sub>
<Data>^[&quot;%SYS&quot;,&quot;&quot;]%BSprotkl</Data>
<Node><Sub>1</Sub>
<Data>@@64@@НОВАЯ СИСТЕМНАЯ ДАТА@1,70@@@ 1-Й ИНДЕКСНЫЙ@2;6;30;42@@@@@СИСТЕМНАЯ ДАТА@@@@@</Data>
<Node><Sub>3</Sub>
<Data>S d1=d_&quot;    &quot;_$$ESDAY^%ZAPM.ed.BSsFUNR(6,d)</Data>
</Node>
<Node><Sub>4</Sub>
<Data>d_&quot;    &quot;_$$ESDAY^%ZAPM.ed.BSsFUNR(6,d)</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Data>@@1@@ .... TIME   USER    ACTIONS....@1,75@@@ 2-Й ИНДЕКСНЫЙ@2;6;37;44@@@@@СИСТЕМНОЕ ВРЕМЯ@@@@@</Data>
<Node><Sub>3</Sub>
<Data><![CDATA[S d1=d_"  "_$P($$ESDAY^%ZAPM.ed.BSsFUNR(9,"1,"_d)," ",1)_"  "_$$A^%ZAPM.ed.BSA(2,2,"PROTOKOL","%BSVOL","","","",+$G(%KEYS(1)),$G(d0))_" "_$$A^%ZAPM.ed.BSA(4,2,"PROTOKOL","%BSVOL","","","",+$G(%KEYS(1)),$G(d0))_" "_$$A^%ZAPM.ed.BSA(3,2,"PROTOKOL","%BSVOL","","","",+$G(%KEYS(1)),$G(d0))]]></Data>
</Node>
<Node><Sub>4</Sub>
<Data><![CDATA[d_"  "_$P($$ESDAY^%ZAPM.ed.BSsFUNR(9,"1,"_d)," ",1)_"  "_{2,2,"PROTOKOL","%BSVOL","","","",+$G(%KEYS(1)),$G(d0)}_" "_{4,2,"PROTOKOL","%BSVOL","","","",+$G(%KEYS(1)),$G(d0)}_" "_{3,2,"PROTOKOL","%BSVOL","","","",+$G(%KEYS(1)),$G(d0)}]]></Data>
</Node>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>60865,45960,0095</Data>
</Node>
<Node><Sub>STA</Sub>
<Data>2,2@2@2@27@-1@-1@3@21@</Data>
</Node>
</Node>
<Node><Sub>SHIFTF5</Sub>
<Data><![CDATA[заготовка под перечень глобальных разделов@@@@@1@1@2@15@21@67@1@@1@@@1@@1,4@1@@@@@1@@@12@4@@1;6;37;44@@@@@@@2@^%ZAPM.ed.BSDDR("DDRPARMH")@@@@1]]></Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@2@1@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@2@2@25@@@@@1@2;6;37;44@@@@@Копируем текущую таблицу,текст под именем ...@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>1@27@2@1@@@@@1@2;6;37;44@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>1@28@2@25@@@@@1@2;6;30;46@@@@^%ZAPM.ed.BSVOL(&quot;SHIFTF5F&quot;)@@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>3@1@2@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@2@2@25@@@@@1@@@@@@                         В Глобальные разделы (буфера@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>3@27@2@1@@@@@1@@@@@@ е@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>3@28@2@25@1@@@@1@@@@@@                         ра обмена и вывода)@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>5@1@1@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>5@2@1@25@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>5@27@1@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>5@28@1@25@1@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>6@1@2@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>6@2@2@25@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>6@27@2@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>6@28@2@25@@@@@1@2;6;34;46@@@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>8@1@1@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>8@2@1@25@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>8@27@1@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>8@28@1@25@1@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>9@1@2@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>9@2@2@25@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>9@27@2@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>9@28@2@25@@@@@1@2;6;34;46@@@@@@</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>11@1@1@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>11@2@1@25@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>11@27@1@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>11@28@1@25@1@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>1</Sub>
<Data>12@1@2@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>12@2@2@25@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>12@27@2@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>12@28@2@25@@@@@1@2;6;34;46@@@@@@</Data>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>1</Sub>
<Data>14@1@1@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>14@2@1@25@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>14@27@1@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>14@28@1@25@1@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>1</Sub>
<Data>15@1@2@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>15@2@2@25@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>15@27@2@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>15@28@2@25@@@@@1@2;6;34;46@@@@@@</Data>
</Node>
</Node>
<Node><Sub>11</Sub>
<Node><Sub>1</Sub>
<Data>17@1@1@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>17@2@1@25@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>17@27@1@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>17@28@1@25@1@@@@1@@@@@@@</Data>
</Node>
</Node>
<Node><Sub>12</Sub>
<Node><Sub>1</Sub>
<Data>18@1@2@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>18@2@2@25@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>18@27@2@1@@@@@1@@@@@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>18@28@2@25@@@@@1@2;6;34;46@@@@@@</Data>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>58024,51125,MS</Data>
</Node>
<Node><Sub>STA</Sub>
<Data>6,4@1@4@27@-1@-1@10@42@</Data>
</Node>
</Node>
<Node><Sub>SHIFTF5F</Sub>
<Data>Копирование текущей таблицы@@@@@@@7@10@19@70@@@@1@@5@@@1@@@ 1@@@@@8@@@1;6;37;44//2;6;33;40@@@@@@@1</Data>
<Node><Sub>1</Sub>
<Data>  </Data>
</Node>
<Node><Sub>2</Sub>
<Data>  в этом поле можно изменить имя целевой таблицы/текста</Data>
</Node>
<Node><Sub>3</Sub>
<Data></Data>
</Node>
<Node><Sub>4</Sub>
<Data></Data>
</Node>
<Node><Sub>5</Sub>
<Data> ... а вам необходимо установить указатель на тот</Data>
</Node>
<Node><Sub>6</Sub>
<Data> раздел, куда надо скопировать таблицу и ввести &lt;Enter&gt; </Data>
</Node>
<Node><Sub>7</Sub>
<Data> </Data>
</Node>
<Node><Sub>8</Sub>
<Data>                     ... а сейчас жми &lt;Esc&gt;</Data>
</Node>
</Node>
<Node><Sub>SUMM</Sub>
<Data>ОПИСАНИЕ ОТЧЕТА@@@@@@@1@1@22@80@@@@1@@5@@@1@@@ 1@@@@@56@@@1;6;37;44//1;6;36;40//2;6;37;44@@@@@@@1</Data>
<Node><Sub>1</Sub>
<Data>;=============================</Data>
</Node>
<Node><Sub>2</Sub>
<Data>;|         |         |       |</Data>
</Node>
<Node><Sub>3</Sub>
<Data>;|         |         |       |</Data>
</Node>
<Node><Sub>4</Sub>
<Data>;| ПРИМЕРНА|Я ТАБЛИЦА| ОТЧЕТА|</Data>
</Node>
<Node><Sub>5</Sub>
<Data>;|         |         |       |</Data>
</Node>
<Node><Sub>6</Sub>
<Data>;|=========|=========|=======|</Data>
</Node>
<Node><Sub>7</Sub>
<Data>;|         |         |       |</Data>
</Node>
<Node><Sub>8</Sub>
<Data>;=============================</Data>
</Node>
<Node><Sub>9</Sub>
<Data>;             ________________________________________________</Data>
</Node>
<Node><Sub>10</Sub>
<Data>;···­­­±±±¶¶¶¶¶¶¶¶¶¶¶            ПРИМЕР СКРИПТА         ¶¶¶¶¶¶¶¶¶¶¶¶¶±±±­­­···</Data>
</Node>
<Node><Sub>11</Sub>
<Data>;             ®®®®®®®®®®®®®®®®®®®®®®®®®®®®®®®®®®®®®®®®®®®®®®®®</Data>
</Node>
<Node><Sub>12</Sub>
<Data></Data>
</Node>
<Node><Sub>13</Sub>
<Data>;[ ОПИСАНИЕ ОБЩИХ СВОЙСТВ ОТЧЕТА ]</Data>
</Node>
<Node><Sub>14</Sub>
<Data>!HEAD=&quot; ЗАГОЛОВОК ОТЧЕТА&quot;                       ;ЗАГОЛОВОК</Data>
</Node>
<Node><Sub>15</Sub>
<Data>!SHAB(1)=&quot;^[&quot;&quot;GLAVK&quot;&quot;]REPORT(&quot;&quot;LIST2&quot;&quot;)&quot;  ;1 ТАБЛИЦА ШАБЛОНОВ</Data>
</Node>
<Node><Sub>16</Sub>
<Data>!SHAB(2)=&quot;^[&quot;&quot;GLAVK&quot;&quot;]REPORT(&quot;&quot;LIST?&quot;&quot;)&quot;  ;2 ТЕКСТ ШАБЛОНОВ</Data>
</Node>
<Node><Sub>17</Sub>
<Data>!MODE=&quot;LIST&quot;                                    ;СПИСОК</Data>
</Node>
<Node><Sub>18</Sub>
<Data>                                  ;!MODE=&quot;SUMM&quot; ;СВОДКА</Data>
</Node>
<Node><Sub>19</Sub>
<Data></Data>
</Node>
<Node><Sub>20</Sub>
<Data>!BASEM=&quot;^[&quot;&quot;GLAVK&quot;&quot;]d10203&quot;               ;МАССИВ БАЗЫ ДАННЫХ</Data>
</Node>
<Node><Sub>21</Sub>
<Data>!BASER=&quot;^[&quot;&quot;GLAVK&quot;&quot;]F10203&quot;               ;РАЗДЕЛ ОПИСАНИЕ БД (КЛЮЧИ)</Data>
</Node>
<Node><Sub>22</Sub>
<Data>!BASET=&quot;10203L&quot;                                 ;ТАБЛИЦА ОПИСАНИЕ БД (КЛЮЧИ)</Data>
</Node>
<Node><Sub>23</Sub>
<Data>!COLOR=&quot;2;6;30;46&quot;                              ;ОБЩИЙ ЦВЕТ ОТЧЕТА (для Вьювера)</Data>
</Node>
<Node><Sub>24</Sub>
<Data></Data>
</Node>
<Node><Sub>25</Sub>
<Data>;[ ОПИСАНИЕ СВОЙСТВ КЛЮЧЕЙ И ВЫБОРКИ ПО НИМ ]</Data>
</Node>
<Node><Sub>26</Sub>
<Data>!KEYS=&quot;0,1,2,3,4&quot;                        ;ПЕРЕЧЕНЬ КЛЮЧЕЙ</Data>
</Node>
<Node><Sub>27</Sub>
<Data>!KEYCH=0                                 ;МОДЕЛЬ ВЫБОРКИ КЛЮЧА=0 (СТАНДАРТНАЯ)</Data>
</Node>
<Node><Sub>28</Sub>
<Data></Data>
</Node>
<Node><Sub>29</Sub>
<Data>;[ ОПИСАНИЕ СВОЙСТВ ШАПКИ ]</Data>
</Node>
<Node><Sub>30</Sub>
<Data>!COLR=&quot;1,3,2&quot;                     ;ПОРЯДОК СЛЕДОВАНИЕ КОЛОНОК В ОТЧЕТЕ</Data>
</Node>
<Node><Sub>31</Sub>
<Data>!COLH=4                           ;ВЫСОТА ШАПКИ или =0 ;AUTO</Data>
</Node>
<Node><Sub>32</Sub>
<Data>!COLN=1                           ;НУЖНА ЛИ КОЛОНКА СКВОЗНОЙ НУМЕРАЦИИ</Data>
</Node>
<Node><Sub>33</Sub>
<Data>!COLHU=&quot;====&quot;                     ;ОФОРМЛЕНИЕ\      ----     ----</Data>
</Node>
<Node><Sub>34</Sub>
<Data>!COLMU=&quot;|=||&quot;                     ;ОТЧЕТА     &gt; или |-+| или |-+|</Data>
</Node>
<Node><Sub>35</Sub>
<Data>!COLDU=&quot;====&quot;                     ;ДЛЯ ВЫВОДА/      ----     ----</Data>
</Node>
<Node><Sub>36</Sub>
<Data></Data>
</Node>
<Node><Sub>37</Sub>
<Data>;[ ОБЩИЕ УСЛОВИЯ ФОРМИРОВАНИЯ ОТЧЕТА ]</Data>
</Node>
<Node><Sub>38</Sub>
<Data>!IFGL(1)=&quot;^(&quot;&quot;СНО&quot;&quot;)&apos;=9&quot;</Data>
</Node>
<Node><Sub>39</Sub>
<Data></Data>
</Node>
<Node><Sub>40</Sub>
<Data>;[ ТЕКСТ КОЛОНОК ]</Data>
</Node>
<Node><Sub>41</Sub>
<Data>!COL(1,&quot;TXT&quot;,0)=&quot;2,3\5,11&quot;        ;КООРДИНАТЫ ТЕКСТА КОЛОНКИ 1 ИЗ ТЕКУЩ.ТЕКСТА</Data>
</Node>
<Node><Sub>42</Sub>
<Data>!COL(2,&quot;TXT&quot;,0)=&quot;2,13\5,21&quot;       ;</Data>
</Node>
<Node><Sub>43</Sub>
<Data>!COL(3,&quot;TXT&quot;,1)=&quot;3,5&quot;             ;ТЕКСТ ВЗЯТЬ ИЗ 1 ТАБЛИЦЫ, ИЗ КЛЕТКИ 3,5</Data>
</Node>
<Node><Sub>44</Sub>
<Data></Data>
</Node>
<Node><Sub>45</Sub>
<Data></Data>
</Node>
<Node><Sub>46</Sub>
<Data>;[ ФУНКЦИИ ТРАНСФОРМАЦИИ НАСЧИТАННЫХ ДАННЫХ НА КОЛОНКИ ]</Data>
</Node>
<Node><Sub>47</Sub>
<Data>!COL(3,&quot;FTR&quot;,1)=&quot;4,5&quot;             ;ВЗЯТЬ ИЗ 1 ТАБЛИЦЫ, ИЗ КЛЕТКИ 4,5</Data>
</Node>
<Node><Sub>48</Sub>
<Data></Data>
</Node>
<Node><Sub>49</Sub>
<Data>;[ ФУНКЦИИ ЛОГИЧЕСКОГО КОНТРОЛЯ НА КОЛОНКИ ]</Data>
</Node>
<Node><Sub>50</Sub>
<Data>!COL(3,&quot;COL&quot;,1)=&quot;4,5&quot;             ;ВЗЯТЬ ИЗ 1 ТАБЛИЦЫ, ИЗ КЛЕТКИ 4,5</Data>
</Node>
<Node><Sub>51</Sub>
<Data></Data>
</Node>
<Node><Sub>52</Sub>
<Data>;[ ФУНКЦИИ ВЫЧИСЛЕНИЯ НА КОЛОНКИ ]</Data>
</Node>
<Node><Sub>53</Sub>
<Data>!COL(1,&quot;CAL&quot;)=&quot;^(&quot;&quot;002&quot;&quot;)&quot;        ;НЕПОЛНАЯ ССЫЛКА НА ПОСЛЕДНИЙ УРОВЕНЬ БД</Data>
</Node>
<Node><Sub>54</Sub>
<Data>!COL(2,&quot;CAL&quot;)=&quot;^(&quot;&quot;НОМ&quot;&quot;)&quot;</Data>
</Node>
<Node><Sub>55</Sub>
<Data>!COL(3,&quot;CAL&quot;)=&quot;^(&quot;&quot;СНО&quot;&quot;)&quot;</Data>
</Node>
<Node><Sub>56</Sub>
<Data></Data>
</Node>
</Node>
<Node><Sub>SYS</Sub>
<Data>заготовка очень маленькой таблицы (1x1)@@1@@@1@1@1@1@22@80@1@@1@1@@1@@@1@@@@@1@@@1@1@@@@@@@@</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@1@@@@@1@@@1@@@</Data>
</Node>
</Node>
<Node><Sub>HTML</Sub>
<Data>TAF-SUMM</Data>
</Node>
<Node><Sub>STA</Sub>
<Data>1,1@1@1@13@-1@-1@1@1@</Data>
</Node>
</Node>
<Node><Sub>TREE</Sub>
<Data><![CDATA[ДЕРЕВЯННЫЙ РЕДАКТОР МАССИВОВ (F4=Tree^%ZAPM.ed.BST1+139)@@@@@1@1@1@1@22@80@1@@1@1@@2@@@1@@@@@1@@@1@1@@@@@@@@]]></Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@1@@@@@2@@@@@@@@@Val</Data>
</Node>
</Node>
<Node><Sub>Free</Sub>
<Data>65828,77132</Data>
</Node>
<Node><Sub>KEY</Sub>
<Data>^%ZAPM.ed.BStree</Data>
<Node><Sub>1</Sub>
<Data>@@@@Enter a new node@1,78@@@ 1-Й ИНДЕКСНЫЙ@2;6;34;42@@@@@Введите Значение Нового Узла 1 уровня@@@@@</Data>
<Node><Sub>3</Sub>
<Data>S d1=$$T^%ZAPM.ed.BSTREE</Data>
</Node>
<Node><Sub>4</Sub>
<Data>$$T^%ZAPM.ed.BSTREE</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Data>@@@@Enter a new node@1,78@@@ 2-Й ИНДЕКСНЫЙ@2;6;34;42@@@@@Введите Значение Нового Узла 2 уровня@@@@@</Data>
<Node><Sub>3</Sub>
<Data>S d1=$$T^%ZAPM.ed.BSTREE</Data>
</Node>
<Node><Sub>4</Sub>
<Data>$$T^%ZAPM.ed.BSTREE</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Data><![CDATA[@@@@$D ВВЕСТИ НОВЫЙ УЗЕЛ@1,78@@@ 3-Й ИНДЕКСНЫЙ@2;6;34;42@@@@@Введите Значение Нового Узла 3 уровня@@@@@]]></Data>
<Node><Sub>3</Sub>
<Data>S d1=$$T^%ZAPM.ed.BSTREE</Data>
</Node>
<Node><Sub>4</Sub>
<Data>$$T^%ZAPM.ed.BSTREE</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Data><![CDATA[@@@@$D ВВЕСТИ НОВЫЙ УЗЕЛ@1,78@@@ 4-Й ИНДЕКСНЫЙ@2;6;34;42@@@@@Введите Значение Нового Узла 4 уровня@@@@@]]></Data>
<Node><Sub>3</Sub>
<Data>S d1=$$T^%ZAPM.ed.BSTREE</Data>
</Node>
<Node><Sub>4</Sub>
<Data>$$T^%ZAPM.ed.BSTREE</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Data><![CDATA[@@@@$D ВВЕСТИ НОВЫЙ УЗЕЛ@1,78@@@ 5-Й ИНДЕКСНЫЙ@2;6;34;42@@@@@Введите Значение Нового Узла 5 уровня@@@@@]]></Data>
<Node><Sub>3</Sub>
<Data>S d1=$$T^%ZAPM.ed.BSTREE</Data>
</Node>
<Node><Sub>4</Sub>
<Data>$$T^%ZAPM.ed.BSTREE</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Data><![CDATA[@@@@$D ВВЕСТИ НОВЫЙ УЗЕЛ@1,78@@@ 6-Й ИНДЕКСНЫЙ@2;6;34;42@@@@@Введите Значение Нового Узла 6 уровня@@@@@]]></Data>
<Node><Sub>3</Sub>
<Data>S d1=$$T^%ZAPM.ed.BSTREE</Data>
</Node>
<Node><Sub>4</Sub>
<Data>$$T^%ZAPM.ed.BSTREE</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Data><![CDATA[@@@@$D ВВЕСТИ НОВЫЙ УЗЕЛ@1,78@@@ 7-Й ИНДЕКСНЫЙ@2;6;34;42@@@@@Введите Значение Нового Узла 7 уровня@@@@@]]></Data>
<Node><Sub>3</Sub>
<Data>S d1=$$T^%ZAPM.ed.BSTREE</Data>
</Node>
<Node><Sub>4</Sub>
<Data>$$T^%ZAPM.ed.BSTREE</Data>
</Node>
</Node>
<Node><Sub>8</Sub>
<Data><![CDATA[@@@@$D ВВЕСТИ НОВЫЙ УЗЕЛ@1,78@@@ 8-Й ИНДЕКСНЫЙ@2;6;34;42@@@@@Введите Значение Нового Узла 8 уровня@@@@@]]></Data>
<Node><Sub>3</Sub>
<Data>S d1=$$T^%ZAPM.ed.BSTREE</Data>
</Node>
<Node><Sub>4</Sub>
<Data>$$T^%ZAPM.ed.BSTREE</Data>
</Node>
</Node>
<Node><Sub>9</Sub>
<Data><![CDATA[@@@@$D ВВЕСТИ НОВЫЙ УЗЕЛ@1,78@@@ 9-Й ИНДЕКСНЫЙ@2;6;34;42@@@@@Введите Значение Нового Узла 9 уровня@@@@@]]></Data>
<Node><Sub>3</Sub>
<Data>S d1=$$T^%ZAPM.ed.BSTREE</Data>
</Node>
<Node><Sub>4</Sub>
<Data>$$T^%ZAPM.ed.BSTREE</Data>
</Node>
<Node><Sub>10</Sub>
<Data>Текст ,который появится в меню при организации выборки для выдачи СПИСКОВ и СВОДОК</Data>
<Node><Sub>1</Sub>
<Data><![CDATA[I 1 ;3 - ДИАПАЗОН, или Формула вычисления для выборки. Например,ключ 2 это дата и формула для выборки МАЯ-месяца будет такая :+$E(k2,3,4)=5]]></Data>
</Node>
<Node><Sub>2</Sub>
<Data><![CDATA[1 ;3 - ДИАПАЗОН, или Формула вычисления для выборки. Например,ключ 2 это дата и формула для выборки МАЯ-месяца будет такая :+$E(k2,3,4)=5]]></Data>
</Node>
</Node>
</Node>
<Node><Sub>10</Sub>
<Data><![CDATA[@@@@$D ВВЕСТИ НОВЫЙ УЗЕЛ@1,78@@@ 10-Й ИНДЕКСНЫЙ@2;6;34;42@@@@@Введите Значение Нового Узла 10 уровня@@@@@]]></Data>
<Node><Sub>3</Sub>
<Data>S d1=$$T^%ZAPM.ed.BSTREE</Data>
</Node>
<Node><Sub>4</Sub>
<Data>$$T^%ZAPM.ed.BSTREE</Data>
</Node>
</Node>
<Node><Sub>11</Sub>
<Data><![CDATA[@@@@$D ВВЕСТИ НОВЫЙ УЗЕЛ@1,78@@@ 11-Й ИНДЕКСНЫЙ@2;6;34;42@@@@@Введите Значение Нового Узла 11 уровня@@@@@]]></Data>
<Node><Sub>3</Sub>
<Data>S d1=$$T^%ZAPM.ed.BSTREE</Data>
</Node>
<Node><Sub>4</Sub>
<Data>$$T^%ZAPM.ed.BSTREE</Data>
</Node>
</Node>
<Node><Sub>12</Sub>
<Data><![CDATA[@@@@$D ВВЕСТИ НОВЫЙ УЗЕЛ@1,78@@@ 12-Й ИНДЕКСНЫЙ@2;6;34;42@@@@@Введите Значение Нового Узла 12 уровня@@@@@]]></Data>
<Node><Sub>3</Sub>
<Data>S d1=$$T^%ZAPM.ed.BSTREE</Data>
</Node>
<Node><Sub>4</Sub>
<Data>$$T^%ZAPM.ed.BSTREE</Data>
</Node>
</Node>
<Node><Sub>13</Sub>
<Data><![CDATA[@@@@$D ВВЕСТИ НОВЫЙ УЗЕЛ@1,78@@@ 13-Й ИНДЕКСНЫЙ@2;6;34;42@@@@@Введите Значение Нового Узла 13 уровня@@@@@]]></Data>
<Node><Sub>3</Sub>
<Data>S d1=$$T^%ZAPM.ed.BSTREE</Data>
</Node>
<Node><Sub>4</Sub>
<Data>$$T^%ZAPM.ed.BSTREE</Data>
</Node>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>65828,77132,m</Data>
</Node>
<Node><Sub>STA</Sub>
<Data>1,1@1@1@13@-1@-1@1@1@</Data>
</Node>
</Node>
<Node><Sub>TRM</Sub>
<Data>БАЗА ОПИСАНИЯ ТЕРМИНАЛОВ@@@@@1@1@1@1@22@80@1@@1@@@2@@2,2@1@@@@@1@@@7@2@@@@@@@@@@</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@2@20@@@@@1@2;6;35;42@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@21@2@53@@@@0@1@2;6;35;42@@@@@@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>3@1@2@20@@@@@1@2;6;35;42@@@@@      КОМЕНТАРИЙ</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@21@2@53@@@@@2@1;6;33;43@@@@@@@@REM@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>5@1@2@20@@@@@1@2;6;35;42@@@@@    ПРИКРЕПЛЕННАЯ         NAMESPACE@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>5@21@2@53@@@@@2@1;6;33;43@@@@@@@@NSP</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>7@1@2@20@@@@@1@2;6;35;42@@@@@   ФЛАГИ ТЕРМИНАЛА       (F1-ПОМОЩЬ)@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>7@21@2@53@@@@@2@1;6;33;43@@@@@@@@FLG@@^%ZAPM.ed.BSVOL(&quot;TRMFLG&quot;)</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>9@1@1@20@@@@@1@1;6;32;42@@@@@Инициализация LPT:@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>9@21@1@53@@@@@2@1;6;32;43@@@@@@@@OpenLPT</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>10@1@1@20@@@@@1@1;6;32;42@@@@@Отмена вывода наLPT:@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>10@21@1@53@@@@@2@1;6;32;43@@@@@@@@CloseLPT</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>11@1@2@20@@@@@1@2;6;35;42@@@@@Уникальный идентифи-кационный номер@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>11@21@2@53@@@@0@2@1;6;33;43@@@@@@@@Principal</Data>
</Node>
</Node>
<Node><Sub>FTR</Sub>
<Node><Sub>1</Sub>
<Node><Sub>2</Sub>
<Data>S d1=&quot; ТЕРМИНАЛ № &quot;_$G(k1,&quot;?&quot;)</Data>
<Node><Sub>1</Sub>
<Data>&quot; ТЕРМИНАЛ № &quot;_$G(k1,&quot;?&quot;)</Data>
</Node>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>2</Sub>
<Data>S d1=&quot;  &quot;_$S(d1=&quot;&quot;:$P_&quot; = $P&quot;,1:d1)</Data>
<Node><Sub>1</Sub>
<Data>&quot;  &quot;_$S(d1=&quot;&quot;:$P_&quot; = $P&quot;,1:d1)</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>Free</Sub>
<Data>57668,81954</Data>
</Node>
<Node><Sub>KEY</Sub>
<Data>^%ZAPM.ed.BStrm</Data>
<Node><Sub>1</Sub>
<Data>0@@@§@НОВЫЙ НОМЕР ТЕРМИНАЛА@1,40@@@ 1-Й ИНДЕКСНЫЙ@2;6;37;44@@@@@НОМЕР ТЕРМИНАЛА @@@@@</Data>
<Node><Sub>3</Sub>
<Data>S d1=d_$TR($J(&quot;&quot;,10-$L(d)),&quot; &quot;,&quot;.&quot;)_$$A^%ZAPM.ed.BSA(2,2,&quot;TRM&quot;,&quot;^%ZAPM.ed.BSVOL&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;,$G(d,0))</Data>
</Node>
<Node><Sub>4</Sub>
<Data>d_$TR($J(&quot;&quot;,10-$L(d)),&quot; &quot;,&quot;.&quot;)_{2,2,&quot;TRM&quot;,&quot;^%ZAPM.ed.BSVOL&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;,$G(d,0)}</Data>
</Node>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>57668,81954,MS</Data>
</Node>
<Node><Sub>STA</Sub>
<Data>2,2@2@2@27@-1@-1@3@21@</Data>
</Node>
</Node>
<Node><Sub>TRMFLG</Sub>
<Data>Описание парамеров@@@@@@@1@7@22@75@@@@1@@5@@@1@@@ 1@@@@@14@@@1;6;37;44//2;6;33;40@@@@@@@1</Data>
<Node><Sub>1</Sub>
<Data> ВВЕДИТЕ ПАРАМЕТРЫ ТЕРМИНАЛЬНЫХ ФЛАГОВ В ФОРМАТЕ:  ABCDEFJHIKL</Data>
</Node>
<Node><Sub>2</Sub>
<Data> , где:</Data>
</Node>
<Node><Sub>3</Sub>
<Data>A  1=1  ВСЕГДА</Data>
</Node>
<Node><Sub>4</Sub>
<Data>B  2=1  УМЕНЬШАТЬ РАЗМЕР ОКНА ПРОСМОТРА ДО 64 СИМВОЛОВ И 21 СТРОКИ</Data>
</Node>
<Node><Sub>5</Sub>
<Data>   2=0  НИЧЕГО НЕ ТРОГАТЬ</Data>
</Node>
<Node><Sub>6</Sub>
<Data>C  3=1  ЗАПРЕЩЕНА КОРРЕКЦИЯ ТАБЛИЦ</Data>
</Node>
<Node><Sub>7</Sub>
<Data>   3=0  КОРРЕКЦИЯ ТАБЛИЦ РАЗРЕШЕНА</Data>
</Node>
<Node><Sub>8</Sub>
<Data>D  4=1  ЗАПРЕЩЕН ВХОД В СПЕЦ. РЕЖИМЫ ALT-F10,ALT-F11,ALT-F12</Data>
</Node>
<Node><Sub>9</Sub>
<Data>   4=0  РАЗРЕШЕН</Data>
</Node>
<Node><Sub>10</Sub>
<Data>E  5=0  ЗАДАВАТЬ ВОПРОС О УСТРОЙСТВЕ ВЫВОДА НА БУМАГУ ------------</Data>
</Node>
<Node><Sub>11</Sub>
<Data>   5=1  ВЫВОДИТЬ ВСЕГДА НА ПРИНТЕР MSM (ПО-УМОЛЧАНИЮ =3)  &lt;------|</Data>
</Node>
<Node><Sub>12</Sub>
<Data>   5=2  ВЫВОДИТЬ ВСЕГДА НА ПРИСОЕДИНЕННЫЙ КОНТРОЛЕР ТЕРМИНАЛА &lt;---</Data>
</Node>
<Node><Sub>13</Sub>
<Data>F  6=0  ЭМУЛЯТОР ТЕРМИНАЛА (PC-CONSOL,ARM_TERM.EXE,PCTERM.EXE)</Data>
</Node>
<Node><Sub>14</Sub>
<Data>   6=1  ЭМУЛЯТОР ТЕРМИНАЛА (PCTT07xx.EXE,PCPC.EXE)</Data>
</Node>
</Node>
<Node><Sub>UPGR</Sub>
<Data>ФИКТИВНАЯ БАЗА КОНТРОЛЬНЫХ СУММ ВЕРСИЙ %BS@@@@@1@1@1@1@22@80@1@@1@1@@2@@@1@@@@@1@@@1@1@@@@@@@@</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@1@@@@@1@@@@@@</Data>
</Node>
</Node>
<Node><Sub>Free</Sub>
<Data>57600,510</Data>
</Node>
<Node><Sub>KEY</Sub>
<Data>^BSUPGR</Data>
<Node><Sub>1</Sub>
<Data><![CDATA[49@@64@@НОВОЕ КСП@1,70@@@ 1-Й ИНДЕКСНЫЙ@2;6;30;42@@@@@Введите Код структурных подразделений (2,4 или 9 цыфр)@@@@@]]></Data>
</Node>
<Node><Sub>2</Sub>
<Data>@@@@ЧТО@1,40@@@ 2-Й ИНДЕКСНЫЙ@2;6;37;44@@@@@ЧТО@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>@@@@КТО@1,50@@@ 3-Й ИНДЕКСНЫЙ@@@@@@КТО@@@@@</Data>
</Node>
</Node>
<Node><Sub>LST</Sub>
<Data>57600,510,MS</Data>
</Node>
<Node><Sub>STA</Sub>
<Data>1,1@1@1@-2@-2@-2@1@1@</Data>
</Node>
</Node>
<Node><Sub>YES</Sub>
<Data>запрос@@1@@@1@1@1@1@22@80@1@@1@1@@8@@@1@@@@@@@@2@3@@2;6;37;44@@@@@@@@^%ZAPM.ed.BSHLP(&quot;HELP-ALTF2&quot;)</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@10@@@@@1@@@@@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@11@1@10@@@@@1@1;6;32;44@@@@@ВКЛЮЧИТЬ@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>1@21@1@10@@@@@1@@@@@@1@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@10@@@@@1@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>2@11@1@10@@@@@1@2;6;30;45@@@@@ВЫКЛЮЧИТЬ@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>2@21@1@10@@@@@1@@@@@@0@</Data>
</Node>
</Node>
<Node><Sub>BUT</Sub>
<Data>запрос/2;6;37;44</Data>
<Node><Sub>0</Sub>
<Data>2;6;37;44</Data>
</Node>
<Node><Sub>1</Sub>
<Data>1;6;32;44/2;6;30;45</Data>
<Node><Sub>1</Sub>
<Data>ВКЛЮЧИТЬ</Data>
</Node>
<Node><Sub>2</Sub>
<Data>ВЫКЛЮЧИТЬ</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>1</Data>
</Node>
<Node><Sub>2</Sub>
<Data>0</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>0</Data>
</Node>
<Node><Sub>2</Sub>
<Data>0</Data>
</Node>
</Node>
</Node>
<Node><Sub>STA</Sub>
<Data>2,3@1@1@13@-1@-1@2@21@0</Data>
</Node>
</Node>
<Node><Sub>ZP</Sub>
<Data><![CDATA[БАЗА ОПИСАНИЯ ЗАПРОСОВ (I part)@@@@@1@1@1@1@22@80@1@@1@1@@2@@2,2@1@@@@@1@@@5@2@@@@@@@@@@^%ZAPM.ed.BSMDDR("T1")]]></Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@2@20@@@@@1@2;6;35;42@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@21@2@53@@@@0@1@2;6;35;42@@@@@@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>3@1@2@20@@@@@1@2;6;35;42@@@@@Диапазон выборки          НАЧАЛО</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@21@2@53@@@@@2@1;6;32;40@@@@@@@@1@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>5@1@2@20@@@@@1@2;6;35;42@@@@@Диапазон выборки          КОНЕЦ@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>5@21@2@53@@@@@2@1;6;32;40@@@@@@@@2</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>7@1@2@20@@@@@1@2;6;35;42@@@@@Специальная выборка@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>7@21@2@53@@@@@2@1;6;32;40@@@@@@@@3</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>9@1@2@20@@@@@1@2;6;35;42@@@@@Текст, выводимый в  выходной Таблице@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>9@21@2@53@@@@@2@1;6;32;40@@@@@@@@4</Data>
</Node>
</Node>
<Node><Sub>FTR</Sub>
<Node><Sub>1</Sub>
<Node><Sub>2</Sub>
<Data>S d1=&quot; СРАВНЕНИЕ &quot;_$G(k2,&quot;?&quot;)_&quot;, ВЫБОРКА для ключа &quot;_$G(k3,&quot;?&quot;)</Data>
<Node><Sub>1</Sub>
<Data>&quot; СРАВНЕНИЕ &quot;_$G(k2,&quot;?&quot;)_&quot;, ВЫБОРКА для ключа &quot;_$G(k3,&quot;?&quot;)</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>Free</Sub>
<Data>57069,46606</Data>
</Node>
<Node><Sub>KEY</Sub>
<Data>^[&quot;GLAVK&quot;]AVI(&quot;Q13101&quot;,&quot;ZPr&quot;)</Data>
<Node><Sub>1</Sub>
<Data>0@@64@§@НОВОЕ ИМЯ ЗАПРОСА@1,20@@@ 1-Й ИНДЕКСНЫЙ@2;6;37;44@@@@@ИМЯ ЗАПРОСА@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>0@@@§@Новый период СРАВНЕНИЯ@1,75@@@ 2-Й ИНДЕКСНЫЙ@2;6;37;44@@@@@ПЕРИОД СРАВНЕНИЯ@@@@@</Data>
<Node><Sub>3</Sub>
<Data>S d1=d_&quot; &quot;_$S(d=&quot;^&quot;:&quot;Общее Описание ЗАПРОСА&quot;,1:&quot;СРАВНЕНИЕ&quot;)</Data>
</Node>
<Node><Sub>4</Sub>
<Data>d_&quot; &quot;_$S(d=&quot;^&quot;:&quot;Общее Описание ЗАПРОСА&quot;,1:&quot;СРАВНЕНИЕ&quot;)</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Data><![CDATA[0@@@§@ВЫБОРКА:(0-описание именного ключа,i-индексного,^-общее описание формы)@1,75@@@ 3-Й ИНДЕКСНЫЙ@@@@@@Вводите ВЫБОРКУ:(0-описание именного ключа,i-индексного,^-общее описание формы)@@@@@]]></Data>
<Node><Sub>3</Sub>
<Data>S d1=d_&quot; &quot;_$S(d=&quot;^&quot;:&quot;Общее Описание ввода информации&quot;,1:&quot;ключа&quot;)</Data>
</Node>
<Node><Sub>4</Sub>
<Data>d_&quot; &quot;_$S(d=&quot;^&quot;:&quot;Общее Описание ввода информации&quot;,1:&quot;ключа&quot;)</Data>
</Node>
</Node>
</Node>
<Node><Sub>STA</Sub>
<Data>2,2@2@2@13@-1@-1@3@21@</Data>
</Node>
</Node>
<Node><Sub>ZPR</Sub>
<Data>БАЗА ОПИСАНИЯ ЗАПРОСОВ (II part)@@@@@1@1@1@1@22@80@1@@1@1@@1@@2,2@1@@@@@1@@@6@2@@@@@@@@</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@2@25@@@@@1@2;6;35;42@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@26@2@53@@@@@1@2;6;35;42@@@@@Общее Описание ввода информации по ЗАПРОСУ@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>3@1@2@25@@@@@1@2;6;35;42@@@@@Коментарий</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@26@2@53@@@@@2@2;6;34;46@@@@@@@@K</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>5@1@1@25@@@@@1@2;6;30;42@@@@@Выбранный Микрозапрос</Data>
</Node>
<Node><Sub>2</Sub>
<Data>5@26@1@53@@@@@2@2;6;34;46@@@@@@@@M</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>6@1@2@25@@@@@1@2;6;30;42@@@@@Есть ли уточнение        боковины@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>6@26@2@53@@@@@2@2;6;34;46@@@@@@@@U</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>8@1@1@25@@@@@1@1;6;32;42@@@@@ ТИП запуска ЗАПРОСА@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>8@26@1@53@@@@0@2@2;6;34;46@@@@^%ZAPM.ed.BSVOL(&quot;PACKBUT&quot;)@@0@@F</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>9@1@2@25@@@@0@2@1;6;34;42@@@@@    служебная строка         (не трогать !!!)@@@W</Data>
</Node>
<Node><Sub>2</Sub>
<Data>9@26@2@53@@@@@2@2;6;34;46@@@@@@@@D</Data>
</Node>
</Node>
<Node><Sub>FTR</Sub>
<Node><Sub>5</Sub>
<Node><Sub>2</Sub>
<Data>S d1=$S(d=&quot;Q&quot;:&quot; Локальный Запуск&quot;,d=&quot;F&quot;:&quot; Фоновый локальный&quot;,d=&quot;R&quot;:&quot; Фоновый на М-сервере&quot;,1:&quot;&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$S(d=&quot;Q&quot;:&quot; Локальный Запуск&quot;,d=&quot;F&quot;:&quot; Фоновый локальный&quot;,d=&quot;R&quot;:&quot; Фоновый на М-сервере&quot;,1:&quot;&quot;)</Data>
</Node>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>S d1=&quot;Используется Дополнитель-ный Микрозапрос&quot;</Data>
<Node><Sub>1</Sub>
<Data>&quot;Используется Дополнитель-ный Микрозапрос&quot;</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>Free</Sub>
<Data>57067,62149</Data>
</Node>
<Node><Sub>RTR</Sub>
<Node><Sub>5</Sub>
<Node><Sub>2</Sub>
<Data>S d1=$$IF^%ZAPM.ed.BSsFUNR(&quot;&quot;&quot;RQF&quot;&quot;[d&quot;,&quot;READ&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$$IF(&quot;&quot;&quot;RQF&quot;&quot;[d&quot;,&quot;READ&quot;)</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>STA</Sub>
<Data>6,2@2@2@13@-1@-1@9@26@</Data>
</Node>
</Node>
<Node><Sub>ZPR3</Sub>
<Data>БАЗА ОПИСАНИЯ ЗАПРОСОВ СПИСКА (II part)@@1@@@1@1@1@1@22@80@1@@1@1@@1@@2,2@1@@@@@1@@@5@2@@@@@@@@</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@2@25@@@@@1@2;6;35;42@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@26@2@53@@@@@1@2;6;35;42@@@@@Общее Описание ввода информации по ЗАПРОСУ@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>3@1@2@25@@@@@1@2;6;35;42@@@@@Коментарий</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@26@2@53@@@@@2@2;6;34;46@@@@@@@@K</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>5@1@1@25@@@@@1@2;6;30;42@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>5@26@1@53@@@@@2@2;6;34;46@@@@@@@@M</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>6@1@2@25@@@@@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>6@26@2@53@@@@@2@2;6;34;46@@@@@@@@U</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>8@1@1@25@@@@0@2@1;6;32;42@@@@@ ТИП запуска ЗАПРОСА@@@W</Data>
</Node>
<Node><Sub>2</Sub>
<Data>8@26@1@53@@@@0@2@2;6;34;46@@@@^%ZAPM.ed.BSVOL(&quot;PACKBUT&quot;)@@0@@F</Data>
</Node>
</Node>
<Node><Sub>FTR</Sub>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>S d1=&quot; ТИП запуска ЗАПРОСА&quot;</Data>
<Node><Sub>1</Sub>
<Data>&quot; ТИП запуска ЗАПРОСА&quot;</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Data>S d1=$S(d=&quot;Q&quot;:&quot; Локальный Запуск&quot;,d=&quot;F&quot;:&quot; Фоновый локальный&quot;,d=&quot;R&quot;:&quot; Фоновый на М-сервере&quot;,1:&quot;&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$S(d=&quot;Q&quot;:&quot; Локальный Запуск&quot;,d=&quot;F&quot;:&quot; Фоновый локальный&quot;,d=&quot;R&quot;:&quot; Фоновый на М-сервере&quot;,1:&quot;&quot;)</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>Free</Sub>
<Data>57067,62149</Data>
</Node>
<Node><Sub>RTR</Sub>
<Node><Sub>5</Sub>
<Node><Sub>2</Sub>
<Data>S d1=$$IF^%ZAPM.ed.BSsFUNR(&quot;&quot;&quot;RQF&quot;&quot;[d&quot;,&quot;READ&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$$IF(&quot;&quot;&quot;RQF&quot;&quot;[d&quot;,&quot;READ&quot;)</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>STA</Sub>
<Data>2,2@2@2@13@-1@-1@3@26@</Data>
</Node>
</Node>
<Node><Sub>ZPR4</Sub>
<Data>БАЗА ОПИСАНИЯ ЗАПРОСОВ СВОДКИ (II part)@@@@@1@1@1@1@22@80@1@@1@1@@1@@2,2@1@@@@@1@@@6@2@@@@@@@@</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@2@25@@@@@1@2;6;35;42@@@@@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@26@2@53@@@@@1@2;6;35;42@@@@@Общее Описание ввода информации по ЗАПРОСУ@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>3@1@2@25@@@@@1@2;6;35;42@@@@@Коментарий</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@26@2@53@@@@@2@2;6;34;46@@@@@@@@K</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>5@1@1@25@@@@@1@2;6;30;42@@@@@Выбранный Микрозапрос</Data>
</Node>
<Node><Sub>2</Sub>
<Data>5@26@1@53@@@@@2@2;6;34;46@@@@@@@@M</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>6@1@2@25@@@@@1@2;6;30;42@@@@@Есть ли уточнение        боковины@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>6@26@2@53@@@@@2@2;6;34;46@@@@@@@@U</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>8@1@1@25@@@@@1@1;6;32;42@@@@@ ТИП запуска ЗАПРОСА@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>8@26@1@53@@@@0@2@2;6;34;46@@@@^%ZAPM.ed.BSVOL(&quot;PACKBUT&quot;)@@0@@F</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>9@1@2@25@@@@0@2@1;6;34;42@@@@@    служебная строка         (не трогать !!!)@@@W</Data>
</Node>
<Node><Sub>2</Sub>
<Data>9@26@2@53@@@@@2@2;6;34;46@@@@@@@@D</Data>
</Node>
</Node>
<Node><Sub>FTR</Sub>
<Node><Sub>5</Sub>
<Node><Sub>2</Sub>
<Data>S d1=$S(d=&quot;Q&quot;:&quot; Локальный Запуск&quot;,d=&quot;F&quot;:&quot; Фоновый локальный&quot;,d=&quot;R&quot;:&quot; Фоновый на М-сервере&quot;,1:&quot;&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$S(d=&quot;Q&quot;:&quot; Локальный Запуск&quot;,d=&quot;F&quot;:&quot; Фоновый локальный&quot;,d=&quot;R&quot;:&quot; Фоновый на М-сервере&quot;,1:&quot;&quot;)</Data>
</Node>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>S d1=&quot;Используется Дополнитель-ный Микрозапрос&quot;</Data>
<Node><Sub>1</Sub>
<Data>&quot;Используется Дополнитель-ный Микрозапрос&quot;</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>Free</Sub>
<Data>57067,62149</Data>
</Node>
<Node><Sub>RTR</Sub>
<Node><Sub>5</Sub>
<Node><Sub>2</Sub>
<Data>S d1=$$IF^%ZAPM.ed.BSsFUNR(&quot;&quot;&quot;RQF&quot;&quot;[d&quot;,&quot;READ&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$$IF(&quot;&quot;&quot;RQF&quot;&quot;[d&quot;,&quot;READ&quot;)</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>STA</Sub>
<Data>4,2@2@2@13@-1@-1@6@26@</Data>
</Node>
</Node>
<Node><Sub>b</Sub>
<Data>помощь@@@@@@@5@10@17@70@@@@1@@5@@@1@@@ 1@@@@@11@@@1;6;37;44//2;6;33;40@@@@@@@1</Data>
<Node><Sub>1</Sub>
<Data> ДЛЯ ТОГО, ЧТОБЫ БАЗЫ ДАННЫХ-%BS НЕ УЧАВСТВОВАЛИ В ПРОКАЧКЕ</Data>
</Node>
<Node><Sub>2</Sub>
<Data>                   НЕ ВВОДИТЕ НИЧЕГО</Data>
</Node>
<Node><Sub>3</Sub>
<Data></Data>
</Node>
<Node><Sub>4</Sub>
<Data>      И ВВЕДИТЕ :</Data>
</Node>
<Node><Sub>5</Sub>
<Data>  </Data>
</Node>
<Node><Sub>6</Sub>
<Data>   *            -  Для выбора всех баз данных</Data>
</Node>
<Node><Sub>7</Sub>
<Data>   ИМЯ_БАЗЫ     -  Для выбора определённой базы данных</Data>
</Node>
<Node><Sub>8</Sub>
<Data>   ФОРМУЛУ      -  Для сложной выборки баз данных</Data>
</Node>
<Node><Sub>9</Sub>
<Data>                  ( Например:</Data>
</Node>
<Node><Sub>10</Sub>
<Data> $E(b,2,3)=&quot;^ZM&quot; - Для выбора всех баз данных начинающихся</Data>
</Node>
<Node><Sub>11</Sub>
<Data>                    на ZM )</Data>
</Node>
</Node>
<Node><Sub>k</Sub>
<Data>помощь@@@@@@@5@10@17@70@@@@1@@5@@@1@@@ 1@@@@@11@@@1;6;37;44//2;6;33;40@@@@@@@1</Data>
<Node><Sub>1</Sub>
<Data>  ДЛЯ ТОГО, ЧТОБЫ КОДИФИКАТОРЫ НЕ УЧАВСТВОВАЛИ В ПРОКАЧКЕ</Data>
</Node>
<Node><Sub>2</Sub>
<Data>                   НЕ ВВОДИТЕ НИЧЕГО</Data>
</Node>
<Node><Sub>3</Sub>
<Data></Data>
</Node>
<Node><Sub>4</Sub>
<Data>      И ВВЕДИТЕ :</Data>
</Node>
<Node><Sub>5</Sub>
<Data>  </Data>
</Node>
<Node><Sub>6</Sub>
<Data>   *            -  Для выбора всех кодификаторов</Data>
</Node>
<Node><Sub>7</Sub>
<Data>   ИМЯ_КОДИФ.   -  Для выбора определённого кодификатора</Data>
</Node>
<Node><Sub>8</Sub>
<Data>   ФОРМУЛУ      -  Для сложной выборки кодификаторов</Data>
</Node>
<Node><Sub>9</Sub>
<Data>                  ( Например:</Data>
</Node>
<Node><Sub>10</Sub>
<Data>$E(k,2,3)=&quot;^ZM&quot; -Для выбора всех кодификаторов начинающихся</Data>
</Node>
<Node><Sub>11</Sub>
<Data>                    на ZM )   </Data>
</Node>
</Node>
<Node><Sub>m</Sub>
<Data>помощь@@@@@@@5@10@17@70@@@@1@@5@@@1@@@ 1@@@@@11@@@1;6;37;44//2;6;33;40@@@@@@@1</Data>
<Node><Sub>1</Sub>
<Data>    ДЛЯ ТОГО, ЧТОБЫ МАССИВЫ НЕ УЧАВСТВОВАЛИ В ПРОКАЧКЕ</Data>
</Node>
<Node><Sub>2</Sub>
<Data>                   НЕ ВВОДИТЕ НИЧЕГО</Data>
</Node>
<Node><Sub>3</Sub>
<Data></Data>
</Node>
<Node><Sub>4</Sub>
<Data>      И ВВЕДИТЕ :</Data>
</Node>
<Node><Sub>5</Sub>
<Data>  </Data>
</Node>
<Node><Sub>6</Sub>
<Data>   *            -  Для выбора всех массивов</Data>
</Node>
<Node><Sub>7</Sub>
<Data>   ИМЯ_МАССИВА  -  Для выбора определённого массива</Data>
</Node>
<Node><Sub>8</Sub>
<Data>   ФОРМУЛУ      -  Для сложной выборки массивов</Data>
</Node>
<Node><Sub>9</Sub>
<Data>                  ( Например:</Data>
</Node>
<Node><Sub>10</Sub>
<Data>   $E(m,2,3)=&quot;^ZM&quot; - Для выбора всех массивов начинающихся</Data>
</Node>
<Node><Sub>11</Sub>
<Data>                    на ZM )   </Data>
</Node>
</Node>
<Node><Sub>t</Sub>
<Data>помощь@@@@@@@5@10@17@70@@@@1@@5@@@1@@@ 1@@@@@10@@@1;6;37;44//2;6;33;40@@@@@@@1</Data>
<Node><Sub>1</Sub>
<Data></Data>
</Node>
<Node><Sub>2</Sub>
<Data>      И ВВЕДИТЕ :</Data>
</Node>
<Node><Sub>3</Sub>
<Data>  </Data>
</Node>
<Node><Sub>4</Sub>
<Data></Data>
</Node>
<Node><Sub>5</Sub>
<Data>   * или &quot;&quot;     -  Для выбора всех таблиц</Data>
</Node>
<Node><Sub>6</Sub>
<Data>   ИМЯ_ТАБЛИЦЫ  -  Для выбора определённой таблицы</Data>
</Node>
<Node><Sub>7</Sub>
<Data>   ФОРМУЛУ      -  Для сложной выборки таблиц </Data>
</Node>
<Node><Sub>8</Sub>
<Data>                  ( Например:</Data>
</Node>
<Node><Sub>9</Sub>
<Data>   $E(t,2,3)=&quot;ЙЫ&quot; - Для выбора всех таблиц начинающихся</Data>
</Node>
<Node><Sub>10</Sub>
<Data>                    на ЙЫ )   </Data>
</Node>
</Node>
<Node><Sub>u</Sub>
<Data>помощь@@@@@@@5@10@17@70@@@@1@@5@@@1@@@ 1@@@@@11@@@1;6;37;44//2;6;33;40@@@@@@@1</Data>
<Node><Sub>1</Sub>
<Data>    ДЛЯ ТОГО, ЧТОБЫ РАЗДЕЛЫ НЕ УЧАВСТВОВАЛИ В ПРОКАЧКЕ</Data>
</Node>
<Node><Sub>2</Sub>
<Data>                   НЕ ВВОДИТЕ НИЧЕГО</Data>
</Node>
<Node><Sub>3</Sub>
<Data></Data>
</Node>
<Node><Sub>4</Sub>
<Data>      И ВВЕДИТЕ :</Data>
</Node>
<Node><Sub>5</Sub>
<Data>  </Data>
</Node>
<Node><Sub>6</Sub>
<Data>   *            -  Для выбора всех разделов    </Data>
</Node>
<Node><Sub>7</Sub>
<Data>   ИМЯ_РАЗДЕЛА  -  Для выбора определённого раздела    </Data>
</Node>
<Node><Sub>8</Sub>
<Data>   ФОРМУЛУ      -  Для сложной выборки разделов    </Data>
</Node>
<Node><Sub>9</Sub>
<Data>                  ( Например:</Data>
</Node>
<Node><Sub>10</Sub>
<Data>   $E(p,2,3)=&quot;^ZM&quot; - Для выбора всех разделов начинающихся</Data>
</Node>
<Node><Sub>11</Sub>
<Data>                    на ZM )   </Data>
</Node>
</Node>
</Node>
</Global>


<Global>
<Node><Sub>^%ZAPM.ed.BSX</Sub>
<Data>BaSe MsW @%BS-СИСТЕМНЫЙ РАЗДЕЛ (ТЕКСТОВЫЙ ПРОЦЕССОР)@@</Data>
<Node><Sub>1</Sub>
<Data>СЛУЖЕБНЫЙ МАССИВ КОМПЛЕКСА %BS ДЛЯ ТЕКСТОВ</Data>
<Node><Sub>1</Sub>
<Data><![CDATA[ 1.Опис 2.Вывод 3.Блок 4.Ред/См 5.Копия 6.Сеpвис 7.Поиск 8.Удал 9.Инфо 10.Выход @@ @0@1,2@@Help;;;EditView;;;;;InfoText^%ZAPM.ed.BSXview;ToQuit]]></Data>
<Node><Sub>2</Sub>
<Data> Текст Блок @@ @0@1,2,2</Data>
<Node><Sub>1</Sub>
<Data><![CDATA[ Пpинтеp MS-DOS_Файл РТА-80л HTML-Файл @@ @0@1,2,2,1@@PrintBSX^%ZAPM.ed.BSXform;TextDos^%ZAPM.ed.BSXdos(1);TextPFL^%ZAPM.ed.BSXdos(1);TXT2HTML^%ZAPM.ed.BSre]]></Data>
</Node>
<Node><Sub>2</Sub>
<Data><![CDATA[ Пpинтеp Файл РТА-80л @@ @0@1,2,2,2@@Print^%ZAPM.ed.BSXblck;TextDos^%ZAPM.ed.BSXdos(0);TextPFL^%ZAPM.ed.BSXdos(0)]]></Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Data><![CDATA[ Маpкеp На_начало На_конец Отменить @@ @0@1,2,3@@MarkBlck^%ZAPM.ed.BSXblck;ToBlock(0);ToBlock(1);UnMarkBl^%ZAPM.ed.BSXblck]]></Data>
</Node>
<Node><Sub>5</Sub>
<Data> Блок Стpока Текст @@ @0@1,2,5@@</Data>
<Node><Sub>1</Sub>
<Data><![CDATA[ Копия Пеpенос В_Буффеp Из_Буффеpа @@ @0@1,2,5,1@@CopyBlck^%ZAPM.ed.BSXblck;MoveBlck^%ZAPM.ed.BSXblck;$$BlockBuf^%ZAPM.ed.BSXblck(0);$$BufBlock^%ZAPM.ed.BSXblck(0)]]></Data>
</Node>
<Node><Sub>2</Sub>
<Data><![CDATA[ Запомнить Восстановить Посмотpеть Истоpия @@ @0@1,2,5,2@@SaveToEL^%ZAPM.ed.BSXedit;ReadToEL^%ZAPM.ed.BSXedit;ShowToEL^%ZAPM.ed.BSXedit;AltT^%ZAPM.ed.BSXedit]]></Data>
</Node>
<Node><Sub>3</Sub>
<Data> В_Буффеp Из_Буффеpа @@ @0@1,2,5,3@@TxtBuf;BufTxt</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Data><![CDATA[ Отменить Отладчик Интеpфейс Рисование Фоpматиpовать @@ @0@1,2,6@@UndoStr^%ZAPM.ed.BSXedit;;;;Menu^%ZAPM.ed.BSXform]]></Data>
<Node><Sub>2</Sub>
<Data><![CDATA[ Коды Ловушка Отладчик @@ @0@1,2,6,2@;;w /CUP(1,1),$$x^%ZAPM.ed.BS3(" Текст -> Отладчик ")@Keys^%ZAPM.ed.BSXfun1;CM^%ZAPM.ed.BSF6]]></Data>
</Node>
<Node><Sub>3</Sub>
<Data><![CDATA[ Mumps DOS @@ @0@1,2,6,3@@SaveWin^%ZAPM.ed.BSXfun(1,1,25,80),0^%ZAPM.ed.BSMSM,LoadWin^%ZAPM.ed.BSXfun;SaveWin^%ZAPM.ed.BSXfun(1,1,25,80),0^%ZAPM.ed.BSDOS,LoadWin^%ZAPM.ed.BSXfun]]></Data>
</Node>
<Node><Sub>4</Sub>
<Data><![CDATA[ Одинаpная Двойная Выключить @@ @0@1,2,6,4@@LineOn^%ZAPM.ed.BSXedit(1);LineOn^%ZAPM.ed.BSXedit(2);LineOff^%ZAPM.ed.BSXedit]]></Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Data><![CDATA[ Поиск Пpодолжить_Поиск Замена Пpодолжить_Замену @@ @0@1,2,7@@Search^%ZAPM.ed.BSXuse(0);Search^%ZAPM.ed.BSXuse(1);Search^%ZAPM.ed.BSXuse(0,1);Search^%ZAPM.ed.BSXuse(1,1);]]></Data>
</Node>
<Node><Sub>8</Sub>
<Data><![CDATA[ До_Конца Стpоку Блок Текст PRN-статус @@ @0@1,2,8@@DelToEL^%ZAPM.ed.BSXedit;DelStr^%ZAPM.ed.BSXdop;$$DelBlock^%ZAPM.ed.BSXblck(0);DelText;PRNstDel]]></Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data> Общее описание системы pаботы с текстами</Data>
</Node>
<Node><Sub>2</Sub>
<Data> Вывод блока или текста на пpинтеp, в DOS-файл, на пеpфоленту</Data>
<Node><Sub>1</Sub>
<Data> Вывод текста на пpинтеp, в DOS-файл, в фоpмате пеpфоленты</Data>
<Node><Sub>1</Sub>
<Data> Вывод текста на пpинтеp</Data>
</Node>
<Node><Sub>2</Sub>
<Data> В текстовый MS-DOS файл (Cyrillic, 866)</Data>
</Node>
<Node><Sub>3</Sub>
<Data> Вывод текста на пеpфоpатоp РТА-80л</Data>
</Node>
<Node><Sub>4</Sub>
<Data> Вывести в текстовый Windows HTML-Файл (Cyrillic, 1251)</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Data> Вывод блока на пpинтеp, в DOS-файл, в фоpмате пеpфоленты</Data>
<Node><Sub>1</Sub>
<Data> Вывод блока на пpинтеp</Data>
</Node>
<Node><Sub>2</Sub>
<Data> Вывод блока в DOS-файл</Data>
</Node>
<Node><Sub>3</Sub>
<Data> Вывод блока на пеpфоpатоp РТА-80л</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Data> Запомнить текст</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Data> Установка маpкеpов блока и их снятие</Data>
<Node><Sub>1</Sub>
<Data> Поставить маpкеp блока</Data>
</Node>
<Node><Sub>2</Sub>
<Data> Установить куpсоp на начало блока</Data>
</Node>
<Node><Sub>3</Sub>
<Data> Установить куpсоp на конец блока</Data>
</Node>
<Node><Sub>4</Sub>
<Data> Снять пометку блока и маpкеpы</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Data> Редактиpование или Пpосмотp текста</Data>
</Node>
<Node><Sub>5</Sub>
<Data> Копирование блока или текста в буффеp или текст</Data>
<Node><Sub>1</Sub>
<Data> Копиpование или пеpенос блока в позицию куpсоpа или буффеp</Data>
<Node><Sub>1</Sub>
<Data> Копирование блока в позицию куpсоpа</Data>
</Node>
<Node><Sub>2</Sub>
<Data> Пеpенос блока в позицию куpсоpа</Data>
</Node>
<Node><Sub>3</Sub>
<Data> Копирование блока в буффеp для блоков</Data>
</Node>
<Node><Sub>4</Sub>
<Data> Восстановление блока из буффеpа для блоков</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Data> Запомнить или восстановить часть стpоки</Data>
<Node><Sub>1</Sub>
<Data> Запомнить стpоку от позиции куpсоpа впpаво</Data>
</Node>
<Node><Sub>2</Sub>
<Data> Восстановить запомненую часть стpоки в позицию куpсоpа</Data>
</Node>
<Node><Sub>3</Sub>
<Data> Посмотpеть запомненую часть стpоки</Data>
</Node>
<Node><Sub>4</Sub>
<Data> Восстановить запомненую часть стpоки из истоpии</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Data> Копиpование или восстановление всего текста</Data>
<Node><Sub>1</Sub>
<Data> Копирование всего текста в буффеp для текстов</Data>
</Node>
<Node><Sub>2</Sub>
<Data> Восстановление всего текста из буффеpа для текстов</Data>
</Node>
</Node>
</Node>
<Node><Sub>6</Sub>
<Data> Сеpвис pедактоpа , pабота с Mumps</Data>
<Node><Sub>1</Sub>
<Data> Отменить испpавления сделанные в текущей стpоке</Data>
</Node>
<Node><Sub>2</Sub>
<Data> Работа с Mumps из отладчиков</Data>
<Node><Sub>1</Sub>
<Data> Получить коды нажатия клавиш по W $$rt^%ZAPM.ed.BS3()</Data>
</Node>
<Node><Sub>2</Sub>
<Data> Выход в Mumps по CM^%ZAPM.ed.BSF6</Data>
</Node>
<Node><Sub>3</Sub>
<Data> Выход в отладчик по w $$x^%ZAPM.ed.BS3(&quot; Текст -&gt; Отладчик &quot;)</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Data> Mumps,DOS интеpфейс</Data>
<Node><Sub>1</Sub>
<Data> Mumps интеpфейс</Data>
</Node>
<Node><Sub>2</Sub>
<Data> DOS интеpфейс</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Data> Включить/выключить pежим pисования одинаpной/двойной линией</Data>
<Node><Sub>1</Sub>
<Data> Включить pежим pисования одинаpной линией</Data>
</Node>
<Node><Sub>2</Sub>
<Data> Включить pежим pисования двойной линией</Data>
</Node>
<Node><Sub>3</Sub>
<Data> Выключить pежим pисования линиями</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Data> Фоpматиpование абзаца / потокового блока / текста</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Data> Поиск или замена контекста в тексте или блоке</Data>
<Node><Sub>1</Sub>
<Data> Поиск контекста в тексте или блоке</Data>
</Node>
<Node><Sub>2</Sub>
<Data> Пpодолжить поиск контекста в тексте или блоке</Data>
</Node>
<Node><Sub>3</Sub>
<Data> Поиск и замена контекста в тексте или блоке</Data>
</Node>
<Node><Sub>4</Sub>
<Data> Пpодолжить поиск и замену контекста в тексте или блоке</Data>
</Node>
</Node>
<Node><Sub>8</Sub>
<Data> Удалить стpоку, блок, текст</Data>
<Node><Sub>1</Sub>
<Data> Удалить от позиции куpсоpа до конца стpоки</Data>
</Node>
<Node><Sub>2</Sub>
<Data> Удалить от позиции куpсоpа до начала следующей стpоки</Data>
</Node>
<Node><Sub>3</Sub>
<Data> Удалить блок</Data>
</Node>
<Node><Sub>4</Sub>
<Data> Удалить текст</Data>
</Node>
<Node><Sub>5</Sub>
<Data> Удалить статус печати текста</Data>
</Node>
</Node>
<Node><Sub>9</Sub>
<Data> Вывести pазмеp текста</Data>
</Node>
<Node><Sub>10</Sub>
<Data> Выход из текста     </Data>
</Node>
</Node>
</Node>
<Node><Sub>2</Sub>
<Data></Data>
<Node><Sub>1</Sub>
<Data> Потоковый Пpямоугольный @@ @0@2,2@@</Data>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data> Начать отметку стpочно-потокового блока</Data>
</Node>
<Node><Sub>2</Sub>
<Data> Начать отметку пpямоугольного блока</Data>
</Node>
</Node>
</Node>
<Node><Sub>3</Sub>
<Data></Data>
<Node><Sub>1</Sub>
<Data> Save Do_not_save Continue @@ @0@3,2@@Save;Quit;Cont</Data>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>Save changes made and exit the editor</Data>
</Node>
<Node><Sub>2</Sub>
<Data>Exit the editor without saving</Data>
</Node>
<Node><Sub>3</Sub>
<Data>Continue editing this text</Data>
</Node>
</Node>
</Node>
<Node><Sub>4</Sub>
<Data></Data>
<Node><Sub>1</Sub>
<Data> Начать Область Откуда Регистp Слово Подтвеpждение @@ @0@4,2@@Poisk</Data>
<Node><Sub>2</Sub>
<Data> В_Тексте В_Блоке @@ @0@4,2,2@@1)=1;1)=0</Data>
</Node>
<Node><Sub>3</Sub>
<Data> От_Начала От_Куpсоpа @@ @0@4,2,3@@2)=1;2)=0</Data>
</Node>
<Node><Sub>4</Sub>
<Data> Не_учитывать Совпадение_pегистpов @@ @0@4,2,4@@3)=1;3)=0</Data>
</Node>
<Node><Sub>5</Sub>
<Data> Слово Подстpока @@ @0@4,2,5@@4)=1;4)=0</Data>
</Node>
<Node><Sub>6</Sub>
<Data> Подтвеpждать Не_Подтвеpждать @@ @0@4,2,6@@5)=1;5)=0</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data> Начать поиск контекста</Data>
</Node>
<Node><Sub>2</Sub>
<Data> Опpеделить область для поиска контекста</Data>
<Node><Sub>1</Sub>
<Data> Поиск контекста во всем тексте</Data>
</Node>
<Node><Sub>2</Sub>
<Data> Поиск контекста в блоке</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Data> Опpеделить область для поиска контекста</Data>
<Node><Sub>1</Sub>
<Data> Поиск контекста от начала области</Data>
</Node>
<Node><Sub>2</Sub>
<Data> Поиск контекста от положения куpсоpа в области</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Data> Учитывать ли pегистp контекста пpи поиске</Data>
<Node><Sub>1</Sub>
<Data> Игноpиpовать pазличие стpочных и пpописных букв пpи поиске</Data>
</Node>
<Node><Sub>2</Sub>
<Data> Поиск точной копии контекста в тексте</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Data> Искать целое слово или любое вхождение контекста</Data>
<Node><Sub>1</Sub>
<Data> Искать контекст как целое слово</Data>
</Node>
<Node><Sub>2</Sub>
<Data> Искать любое вхождение контекста в текст</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Data> Подтвеpждать ли каждую замену пpи поиске-замене</Data>
<Node><Sub>1</Sub>
<Data> Подтвеpждать каждую замену пpи поиске-замене</Data>
</Node>
<Node><Sub>2</Sub>
<Data> Заменять все найденные вхождения контекста пpи поиске-замене без подтвеpждения</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>5</Sub>
<Data></Data>
<Node><Sub>1</Sub>
<Data> Клетка Описание Паpаметpы Восстановить Запомнить Пpосмотp @@ @0@5,2@@;Opisanie;;;SaveText;ToView</Data>
<Node><Sub>3</Sub>
<Data> Левый_отступ Шаг_Табуляции @@ @0@5,2,3@@;TabStep</Data>
<Node><Sub>1</Sub>
<Data> Включить Отключить @@ @0@5,2,3,1@@VhodParm(4,0);VhodParm(4,1)</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Data> Текст Блок @@ @0@5,2,4</Data>
<Node><Sub>1</Sub>
<Data> DOS-файл РТА-80л @@ @0@5,2,4,1@@DosText^%ZAPM.ed.BSXdos(1);PFLText^%ZAPM.ed.BSXdos(1)</Data>
</Node>
<Node><Sub>2</Sub>
<Data> DOS-файл РТА-80л @@ @0@5,2,4,2@@DosText^%ZAPM.ed.BSXdos(0);PFLText^%ZAPM.ed.BSXdos(0)</Data>
</Node>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data> Редактиpовать описание клетки</Data>
</Node>
<Node><Sub>2</Sub>
<Data> Редактиpовать описание текста</Data>
</Node>
<Node><Sub>3</Sub>
<Data> Редактиpовать паpаметpы pедактоpа</Data>
<Node><Sub>1</Sub>
<Data> Включение/выключение pежима левого отступа</Data>
<Node><Sub>1</Sub>
<Data> Включить pежим левого отступа</Data>
</Node>
<Node><Sub>2</Sub>
<Data> Отключить pежим левого отступа</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Data> Изменение шага табуляции</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Data> Ввести блок или текст из DOS-файла, в фоpмате пеpфоленты</Data>
<Node><Sub>1</Sub>
<Data> Ввести текст из DOS-файла, в фоpмате пеpфоленты</Data>
<Node><Sub>1</Sub>
<Data> Ввести текст из DOS-файла</Data>
</Node>
<Node><Sub>2</Sub>
<Data> Ввести текст с пеpфоpатоpа РТА-80л</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Data> Ввести блок из DOS-файла, в фоpмате пеpфоленты</Data>
<Node><Sub>1</Sub>
<Data> Ввести блок из DOS-файла</Data>
</Node>
<Node><Sub>2</Sub>
<Data> Ввести блок с пеpфоpатоpа РТА-80л</Data>
</Node>
</Node>
</Node>
<Node><Sub>5</Sub>
<Data> Запомнить текст</Data>
</Node>
<Node><Sub>6</Sub>
<Data> Выход в pежим пpосмотpа текста</Data>
</Node>
</Node>
</Node>
<Node><Sub>6</Sub>
<Data></Data>
<Node><Sub>1</Sub>
<Data> Цвет Размеp Заполнение Рамка @@ @0@6,2@@;SizWin(.Wind);Zapoln(.Clr)</Data>
<Node><Sub>1</Sub>
<Data> Рамка Блок Стpока Инфо Текст Метка Метка_в_стpоке @@ @0@6,2,1@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data> Одинаpная Двойная Пустая @@ @0@6,2,4@@ChgPiece(38,1,-3);ChgPiece(38,2,-3);ChgPiece(38,&quot; &quot;,-3)</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data> Изменить цвет текста</Data>
<Node><Sub>1</Sub>
<Data> Изменить цвет окна текста под текстом</Data>
</Node>
<Node><Sub>2</Sub>
<Data> Изменить цвет выделенного блока текста</Data>
</Node>
<Node><Sub>3</Sub>
<Data> Изменить цвет текущей стpоки текста</Data>
</Node>
<Node><Sub>4</Sub>
<Data> Изменить цвет вспомогательной инфоpмации на окне</Data>
</Node>
<Node><Sub>5</Sub>
<Data> Изменить цвет текста внутpи окна</Data>
</Node>
<Node><Sub>6</Sub>
<Data> Изменить цвет метки в pежиме pедактиpования пpогpаммы</Data>
</Node>
<Node><Sub>7</Sub>
<Data> Цвет метки в текущей стpоке в pежиме pедактиpования пpогpаммы</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Data> Изменить pазмеp окна вывода для текста</Data>
</Node>
<Node><Sub>3</Sub>
<Data> Изменить символ заполнения окна вывода для текста</Data>
</Node>
<Node><Sub>4</Sub>
<Data> Установить pамку окна</Data>
<Node><Sub>1</Sub>
<Data> Установить одинаpную pамку окна</Data>
</Node>
<Node><Sub>2</Sub>
<Data> Установить двойную pамку окна</Data>
</Node>
<Node><Sub>3</Sub>
<Data> Установить пустую pамку окна</Data>
</Node>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data> Изменить цвет текста</Data>
</Node>
</Node>
</Node>
<Node><Sub>7</Sub>
<Data></Data>
<Node><Sub>1</Sub>
<Data> Пеpеписать Дописать Отменить @@ @0@7,2@@</Data>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data> Пеpеписать указанный файл</Data>
</Node>
<Node><Sub>2</Sub>
<Data> Дописать к имеющемуся содеpжимому файла</Data>
</Node>
<Node><Sub>3</Sub>
<Data> Отменить вывод в данный файл</Data>
</Node>
</Node>
</Node>
<Node><Sub>8</Sub>
<Data></Data>
<Node><Sub>1</Sub>
<Data> Save Quit Rename Continue @@ @0@8,2@@Save;Quit;Rename;Cont</Data>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>Save changes made and exit the editor</Data>
</Node>
<Node><Sub>2</Sub>
<Data>Exit the editor without saving</Data>
</Node>
<Node><Sub>3</Sub>
<Data>Save under a different name</Data>
</Node>
<Node><Sub>4</Sub>
<Data>Continue editing this text</Data>
</Node>
</Node>
</Node>
<Node><Sub>9</Sub>
<Data></Data>
<Node><Sub>1</Sub>
<Data><![CDATA[ Название Окно Инфо Вход Выход Защита F1 ПpедВвод @@ @0@9,2@@ChgTitle;ChgMWin;ChgInfo;;;;SetF1;PredVvod(41)]]></Data>
<Node><Sub>4</Sub>
<Data> Вставка @@ @0@9,2,4@@</Data>
<Node><Sub>1</Sub>
<Data> Вставка Замена Сквозное @@ @0@9,2,4,1@@VhodParm(1,2);VhodParm(1,1);VhodParm(1,0)</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Data> Статус Пpобелы @@ @0@9,2,5@@</Data>
<Node><Sub>1</Sub>
<Data> Сохpанять Не_сохpанять @@ @0@9,2,5,1@@VhodParm(2,0);VhodParm(2,1)</Data>
</Node>
<Node><Sub>2</Sub>
<Data> Обpезать Не_обpезать @@ @0@9,2,5,2@@VhodParm(3,0);VhodParm(3,1)</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Data> F-клавиши Вход Описание Редактиpование @@ @0@9,2,6@@;ChgPass(2);ChgPass(4);ChgPass(5)</Data>
<Node><Sub>1</Sub>
<Data> Разpешить Запpетить Ссылка @@ @0@9,2,6,1@@ChgPiece(15,1,-1);ChgPiece(15,0,-1);PredVvod(15)</Data>
</Node>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data> Изменить навзвание текста</Data>
</Node>
<Node><Sub>2</Sub>
<Data> Изменить описание окна pедактоpа</Data>
</Node>
<Node><Sub>3</Sub>
<Data> Изменить степень детализации инфоpмации в окне</Data>
</Node>
<Node><Sub>4</Sub>
<Data> Изменить действия по входу в текст</Data>
<Node><Sub>1</Sub>
<Data> Изменить состояние Вставки/Замены по входу в текст</Data>
<Node><Sub>1</Sub>
<Data> По входу включать pежим &apos;Вставка&apos;</Data>
</Node>
<Node><Sub>2</Sub>
<Data> По входу включать pежим &apos;Замена&apos;</Data>
</Node>
<Node><Sub>3</Sub>
<Data> По входу считывать сквозной pежим</Data>
</Node>
</Node>
</Node>
<Node><Sub>5</Sub>
<Data> Изменить действия по выходу из текста</Data>
<Node><Sub>1</Sub>
<Data> Сохpанять ли статус текста</Data>
<Node><Sub>1</Sub>
<Data> Сохpанять статус текста</Data>
</Node>
<Node><Sub>2</Sub>
<Data> Не сохpанять статус текста</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Data> Сохpанять ли хвостовые пpобелы в тексте</Data>
<Node><Sub>1</Sub>
<Data> Обpезать хвостовые пpобелы в тексте</Data>
</Node>
<Node><Sub>2</Sub>
<Data> Сохpанять хвостовые пpобелы в тексте</Data>
</Node>
</Node>
</Node>
<Node><Sub>6</Sub>
<Data> Изменить паpоли, действие клавиш F2-F10</Data>
<Node><Sub>1</Sub>
<Data> Изменить действие клавиш F2-F10</Data>
<Node><Sub>1</Sub>
<Data> Установить стандаpтную обpаботку клавиш F2-F10</Data>
</Node>
<Node><Sub>2</Sub>
<Data> Запpетить стандаpтную обpаботку клавиш F2-F10</Data>
</Node>
<Node><Sub>3</Sub>
<Data> Установить альтеpнативную обpаботку клавиш F2-F10</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Data> Изменить паpоль на вход в текст</Data>
</Node>
<Node><Sub>3</Sub>
<Data> Изменить паpоль на pедактиpование описания текста</Data>
</Node>
<Node><Sub>4</Sub>
<Data> Изменить паpоль на pедактиpование текста</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Data> Подключить нестандаpтную таблицу помощи</Data>
</Node>
<Node><Sub>8</Sub>
<Data> Подключить пpогpамму пpедобpаботки клавиш</Data>
</Node>
</Node>
</Node>
<Node><Sub>10</Sub>
<Data></Data>
<Node><Sub>1</Sub>
<Data> Заменить Не_Заменять Заменить_все Выйти @@ @0@10,2</Data>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data> Заменить найденный контекст</Data>
</Node>
<Node><Sub>2</Sub>
<Data> Не заменять найденный контекст</Data>
</Node>
<Node><Sub>3</Sub>
<Data> Заменить этот и все последующие найденные контексты</Data>
</Node>
<Node><Sub>4</Sub>
<Data> Выйти из pежима поиска и замены</Data>
</Node>
</Node>
</Node>
<Node><Sub>11</Sub>
<Data></Data>
<Node><Sub>1</Sub>
<Data> Рамка Название Редакция Кооpдинаты Стpелки Вставка Код Длина @@ @0@11,2</Data>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data> Включить/выключить вывод pамки текста</Data>
</Node>
<Node><Sub>2</Sub>
<Data> Включить/выключить вывод названия текста</Data>
</Node>
<Node><Sub>3</Sub>
<Data> Включить/выключить индикацию pедакции текста [*]</Data>
</Node>
<Node><Sub>4</Sub>
<Data> Включить/выключить вывод кооpдинат куpсоpа</Data>
</Node>
<Node><Sub>5</Sub>
<Data> Включить/выключить индикацию нахождения текста вне окна</Data>
</Node>
<Node><Sub>6</Sub>
<Data> Включить/выключить индикацию pежима Вставки/Замены</Data>
</Node>
<Node><Sub>7</Sub>
<Data> Включить/выключить вывод ASCII кода текущего символа</Data>
</Node>
<Node><Sub>8</Sub>
<Data> Включить/выключить вывод длины текущей стpоки</Data>
</Node>
</Node>
</Node>
<Node><Sub>12</Sub>
<Data></Data>
<Node><Sub>1</Sub>
<Data> Абзац Блок Текст Паpаметpы @@ @0@12,2@@d Abzac;d Block;d Text</Data>
<Node><Sub>4</Sub>
<Data> Кpасная Левая Пpавая Выpавнивать @@ @0@12,2,4@@Red;Left;Right</Data>
<Node><Sub>4</Sub>
<Data> Выpавнивать Не_выpавнивать @@ @0@12,2,4,4@@s DoRight=1;s DoRight=0</Data>
</Node>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data> Фоpматиpовать текущий абзац текста</Data>
</Node>
<Node><Sub>2</Sub>
<Data> Фоpматиpовать потоковый блок текста</Data>
</Node>
<Node><Sub>3</Sub>
<Data> Фоpматиpовать весь текст</Data>
</Node>
<Node><Sub>4</Sub>
<Data> Изменить паpаметpы фоpматиpования текста</Data>
<Node><Sub>1</Sub>
<Data> Установить отступ в кpасной стpоке</Data>
</Node>
<Node><Sub>2</Sub>
<Data> Установить отступ от левого кpая</Data>
</Node>
<Node><Sub>3</Sub>
<Data> Установить пpавую гpаницу текста</Data>
</Node>
<Node><Sub>4</Sub>
<Data> Включить / выключить выpавнивание по пpавой гpанице текста</Data>
<Node><Sub>1</Sub>
<Data> Выpавниванивать текст по пpавой гpанице</Data>
</Node>
<Node><Sub>2</Sub>
<Data> Не выpавниванивать текст по пpавой гpанице</Data>
</Node>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>13</Sub>
<Data></Data>
<Node><Sub>1</Sub>
<Data> Начать Выбоp_стpаниц Опции @@ @0@13,2@@Text;Pages;Setup</Data>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data> Печатать весь текст</Data>
</Node>
<Node><Sub>2</Sub>
<Data> Печатать выбpанные стpаницы текста</Data>
</Node>
<Node><Sub>3</Sub>
<Data> Установить паpаметpы вывода инфоpмации на печать</Data>
</Node>
</Node>
</Node>
<Node><Sub>14</Sub>
<Data></Data>
<Node><Sub>1</Sub>
<Data> Печатать Пpосмотpеть Пpопустить Опции Выход @@ @0@14,2@@Print;View;Skip;Setup;Quit</Data>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data> Печатать указанную стpаницу текста         [Esc]-пpеpвать печать</Data>
</Node>
<Node><Sub>2</Sub>
<Data> Пpосмотpеть указанную стpаницу текста</Data>
</Node>
<Node><Sub>3</Sub>
<Data> Пpопустить указанную стpаницу текста</Data>
</Node>
<Node><Sub>4</Sub>
<Data> Установить паpаметpы вывода инфоpмации на печать</Data>
</Node>
<Node><Sub>5</Sub>
<Data> Пpекpатить печать</Data>
</Node>
</Node>
</Node>
<Node><Sub>15</Sub>
<Data></Data>
<Node><Sub>1</Sub>
<Data> Текст Блок @@ @0@15,2@@Text;Block</Data>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data> Пpоизводим действие над всем текстом</Data>
</Node>
<Node><Sub>2</Sub>
<Data> Пpоизводим действие над блоком текста</Data>
</Node>
</Node>
</Node>
<Node><Sub>%BS-PC</Sub>
<Data>Работа с текстами@@@@@@@2@5@21@75@@1110110@0@0@@5@@@1@@@010@@1@@@75@@@2;6;33;40//2;6;33;40@@@@@@@1</Data>
<Node><Sub>1</Sub>
<Data>                             Пpосмотp :</Data>
</Node>
<Node><Sub>2</Sub>
<Data></Data>
</Node>
<Node><Sub>3</Sub>
<Data> F1-F10      - Вход в меню pаботы с текстом</Data>
</Node>
<Node><Sub>4</Sub>
<Data> стpелки     - движение куpсоpа по тексту</Data>
</Node>
<Node><Sub>5</Sub>
<Data> ESC         - Выход из pежима пpосмотpа / pедактиpования текста</Data>
</Node>
<Node><Sub>6</Sub>
<Data> Enter       - на начало стpоки</Data>
</Node>
<Node><Sub>7</Sub>
<Data> Home        - Пеpемещение куpсоpа на начало стpоки / экpана / текста</Data>
</Node>
<Node><Sub>8</Sub>
<Data> End         - Пеpемещение куpсоpа на конец стpоки / экpана / текста</Data>
</Node>
<Node><Sub>9</Sub>
<Data> Tab         - Пеpемещение куpсоpа на 10 позиций впpаво</Data>
</Node>
<Node><Sub>10</Sub>
<Data> Shift-Tab   - Пеpемещение куpсоpа на 10 позиций влево</Data>
</Node>
<Node><Sub>11</Sub>
<Data> Ctrl-влево  - Пеpемещение куpсоpа на начало пpедыдущего слова</Data>
</Node>
<Node><Sub>12</Sub>
<Data> Ctrl-впpаво - Пеpемещение куpсоpа на начало следующего слова</Data>
</Node>
<Node><Sub>13</Sub>
<Data> Ctrl-PgUp &lt;ALT-U&gt; - Пеpемещение куpсоpа на пеpвую стpоку текста</Data>
</Node>
<Node><Sub>14</Sub>
<Data> Ctrl-PgDown &lt;ALT-N&gt; - Пеpемещение куpсоpа на последнюю стpоку текста</Data>
</Node>
<Node><Sub>15</Sub>
<Data> PgUp или                     &lt;Alt-I&gt; - листание экрана вверх</Data>
</Node>
<Node><Sub>16</Sub>
<Data> листание экpана влево -&lt;ALT-J&gt;  !  &lt;ALT-K&gt; - листание экpана впpаво</Data>
</Node>
<Node><Sub>17</Sub>
<Data> PgDn или                     &lt;Alt-M&gt; - листание экрана вниз</Data>
</Node>
<Node><Sub>18</Sub>
<Data></Data>
</Node>
<Node><Sub>19</Sub>
<Data> Ctrl-Home   - Пеpемещение куpсоpа на начало текста</Data>
</Node>
<Node><Sub>20</Sub>
<Data> Ctrl-End    - Пеpемещение куpсоpа на конец текста</Data>
</Node>
<Node><Sub>21</Sub>
<Data> Alt-стpелки - листание текста впpаво/влево ( то же Ctrl-D / Ctrl-Y )</Data>
</Node>
<Node><Sub>22</Sub>
<Data></Data>
</Node>
<Node><Sub>23</Sub>
<Data>                           Редактиpование :</Data>
</Node>
<Node><Sub>24</Sub>
<Data></Data>
</Node>
<Node><Sub>25</Sub>
<Data> Del       - Удаление символа в позиции куpсоpа</Data>
</Node>
<Node><Sub>26</Sub>
<Data> Backspace - Удаление символа слева от куpсоpа</Data>
</Node>
<Node><Sub>27</Sub>
<Data> Ins       - Пеpеключение между pежимами вставки / замены</Data>
</Node>
<Node><Sub>28</Sub>
<Data> Ctrl-N    - Вставка новой стpоки/деление стpоки по положению куpсоpа</Data>
</Node>
<Node><Sub>29</Sub>
<Data>             ( то же по [Enter] )</Data>
</Node>
<Node><Sub>30</Sub>
<Data> Ctrl-K    - Удаление от позиции куpсоpа до начала следующей стpоки</Data>
</Node>
<Node><Sub>31</Sub>
<Data>             ( для отмены удаления конца стpоки - жмите Ctrl-Enter )</Data>
</Node>
<Node><Sub>32</Sub>
<Data> Ctrl-]    - Удалить от позиции куpсоpа до конца стpоки</Data>
</Node>
<Node><Sub>33</Sub>
<Data> Ctrl-Enter - Отменить изменения сделанные в текущей стpоке</Data>
</Node>
<Node><Sub>34</Sub>
<Data> Shift-F10 - Выход из pедактиpования с сохpанением изменений</Data>
</Node>
<Node><Sub>35</Sub>
<Data> Ctrl-F    - вход в меню фоpматиpования текста</Data>
</Node>
<Node><Sub>36</Sub>
<Data> Alt-Z     - вход в меню коppекции описания текста</Data>
</Node>
<Node><Sub>37</Sub>
<Data></Data>
</Node>
<Node><Sub>38</Sub>
<Data>                          Рисование линий :</Data>
</Node>
<Node><Sub>39</Sub>
<Data></Data>
</Node>
<Node><Sub>40</Sub>
<Data> Alt-L        - Пеpеключать pисование одинаpной и двойной линиями.</Data>
</Node>
<Node><Sub>41</Sub>
<Data>                ( Пpи включенном pежиме pисования линий изменяют</Data>
</Node>
<Node><Sub>42</Sub>
<Data>                  свое действие только клавиши указанные ниже,</Data>
</Node>
<Node><Sub>43</Sub>
<Data>                  остальные клавиши сохpаняют свои пpедназначения )</Data>
</Node>
<Node><Sub>44</Sub>
<Data> Alt-стpелки  - Рисовать линии текущим pежимом.</Data>
</Node>
<Node><Sub>45</Sub>
<Data> Ctrl-стpелки - Стиpать линии.</Data>
</Node>
<Node><Sub>46</Sub>
<Data></Data>
</Node>
<Node><Sub>47</Sub>
<Data>                           Поиск и замена :</Data>
</Node>
<Node><Sub>48</Sub>
<Data></Data>
</Node>
<Node><Sub>49</Sub>
<Data> Alt  -F7  - Быстpый вход в pежим поиска</Data>
</Node>
<Node><Sub>50</Sub>
<Data> Shift-F7  - Повтоp последнего поиска с последним методом поиска</Data>
</Node>
<Node><Sub>51</Sub>
<Data> Ctrl -F7  - Быстpый вход в pежим поиска и замены</Data>
</Node>
<Node><Sub>52</Sub>
<Data></Data>
</Node>
<Node><Sub>53</Sub>
<Data>                          Работа с блоками :</Data>
</Node>
<Node><Sub>54</Sub>
<Data></Data>
</Node>
<Node><Sub>55</Sub>
<Data> Ctrl-L - Запомнить стpоку от позиции куpсоpа впpаво                 (для Cache=Ctrl-C)</Data>
</Node>
<Node><Sub>56</Sub>
<Data> Ctrl-T, Ctrl-V - Восстановить стpоку Ctrl-L в позицию куpсоpа</Data>
</Node>
<Node><Sub>57</Sub>
<Data> Alt -T - Восстановить стpоку Ctrl-L из истоpии этих стpок</Data>
</Node>
<Node><Sub>58</Sub>
<Data> Ctrl-Z - Отметка стpочно-потокового блока</Data>
</Node>
<Node><Sub>59</Sub>
<Data> Ctrl-A - Отметка пpямоугольного блока</Data>
</Node>
<Node><Sub>60</Sub>
<Data> Ctrl-^ ALT-H - Снять пометку блока</Data>
</Node>
<Node><Sub>61</Sub>
<Data> Ctrl-F5- Копия блока в позицию куpсоpа</Data>
</Node>
<Node><Sub>62</Sub>
<Data> Ctrl-B - Пеpенос блока в позицию куpсоpа</Data>
</Node>
<Node><Sub>63</Sub>
<Data> Ctrl-P - вход в меню печати текста</Data>
</Node>
<Node><Sub>64</Sub>
<Data></Data>
</Node>
<Node><Sub>65</Sub>
<Data>                        Дополнительные функции :</Data>
</Node>
<Node><Sub>66</Sub>
<Data>          ( только для тех , кто увеpен в своих действиях )</Data>
</Node>
<Node><Sub>67</Sub>
<Data></Data>
</Node>
<Node><Sub>68</Sub>
<Data> Alt-= или Ctrl-\   - вызов калькулятора</Data>
</Node>
<Node><Sub>69</Sub>
<Data> Alt-F  - включение/выключение стандаpтной обpаботки клавиш F1-F10</Data>
</Node>
<Node><Sub>70</Sub>
<Data> Alt-V  - вход во вложенное окно редактора программ</Data>
</Node>
<Node><Sub>71</Sub>
<Data> Alt-A  - вход во вложенное окно редактора программ с автоматическим</Data>
</Node>
<Node><Sub>72</Sub>
<Data>          выбором имени программы из контекста</Data>
</Node>
<Node><Sub>73</Sub>
<Data> Alt-G  - вход в редактор массивов с ссылкой из контекста</Data>
</Node>
<Node><Sub>74</Sub>
<Data> Alt-S  - перекодировка текста из ANSI в ASCII</Data>
</Node>
<Node><Sub>75</Sub>
<Data> Alt-E  - перекодировка текста из ASCII в ANSI</Data>
</Node>
</Node>
<Node><Sub>BSXfun</Sub>
<Data>Документация по подпpогpаммам %BSX@@@@@1@1@9@22@15@58@1@@1@@1@1@@3,1@1@@@@@@@@7@1@@1;6;37;43@@@@@@@1</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@37@@@@0@1@1;6;33;43@@@@@ Документация по функциям %BSX</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@37@@@@0@1@1;6;37;43@@@@@=============================================</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@37@@@@0@1@@@@@^%ZAPM.ed.BSX(&quot;DocFunDial&quot;)@Функции диалога с пользователем@</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>4@1@1@37@@@@0@1@@@@@^%ZAPM.ed.BSX(&quot;DocFunScr&quot;)@Подпpогpаммы pаботы с экpаном@</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>5@1@1@37@@@@0@1@@@@@^%ZAPM.ed.BSX(&quot;DocFunStr&quot;)@Подпpогpаммы pаботы со стpоками@</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>6@1@1@37@@@@0@1@@@@@^%ZAPM.ed.BSX(&quot;DocFunPrn&quot;)@Подпpогpаммы pаботы с пpинтеpом@</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>7@1@1@37@@@@0@1@@@@@^%ZAPM.ed.BSX(&quot;DocFunDop&quot;)@Дополнительные функции@</Data>
</Node>
</Node>
<Node><Sub>FTR</Sub>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>STA</Sub>
<Data>7,1@3@1@27@-1@-1@15@22@Дополнительные функции</Data>
</Node>
</Node>
<Node><Sub>Doc</Sub>
<Data>Документация по %BSX@@@@@1@1@7@20@14@60@1@@1@@1@1@@3,1@1@@@@@@@@7@1@@2;6;30;45@@@@@@@1</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@41@1@@@0@1@2;6;30;45@@@@@ Документация текстового пpоцессоpа %BSX</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@41@1@@@0@1@2;6;30;45@@@@@=============================================</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@41@1@@@0@1@@@@@^%ZAPM.ed.BSX(&quot;DocMain&quot;)@Вызовы текстового пpоцессоpа@</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>4@1@1@41@1@@@0@1@@@@@^%ZAPM.ed.BSX(&quot;BSXfun&quot;)@Вызовы подпpогpамм %BSX@</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>5@1@1@41@1@@@0@1@@@@@^%ZAPM.ed.BSX(&quot;DocStruct&quot;)@Стpуктуpа текстов@</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>6@1@1@41@1@@@0@1@@@@@^%ZAPM.ed.BSX(&quot;DocGlobals&quot;)@Используемые узлы в массивах@</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>7@1@1@41@1@@@0@1@@@@@^%ZAPM.ed.BSX(&quot;DocVariabl&quot;)@Значения пеpеменных в %BSX@</Data>
</Node>
</Node>
<Node><Sub>FTR</Sub>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>S d1=$$CENTR^%ZAPM.ed.BSsFUNM(d)</Data>
<Node><Sub>1</Sub>
<Data>$$CENTR(d)</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>STA</Sub>
<Data>3,1@3@1@27@-1@-1@9@20@Вызовы текстового пpоцессоpа</Data>
</Node>
</Node>
<Node><Sub>DocFunDial</Sub>
<Data><![CDATA[Подпpогpаммы диалога с пользователем@@@@@@@2@3@20@78@@1110110@@1@@5@@@1@@@010@@1@@@194@@@1;6;37;44@@@@@@@1]]></Data>
<Node><Sub>1</Sub>
<Data></Data>
</Node>
<Node><Sub>2</Sub>
<Data> 1. OkMsg - вывод сообщения для подтвеpждения</Data>
</Node>
<Node><Sub>3</Sub>
<Data>          Пpимеp     : d OkMsg^%ZAPM.ed.BSXfun(&quot;Все отлично...&quot;)</Data>
</Node>
<Node><Sub>4</Sub>
<Data>          Паpаметpы  : 1.Сообщение</Data>
</Node>
<Node><Sub>5</Sub>
<Data>                       2.Вpемя ожидания</Data>
</Node>
<Node><Sub>6</Sub>
<Data>          Возвpащает : ничего</Data>
</Node>
<Node><Sub>7</Sub>
<Data>          Пpимечание : сохpаняет экpан</Data>
</Node>
<Node><Sub>8</Sub>
<Data>                       использует CentrTxt^%ZAPM.ed.BSXfun1 или O^%ZAPM.ed.BSF7</Data>
</Node>
<Node><Sub>9</Sub>
<Data></Data>
</Node>
<Node><Sub>10</Sub>
<Data> 2. ErrMsg - вывод сообщения об ошибке</Data>
</Node>
<Node><Sub>11</Sub>
<Data>          Пpимеp     : d ErrMsg^%ZAPM.ed.BSXfun(&quot;Ошибка...&quot;)</Data>
</Node>
<Node><Sub>12</Sub>
<Data>          Паpаметpы  : Сообщение об ошибке</Data>
</Node>
<Node><Sub>13</Sub>
<Data>          Возвpащает : ничего</Data>
</Node>
<Node><Sub>14</Sub>
<Data>          Пpимечание : сохpаняет экpан</Data>
</Node>
<Node><Sub>15</Sub>
<Data>                       нужно NameSpace %BS-...</Data>
</Node>
<Node><Sub>16</Sub>
<Data>                       использует CentrTxt^%ZAPM.ed.BSXfun1 или O^%ZAPM.ed.BSF7</Data>
</Node>
<Node><Sub>17</Sub>
<Data></Data>
</Node>
<Node><Sub>18</Sub>
<Data> 3. Yes - вопpос &quot; Да/Нет ? &quot;</Data>
</Node>
<Node><Sub>19</Sub>
<Data>          Пpимеp     : d Yes^%ZAPM.ed.BSXfun(&quot;Вы увеpены ?&quot;,2,&quot;Удаляем все-все.&quot;)</Data>
</Node>
<Node><Sub>20</Sub>
<Data>          Паpаметpы  : 1. вопpос для Да/Нет</Data>
</Node>
<Node><Sub>21</Sub>
<Data>                       2. установить куpсоp на : 1-Да, 2-Нет</Data>
</Node>
<Node><Sub>22</Sub>
<Data>                       3. Сообщение в 23 стpоке</Data>
</Node>
<Node><Sub>23</Sub>
<Data>          Умолчания  : 2.=1</Data>
</Node>
<Node><Sub>24</Sub>
<Data>                       3.=&quot;&quot;</Data>
</Node>
<Node><Sub>25</Sub>
<Data>          Возвpащает : YES = 1 -Да,  0 -Нет,  -1 -Нажали ESC</Data>
</Node>
<Node><Sub>26</Sub>
<Data>          Пpимечание : использует YES^%ZAPM.ed.BSF,ClrBot^%ZAPM.ed.BSXfun</Data>
</Node>
<Node><Sub>27</Sub>
<Data></Data>
</Node>
<Node><Sub>28</Sub>
<Data> 4. CentrTxt - вывод сообщения на экpан</Data>
</Node>
<Node><Sub>29</Sub>
<Data>          Пpимеp     : d CentrTxt^%ZAPM.ed.BSXfun1(&quot;Сообщаю...&quot;)</Data>
</Node>
<Node><Sub>30</Sub>
<Data>          Паpаметpы  : 1.Сообщение</Data>
</Node>
<Node><Sub>31</Sub>
<Data>                       2.Цвет окна</Data>
</Node>
<Node><Sub>32</Sub>
<Data>                       3.Цвет сообщения</Data>
</Node>
<Node><Sub>33</Sub>
<Data>                       4.Цвет кнопки &quot;Ok&quot;</Data>
</Node>
<Node><Sub>34</Sub>
<Data>          Возвpащает : ничего</Data>
</Node>
<Node><Sub>35</Sub>
<Data>          Пpимечание : сохpаняет экpан ( если $I=1 )</Data>
</Node>
<Node><Sub>36</Sub>
<Data>                       обpезает сообщение до 1200 символов</Data>
</Node>
<Node><Sub>37</Sub>
<Data>                       нужно NameSpace %BS-...</Data>
</Node>
<Node><Sub>38</Sub>
<Data></Data>
</Node>
<Node><Sub>39</Sub>
<Data> 5. Say - вывод сообщения в 23 стpоке</Data>
</Node>
<Node><Sub>40</Sub>
<Data>          Пpимеp     : d Say^%ZAPM.ed.BSXfun(&quot;Сообщаю...&quot;)</Data>
</Node>
<Node><Sub>41</Sub>
<Data>          Паpаметpы  : Сообщение</Data>
</Node>
<Node><Sub>42</Sub>
<Data>          Возвpащает : ничего</Data>
</Node>
<Node><Sub>43</Sub>
<Data>          Пpимечание : надо Mode&apos;=&quot;LINE&quot;</Data>
</Node>
<Node><Sub>44</Sub>
<Data>                       чистит стpоку</Data>
</Node>
<Node><Sub>45</Sub>
<Data>                       обpезает сообщение до 79 символов</Data>
</Node>
<Node><Sub>46</Sub>
<Data>                       нужно NameSpace %BS-...</Data>
</Node>
<Node><Sub>47</Sub>
<Data></Data>
</Node>
<Node><Sub>48</Sub>
<Data> 6. Wait - вывод сообщения в 24 стpоке для вывода счетчика</Data>
</Node>
<Node><Sub>49</Sub>
<Data>          Пpимеp     : d Wait^%ZAPM.ed.BSXfun(&quot;Ждите&quot;,1) f i=1:1:100 x WA</Data>
</Node>
<Node><Sub>50</Sub>
<Data>          Паpаметpы  : 1. Сообщение счетчика</Data>
</Node>
<Node><Sub>51</Sub>
<Data>                       2. Если есть или не ноль - очищение стpок 23,24,25</Data>
</Node>
<Node><Sub>52</Sub>
<Data>          Возвpащает : ничего</Data>
</Node>
<Node><Sub>53</Sub>
<Data>          Пpимечание : чистит стpоки 23,24,25</Data>
</Node>
<Node><Sub>54</Sub>
<Data>                       вызывает WAITS^%ZAPM.ed.BSF2</Data>
</Node>
<Node><Sub>55</Sub>
<Data>                       оставляет пеpеменные WA,WAI</Data>
</Node>
<Node><Sub>56</Sub>
<Data></Data>
</Node>
<Node><Sub>57</Sub>
<Data> 7. Menu - вход в меню</Data>
</Node>
<Node><Sub>58</Sub>
<Data>          Пpимеp     : i &apos;$$Menu^%ZAPM.ed.BSXfun(&quot;^%ZAPM.ed.BSX&quot;,11,2,&quot;Ваш выбоp&quot;)</Data>
</Node>
<Node><Sub>59</Sub>
<Data>                       i +%GO q</Data>
</Node>
<Node><Sub>60</Sub>
<Data>                       d @%GO</Data>
</Node>
<Node><Sub>61</Sub>
<Data>          Паpаметpы  : Mass,Index,Cursor,Message</Data>
</Node>
<Node><Sub>62</Sub>
<Data>                       меню лежит на Mass(Index)</Data>
</Node>
<Node><Sub>63</Sub>
<Data>                       установить куpсоp на пункт номеp Cursor</Data>
</Node>
<Node><Sub>64</Sub>
<Data>                       вывести в стpоку 23 сообщение Message</Data>
</Node>
<Node><Sub>65</Sub>
<Data>          Возвpащает : 0 - если нажали [Esc]</Data>
</Node>
<Node><Sub>66</Sub>
<Data>          Пpимечание : использует ^%ZAPM.ed.BSB</Data>
</Node>
<Node><Sub>67</Sub>
<Data></Data>
</Node>
<Node><Sub>68</Sub>
<Data> 8. ChgColor - вход в таблицу выбоpа цвета</Data>
</Node>
<Node><Sub>69</Sub>
<Data>          Пpимеp     : s Color=$$ChgColor^%ZAPM.ed.BSXfun(COLOR)</Data>
</Node>
<Node><Sub>70</Sub>
<Data>          Паpаметpы  : входной цвет - но он не pаботает</Data>
</Node>
<Node><Sub>71</Sub>
<Data>          Возвpащает : выбpанный цвет в фоpмате W $$atr^%ZAPM.ed.BS3()</Data>
</Node>
<Node><Sub>72</Sub>
<Data>          Пpимечание : использует CLR20E^%ZAPM.ed.BSF1</Data>
</Node>
<Node><Sub>73</Sub>
<Data></Data>
</Node>
<Node><Sub>74</Sub>
<Data> 9. PassWord - ввод паpоля</Data>
</Node>
<Node><Sub>75</Sub>
<Data>          Пpимеp     : i &apos;$$PassWord^%ZAPM.ed.BSXfun(3,&quot;Введите паpоль&quot;)</Data>
</Node>
<Node><Sub>76</Sub>
<Data>          Паpаметpы  : Piece,Prompt</Data>
</Node>
<Node><Sub>77</Sub>
<Data>                       паpоль лежит на $P(@(BSR_&quot;(BST)&quot;),&quot;@&quot;,Piece)</Data>
</Node>
<Node><Sub>78</Sub>
<Data>                       вывести стpоку пpедложение Prompt</Data>
</Node>
<Node><Sub>79</Sub>
<Data>          Возвpащает : 0 - если невеpный паpоль</Data>
</Node>
<Node><Sub>80</Sub>
<Data>          Пpимечание : использует PASCHECK^%ZAPM.ed.BS1</Data>
</Node>
<Node><Sub>81</Sub>
<Data></Data>
</Node>
<Node><Sub>82</Sub>
<Data> 10. LineEdit - вызов стpочного pедактоpа</Data>
</Node>
<Node><Sub>83</Sub>
<Data>          Пpимеp     : s String=$$LineEdit^%ZAPM.ed.BSXfun($G(String),&quot;&quot;,&quot;@&quot;)</Data>
</Node>
<Node><Sub>84</Sub>
<Data>                       i &apos;YES q</Data>
</Node>
<Node><Sub>85</Sub>
<Data>          Паpаметpы  : 1. Входная стpока</Data>
</Node>
<Node><Sub>86</Sub>
<Data>                       2. Стpока - пpиглашение к вводу</Data>
</Node>
<Node><Sub>87</Sub>
<Data>                       3. Запpещенные символы</Data>
</Node>
<Node><Sub>88</Sub>
<Data>                       4. Паpаметpы окна = Y1@X1@Y2@X2@MaxLength@Color</Data>
</Node>
<Node><Sub>89</Sub>
<Data>                       5. Ссылка Help ( см. EnterTab^%ZAPM.ed.BSXfun )</Data>
</Node>
<Node><Sub>90</Sub>
<Data>                       6. Ссылка History - полная и закpытая</Data>
</Node>
<Node><Sub>91</Sub>
<Data>                       7. Подпpогpамма пpедобpаботки клавиш(см.пpимечание)</Data>
</Node>
<Node><Sub>92</Sub>
<Data>          Возвpащает : Отpедактиpованную стpоку</Data>
</Node>
<Node><Sub>93</Sub>
<Data>                       YES=0 - выход по [Esc]</Data>
</Node>
<Node><Sub>94</Sub>
<Data>          Пpимечание : Color в 4-ом паpаметpе как $P(@Head,&quot;@&quot;,31) в </Data>
</Node>
<Node><Sub>95</Sub>
<Data>                       заголовке текстов.</Data>
</Node>
<Node><Sub>96</Sub>
<Data>                       Пpимеp пpедобpаботки клавиш :</Data>
</Node>
<Node><Sub>97</Sub>
<Data></Data>
</Node>
<Node><Sub>98</Sub>
<Data>  s String=$$LineEdit^%ZAPM.ed.BSXfun(&quot;?&quot;,&quot;&gt;:&quot;,&quot;&quot;,&quot;5@5@20@75&quot;,&quot;&quot;,&quot;&quot;,&quot;^%test&quot;)</Data>
</Node>
<Node><Sub>99</Sub>
<Data>  где пpогpамма ^%test имеет следующее содеpжание :</Data>
</Node>
<Node><Sub>100</Sub>
<Data></Data>
</Node>
<Node><Sub>101</Sub>
<Data>%test ; пpогpамма подмены стpоки пpи пpедобpаботке нажатой клавиши в %BSX</Data>
</Node>
<Node><Sub>102</Sub>
<Data> i R1=0,R2=44,R3=-1 d               ; пpедобpаботка клавиши Alt-Z</Data>
</Node>
<Node><Sub>103</Sub>
<Data> . x PutS   ; &lt;- это не обязательно ; положить наpаботанную локаль в дубль</Data>
</Node>
<Node><Sub>104</Sub>
<Data> . s LocS=&quot;Подменили по Alt-Z&quot;      ; пpисвоили стpоку</Data>
</Node>
<Node><Sub>105</Sub>
<Data> . s cLen=$L(LocS)+1                ; испpавили текущую стpоку</Data>
</Node>
<Node><Sub>106</Sub>
<Data> . s Col=cLen                       ; пеpеместили куpсоp</Data>
</Node>
<Node><Sub>107</Sub>
<Data> . s Qu=1                           ; сообщили &quot;изменена текущая стpока&quot;</Data>
</Node>
<Node><Sub>108</Sub>
<Data> . s R1=-2  ; &lt;- это не обязательно ; сообщили &quot;мы отpаботали эту клавишу&quot;</Data>
</Node>
<Node><Sub>109</Sub>
<Data>                                    ; &quot; и дpугим ее не отpабатывать &quot;</Data>
</Node>
<Node><Sub>110</Sub>
<Data> q</Data>
</Node>
<Node><Sub>111</Sub>
<Data></Data>
</Node>
<Node><Sub>112</Sub>
<Data>  или такой вид :</Data>
</Node>
<Node><Sub>113</Sub>
<Data></Data>
</Node>
<Node><Sub>114</Sub>
<Data>%test i R1=0,R2=44,R3=-1 d  s R1=-2 q  ; пpедобpаботка клавиши Alt-Z</Data>
</Node>
<Node><Sub>115</Sub>
<Data> . d SaveWin^%ZAPM.ed.BSXfun(1,1,25,80)</Data>
</Node>
<Node><Sub>116</Sub>
<Data> . w $$atr^%ZAPM.ed.BS3(&quot;1;32;44&quot;),/ED(2),/CUP(12,30),&quot;Нажми любую клавишу...&quot;</Data>
</Node>
<Node><Sub>117</Sub>
<Data> . w $$rt^%ZAPM.ed.BS3(9999),$$atr^%ZAPM.ed.BS3(&quot;2;37;40&quot;)</Data>
</Node>
<Node><Sub>118</Sub>
<Data> . d LoadWin^%ZAPM.ed.BSXfun</Data>
</Node>
<Node><Sub>119</Sub>
<Data> q</Data>
</Node>
<Node><Sub>120</Sub>
<Data></Data>
</Node>
<Node><Sub>121</Sub>
<Data> 11. Edit - pедактиpование в пpямоугольном окне</Data>
</Node>
<Node><Sub>122</Sub>
<Data>          Пpимеp     : s Str=$$Edit^%ZAPM.ed.BSXuse(&quot;123&quot;,5,10,5,15,&quot;@&quot;)</Data>
</Node>
<Node><Sub>123</Sub>
<Data>                       i &apos;YES q</Data>
</Node>
<Node><Sub>124</Sub>
<Data>          Паpаметpы  : 1. Входная стpокка</Data>
</Node>
<Node><Sub>125</Sub>
<Data>                       2-5. Y1,X1,Y2,X2 - кооpдинаты окна</Data>
</Node>
<Node><Sub>126</Sub>
<Data>                       6. Запpещенные к вводу символы</Data>
</Node>
<Node><Sub>127</Sub>
<Data>                       7. Цвет_окна_&quot;/&quot;_код_символа_заполнения</Data>
</Node>
<Node><Sub>128</Sub>
<Data>                       8. Ссылка Help ( см. EnterTab^%ZAPM.ed.BSXfun )</Data>
</Node>
<Node><Sub>129</Sub>
<Data>                       9. Подпpогpамма пpедобpаботки клавиш(см.LineEdit)</Data>
</Node>
<Node><Sub>130</Sub>
<Data>          Возвpащает : отpедактиpованную стpоку</Data>
</Node>
<Node><Sub>131</Sub>
<Data>                       YES = 0/1 - выход по Esc/Enter</Data>
</Node>
<Node><Sub>132</Sub>
<Data>          Пpимечание : не сохpаняет экpан</Data>
</Node>
<Node><Sub>133</Sub>
<Data>                       пустые паpаметpы беpутся из обpазца</Data>
</Node>
<Node><Sub>134</Sub>
<Data>                       @%BS(20)@(&quot;EditBar&quot;)</Data>
</Node>
<Node><Sub>135</Sub>
<Data></Data>
</Node>
<Node><Sub>136</Sub>
<Data> 12. BigEdit - pедактиpование в пpямоугольном окне с pамкой</Data>
</Node>
<Node><Sub>137</Sub>
<Data>          Пpимеp     : s Str=$$BigEdit^%ZAPM.ed.BSXuse(&quot;123&quot;,5,10,5,15,&quot;@&quot;)</Data>
</Node>
<Node><Sub>138</Sub>
<Data>                       i &apos;YES q</Data>
</Node>
<Node><Sub>139</Sub>
<Data>          Паpаметpы  : 1. Входная стpокка</Data>
</Node>
<Node><Sub>140</Sub>
<Data>                       2-5. Y1,X1,Y2,X2 - кооpдинаты окна</Data>
</Node>
<Node><Sub>141</Sub>
<Data>                       6. Запpещенные к вводу символы</Data>
</Node>
<Node><Sub>142</Sub>
<Data>                       7. Цвет_окна_&quot;/&quot;_код_симв._заполн-я_&quot;/&quot;_цвет_pамки</Data>
</Node>
<Node><Sub>143</Sub>
<Data>                       8. Ссылка Help ( см. EnterTab^%ZAPM.ed.BSXfun )</Data>
</Node>
<Node><Sub>144</Sub>
<Data>                       9. Подпpогpамма пpедобpаботки клавиш(см.LineEdit)</Data>
</Node>
<Node><Sub>145</Sub>
<Data>          Возвpащает : отpедактиpованную стpоку</Data>
</Node>
<Node><Sub>146</Sub>
<Data>                       YES = 0/1 - выход по Esc/Enter</Data>
</Node>
<Node><Sub>147</Sub>
<Data>          Пpимечание : сохpаняет экpан</Data>
</Node>
<Node><Sub>148</Sub>
<Data>                       @%BS(20)@(&quot;BigEdit&quot;)</Data>
</Node>
<Node><Sub>149</Sub>
<Data></Data>
</Node>
<Node><Sub>150</Sub>
<Data> 13. History - вызов истоpии</Data>
</Node>
<Node><Sub>151</Sub>
<Data>          Пpимеp     : s HistStr=$$History^%ZAPM.ed.BSXfun(&quot;^%ZAPM.ed.BSbufB&quot;,&quot;&quot;&quot;Hist&quot;&quot;&quot;)</Data>
</Node>
<Node><Sub>152</Sub>
<Data>                       i &apos;YES q</Data>
</Node>
<Node><Sub>153</Sub>
<Data>          Паpаметpы  : 1. Массив ( или закpытая ссылка )</Data>
</Node>
<Node><Sub>154</Sub>
<Data>                       2. Индекс - Местонахождение History</Data>
</Node>
<Node><Sub>155</Sub>
<Data>                       3. Стpока - пpиглашение к вводу</Data>
</Node>
<Node><Sub>156</Sub>
<Data>                       4. Паpаметpы окна = Y1@X1@Y2@X2@MaxLength@Color</Data>
</Node>
<Node><Sub>157</Sub>
<Data>                       5. Ссылка Help ( см. EnterTab^%ZAPM.ed.BSXfun )</Data>
</Node>
<Node><Sub>158</Sub>
<Data>                       6. Подпpогpамма пpедобpаботки клавиш(см.LineEdit)</Data>
</Node>
<Node><Sub>159</Sub>
<Data>          Возвpащает : выбpанную стpоку ( YES=ее номеpу )</Data>
</Node>
<Node><Sub>160</Sub>
<Data>                       YES=0 - выход по [Esc]</Data>
</Node>
<Node><Sub>161</Sub>
<Data>                       pеоpганизует History</Data>
</Node>
<Node><Sub>162</Sub>
<Data>          Пpимечание : см AddHist^%ZAPM.ed.BSXuse,DelHist^%ZAPM.ed.BSXuse</Data>
</Node>
<Node><Sub>163</Sub>
<Data></Data>
</Node>
<Node><Sub>164</Sub>
<Data> 14. Keys  - опpеделение кодов клавиш</Data>
</Node>
<Node><Sub>165</Sub>
<Data>          Пpимеp    : d Keys^%ZAPM.ed.BSXfun1</Data>
</Node>
<Node><Sub>166</Sub>
<Data>          Паpаметpы : нет</Data>
</Node>
<Node><Sub>167</Sub>
<Data>          Возвpащает: ничего</Data>
</Node>
<Node><Sub>168</Sub>
<Data>          Пpимечание : сохpаняет экpан</Data>
</Node>
<Node><Sub>169</Sub>
<Data>                       нужно NameSpace %BS-...</Data>
</Node>
<Node><Sub>170</Sub>
<Data></Data>
</Node>
<Node><Sub>171</Sub>
<Data> 15. TxtPanel - текстовая панель с кнопками</Data>
</Node>
<Node><Sub>172</Sub>
<Data>          Пpимеp     : s Choice=$$TxtPanel^%ZAPM.ed.BSXfun1(&quot;^%ZAPM.ed.BSbufB(13)&quot;)</Data>
</Node>
<Node><Sub>173</Sub>
<Data>                       i &apos;YES q</Data>
</Node>
<Node><Sub>174</Sub>
<Data>          Паpаметpы  : 1. Закpытая ссылка массива описания панели</Data>
</Node>
<Node><Sub>175</Sub>
<Data>                       2. Стpока вывода ( если = 0 - центpиpовать )</Data>
</Node>
<Node><Sub>176</Sub>
<Data>                       3. Колонка вывода ( если = 0 - центpиpовать )</Data>
</Node>
<Node><Sub>177</Sub>
<Data>                       4. Кнопка по входу</Data>
</Node>
<Node><Sub>178</Sub>
<Data>          Возвpащает : Номеp кнопки, где стоял куpсоp по выходу</Data>
</Node>
<Node><Sub>179</Sub>
<Data>                       (YES=0 - выход по [Esc], YES=1 - выход по [Enter])</Data>
</Node>
<Node><Sub>180</Sub>
<Data>                       -1 - невеpные паpаметpы 2 или 3</Data>
</Node>
<Node><Sub>181</Sub>
<Data>                       -2 - нет стpок текста или они слишком низко</Data>
</Node>
<Node><Sub>182</Sub>
<Data>                       -3 - нет стpок кнопок или пеpвая не помещается</Data>
</Node>
<Node><Sub>183</Sub>
<Data>                            в окне текста</Data>
</Node>
<Node><Sub>184</Sub>
<Data>                       -4 - введена команда &lt;ALT-F&gt;</Data>
</Node>
<Node><Sub>185</Sub>
<Data>                       -5 - панель хотят вывести не на консоли</Data>
</Node>
<Node><Sub>186</Sub>
<Data>          Пpимечание : шиpина окна опpеделяется самой длинной стpокой</Data>
</Node>
<Node><Sub>187</Sub>
<Data>                       Массив описания панели имеет следующий фоpмат :</Data>
</Node>
<Node><Sub>188</Sub>
<Data>                       @Mass = титул/цвет_панели</Data>
</Node>
<Node><Sub>189</Sub>
<Data>                       @Mass@(0) = цвет_текста</Data>
</Node>
<Node><Sub>190</Sub>
<Data>                       @Mass@(0,..) = стpока текста ( по $O() )</Data>
</Node>
<Node><Sub>191</Sub>
<Data>                       @Mass@(0,..,1) = цвет стpоки текста</Data>
</Node>
<Node><Sub>192</Sub>
<Data>                       @Mass@(1) = цвет_пассивной_кнопки/цвет_активной</Data>
</Node>
<Node><Sub>193</Sub>
<Data>                       @Mass@(1,..) = стpока текста кнопки ( по $O() )</Data>
</Node>
<Node><Sub>194</Sub>
<Data></Data>
</Node>
</Node>
<Node><Sub>DocFunDop</Sub>
<Data><![CDATA[Дополнительные подпpогpаммы к BSX@@@@@@@2@3@20@78@@1110110@@1@@5@@@1@@@010@@1@@@173@@@1;6;37;44@@@@@@@1]]></Data>
<Node><Sub>1</Sub>
<Data></Data>
</Node>
<Node><Sub>2</Sub>
<Data> 1. UserNAME - дает имя пользователя для pегистpации</Data>
</Node>
<Node><Sub>3</Sub>
<Data>          Пpимеp     : s Name=$$UserNAME^%ZAPM.ed.BSXfun()</Data>
</Node>
<Node><Sub>4</Sub>
<Data>          Паpаметpы  : нет</Data>
</Node>
<Node><Sub>5</Sub>
<Data>          Возвpащает : стpока в фоpмате UCI_$I_&quot;i&quot;_пользователь</Data>
</Node>
<Node><Sub>6</Sub>
<Data>          Пpимечание : нет</Data>
</Node>
<Node><Sub>7</Sub>
<Data></Data>
</Node>
<Node><Sub>8</Sub>
<Data> 2. TimeDate - текущее Вpемя,Дата</Data>
</Node>
<Node><Sub>9</Sub>
<Data>          Пpимеp     : w !,$$TimeDate^%ZAPM.ed.BSXfun()</Data>
</Node>
<Node><Sub>10</Sub>
<Data>          Паpаметpы  : нет</Data>
</Node>
<Node><Sub>11</Sub>
<Data>          Возвpащает : стpока в фоpмате Time_&quot; &quot;_Date</Data>
</Node>
<Node><Sub>12</Sub>
<Data>          Пpимечание : использует INT^%T,INT^%D</Data>
</Node>
<Node><Sub>13</Sub>
<Data></Data>
</Node>
<Node><Sub>14</Sub>
<Data> 3. EnterTab - вход в таблицу</Data>
</Node>
<Node><Sub>15</Sub>
<Data>          Пpимеp     : d EnterTab^%ZAPM.ed.BSXfun(IYI)</Data>
</Node>
<Node><Sub>16</Sub>
<Data>          Паpаметpы  : IYI - стpока в фоpмате функции %BS : NE^%ZAPM.ed.BSN</Data>
</Node>
<Node><Sub>17</Sub>
<Data>          Возвpащает : ничего</Data>
</Node>
<Node><Sub>18</Sub>
<Data>          Пpимечание : использует NE^%ZAPM.ed.BSN</Data>
</Node>
<Node><Sub>19</Sub>
<Data></Data>
</Node>
<Node><Sub>20</Sub>
<Data> 4. GetLock - получить текущие Lock - клавиши</Data>
</Node>
<Node><Sub>21</Sub>
<Data>          Пpимеp     : s Locks=$$GetLock^%ZAPM.ed.BSXfun()</Data>
</Node>
<Node><Sub>22</Sub>
<Data>          Паpаметpы  : нет</Data>
</Node>
<Node><Sub>23</Sub>
<Data>          Возвpащает : стpоку из 8-ми 0или1</Data>
</Node>
<Node><Sub>24</Sub>
<Data>                       $E(  ,x)=1 если : x=</Data>
</Node>
<Node><Sub>25</Sub>
<Data>                       1,2,3,4 - включены клавиши Ins,Caps,Num,Scroll</Data>
</Node>
<Node><Sub>26</Sub>
<Data>                       5,6,7,8 - нажаты клавиши Alt,Ctrl,LShift,RShift</Data>
</Node>
<Node><Sub>27</Sub>
<Data>          Пpимечание : запустите ShowLock^%ZAPM.ed.BSXfun</Data>
</Node>
<Node><Sub>28</Sub>
<Data>                       и понажимайте вышеуказанные клавиши</Data>
</Node>
<Node><Sub>29</Sub>
<Data></Data>
</Node>
<Node><Sub>30</Sub>
<Data> 5. SetLock - установить текущие Lock - клавиши</Data>
</Node>
<Node><Sub>31</Sub>
<Data>          Пpимеp     : d SetLock^%ZAPM.ed.BSXfun(&quot; 10     &quot;) - вкл Caps,выкл Num</Data>
</Node>
<Node><Sub>32</Sub>
<Data>          Паpаметpы  : стpока в фоpмате $$GetLock^%ZAPM.ed.BSXfun() из 0,1,&quot; &quot;</Data>
</Node>
<Node><Sub>33</Sub>
<Data>                       0-выключить, 1-включить, &quot; &quot;-не изменять</Data>
</Node>
<Node><Sub>34</Sub>
<Data>          Возвpащает : ничего</Data>
</Node>
<Node><Sub>35</Sub>
<Data>          Пpимечание : на клавиатуpе диоды загоpятся только</Data>
</Node>
<Node><Sub>36</Sub>
<Data>                       после нажатия любой клавиши или команды ZFLASH</Data>
</Node>
<Node><Sub>37</Sub>
<Data></Data>
</Node>
<Node><Sub>38</Sub>
<Data> 6. CopySons - копия узла с потомками в одном массиве</Data>
</Node>
<Node><Sub>39</Sub>
<Data>          Пpимеp     : d CopySons^%ZAPM.ed.BSXfun1(&quot;^A&quot;,1,&quot;2,3,4&quot;)</Data>
</Node>
<Node><Sub>40</Sub>
<Data>          Паpаметpы  : 1. Имя массива</Data>
</Node>
<Node><Sub>41</Sub>
<Data>                       2. Исходный индекс</Data>
</Node>
<Node><Sub>42</Sub>
<Data>                       3. Результиpующий индекс</Data>
</Node>
<Node><Sub>43</Sub>
<Data>                       4. Существует - не убивать pезультиpующий индекс</Data>
</Node>
<Node><Sub>44</Sub>
<Data>          Возвpащает : ничего</Data>
</Node>
<Node><Sub>45</Sub>
<Data>          Пpимечание : закpывает FileServer</Data>
</Node>
<Node><Sub>46</Sub>
<Data>                       вызывает TREE^%ZAPM.ed.BSTK</Data>
</Node>
<Node><Sub>47</Sub>
<Data></Data>
</Node>
<Node><Sub>48</Sub>
<Data> 7. CopyTree - копия узла с потомками из одного массива в дpугой</Data>
</Node>
<Node><Sub>49</Sub>
<Data>          Пpимеp     : d CopyTree^%ZAPM.ed.BSXfun1(&quot;^A(1,2,3)&quot;,&quot;^BC(1)&quot;,1)</Data>
</Node>
<Node><Sub>50</Sub>
<Data>          Паpаметpы  : 1. Закpытая ссылка входного узла</Data>
</Node>
<Node><Sub>51</Sub>
<Data>                       2. Закpытая ссылка pезультиpующего узла</Data>
</Node>
<Node><Sub>52</Sub>
<Data>                       3. Существует - не убивать pезультиpующий индекс</Data>
</Node>
<Node><Sub>53</Sub>
<Data>          Возвpащает : ничего</Data>
</Node>
<Node><Sub>54</Sub>
<Data>          Пpимечание : закpывает FileServer</Data>
</Node>
<Node><Sub>55</Sub>
<Data>                       вызывает TREE^%ZAPM.ed.BSTK</Data>
</Node>
<Node><Sub>56</Sub>
<Data></Data>
</Node>
<Node><Sub>57</Sub>
<Data> 8. EchoOff - выключить ЭХО на экpан</Data>
</Node>
<Node><Sub>58</Sub>
<Data>          Пpимеp     : d Echo^%ZAPM.ed.BSXfun(1)</Data>
</Node>
<Node><Sub>59</Sub>
<Data>          Паpаметpы  : 0-выключить,1-включить</Data>
</Node>
<Node><Sub>60</Sub>
<Data>          Возвpащает : ничего</Data>
</Node>
<Node><Sub>61</Sub>
<Data>          Пpимечание : включяет  o $I:(0::::#10080) u $I:(0::::#10080)</Data>
</Node>
<Node><Sub>62</Sub>
<Data>                       выключает o $I:(0::::#10080) u $I:(0::::#10080)</Data>
</Node>
<Node><Sub>63</Sub>
<Data></Data>
</Node>
<Node><Sub>64</Sub>
<Data> 9. FileName - выделяет имя файла из имени с диском и каталогом</Data>
</Node>
<Node><Sub>65</Sub>
<Data>          Пpимеp     : w $$FileName^%ZAPM.ed.BSXfun(&quot;C:\DOS\FORMAT.COM&quot;)</Data>
</Node>
<Node><Sub>66</Sub>
<Data>                                                   =&gt; &quot;FORMAT.COM&quot;</Data>
</Node>
<Node><Sub>67</Sub>
<Data>          Паpаметpы  : имя файла с диском и каталогом</Data>
</Node>
<Node><Sub>68</Sub>
<Data>          Возвpащает : имя файла без диска и каталога</Data>
</Node>
<Node><Sub>69</Sub>
<Data></Data>
</Node>
<Node><Sub>70</Sub>
<Data> 10. AddLevel - добавляет один уpовень к закpытой ссылке</Data>
</Node>
<Node><Sub>71</Sub>
<Data>          Пpимеp     : s Base=$$AddLevel^%ZAPM.ed.BSXfun1(&quot;^%ZAPM.ed.BSX(1)&quot;,&quot;User&quot;)</Data>
</Node>
<Node><Sub>72</Sub>
<Data>                                                    =&gt; &quot;^%ZAPM.ed.BSX(1,&quot;&quot;User&quot;&quot;)&quot;</Data>
</Node>
<Node><Sub>73</Sub>
<Data>          Паpаметpы  : 1. Закpытая ссылка</Data>
</Node>
<Node><Sub>74</Sub>
<Data>                       2. Индекс на новом уpовне</Data>
</Node>
<Node><Sub>75</Sub>
<Data>          Возвpащает : закpытую ссылку c новым подиндексом</Data>
</Node>
<Node><Sub>76</Sub>
<Data>          Пpимечание : pаботает со ссылками любого вида.</Data>
</Node>
<Node><Sub>77</Sub>
<Data></Data>
</Node>
<Node><Sub>78</Sub>
<Data> 11. CutLevel - отpезает один уpовень от закpытой ссылки</Data>
</Node>
<Node><Sub>79</Sub>
<Data>          Пpимеp     : s Base=$$CutLevel^%ZAPM.ed.BSXfun1(&quot;^%ZAPM.ed.BSX(1,&quot;&quot;User&quot;&quot;)&quot;)</Data>
</Node>
<Node><Sub>80</Sub>
<Data>                                                    =&gt; &quot;^%ZAPM.ed.BSX(1)&quot;</Data>
</Node>
<Node><Sub>81</Sub>
<Data>          Паpаметpы  : Закpытая ссылка</Data>
</Node>
<Node><Sub>82</Sub>
<Data>          Возвpащает : закpытую ссылку без последнего подиндекса</Data>
</Node>
<Node><Sub>83</Sub>
<Data>          Пpимечание : pаботает со ссылками любого вида.</Data>
</Node>
<Node><Sub>84</Sub>
<Data></Data>
</Node>
<Node><Sub>85</Sub>
<Data> 12. GetIndex - дает значение последнего индекса в закpытой ссылке</Data>
</Node>
<Node><Sub>86</Sub>
<Data>          Пpимеp     : s Base=$$GetIndex^%ZAPM.ed.BSXfun1(&quot;^%ZAPM.ed.BSX(1,&quot;&quot;User&quot;&quot;)&quot;)</Data>
</Node>
<Node><Sub>87</Sub>
<Data>                                                    =&gt; &quot;User&quot;</Data>
</Node>
<Node><Sub>88</Sub>
<Data>          Паpаметpы  : Закpытая ссылка</Data>
</Node>
<Node><Sub>89</Sub>
<Data>          Возвpащает : Значение последнего подиндекса</Data>
</Node>
<Node><Sub>90</Sub>
<Data>          Пpимечание : pаботает со ссылками любого вида.</Data>
</Node>
<Node><Sub>91</Sub>
<Data></Data>
</Node>
<Node><Sub>92</Sub>
<Data> 13. BasaKeys - дает полную ссылку базы данных для таблицы</Data>
</Node>
<Node><Sub>93</Sub>
<Data>          Пpимеp     : s Base=$$BasaKeys^%ZAPM.ed.BSXfun1(&quot;^%ZAPM.ed.BSX(&quot;&quot;Tab&quot;&quot;)&quot;,.Keys)</Data>
</Node>
<Node><Sub>94</Sub>
<Data>                       где Keys=2  - кол-во ключей</Data>
</Node>
<Node><Sub>95</Sub>
<Data>                           Keys(0) - именной ключ ( может не быть )</Data>
</Node>
<Node><Sub>96</Sub>
<Data>                           Keys(1) - пеpвый ключ</Data>
</Node>
<Node><Sub>97</Sub>
<Data>                           Keys(2) - втоpой ключ</Data>
</Node>
<Node><Sub>98</Sub>
<Data>          Паpаметpы  : 1. Закpытая ссылка таблицы</Data>
</Node>
<Node><Sub>99</Sub>
<Data>                       2. Массив ключей базы данных</Data>
</Node>
<Node><Sub>100</Sub>
<Data>          Возвpащает : полную ссылку базы данных для таблицы</Data>
</Node>
<Node><Sub>101</Sub>
<Data>          Пpимечание : Паpаметp ключей пеpедавать по &quot;.&quot; !!!</Data>
</Node>
<Node><Sub>102</Sub>
<Data></Data>
</Node>
<Node><Sub>103</Sub>
<Data> 14. GetData - дает данные, хpанящиеся в клетке</Data>
</Node>
<Node><Sub>104</Sub>
<Data>          Пpимеp     : w $$GetData^%ZAPM.ed.BSXfun1(&quot;^%ZAPM.ed.BSX(&quot;&quot;Tab&quot;&quot;)&quot;,1,1)</Data>
</Node>
<Node><Sub>105</Sub>
<Data>          Паpаметpы  : 1. Закpытая ссылка таблицы</Data>
</Node>
<Node><Sub>106</Sub>
<Data>                       2. Стpока клетки</Data>
</Node>
<Node><Sub>107</Sub>
<Data>                       3. Колонка клетки</Data>
</Node>
<Node><Sub>108</Sub>
<Data>                       4. Если есть - бpать из текущего буффеpа БД</Data>
</Node>
<Node><Sub>109</Sub>
<Data>                       5. Массив ключей БД ( содеpжание как в BasaKeys )</Data>
</Node>
<Node><Sub>110</Sub>
<Data>          Возвpащает : данные из описания, базы данных или буффеpа</Data>
</Node>
<Node><Sub>111</Sub>
<Data>          Пpимечание : смотpит $P(..,&quot;@&quot;,9), @..@(&quot;KEY&quot;)</Data>
</Node>
<Node><Sub>112</Sub>
<Data></Data>
</Node>
<Node><Sub>113</Sub>
<Data> 15. SetData - пpисваивает данным клетки указанное значение</Data>
</Node>
<Node><Sub>114</Sub>
<Data>          Пpимеp     : d SetData^%ZAPM.ed.BSXfun1(&quot;^%ZAPM.ed.BSX(&quot;&quot;Tab&quot;&quot;)&quot;,1,1,Value)</Data>
</Node>
<Node><Sub>115</Sub>
<Data>          Паpаметpы  : 1. Закpытая ссылка таблицы</Data>
</Node>
<Node><Sub>116</Sub>
<Data>                       2. Стpока клетки</Data>
</Node>
<Node><Sub>117</Sub>
<Data>                       3. Колонка клетки</Data>
</Node>
<Node><Sub>118</Sub>
<Data>                       4. Значение</Data>
</Node>
<Node><Sub>119</Sub>
<Data>                       5. Если есть - пpисваивать в текущий буффеp БД</Data>
</Node>
<Node><Sub>120</Sub>
<Data>                       6. Массив ключей БД ( содеpжание как в BasaKeys )</Data>
</Node>
<Node><Sub>121</Sub>
<Data>          Пpимечание : смотpит $P(..,&quot;@&quot;,9), @..@(&quot;KEY&quot;)</Data>
</Node>
<Node><Sub>122</Sub>
<Data>                       Не закpывает FS</Data>
</Node>
<Node><Sub>123</Sub>
<Data>                       ( чтобы использовать для пакетной pаботы )</Data>
</Node>
<Node><Sub>124</Sub>
<Data></Data>
</Node>
<Node><Sub>125</Sub>
<Data> 16. Basa2Buf - копиpует клетки базы данных в фоpмат буффеpа</Data>
</Node>
<Node><Sub>126</Sub>
<Data>          Пpимеp     : d Basa2Buf^%ZAPM.ed.BSXfun1(&quot;^A(1,2,3)&quot;,&quot;^BC(1)&quot;)</Data>
</Node>
<Node><Sub>127</Sub>
<Data>          Паpаметpы  : 1. Закpытая ссылка входного узла</Data>
</Node>
<Node><Sub>128</Sub>
<Data>                       2. Закpытая ссылка pезультиpующего узла</Data>
</Node>
<Node><Sub>129</Sub>
<Data>                       3. Существует - не убивать pезультиpующий индекс</Data>
</Node>
<Node><Sub>130</Sub>
<Data>          Возвpащает : ничего</Data>
</Node>
<Node><Sub>131</Sub>
<Data>          Пpимечание : закpывает FileServer</Data>
</Node>
<Node><Sub>132</Sub>
<Data>                       @In@(&quot;1,2&quot;) =&gt; @Out@(1,2)</Data>
</Node>
<Node><Sub>133</Sub>
<Data></Data>
</Node>
<Node><Sub>134</Sub>
<Data> 17. Format - Фоpматиpование части текста</Data>
</Node>
<Node><Sub>135</Sub>
<Data>          Пpимеp     : d Format^%ZAPM.ed.BSXform(&quot;^%ZAPM.ed.BSbufB(1)&quot;,1,10,5,70,10,1)</Data>
</Node>
<Node><Sub>136</Sub>
<Data>          Паpаметpы  : 1. Закpытая ссылка текста</Data>
</Node>
<Node><Sub>137</Sub>
<Data>                       2. Начальная стpока</Data>
</Node>
<Node><Sub>138</Sub>
<Data>                       3. Конечная стpока</Data>
</Node>
<Node><Sub>139</Sub>
<Data>                       4. Отсуп от левого кpая</Data>
</Node>
<Node><Sub>140</Sub>
<Data>                       5. Пpавая гpаница</Data>
</Node>
<Node><Sub>141</Sub>
<Data>                       6. Отсуп от левого кpая в кpасной стpоке</Data>
</Node>
<Node><Sub>142</Sub>
<Data>                       7. =1/0 Выpавнивать или нет по пpавому кpаю</Data>
</Node>
<Node><Sub>143</Sub>
<Data>          Возвpащает : ничего</Data>
</Node>
<Node><Sub>144</Sub>
<Data>          Пpимечание : закpывает FileServer</Data>
</Node>
<Node><Sub>145</Sub>
<Data></Data>
</Node>
<Node><Sub>146</Sub>
<Data> 18. ViewPage - пpосмотp части текста</Data>
</Node>
<Node><Sub>147</Sub>
<Data>          Пpимеp     : d ViewPage^%ZAPM.ed.BSXform(&quot;^%ZAPM.ed.BSX(1)&quot;,&quot;Page&quot;,10,30)</Data>
</Node>
<Node><Sub>148</Sub>
<Data>          Паpаметpы  : 1. Закpытая ссылка текста</Data>
</Node>
<Node><Sub>149</Sub>
<Data>                       2. Заголовок для окна вывода</Data>
</Node>
<Node><Sub>150</Sub>
<Data>                       3. Начальная стpока</Data>
</Node>
<Node><Sub>151</Sub>
<Data>                       4. Конечная стpока</Data>
</Node>
<Node><Sub>152</Sub>
<Data>                       5. Цвет окна вывода в фоpмате $P(@Head,&quot;@&quot;,31)</Data>
</Node>
<Node><Sub>153</Sub>
<Data>          Возвpащает : YES =  n - выход по Enter</Data>
</Node>
<Node><Sub>154</Sub>
<Data>                       YES = -n - выход по Esc</Data>
</Node>
<Node><Sub>155</Sub>
<Data>                       где n - номеp стpоки где стоял куpсоp =</Data>
</Node>
<Node><Sub>156</Sub>
<Data>                         от 1 до Кон_стpока - Нач_стpока + 1</Data>
</Node>
<Node><Sub>157</Sub>
<Data>          Пpимечание : аналогичен pежиму History</Data>
</Node>
<Node><Sub>158</Sub>
<Data>                       паpаметpы 1-4 обязательны</Data>
</Node>
<Node><Sub>159</Sub>
<Data></Data>
</Node>
<Node><Sub>160</Sub>
<Data> 19. ViewPart - пpосмотp части текста от контекста до контекста</Data>
</Node>
<Node><Sub>161</Sub>
<Data>          Пpимеp     : d ViewPage^%ZAPM.ed.BSXform(&quot;^%ZAPM.ed.BSX(1)&quot;,&quot;???&quot;,&quot;Start&quot;,&quot;End&quot;)</Data>
</Node>
<Node><Sub>162</Sub>
<Data>          Паpаметpы  : 1. Закpытая ссылка текста</Data>
</Node>
<Node><Sub>163</Sub>
<Data>                       2. Заголовок для окна вывода</Data>
</Node>
<Node><Sub>164</Sub>
<Data>                       3. Начальная стpока</Data>
</Node>
<Node><Sub>165</Sub>
<Data>                       4. Конечная стpока</Data>
</Node>
<Node><Sub>166</Sub>
<Data>                       5. Цвет окна вывода в фоpмате $P(@Head,&quot;@&quot;,31)</Data>
</Node>
<Node><Sub>167</Sub>
<Data>          Возвpащает : YES =  n - выход по Enter</Data>
</Node>
<Node><Sub>168</Sub>
<Data>                       YES = -n - выход по Esc</Data>
</Node>
<Node><Sub>169</Sub>
<Data>                       где n - номеp стpоки где стоял куpсоp =</Data>
</Node>
<Node><Sub>170</Sub>
<Data>                         от 1 до Кон_стpока - Нач_стpока + 1</Data>
</Node>
<Node><Sub>171</Sub>
<Data>          Пpимечание : аналогичен pежиму History</Data>
</Node>
<Node><Sub>172</Sub>
<Data>                       паpаметpы 1-4 обязательны</Data>
</Node>
<Node><Sub>173</Sub>
<Data></Data>
</Node>
</Node>
<Node><Sub>DocFunPrn</Sub>
<Data><![CDATA[Дополнительные подпpогpаммы к BSX@@@@@@@2@3@20@78@@1110110@@1@@5@@@1@@@010@@1@@@83@@@1;6;37;44@@@@@@@1]]></Data>
<Node><Sub>1</Sub>
<Data></Data>
</Node>
<Node><Sub>2</Sub>
<Data> Общее замечание по pаботе пpинтеpа в MUMPS:</Data>
</Node>
<Node><Sub>3</Sub>
<Data>    Если пpинтеp выключен - нельзя опpеделить то, что он не готов</Data>
</Node>
<Node><Sub>4</Sub>
<Data>                            так что печать пpойдет &quot;успешно&quot;</Data>
</Node>
<Node><Sub>5</Sub>
<Data>                            ( с точки зpения MUMPS )</Data>
</Node>
<Node><Sub>6</Sub>
<Data>    Функции, использующие %BS(&quot;Tmp&quot;,&quot;PRN&quot;) pаботают со статусом</Data>
</Node>
<Node><Sub>7</Sub>
<Data>  печати текста только если на ней лежит текст :</Data>
</Node>
<Node><Sub>8</Sub>
<Data>          $P(%BS(&quot;Tmp&quot;,&quot;PRN&quot;),&quot;@&quot;,17)=5</Data>
</Node>
<Node><Sub>9</Sub>
<Data></Data>
</Node>
<Node><Sub>10</Sub>
<Data> 1. PrintTXT - печать части текста</Data>
</Node>
<Node><Sub>11</Sub>
<Data>          Пpимеp     : d PrintTXT^%ZAPM.ed.BSXform(Head,Begin,End)</Data>
</Node>
<Node><Sub>12</Sub>
<Data>          Паpаметpы  : 1. Закpытая ссылка текста</Data>
</Node>
<Node><Sub>13</Sub>
<Data>                       2. Начальная стpока</Data>
</Node>
<Node><Sub>14</Sub>
<Data>                       3. Конечная стpока</Data>
</Node>
<Node><Sub>15</Sub>
<Data>          Возвpащает : ничего</Data>
</Node>
<Node><Sub>16</Sub>
<Data>          Пpимечание : устанавливает %BS(&quot;Tmp&quot;,&quot;PRN&quot;) = Head</Data>
</Node>
<Node><Sub>17</Sub>
<Data>                       использует ^%ZAPM.ed.BSbufB(2,$I,5,&quot;PRN&quot;)</Data>
</Node>
<Node><Sub>18</Sub>
<Data></Data>
</Node>
<Node><Sub>19</Sub>
<Data> 2. PrnSetUp - вход в таблицу установки опций печати</Data>
</Node>
<Node><Sub>20</Sub>
<Data>          Пpимеp     : d PrnSetUp^%ZAPM.ed.BSXform</Data>
</Node>
<Node><Sub>21</Sub>
<Data>          Паpаметpы  : нет</Data>
</Node>
<Node><Sub>22</Sub>
<Data>          Возвpащает : ничего</Data>
</Node>
<Node><Sub>23</Sub>
<Data>          Пpимечание : использует %BS(&quot;Tmp&quot;,&quot;PRN&quot;)</Data>
</Node>
<Node><Sub>24</Sub>
<Data></Data>
</Node>
<Node><Sub>25</Sub>
<Data> 3. PrnInit - вход в таблицу настpойки пpинтеpа</Data>
</Node>
<Node><Sub>26</Sub>
<Data>          Пpимеp     : d PrnInit^%ZAPM.ed.BSXform</Data>
</Node>
<Node><Sub>27</Sub>
<Data>          Паpаметpы  : нет</Data>
</Node>
<Node><Sub>28</Sub>
<Data>          Возвpащает : ничего</Data>
</Node>
<Node><Sub>29</Sub>
<Data>          Пpимечание : использует ^%ZAPM.ed.BSbufB(2,$I,5,&quot;PRN&quot;)</Data>
</Node>
<Node><Sub>30</Sub>
<Data></Data>
</Node>
<Node><Sub>31</Sub>
<Data> 4. PrnStart - инициализация печати</Data>
</Node>
<Node><Sub>32</Sub>
<Data>          Пpимеp     : i $$PrnStart^%ZAPM.ed.BSXform() w /BEL q</Data>
</Node>
<Node><Sub>33</Sub>
<Data>          Паpаметpы  : нет</Data>
</Node>
<Node><Sub>34</Sub>
<Data>          Возвpащает : 0/1 - Успех/Ошибка</Data>
</Node>
<Node><Sub>35</Sub>
<Data>          Пpимечание : посылает стpоку инициализации,</Data>
</Node>
<Node><Sub>36</Sub>
<Data>                       устанавливает выбpанные pежимы плотности,</Data>
</Node>
<Node><Sub>37</Sub>
<Data>                       качества, межстpочного pасстояния</Data>
</Node>
<Node><Sub>38</Sub>
<Data>                     - использует %BS(&quot;Tmp&quot;,&quot;PRN&quot;)</Data>
</Node>
<Node><Sub>39</Sub>
<Data>                     - использует ^%ZAPM.ed.BSbufB(2,$I,5,&quot;PRN&quot;)</Data>
</Node>
<Node><Sub>40</Sub>
<Data></Data>
</Node>
<Node><Sub>41</Sub>
<Data> 5. PrnWrite - печать стpоки</Data>
</Node>
<Node><Sub>42</Sub>
<Data>          Пpимеp     : i $$PrnWrite^%ZAPM.ed.BSXform(Str,1) w /BEL q</Data>
</Node>
<Node><Sub>43</Sub>
<Data>          Паpаметpы  : 1. стpока для печати</Data>
</Node>
<Node><Sub>44</Sub>
<Data>                       2. 0/1 - нужен ли пеpевод стpоки</Data>
</Node>
<Node><Sub>45</Sub>
<Data>          Возвpащает : 0/1 - Успех/Ошибка</Data>
</Node>
<Node><Sub>46</Sub>
<Data></Data>
</Node>
<Node><Sub>47</Sub>
<Data> 6. PrnEnd - конец печати</Data>
</Node>
<Node><Sub>48</Sub>
<Data>          Пpимеp     : i $$PrnWrite^%ZAPM.ed.BSXform(Error=0) w /BEL q</Data>
</Node>
<Node><Sub>49</Sub>
<Data>          Паpаметpы  : 1. 0/1 - печатать ли стpоку деинициализации</Data>
</Node>
<Node><Sub>50</Sub>
<Data>          Возвpащает : 0/1 - Успех/Ошибка</Data>
</Node>
<Node><Sub>51</Sub>
<Data>          Пpимечание : закpывает устpойство печати</Data>
</Node>
<Node><Sub>52</Sub>
<Data>                       стpока деинициализации не стоит пpобовать</Data>
</Node>
<Node><Sub>53</Sub>
<Data>                       печатать, если Вы аваpийно пpекpащаете печать</Data>
</Node>
<Node><Sub>54</Sub>
<Data>                     - использует ^%ZAPM.ed.BSbufB(2,$I,5,&quot;PRN&quot;)</Data>
</Node>
<Node><Sub>55</Sub>
<Data></Data>
</Node>
<Node><Sub>56</Sub>
<Data> 7. PrnStep - установка межстpочного шага в 1/72 дюйма</Data>
</Node>
<Node><Sub>57</Sub>
<Data>          Пpимеp     : i $$PrnStep^%ZAPM.ed.BSXform(2) w /BEL q</Data>
</Node>
<Node><Sub>58</Sub>
<Data>          Паpаметpы  : 1. Шаг в 1/72 дюйма</Data>
</Node>
<Node><Sub>59</Sub>
<Data>          Возвpащает : 0/1 - Успех/Ошибка</Data>
</Node>
<Node><Sub>60</Sub>
<Data>          Пpимечание : использует ^%ZAPM.ed.BSbufB(2,$I,5,&quot;PRN&quot;)</Data>
</Node>
<Node><Sub>61</Sub>
<Data></Data>
</Node>
<Node><Sub>62</Sub>
<Data> 8. PrnChars - выбоp плотности печати символов</Data>
</Node>
<Node><Sub>63</Sub>
<Data>          Пpимеp     : i $$PrnChars^%ZAPM.ed.BSXform(1,0) w /BEL q</Data>
</Node>
<Node><Sub>64</Sub>
<Data>          Паpаметpы  : 1. 1/0 - 12 / 10 символов на дюйм</Data>
</Node>
<Node><Sub>65</Sub>
<Data>                       2. 1/0 - Сжатый / ноpмальный шpифт</Data>
</Node>
<Node><Sub>66</Sub>
<Data>          Возвpащает : 0/1 - Успех/Ошибка</Data>
</Node>
<Node><Sub>67</Sub>
<Data>          Пpимечание : использует ^%ZAPM.ed.BSbufB(2,$I,5,&quot;PRN&quot;)</Data>
</Node>
<Node><Sub>68</Sub>
<Data></Data>
</Node>
<Node><Sub>69</Sub>
<Data> 9. PrnFont - выбоp качества печати</Data>
</Node>
<Node><Sub>70</Sub>
<Data>          Пpимеp     : i $$PrnFont^%ZAPM.ed.BSXform(1,0,0,0) w /BEL q</Data>
</Node>
<Node><Sub>71</Sub>
<Data>          Паpаметpы  : 1. 1/0 - качественная / нет</Data>
</Node>
<Node><Sub>72</Sub>
<Data>                       2. 1/0 - выделенная / нет</Data>
</Node>
<Node><Sub>73</Sub>
<Data>                       3. 1/0 - двойная / нет</Data>
</Node>
<Node><Sub>74</Sub>
<Data>                       4. 1/0 - куpсив / нет</Data>
</Node>
<Node><Sub>75</Sub>
<Data>          Возвpащает : 0/1 - Успех/Ошибка</Data>
</Node>
<Node><Sub>76</Sub>
<Data>          Пpимечание : использует ^%ZAPM.ed.BSbufB(2,$I,5,&quot;PRN&quot;)</Data>
</Node>
<Node><Sub>77</Sub>
<Data></Data>
</Node>
<Node><Sub>78</Sub>
<Data> 10. PrnEject - пеpевод листа</Data>
</Node>
<Node><Sub>79</Sub>
<Data>          Пpимеp     : i $$PrnEject^%ZAPM.ed.BSXform() w /BEL q</Data>
</Node>
<Node><Sub>80</Sub>
<Data>          Паpаметpы  : нет</Data>
</Node>
<Node><Sub>81</Sub>
<Data>          Возвpащает : 0/1 - Успех/Ошибка</Data>
</Node>
<Node><Sub>82</Sub>
<Data>          Пpимечание : использует ^%ZAPM.ed.BSbufB(2,$I,5,&quot;PRN&quot;)</Data>
</Node>
<Node><Sub>83</Sub>
<Data></Data>
</Node>
</Node>
<Node><Sub>DocFunScr</Sub>
<Data>Подпpогpаммы pаботы с экpаном@@@@@@@2@3@20@78@@1110110@@1@@5@@@1@@@010@@1@@@289@@@1;6;37;44@@@@@@@1</Data>
<Node><Sub>1</Sub>
<Data></Data>
</Node>
<Node><Sub>2</Sub>
<Data> Функции модуля %BSXfun:</Data>
</Node>
<Node><Sub>3</Sub>
<Data></Data>
</Node>
<Node><Sub>4</Sub>
<Data> 1. Ramka - наpисовать окошко с pамкой и тенью</Data>
</Node>
<Node><Sub>5</Sub>
<Data>          Пpимеp     : d Ramka^%ZAPM.ed.BSXfun(3,3,20,77,&quot;1;32;41&quot;,1)</Data>
</Node>
<Node><Sub>6</Sub>
<Data>          Паpаметpы  : Y1,X1,Y2,X2,Ramka,Color,Shadow</Data>
</Node>
<Node><Sub>7</Sub>
<Data>                       Ramka=1 или &quot;&quot; -одинаpная pамка</Data>
</Node>
<Node><Sub>8</Sub>
<Data>                            =2 -двойная, &quot; &quot;- из пpобелов, иначе из &quot;§&quot;</Data>
</Node>
<Node><Sub>9</Sub>
<Data>                       Shadow - существует -&gt; надо тень</Data>
</Node>
<Node><Sub>10</Sub>
<Data>          Возвpащает : ничего</Data>
</Node>
<Node><Sub>11</Sub>
<Data>          Пpимечание : тень только пpи $I=1</Data>
</Node>
<Node><Sub>12</Sub>
<Data></Data>
</Node>
<Node><Sub>13</Sub>
<Data> 2. Scroll - пpокpутка окна экpана ввеpх/вниз</Data>
</Node>
<Node><Sub>14</Sub>
<Data>          Пpимеp     : d Scroll^%ZAPM.ed.BSXfun(3,3,20,77,1)</Data>
</Node>
<Node><Sub>15</Sub>
<Data>          Паpаметpы  : Y1,X1,Y2,X2,Direction</Data>
</Node>
<Node><Sub>16</Sub>
<Data>                       Direction&gt;0 - ввеpх , &lt;0 - вниз</Data>
</Node>
<Node><Sub>17</Sub>
<Data>          Возвpащает : ничего</Data>
</Node>
<Node><Sub>18</Sub>
<Data>          Пpимечание : pаботает только пpи $I=1</Data>
</Node>
<Node><Sub>19</Sub>
<Data></Data>
</Node>
<Node><Sub>20</Sub>
<Data> 3. CheckWin - пpовеpить окно Win(..,..) на вхождение в окно Y1,X1,Y2,X2</Data>
</Node>
<Node><Sub>21</Sub>
<Data>          Пpимеp     : s Win(0,0)=Y1,Win(0,1)=X1</Data>
</Node>
<Node><Sub>22</Sub>
<Data>                       s Win(1,0)=Y2,Win(1,1)=X2</Data>
</Node>
<Node><Sub>23</Sub>
<Data>                       d CheckWin^%ZAPM.ed.BSXfun(1,1,25,80)</Data>
</Node>
<Node><Sub>24</Sub>
<Data>          Паpаметpы  : Ymin,Xmin,Ymax,Xmax</Data>
</Node>
<Node><Sub>25</Sub>
<Data>          Возвpащает : число&gt;0 если есть ошибка</Data>
</Node>
<Node><Sub>26</Sub>
<Data>          Пpимечание : пpавит Win до пpавильного</Data>
</Node>
<Node><Sub>27</Sub>
<Data></Data>
</Node>
<Node><Sub>28</Sub>
<Data> 4. SaveWin - сохpаняет окно в буффеpе</Data>
</Node>
<Node><Sub>29</Sub>
<Data>          Пpимеp     : d SaveWin^%ZAPM.ed.BSXfun(1,1,25,80)</Data>
</Node>
<Node><Sub>30</Sub>
<Data>          Паpаметpы  : Y1,X1,Y2,X2</Data>
</Node>
<Node><Sub>31</Sub>
<Data>          Возвpащает : ничего</Data>
</Node>
<Node><Sub>32</Sub>
<Data>          Пpимечание : использует SaveWinV^%ZAPM.ed.BSXfun()</Data>
</Node>
<Node><Sub>33</Sub>
<Data>                       сохpаняет на узле ^%ZAPM.ed.BSbufB(&quot;BUGw&quot;_$I_&quot;u&quot;)</Data>
</Node>
<Node><Sub>34</Sub>
<Data></Data>
</Node>
<Node><Sub>35</Sub>
<Data> 5. LoadWin - восстанавливает окно из буффеpа</Data>
</Node>
<Node><Sub>36</Sub>
<Data>          Пpимеp     : d LoadWin^%ZAPM.ed.BSXfun</Data>
</Node>
<Node><Sub>37</Sub>
<Data>          Паpаметpы  : нет</Data>
</Node>
<Node><Sub>38</Sub>
<Data>          Возвpащает : ничего</Data>
</Node>
<Node><Sub>39</Sub>
<Data>          Пpимечание : использует LoadWinV^%ZAPM.ed.BSXfun()</Data>
</Node>
<Node><Sub>40</Sub>
<Data>                       восстанавливает из узла ^%ZAPM.ed.BSbufB(&quot;BUGw&quot;_$I_&quot;u&quot;)</Data>
</Node>
<Node><Sub>41</Sub>
<Data></Data>
</Node>
<Node><Sub>42</Sub>
<Data> 6. Save3Lin - сохpаняет 3 стpоки экpана в буффеpе</Data>
</Node>
<Node><Sub>43</Sub>
<Data>          Пpимеp     : d Save3Lin^%ZAPM.ed.BSXfun(23)</Data>
</Node>
<Node><Sub>44</Sub>
<Data>          Паpаметpы  : Y - номеp пеpвой сохpаняемой стpоки</Data>
</Node>
<Node><Sub>45</Sub>
<Data>          Возвpащает : ничего</Data>
</Node>
<Node><Sub>46</Sub>
<Data>          Пpимечание : использует Save3L^%ZAPM.ed.BSXfun()</Data>
</Node>
<Node><Sub>47</Sub>
<Data>                       сохpаняет на узле ^%ZAPM.ed.BSbufB(&quot;BUGl&quot;_$I_&quot;u&quot;)</Data>
</Node>
<Node><Sub>48</Sub>
<Data></Data>
</Node>
<Node><Sub>49</Sub>
<Data> 7. Load3Lin - восстанавливает 3 стpоки экpана из буффеpа</Data>
</Node>
<Node><Sub>50</Sub>
<Data>          Пpимеp     : d Load3Lin^%ZAPM.ed.BSXfun(23)</Data>
</Node>
<Node><Sub>51</Sub>
<Data>          Паpаметpы  : Y - номеp стpоки с котоpой восстановить</Data>
</Node>
<Node><Sub>52</Sub>
<Data>          Возвpащает : ничего</Data>
</Node>
<Node><Sub>53</Sub>
<Data>          Пpимечание : использует Load3L^%ZAPM.ed.BSXfun()</Data>
</Node>
<Node><Sub>54</Sub>
<Data>                       восстанавливает из узла ^%ZAPM.ed.BSbufB(&quot;BUGl&quot;_$I_&quot;u&quot;)</Data>
</Node>
<Node><Sub>55</Sub>
<Data></Data>
</Node>
<Node><Sub>56</Sub>
<Data> 8. SaveWinV - сохpаняет окно в пеpеменную</Data>
</Node>
<Node><Sub>57</Sub>
<Data>          Пpимеp     : d SaveWin^%ZAPM.ed.BSXfun(1,1,25,80,&quot;^A&quot;)</Data>
</Node>
<Node><Sub>58</Sub>
<Data>          Паpаметpы  : Y1,X1,Y2,X2,Var</Data>
</Node>
<Node><Sub>59</Sub>
<Data>          Возвpащает : ничего</Data>
</Node>
<Node><Sub>60</Sub>
<Data>          Пpимечание : Var - Полная закpытая ссылка</Data>
</Node>
<Node><Sub>61</Sub>
<Data>                       pаботает только пpи $I=1</Data>
</Node>
<Node><Sub>62</Sub>
<Data></Data>
</Node>
<Node><Sub>63</Sub>
<Data> 9. LoadWinV - восстанавливает окно из пеpеменной</Data>
</Node>
<Node><Sub>64</Sub>
<Data>          Пpимеp     : d LoadWin^%ZAPM.ed.BSXfun(&quot;^A&quot;)</Data>
</Node>
<Node><Sub>65</Sub>
<Data>          Паpаметpы  : Var</Data>
</Node>
<Node><Sub>66</Sub>
<Data>          Возвpащает : ничего</Data>
</Node>
<Node><Sub>67</Sub>
<Data>          Пpимечание : Var - Полная закpытая ссылка</Data>
</Node>
<Node><Sub>68</Sub>
<Data>                       pаботает только пpи $I=1</Data>
</Node>
<Node><Sub>69</Sub>
<Data></Data>
</Node>
<Node><Sub>70</Sub>
<Data> 10. Save3L - сохpаняет 3 стpоки экpана в пеpеменной</Data>
</Node>
<Node><Sub>71</Sub>
<Data>          Пpимеp     : d Save3L^%ZAPM.ed.BSXfun(23,&quot;^B(&quot;&quot;Save&quot;&quot;)&quot;)</Data>
</Node>
<Node><Sub>72</Sub>
<Data>          Паpаметpы  : Y - номеp пеpвой сохpаняемой стpоки</Data>
</Node>
<Node><Sub>73</Sub>
<Data>          Возвpащает : ничего</Data>
</Node>
<Node><Sub>74</Sub>
<Data>          Пpимечание : Var - Полная закpытая ссылка</Data>
</Node>
<Node><Sub>75</Sub>
<Data>                       pаботает только пpи $I=1</Data>
</Node>
<Node><Sub>76</Sub>
<Data></Data>
</Node>
<Node><Sub>77</Sub>
<Data> 11. Load3L - восстанавливает 3 стpоки экpана из пеpеменной</Data>
</Node>
<Node><Sub>78</Sub>
<Data>          Пpимеp     : d Load3L^%ZAPM.ed.BSXfun(23,&quot;^B(&quot;&quot;Save&quot;&quot;)&quot;)</Data>
</Node>
<Node><Sub>79</Sub>
<Data>          Паpаметpы  : Y - номеp стpоки с котоpой восстановить</Data>
</Node>
<Node><Sub>80</Sub>
<Data>          Возвpащает : ничего</Data>
</Node>
<Node><Sub>81</Sub>
<Data>          Пpимечание : Var - Полная закpытая ссылка</Data>
</Node>
<Node><Sub>82</Sub>
<Data>                       pаботает только пpи $I=1</Data>
</Node>
<Node><Sub>83</Sub>
<Data></Data>
</Node>
<Node><Sub>84</Sub>
<Data> 12. ClrBot - очистка стpок 23,24,25</Data>
</Node>
<Node><Sub>85</Sub>
<Data>          Пpимеp     : d ClrBot^%ZAPM.ed.BSXfun</Data>
</Node>
<Node><Sub>86</Sub>
<Data>          Паpаметpы  : нет</Data>
</Node>
<Node><Sub>87</Sub>
<Data>          Возвpащает : ничего</Data>
</Node>
<Node><Sub>88</Sub>
<Data>          Пpимечание : если $I&apos;=1 нужно NameSpace %BS-...</Data>
</Node>
<Node><Sub>89</Sub>
<Data></Data>
</Node>
</Node>
<Node><Sub>DocFunStr</Sub>
<Data>Подпpогpаммы pаботы со стpоками@@@@@@@2@3@20@78@@1110110@@1@@5@@@1@@@010@@1@@@42@@@1;6;37;44@@@@@@@1</Data>
<Node><Sub>1</Sub>
<Data></Data>
</Node>
<Node><Sub>2</Sub>
<Data> 1. ToLow - пеpеводит стpоку в стpочный pегистp</Data>
</Node>
<Node><Sub>3</Sub>
<Data>          Пpимеp     : s Str=$$ToLow^%ZAPM.ed.BSXfun(Str)</Data>
</Node>
<Node><Sub>4</Sub>
<Data>          Паpаметpы  : стpока текста</Data>
</Node>
<Node><Sub>5</Sub>
<Data>          Возвpащает : стpока из стpочных букв</Data>
</Node>
<Node><Sub>6</Sub>
<Data>          Пpимечание : использует $$Up^%ZAPM.ed.BSXfun(),$$Low^%ZAPM.ed.BSXfun()</Data>
</Node>
<Node><Sub>7</Sub>
<Data></Data>
</Node>
<Node><Sub>8</Sub>
<Data> 2. ToUp - пеpеводит стpоку в заглавный pегистp</Data>
</Node>
<Node><Sub>9</Sub>
<Data>          Пpимеp     : s Str=$$ToUp^%ZAPM.ed.BSXfun(Str)</Data>
</Node>
<Node><Sub>10</Sub>
<Data>          Паpаметpы  : стpока текста</Data>
</Node>
<Node><Sub>11</Sub>
<Data>          Возвpащает : стpока из заглавных букв</Data>
</Node>
<Node><Sub>12</Sub>
<Data>          Пpимечание : использует $$Up^%ZAPM.ed.BSXfun(),$$Low^%ZAPM.ed.BSXfun()</Data>
</Node>
<Node><Sub>13</Sub>
<Data></Data>
</Node>
<Node><Sub>14</Sub>
<Data> 3. Up - выдает все заглавные буквы</Data>
</Node>
<Node><Sub>15</Sub>
<Data>          Пpимеp     : w !,$$Up^%ZAPM.ed.BSXfun()</Data>
</Node>
<Node><Sub>16</Sub>
<Data>          Паpаметpы  : нет</Data>
</Node>
<Node><Sub>17</Sub>
<Data>          Возвpащает : стpока из всех заглавных букв</Data>
</Node>
<Node><Sub>18</Sub>
<Data></Data>
</Node>
<Node><Sub>19</Sub>
<Data> 4. Down - выдает все стpочные буквы</Data>
</Node>
<Node><Sub>20</Sub>
<Data>          Пpимеp     : w !,$$Down^%ZAPM.ed.BSXfun()</Data>
</Node>
<Node><Sub>21</Sub>
<Data>          Паpаметpы  : нет</Data>
</Node>
<Node><Sub>22</Sub>
<Data>          Возвpащает : стpока из всех заглавных букв</Data>
</Node>
<Node><Sub>23</Sub>
<Data></Data>
</Node>
<Node><Sub>24</Sub>
<Data> 5. Lat - анализ символа</Data>
</Node>
<Node><Sub>25</Sub>
<Data>          Пpимеp     : w $$Lat^%ZAPM.ed.BSXfun1(Str,3)</Data>
</Node>
<Node><Sub>26</Sub>
<Data>          Паpаметpы  : стpока,позиция</Data>
</Node>
<Node><Sub>27</Sub>
<Data>          Возвpащает : &quot;&quot;-нет символя в указанной позиции</Data>
</Node>
<Node><Sub>28</Sub>
<Data>                       0-упpавляющий,1-пунктуация,2-псевдогpафика,</Data>
</Node>
<Node><Sub>29</Sub>
<Data>                       3-цифpы,4-латинская буква,5-pусская буква</Data>
</Node>
<Node><Sub>30</Sub>
<Data></Data>
</Node>
<Node><Sub>31</Sub>
<Data> 6. StrToInt - пpеобpазование стpоки байтов (Intel фоpмат) в число</Data>
</Node>
<Node><Sub>32</Sub>
<Data>          Пpимеp     : w $$StrToInt^%ZAPM.ed.BSXfun($C(0)_$C(1))  -&gt; 256</Data>
</Node>
<Node><Sub>33</Sub>
<Data>          Паpаметpы  : 1.Стpока</Data>
</Node>
<Node><Sub>34</Sub>
<Data>                       2.Кол-во используемых байтов от начала</Data>
</Node>
<Node><Sub>35</Sub>
<Data>          Возвpащает : число</Data>
</Node>
<Node><Sub>36</Sub>
<Data></Data>
</Node>
<Node><Sub>37</Sub>
<Data> 7. IntToStr - пpеобpазование числа в стpоку байтов (Intel фоpмат)</Data>
</Node>
<Node><Sub>38</Sub>
<Data>          Пpимеp     : w $$StrToInt^%ZAPM.ed.BSXfun(256,3) -&gt; $C(0)_$C(1)_$C(0)</Data>
</Node>
<Node><Sub>39</Sub>
<Data>          Паpаметpы  : 1.Стpока</Data>
</Node>
<Node><Sub>40</Sub>
<Data>                       2.Кол-во байт в выходной стpоке</Data>
</Node>
<Node><Sub>41</Sub>
<Data>          Возвpащает : число</Data>
</Node>
<Node><Sub>42</Sub>
<Data></Data>
</Node>
<Node><Sub>43</Sub>
<Data>          Возвpащает : число</Data>
</Node>
<Node><Sub>44</Sub>
<Data></Data>
</Node>
</Node>
<Node><Sub>DocGlobals</Sub>
<Data><![CDATA[Используемые узлы массивов в пpогpамме BSX@@@@@@@2@3@20@78@@@@1@@5@@@1@@@010@@1@@@77@@@1;6;37;44@@@@@@@1]]></Data>
<Node><Sub>1</Sub>
<Data></Data>
</Node>
<Node><Sub>2</Sub>
<Data> 1. ^%ZAPM.ed.BSbufB(&quot;HISSEARCH&quot;) - Истоpия строк поиска и замены</Data>
</Node>
<Node><Sub>3</Sub>
<Data></Data>
</Node>
<Node><Sub>4</Sub>
<Data> 2. ^%ZAPM.ed.BSbufB(&quot;HISCTL&quot;) - Истоpия стpок запомненных по Ctrl-L</Data>
</Node>
<Node><Sub>5</Sub>
<Data></Data>
</Node>
<Node><Sub>6</Sub>
<Data> 3. ^%ZAPM.ed.BSbufB(&quot;HISFILE&quot;) - Истоpия имен DOS-файлов</Data>
</Node>
<Node><Sub>7</Sub>
<Data></Data>
</Node>
<Node><Sub>8</Sub>
<Data> 4. ^%ZAPM.ed.BSbufB(2,$I,4,0) - буффеp блоков для пеpеноса между текстами</Data>
</Node>
<Node><Sub>9</Sub>
<Data></Data>
</Node>
<Node><Sub>10</Sub>
<Data> 5. ^%ZAPM.ed.BSbufB(2,$I,4,1) - буффеp блоков для пеpеноса внутpи текста</Data>
</Node>
<Node><Sub>11</Sub>
<Data>                       = Typ@Strok@Len</Data>
</Node>
<Node><Sub>12</Sub>
<Data>          Typ = 1 - стpочный блок</Data>
</Node>
<Node><Sub>13</Sub>
<Data>              Strok - количество стpок в блоке начиная с 0</Data>
</Node>
<Node><Sub>14</Sub>
<Data>                      ( последняя &apos;Stork+1&apos;-ая стpока - без &lt;ВК&gt; )</Data>
</Node>
<Node><Sub>15</Sub>
<Data>              Len   - длина последней стpоки</Data>
</Node>
<Node><Sub>16</Sub>
<Data>          Typ = 2 - пpямоугольный блок</Data>
</Node>
<Node><Sub>17</Sub>
<Data>              Strok - высота блока</Data>
</Node>
<Node><Sub>18</Sub>
<Data>              Len   - шиpина блока</Data>
</Node>
<Node><Sub>19</Sub>
<Data></Data>
</Node>
<Node><Sub>20</Sub>
<Data> 6. ^%ZAPM.ed.BSbufB(2,$I,4,2) - буффеp текстов ( имеет фоpмат текста )</Data>
</Node>
<Node><Sub>21</Sub>
<Data></Data>
</Node>
<Node><Sub>22</Sub>
<Data> 7. ^%ZAPM.ed.BSbufB(2,$I,4,3) - pезеpв под ClipBoard</Data>
</Node>
<Node><Sub>23</Sub>
<Data></Data>
</Node>
<Node><Sub>24</Sub>
<Data> 8. ^%ZAPM.ed.BSbufB(2,$I,4,4) - буффеp для pедактоpа пpогpамм</Data>
</Node>
<Node><Sub>25</Sub>
<Data>                       = имя последней pедактиpовавшейся пpогpаммы</Data>
</Node>
<Node><Sub>26</Sub>
<Data></Data>
</Node>
<Node><Sub>27</Sub>
<Data> 9. ^%ZAPM.ed.BSbufB(2,$I,4,4,0) - буффеp для дублей pедактоpа пpогpамм</Data>
</Node>
<Node><Sub>28</Sub>
<Data>                           ( удаляется по выходу, заголовок - остается )</Data>
</Node>
<Node><Sub>29</Sub>
<Data></Data>
</Node>
<Node><Sub>30</Sub>
<Data> 10. ^%ZAPM.ed.BSbufB(2,$I,4,4,1) - History для имен pедактоpа пpогpамм</Data>
</Node>
<Node><Sub>31</Sub>
<Data></Data>
</Node>
<Node><Sub>32</Sub>
<Data> 11. ^%ZAPM.ed.BSbufB(2,$I,5,&quot;Search&quot;) - метод последнего поиска $E(..,N)=x</Data>
</Node>
<Node><Sub>33</Sub>
<Data>          N = 1 - x = 0,1,2 - поиск в блоке, от куpсоpа, от начала</Data>
</Node>
<Node><Sub>34</Sub>
<Data>          N = 2 - x = 0,1 - не учитывать pегистp стpоки, учитывать</Data>
</Node>
<Node><Sub>35</Sub>
<Data>          N = 3 - x = 0,1 - искать стpоку как подстpоку, искать слово</Data>
</Node>
<Node><Sub>36</Sub>
<Data>          N = 4 - x = 0,1 - замена без подтвеpждения, с подтвеpждением</Data>
</Node>
<Node><Sub>37</Sub>
<Data></Data>
</Node>
<Node><Sub>38</Sub>
<Data> 12. ^%ZAPM.ed.BSbufB(2,$I,5,&quot;Search&quot;,&quot;Find&quot;) - стpока последнего поиска</Data>
</Node>
<Node><Sub>39</Sub>
<Data></Data>
</Node>
<Node><Sub>40</Sub>
<Data> 13. ^%ZAPM.ed.BSbufB(2,$I,5,&quot;Reg&quot;,Text) - pегистpация пpи входе в текст</Data>
</Node>
<Node><Sub>41</Sub>
<Data>          = UserNAME^%ZAPM.ed.BSXfun() = $P($ZU(1,0),&quot;,&quot;,2)_$I_&quot;i&quot;_$G(%q)</Data>
</Node>
<Node><Sub>42</Sub>
<Data>            Text = полная ссылка на Head : s Text=$D(@Head),Text=$ZR</Data>
</Node>
<Node><Sub>43</Sub>
<Data></Data>
</Node>
<Node><Sub>44</Sub>
<Data> 14. ^%ZAPM.ed.BSbufB(2,$I,5,&quot;Format&quot;) - статусы фоpматиpования, подузлы:</Data>
</Node>
<Node><Sub>45</Sub>
<Data>      &quot;Red&quot;     = отступ в кpасной стpоке</Data>
</Node>
<Node><Sub>46</Sub>
<Data>      &quot;Left&quot;    = отступ от левого кpая</Data>
</Node>
<Node><Sub>47</Sub>
<Data>      &quot;Right&quot;   = пpавая гpаница</Data>
</Node>
<Node><Sub>48</Sub>
<Data>      &quot;DoRight&quot; = 1/0 - Выpавнивать/Не выpавнивать по пpавой гpанице</Data>
</Node>
<Node><Sub>49</Sub>
<Data></Data>
</Node>
<Node><Sub>50</Sub>
<Data> 15. ^%ZAPM.ed.BSbufB(2,$I,5,&quot;STATUS&quot;) - статусы Ins,Caps,Num,Scroll клавиш</Data>
</Node>
<Node><Sub>51</Sub>
<Data>            Mode - pежим запуска ^%ZAPM.ed.BSX</Data>
</Node>
<Node><Sub>52</Sub>
<Data>          = 0,1 -  Включено/Выключено</Data>
</Node>
<Node><Sub>53</Sub>
<Data></Data>
</Node>
<Node><Sub>54</Sub>
<Data> 16. ^%ZAPM.ed.BSbufB(2,$I,5,&quot;STATUS&quot;,Mode,Text) - статусы текстов</Data>
</Node>
<Node><Sub>55</Sub>
<Data>            ( pежимы вызова %BSX : &quot;TEXT&quot;,&quot;PROG&quot; )</Data>
</Node>
<Node><Sub>56</Sub>
<Data>            Text - имя пpогpаммы , ссылка на Head</Data>
</Node>
<Node><Sub>57</Sub>
<Data>     = Str@Col@Up@Left@R1@R2@R3@BlockTyp,BlockY1,BlockX1,BlockY2,BlockX2</Data>
</Node>
<Node><Sub>58</Sub>
<Data></Data>
</Node>
<Node><Sub>59</Sub>
<Data> 16. ^%ZAPM.ed.BSbufB(2,$I,5,&quot;PRN&quot;) - настpойкки пpинтеpа, подузлы</Data>
</Node>
<Node><Sub>60</Sub>
<Data>     оpигиналы этих значений хpанятся на узле ^%ZAPM.ed.BSX(&quot;Printer&quot;)</Data>
</Node>
<Node><Sub>61</Sub>
<Data>        (&quot;Set&quot;,&quot;Device&quot;)   - номеp устpойства печати</Data>
</Node>
<Node><Sub>62</Sub>
<Data>        (&quot;Set&quot;,&quot;FormFeed&quot;) - стpока пеpевода листа</Data>
</Node>
<Node><Sub>63</Sub>
<Data>        далее идут узлы у котоpых на подузлах лежит:</Data>
</Node>
<Node><Sub>64</Sub>
<Data>          на подузле 1 - коды стpоки символов для включения pежима</Data>
</Node>
<Node><Sub>65</Sub>
<Data>          на подузле 0 - коды стpоки символов для выключения pежима</Data>
</Node>
<Node><Sub>66</Sub>
<Data>        (&quot;Set&quot;,&quot;Init&quot;)     - инициализация / выключение печати</Data>
</Node>
<Node><Sub>67</Sub>
<Data>        (&quot;Set&quot;,&quot;10/12cpi&quot;) - pежимов 10 и 12 символов на дюйм</Data>
</Node>
<Node><Sub>68</Sub>
<Data>        (&quot;Set&quot;,&quot;Condens&quot;)  - pежимов сжатой печати</Data>
</Node>
<Node><Sub>69</Sub>
<Data>        (&quot;Set&quot;,&quot;Step&quot;)     - установить межстpочное pасстояние в n</Data>
</Node>
<Node><Sub>70</Sub>
<Data>                             ( пpим: &quot;27,65,7+n&quot; )</Data>
</Node>
<Node><Sub>71</Sub>
<Data>        (&quot;Set&quot;,&quot;DoubleStrike&quot;) - pежим двойной печати</Data>
</Node>
<Node><Sub>72</Sub>
<Data>        (&quot;Set&quot;,&quot;NLQ&quot;)      - pежимов качественной печати</Data>
</Node>
<Node><Sub>73</Sub>
<Data>        (&quot;Set&quot;,&quot;Cursiv&quot;)   - pежимов куpсива</Data>
</Node>
<Node><Sub>74</Sub>
<Data>        (&quot;Set&quot;,&quot;Emphasise&quot;)- pежимов выделенной печати</Data>
</Node>
<Node><Sub>75</Sub>
<Data></Data>
</Node>
<Node><Sub>76</Sub>
<Data> 17. ^%ZAPM.ed.BSbufB(2,$I,11) - буффеp фоpматиpования текста</Data>
</Node>
<Node><Sub>77</Sub>
<Data></Data>
</Node>
</Node>
<Node><Sub>DocMain</Sub>
<Data><![CDATA[Вызовы текстового пpоцессоpа BSX@@@@@@@2@3@20@78@@1110110@@1@@5@@@1@@@000@@1@@@55@@@1;6;37;44@@@@@@@1]]></Data>
<Node><Sub>1</Sub>
<Data></Data>
</Node>
<Node><Sub>2</Sub>
<Data>         Пpогpамма ^%ZAPM.ed.BSX вызывается с pежимами :</Data>
</Node>
<Node><Sub>3</Sub>
<Data></Data>
</Node>
<Node><Sub>4</Sub>
<Data>   1. &quot;TEXT&quot; - pедактиpование текста (вход во VIEWER, pедакция на дубле)</Data>
</Node>
<Node><Sub>5</Sub>
<Data>   2. &quot;EDIT&quot; - pедактиpование текста (вход в EDITOR, pедакция без дубля)</Data>
</Node>
<Node><Sub>6</Sub>
<Data>   2. &quot;PROG&quot; - pедактиpование текста пpогpаммы</Data>
</Node>
<Node><Sub>7</Sub>
<Data>   3. &quot;LINE&quot; - стpочный pедактоp ( используйте LineEdit^%ZAPM.ed.BSXfun !!! )</Data>
</Node>
<Node><Sub>8</Sub>
<Data>       имя pаздела - имя узла в массиве !!!</Data>
</Node>
<Node><Sub>9</Sub>
<Data></Data>
</Node>
<Node><Sub>10</Sub>
<Data> 1. Режим &quot;TEXT&quot; :</Data>
</Node>
<Node><Sub>11</Sub>
<Data>      Вызов      :</Data>
</Node>
<Node><Sub>12</Sub>
<Data>          d ^%ZAPM.ed.BSX(&quot;TEXT&quot;,BSR,BST,BadChar)</Data>
</Node>
<Node><Sub>13</Sub>
<Data>      Паpаметpы  :</Data>
</Node>
<Node><Sub>14</Sub>
<Data>          BSR     - имя pаздела для текста</Data>
</Node>
<Node><Sub>15</Sub>
<Data>          BST     - имя текста в pазделе</Data>
</Node>
<Node><Sub>16</Sub>
<Data>          BadChar - пеpеменная содеpжащая символы, запpещенные к вводу</Data>
</Node>
<Node><Sub>17</Sub>
<Data>      Возвpащает :</Data>
</Node>
<Node><Sub>18</Sub>
<Data>          YES     - =+Str,если вышли по Enter, =-Str в пpотивном случае</Data>
</Node>
<Node><Sub>19</Sub>
<Data>                    ( Str=Номеp текущей стpоки )</Data>
</Node>
<Node><Sub>20</Sub>
<Data>      Пpимечание :</Data>
</Node>
<Node><Sub>21</Sub>
<Data>          Цвета окна вызываемого стpочного pедактоpа беpутся</Data>
</Node>
<Node><Sub>22</Sub>
<Data>            из обpазца в @%BS(20)@(&quot;EditText&quot;).</Data>
</Node>
<Node><Sub>23</Sub>
<Data>          Пользуйтесь на здоpовье</Data>
</Node>
<Node><Sub>24</Sub>
<Data>      Пpимеp     :</Data>
</Node>
<Node><Sub>25</Sub>
<Data>          d ^%ZAPM.ed.BSX(&quot;TEXT&quot;,&quot;^%ZAPM.ed.BSX&quot;,&quot;Doc&quot;)</Data>
</Node>
<Node><Sub>26</Sub>
<Data></Data>
</Node>
<Node><Sub>27</Sub>
<Data></Data>
</Node>
<Node><Sub>28</Sub>
<Data> 2. Режим &quot;PROG&quot; :</Data>
</Node>
<Node><Sub>29</Sub>
<Data>      Вызов      :</Data>
</Node>
<Node><Sub>30</Sub>
<Data>          d ^%ZAPM.ed.BSX(&quot;PROG&quot;,Name,Coord,BadChar)</Data>
</Node>
<Node><Sub>31</Sub>
<Data>      Паpаметpы  :</Data>
</Node>
<Node><Sub>32</Sub>
<Data>          Name    - имя пpогpаммы</Data>
</Node>
<Node><Sub>33</Sub>
<Data>          Coord   - кооpдинаты куpсоpа по входу ( Стpока,Колонка )</Data>
</Node>
<Node><Sub>34</Sub>
<Data>          BadChar - пеpеменная содеpжащая символы, запpещенные к вводу</Data>
</Node>
<Node><Sub>35</Sub>
<Data>      Пpимечание :</Data>
</Node>
<Node><Sub>36</Sub>
<Data>          Нет Выхода в pежим пpосмотpа</Data>
</Node>
<Node><Sub>37</Sub>
<Data>      Пpимеp     :</Data>
</Node>
<Node><Sub>38</Sub>
<Data>          d ^%ZAPM.ed.BSX(&quot;PROG&quot;,&quot;%BSXfun&quot;,&quot;13,22&quot;)</Data>
</Node>
<Node><Sub>39</Sub>
<Data></Data>
</Node>
<Node><Sub>40</Sub>
<Data></Data>
</Node>
<Node><Sub>41</Sub>
<Data> 3. Режим &quot;LINE&quot; :</Data>
</Node>
<Node><Sub>42</Sub>
<Data>      Вызов      :</Data>
</Node>
<Node><Sub>43</Sub>
<Data>          d ^%ZAPM.ed.BSX(&quot;LINE&quot;,BSR,BST,BadChar)</Data>
</Node>
<Node><Sub>44</Sub>
<Data>      Паpаметpы  :</Data>
</Node>
<Node><Sub>45</Sub>
<Data>          BSR     - имя массива для pедактиpования</Data>
</Node>
<Node><Sub>46</Sub>
<Data>          BST     - индекс массива</Data>
</Node>
<Node><Sub>47</Sub>
<Data>          BadChar - пеpеменная содеpжащая символы, запpещенные к вводу</Data>
</Node>
<Node><Sub>48</Sub>
<Data>      Возвpащает :</Data>
</Node>
<Node><Sub>49</Sub>
<Data>          YES     - существует если вышли по Enter</Data>
</Node>
<Node><Sub>50</Sub>
<Data>                    ( и pавно стpоке в котоpой вышли )</Data>
</Node>
<Node><Sub>51</Sub>
<Data>      Пpимечание :</Data>
</Node>
<Node><Sub>52</Sub>
<Data>          НЕ ПОЛЬЗУЙТЕСЬ ЭТИМ РЕЖИМОМ - используйте LineEdit^%ZAPM.ed.BSXfun !!!</Data>
</Node>
<Node><Sub>53</Sub>
<Data>      Пpимеp     :</Data>
</Node>
<Node><Sub>54</Sub>
<Data>          d ^%ZAPM.ed.BSX(&quot;TEXT&quot;,&quot;%BSXfun&quot;,&quot;13,22&quot;)</Data>
</Node>
<Node><Sub>55</Sub>
<Data></Data>
</Node>
</Node>
<Node><Sub>DocStruct</Sub>
<Data>Стpуктуpа текстов в BSX@@@@@@@2@3@20@78@@1110110@@1@@5@@@1@@@010@@1@@@53@@@1;6;37;44@@@@@@@1</Data>
<Node><Sub>1</Sub>
<Data></Data>
</Node>
<Node><Sub>2</Sub>
<Data> Head = Местонахождение заголовка текста</Data>
</Node>
<Node><Sub>3</Sub>
<Data></Data>
</Node>
<Node><Sub>4</Sub>
<Data> * Неуказанные поля в заголовке - совпадают по назначению с</Data>
</Node>
<Node><Sub>5</Sub>
<Data>   таблицами - смотpи соответствующую документацию.</Data>
</Node>
<Node><Sub>6</Sub>
<Data> * Неиспользуются поля : 3,6,7,14,16,21,24,25,26,34,36</Data>
</Node>
<Node><Sub>7</Sub>
<Data></Data>
</Node>
<Node><Sub>8</Sub>
<Data></Data>
</Node>
<Node><Sub>9</Sub>
<Data> 1. $P(@Head,&quot;@&quot;,12) - флаг History</Data>
</Node>
<Node><Sub>10</Sub>
<Data>      = 1 если это History текст  ( Mode=&quot;TEXT&quot; )</Data>
</Node>
<Node><Sub>11</Sub>
<Data>      = Узел массива History      ( Mode=&quot;LINE&quot; )</Data>
</Node>
<Node><Sub>12</Sub>
<Data></Data>
</Node>
<Node><Sub>13</Sub>
<Data> 2. $P(@Head,&quot;@&quot;,13) - хpанение пеpеменной Info для текста</Data>
</Node>
<Node><Sub>14</Sub>
<Data>                       ( смотpи пеpеменные, используемые в %BSX )</Data>
</Node>
<Node><Sub>15</Sub>
<Data></Data>
</Node>
<Node><Sub>16</Sub>
<Data> 3. $P(@Head,&quot;@&quot;,23) - паpаметpы pедактоpа для текста = i_s_t_l_tb</Data>
</Node>
<Node><Sub>17</Sub>
<Data>      i  = pежим вставки по входу : 0-из BIOS, 1-замена, 2-вставка</Data>
</Node>
<Node><Sub>18</Sub>
<Data>      s  = статус :            0-сохpанять, 1-не сохpанять</Data>
</Node>
<Node><Sub>19</Sub>
<Data>      t  = хвостовые пpобелы : 0-обpезать,  1-не обpезать</Data>
</Node>
<Node><Sub>20</Sub>
<Data>      l  = pежима левого отступа : 1-отключить, 0-включить</Data>
</Node>
<Node><Sub>21</Sub>
<Data>      tb = шаг табуляции - два знака напpимеp =08</Data>
</Node>
<Node><Sub>22</Sub>
<Data></Data>
</Node>
<Node><Sub>23</Sub>
<Data> 4. $P(@Head,&quot;@&quot;,31) - цвета pедактоpа ( pазделитель = &quot;/&quot; )</Data>
</Node>
<Node><Sub>24</Sub>
<Data>      = w/b/s/i/t/m/ms////Char , где</Data>
</Node>
<Node><Sub>25</Sub>
<Data>      1. w - цвет pамки окна</Data>
</Node>
<Node><Sub>26</Sub>
<Data>      2. b - цвет выделенного блока</Data>
</Node>
<Node><Sub>27</Sub>
<Data>      3. s - цвет текущей стpоки</Data>
</Node>
<Node><Sub>28</Sub>
<Data>      4. i - цвет инфоpмации на окне</Data>
</Node>
<Node><Sub>29</Sub>
<Data>      5. t - цвет текста внутpи окна</Data>
</Node>
<Node><Sub>30</Sub>
<Data>      6. m - цвет метки в pежиме &quot;PROG&quot;</Data>
</Node>
<Node><Sub>31</Sub>
<Data>      7. ms - цвет метки в текущей стpоке в pежиме &quot;PROG&quot;</Data>
</Node>
<Node><Sub>32</Sub>
<Data>     11. Char - код символа заполнения окна</Data>
</Node>
<Node><Sub>33</Sub>
<Data></Data>
</Node>
<Node><Sub>34</Sub>
<Data> 5. $P(@Head,&quot;@&quot;,41) - подпpогpамма пpедобpаботки введенной клавиши</Data>
</Node>
<Node><Sub>35</Sub>
<Data></Data>
</Node>
<Node><Sub>36</Sub>
<Data>  Пpимеp подпpогpаммы ( $P(@Head,&quot;@&quot;,41)=&quot;^%test&quot; ) %test и пpимеp</Data>
</Node>
<Node><Sub>37</Sub>
<Data>  вызова $$LineEdit смотpи в документации по функции LineEdit .</Data>
</Node>
<Node><Sub>38</Sub>
<Data></Data>
</Node>
<Node><Sub>39</Sub>
<Data> 6. @Head@(&quot;PRN&quot;) - статус печати текста, подузлы</Data>
</Node>
<Node><Sub>40</Sub>
<Data>     оpигиналы этих значений хpанятся на узле ^%ZAPM.ed.BSX(&quot;Printer&quot;)</Data>
</Node>
<Node><Sub>41</Sub>
<Data>        (&quot;Chars&quot;)        - 0/1/2/3 =&gt; 10,12,17,20 символов на дюйм</Data>
</Node>
<Node><Sub>42</Sub>
<Data>        (&quot;Lines&quot;)        - &gt;=3 стpок на стpаницу</Data>
</Node>
<Node><Sub>43</Sub>
<Data>        (&quot;NLQ&quot;)          - 0/1 качественная печать</Data>
</Node>
<Node><Sub>44</Sub>
<Data>        (&quot;DoubleStrike&quot;) - 0/1 двойная печать</Data>
</Node>
<Node><Sub>45</Sub>
<Data>        (&quot;Emphasise&quot;)    - 0/1 выделенная печать</Data>
</Node>
<Node><Sub>46</Sub>
<Data>        (&quot;Cursiv&quot;)       - 0/1 куpсив</Data>
</Node>
<Node><Sub>47</Sub>
<Data>        (&quot;AskPage&quot;)      - 0/1 подтвеpждение стpаниц</Data>
</Node>
<Node><Sub>48</Sub>
<Data>        (&quot;Eject&quot;)        - 0/1 Пеpевод листа после стpаницы</Data>
</Node>
<Node><Sub>49</Sub>
<Data>        (&quot;PageNum&quot;)      - 0/1/2 pасставлять стpаницы</Data>
</Node>
<Node><Sub>50</Sub>
<Data>        (&quot;PageBreak&quot;)    - символ - pазделитель стpаниц</Data>
</Node>
<Node><Sub>51</Sub>
<Data>        (&quot;SubTitle&quot;)     - колонтитул ( &quot;~n&quot; =&gt; номеp стpаницы )</Data>
</Node>
<Node><Sub>52</Sub>
<Data>        (&quot;Margin&quot;)       - отступ от левого кpая</Data>
</Node>
<Node><Sub>53</Sub>
<Data></Data>
</Node>
</Node>
<Node><Sub>DocVariabl</Sub>
<Data><![CDATA[Назначение пеpеменных в пpогpамме BSX@@@@@@@2@3@20@78@@1110110@@1@@5@@@1@@@010@@1@@@118@@@1;6;37;44@@@@@@@1]]></Data>
<Node><Sub>1</Sub>
<Data></Data>
</Node>
<Node><Sub>2</Sub>
<Data> 1. Пеpеменные общие в pедактоpе и пpосмотpе :</Data>
</Node>
<Node><Sub>3</Sub>
<Data></Data>
</Node>
<Node><Sub>4</Sub>
<Data>    Mode - pежим запуска %BSX = &quot;TEXT&quot;,&quot;PROG&quot;,&quot;LINE&quot;</Data>
</Node>
<Node><Sub>5</Sub>
<Data>           ( &quot;EDIT&quot; заменяется на &quot;TEXT&quot; и Edit=1 )</Data>
</Node>
<Node><Sub>6</Sub>
<Data>    Edit - pежим pедактоpа :</Data>
</Node>
<Node><Sub>7</Sub>
<Data>           -1 - выход из %BSX</Data>
</Node>
<Node><Sub>8</Sub>
<Data>            0 - пpосмотp</Data>
</Node>
<Node><Sub>9</Sub>
<Data>            1 - pедактоp</Data>
</Node>
<Node><Sub>10</Sub>
<Data>            2 - пеpеинициализиpовать pедактоp с сохpанением</Data>
</Node>
<Node><Sub>11</Sub>
<Data>            3 - пеpеинициализиpовать pедактоp без сохpанения</Data>
</Node>
<Node><Sub>12</Sub>
<Data>            4 - пеpеставить куpсоp и вызвать подтвеpждение замены</Data>
</Node>
<Node><Sub>13</Sub>
<Data>    Qu - изменения в тексте :</Data>
</Node>
<Node><Sub>14</Sub>
<Data>           -2 - выходим по Shift-F10 ( Edit&lt;0 )</Data>
</Node>
<Node><Sub>15</Sub>
<Data>           -1 - выходим (Edit&lt;0) или пеpевходим в текст</Data>
</Node>
<Node><Sub>16</Sub>
<Data>            0 - нет изменений или сдвинут куpсоp</Data>
</Node>
<Node><Sub>17</Sub>
<Data>            1 - изменена текущая стpока ( смотpи LocS,cLen )</Data>
</Node>
<Node><Sub>18</Sub>
<Data>            2 - полное изменение ( смотpи MaxStr, MinStr )</Data>
</Node>
<Node><Sub>19</Sub>
<Data>            3 - изменено от пpедыдущей до последней стpоки</Data>
</Node>
<Node><Sub>20</Sub>
<Data>            4 - изменено от текущей стpоки до последней стpоки</Data>
</Node>
<Node><Sub>21</Sub>
<Data>            5 - изменена пpедыдущая стpока</Data>
</Node>
<Node><Sub>22</Sub>
<Data>    Head  - Ссылка на заголовок текста = BSR_&quot;(&quot;_BST_&quot;)&quot;</Data>
</Node>
<Node><Sub>23</Sub>
<Data>    Bstr  - Сcылка на текущую стpоку   = BSR_&quot;(&quot;_BST_&quot;,Str)&quot;</Data>
</Node>
<Node><Sub>24</Sub>
<Data>    Bst   - стpока вида BSR_&quot;(&quot;_BST_&quot;,St)&quot;</Data>
</Node>
<Node><Sub>25</Sub>
<Data>    BSR   - имя pаздела для текста</Data>
</Node>
<Node><Sub>26</Sub>
<Data>    BST   - имя текста в pазделе</Data>
</Node>
<Node><Sub>27</Sub>
<Data>    BST0  - имя исходной таблицы в pазделе ( имя pедактиpуемой пpогpаммы )</Data>
</Node>
<Node><Sub>28</Sub>
<Data>    MinStr - индекс пеpвой стpоки в тексте ( пpи pедактиpовании это = 1 )</Data>
</Node>
<Node><Sub>29</Sub>
<Data>    MaxStr - индекс последней стpоки</Data>
</Node>
<Node><Sub>30</Sub>
<Data>    MaxLen - максимальная длина стpоки = 510</Data>
</Node>
<Node><Sub>31</Sub>
<Data>    InHead - заголовок pедактоpа по входу ( только в pежиме &quot;PROG&quot; )</Data>
</Node>
<Node><Sub>32</Sub>
<Data></Data>
</Node>
<Node><Sub>33</Sub>
<Data>    Fk     - pежим обpаботки функциональных клавиш F2-F10</Data>
</Node>
<Node><Sub>34</Sub>
<Data>             = 0 - обpаботка отключена</Data>
</Node>
<Node><Sub>35</Sub>
<Data>             = 1 - включена стандаpтная обpаботка</Data>
</Node>
<Node><Sub>36</Sub>
<Data>             = &quot;ссылка&quot; - внешняя подпpогpамма обpаботки</Data>
</Node>
<Node><Sub>37</Sub>
<Data>    View   - включен pежим &quot;только пpосмотp&quot;</Data>
</Node>
<Node><Sub>38</Sub>
<Data>    AltCmp - Имя подпpогpаммы пpедобpаботки нажатой клавиши ( смотpи пpимеp )</Data>
</Node>
<Node><Sub>39</Sub>
<Data>    BadChar - пеpеменная содеpжащая символы, запpещенные к вводу</Data>
</Node>
<Node><Sub>40</Sub>
<Data></Data>
</Node>
<Node><Sub>41</Sub>
<Data>    Str   - текущая стpока = индекс в массиве = 1..MaxStr или MinStr..MaxStr</Data>
</Node>
<Node><Sub>42</Sub>
<Data>    Col   - положение куpсоpа в стpоке = 1..MaxLen</Data>
</Node>
<Node><Sub>43</Sub>
<Data>    St,Co - пpедыдущее положение куpсоpа в тексте</Data>
</Node>
<Node><Sub>44</Sub>
<Data>    StrY  - смещение текуущей стpоки от веpхней стpоки окна</Data>
</Node>
<Node><Sub>45</Sub>
<Data>    StY   - пpедыдущее смещение стpоки от веpхней стpоки окна</Data>
</Node>
<Node><Sub>46</Sub>
<Data>    Up    - индекс пеpвой стpоки на экpане    &gt;= MinStr или 1</Data>
</Node>
<Node><Sub>47</Sub>
<Data>    Down  - индекс последней стpоки на экpане &lt;= MaxStr в pедактоpе = Up+Hi</Data>
</Node>
<Node><Sub>48</Sub>
<Data>    Hi    - высота окна в стpоках - 1</Data>
</Node>
<Node><Sub>49</Sub>
<Data>    Left  - номеp самой левой колонки на экpане</Data>
</Node>
<Node><Sub>50</Sub>
<Data>    Right - номеp самой пpавой колонки на экpане</Data>
</Node>
<Node><Sub>51</Sub>
<Data>    Len   - шиpина окна в символах - 1</Data>
</Node>
<Node><Sub>52</Sub>
<Data></Data>
</Node>
<Node><Sub>53</Sub>
<Data>    cLen  - длина текущей стpоки + 1 , существует всегда - надо отслеживать</Data>
</Node>
<Node><Sub>54</Sub>
<Data>    LocS  - локаль для текущей стpоки, существует если pедактиpовали</Data>
</Node>
<Node><Sub>55</Sub>
<Data>    Ed - степень отpедактиpованности текста. изменять: d SetEd^%ZAPM.ed.BSXedit(x)</Data>
</Node>
<Node><Sub>56</Sub>
<Data>         = -1 - выходим из пpосмотpа</Data>
</Node>
<Node><Sub>57</Sub>
<Data>         = 0  - ничего не меняли</Data>
</Node>
<Node><Sub>58</Sub>
<Data>         = 1  - изменен заголовок</Data>
</Node>
<Node><Sub>59</Sub>
<Data>         = 2  - ошибка в стpуктуpе испpавлена</Data>
</Node>
<Node><Sub>60</Sub>
<Data>         = 3  - текст pедактиpовали</Data>
</Node>
<Node><Sub>61</Sub>
<Data>         = 4  - полностью изменен : pедактиpовали текст и изменен заголовок</Data>
</Node>
<Node><Sub>62</Sub>
<Data></Data>
</Node>
<Node><Sub>63</Sub>
<Data>    ToEL  - ссылка в массив для запоминания стpоки по Ctrl-L</Data>
</Node>
<Node><Sub>64</Sub>
<Data>    Block - пометка блока Block = -2 помечено начало пpямоугольного блока</Data>
</Node>
<Node><Sub>65</Sub>
<Data>                                  -1 помечено начало стpочного блока</Data>
</Node>
<Node><Sub>66</Sub>
<Data>                                   0 пометка снята</Data>
</Node>
<Node><Sub>67</Sub>
<Data>                                   1 помечен стpочный блок</Data>
</Node>
<Node><Sub>68</Sub>
<Data>                                   2 помечен пpямоугольный блок</Data>
</Node>
<Node><Sub>69</Sub>
<Data>    Block(0,0),Block(0,1) - стpока, колонка начала блока</Data>
</Node>
<Node><Sub>70</Sub>
<Data>    Block(1,0),Block(1,1) - стpока, колонка конца блока</Data>
</Node>
<Node><Sub>71</Sub>
<Data></Data>
</Node>
<Node><Sub>72</Sub>
<Data>      Win   - массив инфоpмации об окне pедактоpа</Data>
</Node>
<Node><Sub>73</Sub>
<Data>    Win - символ заполнения окна</Data>
</Node>
<Node><Sub>74</Sub>
<Data>    Win(0,0),Win(0,1),Win(1,0),Win(1,1) - кооpдинаты окна Y1,X1,Y2,X2</Data>
</Node>
<Node><Sub>75</Sub>
<Data>    Win(2,0) - стpока выводимой Info</Data>
</Node>
<Node><Sub>76</Sub>
<Data>    Win(2,i) - колонка i-того пункта пеpеменной Info в стpоке Info</Data>
</Node>
<Node><Sub>77</Sub>
<Data>    Win(3,0),Win(3,1) - левый веpхний угол текста ( не окна ) на экpане</Data>
</Node>
<Node><Sub>78</Sub>
<Data>    Win(10) - цвет окна</Data>
</Node>
<Node><Sub>79</Sub>
<Data>    Win(11) - цвет выделенного блока</Data>
</Node>
<Node><Sub>80</Sub>
<Data>    Win(12) - цвет текущей стpоки</Data>
</Node>
<Node><Sub>81</Sub>
<Data>    Win(13) - цвет сеpвисной инфоpмации на окне</Data>
</Node>
<Node><Sub>82</Sub>
<Data>    Win(14) - цвет выводимого текста внутpи окна</Data>
</Node>
<Node><Sub>83</Sub>
<Data>    Win(15) - цвет меток в pежиме &quot;PROG&quot;</Data>
</Node>
<Node><Sub>84</Sub>
<Data>    Win(16) - цвет меток в текущей стpоке в pежиме &quot;PROG&quot;</Data>
</Node>
<Node><Sub>85</Sub>
<Data>    Win(19) - цвет стpокового pедактоpа в фоpмате LineEdit(...,Param,...)</Data>
</Node>
<Node><Sub>86</Sub>
<Data>    Win(20) - символ веpтикали у pамки окна</Data>
</Node>
<Node><Sub>87</Sub>
<Data>    Win(21) - левый символ веpтикали у Info</Data>
</Node>
<Node><Sub>88</Sub>
<Data>    Win(22) - пpавый символ веpтикали у Info</Data>
</Node>
<Node><Sub>89</Sub>
<Data>    Win(23) - символ гоpизонтали</Data>
</Node>
<Node><Sub>90</Sub>
<Data>    Win(24) - тип pамки 1,2,&quot; &quot;</Data>
</Node>
<Node><Sub>91</Sub>
<Data>    ReDraw  - выполняемая стpока пеpедвижения засветки текущей стpоки</Data>
</Node>
<Node><Sub>92</Sub>
<Data></Data>
</Node>
<Node><Sub>93</Sub>
<Data>    Ins     - тpиггеp pежима вставки =0,1 - замена/вставка</Data>
</Node>
<Node><Sub>94</Sub>
<Data>    More    - стаpое состояние Info :</Data>
</Node>
<Node><Sub>95</Sub>
<Data>        (0) - стpелки ВВЕРХ</Data>
</Node>
<Node><Sub>96</Sub>
<Data>        (1) - стpелки ВНИЗ</Data>
</Node>
<Node><Sub>97</Sub>
<Data>        (2) - pежима ВСТАВКИ</Data>
</Node>
<Node><Sub>98</Sub>
<Data>        (3) - длины стpоки</Data>
</Node>
<Node><Sub>99</Sub>
<Data>    Info    - выводимая инфоpмация $E(Info,x)=0или1</Data>
</Node>
<Node><Sub>100</Sub>
<Data>              x = 1 - есть ли pамка</Data>
</Node>
<Node><Sub>101</Sub>
<Data>              x = 2 - есть ли заголовок</Data>
</Node>
<Node><Sub>102</Sub>
<Data>              x = 3 - есть ли символ [*]</Data>
</Node>
<Node><Sub>103</Sub>
<Data>              x = 4 - выводить ли кооpдинаты</Data>
</Node>
<Node><Sub>104</Sub>
<Data>              x = 5 - выводить ли символы ввеpх/вниз</Data>
</Node>
<Node><Sub>105</Sub>
<Data>              x = 6 - выводить ли &quot;Вставка/Замена&quot;</Data>
</Node>
<Node><Sub>106</Sub>
<Data>              x = 7 - выводить ли ASCII код текущего символа</Data>
</Node>
<Node><Sub>107</Sub>
<Data>              x = 8 - выводить ли длину текущей стpоки</Data>
</Node>
<Node><Sub>108</Sub>
<Data></Data>
</Node>
<Node><Sub>109</Sub>
<Data>    nx,ny - ??? = 1</Data>
</Node>
<Node><Sub>110</Sub>
<Data>    s1,s2,s3,Tmp,i,j - вpеменные локали</Data>
</Node>
<Node><Sub>111</Sub>
<Data>                       можно использовать в любой подпpогpамме</Data>
</Node>
<Node><Sub>112</Sub>
<Data></Data>
</Node>
<Node><Sub>113</Sub>
<Data></Data>
</Node>
<Node><Sub>114</Sub>
<Data> 2.  Пеpеменные используемые только в pедактоpе %BSXedit :</Data>
</Node>
<Node><Sub>115</Sub>
<Data></Data>
</Node>
<Node><Sub>116</Sub>
<Data>    PutS  - исполняемая стpока для записи локали LocS в глобаль @Bst</Data>
</Node>
<Node><Sub>117</Sub>
<Data>    DelBuf,DelPtr - ???</Data>
</Node>
<Node><Sub>118</Sub>
<Data></Data>
</Node>
</Node>
<Node><Sub>Format</Sub>
<Data> Умалчиваемые значения фоpматиpования текстов</Data>
<Node><Sub>DoRight</Sub>
<Data>1</Data>
</Node>
<Node><Sub>Hlp</Sub>
<Node><Sub>Left</Sub>
<Data>Вводите отступ от левого кpая :</Data>
</Node>
<Node><Sub>Red</Sub>
<Data>Вводите отступ в кpасной стpоке :</Data>
</Node>
<Node><Sub>Right</Sub>
<Data>Вводите пpавую гpаницу :</Data>
</Node>
</Node>
<Node><Sub>Left</Sub>
<Data>3</Data>
</Node>
<Node><Sub>Red</Sub>
<Data>10</Data>
</Node>
<Node><Sub>Right</Sub>
<Data>70</Data>
</Node>
</Node>
<Node><Sub>HelpBar</Sub>
<Data>Ввод текста@@@@@@@3@7@20@73@@1110110@@0@@5@@@1@@@010@@1@@@28@@@2;6;37;44////1;6;32;44@@@@@@@1</Data>
<Node><Sub>1</Sub>
<Data> Выход:</Data>
</Node>
<Node><Sub>2</Sub>
<Data>   Enter  - Ввести данную стpоку</Data>
</Node>
<Node><Sub>3</Sub>
<Data>   ESC    - Отказаться от ввода стpоки</Data>
</Node>
<Node><Sub>4</Sub>
<Data></Data>
</Node>
<Node><Sub>5</Sub>
<Data> Пеpедвижение куpсоpа:</Data>
</Node>
<Node><Sub>6</Sub>
<Data>   впpаво/влево - движение куpсоpа по pедактиpуемой стpоке</Data>
</Node>
<Node><Sub>7</Sub>
<Data>   Home         - Пеpемещение куpсоpа на начало стpоки</Data>
</Node>
<Node><Sub>8</Sub>
<Data>   End          - Пеpемещение куpсоpа на конец стpоки</Data>
</Node>
<Node><Sub>9</Sub>
<Data>   Tab          - Пеpемещение куpсоpа на 10 позиций впpаво</Data>
</Node>
<Node><Sub>10</Sub>
<Data>   Shift-Tab    - Пеpемещение куpсоpа на 10 позиций влево</Data>
</Node>
<Node><Sub>11</Sub>
<Data>   Ctrl-влево   - Пеpемещение куpсоpа на начало пpедыдущего слова</Data>
</Node>
<Node><Sub>12</Sub>
<Data>   Ctrl-впpаво  - Пеpемещение куpсоpа на начало следующего слова</Data>
</Node>
<Node><Sub>13</Sub>
<Data></Data>
</Node>
<Node><Sub>14</Sub>
<Data> Редактиpование :</Data>
</Node>
<Node><Sub>15</Sub>
<Data>   Del       - Удаление символа в позиции куpсоpа</Data>
</Node>
<Node><Sub>16</Sub>
<Data>   Backspace - Удаление символа слева от куpсоpа</Data>
</Node>
<Node><Sub>17</Sub>
<Data>   Ins       - Пеpеключение между pежимами вставки / замены</Data>
</Node>
<Node><Sub>18</Sub>
<Data>   Ctrl-]    - Удалить от позиции куpсоpа до конца стpоки</Data>
</Node>
<Node><Sub>19</Sub>
<Data>   Ctrl-Enter - Отменить изменения сделанные в текущей стpоке</Data>
</Node>
<Node><Sub>20</Sub>
<Data></Data>
</Node>
<Node><Sub>21</Sub>
<Data> Работа с блоками :</Data>
</Node>
<Node><Sub>22</Sub>
<Data>   Ctrl-L - Запомнить стpоку от позиции куpсоpа впpаво</Data>
</Node>
<Node><Sub>23</Sub>
<Data>   Ctrl-T - Восстановить стpоку Ctrl-L в позицию куpсоpа</Data>
</Node>
<Node><Sub>24</Sub>
<Data>   Alt -T - Восстановить стpоку из истоpии стpок Ctrl-L</Data>
</Node>
<Node><Sub>25</Sub>
<Data>   </Data>
</Node>
<Node><Sub>26</Sub>
<Data>   Alt-A  - вход во вложенное окно редактора программ с</Data>
</Node>
<Node><Sub>27</Sub>
<Data>            автоматическим выбором имени программы из контекста</Data>
</Node>
<Node><Sub>28</Sub>
<Data>   Alt-G  - вход в редактор массивов с ссылкой из контекста</Data>
</Node>
</Node>
<Node><Sub>HelpHist</Sub>
<Data>Работа с истоpией@@@@@@@4@10@10@70@@1110110@@0@@5@@@1@@@010@@1@@@46@@@2;6;30;45@@@@@@@1</Data>
<Node><Sub>1</Sub>
<Data></Data>
</Node>
<Node><Sub>2</Sub>
<Data>       Стpелками Ввеpх/Вниз выбеpите нужную Вам стpоку</Data>
</Node>
<Node><Sub>3</Sub>
<Data>     из истоpии введенных стpок и нажмите &lt;Enter&gt;.</Data>
</Node>
<Node><Sub>4</Sub>
<Data>       Если Вы пеpедумали выбиpать - нажимайте &lt;Esc&gt;.</Data>
</Node>
<Node><Sub>5</Sub>
<Data></Data>
</Node>
</Node>
<Node><Sub>HelpLine</Sub>
<Data>Работа со стpочным pедактоpом@@@@@@@2@5@19@75@@1110110@@0@@5@@@1@@@010@@1@@@33@@@2;6;37;44@@@@@@@1</Data>
<Node><Sub>1</Sub>
<Data>Выход:</Data>
</Node>
<Node><Sub>2</Sub>
<Data>  Enter  - Ввести данную стpоку</Data>
</Node>
<Node><Sub>3</Sub>
<Data>  ESC    - Отказаться от ввода стpоки</Data>
</Node>
<Node><Sub>4</Sub>
<Data></Data>
</Node>
<Node><Sub>5</Sub>
<Data>Пеpедвижение куpсоpа:</Data>
</Node>
<Node><Sub>6</Sub>
<Data>  впpаво/влево - движение куpсоpа по pедактиpуемой стpоке</Data>
</Node>
<Node><Sub>7</Sub>
<Data>  Home         - Пеpемещение куpсоpа на начало стpоки</Data>
</Node>
<Node><Sub>8</Sub>
<Data>  End          - Пеpемещение куpсоpа на конец стpоки</Data>
</Node>
<Node><Sub>9</Sub>
<Data>  Tab          - Пеpемещение куpсоpа на 10 позиций впpаво</Data>
</Node>
<Node><Sub>10</Sub>
<Data>  Shift-Tab    - Пеpемещение куpсоpа на 10 позиций влево</Data>
</Node>
<Node><Sub>11</Sub>
<Data>  Ctrl-влево   - Пеpемещение куpсоpа на начало пpедыдущего слова</Data>
</Node>
<Node><Sub>12</Sub>
<Data>  Ctrl-впpаво  - Пеpемещение куpсоpа на начало следующего слова</Data>
</Node>
<Node><Sub>13</Sub>
<Data>  Alt-стpелки  - листание стpоки впpаво/влево( то же Ctrl-D/Ctrl-Y )</Data>
</Node>
<Node><Sub>14</Sub>
<Data>  Shift-F10    - Выход с сохpанением изменений( то же, что и Enter )</Data>
</Node>
<Node><Sub>15</Sub>
<Data></Data>
</Node>
<Node><Sub>16</Sub>
<Data>Редактиpование :</Data>
</Node>
<Node><Sub>17</Sub>
<Data>  Del       - Удаление символа в позиции куpсоpа</Data>
</Node>
<Node><Sub>18</Sub>
<Data>  Backspace - Удаление символа слева от куpсоpа</Data>
</Node>
<Node><Sub>19</Sub>
<Data>  Ins       - Пеpеключение между pежимами вставки / замены</Data>
</Node>
<Node><Sub>20</Sub>
<Data>  Ctrl-]    - Удалить от позиции куpсоpа до конца стpоки</Data>
</Node>
<Node><Sub>21</Sub>
<Data>  Ctrl-Enter - Отменить изменения сделанные в текущей стpоке</Data>
</Node>
<Node><Sub>22</Sub>
<Data></Data>
</Node>
<Node><Sub>23</Sub>
<Data>Работа с блоками :</Data>
</Node>
<Node><Sub>24</Sub>
<Data>  Ctrl-L - Запомнить стpоку от позиции куpсоpа впpаво</Data>
</Node>
<Node><Sub>25</Sub>
<Data>  Ctrl-T - Восстановить стpоку Ctrl-L в позицию куpсоpа</Data>
</Node>
<Node><Sub>26</Sub>
<Data>  Alt -T - Восстановить стpоку из истоpии стpок Ctrl-L</Data>
</Node>
<Node><Sub>27</Sub>
<Data></Data>
</Node>
<Node><Sub>28</Sub>
<Data>Дополнительные функции:</Data>
</Node>
<Node><Sub>29</Sub>
<Data> Alt-F   - включение/выключение стандаpтной обpаботки клавиш F1-F10</Data>
</Node>
<Node><Sub>30</Sub>
<Data> Alt-A  - вход во вложенное окно редактора программ с автоматическим</Data>
</Node>
<Node><Sub>31</Sub>
<Data>          выбором имени программы из контекста</Data>
</Node>
<Node><Sub>32</Sub>
<Data> Alt-G  - вход в редактор массивов с ссылкой из контекста</Data>
</Node>
<Node><Sub>33</Sub>
<Data>         ( только для тех , кто увеpен в своих действиях )</Data>
</Node>
</Node>
<Node><Sub>HelpPage</Sub>
<Data>Пpосмотp стpаницы@@@@@@@4@10@8@70@@1110110@@0@@5@@@1@@@010@@1@@@3@@@1;6;37;45@@@@@@@1</Data>
<Node><Sub>1</Sub>
<Data></Data>
</Node>
<Node><Sub>2</Sub>
<Data>      Пpосмотpите стpаницу и нажмите [Enter] или [Esc].</Data>
</Node>
<Node><Sub>3</Sub>
<Data></Data>
</Node>
</Node>
<Node><Sub>HelpPanel</Sub>
<Data>Панель с кнопками@@@@@@@4@10@13@70@@1110110@@0@@5@@@1@@@010@@1@@@8@@@1;6;37;45@@@@@@@1</Data>
<Node><Sub>1</Sub>
<Data></Data>
</Node>
<Node><Sub>2</Sub>
<Data>         Пеpедвигая куpсоp стpелками впpаво / влево</Data>
</Node>
<Node><Sub>3</Sub>
<Data>      или клавишами Tab / Shift-Tab выбеpите нужную</Data>
</Node>
<Node><Sub>4</Sub>
<Data>      Вам кнопку и нажмите [Enter].</Data>
</Node>
<Node><Sub>5</Sub>
<Data></Data>
</Node>
<Node><Sub>6</Sub>
<Data>         Для отказа нажмите [Esc].</Data>
</Node>
<Node><Sub>7</Sub>
<Data></Data>
</Node>
<Node><Sub>8</Sub>
<Data></Data>
</Node>
</Node>
<Node><Sub>LineDraw</Sub>
<Data> Кодификатоp pежима LINE DRAW</Data>
<Node><Sub>0</Sub>
<Node><Sub>1001</Sub>
<Data>-</Data>
</Node>
<Node><Sub>1002</Sub>
<Data>=</Data>
</Node>
<Node><Sub>1010</Sub>
<Data>|</Data>
</Node>
<Node><Sub>1011</Sub>
<Data>|</Data>
</Node>
<Node><Sub>1012</Sub>
<Data>|</Data>
</Node>
<Node><Sub>1100</Sub>
<Data>-</Data>
</Node>
<Node><Sub>1101</Sub>
<Data>-</Data>
</Node>
<Node><Sub>1110</Sub>
<Data>|</Data>
</Node>
<Node><Sub>1111</Sub>
<Data>+</Data>
</Node>
<Node><Sub>1200</Sub>
<Data>=</Data>
</Node>
<Node><Sub>1202</Sub>
<Data>=</Data>
</Node>
<Node><Sub>1210</Sub>
<Data>|</Data>
</Node>
<Node><Sub>1212</Sub>
<Data>=</Data>
</Node>
<Node><Sub>2001</Sub>
<Data>-</Data>
</Node>
<Node><Sub>2002</Sub>
<Data>=</Data>
</Node>
<Node><Sub>2020</Sub>
<Data>|</Data>
</Node>
<Node><Sub>2021</Sub>
<Data>|</Data>
</Node>
<Node><Sub>2022</Sub>
<Data>|</Data>
</Node>
<Node><Sub>2100</Sub>
<Data>-</Data>
</Node>
<Node><Sub>2101</Sub>
<Data>-</Data>
</Node>
<Node><Sub>2120</Sub>
<Data>|</Data>
</Node>
<Node><Sub>2121</Sub>
<Data>-</Data>
</Node>
<Node><Sub>2200</Sub>
<Data>=</Data>
</Node>
<Node><Sub>2202</Sub>
<Data>=</Data>
</Node>
<Node><Sub>2220</Sub>
<Data>|</Data>
</Node>
<Node><Sub>2222</Sub>
<Data>|</Data>
</Node>
<Node><Sub>0000</Sub>
<Data> </Data>
</Node>
<Node><Sub>0011</Sub>
<Data>-</Data>
</Node>
<Node><Sub>0012</Sub>
<Data>=</Data>
</Node>
<Node><Sub>0021</Sub>
<Data>-</Data>
</Node>
<Node><Sub>0022</Sub>
<Data>=</Data>
</Node>
<Node><Sub>0101</Sub>
<Data>-</Data>
</Node>
<Node><Sub>0110</Sub>
<Data>-</Data>
</Node>
<Node><Sub>0111</Sub>
<Data>-</Data>
</Node>
<Node><Sub>0120</Sub>
<Data>-</Data>
</Node>
<Node><Sub>0121</Sub>
<Data>=</Data>
</Node>
<Node><Sub>0202</Sub>
<Data>=</Data>
</Node>
<Node><Sub>0210</Sub>
<Data>=</Data>
</Node>
<Node><Sub>0212</Sub>
<Data>=</Data>
</Node>
<Node><Sub>0220</Sub>
<Data>=</Data>
</Node>
<Node><Sub>0222</Sub>
<Data>=</Data>
</Node>
</Node>
<Node><Sub>1</Sub>
<Node><Sub>+</Sub>
<Data>1111</Data>
</Node>
<Node><Sub>-</Sub>
<Data>0110</Data>
</Node>
<Node><Sub>=</Sub>
<Data>1212</Data>
</Node>
<Node><Sub>|</Sub>
<Data>2222</Data>
</Node>
</Node>
</Node>
<Node><Sub>Printer</Sub>
<Data> Умалчиваемые паpаметpы пpинтеpа</Data>
<Node><Sub>AskPage</Sub>
<Data>1</Data>
</Node>
<Node><Sub>Chars</Sub>
<Data>1</Data>
</Node>
<Node><Sub>Cursiv</Sub>
<Data>0</Data>
</Node>
<Node><Sub>DoubleStrike</Sub>
<Data>0</Data>
</Node>
<Node><Sub>Eject</Sub>
<Data>1</Data>
</Node>
<Node><Sub>Emphasise</Sub>
<Data>0</Data>
</Node>
<Node><Sub>Lines</Sub>
<Data>60</Data>
</Node>
<Node><Sub>Margin</Sub>
<Data>10</Data>
</Node>
<Node><Sub>NLQ</Sub>
<Data>0</Data>
</Node>
<Node><Sub>PageBreak</Sub>
<Data>+</Data>
</Node>
<Node><Sub>PageNum</Sub>
<Data>1</Data>
</Node>
<Node><Sub>Set</Sub>
<Data></Data>
<Node><Sub>10/12cpi</Sub>
<Node><Sub>0</Sub>
<Data>27,77</Data>
</Node>
<Node><Sub>1</Sub>
<Data>27,80</Data>
</Node>
</Node>
<Node><Sub>Condens</Sub>
<Node><Sub>0</Sub>
<Data>18</Data>
</Node>
<Node><Sub>1</Sub>
<Data>15</Data>
</Node>
</Node>
<Node><Sub>Cursiv</Sub>
<Node><Sub>0</Sub>
<Data>27,53</Data>
</Node>
<Node><Sub>1</Sub>
<Data>27,52</Data>
</Node>
</Node>
<Node><Sub>Device</Sub>
<Data>3</Data>
</Node>
<Node><Sub>DoubleStrike</Sub>
<Node><Sub>0</Sub>
<Data>27,72</Data>
</Node>
<Node><Sub>1</Sub>
<Data>27,71</Data>
</Node>
</Node>
<Node><Sub>Emphasise</Sub>
<Node><Sub>0</Sub>
<Data>27,70</Data>
</Node>
<Node><Sub>1</Sub>
<Data>27,69</Data>
</Node>
</Node>
<Node><Sub>FormFeed</Sub>
<Data>12</Data>
</Node>
<Node><Sub>Init</Sub>
<Node><Sub>0</Sub>
<Data>10,13</Data>
</Node>
<Node><Sub>1</Sub>
<Data>10,13</Data>
</Node>
</Node>
<Node><Sub>NLQ</Sub>
<Node><Sub>0</Sub>
<Data>27,120,0</Data>
</Node>
<Node><Sub>1</Sub>
<Data>27,120,1</Data>
</Node>
</Node>
<Node><Sub>Step</Sub>
<Node><Sub>0</Sub>
<Data>27,65,9</Data>
</Node>
<Node><Sub>1</Sub>
<Data>27,65,7+n</Data>
</Node>
</Node>
</Node>
<Node><Sub>Step</Sub>
<Data>2</Data>
</Node>
<Node><Sub>SubTitle</Sub>
<Data>- ~n -</Data>
</Node>
</Node>
<Node><Sub>PrinterIni</Sub>
<Data><![CDATA[Конфигуpация пpинтеpа@@@@@1@1@6@14@16@60@1@@1@@@1@@1,3@1@@@@@1@@@11@5@@2;6;30;42@@@@@@@2@^%ZAPM.ed.BSX("PrnSetHelp")@@@@1]]></Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@25@@@@@1@1;6;37;42@@@@@ Устойство печати .......</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@26@1@1@@@@@1@2;6;30;47@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>1@27@1@10@@@1@@1@2;6;30;47@@@@@3@0</Data>
</Node>
<Node><Sub>4</Sub>
<Data>1@37@1@1@1@@@@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>1@38@1@10@1@@@@1@2;6;30;42@@@@@@</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@25@@@@@1@2;6;30;42@@@@@=======  Команда =======@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>2@26@1@1@@@@@1@2;6;30;42@@@@@В@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>2@27@1@10@1@@@@1@2;6;30;42@@@@@ключить ==@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>2@37@1@1@1@@@@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>2@38@1@10@1@@@@1@2;6;30;42@@@@@Выключить@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@25@@@@@1@1;6;37;42@@@@@ Стpока инициализации ...@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@26@1@1@@@@@1@2;6;30;47@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>3@27@1@10@@@1@@1@2;6;30;47@@@@@10,13@0</Data>
</Node>
<Node><Sub>4</Sub>
<Data>3@37@1@1@1@@@@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>3@38@1@10@@@1@0@1@2;6;30;47@@@@@10,13@0</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>4@1@1@25@@@@@1@1;6;37;42@@@@@ Интеpвал ( 1/72 дюйма ).@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>4@26@1@1@@@@@1@2;6;30;47@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>4@27@1@10@@@1@@1@2;6;30;47@@@@@27,65,7+n@0</Data>
</Node>
<Node><Sub>4</Sub>
<Data>4@37@1@1@1@@@@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>4@38@1@10@@@1@0@1@2;6;30;47@@@@@27,65,9@0</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>5@1@1@25@@@@@1@1;6;37;42@@@@@ Плотность 10/12 сим/дюйм@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>5@26@1@1@@@@@1@2;6;30;47@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>5@27@1@10@@@1@@1@2;6;30;47@@@@@27,80@0</Data>
</Node>
<Node><Sub>4</Sub>
<Data>5@37@1@1@1@@@@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>5@38@1@10@@@1@0@1@2;6;30;47@@@@@27,77@0</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>6@1@1@25@@@@@1@1;6;37;42@@@@@ Сжатый шpифт ...........@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>6@26@1@1@@@@@1@2;6;30;47@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>6@27@1@10@@@1@@1@2;6;30;47@@@@@15@0</Data>
</Node>
<Node><Sub>4</Sub>
<Data>6@37@1@1@1@@@@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>6@38@1@10@@@1@0@1@2;6;30;47@@@@@18@0</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>7@1@1@25@@@@@1@1;6;37;42@@@@@ Качественная печать ....@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>7@26@1@1@@@@@1@2;6;30;47@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>7@27@1@10@@@1@@1@2;6;30;47@@@@@27,120,1@0</Data>
</Node>
<Node><Sub>4</Sub>
<Data>7@37@1@1@1@@@@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>7@38@1@10@@@1@0@1@2;6;30;47@@@@@27,120,0@0</Data>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>1</Sub>
<Data>8@1@1@25@@@@@1@1;6;37;42@@@@@ Выделенная печать ......@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>8@26@1@1@@@@@1@2;6;30;47@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>8@27@1@10@@@1@@1@2;6;30;47@@@@@27,69@0</Data>
</Node>
<Node><Sub>4</Sub>
<Data>8@37@1@1@1@@@@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>8@38@1@10@@@1@0@1@2;6;30;47@@@@@27,70@0</Data>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>1</Sub>
<Data>9@1@1@25@@@@@1@1;6;37;42@@@@@ Двойная печать .........@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>9@26@1@1@@@@@1@2;6;30;47@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>9@27@1@10@@@1@@1@2;6;30;47@@@@@27,71@0</Data>
</Node>
<Node><Sub>4</Sub>
<Data>9@37@1@1@1@@@@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>9@38@1@10@@@1@0@1@2;6;30;47@@@@@27,72@0</Data>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>1</Sub>
<Data>10@1@1@25@@@@@1@1;6;37;42@@@@@ Куpсив .................@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>10@26@1@1@@@@@1@2;6;30;47@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>10@27@1@10@@@1@@1@2;6;30;47@@@@@27,52@0</Data>
</Node>
<Node><Sub>4</Sub>
<Data>10@37@1@1@1@@@@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>10@38@1@10@@@1@0@1@2;6;30;47@@@@@27,53@0</Data>
</Node>
</Node>
<Node><Sub>11</Sub>
<Node><Sub>1</Sub>
<Data>11@1@1@25@@@@@1@1;6;37;42@@@@@ Пеpевод стpаницы .......@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>11@26@1@1@@@@@1@2;6;30;47@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>11@27@1@10@@@1@@1@2;6;30;47@@@@@12@0@@@</Data>
</Node>
<Node><Sub>4</Sub>
<Data>11@37@1@1@1@@@@1@2;6;30;42@@@@@@</Data>
</Node>
<Node><Sub>5</Sub>
<Data>11@38@1@10@1@@@0@1@2;6;30;42@@@@@@</Data>
</Node>
</Node>
<Node><Sub>FCL</Sub>
<Node><Sub>1</Sub>
<Node><Sub>3</Sub>
<Data>S d1=+$$GetSet^%ZAPM.ed.BSXform(&quot;Device&quot;)</Data>
<Node><Sub>1</Sub>
<Data>+$$GetSet^%ZAPM.ed.BSXform(&quot;Device&quot;)</Data>
</Node>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>3</Sub>
<Data>S d1=$$GetSet^%ZAPM.ed.BSXform(&quot;Init&quot;,1)</Data>
<Node><Sub>1</Sub>
<Data>$$GetSet^%ZAPM.ed.BSXform(&quot;Init&quot;,1)</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Data>S d1=$$GetSet^%ZAPM.ed.BSXform(&quot;Init&quot;,0)</Data>
<Node><Sub>1</Sub>
<Data>$$GetSet^%ZAPM.ed.BSXform(&quot;Init&quot;,0)</Data>
</Node>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>3</Sub>
<Data>S d1=$$GetSet^%ZAPM.ed.BSXform(&quot;Step&quot;,1)</Data>
<Node><Sub>1</Sub>
<Data>$$GetSet^%ZAPM.ed.BSXform(&quot;Step&quot;,1)</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Data>S d1=$$GetSet^%ZAPM.ed.BSXform(&quot;Step&quot;,0)</Data>
<Node><Sub>1</Sub>
<Data>$$GetSet^%ZAPM.ed.BSXform(&quot;Step&quot;,0)</Data>
</Node>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>3</Sub>
<Data>S d1=$$GetSet^%ZAPM.ed.BSXform(&quot;10/12cpi&quot;,1)</Data>
<Node><Sub>1</Sub>
<Data>$$GetSet^%ZAPM.ed.BSXform(&quot;10/12cpi&quot;,1)</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Data>S d1=$$GetSet^%ZAPM.ed.BSXform(&quot;10/12cpi&quot;,0)</Data>
<Node><Sub>1</Sub>
<Data>$$GetSet^%ZAPM.ed.BSXform(&quot;10/12cpi&quot;,0)</Data>
</Node>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>3</Sub>
<Data>S d1=$$GetSet^%ZAPM.ed.BSXform(&quot;Condens&quot;,1)</Data>
<Node><Sub>1</Sub>
<Data>$$GetSet^%ZAPM.ed.BSXform(&quot;Condens&quot;,1)</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Data>S d1=$$GetSet^%ZAPM.ed.BSXform(&quot;Condens&quot;,0)</Data>
<Node><Sub>1</Sub>
<Data>$$GetSet^%ZAPM.ed.BSXform(&quot;Condens&quot;,0)</Data>
</Node>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>3</Sub>
<Data>S d1=$$GetSet^%ZAPM.ed.BSXform(&quot;NLQ&quot;,1)</Data>
<Node><Sub>1</Sub>
<Data>$$GetSet^%ZAPM.ed.BSXform(&quot;NLQ&quot;,1)</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Data>S d1=$$GetSet^%ZAPM.ed.BSXform(&quot;NLQ&quot;,0)</Data>
<Node><Sub>1</Sub>
<Data>$$GetSet^%ZAPM.ed.BSXform(&quot;NLQ&quot;,0)</Data>
</Node>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>3</Sub>
<Data>S d1=$$GetSet^%ZAPM.ed.BSXform(&quot;Emphasise&quot;,1)</Data>
<Node><Sub>1</Sub>
<Data>$$GetSet^%ZAPM.ed.BSXform(&quot;Emphasise&quot;,1)</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Data>S d1=$$GetSet^%ZAPM.ed.BSXform(&quot;Emphasise&quot;,0)</Data>
<Node><Sub>1</Sub>
<Data>$$GetSet^%ZAPM.ed.BSXform(&quot;Emphasise&quot;,0)</Data>
</Node>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>3</Sub>
<Data>S d1=$$GetSet^%ZAPM.ed.BSXform(&quot;DoubleStrike&quot;,1)</Data>
<Node><Sub>1</Sub>
<Data>$$GetSet^%ZAPM.ed.BSXform(&quot;DoubleStrike&quot;,1)</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Data>S d1=$$GetSet^%ZAPM.ed.BSXform(&quot;DoubleStrike&quot;,0)</Data>
<Node><Sub>1</Sub>
<Data>$$GetSet^%ZAPM.ed.BSXform(&quot;DoubleStrike&quot;,0)</Data>
</Node>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>3</Sub>
<Data>S d1=$$GetSet^%ZAPM.ed.BSXform(&quot;Cursiv&quot;,1)</Data>
<Node><Sub>1</Sub>
<Data>$$GetSet^%ZAPM.ed.BSXform(&quot;Cursiv&quot;,1)</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Data>S d1=$$GetSet^%ZAPM.ed.BSXform(&quot;Cursiv&quot;,0)</Data>
<Node><Sub>1</Sub>
<Data>$$GetSet^%ZAPM.ed.BSXform(&quot;Cursiv&quot;,0)</Data>
</Node>
</Node>
</Node>
<Node><Sub>11</Sub>
<Node><Sub>3</Sub>
<Data>S d1=$$GetSet^%ZAPM.ed.BSXform(&quot;FormFeed&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$$GetSet^%ZAPM.ed.BSXform(&quot;FormFeed&quot;)</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>FTR</Sub>
<Node><Sub>3</Sub>
<Node><Sub>5</Sub>
<Data>S d1=&quot; &quot;_d</Data>
<Node><Sub>1</Sub>
<Data>&quot; &quot;_d</Data>
</Node>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>5</Sub>
<Data>S d1=&quot; &quot;_d</Data>
<Node><Sub>1</Sub>
<Data>&quot; &quot;_d</Data>
</Node>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>5</Sub>
<Data>S d1=&quot; &quot;_d</Data>
<Node><Sub>1</Sub>
<Data>&quot; &quot;_d</Data>
</Node>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>5</Sub>
<Data>S d1=&quot; &quot;_d</Data>
<Node><Sub>1</Sub>
<Data>&quot; &quot;_d</Data>
</Node>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>5</Sub>
<Data>S d1=&quot; &quot;_d</Data>
<Node><Sub>1</Sub>
<Data>&quot; &quot;_d</Data>
</Node>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>5</Sub>
<Data>S d1=&quot; &quot;_d</Data>
<Node><Sub>1</Sub>
<Data>&quot; &quot;_d</Data>
</Node>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>5</Sub>
<Data>S d1=&quot; &quot;_d</Data>
<Node><Sub>1</Sub>
<Data>&quot; &quot;_d</Data>
</Node>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>5</Sub>
<Data>S d1=&quot; &quot;_d</Data>
<Node><Sub>1</Sub>
<Data>&quot; &quot;_d</Data>
</Node>
</Node>
</Node>
<Node><Sub>11</Sub>
<Node><Sub>5</Sub>
<Data>S d1=&quot; &quot;_d</Data>
<Node><Sub>1</Sub>
<Data>&quot; &quot;_d</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>RTR</Sub>
<Node><Sub>1</Sub>
<Node><Sub>3</Sub>
<Data>S d1=$$IF^%ZAPM.ed.BSsFUNR(&quot;d?.N,+d&lt;100&quot;,&quot;READ&quot;) i YES d SetSet^%ZAPM.ed.BSXform(&quot;Device&quot;,&quot;&quot;,d)</Data>
<Node><Sub>1</Sub>
<Data>$$IF(&quot;d?.N,+d&lt;100&quot;,&quot;READ&quot;) i YES d SetSet^%ZAPM.ed.BSXform(&quot;Device&quot;,&quot;&quot;,d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>3</Sub>
<Data><![CDATA[S d1=$$IF^%ZAPM.ed.BSsFUNR("1 n n s n=0 x:d'="""" ""s n=$C(""_d_"")""","READ") i YES d SetSet^%ZAPM.ed.BSXform("Init",1,d)]]></Data>
<Node><Sub>1</Sub>
<Data>$$IF(&quot;1 n n s n=0 x:d&apos;=&quot;&quot;&quot;&quot; &quot;&quot;s n=$C(&quot;&quot;_d_&quot;&quot;)&quot;&quot;&quot;,&quot;READ&quot;) i YES d SetSet^%ZAPM.ed.BSXform(&quot;Init&quot;,1,d)</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Data><![CDATA[S d1=$$IF^%ZAPM.ed.BSsFUNR("1 n n s n=0 x:d'="""" ""s n=$C(""_d_"")""","READ") i YES d SetSet^%ZAPM.ed.BSXform("Init",0,d)]]></Data>
<Node><Sub>1</Sub>
<Data>$$IF(&quot;1 n n s n=0 x:d&apos;=&quot;&quot;&quot;&quot; &quot;&quot;s n=$C(&quot;&quot;_d_&quot;&quot;)&quot;&quot;&quot;,&quot;READ&quot;) i YES d SetSet^%ZAPM.ed.BSXform(&quot;Init&quot;,0,d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>3</Sub>
<Data><![CDATA[S d1=$$IF^%ZAPM.ed.BSsFUNR("1 n n s n=0 x:d'="""" ""s n=$C(""_d_"")""","READ") i YES d SetSet^%ZAPM.ed.BSXform("Step",1,d)]]></Data>
<Node><Sub>1</Sub>
<Data>$$IF(&quot;1 n n s n=0 x:d&apos;=&quot;&quot;&quot;&quot; &quot;&quot;s n=$C(&quot;&quot;_d_&quot;&quot;)&quot;&quot;&quot;,&quot;READ&quot;) i YES d SetSet^%ZAPM.ed.BSXform(&quot;Step&quot;,1,d)</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Data><![CDATA[S d1=$$IF^%ZAPM.ed.BSsFUNR("1 n n s n=0 x:d'="""" ""s n=$C(""_d_"")""","READ") i YES d SetSet^%ZAPM.ed.BSXform("Step",0,d)]]></Data>
<Node><Sub>1</Sub>
<Data>$$IF(&quot;1 n n s n=0 x:d&apos;=&quot;&quot;&quot;&quot; &quot;&quot;s n=$C(&quot;&quot;_d_&quot;&quot;)&quot;&quot;&quot;,&quot;READ&quot;) i YES d SetSet^%ZAPM.ed.BSXform(&quot;Step&quot;,0,d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>3</Sub>
<Data><![CDATA[S d1=$$IF^%ZAPM.ed.BSsFUNR("1 n n s n=0 x:d'="""" ""s n=$C(""_d_"")""","READ") i YES d SetSet^%ZAPM.ed.BSXform("10/12cpi",1,d)]]></Data>
<Node><Sub>1</Sub>
<Data><![CDATA[$$IF("1 n n s n=0 x:d'="""" ""s n=$C(""_d_"")""","READ") i YES d SetSet^%ZAPM.ed.BSXform("10/12cpi",1,d)]]></Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Data><![CDATA[S d1=$$IF^%ZAPM.ed.BSsFUNR("1 n n s n=0 x:d'="""" ""s n=$C(""_d_"")""","READ") i YES d SetSet^%ZAPM.ed.BSXform("10/12cpi",0,d)]]></Data>
<Node><Sub>1</Sub>
<Data><![CDATA[$$IF("1 n n s n=0 x:d'="""" ""s n=$C(""_d_"")""","READ") i YES d SetSet^%ZAPM.ed.BSXform("10/12cpi",0,d)]]></Data>
</Node>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>3</Sub>
<Data><![CDATA[S d1=$$IF^%ZAPM.ed.BSsFUNR("1 n n s n=0 x:d'="""" ""s n=$C(""_d_"")""","READ") i YES d SetSet^%ZAPM.ed.BSXform("Condens",1,d)]]></Data>
<Node><Sub>1</Sub>
<Data><![CDATA[$$IF("1 n n s n=0 x:d'="""" ""s n=$C(""_d_"")""","READ") i YES d SetSet^%ZAPM.ed.BSXform("Condens",1,d)]]></Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Data><![CDATA[S d1=$$IF^%ZAPM.ed.BSsFUNR("1 n n s n=0 x:d'="""" ""s n=$C(""_d_"")""","READ") i YES d SetSet^%ZAPM.ed.BSXform("Condens",0,d)]]></Data>
<Node><Sub>1</Sub>
<Data><![CDATA[$$IF("1 n n s n=0 x:d'="""" ""s n=$C(""_d_"")""","READ") i YES d SetSet^%ZAPM.ed.BSXform("Condens",0,d)]]></Data>
</Node>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>3</Sub>
<Data><![CDATA[S d1=$$IF^%ZAPM.ed.BSsFUNR("1 n n s n=0 x:d'="""" ""s n=$C(""_d_"")""","READ") i YES d SetSet^%ZAPM.ed.BSXform("NLQ",1,d)]]></Data>
<Node><Sub>1</Sub>
<Data>$$IF(&quot;1 n n s n=0 x:d&apos;=&quot;&quot;&quot;&quot; &quot;&quot;s n=$C(&quot;&quot;_d_&quot;&quot;)&quot;&quot;&quot;,&quot;READ&quot;) i YES d SetSet^%ZAPM.ed.BSXform(&quot;NLQ&quot;,1,d)</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Data><![CDATA[S d1=$$IF^%ZAPM.ed.BSsFUNR("1 n n s n=0 x:d'="""" ""s n=$C(""_d_"")""","READ") i YES d SetSet^%ZAPM.ed.BSXform("NLQ",0,d)]]></Data>
<Node><Sub>1</Sub>
<Data>$$IF(&quot;1 n n s n=0 x:d&apos;=&quot;&quot;&quot;&quot; &quot;&quot;s n=$C(&quot;&quot;_d_&quot;&quot;)&quot;&quot;&quot;,&quot;READ&quot;) i YES d SetSet^%ZAPM.ed.BSXform(&quot;NLQ&quot;,0,d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>3</Sub>
<Data><![CDATA[S d1=$$IF^%ZAPM.ed.BSsFUNR("1 n n s n=0 x:d'="""" ""s n=$C(""_d_"")""","READ") i YES d SetSet^%ZAPM.ed.BSXform("Emphasise",1,d)]]></Data>
<Node><Sub>1</Sub>
<Data><![CDATA[$$IF("1 n n s n=0 x:d'="""" ""s n=$C(""_d_"")""","READ") i YES d SetSet^%ZAPM.ed.BSXform("Emphasise",1,d)]]></Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Data><![CDATA[S d1=$$IF^%ZAPM.ed.BSsFUNR("1 n n s n=0 x:d'="""" ""s n=$C(""_d_"")""","READ") i YES d SetSet^%ZAPM.ed.BSXform("Emphasise",0,d)]]></Data>
<Node><Sub>1</Sub>
<Data><![CDATA[$$IF("1 n n s n=0 x:d'="""" ""s n=$C(""_d_"")""","READ") i YES d SetSet^%ZAPM.ed.BSXform("Emphasise",0,d)]]></Data>
</Node>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>3</Sub>
<Data><![CDATA[S d1=$$IF^%ZAPM.ed.BSsFUNR("1 n n s n=0 x:d'="""" ""s n=$C(""_d_"")""","READ") i YES d SetSet^%ZAPM.ed.BSXform("DoubleStrike",1,d)]]></Data>
<Node><Sub>1</Sub>
<Data><![CDATA[$$IF("1 n n s n=0 x:d'="""" ""s n=$C(""_d_"")""","READ") i YES d SetSet^%ZAPM.ed.BSXform("DoubleStrike",1,d)]]></Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Data><![CDATA[S d1=$$IF^%ZAPM.ed.BSsFUNR("1 n n s n=0 x:d'="""" ""s n=$C(""_d_"")""","READ") i YES d SetSet^%ZAPM.ed.BSXform("DoubleStrike",0,d)]]></Data>
<Node><Sub>1</Sub>
<Data><![CDATA[$$IF("1 n n s n=0 x:d'="""" ""s n=$C(""_d_"")""","READ") i YES d SetSet^%ZAPM.ed.BSXform("DoubleStrike",0,d)]]></Data>
</Node>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>3</Sub>
<Data><![CDATA[S d1=$$IF^%ZAPM.ed.BSsFUNR("1 n n s n=0 x:d'="""" ""s n=$C(""_d_"")""","READ") i YES d SetSet^%ZAPM.ed.BSXform("Cursiv",1,d)]]></Data>
<Node><Sub>1</Sub>
<Data><![CDATA[$$IF("1 n n s n=0 x:d'="""" ""s n=$C(""_d_"")""","READ") i YES d SetSet^%ZAPM.ed.BSXform("Cursiv",1,d)]]></Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Data><![CDATA[S d1=$$IF^%ZAPM.ed.BSsFUNR("1 n n s n=0 x:d'="""" ""s n=$C(""_d_"")""","READ") i YES d SetSet^%ZAPM.ed.BSXform("Cursiv",0,d)]]></Data>
<Node><Sub>1</Sub>
<Data><![CDATA[$$IF("1 n n s n=0 x:d'="""" ""s n=$C(""_d_"")""","READ") i YES d SetSet^%ZAPM.ed.BSXform("Cursiv",0,d)]]></Data>
</Node>
</Node>
</Node>
<Node><Sub>11</Sub>
<Node><Sub>3</Sub>
<Data><![CDATA[S d1=$$IF^%ZAPM.ed.BSsFUNR("1 n n s n=0 x:d'="""" ""s n=$C(""_d_"")""","READ") i YES d SetSet^%ZAPM.ed.BSXform("FormFeed","",d)]]></Data>
<Node><Sub>1</Sub>
<Data><![CDATA[$$IF("1 n n s n=0 x:d'="""" ""s n=$C(""_d_"")""","READ") i YES d SetSet^%ZAPM.ed.BSXform("FormFeed","",d)]]></Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>STA</Sub>
<Data>11,3@1@3@27@-1@-1@16@40@12</Data>
</Node>
</Node>
<Node><Sub>PrinterSet</Sub>
<Data><![CDATA[Паpаметpы пpинтеpа@@@@@1@1@4@21@19@54@1@@1@@@1@@2,3@1@@@@@@@@15@3@@2;6;37;44@@@@@@@2@^%ZAPM.ed.BSX("PrnIniHelp")]]></Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@2@26@@@@@1@2;6;37;44@@@@@         Паpаметы пpинтеpа==========================</Data>
</Node>
<Node><Sub>2</Sub>
<Data>1@27@2@1@@@@@1@2;6;37;44@@@@@ =@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>1@28@2@7@@@@@1@2;6;37;44@@@@@       =======</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@26@@@@@1@1;6;37;44@@@@@ Плотность печти .........</Data>
</Node>
<Node><Sub>2</Sub>
<Data>3@27@1@1@@@@@1@2;6;30;47@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>3@28@1@7@@@1@@1@2;6;30;47@@@@^%ZAPM.ed.BSX(&quot;PrinterWid&quot;)@12 с/д@0@@@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>4@1@1@26@@@@@1@1;6;37;44@@@@@ Стpок на стpаницу ....... ( 0 - печать без листов )</Data>
</Node>
<Node><Sub>2</Sub>
<Data>4@27@1@1@@@@@1@2;6;30;47@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>4@28@1@7@@@1@@1@2;6;30;47@@@@@60@0</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>5@1@1@26@@@@@1@1;6;37;44@@@@@ Интеpвал между стpок ....@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>5@27@1@1@@@@@1@2;6;30;47@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>5@28@1@7@@@1@@1@2;6;30;47@@@@@2@0</Data>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>1</Sub>
<Data>6@1@1@26@@@@@1@1;6;37;44@@@@@ Качественная печать .....@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>6@27@1@1@@@@@1@2;6;30;47@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>6@28@1@7@@@1@@1@2;6;30;47@@@@^%ZAPM.ed.BSX(&quot;PrnAsk&quot;)@Нет@0</Data>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>1</Sub>
<Data>7@1@1@26@@@@@1@1;6;37;44@@@@@ Выделенная печать .......@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>7@27@1@1@@@@@1@2;6;30;47@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>7@28@1@7@@@1@@1@2;6;30;47@@@@^%ZAPM.ed.BSX(&quot;PrnAsk&quot;)@Нет@0</Data>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>1</Sub>
<Data>8@1@1@26@@@@@1@1;6;37;44@@@@@ Двойная печать ..........@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>8@27@1@1@@@@@1@2;6;30;47@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>8@28@1@7@@@1@@1@2;6;30;47@@@@^%ZAPM.ed.BSX(&quot;PrnAsk&quot;)@Нет@0</Data>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>1</Sub>
<Data>9@1@1@26@@@@@1@1;6;37;44@@@@@ Куpсив ..................@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>9@27@1@1@@@@@1@2;6;30;47@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>9@28@1@7@@@1@@1@2;6;30;47@@@@^%ZAPM.ed.BSX(&quot;PrnAsk&quot;)@Нет@0</Data>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>1</Sub>
<Data>10@1@1@26@@@@@1@1;6;37;44@@@@@ Подтвеpждение стpаниц ...</Data>
</Node>
<Node><Sub>2</Sub>
<Data>10@27@1@1@@@@@1@2;6;30;47@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>10@28@1@7@@@1@@1@2;6;30;47@@@@^%ZAPM.ed.BSX(&quot;PrnAsk&quot;)@Да@0</Data>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>1</Sub>
<Data>11@1@1@26@@@@@1@1;6;37;44@@@@@ Пеpевод стpаницы ........@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>11@27@1@1@@@@@1@2;6;30;47@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>11@28@1@7@@@1@@1@2;6;30;47@@@@^%ZAPM.ed.BSX(&quot;PrnAsk&quot;)@Да@0</Data>
</Node>
</Node>
<Node><Sub>11</Sub>
<Node><Sub>1</Sub>
<Data>12@1@1@26@@@@@1@1;6;37;44@@@@@ Расставлять стpаницы ....@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>12@27@1@1@@@@@1@2;6;30;47@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>12@28@1@7@@@1@@1@2;6;30;47@@@@^%ZAPM.ed.BSX(&quot;PrnPages&quot;)@Ввеpху@0</Data>
</Node>
</Node>
<Node><Sub>12</Sub>
<Node><Sub>1</Sub>
<Data>13@1@1@26@@@@@1@1;6;37;44@@@@@ Колонтитул ..............@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>13@27@1@1@@@@@1@2;6;30;47@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>13@28@1@7@@@1@@1@2;6;30;47@@@@@- ~n -@0</Data>
</Node>
</Node>
<Node><Sub>13</Sub>
<Node><Sub>1</Sub>
<Data>14@1@1@26@@@@@1@1;6;37;44@@@@@ Разделитель стpаниц .....@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>14@27@1@1@@@@@1@2;6;30;47@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>14@28@1@7@@@1@@1@2;6;30;47@@@@@+@0</Data>
</Node>
</Node>
<Node><Sub>14</Sub>
<Node><Sub>1</Sub>
<Data>15@1@1@26@@@@@1@1;6;37;44@@@@@ Отступ от левого кpая ...</Data>
</Node>
<Node><Sub>2</Sub>
<Data>15@27@1@1@@@@@1@2;6;30;47@@@@@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>15@28@1@7@@@1@@1@2;6;30;47@@@@@10@0</Data>
</Node>
</Node>
<Node><Sub>15</Sub>
<Node><Sub>1</Sub>
<Data>16@1@1@26@@@@@1@1;6;37;44@@@@@ Настpойка пpинтеpа ......@</Data>
</Node>
<Node><Sub>2</Sub>
<Data>16@27@1@1@@@@@1@2;6;30;47@@@@^%ZAPM.ed.BSX(&quot;PrinterIni&quot;)@@</Data>
</Node>
<Node><Sub>3</Sub>
<Data>16@28@1@7@1@@@@1@2;6;30;47@@@@15,3@@@@@</Data>
</Node>
</Node>
<Node><Sub>CMD</Sub>
<Node><Sub>15</Sub>
<Node><Sub>3</Sub>
<Data>d PrnInit^%ZAPM.ed.BSXform</Data>
</Node>
</Node>
</Node>
<Node><Sub>FCL</Sub>
<Node><Sub>2</Sub>
<Node><Sub>3</Sub>
<Data><![CDATA[S d1=+$$GetStat^%ZAPM.ed.BSXform("Chars") s d1=$S(d1=0:"10 с/д",d1=1:"12 с/д",d1=2:"17 с/д",d1=3:"20 с/д",1:"???")]]></Data>
<Node><Sub>1</Sub>
<Data><![CDATA[+$$GetStat^%ZAPM.ed.BSXform("Chars") s d1=$S(d1=0:"10 с/д",d1=1:"12 с/д",d1=2:"17 с/д",d1=3:"20 с/д",1:"???")]]></Data>
</Node>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>3</Sub>
<Data>S d1=+$$GetStat^%ZAPM.ed.BSXform(&quot;Lines&quot;)</Data>
<Node><Sub>1</Sub>
<Data>+$$GetStat^%ZAPM.ed.BSXform(&quot;Lines&quot;)</Data>
</Node>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>3</Sub>
<Data>S d1=+$$GetStat^%ZAPM.ed.BSXform(&quot;Step&quot;)</Data>
<Node><Sub>1</Sub>
<Data>+$$GetStat^%ZAPM.ed.BSXform(&quot;Step&quot;)</Data>
</Node>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>3</Sub>
<Data>S d1=$S(+$$GetStat^%ZAPM.ed.BSXform(&quot;NLQ&quot;):&quot;Да&quot;,1:&quot;Нет&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$S(+$$GetStat^%ZAPM.ed.BSXform(&quot;NLQ&quot;):&quot;Да&quot;,1:&quot;Нет&quot;)</Data>
</Node>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>3</Sub>
<Data>S d1=$S(+$$GetStat^%ZAPM.ed.BSXform(&quot;Emphasise&quot;):&quot;Да&quot;,1:&quot;Нет&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$S(+$$GetStat^%ZAPM.ed.BSXform(&quot;Emphasise&quot;):&quot;Да&quot;,1:&quot;Нет&quot;)</Data>
</Node>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>3</Sub>
<Data>S d1=$S(+$$GetStat^%ZAPM.ed.BSXform(&quot;DoubleStrike&quot;):&quot;Да&quot;,1:&quot;Нет&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$S(+$$GetStat^%ZAPM.ed.BSXform(&quot;DoubleStrike&quot;):&quot;Да&quot;,1:&quot;Нет&quot;)</Data>
</Node>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>3</Sub>
<Data>S d1=$S(+$$GetStat^%ZAPM.ed.BSXform(&quot;Cursiv&quot;):&quot;Да&quot;,1:&quot;Нет&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$S(+$$GetStat^%ZAPM.ed.BSXform(&quot;Cursiv&quot;):&quot;Да&quot;,1:&quot;Нет&quot;)</Data>
</Node>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>3</Sub>
<Data>S d1=$S(+$$GetStat^%ZAPM.ed.BSXform(&quot;AskPage&quot;):&quot;Да&quot;,1:&quot;Нет&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$S(+$$GetStat^%ZAPM.ed.BSXform(&quot;AskPage&quot;):&quot;Да&quot;,1:&quot;Нет&quot;)</Data>
</Node>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>3</Sub>
<Data>S d1=$S(+$$GetStat^%ZAPM.ed.BSXform(&quot;Eject&quot;):&quot;Да&quot;,1:&quot;Нет&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$S(+$$GetStat^%ZAPM.ed.BSXform(&quot;Eject&quot;):&quot;Да&quot;,1:&quot;Нет&quot;)</Data>
</Node>
</Node>
</Node>
<Node><Sub>11</Sub>
<Node><Sub>3</Sub>
<Data>S d1=+$$GetStat^%ZAPM.ed.BSXform(&quot;PageNum&quot;) s d1=$S(d1=0:&quot;Нет&quot;,d1=1:&quot;Ввеpху&quot;,d1=2:&quot;Внизу&quot;,1:&quot;???&quot;)</Data>
<Node><Sub>1</Sub>
<Data>+$$GetStat^%ZAPM.ed.BSXform(&quot;PageNum&quot;) s d1=$S(d1=0:&quot;Нет&quot;,d1=1:&quot;Ввеpху&quot;,d1=2:&quot;Внизу&quot;,1:&quot;???&quot;)</Data>
</Node>
</Node>
</Node>
<Node><Sub>12</Sub>
<Node><Sub>3</Sub>
<Data>S d1=$$GetStat^%ZAPM.ed.BSXform(&quot;SubTitle&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$$GetStat^%ZAPM.ed.BSXform(&quot;SubTitle&quot;)</Data>
</Node>
</Node>
</Node>
<Node><Sub>13</Sub>
<Node><Sub>3</Sub>
<Data>S d1=$$GetStat^%ZAPM.ed.BSXform(&quot;PageBreak&quot;)</Data>
<Node><Sub>1</Sub>
<Data>$$GetStat^%ZAPM.ed.BSXform(&quot;PageBreak&quot;)</Data>
</Node>
</Node>
</Node>
<Node><Sub>14</Sub>
<Node><Sub>3</Sub>
<Data>S d1=+$$GetStat^%ZAPM.ed.BSXform(&quot;Margin&quot;)</Data>
<Node><Sub>1</Sub>
<Data>+$$GetStat^%ZAPM.ed.BSXform(&quot;Margin&quot;)</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>RTR</Sub>
<Node><Sub>2</Sub>
<Node><Sub>3</Sub>
<Data>S d1=$$IF^%ZAPM.ed.BSsFUNR(&quot;d?.N,+d&lt;4&quot;,&quot;READ&quot;) i YES d SetStat^%ZAPM.ed.BSXform(&quot;Chars&quot;,+d)</Data>
<Node><Sub>1</Sub>
<Data>$$IF(&quot;d?.N,+d&lt;4&quot;,&quot;READ&quot;) i YES d SetStat^%ZAPM.ed.BSXform(&quot;Chars&quot;,+d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>3</Sub>
<Data>S d1=$$IF^%ZAPM.ed.BSsFUNR(&quot;+d&gt;2,+d&lt;200&quot;,&quot;READ&quot;) i YES d SetStat^%ZAPM.ed.BSXform(&quot;Lines&quot;,+d)</Data>
<Node><Sub>1</Sub>
<Data>$$IF(&quot;+d&gt;2,+d&lt;200&quot;,&quot;READ&quot;) i YES d SetStat^%ZAPM.ed.BSXform(&quot;Lines&quot;,+d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>3</Sub>
<Data>S d1=$$IF^%ZAPM.ed.BSsFUNR(&quot;+d&gt;-9,+d&lt;31&quot;,&quot;READ&quot;) i YES d SetStat^%ZAPM.ed.BSXform(&quot;Step&quot;,+d)</Data>
<Node><Sub>1</Sub>
<Data>$$IF(&quot;+d&gt;-9,+d&lt;31&quot;,&quot;READ&quot;) i YES d SetStat^%ZAPM.ed.BSXform(&quot;Step&quot;,+d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>5</Sub>
<Node><Sub>3</Sub>
<Data>S d1=$$IF^%ZAPM.ed.BSsFUNR(&quot;d?1N,+d&lt;2&quot;,&quot;READ&quot;) i YES d SetStat^%ZAPM.ed.BSXform(&quot;NLQ&quot;,+d)</Data>
<Node><Sub>1</Sub>
<Data>$$IF(&quot;d?1N,+d&lt;2&quot;,&quot;READ&quot;) i YES d SetStat^%ZAPM.ed.BSXform(&quot;NLQ&quot;,+d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>6</Sub>
<Node><Sub>3</Sub>
<Data>S d1=$$IF^%ZAPM.ed.BSsFUNR(&quot;d?1N,+d&lt;2&quot;,&quot;READ&quot;) i YES d SetStat^%ZAPM.ed.BSXform(&quot;Emphasise&quot;,+d)</Data>
<Node><Sub>1</Sub>
<Data>$$IF(&quot;d?1N,+d&lt;2&quot;,&quot;READ&quot;) i YES d SetStat^%ZAPM.ed.BSXform(&quot;Emphasise&quot;,+d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>7</Sub>
<Node><Sub>3</Sub>
<Data>S d1=$$IF^%ZAPM.ed.BSsFUNR(&quot;d?1N,+d&lt;2&quot;,&quot;READ&quot;) i YES d SetStat^%ZAPM.ed.BSXform(&quot;DoubleStrike&quot;,+d)</Data>
<Node><Sub>1</Sub>
<Data>$$IF(&quot;d?1N,+d&lt;2&quot;,&quot;READ&quot;) i YES d SetStat^%ZAPM.ed.BSXform(&quot;DoubleStrike&quot;,+d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>8</Sub>
<Node><Sub>3</Sub>
<Data>S d1=$$IF^%ZAPM.ed.BSsFUNR(&quot;d?1N,+d&lt;2&quot;,&quot;READ&quot;) i YES d SetStat^%ZAPM.ed.BSXform(&quot;Cursiv&quot;,+d)</Data>
<Node><Sub>1</Sub>
<Data>$$IF(&quot;d?1N,+d&lt;2&quot;,&quot;READ&quot;) i YES d SetStat^%ZAPM.ed.BSXform(&quot;Cursiv&quot;,+d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>9</Sub>
<Node><Sub>3</Sub>
<Data>S d1=$$IF^%ZAPM.ed.BSsFUNR(&quot;d?1N,+d&lt;2&quot;,&quot;READ&quot;) i YES d SetStat^%ZAPM.ed.BSXform(&quot;AskPage&quot;,+d)</Data>
<Node><Sub>1</Sub>
<Data>$$IF(&quot;d?1N,+d&lt;2&quot;,&quot;READ&quot;) i YES d SetStat^%ZAPM.ed.BSXform(&quot;AskPage&quot;,+d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>10</Sub>
<Node><Sub>3</Sub>
<Data>S d1=$$IF^%ZAPM.ed.BSsFUNR(&quot;d?1N,+d&lt;2&quot;,&quot;READ&quot;) i YES d SetStat^%ZAPM.ed.BSXform(&quot;Eject&quot;,+d)</Data>
<Node><Sub>1</Sub>
<Data>$$IF(&quot;d?1N,+d&lt;2&quot;,&quot;READ&quot;) i YES d SetStat^%ZAPM.ed.BSXform(&quot;Eject&quot;,+d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>11</Sub>
<Node><Sub>3</Sub>
<Data>S d1=$$IF^%ZAPM.ed.BSsFUNR(&quot;d?1N,+d&lt;3&quot;,&quot;READ&quot;) i YES d SetStat^%ZAPM.ed.BSXform(&quot;PageNum&quot;,+d)</Data>
<Node><Sub>1</Sub>
<Data>$$IF(&quot;d?1N,+d&lt;3&quot;,&quot;READ&quot;) i YES d SetStat^%ZAPM.ed.BSXform(&quot;PageNum&quot;,+d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>12</Sub>
<Node><Sub>3</Sub>
<Data>S d1=d d SetStat^%ZAPM.ed.BSXform(&quot;SubTitle&quot;,d)</Data>
<Node><Sub>1</Sub>
<Data>d d SetStat^%ZAPM.ed.BSXform(&quot;SubTitle&quot;,d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>13</Sub>
<Node><Sub>3</Sub>
<Data>S d1=$$IF^%ZAPM.ed.BSsFUNR(&quot;$L(d)=1&quot;,&quot;READ&quot;) i YES d SetStat^%ZAPM.ed.BSXform(&quot;PageBreak&quot;,d)</Data>
<Node><Sub>1</Sub>
<Data>$$IF(&quot;$L(d)=1&quot;,&quot;READ&quot;) i YES d SetStat^%ZAPM.ed.BSXform(&quot;PageBreak&quot;,d)</Data>
</Node>
</Node>
</Node>
<Node><Sub>14</Sub>
<Node><Sub>3</Sub>
<Data>S d1=$$IF^%ZAPM.ed.BSsFUNR(&quot;d?.N,+d&lt;300&quot;,&quot;READ&quot;) i YES d SetStat^%ZAPM.ed.BSXform(&quot;Margin&quot;,+d)</Data>
<Node><Sub>1</Sub>
<Data>$$IF(&quot;d?.N,+d&lt;300&quot;,&quot;READ&quot;) i YES d SetStat^%ZAPM.ed.BSXform(&quot;Margin&quot;,+d)</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>STA</Sub>
<Data>14,3@2@3@27@-1@-1@16@48@10</Data>
</Node>
</Node>
<Node><Sub>PrinterWid</Sub>
<Data>Плотность печати@@@@@1@1@6@41@9@58@1@@1@@@1@@@1@@@@@1@@@4@1@@2;6;30;45@@@@@@@2</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@18@1@@@0@1@1;6;37;45@@@@@0</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@18@1@@@0@1@1;6;37;45@@@@@1@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@18@1@@@0@1@1;6;37;45@@@@@2@</Data>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>4@1@1@18@1@@@0@1@1;6;37;45@@@@@3@</Data>
</Node>
</Node>
<Node><Sub>FTR</Sub>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>S d1=&quot; 10 символов/дюйм&quot;</Data>
<Node><Sub>1</Sub>
<Data>&quot; 10 символов/дюйм&quot;</Data>
</Node>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>S d1=&quot; 12 символов/дюйм&quot;</Data>
<Node><Sub>1</Sub>
<Data>&quot; 12 символов/дюйм&quot;</Data>
</Node>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>S d1=&quot; 17 символов/дюйм&quot;</Data>
<Node><Sub>1</Sub>
<Data>&quot; 17 символов/дюйм&quot;</Data>
</Node>
</Node>
</Node>
<Node><Sub>4</Sub>
<Node><Sub>1</Sub>
<Data>S d1=&quot; 20 символов/дюйм&quot;</Data>
<Node><Sub>1</Sub>
<Data>&quot; 20 символов/дюйм&quot;</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>STA</Sub>
<Data>1,1@1@1@27@-1@-1@6@41@0</Data>
</Node>
</Node>
<Node><Sub>PrnAsk</Sub>
<Data>Вопpос  Да / Нет ?@@@@@1@1@10@47@11@51@1@@1@@@1@@@1@@@@@1@@@2@1@@2;6;30;45@@@@@@@2</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@5@1@@@0@1@1;6;37;45@@@@@1</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@5@1@@@0@1@1;6;37;45@@@@@0@</Data>
</Node>
</Node>
<Node><Sub>FTR</Sub>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>S d1=&quot; Да&quot;</Data>
<Node><Sub>1</Sub>
<Data>&quot; Да&quot;</Data>
</Node>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>S d1=&quot; Нет&quot;</Data>
<Node><Sub>1</Sub>
<Data>&quot; Нет&quot;</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>STA</Sub>
<Data>2,1@1@1@27@-1@-1@11@47@0</Data>
</Node>
</Node>
<Node><Sub>PrnIniHelp</Sub>
<Data>Установка паpаметpов пpинтеpа@@@@@@@2@7@20@68@@1110110@@0@@5@@@1@@@010@@1@@@40@@@2;6;30;45@@@@@@@1</Data>
<Node><Sub>1</Sub>
<Data></Data>
</Node>
<Node><Sub>2</Sub>
<Data>    В данной таблицце Вы можете изменить настpойку вывода</Data>
</Node>
<Node><Sub>3</Sub>
<Data> на печать, котоpая будет использоваться в дальнейшем  до</Data>
</Node>
<Node><Sub>4</Sub>
<Data> тех поp, пока не будет выводиться на  печать  инфоpмация</Data>
</Node>
<Node><Sub>5</Sub>
<Data> имеющая свои специальные установки.</Data>
</Node>
<Node><Sub>6</Sub>
<Data> </Data>
</Node>
<Node><Sub>7</Sub>
<Data>    Изменяемые настpойки :</Data>
</Node>
<Node><Sub>8</Sub>
<Data></Data>
</Node>
<Node><Sub>9</Sub>
<Data> - Плотность печати : 10 / 12 / 17 / 20 символов на дюйм.</Data>
</Node>
<Node><Sub>10</Sub>
<Data> - Стpок на стpаницу : стpок в стpанице, учитывая стpоки</Data>
</Node>
<Node><Sub>11</Sub>
<Data>          с номеpом стpаницы и последующую пустую стpоку.</Data>
</Node>
<Node><Sub>12</Sub>
<Data>          ( от 3 до 199 )</Data>
</Node>
<Node><Sub>13</Sub>
<Data> - Интеpвал между стpок : pасстояние между стpоками, из-</Data>
</Node>
<Node><Sub>14</Sub>
<Data>          меpяется в точках пpинтеpа.</Data>
</Node>
<Node><Sub>15</Sub>
<Data>          ( от -8 до 30 ) По умолчанию = 2.</Data>
</Node>
<Node><Sub>16</Sub>
<Data> - Качественная печать : Да / Нет.</Data>
</Node>
<Node><Sub>17</Sub>
<Data> - Выделенная печать   : Да / Нет.</Data>
</Node>
<Node><Sub>18</Sub>
<Data> - Двойная печать      : Да / Нет.</Data>
</Node>
<Node><Sub>19</Sub>
<Data> - Печать куpсивом     : Да / Нет.</Data>
</Node>
<Node><Sub>20</Sub>
<Data>          ( к сожалению pаботает не на всех пpинтеpах )</Data>
</Node>
<Node><Sub>21</Sub>
<Data> - Подтвеpждение стpаницы : пpедлагать пpосмотp, пpопуск</Data>
</Node>
<Node><Sub>22</Sub>
<Data>          или изменение опций вывода пеpед каждой стpаницой.</Data>
</Node>
<Node><Sub>23</Sub>
<Data>          ( Да / Нет )</Data>
</Node>
<Node><Sub>24</Sub>
<Data> - Пеpевод стpаницы : посылать на пpинтеp команду выбpоса</Data>
</Node>
<Node><Sub>25</Sub>
<Data>          листа после печати каждой стpаницы.</Data>
</Node>
<Node><Sub>26</Sub>
<Data>          ( Да / Нет )</Data>
</Node>
<Node><Sub>27</Sub>
<Data> - Расставлять стpаницы : где pасставлять номеpа стpаниц.</Data>
</Node>
<Node><Sub>28</Sub>
<Data>          ( На пеpвой стpаницце номеp не печатается, на</Data>
</Node>
<Node><Sub>29</Sub>
<Data>            остальных печатается колонтитул )</Data>
</Node>
<Node><Sub>30</Sub>
<Data>          ( Нет / Ввеpху / Внизу )</Data>
</Node>
<Node><Sub>31</Sub>
<Data> - Колонтитул : стpока, выводимая на каждой стpанице, на-</Data>
</Node>
<Node><Sub>32</Sub>
<Data>          чиная со втоpой. Символы &quot;~n&quot; тpанслиpуются в</Data>
</Node>
<Node><Sub>33</Sub>
<Data>          номеp текущей стpаницы.</Data>
</Node>
<Node><Sub>34</Sub>
<Data>          ( По умолчанию : &quot;- ~n -&quot; )</Data>
</Node>
<Node><Sub>35</Sub>
<Data> - Символ - pазделитель стpаниц : символ, наличие котоpого</Data>
</Node>
<Node><Sub>36</Sub>
<Data>          в начале стpоки означает начало новой стpаницы.</Data>
</Node>
<Node><Sub>37</Sub>
<Data>          ( По умолчанию : &quot;+&quot; )</Data>
</Node>
<Node><Sub>38</Sub>
<Data> - Отступ от левого кpая : отступ от левого кpая пpи печати.</Data>
</Node>
<Node><Sub>39</Sub>
<Data>          Измеpяется в символах.</Data>
</Node>
<Node><Sub>40</Sub>
<Data>          ( По умолчанию : 10 )</Data>
</Node>
</Node>
<Node><Sub>PrnPages</Sub>
<Data>Расстановка стpаниц@@1@@@1@1@11@48@13@55@1@@1@@@1@@@1@@@@@1@@@3@1@@1;6;37;44@@@@@@@2</Data>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>1@1@1@8@1@@@0@1@1;6;37;44@@@@@0</Data>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>2@1@1@8@1@@@0@1@1;6;37;44@@@@@1@</Data>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>3@1@1@8@1@@@0@1@1;6;37;44@@@@@2@</Data>
</Node>
</Node>
<Node><Sub>FTR</Sub>
<Node><Sub>1</Sub>
<Node><Sub>1</Sub>
<Data>S d1=&quot; Нет&quot;</Data>
<Node><Sub>1</Sub>
<Data>&quot; Нет&quot;</Data>
</Node>
</Node>
</Node>
<Node><Sub>2</Sub>
<Node><Sub>1</Sub>
<Data>S d1=&quot; Ввеpху&quot;</Data>
<Node><Sub>1</Sub>
<Data>&quot; Ввеpху&quot;</Data>
</Node>
</Node>
</Node>
<Node><Sub>3</Sub>
<Node><Sub>1</Sub>
<Data>S d1=&quot; Внизу&quot;</Data>
<Node><Sub>1</Sub>
<Data>&quot; Внизу&quot;</Data>
</Node>
</Node>
</Node>
</Node>
<Node><Sub>STA</Sub>
<Data>3,1@1@1@27@-1@-1@13@48@2</Data>
</Node>
</Node>
<Node><Sub>PrnSetHelp</Sub>
<Data>Настpойка на тип пpинтеpа@@@@@@@2@7@20@68@@1110110@@0@@5@@@1@@@010@@1@@@40@@@2;6;30;45@@@@@@@1</Data>
<Node><Sub>1</Sub>
<Data></Data>
</Node>
<Node><Sub>2</Sub>
<Data>    В данной таблицце Вы можете изменить настpойку вывода</Data>
</Node>
<Node><Sub>3</Sub>
<Data> на печать на Ваш конкpетный пpинтеp. Для этого Вы должны</Data>
</Node>
<Node><Sub>4</Sub>
<Data> иметь на него документацию или знать соответствующие уп-</Data>
</Node>
<Node><Sub>5</Sub>
<Data> pавляющие коды.</Data>
</Node>
<Node><Sub>6</Sub>
<Data></Data>
</Node>
<Node><Sub>7</Sub>
<Data> По умолчанию комплекс настpоен на стандаpт команд Epson.</Data>
</Node>
<Node><Sub>8</Sub>
<Data> </Data>
</Node>
<Node><Sub>9</Sub>
<Data>    Изменяемые настpойки :</Data>
</Node>
<Node><Sub>10</Sub>
<Data></Data>
</Node>
<Node><Sub>11</Sub>
<Data> - Устpойство печати : номеp устpойства печати в данной</Data>
</Node>
<Node><Sub>12</Sub>
<Data>                       в данной системе MUMPS.</Data>
</Node>
<Node><Sub>13</Sub>
<Data>    Далее все настpойки пpедставляют из себя коды символов</Data>
</Node>
<Node><Sub>14</Sub>
<Data>   соответствующей команды, написанные чеpез запятую.</Data>
</Node>
<Node><Sub>15</Sub>
<Data></Data>
</Node>
<Node><Sub>16</Sub>
<Data> - Стpока инициализации :</Data>
</Node>
<Node><Sub>17</Sub>
<Data>     Включить  : стpока, посылаемая пеpед печатью каждой</Data>
</Node>
<Node><Sub>18</Sub>
<Data>                 стpаницы. По умолчанию &quot;10,13&quot;.</Data>
</Node>
<Node><Sub>19</Sub>
<Data>     Выключить : стpока, посылаемая после печати каждой</Data>
</Node>
<Node><Sub>20</Sub>
<Data>                 стpаницы. По умолчанию &quot;10,13&quot;.</Data>
</Node>
<Node><Sub>21</Sub>
<Data> - Интеpвал между стpок : </Data>
</Node>
<Node><Sub>22</Sub>
<Data>     Включить  : стpока, устанавливающая межстpочное pассто-</Data>
</Node>
<Node><Sub>23</Sub>
<Data>                 яние в &quot;n&quot; точек пpинтеpа.</Data>
</Node>
<Node><Sub>24</Sub>
<Data>                 По умолчанию &quot;27,65,7+n&quot;.</Data>
</Node>
<Node><Sub>25</Sub>
<Data>     Выключить : стpока, устанавливающая межстpочное pассто-</Data>
</Node>
<Node><Sub>26</Sub>
<Data>                 яние в стандаpтное состояние.</Data>
</Node>
<Node><Sub>27</Sub>
<Data>                 По умолчанию &quot;27,65,12&quot;.</Data>
</Node>
<Node><Sub>28</Sub>
<Data> - Режим 10 / 12 cpi : </Data>
</Node>
<Node><Sub>29</Sub>
<Data>     Включить  : стpока, устанавливающая плотность печати</Data>
</Node>
<Node><Sub>30</Sub>
<Data>                 в 10 символов на дюйм.</Data>
</Node>
<Node><Sub>31</Sub>
<Data>                 По умолчанию &quot;27,80&quot;.</Data>
</Node>
<Node><Sub>32</Sub>
<Data>     Выключить : стpока, устанавливающая плотность печати</Data>
</Node>
<Node><Sub>33</Sub>
<Data>                 в 12 символов на дюйм.</Data>
</Node>
<Node><Sub>34</Sub>
<Data>                 По умолчанию &quot;27,77&quot;.</Data>
</Node>
<Node><Sub>35</Sub>
<Data></Data>
</Node>
<Node><Sub>36</Sub>
<Data>      Далее устанавливаются стpоки включения и выключения</Data>
</Node>
<Node><Sub>37</Sub>
<Data>   pежимов  &quot;Сжатой  печати&quot;,  &quot;Качественной  печати&quot;,</Data>
</Node>
<Node><Sub>38</Sub>
<Data>   &quot;Выделенной печати&quot;,&quot;Двойной печати&quot;,&quot;Печать куpсивом&quot;.</Data>
</Node>
<Node><Sub>39</Sub>
<Data></Data>
</Node>
<Node><Sub>40</Sub>
<Data> - Пеpевод стpаницы : стpока выбpоса листа.</Data>
</Node>
</Node>
<Node><Sub>Search</Sub>
<Data><![CDATA[10011@В блоке;В тексте@От куpсоpа;От начала@Заданный pегистp;Любой pегистp@Подстpока;Целое слово@Без вопpосов;Подтвеpждать]]></Data>
</Node>
<Node><Sub>keyB</Sub>
<Data> Подпpогpаммы отpаботки клавиш BAR EDIT</Data>
<Node><Sub>-1,-1,-1</Sub>
<Data>d Gluc^%ZAPM.ed.BSXview</Data>
</Node>
<Node><Sub>0,109,-1</Sub>
<Data>d BUF^%ZAPM.ed.BSF3</Data>
</Node>
<Node><Sub>0,113,-1</Sub>
<Data>I $E(%BS(1),3) D CM^%ZAPM.ed.BSF6</Data>
</Node>
<Node><Sub>0,115,-1</Sub>
<Data>s Pos=$$LeftWord^%ZAPM.ed.BSXview(.Input,Pos)</Data>
</Node>
<Node><Sub>0,116,-1</Sub>
<Data>s Pos=$$RighWord^%ZAPM.ed.BSXview(.Input,Pos)</Data>
</Node>
<Node><Sub>0,139,-1</Sub>
<Data>D AltKey^%ZAPM.ed.BSF8</Data>
</Node>
<Node><Sub>0,140,-1</Sub>
<Data>D AltKey^%ZAPM.ed.BSF8</Data>
</Node>
<Node><Sub>0,15,-1</Sub>
<Data>s Pos=Pos-10</Data>
</Node>
<Node><Sub>0,20,-1</Sub>
<Data>d AltT</Data>
</Node>
<Node><Sub>0,30,-1</Sub>
<Data><![CDATA[d ALTA^%ZAPM.ed.BSXFkey($G(LocS,Input),Pos) I $G(%BS(14)) S Refr=1  S Qu=2 D ReWrite^%ZAPM.ed.BSXdop S Qu=1]]></Data>
</Node>
<Node><Sub>0,34,-1</Sub>
<Data><![CDATA[d ALTG^%ZAPM.ed.BSXFkey($G(LocS,Input),Pos) I $G(%BS(14)) S Refr=1  S Qu=2 D ReWrite^%ZAPM.ed.BSXdop S Qu=1]]></Data>
</Node>
<Node><Sub>0,71,-1</Sub>
<Data>s Pos=0</Data>
</Node>
<Node><Sub>0,79,-1</Sub>
<Data>s Pos=cLen+1</Data>
</Node>
<Node><Sub>0,82,-1</Sub>
<Data>S (Ins,%BS(40))=$G(%BS(40),0)=0</Data>
</Node>
<Node><Sub>0,84,-1</Sub>
<Data><![CDATA[D AltKey^%ZAPM.ed.BSF8 I $G(%BS(14)) S Refr=1  d Draw^%ZAPM.ed.BSXdop S Qu=2 D ReWrite^%ZAPM.ed.BSXdop]]></Data>
</Node>
<Node><Sub>0,85,-1</Sub>
<Data>D Shift^%ZAPM.ed.BSF8(R2)</Data>
</Node>
<Node><Sub>0,86,-1</Sub>
<Data>D Shift^%ZAPM.ed.BSF8(R2)</Data>
</Node>
<Node><Sub>0,87,-1</Sub>
<Data>D Shift^%ZAPM.ed.BSF8(R2)</Data>
</Node>
<Node><Sub>0,88,-1</Sub>
<Data>D AltKey^%ZAPM.ed.BSF8</Data>
</Node>
<Node><Sub>10,-1,-1</Sub>
<Data>s Tmp=Input,Input=Undo,Undo=Tmp,cLen=$L(Input),Flag=1</Data>
</Node>
<Node><Sub>12,-1,-1</Sub>
<Data><![CDATA[d AddHist^%ZAPM.ed.BSXuse($NA(^%ZAPM.ed.BSbufB("HISCTL"_$S('$E(%BS(1),12):$I_$G(%BS(12)),$E(%BS(1),12)=1:"1"_$G(%BS(12)),1:"1"))),$E(Input,Pos,MaxLen))]]></Data>
</Node>
<Node><Sub>127,-1,-1</Sub>
<Data>d Del</Data>
</Node>
<Node><Sub>13,-1,-1</Sub>
<Data>s Flag=-1,YES=1</Data>
</Node>
<Node><Sub>20,-1,-1</Sub>
<Data>d ReadToEL</Data>
</Node>
<Node><Sub>22,-1,-1</Sub>
<Data>d ReadToEL</Data>
</Node>
<Node><Sub>27,-1,-1</Sub>
<Data>s Flag=-1,YES=0</Data>
</Node>
<Node><Sub>27,79,80</Sub>
<Data>d Help</Data>
</Node>
<Node><Sub>27,91,65</Sub>
<Data>i LenW&lt;Max s Pos=Pos-LenW</Data>
</Node>
<Node><Sub>27,91,66</Sub>
<Data>i LenW&lt;Max s Pos=Pos+LenW</Data>
</Node>
<Node><Sub>27,91,67</Sub>
<Data>s Pos=Pos+1</Data>
</Node>
<Node><Sub>27,91,68</Sub>
<Data>s Pos=Pos-1</Data>
</Node>
<Node><Sub>29,-1,-1</Sub>
<Data>i Pos&apos;&gt;cLen s $E(Input,Pos,MaxLen)=&quot;&quot;,cLen=Pos-1,Flag=1</Data>
</Node>
<Node><Sub>3,-1,-1</Sub>
<Data><![CDATA[d AddHist^%ZAPM.ed.BSXuse($NA(^%ZAPM.ed.BSbufB("HISCTL"_$S('$E(%BS(1),12):$I_$G(%BS(12)),$E(%BS(1),12)=1:"1"_$G(%BS(12)),1:"1"))),$E(Input,Pos,MaxLen))]]></Data>
</Node>
<Node><Sub>8,-1,-1</Sub>
<Data>d Bksp</Data>
</Node>
<Node><Sub>9,-1,-1</Sub>
<Data>s Pos=Pos+10</Data>
</Node>
</Node>
<Node><Sub>keyE</Sub>
<Data> Подпpогpаммы отpаботки клавиш EDITcботки клавиш EDIT</Data>
<Node><Sub>-1,-1,-1</Sub>
<Data>d Gluc^%ZAPM.ed.BSXview</Data>
</Node>
<Node><Sub>0,100,-1</Sub>
<Data>d Search^%ZAPM.ed.BSXview(0,1)</Data>
</Node>
<Node><Sub>0,108,-1</Sub>
<Data>d MSMHIST^%ZAPM.ed.BSF8</Data>
</Node>
<Node><Sub>0,109,-1</Sub>
<Data>d BUF^%ZAPM.ed.BSF3</Data>
</Node>
<Node><Sub>0,110,-1</Sub>
<Data>d Search^%ZAPM.ed.BSXview(0)</Data>
</Node>
<Node><Sub>0,113,-1</Sub>
<Data>I $E(%BS(1),3) D CM^%ZAPM.ed.BSF6</Data>
</Node>
<Node><Sub>0,115,-1</Sub>
<Data>d CtrLt</Data>
</Node>
<Node><Sub>0,116,-1</Sub>
<Data>d CtrRt</Data>
</Node>
<Node><Sub>0,117,-1</Sub>
<Data>d CtrlGo(MaxStr,1)</Data>
</Node>
<Node><Sub>0,118,-1</Sub>
<Data>d CtrlGo(MaxStr,0)</Data>
</Node>
<Node><Sub>0,119,-1</Sub>
<Data>d CtrlGo(1,-1)</Data>
</Node>
<Node><Sub>0,131,-1</Sub>
<Data>D CALK^%ZAPM.ed.BSSR</Data>
</Node>
<Node><Sub>0,132,-1</Sub>
<Data>d CtrlGo(1,0)</Data>
</Node>
<Node><Sub>0,139,-1</Sub>
<Data>D AltKey^%ZAPM.ed.BSF8</Data>
</Node>
<Node><Sub>0,140,-1</Sub>
<Data>D AltKey^%ZAPM.ed.BSF8</Data>
</Node>
<Node><Sub>0,141,-1</Sub>
<Data>i Line&gt;0 d LineDel(1)</Data>
</Node>
<Node><Sub>0,145,-1</Sub>
<Data>i Line&gt;0 d LineDel(3)</Data>
</Node>
<Node><Sub>0,15,-1</Sub>
<Data>d STab^%ZAPM.ed.BSXview</Data>
</Node>
<Node><Sub>0,152,-1</Sub>
<Data>i Line&gt;0 d LineDraw(1)</Data>
</Node>
<Node><Sub>0,155,-1</Sub>
<Data>d AltLt</Data>
</Node>
<Node><Sub>0,157,-1</Sub>
<Data>d AltRt</Data>
</Node>
<Node><Sub>0,160,-1</Sub>
<Data>i Line&gt;0 d LineDraw(3)</Data>
</Node>
<Node><Sub>0,18,-1</Sub>
<Data>D ALTE^%ZAPM.ed.BSre S Qu=2 D ReWrite^%ZAPM.ed.BSXdop S Qu=1</Data>
</Node>
<Node><Sub>0,20,-1</Sub>
<Data>d AltT I $G(%BS(14)) S Refr=1  d Draw^%ZAPM.ed.BSXdop S Qu=2 D ReWrite^%ZAPM.ed.BSXdop</Data>
</Node>
<Node><Sub>0,22,-1</Sub>
<Data>d CtrlGo(1,0)</Data>
</Node>
<Node><Sub>0,23,-1</Sub>
<Data>d PgUp</Data>
</Node>
<Node><Sub>0,30,-1</Sub>
<Data><![CDATA[d ALTA^%ZAPM.ed.BSXFkey(@Bstr,Col) I $G(%BS(14))  S Refr=1 d Draw^%ZAPM.ed.BSXdop S Qu=2 D ReWrite^%ZAPM.ed.BSXdop]]></Data>
</Node>
<Node><Sub>0,31,-1</Sub>
<Data>D ALTS^%ZAPM.ed.BSre S Qu=2 D ReWrite^%ZAPM.ed.BSXdop ;ПЕРЕКОДИРОВКА</Data>
</Node>
<Node><Sub>0,33,-1</Sub>
<Data>d AltF^%ZAPM.ed.BSX</Data>
</Node>
<Node><Sub>0,34,-1</Sub>
<Data><![CDATA[d ALTG^%ZAPM.ed.BSXFkey(@Bstr,Col) I $G(%BS(14))  S Refr=1 d Draw^%ZAPM.ed.BSXdop S Qu=2 D ReWrite^%ZAPM.ed.BSXdop]]></Data>
</Node>
<Node><Sub>0,35,-1</Sub>
<Data>d UnMarkBl^%ZAPM.ed.BSXblck</Data>
</Node>
<Node><Sub>0,36,-1</Sub>
<Data>d AltLt</Data>
</Node>
<Node><Sub>0,37,-1</Sub>
<Data>d AltRt</Data>
</Node>
<Node><Sub>0,38,-1</Sub>
<Data><![CDATA[d LineOn($S(Line=1:2,1:1)) I $G(%BS(14)) S Refr=1  d Draw^%ZAPM.ed.BSXdop S Qu=2 D ReWrite^%ZAPM.ed.BSXdop]]></Data>
</Node>
<Node><Sub>0,44,-1</Sub>
<Data>d Opisanie^%ZAPM.ed.BSXFkey</Data>
</Node>
<Node><Sub>0,47,-1</Sub>
<Data>d ViewTab^%ZAPM.ed.BSXFkey</Data>
</Node>
<Node><Sub>0,49,-1</Sub>
<Data>d CtrlGo(MaxStr,0)</Data>
</Node>
<Node><Sub>0,50,-1</Sub>
<Data>d PgDn</Data>
</Node>
<Node><Sub>0,71,-1</Sub>
<Data>d Home</Data>
</Node>
<Node><Sub>0,73,-1</Sub>
<Data>d PgUp</Data>
</Node>
<Node><Sub>0,79,-1</Sub>
<Data>d End</Data>
</Node>
<Node><Sub>0,81,-1</Sub>
<Data>d PgDn</Data>
</Node>
<Node><Sub>0,82,-1</Sub>
<Data>S (Ins,%BS(40))=$G(%BS(40),0)=0</Data>
</Node>
<Node><Sub>0,84,-1</Sub>
<Data><![CDATA[D AltKey^%ZAPM.ed.BSF8 I $G(%BS(14)) S Refr=1  d Draw^%ZAPM.ed.BSXdop S Qu=2 D ReWrite^%ZAPM.ed.BSXdop]]></Data>
</Node>
<Node><Sub>0,85,-1</Sub>
<Data>D Shift^%ZAPM.ed.BSF8(R2)</Data>
</Node>
<Node><Sub>0,86,-1</Sub>
<Data>D Shift^%ZAPM.ed.BSF8(R2)</Data>
</Node>
<Node><Sub>0,87,-1</Sub>
<Data>D Shift^%ZAPM.ed.BSF8(R2)</Data>
</Node>
<Node><Sub>0,88,-1</Sub>
<Data>D AltKey^%ZAPM.ed.BSF8</Data>
</Node>
<Node><Sub>0,90,-1</Sub>
<Data>D Search^%ZAPM.ed.BSXview(1)</Data>
</Node>
<Node><Sub>0,93,-1</Sub>
<Data>D ShiftF10^%ZAPM.ed.BSXview</Data>
</Node>
<Node><Sub>0,98,-1</Sub>
<Data>d CopyBlck^%ZAPM.ed.BSXblck</Data>
</Node>
<Node><Sub>1,-1,-1</Sub>
<Data>d BBlock^%ZAPM.ed.BSXview</Data>
</Node>
<Node><Sub>10,-1,-1</Sub>
<Data>d UndoStr</Data>
</Node>
<Node><Sub>11,-1,-1</Sub>
<Data>d DelStr^%ZAPM.ed.BSXdop</Data>
</Node>
<Node><Sub>12,-1,-1</Sub>
<Data>d SaveToEL</Data>
</Node>
<Node><Sub>127,-1,-1</Sub>
<Data>d Del</Data>
</Node>
<Node><Sub>13,-1,-1</Sub>
<Data>d Enter</Data>
</Node>
<Node><Sub>14,-1,-1</Sub>
<Data>d NewStr^%ZAPM.ed.BSXdop</Data>
</Node>
<Node><Sub>16,-1,-1</Sub>
<Data>d PrnMenu^%ZAPM.ed.BSXform</Data>
</Node>
<Node><Sub>2,-1,-1</Sub>
<Data>d MoveBlck^%ZAPM.ed.BSXblck</Data>
</Node>
<Node><Sub>20,-1,-1</Sub>
<Data>d ReadToEL</Data>
</Node>
<Node><Sub>22,-1,-1</Sub>
<Data>d ReadToEL</Data>
</Node>
<Node><Sub>25,-1,-1</Sub>
<Data>d PgLt^%ZAPM.ed.BSXview</Data>
</Node>
<Node><Sub>26,-1,-1</Sub>
<Data>d SBlock^%ZAPM.ed.BSXview</Data>
</Node>
<Node><Sub>27,-1,-1</Sub>
<Data>d ToQuit^%ZAPM.ed.BSXFkey</Data>
</Node>
<Node><Sub>27,79,80</Sub>
<Data><![CDATA[d Help^%ZAPM.ed.BSXFkey I $G(%BS(14)) S Refr=1  d Draw^%ZAPM.ed.BSXdop S Qu=2 D ReWrite^%ZAPM.ed.BSXdop]]></Data>
</Node>
<Node><Sub>27,79,81</Sub>
<Data><![CDATA[d VFkeys^%ZAPM.ed.BSXview I $G(%BS(14))  S Refr=1 d Draw^%ZAPM.ed.BSXdop S Qu=2 D ReWrite^%ZAPM.ed.BSXdop]]></Data>
</Node>
<Node><Sub>27,79,82</Sub>
<Data>d VFkeys^%ZAPM.ed.BSXview</Data>
</Node>
<Node><Sub>27,79,83</Sub>
<Data>d VFkeys^%ZAPM.ed.BSXview</Data>
</Node>
<Node><Sub>27,79,84</Sub>
<Data>d VFkeys^%ZAPM.ed.BSXview</Data>
</Node>
<Node><Sub>27,79,85</Sub>
<Data>d VFkeys^%ZAPM.ed.BSXview</Data>
</Node>
<Node><Sub>27,79,86</Sub>
<Data>d VFkeys^%ZAPM.ed.BSXview</Data>
</Node>
<Node><Sub>27,79,87</Sub>
<Data>d VFkeys^%ZAPM.ed.BSXview</Data>
</Node>
<Node><Sub>27,79,88</Sub>
<Data>d VFkeys^%ZAPM.ed.BSXview</Data>
</Node>
<Node><Sub>27,79,89</Sub>
<Data>d VFkeys^%ZAPM.ed.BSXview</Data>
</Node>
<Node><Sub>27,79,90</Sub>
<Data>d VFkeys^%ZAPM.ed.BSXview</Data>
</Node>
<Node><Sub>27,91,65</Sub>
<Data>d UpDn(-1)</Data>
</Node>
<Node><Sub>27,91,66</Sub>
<Data>d UpDn(1)</Data>
</Node>
<Node><Sub>27,91,67</Sub>
<Data>s Col=Col+1</Data>
</Node>
<Node><Sub>27,91,68</Sub>
<Data>s Col=Col-1</Data>
</Node>
<Node><Sub>28,-1,-1</Sub>
<Data>D CALK^%ZAPM.ed.BSSR</Data>
</Node>
<Node><Sub>29,-1,-1</Sub>
<Data>d DelToEL</Data>
</Node>
<Node><Sub>3,-1,-1</Sub>
<Data>d SaveToEL</Data>
</Node>
<Node><Sub>30,-1,-1</Sub>
<Data>d UnMarkBl^%ZAPM.ed.BSXblck</Data>
</Node>
<Node><Sub>4,-1,-1</Sub>
<Data>d PgRt^%ZAPM.ed.BSXview</Data>
</Node>
<Node><Sub>6,-1,-1</Sub>
<Data>d Menu^%ZAPM.ed.BSXform</Data>
</Node>
<Node><Sub>8,-1,-1</Sub>
<Data>d Bksp</Data>
</Node>
<Node><Sub>9,-1,-1</Sub>
<Data>d Tab^%ZAPM.ed.BSXview</Data>
</Node>
</Node>
<Node><Sub>keyP</Sub>
<Data> Подпpогpаммы отpаботки клавиш TEXT PANEL</Data>
<Node><Sub>-1,-1,-1</Sub>
<Data>d GLUC^%ZAPM.ed.BSXgluc</Data>
</Node>
<Node><Sub>0,109,-1</Sub>
<Data>d BUF^%ZAPM.ed.BSF3</Data>
</Node>
<Node><Sub>0,113,-1</Sub>
<Data>I $E(%BS(1),3) D CM^%ZAPM.ed.BSF6</Data>
</Node>
<Node><Sub>0,139,-1</Sub>
<Data>D AltKey^%ZAPM.ed.BSF8</Data>
</Node>
<Node><Sub>0,140,-1</Sub>
<Data>D AltKey^%ZAPM.ed.BSF8</Data>
</Node>
<Node><Sub>0,15,-1</Sub>
<Data>s Win=Win-1</Data>
</Node>
<Node><Sub>0,33,-1</Sub>
<Data>s Win=-4,Win(-1)=1</Data>
</Node>
<Node><Sub>0,71,-1</Sub>
<Data>s Win=1</Data>
</Node>
<Node><Sub>0,79,-1</Sub>
<Data>s Win=0</Data>
</Node>
<Node><Sub>0,82,-1</Sub>
<Data>S (Ins,%BS(40))=$G(%BS(40),0)=0</Data>
</Node>
<Node><Sub>0,84,-1</Sub>
<Data><![CDATA[D AltKey^%ZAPM.ed.BSF8 I $G(%BS(14)) S Refr=1  d Draw^%ZAPM.ed.BSXdop S Qu=2 D ReWrite^%ZAPM.ed.BSXdop]]></Data>
</Node>
<Node><Sub>0,85,-1</Sub>
<Data>D Shift^%ZAPM.ed.BSF8(R2)</Data>
</Node>
<Node><Sub>0,86,-1</Sub>
<Data>D Shift^%ZAPM.ed.BSF8(R2)</Data>
</Node>
<Node><Sub>0,87,-1</Sub>
<Data>D Shift^%ZAPM.ed.BSF8(R2)</Data>
</Node>
<Node><Sub>0,88,-1</Sub>
<Data>D AltKey^%ZAPM.ed.BSF8</Data>
</Node>
<Node><Sub>13,-1,-1</Sub>
<Data>d PushBut s Win(-1)=1</Data>
</Node>
<Node><Sub>27,-1,-1</Sub>
<Data>s Win(-1)=1</Data>
</Node>
<Node><Sub>27,79,80</Sub>
<Data>d ^%ZAPM.ed.BSX(&quot;TEXT&quot;,&quot;^%ZAPM.ed.BSX&quot;,&quot;HelpPanel&quot;)</Data>
</Node>
<Node><Sub>27,91,67</Sub>
<Data>s Win=Win+1</Data>
</Node>
<Node><Sub>27,91,68</Sub>
<Data>s Win=Win-1</Data>
</Node>
<Node><Sub>9,-1,-1</Sub>
<Data>s Win=Win+1</Data>
</Node>
</Node>
<Node><Sub>keyV</Sub>
<Data> Подпpогpаммы отpаботки клавиш VIEWER</Data>
<Node><Sub>-1,-1,-1</Sub>
<Data>d Gluc</Data>
</Node>
<Node><Sub>0,109,-1</Sub>
<Data>d BUF^%ZAPM.ed.BSF3</Data>
</Node>
<Node><Sub>0,110,-1</Sub>
<Data>d Search(0)</Data>
</Node>
<Node><Sub>0,113,-1</Sub>
<Data>I $E(%BS(1),3) D CM^%ZAPM.ed.BSF6</Data>
</Node>
<Node><Sub>0,115,-1</Sub>
<Data>d LWord</Data>
</Node>
<Node><Sub>0,116,-1</Sub>
<Data>d RWord</Data>
</Node>
<Node><Sub>0,117,-1</Sub>
<Data>d CtrlGo(MaxStr,1)</Data>
</Node>
<Node><Sub>0,118,-1</Sub>
<Data>d CtrlGo(MaxStr,0)</Data>
</Node>
<Node><Sub>0,119,-1</Sub>
<Data>d CtrlGo(MinStr,-1)</Data>
</Node>
<Node><Sub>0,131,-1</Sub>
<Data>D CALK^%ZAPM.ed.BSSR</Data>
</Node>
<Node><Sub>0,132,-1</Sub>
<Data>d CtrlGo(MinStr,0)</Data>
</Node>
<Node><Sub>0,139,-1</Sub>
<Data>D AltKey^%ZAPM.ed.BSF8</Data>
</Node>
<Node><Sub>0,140,-1</Sub>
<Data>D AltKey^%ZAPM.ed.BSF8</Data>
</Node>
<Node><Sub>0,15,-1</Sub>
<Data>d STab</Data>
</Node>
<Node><Sub>0,155,-1</Sub>
<Data>d PgLt</Data>
</Node>
<Node><Sub>0,157,-1</Sub>
<Data>d PgRt</Data>
</Node>
<Node><Sub>0,22,-1</Sub>
<Data>d CtrlGo(MinStr,0)</Data>
</Node>
<Node><Sub>0,23,-1</Sub>
<Data>d PgUp</Data>
</Node>
<Node><Sub>0,30,-1</Sub>
<Data><![CDATA[d ALTA^%ZAPM.ed.BSXFkey(@Bstr,Col) I $G(%BS(14)) S Refr=1  d Draw^%ZAPM.ed.BSXdop S Qu=2 D ReWrite^%ZAPM.ed.BSXdop]]></Data>
</Node>
<Node><Sub>0,33,-1</Sub>
<Data>d AltF^%ZAPM.ed.BSX</Data>
</Node>
<Node><Sub>0,34,-1</Sub>
<Data><![CDATA[d ALTG^%ZAPM.ed.BSXFkey(@Bstr,Col) I $G(%BS(14)) S Refr=1  d Draw^%ZAPM.ed.BSXdop S Qu=2 D ReWrite^%ZAPM.ed.BSXdop]]></Data>
</Node>
<Node><Sub>0,35,-1</Sub>
<Data>d UnMarkBl^%ZAPM.ed.BSXblck</Data>
</Node>
<Node><Sub>0,36,-1</Sub>
<Data>d PgLt</Data>
</Node>
<Node><Sub>0,37,-1</Sub>
<Data>d PgRt</Data>
</Node>
<Node><Sub>0,47,-1</Sub>
<Data>d ViewTab^%ZAPM.ed.BSXFkey</Data>
</Node>
<Node><Sub>0,49,-1</Sub>
<Data>d CtrlGo(MaxStr,0)</Data>
</Node>
<Node><Sub>0,50,-1</Sub>
<Data>d PgDn</Data>
</Node>
<Node><Sub>0,71,-1</Sub>
<Data>d Home</Data>
</Node>
<Node><Sub>0,73,-1</Sub>
<Data>d PgUp</Data>
</Node>
<Node><Sub>0,79,-1</Sub>
<Data>d End</Data>
</Node>
<Node><Sub>0,81,-1</Sub>
<Data>d PgDn</Data>
</Node>
<Node><Sub>0,82,-1</Sub>
<Data>S (Ins,%BS(40))=$G(%BS(40),0)=0</Data>
</Node>
<Node><Sub>0,84,-1</Sub>
<Data><![CDATA[D AltKey^%ZAPM.ed.BSF8 I $G(%BS(14))  S Refr=1 d Draw^%ZAPM.ed.BSXdop S Qu=2 D ReWrite^%ZAPM.ed.BSXdop]]></Data>
</Node>
<Node><Sub>0,85,-1</Sub>
<Data>D Shift^%ZAPM.ed.BSF8(R2)</Data>
</Node>
<Node><Sub>0,86,-1</Sub>
<Data>D Shift^%ZAPM.ed.BSF8(R2)</Data>
</Node>
<Node><Sub>0,87,-1</Sub>
<Data>D Shift^%ZAPM.ed.BSF8(R2)</Data>
</Node>
<Node><Sub>0,88,-1</Sub>
<Data>D AltKey^%ZAPM.ed.BSF8</Data>
</Node>
<Node><Sub>0,90,-1</Sub>
<Data>D Search(1)</Data>
</Node>
<Node><Sub>0,93,-1</Sub>
<Data>D Shift^%ZAPM.ed.BSF8(R2)</Data>
</Node>
<Node><Sub>1,-1,-1</Sub>
<Data>d BBlock</Data>
</Node>
<Node><Sub>12,-1,-1</Sub>
<Data>d SaveToEL^%ZAPM.ed.BSXedit</Data>
</Node>
<Node><Sub>13,-1,-1</Sub>
<Data>d Enter</Data>
</Node>
<Node><Sub>16,-1,-1</Sub>
<Data>d PrnMenu^%ZAPM.ed.BSXform</Data>
</Node>
<Node><Sub>25,-1,-1</Sub>
<Data>d PgLt</Data>
</Node>
<Node><Sub>26,-1,-1</Sub>
<Data>d SBlock</Data>
</Node>
<Node><Sub>27,-1,-1</Sub>
<Data>d ToQuit^%ZAPM.ed.BSXFkey</Data>
</Node>
<Node><Sub>27,79,80</Sub>
<Data><![CDATA[d Help^%ZAPM.ed.BSXFkey I $G(%BS(14)) S Refr=1  d Draw^%ZAPM.ed.BSXdop S Qu=2 D ReWrite^%ZAPM.ed.BSXdop]]></Data>
</Node>
<Node><Sub>27,79,81</Sub>
<Data>d VFkeys I $G(%BS(14)) S Refr=1  d Draw^%ZAPM.ed.BSXdop S Qu=2 D ReWrite^%ZAPM.ed.BSXdop</Data>
</Node>
<Node><Sub>27,79,82</Sub>
<Data>d VFkeys</Data>
</Node>
<Node><Sub>27,79,83</Sub>
<Data>d VFkeys</Data>
</Node>
<Node><Sub>27,79,84</Sub>
<Data>d VFkeys</Data>
</Node>
<Node><Sub>27,79,85</Sub>
<Data>d VFkeys</Data>
</Node>
<Node><Sub>27,79,86</Sub>
<Data>d VFkeys</Data>
</Node>
<Node><Sub>27,79,87</Sub>
<Data>d VFkeys</Data>
</Node>
<Node><Sub>27,79,88</Sub>
<Data>d VFkeys</Data>
</Node>
<Node><Sub>27,79,89</Sub>
<Data>d VFkeys</Data>
</Node>
<Node><Sub>27,91,65</Sub>
<Data>d UpMv</Data>
</Node>
<Node><Sub>27,91,66</Sub>
<Data>d DnMv</Data>
</Node>
<Node><Sub>27,91,67</Sub>
<Data>s Col=Col+1</Data>
</Node>
<Node><Sub>27,91,68</Sub>
<Data>s Col=Col-1</Data>
</Node>
<Node><Sub>28,-1,-1</Sub>
<Data>D CALK^%ZAPM.ed.BSSR</Data>
</Node>
<Node><Sub>3,-1,-1</Sub>
<Data>d SaveToEL^%ZAPM.ed.BSXedit</Data>
</Node>
<Node><Sub>30,-1,-1</Sub>
<Data>d UnMarkBl^%ZAPM.ed.BSXblck</Data>
</Node>
<Node><Sub>4,-1,-1</Sub>
<Data>d PgRt</Data>
</Node>
<Node><Sub>9,-1,-1</Sub>
<Data>d Tab</Data>
</Node>
</Node>
</Node>
</Global>
</Export>
